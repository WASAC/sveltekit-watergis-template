var K0=Object.defineProperty;var r_=Object.getOwnPropertySymbols;var J0=Object.prototype.hasOwnProperty,Y0=Object.prototype.propertyIsEnumerable;var n_=(c,a,l)=>a in c?K0(c,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[a]=l,sl=(c,a)=>{for(var l in a||(a={}))J0.call(a,l)&&n_(c,l,a[l]);if(r_)for(var l of r_(a))Y0.call(a,l)&&n_(c,l,a[l]);return c};import{F as ll,G as Dy,H as $0,I as Q0,S as Rn,i as Bn,s as On,J as Co,C as Ci,e as Tr,c as Ar,a as Zr,d as Zt,K as Hr,g as Fi,L as Jr,M as ko,N as zo,O as Po,z as go,P as ha,q as Mi,o as Ui,Q as Ya,R as br,T as Fo,v as yh,U as Uo,V as ex,W as _n,w as en,l as Qo,x as In,y as tn,A as Fs,p as Yh,B as rn,X as gs,r as Ea,Y as Ud,n as $h,Z as tx,E as cl,b as Ur,k as pa,m as da,_ as ix,$ as wa,a0 as rx,t as Np,h as jp,j as ev,a1 as o_,a2 as a_,a3 as jf,a4 as Md,a5 as Ld,a6 as nx}from"./index-9c2ec6cf.js";import{r as ox,w as tv,_ as py}from"./preload-helper-c997f876.js";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ry=function(c,a){return Ry=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,x){l.__proto__=x}||function(l,x){for(var T in x)Object.prototype.hasOwnProperty.call(x,T)&&(l[T]=x[T])},Ry(c,a)};function vu(c,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");Ry(c,a);function l(){this.constructor=c}c.prototype=a===null?Object.create(a):(l.prototype=a.prototype,new l)}var La=function(){return La=Object.assign||function(a){for(var l,x=1,T=arguments.length;x<T;x++){l=arguments[x];for(var P in l)Object.prototype.hasOwnProperty.call(l,P)&&(a[P]=l[P])}return a},La.apply(this,arguments)};function Tf(c){var a=typeof Symbol=="function"&&Symbol.iterator,l=a&&c[a],x=0;if(l)return l.call(c);if(c&&typeof c.length=="number")return{next:function(){return c&&x>=c.length&&(c=void 0),{value:c&&c[x++],done:!c}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Qh=function(){function c(a){a===void 0&&(a={}),this.adapter=a}return Object.defineProperty(c,"cssClasses",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(c,"strings",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(c,"numbers",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(c,"defaultAdapter",{get:function(){return{}},enumerable:!1,configurable:!0}),c.prototype.init=function(){},c.prototype.destroy=function(){},c}();/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function ax(c){return c===void 0&&(c=window),sx(c)?{passive:!0}:!1}function sx(c){c===void 0&&(c=window);var a=!1;try{var l={get passive(){return a=!0,!1}},x=function(){};c.document.addEventListener("test",x,l),c.document.removeEventListener("test",x,l)}catch{a=!1}return a}var lx=Object.freeze(Object.defineProperty({__proto__:null,applyPassive:ax},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function ux(c,a){if(c.closest)return c.closest(a);for(var l=c;l;){if(iv(l,a))return l;l=l.parentElement}return null}function iv(c,a){var l=c.matches||c.webkitMatchesSelector||c.msMatchesSelector;return l.call(c,a)}function cx(c){var a=c;if(a.offsetParent!==null)return a.scrollWidth;var l=a.cloneNode(!0);l.style.setProperty("position","absolute"),l.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(l);var x=l.scrollWidth;return document.documentElement.removeChild(l),x}var rv=Object.freeze(Object.defineProperty({__proto__:null,closest:ux,matches:iv,estimateScrollWidth:cx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var hx={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},px={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},s_={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300},Af;function dx(c,a){a===void 0&&(a=!1);var l=c.CSS,x=Af;if(typeof Af=="boolean"&&!a)return Af;var T=l&&typeof l.supports=="function";if(!T)return!1;var P=l.supports("--css-vars","yes"),f=l.supports("(--css-vars: yes)")&&l.supports("color","#00000000");return x=P||f,a||(Af=x),x}function fx(c,a,l){if(!c)return{x:0,y:0};var x=a.x,T=a.y,P=x+l.left,f=T+l.top,d,R;if(c.type==="touchstart"){var q=c;d=q.changedTouches[0].pageX-P,R=q.changedTouches[0].pageY-f}else{var V=c;d=V.pageX-P,R=V.pageY-f}return{x:d,y:R}}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var l_=["touchstart","pointerdown","mousedown","keydown"],u_=["touchend","pointerup","mouseup","contextmenu"],Cf=[],mx=function(c){vu(a,c);function a(l){var x=c.call(this,La(La({},a.defaultAdapter),l))||this;return x.activationAnimationHasEnded=!1,x.activationTimer=0,x.fgDeactivationRemovalTimer=0,x.fgScale="0",x.frame={width:0,height:0},x.initialSize=0,x.layoutFrame=0,x.maxRadius=0,x.unboundedCoords={left:0,top:0},x.activationState=x.defaultActivationState(),x.activationTimerCallback=function(){x.activationAnimationHasEnded=!0,x.runDeactivationUXLogicIfReady()},x.activateHandler=function(T){x.activateImpl(T)},x.deactivateHandler=function(){x.deactivateImpl()},x.focusHandler=function(){x.handleFocus()},x.blurHandler=function(){x.handleBlur()},x.resizeHandler=function(){x.layout()},x}return Object.defineProperty(a,"cssClasses",{get:function(){return hx},enumerable:!1,configurable:!0}),Object.defineProperty(a,"strings",{get:function(){return px},enumerable:!1,configurable:!0}),Object.defineProperty(a,"numbers",{get:function(){return s_},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!1,configurable:!0}),a.prototype.init=function(){var l=this,x=this.supportsPressRipple();if(this.registerRootHandlers(x),x){var T=a.cssClasses,P=T.ROOT,f=T.UNBOUNDED;requestAnimationFrame(function(){l.adapter.addClass(P),l.adapter.isUnbounded()&&(l.adapter.addClass(f),l.layoutInternal())})}},a.prototype.destroy=function(){var l=this;if(this.supportsPressRipple()){this.activationTimer&&(clearTimeout(this.activationTimer),this.activationTimer=0,this.adapter.removeClass(a.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer&&(clearTimeout(this.fgDeactivationRemovalTimer),this.fgDeactivationRemovalTimer=0,this.adapter.removeClass(a.cssClasses.FG_DEACTIVATION));var x=a.cssClasses,T=x.ROOT,P=x.UNBOUNDED;requestAnimationFrame(function(){l.adapter.removeClass(T),l.adapter.removeClass(P),l.removeCssVars()})}this.deregisterRootHandlers(),this.deregisterDeactivationHandlers()},a.prototype.activate=function(l){this.activateImpl(l)},a.prototype.deactivate=function(){this.deactivateImpl()},a.prototype.layout=function(){var l=this;this.layoutFrame&&cancelAnimationFrame(this.layoutFrame),this.layoutFrame=requestAnimationFrame(function(){l.layoutInternal(),l.layoutFrame=0})},a.prototype.setUnbounded=function(l){var x=a.cssClasses.UNBOUNDED;l?this.adapter.addClass(x):this.adapter.removeClass(x)},a.prototype.handleFocus=function(){var l=this;requestAnimationFrame(function(){return l.adapter.addClass(a.cssClasses.BG_FOCUSED)})},a.prototype.handleBlur=function(){var l=this;requestAnimationFrame(function(){return l.adapter.removeClass(a.cssClasses.BG_FOCUSED)})},a.prototype.supportsPressRipple=function(){return this.adapter.browserSupportsCssVars()},a.prototype.defaultActivationState=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},a.prototype.registerRootHandlers=function(l){var x,T;if(l){try{for(var P=Tf(l_),f=P.next();!f.done;f=P.next()){var d=f.value;this.adapter.registerInteractionHandler(d,this.activateHandler)}}catch(R){x={error:R}}finally{try{f&&!f.done&&(T=P.return)&&T.call(P)}finally{if(x)throw x.error}}this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler)}this.adapter.registerInteractionHandler("focus",this.focusHandler),this.adapter.registerInteractionHandler("blur",this.blurHandler)},a.prototype.registerDeactivationHandlers=function(l){var x,T;if(l.type==="keydown")this.adapter.registerInteractionHandler("keyup",this.deactivateHandler);else try{for(var P=Tf(u_),f=P.next();!f.done;f=P.next()){var d=f.value;this.adapter.registerDocumentInteractionHandler(d,this.deactivateHandler)}}catch(R){x={error:R}}finally{try{f&&!f.done&&(T=P.return)&&T.call(P)}finally{if(x)throw x.error}}},a.prototype.deregisterRootHandlers=function(){var l,x;try{for(var T=Tf(l_),P=T.next();!P.done;P=T.next()){var f=P.value;this.adapter.deregisterInteractionHandler(f,this.activateHandler)}}catch(d){l={error:d}}finally{try{P&&!P.done&&(x=T.return)&&x.call(T)}finally{if(l)throw l.error}}this.adapter.deregisterInteractionHandler("focus",this.focusHandler),this.adapter.deregisterInteractionHandler("blur",this.blurHandler),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler)},a.prototype.deregisterDeactivationHandlers=function(){var l,x;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler);try{for(var T=Tf(u_),P=T.next();!P.done;P=T.next()){var f=P.value;this.adapter.deregisterDocumentInteractionHandler(f,this.deactivateHandler)}}catch(d){l={error:d}}finally{try{P&&!P.done&&(x=T.return)&&x.call(T)}finally{if(l)throw l.error}}},a.prototype.removeCssVars=function(){var l=this,x=a.strings,T=Object.keys(x);T.forEach(function(P){P.indexOf("VAR_")===0&&l.adapter.updateCssVariable(x[P],null)})},a.prototype.activateImpl=function(l){var x=this;if(!this.adapter.isSurfaceDisabled()){var T=this.activationState;if(!T.isActivated){var P=this.previousActivationEvent,f=P&&l!==void 0&&P.type!==l.type;if(!f){T.isActivated=!0,T.isProgrammatic=l===void 0,T.activationEvent=l,T.wasActivatedByPointer=T.isProgrammatic?!1:l!==void 0&&(l.type==="mousedown"||l.type==="touchstart"||l.type==="pointerdown");var d=l!==void 0&&Cf.length>0&&Cf.some(function(R){return x.adapter.containsEventTarget(R)});if(d){this.resetActivationState();return}l!==void 0&&(Cf.push(l.target),this.registerDeactivationHandlers(l)),T.wasElementMadeActive=this.checkElementMadeActive(l),T.wasElementMadeActive&&this.animateActivation(),requestAnimationFrame(function(){Cf=[],!T.wasElementMadeActive&&l!==void 0&&(l.key===" "||l.keyCode===32)&&(T.wasElementMadeActive=x.checkElementMadeActive(l),T.wasElementMadeActive&&x.animateActivation()),T.wasElementMadeActive||(x.activationState=x.defaultActivationState())})}}}},a.prototype.checkElementMadeActive=function(l){return l!==void 0&&l.type==="keydown"?this.adapter.isSurfaceActive():!0},a.prototype.animateActivation=function(){var l=this,x=a.strings,T=x.VAR_FG_TRANSLATE_START,P=x.VAR_FG_TRANSLATE_END,f=a.cssClasses,d=f.FG_DEACTIVATION,R=f.FG_ACTIVATION,q=a.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal();var V="",G="";if(!this.adapter.isUnbounded()){var X=this.getFgTranslationCoordinates(),Me=X.startPoint,ke=X.endPoint;V=Me.x+"px, "+Me.y+"px",G=ke.x+"px, "+ke.y+"px"}this.adapter.updateCssVariable(T,V),this.adapter.updateCssVariable(P,G),clearTimeout(this.activationTimer),clearTimeout(this.fgDeactivationRemovalTimer),this.rmBoundedActivationClasses(),this.adapter.removeClass(d),this.adapter.computeBoundingRect(),this.adapter.addClass(R),this.activationTimer=setTimeout(function(){l.activationTimerCallback()},q)},a.prototype.getFgTranslationCoordinates=function(){var l=this.activationState,x=l.activationEvent,T=l.wasActivatedByPointer,P;T?P=fx(x,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):P={x:this.frame.width/2,y:this.frame.height/2},P={x:P.x-this.initialSize/2,y:P.y-this.initialSize/2};var f={x:this.frame.width/2-this.initialSize/2,y:this.frame.height/2-this.initialSize/2};return{startPoint:P,endPoint:f}},a.prototype.runDeactivationUXLogicIfReady=function(){var l=this,x=a.cssClasses.FG_DEACTIVATION,T=this.activationState,P=T.hasDeactivationUXRun,f=T.isActivated,d=P||!f;d&&this.activationAnimationHasEnded&&(this.rmBoundedActivationClasses(),this.adapter.addClass(x),this.fgDeactivationRemovalTimer=setTimeout(function(){l.adapter.removeClass(x)},s_.FG_DEACTIVATION_MS))},a.prototype.rmBoundedActivationClasses=function(){var l=a.cssClasses.FG_ACTIVATION;this.adapter.removeClass(l),this.activationAnimationHasEnded=!1,this.adapter.computeBoundingRect()},a.prototype.resetActivationState=function(){var l=this;this.previousActivationEvent=this.activationState.activationEvent,this.activationState=this.defaultActivationState(),setTimeout(function(){return l.previousActivationEvent=void 0},a.numbers.TAP_DELAY_MS)},a.prototype.deactivateImpl=function(){var l=this,x=this.activationState;if(!!x.isActivated){var T=La({},x);x.isProgrammatic?(requestAnimationFrame(function(){l.animateDeactivation(T)}),this.resetActivationState()):(this.deregisterDeactivationHandlers(),requestAnimationFrame(function(){l.activationState.hasDeactivationUXRun=!0,l.animateDeactivation(T),l.resetActivationState()}))}},a.prototype.animateDeactivation=function(l){var x=l.wasActivatedByPointer,T=l.wasElementMadeActive;(x||T)&&this.runDeactivationUXLogicIfReady()},a.prototype.layoutInternal=function(){var l=this;this.frame=this.adapter.computeBoundingRect();var x=Math.max(this.frame.height,this.frame.width),T=function(){var f=Math.sqrt(Math.pow(l.frame.width,2)+Math.pow(l.frame.height,2));return f+a.numbers.PADDING};this.maxRadius=this.adapter.isUnbounded()?x:T();var P=Math.floor(x*a.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&P%2!==0?this.initialSize=P-1:this.initialSize=P,this.fgScale=""+this.maxRadius/this.initialSize,this.updateLayoutCssVars()},a.prototype.updateLayoutCssVars=function(){var l=a.strings,x=l.VAR_FG_SIZE,T=l.VAR_LEFT,P=l.VAR_TOP,f=l.VAR_FG_SCALE;this.adapter.updateCssVariable(x,this.initialSize+"px"),this.adapter.updateCssVariable(f,this.fgScale),this.adapter.isUnbounded()&&(this.unboundedCoords={left:Math.round(this.frame.width/2-this.initialSize/2),top:Math.round(this.frame.height/2-this.initialSize/2)},this.adapter.updateCssVariable(T,this.unboundedCoords.left+"px"),this.adapter.updateCssVariable(P,this.unboundedCoords.top+"px"))},a}(Qh);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Xh={FIXED_CLASS:"mdc-top-app-bar--fixed",FIXED_SCROLLED_CLASS:"mdc-top-app-bar--fixed-scrolled",SHORT_CLASS:"mdc-top-app-bar--short",SHORT_COLLAPSED_CLASS:"mdc-top-app-bar--short-collapsed",SHORT_HAS_ACTION_ITEM_CLASS:"mdc-top-app-bar--short-has-action-item"},Bf={DEBOUNCE_THROTTLE_RESIZE_TIME_MS:100,MAX_TOP_APP_BAR_HEIGHT:128},yx={ACTION_ITEM_SELECTOR:".mdc-top-app-bar__action-item",NAVIGATION_EVENT:"MDCTopAppBar:nav",NAVIGATION_ICON_SELECTOR:".mdc-top-app-bar__navigation-icon",ROOT_SELECTOR:".mdc-top-app-bar",TITLE_SELECTOR:".mdc-top-app-bar__title"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Xy=function(c){vu(a,c);function a(l){return c.call(this,La(La({},a.defaultAdapter),l))||this}return Object.defineProperty(a,"strings",{get:function(){return yx},enumerable:!1,configurable:!0}),Object.defineProperty(a,"cssClasses",{get:function(){return Xh},enumerable:!1,configurable:!0}),Object.defineProperty(a,"numbers",{get:function(){return Bf},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},getTopAppBarHeight:function(){return 0},notifyNavigationIconClicked:function(){},getViewportScrollY:function(){return 0},getTotalActionItems:function(){return 0}}},enumerable:!1,configurable:!0}),a.prototype.handleTargetScroll=function(){},a.prototype.handleWindowResize=function(){},a.prototype.handleNavigationClick=function(){this.adapter.notifyNavigationIconClicked()},a}(Qh);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var kf=0,nv=function(c){vu(a,c);function a(l){var x=c.call(this,l)||this;return x.wasDocked=!0,x.isDockedShowing=!0,x.currentAppBarOffsetTop=0,x.isCurrentlyBeingResized=!1,x.resizeThrottleId=kf,x.resizeDebounceId=kf,x.lastScrollPosition=x.adapter.getViewportScrollY(),x.topAppBarHeight=x.adapter.getTopAppBarHeight(),x}return a.prototype.destroy=function(){c.prototype.destroy.call(this),this.adapter.setStyle("top","")},a.prototype.handleTargetScroll=function(){var l=Math.max(this.adapter.getViewportScrollY(),0),x=l-this.lastScrollPosition;this.lastScrollPosition=l,this.isCurrentlyBeingResized||(this.currentAppBarOffsetTop-=x,this.currentAppBarOffsetTop>0?this.currentAppBarOffsetTop=0:Math.abs(this.currentAppBarOffsetTop)>this.topAppBarHeight&&(this.currentAppBarOffsetTop=-this.topAppBarHeight),this.moveTopAppBar())},a.prototype.handleWindowResize=function(){var l=this;this.resizeThrottleId||(this.resizeThrottleId=setTimeout(function(){l.resizeThrottleId=kf,l.throttledResizeHandler()},Bf.DEBOUNCE_THROTTLE_RESIZE_TIME_MS)),this.isCurrentlyBeingResized=!0,this.resizeDebounceId&&clearTimeout(this.resizeDebounceId),this.resizeDebounceId=setTimeout(function(){l.handleTargetScroll(),l.isCurrentlyBeingResized=!1,l.resizeDebounceId=kf},Bf.DEBOUNCE_THROTTLE_RESIZE_TIME_MS)},a.prototype.checkForUpdate=function(){var l=-this.topAppBarHeight,x=this.currentAppBarOffsetTop<0,T=this.currentAppBarOffsetTop>l,P=x&&T;if(P)this.wasDocked=!1;else if(this.wasDocked){if(this.isDockedShowing!==T)return this.isDockedShowing=T,!0}else return this.wasDocked=!0,!0;return P},a.prototype.moveTopAppBar=function(){if(this.checkForUpdate()){var l=this.currentAppBarOffsetTop;Math.abs(l)>=this.topAppBarHeight&&(l=-Bf.MAX_TOP_APP_BAR_HEIGHT),this.adapter.setStyle("top",l+"px")}},a.prototype.throttledResizeHandler=function(){var l=this.adapter.getTopAppBarHeight();this.topAppBarHeight!==l&&(this.wasDocked=!1,this.currentAppBarOffsetTop-=this.topAppBarHeight-l,this.topAppBarHeight=l),this.handleTargetScroll()},a}(Xy);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var gx=function(c){vu(a,c);function a(){var l=c!==null&&c.apply(this,arguments)||this;return l.wasScrolled=!1,l}return a.prototype.handleTargetScroll=function(){var l=this.adapter.getViewportScrollY();l<=0?this.wasScrolled&&(this.adapter.removeClass(Xh.FIXED_SCROLLED_CLASS),this.wasScrolled=!1):this.wasScrolled||(this.adapter.addClass(Xh.FIXED_SCROLLED_CLASS),this.wasScrolled=!0)},a}(nv);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var _x=function(c){vu(a,c);function a(l){var x=c.call(this,l)||this;return x.collapsed=!1,x.isAlwaysCollapsed=!1,x}return Object.defineProperty(a.prototype,"isCollapsed",{get:function(){return this.collapsed},enumerable:!1,configurable:!0}),a.prototype.init=function(){c.prototype.init.call(this),this.adapter.getTotalActionItems()>0&&this.adapter.addClass(Xh.SHORT_HAS_ACTION_ITEM_CLASS),this.setAlwaysCollapsed(this.adapter.hasClass(Xh.SHORT_COLLAPSED_CLASS))},a.prototype.setAlwaysCollapsed=function(l){this.isAlwaysCollapsed=!!l,this.isAlwaysCollapsed?this.collapse():this.maybeCollapseBar()},a.prototype.getAlwaysCollapsed=function(){return this.isAlwaysCollapsed},a.prototype.handleTargetScroll=function(){this.maybeCollapseBar()},a.prototype.maybeCollapseBar=function(){if(!this.isAlwaysCollapsed){var l=this.adapter.getViewportScrollY();l<=0?this.collapsed&&this.uncollapse():this.collapsed||this.collapse()}},a.prototype.uncollapse=function(){this.adapter.removeClass(Xh.SHORT_COLLAPSED_CLASS),this.collapsed=!1},a.prototype.collapse=function(){this.adapter.addClass(Xh.SHORT_COLLAPSED_CLASS),this.collapsed=!0},a}(Xy);function Ao(c){return Object.entries(c).filter(([a,l])=>a!==""&&l).map(([a])=>a).join(" ")}function Us(c,a,l,x={bubbles:!0},T=!1){if(typeof Event!="undefined"&&c){const P=new CustomEvent(a,Object.assign(Object.assign({},x),{detail:l}));if(c==null||c.dispatchEvent(P),T&&a.startsWith("SMUI")){const f=new CustomEvent(a.replace(/^SMUI/g,()=>"MDC"),Object.assign(Object.assign({},x),{detail:l}));c==null||c.dispatchEvent(f),f.defaultPrevented&&P.preventDefault()}return P}}function Vf(c,a){let l=Object.getOwnPropertyNames(c);const x={};for(let T=0;T<l.length;T++){const P=l[T],f=P.indexOf("$");f!==-1&&a.indexOf(P.substring(0,f+1))!==-1||a.indexOf(P)===-1&&(x[P]=c[P])}return x}const c_=/^[a-z]+(?::(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/,vx=/^[^$]+(?:\$(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/;function No(c){let a,l=[];c.$on=(T,P)=>{let f=T,d=()=>{};return a?d=a(f,P):l.push([f,P]),f.match(c_)&&console&&console.warn('Event modifiers in SMUI now use "$" instead of ":", so that all events can be bound with modifiers. Please update your event binding: ',f),()=>{d()}};function x(T){Dy(c,T)}return T=>{const P=[],f={};a=(d,R)=>{let q=d,V=R,G=!1;const X=q.match(c_),Me=q.match(vx),ke=X||Me;if(q.match(/^SMUI:\w+:/)){const ft=q.split(":");let Ge="";for(let Ze=0;Ze<ft.length;Ze++)Ge+=Ze===ft.length-1?":"+ft[Ze]:ft[Ze].split("-").map(gt=>gt.slice(0,1).toUpperCase()+gt.slice(1)).join("");console.warn(`The event ${q.split("$")[0]} has been renamed to ${Ge.split("$")[0]}.`),q=Ge}if(ke){const ft=q.split(X?":":"$");q=ft[0];const Ge=Object.fromEntries(ft.slice(1).map(Ze=>[Ze,!0]));Ge.passive&&(G=G||{},G.passive=!0),Ge.nonpassive&&(G=G||{},G.passive=!1),Ge.capture&&(G=G||{},G.capture=!0),Ge.once&&(G=G||{},G.once=!0),Ge.preventDefault&&(V=$0(V)),Ge.stopPropagation&&(V=Q0(V))}const qe=ll(T,q,V,G),We=()=>{qe();const ft=P.indexOf(We);ft>-1&&P.splice(ft,1)};return P.push(We),q in f||(f[q]=ll(T,q,x)),We};for(let d=0;d<l.length;d++)a(l[d][0],l[d][1]);return{destroy:()=>{for(let d=0;d<P.length;d++)P[d]();for(let d of Object.entries(f))d[1]()}}}}function qf(c,a){let l=Object.getOwnPropertyNames(c);const x={};for(let T=0;T<l.length;T++){const P=l[T];P.substring(0,a.length)===a&&(x[P.substring(a.length)]=c[P])}return x}function Ia(c,a){let l=[];if(a)for(let x=0;x<a.length;x++){const T=a[x],P=Array.isArray(T)?T[0]:T;Array.isArray(T)&&T.length>1?l.push(P(c,T[1])):l.push(P(c))}return{update(x){if((x&&x.length||0)!=l.length)throw new Error("You must not change the length of an actions array.");if(x)for(let T=0;T<x.length;T++){const P=l[T];if(P&&P.update){const f=x[T];Array.isArray(f)&&f.length>1?P.update(f[1]):P.update()}}},destroy(){for(let x=0;x<l.length;x++){const T=l[x];T&&T.destroy&&T.destroy()}}}}const{window:h_}=ex;function xx(c){let a,l,x,T,P,f,d;const R=c[22].default,q=Co(R,c,c[21],null);let V=[{class:l=Ao(sl({[c[2]]:!0,"mdc-top-app-bar":!0,"mdc-top-app-bar--short":c[4]==="short","mdc-top-app-bar--short-collapsed":c[0],"mdc-top-app-bar--fixed":c[4]==="fixed","smui-top-app-bar--static":c[4]==="static","smui-top-app-bar--color-secondary":c[5]==="secondary","mdc-top-app-bar--prominent":c[6],"mdc-top-app-bar--dense":c[7]},c[11]))},{style:x=Object.entries(c[12]).map(p_).concat([c[3]]).join(" ")},c[15]],G={};for(let X=0;X<V.length;X+=1)G=Ci(G,V[X]);return{c(){a=Tr("header"),q&&q.c(),this.h()},l(X){a=Ar(X,"HEADER",{class:!0,style:!0});var Me=Zr(a);q&&q.l(Me),Me.forEach(Zt),this.h()},h(){Hr(a,G)},m(X,Me){Fi(X,a,Me),q&&q.m(a,null),c[25](a),P=!0,f||(d=[ll(h_,"resize",c[23]),ll(h_,"scroll",c[24]),Jr(T=Ia.call(null,a,c[1])),Jr(c[13].call(null,a)),ll(a,"SMUITopAppBarIconButton:nav",c[26])],f=!0)},p(X,Me){q&&q.p&&(!P||Me[0]&2097152)&&ko(q,R,X,X[21],P?Po(R,X[21],Me,null):zo(X[21]),null),Hr(a,G=go(V,[(!P||Me[0]&2293&&l!==(l=Ao(sl({[X[2]]:!0,"mdc-top-app-bar":!0,"mdc-top-app-bar--short":X[4]==="short","mdc-top-app-bar--short-collapsed":X[0],"mdc-top-app-bar--fixed":X[4]==="fixed","smui-top-app-bar--static":X[4]==="static","smui-top-app-bar--color-secondary":X[5]==="secondary","mdc-top-app-bar--prominent":X[6],"mdc-top-app-bar--dense":X[7]},X[11]))))&&{class:l},(!P||Me[0]&4104&&x!==(x=Object.entries(X[12]).map(p_).concat([X[3]]).join(" ")))&&{style:x},Me[0]&32768&&X[15]])),T&&ha(T.update)&&Me[0]&2&&T.update.call(null,X[1])},i(X){P||(Mi(q,X),P=!0)},o(X){Ui(q,X),P=!1},d(X){X&&Zt(a),q&&q.d(X),c[25](null),f=!1,Ya(d)}}}const p_=([c,a])=>`${c}: ${a};`;function bx(c,a,l){const x=["use","class","style","variant","color","collapsed","prominent","dense","scrollTarget","getPropStore","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a;const d=No(Fo());let R=()=>{};function q(Nt){return Nt===R}let{use:V=[]}=a,{class:G=""}=a,{style:X=""}=a,{variant:Me="standard"}=a,{color:ke="primary"}=a,{collapsed:qe=R}=a;const We=!q(qe)&&!!qe;q(qe)&&(qe=!1);let{prominent:ft=!1}=a,{dense:Ge=!1}=a,{scrollTarget:Ze=void 0}=a,gt,ct,pt={},lt={},pi,Et=ox({variant:Me,prominent:ft,dense:Ge},Nt=>{l(18,pi=Nt)}),Wt,vi=Me;yh(()=>(l(9,ct=qi()),ct.init(),()=>{ct.destroy()}));function qi(){const Nt={static:Xy,short:_x,fixed:gx}[Me]||nv;return new Nt({hasClass:Xt,addClass:Qt,removeClass:Ei,setStyle:bt,getTopAppBarHeight:()=>gt.clientHeight,notifyNavigationIconClicked:()=>Us(gt,"SMUITopAppBar:nav",void 0,void 0,!0),getViewportScrollY:()=>Ze==null?window.pageYOffset:Ze.scrollTop,getTotalActionItems:()=>gt.querySelectorAll(".mdc-top-app-bar__action-item").length})}function Xt(Nt){return Nt in pt?pt[Nt]:wr().classList.contains(Nt)}function Qt(Nt){pt[Nt]||l(11,pt[Nt]=!0,pt)}function Ei(Nt){(!(Nt in pt)||pt[Nt])&&l(11,pt[Nt]=!1,pt)}function bt(Nt,Xi){lt[Nt]!=Xi&&(Xi===""||Xi==null?(delete lt[Nt],l(12,lt),l(20,vi),l(4,Me),l(9,ct)):l(12,lt[Nt]=Xi,lt))}function Gi(){ct&&(ct.handleTargetScroll(),Me==="short"&&l(0,qe="isCollapsed"in ct&&ct.isCollapsed))}function hr(){return Et}function wr(){return gt}const Dt=()=>Me!=="short"&&Me!=="fixed"&&ct&&ct.handleWindowResize(),oi=()=>Ze==null&&Gi();function fi(Nt){_n[Nt?"unshift":"push"](()=>{gt=Nt,l(10,gt)})}const Bi=()=>ct&&ct.handleNavigationClick();return c.$$set=Nt=>{a=Ci(Ci({},a),Uo(Nt)),l(15,T=br(a,x)),"use"in Nt&&l(1,V=Nt.use),"class"in Nt&&l(2,G=Nt.class),"style"in Nt&&l(3,X=Nt.style),"variant"in Nt&&l(4,Me=Nt.variant),"color"in Nt&&l(5,ke=Nt.color),"collapsed"in Nt&&l(0,qe=Nt.collapsed),"prominent"in Nt&&l(6,ft=Nt.prominent),"dense"in Nt&&l(7,Ge=Nt.dense),"scrollTarget"in Nt&&l(8,Ze=Nt.scrollTarget),"$$scope"in Nt&&l(21,f=Nt.$$scope)},c.$$.update=()=>{c.$$.dirty[0]&262352&&pi&&pi({variant:Me,prominent:ft,dense:Ge}),c.$$.dirty[0]&1049104&&vi!==Me&&ct&&(l(20,vi=Me),ct.destroy(),l(11,pt={}),l(12,lt={}),l(9,ct=qi()),ct.init()),c.$$.dirty[0]&528&&ct&&Me==="short"&&"setAlwaysCollapsed"in ct&&ct.setAlwaysCollapsed(We),c.$$.dirty[0]&524544&&Wt!==Ze&&(Wt&&Wt.removeEventListener("scroll",Gi),Ze&&Ze.addEventListener("scroll",Gi),l(19,Wt=Ze))},[qe,V,G,X,Me,ke,ft,Ge,Ze,ct,gt,pt,lt,d,Gi,T,hr,wr,pi,Wt,vi,f,P,Dt,oi,fi,Bi]}class wx extends Rn{constructor(a){super(),Bn(this,a,bx,xx,On,{use:1,class:2,style:3,variant:4,color:5,collapsed:0,prominent:6,dense:7,scrollTarget:8,getPropStore:16,getElement:17},null,[-1,-1])}get getPropStore(){return this.$$.ctx[16]}get getElement(){return this.$$.ctx[17]}}function Ex(c){let a,l,x,T,P;const f=c[6].default,d=Co(f,c,c[5],null);let R=[c[3]],q={};for(let V=0;V<R.length;V+=1)q=Ci(q,R[V]);return{c(){a=Tr("div"),d&&d.c(),this.h()},l(V){a=Ar(V,"DIV",{});var G=Zr(a);d&&d.l(G),G.forEach(Zt),this.h()},h(){Hr(a,q)},m(V,G){Fi(V,a,G),d&&d.m(a,null),c[7](a),x=!0,T||(P=[Jr(l=Ia.call(null,a,c[0])),Jr(c[2].call(null,a))],T=!0)},p(V,[G]){d&&d.p&&(!x||G&32)&&ko(d,f,V,V[5],x?Po(f,V[5],G,null):zo(V[5]),null),Hr(a,q=go(R,[G&8&&V[3]])),l&&ha(l.update)&&G&1&&l.update.call(null,V[0])},i(V){x||(Mi(d,V),x=!0)},o(V){Ui(d,V),x=!1},d(V){V&&Zt(a),d&&d.d(V),c[7](null),T=!1,Ya(P)}}}function Ix(c,a,l){const x=["use","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a,{use:d=[]}=a;const R=No(Fo());let q;function V(){return q}function G(X){_n[X?"unshift":"push"](()=>{q=X,l(1,q)})}return c.$$set=X=>{a=Ci(Ci({},a),Uo(X)),l(3,T=br(a,x)),"use"in X&&l(0,d=X.use),"$$scope"in X&&l(5,f=X.$$scope)},[d,q,R,T,V,f,P,G]}class ov extends Rn{constructor(a){super(),Bn(this,a,Ix,Ex,On,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function Sx(c){let a;const l=c[10].default,x=Co(l,c,c[12],null);return{c(){x&&x.c()},l(T){x&&x.l(T)},m(T,P){x&&x.m(T,P),a=!0},p(T,P){x&&x.p&&(!a||P&4096)&&ko(x,l,T,T[12],a?Po(l,T[12],P,null):zo(T[12]),null)},i(T){a||(Mi(x,T),a=!0)},o(T){Ui(x,T),a=!1},d(T){x&&x.d(T)}}}function Tx(c){let a,l,x;const T=[{use:[c[7],...c[0]]},{class:Ao(sl({[c[1]]:!0,[c[5]]:!0},c[4]))},c[6],c[8]];var P=c[2];function f(d){let R={$$slots:{default:[Sx]},$$scope:{ctx:d}};for(let q=0;q<T.length;q+=1)R=Ci(R,T[q]);return{props:R}}return P&&(a=new P(f(c)),c[11](a)),{c(){a&&en(a.$$.fragment),l=Qo()},l(d){a&&In(a.$$.fragment,d),l=Qo()},m(d,R){a&&tn(a,d,R),Fi(d,l,R),x=!0},p(d,[R]){const q=R&499?go(T,[R&129&&{use:[d[7],...d[0]]},R&50&&{class:Ao(sl({[d[1]]:!0,[d[5]]:!0},d[4]))},R&64&&Fs(d[6]),R&256&&Fs(d[8])]):{};if(R&4096&&(q.$$scope={dirty:R,ctx:d}),P!==(P=d[2])){if(a){$h();const V=a;Ui(V.$$.fragment,1,0,()=>{rn(V,1)}),Yh()}P?(a=new P(f(d)),d[11](a),en(a.$$.fragment),Mi(a.$$.fragment,1),tn(a,l.parentNode,l)):a=null}else P&&a.$set(q)},i(d){x||(a&&Mi(a.$$.fragment,d),x=!0)},o(d){a&&Ui(a.$$.fragment,d),x=!1},d(d){c[11](null),d&&Zt(l),a&&rn(a,d)}}}const ch={component:ov,class:"",classMap:{},contexts:{},props:{}};function Ax(c,a,l){const x=["use","class","component","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a,{use:d=[]}=a,{class:R=""}=a,q;const V=ch.class,G={},X=[],Me=ch.contexts,ke=ch.props;let{component:qe=ch.component}=a;Object.entries(ch.classMap).forEach(([Ze,gt])=>{const ct=gs(gt);ct&&"subscribe"in ct&&X.push(ct.subscribe(pt=>{l(4,G[Ze]=pt,G)}))});const We=No(Fo());for(let Ze in Me)Me.hasOwnProperty(Ze)&&Ea(Ze,Me[Ze]);Ud(()=>{for(const Ze of X)Ze()});function ft(){return q.getElement()}function Ge(Ze){_n[Ze?"unshift":"push"](()=>{q=Ze,l(3,q)})}return c.$$set=Ze=>{a=Ci(Ci({},a),Uo(Ze)),l(8,T=br(a,x)),"use"in Ze&&l(0,d=Ze.use),"class"in Ze&&l(1,R=Ze.class),"component"in Ze&&l(2,qe=Ze.component),"$$scope"in Ze&&l(12,f=Ze.$$scope)},[d,R,qe,q,G,V,ke,We,T,ft,P,Ge,f]}class Cx extends Rn{constructor(a){super(),Bn(this,a,Ax,Tx,On,{use:0,class:1,component:2,getElement:9})}get getElement(){return this.$$.ctx[9]}}const d_=Object.assign({},ch);function hl(c){return new Proxy(Cx,{construct:function(a,l){return Object.assign(ch,d_,c),new a(...l)},get:function(a,l){return Object.assign(ch,d_,c),a[l]}})}function kx(c){let a,l,x,T,P;const f=c[7].default,d=Co(f,c,c[6],null);let R=[{href:c[1]},c[4]],q={};for(let V=0;V<R.length;V+=1)q=Ci(q,R[V]);return{c(){a=Tr("a"),d&&d.c(),this.h()},l(V){a=Ar(V,"A",{href:!0});var G=Zr(a);d&&d.l(G),G.forEach(Zt),this.h()},h(){Hr(a,q)},m(V,G){Fi(V,a,G),d&&d.m(a,null),c[8](a),x=!0,T||(P=[Jr(l=Ia.call(null,a,c[0])),Jr(c[3].call(null,a))],T=!0)},p(V,[G]){d&&d.p&&(!x||G&64)&&ko(d,f,V,V[6],x?Po(f,V[6],G,null):zo(V[6]),null),Hr(a,q=go(R,[(!x||G&2)&&{href:V[1]},G&16&&V[4]])),l&&ha(l.update)&&G&1&&l.update.call(null,V[0])},i(V){x||(Mi(d,V),x=!0)},o(V){Ui(d,V),x=!1},d(V){V&&Zt(a),d&&d.d(V),c[8](null),T=!1,Ya(P)}}}function zx(c,a,l){const x=["use","href","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a,{use:d=[]}=a,{href:R="javascript:void(0);"}=a;const q=No(Fo());let V;function G(){return V}function X(Me){_n[Me?"unshift":"push"](()=>{V=Me,l(2,V)})}return c.$$set=Me=>{a=Ci(Ci({},a),Uo(Me)),l(4,T=br(a,x)),"use"in Me&&l(0,d=Me.use),"href"in Me&&l(1,R=Me.href),"$$scope"in Me&&l(6,f=Me.$$scope)},[d,R,V,q,T,G,f,P,X]}class Px extends Rn{constructor(a){super(),Bn(this,a,zx,kx,On,{use:0,href:1,getElement:5})}get getElement(){return this.$$.ctx[5]}}function Mx(c){let a,l,x,T,P;const f=c[6].default,d=Co(f,c,c[5],null);let R=[c[3]],q={};for(let V=0;V<R.length;V+=1)q=Ci(q,R[V]);return{c(){a=Tr("button"),d&&d.c(),this.h()},l(V){a=Ar(V,"BUTTON",{});var G=Zr(a);d&&d.l(G),G.forEach(Zt),this.h()},h(){Hr(a,q)},m(V,G){Fi(V,a,G),d&&d.m(a,null),a.autofocus&&a.focus(),c[7](a),x=!0,T||(P=[Jr(l=Ia.call(null,a,c[0])),Jr(c[2].call(null,a))],T=!0)},p(V,[G]){d&&d.p&&(!x||G&32)&&ko(d,f,V,V[5],x?Po(f,V[5],G,null):zo(V[5]),null),Hr(a,q=go(R,[G&8&&V[3]])),l&&ha(l.update)&&G&1&&l.update.call(null,V[0])},i(V){x||(Mi(d,V),x=!0)},o(V){Ui(d,V),x=!1},d(V){V&&Zt(a),d&&d.d(V),c[7](null),T=!1,Ya(P)}}}function Lx(c,a,l){const x=["use","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a,{use:d=[]}=a;const R=No(Fo());let q;function V(){return q}function G(X){_n[X?"unshift":"push"](()=>{q=X,l(1,q)})}return c.$$set=X=>{a=Ci(Ci({},a),Uo(X)),l(3,T=br(a,x)),"use"in X&&l(0,d=X.use),"$$scope"in X&&l(5,f=X.$$scope)},[d,q,R,T,V,f,P,G]}class Dx extends Rn{constructor(a){super(),Bn(this,a,Lx,Mx,On,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function Rx(c){let a,l,x,T,P;const f=c[6].default,d=Co(f,c,c[5],null);let R=[c[3]],q={};for(let V=0;V<R.length;V+=1)q=Ci(q,R[V]);return{c(){a=Tr("h1"),d&&d.c(),this.h()},l(V){a=Ar(V,"H1",{});var G=Zr(a);d&&d.l(G),G.forEach(Zt),this.h()},h(){Hr(a,q)},m(V,G){Fi(V,a,G),d&&d.m(a,null),c[7](a),x=!0,T||(P=[Jr(l=Ia.call(null,a,c[0])),Jr(c[2].call(null,a))],T=!0)},p(V,[G]){d&&d.p&&(!x||G&32)&&ko(d,f,V,V[5],x?Po(f,V[5],G,null):zo(V[5]),null),Hr(a,q=go(R,[G&8&&V[3]])),l&&ha(l.update)&&G&1&&l.update.call(null,V[0])},i(V){x||(Mi(d,V),x=!0)},o(V){Ui(d,V),x=!1},d(V){V&&Zt(a),d&&d.d(V),c[7](null),T=!1,Ya(P)}}}function Bx(c,a,l){const x=["use","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a,{use:d=[]}=a;const R=No(Fo());let q;function V(){return q}function G(X){_n[X?"unshift":"push"](()=>{q=X,l(1,q)})}return c.$$set=X=>{a=Ci(Ci({},a),Uo(X)),l(3,T=br(a,x)),"use"in X&&l(0,d=X.use),"$$scope"in X&&l(5,f=X.$$scope)},[d,q,R,T,V,f,P,G]}class Ox extends Rn{constructor(a){super(),Bn(this,a,Bx,Rx,On,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function Fx(c){let a,l,x,T,P;const f=c[6].default,d=Co(f,c,c[5],null);let R=[c[3]],q={};for(let V=0;V<R.length;V+=1)q=Ci(q,R[V]);return{c(){a=Tr("h2"),d&&d.c(),this.h()},l(V){a=Ar(V,"H2",{});var G=Zr(a);d&&d.l(G),G.forEach(Zt),this.h()},h(){Hr(a,q)},m(V,G){Fi(V,a,G),d&&d.m(a,null),c[7](a),x=!0,T||(P=[Jr(l=Ia.call(null,a,c[0])),Jr(c[2].call(null,a))],T=!0)},p(V,[G]){d&&d.p&&(!x||G&32)&&ko(d,f,V,V[5],x?Po(f,V[5],G,null):zo(V[5]),null),Hr(a,q=go(R,[G&8&&V[3]])),l&&ha(l.update)&&G&1&&l.update.call(null,V[0])},i(V){x||(Mi(d,V),x=!0)},o(V){Ui(d,V),x=!1},d(V){V&&Zt(a),d&&d.d(V),c[7](null),T=!1,Ya(P)}}}function Ux(c,a,l){const x=["use","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a,{use:d=[]}=a;const R=No(Fo());let q;function V(){return q}function G(X){_n[X?"unshift":"push"](()=>{q=X,l(1,q)})}return c.$$set=X=>{a=Ci(Ci({},a),Uo(X)),l(3,T=br(a,x)),"use"in X&&l(0,d=X.use),"$$scope"in X&&l(5,f=X.$$scope)},[d,q,R,T,V,f,P,G]}class Nx extends Rn{constructor(a){super(),Bn(this,a,Ux,Fx,On,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function jx(c){let a,l,x,T,P;const f=c[6].default,d=Co(f,c,c[5],null);let R=[c[3]],q={};for(let V=0;V<R.length;V+=1)q=Ci(q,R[V]);return{c(){a=Tr("h3"),d&&d.c(),this.h()},l(V){a=Ar(V,"H3",{});var G=Zr(a);d&&d.l(G),G.forEach(Zt),this.h()},h(){Hr(a,q)},m(V,G){Fi(V,a,G),d&&d.m(a,null),c[7](a),x=!0,T||(P=[Jr(l=Ia.call(null,a,c[0])),Jr(c[2].call(null,a))],T=!0)},p(V,[G]){d&&d.p&&(!x||G&32)&&ko(d,f,V,V[5],x?Po(f,V[5],G,null):zo(V[5]),null),Hr(a,q=go(R,[G&8&&V[3]])),l&&ha(l.update)&&G&1&&l.update.call(null,V[0])},i(V){x||(Mi(d,V),x=!0)},o(V){Ui(d,V),x=!1},d(V){V&&Zt(a),d&&d.d(V),c[7](null),T=!1,Ya(P)}}}function Vx(c,a,l){const x=["use","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a,{use:d=[]}=a;const R=No(Fo());let q;function V(){return q}function G(X){_n[X?"unshift":"push"](()=>{q=X,l(1,q)})}return c.$$set=X=>{a=Ci(Ci({},a),Uo(X)),l(3,T=br(a,x)),"use"in X&&l(0,d=X.use),"$$scope"in X&&l(5,f=X.$$scope)},[d,q,R,T,V,f,P,G]}class qx extends Rn{constructor(a){super(),Bn(this,a,Vx,jx,On,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function Gx(c){let a,l,x,T,P;const f=c[6].default,d=Co(f,c,c[5],null);let R=[c[3]],q={};for(let V=0;V<R.length;V+=1)q=Ci(q,R[V]);return{c(){a=Tr("li"),d&&d.c(),this.h()},l(V){a=Ar(V,"LI",{});var G=Zr(a);d&&d.l(G),G.forEach(Zt),this.h()},h(){Hr(a,q)},m(V,G){Fi(V,a,G),d&&d.m(a,null),c[7](a),x=!0,T||(P=[Jr(l=Ia.call(null,a,c[0])),Jr(c[2].call(null,a))],T=!0)},p(V,[G]){d&&d.p&&(!x||G&32)&&ko(d,f,V,V[5],x?Po(f,V[5],G,null):zo(V[5]),null),Hr(a,q=go(R,[G&8&&V[3]])),l&&ha(l.update)&&G&1&&l.update.call(null,V[0])},i(V){x||(Mi(d,V),x=!0)},o(V){Ui(d,V),x=!1},d(V){V&&Zt(a),d&&d.d(V),c[7](null),T=!1,Ya(P)}}}function Zx(c,a,l){const x=["use","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a,{use:d=[]}=a;const R=No(Fo());let q;function V(){return q}function G(X){_n[X?"unshift":"push"](()=>{q=X,l(1,q)})}return c.$$set=X=>{a=Ci(Ci({},a),Uo(X)),l(3,T=br(a,x)),"use"in X&&l(0,d=X.use),"$$scope"in X&&l(5,f=X.$$scope)},[d,q,R,T,V,f,P,G]}class Hx extends Rn{constructor(a){super(),Bn(this,a,Zx,Gx,On,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function Wx(c){let a,l,x,T,P;const f=c[6].default,d=Co(f,c,c[5],null);let R=[c[3]],q={};for(let V=0;V<R.length;V+=1)q=Ci(q,R[V]);return{c(){a=Tr("main"),d&&d.c(),this.h()},l(V){a=Ar(V,"MAIN",{});var G=Zr(a);d&&d.l(G),G.forEach(Zt),this.h()},h(){Hr(a,q)},m(V,G){Fi(V,a,G),d&&d.m(a,null),c[7](a),x=!0,T||(P=[Jr(l=Ia.call(null,a,c[0])),Jr(c[2].call(null,a))],T=!0)},p(V,[G]){d&&d.p&&(!x||G&32)&&ko(d,f,V,V[5],x?Po(f,V[5],G,null):zo(V[5]),null),Hr(a,q=go(R,[G&8&&V[3]])),l&&ha(l.update)&&G&1&&l.update.call(null,V[0])},i(V){x||(Mi(d,V),x=!0)},o(V){Ui(d,V),x=!1},d(V){V&&Zt(a),d&&d.d(V),c[7](null),T=!1,Ya(P)}}}function Xx(c,a,l){const x=["use","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a,{use:d=[]}=a;const R=No(Fo());let q;function V(){return q}function G(X){_n[X?"unshift":"push"](()=>{q=X,l(1,q)})}return c.$$set=X=>{a=Ci(Ci({},a),Uo(X)),l(3,T=br(a,x)),"use"in X&&l(0,d=X.use),"$$scope"in X&&l(5,f=X.$$scope)},[d,q,R,T,V,f,P,G]}class Kx extends Rn{constructor(a){super(),Bn(this,a,Xx,Wx,On,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function Jx(c){let a,l,x,T,P;const f=c[6].default,d=Co(f,c,c[5],null);let R=[c[3]],q={};for(let V=0;V<R.length;V+=1)q=Ci(q,R[V]);return{c(){a=Tr("nav"),d&&d.c(),this.h()},l(V){a=Ar(V,"NAV",{});var G=Zr(a);d&&d.l(G),G.forEach(Zt),this.h()},h(){Hr(a,q)},m(V,G){Fi(V,a,G),d&&d.m(a,null),c[7](a),x=!0,T||(P=[Jr(l=Ia.call(null,a,c[0])),Jr(c[2].call(null,a))],T=!0)},p(V,[G]){d&&d.p&&(!x||G&32)&&ko(d,f,V,V[5],x?Po(f,V[5],G,null):zo(V[5]),null),Hr(a,q=go(R,[G&8&&V[3]])),l&&ha(l.update)&&G&1&&l.update.call(null,V[0])},i(V){x||(Mi(d,V),x=!0)},o(V){Ui(d,V),x=!1},d(V){V&&Zt(a),d&&d.d(V),c[7](null),T=!1,Ya(P)}}}function Yx(c,a,l){const x=["use","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a,{use:d=[]}=a;const R=No(Fo());let q;function V(){return q}function G(X){_n[X?"unshift":"push"](()=>{q=X,l(1,q)})}return c.$$set=X=>{a=Ci(Ci({},a),Uo(X)),l(3,T=br(a,x)),"use"in X&&l(0,d=X.use),"$$scope"in X&&l(5,f=X.$$scope)},[d,q,R,T,V,f,P,G]}class $x extends Rn{constructor(a){super(),Bn(this,a,Yx,Jx,On,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function Qx(c){let a,l,x,T,P;const f=c[6].default,d=Co(f,c,c[5],null);let R=[c[3]],q={};for(let V=0;V<R.length;V+=1)q=Ci(q,R[V]);return{c(){a=Tr("span"),d&&d.c(),this.h()},l(V){a=Ar(V,"SPAN",{});var G=Zr(a);d&&d.l(G),G.forEach(Zt),this.h()},h(){Hr(a,q)},m(V,G){Fi(V,a,G),d&&d.m(a,null),c[7](a),x=!0,T||(P=[Jr(l=Ia.call(null,a,c[0])),Jr(c[2].call(null,a))],T=!0)},p(V,[G]){d&&d.p&&(!x||G&32)&&ko(d,f,V,V[5],x?Po(f,V[5],G,null):zo(V[5]),null),Hr(a,q=go(R,[G&8&&V[3]])),l&&ha(l.update)&&G&1&&l.update.call(null,V[0])},i(V){x||(Mi(d,V),x=!0)},o(V){Ui(d,V),x=!1},d(V){V&&Zt(a),d&&d.d(V),c[7](null),T=!1,Ya(P)}}}function e1(c,a,l){const x=["use","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a,{use:d=[]}=a;const R=No(Fo());let q;function V(){return q}function G(X){_n[X?"unshift":"push"](()=>{q=X,l(1,q)})}return c.$$set=X=>{a=Ci(Ci({},a),Uo(X)),l(3,T=br(a,x)),"use"in X&&l(0,d=X.use),"$$scope"in X&&l(5,f=X.$$scope)},[d,q,R,T,V,f,P,G]}class t1 extends Rn{constructor(a){super(),Bn(this,a,e1,Qx,On,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function i1(c){let a,l,x,T,P;const f=c[6].default,d=Co(f,c,c[5],null);let R=[c[3]],q={};for(let V=0;V<R.length;V+=1)q=Ci(q,R[V]);return{c(){a=Tr("ul"),d&&d.c(),this.h()},l(V){a=Ar(V,"UL",{});var G=Zr(a);d&&d.l(G),G.forEach(Zt),this.h()},h(){Hr(a,q)},m(V,G){Fi(V,a,G),d&&d.m(a,null),c[7](a),x=!0,T||(P=[Jr(l=Ia.call(null,a,c[0])),Jr(c[2].call(null,a))],T=!0)},p(V,[G]){d&&d.p&&(!x||G&32)&&ko(d,f,V,V[5],x?Po(f,V[5],G,null):zo(V[5]),null),Hr(a,q=go(R,[G&8&&V[3]])),l&&ha(l.update)&&G&1&&l.update.call(null,V[0])},i(V){x||(Mi(d,V),x=!0)},o(V){Ui(d,V),x=!1},d(V){V&&Zt(a),d&&d.d(V),c[7](null),T=!1,Ya(P)}}}function r1(c,a,l){const x=["use","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a,{use:d=[]}=a;const R=No(Fo());let q;function V(){return q}function G(X){_n[X?"unshift":"push"](()=>{q=X,l(1,q)})}return c.$$set=X=>{a=Ci(Ci({},a),Uo(X)),l(3,T=br(a,x)),"use"in X&&l(0,d=X.use),"$$scope"in X&&l(5,f=X.$$scope)},[d,q,R,T,V,f,P,G]}class n1 extends Rn{constructor(a){super(),Bn(this,a,r1,i1,On,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}const av=Px,o1=Dx,Nd=ov,a1=Ox,s1=Nx,l1=qx,u1=Hx,c1=Kx,h1=$x,Vp=t1,p1=n1;var d1=hl({class:"mdc-top-app-bar__row",component:Nd});function f1(c){let a,l,x,T,P,f;const d=c[9].default,R=Co(d,c,c[8],null);let q=[{class:l=Ao({[c[1]]:!0,"mdc-top-app-bar__section":!0,"mdc-top-app-bar__section--align-start":c[2]==="start","mdc-top-app-bar__section--align-end":c[2]==="end"})},c[3]?{role:"toolbar"}:{},c[6]],V={};for(let G=0;G<q.length;G+=1)V=Ci(V,q[G]);return{c(){a=Tr("section"),R&&R.c(),this.h()},l(G){a=Ar(G,"SECTION",{class:!0});var X=Zr(a);R&&R.l(X),X.forEach(Zt),this.h()},h(){Hr(a,V)},m(G,X){Fi(G,a,X),R&&R.m(a,null),c[10](a),T=!0,P||(f=[Jr(x=Ia.call(null,a,c[0])),Jr(c[5].call(null,a))],P=!0)},p(G,[X]){R&&R.p&&(!T||X&256)&&ko(R,d,G,G[8],T?Po(d,G[8],X,null):zo(G[8]),null),Hr(a,V=go(q,[(!T||X&6&&l!==(l=Ao({[G[1]]:!0,"mdc-top-app-bar__section":!0,"mdc-top-app-bar__section--align-start":G[2]==="start","mdc-top-app-bar__section--align-end":G[2]==="end"})))&&{class:l},X&8&&(G[3]?{role:"toolbar"}:{}),X&64&&G[6]])),x&&ha(x.update)&&X&1&&x.update.call(null,G[0])},i(G){T||(Mi(R,G),T=!0)},o(G){Ui(R,G),T=!1},d(G){G&&Zt(a),R&&R.d(G),c[10](null),P=!1,Ya(f)}}}function m1(c,a,l){const x=["use","class","align","toolbar","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a;const d=No(Fo());let{use:R=[]}=a,{class:q=""}=a,{align:V="start"}=a,{toolbar:G=!1}=a,X;Ea("SMUI:icon-button:context",G?"top-app-bar:action":"top-app-bar:navigation"),Ea("SMUI:button:context",G?"top-app-bar:action":"top-app-bar:navigation");function Me(){return X}function ke(qe){_n[qe?"unshift":"push"](()=>{X=qe,l(4,X)})}return c.$$set=qe=>{a=Ci(Ci({},a),Uo(qe)),l(6,T=br(a,x)),"use"in qe&&l(0,R=qe.use),"class"in qe&&l(1,q=qe.class),"align"in qe&&l(2,V=qe.align),"toolbar"in qe&&l(3,G=qe.toolbar),"$$scope"in qe&&l(8,f=qe.$$scope)},[R,q,V,G,X,d,T,Me,f,P,ke]}class y1 extends Rn{constructor(a){super(),Bn(this,a,m1,f1,On,{use:0,class:1,align:2,toolbar:3,getElement:7})}get getElement(){return this.$$.ctx[7]}}var g1=hl({class:"mdc-top-app-bar__title",component:Vp});function _1(c){let a;const l=c[11].default,x=Co(l,c,c[13],null);return{c(){x&&x.c()},l(T){x&&x.l(T)},m(T,P){x&&x.m(T,P),a=!0},p(T,P){x&&x.p&&(!a||P&8192)&&ko(x,l,T,T[13],a?Po(l,T[13],P,null):zo(T[13]),null)},i(T){a||(Mi(x,T),a=!0)},o(T){Ui(x,T),a=!1},d(T){x&&x.d(T)}}}function v1(c){let a,l,x;const T=[{use:[c[6],...c[0]]},{class:Ao({[c[1]]:!0,[c[5]]:!0})},c[7]];var P=c[2];function f(d){let R={$$slots:{default:[_1]},$$scope:{ctx:d}};for(let q=0;q<T.length;q+=1)R=Ci(R,T[q]);return{props:R}}return P&&(a=new P(f(c)),c[12](a)),{c(){a&&en(a.$$.fragment),l=Qo()},l(d){a&&In(a.$$.fragment,d),l=Qo()},m(d,R){a&&tn(a,d,R),Fi(d,l,R),x=!0},p(d,[R]){const q=R&227?go(T,[R&65&&{use:[d[6],...d[0]]},R&34&&{class:Ao({[d[1]]:!0,[d[5]]:!0})},R&128&&Fs(d[7])]):{};if(R&8192&&(q.$$scope={dirty:R,ctx:d}),P!==(P=d[2])){if(a){$h();const V=a;Ui(V.$$.fragment,1,0,()=>{rn(V,1)}),Yh()}P?(a=new P(f(d)),d[12](a),en(a.$$.fragment),Mi(a.$$.fragment,1),tn(a,l.parentNode,l)):a=null}else P&&a.$set(q)},i(d){x||(a&&Mi(a.$$.fragment,d),x=!0)},o(d){a&&Ui(a.$$.fragment,d),x=!1},d(d){c[12](null),d&&Zt(l),a&&rn(a,d)}}}function x1(c,a,l){let x,T;const P=["use","class","topAppBar","component","getElement"];let f=br(a,P),d,R=cl,q=()=>(R(),R=tx(x,gt=>l(10,d=gt)),x);c.$$.on_destroy.push(()=>R());let{$$slots:V={},$$scope:G}=a;const X=No(Fo());let{use:Me=[]}=a,{class:ke=""}=a,{topAppBar:qe}=a,We,{component:ft=c1}=a;function Ge(){return We.getElement()}function Ze(gt){_n[gt?"unshift":"push"](()=>{We=gt,l(4,We)})}return c.$$set=gt=>{a=Ci(Ci({},a),Uo(gt)),l(7,f=br(a,P)),"use"in gt&&l(0,Me=gt.use),"class"in gt&&l(1,ke=gt.class),"topAppBar"in gt&&l(8,qe=gt.topAppBar),"component"in gt&&l(2,ft=gt.component),"$$scope"in gt&&l(13,G=gt.$$scope)},c.$$.update=()=>{c.$$.dirty&256&&q(l(3,x=qe&&qe.getPropStore())),c.$$.dirty&1032&&l(5,T=(()=>!x||d.variant==="static"?"":d.variant==="short"?"mdc-top-app-bar--short-fixed-adjust":d.prominent&&d.dense?"mdc-top-app-bar--dense-prominent-fixed-adjust":d.prominent?"mdc-top-app-bar--prominent-fixed-adjust":d.dense?"mdc-top-app-bar--dense-fixed-adjust":"mdc-top-app-bar--fixed-adjust")())},[Me,ke,ft,x,We,T,X,f,qe,Ge,d,V,Ze,G]}class b1 extends Rn{constructor(a){super(),Bn(this,a,x1,v1,On,{use:0,class:1,topAppBar:8,component:2,getElement:9})}get getElement(){return this.$$.ctx[9]}}const f_=y1,w1=b1;/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var zf={ICON_BUTTON_ON:"mdc-icon-button--on",ROOT:"mdc-icon-button"},Cc={ARIA_LABEL:"aria-label",ARIA_PRESSED:"aria-pressed",DATA_ARIA_LABEL_OFF:"data-aria-label-off",DATA_ARIA_LABEL_ON:"data-aria-label-on",CHANGE_EVENT:"MDCIconButtonToggle:change"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var E1=function(c){vu(a,c);function a(l){var x=c.call(this,La(La({},a.defaultAdapter),l))||this;return x.hasToggledAriaLabel=!1,x}return Object.defineProperty(a,"cssClasses",{get:function(){return zf},enumerable:!1,configurable:!0}),Object.defineProperty(a,"strings",{get:function(){return Cc},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultAdapter",{get:function(){return{addClass:function(){},hasClass:function(){return!1},notifyChange:function(){},removeClass:function(){},getAttr:function(){return null},setAttr:function(){}}},enumerable:!1,configurable:!0}),a.prototype.init=function(){var l=this.adapter.getAttr(Cc.DATA_ARIA_LABEL_ON),x=this.adapter.getAttr(Cc.DATA_ARIA_LABEL_OFF);if(l&&x){if(this.adapter.getAttr(Cc.ARIA_PRESSED)!==null)throw new Error("MDCIconButtonToggleFoundation: Button should not set `aria-pressed` if it has a toggled aria label.");this.hasToggledAriaLabel=!0}else this.adapter.setAttr(Cc.ARIA_PRESSED,String(this.isOn()))},a.prototype.handleClick=function(){this.toggle(),this.adapter.notifyChange({isOn:this.isOn()})},a.prototype.isOn=function(){return this.adapter.hasClass(zf.ICON_BUTTON_ON)},a.prototype.toggle=function(l){if(l===void 0&&(l=!this.isOn()),l?this.adapter.addClass(zf.ICON_BUTTON_ON):this.adapter.removeClass(zf.ICON_BUTTON_ON),this.hasToggledAriaLabel){var x=l?this.adapter.getAttr(Cc.DATA_ARIA_LABEL_ON):this.adapter.getAttr(Cc.DATA_ARIA_LABEL_OFF);this.adapter.setAttr(Cc.ARIA_LABEL,x||"")}else this.adapter.setAttr(Cc.ARIA_PRESSED,""+l)},a}(Qh);/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var dy="mdc-dom-focus-sentinel",I1=function(){function c(a,l){l===void 0&&(l={}),this.root=a,this.options=l,this.elFocusedBeforeTrapFocus=null}return c.prototype.trapFocus=function(){var a=this.getFocusableElements(this.root);if(a.length===0)throw new Error("FocusTrap: Element must have at least one focusable child.");this.elFocusedBeforeTrapFocus=document.activeElement instanceof HTMLElement?document.activeElement:null,this.wrapTabFocus(this.root),this.options.skipInitialFocus||this.focusInitialElement(a,this.options.initialFocusEl)},c.prototype.releaseFocus=function(){[].slice.call(this.root.querySelectorAll("."+dy)).forEach(function(a){a.parentElement.removeChild(a)}),!this.options.skipRestoreFocus&&this.elFocusedBeforeTrapFocus&&this.elFocusedBeforeTrapFocus.focus()},c.prototype.wrapTabFocus=function(a){var l=this,x=this.createSentinel(),T=this.createSentinel();x.addEventListener("focus",function(){var P=l.getFocusableElements(a);P.length>0&&P[P.length-1].focus()}),T.addEventListener("focus",function(){var P=l.getFocusableElements(a);P.length>0&&P[0].focus()}),a.insertBefore(x,a.children[0]),a.appendChild(T)},c.prototype.focusInitialElement=function(a,l){var x=0;l&&(x=Math.max(a.indexOf(l),0)),a[x].focus()},c.prototype.getFocusableElements=function(a){var l=[].slice.call(a.querySelectorAll("[autofocus], [tabindex], a, input, textarea, select, button"));return l.filter(function(x){var T=x.getAttribute("aria-disabled")==="true"||x.getAttribute("disabled")!=null||x.getAttribute("hidden")!=null||x.getAttribute("aria-hidden")==="true",P=x.tabIndex>=0&&x.getBoundingClientRect().width>0&&!x.classList.contains(dy)&&!T,f=!1;if(P){var d=getComputedStyle(x);f=d.display==="none"||d.visibility==="hidden"}return P&&!f})},c.prototype.createSentinel=function(){var a=document.createElement("div");return a.setAttribute("tabindex","0"),a.setAttribute("aria-hidden","true"),a.classList.add(dy),a},c}(),S1=Object.freeze(Object.defineProperty({__proto__:null,FocusTrap:I1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var qr={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape",TAB:"Tab"},_s=new Set;_s.add(qr.BACKSPACE);_s.add(qr.ENTER);_s.add(qr.SPACEBAR);_s.add(qr.PAGE_UP);_s.add(qr.PAGE_DOWN);_s.add(qr.END);_s.add(qr.HOME);_s.add(qr.ARROW_LEFT);_s.add(qr.ARROW_UP);_s.add(qr.ARROW_RIGHT);_s.add(qr.ARROW_DOWN);_s.add(qr.DELETE);_s.add(qr.ESCAPE);_s.add(qr.TAB);var Ns={BACKSPACE:8,ENTER:13,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ESCAPE:27,TAB:9},vs=new Map;vs.set(Ns.BACKSPACE,qr.BACKSPACE);vs.set(Ns.ENTER,qr.ENTER);vs.set(Ns.SPACEBAR,qr.SPACEBAR);vs.set(Ns.PAGE_UP,qr.PAGE_UP);vs.set(Ns.PAGE_DOWN,qr.PAGE_DOWN);vs.set(Ns.END,qr.END);vs.set(Ns.HOME,qr.HOME);vs.set(Ns.ARROW_LEFT,qr.ARROW_LEFT);vs.set(Ns.ARROW_UP,qr.ARROW_UP);vs.set(Ns.ARROW_RIGHT,qr.ARROW_RIGHT);vs.set(Ns.ARROW_DOWN,qr.ARROW_DOWN);vs.set(Ns.DELETE,qr.DELETE);vs.set(Ns.ESCAPE,qr.ESCAPE);vs.set(Ns.TAB,qr.TAB);var gh=new Set;gh.add(qr.PAGE_UP);gh.add(qr.PAGE_DOWN);gh.add(qr.END);gh.add(qr.HOME);gh.add(qr.ARROW_LEFT);gh.add(qr.ARROW_UP);gh.add(qr.ARROW_RIGHT);gh.add(qr.ARROW_DOWN);function Ja(c){var a=c.key;if(_s.has(a))return a;var l=vs.get(c.keyCode);return l||qr.UNKNOWN}const{applyPassive:Pf}=lx,{matches:T1}=rv;function Dd(c,{ripple:a=!0,surface:l=!1,unbounded:x=!1,disabled:T=!1,color:P,active:f,rippleElement:d,eventTarget:R,activeTarget:q,addClass:V=ke=>c.classList.add(ke),removeClass:G=ke=>c.classList.remove(ke),addStyle:X=(ke,qe)=>c.style.setProperty(ke,qe),initPromise:Me=Promise.resolve()}={}){let ke,qe=gs("SMUI:addLayoutListener"),We,ft=f,Ge=R,Ze=q;function gt(){l?(V("mdc-ripple-surface"),P==="primary"?(V("smui-ripple-surface--primary"),G("smui-ripple-surface--secondary")):P==="secondary"?(G("smui-ripple-surface--primary"),V("smui-ripple-surface--secondary")):(G("smui-ripple-surface--primary"),G("smui-ripple-surface--secondary"))):(G("mdc-ripple-surface"),G("smui-ripple-surface--primary"),G("smui-ripple-surface--secondary")),ke&&ft!==f&&(ft=f,f?ke.activate():f===!1&&ke.deactivate()),a&&!ke?(ke=new mx({addClass:V,browserSupportsCssVars:()=>dx(window),computeBoundingRect:()=>(d||c).getBoundingClientRect(),containsEventTarget:pt=>c.contains(pt),deregisterDocumentInteractionHandler:(pt,lt)=>document.documentElement.removeEventListener(pt,lt,Pf()),deregisterInteractionHandler:(pt,lt)=>(R||c).removeEventListener(pt,lt,Pf()),deregisterResizeHandler:pt=>window.removeEventListener("resize",pt),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset}),isSurfaceActive:()=>f==null?T1(q||c,":active"):f,isSurfaceDisabled:()=>!!T,isUnbounded:()=>!!x,registerDocumentInteractionHandler:(pt,lt)=>document.documentElement.addEventListener(pt,lt,Pf()),registerInteractionHandler:(pt,lt)=>(R||c).addEventListener(pt,lt,Pf()),registerResizeHandler:pt=>window.addEventListener("resize",pt),removeClass:G,updateCssVariable:X}),Me.then(()=>{ke&&(ke.init(),ke.setUnbounded(x))})):ke&&!a&&Me.then(()=>{ke&&(ke.destroy(),ke=void 0)}),ke&&(Ge!==R||Ze!==q)&&(Ge=R,Ze=q,ke.destroy(),requestAnimationFrame(()=>{ke&&(ke.init(),ke.setUnbounded(x))})),!a&&x&&V("mdc-ripple-upgraded--unbounded")}gt(),qe&&(We=qe(ct));function ct(){ke&&ke.layout()}return{update(pt){({ripple:a,surface:l,unbounded:x,disabled:T,color:P,active:f,rippleElement:d,eventTarget:R,activeTarget:q,addClass:V,removeClass:G,addStyle:X,initPromise:Me}=Object.assign({ripple:!0,surface:!1,unbounded:!1,disabled:!1,color:void 0,active:void 0,rippleElement:void 0,eventTarget:void 0,activeTarget:void 0,addClass:lt=>c.classList.add(lt),removeClass:lt=>c.classList.remove(lt),addStyle:(lt,pi)=>c.style.setProperty(lt,pi),initPromise:Promise.resolve()},pt)),gt()},destroy(){ke&&(ke.destroy(),ke=void 0,G("mdc-ripple-surface"),G("smui-ripple-surface--primary"),G("smui-ripple-surface--secondary")),We&&We()}}}function m_(c){let a;return{c(){a=Tr("div"),this.h()},l(l){a=Ar(l,"DIV",{class:!0}),Zr(a).forEach(Zt),this.h()},h(){Ur(a,"class","mdc-icon-button__touch")},m(l,x){Fi(l,a,x)},d(l){l&&Zt(a)}}}function A1(c){let a,l,x,T;const P=c[32].default,f=Co(P,c,c[36],null);let d=c[8]&&m_();return{c(){a=Tr("div"),l=pa(),f&&f.c(),d&&d.c(),x=Qo(),this.h()},l(R){a=Ar(R,"DIV",{class:!0}),Zr(a).forEach(Zt),l=da(R),f&&f.l(R),d&&d.l(R),x=Qo(),this.h()},h(){Ur(a,"class","mdc-icon-button__ripple")},m(R,q){Fi(R,a,q),Fi(R,l,q),f&&f.m(R,q),d&&d.m(R,q),Fi(R,x,q),T=!0},p(R,q){f&&f.p&&(!T||q[1]&32)&&ko(f,P,R,R[36],T?Po(P,R[36],q,null):zo(R[36]),null),R[8]?d||(d=m_(),d.c(),d.m(x.parentNode,x)):d&&(d.d(1),d=null)},i(R){T||(Mi(f,R),T=!0)},o(R){Ui(f,R),T=!1},d(R){R&&Zt(a),R&&Zt(l),f&&f.d(R),d&&d.d(R),R&&Zt(x)}}}function C1(c){let a,l,x;const T=[{use:[[Dd,{ripple:c[4],unbounded:!0,color:c[5],disabled:!!c[28].disabled,addClass:c[25],removeClass:c[26],addStyle:c[27]}],c[21],...c[1]]},{class:Ao(sl({[c[2]]:!0,"mdc-icon-button":!0,"mdc-icon-button--on":!c[22](c[0])&&c[0],"mdc-icon-button--touch":c[8],"mdc-icon-button--display-flex":c[9],"smui-icon-button--size-button":c[10]==="button","mdc-icon-button--reduced-size":c[10]==="mini"||c[10]==="button","mdc-card__action":c[23]==="card:action","mdc-card__action--icon":c[23]==="card:action","mdc-top-app-bar__navigation-icon":c[23]==="top-app-bar:navigation","mdc-top-app-bar__action-item":c[23]==="top-app-bar:action","mdc-snackbar__dismiss":c[23]==="snackbar:actions","mdc-data-table__pagination-button":c[23]==="data-table:pagination","mdc-data-table__sort-icon-button":c[23]==="data-table:sortable-header-cell","mdc-dialog__close":c[23]==="dialog:header"&&c[12]==="close"},c[17]))},{style:Object.entries(c[18]).map(y_).concat([c[3]]).join(" ")},{"aria-pressed":c[22](c[0])?null:c[0]?"true":"false"},{"aria-label":c[0]?c[6]:c[7]},{"data-aria-label-on":c[6]},{"data-aria-label-off":c[7]},{"aria-describedby":c[24]},{href:c[11]},c[20],c[19],c[28]];var P=c[13];function f(d){let R={$$slots:{default:[A1]},$$scope:{ctx:d}};for(let q=0;q<T.length;q+=1)R=Ci(R,T[q]);return{props:R}}return P&&(a=new P(f(c)),c[33](a),a.$on("click",c[34]),a.$on("click",c[35])),{c(){a&&en(a.$$.fragment),l=Qo()},l(d){a&&In(a.$$.fragment,d),l=Qo()},m(d,R){a&&tn(a,d,R),Fi(d,l,R),x=!0},p(d,R){const q=R[0]&536748031?go(T,[R[0]&505413682&&{use:[[Dd,{ripple:d[4],unbounded:!0,color:d[5],disabled:!!d[28].disabled,addClass:d[25],removeClass:d[26],addStyle:d[27]}],d[21],...d[1]]},R[0]&12719877&&{class:Ao(sl({[d[2]]:!0,"mdc-icon-button":!0,"mdc-icon-button--on":!d[22](d[0])&&d[0],"mdc-icon-button--touch":d[8],"mdc-icon-button--display-flex":d[9],"smui-icon-button--size-button":d[10]==="button","mdc-icon-button--reduced-size":d[10]==="mini"||d[10]==="button","mdc-card__action":d[23]==="card:action","mdc-card__action--icon":d[23]==="card:action","mdc-top-app-bar__navigation-icon":d[23]==="top-app-bar:navigation","mdc-top-app-bar__action-item":d[23]==="top-app-bar:action","mdc-snackbar__dismiss":d[23]==="snackbar:actions","mdc-data-table__pagination-button":d[23]==="data-table:pagination","mdc-data-table__sort-icon-button":d[23]==="data-table:sortable-header-cell","mdc-dialog__close":d[23]==="dialog:header"&&d[12]==="close"},d[17]))},R[0]&262152&&{style:Object.entries(d[18]).map(y_).concat([d[3]]).join(" ")},R[0]&4194305&&{"aria-pressed":d[22](d[0])?null:d[0]?"true":"false"},R[0]&193&&{"aria-label":d[0]?d[6]:d[7]},R[0]&64&&{"data-aria-label-on":d[6]},R[0]&128&&{"data-aria-label-off":d[7]},R[0]&16777216&&{"aria-describedby":d[24]},R[0]&2048&&{href:d[11]},R[0]&1048576&&Fs(d[20]),R[0]&524288&&Fs(d[19]),R[0]&268435456&&Fs(d[28])]):{};if(R[0]&256|R[1]&32&&(q.$$scope={dirty:R,ctx:d}),P!==(P=d[13])){if(a){$h();const V=a;Ui(V.$$.fragment,1,0,()=>{rn(V,1)}),Yh()}P?(a=new P(f(d)),d[33](a),a.$on("click",d[34]),a.$on("click",d[35]),en(a.$$.fragment),Mi(a.$$.fragment,1),tn(a,l.parentNode,l)):a=null}else P&&a.$set(q)},i(d){x||(a&&Mi(a.$$.fragment,d),x=!0)},o(d){a&&Ui(a.$$.fragment,d),x=!1},d(d){c[33](null),d&&Zt(l),a&&rn(a,d)}}}const y_=([c,a])=>`${c}: ${a};`;function k1(c,a,l){let x;const T=["use","class","style","ripple","color","toggle","pressed","ariaLabelOn","ariaLabelOff","touch","displayFlex","size","href","action","component","getElement"];let P=br(a,T),{$$slots:f={},$$scope:d}=a;const R=No(Fo());let q=()=>{};function V(zt){return zt===q}let{use:G=[]}=a,{class:X=""}=a,{style:Me=""}=a,{ripple:ke=!0}=a,{color:qe=void 0}=a,{toggle:We=!1}=a,{pressed:ft=q}=a,{ariaLabelOn:Ge=void 0}=a,{ariaLabelOff:Ze=void 0}=a,{touch:gt=!1}=a,{displayFlex:ct=!0}=a,{size:pt="normal"}=a,{href:lt=void 0}=a,{action:pi=void 0}=a,Et,Wt,vi={},qi={},Xt={},Qt=gs("SMUI:icon-button:context"),Ei=gs("SMUI:icon-button:aria-describedby"),{component:bt=lt==null?o1:av}=a,Gi=P.disabled;Ea("SMUI:icon:context","icon-button");let hr=null;Ud(()=>{Wt&&Wt.destroy()});function wr(zt){return zt in vi?vi[zt]:Li().classList.contains(zt)}function Dt(zt){vi[zt]||l(17,vi[zt]=!0,vi)}function oi(zt){(!(zt in vi)||vi[zt])&&l(17,vi[zt]=!1,vi)}function fi(zt,tr){qi[zt]!=tr&&(tr===""||tr==null?(delete qi[zt],l(18,qi)):l(18,qi[zt]=tr,qi))}function Bi(zt){var tr;return zt in Xt?(tr=Xt[zt])!==null&&tr!==void 0?tr:null:Li().getAttribute(zt)}function Nt(zt,tr){Xt[zt]!==tr&&l(19,Xt[zt]=tr,Xt)}function Xi(zt){l(0,ft=zt.isOn)}function Li(){return Et.getElement()}function xi(zt){_n[zt?"unshift":"push"](()=>{Et=zt,l(15,Et)})}const rr=()=>Wt&&Wt.handleClick(),Ti=()=>Qt==="top-app-bar:navigation"&&Us(Li(),"SMUITopAppBarIconButton:nav");return c.$$set=zt=>{a=Ci(Ci({},a),Uo(zt)),l(28,P=br(a,T)),"use"in zt&&l(1,G=zt.use),"class"in zt&&l(2,X=zt.class),"style"in zt&&l(3,Me=zt.style),"ripple"in zt&&l(4,ke=zt.ripple),"color"in zt&&l(5,qe=zt.color),"toggle"in zt&&l(29,We=zt.toggle),"pressed"in zt&&l(0,ft=zt.pressed),"ariaLabelOn"in zt&&l(6,Ge=zt.ariaLabelOn),"ariaLabelOff"in zt&&l(7,Ze=zt.ariaLabelOff),"touch"in zt&&l(8,gt=zt.touch),"displayFlex"in zt&&l(9,ct=zt.displayFlex),"size"in zt&&l(10,pt=zt.size),"href"in zt&&l(11,lt=zt.href),"action"in zt&&l(12,pi=zt.action),"component"in zt&&l(13,bt=zt.component),"$$scope"in zt&&l(36,d=zt.$$scope)},c.$$.update=()=>{if(c.$$.dirty[0]&4096&&l(20,x=(()=>{if(Qt==="data-table:pagination")switch(pi){case"first-page":return{"data-first-page":"true"};case"prev-page":return{"data-prev-page":"true"};case"next-page":return{"data-next-page":"true"};case"last-page":return{"data-last-page":"true"};default:return{"data-action":"true"}}else return Qt==="dialog:header"?{"data-mdc-dialog-action":pi}:{action:pi}})()),Gi!==P.disabled){const zt=Li();"blur"in zt&&zt.blur(),l(30,Gi=P.disabled)}c.$$.dirty[0]&536969216|c.$$.dirty[1]&1&&Et&&Li()&&We!==hr&&(We&&!Wt?(l(16,Wt=new E1({addClass:Dt,hasClass:wr,notifyChange:zt=>{Xi(zt),Us(Li(),"SMUIIconButtonToggle:change",zt,void 0,!0)},removeClass:oi,getAttr:Bi,setAttr:Nt})),Wt.init()):!We&&Wt&&(Wt.destroy(),l(16,Wt=void 0),l(17,vi={}),l(19,Xt={})),l(31,hr=We)),c.$$.dirty[0]&65537&&Wt&&!V(ft)&&Wt.isOn()!==ft&&Wt.toggle(ft)},[ft,G,X,Me,ke,qe,Ge,Ze,gt,ct,pt,lt,pi,bt,Li,Et,Wt,vi,qi,Xt,x,R,V,Qt,Ei,Dt,oi,fi,P,We,Gi,hr,f,xi,rr,Ti,d]}class By extends Rn{constructor(a){super(),Bn(this,a,k1,C1,On,{use:1,class:2,style:3,ripple:4,color:5,toggle:29,pressed:0,ariaLabelOn:6,ariaLabelOff:7,touch:8,displayFlex:9,size:10,href:11,action:12,component:13,getElement:14},null,[-1,-1])}get getElement(){return this.$$.ctx[14]}}const dn={title:"GIS for Water",url:"https://water-gis.com",logo:"https://raw.githubusercontent.com/watergis/logo/main/logo.svg",basePath:"/sveltekit-watergis-template",attribution:"\xA9NARWASSCO",styles:[{title:"UNVT(Water)",uri:"https://narwassco.github.io/mapbox-stylefiles/unvt/style.json"},{title:"UNVT(Sewer",uri:"https://narwassco.github.io/mapbox-stylefiles/unvt/style-sewer.json"}],center:{lng:35.87063,lat:-1.08551},zoom:13,search:{url:"https://narwassco.github.io/vt/meter.geojson",target:["connno","serialno"],format:c=>`${c.customer}, ${c.connno}, ${c.serialno}, ${c.village}`,place_type:["meter"],placeholder:"Search CONN NO or S/N",zoom:17},popup:{target:["meter","flow meter","valve","washout","firehydrant","tank","pipeline"]},areaSwitcher:{areas:[{title:"Narok",latlng:[35.87063,-1.08551],zoom:14},{title:"Ololulung'a",latlng:[35.65072,-1.0085],zoom:13},{title:"Kilgoris",latlng:[34.87533,-1.00278],zoom:14},{title:"Suswa",latlng:[36.33078,-1.05307],zoom:13}]},legend:{targets:{pipeline:"Pipeline",pipeline_annotation:"Pipeline Label",meter:"Water Meter","flow meter":"Flow Meter",valve:"Valve",firehydrant:"Fire Hydrant",washout:"Washout",tank:"Tank",tank_annotation:"Tank Label",wtp:"WTP",wtp_annotation:"WTP Label",intake:"Intake",intake_annotation:"Intake Label",parcels:"Parcels",parcels_annotation:"Parcels Label",village:"Village",village_annotation:"Village Label",dma:"DMA","dma-annotation":"DMA Label","contour-line":"Countour","contour-label":"Contour Label",hillshade:"Hillshade"},options:{showDefault:!1,showCheckbox:!0,reverseOrder:!0,onlyRendered:!0}},elevation:{url:"https://narwassco.github.io/narok-terrain/tiles/{z}/{x}/{y}.png",options:{tileSize:512,font:["Roboto Medium"],fontSize:12,fontHalo:1,mainColor:"#263238",haloColor:"#fff",units:"kilometers"}},valhalla:{url:"https://valhalla.water-gis.com",options:{Contours:[{time:3,distance:1,color:"ff0000"},{time:5,distance:2,color:"ffff00"},{time:10,distance:3,color:"0000ff"},{time:15,distance:4,color:"ff00ff"}]}}};function z1(c){let a;return{c(){a=Tr("link"),this.h()},l(l){a=Ar(l,"LINK",{rel:!0,href:!0}),this.h()},h(){Ur(a,"rel","stylesheet"),Ur(a,"href",dn.basePath+"/smui.css")},m(l,x){Fi(l,a,x)},p:cl,d(l){l&&Zt(a)}}}function P1(c){let a,l,x;return{c(){a=Tr("link"),l=pa(),x=Tr("link"),this.h()},l(T){a=Ar(T,"LINK",{rel:!0,href:!0,media:!0}),l=da(T),x=Ar(T,"LINK",{rel:!0,href:!0,media:!0}),this.h()},h(){Ur(a,"rel","stylesheet"),Ur(a,"href",dn.basePath+"/smui.css"),Ur(a,"media","print"),Ur(x,"rel","stylesheet"),Ur(x,"href",dn.basePath+"/smui-dark.css"),Ur(x,"media","screen")},m(T,P){Fi(T,a,P),Fi(T,l,P),Fi(T,x,P)},p:cl,d(T){T&&Zt(a),T&&Zt(l),T&&Zt(x)}}}function M1(c){let a,l,x;return{c(){a=Tr("link"),l=pa(),x=Tr("link"),this.h()},l(T){a=Ar(T,"LINK",{rel:!0,href:!0,media:!0}),l=da(T),x=Ar(T,"LINK",{rel:!0,href:!0,media:!0}),this.h()},h(){Ur(a,"rel","stylesheet"),Ur(a,"href",dn.basePath+"/smui.css"),Ur(a,"media","(prefers-color-scheme: light)"),Ur(x,"rel","stylesheet"),Ur(x,"href",dn.basePath+"/smui-dark.css"),Ur(x,"media","screen and (prefers-color-scheme: dark)")},m(T,P){Fi(T,a,P),Fi(T,l,P),Fi(T,x,P)},p:cl,d(T){T&&Zt(a),T&&Zt(l),T&&Zt(x)}}}function L1(c){let a;return{c(){a=Np("menu")},l(l){a=jp(l,"menu")},m(l,x){Fi(l,a,x)},d(l){l&&Zt(a)}}}function D1(c){let a=dn.title+"",l;return{c(){l=Np(a)},l(x){l=jp(x,a)},m(x,T){Fi(x,l,T)},p:cl,d(x){x&&Zt(l)}}}function R1(c){let a,l,x,T,P,f,d,R;return a=new By({props:{class:"material-icons",$$slots:{default:[L1]},$$scope:{ctx:c}}}),a.$on("click",c[6]),d=new g1({props:{$$slots:{default:[D1]},$$scope:{ctx:c}}}),{c(){en(a.$$.fragment),l=pa(),x=Tr("a"),T=Tr("img"),f=pa(),en(d.$$.fragment),this.h()},l(q){In(a.$$.fragment,q),l=da(q),x=Ar(q,"A",{href:!0});var V=Zr(x);T=Ar(V,"IMG",{src:!0,alt:!0,class:!0}),V.forEach(Zt),f=da(q),In(d.$$.fragment,q),this.h()},h(){rx(T.src,P=dn.logo)||Ur(T,"src",P),Ur(T,"alt","logo"),Ur(T,"class","logo svelte-1cnjkz4"),Ur(x,"href",dn.url)},m(q,V){tn(a,q,V),Fi(q,l,V),Fi(q,x,V),wa(x,T),Fi(q,f,V),tn(d,q,V),R=!0},p(q,V){const G={};V&256&&(G.$$scope={dirty:V,ctx:q}),a.$set(G);const X={};V&256&&(X.$$scope={dirty:V,ctx:q}),d.$set(X)},i(q){R||(Mi(a.$$.fragment,q),Mi(d.$$.fragment,q),R=!0)},o(q){Ui(a.$$.fragment,q),Ui(d.$$.fragment,q),R=!1},d(q){rn(a,q),q&&Zt(l),q&&Zt(x),q&&Zt(f),rn(d,q)}}}function B1(c){let a;return{c(){a=Np("print")},l(l){a=jp(l,"print")},m(l,x){Fi(l,a,x)},d(l){l&&Zt(a)}}}function O1(c){let a;return{c(){a=Np(c[3])},l(l){a=jp(l,c[3])},m(l,x){Fi(l,a,x)},p(l,x){x&8&&ev(a,l[3])},d(l){l&&Zt(a)}}}function F1(c){let a,l,x,T;return a=new By({props:{class:"material-icons","aria-label":"Print",$$slots:{default:[B1]},$$scope:{ctx:c}}}),x=new By({props:{"aria-label":c[4],class:"material-icons",title:c[4],$$slots:{default:[O1]},$$scope:{ctx:c}}}),x.$on("click",c[5]),{c(){en(a.$$.fragment),l=pa(),en(x.$$.fragment)},l(P){In(a.$$.fragment,P),l=da(P),In(x.$$.fragment,P)},m(P,f){tn(a,P,f),Fi(P,l,f),tn(x,P,f),T=!0},p(P,f){const d={};f&256&&(d.$$scope={dirty:f,ctx:P}),a.$set(d);const R={};f&16&&(R["aria-label"]=P[4]),f&16&&(R.title=P[4]),f&264&&(R.$$scope={dirty:f,ctx:P}),x.$set(R)},i(P){T||(Mi(a.$$.fragment,P),Mi(x.$$.fragment,P),T=!0)},o(P){Ui(a.$$.fragment,P),Ui(x.$$.fragment,P),T=!1},d(P){rn(a,P),P&&Zt(l),rn(x,P)}}}function U1(c){let a,l,x,T,P,f;return a=new f_({props:{$$slots:{default:[R1]},$$scope:{ctx:c}}}),P=new f_({props:{align:"end",toolbar:!0,$$slots:{default:[F1]},$$scope:{ctx:c}}}),{c(){en(a.$$.fragment),l=pa(),x=Tr("section"),T=pa(),en(P.$$.fragment)},l(d){In(a.$$.fragment,d),l=da(d),x=Ar(d,"SECTION",{}),Zr(x).forEach(Zt),T=da(d),In(P.$$.fragment,d)},m(d,R){tn(a,d,R),Fi(d,l,R),Fi(d,x,R),Fi(d,T,R),tn(P,d,R),f=!0},p(d,R){const q={};R&257&&(q.$$scope={dirty:R,ctx:d}),a.$set(q);const V={};R&280&&(V.$$scope={dirty:R,ctx:d}),P.$set(V)},i(d){f||(Mi(a.$$.fragment,d),Mi(P.$$.fragment,d),f=!0)},o(d){Ui(a.$$.fragment,d),Ui(P.$$.fragment,d),f=!1},d(d){rn(a,d),d&&Zt(l),d&&Zt(x),d&&Zt(T),rn(P,d)}}}function N1(c){let a,l;return a=new d1({props:{$$slots:{default:[U1]},$$scope:{ctx:c}}}),{c(){en(a.$$.fragment)},l(x){In(a.$$.fragment,x)},m(x,T){tn(a,x,T),l=!0},p(x,T){const P={};T&281&&(P.$$scope={dirty:T,ctx:x}),a.$set(P)},i(x){l||(Mi(a.$$.fragment,x),l=!0)},o(x){Ui(a.$$.fragment,x),l=!1},d(x){rn(a,x)}}}function j1(c){let a,l,x,T,P,f;function d(G,X){return G[1]===void 0?M1:G[1]?P1:z1}let R=d(c),q=R(c),V={variant:"fixed",$$slots:{default:[N1]},$$scope:{ctx:c}};return x=new wx({props:V}),c[7](x),P=new w1({props:{topAppBar:c[2]}}),{c(){q.c(),a=Qo(),l=pa(),en(x.$$.fragment),T=pa(),en(P.$$.fragment)},l(G){const X=ix('[data-svelte="svelte-7r4yyr"]',document.head);q.l(X),a=Qo(),X.forEach(Zt),l=da(G),In(x.$$.fragment,G),T=da(G),In(P.$$.fragment,G)},m(G,X){q.m(document.head,null),wa(document.head,a),Fi(G,l,X),tn(x,G,X),Fi(G,T,X),tn(P,G,X),f=!0},p(G,[X]){R===(R=d(G))&&q?q.p(G,X):(q.d(1),q=R(G),q&&(q.c(),q.m(a.parentNode,a)));const Me={};X&281&&(Me.$$scope={dirty:X,ctx:G}),x.$set(Me);const ke={};X&4&&(ke.topAppBar=G[2]),P.$set(ke)},i(G){f||(Mi(x.$$.fragment,G),Mi(P.$$.fragment,G),f=!0)},o(G){Ui(x.$$.fragment,G),Ui(P.$$.fragment,G),f=!1},d(G){q.d(G),Zt(a),G&&Zt(l),c[7](null),rn(x,G),G&&Zt(T),rn(P,G)}}}function V1(c,a,l){let x,T,{drawerOpen:P=!1}=a,f,d;yh(()=>{l(1,f=window.matchMedia("(prefers-color-scheme: dark)").matches)});const R=()=>l(1,f=!f),q=()=>l(0,P=!P);function V(G){_n[G?"unshift":"push"](()=>{d=G,l(2,d)})}return c.$$set=G=>{"drawerOpen"in G&&l(0,P=G.drawerOpen)},c.$$.update=()=>{c.$$.dirty&2&&l(4,x=`switch to ${f?"light":"dark"} mode`),c.$$.dirty&2&&l(3,T=f?"light_mode":"dark_mode")},[P,f,d,T,x,R,q,V]}class q1 extends Rn{constructor(a){super(),Bn(this,a,V1,j1,On,{drawerOpen:0})}}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var sh,kc,Dr={LIST_ITEM_ACTIVATED_CLASS:"mdc-list-item--activated",LIST_ITEM_CLASS:"mdc-list-item",LIST_ITEM_DISABLED_CLASS:"mdc-list-item--disabled",LIST_ITEM_SELECTED_CLASS:"mdc-list-item--selected",LIST_ITEM_TEXT_CLASS:"mdc-list-item__text",LIST_ITEM_PRIMARY_TEXT_CLASS:"mdc-list-item__primary-text",ROOT:"mdc-list"};sh={},sh[""+Dr.LIST_ITEM_ACTIVATED_CLASS]="mdc-list-item--activated",sh[""+Dr.LIST_ITEM_CLASS]="mdc-list-item",sh[""+Dr.LIST_ITEM_DISABLED_CLASS]="mdc-list-item--disabled",sh[""+Dr.LIST_ITEM_SELECTED_CLASS]="mdc-list-item--selected",sh[""+Dr.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-list-item__primary-text",sh[""+Dr.ROOT]="mdc-list";var Cp=(kc={},kc[""+Dr.LIST_ITEM_ACTIVATED_CLASS]="mdc-deprecated-list-item--activated",kc[""+Dr.LIST_ITEM_CLASS]="mdc-deprecated-list-item",kc[""+Dr.LIST_ITEM_DISABLED_CLASS]="mdc-deprecated-list-item--disabled",kc[""+Dr.LIST_ITEM_SELECTED_CLASS]="mdc-deprecated-list-item--selected",kc[""+Dr.LIST_ITEM_TEXT_CLASS]="mdc-deprecated-list-item__text",kc[""+Dr.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-deprecated-list-item__primary-text",kc[""+Dr.ROOT]="mdc-deprecated-list",kc),lh={ACTION_EVENT:"MDCList:action",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",ARIA_INTERACTIVE_ROLES_SELECTOR:'[role="listbox"], [role="menu"]',ARIA_MULTI_SELECTABLE_SELECTOR:'[aria-multiselectable="true"]',CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:`
    .`+Dr.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+Dr.LIST_ITEM_CLASS+` a,
    .`+Cp[Dr.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+Cp[Dr.LIST_ITEM_CLASS]+` a
  `,DEPRECATED_SELECTOR:".mdc-deprecated-list",FOCUSABLE_CHILD_ELEMENTS:`
    .`+Dr.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+Dr.LIST_ITEM_CLASS+` a,
    .`+Dr.LIST_ITEM_CLASS+` input[type="radio"]:not(:disabled),
    .`+Dr.LIST_ITEM_CLASS+` input[type="checkbox"]:not(:disabled),
    .`+Cp[Dr.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+Cp[Dr.LIST_ITEM_CLASS]+` a,
    .`+Cp[Dr.LIST_ITEM_CLASS]+` input[type="radio"]:not(:disabled),
    .`+Cp[Dr.LIST_ITEM_CLASS]+` input[type="checkbox"]:not(:disabled)
  `,RADIO_SELECTOR:'input[type="radio"]',SELECTED_ITEM_SELECTOR:'[aria-selected="true"], [aria-current="true"]'},ua={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var G1=["input","button","textarea","select"],Hh=function(c){var a=c.target;if(!!a){var l=(""+a.tagName).toLowerCase();G1.indexOf(l)===-1&&c.preventDefault()}};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function Z1(){var c={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""};return c}function H1(c,a){for(var l=new Map,x=0;x<c;x++){var T=a(x).trim();if(!!T){var P=T[0].toLowerCase();l.has(P)||l.set(P,[]),l.get(P).push({text:T.toLowerCase(),index:x})}}return l.forEach(function(f){f.sort(function(d,R){return d.index-R.index})}),l}function Oy(c,a){var l=c.nextChar,x=c.focusItemAtIndex,T=c.sortedIndexByFirstChar,P=c.focusedItemIndex,f=c.skipFocus,d=c.isItemAtIndexDisabled;clearTimeout(a.bufferClearTimeout),a.bufferClearTimeout=setTimeout(function(){lv(a)},ua.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),a.typeaheadBuffer=a.typeaheadBuffer+l;var R;return a.typeaheadBuffer.length===1?R=W1(T,P,d,a):R=X1(T,d,a),R!==-1&&!f&&x(R),R}function W1(c,a,l,x){var T=x.typeaheadBuffer[0],P=c.get(T);if(!P)return-1;if(T===x.currentFirstChar&&P[x.sortedIndexCursor].index===a){x.sortedIndexCursor=(x.sortedIndexCursor+1)%P.length;var f=P[x.sortedIndexCursor].index;if(!l(f))return f}x.currentFirstChar=T;var d=-1,R;for(R=0;R<P.length;R++)if(!l(P[R].index)){d=R;break}for(;R<P.length;R++)if(P[R].index>a&&!l(P[R].index)){d=R;break}return d!==-1?(x.sortedIndexCursor=d,P[x.sortedIndexCursor].index):-1}function X1(c,a,l){var x=l.typeaheadBuffer[0],T=c.get(x);if(!T)return-1;var P=T[l.sortedIndexCursor];if(P.text.lastIndexOf(l.typeaheadBuffer,0)===0&&!a(P.index))return P.index;for(var f=(l.sortedIndexCursor+1)%T.length,d=-1;f!==l.sortedIndexCursor;){var R=T[f],q=R.text.lastIndexOf(l.typeaheadBuffer,0)===0,V=!a(R.index);if(q&&V){d=f;break}f=(f+1)%T.length}return d!==-1?(l.sortedIndexCursor=d,T[l.sortedIndexCursor].index):-1}function sv(c){return c.typeaheadBuffer.length>0}function lv(c){c.typeaheadBuffer=""}function g_(c,a){var l=c.event,x=c.isTargetListItem,T=c.focusedItemIndex,P=c.focusItemAtIndex,f=c.sortedIndexByFirstChar,d=c.isItemAtIndexDisabled,R=Ja(l)==="ArrowLeft",q=Ja(l)==="ArrowUp",V=Ja(l)==="ArrowRight",G=Ja(l)==="ArrowDown",X=Ja(l)==="Home",Me=Ja(l)==="End",ke=Ja(l)==="Enter",qe=Ja(l)==="Spacebar";if(l.ctrlKey||l.metaKey||R||q||V||G||X||Me||ke)return-1;var We=!qe&&l.key.length===1;if(We){Hh(l);var ft={focusItemAtIndex:P,focusedItemIndex:T,nextChar:l.key.toLowerCase(),sortedIndexByFirstChar:f,skipFocus:!1,isItemAtIndexDisabled:d};return Oy(ft,a)}if(!qe)return-1;x&&Hh(l);var Ge=x&&sv(a);if(Ge){var ft={focusItemAtIndex:P,focusedItemIndex:T,nextChar:" ",sortedIndexByFirstChar:f,skipFocus:!1,isItemAtIndexDisabled:d};return Oy(ft,a)}return-1}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function K1(c){return c instanceof Array}var J1=function(c){vu(a,c);function a(l){var x=c.call(this,La(La({},a.defaultAdapter),l))||this;return x.wrapFocus=!1,x.isVertical=!0,x.isSingleSelectionList=!1,x.selectedIndex=ua.UNSET_INDEX,x.focusedItemIndex=ua.UNSET_INDEX,x.useActivatedClass=!1,x.useSelectedAttr=!1,x.ariaCurrentAttrValue=null,x.isCheckboxList=!1,x.isRadioList=!1,x.hasTypeahead=!1,x.typeaheadState=Z1(),x.sortedIndexByFirstChar=new Map,x}return Object.defineProperty(a,"strings",{get:function(){return lh},enumerable:!1,configurable:!0}),Object.defineProperty(a,"cssClasses",{get:function(){return Dr},enumerable:!1,configurable:!0}),Object.defineProperty(a,"numbers",{get:function(){return ua},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultAdapter",{get:function(){return{addClassForElementIndex:function(){},focusItemAtIndex:function(){},getAttributeForElementIndex:function(){return null},getFocusedElementIndex:function(){return 0},getListItemCount:function(){return 0},hasCheckboxAtIndex:function(){return!1},hasRadioAtIndex:function(){return!1},isCheckboxCheckedAtIndex:function(){return!1},isFocusInsideList:function(){return!1},isRootFocused:function(){return!1},listItemAtIndexHasClass:function(){return!1},notifyAction:function(){},removeClassForElementIndex:function(){},setAttributeForElementIndex:function(){},setCheckedCheckboxOrRadioAtIndex:function(){},setTabIndexForListItemChildren:function(){},getPrimaryTextAtIndex:function(){return""}}},enumerable:!1,configurable:!0}),a.prototype.layout=function(){this.adapter.getListItemCount()!==0&&(this.adapter.hasCheckboxAtIndex(0)?this.isCheckboxList=!0:this.adapter.hasRadioAtIndex(0)?this.isRadioList=!0:this.maybeInitializeSingleSelection(),this.hasTypeahead&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex()))},a.prototype.getFocusedItemIndex=function(){return this.focusedItemIndex},a.prototype.setWrapFocus=function(l){this.wrapFocus=l},a.prototype.setVerticalOrientation=function(l){this.isVertical=l},a.prototype.setSingleSelection=function(l){this.isSingleSelectionList=l,l&&(this.maybeInitializeSingleSelection(),this.selectedIndex=this.getSelectedIndexFromDOM())},a.prototype.maybeInitializeSingleSelection=function(){var l=this.getSelectedIndexFromDOM();if(l!==ua.UNSET_INDEX){var x=this.adapter.listItemAtIndexHasClass(l,Dr.LIST_ITEM_ACTIVATED_CLASS);x&&this.setUseActivatedClass(!0),this.isSingleSelectionList=!0,this.selectedIndex=l}},a.prototype.getSelectedIndexFromDOM=function(){for(var l=ua.UNSET_INDEX,x=this.adapter.getListItemCount(),T=0;T<x;T++){var P=this.adapter.listItemAtIndexHasClass(T,Dr.LIST_ITEM_SELECTED_CLASS),f=this.adapter.listItemAtIndexHasClass(T,Dr.LIST_ITEM_ACTIVATED_CLASS);if(!!(P||f)){l=T;break}}return l},a.prototype.setHasTypeahead=function(l){this.hasTypeahead=l,l&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex())},a.prototype.isTypeaheadInProgress=function(){return this.hasTypeahead&&sv(this.typeaheadState)},a.prototype.setUseActivatedClass=function(l){this.useActivatedClass=l},a.prototype.setUseSelectedAttribute=function(l){this.useSelectedAttr=l},a.prototype.getSelectedIndex=function(){return this.selectedIndex},a.prototype.setSelectedIndex=function(l,x){var T=x===void 0?{}:x,P=T.forceUpdate;!this.isIndexValid(l)||(this.isCheckboxList?this.setCheckboxAtIndex(l):this.isRadioList?this.setRadioAtIndex(l):this.setSingleSelectionAtIndex(l,{forceUpdate:P}))},a.prototype.handleFocusIn=function(l){l>=0&&(this.focusedItemIndex=l,this.adapter.setAttributeForElementIndex(l,"tabindex","0"),this.adapter.setTabIndexForListItemChildren(l,"0"))},a.prototype.handleFocusOut=function(l){var x=this;l>=0&&(this.adapter.setAttributeForElementIndex(l,"tabindex","-1"),this.adapter.setTabIndexForListItemChildren(l,"-1")),setTimeout(function(){x.adapter.isFocusInsideList()||x.setTabindexToFirstSelectedOrFocusedItem()},0)},a.prototype.handleKeydown=function(l,x,T){var P=this,f=Ja(l)==="ArrowLeft",d=Ja(l)==="ArrowUp",R=Ja(l)==="ArrowRight",q=Ja(l)==="ArrowDown",V=Ja(l)==="Home",G=Ja(l)==="End",X=Ja(l)==="Enter",Me=Ja(l)==="Spacebar",ke=l.key==="A"||l.key==="a";if(this.adapter.isRootFocused()){if(d||G?(l.preventDefault(),this.focusLastElement()):(q||V)&&(l.preventDefault(),this.focusFirstElement()),this.hasTypeahead){var qe={event:l,focusItemAtIndex:function(Ge){P.focusItemAtIndex(Ge)},focusedItemIndex:-1,isTargetListItem:x,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(Ge){return P.adapter.listItemAtIndexHasClass(Ge,Dr.LIST_ITEM_DISABLED_CLASS)}};g_(qe,this.typeaheadState)}return}var We=this.adapter.getFocusedElementIndex();if(!(We===-1&&(We=T,We<0))){if(this.isVertical&&q||!this.isVertical&&R)Hh(l),this.focusNextElement(We);else if(this.isVertical&&d||!this.isVertical&&f)Hh(l),this.focusPrevElement(We);else if(V)Hh(l),this.focusFirstElement();else if(G)Hh(l),this.focusLastElement();else if(ke&&l.ctrlKey&&this.isCheckboxList)l.preventDefault(),this.toggleAll(this.selectedIndex===ua.UNSET_INDEX?[]:this.selectedIndex);else if((X||Me)&&x){var ft=l.target;if(ft&&ft.tagName==="A"&&X||(Hh(l),this.adapter.listItemAtIndexHasClass(We,Dr.LIST_ITEM_DISABLED_CLASS)))return;this.isTypeaheadInProgress()||(this.isSelectableList()&&this.setSelectedIndexOnAction(We),this.adapter.notifyAction(We))}if(this.hasTypeahead){var qe={event:l,focusItemAtIndex:function(Ze){P.focusItemAtIndex(Ze)},focusedItemIndex:this.focusedItemIndex,isTargetListItem:x,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(Ze){return P.adapter.listItemAtIndexHasClass(Ze,Dr.LIST_ITEM_DISABLED_CLASS)}};g_(qe,this.typeaheadState)}}},a.prototype.handleClick=function(l,x){l!==ua.UNSET_INDEX&&(this.adapter.listItemAtIndexHasClass(l,Dr.LIST_ITEM_DISABLED_CLASS)||(this.isSelectableList()&&this.setSelectedIndexOnAction(l,x),this.adapter.notifyAction(l)))},a.prototype.focusNextElement=function(l){var x=this.adapter.getListItemCount(),T=l+1;if(T>=x)if(this.wrapFocus)T=0;else return l;return this.focusItemAtIndex(T),T},a.prototype.focusPrevElement=function(l){var x=l-1;if(x<0)if(this.wrapFocus)x=this.adapter.getListItemCount()-1;else return l;return this.focusItemAtIndex(x),x},a.prototype.focusFirstElement=function(){return this.focusItemAtIndex(0),0},a.prototype.focusLastElement=function(){var l=this.adapter.getListItemCount()-1;return this.focusItemAtIndex(l),l},a.prototype.focusInitialElement=function(){var l=this.getFirstSelectedOrFocusedItemIndex();return this.focusItemAtIndex(l),l},a.prototype.setEnabled=function(l,x){!this.isIndexValid(l)||(x?(this.adapter.removeClassForElementIndex(l,Dr.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(l,lh.ARIA_DISABLED,"false")):(this.adapter.addClassForElementIndex(l,Dr.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(l,lh.ARIA_DISABLED,"true")))},a.prototype.setSingleSelectionAtIndex=function(l,x){var T=x===void 0?{}:x,P=T.forceUpdate;if(!(this.selectedIndex===l&&!P)){var f=Dr.LIST_ITEM_SELECTED_CLASS;this.useActivatedClass&&(f=Dr.LIST_ITEM_ACTIVATED_CLASS),this.selectedIndex!==ua.UNSET_INDEX&&this.adapter.removeClassForElementIndex(this.selectedIndex,f),this.setAriaForSingleSelectionAtIndex(l),this.setTabindexAtIndex(l),l!==ua.UNSET_INDEX&&this.adapter.addClassForElementIndex(l,f),this.selectedIndex=l}},a.prototype.setAriaForSingleSelectionAtIndex=function(l){this.selectedIndex===ua.UNSET_INDEX&&(this.ariaCurrentAttrValue=this.adapter.getAttributeForElementIndex(l,lh.ARIA_CURRENT));var x=this.ariaCurrentAttrValue!==null,T=x?lh.ARIA_CURRENT:lh.ARIA_SELECTED;if(this.selectedIndex!==ua.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,T,"false"),l!==ua.UNSET_INDEX){var P=x?this.ariaCurrentAttrValue:"true";this.adapter.setAttributeForElementIndex(l,T,P)}},a.prototype.getSelectionAttribute=function(){return this.useSelectedAttr?lh.ARIA_SELECTED:lh.ARIA_CHECKED},a.prototype.setRadioAtIndex=function(l){var x=this.getSelectionAttribute();this.adapter.setCheckedCheckboxOrRadioAtIndex(l,!0),this.selectedIndex!==ua.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,x,"false"),this.adapter.setAttributeForElementIndex(l,x,"true"),this.selectedIndex=l},a.prototype.setCheckboxAtIndex=function(l){for(var x=this.getSelectionAttribute(),T=0;T<this.adapter.getListItemCount();T++){var P=!1;l.indexOf(T)>=0&&(P=!0),this.adapter.setCheckedCheckboxOrRadioAtIndex(T,P),this.adapter.setAttributeForElementIndex(T,x,P?"true":"false")}this.selectedIndex=l},a.prototype.setTabindexAtIndex=function(l){this.focusedItemIndex===ua.UNSET_INDEX&&l!==0?this.adapter.setAttributeForElementIndex(0,"tabindex","-1"):this.focusedItemIndex>=0&&this.focusedItemIndex!==l&&this.adapter.setAttributeForElementIndex(this.focusedItemIndex,"tabindex","-1"),!(this.selectedIndex instanceof Array)&&this.selectedIndex!==l&&this.adapter.setAttributeForElementIndex(this.selectedIndex,"tabindex","-1"),l!==ua.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(l,"tabindex","0")},a.prototype.isSelectableList=function(){return this.isSingleSelectionList||this.isCheckboxList||this.isRadioList},a.prototype.setTabindexToFirstSelectedOrFocusedItem=function(){var l=this.getFirstSelectedOrFocusedItemIndex();this.setTabindexAtIndex(l)},a.prototype.getFirstSelectedOrFocusedItemIndex=function(){return this.isSelectableList()?typeof this.selectedIndex=="number"&&this.selectedIndex!==ua.UNSET_INDEX?this.selectedIndex:K1(this.selectedIndex)&&this.selectedIndex.length>0?this.selectedIndex.reduce(function(l,x){return Math.min(l,x)}):0:Math.max(this.focusedItemIndex,0)},a.prototype.isIndexValid=function(l){var x=this;if(l instanceof Array){if(!this.isCheckboxList)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");return l.length===0?!0:l.some(function(T){return x.isIndexInRange(T)})}else if(typeof l=="number"){if(this.isCheckboxList)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+l);return this.isIndexInRange(l)||this.isSingleSelectionList&&l===ua.UNSET_INDEX}else return!1},a.prototype.isIndexInRange=function(l){var x=this.adapter.getListItemCount();return l>=0&&l<x},a.prototype.setSelectedIndexOnAction=function(l,x){x===void 0&&(x=!0),this.isCheckboxList?this.toggleCheckboxAtIndex(l,x):this.setSelectedIndex(l)},a.prototype.toggleCheckboxAtIndex=function(l,x){var T=this.getSelectionAttribute(),P=this.adapter.isCheckboxCheckedAtIndex(l);x&&(P=!P,this.adapter.setCheckedCheckboxOrRadioAtIndex(l,P)),this.adapter.setAttributeForElementIndex(l,T,P?"true":"false");var f=this.selectedIndex===ua.UNSET_INDEX?[]:this.selectedIndex.slice();P?f.push(l):f=f.filter(function(d){return d!==l}),this.selectedIndex=f},a.prototype.focusItemAtIndex=function(l){this.adapter.focusItemAtIndex(l),this.focusedItemIndex=l},a.prototype.toggleAll=function(l){var x=this.adapter.getListItemCount();if(l.length===x)this.setCheckboxAtIndex([]);else{for(var T=[],P=0;P<x;P++)(!this.adapter.listItemAtIndexHasClass(P,Dr.LIST_ITEM_DISABLED_CLASS)||l.indexOf(P)>-1)&&T.push(P);this.setCheckboxAtIndex(T)}},a.prototype.typeaheadMatchItem=function(l,x,T){var P=this;T===void 0&&(T=!1);var f={focusItemAtIndex:function(d){P.focusItemAtIndex(d)},focusedItemIndex:x||this.focusedItemIndex,nextChar:l,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:T,isItemAtIndexDisabled:function(d){return P.adapter.listItemAtIndexHasClass(d,Dr.LIST_ITEM_DISABLED_CLASS)}};return Oy(f,this.typeaheadState)},a.prototype.typeaheadInitSortedIndex=function(){return H1(this.adapter.getListItemCount(),this.adapter.getPrimaryTextAtIndex)},a.prototype.clearTypeaheadBuffer=function(){lv(this.typeaheadState)},a}(Qh);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Os={ANIMATE:"mdc-drawer--animate",CLOSING:"mdc-drawer--closing",DISMISSIBLE:"mdc-drawer--dismissible",MODAL:"mdc-drawer--modal",OPEN:"mdc-drawer--open",OPENING:"mdc-drawer--opening",ROOT:"mdc-drawer"},Y1={APP_CONTENT_SELECTOR:".mdc-drawer-app-content",CLOSE_EVENT:"MDCDrawer:closed",OPEN_EVENT:"MDCDrawer:opened",SCRIM_SELECTOR:".mdc-drawer-scrim",LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",LIST_ITEM_ACTIVATED_SELECTOR:".mdc-list-item--activated,.mdc-deprecated-list-item--activated"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var uv=function(c){vu(a,c);function a(l){var x=c.call(this,La(La({},a.defaultAdapter),l))||this;return x.animationFrame=0,x.animationTimer=0,x}return Object.defineProperty(a,"strings",{get:function(){return Y1},enumerable:!1,configurable:!0}),Object.defineProperty(a,"cssClasses",{get:function(){return Os},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},elementHasClass:function(){return!1},notifyClose:function(){},notifyOpen:function(){},saveFocus:function(){},restoreFocus:function(){},focusActiveNavigationItem:function(){},trapFocus:function(){},releaseFocus:function(){}}},enumerable:!1,configurable:!0}),a.prototype.destroy=function(){this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.animationTimer&&clearTimeout(this.animationTimer)},a.prototype.open=function(){var l=this;this.isOpen()||this.isOpening()||this.isClosing()||(this.adapter.addClass(Os.OPEN),this.adapter.addClass(Os.ANIMATE),this.runNextAnimationFrame(function(){l.adapter.addClass(Os.OPENING)}),this.adapter.saveFocus())},a.prototype.close=function(){!this.isOpen()||this.isOpening()||this.isClosing()||this.adapter.addClass(Os.CLOSING)},a.prototype.isOpen=function(){return this.adapter.hasClass(Os.OPEN)},a.prototype.isOpening=function(){return this.adapter.hasClass(Os.OPENING)||this.adapter.hasClass(Os.ANIMATE)},a.prototype.isClosing=function(){return this.adapter.hasClass(Os.CLOSING)},a.prototype.handleKeydown=function(l){var x=l.keyCode,T=l.key,P=T==="Escape"||x===27;P&&this.close()},a.prototype.handleTransitionEnd=function(l){var x=Os.OPENING,T=Os.CLOSING,P=Os.OPEN,f=Os.ANIMATE,d=Os.ROOT,R=this.isElement(l.target)&&this.adapter.elementHasClass(l.target,d);!R||(this.isClosing()?(this.adapter.removeClass(P),this.closed(),this.adapter.restoreFocus(),this.adapter.notifyClose()):(this.adapter.focusActiveNavigationItem(),this.opened(),this.adapter.notifyOpen()),this.adapter.removeClass(f),this.adapter.removeClass(x),this.adapter.removeClass(T))},a.prototype.opened=function(){},a.prototype.closed=function(){},a.prototype.runNextAnimationFrame=function(l){var x=this;cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(function(){x.animationFrame=0,clearTimeout(x.animationTimer),x.animationTimer=setTimeout(l,0)})},a.prototype.isElement=function(l){return Boolean(l.classList)},a}(Qh);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var $1=function(c){vu(a,c);function a(){return c!==null&&c.apply(this,arguments)||this}return a.prototype.handleScrimClick=function(){this.close()},a.prototype.opened=function(){this.adapter.trapFocus()},a.prototype.closed=function(){this.adapter.releaseFocus()},a}(uv);function Q1(c){let a,l,x,T,P,f;const d=c[15].default,R=Co(d,c,c[14],null);let q=[{class:l=Ao(sl({[c[1]]:!0,"mdc-drawer":!0,"mdc-drawer--dismissible":c[2]==="dismissible","mdc-drawer--modal":c[2]==="modal","smui-drawer__absolute":c[2]==="modal"&&!c[3]},c[6]))},c[8]],V={};for(let G=0;G<q.length;G+=1)V=Ci(V,q[G]);return{c(){a=Tr("aside"),R&&R.c(),this.h()},l(G){a=Ar(G,"ASIDE",{class:!0});var X=Zr(a);R&&R.l(X),X.forEach(Zt),this.h()},h(){Hr(a,V)},m(G,X){Fi(G,a,X),R&&R.m(a,null),c[16](a),T=!0,P||(f=[Jr(x=Ia.call(null,a,c[0])),Jr(c[7].call(null,a)),ll(a,"keydown",c[17]),ll(a,"transitionend",c[18])],P=!0)},p(G,[X]){R&&R.p&&(!T||X&16384)&&ko(R,d,G,G[14],T?Po(d,G[14],X,null):zo(G[14]),null),Hr(a,V=go(q,[(!T||X&78&&l!==(l=Ao(sl({[G[1]]:!0,"mdc-drawer":!0,"mdc-drawer--dismissible":G[2]==="dismissible","mdc-drawer--modal":G[2]==="modal","smui-drawer__absolute":G[2]==="modal"&&!G[3]},G[6]))))&&{class:l},X&256&&G[8]])),x&&ha(x.update)&&X&1&&x.update.call(null,G[0])},i(G){T||(Mi(R,G),T=!0)},o(G){Ui(R,G),T=!1},d(G){G&&Zt(a),R&&R.d(G),c[16](null),P=!1,Ya(f)}}}function eb(c,a,l){const x=["use","class","variant","open","fixed","setOpen","isOpen","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a;const{FocusTrap:d}=S1,R=No(Fo());let{use:q=[]}=a,{class:V=""}=a,{variant:G=void 0}=a,{open:X=!1}=a,{fixed:Me=!0}=a,ke,qe,We={},ft=null,Ge,Ze=!1;Ea("SMUI:list:nav",!0),Ea("SMUI:list:item:nav",!0),Ea("SMUI:list:wrapFocus",!0);let gt=G;yh(()=>{Ge=new d(ke,{skipInitialFocus:!0}),l(4,qe=ct()),qe&&qe.init()}),Ud(()=>{qe&&qe.destroy(),Ze&&Ze.removeEventListener("SMUIDrawerScrim:click",Et)});function ct(){var bt,Gi;Ze&&Ze.removeEventListener("SMUIDrawerScrim:click",Et),G==="modal"&&(Ze=(Gi=(bt=ke.parentNode)===null||bt===void 0?void 0:bt.querySelector(".mdc-drawer-scrim"))!==null&&Gi!==void 0?Gi:!1,Ze&&Ze.addEventListener("SMUIDrawerScrim:click",Et));const hr=G==="dismissible"?uv:G==="modal"?$1:void 0;return hr?new hr({addClass:lt,removeClass:pi,hasClass:pt,elementHasClass:(wr,Dt)=>wr.classList.contains(Dt),saveFocus:()=>ft=document.activeElement,restoreFocus:()=>{ft&&"focus"in ft&&ke.contains(document.activeElement)&&ft.focus()},focusActiveNavigationItem:()=>{const wr=ke.querySelector(".mdc-list-item--activated,.mdc-deprecated-list-item--activated");wr&&wr.focus()},notifyClose:()=>{l(9,X=!1),Us(ke,"SMUIDrawer:closed",void 0,void 0,!0)},notifyOpen:()=>{l(9,X=!0),Us(ke,"SMUIDrawer:opened",void 0,void 0,!0)},trapFocus:()=>Ge.trapFocus(),releaseFocus:()=>Ge.releaseFocus()}):void 0}function pt(bt){return bt in We?We[bt]:qi().classList.contains(bt)}function lt(bt){We[bt]||l(6,We[bt]=!0,We)}function pi(bt){(!(bt in We)||We[bt])&&l(6,We[bt]=!1,We)}function Et(){qe&&"handleScrimClick"in qe&&qe.handleScrimClick()}function Wt(bt){l(9,X=bt)}function vi(){return X}function qi(){return ke}function Xt(bt){_n[bt?"unshift":"push"](()=>{ke=bt,l(5,ke)})}const Qt=bt=>qe&&qe.handleKeydown(bt),Ei=bt=>qe&&qe.handleTransitionEnd(bt);return c.$$set=bt=>{a=Ci(Ci({},a),Uo(bt)),l(8,T=br(a,x)),"use"in bt&&l(0,q=bt.use),"class"in bt&&l(1,V=bt.class),"variant"in bt&&l(2,G=bt.variant),"open"in bt&&l(9,X=bt.open),"fixed"in bt&&l(3,Me=bt.fixed),"$$scope"in bt&&l(14,f=bt.$$scope)},c.$$.update=()=>{c.$$.dirty&8212&&gt!==G&&(l(13,gt=G),qe&&qe.destroy(),l(6,We={}),l(4,qe=ct()),qe&&qe.init()),c.$$.dirty&528&&qe&&qe.isOpen()!==X&&(X?qe.open():qe.close())},[q,V,G,Me,qe,ke,We,R,T,X,Wt,vi,qi,gt,f,P,Xt,Qt,Ei]}class tb extends Rn{constructor(a){super(),Bn(this,a,eb,Q1,On,{use:0,class:1,variant:2,open:9,fixed:3,setOpen:10,isOpen:11,getElement:12})}get setOpen(){return this.$$.ctx[10]}get isOpen(){return this.$$.ctx[11]}get getElement(){return this.$$.ctx[12]}}var ib=hl({class:"mdc-drawer-app-content",component:Nd}),rb=hl({class:"mdc-drawer__content",component:Nd}),nb=hl({class:"mdc-drawer__header",component:Nd});hl({class:"mdc-drawer__title",component:a1});hl({class:"mdc-drawer__subtitle",component:s1});function ob(c){let a;const l=c[37].default,x=Co(l,c,c[43],null);return{c(){x&&x.c()},l(T){x&&x.l(T)},m(T,P){x&&x.m(T,P),a=!0},p(T,P){x&&x.p&&(!a||P[1]&4096)&&ko(x,l,T,T[43],a?Po(l,T[43],P,null):zo(T[43]),null)},i(T){a||(Mi(x,T),a=!0)},o(T){Ui(x,T),a=!1},d(T){x&&x.d(T)}}}function ab(c){let a,l,x;const T=[{use:[c[17],...c[0]]},{class:Ao({[c[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":c[2],"mdc-deprecated-list--dense":c[3],"mdc-deprecated-list--textual-list":c[4],"mdc-deprecated-list--avatar-list":c[5]||c[18],"mdc-deprecated-list--icon-list":c[6],"mdc-deprecated-list--image-list":c[7],"mdc-deprecated-list--thumbnail-list":c[8],"mdc-deprecated-list--video-list":c[9],"mdc-deprecated-list--two-line":c[10],"smui-list--three-line":c[11]&&!c[10]})},{role:c[15]},c[23]];var P=c[12];function f(d){let R={$$slots:{default:[ob]},$$scope:{ctx:d}};for(let q=0;q<T.length;q+=1)R=Ci(R,T[q]);return{props:R}}return P&&(a=new P(f(c)),c[38](a),a.$on("keydown",c[39]),a.$on("focusin",c[40]),a.$on("focusout",c[41]),a.$on("click",c[42]),a.$on("SMUIListItem:mount",c[19]),a.$on("SMUIListItem:unmount",c[20]),a.$on("SMUI:action",c[21])),{c(){a&&en(a.$$.fragment),l=Qo()},l(d){a&&In(a.$$.fragment,d),l=Qo()},m(d,R){a&&tn(a,d,R),Fi(d,l,R),x=!0},p(d,R){const q=R[0]&8818687?go(T,[R[0]&131073&&{use:[d[17],...d[0]]},R[0]&266238&&{class:Ao({[d[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":d[2],"mdc-deprecated-list--dense":d[3],"mdc-deprecated-list--textual-list":d[4],"mdc-deprecated-list--avatar-list":d[5]||d[18],"mdc-deprecated-list--icon-list":d[6],"mdc-deprecated-list--image-list":d[7],"mdc-deprecated-list--thumbnail-list":d[8],"mdc-deprecated-list--video-list":d[9],"mdc-deprecated-list--two-line":d[10],"smui-list--three-line":d[11]&&!d[10]})},R[0]&32768&&{role:d[15]},R[0]&8388608&&Fs(d[23])]):{};if(R[1]&4096&&(q.$$scope={dirty:R,ctx:d}),P!==(P=d[12])){if(a){$h();const V=a;Ui(V.$$.fragment,1,0,()=>{rn(V,1)}),Yh()}P?(a=new P(f(d)),d[38](a),a.$on("keydown",d[39]),a.$on("focusin",d[40]),a.$on("focusout",d[41]),a.$on("click",d[42]),a.$on("SMUIListItem:mount",d[19]),a.$on("SMUIListItem:unmount",d[20]),a.$on("SMUI:action",d[21]),en(a.$$.fragment),Mi(a.$$.fragment,1),tn(a,l.parentNode,l)):a=null}else P&&a.$set(q)},i(d){x||(a&&Mi(a.$$.fragment,d),x=!0)},o(d){a&&Ui(a.$$.fragment,d),x=!1},d(d){c[38](null),d&&Zt(l),a&&rn(a,d)}}}function sb(c,a,l){const x=["use","class","nonInteractive","dense","textualList","avatarList","iconList","imageList","thumbnailList","videoList","twoLine","threeLine","vertical","wrapFocus","singleSelection","selectedIndex","radioList","checkList","hasTypeahead","component","layout","setEnabled","getTypeaheadInProgress","getSelectedIndex","getFocusedItemIndex","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a;var d;const{closest:R,matches:q}=rv,V=No(Fo());let{use:G=[]}=a,{class:X=""}=a,{nonInteractive:Me=!1}=a,{dense:ke=!1}=a,{textualList:qe=!1}=a,{avatarList:We=!1}=a,{iconList:ft=!1}=a,{imageList:Ge=!1}=a,{thumbnailList:Ze=!1}=a,{videoList:gt=!1}=a,{twoLine:ct=!1}=a,{threeLine:pt=!1}=a,{vertical:lt=!0}=a,{wrapFocus:pi=(d=gs("SMUI:list:wrapFocus"))!==null&&d!==void 0?d:!1}=a,{singleSelection:Et=!1}=a,{selectedIndex:Wt=-1}=a,{radioList:vi=!1}=a,{checkList:qi=!1}=a,{hasTypeahead:Xt=!1}=a,Qt,Ei,bt=[],Gi=gs("SMUI:list:role"),hr=gs("SMUI:list:nav");const wr=new WeakMap;let Dt=gs("SMUI:dialog:selection"),oi=gs("SMUI:addLayoutListener"),fi,{component:Bi=hr?h1:p1}=a;Ea("SMUI:list:nonInteractive",Me),Ea("SMUI:separator:context","list"),Gi||(Et?(Gi="listbox",Ea("SMUI:list:item:role","option")):vi?(Gi="radiogroup",Ea("SMUI:list:item:role","radio")):qi?(Gi="group",Ea("SMUI:list:item:role","checkbox")):(Gi="list",Ea("SMUI:list:item:role",void 0))),oi&&(fi=oi(no)),yh(()=>{l(13,Ei=new J1({addClassForElementIndex:zt,focusItemAtIndex:rr,getAttributeForElementIndex:(_t,bi)=>{var pr,mr;return(mr=(pr=xi()[_t])===null||pr===void 0?void 0:pr.getAttr(bi))!==null&&mr!==void 0?mr:null},getFocusedElementIndex:()=>document.activeElement?xi().map(_t=>_t.element).indexOf(document.activeElement):-1,getListItemCount:()=>bt.length,getPrimaryTextAtIndex:ir,hasCheckboxAtIndex:_t=>{var bi,pr;return(pr=(bi=xi()[_t])===null||bi===void 0?void 0:bi.hasCheckbox)!==null&&pr!==void 0?pr:!1},hasRadioAtIndex:_t=>{var bi,pr;return(pr=(bi=xi()[_t])===null||bi===void 0?void 0:bi.hasRadio)!==null&&pr!==void 0?pr:!1},isCheckboxCheckedAtIndex:_t=>{var bi;const pr=xi()[_t];return(bi=(pr==null?void 0:pr.hasCheckbox)&&pr.checked)!==null&&bi!==void 0?bi:!1},isFocusInsideList:()=>Qt!=null&&Gn()!==document.activeElement&&Gn().contains(document.activeElement),isRootFocused:()=>Qt!=null&&document.activeElement===Gn(),listItemAtIndexHasClass:Ti,notifyAction:_t=>{l(24,Wt=_t),Qt!=null&&Us(Gn(),"SMUIList:action",{index:_t},void 0,!0)},removeClassForElementIndex:tr,setAttributeForElementIndex:Rt,setCheckedCheckboxOrRadioAtIndex:(_t,bi)=>{xi()[_t].checked=bi},setTabIndexForListItemChildren:(_t,bi)=>{const pr=xi()[_t],mr="button:not(:disabled), a";Array.prototype.forEach.call(pr.element.querySelectorAll(mr),Hn=>{Hn.setAttribute("tabindex",bi)})}}));const Ue={get element(){return Gn()},get items(){return bt},get typeaheadInProgress(){return Ei.isTypeaheadInProgress()},typeaheadMatchItem(_t,bi){return Ei.typeaheadMatchItem(_t,bi,!0)},getOrderedList:xi,focusItemAtIndex:rr,addClassForElementIndex:zt,removeClassForElementIndex:tr,setAttributeForElementIndex:Rt,removeAttributeForElementIndex:rt,getAttributeFromElementIndex:yi,getPrimaryTextAtIndex:ir};return Us(Gn(),"SMUIList:mount",Ue),Ei.init(),()=>{Ei.destroy()}}),Ud(()=>{fi&&fi()});function Nt(Ue){bt.push(Ue.detail),wr.set(Ue.detail.element,Ue.detail),Et&&Ue.detail.selected&&l(24,Wt=Cr(Ue.detail.element)),Ue.stopPropagation()}function Xi(Ue){var _t;const bi=(_t=Ue.detail&&bt.indexOf(Ue.detail))!==null&&_t!==void 0?_t:-1;bi!==-1&&(bt.splice(bi,1),bt=bt,wr.delete(Ue.detail.element)),Ue.stopPropagation()}function Li(Ue){if(vi||qi){const _t=Cr(Ue.target);if(_t!==-1){const bi=xi()[_t];bi&&(vi&&!bi.checked||qi)&&(bi.checked=!bi.checked,bi.activateRipple(),window.requestAnimationFrame(()=>{bi.deactivateRipple()}))}}}function xi(){return Qt==null?[]:[...Gn().children].map(Ue=>wr.get(Ue)).filter(Ue=>Ue&&Ue._smui_list_item_accessor)}function rr(Ue){const _t=xi()[Ue];_t&&"focus"in _t.element&&_t.element.focus()}function Ti(Ue,_t){var bi;const pr=xi()[Ue];return(bi=pr&&pr.hasClass(_t))!==null&&bi!==void 0?bi:!1}function zt(Ue,_t){const bi=xi()[Ue];bi&&bi.addClass(_t)}function tr(Ue,_t){const bi=xi()[Ue];bi&&bi.removeClass(_t)}function Rt(Ue,_t,bi){const pr=xi()[Ue];pr&&pr.addAttr(_t,bi)}function rt(Ue,_t){const bi=xi()[Ue];bi&&bi.removeAttr(_t)}function yi(Ue,_t){const bi=xi()[Ue];return bi?bi.getAttr(_t):null}function ir(Ue){var _t;const bi=xi()[Ue];return(_t=bi&&bi.getPrimaryText())!==null&&_t!==void 0?_t:""}function Cr(Ue){const _t=R(Ue,".mdc-deprecated-list-item, .mdc-deprecated-list");return _t&&q(_t,".mdc-deprecated-list-item")?xi().map(bi=>bi==null?void 0:bi.element).indexOf(_t):-1}function no(){return Ei.layout()}function qn(Ue,_t){return Ei.setEnabled(Ue,_t)}function Mo(){return Ei.isTypeaheadInProgress()}function fn(){return Ei.getSelectedIndex()}function oo(){return Ei.getFocusedItemIndex()}function Gn(){return Qt.getElement()}function Zi(Ue){_n[Ue?"unshift":"push"](()=>{Qt=Ue,l(14,Qt)})}const Fn=Ue=>Ei&&Ei.handleKeydown(Ue,Ue.target.classList.contains("mdc-deprecated-list-item"),Cr(Ue.target)),_o=Ue=>Ei&&Ei.handleFocusIn(Cr(Ue.target)),Zn=Ue=>Ei&&Ei.handleFocusOut(Cr(Ue.target)),Ra=Ue=>Ei&&Ei.handleClick(Cr(Ue.target),!q(Ue.target,'input[type="checkbox"], input[type="radio"]'));return c.$$set=Ue=>{a=Ci(Ci({},a),Uo(Ue)),l(23,T=br(a,x)),"use"in Ue&&l(0,G=Ue.use),"class"in Ue&&l(1,X=Ue.class),"nonInteractive"in Ue&&l(2,Me=Ue.nonInteractive),"dense"in Ue&&l(3,ke=Ue.dense),"textualList"in Ue&&l(4,qe=Ue.textualList),"avatarList"in Ue&&l(5,We=Ue.avatarList),"iconList"in Ue&&l(6,ft=Ue.iconList),"imageList"in Ue&&l(7,Ge=Ue.imageList),"thumbnailList"in Ue&&l(8,Ze=Ue.thumbnailList),"videoList"in Ue&&l(9,gt=Ue.videoList),"twoLine"in Ue&&l(10,ct=Ue.twoLine),"threeLine"in Ue&&l(11,pt=Ue.threeLine),"vertical"in Ue&&l(25,lt=Ue.vertical),"wrapFocus"in Ue&&l(26,pi=Ue.wrapFocus),"singleSelection"in Ue&&l(27,Et=Ue.singleSelection),"selectedIndex"in Ue&&l(24,Wt=Ue.selectedIndex),"radioList"in Ue&&l(28,vi=Ue.radioList),"checkList"in Ue&&l(29,qi=Ue.checkList),"hasTypeahead"in Ue&&l(30,Xt=Ue.hasTypeahead),"component"in Ue&&l(12,Bi=Ue.component),"$$scope"in Ue&&l(43,f=Ue.$$scope)},c.$$.update=()=>{c.$$.dirty[0]&33562624&&Ei&&Ei.setVerticalOrientation(lt),c.$$.dirty[0]&67117056&&Ei&&Ei.setWrapFocus(pi),c.$$.dirty[0]&1073750016&&Ei&&Ei.setHasTypeahead(Xt),c.$$.dirty[0]&134225920&&Ei&&Ei.setSingleSelection(Et),c.$$.dirty[0]&151003136&&Ei&&Et&&fn()!==Wt&&Ei.setSelectedIndex(Wt)},[G,X,Me,ke,qe,We,ft,Ge,Ze,gt,ct,pt,Bi,Ei,Qt,Gi,q,V,Dt,Nt,Xi,Li,Cr,T,Wt,lt,pi,Et,vi,qi,Xt,no,qn,Mo,fn,oo,Gn,P,Zi,Fn,_o,Zn,Ra,f]}class lb extends Rn{constructor(a){super(),Bn(this,a,sb,ab,On,{use:0,class:1,nonInteractive:2,dense:3,textualList:4,avatarList:5,iconList:6,imageList:7,thumbnailList:8,videoList:9,twoLine:10,threeLine:11,vertical:25,wrapFocus:26,singleSelection:27,selectedIndex:24,radioList:28,checkList:29,hasTypeahead:30,component:12,layout:31,setEnabled:32,getTypeaheadInProgress:33,getSelectedIndex:34,getFocusedItemIndex:35,getElement:36},null,[-1,-1])}get layout(){return this.$$.ctx[31]}get setEnabled(){return this.$$.ctx[32]}get getTypeaheadInProgress(){return this.$$.ctx[33]}get getSelectedIndex(){return this.$$.ctx[34]}get getFocusedItemIndex(){return this.$$.ctx[35]}get getElement(){return this.$$.ctx[36]}}function __(c){let a;return{c(){a=Tr("span"),this.h()},l(l){a=Ar(l,"SPAN",{class:!0}),Zr(a).forEach(Zt),this.h()},h(){Ur(a,"class","mdc-deprecated-list-item__ripple")},m(l,x){Fi(l,a,x)},d(l){l&&Zt(a)}}}function ub(c){let a,l,x=c[7]&&__();const T=c[32].default,P=Co(T,c,c[35],null);return{c(){x&&x.c(),a=Qo(),P&&P.c()},l(f){x&&x.l(f),a=Qo(),P&&P.l(f)},m(f,d){x&&x.m(f,d),Fi(f,a,d),P&&P.m(f,d),l=!0},p(f,d){f[7]?x||(x=__(),x.c(),x.m(a.parentNode,a)):x&&(x.d(1),x=null),P&&P.p&&(!l||d[1]&16)&&ko(P,T,f,f[35],l?Po(T,f[35],d,null):zo(f[35]),null)},i(f){l||(Mi(P,f),l=!0)},o(f){Ui(P,f),l=!1},d(f){x&&x.d(f),f&&Zt(a),P&&P.d(f)}}}function cb(c){let a,l,x;const T=[{use:[...c[6]?[]:[[Dd,{ripple:!c[14],unbounded:!1,color:(c[1]||c[0])&&c[5]==null?"primary":c[5],disabled:c[9],addClass:c[22],removeClass:c[23],addStyle:c[24]}]],c[20],...c[2]]},{class:Ao(sl({[c[3]]:!0,"mdc-deprecated-list-item":!0,"mdc-deprecated-list-item--activated":c[1],"mdc-deprecated-list-item--selected":c[0],"mdc-deprecated-list-item--disabled":c[9],"mdc-menu-item--selected":!c[21]&&c[8]==="menuitem"&&c[0],"smui-menu-item--non-interactive":c[6]},c[16]))},{style:Object.entries(c[17]).map(v_).concat([c[4]]).join(" ")},c[21]&&c[1]?{"aria-current":"page"}:{},c[21]?{}:{role:c[8]},!c[21]&&c[8]==="option"?{"aria-selected":c[0]?"true":"false"}:{},!c[21]&&(c[8]==="radio"||c[8]==="checkbox")?{"aria-checked":c[14]&&c[14].checked?"true":"false"}:{},c[21]?{}:{"aria-disabled":c[9]?"true":"false"},{"data-menu-item-skip-restore-focus":c[10]||void 0},{tabindex:c[19]},{href:c[11]},c[18],c[27]];var P=c[12];function f(d){let R={$$slots:{default:[ub]},$$scope:{ctx:d}};for(let q=0;q<T.length;q+=1)R=Ci(R,T[q]);return{props:R}}return P&&(a=new P(f(c)),c[33](a),a.$on("click",c[13]),a.$on("keydown",c[25]),a.$on("SMUIGenericInput:mount",c[26]),a.$on("SMUIGenericInput:unmount",c[34])),{c(){a&&en(a.$$.fragment),l=Qo()},l(d){a&&In(a.$$.fragment,d),l=Qo()},m(d,R){a&&tn(a,d,R),Fi(d,l,R),x=!0},p(d,R){const q=R[0]&167726975?go(T,[R[0]&30425703&&{use:[...d[6]?[]:[[Dd,{ripple:!d[14],unbounded:!1,color:(d[1]||d[0])&&d[5]==null?"primary":d[5],disabled:d[9],addClass:d[22],removeClass:d[23],addStyle:d[24]}]],d[20],...d[2]]},R[0]&2163531&&{class:Ao(sl({[d[3]]:!0,"mdc-deprecated-list-item":!0,"mdc-deprecated-list-item--activated":d[1],"mdc-deprecated-list-item--selected":d[0],"mdc-deprecated-list-item--disabled":d[9],"mdc-menu-item--selected":!d[21]&&d[8]==="menuitem"&&d[0],"smui-menu-item--non-interactive":d[6]},d[16]))},R[0]&131088&&{style:Object.entries(d[17]).map(v_).concat([d[4]]).join(" ")},R[0]&2097154&&Fs(d[21]&&d[1]?{"aria-current":"page"}:{}),R[0]&2097408&&Fs(d[21]?{}:{role:d[8]}),R[0]&2097409&&Fs(!d[21]&&d[8]==="option"?{"aria-selected":d[0]?"true":"false"}:{}),R[0]&2113792&&Fs(!d[21]&&(d[8]==="radio"||d[8]==="checkbox")?{"aria-checked":d[14]&&d[14].checked?"true":"false"}:{}),R[0]&2097664&&Fs(d[21]?{}:{"aria-disabled":d[9]?"true":"false"}),R[0]&1024&&{"data-menu-item-skip-restore-focus":d[10]||void 0},R[0]&524288&&{tabindex:d[19]},R[0]&2048&&{href:d[11]},R[0]&262144&&Fs(d[18]),R[0]&134217728&&Fs(d[27])]):{};if(R[0]&128|R[1]&16&&(q.$$scope={dirty:R,ctx:d}),P!==(P=d[12])){if(a){$h();const V=a;Ui(V.$$.fragment,1,0,()=>{rn(V,1)}),Yh()}P?(a=new P(f(d)),d[33](a),a.$on("click",d[13]),a.$on("keydown",d[25]),a.$on("SMUIGenericInput:mount",d[26]),a.$on("SMUIGenericInput:unmount",d[34]),en(a.$$.fragment),Mi(a.$$.fragment,1),tn(a,l.parentNode,l)):a=null}else P&&a.$set(q)},i(d){x||(a&&Mi(a.$$.fragment,d),x=!0)},o(d){a&&Ui(a.$$.fragment,d),x=!1},d(d){c[33](null),d&&Zt(l),a&&rn(a,d)}}}let hb=0;const v_=([c,a])=>`${c}: ${a};`;function pb(c,a,l){let x;const T=["use","class","style","color","nonInteractive","ripple","activated","role","selected","disabled","skipRestoreFocus","tabindex","inputId","href","component","action","getPrimaryText","getElement"];let P=br(a,T),{$$slots:f={},$$scope:d}=a;var R;const q=No(Fo());let V=()=>{};function G(rt){return rt===V}let{use:X=[]}=a,{class:Me=""}=a,{style:ke=""}=a,{color:qe=void 0}=a,{nonInteractive:We=(R=gs("SMUI:list:nonInteractive"))!==null&&R!==void 0?R:!1}=a;Ea("SMUI:list:nonInteractive",void 0);let{ripple:ft=!We}=a,{activated:Ge=!1}=a,{role:Ze=gs("SMUI:list:item:role")}=a;Ea("SMUI:list:item:role",void 0);let{selected:gt=!1}=a,{disabled:ct=!1}=a,{skipRestoreFocus:pt=!1}=a,{tabindex:lt=V}=a,{inputId:pi="SMUI-form-field-list-"+hb++}=a,{href:Et=void 0}=a,Wt,vi={},qi={},Xt={},Qt,Ei,bt=gs("SMUI:list:item:nav"),{component:Gi=bt?Et?av:Vp:u1}=a;Ea("SMUI:generic:input:props",{id:pi}),Ea("SMUI:separator:context",void 0),yh(()=>{if(!gt&&!We){let yi=!0,ir=Wt;for(;ir.previousSibling;)if(ir=ir.previousSibling,ir.nodeType===1&&ir.classList.contains("mdc-deprecated-list-item")&&!ir.classList.contains("mdc-deprecated-list-item--disabled")){yi=!1;break}yi&&(Ei=window.requestAnimationFrame(Xi))}const rt={_smui_list_item_accessor:!0,get element(){return zt()},get selected(){return gt},set selected(yi){l(0,gt=yi)},hasClass:hr,addClass:wr,removeClass:Dt,getAttr:fi,addAttr:Bi,removeAttr:Nt,getPrimaryText:Ti,get checked(){var yi;return(yi=Qt&&Qt.checked)!==null&&yi!==void 0?yi:!1},set checked(yi){Qt&&l(14,Qt.checked=!!yi,Qt)},get hasCheckbox(){return!!(Qt&&"_smui_checkbox_accessor"in Qt)},get hasRadio(){return!!(Qt&&"_smui_radio_accessor"in Qt)},activateRipple(){Qt&&Qt.activateRipple()},deactivateRipple(){Qt&&Qt.deactivateRipple()},getValue(){return P.value},action:rr,get tabindex(){return x},set tabindex(yi){l(28,lt=yi)},get disabled(){return ct},get activated(){return Ge},set activated(yi){l(1,Ge=yi)}};return Us(zt(),"SMUIListItem:mount",rt),()=>{Us(zt(),"SMUIListItem:unmount",rt)}}),Ud(()=>{Ei&&window.cancelAnimationFrame(Ei)});function hr(rt){return rt in vi?vi[rt]:zt().classList.contains(rt)}function wr(rt){vi[rt]||l(16,vi[rt]=!0,vi)}function Dt(rt){(!(rt in vi)||vi[rt])&&l(16,vi[rt]=!1,vi)}function oi(rt,yi){qi[rt]!=yi&&(yi===""||yi==null?(delete qi[rt],l(17,qi)):l(17,qi[rt]=yi,qi))}function fi(rt){var yi;return rt in Xt?(yi=Xt[rt])!==null&&yi!==void 0?yi:null:zt().getAttribute(rt)}function Bi(rt,yi){Xt[rt]!==yi&&l(18,Xt[rt]=yi,Xt)}function Nt(rt){(!(rt in Xt)||Xt[rt]!=null)&&l(18,Xt[rt]=void 0,Xt)}function Xi(){let rt=!0,yi=Wt.getElement();for(;yi.nextElementSibling;)if(yi=yi.nextElementSibling,yi.nodeType===1&&yi.classList.contains("mdc-deprecated-list-item")){const ir=yi.attributes.getNamedItem("tabindex");if(ir&&ir.value==="0"){rt=!1;break}}rt&&l(19,x=0)}function Li(rt){const yi=rt.key==="Enter",ir=rt.key==="Space";(yi||ir)&&rr(rt)}function xi(rt){("_smui_checkbox_accessor"in rt.detail||"_smui_radio_accessor"in rt.detail)&&l(14,Qt=rt.detail)}function rr(rt){ct||Us(zt(),"SMUI:action",rt)}function Ti(){var rt,yi,ir;const Cr=zt(),no=Cr.querySelector(".mdc-deprecated-list-item__primary-text");if(no)return(rt=no.textContent)!==null&&rt!==void 0?rt:"";const qn=Cr.querySelector(".mdc-deprecated-list-item__text");return qn?(yi=qn.textContent)!==null&&yi!==void 0?yi:"":(ir=Cr.textContent)!==null&&ir!==void 0?ir:""}function zt(){return Wt.getElement()}function tr(rt){_n[rt?"unshift":"push"](()=>{Wt=rt,l(15,Wt)})}const Rt=()=>l(14,Qt=void 0);return c.$$set=rt=>{a=Ci(Ci({},a),Uo(rt)),l(27,P=br(a,T)),"use"in rt&&l(2,X=rt.use),"class"in rt&&l(3,Me=rt.class),"style"in rt&&l(4,ke=rt.style),"color"in rt&&l(5,qe=rt.color),"nonInteractive"in rt&&l(6,We=rt.nonInteractive),"ripple"in rt&&l(7,ft=rt.ripple),"activated"in rt&&l(1,Ge=rt.activated),"role"in rt&&l(8,Ze=rt.role),"selected"in rt&&l(0,gt=rt.selected),"disabled"in rt&&l(9,ct=rt.disabled),"skipRestoreFocus"in rt&&l(10,pt=rt.skipRestoreFocus),"tabindex"in rt&&l(28,lt=rt.tabindex),"inputId"in rt&&l(29,pi=rt.inputId),"href"in rt&&l(11,Et=rt.href),"component"in rt&&l(12,Gi=rt.component),"$$scope"in rt&&l(35,d=rt.$$scope)},c.$$.update=()=>{c.$$.dirty[0]&268452417&&l(19,x=G(lt)?!We&&!ct&&(gt||Qt&&Qt.checked)?0:-1:lt)},[gt,Ge,X,Me,ke,qe,We,ft,Ze,ct,pt,Et,Gi,rr,Qt,Wt,vi,qi,Xt,x,q,bt,wr,Dt,oi,Li,xi,P,lt,pi,Ti,zt,f,tr,Rt,d]}class db extends Rn{constructor(a){super(),Bn(this,a,pb,cb,On,{use:2,class:3,style:4,color:5,nonInteractive:6,ripple:7,activated:1,role:8,selected:0,disabled:9,skipRestoreFocus:10,tabindex:28,inputId:29,href:11,component:12,action:13,getPrimaryText:30,getElement:31},null,[-1,-1])}get action(){return this.$$.ctx[13]}get getPrimaryText(){return this.$$.ctx[30]}get getElement(){return this.$$.ctx[31]}}hl({class:"mdc-deprecated-list-item__text",component:Vp});hl({class:"mdc-deprecated-list-item__primary-text",component:Vp});hl({class:"mdc-deprecated-list-item__secondary-text",component:Vp});hl({class:"mdc-deprecated-list-item__meta",component:Vp});hl({class:"mdc-deprecated-list-group",component:Nd});hl({class:"mdc-deprecated-list-group__subheader",component:l1});const fb=db;/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Ad={ANIM_CHECKED_INDETERMINATE:"mdc-checkbox--anim-checked-indeterminate",ANIM_CHECKED_UNCHECKED:"mdc-checkbox--anim-checked-unchecked",ANIM_INDETERMINATE_CHECKED:"mdc-checkbox--anim-indeterminate-checked",ANIM_INDETERMINATE_UNCHECKED:"mdc-checkbox--anim-indeterminate-unchecked",ANIM_UNCHECKED_CHECKED:"mdc-checkbox--anim-unchecked-checked",ANIM_UNCHECKED_INDETERMINATE:"mdc-checkbox--anim-unchecked-indeterminate",BACKGROUND:"mdc-checkbox__background",CHECKED:"mdc-checkbox--checked",CHECKMARK:"mdc-checkbox__checkmark",CHECKMARK_PATH:"mdc-checkbox__checkmark-path",DISABLED:"mdc-checkbox--disabled",INDETERMINATE:"mdc-checkbox--indeterminate",MIXEDMARK:"mdc-checkbox__mixedmark",NATIVE_CONTROL:"mdc-checkbox__native-control",ROOT:"mdc-checkbox",SELECTED:"mdc-checkbox--selected",UPGRADED:"mdc-checkbox--upgraded"},Pl={ARIA_CHECKED_ATTR:"aria-checked",ARIA_CHECKED_INDETERMINATE_VALUE:"mixed",DATA_INDETERMINATE_ATTR:"data-indeterminate",NATIVE_CONTROL_SELECTOR:".mdc-checkbox__native-control",TRANSITION_STATE_CHECKED:"checked",TRANSITION_STATE_INDETERMINATE:"indeterminate",TRANSITION_STATE_INIT:"init",TRANSITION_STATE_UNCHECKED:"unchecked"},x_={ANIM_END_LATCH_MS:250};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var mb=function(c){vu(a,c);function a(l){var x=c.call(this,La(La({},a.defaultAdapter),l))||this;return x.currentCheckState=Pl.TRANSITION_STATE_INIT,x.currentAnimationClass="",x.animEndLatchTimer=0,x.enableAnimationEndHandler=!1,x}return Object.defineProperty(a,"cssClasses",{get:function(){return Ad},enumerable:!1,configurable:!0}),Object.defineProperty(a,"strings",{get:function(){return Pl},enumerable:!1,configurable:!0}),Object.defineProperty(a,"numbers",{get:function(){return x_},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultAdapter",{get:function(){return{addClass:function(){},forceLayout:function(){},hasNativeControl:function(){return!1},isAttachedToDOM:function(){return!1},isChecked:function(){return!1},isIndeterminate:function(){return!1},removeClass:function(){},removeNativeControlAttr:function(){},setNativeControlAttr:function(){},setNativeControlDisabled:function(){}}},enumerable:!1,configurable:!0}),a.prototype.init=function(){this.currentCheckState=this.determineCheckState(),this.updateAriaChecked(),this.adapter.addClass(Ad.UPGRADED)},a.prototype.destroy=function(){clearTimeout(this.animEndLatchTimer)},a.prototype.setDisabled=function(l){this.adapter.setNativeControlDisabled(l),l?this.adapter.addClass(Ad.DISABLED):this.adapter.removeClass(Ad.DISABLED)},a.prototype.handleAnimationEnd=function(){var l=this;!this.enableAnimationEndHandler||(clearTimeout(this.animEndLatchTimer),this.animEndLatchTimer=setTimeout(function(){l.adapter.removeClass(l.currentAnimationClass),l.enableAnimationEndHandler=!1},x_.ANIM_END_LATCH_MS))},a.prototype.handleChange=function(){this.transitionCheckState()},a.prototype.transitionCheckState=function(){if(!!this.adapter.hasNativeControl()){var l=this.currentCheckState,x=this.determineCheckState();if(l!==x){this.updateAriaChecked();var T=Pl.TRANSITION_STATE_UNCHECKED,P=Ad.SELECTED;x===T?this.adapter.removeClass(P):this.adapter.addClass(P),this.currentAnimationClass.length>0&&(clearTimeout(this.animEndLatchTimer),this.adapter.forceLayout(),this.adapter.removeClass(this.currentAnimationClass)),this.currentAnimationClass=this.getTransitionAnimationClass(l,x),this.currentCheckState=x,this.adapter.isAttachedToDOM()&&this.currentAnimationClass.length>0&&(this.adapter.addClass(this.currentAnimationClass),this.enableAnimationEndHandler=!0)}}},a.prototype.determineCheckState=function(){var l=Pl.TRANSITION_STATE_INDETERMINATE,x=Pl.TRANSITION_STATE_CHECKED,T=Pl.TRANSITION_STATE_UNCHECKED;return this.adapter.isIndeterminate()?l:this.adapter.isChecked()?x:T},a.prototype.getTransitionAnimationClass=function(l,x){var T=Pl.TRANSITION_STATE_INIT,P=Pl.TRANSITION_STATE_CHECKED,f=Pl.TRANSITION_STATE_UNCHECKED,d=a.cssClasses,R=d.ANIM_UNCHECKED_CHECKED,q=d.ANIM_UNCHECKED_INDETERMINATE,V=d.ANIM_CHECKED_UNCHECKED,G=d.ANIM_CHECKED_INDETERMINATE,X=d.ANIM_INDETERMINATE_CHECKED,Me=d.ANIM_INDETERMINATE_UNCHECKED;switch(l){case T:return x===f?"":x===P?X:Me;case f:return x===P?R:q;case P:return x===f?V:G;default:return x===P?X:Me}},a.prototype.updateAriaChecked=function(){this.adapter.isIndeterminate()?this.adapter.setNativeControlAttr(Pl.ARIA_CHECKED_ATTR,Pl.ARIA_CHECKED_INDETERMINATE_VALUE):this.adapter.removeNativeControlAttr(Pl.ARIA_CHECKED_ATTR)},a}(Qh);function yb(c){let a,l,x,T,P,f,d,R,q,V,G,X,Me,ke,qe,We,ft,Ge,Ze,gt,ct=[{class:x=Ao({[c[9]]:!0,"mdc-checkbox__native-control":!0})},{type:"checkbox"},c[20],{disabled:c[1]},{__value:T=c[19](c[7])?c[6]:c[7]},{"data-indeterminate":P=!c[19](c[0])&&c[0]?"true":void 0},c[16],qf(c[26],"input$")],pt={};for(let Et=0;Et<ct.length;Et+=1)pt=Ci(pt,ct[Et]);let lt=[{class:qe=Ao(sl({[c[3]]:!0,"mdc-checkbox":!0,"mdc-checkbox--disabled":c[1],"mdc-checkbox--touch":c[5],"mdc-data-table__header-row-checkbox":c[21]==="data-table"&&c[22],"mdc-data-table__row-checkbox":c[21]==="data-table"&&!c[22]},c[14]))},{style:We=Object.entries(c[15]).map(b_).concat([c[4]]).join(" ")},Vf(c[26],["input$"])],pi={};for(let Et=0;Et<lt.length;Et+=1)pi=Ci(pi,lt[Et]);return{c(){a=Tr("div"),l=Tr("input"),d=pa(),R=Tr("div"),q=o_("svg"),V=o_("path"),G=pa(),X=Tr("div"),Me=pa(),ke=Tr("div"),this.h()},l(Et){a=Ar(Et,"DIV",{class:!0,style:!0});var Wt=Zr(a);l=Ar(Wt,"INPUT",{class:!0,type:!0,"data-indeterminate":!0}),d=da(Wt),R=Ar(Wt,"DIV",{class:!0});var vi=Zr(R);q=a_(vi,"svg",{class:!0,viewBox:!0});var qi=Zr(q);V=a_(qi,"path",{class:!0,fill:!0,d:!0}),Zr(V).forEach(Zt),qi.forEach(Zt),G=da(vi),X=Ar(vi,"DIV",{class:!0}),Zr(X).forEach(Zt),vi.forEach(Zt),Me=da(Wt),ke=Ar(Wt,"DIV",{class:!0}),Zr(ke).forEach(Zt),Wt.forEach(Zt),this.h()},h(){Hr(l,pt),Ur(V,"class","mdc-checkbox__checkmark-path"),Ur(V,"fill","none"),Ur(V,"d","M1.73,12.91 8.1,19.28 22.79,4.59"),Ur(q,"class","mdc-checkbox__checkmark"),Ur(q,"viewBox","0 0 24 24"),Ur(X,"class","mdc-checkbox__mixedmark"),Ur(R,"class","mdc-checkbox__background"),Ur(ke,"class","mdc-checkbox__ripple"),Hr(a,pi)},m(Et,Wt){Fi(Et,a,Wt),wa(a,l),l.autofocus&&l.focus(),c[36](l),l.checked=c[12],wa(a,d),wa(a,R),wa(R,q),wa(q,V),wa(R,G),wa(R,X),wa(a,Me),wa(a,ke),c[38](a),Ze||(gt=[Jr(f=Ia.call(null,l,c[8])),ll(l,"change",c[37]),ll(l,"blur",c[34]),ll(l,"focus",c[35]),Jr(ft=Ia.call(null,a,c[2])),Jr(c[18].call(null,a)),Jr(Ge=Dd.call(null,a,{unbounded:!0,addClass:c[23],removeClass:c[24],addStyle:c[25],active:c[17],eventTarget:c[11]})),ll(a,"animationend",c[39])],Ze=!0)},p(Et,Wt){Hr(l,pt=go(ct,[Wt[0]&512&&x!==(x=Ao({[Et[9]]:!0,"mdc-checkbox__native-control":!0}))&&{class:x},{type:"checkbox"},Et[20],Wt[0]&2&&{disabled:Et[1]},Wt[0]&192&&T!==(T=Et[19](Et[7])?Et[6]:Et[7])&&{__value:T},Wt[0]&1&&P!==(P=!Et[19](Et[0])&&Et[0]?"true":void 0)&&{"data-indeterminate":P},Wt[0]&65536&&Et[16],Wt[0]&67108864&&qf(Et[26],"input$")])),f&&ha(f.update)&&Wt[0]&256&&f.update.call(null,Et[8]),Wt[0]&4096&&(l.checked=Et[12]),Hr(a,pi=go(lt,[Wt[0]&16426&&qe!==(qe=Ao(sl({[Et[3]]:!0,"mdc-checkbox":!0,"mdc-checkbox--disabled":Et[1],"mdc-checkbox--touch":Et[5],"mdc-data-table__header-row-checkbox":Et[21]==="data-table"&&Et[22],"mdc-data-table__row-checkbox":Et[21]==="data-table"&&!Et[22]},Et[14])))&&{class:qe},Wt[0]&32784&&We!==(We=Object.entries(Et[15]).map(b_).concat([Et[4]]).join(" "))&&{style:We},Wt[0]&67108864&&Vf(Et[26],["input$"])])),ft&&ha(ft.update)&&Wt[0]&4&&ft.update.call(null,Et[2]),Ge&&ha(Ge.update)&&Wt[0]&133120&&Ge.update.call(null,{unbounded:!0,addClass:Et[23],removeClass:Et[24],addStyle:Et[25],active:Et[17],eventTarget:Et[11]})},i:cl,o:cl,d(Et){Et&&Zt(a),c[36](null),c[38](null),Ze=!1,Ya(gt)}}}const b_=([c,a])=>`${c}: ${a};`;function gb(c,a,l){const x=["use","class","style","disabled","touch","indeterminate","group","checked","value","valueKey","input$use","input$class","getId","getElement"];let T=br(a,x);var P;const f=No(Fo());let d=()=>{};function R(Rt){return Rt===d}let{use:q=[]}=a,{class:V=""}=a,{style:G=""}=a,{disabled:X=!1}=a,{touch:Me=!1}=a,{indeterminate:ke=d}=a,{group:qe=d}=a,{checked:We=d}=a,{value:ft=null}=a,{valueKey:Ge=d}=a,{input$use:Ze=[]}=a,{input$class:gt=""}=a,ct,pt,lt,pi={},Et={},Wt={},vi=!1,qi=(P=gs("SMUI:generic:input:props"))!==null&&P!==void 0?P:{},Xt=R(qe)?R(We)?!1:We!=null?We:void 0:qe.indexOf(ft)!==-1,Qt=gs("SMUI:checkbox:context"),Ei=gs("SMUI:data-table:row:header"),bt=We,Gi=R(qe)?[]:[...qe],hr=Xt;yh(()=>{l(11,lt.indeterminate=!R(ke)&&ke,lt),l(10,pt=new mb({addClass:wr,forceLayout:()=>ct.offsetWidth,hasNativeControl:()=>!0,isAttachedToDOM:()=>Boolean(ct.parentNode),isChecked:()=>Xt!=null?Xt:!1,isIndeterminate:()=>R(ke)?!1:ke,removeClass:Dt,removeNativeControlAttr:Bi,setNativeControlAttr:fi,setNativeControlDisabled:rt=>l(1,X=rt)}));const Rt={_smui_checkbox_accessor:!0,get element(){return Xi()},get checked(){return Xt!=null?Xt:!1},set checked(rt){Xt!==rt&&l(12,Xt=rt)},get indeterminate(){return R(ke)?!1:ke},set indeterminate(rt){l(0,ke=rt)},activateRipple(){X||l(17,vi=!0)},deactivateRipple(){l(17,vi=!1)}};return Us(ct,"SMUIGenericInput:mount",Rt),Us(ct,"SMUICheckbox:mount",Rt),pt.init(),()=>{Us(ct,"SMUIGenericInput:unmount",Rt),Us(ct,"SMUICheckbox:unmount",Rt),pt.destroy()}});function wr(Rt){pi[Rt]||l(14,pi[Rt]=!0,pi)}function Dt(Rt){(!(Rt in pi)||pi[Rt])&&l(14,pi[Rt]=!1,pi)}function oi(Rt,rt){Et[Rt]!=rt&&(rt===""||rt==null?(delete Et[Rt],l(15,Et)):l(15,Et[Rt]=rt,Et))}function fi(Rt,rt){Wt[Rt]!==rt&&l(16,Wt[Rt]=rt,Wt)}function Bi(Rt){(!(Rt in Wt)||Wt[Rt]!=null)&&l(16,Wt[Rt]=void 0,Wt)}function Nt(){return qi&&qi.id}function Xi(){return ct}function Li(Rt){Dy.call(this,c,Rt)}function xi(Rt){Dy.call(this,c,Rt)}function rr(Rt){_n[Rt?"unshift":"push"](()=>{lt=Rt,l(11,lt),l(27,qe),l(33,hr),l(12,Xt),l(6,ft),l(32,Gi),l(28,We),l(31,bt),l(0,ke),l(10,pt)})}function Ti(){Xt=this.checked,l(12,Xt),l(27,qe),l(33,hr),l(6,ft),l(32,Gi),l(28,We),l(31,bt),l(0,ke),l(11,lt),l(10,pt)}function zt(Rt){_n[Rt?"unshift":"push"](()=>{ct=Rt,l(13,ct)})}const tr=()=>pt&&pt.handleAnimationEnd();return c.$$set=Rt=>{a=Ci(Ci({},a),Uo(Rt)),l(26,T=br(a,x)),"use"in Rt&&l(2,q=Rt.use),"class"in Rt&&l(3,V=Rt.class),"style"in Rt&&l(4,G=Rt.style),"disabled"in Rt&&l(1,X=Rt.disabled),"touch"in Rt&&l(5,Me=Rt.touch),"indeterminate"in Rt&&l(0,ke=Rt.indeterminate),"group"in Rt&&l(27,qe=Rt.group),"checked"in Rt&&l(28,We=Rt.checked),"value"in Rt&&l(6,ft=Rt.value),"valueKey"in Rt&&l(7,Ge=Rt.valueKey),"input$use"in Rt&&l(8,Ze=Rt.input$use),"input$class"in Rt&&l(9,gt=Rt.input$class)},c.$$.update=()=>{if(c.$$.dirty[0]&402660417|c.$$.dirty[1]&7){let Rt=!1;if(!R(qe))if(hr!==Xt){const rt=qe.indexOf(ft);Xt&&rt===-1?(qe.push(ft),l(27,qe),l(33,hr),l(12,Xt),l(6,ft),l(32,Gi),l(28,We),l(31,bt),l(0,ke),l(11,lt),l(10,pt)):!Xt&&rt!==-1&&(qe.splice(rt,1),l(27,qe),l(33,hr),l(12,Xt),l(6,ft),l(32,Gi),l(28,We),l(31,bt),l(0,ke),l(11,lt),l(10,pt)),Rt=!0}else{const rt=Gi.indexOf(ft),yi=qe.indexOf(ft);rt>-1&&yi===-1?(l(12,Xt=!1),Rt=!0):yi>-1&&rt===-1&&(l(12,Xt=!0),Rt=!0)}R(We)?!!hr!=!!Xt&&(Rt=!0):We!==(Xt!=null?Xt:null)&&(We===bt?(l(28,We=Xt!=null?Xt:null),R(ke)||l(0,ke=!1)):l(12,Xt=We!=null?We:void 0),Rt=!0),lt&&(R(ke)?lt.indeterminate&&(l(11,lt.indeterminate=!1,lt),Rt=!0):!ke&&lt.indeterminate?(l(11,lt.indeterminate=!1,lt),Rt=!0):ke&&!lt.indeterminate&&(l(11,lt.indeterminate=!0,lt),Rt=!0)),l(31,bt=We),l(32,Gi=R(qe)?[]:[...qe]),l(33,hr=Xt),Rt&&pt&&pt.handleChange()}},[ke,X,q,V,G,Me,ft,Ge,Ze,gt,pt,lt,Xt,ct,pi,Et,Wt,vi,f,R,qi,Qt,Ei,wr,Dt,oi,T,qe,We,Nt,Xi,bt,Gi,hr,Li,xi,rr,Ti,zt,tr]}class cv extends Rn{constructor(a){super(),Bn(this,a,gb,yb,On,{use:2,class:3,style:4,disabled:1,touch:5,indeterminate:0,group:27,checked:28,value:6,valueKey:7,input$use:8,input$class:9,getId:29,getElement:30},null,[-1,-1])}get getId(){return this.$$.ctx[29]}get getElement(){return this.$$.ctx[30]}}/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var _b={ROOT:"mdc-form-field"},vb={LABEL_SELECTOR:".mdc-form-field > label"};/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var xb=function(c){vu(a,c);function a(l){var x=c.call(this,La(La({},a.defaultAdapter),l))||this;return x.click=function(){x.handleClick()},x}return Object.defineProperty(a,"cssClasses",{get:function(){return _b},enumerable:!1,configurable:!0}),Object.defineProperty(a,"strings",{get:function(){return vb},enumerable:!1,configurable:!0}),Object.defineProperty(a,"defaultAdapter",{get:function(){return{activateInputRipple:function(){},deactivateInputRipple:function(){},deregisterInteractionHandler:function(){},registerInteractionHandler:function(){}}},enumerable:!1,configurable:!0}),a.prototype.init=function(){this.adapter.registerInteractionHandler("click",this.click)},a.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("click",this.click)},a.prototype.handleClick=function(){var l=this;this.adapter.activateInputRipple(),requestAnimationFrame(function(){l.adapter.deactivateInputRipple()})},a}(Qh);const bb=c=>({}),w_=c=>({});function wb(c){let a,l,x,T,P,f,d,R,q;const V=c[13].default,G=Co(V,c,c[12],null),X=c[13].label,Me=Co(X,c,c[12],w_);let ke=[{for:c[4]},qf(c[10],"label$")],qe={};for(let Ge=0;Ge<ke.length;Ge+=1)qe=Ci(qe,ke[Ge]);let We=[{class:P=Ao({[c[1]]:!0,"mdc-form-field":!0,"mdc-form-field--align-end":c[2]==="end","mdc-form-field--nowrap":c[3]})},Vf(c[10],["label$"])],ft={};for(let Ge=0;Ge<We.length;Ge+=1)ft=Ci(ft,We[Ge]);return{c(){a=Tr("div"),G&&G.c(),l=pa(),x=Tr("label"),Me&&Me.c(),this.h()},l(Ge){a=Ar(Ge,"DIV",{class:!0});var Ze=Zr(a);G&&G.l(Ze),l=da(Ze),x=Ar(Ze,"LABEL",{for:!0});var gt=Zr(x);Me&&Me.l(gt),gt.forEach(Zt),Ze.forEach(Zt),this.h()},h(){Hr(x,qe),Hr(a,ft)},m(Ge,Ze){Fi(Ge,a,Ze),G&&G.m(a,null),wa(a,l),wa(a,x),Me&&Me.m(x,null),c[14](x),c[15](a),d=!0,R||(q=[Jr(T=Ia.call(null,x,c[5])),Jr(f=Ia.call(null,a,c[0])),Jr(c[9].call(null,a)),ll(a,"SMUIGenericInput:mount",c[16]),ll(a,"SMUIGenericInput:unmount",c[17])],R=!0)},p(Ge,[Ze]){G&&G.p&&(!d||Ze&4096)&&ko(G,V,Ge,Ge[12],d?Po(V,Ge[12],Ze,null):zo(Ge[12]),null),Me&&Me.p&&(!d||Ze&4096)&&ko(Me,X,Ge,Ge[12],d?Po(X,Ge[12],Ze,bb):zo(Ge[12]),w_),Hr(x,qe=go(ke,[(!d||Ze&16)&&{for:Ge[4]},Ze&1024&&qf(Ge[10],"label$")])),T&&ha(T.update)&&Ze&32&&T.update.call(null,Ge[5]),Hr(a,ft=go(We,[(!d||Ze&14&&P!==(P=Ao({[Ge[1]]:!0,"mdc-form-field":!0,"mdc-form-field--align-end":Ge[2]==="end","mdc-form-field--nowrap":Ge[3]})))&&{class:P},Ze&1024&&Vf(Ge[10],["label$"])])),f&&ha(f.update)&&Ze&1&&f.update.call(null,Ge[0])},i(Ge){d||(Mi(G,Ge),Mi(Me,Ge),d=!0)},o(Ge){Ui(G,Ge),Ui(Me,Ge),d=!1},d(Ge){Ge&&Zt(a),G&&G.d(Ge),Me&&Me.d(Ge),c[14](null),c[15](null),R=!1,Ya(q)}}}let Eb=0;function Ib(c,a,l){const x=["use","class","align","noWrap","inputId","label$use","getElement"];let T=br(a,x),{$$slots:P={},$$scope:f}=a;const d=No(Fo());let{use:R=[]}=a,{class:q=""}=a,{align:V="start"}=a,{noWrap:G=!1}=a,{inputId:X="SMUI-form-field-"+Eb++}=a,{label$use:Me=[]}=a,ke,qe,We,ft;Ea("SMUI:generic:input:props",{id:X}),yh(()=>(qe=new xb({activateInputRipple:()=>{ft&&ft.activateRipple()},deactivateInputRipple:()=>{ft&&ft.deactivateRipple()},deregisterInteractionHandler:(lt,pi)=>{We.removeEventListener(lt,pi)},registerInteractionHandler:(lt,pi)=>{We.addEventListener(lt,pi)}}),qe.init(),()=>{qe.destroy()}));function Ge(){return ke}function Ze(lt){_n[lt?"unshift":"push"](()=>{We=lt,l(7,We)})}function gt(lt){_n[lt?"unshift":"push"](()=>{ke=lt,l(6,ke)})}const ct=lt=>l(8,ft=lt.detail),pt=()=>l(8,ft=void 0);return c.$$set=lt=>{a=Ci(Ci({},a),Uo(lt)),l(10,T=br(a,x)),"use"in lt&&l(0,R=lt.use),"class"in lt&&l(1,q=lt.class),"align"in lt&&l(2,V=lt.align),"noWrap"in lt&&l(3,G=lt.noWrap),"inputId"in lt&&l(4,X=lt.inputId),"label$use"in lt&&l(5,Me=lt.label$use),"$$scope"in lt&&l(12,f=lt.$$scope)},[R,q,V,G,X,Me,ke,We,ft,d,T,Ge,f,P,Ze,gt,ct,pt]}class hv extends Rn{constructor(a){super(),Bn(this,a,Ib,wb,On,{use:0,class:1,align:2,noWrap:3,inputId:4,label$use:5,getElement:11})}get getElement(){return this.$$.ctx[11]}}const Yf=tv(null),pv=tv(null);var Sb=8,Tb={version:{required:!0,type:"enum",values:[8],doc:"Style specification version number. Must be 8.",example:8},name:{type:"string",doc:"A human-readable name for the style.",example:"Bright"},metadata:{type:"*",doc:"Arbitrary properties useful to track with the stylesheet, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},center:{type:"array",value:"number",doc:"Default map center in longitude and latitude.  The style center will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:[-73.9749,40.7736]},zoom:{type:"number",doc:"Default zoom level.  The style zoom will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:12.5},bearing:{type:"number",default:0,period:360,units:"degrees",doc:'Default bearing, in degrees. The bearing is the compass direction that is "up"; for example, a bearing of 90\xB0 orients the map so that east is up. This value will be used only if the map has not been positioned by other means (e.g. map options or user interaction).',example:29},pitch:{type:"number",default:0,units:"degrees",doc:"Default pitch, in degrees. Zero is perpendicular to the surface, for a look straight down at the map, while a greater value like 60 looks ahead towards the horizon. The style pitch will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:50},light:{type:"light",doc:"The global light source.",example:{anchor:"viewport",color:"white",intensity:.4}},terrain:{type:"terrain",doc:"A global modifier that elevates layers and markers based on a DEM data source."},fog:{type:"fog",doc:"A global effect that fades layers and markers based on their distance to the camera. The fog can be used to approximate the effect of atmosphere on distant objects and enhance the depth perception of the map when used with terrain or 3D features."},sources:{required:!0,type:"sources",doc:"Data source specifications.",example:{"mapbox-streets":{type:"vector",url:"mapbox://mapbox.mapbox-streets-v6"}}},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended. This property is required if any layer uses the `background-pattern`, `fill-pattern`, `line-pattern`, `fill-extrusion-pattern`, or `icon-image` properties. The URL must be absolute, containing the [scheme, authority and path components](https://en.wikipedia.org/wiki/URL#Syntax).",example:"mapbox://sprites/mapbox/bright-v8"},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. The URL must include `{fontstack}` and `{range}` tokens. This property is required if any layer uses the `text-field` layout property. The URL must be absolute, containing the [scheme, authority and path components](https://en.wikipedia.org/wiki/URL#Syntax).",example:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},transition:{type:"transition",doc:"A global transition definition to use as a default across properties, to be used for timing transitions between one value and the next when no property-specific transition is set. Collision-based symbol fading is controlled independently of the style's `transition` property.",example:{duration:300,delay:0}},projection:{type:"projection",doc:"The projection the map should be rendered in. Supported projections are Albers, Equal Earth, Equirectangular (WGS84), Lambert conformal conic, Mercator, Natural Earth, and Winkel Tripel. Terrain, fog, sky and CustomLayerInterface are not supported for projections other than mercator.",example:{name:"albers",center:[-154,50],parallels:[55,65]}},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array.",example:[{id:"water",source:"mapbox-streets","source-layer":"water",type:"fill",paint:{"fill-color":"#00ffff"}}]}},Ab={"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For image and video sources, a URL must be provided. For GeoJSON sources, a URL or inline GeoJSON must be provided."}},Cb=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],kb={type:{required:!0,type:"enum",values:{vector:{doc:"A vector tile source."}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},scheme:{type:"enum",values:{xyz:{doc:"Slippy map tilenames scheme."},tms:{doc:"OSGeo spec scheme."}},default:"xyz",doc:"Influences the y direction of the tile coordinates. The global-mercator (aka Spherical Mercator) profile is assumed."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},promoteId:{type:"promoteId",doc:"A property to use as a feature id (for feature state). Either a property name, or an object of the form `{<sourceLayer>: <propertyName>}`. If specified as a string for a vector tile source, the same property is used across all its source layers."},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},zb={type:{required:!0,type:"enum",values:{raster:{doc:"A raster tile source."}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},scheme:{type:"enum",values:{xyz:{doc:"Slippy map tilenames scheme."},tms:{doc:"OSGeo spec scheme."}},default:"xyz",doc:"Influences the y direction of the tile coordinates. The global-mercator (aka Spherical Mercator) profile is assumed."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},Pb={type:{required:!0,type:"enum",values:{"raster-dem":{doc:"A RGB-encoded raster DEM source"}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},encoding:{type:"enum",values:{terrarium:{doc:"Terrarium format PNG tiles. See https://aws.amazon.com/es/public-datasets/terrain/ for more info."},mapbox:{doc:"Mapbox Terrain RGB tiles. See https://www.mapbox.com/help/access-elevation-data/#mapbox-terrain-rgb for more info."}},default:"mapbox",doc:"The encoding used by this source. Mapbox Terrain RGB is used by default"},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},Mb={type:{required:!0,type:"enum",values:{geojson:{doc:"A GeoJSON data source."}},doc:"The data type of the GeoJSON source."},data:{type:"*",doc:"A URL to a GeoJSON file, or inline GeoJSON."},maxzoom:{type:"number",default:18,doc:"Maximum zoom level at which to create vector tiles (higher means greater detail at high zoom levels)."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},buffer:{type:"number",default:128,maximum:512,minimum:0,doc:"Size of the tile buffer on each side. A value of 0 produces no buffer. A value of 512 produces a buffer as wide as the tile itself. Larger values produce fewer rendering artifacts near tile edges and slower performance."},filter:{type:"*",doc:"An expression for filtering features prior to processing them for rendering."},tolerance:{type:"number",default:.375,doc:"Douglas-Peucker simplification tolerance (higher means simpler geometries and faster performance)."},cluster:{type:"boolean",default:!1,doc:"If the data is a collection of point features, setting this to true clusters the points by radius into groups. Cluster groups become new `Point` features in the source with additional properties:\n * `cluster` Is `true` if the point is a cluster \n * `cluster_id` A unqiue id for the cluster to be used in conjunction with the [cluster inspection methods](https://www.mapbox.com/mapbox-gl-js/api/#geojsonsource#getclusterexpansionzoom)\n * `point_count` Number of original points grouped into this cluster\n * `point_count_abbreviated` An abbreviated point count"},clusterRadius:{type:"number",default:50,minimum:0,doc:"Radius of each cluster if clustering is enabled. A value of 512 indicates a radius equal to the width of a tile."},clusterMaxZoom:{type:"number",doc:"Max zoom on which to cluster points if clustering is enabled. Defaults to one zoom less than maxzoom (so that last zoom features are not clustered). Clusters are re-evaluated at integer zoom levels so setting clusterMaxZoom to 14 means the clusters will be displayed until z15."},clusterMinPoints:{type:"number",doc:"Minimum number of points necessary to form a cluster if clustering is enabled. Defaults to `2`."},clusterProperties:{type:"*",doc:'An object defining custom properties on the generated clusters if clustering is enabled, aggregating values from clustered points. Has the form `{"property_name": [operator, map_expression]}`. `operator` is any expression function that accepts at least 2 operands (e.g. `"+"` or `"max"`) \u2014 it accumulates the property value from clusters/points the cluster contains; `map_expression` produces the value of a single point.\n\nExample: `{"sum": ["+", ["get", "scalerank"]]}`.\n\nFor more advanced use cases, in place of `operator`, you can use a custom reduce expression that references a special `["accumulated"]` value, e.g.:\n`{"sum": [["+", ["accumulated"], ["get", "sum"]], ["get", "scalerank"]]}`'},lineMetrics:{type:"boolean",default:!1,doc:"Whether to calculate line distance metrics. This is required for line layers that specify `line-gradient` values."},generateId:{type:"boolean",default:!1,doc:"Whether to generate ids for the geojson features. When enabled, the `feature.id` property will be auto assigned based on its index in the `features` array, over-writing any previous values."},promoteId:{type:"promoteId",doc:"A property to use as a feature id (for feature state). Either a property name, or an object of the form `{<sourceLayer>: <propertyName>}`."}},Lb={type:{required:!0,type:"enum",values:{video:{doc:"A video data source."}},doc:"The data type of the video source."},urls:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,doc:"Corners of video specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},Db={type:{required:!0,type:"enum",values:{image:{doc:"An image data source."}},doc:"The data type of the image source."},url:{required:!0,type:"string",doc:"URL that points to an image."},coordinates:{required:!0,doc:"Corners of image specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},Rb={id:{type:"string",doc:"Unique layer name.",required:!0},type:{type:"enum",values:{fill:{doc:"A filled polygon with an optional stroked border.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},line:{doc:"A stroked line.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},symbol:{doc:"An icon or a text label.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},circle:{doc:"A filled circle.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},heatmap:{doc:"A heatmap.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"fill-extrusion":{doc:"An extruded (3D) polygon.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},raster:{doc:"Raster map textures such as satellite imagery.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},hillshade:{doc:"Client-side hillshading visualization based on DEM data. Currently, the implementation only supports Mapbox Terrain RGB and Mapzen Terrarium tiles.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},background:{doc:"The background color or pattern of the map.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},sky:{doc:"A spherical dome around the map that is always rendered behind all other layers.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}}},doc:"Rendering type of this layer.",required:!0},metadata:{type:"*",doc:"Arbitrary properties useful to track with the layer, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},source:{type:"string",doc:"Name of a source description to be used for this layer. Required for all layer types except `background`."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required for vector tile sources; prohibited for all other source types, including GeoJSON sources."},minzoom:{type:"number",minimum:0,maximum:24,doc:"The minimum zoom level for the layer. At zoom levels less than the minzoom, the layer will be hidden."},maxzoom:{type:"number",minimum:0,maximum:24,doc:"The maximum zoom level for the layer. At zoom levels equal to or greater than the maxzoom, the layer will be hidden."},filter:{type:"filter",doc:'An expression specifying conditions on source features. Only features that match the filter are displayed. Zoom expressions in filters are only evaluated at integer zoom levels. The `["feature-state", ...]` expression is not supported in filter expressions.  The `["pitch"]` and `["distance-from-center"]` expressions are supported only for filter expressions on the symbol layer.'},layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."}},Bb=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],Ob={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},Fb={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"constant"}},Ub={"fill-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"},"data-driven styling":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},Nb={"circle-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.2.0",ios:"5.9.0",macos:"0.16.0"},"data-driven styling":{js:"1.2.0",android:"9.2.0",ios:"5.9.0",macos:"0.16.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},jb={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},"property-type":"constant"}},Vb={"line-cap":{type:"enum",values:{butt:{doc:"A cap with a squared-off end which is drawn to the exact endpoint of the line."},round:{doc:"A cap with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},square:{doc:"A cap with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."}},default:"butt",doc:"The display of line endings.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{doc:"A join with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."},round:{doc:"A join with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},miter:{doc:"A join with a sharp, angled corner which is drawn with the outer sides beyond the endpoint of the path until they meet."}},default:"miter",doc:"The display of lines when joining.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"},"data-driven styling":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},qb={"symbol-placement":{type:"enum",values:{point:{doc:"The label is placed at the point where the geometry is located."},line:{doc:"The label is placed along the line of the geometry. Can only be used on `LineString` and `Polygon` geometries."},"line-center":{doc:"The label is placed at the center of the line of the geometry. Can only be used on `LineString` and `Polygon` geometries. Note that a single feature in a vector tile may contain multiple line geometries."}},default:"point",doc:"Label placement relative to its geometry.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`line-center` value":{js:"0.47.0",android:"6.4.0",ios:"4.3.0",macos:"0.10.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",doc:"Distance between two symbol anchors.",requires:[{"symbol-placement":"line"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,doc:"If true, the symbols will not cross tile edges to avoid mutual collisions. Recommended in layers that don't have enough padding in the vector tile to prevent collisions, or if it is a point symbol layer placed after a line symbol layer. When using a client that supports global collision detection, like Mapbox GL JS version 0.42.0 or greater, enabling this property is not needed to prevent clipped labels at tile boundaries.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with lower sort keys are drawn and placed first.  When `icon-allow-overlap` or `text-allow-overlap` is `false`, features with a lower sort key will have priority during placement. When `icon-allow-overlap` or `text-allow-overlap` is set to `true`, features with a higher sort key will overlap over features with a lower sort key.","sdk-support":{"basic functionality":{js:"0.53.0",android:"7.4.0",ios:"4.11.0",macos:"0.14.0"},"data-driven styling":{js:"0.53.0",android:"7.4.0",ios:"4.11.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{doc:"Sorts symbols by `symbol-sort-key` if set. Otherwise, sorts symbols by their y-position relative to the viewport if `icon-allow-overlap` or `text-allow-overlap` is set to `true` or `icon-ignore-placement` or `text-ignore-placement` is `false`."},"viewport-y":{doc:"Sorts symbols by their y-position relative to the viewport if `icon-allow-overlap` or `text-allow-overlap` is set to `true` or `icon-ignore-placement` or `text-ignore-placement` is `false`."},source:{doc:"Sorts symbols by `symbol-sort-key` if set. Otherwise, no sorting is applied; symbols are rendered in the same order as the source data."}},default:"auto",doc:"Determines whether overlapping symbols in the same layer are rendered in the order that they appear in the data source or by their y-position relative to the viewport. To control the order and prioritization of symbols otherwise, use `symbol-sort-key`.","sdk-support":{"basic functionality":{js:"0.49.0",android:"6.6.0",ios:"4.5.0",macos:"0.12.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,doc:"If true, the icon will be visible even if it collides with other previously drawn symbols.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,doc:"If true, other symbols can be visible even if they collide with the icon.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,doc:"If true, text will display without their corresponding icons when the icon collides with other symbols and the text does not.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{doc:"When `symbol-placement` is set to `point`, aligns icons east-west. When `symbol-placement` is set to `line` or `line-center`, aligns icon x-axes with the line."},viewport:{doc:"Produces icons whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line` or `line-center`, this is equivalent to `map`."}},default:"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of icons.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",doc:"Scales the original size of the icon by the provided factor. The new pixel size of the image will be the original pixel size multiplied by `icon-size`. 1 is the original size; 3 triples the size of the image.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{doc:"The icon is displayed at its intrinsic aspect ratio."},width:{doc:"The icon is scaled in the x-dimension to fit the width of the text."},height:{doc:"The icon is scaled in the y-dimension to fit the height of the text."},both:{doc:"The icon is scaled in both x- and y-dimensions."}},default:"none",doc:"Scales the icon to fit around the associated text.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"stretchable icons":{js:"1.6.0",android:"9.2.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",doc:"Size of the additional area added to dimensions determined by `icon-text-fit`, in clockwise order: top, right, bottom, left.",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",doc:"Name of image in sprite to use for drawing an image background.",tokens:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",doc:"Size of the additional area around the icon bounding box used for detecting symbol collisions.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down.",requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],doc:"Offset distance of icon from its anchor. Positive values indicate right and down, while negative values indicate left and up. Each component is multiplied by the value of `icon-size` to obtain the final offset in pixels. When combined with `icon-rotate` the offset will be as if the rotated direction was up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{doc:"The center of the icon is placed closest to the anchor."},left:{doc:"The left side of the icon is placed closest to the anchor."},right:{doc:"The right side of the icon is placed closest to the anchor."},top:{doc:"The top of the icon is placed closest to the anchor."},bottom:{doc:"The bottom of the icon is placed closest to the anchor."},"top-left":{doc:"The top left corner of the icon is placed closest to the anchor."},"top-right":{doc:"The top right corner of the icon is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the icon is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the icon is placed closest to the anchor."}},default:"center",doc:"Part of the icon placed closest to the anchor.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{doc:"The icon is aligned to the plane of the map."},viewport:{doc:"The icon is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `icon-rotation-alignment`."}},default:"auto",doc:"Orientation of icon when map is pitched.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{doc:"The text is aligned to the plane of the map."},viewport:{doc:"The text is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `text-rotation-alignment`."}},default:"auto",doc:"Orientation of text when map is pitched.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{doc:"When `symbol-placement` is set to `point`, aligns text east-west. When `symbol-placement` is set to `line` or `line-center`, aligns text x-axes with the line."},viewport:{doc:"Produces glyphs whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line` or `line-center`, this is equivalent to `map`."}},default:"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of the individual glyphs forming the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,doc:"Value to use for a text label. If a plain `string` is provided, it will be treated as a `formatted` with default/inherited formatting options. SDF images are not supported in formatted text and will be ignored.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],doc:"Font stack to use for displaying text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",doc:"Font size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",doc:"The maximum line width for text wrapping.",requires:["text-field",{"symbol-placement":["point"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",doc:"Text leading value for multi-line text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",doc:"Text tracking amount.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{doc:"The text is aligned towards the anchor position."},left:{doc:"The text is aligned to the left."},center:{doc:"The text is centered."},right:{doc:"The text is aligned to the right."}},default:"center",doc:"Text justification options.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"},auto:{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,doc:"Radial offset of text, in the direction of the symbol's anchor. Useful in combination with `text-variable-anchor`, which defaults to using the two-dimensional `text-offset` if present.","sdk-support":{"basic functionality":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"},"data-driven styling":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},requires:["text-field",{"symbol-placement":["point"]}],doc:"To increase the chance of placing high-priority labels on the map, you can provide an array of `text-anchor` locations: the renderer will attempt to place the label at each location, in order, before moving onto the next label. Use `text-justify: auto` to choose justification based on anchor position. To apply an offset, use the `text-radial-offset` or the two-dimensional `text-offset`.","sdk-support":{"basic functionality":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},default:"center",doc:"Part of the text placed closest to the anchor.",requires:["text-field",{"!":"text-variable-anchor"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{doc:"If a text's language supports horizontal writing mode, symbols would be laid out horizontally."},vertical:{doc:"If a text's language supports vertical writing mode, symbols would be laid out vertically."}},doc:"The property allows control over a symbol's orientation. Note that the property values act as a hint, so that a symbol whose language doesn\u2019t support the provided orientation will be laid out in its natural orientation. Example: English point symbol will be rendered horizontally even if array value contains single 'vertical' enum value. For symbol with point placement, the order of elements in an array define priority order for the placement of an orientation variant. For symbol with line placement, the default text writing mode is either ['horizontal', 'vertical'] or ['vertical', 'horizontal'], the order doesn't affect the placement.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"1.3.0",android:"8.3.0",ios:"5.3.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",doc:"Rotates the text clockwise.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",doc:"Size of the additional area around the text bounding box used for detecting symbol collisions.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{doc:"The text is not altered."},uppercase:{doc:"Forces all letters to be displayed in uppercase."},lowercase:{doc:"Forces all letters to be displayed in lowercase."}},default:"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",doc:"Offset distance of text from its anchor. Positive values indicate right and down, while negative values indicate left and up. If used with text-variable-anchor, input values will be taken as absolute values. Offsets along the x- and y-axis will be applied automatically based on the anchor position.",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,doc:"If true, the text will be visible even if it collides with other previously drawn symbols.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,doc:"If true, other symbols can be visible even if they collide with the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,doc:"If true, icons will display without their corresponding text when the text collides with other symbols and the icon does not.",requires:["text-field","icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},Gb={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},Zb={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},"property-type":"constant"}},Hb={type:"array",value:"*",doc:"A filter selects specific features from a layer."},Wb={type:"boolean",doc:'Expression which determines whether or not to display a symbol. Symbols support dynamic filtering, meaning this expression can use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},Xb={type:"boolean",doc:'Expression which determines whether or not to display a polygon. Fill layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},Kb={type:"boolean",doc:'Expression which determines whether or not to display a Polygon or LineString. Line layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},Jb={type:"boolean",doc:'Expression which determines whether or not to display a circle. Circle layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},Yb={type:"boolean",doc:'Expression used to determine whether a point is being displayed or not. Heatmap layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},$b={type:"enum",values:{"==":{doc:'`["==", key, value]` equality: `feature[key] = value`'},"!=":{doc:'`["!=", key, value]` inequality: `feature[key] \u2260 value`'},">":{doc:'`[">", key, value]` greater than: `feature[key] > value`'},">=":{doc:'`[">=", key, value]` greater than or equal: `feature[key] \u2265 value`'},"<":{doc:'`["<", key, value]` less than: `feature[key] < value`'},"<=":{doc:'`["<=", key, value]` less than or equal: `feature[key] \u2264 value`'},in:{doc:'`["in", key, v0, ..., vn]` set inclusion: `feature[key] \u2208 {v0, ..., vn}`'},"!in":{doc:'`["!in", key, v0, ..., vn]` set exclusion: `feature[key] \u2209 {v0, ..., vn}`'},all:{doc:'`["all", f0, ..., fn]` logical `AND`: `f0 \u2227 ... \u2227 fn`'},any:{doc:'`["any", f0, ..., fn]` logical `OR`: `f0 \u2228 ... \u2228 fn`'},none:{doc:'`["none", f0, ..., fn]` logical `NOR`: `\xACf0 \u2227 ... \u2227 \xACfn`'},has:{doc:'`["has", key]` `feature[key]` exists'},"!has":{doc:'`["!has", key]` `feature[key]` does not exist'},within:{doc:'`["within", object]` feature geometry is within object geometry'}},doc:"The filter operator."},Qb={type:"enum",values:{Point:{doc:"Filter to point geometries."},LineString:{doc:"Filter to line geometries."},Polygon:{doc:"Filter to polygon geometries."}},doc:"The geometry type for the filter to select."},ew={type:"array",minimum:0,maximum:24,value:["number","color"],length:2,doc:"Zoom level and value pair."},tw={type:"array",value:"*",minimum:1,doc:"An expression defines a function that can be used for data-driven style properties or feature filters."},iw={doc:"",type:"enum",values:{let:{doc:'Binds expressions to named variables, which can then be referenced in the result expression using ["var", "variable_name"].',group:"Variable binding","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},var:{doc:'References variable bound using "let".',group:"Variable binding","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},literal:{doc:"Provides a literal array or object value.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},array:{doc:"Asserts that the input is an array (optionally with a specific item type and length).  If, when the input expression is evaluated, it is not of the asserted type, then this assertion will cause the whole expression to be aborted.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},at:{doc:"Retrieves an item from an array.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},in:{doc:"Determines whether an item exists in an array or a substring exists in a string. In the specific case when the second and third arguments are string literals, you must wrap at least one of them in a [`literal`](#types-literal) expression to hint correct interpretation to the [type system](#type-system).",group:"Lookup","sdk-support":{"basic functionality":{js:"1.6.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}}},"index-of":{doc:"Returns the first position at which an item can be found in an array or a substring can be found in a string, or `-1` if the input cannot be found. Accepts an optional index from where to begin the search.",group:"Lookup","sdk-support":{"basic functionality":{js:"1.10.0"}}},slice:{doc:"Returns an item from an array or a substring from a string from a specified start index, or between a start index and an end index if set. The return value is inclusive of the start index but not of the end index.",group:"Lookup","sdk-support":{"basic functionality":{js:"1.10.0"}}},case:{doc:"Selects the first output whose corresponding test condition evaluates to true, or the fallback value otherwise.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},match:{doc:'Selects the output for which the label value matches the input value, or the fallback value if no match is found. The input can be any expression (for example, `["get", "building_type"]`). Each label must be unique, and must be either:\n - a single literal value; or\n - an array of literal values, the values of which must be all strings or all numbers (for example `[100, 101]` or `["c", "b"]`).\n\nThe input matches if any of the values in the array matches using strict equality, similar to the `"in"` operator.\nIf the input type does not match the type of the labels, the result will be the fallback value.',group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},coalesce:{doc:"Evaluates each expression in turn until the first valid value is obtained. Invalid values are `null` and [`'image'`](#types-image) expressions that are unavailable in the style. If all values are invalid, `coalesce` returns the first value listed.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},step:{doc:'Produces discrete, stepped results by evaluating a piecewise-constant function defined by pairs of input and output values ("stops"). The `input` may be any numeric expression (e.g., `["get", "population"]`). Stop inputs must be numeric literals in strictly ascending order. Returns the output value of the stop just less than the input, or the first output if the input is less than the first stop.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},interpolate:{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). The `input` may be any numeric expression (e.g., `["get", "population"]`). Stop inputs must be numeric literals in strictly ascending order. The output type must be `number`, `array<number>`, or `color`.\n\nInterpolation types:\n- `["linear"]`: Interpolates linearly between the pair of stops just less than and just greater than the input.\n- `["exponential", base]`: Interpolates exponentially between the stops just less than and just greater than the input. `base` controls the rate at which the output increases: higher values make the output increase more towards the high end of the range. With values close to 1 the output increases linearly.\n- `["cubic-bezier", x1, y1, x2, y2]`: Interpolates using the cubic bezier curve defined by the given control points.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"interpolate-hcl":{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). Works like `interpolate`, but the output type must be `color`, and the interpolation is performed in the Hue-Chroma-Luminance color space.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.49.0"}}},"interpolate-lab":{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). Works like `interpolate`, but the output type must be `color`, and the interpolation is performed in the CIELAB color space.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.49.0"}}},ln2:{doc:"Returns mathematical constant ln(2).",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},pi:{doc:"Returns the mathematical constant pi.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},e:{doc:"Returns the mathematical constant e.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},typeof:{doc:"Returns a string describing the type of the given value.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},string:{doc:"Asserts that the input value is a string. If multiple values are provided, each one is evaluated in order until a string is obtained. If none of the inputs are strings, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},number:{doc:"Asserts that the input value is a number. If multiple values are provided, each one is evaluated in order until a number is obtained. If none of the inputs are numbers, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},boolean:{doc:"Asserts that the input value is a boolean. If multiple values are provided, each one is evaluated in order until a boolean is obtained. If none of the inputs are booleans, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},object:{doc:"Asserts that the input value is an object. If multiple values are provided, each one is evaluated in order until an object is obtained. If none of the inputs are objects, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},collator:{doc:"Returns a `collator` for use in locale-dependent comparison operations. The `case-sensitive` and `diacritic-sensitive` options default to `false`. The `locale` argument specifies the IETF language tag of the locale to use. If none is provided, the default locale is used. If the requested locale is not available, the `collator` will use a system-defined fallback locale. Use `resolved-locale` to test the results of locale fallback behavior.",group:"Types","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},format:{doc:'Returns a `formatted` string for displaying mixed-format text in the `text-field` property. The input may contain a string literal or expression, including an [`\'image\'`](#types-image) expression. Strings may be followed by a style override object that supports the following properties:\n- `"text-font"`: Overrides the font stack specified by the root layout property.\n- `"text-color"`: Overrides the color specified by the root paint property.\n- `"font-scale"`: Applies a scaling factor on `text-size` as specified by the root layout property.',group:"Types","sdk-support":{"basic functionality":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"text-font":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"font-scale":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"text-color":{js:"1.3.0",android:"7.3.0",ios:"4.10.0",macos:"0.14.0"},image:{js:"1.6.0",android:"8.6.0",ios:"5.7.0",macos:"0.15.0"}}},image:{doc:"Returns a [`ResolvedImage`](/mapbox-gl-js/style-spec/types/#resolvedimage) for use in [`icon-image`](/mapbox-gl-js/style-spec/layers/#layout-symbol-icon-image), `*-pattern` entries, and as a section in the [`'format'`](#types-format) expression. A [`'coalesce'`](#coalesce) expression containing `image` expressions will evaluate to the first listed image that is currently in the style. This validation process is synchronous and requires the image to have been added to the style before requesting it in the `'image'` argument.",group:"Types","sdk-support":{"basic functionality":{js:"1.4.0",android:"8.6.0",ios:"5.7.0",macos:"0.15.0"}}},"number-format":{doc:"Converts the input number into a string representation using the providing formatting rules. If set, the `locale` argument specifies the locale to use, as a BCP 47 language tag. If set, the `currency` argument specifies an ISO 4217 code to use for currency-style formatting. If set, the `min-fraction-digits` and `max-fraction-digits` arguments specify the minimum and maximum number of fractional digits to include.",group:"Types","sdk-support":{"basic functionality":{js:"0.54.0",android:"8.4.0",ios:"5.4.0",macos:"0.15.0"}}},"to-string":{doc:'Converts the input value to a string. If the input is `null`, the result is `""`. If the input is a [`boolean`](#types-boolean), the result is `"true"` or `"false"`. If the input is a number, it is converted to a string as specified by the ["NumberToString" algorithm](https://tc39.github.io/ecma262/#sec-tostring-applied-to-the-number-type) of the ECMAScript Language Specification. If the input is a [`color`](#color), it is converted to a string of the form `"rgba(r,g,b,a)"`, where `r`, `g`, and `b` are numerals ranging from 0 to 255, and `a` ranges from 0 to 1. If the input is an [`\'image\'`](#types-image) expression, `\'to-string\'` returns the image name. Otherwise, the input is converted to a string in the format specified by the [`JSON.stringify`](https://tc39.github.io/ecma262/#sec-json.stringify) function of the ECMAScript Language Specification.',group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-number":{doc:'Converts the input value to a number, if possible. If the input is `null` or `false`, the result is 0. If the input is `true`, the result is 1. If the input is a string, it is converted to a number as specified by the ["ToNumber Applied to the String Type" algorithm](https://tc39.github.io/ecma262/#sec-tonumber-applied-to-the-string-type) of the ECMAScript Language Specification. If multiple values are provided, each one is evaluated in order until the first successful conversion is obtained. If none of the inputs can be converted, the expression is an error.',group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-boolean":{doc:"Converts the input value to a boolean. The result is `false` when then input is an empty string, 0, `false`, `null`, or `NaN`; otherwise it is `true`.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-rgba":{doc:"Returns a four-element array containing the input color's red, green, blue, and alpha components, in that order.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-color":{doc:"Converts the input value to a color. If multiple values are provided, each one is evaluated in order until the first successful conversion is obtained. If none of the inputs can be converted, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},rgb:{doc:"Creates a color value from red, green, and blue components, which must range between 0 and 255, and an alpha component of 1. If any component is out of range, the expression is an error.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},rgba:{doc:"Creates a color value from red, green, blue components, which must range between 0 and 255, and an alpha component which must range between 0 and 1. If any component is out of range, the expression is an error.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},get:{doc:"Retrieves a property value from the current feature's properties, or from another object if a second argument is provided. Returns `null` if the requested property is missing.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},has:{doc:"Tests for the presence of an property value in the current feature's properties, or from another object if a second argument is provided.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},length:{doc:"Returns the length of an array or string.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},properties:{doc:'Returns the feature properties object.  Note that in some cases, it may be more efficient to use `["get", "property_name"]` directly.',group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"feature-state":{doc:"Retrieves a property value from the current feature's state. Returns `null` if the requested property is not present on the feature's state. A feature's state is not part of the GeoJSON or vector tile data, and must be set programmatically on each feature. Features are identified by their `id` attribute, which must be an integer or a string that can be cast to an integer. Note that [\"feature-state\"] can only be used with paint properties that support data-driven styling.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.46.0"}}},"geometry-type":{doc:"Returns the feature's geometry type: `Point`, `MultiPoint`, `LineString`, `MultiLineString`, `Polygon`, `MultiPolygon`. `Multi*` feature types are only returned in GeoJSON sources. When working with vector tile sources, use the singular forms.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},id:{doc:"Returns the feature's id, if it has one.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},zoom:{doc:'Returns the current zoom level.  Note that in style layout and paint properties, ["zoom"] may only appear as the input to a top-level "step" or "interpolate" expression.',group:"Camera","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},pitch:{doc:'Returns the current pitch in degrees. `["pitch"]` may only be used in the `filter` expression for a `symbol` layer.',group:"Camera","sdk-support":{"basic functionality":{js:"2.6.0"}}},"distance-from-center":{doc:'Returns the distance of a `symbol` instance from the center of the map. The distance is measured in pixels divided by the height of the map container. It measures 0 at the center, decreases towards the camera and increase away from the camera. For example, if the height of the map is 1000px, a value of -1 means 1000px away from the center towards the camera, and a value of 1 means a distance of 1000px away from the camera from the center. `["distance-from-center"]` may only be used in the `filter` expression for a `symbol` layer.',group:"Camera","sdk-support":{"basic functionality":{js:"2.6.0"}}},"heatmap-density":{doc:"Returns the kernel density estimation of a pixel in a heatmap layer, which is a relative measure of how many data points are crowded around a particular pixel. Can only be used in the `heatmap-color` property.",group:"Heatmap","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"line-progress":{doc:"Returns the progress along a gradient line. Can only be used in the `line-gradient` property.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.6.0",macos:"0.12.0"}}},"sky-radial-progress":{doc:"Returns the distance of a point on the sky from the sun position. Returns 0 at sun position and 1 when the distance reaches `sky-gradient-radius`. Can only be used in the `sky-gradient` property.",group:"sky","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}},accumulated:{doc:"Returns the value of a cluster property accumulated so far. Can only be used in the `clusterProperties` option of a clustered GeoJSON source.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.53.0",android:"8.4.0",ios:"5.5.0",macos:"0.15.0"}}},"+":{doc:"Returns the sum of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"*":{doc:"Returns the product of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"-":{doc:"For two inputs, returns the result of subtracting the second input from the first. For a single input, returns the result of subtracting it from 0.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"/":{doc:"Returns the result of floating point division of the first input by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"%":{doc:"Returns the remainder after integer division of the first input by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"^":{doc:"Returns the result of raising the first input to the power specified by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},sqrt:{doc:"Returns the square root of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},log10:{doc:"Returns the base-ten logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},ln:{doc:"Returns the natural logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},log2:{doc:"Returns the base-two logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},sin:{doc:"Returns the sine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},cos:{doc:"Returns the cosine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},tan:{doc:"Returns the tangent of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},asin:{doc:"Returns the arcsine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},acos:{doc:"Returns the arccosine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},atan:{doc:"Returns the arctangent of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},min:{doc:"Returns the minimum value of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},max:{doc:"Returns the maximum value of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},round:{doc:'Rounds the input to the nearest integer. Halfway values are rounded away from zero. For example, `["round", -1.5]` evaluates to -2.',group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},abs:{doc:"Returns the absolute value of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},ceil:{doc:"Returns the smallest integer that is greater than or equal to the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},floor:{doc:"Returns the largest integer that is less than or equal to the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},distance:{doc:"Returns the shortest distance in meters between the evaluated feature and the input geometry. The input value can be a valid GeoJSON of type `Point`, `MultiPoint`, `LineString`, `MultiLineString`, `Polygon`, `MultiPolygon`, `Feature`, or `FeatureCollection`. Distance values returned may vary in precision due to loss in precision from encoding geometries, particularly below zoom level 13.",group:"Math","sdk-support":{"basic functionality":{android:"9.2.0",ios:"5.9.0",macos:"0.16.0"}}},"==":{doc:"Returns `true` if the input values are equal, `false` otherwise. The comparison is strictly typed: values of different runtime types are always considered unequal. Cases where the types are known to be different at parse time are considered invalid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"!=":{doc:"Returns `true` if the input values are not equal, `false` otherwise. The comparison is strictly typed: values of different runtime types are always considered unequal. Cases where the types are known to be different at parse time are considered invalid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},">":{doc:"Returns `true` if the first input is strictly greater than the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"<":{doc:"Returns `true` if the first input is strictly less than the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},">=":{doc:"Returns `true` if the first input is greater than or equal to the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"<=":{doc:"Returns `true` if the first input is less than or equal to the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},all:{doc:"Returns `true` if all the inputs are `true`, `false` otherwise. The inputs are evaluated in order, and evaluation is short-circuiting: once an input expression evaluates to `false`, the result is `false` and no further input expressions are evaluated.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},any:{doc:"Returns `true` if any of the inputs are `true`, `false` otherwise. The inputs are evaluated in order, and evaluation is short-circuiting: once an input expression evaluates to `true`, the result is `true` and no further input expressions are evaluated.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"!":{doc:"Logical negation. Returns `true` if the input is `false`, and `false` if the input is `true`.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},within:{doc:"Returns `true` if the evaluated feature is fully contained inside a boundary of the input geometry, `false` otherwise. The input value can be a valid GeoJSON of type `Polygon`, `MultiPolygon`, `Feature`, or `FeatureCollection`. Supported features for evaluation:\n- `Point`: Returns `false` if a point is on the boundary or falls outside the boundary.\n- `LineString`: Returns `false` if any part of a line falls outside the boundary, the line intersects the boundary, or a line's endpoint is on the boundary.",group:"Decision","sdk-support":{"basic functionality":{js:"1.9.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}}},"is-supported-script":{doc:"Returns `true` if the input string is expected to render legibly. Returns `false` if the input string contains sections that cannot be rendered without potential loss of meaning (e.g. Indic scripts that require complex text shaping, or right-to-left scripts if the the `mapbox-gl-rtl-text` plugin is not in use in Mapbox GL JS).",group:"String","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.6.0"}}},upcase:{doc:"Returns the input string converted to uppercase. Follows the Unicode Default Case Conversion algorithm and the locale-insensitive case mappings in the Unicode Character Database.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},downcase:{doc:"Returns the input string converted to lowercase. Follows the Unicode Default Case Conversion algorithm and the locale-insensitive case mappings in the Unicode Character Database.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},concat:{doc:"Returns a `string` consisting of the concatenation of the inputs. Each input is converted to a string as if by `to-string`.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"resolved-locale":{doc:"Returns the IETF language tag of the locale being used by the provided `collator`. This can be used to determine the default system locale, or to determine if a requested locale was successfully loaded.",group:"String","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}}}},rw={range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},doc:"The start and end distance range in which fog fades from fully transparent to fully opaque. The distance to the point at the center of the map is defined as zero, so that negative range values are closer to the camera, and positive values are farther away.",example:[.5,10],"sdk-support":{"basic functionality":{js:"2.3.0"}}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"The color of the fog. Using opacity is recommended only for smoothly transitioning fog on/off as anything less than 100% opacity results in more tiles loaded and drawn.","sdk-support":{"basic functionality":{js:"2.3.0"}}},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Horizon blend applies a smooth fade from the color of the fog to the color of the sky. A value of zero leaves a sharp transition from fog to sky. Increasing the value blends the color of fog into increasingly high angles of the sky.","sdk-support":{"basic functionality":{js:"2.3.0"}}}},nw={anchor:{type:"enum",default:"viewport",values:{map:{doc:"The position of the light source is aligned to the rotation of the map."},viewport:{doc:"The position of the light source is aligned to the rotation of the viewport."}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]},doc:"Whether extruded geometries are lit relative to the map or viewport.",example:"map","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},doc:"Position of the light source relative to lit (extruded) geometries, in [r radial coordinate, a azimuthal angle, p polar angle] where r indicates the distance from the center of the base of an object to its light, a indicates the position of the light relative to 0\xB0 (0\xB0 when `light.anchor` is set to `viewport` corresponds to the top of the viewport, or 0\xB0 when `light.anchor` is set to `map` corresponds to due north, and degrees proceed clockwise), and p indicates the height of the light (from 0\xB0, directly above, to 180\xB0, directly below).",example:[1.5,90,80],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Color tint for lighting extruded geometries.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Intensity of lighting (on a scale from 0 to 1). Higher numbers will present as more extreme contrast.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}}},ow={name:{type:"enum",values:{albers:{doc:"An Albers equal-area projection centered on the continental United States. You can configure the projection for a different region by setting `center` and `parallels` properties. You may want to set max bounds to constrain the map to the relevant region."},equalEarth:{doc:"An Equal Earth projection."},equirectangular:{doc:"An Equirectangular projection. This projection is very similar to the Plate Carr\xE9e projection."},lambertConformalConic:{doc:"A Lambert conformal conic projection. You can configure the projection for a region by setting `center` and `parallels` properties. You may want to set max bounds to constrain the map to the relevant region."},mercator:{doc:"The Mercator projection is the default projection."},naturalEarth:{doc:"A Natural Earth projection."},winkelTripel:{doc:"A Winkel Tripel projection."}},default:"mercator",doc:"The name of the projection to be used for rendering the map.",required:!0,"sdk-support":{"basic functionality":{js:"2.6.0"}}},center:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,doc:"The reference longitude and latitude of the projection. `center` takes the form of [lng, lat]. This property is only configurable for conic projections (Albers and Lambert Conformal Conic). All other projections are centered on [0, 0].",example:[-96,37.5],requires:[{name:["albers","lambertConformalConic"]}],"sdk-support":{"basic functionality":{js:"2.6.0"}}},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,doc:"The standard parallels of the projection, denoting the desired latitude range with minimal distortion. `parallels` takes the form of [lat0, lat1]. This property is only configurable for conic projections (Albers and Lambert Conformal Conic).",example:[29.5,45.5],requires:[{name:["albers","lambertConformalConic"]}],"sdk-support":{"basic functionality":{js:"2.6.0"}}}},aw={source:{type:"string",doc:"Name of a source of `raster_dem` type to be used for terrain elevation.",required:!0,"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Exaggerates the elevation of the terrain by multiplying the data from the DEM with this value.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}}},sw=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],lw={"fill-antialias":{type:"boolean",default:!0,doc:"Whether or not the fill should be antialiased.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire fill layer. In contrast to the `fill-color`, this value will also affect the 1px stroke around the fill, if the stroke is used.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",doc:"The color of the filled part of this layer. This color can be specified as `rgba` with an alpha component and the color's opacity will not affect the opacity of the 1px stroke, if it is used.",transition:!0,requires:[{"!":"fill-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{doc:"The fill is translated relative to the map."},viewport:{doc:"The fill is translated relative to the viewport."}},doc:"Controls the frame of reference for `fill-translate`.",default:"map",requires:["fill-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing image fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},uw={"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",doc:"The color with which the line will be drawn.",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.23.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{doc:"The line is translated relative to the map."},viewport:{doc:"The line is translated relative to the viewport."}},doc:"Controls the frame of reference for `line-translate`.",default:"map",requires:["line-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",doc:"Stroke thickness.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.",transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,doc:"The line's offset. For linear features, a positive value offsets the line to the right, relative to the direction of the line, and a negative value to the left. For polygon features, a positive value results in an inset, and a negative value results in an outset.",transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.12.1",android:"3.0.0",ios:"3.1.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width. Note that GeoJSON sources with `lineMetrics: true` specified won't render dashed lines to the expected scale. Also note that zoom-dependent expressions will be evaluated only at integer zoom levels.",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing image lines. For seamless patterns, image width must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",doc:'Defines a gradient with which to color a line feature. Can only be used with GeoJSON sources that specify `"lineMetrics": true`.',transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],"sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.4.0",macos:"0.11.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},cw={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",doc:"Circle radius.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",doc:"The fill color of the circle.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,doc:"Amount to blur the circle. 1 blurs the circle such that only the centerpoint is full opacity.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",doc:"The opacity at which the circle will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{doc:"The circle is translated relative to the map."},viewport:{doc:"The circle is translated relative to the viewport."}},doc:"Controls the frame of reference for `circle-translate`.",default:"map",requires:["circle-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{doc:"Circles are scaled according to their apparent distance to the camera."},viewport:{doc:"Circles are not scaled."}},default:"map",doc:"Controls the scaling behavior of the circle when the map is pitched.","sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{doc:"The circle is aligned to the plane of the map."},viewport:{doc:"The circle is aligned to the plane of the viewport."}},default:"viewport",doc:"Orientation of circle when map is pitched.","sdk-support":{"basic functionality":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"The width of the circle's stroke. Strokes are placed outside of the `circle-radius`.","sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",doc:"The stroke color of the circle.",transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",doc:"The opacity of the circle's stroke.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},hw={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",doc:"Radius of influence of one heatmap point in pixels. Increasing the value makes the heatmap smoother, but less detailed. `queryRenderedFeatures` on heatmap layers will return points within this radius.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,doc:"A measure of how much an individual point contributes to the heatmap. A value of 10 would be equivalent to having 10 points of weight 1 in the same spot. Especially useful when combined with clustering.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,doc:"Similar to `heatmap-weight` but controls the intensity of the heatmap globally. Primarily used for adjusting the heatmap based on zoom level.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],doc:'Defines the color of each pixel based on its density value in a heatmap.  Should be an expression that uses `["heatmap-density"]` as input.',transition:!1,"sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",doc:"The global opacity at which the heatmap layer will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},pw={"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,doc:"The color of the icon. This can only be used with [SDF icons](/help/troubleshooting/using-recolorable-images-in-mapbox-maps/).",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,doc:"The color of the icon's halo. Icon halos can only be used with [SDF icons](/help/troubleshooting/using-recolorable-images-in-mapbox-maps/).",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"Distance that the icon's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{doc:"Icons are translated relative to the map."},viewport:{doc:"Icons are translated relative to the viewport."}},doc:"Controls the frame of reference for `icon-translate`.",default:"map",requires:["icon-image","icon-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",doc:"The color with which the text will be drawn.",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"Distance that the text's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{doc:"The text is translated relative to the map."},viewport:{doc:"The text is translated relative to the viewport."}},doc:"Controls the frame of reference for `text-translate`.",default:"map",requires:["text-field","text-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},dw={"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",doc:"Rotates hues around the color wheel.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.",default:0,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.",default:0,minimum:-1,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.",default:0,minimum:-1,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",doc:"The resampling/interpolation method to use for overscaling, also known as texture magnification filter",values:{linear:{doc:"(Bi)linear filtering interpolates pixel values using the weighted average of the four closest original source pixels creating a smooth but blurry look when overscaled"},nearest:{doc:"Nearest neighbor filtering interpolates pixel values using the nearest original source pixel creating a sharp but pixelated look when overscaled"}},default:"linear","sdk-support":{"basic functionality":{js:"0.47.0",android:"6.3.0",ios:"4.2.0",macos:"0.9.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",doc:"Fade duration when a new tile is added.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},fw={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,doc:"The direction of the light source used to generate the hillshading with 0 as the top of the viewport if `hillshade-illumination-anchor` is set to `viewport` and due north if `hillshade-illumination-anchor` is set to `map`.",transition:!1,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{doc:"The hillshade illumination is relative to the north direction."},viewport:{doc:"The hillshade illumination is relative to the top of the viewport."}},default:"viewport",doc:"Direction of light source when map is rotated.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",doc:"Intensity of the hillshade",default:.5,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",doc:"The shading color of areas that face away from the light source.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",doc:"The shading color of areas that faces towards the light source.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",doc:"The shading color used to accentuate rugged terrain like sharp cliffs and gorges.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},mw={"background-color":{type:"color",default:"#000000",doc:"The color with which the background will be drawn.",transition:!0,requires:[{"!":"background-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing an image background. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},yw={"sky-type":{type:"enum",values:{gradient:{doc:"Renders the sky with a gradient that can be configured with `sky-gradient-radius` and `sky-gradient`."},atmosphere:{doc:"Renders the sky with a simulated atmospheric scattering algorithm, the sun direction can be attached to the light position or explicitly set through `sky-atmosphere-sun`."}},default:"atmosphere",doc:"The type of the sky","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,doc:"Position of the sun center [a azimuthal angle, p polar angle]. The azimuthal angle indicates the position of the sun relative to 0\xB0 north, where degrees proceed clockwise. The polar angle indicates the height of the sun, where 0\xB0 is directly above, at zenith, and 90\xB0 at the horizon. When this property is ommitted, the sun center is directly inherited from the light position.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,doc:"Intensity of the sun as a light source in the atmosphere (on a scale from 0 to a 100). Setting higher values will brighten up the sky.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,doc:"Position of the gradient center [a azimuthal angle, p polar angle]. The azimuthal angle indicates the position of the gradient center relative to 0\xB0 north, where degrees proceed clockwise. The polar angle indicates the height of the gradient center, where 0\xB0 is directly above, at zenith, and 90\xB0 at the horizon.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,doc:"The angular distance (measured in degrees) from `sky-gradient-center` up to which the gradient extends. A value of 180 causes the gradient to wrap around to the opposite direction from `sky-gradient-center`.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],doc:"Defines a radial color gradient with which to color the sky. The color values can be interpolated with an expression using `sky-radial-progress`. The range [0, 1] for the interpolant covers a radial distance (in degrees) of [0, `sky-gradient-radius`] centered at the position specified by `sky-gradient-center`.",transition:!1,requires:[{"sky-type":"gradient"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",doc:"A color applied to the atmosphere sun halo. The alpha channel describes how strongly the sun halo is represented in an atmosphere sky layer.",transition:!1,requires:[{"sky-type":"atmosphere"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",doc:"A color used to tweak the main atmospheric scattering coefficients. Using white applies the default coefficients giving the natural blue color to the atmosphere. This color affects how heavily the corresponding wavelength is represented during scattering. The alpha channel describes the density of the atmosphere, with 1 maximum density and 0 no density.",transition:!1,requires:[{"sky-type":"atmosphere"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire sky layer.",transition:!0,"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},gw={duration:{type:"number",default:300,minimum:0,units:"milliseconds",doc:"Time allotted for transitions to complete."},delay:{type:"number",default:0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}},_w={"*":{type:"string",doc:"A name of a feature property to use as ID for feature state."}},vw={$version:Sb,$root:Tb,sources:Ab,source:Cb,source_vector:kb,source_raster:zb,source_raster_dem:Pb,source_geojson:Mb,source_video:Lb,source_image:Db,layer:Rb,layout:Bb,layout_background:Ob,layout_sky:Fb,layout_fill:Ub,layout_circle:Nb,layout_heatmap:jb,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},"property-type":"constant"}},layout_line:Vb,layout_symbol:qb,layout_raster:Gb,layout_hillshade:Zb,filter:Hb,filter_symbol:Wb,filter_fill:Xb,filter_line:Kb,filter_circle:Jb,"filter_fill-extrusion":{type:"boolean",doc:'Expression which determines whether or not to display a Polygon. Fill-extrusion layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:Yb,filter_operator:$b,geometry_type:Qb,function:{expression:{type:"expression",doc:"An expression."},stops:{type:"array",doc:"An array of stops.",value:"function_stop"},base:{type:"number",default:1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."},property:{type:"string",doc:"The name of a feature property to use as the function input.",default:"$zoom"},type:{type:"enum",values:{identity:{doc:"Return the input value as the output value."},exponential:{doc:"Generate an output by interpolating between stops just less than and just greater than the function input."},interval:{doc:"Return the output value of the stop just less than the function input."},categorical:{doc:"Return the output value of the stop equal to the function input."}},doc:"The interpolation strategy to use in function evaluation.",default:"exponential"},colorSpace:{type:"enum",values:{rgb:{doc:"Use the RGB color space to interpolate color values"},lab:{doc:"Use the LAB color space to interpolate color values."},hcl:{doc:"Use the HCL color space to interpolate color values, interpolating the Hue, Chroma, and Luminance channels individually."}},doc:"The color space in which colors interpolated. Interpolating colors in perceptual color spaces like LAB and HCL tend to produce color ramps that look more consistent and produce colors that can be differentiated more easily than those interpolated in RGB space.",default:"rgb"},default:{type:"*",required:!1,doc:`A value to serve as a fallback function result when a value isn't otherwise available. It is used in the following circumstances:
* In categorical functions, when the feature value does not match any of the stop domain values.
* In property and zoom-and-property functions, when a feature does not contain a value for the specified property.
* In identity functions, when the feature value is not valid for the style property (for example, if the function is being used for a \`circle-color\` property but the feature property value is not a string or not a valid color).
* In interval or exponential property and zoom-and-property functions, when the feature value is not numeric.
If no default is provided, the style property's default is used in these circumstances.`}},function_stop:ew,expression:tw,expression_name:iw,fog:rw,light:nw,projection:ow,terrain:aw,paint:sw,paint_fill:lw,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire fill extrusion layer. This is rendered on a per-layer, not per-feature, basis, and data-driven styling is not available.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",doc:"The base color of the extruded fill. The extrusion's surfaces will be shaded differently based on this color in combination with the root `light` settings. If this color is specified as `rgba` with an alpha component, the alpha component will be ignored; use `fill-extrusion-opacity` to set layer opacity.",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up (on the flat plane), respectively.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{doc:"The fill extrusion is translated relative to the map."},viewport:{doc:"The fill extrusion is translated relative to the viewport."}},doc:"Controls the frame of reference for `fill-extrusion-translate`.",default:"map",requires:["fill-extrusion-translate"],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing images on extruded fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",doc:"The height with which to extrude this layer.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",doc:"The height with which to extrude the base of this layer. Must be less than or equal to `fill-extrusion-height`.",transition:!0,requires:["fill-extrusion-height"],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,doc:"Whether to apply a vertical gradient to the sides of a fill-extrusion layer. If true, sides will be shaded slightly darker farther down.",transition:!1,"sdk-support":{"basic functionality":{js:"0.50.0",android:"7.0.0",ios:"4.7.0",macos:"0.13.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:uw,paint_circle:cw,paint_heatmap:hw,paint_symbol:pw,paint_raster:dw,paint_hillshade:fw,paint_background:mw,paint_sky:yw,transition:gw,"property-type":{"data-driven":{type:"property-type",doc:"Property is interpolable and can be represented using a property expression."},"cross-faded":{type:"property-type",doc:"Property is non-interpolable; rather, its values will be cross-faded to smoothly transition between integer zooms."},"cross-faded-data-driven":{type:"property-type",doc:"Property is non-interpolable; rather, its values will be cross-faded to smoothly transition between integer zooms. It can be represented using a property expression."},"color-ramp":{type:"property-type",doc:"Property should be specified using a color ramp from which the output color can be sampled based on a property calculation."},"data-constant":{type:"property-type",doc:"Property is interpolable but cannot be represented using a property expression."},constant:{type:"property-type",doc:"Property is constant across all zoom levels and property values."}},promoteId:_w},fy=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function $f(c){var a={exports:{}};return c(a,a.exports),a.exports}function xw(c){throw new Error('Could not dynamically require "'+c+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}/*! https://mths.be/punycode v1.3.2 by @mathias */$f(function(c,a){(function(l){var x=a&&!a.nodeType&&a,T=c&&!c.nodeType&&c,P=typeof fy=="object"&&fy;(P.global===P||P.window===P||P.self===P)&&(l=P);var f,d=2147483647,R=36,q=1,V=26,G=38,X=700,Me=72,ke=128,qe="-",We=/^xn--/,ft=/[^\x20-\x7E]/,Ge=/[\x2E\u3002\uFF0E\uFF61]/g,Ze={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},gt=R-q,ct=Math.floor,pt=String.fromCharCode,lt;function pi(Dt){throw RangeError(Ze[Dt])}function Et(Dt,oi){for(var fi=Dt.length,Bi=[];fi--;)Bi[fi]=oi(Dt[fi]);return Bi}function Wt(Dt,oi){var fi=Dt.split("@"),Bi="";fi.length>1&&(Bi=fi[0]+"@",Dt=fi[1]),Dt=Dt.replace(Ge,".");var Nt=Dt.split("."),Xi=Et(Nt,oi).join(".");return Bi+Xi}function vi(Dt){for(var oi=[],fi=0,Bi=Dt.length,Nt,Xi;fi<Bi;)Nt=Dt.charCodeAt(fi++),Nt>=55296&&Nt<=56319&&fi<Bi?(Xi=Dt.charCodeAt(fi++),(Xi&64512)==56320?oi.push(((Nt&1023)<<10)+(Xi&1023)+65536):(oi.push(Nt),fi--)):oi.push(Nt);return oi}function qi(Dt){return Et(Dt,function(oi){var fi="";return oi>65535&&(oi-=65536,fi+=pt(oi>>>10&1023|55296),oi=56320|oi&1023),fi+=pt(oi),fi}).join("")}function Xt(Dt){return Dt-48<10?Dt-22:Dt-65<26?Dt-65:Dt-97<26?Dt-97:R}function Qt(Dt,oi){return Dt+22+75*(Dt<26)-((oi!=0)<<5)}function Ei(Dt,oi,fi){var Bi=0;for(Dt=fi?ct(Dt/X):Dt>>1,Dt+=ct(Dt/oi);Dt>gt*V>>1;Bi+=R)Dt=ct(Dt/gt);return ct(Bi+(gt+1)*Dt/(Dt+G))}function bt(Dt){var oi=[],fi=Dt.length,Bi,Nt=0,Xi=ke,Li=Me,xi,rr,Ti,zt,tr,Rt,rt,yi,ir;for(xi=Dt.lastIndexOf(qe),xi<0&&(xi=0),rr=0;rr<xi;++rr)Dt.charCodeAt(rr)>=128&&pi("not-basic"),oi.push(Dt.charCodeAt(rr));for(Ti=xi>0?xi+1:0;Ti<fi;){for(zt=Nt,tr=1,Rt=R;Ti>=fi&&pi("invalid-input"),rt=Xt(Dt.charCodeAt(Ti++)),(rt>=R||rt>ct((d-Nt)/tr))&&pi("overflow"),Nt+=rt*tr,yi=Rt<=Li?q:Rt>=Li+V?V:Rt-Li,!(rt<yi);Rt+=R)ir=R-yi,tr>ct(d/ir)&&pi("overflow"),tr*=ir;Bi=oi.length+1,Li=Ei(Nt-zt,Bi,zt==0),ct(Nt/Bi)>d-Xi&&pi("overflow"),Xi+=ct(Nt/Bi),Nt%=Bi,oi.splice(Nt++,0,Xi)}return qi(oi)}function Gi(Dt){var oi,fi,Bi,Nt,Xi,Li,xi,rr,Ti,zt,tr,Rt=[],rt,yi,ir,Cr;for(Dt=vi(Dt),rt=Dt.length,oi=ke,fi=0,Xi=Me,Li=0;Li<rt;++Li)tr=Dt[Li],tr<128&&Rt.push(pt(tr));for(Bi=Nt=Rt.length,Nt&&Rt.push(qe);Bi<rt;){for(xi=d,Li=0;Li<rt;++Li)tr=Dt[Li],tr>=oi&&tr<xi&&(xi=tr);for(yi=Bi+1,xi-oi>ct((d-fi)/yi)&&pi("overflow"),fi+=(xi-oi)*yi,oi=xi,Li=0;Li<rt;++Li)if(tr=Dt[Li],tr<oi&&++fi>d&&pi("overflow"),tr==oi){for(rr=fi,Ti=R;zt=Ti<=Xi?q:Ti>=Xi+V?V:Ti-Xi,!(rr<zt);Ti+=R)Cr=rr-zt,ir=R-zt,Rt.push(pt(Qt(zt+Cr%ir,0))),rr=ct(Cr/ir);Rt.push(pt(Qt(rr,0))),Xi=Ei(fi,yi,Bi==Nt),fi=0,++Bi}++fi,++oi}return Rt.join("")}function hr(Dt){return Wt(Dt,function(oi){return We.test(oi)?bt(oi.slice(4).toLowerCase()):oi})}function wr(Dt){return Wt(Dt,function(oi){return ft.test(oi)?"xn--"+Gi(oi):oi})}if(f={version:"1.3.2",ucs2:{decode:vi,encode:qi},decode:bt,encode:Gi,toASCII:wr,toUnicode:hr},x&&T)if(c.exports==x)T.exports=f;else for(lt in f)f.hasOwnProperty(lt)&&(x[lt]=f[lt]);else l.punycode=f})(fy)});function bw(c,a){return Object.prototype.hasOwnProperty.call(c,a)}var ww=function(c,a,l,x){a=a||"&",l=l||"=";var T={};if(typeof c!="string"||c.length===0)return T;var P=/\+/g;c=c.split(a);var f=1e3;x&&typeof x.maxKeys=="number"&&(f=x.maxKeys);var d=c.length;f>0&&d>f&&(d=f);for(var R=0;R<d;++R){var q=c[R].replace(P,"%20"),V=q.indexOf(l),G,X,Me,ke;V>=0?(G=q.substr(0,V),X=q.substr(V+1)):(G=q,X=""),Me=decodeURIComponent(G),ke=decodeURIComponent(X),bw(T,Me)?Array.isArray(T[Me])?T[Me].push(ke):T[Me]=[T[Me],ke]:T[Me]=ke}return T},Cd=function(c){switch(typeof c){case"string":return c;case"boolean":return c?"true":"false";case"number":return isFinite(c)?c:"";default:return""}},Ew=function(c,a,l,x){return a=a||"&",l=l||"=",c===null&&(c=void 0),typeof c=="object"?Object.keys(c).map(function(T){var P=encodeURIComponent(Cd(T))+l;return Array.isArray(c[T])?c[T].map(function(f){return P+encodeURIComponent(Cd(f))}).join(a):P+encodeURIComponent(Cd(c[T]))}).join(a):x?encodeURIComponent(Cd(x))+l+encodeURIComponent(Cd(c)):""};$f(function(c,a){a.decode=a.parse=ww,a.encode=a.stringify=Ew});function dv(c,...a){for(const l of a)for(const x in l)c[x]=l[x];return c}class Ju extends Error{constructor(a,l){super(l),this.message=l,this.key=a}}class Ky{constructor(a,l=[]){this.parent=a,this.bindings={};for(const[x,T]of l)this.bindings[x]=T}concat(a){return new Ky(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return this.bindings[a]?!0:this.parent?this.parent.has(a):!1}}const Qf={kind:"null"},si={kind:"number"},Lr={kind:"string"},vr={kind:"boolean"},zc={kind:"color"},Mp={kind:"object"},xr={kind:"value"},Iw={kind:"error"},em={kind:"collator"},tm={kind:"formatted"},jd={kind:"resolvedImage"};function Ml(c,a){return{kind:"array",itemType:c,N:a}}function ho(c){if(c.kind==="array"){const a=ho(c.itemType);return typeof c.N=="number"?`array<${a}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${a}>`}else return c.kind}const Sw=[Qf,si,Lr,vr,zc,tm,Mp,Ml(xr),jd];function Rd(c,a){if(a.kind==="error")return null;if(c.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!Rd(c.itemType,a.itemType))&&(typeof c.N!="number"||c.N===a.N))return null}else{if(c.kind===a.kind)return null;if(c.kind==="value"){for(const l of Sw)if(!Rd(l,a))return null}}return`Expected ${ho(c)} but found ${ho(a)} instead.`}function Jy(c,a){return a.some(l=>l.kind===c.kind)}function Bd(c,a){return a.some(l=>l==="null"?c===null:l==="array"?Array.isArray(c):l==="object"?c&&!Array.isArray(c)&&typeof c=="object":l===typeof c)}var Tw=$f(function(c,a){var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function x(q){return q=Math.round(q),q<0?0:q>255?255:q}function T(q){return q<0?0:q>1?1:q}function P(q){return q[q.length-1]==="%"?x(parseFloat(q)/100*255):x(parseInt(q))}function f(q){return q[q.length-1]==="%"?T(parseFloat(q)/100):T(parseFloat(q))}function d(q,V,G){return G<0?G+=1:G>1&&(G-=1),G*6<1?q+(V-q)*G*6:G*2<1?V:G*3<2?q+(V-q)*(2/3-G)*6:q}function R(q){var V=q.replace(/ /g,"").toLowerCase();if(V in l)return l[V].slice();if(V[0]==="#"){if(V.length===4){var G=parseInt(V.substr(1),16);return G>=0&&G<=4095?[(G&3840)>>4|(G&3840)>>8,G&240|(G&240)>>4,G&15|(G&15)<<4,1]:null}else if(V.length===7){var G=parseInt(V.substr(1),16);return G>=0&&G<=16777215?[(G&16711680)>>16,(G&65280)>>8,G&255,1]:null}return null}var X=V.indexOf("("),Me=V.indexOf(")");if(X!==-1&&Me+1===V.length){var ke=V.substr(0,X),qe=V.substr(X+1,Me-(X+1)).split(","),We=1;switch(ke){case"rgba":if(qe.length!==4)return null;We=f(qe.pop());case"rgb":return qe.length!==3?null:[P(qe[0]),P(qe[1]),P(qe[2]),We];case"hsla":if(qe.length!==4)return null;We=f(qe.pop());case"hsl":if(qe.length!==3)return null;var ft=(parseFloat(qe[0])%360+360)%360/360,Ge=f(qe[1]),Ze=f(qe[2]),gt=Ze<=.5?Ze*(Ge+1):Ze+Ge-Ze*Ge,ct=Ze*2-gt;return[x(d(ct,gt,ft+1/3)*255),x(d(ct,gt,ft)*255),x(d(ct,gt,ft-1/3)*255),We];default:return null}}return null}try{a.parseCSSColor=R}catch{}});class gn{constructor(a,l,x,T=1){this.r=a,this.g=l,this.b=x,this.a=T}static parse(a){if(!a)return;if(a instanceof gn)return a;if(typeof a!="string")return;const l=Tw.parseCSSColor(a);if(!!l)return new gn(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3])}toString(){const[a,l,x,T]=this.toArray();return`rgba(${Math.round(a)},${Math.round(l)},${Math.round(x)},${T})`}toArray(){const{r:a,g:l,b:x,a:T}=this;return T===0?[0,0,0,0]:[a*255/T,l*255/T,x*255/T,T]}}gn.black=new gn(0,0,0,1);gn.white=new gn(1,1,1,1);gn.transparent=new gn(0,0,0,0);gn.red=new gn(1,0,0,1);gn.blue=new gn(0,0,1,1);class Yy{constructor(a,l,x){a?this.sensitivity=l?"variant":"case":this.sensitivity=l?"accent":"base",this.locale=x,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,l){return this.collator.compare(a,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Fy{constructor(a,l,x,T,P){this.text=a.normalize?a.normalize():a,this.image=l,this.scale=x,this.fontStack=T,this.textColor=P}}class gu{constructor(a){this.sections=a}static fromString(a){return new gu([new Fy(a,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof gu?a:gu.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}serialize(){const a=["format"];for(const l of this.sections){if(l.image){a.push(["image",l.image.name]);continue}a.push(l.text);const x={};l.fontStack&&(x["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(x["font-scale"]=l.scale),l.textColor&&(x["text-color"]=["rgba"].concat(l.textColor.toArray())),a.push(x)}return a}}class Pc{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Pc({name:a,available:!1}):null}serialize(){return["image",this.name]}}function fv(c,a,l,x){return typeof c=="number"&&c>=0&&c<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof l=="number"&&l>=0&&l<=255?typeof x=="undefined"||typeof x=="number"&&x>=0&&x<=1?null:`Invalid rgba value [${[c,a,l,x].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof x=="number"?[c,a,l,x]:[c,a,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Gf(c){if(c===null)return!0;if(typeof c=="string")return!0;if(typeof c=="boolean")return!0;if(typeof c=="number")return!0;if(c instanceof gn)return!0;if(c instanceof Yy)return!0;if(c instanceof gu)return!0;if(c instanceof Pc)return!0;if(Array.isArray(c)){for(const a of c)if(!Gf(a))return!1;return!0}else if(typeof c=="object"){for(const a in c)if(!Gf(c[a]))return!1;return!0}else return!1}function ca(c){if(c===null)return Qf;if(typeof c=="string")return Lr;if(typeof c=="boolean")return vr;if(typeof c=="number")return si;if(c instanceof gn)return zc;if(c instanceof Yy)return em;if(c instanceof gu)return tm;if(c instanceof Pc)return jd;if(Array.isArray(c)){const a=c.length;let l;for(const x of c){const T=ca(x);if(!l)l=T;else{if(l===T)continue;l=xr;break}}return Ml(l||xr,a)}else return Mp}function Pd(c){const a=typeof c;return c===null?"":a==="string"||a==="number"||a==="boolean"?String(c):c instanceof gn||c instanceof gu||c instanceof Pc?c.toString():JSON.stringify(c)}class Op{constructor(a,l){this.type=a,this.value=l}static parse(a,l){if(a.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Gf(a[1]))return l.error("invalid value");const x=a[1];let T=ca(x);const P=l.expectedType;return T.kind==="array"&&T.N===0&&P&&P.kind==="array"&&(typeof P.N!="number"||P.N===0)&&(T=P),new Op(T,x)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof gn?["rgba"].concat(this.value.toArray()):this.value instanceof gu?this.value.serialize():this.value}}class Da{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}}const my={string:Lr,number:si,boolean:vr,object:Mp};class mu{constructor(a,l){this.type=a,this.args=l}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");let x=1,T;const P=a[0];if(P==="array"){let d;if(a.length>2){const q=a[1];if(typeof q!="string"||!(q in my)||q==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);d=my[q],x++}else d=xr;let R;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return l.error('The length argument to "array" must be a positive integer literal',2);R=a[2],x++}T=Ml(d,R)}else T=my[P];const f=[];for(;x<a.length;x++){const d=l.parse(a[x],x,xr);if(!d)return null;f.push(d)}return new mu(T,f)}evaluate(a){for(let l=0;l<this.args.length;l++){const x=this.args[l].evaluate(a);if(Rd(this.type,ca(x))){if(l===this.args.length-1)throw new Da(`Expected value to be of type ${ho(this.type)}, but found ${ho(ca(x))} instead.`)}else return x}return null}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=this.type,l=[a.kind];if(a.kind==="array"){const x=a.itemType;if(x.kind==="string"||x.kind==="number"||x.kind==="boolean"){l.push(x.kind);const T=a.N;(typeof T=="number"||this.args.length>1)&&l.push(T)}}return l.concat(this.args.map(x=>x.serialize()))}}class im{constructor(a){this.type=tm,this.sections=a}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");const x=a[1];if(!Array.isArray(x)&&typeof x=="object")return l.error("First argument must be an image or text section.");const T=[];let P=!1;for(let f=1;f<=a.length-1;++f){const d=a[f];if(P&&typeof d=="object"&&!Array.isArray(d)){P=!1;let R=null;if(d["font-scale"]&&(R=l.parse(d["font-scale"],1,si),!R))return null;let q=null;if(d["text-font"]&&(q=l.parse(d["text-font"],1,Ml(Lr)),!q))return null;let V=null;if(d["text-color"]&&(V=l.parse(d["text-color"],1,zc),!V))return null;const G=T[T.length-1];G.scale=R,G.font=q,G.textColor=V}else{const R=l.parse(a[f],1,xr);if(!R)return null;const q=R.type.kind;if(q!=="string"&&q!=="value"&&q!=="null"&&q!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");P=!0,T.push({content:R,scale:null,font:null,textColor:null})}}return new im(T)}evaluate(a){const l=x=>{const T=x.content.evaluate(a);return ca(T)===jd?new Fy("",T,null,null,null):new Fy(Pd(T),null,x.scale?x.scale.evaluate(a):null,x.font?x.font.evaluate(a).join(","):null,x.textColor?x.textColor.evaluate(a):null)};return new gu(this.sections.map(l))}eachChild(a){for(const l of this.sections)a(l.content),l.scale&&a(l.scale),l.font&&a(l.font),l.textColor&&a(l.textColor)}outputDefined(){return!1}serialize(){const a=["format"];for(const l of this.sections){a.push(l.content.serialize());const x={};l.scale&&(x["font-scale"]=l.scale.serialize()),l.font&&(x["text-font"]=l.font.serialize()),l.textColor&&(x["text-color"]=l.textColor.serialize()),a.push(x)}return a}}class rm{constructor(a){this.type=jd,this.input=a}static parse(a,l){if(a.length!==2)return l.error("Expected two arguments.");const x=l.parse(a[1],1,Lr);return x?new rm(x):l.error("No image name provided.")}evaluate(a){const l=this.input.evaluate(a),x=Pc.fromString(l);return x&&a.availableImages&&(x.available=a.availableImages.indexOf(l)>-1),x}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Aw={"to-boolean":vr,"to-color":zc,"to-number":si,"to-string":Lr};class hh{constructor(a,l){this.type=a,this.args=l}static parse(a,l){if(a.length<2)return l.error("Expected at least one argument.");const x=a[0];if((x==="to-boolean"||x==="to-string")&&a.length!==2)return l.error("Expected one argument.");const T=Aw[x],P=[];for(let f=1;f<a.length;f++){const d=l.parse(a[f],f,xr);if(!d)return null;P.push(d)}return new hh(T,P)}evaluate(a){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(a));if(this.type.kind==="color"){let l,x;for(const T of this.args){if(l=T.evaluate(a),x=null,l instanceof gn)return l;if(typeof l=="string"){const P=a.parseColor(l);if(P)return P}else if(Array.isArray(l)&&(l.length<3||l.length>4?x=`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:x=fv(l[0],l[1],l[2],l[3]),!x))return new gn(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Da(x||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}else if(this.type.kind==="number"){let l=null;for(const x of this.args){if(l=x.evaluate(a),l===null)return 0;const T=Number(l);if(!isNaN(T))return T}throw new Da(`Could not convert ${JSON.stringify(l)} to number.`)}else return this.type.kind==="formatted"?gu.fromString(Pd(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?Pc.fromString(Pd(this.args[0].evaluate(a))):Pd(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){if(this.type.kind==="formatted")return new im([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new rm(this.args[0]).serialize();const a=[`to-${this.type.kind}`];return this.eachChild(l=>{a.push(l.serialize())}),a}}const Cw=["Unknown","Point","LineString","Polygon"];class mv{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Cw[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x,y:T}=this.featureTileCoord,P=x*l-a[0],f=T*l-a[1],d=this.featureDistanceData.bearing[0],R=this.featureDistanceData.bearing[1];return d*P+R*f}return 0}parseColor(a){let l=this._parseColorCache[a];return l||(l=this._parseColorCache[a]=gn.parse(a)),l}}class yu{constructor(a,l,x,T){this.name=a,this.type=l,this._evaluate=x,this.args=T}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(a=>a.serialize()))}static parse(a,l){const x=a[0],T=yu.definitions[x];if(!T)return l.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0);const P=Array.isArray(T)?T[0]:T.type,f=Array.isArray(T)?[[T[1],T[2]]]:T.overloads,d=f.filter(([q])=>!Array.isArray(q)||q.length===a.length-1);let R=null;for(const[q,V]of d){R=new am(l.registry,l.path,null,l.scope);const G=[];let X=!1;for(let Me=1;Me<a.length;Me++){const ke=a[Me],qe=Array.isArray(q)?q[Me-1]:q.type,We=R.parse(ke,1+G.length,qe);if(!We){X=!0;break}G.push(We)}if(!X){if(Array.isArray(q)&&q.length!==G.length){R.error(`Expected ${q.length} arguments, but found ${G.length} instead.`);continue}for(let Me=0;Me<G.length;Me++){const ke=Array.isArray(q)?q[Me]:q.type,qe=G[Me];R.concat(Me+1).checkSubtype(ke,qe.type)}if(R.errors.length===0)return new yu(x,P,V,G)}}if(d.length===1)l.errors.push(...R.errors);else{const V=(d.length?d:f).map(([X])=>kw(X)).join(" | "),G=[];for(let X=1;X<a.length;X++){const Me=l.parse(a[X],1+G.length);if(!Me)return null;G.push(ho(Me.type))}l.error(`Expected arguments of type ${V}, but found (${G.join(", ")}) instead.`)}return null}static register(a,l){yu.definitions=l;for(const x in l)a[x]=yu}}function kw(c){return Array.isArray(c)?`(${c.map(ho).join(", ")})`:`(${ho(c.type)}...)`}class nm{constructor(a,l,x){this.type=em,this.locale=x,this.caseSensitive=a,this.diacriticSensitive=l}static parse(a,l){if(a.length!==2)return l.error("Expected one argument.");const x=a[1];if(typeof x!="object"||Array.isArray(x))return l.error("Collator options argument must be an object.");const T=l.parse(x["case-sensitive"]===void 0?!1:x["case-sensitive"],1,vr);if(!T)return null;const P=l.parse(x["diacritic-sensitive"]===void 0?!1:x["diacritic-sensitive"],1,vr);if(!P)return null;let f=null;return x.locale&&(f=l.parse(x.locale,1,Lr),!f)?null:new nm(T,P,f)}evaluate(a){return new Yy(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}serialize(){const a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]}}const ph=8192;function $y(c,a){c[0]=Math.min(c[0],a[0]),c[1]=Math.min(c[1],a[1]),c[2]=Math.max(c[2],a[0]),c[3]=Math.max(c[3],a[1])}function zw(c){return(180+c)/360}function Pw(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Zf(c,a){return!(c[0]<=a[0]||c[2]>=a[2]||c[1]<=a[1]||c[3]>=a[3])}function Mw(c,a){const l=zw(c[0]),x=Pw(c[1]),T=Math.pow(2,a.z);return[Math.round(l*T*ph),Math.round(x*T*ph)]}function Lw(c,a,l){const x=c[0]-a[0],T=c[1]-a[1],P=c[0]-l[0],f=c[1]-l[1];return x*f-P*T===0&&x*P<=0&&T*f<=0}function Dw(c,a,l){return a[1]>c[1]!=l[1]>c[1]&&c[0]<(l[0]-a[0])*(c[1]-a[1])/(l[1]-a[1])+a[0]}function Qy(c,a){let l=!1;for(let x=0,T=a.length;x<T;x++){const P=a[x];for(let f=0,d=P.length;f<d-1;f++){if(Lw(c,P[f],P[f+1]))return!1;Dw(c,P[f],P[f+1])&&(l=!l)}}return l}function Rw(c,a){for(let l=0;l<a.length;l++)if(Qy(c,a[l]))return!0;return!1}function Bw(c,a){return c[0]*a[1]-c[1]*a[0]}function E_(c,a,l,x){const T=c[0]-l[0],P=c[1]-l[1],f=a[0]-l[0],d=a[1]-l[1],R=x[0]-l[0],q=x[1]-l[1],V=T*q-R*P,G=f*q-R*d;return V>0&&G<0||V<0&&G>0}function Ow(c,a,l,x){const T=[a[0]-c[0],a[1]-c[1]],P=[x[0]-l[0],x[1]-l[1]];return Bw(P,T)===0?!1:!!(E_(c,a,l,x)&&E_(l,x,c,a))}function Fw(c,a,l){for(const x of l)for(let T=0;T<x.length-1;++T)if(Ow(c,a,x[T],x[T+1]))return!0;return!1}function yv(c,a){for(let l=0;l<c.length;++l)if(!Qy(c[l],a))return!1;for(let l=0;l<c.length-1;++l)if(Fw(c[l],c[l+1],a))return!1;return!0}function Uw(c,a){for(let l=0;l<a.length;l++)if(yv(c,a[l]))return!0;return!1}function eg(c,a,l){const x=[];for(let T=0;T<c.length;T++){const P=[];for(let f=0;f<c[T].length;f++){const d=Mw(c[T][f],l);$y(a,d),P.push(d)}x.push(P)}return x}function gv(c,a,l){const x=[];for(let T=0;T<c.length;T++){const P=eg(c[T],a,l);x.push(P)}return x}function _v(c,a,l,x){if(c[0]<l[0]||c[0]>l[2]){const T=x*.5;let P=c[0]-l[0]>T?-x:l[0]-c[0]>T?x:0;P===0&&(P=c[0]-l[2]>T?-x:l[2]-c[0]>T?x:0),c[0]+=P}$y(a,c)}function Nw(c){c[0]=c[1]=1/0,c[2]=c[3]=-1/0}function I_(c,a,l,x){const T=Math.pow(2,x.z)*ph,P=[x.x*ph,x.y*ph],f=[];if(!c)return f;for(const d of c)for(const R of d){const q=[R.x+P[0],R.y+P[1]];_v(q,a,l,T),f.push(q)}return f}function S_(c,a,l,x){const T=Math.pow(2,x.z)*ph,P=[x.x*ph,x.y*ph],f=[];if(!c)return f;for(const d of c){const R=[];for(const q of d){const V=[q.x+P[0],q.y+P[1]];$y(a,V),R.push(V)}f.push(R)}if(a[2]-a[0]<=T/2){Nw(a);for(const d of f)for(const R of d)_v(R,a,l,T)}return f}function jw(c,a){const l=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],T=c.canonicalID();if(!T)return!1;if(a.type==="Polygon"){const P=eg(a.coordinates,x,T),f=I_(c.geometry(),l,x,T);if(!Zf(l,x))return!1;for(const d of f)if(!Qy(d,P))return!1}if(a.type==="MultiPolygon"){const P=gv(a.coordinates,x,T),f=I_(c.geometry(),l,x,T);if(!Zf(l,x))return!1;for(const d of f)if(!Rw(d,P))return!1}return!0}function Vw(c,a){const l=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],T=c.canonicalID();if(!T)return!1;if(a.type==="Polygon"){const P=eg(a.coordinates,x,T),f=S_(c.geometry(),l,x,T);if(!Zf(l,x))return!1;for(const d of f)if(!yv(d,P))return!1}if(a.type==="MultiPolygon"){const P=gv(a.coordinates,x,T),f=S_(c.geometry(),l,x,T);if(!Zf(l,x))return!1;for(const d of f)if(!Uw(d,P))return!1}return!0}class Kh{constructor(a,l){this.type=vr,this.geojson=a,this.geometries=l}static parse(a,l){if(a.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Gf(a[1])){const x=a[1];if(x.type==="FeatureCollection")for(let T=0;T<x.features.length;++T){const P=x.features[T].geometry.type;if(P==="Polygon"||P==="MultiPolygon")return new Kh(x,x.features[T].geometry)}else if(x.type==="Feature"){const T=x.geometry.type;if(T==="Polygon"||T==="MultiPolygon")return new Kh(x,x.geometry)}else if(x.type==="Polygon"||x.type==="MultiPolygon")return new Kh(x,x)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return jw(a,this.geometries);if(a.geometryType()==="LineString")return Vw(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function tg(c){if(c instanceof yu){if(c.name==="get"&&c.args.length===1)return!1;if(c.name==="feature-state")return!1;if(c.name==="has"&&c.args.length===1)return!1;if(c.name==="properties"||c.name==="geometry-type"||c.name==="id")return!1;if(/^filter-/.test(c.name))return!1}if(c instanceof Kh)return!1;let a=!0;return c.eachChild(l=>{a&&!tg(l)&&(a=!1)}),a}function ig(c){if(c instanceof yu&&c.name==="feature-state")return!1;let a=!0;return c.eachChild(l=>{a&&!ig(l)&&(a=!1)}),a}function rg(c,a){if(c instanceof yu&&a.indexOf(c.name)>=0)return!1;let l=!0;return c.eachChild(x=>{l&&!rg(x,a)&&(l=!1)}),l}class om{constructor(a,l){this.type=l.type,this.name=a,this.boundExpression=l}static parse(a,l){if(a.length!==2||typeof a[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const x=a[1];return l.scope.has(x)?new om(x,l.scope.get(x)):l.error(`Unknown variable "${x}". Make sure "${x}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class am{constructor(a,l=[],x,T=new Ky,P=[]){this.registry=a,this.path=l,this.key=l.map(f=>`[${f}]`).join(""),this.scope=T,this.errors=P,this.expectedType=x}parse(a,l,x,T,P={}){return l?this.concat(l,x,T)._parse(a,P):this._parse(a,P)}_parse(a,l){(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number")&&(a=["literal",a]);function x(T,P,f){return f==="assert"?new mu(P,[T]):f==="coerce"?new hh(P,[T]):T}if(Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const T=a[0];if(typeof T!="string")return this.error(`Expression name must be a string, but found ${typeof T} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const P=this.registry[T];if(P){let f=P.parse(a,this);if(!f)return null;if(this.expectedType){const d=this.expectedType,R=f.type;if((d.kind==="string"||d.kind==="number"||d.kind==="boolean"||d.kind==="object"||d.kind==="array")&&R.kind==="value")f=x(f,d,l.typeAnnotation||"assert");else if((d.kind==="color"||d.kind==="formatted"||d.kind==="resolvedImage")&&(R.kind==="value"||R.kind==="string"))f=x(f,d,l.typeAnnotation||"coerce");else if(this.checkSubtype(d,R))return null}if(!(f instanceof Op)&&f.type.kind!=="resolvedImage"&&Uy(f)){const d=new mv;try{f=new Op(f.type,f.evaluate(d))}catch(R){return this.error(R.message),null}}return f}return this.error(`Unknown expression "${T}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof a=="undefined"?this.error("'undefined' value invalid. Use null instead."):typeof a=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof a} instead.`)}concat(a,l,x){const T=typeof a=="number"?this.path.concat(a):this.path,P=x?this.scope.concat(x):this.scope;return new am(this.registry,T,l||null,P,this.errors)}error(a,...l){const x=`${this.key}${l.map(T=>`[${T}]`).join("")}`;this.errors.push(new Ju(x,a))}checkSubtype(a,l){const x=Rd(a,l);return x&&this.error(x),x}}function Uy(c){if(c instanceof om)return Uy(c.boundExpression);if(c instanceof yu&&c.name==="error")return!1;if(c instanceof nm)return!1;if(c instanceof Kh)return!1;const a=c instanceof hh||c instanceof mu;let l=!0;return c.eachChild(x=>{a?l=l&&Uy(x):l=l&&x instanceof Op}),l?tg(c)&&rg(c,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"]):!1}function sm(c,a){const l=c.length-1;let x=0,T=l,P=0,f,d;for(;x<=T;)if(P=Math.floor((x+T)/2),f=c[P],d=c[P+1],f<=a){if(P===l||a<d)return P;x=P+1}else if(f>a)T=P-1;else throw new Da("Input is not a number.");return 0}class lm{constructor(a,l,x){this.type=a,this.input=l,this.labels=[],this.outputs=[];for(const[T,P]of x)this.labels.push(T),this.outputs.push(P)}static parse(a,l){if(a.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!==0)return l.error("Expected an even number of arguments.");const x=l.parse(a[1],1,si);if(!x)return null;const T=[];let P=null;l.expectedType&&l.expectedType.kind!=="value"&&(P=l.expectedType);for(let f=1;f<a.length;f+=2){const d=f===1?-1/0:a[f],R=a[f+1],q=f,V=f+1;if(typeof d!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(T.length&&T[T.length-1][0]>=d)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',q);const G=l.parse(R,V,P);if(!G)return null;P=P||G.type,T.push([d,G])}return new lm(P,x,T)}evaluate(a){const l=this.labels,x=this.outputs;if(l.length===1)return x[0].evaluate(a);const T=this.input.evaluate(a);if(T<=l[0])return x[0].evaluate(a);const P=l.length;if(T>=l[P-1])return x[P-1].evaluate(a);const f=sm(l,T);return x[f].evaluate(a)}eachChild(a){a(this.input);for(const l of this.outputs)a(l)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){const a=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&a.push(this.labels[l]),a.push(this.outputs[l].serialize());return a}}var qw=qp;function qp(c,a,l,x){this.cx=3*c,this.bx=3*(l-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(x-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=x,this.p2x=l,this.p2y=x}qp.prototype.sampleCurveX=function(c){return((this.ax*c+this.bx)*c+this.cx)*c};qp.prototype.sampleCurveY=function(c){return((this.ay*c+this.by)*c+this.cy)*c};qp.prototype.sampleCurveDerivativeX=function(c){return(3*this.ax*c+2*this.bx)*c+this.cx};qp.prototype.solveCurveX=function(c,a){typeof a=="undefined"&&(a=1e-6);var l,x,T,P,f;for(T=c,f=0;f<8;f++){if(P=this.sampleCurveX(T)-c,Math.abs(P)<a)return T;var d=this.sampleCurveDerivativeX(T);if(Math.abs(d)<1e-6)break;T=T-P/d}if(l=0,x=1,T=c,T<l)return l;if(T>x)return x;for(;l<x;){if(P=this.sampleCurveX(T),Math.abs(P-c)<a)return T;c>P?l=T:x=T,T=(x-l)*.5+l}return T};qp.prototype.solve=function(c,a){return this.sampleCurveY(this.solveCurveX(c,a))};function ul(c,a,l){return c*(1-l)+a*l}function Gw(c,a,l){return new gn(ul(c.r,a.r,l),ul(c.g,a.g,l),ul(c.b,a.b,l),ul(c.a,a.a,l))}function Zw(c,a,l){return c.map((x,T)=>ul(x,a[T],l))}var vv=Object.freeze({__proto__:null,number:ul,color:Gw,array:Zw});const xv=.95047,bv=1,wv=1.08883,Ev=4/29,Lp=6/29,Iv=3*Lp*Lp,Hw=Lp*Lp*Lp,Ww=Math.PI/180,Xw=180/Math.PI;function yy(c){return c>Hw?Math.pow(c,1/3):c/Iv+Ev}function gy(c){return c>Lp?c*c*c:Iv*(c-Ev)}function _y(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function vy(c){return c/=255,c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Sv(c){const a=vy(c.r),l=vy(c.g),x=vy(c.b),T=yy((.4124564*a+.3575761*l+.1804375*x)/xv),P=yy((.2126729*a+.7151522*l+.072175*x)/bv),f=yy((.0193339*a+.119192*l+.9503041*x)/wv);return{l:116*P-16,a:500*(T-P),b:200*(P-f),alpha:c.a}}function Tv(c){let a=(c.l+16)/116,l=isNaN(c.a)?a:a+c.a/500,x=isNaN(c.b)?a:a-c.b/200;return a=bv*gy(a),l=xv*gy(l),x=wv*gy(x),new gn(_y(3.2404542*l-1.5371385*a-.4985314*x),_y(-.969266*l+1.8760108*a+.041556*x),_y(.0556434*l-.2040259*a+1.0572252*x),c.alpha)}function Kw(c,a,l){return{l:ul(c.l,a.l,l),a:ul(c.a,a.a,l),b:ul(c.b,a.b,l),alpha:ul(c.alpha,a.alpha,l)}}function Jw(c){const{l:a,a:l,b:x}=Sv(c),T=Math.atan2(x,l)*Xw;return{h:T<0?T+360:T,c:Math.sqrt(l*l+x*x),l:a,alpha:c.a}}function Yw(c){const a=c.h*Ww,l=c.c,x=c.l;return Tv({l:x,a:Math.cos(a)*l,b:Math.sin(a)*l,alpha:c.alpha})}function $w(c,a,l){const x=a-c;return c+l*(x>180||x<-180?x-360*Math.round(x/360):x)}function Qw(c,a,l){return{h:$w(c.h,a.h,l),c:ul(c.c,a.c,l),l:ul(c.l,a.l,l),alpha:ul(c.alpha,a.alpha,l)}}const kd={forward:Sv,reverse:Tv,interpolate:Kw},zd={forward:Jw,reverse:Yw,interpolate:Qw};var Av=Object.freeze({__proto__:null,lab:kd,hcl:zd});class Dl{constructor(a,l,x,T,P){this.type=a,this.operator=l,this.interpolation=x,this.input=T,this.labels=[],this.outputs=[];for(const[f,d]of P)this.labels.push(f),this.outputs.push(d)}static interpolationFactor(a,l,x,T){let P=0;if(a.name==="exponential")P=xy(l,a.base,x,T);else if(a.name==="linear")P=xy(l,1,x,T);else if(a.name==="cubic-bezier"){const f=a.controlPoints;P=new qw(f[0],f[1],f[2],f[3]).solve(xy(l,1,x,T))}return P}static parse(a,l){let[x,T,P,...f]=a;if(!Array.isArray(T)||T.length===0)return l.error("Expected an interpolation type expression.",1);if(T[0]==="linear")T={name:"linear"};else if(T[0]==="exponential"){const q=T[1];if(typeof q!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);T={name:"exponential",base:q}}else if(T[0]==="cubic-bezier"){const q=T.slice(1);if(q.length!==4||q.some(V=>typeof V!="number"||V<0||V>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);T={name:"cubic-bezier",controlPoints:q}}else return l.error(`Unknown interpolation type ${String(T[0])}`,1,0);if(a.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!==0)return l.error("Expected an even number of arguments.");if(P=l.parse(P,2,si),!P)return null;const d=[];let R=null;x==="interpolate-hcl"||x==="interpolate-lab"?R=zc:l.expectedType&&l.expectedType.kind!=="value"&&(R=l.expectedType);for(let q=0;q<f.length;q+=2){const V=f[q],G=f[q+1],X=q+3,Me=q+4;if(typeof V!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',X);if(d.length&&d[d.length-1][0]>=V)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',X);const ke=l.parse(G,Me,R);if(!ke)return null;R=R||ke.type,d.push([V,ke])}return R.kind!=="number"&&R.kind!=="color"&&!(R.kind==="array"&&R.itemType.kind==="number"&&typeof R.N=="number")?l.error(`Type ${ho(R)} is not interpolatable.`):new Dl(R,x,T,P,d)}evaluate(a){const l=this.labels,x=this.outputs;if(l.length===1)return x[0].evaluate(a);const T=this.input.evaluate(a);if(T<=l[0])return x[0].evaluate(a);const P=l.length;if(T>=l[P-1])return x[P-1].evaluate(a);const f=sm(l,T),d=l[f],R=l[f+1],q=Dl.interpolationFactor(this.interpolation,T,d,R),V=x[f].evaluate(a),G=x[f+1].evaluate(a);return this.operator==="interpolate"?vv[this.type.kind.toLowerCase()](V,G,q):this.operator==="interpolate-hcl"?zd.reverse(zd.interpolate(zd.forward(V),zd.forward(G),q)):kd.reverse(kd.interpolate(kd.forward(V),kd.forward(G),q))}eachChild(a){a(this.input);for(const l of this.outputs)a(l)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){let a;this.interpolation.name==="linear"?a=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?a=["linear"]:a=["exponential",this.interpolation.base]:a=["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,a,this.input.serialize()];for(let x=0;x<this.labels.length;x++)l.push(this.labels[x],this.outputs[x].serialize());return l}}function xy(c,a,l,x){const T=x-l,P=c-l;return T===0?0:a===1?P/T:(Math.pow(a,P)-1)/(Math.pow(a,T)-1)}class Od{constructor(a,l){this.type=a,this.args=l}static parse(a,l){if(a.length<2)return l.error("Expectected at least one argument.");let x=null;const T=l.expectedType;T&&T.kind!=="value"&&(x=T);const P=[];for(const d of a.slice(1)){const R=l.parse(d,1+P.length,x,void 0,{typeAnnotation:"omit"});if(!R)return null;x=x||R.type,P.push(R)}return T&&P.some(d=>Rd(T,d.type))?new Od(xr,P):new Od(x,P)}evaluate(a){let l=null,x=0,T;for(const P of this.args){if(x++,l=P.evaluate(a),l&&l instanceof Pc&&!l.available&&(T||(T=l),l=null,x===this.args.length))return T;if(l!==null)break}return l}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=["coalesce"];return this.eachChild(l=>{a.push(l.serialize())}),a}}class um{constructor(a,l){this.type=l.type,this.bindings=[].concat(a),this.result=l}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const l of this.bindings)a(l[1]);a(this.result)}static parse(a,l){if(a.length<4)return l.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const x=[];for(let P=1;P<a.length-1;P+=2){const f=a[P];if(typeof f!="string")return l.error(`Expected string, but found ${typeof f} instead.`,P);if(/[^a-zA-Z0-9_]/.test(f))return l.error("Variable names must contain only alphanumeric characters or '_'.",P);const d=l.parse(a[P+1],P+1);if(!d)return null;x.push([f,d])}const T=l.parse(a[a.length-1],a.length-1,l.expectedType,x);return T?new um(x,T):null}outputDefined(){return this.result.outputDefined()}serialize(){const a=["let"];for(const[l,x]of this.bindings)a.push(l,x.serialize());return a.push(this.result.serialize()),a}}class ng{constructor(a,l,x){this.type=a,this.index=l,this.input=x}static parse(a,l){if(a.length!==3)return l.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const x=l.parse(a[1],1,si),T=l.parse(a[2],2,Ml(l.expectedType||xr));if(!x||!T)return null;const P=T.type;return new ng(P.itemType,x,T)}evaluate(a){const l=this.index.evaluate(a),x=this.input.evaluate(a);if(l<0)throw new Da(`Array index out of bounds: ${l} < 0.`);if(l>=x.length)throw new Da(`Array index out of bounds: ${l} > ${x.length-1}.`);if(l!==Math.floor(l))throw new Da(`Array index must be an integer, but found ${l} instead.`);return x[l]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class og{constructor(a,l){this.type=vr,this.needle=a,this.haystack=l}static parse(a,l){if(a.length!==3)return l.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const x=l.parse(a[1],1,xr),T=l.parse(a[2],2,xr);return!x||!T?null:Jy(x.type,[vr,Lr,si,Qf,xr])?new og(x,T):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ho(x.type)} instead`)}evaluate(a){const l=this.needle.evaluate(a),x=this.haystack.evaluate(a);if(x==null)return!1;if(!Bd(l,["boolean","string","number","null"]))throw new Da(`Expected first argument to be of type boolean, string, number or null, but found ${ho(ca(l))} instead.`);if(!Bd(x,["string","array"]))throw new Da(`Expected second argument to be of type array or string, but found ${ho(ca(x))} instead.`);return x.indexOf(l)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Hf{constructor(a,l,x){this.type=si,this.needle=a,this.haystack=l,this.fromIndex=x}static parse(a,l){if(a.length<=2||a.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const x=l.parse(a[1],1,xr),T=l.parse(a[2],2,xr);if(!x||!T)return null;if(!Jy(x.type,[vr,Lr,si,Qf,xr]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ho(x.type)} instead`);if(a.length===4){const P=l.parse(a[3],3,si);return P?new Hf(x,T,P):null}else return new Hf(x,T)}evaluate(a){const l=this.needle.evaluate(a),x=this.haystack.evaluate(a);if(!Bd(l,["boolean","string","number","null"]))throw new Da(`Expected first argument to be of type boolean, string, number or null, but found ${ho(ca(l))} instead.`);if(!Bd(x,["string","array"]))throw new Da(`Expected second argument to be of type array or string, but found ${ho(ca(x))} instead.`);if(this.fromIndex){const T=this.fromIndex.evaluate(a);return x.indexOf(l,T)}return x.indexOf(l)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class ag{constructor(a,l,x,T,P,f){this.inputType=a,this.type=l,this.input=x,this.cases=T,this.outputs=P,this.otherwise=f}static parse(a,l){if(a.length<5)return l.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!==1)return l.error("Expected an even number of arguments.");let x,T;l.expectedType&&l.expectedType.kind!=="value"&&(T=l.expectedType);const P={},f=[];for(let q=2;q<a.length-1;q+=2){let V=a[q];const G=a[q+1];Array.isArray(V)||(V=[V]);const X=l.concat(q);if(V.length===0)return X.error("Expected at least one branch label.");for(const ke of V){if(typeof ke!="number"&&typeof ke!="string")return X.error("Branch labels must be numbers or strings.");if(typeof ke=="number"&&Math.abs(ke)>Number.MAX_SAFE_INTEGER)return X.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ke=="number"&&Math.floor(ke)!==ke)return X.error("Numeric branch labels must be integer values.");if(!x)x=ca(ke);else if(X.checkSubtype(x,ca(ke)))return null;if(typeof P[String(ke)]!="undefined")return X.error("Branch labels must be unique.");P[String(ke)]=f.length}const Me=l.parse(G,q,T);if(!Me)return null;T=T||Me.type,f.push(Me)}const d=l.parse(a[1],1,xr);if(!d)return null;const R=l.parse(a[a.length-1],a.length-1,T);return!R||d.type.kind!=="value"&&l.concat(1).checkSubtype(x,d.type)?null:new ag(x,T,d,P,f,R)}evaluate(a){const l=this.input.evaluate(a);return(ca(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),x=[],T={};for(const f of l){const d=T[this.cases[f]];d===void 0?(T[this.cases[f]]=x.length,x.push([this.cases[f],[f]])):x[d][1].push(f)}const P=f=>this.inputType.kind==="number"?Number(f):f;for(const[f,d]of x)d.length===1?a.push(P(d[0])):a.push(d.map(P)),a.push(this.outputs[f].serialize());return a.push(this.otherwise.serialize()),a}}class sg{constructor(a,l,x){this.type=a,this.branches=l,this.otherwise=x}static parse(a,l){if(a.length<4)return l.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!==0)return l.error("Expected an odd number of arguments.");let x;l.expectedType&&l.expectedType.kind!=="value"&&(x=l.expectedType);const T=[];for(let f=1;f<a.length-1;f+=2){const d=l.parse(a[f],f,vr);if(!d)return null;const R=l.parse(a[f+1],f+1,x);if(!R)return null;T.push([d,R]),x=x||R.type}const P=l.parse(a[a.length-1],a.length-1,x);return P?new sg(x,T,P):null}evaluate(a){for(const[l,x]of this.branches)if(l.evaluate(a))return x.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[l,x]of this.branches)a(l),a(x);a(this.otherwise)}outputDefined(){return this.branches.every(([a,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["case"];return this.eachChild(l=>{a.push(l.serialize())}),a}}class Wf{constructor(a,l,x,T){this.type=a,this.input=l,this.beginIndex=x,this.endIndex=T}static parse(a,l){if(a.length<=2||a.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const x=l.parse(a[1],1,xr),T=l.parse(a[2],2,si);if(!x||!T)return null;if(!Jy(x.type,[Ml(xr),Lr,xr]))return l.error(`Expected first argument to be of type array or string, but found ${ho(x.type)} instead`);if(a.length===4){const P=l.parse(a[3],3,si);return P?new Wf(x.type,x,T,P):null}else return new Wf(x.type,x,T)}evaluate(a){const l=this.input.evaluate(a),x=this.beginIndex.evaluate(a);if(!Bd(l,["string","array"]))throw new Da(`Expected first argument to be of type array or string, but found ${ho(ca(l))} instead.`);if(this.endIndex){const T=this.endIndex.evaluate(a);return l.slice(x,T)}return l.slice(x)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function T_(c,a){return c==="=="||c==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function e2(c,a,l){return a===l}function t2(c,a,l){return a!==l}function i2(c,a,l){return a<l}function r2(c,a,l){return a>l}function n2(c,a,l){return a<=l}function o2(c,a,l){return a>=l}function Cv(c,a,l,x){return x.compare(a,l)===0}function a2(c,a,l,x){return!Cv(c,a,l,x)}function s2(c,a,l,x){return x.compare(a,l)<0}function l2(c,a,l,x){return x.compare(a,l)>0}function u2(c,a,l,x){return x.compare(a,l)<=0}function c2(c,a,l,x){return x.compare(a,l)>=0}function Gp(c,a,l){const x=c!=="=="&&c!=="!=";return class kv{constructor(P,f,d){this.type=vr,this.lhs=P,this.rhs=f,this.collator=d,this.hasUntypedArgument=P.type.kind==="value"||f.type.kind==="value"}static parse(P,f){if(P.length!==3&&P.length!==4)return f.error("Expected two or three arguments.");const d=P[0];let R=f.parse(P[1],1,xr);if(!R)return null;if(!T_(d,R.type))return f.concat(1).error(`"${d}" comparisons are not supported for type '${ho(R.type)}'.`);let q=f.parse(P[2],2,xr);if(!q)return null;if(!T_(d,q.type))return f.concat(2).error(`"${d}" comparisons are not supported for type '${ho(q.type)}'.`);if(R.type.kind!==q.type.kind&&R.type.kind!=="value"&&q.type.kind!=="value")return f.error(`Cannot compare types '${ho(R.type)}' and '${ho(q.type)}'.`);x&&(R.type.kind==="value"&&q.type.kind!=="value"?R=new mu(q.type,[R]):R.type.kind!=="value"&&q.type.kind==="value"&&(q=new mu(R.type,[q])));let V=null;if(P.length===4){if(R.type.kind!=="string"&&q.type.kind!=="string"&&R.type.kind!=="value"&&q.type.kind!=="value")return f.error("Cannot use collator to compare non-string types.");if(V=f.parse(P[3],3,em),!V)return null}return new kv(R,q,V)}evaluate(P){const f=this.lhs.evaluate(P),d=this.rhs.evaluate(P);if(x&&this.hasUntypedArgument){const R=ca(f),q=ca(d);if(R.kind!==q.kind||!(R.kind==="string"||R.kind==="number"))throw new Da(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${R.kind}, ${q.kind}) instead.`)}if(this.collator&&!x&&this.hasUntypedArgument){const R=ca(f),q=ca(d);if(R.kind!=="string"||q.kind!=="string")return a(P,f,d)}return this.collator?l(P,f,d,this.collator.evaluate(P)):a(P,f,d)}eachChild(P){P(this.lhs),P(this.rhs),this.collator&&P(this.collator)}outputDefined(){return!0}serialize(){const P=[c];return this.eachChild(f=>{P.push(f.serialize())}),P}}}const h2=Gp("==",e2,Cv),p2=Gp("!=",t2,a2),d2=Gp("<",i2,s2),f2=Gp(">",r2,l2),m2=Gp("<=",n2,u2),y2=Gp(">=",o2,c2);class lg{constructor(a,l,x,T,P){this.type=Lr,this.number=a,this.locale=l,this.currency=x,this.minFractionDigits=T,this.maxFractionDigits=P}static parse(a,l){if(a.length!==3)return l.error("Expected two arguments.");const x=l.parse(a[1],1,si);if(!x)return null;const T=a[2];if(typeof T!="object"||Array.isArray(T))return l.error("NumberFormat options argument must be an object.");let P=null;if(T.locale&&(P=l.parse(T.locale,1,Lr),!P))return null;let f=null;if(T.currency&&(f=l.parse(T.currency,1,Lr),!f))return null;let d=null;if(T["min-fraction-digits"]&&(d=l.parse(T["min-fraction-digits"],1,si),!d))return null;let R=null;return T["max-fraction-digits"]&&(R=l.parse(T["max-fraction-digits"],1,si),!R)?null:new lg(x,P,f,d,R)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]}}class ug{constructor(a){this.type=si,this.input=a}static parse(a,l){if(a.length!==2)return l.error(`Expected 1 argument, but found ${a.length-1} instead.`);const x=l.parse(a[1],1);return x?x.type.kind!=="array"&&x.type.kind!=="string"&&x.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${ho(x.type)} instead.`):new ug(x):null}evaluate(a){const l=this.input.evaluate(a);if(typeof l=="string")return l.length;if(Array.isArray(l))return l.length;throw new Da(`Expected value to be of type string or array, but found ${ho(ca(l))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){const a=["length"];return this.eachChild(l=>{a.push(l.serialize())}),a}}const cg={"==":h2,"!=":p2,">":f2,"<":d2,">=":y2,"<=":m2,array:mu,at:ng,boolean:mu,case:sg,coalesce:Od,collator:nm,format:im,image:rm,in:og,"index-of":Hf,interpolate:Dl,"interpolate-hcl":Dl,"interpolate-lab":Dl,length:ug,let:um,literal:Op,match:ag,number:mu,"number-format":lg,object:mu,slice:Wf,step:lm,string:mu,"to-boolean":hh,"to-color":hh,"to-number":hh,"to-string":hh,var:om,within:Kh};function A_(c,[a,l,x,T]){a=a.evaluate(c),l=l.evaluate(c),x=x.evaluate(c);const P=T?T.evaluate(c):1,f=fv(a,l,x,P);if(f)throw new Da(f);return new gn(a/255*P,l/255*P,x/255*P,P)}function C_(c,a){return c in a}function by(c,a){const l=a[c];return typeof l=="undefined"?null:l}function g2(c,a,l,x){for(;l<=x;){const T=l+x>>1;if(a[T]===c)return!0;a[T]>c?x=T-1:l=T+1}return!1}function qh(c){return{type:c}}yu.register(cg,{error:[Iw,[Lr],(c,[a])=>{throw new Da(a.evaluate(c))}],typeof:[Lr,[xr],(c,[a])=>ho(ca(a.evaluate(c)))],"to-rgba":[Ml(si,4),[zc],(c,[a])=>a.evaluate(c).toArray()],rgb:[zc,[si,si,si],A_],rgba:[zc,[si,si,si,si],A_],has:{type:vr,overloads:[[[Lr],(c,[a])=>C_(a.evaluate(c),c.properties())],[[Lr,Mp],(c,[a,l])=>C_(a.evaluate(c),l.evaluate(c))]]},get:{type:xr,overloads:[[[Lr],(c,[a])=>by(a.evaluate(c),c.properties())],[[Lr,Mp],(c,[a,l])=>by(a.evaluate(c),l.evaluate(c))]]},"feature-state":[xr,[Lr],(c,[a])=>by(a.evaluate(c),c.featureState||{})],properties:[Mp,[],c=>c.properties()],"geometry-type":[Lr,[],c=>c.geometryType()],id:[xr,[],c=>c.id()],zoom:[si,[],c=>c.globals.zoom],pitch:[si,[],c=>c.globals.pitch||0],"distance-from-center":[si,[],c=>c.distanceFromCenter()],"heatmap-density":[si,[],c=>c.globals.heatmapDensity||0],"line-progress":[si,[],c=>c.globals.lineProgress||0],"sky-radial-progress":[si,[],c=>c.globals.skyRadialProgress||0],accumulated:[xr,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[si,qh(si),(c,a)=>{let l=0;for(const x of a)l+=x.evaluate(c);return l}],"*":[si,qh(si),(c,a)=>{let l=1;for(const x of a)l*=x.evaluate(c);return l}],"-":{type:si,overloads:[[[si,si],(c,[a,l])=>a.evaluate(c)-l.evaluate(c)],[[si],(c,[a])=>-a.evaluate(c)]]},"/":[si,[si,si],(c,[a,l])=>a.evaluate(c)/l.evaluate(c)],"%":[si,[si,si],(c,[a,l])=>a.evaluate(c)%l.evaluate(c)],ln2:[si,[],()=>Math.LN2],pi:[si,[],()=>Math.PI],e:[si,[],()=>Math.E],"^":[si,[si,si],(c,[a,l])=>Math.pow(a.evaluate(c),l.evaluate(c))],sqrt:[si,[si],(c,[a])=>Math.sqrt(a.evaluate(c))],log10:[si,[si],(c,[a])=>Math.log(a.evaluate(c))/Math.LN10],ln:[si,[si],(c,[a])=>Math.log(a.evaluate(c))],log2:[si,[si],(c,[a])=>Math.log(a.evaluate(c))/Math.LN2],sin:[si,[si],(c,[a])=>Math.sin(a.evaluate(c))],cos:[si,[si],(c,[a])=>Math.cos(a.evaluate(c))],tan:[si,[si],(c,[a])=>Math.tan(a.evaluate(c))],asin:[si,[si],(c,[a])=>Math.asin(a.evaluate(c))],acos:[si,[si],(c,[a])=>Math.acos(a.evaluate(c))],atan:[si,[si],(c,[a])=>Math.atan(a.evaluate(c))],min:[si,qh(si),(c,a)=>Math.min(...a.map(l=>l.evaluate(c)))],max:[si,qh(si),(c,a)=>Math.max(...a.map(l=>l.evaluate(c)))],abs:[si,[si],(c,[a])=>Math.abs(a.evaluate(c))],round:[si,[si],(c,[a])=>{const l=a.evaluate(c);return l<0?-Math.round(-l):Math.round(l)}],floor:[si,[si],(c,[a])=>Math.floor(a.evaluate(c))],ceil:[si,[si],(c,[a])=>Math.ceil(a.evaluate(c))],"filter-==":[vr,[Lr,xr],(c,[a,l])=>c.properties()[a.value]===l.value],"filter-id-==":[vr,[xr],(c,[a])=>c.id()===a.value],"filter-type-==":[vr,[Lr],(c,[a])=>c.geometryType()===a.value],"filter-<":[vr,[Lr,xr],(c,[a,l])=>{const x=c.properties()[a.value],T=l.value;return typeof x==typeof T&&x<T}],"filter-id-<":[vr,[xr],(c,[a])=>{const l=c.id(),x=a.value;return typeof l==typeof x&&l<x}],"filter->":[vr,[Lr,xr],(c,[a,l])=>{const x=c.properties()[a.value],T=l.value;return typeof x==typeof T&&x>T}],"filter-id->":[vr,[xr],(c,[a])=>{const l=c.id(),x=a.value;return typeof l==typeof x&&l>x}],"filter-<=":[vr,[Lr,xr],(c,[a,l])=>{const x=c.properties()[a.value],T=l.value;return typeof x==typeof T&&x<=T}],"filter-id-<=":[vr,[xr],(c,[a])=>{const l=c.id(),x=a.value;return typeof l==typeof x&&l<=x}],"filter->=":[vr,[Lr,xr],(c,[a,l])=>{const x=c.properties()[a.value],T=l.value;return typeof x==typeof T&&x>=T}],"filter-id->=":[vr,[xr],(c,[a])=>{const l=c.id(),x=a.value;return typeof l==typeof x&&l>=x}],"filter-has":[vr,[xr],(c,[a])=>a.value in c.properties()],"filter-has-id":[vr,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[vr,[Ml(Lr)],(c,[a])=>a.value.indexOf(c.geometryType())>=0],"filter-id-in":[vr,[Ml(xr)],(c,[a])=>a.value.indexOf(c.id())>=0],"filter-in-small":[vr,[Lr,Ml(xr)],(c,[a,l])=>l.value.indexOf(c.properties()[a.value])>=0],"filter-in-large":[vr,[Lr,Ml(xr)],(c,[a,l])=>g2(c.properties()[a.value],l.value,0,l.value.length-1)],all:{type:vr,overloads:[[[vr,vr],(c,[a,l])=>a.evaluate(c)&&l.evaluate(c)],[qh(vr),(c,a)=>{for(const l of a)if(!l.evaluate(c))return!1;return!0}]]},any:{type:vr,overloads:[[[vr,vr],(c,[a,l])=>a.evaluate(c)||l.evaluate(c)],[qh(vr),(c,a)=>{for(const l of a)if(l.evaluate(c))return!0;return!1}]]},"!":[vr,[vr],(c,[a])=>!a.evaluate(c)],"is-supported-script":[vr,[Lr],(c,[a])=>{const l=c.globals&&c.globals.isSupportedScript;return l?l(a.evaluate(c)):!0}],upcase:[Lr,[Lr],(c,[a])=>a.evaluate(c).toUpperCase()],downcase:[Lr,[Lr],(c,[a])=>a.evaluate(c).toLowerCase()],concat:[Lr,qh(xr),(c,a)=>a.map(l=>Pd(l.evaluate(c))).join("")],"resolved-locale":[Lr,[em],(c,[a])=>a.evaluate(c).resolvedLocale()]});function Ny(c){return{result:"success",value:c}}function Pp(c){return{result:"error",value:c}}function _2(c){return c["property-type"]==="data-driven"||c["property-type"]==="cross-faded-data-driven"}function v2(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function zv(c){return!!c.expression&&c.expression.interpolated}function hg(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function pg(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function x2(c){return c}function dg(c,a){const l=a.type==="color",x=c.stops&&typeof c.stops[0][0]=="object",T=x||c.property!==void 0,P=x||!T,f=c.type||(zv(a)?"exponential":"interval");if(l&&(c=dv({},c),c.stops&&(c.stops=c.stops.map(V=>[V[0],gn.parse(V[1])])),c.default?c.default=gn.parse(c.default):c.default=gn.parse(a.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!Av[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let d,R,q;if(f==="exponential")d=k_;else if(f==="interval")d=w2;else if(f==="categorical"){d=b2,R=Object.create(null);for(const V of c.stops)R[V[0]]=V[1];q=typeof c.stops[0][0]}else if(f==="identity")d=E2;else throw new Error(`Unknown function type "${f}"`);if(x){const V={},G=[];for(let ke=0;ke<c.stops.length;ke++){const qe=c.stops[ke],We=qe[0].zoom;V[We]===void 0&&(V[We]={zoom:We,type:c.type,property:c.property,default:c.default,stops:[]},G.push(We)),V[We].stops.push([qe[0].value,qe[1]])}const X=[];for(const ke of G)X.push([V[ke].zoom,dg(V[ke],a)]);const Me={name:"linear"};return{kind:"composite",interpolationType:Me,interpolationFactor:Dl.interpolationFactor.bind(void 0,Me),zoomStops:X.map(ke=>ke[0]),evaluate({zoom:ke},qe){return k_({stops:X,base:c.base},a,ke).evaluate(ke,qe)}}}else if(P){const V=f==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:V,interpolationFactor:Dl.interpolationFactor.bind(void 0,V),zoomStops:c.stops.map(G=>G[0]),evaluate:({zoom:G})=>d(c,a,G,R,q)}}else return{kind:"source",evaluate(V,G){const X=G&&G.properties?G.properties[c.property]:void 0;return X===void 0?Vd(c.default,a.default):d(c,a,X,R,q)}}}function Vd(c,a,l){if(c!==void 0)return c;if(a!==void 0)return a;if(l!==void 0)return l}function b2(c,a,l,x,T){const P=typeof l===T?x[l]:void 0;return Vd(P,c.default,a.default)}function w2(c,a,l){if(hg(l)!=="number")return Vd(c.default,a.default);const x=c.stops.length;if(x===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[x-1][0])return c.stops[x-1][1];const T=sm(c.stops.map(P=>P[0]),l);return c.stops[T][1]}function k_(c,a,l){const x=c.base!==void 0?c.base:1;if(hg(l)!=="number")return Vd(c.default,a.default);const T=c.stops.length;if(T===1||l<=c.stops[0][0])return c.stops[0][1];if(l>=c.stops[T-1][0])return c.stops[T-1][1];const P=sm(c.stops.map(V=>V[0]),l),f=I2(l,x,c.stops[P][0],c.stops[P+1][0]),d=c.stops[P][1],R=c.stops[P+1][1];let q=vv[a.type]||x2;if(c.colorSpace&&c.colorSpace!=="rgb"){const V=Av[c.colorSpace];q=(G,X)=>V.reverse(V.interpolate(V.forward(G),V.forward(X),f))}return typeof d.evaluate=="function"?{evaluate(...V){const G=d.evaluate.apply(void 0,V),X=R.evaluate.apply(void 0,V);if(!(G===void 0||X===void 0))return q(G,X,f)}}:q(d,R,f)}function E2(c,a,l){return a.type==="color"?l=gn.parse(l):a.type==="formatted"?l=gu.fromString(l.toString()):a.type==="resolvedImage"?l=Pc.fromString(l.toString()):hg(l)!==a.type&&(a.type!=="enum"||!a.values[l])&&(l=void 0),Vd(l,c.default,a.default)}function I2(c,a,l,x){const T=x-l,P=c-l;return T===0?0:a===1?P/T:(Math.pow(a,P)-1)/(Math.pow(a,T)-1)}class Pv{constructor(a,l){this.expression=a,this._warningHistory={},this._evaluator=new mv,this._defaultValue=l?A2(l):null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(a,l,x,T,P,f,d,R){return this._evaluator.globals=a,this._evaluator.feature=l,this._evaluator.featureState=x,this._evaluator.canonical=T||null,this._evaluator.availableImages=P||null,this._evaluator.formattedSection=f,this._evaluator.featureTileCoord=d||null,this._evaluator.featureDistanceData=R||null,this.expression.evaluate(this._evaluator)}evaluate(a,l,x,T,P,f,d,R){this._evaluator.globals=a,this._evaluator.feature=l||null,this._evaluator.featureState=x||null,this._evaluator.canonical=T||null,this._evaluator.availableImages=P||null,this._evaluator.formattedSection=f||null,this._evaluator.featureTileCoord=d||null,this._evaluator.featureDistanceData=R||null;try{const q=this.expression.evaluate(this._evaluator);if(q==null||typeof q=="number"&&q!==q)return this._defaultValue;if(this._enumValues&&!(q in this._enumValues))throw new Da(`Expected value to be one of ${Object.keys(this._enumValues).map(V=>JSON.stringify(V)).join(", ")}, but found ${JSON.stringify(q)} instead.`);return q}catch(q){return this._warningHistory[q.message]||(this._warningHistory[q.message]=!0,typeof console!="undefined"&&console.warn(q.message)),this._defaultValue}}}function Mv(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in cg}function Lv(c,a){const l=new am(cg,[],a?T2(a):void 0),x=l.parse(c,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return x?Ny(new Pv(x,a)):Pp(l.errors)}class jy{constructor(a,l){this.kind=a,this._styleExpression=l,this.isStateDependent=a!=="constant"&&!ig(l.expression)}evaluateWithoutErrorHandling(a,l,x,T,P,f){return this._styleExpression.evaluateWithoutErrorHandling(a,l,x,T,P,f)}evaluate(a,l,x,T,P,f){return this._styleExpression.evaluate(a,l,x,T,P,f)}}class Vy{constructor(a,l,x,T){this.kind=a,this.zoomStops=x,this._styleExpression=l,this.isStateDependent=a!=="camera"&&!ig(l.expression),this.interpolationType=T}evaluateWithoutErrorHandling(a,l,x,T,P,f){return this._styleExpression.evaluateWithoutErrorHandling(a,l,x,T,P,f)}evaluate(a,l,x,T,P,f){return this._styleExpression.evaluate(a,l,x,T,P,f)}interpolationFactor(a,l,x){return this.interpolationType?Dl.interpolationFactor(this.interpolationType,a,l,x):0}}function Dv(c,a){if(c=Lv(c,a),c.result==="error")return c;const l=c.value.expression,x=tg(l);if(!x&&!_2(a))return Pp([new Ju("","data expressions not supported")]);const T=rg(l,["zoom","pitch","distance-from-center"]);if(!T&&!v2(a))return Pp([new Ju("","zoom expressions not supported")]);const P=Of(l);if(!P&&!T)return Pp([new Ju("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(P instanceof Ju)return Pp([P]);if(P instanceof Dl&&!zv(a))return Pp([new Ju("",'"interpolate" expressions cannot be used with this property')]);if(!P)return Ny(x?new jy("constant",c.value):new jy("source",c.value));const f=P instanceof Dl?P.interpolation:void 0;return Ny(x?new Vy("camera",c.value,P.labels,f):new Vy("composite",c.value,P.labels,f))}class cm{constructor(a,l){this._parameters=a,this._specification=l,dv(this,dg(this._parameters,this._specification))}static deserialize(a){return new cm(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function S2(c,a){if(pg(c))return new cm(c,a);if(Mv(c)){const l=Dv(c,a);if(l.result==="error")throw new Error(l.value.map(x=>`${x.key}: ${x.message}`).join(", "));return l.value}else{let l=c;return typeof c=="string"&&a.type==="color"&&(l=gn.parse(c)),{kind:"constant",evaluate:()=>l}}}function Of(c){let a=null;if(c instanceof um)a=Of(c.result);else if(c instanceof Od){for(const l of c.args)if(a=Of(l),a)break}else(c instanceof lm||c instanceof Dl)&&c.input instanceof yu&&c.input.name==="zoom"&&(a=c);return a instanceof Ju||c.eachChild(l=>{const x=Of(l);x instanceof Ju?a=x:!a&&x?a=new Ju("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&x&&a!==x&&(a=new Ju("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function T2(c){const a={color:zc,string:Lr,number:si,enum:Lr,boolean:vr,formatted:tm,resolvedImage:jd};return c.type==="array"?Ml(a[c.value]||xr,c.length):a[c.type]}function A2(c){return c.type==="color"&&pg(c.default)?new gn(0,0,0,0):c.type==="color"?gn.parse(c.default)||null:c.default===void 0?null:c.default}function Fd(c){return typeof c=="object"?["literal",c]:c}function C2(c,a){let l=c.stops;if(!l)return k2(c,a);const x=l&&typeof l[0][0]=="object",T=x||c.property!==void 0,P=x||!T;return l=l.map(f=>!T&&a.tokens&&typeof f[1]=="string"?[f[0],L2(f[1])]:[f[0],Fd(f[1])]),x?z2(c,a,l):P?M2(c,a,l):qy(c,a,l)}function k2(c,a){const l=["get",c.property];if(c.default===void 0)return a.type==="string"?["string",l]:l;if(a.type==="enum")return["match",l,Object.keys(a.values),l,c.default];{const x=[a.type==="color"?"to-color":a.type,l,Fd(c.default)];return a.type==="array"&&x.splice(1,0,a.value,a.length||null),x}}function fg(c){switch(c.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function z2(c,a,l){const x={},T={},P=[];for(let d=0;d<l.length;d++){const R=l[d],q=R[0].zoom;x[q]===void 0&&(x[q]={zoom:q,type:c.type,property:c.property,default:c.default},T[q]=[],P.push(q)),T[q].push([R[0].value,R[1]])}if(yg({},a)==="exponential"){const d=[fg(c),["linear"],["zoom"]];for(const R of P){const q=qy(x[R],a,T[R]);Dp(d,R,q,!1)}return d}else{const d=["step",["zoom"]];for(const R of P){const q=qy(x[R],a,T[R]);Dp(d,R,q,!0)}return mg(d),d}}function P2(c,a){if(c!==void 0)return c;if(a!==void 0)return a}function z_(c,a){const l=Fd(P2(c.default,a.default));return l===void 0&&a.type==="resolvedImage"?"":l}function qy(c,a,l){const x=yg(c,a),T=["get",c.property];if(x==="categorical"&&typeof l[0][0]=="boolean"){const P=["case"];for(const f of l)P.push(["==",T,f[0]],f[1]);return P.push(z_(c,a)),P}else if(x==="categorical"){const P=["match",T];for(const f of l)Dp(P,f[0],f[1],!1);return P.push(z_(c,a)),P}else if(x==="interval"){const P=["step",["number",T]];for(const f of l)Dp(P,f[0],f[1],!0);return mg(P),c.default===void 0?P:["case",["==",["typeof",T],"number"],P,Fd(c.default)]}else if(x==="exponential"){const P=c.base!==void 0?c.base:1,f=[fg(c),P===1?["linear"]:["exponential",P],["number",T]];for(const d of l)Dp(f,d[0],d[1],!1);return c.default===void 0?f:["case",["==",["typeof",T],"number"],f,Fd(c.default)]}else throw new Error(`Unknown property function type ${x}`)}function M2(c,a,l,x=["zoom"]){const T=yg(c,a);let P,f=!1;if(T==="interval")P=["step",x],f=!0;else if(T==="exponential"){const d=c.base!==void 0?c.base:1;P=[fg(c),d===1?["linear"]:["exponential",d],x]}else throw new Error(`Unknown zoom function type "${T}"`);for(const d of l)Dp(P,d[0],d[1],f);return mg(P),P}function mg(c){c[0]==="step"&&c.length===3&&(c.push(0),c.push(c[3]))}function Dp(c,a,l,x){c.length>3&&a===c[c.length-2]||(x&&c.length===2||c.push(a),c.push(l))}function yg(c,a){return c.type?c.type:a.expression.interpolated?"exponential":"interval"}function L2(c){const a=["concat"],l=/{([^{}]+)}/g;let x=0;for(let T=l.exec(c);T!==null;T=l.exec(c)){const P=c.slice(x,l.lastIndex-T[0].length);x=l.lastIndex,P.length>0&&a.push(P),a.push(["get",T[1]])}if(a.length===1)return c;if(x<c.length)a.push(c.slice(x));else if(a.length===2)return["to-string",a[1]];return a}function Rv(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const a of c.slice(1))if(!Rv(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}$f(function(c,a){var l=function(){var x=function(ft,Ge,Ze,gt){for(Ze=Ze||{},gt=ft.length;gt--;Ze[ft[gt]]=Ge);return Ze},T=[1,12],P=[1,13],f=[1,9],d=[1,10],R=[1,11],q=[1,14],V=[1,15],G=[14,18,22,24],X=[18,22],Me=[22,24],ke={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(Ge,Ze,gt,ct,pt,lt,pi){var Et=lt.length-1;switch(pt){case 1:this.$=new String(Ge.replace(/\\(\\|")/g,"$1").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b")),this.$.__line__=this._$.first_line;break;case 2:this.$=new Number(Ge),this.$.__line__=this._$.first_line;break;case 3:this.$=null;break;case 4:this.$=new Boolean(!0),this.$.__line__=this._$.first_line;break;case 5:this.$=new Boolean(!1),this.$.__line__=this._$.first_line;break;case 6:return this.$=lt[Et-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=lt[Et-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[lt[Et-2],lt[Et]];break;case 16:this.$={},this.$[lt[Et][0]]=lt[Et][1];break;case 17:this.$=lt[Et-2],lt[Et-2][lt[Et][0]]=lt[Et][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[lt[Et]];break;case 21:this.$=lt[Et-2],lt[Et-2].push(lt[Et]);break}},table:[{3:5,4:T,5:6,6:P,7:3,8:f,9:4,10:d,11:R,12:1,13:2,15:7,16:8,17:q,23:V},{1:[3]},{14:[1,16]},x(G,[2,7]),x(G,[2,8]),x(G,[2,9]),x(G,[2,10]),x(G,[2,11]),x(G,[2,12]),x(G,[2,3]),x(G,[2,4]),x(G,[2,5]),x([14,18,21,22,24],[2,1]),x(G,[2,2]),{3:20,4:T,18:[1,17],19:18,20:19},{3:5,4:T,5:6,6:P,7:3,8:f,9:4,10:d,11:R,13:23,15:7,16:8,17:q,23:V,24:[1,21],25:22},{1:[2,6]},x(G,[2,13]),{18:[1,24],22:[1,25]},x(X,[2,16]),{21:[1,26]},x(G,[2,18]),{22:[1,28],24:[1,27]},x(Me,[2,20]),x(G,[2,14]),{3:20,4:T,20:29},{3:5,4:T,5:6,6:P,7:3,8:f,9:4,10:d,11:R,13:30,15:7,16:8,17:q,23:V},x(G,[2,19]),{3:5,4:T,5:6,6:P,7:3,8:f,9:4,10:d,11:R,13:31,15:7,16:8,17:q,23:V},x(X,[2,17]),x(X,[2,15]),x(Me,[2,21])],defaultActions:{16:[2,6]},parseError:function(Ge,Ze){if(Ze.recoverable)this.trace(Ge);else throw new Error(Ge)},parse:function(Ge){var Ze=this,gt=[0],ct=[null],pt=[],lt=this.table,pi="",Et=0,Wt=0,vi=2,qi=1,Xt=pt.slice.call(arguments,1),Qt=Object.create(this.lexer),Ei={yy:{}};for(var bt in this.yy)Object.prototype.hasOwnProperty.call(this.yy,bt)&&(Ei.yy[bt]=this.yy[bt]);Qt.setInput(Ge,Ei.yy),Ei.yy.lexer=Qt,Ei.yy.parser=this,typeof Qt.yylloc=="undefined"&&(Qt.yylloc={});var Gi=Qt.yylloc;pt.push(Gi);var hr=Qt.options&&Qt.options.ranges;typeof Ei.yy.parseError=="function"?this.parseError=Ei.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function wr(){var zt;return zt=Qt.lex()||qi,typeof zt!="number"&&(zt=Ze.symbols_[zt]||zt),zt}for(var Dt,oi,fi,Bi,Nt={},Xi,Li,xi,rr;;){if(oi=gt[gt.length-1],this.defaultActions[oi]?fi=this.defaultActions[oi]:((Dt===null||typeof Dt=="undefined")&&(Dt=wr()),fi=lt[oi]&&lt[oi][Dt]),typeof fi=="undefined"||!fi.length||!fi[0]){var Ti="";rr=[];for(Xi in lt[oi])this.terminals_[Xi]&&Xi>vi&&rr.push("'"+this.terminals_[Xi]+"'");Qt.showPosition?Ti="Parse error on line "+(Et+1)+`:
`+Qt.showPosition()+`
Expecting `+rr.join(", ")+", got '"+(this.terminals_[Dt]||Dt)+"'":Ti="Parse error on line "+(Et+1)+": Unexpected "+(Dt==qi?"end of input":"'"+(this.terminals_[Dt]||Dt)+"'"),this.parseError(Ti,{text:Qt.match,token:this.terminals_[Dt]||Dt,line:Qt.yylineno,loc:Gi,expected:rr})}if(fi[0]instanceof Array&&fi.length>1)throw new Error("Parse Error: multiple actions possible at state: "+oi+", token: "+Dt);switch(fi[0]){case 1:gt.push(Dt),ct.push(Qt.yytext),pt.push(Qt.yylloc),gt.push(fi[1]),Dt=null,Wt=Qt.yyleng,pi=Qt.yytext,Et=Qt.yylineno,Gi=Qt.yylloc;break;case 2:if(Li=this.productions_[fi[1]][1],Nt.$=ct[ct.length-Li],Nt._$={first_line:pt[pt.length-(Li||1)].first_line,last_line:pt[pt.length-1].last_line,first_column:pt[pt.length-(Li||1)].first_column,last_column:pt[pt.length-1].last_column},hr&&(Nt._$.range=[pt[pt.length-(Li||1)].range[0],pt[pt.length-1].range[1]]),Bi=this.performAction.apply(Nt,[pi,Wt,Et,Ei.yy,fi[1],ct,pt].concat(Xt)),typeof Bi!="undefined")return Bi;Li&&(gt=gt.slice(0,-1*Li*2),ct=ct.slice(0,-1*Li),pt=pt.slice(0,-1*Li)),gt.push(this.productions_[fi[1]][0]),ct.push(Nt.$),pt.push(Nt._$),xi=lt[gt[gt.length-2]][gt[gt.length-1]],gt.push(xi);break;case 3:return!0}}return!0}},qe=function(){var ft={EOF:1,parseError:function(Ze,gt){if(this.yy.parser)this.yy.parser.parseError(Ze,gt);else throw new Error(Ze)},setInput:function(Ge,Ze){return this.yy=Ze||this.yy||{},this._input=Ge,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var Ge=this._input[0];this.yytext+=Ge,this.yyleng++,this.offset++,this.match+=Ge,this.matched+=Ge;var Ze=Ge.match(/(?:\r\n?|\n).*/g);return Ze?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),Ge},unput:function(Ge){var Ze=Ge.length,gt=Ge.split(/(?:\r\n?|\n)/g);this._input=Ge+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Ze),this.offset-=Ze;var ct=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),gt.length-1&&(this.yylineno-=gt.length-1);var pt=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:gt?(gt.length===ct.length?this.yylloc.first_column:0)+ct[ct.length-gt.length].length-gt[0].length:this.yylloc.first_column-Ze},this.options.ranges&&(this.yylloc.range=[pt[0],pt[0]+this.yyleng-Ze]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(Ge){this.unput(this.match.slice(Ge))},pastInput:function(){var Ge=this.matched.substr(0,this.matched.length-this.match.length);return(Ge.length>20?"...":"")+Ge.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var Ge=this.match;return Ge.length<20&&(Ge+=this._input.substr(0,20-Ge.length)),(Ge.substr(0,20)+(Ge.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var Ge=this.pastInput(),Ze=new Array(Ge.length+1).join("-");return Ge+this.upcomingInput()+`
`+Ze+"^"},test_match:function(Ge,Ze){var gt,ct,pt;if(this.options.backtrack_lexer&&(pt={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(pt.yylloc.range=this.yylloc.range.slice(0))),ct=Ge[0].match(/(?:\r\n?|\n).*/g),ct&&(this.yylineno+=ct.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:ct?ct[ct.length-1].length-ct[ct.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+Ge[0].length},this.yytext+=Ge[0],this.match+=Ge[0],this.matches=Ge,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(Ge[0].length),this.matched+=Ge[0],gt=this.performAction.call(this,this.yy,this,Ze,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),gt)return gt;if(this._backtrack){for(var lt in pt)this[lt]=pt[lt];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var Ge,Ze,gt,ct;this._more||(this.yytext="",this.match="");for(var pt=this._currentRules(),lt=0;lt<pt.length;lt++)if(gt=this._input.match(this.rules[pt[lt]]),gt&&(!Ze||gt[0].length>Ze[0].length)){if(Ze=gt,ct=lt,this.options.backtrack_lexer){if(Ge=this.test_match(gt,pt[lt]),Ge!==!1)return Ge;if(this._backtrack){Ze=!1;continue}else return!1}else if(!this.options.flex)break}return Ze?(Ge=this.test_match(Ze,pt[ct]),Ge!==!1?Ge:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var Ze=this.next();return Ze||this.lex()},begin:function(Ze){this.conditionStack.push(Ze)},popState:function(){var Ze=this.conditionStack.length-1;return Ze>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(Ze){return Ze=this.conditionStack.length-1-Math.abs(Ze||0),Ze>=0?this.conditionStack[Ze]:"INITIAL"},pushState:function(Ze){this.begin(Ze)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(Ze,gt,ct,pt){switch(ct){case 0:break;case 1:return 6;case 2:return gt.yytext=gt.yytext.substr(1,gt.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return ft}();ke.lexer=qe;function We(){this.yy={}}return We.prototype=ke,ke.Parser=We,new We}();typeof xw!="undefined"&&(a.parser=l,a.Parser=l.Parser,a.parse=function(){return l.parse.apply(l,arguments)})});const D2={StyleExpression:Pv,isExpression:Mv,isExpressionFilter:Rv,createExpression:Lv,createPropertyExpression:Dv,normalizePropertyExpression:S2,ZoomConstantExpression:jy,ZoomDependentExpression:Vy,StylePropertyFunction:cm},R2={convertFunction:C2,createFunction:dg,isFunction:pg};function B2(c){var a=c.expr,l=c.layer,x=Math.min(a(l,"paint","circle-radius"),8),T=Math.min(a(l,"paint","circle-stroke-width"),4),P=a(l,"paint","circle-color"),f=a(l,"paint","circle-opacity"),d=a(l,"paint","circle-stroke-color"),R=a(l,"paint","circle-stroke-opacity"),q=x-T/2;return{element:"svg",attributes:{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",style:{filter:"blur("+a(l,"paint","circle-blur")*q+"px)"}},children:[{element:"circle",attributes:{key:"l1",cx:10,cy:10,fill:P,opacity:f,r:q}},{element:"circle",attributes:{key:"l2",cx:10,cy:10,fill:"transparent",opacity:R,r:x,"stroke-width":T,stroke:d}}]}}function O2(c){var a=c.expr,l=c.layer;return{element:"div",attributes:{style:{width:"100%",height:"100%",backgroundImage:"url("+(0,c.image)(a(l,"paint","fill-pattern"))+")",backgroundColor:a(l,"paint","fill-color"),opacity:a(l,"paint","fill-opacity"),backgroundSize:"66% 66%",backgroundPosition:"center"}}}}function F2(c){var a=c.layer,l=c.expr,x=(0,c.image)(l(a,"paint","line-pattern")),T={stroke:x?"url(#img1)":l(a,"paint","line-color"),strokeWidth:Math.max(2,Math.min(l(a,"paint","line-width"),8)),strokeOpacity:l(a,"paint","line-opacity")},P=T.strokeWidth;return{element:"svg",attributes:{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},children:[{element:"defs",attributes:{key:"defs"},children:[{element:"pattern",attributes:{key:"pattern",id:"img1",x:0,y:0,width:T.strokeWidth,height:T.strokeWidth,patternUnits:"userSpaceOnUse",patternTransform:"translate("+-P/2+" "+-P/2+") rotate(45)"},children:[{element:"image",attributes:{key:"img",xlinkHref:x,x:0,y:0,width:T.strokeWidth,height:T.strokeWidth}}]}]},{element:"path",attributes:{key:"path",style:T,stroke:T.stroke,d:"M0 20 L 20 0"}}]}}function U2(c){return function(d){var R=d.image,q=(0,d.expr)(d.layer,"layout","icon-image");if(!q)return null;var V=R(q);return V?{element:"div",attributes:{style:{backgroundImage:"url("+V+")",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",width:"100%",height:"100%"}}}:null}(c)||(T=(l=(a=c).expr)(x=a.layer,"paint","text-color"),P=l(x,"paint","text-opacity"),{element:"svg",attributes:{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},children:[{element:"path",attributes:{key:"l1",d:f="M 4,4 L 16,4 L 16,7 L 11.5 7 L 11.5 16 L 8.5 16 L 8.5 7 L 4 7 Z",stroke:l(x,"paint","text-halo-color"),"stroke-width":2*l(x,"paint","text-halo-width"),fill:"transparent","stroke-linejoin":"round"}},{element:"path",attributes:{key:"l2",d:f,fill:"white"}},{element:"path",attributes:{key:"l3",d:f,fill:T,opacity:P}}]});var a,l,x,T,P,f}var N2=[["background"],["circle"],["fill-extrusion"],["fill"],["heatmap"],["hillshade"],["line"],["raster"],["icon","symbol"],["text","symbol"]];function Bv(c){var a,l=c.sprite,x=c.layer,T={circle:B2,symbol:U2,line:F2,fill:O2}[x.type],P=(a=c.zoom,function(f,d,R){var q=function(ke){var qe=N2.find(function(We){return ke.startsWith(We[0])});return qe?qe[1]||qe[0]:null}(R),V=vw[d+"_"+q][R];if(!f[d])return V.default;var G=f[d][R];if(G===void 0)return V.default;if(typeof G=="object"){var X;if(!(X=Array.isArray(G)?D2.createExpression(G).value:R2.createFunction(G,V)).evaluate)return null;var Me=X.evaluate({zoom:a},{});return Me?Me.name||Me:null}return G});return T?T({layer:x,expr:P,image:function(f){if(l&&l.json){var d=l.json[f];if(d)return R=l.image,V=(q=d).x,G=q.y,X=q.width,Me=q.height,(ke=document.createElement("canvas")).width=2*X,ke.height=2*Me,ke.getContext("2d").drawImage(R,2*V,2*G,2*X,2*Me,0,0,2*X,2*Me),ke.toDataURL()}var R,q,V,G,X,Me,ke;return null}}):null}var yA=Object.freeze(Object.defineProperty({__proto__:null,default:Bv},Symbol.toStringTag,{value:"Module"}));function j2(c){let a,l=c[0].innerHTML+"";return{c(){a=Tr("div"),this.h()},l(x){a=Ar(x,"DIV",{class:!0});var T=Zr(a);T.forEach(Zt),this.h()},h(){Ur(a,"class","legend svelte-xshoo9")},m(x,T){Fi(x,a,T),a.innerHTML=l},p(x,[T]){T&1&&l!==(l=x[0].innerHTML+"")&&(a.innerHTML=l)},i:cl,o:cl,d(x){x&&Zt(a)}}}function V2(c,a,l){let x,T;jf(c,pv,R=>l(2,x=R)),jf(c,Yf,R=>l(3,T=R));let{layer:P}=a,f=document.createElement("div");const d=()=>{const R=T.getZoom(),q=Bv({zoom:R,sprite:x,layer:P});if(l(0,f.innerText="",f),q){let G,X;switch(q.element){case"div":if(q.attributes.style.backgroundImage&&!["url(undefined)","url(null)"].includes(q.attributes.style.backgroundImage)){var V=document.createElement("img");V.src=q.attributes.style.backgroundImage.replace("url(","").replace(")",""),V.alt=P.id,V.style.cssText="height: 24px;",f.appendChild(V)}G=document.createElement("div"),G.style.height="24px",G.style.width="50px",G.style.backgroundColor=q.attributes.style.backgroundColor,G.style.backgroundPosition=q.attributes.style.backgroundPosition,G.style.backgroundSize=q.attributes.style.backgroundSize,G.style.backgroundRepeat=q.attributes.style.backgroundRepeat,G.style.opacity=q.attributes.style.opacity,f.appendChild(G);break;case"svg":X=document.createElementNS("http://www.w3.org/2000/svg","svg"),X.style.cssText="height: 24px;",X.setAttributeNS(null,"version","1.1"),Object.keys(q.attributes).forEach(Me=>{X.setAttribute(Me,q.attributes[Me]);let ke=document.createElementNS("http://www.w3.org/2000/svg","g");q.children.forEach(qe=>{var We=document.createElementNS("http://www.w3.org/2000/svg",qe.element);Object.keys(qe.attributes).forEach(ft=>{We.setAttributeNS(null,ft,qe.attributes[ft])}),ke.appendChild(We)}),X.appendChild(ke)}),f.appendChild(X);break;default:console.log(q.element);return}}else{const G=document.createElementNS("http://www.w3.org/2000/svg","svg"),X=document.createElementNS("http://www.w3.org/2000/svg","path"),Me=document.createElementNS("http://www.w3.org/2000/svg","path");G.setAttribute("fill","none"),G.setAttribute("viewBox","0 0 24 24"),G.setAttribute("stroke","black"),G.classList.add("post-icon"),X.setAttribute("d","M21,0H3A3,3,0,0,0,0,3V21a3,3,0,0,0,3,3H21a3,3,0,0,0,3-3V3A3,3,0,0,0,21,0ZM3,2H21a1,1,0,0,1,1,1V15.86L14.18,9.35a5.06,5.06,0,0,0-6.39-.06L2,13.92V3A1,1,0,0,1,3,2ZM21,22H3a1,1,0,0,1-1-1V16.48l7-5.63a3.06,3.06,0,0,1,3.86,0L22,18.47V21A1,1,0,0,1,21,22Z"),X.setAttribute("stroke-linecap","round"),X.setAttribute("stroke-linejoin","round"),X.setAttribute("stroke-width","2"),Me.setAttribute("d","M18,9a3,3,0,1,0-3-3A3,3,0,0,0,18,9Zm0-4a1,1,0,1,1-1,1A1,1,0,0,1,18,5Z"),Me.setAttribute("stroke-linecap","round"),Me.setAttribute("stroke-linejoin","round"),Me.setAttribute("stroke-width","2"),G.appendChild(X),G.appendChild(Me),f.appendChild(G)}};return c.$$set=R=>{"layer"in R&&l(1,P=R.layer)},c.$$.update=()=>{c.$$.dirty&2&&d()},[f,P]}class q2 extends Rn{constructor(a){super(),Bn(this,a,V2,j2,On,{layer:1})}}function G2(c){let a,l,x,T,P;function f(R){c[2](R)}let d={touch:!0};return c[1]!==void 0&&(d.checked=c[1]),a=new cv({props:d}),_n.push(()=>Md(a,"checked",f)),T=new q2({props:{layer:c[0]}}),{c(){en(a.$$.fragment),x=pa(),en(T.$$.fragment)},l(R){In(a.$$.fragment,R),x=da(R),In(T.$$.fragment,R)},m(R,q){tn(a,R,q),Fi(R,x,q),tn(T,R,q),P=!0},p(R,q){const V={};!l&&q&2&&(l=!0,V.checked=R[1],Ld(()=>l=!1)),a.$set(V);const G={};q&1&&(G.layer=R[0]),T.$set(G)},i(R){P||(Mi(a.$$.fragment,R),Mi(T.$$.fragment,R),P=!0)},o(R){Ui(a.$$.fragment,R),Ui(T.$$.fragment,R),P=!1},d(R){rn(a,R),R&&Zt(x),rn(T,R)}}}function Z2(c){let a,l=c[0].id+"",x;return{c(){a=Tr("span"),x=Np(l),this.h()},l(T){a=Ar(T,"SPAN",{slot:!0});var P=Zr(a);x=jp(P,l),P.forEach(Zt),this.h()},h(){Ur(a,"slot","label")},m(T,P){Fi(T,a,P),wa(a,x)},p(T,P){P&1&&l!==(l=T[0].id+"")&&ev(x,l)},d(T){T&&Zt(a)}}}function H2(c){let a,l,x;return l=new hv({props:{$$slots:{label:[Z2],default:[G2]},$$scope:{ctx:c}}}),{c(){a=Tr("div"),en(l.$$.fragment)},l(T){a=Ar(T,"DIV",{});var P=Zr(a);In(l.$$.fragment,P),P.forEach(Zt)},m(T,P){Fi(T,a,P),tn(l,a,null),x=!0},p(T,[P]){const f={};P&67&&(f.$$scope={dirty:P,ctx:T}),l.$set(f)},i(T){x||(Mi(l.$$.fragment,T),x=!0)},o(T){Ui(l.$$.fragment,T),x=!1},d(T){T&&Zt(a),rn(l)}}}function W2(c,a,l){let x;jf(c,Yf,q=>l(4,x=q));let{layer:T}=a,P="visible";T.layout&&T.layout.visibility==="none"&&(P="none");let f=P==="visible";const d=()=>{x.setLayoutProperty(T.id,"visibility",f===!0?"visible":"none")};function R(q){f=q,l(1,f)}return c.$$set=q=>{"layer"in q&&l(0,T=q.layer)},c.$$.update=()=>{c.$$.dirty&2&&d()},[T,f,R]}class X2 extends Rn{constructor(a){super(),Bn(this,a,W2,H2,On,{layer:0})}}function P_(c,a,l){const x=c.slice();return x[11]=a[l],x}function K2(c){let a,l,x;function T(f){c[7](f)}let P={touch:!0};return c[1]!==void 0&&(P.checked=c[1]),a=new cv({props:P}),_n.push(()=>Md(a,"checked",T)),{c(){en(a.$$.fragment)},l(f){In(a.$$.fragment,f)},m(f,d){tn(a,f,d),x=!0},p(f,d){const R={};!l&&d&2&&(l=!0,R.checked=f[1],Ld(()=>l=!1)),a.$set(R)},i(f){x||(Mi(a.$$.fragment,f),x=!0)},o(f){Ui(a.$$.fragment,f),x=!1},d(f){rn(a,f)}}}function J2(c){let a,l;return{c(){a=Tr("span"),l=Np("Only rendered"),this.h()},l(x){a=Ar(x,"SPAN",{slot:!0});var T=Zr(a);l=jp(T,"Only rendered"),T.forEach(Zt),this.h()},h(){Ur(a,"slot","label")},m(x,T){Fi(x,a,T),wa(a,l)},p:cl,d(x){x&&Zt(a)}}}function Y2(c){let a,l;return a=new hv({props:{$$slots:{label:[J2],default:[K2]},$$scope:{ctx:c}}}),{c(){en(a.$$.fragment)},l(x){In(a.$$.fragment,x)},m(x,T){tn(a,x,T),l=!0},p(x,T){const P={};T&514&&(P.$$scope={dirty:T,ctx:x}),a.$set(P)},i(x){l||(Mi(a.$$.fragment,x),l=!0)},o(x){Ui(a.$$.fragment,x),l=!1},d(x){rn(a,x)}}}function M_(c){let a,l;return a=new fb({props:{$$slots:{default:[$2]},$$scope:{ctx:c}}}),{c(){en(a.$$.fragment)},l(x){In(a.$$.fragment,x)},m(x,T){tn(a,x,T),l=!0},p(x,T){const P={};T&516&&(P.$$scope={dirty:T,ctx:x}),a.$set(P)},i(x){l||(Mi(a.$$.fragment,x),l=!0)},o(x){Ui(a.$$.fragment,x),l=!1},d(x){rn(a,x)}}}function $2(c){let a,l,x;return a=new X2({props:{layer:c[11]}}),{c(){en(a.$$.fragment),l=pa()},l(T){In(a.$$.fragment,T),l=da(T)},m(T,P){tn(a,T,P),Fi(T,l,P),x=!0},p(T,P){const f={};P&4&&(f.layer=T[11]),a.$set(f)},i(T){x||(Mi(a.$$.fragment,T),x=!0)},o(T){Ui(a.$$.fragment,T),x=!1},d(T){rn(a,T),T&&Zt(l)}}}function L_(c){let a,l,x=(c[1]===!1||c[1]===!0&&c[3][c[11].id])&&M_(c);return{c(){x&&x.c(),a=Qo()},l(T){x&&x.l(T),a=Qo()},m(T,P){x&&x.m(T,P),Fi(T,a,P),l=!0},p(T,P){T[1]===!1||T[1]===!0&&T[3][T[11].id]?x?(x.p(T,P),P&14&&Mi(x,1)):(x=M_(T),x.c(),Mi(x,1),x.m(a.parentNode,a)):x&&($h(),Ui(x,1,1,()=>{x=null}),Yh())},i(T){l||(Mi(x),l=!0)},o(T){Ui(x),l=!1},d(T){x&&x.d(T),T&&Zt(a)}}}function Q2(c){let a,l,x=c[2],T=[];for(let f=0;f<x.length;f+=1)T[f]=L_(P_(c,x,f));const P=f=>Ui(T[f],1,1,()=>{T[f]=null});return{c(){for(let f=0;f<T.length;f+=1)T[f].c();a=Qo()},l(f){for(let d=0;d<T.length;d+=1)T[d].l(f);a=Qo()},m(f,d){for(let R=0;R<T.length;R+=1)T[R].m(f,d);Fi(f,a,d),l=!0},p(f,d){if(d&14){x=f[2];let R;for(R=0;R<x.length;R+=1){const q=P_(f,x,R);T[R]?(T[R].p(q,d),Mi(T[R],1)):(T[R]=L_(q),T[R].c(),Mi(T[R],1),T[R].m(a.parentNode,a))}for($h(),R=x.length;R<T.length;R+=1)P(R);Yh()}},i(f){if(!l){for(let d=0;d<x.length;d+=1)Mi(T[d]);l=!0}},o(f){T=T.filter(Boolean);for(let d=0;d<T.length;d+=1)Ui(T[d]);l=!1},d(f){nx(T,f),f&&Zt(a)}}}function eE(c){let a,l;return a=new lb({props:{$$slots:{default:[Q2]},$$scope:{ctx:c}}}),{c(){en(a.$$.fragment)},l(x){In(a.$$.fragment,x)},m(x,T){tn(a,x,T),l=!0},p(x,T){const P={};T&526&&(P.$$scope={dirty:T,ctx:x}),a.$set(P)},i(x){l||(Mi(a.$$.fragment,x),l=!0)},o(x){Ui(a.$$.fragment,x),l=!1},d(x){rn(a,x)}}}function tE(c){let a,l,x,T,P;return l=new nb({props:{$$slots:{default:[Y2]},$$scope:{ctx:c}}}),T=new rb({props:{$$slots:{default:[eE]},$$scope:{ctx:c}}}),{c(){a=Tr("div"),en(l.$$.fragment),x=pa(),en(T.$$.fragment),this.h()},l(f){a=Ar(f,"DIV",{class:!0});var d=Zr(a);In(l.$$.fragment,d),x=da(d),In(T.$$.fragment,d),d.forEach(Zt),this.h()},h(){Ur(a,"class","drawer-content svelte-17kx22f")},m(f,d){Fi(f,a,d),tn(l,a,null),wa(a,x),tn(T,a,null),P=!0},p(f,d){const R={};d&514&&(R.$$scope={dirty:d,ctx:f}),l.$set(R);const q={};d&526&&(q.$$scope={dirty:d,ctx:f}),T.$set(q)},i(f){P||(Mi(l.$$.fragment,f),Mi(T.$$.fragment,f),P=!0)},o(f){Ui(l.$$.fragment,f),Ui(T.$$.fragment,f),P=!1},d(f){f&&Zt(a),rn(l),rn(T)}}}function iE(c){let a,l;const x=c[6].default,T=Co(x,c,c[9],null);return{c(){a=Tr("main"),T&&T.c(),this.h()},l(P){a=Ar(P,"MAIN",{class:!0});var f=Zr(a);T&&T.l(f),f.forEach(Zt),this.h()},h(){Ur(a,"class","main-content svelte-17kx22f")},m(P,f){Fi(P,a,f),T&&T.m(a,null),l=!0},p(P,f){T&&T.p&&(!l||f&512)&&ko(T,x,P,P[9],l?Po(x,P[9],f,null):zo(P[9]),null)},i(P){l||(Mi(T,P),l=!0)},o(P){Ui(T,P),l=!1},d(P){P&&Zt(a),T&&T.d(P)}}}function rE(c){let a,l,x,T,P,f;function d(q){c[8](q)}let R={variant:"dismissible",$$slots:{default:[tE]},$$scope:{ctx:c}};return c[0]!==void 0&&(R.open=c[0]),l=new tb({props:R}),_n.push(()=>Md(l,"open",d)),P=new ib({props:{class:"app-content",$$slots:{default:[iE]},$$scope:{ctx:c}}}),{c(){a=Tr("div"),en(l.$$.fragment),T=pa(),en(P.$$.fragment),this.h()},l(q){a=Ar(q,"DIV",{class:!0});var V=Zr(a);In(l.$$.fragment,V),T=da(V),In(P.$$.fragment,V),V.forEach(Zt),this.h()},h(){Ur(a,"class","drawer-container svelte-17kx22f")},m(q,V){Fi(q,a,V),tn(l,a,null),wa(a,T),tn(P,a,null),f=!0},p(q,[V]){const G={};V&526&&(G.$$scope={dirty:V,ctx:q}),!x&&V&1&&(x=!0,G.open=q[0],Ld(()=>x=!1)),l.$set(G);const X={};V&512&&(X.$$scope={dirty:V,ctx:q}),P.$set(X)},i(q){f||(Mi(l.$$.fragment,q),Mi(P.$$.fragment,q),f=!0)},o(q){Ui(l.$$.fragment,q),Ui(P.$$.fragment,q),f=!1},d(q){q&&Zt(a),rn(l),rn(P)}}}function nE(c,a,l){let x;jf(c,Yf,ke=>l(5,x=ke));let{$$slots:T={},$$scope:P}=a,{open:f=!1}=a,d,R=!0,q=[],V={};const G=()=>{if(l(3,V={}),x&&x.queryRenderedFeatures){const ke=x.queryRenderedFeatures();for(let qe of ke)l(3,V[qe.layer.id]=qe.layer,V)}};function X(ke){R=ke,l(1,R)}function Me(ke){f=ke,l(0,f)}return c.$$set=ke=>{"open"in ke&&l(0,f=ke.open),"$$scope"in ke&&l(9,P=ke.$$scope)},c.$$.update=()=>{c.$$.dirty&48&&x&&(l(4,d=x.getStyle()),l(2,q=d.layers),x.on("load",G),x.on("moveend",G))},[f,R,q,V,d,x,T,X,Me,P]}class oE extends Rn{constructor(a){super(),Bn(this,a,nE,rE,On,{open:0})}}var Ll=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function gA(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}function aE(c){if(c.__esModule)return c;var a=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(c).forEach(function(l){var x=Object.getOwnPropertyDescriptor(c,l);Object.defineProperty(a,l,x.get?x:{enumerable:!0,get:function(){return c[l]}})}),a}var Wh={exports:{}};(function(c,a){(function(l,x){c.exports=x()})(Ll,function(){var l,x,T;function P(d,R){if(!l)l=R;else if(!x)x=R;else{var q="var sharedChunk = {}; ("+l+")(sharedChunk); ("+x+")(sharedChunk);",V={};l(V),T=R(V),typeof window!="undefined"&&(T.workerUrl=window.URL.createObjectURL(new Blob([q],{type:"text/javascript"})))}}P(["exports"],function(d){var R=q;function q(i,t,o,h){this.cx=3*i,this.bx=3*(o-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(h-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=t,this.p2x=o,this.p2y=h}function V(i,t,o,h){const g=new R(i,t,o,h);return function(b){return g.solve(b)}}q.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,t){if(t===void 0&&(t=1e-6),i<0)return 0;if(i>1)return 1;for(var o=i,h=0;h<8;h++){var g=this.sampleCurveX(o)-i;if(Math.abs(g)<t)return o;var b=this.sampleCurveDerivativeX(o);if(Math.abs(b)<1e-6)break;o-=g/b}var E=0,z=1;for(o=i,h=0;h<20&&(g=this.sampleCurveX(o),!(Math.abs(g-i)<t));h++)i>g?E=o:z=o,o=.5*(z-E)+E;return o},solve:function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))}};const G=V(.25,.1,.25,1);function X(i,t,o){return Math.min(o,Math.max(t,i))}function Me(i,t,o){const h=o-t,g=((i-t)%h+h)%h+t;return g===t?o:g}function ke(i,...t){for(const o of t)for(const h in o)i[h]=o[h];return i}let qe=1;function We(i,t){i.forEach(o=>{t[o]&&(t[o]=t[o].bind(t))})}function ft(i,t,o){const h={};for(const g in i)h[g]=t.call(o||this,i[g],g,i);return h}function Ge(i,t,o){const h={};for(const g in i)t.call(o||this,i[g],g,i)&&(h[g]=i[g]);return h}function Ze(i){return Array.isArray(i)?i.map(Ze):typeof i=="object"&&i?ft(i,Ze):i}const gt={};function ct(i){gt[i]||(typeof console!="undefined"&&console.warn(i),gt[i]=!0)}function pt(i,t,o){return(o.y-i.y)*(t.x-i.x)>(t.y-i.y)*(o.x-i.x)}function lt(i){let t=0;for(let o,h,g=0,b=i.length,E=b-1;g<b;E=g++)o=i[g],h=i[E],t+=(h.x-o.x)*(o.y+h.y);return t}function pi(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Et(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,h,g,b)=>{const E=g||b;return t[h]=!E||E.toLowerCase(),""}),t["max-age"]){const o=parseInt(t["max-age"],10);isNaN(o)?delete t["max-age"]:t["max-age"]=o}return t}let Wt,vi,qi=null;function Xt(i){if(qi==null){const t=i.navigator?i.navigator.userAgent:null;qi=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return qi}function Qt(i){return typeof ImageBitmap!="undefined"&&i instanceof ImageBitmap}const Ei={now:typeof performance!="undefined"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(i){const t=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(i,t=0){const o=window.document.createElement("canvas"),h=o.getContext("2d");if(!h)throw new Error("failed to create canvas 2d context");return o.width=i.width,o.height=i.height,h.drawImage(i,0,0,i.width,i.height),h.getImageData(-t,-t,i.width+2*t,i.height+2*t)},resolveURL:i=>(Wt||(Wt=document.createElement("a")),Wt.href=i,Wt.href),hardwareConcurrency:typeof navigator!="undefined"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(vi==null&&(vi=matchMedia("(prefers-reduced-motion: reduce)")),vi.matches)}};var bt=Gi;function Gi(i,t){this.x=i,this.y=t}Gi.prototype={clone:function(){return new Gi(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,t){return this.clone()._rotateAround(i,t)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var t=i.x-this.x,o=i.y-this.y;return t*t+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult:function(i){var t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var t=Math.cos(i),o=Math.sin(i),h=o*this.x+t*this.y;return this.x=t*this.x-o*this.y,this.y=h,this},_rotateAround:function(i,t){var o=Math.cos(i),h=Math.sin(i),g=t.y+h*(this.x-t.x)+o*(this.y-t.y);return this.x=t.x+o*(this.x-t.x)-h*(this.y-t.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Gi.convert=function(i){return i instanceof Gi?i:Array.isArray(i)?new Gi(i[0],i[1]):i};const hr={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},wr="mapbox-tiles";let Dt,oi,fi=500,Bi=50;function Nt(){typeof caches=="undefined"||Dt||(Dt=caches.open(wr))}let Xi=1/0;const Li={supported:!1,testSupport:function(i){!Ti&&rr&&(zt?tr(i):xi=i)}};let xi,rr,Ti=!1,zt=!1;function tr(i){const t=i.createTexture();i.bindTexture(i.TEXTURE_2D,t);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,rr),i.isContextLost())return;Li.supported=!0}catch{}i.deleteTexture(t),Ti=!0}typeof document!="undefined"&&(rr=document.createElement("img"),rr.onload=function(){xi&&tr(xi),xi=null,zt=!0},rr.onerror=function(){Ti=!0,xi=null},rr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Rt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Rt);class rt extends Error{constructor(t,o,h,g){super(`AJAXError: ${o} (${t}): ${h}`),this.status=t,this.statusText=o,this.url=h,this.body=g}}const yi=pi()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function ir(i,t){const o=new AbortController,h=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,referrer:yi(),signal:o.signal});let g=!1,b=!1;return i.type==="json"&&h.headers.set("Accept","application/json"),((E,z,D)=>{if(b)return;const O=Date.now();fetch(h).then(N=>N.ok?((U,K,$)=>{(i.type==="arrayBuffer"?U.arrayBuffer():i.type==="json"?U.json():U.text()).then(Q=>{b||(K&&$&&function(se,pe,Ae){if(Nt(),!Dt)return;const Be={status:pe.status,statusText:pe.statusText,headers:new Headers};pe.headers.forEach((Ve,it)=>Be.headers.set(it,Ve));const je=Et(pe.headers.get("Cache-Control")||"");je["no-store"]||(je["max-age"]&&Be.headers.set("Expires",new Date(Ae+1e3*je["max-age"]).toUTCString()),new Date(Be.headers.get("Expires")).getTime()-Ae<42e4||function(Ve,it){if(oi===void 0)try{new Response(new ReadableStream),oi=!0}catch{oi=!1}oi?it(Ve.body):Ve.blob().then(it)}(pe,Ve=>{const it=new Response(Ve,Be);Nt(),Dt&&Dt.then(He=>He.put(function(Ct){const Tt=Ct.indexOf("?");return Tt<0?Ct:Ct.slice(0,Tt)}(se.url),it)).catch(He=>ct(He.message))}))}(h,K,$),g=!0,t(null,Q,U.headers.get("Cache-Control"),U.headers.get("Expires")))}).catch(Q=>{b||t(new Error(Q.message))})})(N,null,O):N.blob().then(U=>t(new rt(N.status,N.statusText,i.url,U)))).catch(N=>{N.code!==20&&t(new Error(N.message))})})(),{cancel:()=>{b=!0,g||o.abort()}}}const Cr=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){if(pi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t);if(!pi()){const h=i.url.substring(0,i.url.indexOf("://"));return(hr.REGISTERED_PROTOCOLS[h]||ir)(i,t)}}if(!(/^file:/.test(o=i.url)||/^file:/.test(yi())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return ir(i,t);if(pi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t,void 0,!0)}var o;return function(h,g){const b=new XMLHttpRequest;b.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(b.responseType="arraybuffer");for(const E in h.headers)b.setRequestHeader(E,h.headers[E]);return h.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=h.credentials==="include",b.onerror=()=>{g(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let E=b.response;if(h.type==="json")try{E=JSON.parse(b.response)}catch(z){return g(z)}g(null,E,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else{const E=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});g(new rt(b.status,b.statusText,h.url,E))}},b.send(h.body),{cancel:()=>b.abort()}}(i,t)},no=function(i,t){return Cr(ke(i,{type:"arrayBuffer"}),t)};function qn(i){const t=window.document.createElement("a");return t.href=i,t.protocol===window.document.location.protocol&&t.host===window.document.location.host}const Mo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let fn,oo;fn=[],oo=0;const Gn=function(i,t){if(Li.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),oo>=hr.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:i,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return fn.push(b),b}oo++;let o=!1;const h=()=>{if(!o)for(o=!0,oo--;fn.length&&oo<hr.MAX_PARALLEL_IMAGE_REQUESTS;){const b=fn.shift(),{requestParameters:E,callback:z,cancelled:D}=b;D||(b.cancel=Gn(E,z).cancel)}},g=no(i,(b,E,z,D)=>{h(),b?t(b):E&&function(O,N){typeof createImageBitmap=="function"?function(U,K){const $=new Blob([new Uint8Array(U)],{type:"image/png"});createImageBitmap($).then(Q=>{K(null,Q)}).catch(Q=>{K(new Error(`Could not load image because of ${Q.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(O,N):function(U,K){const $=new Image;$.onload=()=>{K(null,$),URL.revokeObjectURL($.src),$.onload=null,window.requestAnimationFrame(()=>{$.src=Mo})},$.onerror=()=>K(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Q=new Blob([new Uint8Array(U)],{type:"image/png"});$.src=U.byteLength?URL.createObjectURL(Q):Mo}(O,N)}(E,(O,N)=>{O!=null?t(O):N!=null&&t(null,N,{cacheControl:z,expires:D})})});return{cancel:()=>{g.cancel(),h()}}};function Zi(i,t,o){o[i]&&o[i].indexOf(t)!==-1||(o[i]=o[i]||[],o[i].push(t))}function Fn(i,t,o){if(o&&o[i]){const h=o[i].indexOf(t);h!==-1&&o[i].splice(h,1)}}class _o{constructor(t,o={}){ke(this,o),this.type=t}}class Zn extends _o{constructor(t,o={}){super("error",ke({error:t},o))}}class Ra{on(t,o){return this._listeners=this._listeners||{},Zi(t,o,this._listeners),this}off(t,o){return Fn(t,o,this._listeners),Fn(t,o,this._oneTimeListeners),this}once(t,o){return this._oneTimeListeners=this._oneTimeListeners||{},Zi(t,o,this._oneTimeListeners),this}fire(t,o){typeof t=="string"&&(t=new _o(t,o||{}));const h=t.type;if(this.listens(h)){t.target=this;const g=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const z of g)z.call(this,t);const b=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const z of b)Fn(h,z,this._oneTimeListeners),z.call(this,t);const E=this._eventedParent;E&&(ke(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(t))}else t instanceof Zn&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,o){return this._eventedParent=t,this._eventedParentData=o,this}}var Ue={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class _t{constructor(t,o,h,g){this.message=(t?`${t}: `:"")+h,g&&(this.identifier=g),o!=null&&o.__line__&&(this.line=o.__line__)}}function bi(i){const t=i.value;return t?[new _t(i.key,t,"constants have been deprecated as of v8")]:[]}function pr(i,...t){for(const o of t)for(const h in o)i[h]=o[h];return i}function mr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Hn(i){if(Array.isArray(i))return i.map(Hn);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const o in i)t[o]=Hn(i[o]);return t}return mr(i)}class Wn extends Error{constructor(t,o){super(o),this.message=o,this.key=t}}class ea{constructor(t,o=[]){this.parent=t,this.bindings={};for(const[h,g]of o)this.bindings[h]=g}concat(t){return new ea(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Gr={kind:"null"},Ht={kind:"number"},nr={kind:"string"},Ki={kind:"boolean"},zn={kind:"color"},Xn={kind:"object"},Ni={kind:"value"},fa={kind:"collator"},Lo={kind:"formatted"},Nr={kind:"resolvedImage"};function te(i,t){return{kind:"array",itemType:i,N:t}}function oe(i){if(i.kind==="array"){const t=oe(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const le=[Gr,Ht,nr,Ki,zn,Lo,Xn,te(Ni),Nr];function ge(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!ge(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const o of le)if(!ge(o,t))return null}}return`Expected ${oe(i)} but found ${oe(t)} instead.`}function Se(i,t){return t.some(o=>o.kind===i.kind)}function Oe(i,t){return t.some(o=>o==="null"?i===null:o==="array"?Array.isArray(i):o==="object"?i&&!Array.isArray(i)&&typeof i=="object":o===typeof i)}var Ne,ye={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Pe(i){return(i=Math.round(i))<0?0:i>255?255:i}function Qe(i){return Pe(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function ae(i){return(t=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:t>1?1:t;var t}function H(i,t,o){return o<0?o+=1:o>1&&(o-=1),6*o<1?i+(t-i)*o*6:2*o<1?t:3*o<2?i+(t-i)*(2/3-o)*6:i}try{Ne={}.parseCSSColor=function(i){var t,o=i.replace(/ /g,"").toLowerCase();if(o in ye)return ye[o].slice();if(o[0]==="#")return o.length===4?(t=parseInt(o.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:o.length===7&&(t=parseInt(o.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var h=o.indexOf("("),g=o.indexOf(")");if(h!==-1&&g+1===o.length){var b=o.substr(0,h),E=o.substr(h+1,g-(h+1)).split(","),z=1;switch(b){case"rgba":if(E.length!==4)return null;z=ae(E.pop());case"rgb":return E.length!==3?null:[Qe(E[0]),Qe(E[1]),Qe(E[2]),z];case"hsla":if(E.length!==4)return null;z=ae(E.pop());case"hsl":if(E.length!==3)return null;var D=(parseFloat(E[0])%360+360)%360/360,O=ae(E[1]),N=ae(E[2]),U=N<=.5?N*(O+1):N+O-N*O,K=2*N-U;return[Pe(255*H(K,U,D+1/3)),Pe(255*H(K,U,D)),Pe(255*H(K,U,D-1/3)),z];default:return null}}return null}}catch{}class W{constructor(t,o,h,g=1){this.r=t,this.g=o,this.b=h,this.a=g}static parse(t){if(!t)return;if(t instanceof W)return t;if(typeof t!="string")return;const o=Ne(t);return o?new W(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[t,o,h,g]=this.toArray();return`rgba(${Math.round(t)},${Math.round(o)},${Math.round(h)},${g})`}toArray(){const{r:t,g:o,b:h,a:g}=this;return g===0?[0,0,0,0]:[255*t/g,255*o/g,255*h/g,g]}}W.black=new W(0,0,0,1),W.white=new W(1,1,1,1),W.transparent=new W(0,0,0,0),W.red=new W(1,0,0,1);class ne{constructor(t,o,h){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,o){return this.collator.compare(t,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ce{constructor(t,o,h,g,b){this.text=t,this.image=o,this.scale=h,this.fontStack=g,this.textColor=b}}class _e{constructor(t){this.sections=t}static fromString(t){return new _e([new ce(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof _e?t:_e.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const o of this.sections){if(o.image){t.push(["image",o.image.name]);continue}t.push(o.text);const h={};o.fontStack&&(h["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(h["font-scale"]=o.scale),o.textColor&&(h["text-color"]=["rgba"].concat(o.textColor.toArray())),t.push(h)}return t}}class fe{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new fe({name:t,available:!1}):null}serialize(){return["image",this.name]}}function Ee(i,t,o,h){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[i,t,o,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[i,t,o,h]:[i,t,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function we(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof W||i instanceof ne||i instanceof _e||i instanceof fe)return!0;if(Array.isArray(i)){for(const t of i)if(!we(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!we(i[t]))return!1;return!0}return!1}function Ie(i){if(i===null)return Gr;if(typeof i=="string")return nr;if(typeof i=="boolean")return Ki;if(typeof i=="number")return Ht;if(i instanceof W)return zn;if(i instanceof ne)return fa;if(i instanceof _e)return Lo;if(i instanceof fe)return Nr;if(Array.isArray(i)){const t=i.length;let o;for(const h of i){const g=Ie(h);if(o){if(o===g)continue;o=Ni;break}o=g}return te(o||Ni,t)}return Xn}function et(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof W||i instanceof _e||i instanceof fe?i.toString():JSON.stringify(i)}class Ke{constructor(t,o){this.type=t,this.value=o}static parse(t,o){if(t.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!we(t[1]))return o.error("invalid value");const h=t[1];let g=Ie(h);const b=o.expectedType;return g.kind!=="array"||g.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(g=b),new Ke(g,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof W?["rgba"].concat(this.value.toArray()):this.value instanceof _e?this.value.serialize():this.value}}class tt{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Ft={string:nr,number:Ht,boolean:Ki,object:Xn};class At{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let h,g=1;const b=t[0];if(b==="array"){let z,D;if(t.length>2){const O=t[1];if(typeof O!="string"||!(O in Ft)||O==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);z=Ft[O],g++}else z=Ni;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);D=t[2],g++}h=te(z,D)}else h=Ft[b];const E=[];for(;g<t.length;g++){const z=o.parse(t[g],g,Ni);if(!z)return null;E.push(z)}return new At(h,E)}evaluate(t){for(let o=0;o<this.args.length;o++){const h=this.args[o].evaluate(t);if(!ge(this.type,Ie(h)))return h;if(o===this.args.length-1)throw new tt(`Expected value to be of type ${oe(this.type)}, but found ${oe(Ie(h))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,o=[t.kind];if(t.kind==="array"){const h=t.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){o.push(h.kind);const g=t.N;(typeof g=="number"||this.args.length>1)&&o.push(g)}}return o.concat(this.args.map(h=>h.serialize()))}}class Bt{constructor(t){this.type=Lo,this.sections=t}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const h=t[1];if(!Array.isArray(h)&&typeof h=="object")return o.error("First argument must be an image or text section.");const g=[];let b=!1;for(let E=1;E<=t.length-1;++E){const z=t[E];if(b&&typeof z=="object"&&!Array.isArray(z)){b=!1;let D=null;if(z["font-scale"]&&(D=o.parse(z["font-scale"],1,Ht),!D))return null;let O=null;if(z["text-font"]&&(O=o.parse(z["text-font"],1,te(nr)),!O))return null;let N=null;if(z["text-color"]&&(N=o.parse(z["text-color"],1,zn),!N))return null;const U=g[g.length-1];U.scale=D,U.font=O,U.textColor=N}else{const D=o.parse(t[E],1,Ni);if(!D)return null;const O=D.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,g.push({content:D,scale:null,font:null,textColor:null})}}return new Bt(g)}evaluate(t){return new _e(this.sections.map(o=>{const h=o.content.evaluate(t);return Ie(h)===Nr?new ce("",h,null,null,null):new ce(et(h),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)}))}eachChild(t){for(const o of this.sections)t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const o of this.sections){t.push(o.content.serialize());const h={};o.scale&&(h["font-scale"]=o.scale.serialize()),o.font&&(h["text-font"]=o.font.serialize()),o.textColor&&(h["text-color"]=o.textColor.serialize()),t.push(h)}return t}}class jt{constructor(t){this.type=Nr,this.input=t}static parse(t,o){if(t.length!==2)return o.error("Expected two arguments.");const h=o.parse(t[1],1,nr);return h?new jt(h):o.error("No image name provided.")}evaluate(t){const o=this.input.evaluate(t),h=fe.fromString(o);return h&&t.availableImages&&(h.available=t.availableImages.indexOf(o)>-1),h}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Hi={"to-boolean":Ki,"to-color":zn,"to-number":Ht,"to-string":nr};class mi{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const h=t[0];if((h==="to-boolean"||h==="to-string")&&t.length!==2)return o.error("Expected one argument.");const g=Hi[h],b=[];for(let E=1;E<t.length;E++){const z=o.parse(t[E],E,Ni);if(!z)return null;b.push(z)}return new mi(g,b)}evaluate(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){let o,h;for(const g of this.args){if(o=g.evaluate(t),h=null,o instanceof W)return o;if(typeof o=="string"){const b=t.parseColor(o);if(b)return b}else if(Array.isArray(o)&&(h=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Ee(o[0],o[1],o[2],o[3]),!h))return new W(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new tt(h||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const h of this.args){if(o=h.evaluate(t),o===null)return 0;const g=Number(o);if(!isNaN(g))return g}throw new tt(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?_e.fromString(et(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?fe.fromString(et(this.args[0].evaluate(t))):et(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Bt([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new jt(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(o=>{t.push(o.serialize())}),t}}const Ii=["Unknown","Point","LineString","Polygon"];class li{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ii[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=W.parse(t)),o}}class Kt{constructor(t,o,h,g){this.name=t,this.type=o,this._evaluate=h,this.args=g}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,o){const h=t[0],g=Kt.definitions[h];if(!g)return o.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(g)?g[0]:g.type,E=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,z=E.filter(([O])=>!Array.isArray(O)||O.length===t.length-1);let D=null;for(const[O,N]of z){D=new Ba(o.registry,o.path,null,o.scope);const U=[];let K=!1;for(let $=1;$<t.length;$++){const Q=t[$],se=Array.isArray(O)?O[$-1]:O.type,pe=D.parse(Q,1+U.length,se);if(!pe){K=!0;break}U.push(pe)}if(!K)if(Array.isArray(O)&&O.length!==U.length)D.error(`Expected ${O.length} arguments, but found ${U.length} instead.`);else{for(let $=0;$<U.length;$++){const Q=Array.isArray(O)?O[$]:O.type,se=U[$];D.concat($+1).checkSubtype(Q,se.type)}if(D.errors.length===0)return new Kt(h,b,N,U)}}if(z.length===1)o.errors.push(...D.errors);else{const O=(z.length?z:E).map(([U])=>{return K=U,Array.isArray(K)?`(${K.map(oe).join(", ")})`:`(${oe(K.type)}...)`;var K}).join(" | "),N=[];for(let U=1;U<t.length;U++){const K=o.parse(t[U],1+N.length);if(!K)return null;N.push(oe(K.type))}o.error(`Expected arguments of type ${O}, but found (${N.join(", ")}) instead.`)}return null}static register(t,o){Kt.definitions=o;for(const h in o)t[h]=Kt}}class Pi{constructor(t,o,h){this.type=fa,this.locale=h,this.caseSensitive=t,this.diacriticSensitive=o}static parse(t,o){if(t.length!==2)return o.error("Expected one argument.");const h=t[1];if(typeof h!="object"||Array.isArray(h))return o.error("Collator options argument must be an object.");const g=o.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,Ki);if(!g)return null;const b=o.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,Ki);if(!b)return null;let E=null;return h.locale&&(E=o.parse(h.locale,1,nr),!E)?null:new Pi(g,b,E)}evaluate(t){return new ne(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const _r=8192;function Sn(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function Er(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function po(i,t){const o=(180+i[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,g=Math.pow(2,t.z);return[Math.round(o*g*_r),Math.round(h*g*_r)]}function Rl(i,t,o){const h=i[0]-t[0],g=i[1]-t[1],b=i[0]-o[0],E=i[1]-o[1];return h*E-b*g==0&&h*b<=0&&g*E<=0}function Rr(i,t){let o=!1;for(let E=0,z=t.length;E<z;E++){const D=t[E];for(let O=0,N=D.length;O<N-1;O++){if(Rl(i,D[O],D[O+1]))return!1;(g=D[O])[1]>(h=i)[1]!=(b=D[O+1])[1]>h[1]&&h[0]<(b[0]-g[0])*(h[1]-g[1])/(b[1]-g[1])+g[0]&&(o=!o)}}var h,g,b;return o}function vn(i,t){for(let o=0;o<t.length;o++)if(Rr(i,t[o]))return!0;return!1}function Vs(i,t,o,h){const g=h[0]-o[0],b=h[1]-o[1],E=(i[0]-o[0])*b-g*(i[1]-o[1]),z=(t[0]-o[0])*b-g*(t[1]-o[1]);return E>0&&z<0||E<0&&z>0}function vo(i,t,o){for(const O of o)for(let N=0;N<O.length-1;++N)if((z=[(E=O[N+1])[0]-(b=O[N])[0],E[1]-b[1]])[0]*(D=[(g=t)[0]-(h=i)[0],g[1]-h[1]])[1]-z[1]*D[0]!=0&&Vs(h,g,b,E)&&Vs(b,E,h,g))return!0;var h,g,b,E,z,D;return!1}function Pn(i,t){for(let o=0;o<i.length;++o)if(!Rr(i[o],t))return!1;for(let o=0;o<i.length-1;++o)if(vo(i[o],i[o+1],t))return!1;return!0}function ta(i,t){for(let o=0;o<t.length;o++)if(Pn(i,t[o]))return!0;return!1}function Wr(i,t,o){const h=[];for(let g=0;g<i.length;g++){const b=[];for(let E=0;E<i[g].length;E++){const z=po(i[g][E],o);Sn(t,z),b.push(z)}h.push(b)}return h}function ia(i,t,o){const h=[];for(let g=0;g<i.length;g++){const b=Wr(i[g],t,o);h.push(b)}return h}function Do(i,t,o,h){if(i[0]<o[0]||i[0]>o[2]){const g=.5*h;let b=i[0]-o[0]>g?-h:o[0]-i[0]>g?h:0;b===0&&(b=i[0]-o[2]>g?-h:o[2]-i[0]>g?h:0),i[0]+=b}Sn(t,i)}function Yu(i,t,o,h){const g=Math.pow(2,h.z)*_r,b=[h.x*_r,h.y*_r],E=[];for(const z of i)for(const D of z){const O=[D.x+b[0],D.y+b[1]];Do(O,t,o,g),E.push(O)}return E}function ra(i,t,o,h){const g=Math.pow(2,h.z)*_r,b=[h.x*_r,h.y*_r],E=[];for(const D of i){const O=[];for(const N of D){const U=[N.x+b[0],N.y+b[1]];Sn(t,U),O.push(U)}E.push(O)}if(t[2]-t[0]<=g/2){(z=t)[0]=z[1]=1/0,z[2]=z[3]=-1/0;for(const D of E)for(const O of D)Do(O,t,o,g)}var z;return E}class qs{constructor(t,o){this.type=Ki,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(we(t[1])){const h=t[1];if(h.type==="FeatureCollection")for(let g=0;g<h.features.length;++g){const b=h.features[g].geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new qs(h,h.features[g].geometry)}else if(h.type==="Feature"){const g=h.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new qs(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new qs(h,h)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,h){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],E=o.canonicalID();if(h.type==="Polygon"){const z=Wr(h.coordinates,b,E),D=Yu(o.geometry(),g,b,E);if(!Er(g,b))return!1;for(const O of D)if(!Rr(O,z))return!1}if(h.type==="MultiPolygon"){const z=ia(h.coordinates,b,E),D=Yu(o.geometry(),g,b,E);if(!Er(g,b))return!1;for(const O of D)if(!vn(O,z))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,h){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],E=o.canonicalID();if(h.type==="Polygon"){const z=Wr(h.coordinates,b,E),D=ra(o.geometry(),g,b,E);if(!Er(g,b))return!1;for(const O of D)if(!Pn(O,z))return!1}if(h.type==="MultiPolygon"){const z=ia(h.coordinates,b,E),D=ra(o.geometry(),g,b,E);if(!Er(g,b))return!1;for(const O of D)if(!ta(O,z))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function ma(i){if(i instanceof Kt&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof qs)return!1;let t=!0;return i.eachChild(o=>{t&&!ma(o)&&(t=!1)}),t}function xn(i){if(i instanceof Kt&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(o=>{t&&!xn(o)&&(t=!1)}),t}function jo(i,t){if(i instanceof Kt&&t.indexOf(i.name)>=0)return!1;let o=!0;return i.eachChild(h=>{o&&!jo(h,t)&&(o=!1)}),o}class Kn{constructor(t,o){this.type=o.type,this.name=t,this.boundExpression=o}static parse(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const h=t[1];return o.scope.has(h)?new Kn(h,o.scope.get(h)):o.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Ba{constructor(t,o=[],h,g=new ea,b=[]){this.registry=t,this.path=o,this.key=o.map(E=>`[${E}]`).join(""),this.scope=g,this.errors=b,this.expectedType=h}parse(t,o,h,g,b={}){return o?this.concat(o,h,g)._parse(t,b):this._parse(t,b)}_parse(t,o){function h(g,b,E){return E==="assert"?new At(b,[g]):E==="coerce"?new mi(b,[g]):g}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=t[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[g];if(b){let E=b.parse(t,this);if(!E)return null;if(this.expectedType){const z=this.expectedType,D=E.type;if(z.kind!=="string"&&z.kind!=="number"&&z.kind!=="boolean"&&z.kind!=="object"&&z.kind!=="array"||D.kind!=="value")if(z.kind!=="color"&&z.kind!=="formatted"&&z.kind!=="resolvedImage"||D.kind!=="value"&&D.kind!=="string"){if(this.checkSubtype(z,D))return null}else E=h(E,z,o.typeAnnotation||"coerce");else E=h(E,z,o.typeAnnotation||"assert")}if(!(E instanceof Ke)&&E.type.kind!=="resolvedImage"&&Bl(E)){const z=new li;try{E=new Ke(E.type,E.evaluate(z))}catch(D){return this.error(D.message),null}}return E}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,o,h){const g=typeof t=="number"?this.path.concat(t):this.path,b=h?this.scope.concat(h):this.scope;return new Ba(this.registry,g,o||null,b,this.errors)}error(t,...o){const h=`${this.key}${o.map(g=>`[${g}]`).join("")}`;this.errors.push(new Wn(h,t))}checkSubtype(t,o){const h=ge(t,o);return h&&this.error(h),h}}function Bl(i){if(i instanceof Kn)return Bl(i.boundExpression);if(i instanceof Kt&&i.name==="error"||i instanceof Pi||i instanceof qs)return!1;const t=i instanceof mi||i instanceof At;let o=!0;return i.eachChild(h=>{o=t?o&&Bl(h):o&&h instanceof Ke}),!!o&&ma(i)&&jo(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function xu(i,t){const o=i.length-1;let h,g,b=0,E=o,z=0;for(;b<=E;)if(z=Math.floor((b+E)/2),h=i[z],g=i[z+1],h<=t){if(z===o||t<g)return z;b=z+1}else{if(!(h>t))throw new tt("Input is not a number.");E=z-1}return 0}class Gs{constructor(t,o,h){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(const[g,b]of h)this.labels.push(g),this.outputs.push(b)}static parse(t,o){if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");const h=o.parse(t[1],1,Ht);if(!h)return null;const g=[];let b=null;o.expectedType&&o.expectedType.kind!=="value"&&(b=o.expectedType);for(let E=1;E<t.length;E+=2){const z=E===1?-1/0:t[E],D=t[E+1],O=E,N=E+1;if(typeof z!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(g.length&&g[g.length-1][0]>=z)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const U=o.parse(D,N,b);if(!U)return null;b=b||U.type,g.push([z,U])}return new Gs(b,h,g)}evaluate(t){const o=this.labels,h=this.outputs;if(o.length===1)return h[0].evaluate(t);const g=this.input.evaluate(t);if(g<=o[0])return h[0].evaluate(t);const b=o.length;return g>=o[b-1]?h[b-1].evaluate(t):h[xu(o,g)].evaluate(t)}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&t.push(this.labels[o]),t.push(this.outputs[o].serialize());return t}}function Un(i,t,o){return i*(1-o)+t*o}var dl=Object.freeze({__proto__:null,number:Un,color:function(i,t,o){return new W(Un(i.r,t.r,o),Un(i.g,t.g,o),Un(i.b,t.b,o),Un(i.a,t.a,o))},array:function(i,t,o){return i.map((h,g)=>Un(h,t[g],o))}});const $u=.95047,Qu=1.08883,ec=4/29,Qa=6/29,Ol=3*Qa*Qa,Fl=Math.PI/180,Mc=180/Math.PI;function fl(i){return i>.008856451679035631?Math.pow(i,1/3):i/Ol+ec}function Vo(i){return i>Qa?i*i*i:Ol*(i-ec)}function Oa(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function Fa(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function xs(i){const t=Fa(i.r),o=Fa(i.g),h=Fa(i.b),g=fl((.4124564*t+.3575761*o+.1804375*h)/$u),b=fl((.2126729*t+.7151522*o+.072175*h)/1);return{l:116*b-16,a:500*(g-b),b:200*(b-fl((.0193339*t+.119192*o+.9503041*h)/Qu)),alpha:i.a}}function ur(i){let t=(i.l+16)/116,o=isNaN(i.a)?t:t+i.a/500,h=isNaN(i.b)?t:t-i.b/200;return t=1*Vo(t),o=$u*Vo(o),h=Qu*Vo(h),new W(Oa(3.2404542*o-1.5371385*t-.4985314*h),Oa(-.969266*o+1.8760108*t+.041556*h),Oa(.0556434*o-.2040259*t+1.0572252*h),i.alpha)}function bs(i,t,o){const h=t-i;return i+o*(h>180||h<-180?h-360*Math.round(h/360):h)}const ws={forward:xs,reverse:ur,interpolate:function(i,t,o){return{l:Un(i.l,t.l,o),a:Un(i.a,t.a,o),b:Un(i.b,t.b,o),alpha:Un(i.alpha,t.alpha,o)}}},ao={forward:function(i){const{l:t,a:o,b:h}=xs(i),g=Math.atan2(h,o)*Mc;return{h:g<0?g+360:g,c:Math.sqrt(o*o+h*h),l:t,alpha:i.a}},reverse:function(i){const t=i.h*Fl,o=i.c;return ur({l:i.l,a:Math.cos(t)*o,b:Math.sin(t)*o,alpha:i.alpha})},interpolate:function(i,t,o){return{h:bs(i.h,t.h,o),c:Un(i.c,t.c,o),l:Un(i.l,t.l,o),alpha:Un(i.alpha,t.alpha,o)}}};var bn=Object.freeze({__proto__:null,lab:ws,hcl:ao});class so{constructor(t,o,h,g,b){this.type=t,this.operator=o,this.interpolation=h,this.input=g,this.labels=[],this.outputs=[];for(const[E,z]of b)this.labels.push(E),this.outputs.push(z)}static interpolationFactor(t,o,h,g){let b=0;if(t.name==="exponential")b=bu(o,t.base,h,g);else if(t.name==="linear")b=bu(o,1,h,g);else if(t.name==="cubic-bezier"){const E=t.controlPoints;b=new R(E[0],E[1],E[2],E[3]).solve(bu(o,1,h,g))}return b}static parse(t,o){let[h,g,b,...E]=t;if(!Array.isArray(g)||g.length===0)return o.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const O=g[1];if(typeof O!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:O}}else{if(g[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const O=g.slice(1);if(O.length!==4||O.some(N=>typeof N!="number"||N<0||N>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:O}}}if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(b=o.parse(b,2,Ht),!b)return null;const z=[];let D=null;h==="interpolate-hcl"||h==="interpolate-lab"?D=zn:o.expectedType&&o.expectedType.kind!=="value"&&(D=o.expectedType);for(let O=0;O<E.length;O+=2){const N=E[O],U=E[O+1],K=O+3,$=O+4;if(typeof N!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',K);if(z.length&&z[z.length-1][0]>=N)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',K);const Q=o.parse(U,$,D);if(!Q)return null;D=D||Q.type,z.push([N,Q])}return D.kind==="number"||D.kind==="color"||D.kind==="array"&&D.itemType.kind==="number"&&typeof D.N=="number"?new so(D,h,g,b,z):o.error(`Type ${oe(D)} is not interpolatable.`)}evaluate(t){const o=this.labels,h=this.outputs;if(o.length===1)return h[0].evaluate(t);const g=this.input.evaluate(t);if(g<=o[0])return h[0].evaluate(t);const b=o.length;if(g>=o[b-1])return h[b-1].evaluate(t);const E=xu(o,g),z=so.interpolationFactor(this.interpolation,g,o[E],o[E+1]),D=h[E].evaluate(t),O=h[E+1].evaluate(t);return this.operator==="interpolate"?dl[this.type.kind.toLowerCase()](D,O,z):this.operator==="interpolate-hcl"?ao.reverse(ao.interpolate(ao.forward(D),ao.forward(O),z)):ws.reverse(ws.interpolate(ws.forward(D),ws.forward(O),z))}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,t,this.input.serialize()];for(let h=0;h<this.labels.length;h++)o.push(this.labels[h],this.outputs[h].serialize());return o}}function bu(i,t,o,h){const g=h-o,b=i-o;return g===0?0:t===1?b/g:(Math.pow(t,b)-1)/(Math.pow(t,g)-1)}class wu{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expectected at least one argument.");let h=null;const g=o.expectedType;g&&g.kind!=="value"&&(h=g);const b=[];for(const z of t.slice(1)){const D=o.parse(z,1+b.length,h,void 0,{typeAnnotation:"omit"});if(!D)return null;h=h||D.type,b.push(D)}const E=g&&b.some(z=>ge(g,z.type));return new wu(E?Ni:h,b)}evaluate(t){let o,h=null,g=0;for(const b of this.args)if(g++,h=b.evaluate(t),h&&h instanceof fe&&!h.available&&(o||(o=h.name),h=null,g===this.args.length&&(h=o)),h!==null)break;return h}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(o=>{t.push(o.serialize())}),t}}class Eu{constructor(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const o of this.bindings)t(o[1]);t(this.result)}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const h=[];for(let b=1;b<t.length-1;b+=2){const E=t[b];if(typeof E!="string")return o.error(`Expected string, but found ${typeof E} instead.`,b);if(/[^a-zA-Z0-9_]/.test(E))return o.error("Variable names must contain only alphanumeric characters or '_'.",b);const z=o.parse(t[b+1],b+1);if(!z)return null;h.push([E,z])}const g=o.parse(t[t.length-1],t.length-1,o.expectedType,h);return g?new Eu(h,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[o,h]of this.bindings)t.push(o,h.serialize());return t.push(this.result.serialize()),t}}class Ul{constructor(t,o,h){this.type=t,this.index=o,this.input=h}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=o.parse(t[1],1,Ht),g=o.parse(t[2],2,te(o.expectedType||Ni));return h&&g?new Ul(g.type.itemType,h,g):null}evaluate(t){const o=this.index.evaluate(t),h=this.input.evaluate(t);if(o<0)throw new tt(`Array index out of bounds: ${o} < 0.`);if(o>=h.length)throw new tt(`Array index out of bounds: ${o} > ${h.length-1}.`);if(o!==Math.floor(o))throw new tt(`Array index must be an integer, but found ${o} instead.`);return h[o]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Nl{constructor(t,o){this.type=Ki,this.needle=t,this.haystack=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=o.parse(t[1],1,Ni),g=o.parse(t[2],2,Ni);return h&&g?Se(h.type,[Ki,nr,Ht,Gr,Ni])?new Nl(h,g):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${oe(h.type)} instead`):null}evaluate(t){const o=this.needle.evaluate(t),h=this.haystack.evaluate(t);if(!h)return!1;if(!Oe(o,["boolean","string","number","null"]))throw new tt(`Expected first argument to be of type boolean, string, number or null, but found ${oe(Ie(o))} instead.`);if(!Oe(h,["string","array"]))throw new tt(`Expected second argument to be of type array or string, but found ${oe(Ie(h))} instead.`);return h.indexOf(o)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class ml{constructor(t,o,h){this.type=Ht,this.needle=t,this.haystack=o,this.fromIndex=h}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const h=o.parse(t[1],1,Ni),g=o.parse(t[2],2,Ni);if(!h||!g)return null;if(!Se(h.type,[Ki,nr,Ht,Gr,Ni]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${oe(h.type)} instead`);if(t.length===4){const b=o.parse(t[3],3,Ht);return b?new ml(h,g,b):null}return new ml(h,g)}evaluate(t){const o=this.needle.evaluate(t),h=this.haystack.evaluate(t);if(!Oe(o,["boolean","string","number","null"]))throw new tt(`Expected first argument to be of type boolean, string, number or null, but found ${oe(Ie(o))} instead.`);if(!Oe(h,["string","array"]))throw new tt(`Expected second argument to be of type array or string, but found ${oe(Ie(h))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(t);return h.indexOf(o,g)}return h.indexOf(o)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class jl{constructor(t,o,h,g,b,E){this.inputType=t,this.type=o,this.input=h,this.cases=g,this.outputs=b,this.otherwise=E}static parse(t,o){if(t.length<5)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return o.error("Expected an even number of arguments.");let h,g;o.expectedType&&o.expectedType.kind!=="value"&&(g=o.expectedType);const b={},E=[];for(let O=2;O<t.length-1;O+=2){let N=t[O];const U=t[O+1];Array.isArray(N)||(N=[N]);const K=o.concat(O);if(N.length===0)return K.error("Expected at least one branch label.");for(const Q of N){if(typeof Q!="number"&&typeof Q!="string")return K.error("Branch labels must be numbers or strings.");if(typeof Q=="number"&&Math.abs(Q)>Number.MAX_SAFE_INTEGER)return K.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Q=="number"&&Math.floor(Q)!==Q)return K.error("Numeric branch labels must be integer values.");if(h){if(K.checkSubtype(h,Ie(Q)))return null}else h=Ie(Q);if(b[String(Q)]!==void 0)return K.error("Branch labels must be unique.");b[String(Q)]=E.length}const $=o.parse(U,O,g);if(!$)return null;g=g||$.type,E.push($)}const z=o.parse(t[1],1,Ni);if(!z)return null;const D=o.parse(t[t.length-1],t.length-1,g);return D?z.type.kind!=="value"&&o.concat(1).checkSubtype(h,z.type)?null:new jl(h,g,z,b,E,D):null}evaluate(t){const o=this.input.evaluate(t);return(Ie(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),h=[],g={};for(const E of o){const z=g[this.cases[E]];z===void 0?(g[this.cases[E]]=h.length,h.push([this.cases[E],[E]])):h[z][1].push(E)}const b=E=>this.inputType.kind==="number"?Number(E):E;for(const[E,z]of h)t.push(z.length===1?b(z[0]):z.map(b)),t.push(this.outputs[E].serialize());return t.push(this.otherwise.serialize()),t}}class Iu{constructor(t,o,h){this.type=t,this.branches=o,this.otherwise=h}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return o.error("Expected an odd number of arguments.");let h;o.expectedType&&o.expectedType.kind!=="value"&&(h=o.expectedType);const g=[];for(let E=1;E<t.length-1;E+=2){const z=o.parse(t[E],E,Ki);if(!z)return null;const D=o.parse(t[E+1],E+1,h);if(!D)return null;g.push([z,D]),h=h||D.type}const b=o.parse(t[t.length-1],t.length-1,h);return b?new Iu(h,g,b):null}evaluate(t){for(const[o,h]of this.branches)if(o.evaluate(t))return h.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[o,h]of this.branches)t(o),t(h);t(this.otherwise)}outputDefined(){return this.branches.every(([t,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(o=>{t.push(o.serialize())}),t}}class Vl{constructor(t,o,h,g){this.type=t,this.input=o,this.beginIndex=h,this.endIndex=g}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const h=o.parse(t[1],1,Ni),g=o.parse(t[2],2,Ht);if(!h||!g)return null;if(!Se(h.type,[te(Ni),nr,Ni]))return o.error(`Expected first argument to be of type array or string, but found ${oe(h.type)} instead`);if(t.length===4){const b=o.parse(t[3],3,Ht);return b?new Vl(h.type,h,g,b):null}return new Vl(h.type,h,g)}evaluate(t){const o=this.input.evaluate(t),h=this.beginIndex.evaluate(t);if(!Oe(o,["string","array"]))throw new tt(`Expected first argument to be of type array or string, but found ${oe(Ie(o))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(t);return o.slice(h,g)}return o.slice(h)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Lc(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function yl(i,t,o,h){return h.compare(t,o)===0}function Ua(i,t,o){const h=i!=="=="&&i!=="!=";return class Ov{constructor(b,E,z){this.type=Ki,this.lhs=b,this.rhs=E,this.collator=z,this.hasUntypedArgument=b.type.kind==="value"||E.type.kind==="value"}static parse(b,E){if(b.length!==3&&b.length!==4)return E.error("Expected two or three arguments.");const z=b[0];let D=E.parse(b[1],1,Ni);if(!D)return null;if(!Lc(z,D.type))return E.concat(1).error(`"${z}" comparisons are not supported for type '${oe(D.type)}'.`);let O=E.parse(b[2],2,Ni);if(!O)return null;if(!Lc(z,O.type))return E.concat(2).error(`"${z}" comparisons are not supported for type '${oe(O.type)}'.`);if(D.type.kind!==O.type.kind&&D.type.kind!=="value"&&O.type.kind!=="value")return E.error(`Cannot compare types '${oe(D.type)}' and '${oe(O.type)}'.`);h&&(D.type.kind==="value"&&O.type.kind!=="value"?D=new At(O.type,[D]):D.type.kind!=="value"&&O.type.kind==="value"&&(O=new At(D.type,[O])));let N=null;if(b.length===4){if(D.type.kind!=="string"&&O.type.kind!=="string"&&D.type.kind!=="value"&&O.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(N=E.parse(b[3],3,fa),!N)return null}return new Ov(D,O,N)}evaluate(b){const E=this.lhs.evaluate(b),z=this.rhs.evaluate(b);if(h&&this.hasUntypedArgument){const D=Ie(E),O=Ie(z);if(D.kind!==O.kind||D.kind!=="string"&&D.kind!=="number")throw new tt(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${D.kind}, ${O.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const D=Ie(E),O=Ie(z);if(D.kind!=="string"||O.kind!=="string")return t(b,E,z)}return this.collator?o(b,E,z,this.collator.evaluate(b)):t(b,E,z)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}serialize(){const b=[i];return this.eachChild(E=>{b.push(E.serialize())}),b}}}const Dc=Ua("==",function(i,t,o){return t===o},yl),lo=Ua("!=",function(i,t,o){return t!==o},function(i,t,o,h){return!yl(0,t,o,h)}),tc=Ua("<",function(i,t,o){return t<o},function(i,t,o,h){return h.compare(t,o)<0}),Es=Ua(">",function(i,t,o){return t>o},function(i,t,o,h){return h.compare(t,o)>0}),Is=Ua("<=",function(i,t,o){return t<=o},function(i,t,o,h){return h.compare(t,o)<=0}),Zs=Ua(">=",function(i,t,o){return t>=o},function(i,t,o,h){return h.compare(t,o)>=0});class es{constructor(t,o,h,g,b){this.type=nr,this.number=t,this.locale=o,this.currency=h,this.minFractionDigits=g,this.maxFractionDigits=b}static parse(t,o){if(t.length!==3)return o.error("Expected two arguments.");const h=o.parse(t[1],1,Ht);if(!h)return null;const g=t[2];if(typeof g!="object"||Array.isArray(g))return o.error("NumberFormat options argument must be an object.");let b=null;if(g.locale&&(b=o.parse(g.locale,1,nr),!b))return null;let E=null;if(g.currency&&(E=o.parse(g.currency,1,nr),!E))return null;let z=null;if(g["min-fraction-digits"]&&(z=o.parse(g["min-fraction-digits"],1,Ht),!z))return null;let D=null;return g["max-fraction-digits"]&&(D=o.parse(g["max-fraction-digits"],1,Ht),!D)?null:new es(h,b,E,z,D)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Na{constructor(t){this.type=Ht,this.input=t}static parse(t,o){if(t.length!==2)return o.error(`Expected 1 argument, but found ${t.length-1} instead.`);const h=o.parse(t[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${oe(h.type)} instead.`):new Na(h):null}evaluate(t){const o=this.input.evaluate(t);if(typeof o=="string"||Array.isArray(o))return o.length;throw new tt(`Expected value to be of type string or array, but found ${oe(Ie(o))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(o=>{t.push(o.serialize())}),t}}const ya={"==":Dc,"!=":lo,">":Es,"<":tc,">=":Zs,"<=":Is,array:At,at:Ul,boolean:At,case:Iu,coalesce:wu,collator:Pi,format:Bt,image:jt,in:Nl,"index-of":ml,interpolate:so,"interpolate-hcl":so,"interpolate-lab":so,length:Na,let:Eu,literal:Ke,match:jl,number:At,"number-format":es,object:At,slice:Vl,step:Gs,string:At,"to-boolean":mi,"to-color":mi,"to-number":mi,"to-string":mi,var:Kn,within:qs};function Ss(i,[t,o,h,g]){t=t.evaluate(i),o=o.evaluate(i),h=h.evaluate(i);const b=g?g.evaluate(i):1,E=Ee(t,o,h,b);if(E)throw new tt(E);return new W(t/255*b,o/255*b,h/255*b,b)}function ts(i,t){return i in t}function Su(i,t){const o=t[i];return o===void 0?null:o}function Ts(i){return{type:i}}function Br(i){return{result:"success",value:i}}function Hs(i){return{result:"error",value:i}}function is(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function ic(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Tu(i){return!!i.expression&&i.expression.interpolated}function Ji(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function ql(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function yr(i){return i}function Sa(i,t){const o=t.type==="color",h=i.stops&&typeof i.stops[0][0]=="object",g=h||!(h||i.property!==void 0),b=i.type||(Tu(t)?"exponential":"interval");if(o&&((i=pr({},i)).stops&&(i.stops=i.stops.map(O=>[O[0],W.parse(O[1])])),i.default=W.parse(i.default?i.default:t.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!bn[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let E,z,D;if(b==="exponential")E=Zl;else if(b==="interval")E=Gl;else if(b==="categorical"){E=wn,z=Object.create(null);for(const O of i.stops)z[O[0]]=O[1];D=typeof i.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);E=Ws}if(h){const O={},N=[];for(let $=0;$<i.stops.length;$++){const Q=i.stops[$],se=Q[0].zoom;O[se]===void 0&&(O[se]={zoom:se,type:i.type,property:i.property,default:i.default,stops:[]},N.push(se)),O[se].stops.push([Q[0].value,Q[1]])}const U=[];for(const $ of N)U.push([O[$].zoom,Sa(O[$],t)]);const K={name:"linear"};return{kind:"composite",interpolationType:K,interpolationFactor:so.interpolationFactor.bind(void 0,K),zoomStops:U.map($=>$[0]),evaluate:({zoom:$},Q)=>Zl({stops:U,base:i.base},t,$).evaluate($,Q)}}if(g){const O=b==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:so.interpolationFactor.bind(void 0,O),zoomStops:i.stops.map(N=>N[0]),evaluate:({zoom:N})=>E(i,t,N,z,D)}}return{kind:"source",evaluate(O,N){const U=N&&N.properties?N.properties[i.property]:void 0;return U===void 0?jr(i.default,t.default):E(i,t,U,z,D)}}}function jr(i,t,o){return i!==void 0?i:t!==void 0?t:o!==void 0?o:void 0}function wn(i,t,o,h,g){return jr(typeof o===g?h[o]:void 0,i.default,t.default)}function Gl(i,t,o){if(Ji(o)!=="number")return jr(i.default,t.default);const h=i.stops.length;if(h===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[h-1][0])return i.stops[h-1][1];const g=xu(i.stops.map(b=>b[0]),o);return i.stops[g][1]}function Zl(i,t,o){const h=i.base!==void 0?i.base:1;if(Ji(o)!=="number")return jr(i.default,t.default);const g=i.stops.length;if(g===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[g-1][0])return i.stops[g-1][1];const b=xu(i.stops.map(N=>N[0]),o),E=function(N,U,K,$){const Q=$-K,se=N-K;return Q===0?0:U===1?se/Q:(Math.pow(U,se)-1)/(Math.pow(U,Q)-1)}(o,h,i.stops[b][0],i.stops[b+1][0]),z=i.stops[b][1],D=i.stops[b+1][1];let O=dl[t.type]||yr;if(i.colorSpace&&i.colorSpace!=="rgb"){const N=bn[i.colorSpace];O=(U,K)=>N.reverse(N.interpolate(N.forward(U),N.forward(K),E))}return typeof z.evaluate=="function"?{evaluate(...N){const U=z.evaluate.apply(void 0,N),K=D.evaluate.apply(void 0,N);if(U!==void 0&&K!==void 0)return O(U,K,E)}}:O(z,D,E)}function Ws(i,t,o){return t.type==="color"?o=W.parse(o):t.type==="formatted"?o=_e.fromString(o.toString()):t.type==="resolvedImage"?o=fe.fromString(o.toString()):Ji(o)===t.type||t.type==="enum"&&t.values[o]||(o=void 0),jr(o,i.default,t.default)}Kt.register(ya,{error:[{kind:"error"},[nr],(i,[t])=>{throw new tt(t.evaluate(i))}],typeof:[nr,[Ni],(i,[t])=>oe(Ie(t.evaluate(i)))],"to-rgba":[te(Ht,4),[zn],(i,[t])=>t.evaluate(i).toArray()],rgb:[zn,[Ht,Ht,Ht],Ss],rgba:[zn,[Ht,Ht,Ht,Ht],Ss],has:{type:Ki,overloads:[[[nr],(i,[t])=>ts(t.evaluate(i),i.properties())],[[nr,Xn],(i,[t,o])=>ts(t.evaluate(i),o.evaluate(i))]]},get:{type:Ni,overloads:[[[nr],(i,[t])=>Su(t.evaluate(i),i.properties())],[[nr,Xn],(i,[t,o])=>Su(t.evaluate(i),o.evaluate(i))]]},"feature-state":[Ni,[nr],(i,[t])=>Su(t.evaluate(i),i.featureState||{})],properties:[Xn,[],i=>i.properties()],"geometry-type":[nr,[],i=>i.geometryType()],id:[Ni,[],i=>i.id()],zoom:[Ht,[],i=>i.globals.zoom],"heatmap-density":[Ht,[],i=>i.globals.heatmapDensity||0],"line-progress":[Ht,[],i=>i.globals.lineProgress||0],accumulated:[Ni,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Ht,Ts(Ht),(i,t)=>{let o=0;for(const h of t)o+=h.evaluate(i);return o}],"*":[Ht,Ts(Ht),(i,t)=>{let o=1;for(const h of t)o*=h.evaluate(i);return o}],"-":{type:Ht,overloads:[[[Ht,Ht],(i,[t,o])=>t.evaluate(i)-o.evaluate(i)],[[Ht],(i,[t])=>-t.evaluate(i)]]},"/":[Ht,[Ht,Ht],(i,[t,o])=>t.evaluate(i)/o.evaluate(i)],"%":[Ht,[Ht,Ht],(i,[t,o])=>t.evaluate(i)%o.evaluate(i)],ln2:[Ht,[],()=>Math.LN2],pi:[Ht,[],()=>Math.PI],e:[Ht,[],()=>Math.E],"^":[Ht,[Ht,Ht],(i,[t,o])=>Math.pow(t.evaluate(i),o.evaluate(i))],sqrt:[Ht,[Ht],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[Ht,[Ht],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[Ht,[Ht],(i,[t])=>Math.log(t.evaluate(i))],log2:[Ht,[Ht],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[Ht,[Ht],(i,[t])=>Math.sin(t.evaluate(i))],cos:[Ht,[Ht],(i,[t])=>Math.cos(t.evaluate(i))],tan:[Ht,[Ht],(i,[t])=>Math.tan(t.evaluate(i))],asin:[Ht,[Ht],(i,[t])=>Math.asin(t.evaluate(i))],acos:[Ht,[Ht],(i,[t])=>Math.acos(t.evaluate(i))],atan:[Ht,[Ht],(i,[t])=>Math.atan(t.evaluate(i))],min:[Ht,Ts(Ht),(i,t)=>Math.min(...t.map(o=>o.evaluate(i)))],max:[Ht,Ts(Ht),(i,t)=>Math.max(...t.map(o=>o.evaluate(i)))],abs:[Ht,[Ht],(i,[t])=>Math.abs(t.evaluate(i))],round:[Ht,[Ht],(i,[t])=>{const o=t.evaluate(i);return o<0?-Math.round(-o):Math.round(o)}],floor:[Ht,[Ht],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[Ht,[Ht],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[Ki,[nr,Ni],(i,[t,o])=>i.properties()[t.value]===o.value],"filter-id-==":[Ki,[Ni],(i,[t])=>i.id()===t.value],"filter-type-==":[Ki,[nr],(i,[t])=>i.geometryType()===t.value],"filter-<":[Ki,[nr,Ni],(i,[t,o])=>{const h=i.properties()[t.value],g=o.value;return typeof h==typeof g&&h<g}],"filter-id-<":[Ki,[Ni],(i,[t])=>{const o=i.id(),h=t.value;return typeof o==typeof h&&o<h}],"filter->":[Ki,[nr,Ni],(i,[t,o])=>{const h=i.properties()[t.value],g=o.value;return typeof h==typeof g&&h>g}],"filter-id->":[Ki,[Ni],(i,[t])=>{const o=i.id(),h=t.value;return typeof o==typeof h&&o>h}],"filter-<=":[Ki,[nr,Ni],(i,[t,o])=>{const h=i.properties()[t.value],g=o.value;return typeof h==typeof g&&h<=g}],"filter-id-<=":[Ki,[Ni],(i,[t])=>{const o=i.id(),h=t.value;return typeof o==typeof h&&o<=h}],"filter->=":[Ki,[nr,Ni],(i,[t,o])=>{const h=i.properties()[t.value],g=o.value;return typeof h==typeof g&&h>=g}],"filter-id->=":[Ki,[Ni],(i,[t])=>{const o=i.id(),h=t.value;return typeof o==typeof h&&o>=h}],"filter-has":[Ki,[Ni],(i,[t])=>t.value in i.properties()],"filter-has-id":[Ki,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Ki,[te(nr)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[Ki,[te(Ni)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[Ki,[nr,te(Ni)],(i,[t,o])=>o.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[Ki,[nr,te(Ni)],(i,[t,o])=>function(h,g,b,E){for(;b<=E;){const z=b+E>>1;if(g[z]===h)return!0;g[z]>h?E=z-1:b=z+1}return!1}(i.properties()[t.value],o.value,0,o.value.length-1)],all:{type:Ki,overloads:[[[Ki,Ki],(i,[t,o])=>t.evaluate(i)&&o.evaluate(i)],[Ts(Ki),(i,t)=>{for(const o of t)if(!o.evaluate(i))return!1;return!0}]]},any:{type:Ki,overloads:[[[Ki,Ki],(i,[t,o])=>t.evaluate(i)||o.evaluate(i)],[Ts(Ki),(i,t)=>{for(const o of t)if(o.evaluate(i))return!0;return!1}]]},"!":[Ki,[Ki],(i,[t])=>!t.evaluate(i)],"is-supported-script":[Ki,[nr],(i,[t])=>{const o=i.globals&&i.globals.isSupportedScript;return!o||o(t.evaluate(i))}],upcase:[nr,[nr],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[nr,[nr],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[nr,Ts(Ni),(i,t)=>t.map(o=>et(o.evaluate(i))).join("")],"resolved-locale":[nr,[fa],(i,[t])=>t.evaluate(i).resolvedLocale()]});class Au{constructor(t,o){this.expression=t,this._warningHistory={},this._evaluator=new li,this._defaultValue=o?function(h){return h.type==="color"&&ql(h.default)?new W(0,0,0,0):h.type==="color"?W.parse(h.default)||null:h.default===void 0?null:h.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(t,o,h,g,b,E){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=h,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)}evaluate(t,o,h,g,b,E){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=h||null,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=E||null;try{const z=this.expression.evaluate(this._evaluator);if(z==null||typeof z=="number"&&z!=z)return this._defaultValue;if(this._enumValues&&!(z in this._enumValues))throw new tt(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(z)} instead.`);return z}catch(z){return this._warningHistory[z.message]||(this._warningHistory[z.message]=!0,typeof console!="undefined"&&console.warn(z.message)),this._defaultValue}}}function ja(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in ya}function Va(i,t){const o=new Ba(ya,[],t?function(g){const b={color:zn,string:nr,number:Ht,enum:nr,boolean:Ki,formatted:Lo,resolvedImage:Nr};return g.type==="array"?te(b[g.value]||Ni,g.length):b[g.type]}(t):void 0),h=o.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?Br(new Au(h,t)):Hs(o.errors)}class Hl{constructor(t,o){this.kind=t,this._styleExpression=o,this.isStateDependent=t!=="constant"&&!xn(o.expression)}evaluateWithoutErrorHandling(t,o,h,g,b,E){return this._styleExpression.evaluateWithoutErrorHandling(t,o,h,g,b,E)}evaluate(t,o,h,g,b,E){return this._styleExpression.evaluate(t,o,h,g,b,E)}}class As{constructor(t,o,h,g){this.kind=t,this.zoomStops=h,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!xn(o.expression),this.interpolationType=g}evaluateWithoutErrorHandling(t,o,h,g,b,E){return this._styleExpression.evaluateWithoutErrorHandling(t,o,h,g,b,E)}evaluate(t,o,h,g,b,E){return this._styleExpression.evaluate(t,o,h,g,b,E)}interpolationFactor(t,o,h){return this.interpolationType?so.interpolationFactor(this.interpolationType,t,o,h):0}}function Vr(i,t){const o=Va(i,t);if(o.result==="error")return o;const h=o.value.expression,g=ma(h);if(!g&&!is(t))return Hs([new Wn("","data expressions not supported")]);const b=jo(h,["zoom"]);if(!b&&!ic(t))return Hs([new Wn("","zoom expressions not supported")]);const E=Cu(h);return E||b?E instanceof Wn?Hs([E]):E instanceof so&&!Tu(t)?Hs([new Wn("",'"interpolate" expressions cannot be used with this property')]):Br(E?new As(g?"camera":"composite",o.value,E.labels,E instanceof so?E.interpolation:void 0):new Hl(g?"constant":"source",o.value)):Hs([new Wn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class rs{constructor(t,o){this._parameters=t,this._specification=o,pr(this,Sa(this._parameters,this._specification))}static deserialize(t){return new rs(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Cu(i){let t=null;if(i instanceof Eu)t=Cu(i.result);else if(i instanceof wu){for(const o of i.args)if(t=Cu(o),t)break}else(i instanceof Gs||i instanceof so)&&i.input instanceof Kt&&i.input.name==="zoom"&&(t=i);return t instanceof Wn||i.eachChild(o=>{const h=Cu(o);h instanceof Wn?t=h:!t&&h?t=new Wn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&h&&t!==h&&(t=new Wn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function xo(i){const t=i.key,o=i.value,h=i.valueSpec||{},g=i.objectElementValidators||{},b=i.style,E=i.styleSpec;let z=[];const D=Ji(o);if(D!=="object")return[new _t(t,o,`object expected, ${D} found`)];for(const O in o){const N=O.split(".")[0],U=h[N]||h["*"];let K;if(g[N])K=g[N];else if(h[N])K=wo;else if(g["*"])K=g["*"];else{if(!h["*"]){z.push(new _t(t,o[O],`unknown property "${O}"`));continue}K=wo}z=z.concat(K({key:(t&&`${t}.`)+O,value:o[O],valueSpec:U,style:b,styleSpec:E,object:o,objectKey:O},o))}for(const O in h)g[O]||h[O].required&&h[O].default===void 0&&o[O]===void 0&&z.push(new _t(t,o,`missing required property "${O}"`));return z}function rc(i){const t=i.value,o=i.valueSpec,h=i.style,g=i.styleSpec,b=i.key,E=i.arrayElementValidator||wo;if(Ji(t)!=="array")return[new _t(b,t,`array expected, ${Ji(t)} found`)];if(o.length&&t.length!==o.length)return[new _t(b,t,`array length ${o.length} expected, length ${t.length} found`)];if(o["min-length"]&&t.length<o["min-length"])return[new _t(b,t,`array length at least ${o["min-length"]} expected, length ${t.length} found`)];let z={type:o.value,values:o.values};g.$version<7&&(z.function=o.function),Ji(o.value)==="object"&&(z=o.value);let D=[];for(let O=0;O<t.length;O++)D=D.concat(E({array:t,arrayIndex:O,value:t[O],valueSpec:z,style:h,styleSpec:g,key:`${b}[${O}]`}));return D}function Rc(i){const t=i.key,o=i.value,h=i.valueSpec;let g=Ji(o);return g==="number"&&o!=o&&(g="NaN"),g!=="number"?[new _t(t,o,`number expected, ${g} found`)]:"minimum"in h&&o<h.minimum?[new _t(t,o,`${o} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&o>h.maximum?[new _t(t,o,`${o} is greater than the maximum value ${h.maximum}`)]:[]}function nc(i){const t=i.valueSpec,o=mr(i.value.type);let h,g,b,E={};const z=o!=="categorical"&&i.value.property===void 0,D=!z,O=Ji(i.value.stops)==="array"&&Ji(i.value.stops[0])==="array"&&Ji(i.value.stops[0][0])==="object",N=xo({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function($){if(o==="identity")return[new _t($.key,$.value,'identity function may not have a "stops" property')];let Q=[];const se=$.value;return Q=Q.concat(rc({key:$.key,value:se,valueSpec:$.valueSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:U})),Ji(se)==="array"&&se.length===0&&Q.push(new _t($.key,se,"array must have at least one stop")),Q},default:function($){return wo({key:$.key,value:$.value,valueSpec:t,style:$.style,styleSpec:$.styleSpec})}}});return o==="identity"&&z&&N.push(new _t(i.key,i.value,'missing required property "property"')),o==="identity"||i.value.stops||N.push(new _t(i.key,i.value,'missing required property "stops"')),o==="exponential"&&i.valueSpec.expression&&!Tu(i.valueSpec)&&N.push(new _t(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(D&&!is(i.valueSpec)?N.push(new _t(i.key,i.value,"property functions not supported")):z&&!ic(i.valueSpec)&&N.push(new _t(i.key,i.value,"zoom functions not supported"))),o!=="categorical"&&!O||i.value.property!==void 0||N.push(new _t(i.key,i.value,'"property" property is required')),N;function U($){let Q=[];const se=$.value,pe=$.key;if(Ji(se)!=="array")return[new _t(pe,se,`array expected, ${Ji(se)} found`)];if(se.length!==2)return[new _t(pe,se,`array length 2 expected, length ${se.length} found`)];if(O){if(Ji(se[0])!=="object")return[new _t(pe,se,`object expected, ${Ji(se[0])} found`)];if(se[0].zoom===void 0)return[new _t(pe,se,"object stop key must have zoom")];if(se[0].value===void 0)return[new _t(pe,se,"object stop key must have value")];if(b&&b>mr(se[0].zoom))return[new _t(pe,se[0].zoom,"stop zoom values must appear in ascending order")];mr(se[0].zoom)!==b&&(b=mr(se[0].zoom),g=void 0,E={}),Q=Q.concat(xo({key:`${pe}[0]`,value:se[0],valueSpec:{zoom:{}},style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:Rc,value:K}}))}else Q=Q.concat(K({key:`${pe}[0]`,value:se[0],valueSpec:{},style:$.style,styleSpec:$.styleSpec},se));return ja(Hn(se[1]))?Q.concat([new _t(`${pe}[1]`,se[1],"expressions are not allowed in function stops.")]):Q.concat(wo({key:`${pe}[1]`,value:se[1],valueSpec:t,style:$.style,styleSpec:$.styleSpec}))}function K($,Q){const se=Ji($.value),pe=mr($.value),Ae=$.value!==null?$.value:Q;if(h){if(se!==h)return[new _t($.key,Ae,`${se} stop domain type must match previous stop domain type ${h}`)]}else h=se;if(se!=="number"&&se!=="string"&&se!=="boolean")return[new _t($.key,Ae,"stop domain value must be a number, string, or boolean")];if(se!=="number"&&o!=="categorical"){let Be=`number expected, ${se} found`;return is(t)&&o===void 0&&(Be+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new _t($.key,Ae,Be)]}return o!=="categorical"||se!=="number"||isFinite(pe)&&Math.floor(pe)===pe?o!=="categorical"&&se==="number"&&g!==void 0&&pe<g?[new _t($.key,Ae,"stop domain values must appear in ascending order")]:(g=pe,o==="categorical"&&pe in E?[new _t($.key,Ae,"stop domain values must be unique")]:(E[pe]=!0,[])):[new _t($.key,Ae,`integer expected, found ${pe}`)]}}function ns(i){const t=(i.expressionContext==="property"?Vr:Va)(Hn(i.value),i.valueSpec);if(t.result==="error")return t.value.map(h=>new _t(`${i.key}${h.key}`,i.value,h.message));const o=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!o.outputDefined())return[new _t(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!xn(o))return[new _t(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!xn(o))return[new _t(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!jo(o,["zoom","feature-state"]))return[new _t(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!ma(o))return[new _t(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function os(i){const t=i.key,o=i.value,h=i.valueSpec,g=[];return Array.isArray(h.values)?h.values.indexOf(mr(o))===-1&&g.push(new _t(t,o,`expected one of [${h.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(h.values).indexOf(mr(o))===-1&&g.push(new _t(t,o,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(o)} found`)),g}function Xs(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!Xs(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Wl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Cs(i){if(i==null)return{filter:()=>!0,needGeometry:!1};Xs(i)||(i=qa(i));const t=Va(i,Wl);if(t.result==="error")throw new Error(t.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,h,g)=>t.value.evaluate(o,h,{},g),needGeometry:oc(i)}}function as(i,t){return i<t?-1:i>t?1:0}function oc(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let t=1;t<i.length;t++)if(oc(i[t]))return!0;return!1}function qa(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?na(i[1],i[2],"=="):t==="!="?Ks(na(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?na(i[1],i[2],t):t==="any"?(o=i.slice(1),["any"].concat(o.map(qa))):t==="all"?["all"].concat(i.slice(1).map(qa)):t==="none"?["all"].concat(i.slice(1).map(qa).map(Ks)):t==="in"?Xl(i[1],i.slice(2)):t==="!in"?Ks(Xl(i[1],i.slice(2))):t==="has"?Kl(i[1]):t==="!has"?Ks(Kl(i[1])):t!=="within"||i;var o}function na(i,t,o){switch(i){case"$type":return[`filter-type-${o}`,t];case"$id":return[`filter-id-${o}`,t];default:return[`filter-${o}`,i,t]}}function Xl(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(o=>typeof o!=typeof t[0])?["filter-in-large",i,["literal",t.sort(as)]]:["filter-in-small",i,["literal",t]]}}function Kl(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Ks(i){return["!",i]}function Ta(i){return Xs(Hn(i.value))?ns(pr({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):gl(i)}function gl(i){const t=i.value,o=i.key;if(Ji(t)!=="array")return[new _t(o,t,`array expected, ${Ji(t)} found`)];const h=i.styleSpec;let g,b=[];if(t.length<1)return[new _t(o,t,"filter array must have at least 1 element")];switch(b=b.concat(os({key:`${o}[0]`,value:t[0],valueSpec:h.filter_operator,style:i.style,styleSpec:i.styleSpec})),mr(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&mr(t[1])==="$type"&&b.push(new _t(o,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&b.push(new _t(o,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(g=Ji(t[1]),g!=="string"&&b.push(new _t(`${o}[1]`,t[1],`string expected, ${g} found`)));for(let E=2;E<t.length;E++)g=Ji(t[E]),mr(t[1])==="$type"?b=b.concat(os({key:`${o}[${E}]`,value:t[E],valueSpec:h.geometry_type,style:i.style,styleSpec:i.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&b.push(new _t(`${o}[${E}]`,t[E],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let E=1;E<t.length;E++)b=b.concat(gl({key:`${o}[${E}]`,value:t[E],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":g=Ji(t[1]),t.length!==2?b.push(new _t(o,t,`filter array for "${t[0]}" operator must have 2 elements`)):g!=="string"&&b.push(new _t(`${o}[1]`,t[1],`string expected, ${g} found`));break;case"within":g=Ji(t[1]),t.length!==2?b.push(new _t(o,t,`filter array for "${t[0]}" operator must have 2 elements`)):g!=="object"&&b.push(new _t(`${o}[1]`,t[1],`object expected, ${g} found`))}return b}function ks(i,t){const o=i.key,h=i.style,g=i.styleSpec,b=i.value,E=i.objectKey,z=g[`${t}_${i.layerType}`];if(!z)return[];const D=E.match(/^(.*)-transition$/);if(t==="paint"&&D&&z[D[1]]&&z[D[1]].transition)return wo({key:o,value:b,valueSpec:g.transition,style:h,styleSpec:g});const O=i.valueSpec||z[E];if(!O)return[new _t(o,b,`unknown property "${E}"`)];let N;if(Ji(b)==="string"&&is(O)&&!O.tokens&&(N=/^{([^}]+)}$/.exec(b)))return[new _t(o,b,`"${E}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(N[1])} }\`.`)];const U=[];return i.layerType==="symbol"&&(E==="text-field"&&h&&!h.glyphs&&U.push(new _t(o,b,'use of "text-field" requires a style "glyphs" property')),E==="text-font"&&ql(Hn(b))&&mr(b.type)==="identity"&&U.push(new _t(o,b,'"text-font" does not support identity functions'))),U.concat(wo({key:i.key,value:b,valueSpec:O,style:h,styleSpec:g,expressionContext:"property",propertyType:t,propertyKey:E}))}function ku(i){return ks(i,"paint")}function Jl(i){return ks(i,"layout")}function Bc(i){let t=[];const o=i.value,h=i.key,g=i.style,b=i.styleSpec;o.type||o.ref||t.push(new _t(h,o,'either "type" or "ref" is required'));let E=mr(o.type);const z=mr(o.ref);if(o.id){const D=mr(o.id);for(let O=0;O<i.arrayIndex;O++){const N=g.layers[O];mr(N.id)===D&&t.push(new _t(h,o.id,`duplicate layer id "${o.id}", previously used at line ${N.id.__line__}`))}}if("ref"in o){let D;["type","source","source-layer","filter","layout"].forEach(O=>{O in o&&t.push(new _t(h,o[O],`"${O}" is prohibited for ref layers`))}),g.layers.forEach(O=>{mr(O.id)===z&&(D=O)}),D?D.ref?t.push(new _t(h,o.ref,"ref cannot reference another ref layer")):E=mr(D.type):t.push(new _t(h,o.ref,`ref layer "${z}" not found`))}else if(E!=="background")if(o.source){const D=g.sources&&g.sources[o.source],O=D&&mr(D.type);D?O==="vector"&&E==="raster"?t.push(new _t(h,o.source,`layer "${o.id}" requires a raster source`)):O==="raster"&&E!=="raster"?t.push(new _t(h,o.source,`layer "${o.id}" requires a vector source`)):O!=="vector"||o["source-layer"]?O==="raster-dem"&&E!=="hillshade"?t.push(new _t(h,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!o.paint||!o.paint["line-gradient"]||O==="geojson"&&D.lineMetrics||t.push(new _t(h,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new _t(h,o,`layer "${o.id}" must specify a "source-layer"`)):t.push(new _t(h,o.source,`source "${o.source}" not found`))}else t.push(new _t(h,o,'missing required property "source"'));return t=t.concat(xo({key:h,value:o,valueSpec:b.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>wo({key:`${h}.type`,value:o.type,valueSpec:b.layer.type,style:i.style,styleSpec:i.styleSpec,object:o,objectKey:"type"}),filter:Ta,layout:D=>xo({layer:o,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":O=>Jl(pr({layerType:E},O))}}),paint:D=>xo({layer:o,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":O=>ku(pr({layerType:E},O))}})}})),t}function ss(i){const t=i.value,o=i.key,h=Ji(t);return h!=="string"?[new _t(o,t,`string expected, ${h} found`)]:[]}const zu={promoteId:function({key:i,value:t}){if(Ji(t)==="string")return ss({key:i,value:t});{const o=[];for(const h in t)o.push(...ss({key:`${i}.${h}`,value:t[h]}));return o}}};function _l(i){const t=i.value,o=i.key,h=i.styleSpec,g=i.style;if(!t.type)return[new _t(o,t,'"type" is required')];const b=mr(t.type);let E;switch(b){case"vector":case"raster":case"raster-dem":return E=xo({key:o,value:t,valueSpec:h[`source_${b.replace("-","_")}`],style:i.style,styleSpec:h,objectElementValidators:zu}),E;case"geojson":if(E=xo({key:o,value:t,valueSpec:h.source_geojson,style:g,styleSpec:h,objectElementValidators:zu}),t.cluster)for(const z in t.clusterProperties){const[D,O]=t.clusterProperties[z],N=typeof D=="string"?[D,["accumulated"],["get",z]]:D;E.push(...ns({key:`${o}.${z}.map`,value:O,expressionContext:"cluster-map"})),E.push(...ns({key:`${o}.${z}.reduce`,value:N,expressionContext:"cluster-reduce"}))}return E;case"video":return xo({key:o,value:t,valueSpec:h.source_video,style:g,styleSpec:h});case"image":return xo({key:o,value:t,valueSpec:h.source_image,style:g,styleSpec:h});case"canvas":return[new _t(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return os({key:`${o}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,styleSpec:h})}}function vl(i){const t=i.value,o=i.styleSpec,h=o.light,g=i.style;let b=[];const E=Ji(t);if(t===void 0)return b;if(E!=="object")return b=b.concat([new _t("light",t,`object expected, ${E} found`)]),b;for(const z in t){const D=z.match(/^(.*)-transition$/);b=b.concat(D&&h[D[1]]&&h[D[1]].transition?wo({key:z,value:t[z],valueSpec:o.transition,style:g,styleSpec:o}):h[z]?wo({key:z,value:t[z],valueSpec:h[z],style:g,styleSpec:o}):[new _t(z,t[z],`unknown property "${z}"`)])}return b}const bo={"*":()=>[],array:rc,boolean:function(i){const t=i.value,o=i.key,h=Ji(t);return h!=="boolean"?[new _t(o,t,`boolean expected, ${h} found`)]:[]},number:Rc,color:function(i){const t=i.key,o=i.value,h=Ji(o);return h!=="string"?[new _t(t,o,`color expected, ${h} found`)]:Ne(o)===null?[new _t(t,o,`color expected, "${o}" found`)]:[]},constants:bi,enum:os,filter:Ta,function:nc,layer:Bc,object:xo,source:_l,light:vl,string:ss,formatted:function(i){return ss(i).length===0?[]:ns(i)},resolvedImage:function(i){return ss(i).length===0?[]:ns(i)}};function wo(i){const t=i.value,o=i.valueSpec,h=i.styleSpec;return o.expression&&ql(mr(t))?nc(i):o.expression&&ja(Hn(t))?ns(i):o.type&&bo[o.type]?bo[o.type](i):xo(pr({},i,{valueSpec:o.type?h[o.type]:o}))}function ac(i){const t=i.value,o=i.key,h=ss(i);return h.length||(t.indexOf("{fontstack}")===-1&&h.push(new _t(o,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&h.push(new _t(o,t,'"glyphs" url must include a "{range}" token'))),h}function ls(i,t=Ue){let o=[];return o=o.concat(wo({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,objectElementValidators:{glyphs:ac,"*":()=>[]}})),i.constants&&(o=o.concat(bi({key:"constants",value:i.constants,style:i,styleSpec:t}))),xl(o)}function xl(i){return[].concat(i).sort((t,o)=>t.line-o.line)}function Js(i){return function(...t){return xl(i.apply(this,t))}}ls.source=Js(_l),ls.light=Js(vl),ls.layer=Js(Bc),ls.filter=Js(Ta),ls.paintProperty=Js(ku),ls.layoutProperty=Js(Jl);const oa=ls,nn=oa.light,bl=oa.paintProperty,Ys=oa.layoutProperty;function us(i,t){let o=!1;if(t&&t.length)for(const h of t)i.fire(new Zn(new Error(h.message))),o=!0;return o}class Qi{constructor(t,o,h){const g=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const E=new Int32Array(this.arrayBuffer);t=E[0],this.d=(o=E[1])+2*(h=E[2]);for(let D=0;D<this.d*this.d;D++){const O=E[3+D],N=E[3+D+1];g.push(O===N?null:E.subarray(O,N))}const z=E[3+g.length+1];this.keys=E.subarray(E[3+g.length],z),this.bboxes=E.subarray(z),this.insert=this._insertReadonly}else{this.d=o+2*h;for(let E=0;E<this.d*this.d;E++)g.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=t,this.padding=h,this.scale=o/t,this.uid=0;const b=h/o*t;this.min=-b,this.max=t+b}insert(t,o,h,g,b){this._forEachCell(o,h,g,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,o,h,g,b,E){this.cells[b].push(E)}query(t,o,h,g,b){const E=this.min,z=this.max;if(t<=E&&o<=E&&z<=h&&z<=g&&!b)return Array.prototype.slice.call(this.keys);{const D=[];return this._forEachCell(t,o,h,g,this._queryCell,D,{},b),D}}_queryCell(t,o,h,g,b,E,z,D){const O=this.cells[b];if(O!==null){const N=this.keys,U=this.bboxes;for(let K=0;K<O.length;K++){const $=O[K];if(z[$]===void 0){const Q=4*$;(D?D(U[Q+0],U[Q+1],U[Q+2],U[Q+3]):t<=U[Q+2]&&o<=U[Q+3]&&h>=U[Q+0]&&g>=U[Q+1])?(z[$]=!0,E.push(N[$])):z[$]=!1}}}}_forEachCell(t,o,h,g,b,E,z,D){const O=this._convertToCellCoord(t),N=this._convertToCellCoord(o),U=this._convertToCellCoord(h),K=this._convertToCellCoord(g);for(let $=O;$<=U;$++)for(let Q=N;Q<=K;Q++){const se=this.d*Q+$;if((!D||D(this._convertFromCellCoord($),this._convertFromCellCoord(Q),this._convertFromCellCoord($+1),this._convertFromCellCoord(Q+1)))&&b.call(this,t,o,h,g,se,E,z,D))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,o=3+this.cells.length+1+1;let h=0;for(let E=0;E<this.cells.length;E++)h+=this.cells[E].length;const g=new Int32Array(o+h+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let b=o;for(let E=0;E<t.length;E++){const z=t[E];g[3+E]=b,g.set(z,b),b+=z.length}return g[3+t.length]=b,g.set(this.keys,b),b+=this.keys.length,g[3+t.length+1]=b,g.set(this.bboxes,b),b+=this.bboxes.length,g.buffer}static serialize(t,o){const h=t.toArrayBuffer();return o&&o.push(h),{buffer:h}}static deserialize(t){return new Qi(t.buffer)}}const kr={};function Jt(i,t,o={}){Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),kr[i]={klass:t,omit:o.omit||[],shallow:o.shallow||[]}}Jt("Object",Object),Jt("TransferableGridIndex",Qi),Jt("Color",W),Jt("Error",Error),Jt("AJAXError",rt),Jt("ResolvedImage",fe),Jt("StylePropertyFunction",rs),Jt("StyleExpression",Au,{omit:["_evaluator"]}),Jt("ZoomDependentExpression",As),Jt("ZoomConstantExpression",Hl),Jt("CompoundExpression",Kt,{omit:["_evaluate"]});for(const i in ya)ya[i]._classRegistryKey||Jt(`Expression_${i}`,ya[i]);function $s(i){return i&&typeof ArrayBuffer!="undefined"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Ga(i,t){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob)return i;if($s(i)||Qt(i))return t&&t.push(i),i;if(ArrayBuffer.isView(i)){const o=i;return t&&t.push(o.buffer),o}if(i instanceof ImageData)return t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const o=[];for(const h of i)o.push(Ga(h,t));return o}if(typeof i=="object"){const o=i.constructor,h=o._classRegistryKey;if(!h)throw new Error("can't serialize object of unregistered class");const g=o.serialize?o.serialize(i,t):{};if(!o.serialize){for(const b in i){if(!i.hasOwnProperty(b)||kr[h].omit.indexOf(b)>=0)continue;const E=i[b];g[b]=kr[h].shallow.indexOf(b)>=0?E:Ga(E,t)}i instanceof Error&&(g.message=i.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(g.$name=h),g}throw new Error("can't serialize object of type "+typeof i)}function Aa(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||$s(i)||Qt(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(Aa);if(typeof i=="object"){const t=i.$name||"Object";if(!kr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:o}=kr[t];if(!o)throw new Error(`can't deserialize unregistered class ${t}`);if(o.deserialize)return o.deserialize(i);const h=Object.create(o.prototype);for(const g of Object.keys(i)){if(g==="$name")continue;const b=i[g];h[g]=kr[t].shallow.indexOf(g)>=0?b:Aa(b)}return h}throw new Error("can't deserialize object of type "+typeof i)}class Yl{constructor(){this.first=!0}update(t,o){const h=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=o),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=h,!0))}}const ii={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Qs(i){for(const t of i)if(ln(t.charCodeAt(0)))return!0;return!1}function wl(i){for(const t of i)if(!cs(t.charCodeAt(0)))return!1;return!0}function cs(i){return!(ii.Arabic(i)||ii["Arabic Supplement"](i)||ii["Arabic Extended-A"](i)||ii["Arabic Presentation Forms-A"](i)||ii["Arabic Presentation Forms-B"](i))}function ln(i){return!(i!==746&&i!==747&&(i<4352||!(ii["Bopomofo Extended"](i)||ii.Bopomofo(i)||ii["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||ii["CJK Compatibility Ideographs"](i)||ii["CJK Compatibility"](i)||ii["CJK Radicals Supplement"](i)||ii["CJK Strokes"](i)||!(!ii["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||ii["CJK Unified Ideographs Extension A"](i)||ii["CJK Unified Ideographs"](i)||ii["Enclosed CJK Letters and Months"](i)||ii["Hangul Compatibility Jamo"](i)||ii["Hangul Jamo Extended-A"](i)||ii["Hangul Jamo Extended-B"](i)||ii["Hangul Jamo"](i)||ii["Hangul Syllables"](i)||ii.Hiragana(i)||ii["Ideographic Description Characters"](i)||ii.Kanbun(i)||ii["Kangxi Radicals"](i)||ii["Katakana Phonetic Extensions"](i)||ii.Katakana(i)&&i!==12540||!(!ii["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!ii["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||ii["Unified Canadian Aboriginal Syllabics"](i)||ii["Unified Canadian Aboriginal Syllabics Extended"](i)||ii["Vertical Forms"](i)||ii["Yijing Hexagram Symbols"](i)||ii["Yi Syllables"](i)||ii["Yi Radicals"](i))))}function El(i){return!(ln(i)||function(t){return!!(ii["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||ii["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||ii["Letterlike Symbols"](t)||ii["Number Forms"](t)||ii["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||ii["Control Pictures"](t)&&t!==9251||ii["Optical Character Recognition"](t)||ii["Enclosed Alphanumerics"](t)||ii["Geometric Shapes"](t)||ii["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||ii["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||ii["CJK Symbols and Punctuation"](t)||ii.Katakana(t)||ii["Private Use Area"](t)||ii["CJK Compatibility Forms"](t)||ii["Small Form Variants"](t)||ii["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}function sc(i){return i>=1424&&i<=2303||ii["Arabic Presentation Forms-A"](i)||ii["Arabic Presentation Forms-B"](i)}function Tn(i,t){return!(!t&&sc(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||ii.Khmer(i))}function ni(i){for(const t of i)if(sc(t.charCodeAt(0)))return!0;return!1}const fo="deferred",Il="loading",zs="loaded";let aa=null,on="unavailable",Za=null;const Vt=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(on="error"),aa&&aa(i)};function $l(){hs.fire(new _o("pluginStateChange",{pluginStatus:on,pluginURL:Za}))}const hs=new Ra,Ql=function(){return on},Ro=function(){if(on!==fo||!Za)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");on=Il,$l(),Za&&no({url:Za},i=>{i?Vt(i):(on=zs,$l())})},un={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>on===zs||un.applyArabicShaping!=null,isLoading:()=>on===Il,setState(i){on=i.pluginStatus,Za=i.pluginURL},isParsed:()=>un.applyArabicShaping!=null&&un.processBidirectionalText!=null&&un.processStyledBidirectionalText!=null,getPluginURL:()=>Za};class Yr{constructor(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Yl,this.transition={})}isSupportedScript(t){return function(o,h){for(const g of o)if(!Tn(g.charCodeAt(0),h))return!1;return!0}(t,un.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,o=t-Math.floor(t),h=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*o}}}class el{constructor(t,o){this.property=t,this.value=o,this.expression=function(h,g){if(ql(h))return new rs(h,g);if(ja(h)){const b=Vr(h,g);if(b.result==="error")throw new Error(b.value.map(E=>`${E.key}: ${E.message}`).join(", "));return b.value}{let b=h;return typeof h=="string"&&g.type==="color"&&(b=W.parse(h)),{kind:"constant",evaluate:()=>b}}}(o===void 0?t.specification.default:o,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,o,h){return this.property.possiblyEvaluate(this,t,o,h)}}class mo{constructor(t){this.property=t,this.value=new el(t,void 0)}transitioned(t,o){return new lc(this.property,this.value,o,ke({},t.transition,this.transition),t.now)}untransitioned(){return new lc(this.property,this.value,null,{},0)}}class Ca{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Ze(this._values[t].value.value)}setValue(t,o){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new mo(this._values[t].property)),this._values[t].value=new el(this._values[t].property,o===null?void 0:Ze(o))}getTransition(t){return Ze(this._values[t].transition)}setTransition(t,o){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new mo(this._values[t].property)),this._values[t].transition=Ze(o)||void 0}serialize(){const t={};for(const o of Object.keys(this._values)){const h=this.getValue(o);h!==void 0&&(t[o]=h);const g=this.getTransition(o);g!==void 0&&(t[`${o}-transition`]=g)}return t}transitioned(t,o){const h=new Sl(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].transitioned(t,o._values[g]);return h}untransitioned(){const t=new Sl(this._properties);for(const o of Object.keys(this._values))t._values[o]=this._values[o].untransitioned();return t}}class lc{constructor(t,o,h,g,b){this.property=t,this.value=o,this.begin=b+g.delay||0,this.end=this.begin+g.duration||0,t.specification.transition&&(g.delay||g.duration)&&(this.prior=h)}possiblyEvaluate(t,o,h){const g=t.now||0,b=this.value.possiblyEvaluate(t,o,h),E=this.prior;if(E){if(g>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(g<this.begin)return E.possiblyEvaluate(t,o,h);{const z=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(t,o,h),b,function(D){if(D<=0)return 0;if(D>=1)return 1;const O=D*D,N=O*D;return 4*(D<.5?N:3*(D-O)+N-.75)}(z))}}return b}}class Sl{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,o,h){const g=new qo(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(t,o,h);return g}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class uc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return Ze(this._values[t].value)}setValue(t,o){this._values[t]=new el(this._values[t].property,o===null?void 0:Ze(o))}serialize(){const t={};for(const o of Object.keys(this._values)){const h=this.getValue(o);h!==void 0&&(t[o]=h)}return t}possiblyEvaluate(t,o,h){const g=new qo(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(t,o,h);return g}}class ga{constructor(t,o,h){this.property=t,this.value=o,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,o,h,g){return this.property.evaluate(this.value,this.parameters,t,o,h,g)}}class qo{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class ai{constructor(t){this.specification=t}possiblyEvaluate(t,o){return t.expression.evaluate(o)}interpolate(t,o,h){const g=dl[this.specification.type];return g?g(t,o,h):t}}class Ut{constructor(t,o){this.specification=t,this.overrides=o}possiblyEvaluate(t,o,h,g){return new ga(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(o,null,{},h,g)}:t.expression,o)}interpolate(t,o,h){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new ga(this,{kind:"constant",value:void 0},t.parameters);const g=dl[this.specification.type];return g?new ga(this,{kind:"constant",value:g(t.value.value,o.value.value,h)},t.parameters):t}evaluate(t,o,h,g,b,E){return t.kind==="constant"?t.value:t.evaluate(o,h,g,b,E)}}class Go extends Ut{possiblyEvaluate(t,o,h,g){if(t.value===void 0)return new ga(this,{kind:"constant",value:void 0},o);if(t.expression.kind==="constant"){const b=t.expression.evaluate(o,null,{},h,g),E=t.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,z=this._calculate(E,E,E,o);return new ga(this,{kind:"constant",value:z},o)}if(t.expression.kind==="camera"){const b=this._calculate(t.expression.evaluate({zoom:o.zoom-1}),t.expression.evaluate({zoom:o.zoom}),t.expression.evaluate({zoom:o.zoom+1}),o);return new ga(this,{kind:"constant",value:b},o)}return new ga(this,t.expression,o)}evaluate(t,o,h,g,b,E){if(t.kind==="source"){const z=t.evaluate(o,h,g,b,E);return this._calculate(z,z,z,o)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(o.zoom)-1},h,g),t.evaluate({zoom:Math.floor(o.zoom)},h,g),t.evaluate({zoom:Math.floor(o.zoom)+1},h,g),o):t.value}_calculate(t,o,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:h,to:o}}interpolate(t){return t}}class Eo{constructor(t){this.specification=t}possiblyEvaluate(t,o,h,g){if(t.value!==void 0){if(t.expression.kind==="constant"){const b=t.expression.evaluate(o,null,{},h,g);return this._calculate(b,b,b,o)}return this._calculate(t.expression.evaluate(new Yr(Math.floor(o.zoom-1),o)),t.expression.evaluate(new Yr(Math.floor(o.zoom),o)),t.expression.evaluate(new Yr(Math.floor(o.zoom+1),o)),o)}}_calculate(t,o,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:h,to:o}}interpolate(t){return t}}class Nn{constructor(t){this.specification=t}possiblyEvaluate(t,o,h,g){return!!t.expression.evaluate(o,null,{},h,g)}interpolate(){return!1}}class cn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in t){const h=t[o];h.specification.overridable&&this.overridableProperties.push(o);const g=this.defaultPropertyValues[o]=new el(h,void 0),b=this.defaultTransitionablePropertyValues[o]=new mo(h);this.defaultTransitioningPropertyValues[o]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=g.possiblyEvaluate({})}}}Jt("DataDrivenProperty",Ut),Jt("DataConstantProperty",ai),Jt("CrossFadedDataDrivenProperty",Go),Jt("CrossFadedProperty",Eo),Jt("ColorRampProperty",Nn);const Zo="-transition";class mn extends Ra{constructor(t,o){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),o.layout&&(this._unevaluatedLayout=new uc(o.layout)),o.paint)){this._transitionablePaint=new Ca(o.paint);for(const h in t.paint)this.setPaintProperty(h,t.paint[h],{validate:!1});for(const h in t.layout)this.setLayoutProperty(h,t.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new qo(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,o,h={}){o!=null&&this._validate(Ys,`layers.${this.id}.layout.${t}`,t,o,h)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,o):this.visibility=o)}getPaintProperty(t){return t.endsWith(Zo)?this._transitionablePaint.getTransition(t.slice(0,-Zo.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,o,h={}){if(o!=null&&this._validate(bl,`layers.${this.id}.paint.${t}`,t,o,h))return!1;if(t.endsWith(Zo))return this._transitionablePaint.setTransition(t.slice(0,-Zo.length),o||void 0),!1;{const g=this._transitionablePaint._values[t],b=g.property.specification["property-type"]==="cross-faded-data-driven",E=g.value.isDataDriven(),z=g.value;this._transitionablePaint.setValue(t,o),this._handleSpecialPaintPropertyUpdate(t);const D=this._transitionablePaint._values[t].value;return D.isDataDriven()||E||b||this._handleOverridablePaintPropertyUpdate(t,z,D)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,o,h){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,o){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,o)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Ge(t,(o,h)=>!(o===void 0||h==="layout"&&!Object.keys(o).length||h==="paint"&&!Object.keys(o).length))}_validate(t,o,h,g,b={}){return(!b||b.validate!==!1)&&us(this,t.call(oa,{key:o,layerType:this.type,objectKey:h,value:g,styleSpec:Ue,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const o=this.paint.get(t);if(o instanceof ga&&is(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const Io={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ps{constructor(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Gt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,o){return t._trim(),o&&(t.isTransferred=!0,o.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function qt(i,t=1){let o=0,h=0;return{members:i.map(g=>{const b=Io[g.type].BYTES_PER_ELEMENT,E=o=eu(o,Math.max(t,b)),z=g.components||1;return h=Math.max(h,b),o+=b*z,{name:g.name,type:g.type,components:z,offset:E}}),size:eu(o,Math.max(h,t)),alignment:t}}function eu(i,t){return Math.ceil(i/t)*t}class Mn extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,o)}emplace(t,o,h){const g=2*t;return this.int16[g+0]=o,this.int16[g+1]=h,t}}Mn.prototype.bytesPerElement=4,Jt("StructArrayLayout2i4",Mn);class Bo extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,h,g)}emplace(t,o,h,g,b){const E=4*t;return this.int16[E+0]=o,this.int16[E+1]=h,this.int16[E+2]=g,this.int16[E+3]=b,t}}Bo.prototype.bytesPerElement=8,Jt("StructArrayLayout4i8",Bo);class S extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h,g,b,E){const z=this.length;return this.resize(z+1),this.emplace(z,t,o,h,g,b,E)}emplace(t,o,h,g,b,E,z){const D=6*t;return this.int16[D+0]=o,this.int16[D+1]=h,this.int16[D+2]=g,this.int16[D+3]=b,this.int16[D+4]=E,this.int16[D+5]=z,t}}S.prototype.bytesPerElement=12,Jt("StructArrayLayout2i4i12",S);class n extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h,g,b,E){const z=this.length;return this.resize(z+1),this.emplace(z,t,o,h,g,b,E)}emplace(t,o,h,g,b,E,z){const D=4*t,O=8*t;return this.int16[D+0]=o,this.int16[D+1]=h,this.uint8[O+4]=g,this.uint8[O+5]=b,this.uint8[O+6]=E,this.uint8[O+7]=z,t}}n.prototype.bytesPerElement=8,Jt("StructArrayLayout2i4ub8",n);class y extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,o)}emplace(t,o,h){const g=2*t;return this.float32[g+0]=o,this.float32[g+1]=h,t}}y.prototype.bytesPerElement=8,Jt("StructArrayLayout2f8",y);class I extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,h,g,b,E,z,D,O,N){const U=this.length;return this.resize(U+1),this.emplace(U,t,o,h,g,b,E,z,D,O,N)}emplace(t,o,h,g,b,E,z,D,O,N,U){const K=10*t;return this.uint16[K+0]=o,this.uint16[K+1]=h,this.uint16[K+2]=g,this.uint16[K+3]=b,this.uint16[K+4]=E,this.uint16[K+5]=z,this.uint16[K+6]=D,this.uint16[K+7]=O,this.uint16[K+8]=N,this.uint16[K+9]=U,t}}I.prototype.bytesPerElement=20,Jt("StructArrayLayout10ui20",I);class A extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,h,g,b,E,z,D,O,N,U,K){const $=this.length;return this.resize($+1),this.emplace($,t,o,h,g,b,E,z,D,O,N,U,K)}emplace(t,o,h,g,b,E,z,D,O,N,U,K,$){const Q=12*t;return this.int16[Q+0]=o,this.int16[Q+1]=h,this.int16[Q+2]=g,this.int16[Q+3]=b,this.uint16[Q+4]=E,this.uint16[Q+5]=z,this.uint16[Q+6]=D,this.uint16[Q+7]=O,this.int16[Q+8]=N,this.int16[Q+9]=U,this.int16[Q+10]=K,this.int16[Q+11]=$,t}}A.prototype.bytesPerElement=24,Jt("StructArrayLayout4i4ui4i24",A);class M extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,h)}emplace(t,o,h,g){const b=3*t;return this.float32[b+0]=o,this.float32[b+1]=h,this.float32[b+2]=g,t}}M.prototype.bytesPerElement=12,Jt("StructArrayLayout3f12",M);class F extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint32[1*t+0]=o,t}}F.prototype.bytesPerElement=4,Jt("StructArrayLayout1ul4",F);class Z extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,h,g,b,E,z,D,O){const N=this.length;return this.resize(N+1),this.emplace(N,t,o,h,g,b,E,z,D,O)}emplace(t,o,h,g,b,E,z,D,O,N){const U=10*t,K=5*t;return this.int16[U+0]=o,this.int16[U+1]=h,this.int16[U+2]=g,this.int16[U+3]=b,this.int16[U+4]=E,this.int16[U+5]=z,this.uint32[K+3]=D,this.uint16[U+8]=O,this.uint16[U+9]=N,t}}Z.prototype.bytesPerElement=20,Jt("StructArrayLayout6i1ul2ui20",Z);class J extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h,g,b,E){const z=this.length;return this.resize(z+1),this.emplace(z,t,o,h,g,b,E)}emplace(t,o,h,g,b,E,z){const D=6*t;return this.int16[D+0]=o,this.int16[D+1]=h,this.int16[D+2]=g,this.int16[D+3]=b,this.int16[D+4]=E,this.int16[D+5]=z,t}}J.prototype.bytesPerElement=12,Jt("StructArrayLayout2i2i2i12",J);class ee extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h,g,b){const E=this.length;return this.resize(E+1),this.emplace(E,t,o,h,g,b)}emplace(t,o,h,g,b,E){const z=4*t,D=8*t;return this.float32[z+0]=o,this.float32[z+1]=h,this.float32[z+2]=g,this.int16[D+6]=b,this.int16[D+7]=E,t}}ee.prototype.bytesPerElement=16,Jt("StructArrayLayout2f1f2i16",ee);class re extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,h,g)}emplace(t,o,h,g,b){const E=12*t,z=3*t;return this.uint8[E+0]=o,this.uint8[E+1]=h,this.float32[z+1]=g,this.float32[z+2]=b,t}}re.prototype.bytesPerElement=12,Jt("StructArrayLayout2ub2f12",re);class ue extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,h)}emplace(t,o,h,g){const b=3*t;return this.uint16[b+0]=o,this.uint16[b+1]=h,this.uint16[b+2]=g,t}}ue.prototype.bytesPerElement=6,Jt("StructArrayLayout3ui6",ue);class ve extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,g,b,E,z,D,O,N,U,K,$,Q,se,pe,Ae){const Be=this.length;return this.resize(Be+1),this.emplace(Be,t,o,h,g,b,E,z,D,O,N,U,K,$,Q,se,pe,Ae)}emplace(t,o,h,g,b,E,z,D,O,N,U,K,$,Q,se,pe,Ae,Be){const je=24*t,Ve=12*t,it=48*t;return this.int16[je+0]=o,this.int16[je+1]=h,this.uint16[je+2]=g,this.uint16[je+3]=b,this.uint32[Ve+2]=E,this.uint32[Ve+3]=z,this.uint32[Ve+4]=D,this.uint16[je+10]=O,this.uint16[je+11]=N,this.uint16[je+12]=U,this.float32[Ve+7]=K,this.float32[Ve+8]=$,this.uint8[it+36]=Q,this.uint8[it+37]=se,this.uint8[it+38]=pe,this.uint32[Ve+10]=Ae,this.int16[je+22]=Be,t}}ve.prototype.bytesPerElement=48,Jt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ve);class Re extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,g,b,E,z,D,O,N,U,K,$,Q,se,pe,Ae,Be,je,Ve,it,He,Ct,Tt,ut,St,yt,kt){const dt=this.length;return this.resize(dt+1),this.emplace(dt,t,o,h,g,b,E,z,D,O,N,U,K,$,Q,se,pe,Ae,Be,je,Ve,it,He,Ct,Tt,ut,St,yt,kt)}emplace(t,o,h,g,b,E,z,D,O,N,U,K,$,Q,se,pe,Ae,Be,je,Ve,it,He,Ct,Tt,ut,St,yt,kt,dt){const vt=34*t,ti=17*t;return this.int16[vt+0]=o,this.int16[vt+1]=h,this.int16[vt+2]=g,this.int16[vt+3]=b,this.int16[vt+4]=E,this.int16[vt+5]=z,this.int16[vt+6]=D,this.int16[vt+7]=O,this.uint16[vt+8]=N,this.uint16[vt+9]=U,this.uint16[vt+10]=K,this.uint16[vt+11]=$,this.uint16[vt+12]=Q,this.uint16[vt+13]=se,this.uint16[vt+14]=pe,this.uint16[vt+15]=Ae,this.uint16[vt+16]=Be,this.uint16[vt+17]=je,this.uint16[vt+18]=Ve,this.uint16[vt+19]=it,this.uint16[vt+20]=He,this.uint16[vt+21]=Ct,this.uint16[vt+22]=Tt,this.uint32[ti+12]=ut,this.float32[ti+13]=St,this.float32[ti+14]=yt,this.float32[ti+15]=kt,this.float32[ti+16]=dt,t}}Re.prototype.bytesPerElement=68,Jt("StructArrayLayout8i15ui1ul4f68",Re);class be extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.float32[1*t+0]=o,t}}be.prototype.bytesPerElement=4,Jt("StructArrayLayout1f4",be);class De extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,h)}emplace(t,o,h,g){const b=3*t;return this.int16[b+0]=o,this.int16[b+1]=h,this.int16[b+2]=g,t}}De.prototype.bytesPerElement=6,Jt("StructArrayLayout3i6",De);class Je extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,h)}emplace(t,o,h,g){const b=4*t;return this.uint32[2*t+0]=o,this.uint16[b+2]=h,this.uint16[b+3]=g,t}}Je.prototype.bytesPerElement=8,Jt("StructArrayLayout1ul2ui8",Je);class Xe extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o){const h=this.length;return this.resize(h+1),this.emplace(h,t,o)}emplace(t,o,h){const g=2*t;return this.uint16[g+0]=o,this.uint16[g+1]=h,t}}Xe.prototype.bytesPerElement=4,Jt("StructArrayLayout2ui4",Xe);class nt extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint16[1*t+0]=o,t}}nt.prototype.bytesPerElement=2,Jt("StructArrayLayout1ui2",nt);class $e extends Gt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,h,g)}emplace(t,o,h,g,b){const E=4*t;return this.float32[E+0]=o,this.float32[E+1]=h,this.float32[E+2]=g,this.float32[E+3]=b,t}}$e.prototype.bytesPerElement=16,Jt("StructArrayLayout4f16",$e);class xt extends ps{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new bt(this.anchorPointX,this.anchorPointY)}}xt.prototype.size=20;class ht extends Z{get(t){return new xt(this,t)}}Jt("CollisionBoxArray",ht);class mt extends ps{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}mt.prototype.size=48;class Pt extends ve{get(t){return new mt(this,t)}}Jt("PlacedSymbolArray",Pt);class Ot extends ps{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Ot.prototype.size=68;class wt extends Re{get(t){return new Ot(this,t)}}Jt("SymbolInstanceArray",wt);class ci extends be{getoffsetX(t){return this.float32[1*t+0]}}Jt("GlyphOffsetArray",ci);class ei extends De{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Jt("SymbolLineVertexArray",ei);class Oi extends ps{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Oi.prototype.size=8;class u extends Je{get(t){return new Oi(this,t)}}Jt("FeatureIndexArray",u);class m extends Mn{}class p extends Mn{}class v extends S{}class k extends n{}class L extends y{}class B extends I{}class j extends A{}class Y extends M{}class ie extends F{}class he extends J{}class de extends re{}class me extends ue{}class Ce extends Xe{}const Te=qt([{name:"a_pos",components:2,type:"Int16"}],4),{members:Le}=Te;class xe{constructor(t=[]){this.segments=t}prepareSegment(t,o,h,g){let b=this.segments[this.segments.length-1];return t>xe.MAX_VERTEX_ARRAY_LENGTH&&ct(`Max vertices per segment is ${xe.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!b||b.vertexLength+t>xe.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==g)&&(b={vertexOffset:o.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},g!==void 0&&(b.sortKey=g),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const t of this.segments)for(const o in t.vaos)t.vaos[o].destroy()}static simpleSegment(t,o,h,g){return new xe([{vertexOffset:t,primitiveOffset:o,vertexLength:h,primitiveLength:g,vaos:{},sortKey:0}])}}function ze(i,t){return 256*(i=X(Math.floor(i),0,255))+X(Math.floor(t),0,255)}xe.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Jt("SegmentVector",xe);const Fe=qt([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ye={exports:{}},ot={exports:{}};ot.exports=function(i,t){var o,h,g,b,E,z,D,O;for(h=i.length-(o=3&i.length),g=t,E=3432918353,z=461845907,O=0;O<h;)D=255&i.charCodeAt(O)|(255&i.charCodeAt(++O))<<8|(255&i.charCodeAt(++O))<<16|(255&i.charCodeAt(++O))<<24,++O,g=27492+(65535&(b=5*(65535&(g=(g^=D=(65535&(D=(D=(65535&D)*E+(((D>>>16)*E&65535)<<16)&4294967295)<<15|D>>>17))*z+(((D>>>16)*z&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(D=0,o){case 3:D^=(255&i.charCodeAt(O+2))<<16;case 2:D^=(255&i.charCodeAt(O+1))<<8;case 1:g^=D=(65535&(D=(D=(65535&(D^=255&i.charCodeAt(O)))*E+(((D>>>16)*E&65535)<<16)&4294967295)<<15|D>>>17))*z+(((D>>>16)*z&65535)<<16)&4294967295}return g^=i.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var at={exports:{}};at.exports=function(i,t){for(var o,h=i.length,g=t^h,b=0;h>=4;)o=1540483477*(65535&(o=255&i.charCodeAt(b)|(255&i.charCodeAt(++b))<<8|(255&i.charCodeAt(++b))<<16|(255&i.charCodeAt(++b))<<24))+((1540483477*(o>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),h-=4,++b;switch(h){case 3:g^=(255&i.charCodeAt(b+2))<<16;case 2:g^=(255&i.charCodeAt(b+1))<<8;case 1:g=1540483477*(65535&(g^=255&i.charCodeAt(b)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var st=ot.exports,It=at.exports;Ye.exports=st,Ye.exports.murmur3=st,Ye.exports.murmur2=It;var Lt=Ye.exports;class Mt{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,o,h,g){this.ids.push(Yt(t)),this.positions.push(o,h,g)}getPositions(t){const o=Yt(t);let h=0,g=this.ids.length-1;for(;h<g;){const E=h+g>>1;this.ids[E]>=o?g=E:h=E+1}const b=[];for(;this.ids[h]===o;)b.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return b}static serialize(t,o){const h=new Float64Array(t.ids),g=new Uint32Array(t.positions);return di(h,g,0,h.length-1),o&&o.push(h.buffer,g.buffer),{ids:h,positions:g}}static deserialize(t){const o=new Mt;return o.ids=t.ids,o.positions=t.positions,o.indexed=!0,o}}function Yt(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Lt(String(i))}function di(i,t,o,h){for(;o<h;){const g=i[o+h>>1];let b=o-1,E=h+1;for(;;){do b++;while(i[b]<g);do E--;while(i[E]>g);if(b>=E)break;_i(i,b,E),_i(t,3*b,3*E),_i(t,3*b+1,3*E+1),_i(t,3*b+2,3*E+2)}E-o<h-E?(di(i,t,o,E),o=E+1):(di(i,t,E+1,h),h=E)}}function _i(i,t,o){const h=i[t];i[t]=i[o],i[o]=h}Jt("FeaturePositionMap",Mt);class hi{constructor(t,o){this.gl=t.gl,this.location=o}}class ar extends hi{constructor(t,o){super(t,o),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class ri extends hi{constructor(t,o){super(t,o),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Di extends hi{constructor(t,o){super(t,o),this.current=W.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const er=new Float32Array(16);function zi(i){return[ze(255*i.r,255*i.g),ze(255*i.b,255*i.a)]}class Ai{constructor(t,o,h){this.value=t,this.uniformNames=o.map(g=>`u_${g}`),this.type=h}setUniform(t,o,h){t.set(h.constantOr(this.value))}getBinding(t,o,h){return this.type==="color"?new Di(t,o):new ar(t,o)}}class ji{constructor(t,o){this.uniformNames=o.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=t.tlbr}setUniform(t,o,h,g){const b=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&t.set(b)}getBinding(t,o,h){return h.substr(0,9)==="u_pattern"?new ri(t,o):new ar(t,o)}}class wi{constructor(t,o,h,g){this.expression=t,this.type=h,this.maxValue=0,this.paintVertexAttributes=o.map(b=>({name:`a_${b}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,o,h,g,b){const E=this.paintVertexArray.length,z=this.expression.evaluate(new Yr(0),o,{},g,[],b);this.paintVertexArray.resize(t),this._setPaintValue(E,t,z)}updatePaintArray(t,o,h,g){const b=this.expression.evaluate({zoom:0},h,g);this._setPaintValue(t,o,b)}_setPaintValue(t,o,h){if(this.type==="color"){const g=zi(h);for(let b=t;b<o;b++)this.paintVertexArray.emplace(b,g[0],g[1])}else{for(let g=t;g<o;g++)this.paintVertexArray.emplace(g,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class gi{constructor(t,o,h,g,b,E){this.expression=t,this.uniformNames=o.map(z=>`u_${z}_t`),this.type=h,this.useIntegerZoom=g,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=o.map(z=>({name:`a_${z}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(t,o,h,g,b){const E=this.expression.evaluate(new Yr(this.zoom),o,{},g,[],b),z=this.expression.evaluate(new Yr(this.zoom+1),o,{},g,[],b),D=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(D,t,E,z)}updatePaintArray(t,o,h,g){const b=this.expression.evaluate({zoom:this.zoom},h,g),E=this.expression.evaluate({zoom:this.zoom+1},h,g);this._setPaintValue(t,o,b,E)}_setPaintValue(t,o,h,g){if(this.type==="color"){const b=zi(h),E=zi(g);for(let z=t;z<o;z++)this.paintVertexArray.emplace(z,b[0],b[1],E[0],E[1])}else{for(let b=t;b<o;b++)this.paintVertexArray.emplace(b,h,g);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(g))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,o){const h=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,g=X(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);t.set(g)}getBinding(t,o,h){return new ar(t,o)}}class hn{constructor(t,o,h,g,b,E){this.expression=t,this.type=o,this.useIntegerZoom=h,this.zoom=g,this.layerId=E,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(t,o,h){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(g,t,o.patterns&&o.patterns[this.layerId],h)}updatePaintArray(t,o,h,g,b){this._setPaintValues(t,o,h.patterns&&h.patterns[this.layerId],b)}_setPaintValues(t,o,h,g){if(!g||!h)return;const{min:b,mid:E,max:z}=h,D=g[b],O=g[E],N=g[z];if(D&&O&&N)for(let U=t;U<o;U++)this.zoomInPaintVertexArray.emplace(U,O.tl[0],O.tl[1],O.br[0],O.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],O.pixelRatio,D.pixelRatio),this.zoomOutPaintVertexArray.emplace(U,O.tl[0],O.tl[1],O.br[0],O.br[1],N.tl[0],N.tl[1],N.br[0],N.br[1],O.pixelRatio,N.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Fe.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Fe.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class En{constructor(t,o,h){this.binders={},this._buffers=[];const g=[];for(const b in t.paint._values){if(!h(b))continue;const E=t.paint.get(b);if(!(E instanceof ga&&is(E.property.specification)))continue;const z=yo(b,t.type),D=E.value,O=E.property.specification.type,N=E.property.useIntegerZoom,U=E.property.specification["property-type"],K=U==="cross-faded"||U==="cross-faded-data-driven";if(D.kind==="constant")this.binders[b]=K?new ji(D.value,z):new Ai(D.value,z,O),g.push(`/u_${b}`);else if(D.kind==="source"||K){const $=yn(b,O,"source");this.binders[b]=K?new hn(D,O,N,o,$,t.id):new wi(D,z,O,$),g.push(`/a_${b}`)}else{const $=yn(b,O,"composite");this.binders[b]=new gi(D,z,O,N,o,$),g.push(`/z_${b}`)}}this.cacheKey=g.sort().join("")}getMaxValue(t){const o=this.binders[t];return o instanceof wi||o instanceof gi?o.maxValue:0}populatePaintArrays(t,o,h,g,b){for(const E in this.binders){const z=this.binders[E];(z instanceof wi||z instanceof gi||z instanceof hn)&&z.populatePaintArray(t,o,h,g,b)}}setConstantPatternPositions(t,o){for(const h in this.binders){const g=this.binders[h];g instanceof ji&&g.setConstantPatternPositions(t,o)}}updatePaintArrays(t,o,h,g,b){let E=!1;for(const z in t){const D=o.getPositions(z);for(const O of D){const N=h.feature(O.index);for(const U in this.binders){const K=this.binders[U];if((K instanceof wi||K instanceof gi||K instanceof hn)&&K.expression.isStateDependent===!0){const $=g.paint.get(U);K.expression=$.value,K.updatePaintArray(O.start,O.end,N,t[z],b),E=!0}}}}return E}defines(){const t=[];for(const o in this.binders){const h=this.binders[o];(h instanceof Ai||h instanceof ji)&&t.push(...h.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return t}getBinderAttributes(){const t=[];for(const o in this.binders){const h=this.binders[o];if(h instanceof wi||h instanceof gi)for(let g=0;g<h.paintVertexAttributes.length;g++)t.push(h.paintVertexAttributes[g].name);else if(h instanceof hn)for(let g=0;g<Fe.members.length;g++)t.push(Fe.members[g].name)}return t}getBinderUniforms(){const t=[];for(const o in this.binders){const h=this.binders[o];if(h instanceof Ai||h instanceof ji||h instanceof gi)for(const g of h.uniformNames)t.push(g)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,o){const h=[];for(const g in this.binders){const b=this.binders[g];if(b instanceof Ai||b instanceof ji||b instanceof gi){for(const E of b.uniformNames)if(o[E]){const z=b.getBinding(t,o[E],E);h.push({name:E,property:g,binding:z})}}}return h}setUniforms(t,o,h,g){for(const{name:b,property:E,binding:z}of o)this.binders[E].setUniform(z,g,h.get(E),b)}updatePaintBuffers(t){this._buffers=[];for(const o in this.binders){const h=this.binders[o];if(t&&h instanceof hn){const g=t.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(h instanceof wi||h instanceof gi)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(t){for(const o in this.binders){const h=this.binders[o];(h instanceof wi||h instanceof gi||h instanceof hn)&&h.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const o=this.binders[t];(o instanceof wi||o instanceof gi||o instanceof hn)&&o.destroy()}}}class Ln{constructor(t,o,h=()=>!0){this.programConfigurations={};for(const g of t)this.programConfigurations[g.id]=new En(g,o,h);this.needsUpload=!1,this._featureMap=new Mt,this._bufferOffset=0}populatePaintArrays(t,o,h,g,b,E){for(const z in this.programConfigurations)this.programConfigurations[z].populatePaintArrays(t,o,g,b,E);o.id!==void 0&&this._featureMap.add(o.id,h,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,o,h,g){for(const b of h)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(t,this._featureMap,o,b,g)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function yo(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function yn(i,t,o){const h={color:{source:y,composite:$e},number:{source:be,composite:y}},g=function(b){return{"line-pattern":{source:B,composite:B},"fill-pattern":{source:B,composite:B},"fill-extrusion-pattern":{source:B,composite:B}}[b]}(i);return g&&g[o]||h[t][o]}Jt("ConstantBinder",Ai),Jt("CrossFadedConstantBinder",ji),Jt("SourceExpressionBinder",wi),Jt("CrossFadedCompositeBinder",hn),Jt("CompositeExpressionBinder",gi),Jt("ProgramConfiguration",En,{omit:["_buffers"]}),Jt("ProgramConfigurationSet",Ln);var lr=8192;const Ho=Math.pow(2,14)-1,Oo=-Ho-1;function _a(i){const t=lr/i.extent,o=i.loadGeometry();for(let h=0;h<o.length;h++){const g=o[h];for(let b=0;b<g.length;b++){const E=g[b],z=Math.round(E.x*t),D=Math.round(E.y*t);E.x=X(z,Oo,Ho),E.y=X(D,Oo,Ho),(z<E.x||z>E.x+1||D<E.y||D>E.y+1)&&ct("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Jn(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?_a(i):[]}}function va(i,t,o,h,g){i.emplaceBack(2*t+(h+1)/2,2*o+(g+1)/2)}class xa{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new m,this.indexArray=new me,this.segments=new xe,this.programConfigurations=new Ln(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,h){const g=this.layers[0],b=[];let E=null,z=!1;g.type==="circle"&&(E=g.layout.get("circle-sort-key"),z=!E.isConstant());for(const{feature:D,id:O,index:N,sourceLayerIndex:U}of t){const K=this.layers[0]._featureFilter.needGeometry,$=Jn(D,K);if(!this.layers[0]._featureFilter.filter(new Yr(this.zoom),$,h))continue;const Q=z?E.evaluate($,{},h):void 0,se={id:O,properties:D.properties,type:D.type,sourceLayerIndex:U,index:N,geometry:K?$.geometry:_a(D),patterns:{},sortKey:Q};b.push(se)}z&&b.sort((D,O)=>D.sortKey-O.sortKey);for(const D of b){const{geometry:O,index:N,sourceLayerIndex:U}=D,K=t[N].feature;this.addFeature(D,O,N,h),o.featureIndex.insert(K,O,N,U,this.index)}}update(t,o,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Le),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,h,g){for(const b of o)for(const E of b){const z=E.x,D=E.y;if(z<0||z>=lr||D<0||D>=lr)continue;const O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),N=O.vertexLength;va(this.layoutVertexArray,z,D,-1,-1),va(this.layoutVertexArray,z,D,1,-1),va(this.layoutVertexArray,z,D,1,1),va(this.layoutVertexArray,z,D,-1,1),this.indexArray.emplaceBack(N,N+1,N+2),this.indexArray.emplaceBack(N,N+3,N+2),O.vertexLength+=4,O.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,{},g)}}function Pu(i,t){for(let o=0;o<i.length;o++)if(ba(t,i[o]))return!0;for(let o=0;o<t.length;o++)if(ba(i,t[o]))return!0;return!!tu(i,t)}function Mu(i,t,o){return!!ba(i,t)||!!iu(t,i,o)}function tl(i,t){if(i.length===1)return Yn(t,i[0]);for(let o=0;o<t.length;o++){const h=t[o];for(let g=0;g<h.length;g++)if(ba(i,h[g]))return!0}for(let o=0;o<i.length;o++)if(Yn(t,i[o]))return!0;for(let o=0;o<t.length;o++)if(tu(i,t[o]))return!0;return!1}function Lu(i,t,o){if(i.length>1){if(tu(i,t))return!0;for(let h=0;h<t.length;h++)if(iu(t[h],i,o))return!0}for(let h=0;h<i.length;h++)if(iu(i[h],t,o))return!0;return!1}function tu(i,t){if(i.length===0||t.length===0)return!1;for(let o=0;o<i.length-1;o++){const h=i[o],g=i[o+1];for(let b=0;b<t.length-1;b++)if(Ps(h,g,t[b],t[b+1]))return!0}return!1}function Ps(i,t,o,h){return pt(i,o,h)!==pt(t,o,h)&&pt(i,t,o)!==pt(i,t,h)}function iu(i,t,o){const h=o*o;if(t.length===1)return i.distSqr(t[0])<h;for(let g=1;g<t.length;g++)if(ds(i,t[g-1],t[g])<h)return!0;return!1}function ds(i,t,o){const h=t.distSqr(o);if(h===0)return i.distSqr(t);const g=((i.x-t.x)*(o.x-t.x)+(i.y-t.y)*(o.y-t.y))/h;return i.distSqr(g<0?t:g>1?o:o.sub(t)._mult(g)._add(t))}function Yn(i,t){let o,h,g,b=!1;for(let E=0;E<i.length;E++){o=i[E];for(let z=0,D=o.length-1;z<o.length;D=z++)h=o[z],g=o[D],h.y>t.y!=g.y>t.y&&t.x<(g.x-h.x)*(t.y-h.y)/(g.y-h.y)+h.x&&(b=!b)}return b}function ba(i,t){let o=!1;for(let h=0,g=i.length-1;h<i.length;g=h++){const b=i[h],E=i[g];b.y>t.y!=E.y>t.y&&t.x<(E.x-b.x)*(t.y-b.y)/(E.y-b.y)+b.x&&(o=!o)}return o}function Tl(i,t,o){const h=o[0],g=o[2];if(i.x<h.x&&t.x<h.x||i.x>g.x&&t.x>g.x||i.y<h.y&&t.y<h.y||i.y>g.y&&t.y>g.y)return!1;const b=pt(i,t,o[0]);return b!==pt(i,t,o[1])||b!==pt(i,t,o[2])||b!==pt(i,t,o[3])}function fs(i,t,o){const h=t.paint.get(i).value;return h.kind==="constant"?h.value:o.programConfigurations.get(t.id).getMaxValue(i)}function gr(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Wo(i,t,o,h,g){if(!t[0]&&!t[1])return i;const b=bt.convert(t)._mult(g);o==="viewport"&&b._rotate(-h);const E=[];for(let z=0;z<i.length;z++)E.push(i[z].sub(b));return E}Jt("CircleBucket",xa,{omit:["layers"]});const sa=new cn({"circle-sort-key":new Ut(Ue.layout_circle["circle-sort-key"])});var ru={paint:new cn({"circle-radius":new Ut(Ue.paint_circle["circle-radius"]),"circle-color":new Ut(Ue.paint_circle["circle-color"]),"circle-blur":new Ut(Ue.paint_circle["circle-blur"]),"circle-opacity":new Ut(Ue.paint_circle["circle-opacity"]),"circle-translate":new ai(Ue.paint_circle["circle-translate"]),"circle-translate-anchor":new ai(Ue.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ai(Ue.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ai(Ue.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ut(Ue.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ut(Ue.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ut(Ue.paint_circle["circle-stroke-opacity"])}),layout:sa},Du=typeof Float32Array!="undefined"?Float32Array:Array;function Ru(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function tp(i,t,o){var h=t[0],g=t[1],b=t[2],E=t[3],z=t[4],D=t[5],O=t[6],N=t[7],U=t[8],K=t[9],$=t[10],Q=t[11],se=t[12],pe=t[13],Ae=t[14],Be=t[15],je=o[0],Ve=o[1],it=o[2],He=o[3];return i[0]=je*h+Ve*z+it*U+He*se,i[1]=je*g+Ve*D+it*K+He*pe,i[2]=je*b+Ve*O+it*$+He*Ae,i[3]=je*E+Ve*N+it*Q+He*Be,i[4]=(je=o[4])*h+(Ve=o[5])*z+(it=o[6])*U+(He=o[7])*se,i[5]=je*g+Ve*D+it*K+He*pe,i[6]=je*b+Ve*O+it*$+He*Ae,i[7]=je*E+Ve*N+it*Q+He*Be,i[8]=(je=o[8])*h+(Ve=o[9])*z+(it=o[10])*U+(He=o[11])*se,i[9]=je*g+Ve*D+it*K+He*pe,i[10]=je*b+Ve*O+it*$+He*Ae,i[11]=je*E+Ve*N+it*Q+He*Be,i[12]=(je=o[12])*h+(Ve=o[13])*z+(it=o[14])*U+(He=o[15])*se,i[13]=je*g+Ve*D+it*K+He*pe,i[14]=je*b+Ve*O+it*$+He*Ae,i[15]=je*E+Ve*N+it*Q+He*Be,i}Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});var il,ip=tp;function rl(i,t,o){var h=t[0],g=t[1],b=t[2],E=t[3];return i[0]=o[0]*h+o[4]*g+o[8]*b+o[12]*E,i[1]=o[1]*h+o[5]*g+o[9]*b+o[13]*E,i[2]=o[2]*h+o[6]*g+o[10]*b+o[14]*E,i[3]=o[3]*h+o[7]*g+o[11]*b+o[15]*E,i}function cc(i,t){const o=rl([],[i.x,i.y,0,1],t);return new bt(o[0]/o[3],o[1]/o[3])}il=new Du(4),Du!=Float32Array&&(il[0]=0,il[1]=0,il[2]=0,il[3]=0);class rp extends xa{}Jt("HeatmapBucket",rp,{omit:["layers"]});var hc={paint:new cn({"heatmap-radius":new Ut(Ue.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ut(Ue.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ai(Ue.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Nn(Ue.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ai(Ue.paint_heatmap["heatmap-opacity"])})};function Xo(i,{width:t,height:o},h,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==t*o*h)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${t*o*h}`)}else g=new Uint8Array(t*o*h);return i.width=t,i.height=o,i.data=g,i}function Gd(i,{width:t,height:o},h){if(t===i.width&&o===i.height)return;const g=Xo({},{width:t,height:o},h);np(i,g,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,o)},h),i.width=t,i.height=o,i.data=g.data}function np(i,t,o,h,g,b){if(g.width===0||g.height===0)return t;if(g.width>i.width||g.height>i.height||o.x>i.width-g.width||o.y>i.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>t.width||g.height>t.height||h.x>t.width-g.width||h.y>t.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const E=i.data,z=t.data;for(let D=0;D<g.height;D++){const O=((o.y+D)*i.width+o.x)*b,N=((h.y+D)*t.width+h.x)*b;for(let U=0;U<g.width*b;U++)z[N+U]=E[O+U]}return t}class _h{constructor(t,o){Xo(this,t,1,o)}resize(t){Gd(this,t,1)}clone(){return new _h({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,h,g,b){np(t,o,h,g,b,1)}}class ms{constructor(t,o){Xo(this,t,4,o)}resize(t){Gd(this,t,4)}replace(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ms({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,h,g,b){np(t,o,h,g,b,4)}}function Zd(i){const t={},o=i.resolution||256,h=i.clips?i.clips.length:1,g=i.image||new ms({width:o,height:h}),b=(E,z,D)=>{t[i.evaluationKey]=D;const O=i.expression.evaluate(t);g.data[E+z+0]=Math.floor(255*O.r/O.a),g.data[E+z+1]=Math.floor(255*O.g/O.a),g.data[E+z+2]=Math.floor(255*O.b/O.a),g.data[E+z+3]=Math.floor(255*O.a)};if(i.clips)for(let E=0,z=0;E<h;++E,z+=4*o)for(let D=0,O=0;D<o;D++,O+=4){const N=D/(o-1),{start:U,end:K}=i.clips[E];b(z,O,U*(1-N)+K*N)}else for(let E=0,z=0;E<o;E++,z+=4)b(0,z,E/(o-1));return g}Jt("AlphaImage",_h),Jt("RGBAImage",ms);var _m={paint:new cn({"hillshade-illumination-direction":new ai(Ue.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ai(Ue.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ai(Ue.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ai(Ue.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ai(Ue.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ai(Ue.paint_hillshade["hillshade-accent-color"])})};const Hp=qt([{name:"a_pos",components:2,type:"Int16"}],4),{members:vm}=Hp;var Oc={exports:{}};function vh(i,t,o){o=o||2;var h,g,b,E,z,D,O,N=t&&t.length,U=N?t[0]*o:i.length,K=nu(i,0,U,o,!0),$=[];if(!K||K.next===K.prev)return $;if(N&&(K=function(se,pe,Ae,Be){var je,Ve,it,He=[];for(je=0,Ve=pe.length;je<Ve;je++)(it=nu(se,pe[je]*Be,je<Ve-1?pe[je+1]*Be:se.length,Be,!1))===it.next&&(it.steiner=!0),He.push(Fc(it));for(He.sort(Im),je=0;je<He.length;je++)Ae=Ms(Ae=Sm(He[je],Ae),Ae.next);return Ae}(i,t,K,o)),i.length>80*o){h=b=i[0],g=E=i[1];for(var Q=o;Q<U;Q+=o)(z=i[Q])<h&&(h=z),(D=i[Q+1])<g&&(g=D),z>b&&(b=z),D>E&&(E=D);O=(O=Math.max(b-h,E-g))!==0?1/O:0}return xh(K,$,o,h,g,O),$}function nu(i,t,o,h,g){var b,E;if(g===Jp(i,t,o,h)>0)for(b=t;b<o;b+=h)E=jc(b,i[b],i[b+1],E);else for(b=o-h;b>=t;b-=h)E=jc(b,i[b],i[b+1],E);return E&&bh(E,E.next)&&(dc(E),E=E.next),E}function Ms(i,t){if(!i)return i;t||(t=i);var o,h=i;do if(o=!1,h.steiner||!bh(h,h.next)&&An(h.prev,h,h.next)!==0)h=h.next;else{if(dc(h),(h=t=h.prev)===h.next)break;o=!0}while(o||h!==t);return t}function xh(i,t,o,h,g,b,E){if(i){!E&&b&&function(N,U,K,$){var Q=N;do Q.z===null&&(Q.z=Xp(Q.x,Q.y,U,K,$)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==N);Q.prevZ.nextZ=null,Q.prevZ=null,function(se){var pe,Ae,Be,je,Ve,it,He,Ct,Tt=1;do{for(Ae=se,se=null,Ve=null,it=0;Ae;){for(it++,Be=Ae,He=0,pe=0;pe<Tt&&(He++,Be=Be.nextZ);pe++);for(Ct=Tt;He>0||Ct>0&&Be;)He!==0&&(Ct===0||!Be||Ae.z<=Be.z)?(je=Ae,Ae=Ae.nextZ,He--):(je=Be,Be=Be.nextZ,Ct--),Ve?Ve.nextZ=je:se=je,je.prevZ=Ve,Ve=je;Ae=Be}Ve.nextZ=null,Tt*=2}while(it>1)}(Q)}(i,h,g,b);for(var z,D,O=i;i.prev!==i.next;)if(z=i.prev,D=i.next,b?bm(i,h,g,b):xm(i))t.push(z.i/o),t.push(i.i/o),t.push(D.i/o),dc(i),i=D.next,O=D.next;else if((i=D)===O){E?E===1?xh(i=wm(Ms(i),t,o),t,o,h,g,b,2):E===2&&Em(i,t,o,h,g,b):xh(Ms(i),t,o,h,g,b,1);break}}}function xm(i){var t=i.prev,o=i,h=i.next;if(An(t,o,h)>=0)return!1;for(var g=i.next.next;g!==i.prev;){if(Uc(t.x,t.y,o.x,o.y,h.x,h.y,g.x,g.y)&&An(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function bm(i,t,o,h){var g=i.prev,b=i,E=i.next;if(An(g,b,E)>=0)return!1;for(var z=g.x>b.x?g.x>E.x?g.x:E.x:b.x>E.x?b.x:E.x,D=g.y>b.y?g.y>E.y?g.y:E.y:b.y>E.y?b.y:E.y,O=Xp(g.x<b.x?g.x<E.x?g.x:E.x:b.x<E.x?b.x:E.x,g.y<b.y?g.y<E.y?g.y:E.y:b.y<E.y?b.y:E.y,t,o,h),N=Xp(z,D,t,o,h),U=i.prevZ,K=i.nextZ;U&&U.z>=O&&K&&K.z<=N;){if(U!==i.prev&&U!==i.next&&Uc(g.x,g.y,b.x,b.y,E.x,E.y,U.x,U.y)&&An(U.prev,U,U.next)>=0||(U=U.prevZ,K!==i.prev&&K!==i.next&&Uc(g.x,g.y,b.x,b.y,E.x,E.y,K.x,K.y)&&An(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;U&&U.z>=O;){if(U!==i.prev&&U!==i.next&&Uc(g.x,g.y,b.x,b.y,E.x,E.y,U.x,U.y)&&An(U.prev,U,U.next)>=0)return!1;U=U.prevZ}for(;K&&K.z<=N;){if(K!==i.prev&&K!==i.next&&Uc(g.x,g.y,b.x,b.y,E.x,E.y,K.x,K.y)&&An(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function wm(i,t,o){var h=i;do{var g=h.prev,b=h.next.next;!bh(g,b)&&wh(g,h,h.next,b)&&Nc(g,b)&&Nc(b,g)&&(t.push(g.i/o),t.push(h.i/o),t.push(b.i/o),dc(h),dc(h.next),h=i=b),h=h.next}while(h!==i);return Ms(h)}function Em(i,t,o,h,g,b){var E=i;do{for(var z=E.next.next;z!==E.prev;){if(E.i!==z.i&&$n(E,z)){var D=Kp(E,z);return E=Ms(E,E.next),D=Ms(D,D.next),xh(E,t,o,h,g,b),void xh(D,t,o,h,g,b)}z=z.next}E=E.next}while(E!==i)}function Im(i,t){return i.x-t.x}function Sm(i,t){var o=function(b,E){var z,D=E,O=b.x,N=b.y,U=-1/0;do{if(N<=D.y&&N>=D.next.y&&D.next.y!==D.y){var K=D.x+(N-D.y)*(D.next.x-D.x)/(D.next.y-D.y);if(K<=O&&K>U){if(U=K,K===O){if(N===D.y)return D;if(N===D.next.y)return D.next}z=D.x<D.next.x?D:D.next}}D=D.next}while(D!==E);if(!z)return null;if(O===U)return z;var $,Q=z,se=z.x,pe=z.y,Ae=1/0;D=z;do O>=D.x&&D.x>=se&&O!==D.x&&Uc(N<pe?O:U,N,se,pe,N<pe?U:O,N,D.x,D.y)&&($=Math.abs(N-D.y)/(O-D.x),Nc(D,b)&&($<Ae||$===Ae&&(D.x>z.x||D.x===z.x&&Wp(z,D)))&&(z=D,Ae=$)),D=D.next;while(D!==Q);return z}(i,t);if(!o)return t;var h=Kp(o,i),g=Ms(o,o.next);return Ms(h,h.next),t===o?g:t}function Wp(i,t){return An(i.prev,i,t.prev)<0&&An(t.next,i,i.next)<0}function Xp(i,t,o,h,g){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-o)*g)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-h)*g)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Fc(i){var t=i,o=i;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==i);return o}function Uc(i,t,o,h,g,b,E,z){return(g-E)*(t-z)-(i-E)*(b-z)>=0&&(i-E)*(h-z)-(o-E)*(t-z)>=0&&(o-E)*(b-z)-(g-E)*(h-z)>=0}function $n(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(o,h){var g=o;do{if(g.i!==o.i&&g.next.i!==o.i&&g.i!==h.i&&g.next.i!==h.i&&wh(g,g.next,o,h))return!0;g=g.next}while(g!==o);return!1}(i,t)&&(Nc(i,t)&&Nc(t,i)&&function(o,h){var g=o,b=!1,E=(o.x+h.x)/2,z=(o.y+h.y)/2;do g.y>z!=g.next.y>z&&g.next.y!==g.y&&E<(g.next.x-g.x)*(z-g.y)/(g.next.y-g.y)+g.x&&(b=!b),g=g.next;while(g!==o);return b}(i,t)&&(An(i.prev,i,t.prev)||An(i,t.prev,t))||bh(i,t)&&An(i.prev,i,i.next)>0&&An(t.prev,t,t.next)>0)}function An(i,t,o){return(t.y-i.y)*(o.x-t.x)-(t.x-i.x)*(o.y-t.y)}function bh(i,t){return i.x===t.x&&i.y===t.y}function wh(i,t,o,h){var g=Bu(An(i,t,o)),b=Bu(An(i,t,h)),E=Bu(An(o,h,i)),z=Bu(An(o,h,t));return g!==b&&E!==z||!(g!==0||!pc(i,o,t))||!(b!==0||!pc(i,h,t))||!(E!==0||!pc(o,i,h))||!(z!==0||!pc(o,t,h))}function pc(i,t,o){return t.x<=Math.max(i.x,o.x)&&t.x>=Math.min(i.x,o.x)&&t.y<=Math.max(i.y,o.y)&&t.y>=Math.min(i.y,o.y)}function Bu(i){return i>0?1:i<0?-1:0}function Nc(i,t){return An(i.prev,i,i.next)<0?An(i,t,i.next)>=0&&An(i,i.prev,t)>=0:An(i,t,i.prev)<0||An(i,i.next,t)<0}function Kp(i,t){var o=new Eh(i.i,i.x,i.y),h=new Eh(t.i,t.x,t.y),g=i.next,b=t.prev;return i.next=t,t.prev=i,o.next=g,g.prev=o,h.next=o,o.prev=h,b.next=h,h.prev=b,h}function jc(i,t,o,h){var g=new Eh(i,t,o);return h?(g.next=h.next,g.prev=h,h.next.prev=g,h.next=g):(g.prev=g,g.next=g),g}function dc(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Eh(i,t,o){this.i=i,this.x=t,this.y=o,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Jp(i,t,o,h){for(var g=0,b=t,E=o-h;b<o;b+=h)g+=(i[E]-i[b])*(i[b+1]+i[E+1]),E=b;return g}Oc.exports=vh,Oc.exports.default=vh,vh.deviation=function(i,t,o,h){var g=t&&t.length,b=Math.abs(Jp(i,0,g?t[0]*o:i.length,o));if(g)for(var E=0,z=t.length;E<z;E++)b-=Math.abs(Jp(i,t[E]*o,E<z-1?t[E+1]*o:i.length,o));var D=0;for(E=0;E<h.length;E+=3){var O=h[E]*o,N=h[E+1]*o,U=h[E+2]*o;D+=Math.abs((i[O]-i[U])*(i[N+1]-i[O+1])-(i[O]-i[N])*(i[U+1]-i[O+1]))}return b===0&&D===0?0:Math.abs((D-b)/b)},vh.flatten=function(i){for(var t=i[0][0].length,o={vertices:[],holes:[],dimensions:t},h=0,g=0;g<i.length;g++){for(var b=0;b<i[g].length;b++)for(var E=0;E<t;E++)o.vertices.push(i[g][b][E]);g>0&&o.holes.push(h+=i[g-1].length)}return o};var Vc=Oc.exports;function Tm(i,t,o,h,g){op(i,t,o||0,h||i.length-1,g||Yp)}function op(i,t,o,h,g){for(;h>o;){if(h-o>600){var b=h-o+1,E=t-o+1,z=Math.log(b),D=.5*Math.exp(2*z/3),O=.5*Math.sqrt(z*D*(b-D)/b)*(E-b/2<0?-1:1);op(i,t,Math.max(o,Math.floor(t-E*D/b+O)),Math.min(h,Math.floor(t+(b-E)*D/b+O)),g)}var N=i[t],U=o,K=h;for(Ih(i,o,t),g(i[h],N)>0&&Ih(i,o,h);U<K;){for(Ih(i,U,K),U++,K--;g(i[U],N)<0;)U++;for(;g(i[K],N)>0;)K--}g(i[o],N)===0?Ih(i,o,K):Ih(i,++K,h),K<=t&&(o=K+1),t<=K&&(h=K-1)}}function Ih(i,t,o){var h=i[t];i[t]=i[o],i[o]=h}function Yp(i,t){return i<t?-1:i>t?1:0}function Sh(i,t){const o=i.length;if(o<=1)return[i];const h=[];let g,b;for(let E=0;E<o;E++){const z=lt(i[E]);z!==0&&(i[E].area=Math.abs(z),b===void 0&&(b=z<0),b===z<0?(g&&h.push(g),g=[i[E]]):g.push(i[E]))}if(g&&h.push(g),t>1)for(let E=0;E<h.length;E++)h[E].length<=t||(Tm(h[E],t,1,h[E].length-1,nl),h[E]=h[E].slice(0,t));return h}function nl(i,t){return t.area-i.area}function $p(i,t,o){const h=o.patternDependencies;let g=!1;for(const b of t){const E=b.paint.get(`${i}-pattern`);E.isConstant()||(g=!0);const z=E.constantOr(null);z&&(g=!0,h[z.to]=!0,h[z.from]=!0)}return g}function Qp(i,t,o,h,g){const b=g.patternDependencies;for(const E of t){const z=E.paint.get(`${i}-pattern`).value;if(z.kind!=="constant"){let D=z.evaluate({zoom:h-1},o,{},g.availableImages),O=z.evaluate({zoom:h},o,{},g.availableImages),N=z.evaluate({zoom:h+1},o,{},g.availableImages);D=D&&D.name?D.name:D,O=O&&O.name?O.name:O,N=N&&N.name?N.name:N,b[D]=!0,b[O]=!0,b[N]=!0,o.patterns[E.id]={min:D,mid:O,max:N}}}return o}class ed{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new p,this.indexArray=new me,this.indexArray2=new Ce,this.programConfigurations=new Ln(t.layers,t.zoom),this.segments=new xe,this.segments2=new xe,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,h){this.hasPattern=$p("fill",this.layers,o);const g=this.layers[0].layout.get("fill-sort-key"),b=!g.isConstant(),E=[];for(const{feature:z,id:D,index:O,sourceLayerIndex:N}of t){const U=this.layers[0]._featureFilter.needGeometry,K=Jn(z,U);if(!this.layers[0]._featureFilter.filter(new Yr(this.zoom),K,h))continue;const $=b?g.evaluate(K,{},h,o.availableImages):void 0,Q={id:D,properties:z.properties,type:z.type,sourceLayerIndex:N,index:O,geometry:U?K.geometry:_a(z),patterns:{},sortKey:$};E.push(Q)}b&&E.sort((z,D)=>z.sortKey-D.sortKey);for(const z of E){const{geometry:D,index:O,sourceLayerIndex:N}=z;if(this.hasPattern){const U=Qp("fill",this.layers,z,this.zoom,o);this.patternFeatures.push(U)}else this.addFeature(z,D,O,h,{});o.featureIndex.insert(t[O].feature,D,O,N,this.index)}}update(t,o,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,h)}addFeatures(t,o,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,o,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,vm),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,o,h,g,b){for(const E of Sh(o,500)){let z=0;for(const $ of E)z+=$.length;const D=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray),O=D.vertexLength,N=[],U=[];for(const $ of E){if($.length===0)continue;$!==E[0]&&U.push(N.length/2);const Q=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),se=Q.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(se+$.length-1,se),N.push($[0].x),N.push($[0].y);for(let pe=1;pe<$.length;pe++)this.layoutVertexArray.emplaceBack($[pe].x,$[pe].y),this.indexArray2.emplaceBack(se+pe-1,se+pe),N.push($[pe].x),N.push($[pe].y);Q.vertexLength+=$.length,Q.primitiveLength+=$.length}const K=Vc(N,U);for(let $=0;$<K.length;$+=3)this.indexArray.emplaceBack(O+K[$],O+K[$+1],O+K[$+2]);D.vertexLength+=z,D.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,b,g)}}Jt("FillBucket",ed,{omit:["layers","patternFeatures"]});const Am=new cn({"fill-sort-key":new Ut(Ue.layout_fill["fill-sort-key"])});var Hd={paint:new cn({"fill-antialias":new ai(Ue.paint_fill["fill-antialias"]),"fill-opacity":new Ut(Ue.paint_fill["fill-opacity"]),"fill-color":new Ut(Ue.paint_fill["fill-color"]),"fill-outline-color":new Ut(Ue.paint_fill["fill-outline-color"]),"fill-translate":new ai(Ue.paint_fill["fill-translate"]),"fill-translate-anchor":new ai(Ue.paint_fill["fill-translate-anchor"]),"fill-pattern":new Go(Ue.paint_fill["fill-pattern"])}),layout:Am};const qc=qt([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),{members:Cm}=qc;var Ou={},Wd=bt,td=Gc;function Gc(i,t,o,h,g){this.properties={},this.extent=o,this.type=0,this._pbf=i,this._geometry=-1,this._keys=h,this._values=g,i.readFields(km,this,t)}function km(i,t,o){i==1?t.id=o.readVarint():i==2?function(h,g){for(var b=h.readVarint()+h.pos;h.pos<b;){var E=g._keys[h.readVarint()],z=g._values[h.readVarint()];g.properties[E]=z}}(o,t):i==3?t.type=o.readVarint():i==4&&(t._geometry=o.pos)}function Zc(i){for(var t,o,h=0,g=0,b=i.length,E=b-1;g<b;E=g++)h+=((o=i[E]).x-(t=i[g]).x)*(t.y+o.y);return h}Gc.types=["Unknown","Point","LineString","Polygon"],Gc.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t,o=i.readVarint()+i.pos,h=1,g=0,b=0,E=0,z=[];i.pos<o;){if(g<=0){var D=i.readVarint();h=7&D,g=D>>3}if(g--,h===1||h===2)b+=i.readSVarint(),E+=i.readSVarint(),h===1&&(t&&z.push(t),t=[]),t.push(new Wd(b,E));else{if(h!==7)throw new Error("unknown command "+h);t&&t.push(t[0].clone())}}return t&&z.push(t),z},Gc.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,o=1,h=0,g=0,b=0,E=1/0,z=-1/0,D=1/0,O=-1/0;i.pos<t;){if(h<=0){var N=i.readVarint();o=7&N,h=N>>3}if(h--,o===1||o===2)(g+=i.readSVarint())<E&&(E=g),g>z&&(z=g),(b+=i.readSVarint())<D&&(D=b),b>O&&(O=b);else if(o!==7)throw new Error("unknown command "+o)}return[E,D,z,O]},Gc.prototype.toGeoJSON=function(i,t,o){var h,g,b=this.extent*Math.pow(2,o),E=this.extent*i,z=this.extent*t,D=this.loadGeometry(),O=Gc.types[this.type];function N($){for(var Q=0;Q<$.length;Q++){var se=$[Q];$[Q]=[360*(se.x+E)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(se.y+z)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var U=[];for(h=0;h<D.length;h++)U[h]=D[h][0];N(D=U);break;case 2:for(h=0;h<D.length;h++)N(D[h]);break;case 3:for(D=function($){var Q=$.length;if(Q<=1)return[$];for(var se,pe,Ae=[],Be=0;Be<Q;Be++){var je=Zc($[Be]);je!==0&&(pe===void 0&&(pe=je<0),pe===je<0?(se&&Ae.push(se),se=[$[Be]]):se.push($[Be]))}return se&&Ae.push(se),Ae}(D),h=0;h<D.length;h++)for(g=0;g<D[h].length;g++)N(D[h][g])}D.length===1?D=D[0]:O="Multi"+O;var K={type:"Feature",geometry:{type:O,coordinates:D},properties:this.properties};return"id"in this&&(K.id=this.id),K};var zm=td,ap=Hc;function Hc(i,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(ol,this,t),this.length=this._features.length}function ol(i,t,o){i===15?t.version=o.readVarint():i===1?t.name=o.readString():i===5?t.extent=o.readVarint():i===2?t._features.push(o.pos):i===3?t._keys.push(o.readString()):i===4&&t._values.push(function(h){for(var g=null,b=h.readVarint()+h.pos;h.pos<b;){var E=h.readVarint()>>3;g=E===1?h.readString():E===2?h.readFloat():E===3?h.readDouble():E===4?h.readVarint64():E===5?h.readVarint():E===6?h.readSVarint():E===7?h.readBoolean():null}return g}(o))}Hc.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var t=this._pbf.readVarint()+this._pbf.pos;return new zm(this._pbf,t,this.extent,this._keys,this._values)};var Pm=ap;function Mm(i,t,o){if(i===3){var h=new Pm(o,o.readVarint()+o.pos);h.length&&(t[h.name]=h)}}Ou.VectorTile=function(i,t){this.layers=i.readFields(Mm,{},t)},Ou.VectorTileFeature=td,Ou.VectorTileLayer=ap;const Lm=Ou.VectorTileFeature.types,fc=Math.pow(2,13);function Wc(i,t,o,h,g,b,E,z){i.emplaceBack(t,o,2*Math.floor(h*fc)+E,g*fc*2,b*fc*2,Math.round(z))}class id{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new v,this.indexArray=new me,this.programConfigurations=new Ln(t.layers,t.zoom),this.segments=new xe,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,h){this.features=[],this.hasPattern=$p("fill-extrusion",this.layers,o);for(const{feature:g,id:b,index:E,sourceLayerIndex:z}of t){const D=this.layers[0]._featureFilter.needGeometry,O=Jn(g,D);if(!this.layers[0]._featureFilter.filter(new Yr(this.zoom),O,h))continue;const N={id:b,sourceLayerIndex:z,index:E,geometry:D?O.geometry:_a(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Qp("fill-extrusion",this.layers,N,this.zoom,o)):this.addFeature(N,N.geometry,E,h,{}),o.featureIndex.insert(g,N.geometry,E,z,this.index,!0)}}addFeatures(t,o,h){for(const g of this.features){const{geometry:b}=g;this.addFeature(g,b,g.index,o,h)}}update(t,o,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Cm),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,h,g,b){for(const E of Sh(o,500)){let z=0;for(const $ of E)z+=$.length;let D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const $ of E){if($.length===0||Rm($))continue;let Q=0;for(let se=0;se<$.length;se++){const pe=$[se];if(se>=1){const Ae=$[se-1];if(!Dm(pe,Ae)){D.vertexLength+4>xe.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Be=pe.sub(Ae)._perp()._unit(),je=Ae.dist(pe);Q+je>32768&&(Q=0),Wc(this.layoutVertexArray,pe.x,pe.y,Be.x,Be.y,0,0,Q),Wc(this.layoutVertexArray,pe.x,pe.y,Be.x,Be.y,0,1,Q),Q+=je,Wc(this.layoutVertexArray,Ae.x,Ae.y,Be.x,Be.y,0,0,Q),Wc(this.layoutVertexArray,Ae.x,Ae.y,Be.x,Be.y,0,1,Q);const Ve=D.vertexLength;this.indexArray.emplaceBack(Ve,Ve+2,Ve+1),this.indexArray.emplaceBack(Ve+1,Ve+2,Ve+3),D.vertexLength+=4,D.primitiveLength+=2}}}}if(D.vertexLength+z>xe.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray)),Lm[t.type]!=="Polygon")continue;const O=[],N=[],U=D.vertexLength;for(const $ of E)if($.length!==0){$!==E[0]&&N.push(O.length/2);for(let Q=0;Q<$.length;Q++){const se=$[Q];Wc(this.layoutVertexArray,se.x,se.y,0,0,1,1,0),O.push(se.x),O.push(se.y)}}const K=Vc(O,N);for(let $=0;$<K.length;$+=3)this.indexArray.emplaceBack(U+K[$],U+K[$+2],U+K[$+1]);D.primitiveLength+=K.length/3,D.vertexLength+=z}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,b,g)}}function Dm(i,t){return i.x===t.x&&(i.x<0||i.x>lr)||i.y===t.y&&(i.y<0||i.y>lr)}function Rm(i){return i.every(t=>t.x<0)||i.every(t=>t.x>lr)||i.every(t=>t.y<0)||i.every(t=>t.y>lr)}Jt("FillExtrusionBucket",id,{omit:["layers","features"]});var Bm={paint:new cn({"fill-extrusion-opacity":new ai(Ue["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ut(Ue["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ai(Ue["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ai(Ue["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Go(Ue["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ut(Ue["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ut(Ue["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ai(Ue["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Xc(i,t){return i.x*t.x+i.y*t.y}function Ko(i,t){if(i.length===1){let o=0;const h=t[o++];let g;for(;!g||h.equals(g);)if(g=t[o++],!g)return 1/0;for(;o<t.length;o++){const b=t[o],E=i[0],z=g.sub(h),D=b.sub(h),O=E.sub(h),N=Xc(z,z),U=Xc(z,D),K=Xc(D,D),$=Xc(O,z),Q=Xc(O,D),se=N*K-U*U,pe=(K*$-U*Q)/se,Ae=(N*Q-U*$)/se,Be=h.z*(1-pe-Ae)+g.z*pe+b.z*Ae;if(isFinite(Be))return Be}return 1/0}{let o=1/0;for(const h of t)o=Math.min(o,h.z);return o}}const Om=qt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Xd}=Om,Kd=qt([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Fm}=Kd,Jd=Ou.VectorTileFeature.types,Um=Math.cos(Math.PI/180*37.5),Yd=Math.pow(2,14)/.5;class rd{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new k,this.layoutVertexArray2=new L,this.indexArray=new me,this.programConfigurations=new Ln(t.layers,t.zoom),this.segments=new xe,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,h){this.hasPattern=$p("line",this.layers,o);const g=this.layers[0].layout.get("line-sort-key"),b=!g.isConstant(),E=[];for(const{feature:z,id:D,index:O,sourceLayerIndex:N}of t){const U=this.layers[0]._featureFilter.needGeometry,K=Jn(z,U);if(!this.layers[0]._featureFilter.filter(new Yr(this.zoom),K,h))continue;const $=b?g.evaluate(K,{},h):void 0,Q={id:D,properties:z.properties,type:z.type,sourceLayerIndex:N,index:O,geometry:U?K.geometry:_a(z),patterns:{},sortKey:$};E.push(Q)}b&&E.sort((z,D)=>z.sortKey-D.sortKey);for(const z of E){const{geometry:D,index:O,sourceLayerIndex:N}=z;if(this.hasPattern){const U=Qp("line",this.layers,z,this.zoom,o);this.patternFeatures.push(U)}else this.addFeature(z,D,O,h,{});o.featureIndex.insert(t[O].feature,D,O,N,this.index)}}update(t,o,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,h)}addFeatures(t,o,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,o,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Fm)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xd),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,o,h,g,b){const E=this.layers[0].layout,z=E.get("line-join").evaluate(t,{}),D=E.get("line-cap"),O=E.get("line-miter-limit"),N=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const U of o)this.addLine(U,t,z,D,O,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,b,g)}addLine(t,o,h,g,b,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ae=0;Ae<t.length-1;Ae++)this.totalDistance+=t[Ae].dist(t[Ae+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const z=Jd[o.type]==="Polygon";let D=t.length;for(;D>=2&&t[D-1].equals(t[D-2]);)D--;let O=0;for(;O<D-1&&t[O].equals(t[O+1]);)O++;if(D<(z?3:2))return;h==="bevel"&&(b=1.05);const N=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let K,$,Q,se,pe;this.e1=this.e2=-1,z&&(K=t[D-2],pe=t[O].sub(K)._unit()._perp());for(let Ae=O;Ae<D;Ae++){if(Q=Ae===D-1?z?t[O+1]:void 0:t[Ae+1],Q&&t[Ae].equals(Q))continue;pe&&(se=pe),K&&($=K),K=t[Ae],pe=Q?Q.sub(K)._unit()._perp():se,se=se||pe;let Be=se.add(pe);Be.x===0&&Be.y===0||Be._unit();const je=se.x*pe.x+se.y*pe.y,Ve=Be.x*pe.x+Be.y*pe.y,it=Ve!==0?1/Ve:1/0,He=2*Math.sqrt(2-2*Ve),Ct=Ve<Um&&$&&Q,Tt=se.x*pe.y-se.y*pe.x>0;if(Ct&&Ae>O){const yt=K.dist($);if(yt>2*N){const kt=K.sub(K.sub($)._mult(N/yt)._round());this.updateDistance($,kt),this.addCurrentVertex(kt,se,0,0,U),$=kt}}const ut=$&&Q;let St=ut?h:z?"butt":g;if(ut&&St==="round"&&(it<E?St="miter":it<=2&&(St="fakeround")),St==="miter"&&it>b&&(St="bevel"),St==="bevel"&&(it>2&&(St="flipbevel"),it<b&&(St="miter")),$&&this.updateDistance($,K),St==="miter")Be._mult(it),this.addCurrentVertex(K,Be,0,0,U);else if(St==="flipbevel"){if(it>100)Be=pe.mult(-1);else{const yt=it*se.add(pe).mag()/se.sub(pe).mag();Be._perp()._mult(yt*(Tt?-1:1))}this.addCurrentVertex(K,Be,0,0,U),this.addCurrentVertex(K,Be.mult(-1),0,0,U)}else if(St==="bevel"||St==="fakeround"){const yt=-Math.sqrt(it*it-1),kt=Tt?yt:0,dt=Tt?0:yt;if($&&this.addCurrentVertex(K,se,kt,dt,U),St==="fakeround"){const vt=Math.round(180*He/Math.PI/20);for(let ti=1;ti<vt;ti++){let $t=ti/vt;if($t!==.5){const ki=$t-.5;$t+=$t*ki*($t-1)*((1.0904+je*(je*(3.55645-1.43519*je)-3.2452))*ki*ki+(.848013+je*(.215638*je-1.06021)))}const Si=pe.sub(se)._mult($t)._add(se)._unit()._mult(Tt?-1:1);this.addHalfVertex(K,Si.x,Si.y,!1,Tt,0,U)}}Q&&this.addCurrentVertex(K,pe,-kt,-dt,U)}else if(St==="butt")this.addCurrentVertex(K,Be,0,0,U);else if(St==="square"){const yt=$?1:-1;this.addCurrentVertex(K,Be,yt,yt,U)}else St==="round"&&($&&(this.addCurrentVertex(K,se,0,0,U),this.addCurrentVertex(K,se,1,1,U,!0)),Q&&(this.addCurrentVertex(K,pe,-1,-1,U,!0),this.addCurrentVertex(K,pe,0,0,U)));if(Ct&&Ae<D-1){const yt=K.dist(Q);if(yt>2*N){const kt=K.add(Q.sub(K)._mult(N/yt)._round());this.updateDistance(K,kt),this.addCurrentVertex(kt,pe,0,0,U),K=kt}}}}addCurrentVertex(t,o,h,g,b,E=!1){const z=o.y*g-o.x,D=-o.y-o.x*g;this.addHalfVertex(t,o.x+o.y*h,o.y-o.x*h,E,!1,h,b),this.addHalfVertex(t,z,D,E,!0,-g,b),this.distance>Yd/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(t,o,h,g,b,E))}addHalfVertex({x:t,y:o},h,g,b,E,z,D){const O=.5*(this.lineClips?this.scaledDistance*(Yd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(b?1:0),(o<<1)+(E?1:0),Math.round(63*h)+128,Math.round(63*g)+128,1+(z===0?0:z<0?-1:1)|(63&O)<<2,O>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const N=D.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,N),D.primitiveLength++),E?this.e2=N:this.e1=N}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,o){this.distance+=t.dist(o),this.updateScaledDistance()}}Jt("LineBucket",rd,{omit:["layers","patternFeatures"]});const $d=new cn({"line-cap":new ai(Ue.layout_line["line-cap"]),"line-join":new Ut(Ue.layout_line["line-join"]),"line-miter-limit":new ai(Ue.layout_line["line-miter-limit"]),"line-round-limit":new ai(Ue.layout_line["line-round-limit"]),"line-sort-key":new Ut(Ue.layout_line["line-sort-key"])});var Qd={paint:new cn({"line-opacity":new Ut(Ue.paint_line["line-opacity"]),"line-color":new Ut(Ue.paint_line["line-color"]),"line-translate":new ai(Ue.paint_line["line-translate"]),"line-translate-anchor":new ai(Ue.paint_line["line-translate-anchor"]),"line-width":new Ut(Ue.paint_line["line-width"]),"line-gap-width":new Ut(Ue.paint_line["line-gap-width"]),"line-offset":new Ut(Ue.paint_line["line-offset"]),"line-blur":new Ut(Ue.paint_line["line-blur"]),"line-dasharray":new Eo(Ue.paint_line["line-dasharray"]),"line-pattern":new Go(Ue.paint_line["line-pattern"]),"line-gradient":new Nn(Ue.paint_line["line-gradient"])}),layout:$d};const ef=new class extends Ut{possiblyEvaluate(i,t){return t=new Yr(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(i,t)}evaluate(i,t,o,h){return t=ke({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(i,t,o,h)}}(Qd.paint.properties["line-width"].specification);function Kc(i,t){return t>0?t+2*i:i}ef.useIntegerZoom=!0;const tf=qt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),rf=qt([{name:"a_projected_pos",components:3,type:"Float32"}],4);qt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const sp=qt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);qt([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const $r=qt([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),nf=qt([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ou(i,t,o){return i.sections.forEach(h=>{h.text=function(g,b,E){const z=b.layout.get("text-transform").evaluate(E,{});return z==="uppercase"?g=g.toLocaleUpperCase():z==="lowercase"&&(g=g.toLocaleLowerCase()),un.applyArabicShaping&&(g=un.applyArabicShaping(g)),g}(h.text,t,o)}),i}qt([{name:"triangle",components:3,type:"Uint16"}]),qt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),qt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),qt([{type:"Float32",name:"offsetX"}]),qt([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Al={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var So=24,nd=an,of=function(i,t,o,h,g){var b,E,z=8*g-h-1,D=(1<<z)-1,O=D>>1,N=-7,U=o?g-1:0,K=o?-1:1,$=i[t+U];for(U+=K,b=$&(1<<-N)-1,$>>=-N,N+=z;N>0;b=256*b+i[t+U],U+=K,N-=8);for(E=b&(1<<-N)-1,b>>=-N,N+=h;N>0;E=256*E+i[t+U],U+=K,N-=8);if(b===0)b=1-O;else{if(b===D)return E?NaN:1/0*($?-1:1);E+=Math.pow(2,h),b-=O}return($?-1:1)*E*Math.pow(2,b-h)},af=function(i,t,o,h,g,b){var E,z,D,O=8*b-g-1,N=(1<<O)-1,U=N>>1,K=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=h?0:b-1,Q=h?1:-1,se=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(z=isNaN(t)?1:0,E=N):(E=Math.floor(Math.log(t)/Math.LN2),t*(D=Math.pow(2,-E))<1&&(E--,D*=2),(t+=E+U>=1?K/D:K*Math.pow(2,1-U))*D>=2&&(E++,D/=2),E+U>=N?(z=0,E=N):E+U>=1?(z=(t*D-1)*Math.pow(2,g),E+=U):(z=t*Math.pow(2,U-1)*Math.pow(2,g),E=0));g>=8;i[o+$]=255&z,$+=Q,z/=256,g-=8);for(E=E<<g|z,O+=g;O>0;i[o+$]=255&E,$+=Q,E/=256,O-=8);i[o+$-Q]|=128*se};function an(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}an.Varint=0,an.Fixed64=1,an.Bytes=2,an.Fixed32=5;var Fu,od=4294967296,sf=1/od,lf=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function au(i){return i.type===an.Bytes?i.readVarint()+i.pos:i.pos+1}function su(i,t,o){return o?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function mc(i,t,o){var h=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));o.realloc(h);for(var g=o.pos-1;g>=i;g--)o.buf[g+h]=o.buf[g]}function uf(i,t){for(var o=0;o<i.length;o++)t.writeVarint(i[o])}function Nm(i,t){for(var o=0;o<i.length;o++)t.writeSVarint(i[o])}function jm(i,t){for(var o=0;o<i.length;o++)t.writeFloat(i[o])}function Vm(i,t){for(var o=0;o<i.length;o++)t.writeDouble(i[o])}function cf(i,t){for(var o=0;o<i.length;o++)t.writeBoolean(i[o])}function lp(i,t){for(var o=0;o<i.length;o++)t.writeFixed32(i[o])}function Th(i,t){for(var o=0;o<i.length;o++)t.writeSFixed32(i[o])}function Ah(i,t){for(var o=0;o<i.length;o++)t.writeFixed64(i[o])}function Ha(i,t){for(var o=0;o<i.length;o++)t.writeSFixed64(i[o])}function lu(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+16777216*i[t+3]}function Qn(i,t,o){i[o]=t,i[o+1]=t>>>8,i[o+2]=t>>>16,i[o+3]=t>>>24}function Ch(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+(i[t+3]<<24)}function up(i,t,o){i===1&&o.readMessage(ka,t)}function ka(i,t,o){if(i===3){const{id:h,bitmap:g,width:b,height:E,left:z,top:D,advance:O}=o.readMessage(hf,{});t.push({id:h,bitmap:new _h({width:b+6,height:E+6},g),metrics:{width:b,height:E,left:z,top:D,advance:O}})}}function hf(i,t,o){i===1?t.id=o.readVarint():i===2?t.bitmap=o.readBytes():i===3?t.width=o.readVarint():i===4?t.height=o.readVarint():i===5?t.left=o.readSVarint():i===6?t.top=o.readSVarint():i===7&&(t.advance=o.readVarint())}function ad(i){let t=0,o=0;for(const E of i)t+=E.w*E.h,o=Math.max(o,E.w);i.sort((E,z)=>z.h-E.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),o),h:1/0}];let g=0,b=0;for(const E of i)for(let z=h.length-1;z>=0;z--){const D=h[z];if(!(E.w>D.w||E.h>D.h)){if(E.x=D.x,E.y=D.y,b=Math.max(b,E.y+E.h),g=Math.max(g,E.x+E.w),E.w===D.w&&E.h===D.h){const O=h.pop();z<h.length&&(h[z]=O)}else E.h===D.h?(D.x+=E.w,D.w-=E.w):E.w===D.w?(D.y+=E.h,D.h-=E.h):(h.push({x:D.x+E.w,y:D.y,w:D.w-E.w,h:E.h}),D.y+=E.h,D.h-=E.h);break}}return{w:g,h:b,fill:t/(g*b)||0}}an.prototype={destroy:function(){this.buf=null},readFields:function(i,t,o){for(o=o||this.length;this.pos<o;){var h=this.readVarint(),g=h>>3,b=this.pos;this.type=7&h,i(g,t,this),this.pos===b&&this.skip(h)}return t},readMessage:function(i,t){return this.readFields(i,t,this.readVarint()+this.pos)},readFixed32:function(){var i=lu(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Ch(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=lu(this.buf,this.pos)+lu(this.buf,this.pos+4)*od;return this.pos+=8,i},readSFixed64:function(){var i=lu(this.buf,this.pos)+Ch(this.buf,this.pos+4)*od;return this.pos+=8,i},readFloat:function(){var i=of(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=of(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var t,o,h=this.buf;return t=127&(o=h[this.pos++]),o<128?t:(t|=(127&(o=h[this.pos++]))<<7,o<128?t:(t|=(127&(o=h[this.pos++]))<<14,o<128?t:(t|=(127&(o=h[this.pos++]))<<21,o<128?t:function(g,b,E){var z,D,O=E.buf;if(z=(112&(D=O[E.pos++]))>>4,D<128||(z|=(127&(D=O[E.pos++]))<<3,D<128)||(z|=(127&(D=O[E.pos++]))<<10,D<128)||(z|=(127&(D=O[E.pos++]))<<17,D<128)||(z|=(127&(D=O[E.pos++]))<<24,D<128)||(z|=(1&(D=O[E.pos++]))<<31,D<128))return su(g,z,b);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(o=h[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var i=this.readVarint()+this.pos,t=this.pos;return this.pos=i,i-t>=12&&lf?function(o,h,g){return lf.decode(o.subarray(h,g))}(this.buf,t,i):function(o,h,g){for(var b="",E=h;E<g;){var z,D,O,N=o[E],U=null,K=N>239?4:N>223?3:N>191?2:1;if(E+K>g)break;K===1?N<128&&(U=N):K===2?(192&(z=o[E+1]))==128&&(U=(31&N)<<6|63&z)<=127&&(U=null):K===3?(D=o[E+2],(192&(z=o[E+1]))==128&&(192&D)==128&&((U=(15&N)<<12|(63&z)<<6|63&D)<=2047||U>=55296&&U<=57343)&&(U=null)):K===4&&(D=o[E+2],O=o[E+3],(192&(z=o[E+1]))==128&&(192&D)==128&&(192&O)==128&&((U=(15&N)<<18|(63&z)<<12|(63&D)<<6|63&O)<=65535||U>=1114112)&&(U=null)),U===null?(U=65533,K=1):U>65535&&(U-=65536,b+=String.fromCharCode(U>>>10&1023|55296),U=56320|1023&U),b+=String.fromCharCode(U),E+=K}return b}(this.buf,t,i)},readBytes:function(){var i=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,i);return this.pos=i,t},readPackedVarint:function(i,t){if(this.type!==an.Bytes)return i.push(this.readVarint(t));var o=au(this);for(i=i||[];this.pos<o;)i.push(this.readVarint(t));return i},readPackedSVarint:function(i){if(this.type!==an.Bytes)return i.push(this.readSVarint());var t=au(this);for(i=i||[];this.pos<t;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==an.Bytes)return i.push(this.readBoolean());var t=au(this);for(i=i||[];this.pos<t;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==an.Bytes)return i.push(this.readFloat());var t=au(this);for(i=i||[];this.pos<t;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==an.Bytes)return i.push(this.readDouble());var t=au(this);for(i=i||[];this.pos<t;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==an.Bytes)return i.push(this.readFixed32());var t=au(this);for(i=i||[];this.pos<t;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==an.Bytes)return i.push(this.readSFixed32());var t=au(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==an.Bytes)return i.push(this.readFixed64());var t=au(this);for(i=i||[];this.pos<t;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==an.Bytes)return i.push(this.readSFixed64());var t=au(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed64());return i},skip:function(i){var t=7&i;if(t===an.Varint)for(;this.buf[this.pos++]>127;);else if(t===an.Bytes)this.pos=this.readVarint()+this.pos;else if(t===an.Fixed32)this.pos+=4;else{if(t!==an.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(i,t){this.writeVarint(i<<3|t)},realloc:function(i){for(var t=this.length||16;t<this.pos+i;)t*=2;if(t!==this.length){var o=new Uint8Array(t);o.set(this.buf),this.buf=o,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Qn(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Qn(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Qn(this.buf,-1&i,this.pos),Qn(this.buf,Math.floor(i*sf),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Qn(this.buf,-1&i,this.pos),Qn(this.buf,Math.floor(i*sf),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(t,o){var h,g;if(t>=0?(h=t%4294967296|0,g=t/4294967296|0):(g=~(-t/4294967296),4294967295^(h=~(-t%4294967296))?h=h+1|0:(h=0,g=g+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(b,E,z){z.buf[z.pos++]=127&b|128,b>>>=7,z.buf[z.pos++]=127&b|128,b>>>=7,z.buf[z.pos++]=127&b|128,b>>>=7,z.buf[z.pos++]=127&b|128,z.buf[z.pos]=127&(b>>>=7)}(h,0,o),function(b,E){var z=(7&b)<<4;E.buf[E.pos++]|=z|((b>>>=3)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b)))))}(g,o)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(Boolean(i))},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var t=this.pos;this.pos=function(h,g,b){for(var E,z,D=0;D<g.length;D++){if((E=g.charCodeAt(D))>55295&&E<57344){if(!z){E>56319||D+1===g.length?(h[b++]=239,h[b++]=191,h[b++]=189):z=E;continue}if(E<56320){h[b++]=239,h[b++]=191,h[b++]=189,z=E;continue}E=z-55296<<10|E-56320|65536,z=null}else z&&(h[b++]=239,h[b++]=191,h[b++]=189,z=null);E<128?h[b++]=E:(E<2048?h[b++]=E>>6|192:(E<65536?h[b++]=E>>12|224:(h[b++]=E>>18|240,h[b++]=E>>12&63|128),h[b++]=E>>6&63|128),h[b++]=63&E|128)}return b}(this.buf,i,this.pos);var o=this.pos-t;o>=128&&mc(t,o,this),this.pos=t-1,this.writeVarint(o),this.pos+=o},writeFloat:function(i){this.realloc(4),af(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),af(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var t=i.length;this.writeVarint(t),this.realloc(t);for(var o=0;o<t;o++)this.buf[this.pos++]=i[o]},writeRawMessage:function(i,t){this.pos++;var o=this.pos;i(t,this);var h=this.pos-o;h>=128&&mc(o,h,this),this.pos=o-1,this.writeVarint(h),this.pos+=h},writeMessage:function(i,t,o){this.writeTag(i,an.Bytes),this.writeRawMessage(t,o)},writePackedVarint:function(i,t){t.length&&this.writeMessage(i,uf,t)},writePackedSVarint:function(i,t){t.length&&this.writeMessage(i,Nm,t)},writePackedBoolean:function(i,t){t.length&&this.writeMessage(i,cf,t)},writePackedFloat:function(i,t){t.length&&this.writeMessage(i,jm,t)},writePackedDouble:function(i,t){t.length&&this.writeMessage(i,Vm,t)},writePackedFixed32:function(i,t){t.length&&this.writeMessage(i,lp,t)},writePackedSFixed32:function(i,t){t.length&&this.writeMessage(i,Th,t)},writePackedFixed64:function(i,t){t.length&&this.writeMessage(i,Ah,t)},writePackedSFixed64:function(i,t){t.length&&this.writeMessage(i,Ha,t)},writeBytesField:function(i,t){this.writeTag(i,an.Bytes),this.writeBytes(t)},writeFixed32Field:function(i,t){this.writeTag(i,an.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(i,t){this.writeTag(i,an.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(i,t){this.writeTag(i,an.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(i,t){this.writeTag(i,an.Fixed64),this.writeSFixed64(t)},writeVarintField:function(i,t){this.writeTag(i,an.Varint),this.writeVarint(t)},writeSVarintField:function(i,t){this.writeTag(i,an.Varint),this.writeSVarint(t)},writeStringField:function(i,t){this.writeTag(i,an.Bytes),this.writeString(t)},writeFloatField:function(i,t){this.writeTag(i,an.Fixed32),this.writeFloat(t)},writeDoubleField:function(i,t){this.writeTag(i,an.Fixed64),this.writeDouble(t)},writeBooleanField:function(i,t){this.writeVarintField(i,Boolean(t))}};class sd{constructor(t,{pixelRatio:o,version:h,stretchX:g,stretchY:b,content:E}){this.paddedRect=t,this.pixelRatio=o,this.stretchX=g,this.stretchY=b,this.content=E,this.version=h}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class ld{constructor(t,o){const h={},g={};this.haveRenderCallbacks=[];const b=[];this.addImages(t,h,b),this.addImages(o,g,b);const{w:E,h:z}=ad(b),D=new ms({width:E||1,height:z||1});for(const O in t){const N=t[O],U=h[O].paddedRect;ms.copy(N.data,D,{x:0,y:0},{x:U.x+1,y:U.y+1},N.data)}for(const O in o){const N=o[O],U=g[O].paddedRect,K=U.x+1,$=U.y+1,Q=N.data.width,se=N.data.height;ms.copy(N.data,D,{x:0,y:0},{x:K,y:$},N.data),ms.copy(N.data,D,{x:0,y:se-1},{x:K,y:$-1},{width:Q,height:1}),ms.copy(N.data,D,{x:0,y:0},{x:K,y:$+se},{width:Q,height:1}),ms.copy(N.data,D,{x:Q-1,y:0},{x:K-1,y:$},{width:1,height:se}),ms.copy(N.data,D,{x:0,y:0},{x:K+Q,y:$},{width:1,height:se})}this.image=D,this.iconPositions=h,this.patternPositions=g}addImages(t,o,h){for(const g in t){const b=t[g],E={x:0,y:0,w:b.data.width+2,h:b.data.height+2};h.push(E),o[g]=new sd(E,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(t,o){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in t.updatedImages)this.patchUpdatedImage(this.iconPositions[h],t.getImage(h),o),this.patchUpdatedImage(this.patternPositions[h],t.getImage(h),o)}patchUpdatedImage(t,o,h){if(!t||!o||t.version===o.version)return;t.version=o.version;const[g,b]=t.tl;h.update(o.data,void 0,{x:g,y:b})}}Jt("ImagePosition",sd),Jt("ImageAtlas",ld),d.WritingMode=void 0,(Fu=d.WritingMode||(d.WritingMode={}))[Fu.none=0]="none",Fu[Fu.horizontal=1]="horizontal",Fu[Fu.vertical=2]="vertical",Fu[Fu.horizontalOnly=3]="horizontalOnly";const Jc=-17;class yc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,o){const h=new yc;return h.scale=t||1,h.fontStack=o,h}static forImage(t){const o=new yc;return o.imageName=t,o}}class Yc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,o){const h=new Yc;for(let g=0;g<t.sections.length;g++){const b=t.sections[g];b.image?h.addImageSection(b):h.addTextSection(b,o)}return h}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let o="";for(let h=0;h<t.length;h++){const g=t.charCodeAt(h+1)||null,b=t.charCodeAt(h-1)||null;o+=g&&El(g)&&!Al[t[h+1]]||b&&El(b)&&!Al[t[h-1]]||!Al[t[h]]?t[h]:Al[t[h]]}return o}(this.text)}trim(){let t=0;for(let h=0;h<this.text.length&&uu[this.text.charCodeAt(h)];h++)t++;let o=this.text.length;for(let h=this.text.length-1;h>=0&&h>=t&&uu[this.text.charCodeAt(h)];h--)o--;this.text=this.text.substring(t,o),this.sectionIndex=this.sectionIndex.slice(t,o)}substring(t,o){const h=new Yc;return h.text=this.text.substring(t,o),h.sectionIndex=this.sectionIndex.slice(t,o),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,o)=>Math.max(t,this.sections[o].scale),0)}addTextSection(t,o){this.text+=t.text,this.sections.push(yc.forText(t.scale,t.fontStack||o));const h=this.sections.length-1;for(let g=0;g<t.text.length;++g)this.sectionIndex.push(h)}addImageSection(t){const o=t.image?t.image.name:"";if(o.length===0)return void ct("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(yc.forImage(o)),this.sectionIndex.push(this.sections.length-1)):ct("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function kh(i,t,o,h,g,b,E,z,D,O,N,U,K,$,Q,se){const pe=Yc.fromFeature(i,g);let Ae;U===d.WritingMode.vertical&&pe.verticalizePunctuation();const{processBidirectionalText:Be,processStyledBidirectionalText:je}=un;if(Be&&pe.sections.length===1){Ae=[];const He=Be(pe.toString(),cp(pe,O,b,t,h,$,Q));for(const Ct of He){const Tt=new Yc;Tt.text=Ct,Tt.sections=pe.sections;for(let ut=0;ut<Ct.length;ut++)Tt.sectionIndex.push(0);Ae.push(Tt)}}else if(je){Ae=[];const He=je(pe.text,pe.sectionIndex,cp(pe,O,b,t,h,$,Q));for(const Ct of He){const Tt=new Yc;Tt.text=Ct[0],Tt.sectionIndex=Ct[1],Tt.sections=pe.sections,Ae.push(Tt)}}else Ae=function(He,Ct){const Tt=[],ut=He.text;let St=0;for(const yt of Ct)Tt.push(He.substring(St,yt)),St=yt;return St<ut.length&&Tt.push(He.substring(St,ut.length)),Tt}(pe,cp(pe,O,b,t,h,$,Q));const Ve=[],it={positionedLines:Ve,text:pe.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:U,iconsInText:!1,verticalizable:!1};return function(He,Ct,Tt,ut,St,yt,kt,dt,vt,ti,$t,Si){let ki=0,Yi=Jc,sr=0,Ir=0;const Sr=dt==="right"?1:dt==="left"?0:.5;let dr=0;for(const Wi of St){Wi.trim();const $i=Wi.getMaxScale(),Vi=($i-1)*So,Qr={positionedGlyphs:[],lineOffset:0};He.positionedLines[dr]=Qr;const Xr=Qr.positionedGlyphs;let cr=0;if(!Wi.length()){Yi+=yt,++dr;continue}for(let zr=0;zr<Wi.length();zr++){const ui=Wi.getSection(zr),to=Wi.getSectionIndex(zr),sn=Wi.getCharCode(zr);let Cn=0,Fr=null,To=null,co=null,Wa=So;const Jo=!(vt===d.WritingMode.horizontal||!$t&&!ln(sn)||$t&&(uu[sn]||(Pr=sn,ii.Arabic(Pr)||ii["Arabic Supplement"](Pr)||ii["Arabic Extended-A"](Pr)||ii["Arabic Presentation Forms-A"](Pr)||ii["Arabic Presentation Forms-B"](Pr))));if(ui.imageName){const Yo=ut[ui.imageName];if(!Yo)continue;co=ui.imageName,He.iconsInText=He.iconsInText||!0,To=Yo.paddedRect;const io=Yo.displaySize;ui.scale=ui.scale*So/Si,Fr={width:io[0],height:io[1],left:1,top:-3,advance:Jo?io[1]:io[0]},Cn=Vi+(So-io[1]*ui.scale),Wa=Fr.advance;const Xa=Jo?io[0]*ui.scale-So*$i:io[1]*ui.scale-So*$i;Xa>0&&Xa>cr&&(cr=Xa)}else{const Yo=Tt[ui.fontStack],io=Yo&&Yo[sn];if(io&&io.rect)To=io.rect,Fr=io.metrics;else{const Xa=Ct[ui.fontStack],Zu=Xa&&Xa[sn];if(!Zu)continue;Fr=Zu.metrics}Cn=($i-ui.scale)*So}Jo?(He.verticalizable=!0,Xr.push({glyph:sn,imageName:co,x:ki,y:Yi+Cn,vertical:Jo,scale:ui.scale,fontStack:ui.fontStack,sectionIndex:to,metrics:Fr,rect:To}),ki+=Wa*ui.scale+ti):(Xr.push({glyph:sn,imageName:co,x:ki,y:Yi+Cn,vertical:Jo,scale:ui.scale,fontStack:ui.fontStack,sectionIndex:to,metrics:Fr,rect:To}),ki+=Fr.advance*ui.scale+ti)}Xr.length!==0&&(sr=Math.max(ki-ti,sr),Gm(Xr,0,Xr.length-1,Sr,cr)),ki=0;const or=yt*$i+cr;Qr.lineOffset=Math.max(cr,Vi),Yi+=or,Ir=Math.max(or,Ir),++dr}var Pr;const fr=Yi-Jc,{horizontalAlign:Mr,verticalAlign:Ri}=hp(kt);(function(Wi,$i,Vi,Qr,Xr,cr,or,zr,ui){const to=($i-Vi)*Xr;let sn=0;sn=cr!==or?-zr*Qr-Jc:(-Qr*ui+.5)*or;for(const Cn of Wi)for(const Fr of Cn.positionedGlyphs)Fr.x+=to,Fr.y+=sn})(He.positionedLines,Sr,Mr,Ri,sr,Ir,yt,fr,St.length),He.top+=-Ri*fr,He.bottom=He.top+fr,He.left+=-Mr*sr,He.right=He.left+sr}(it,t,o,h,Ae,E,z,D,U,O,K,se),!function(He){for(const Ct of He)if(Ct.positionedGlyphs.length!==0)return!1;return!0}(Ve)&&it}const uu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ud={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function cd(i,t,o,h,g,b){if(t.imageName){const E=h[t.imageName];return E?E.displaySize[0]*t.scale*So/b+g:0}{const E=o[t.fontStack],z=E&&E[i];return z?z.metrics.advance*t.scale+g:0}}function hd(i,t,o,h){const g=Math.pow(i-t,2);return h?i<t?g/2:2*g:g+Math.abs(o)*o}function qm(i,t,o){let h=0;return i===10&&(h-=1e4),o&&(h+=150),i!==40&&i!==65288||(h+=50),t!==41&&t!==65289||(h+=50),h}function pd(i,t,o,h,g,b){let E=null,z=hd(t,o,g,b);for(const D of h){const O=hd(t-D.x,o,g,b)+D.badness;O<=z&&(E=D,z=O)}return{index:i,x:t,priorBreak:E,badness:z}}function dd(i){return i?dd(i.priorBreak).concat(i.index):[]}function cp(i,t,o,h,g,b,E){if(b!=="point")return[];if(!i)return[];const z=[],D=function(K,$,Q,se,pe,Ae){let Be=0;for(let je=0;je<K.length();je++){const Ve=K.getSection(je);Be+=cd(K.getCharCode(je),Ve,se,pe,$,Ae)}return Be/Math.max(1,Math.ceil(Be/Q))}(i,t,o,h,g,E),O=i.text.indexOf("\u200B")>=0;let N=0;for(let K=0;K<i.length();K++){const $=i.getSection(K),Q=i.getCharCode(K);if(uu[Q]||(N+=cd(Q,$,h,g,t,E)),K<i.length()-1){const se=!((U=Q)<11904||!(ii["Bopomofo Extended"](U)||ii.Bopomofo(U)||ii["CJK Compatibility Forms"](U)||ii["CJK Compatibility Ideographs"](U)||ii["CJK Compatibility"](U)||ii["CJK Radicals Supplement"](U)||ii["CJK Strokes"](U)||ii["CJK Symbols and Punctuation"](U)||ii["CJK Unified Ideographs Extension A"](U)||ii["CJK Unified Ideographs"](U)||ii["Enclosed CJK Letters and Months"](U)||ii["Halfwidth and Fullwidth Forms"](U)||ii.Hiragana(U)||ii["Ideographic Description Characters"](U)||ii["Kangxi Radicals"](U)||ii["Katakana Phonetic Extensions"](U)||ii.Katakana(U)||ii["Vertical Forms"](U)||ii["Yi Radicals"](U)||ii["Yi Syllables"](U)));(ud[Q]||se||$.imageName)&&z.push(pd(K+1,N,D,z,qm(Q,i.getCharCode(K+1),se&&O),!1))}}var U;return dd(pd(i.length(),N,D,z,0,!0))}function hp(i){let t=.5,o=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:t,verticalAlign:o}}function Gm(i,t,o,h,g){if(!h&&!g)return;const b=i[o],E=(i[o].x+b.metrics.advance*b.scale)*h;for(let z=t;z<=o;z++)i[z].x-=E,i[z].y+=g}function Zm(i,t,o){const{horizontalAlign:h,verticalAlign:g}=hp(o),b=t[0]-i.displaySize[0]*h,E=t[1]-i.displaySize[1]*g;return{image:i,top:E,bottom:E+i.displaySize[1],left:b,right:b+i.displaySize[0]}}function fd(i,t,o,h,g,b){const E=i.image;let z;if(E.content){const pe=E.content,Ae=E.pixelRatio||1;z=[pe[0]/Ae,pe[1]/Ae,E.displaySize[0]-pe[2]/Ae,E.displaySize[1]-pe[3]/Ae]}const D=t.left*b,O=t.right*b;let N,U,K,$;o==="width"||o==="both"?($=g[0]+D-h[3],U=g[0]+O+h[1]):($=g[0]+(D+O-E.displaySize[0])/2,U=$+E.displaySize[0]);const Q=t.top*b,se=t.bottom*b;return o==="height"||o==="both"?(N=g[1]+Q-h[0],K=g[1]+se+h[2]):(N=g[1]+(Q+se-E.displaySize[1])/2,K=N+E.displaySize[1]),{image:E,top:N,right:U,bottom:K,left:$,collisionPadding:z}}const Cl=128;function zh(i,t){const{expression:o}=t;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Yr(i+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:g}=o;let b=0;for(;b<h.length&&h[b]<=i;)b++;b=Math.max(0,b-1);let E=b;for(;E<h.length&&h[E]<i+1;)E++;E=Math.min(h.length-1,E);const z=h[b],D=h[E];return o.kind==="composite"?{kind:"composite",minZoom:z,maxZoom:D,interpolationType:g}:{kind:"camera",minZoom:z,maxZoom:D,minSize:o.evaluate(new Yr(z)),maxSize:o.evaluate(new Yr(D)),interpolationType:g}}}class cu extends bt{constructor(t,o,h,g){super(t,o),this.angle=h,g!==void 0&&(this.segment=g)}clone(){return new cu(this.x,this.y,this.angle,this.segment)}}function Ph(i,t,o,h,g){if(t.segment===void 0)return!0;let b=t,E=t.segment+1,z=0;for(;z>-o/2;){if(E--,E<0)return!1;z-=i[E].dist(b),b=i[E]}z+=i[E].dist(i[E+1]),E++;const D=[];let O=0;for(;z<o/2;){const N=i[E],U=i[E+1];if(!U)return!1;let K=i[E-1].angleTo(N)-N.angleTo(U);for(K=Math.abs((K+3*Math.PI)%(2*Math.PI)-Math.PI),D.push({distance:z,angleDelta:K}),O+=K;z-D[0].distance>h;)O-=D.shift().angleDelta;if(O>g)return!1;E++,z+=N.dist(U)}return!0}function Mh(i){let t=0;for(let o=0;o<i.length-1;o++)t+=i[o].dist(i[o+1]);return t}function Lh(i,t,o){return i?.6*t*o:0}function gc(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function Hm(i,t,o,h,g,b){const E=Lh(o,g,b),z=gc(o,h)*b;let D=0;const O=Mh(i)/2;for(let N=0;N<i.length-1;N++){const U=i[N],K=i[N+1],$=U.dist(K);if(D+$>O){const Q=(O-D)/$,se=Un(U.x,K.x,Q),pe=Un(U.y,K.y,Q),Ae=new cu(se,pe,K.angleTo(U),N);return Ae._round(),!E||Ph(i,Ae,z,E,t)?Ae:void 0}D+=$}}function Wm(i,t,o,h,g,b,E,z,D){const O=Lh(h,b,E),N=gc(h,g),U=N*E,K=i[0].x===0||i[0].x===D||i[0].y===0||i[0].y===D;return t-U<t/4&&(t=U+t/4),pf(i,K?t/2*z%t:(N/2+2*b)*E*z%t,t,O,o,U,K,!1,D)}function pf(i,t,o,h,g,b,E,z,D){const O=b/2,N=Mh(i);let U=0,K=t-o,$=[];for(let Q=0;Q<i.length-1;Q++){const se=i[Q],pe=i[Q+1],Ae=se.dist(pe),Be=pe.angleTo(se);for(;K+o<U+Ae;){K+=o;const je=(K-U)/Ae,Ve=Un(se.x,pe.x,je),it=Un(se.y,pe.y,je);if(Ve>=0&&Ve<D&&it>=0&&it<D&&K-O>=0&&K+O<=N){const He=new cu(Ve,it,Be,Q);He._round(),h&&!Ph(i,He,b,h,g)||$.push(He)}}U+=Ae}return z||$.length||E||($=pf(i,U/2,o,h,g,b,E,!0,D)),$}function _c(i,t,o,h,g){const b=[];for(let E=0;E<i.length;E++){const z=i[E];let D;for(let O=0;O<z.length-1;O++){let N=z[O],U=z[O+1];N.x<t&&U.x<t||(N.x<t?N=new bt(t,N.y+(t-N.x)/(U.x-N.x)*(U.y-N.y))._round():U.x<t&&(U=new bt(t,N.y+(t-N.x)/(U.x-N.x)*(U.y-N.y))._round()),N.y<o&&U.y<o||(N.y<o?N=new bt(N.x+(o-N.y)/(U.y-N.y)*(U.x-N.x),o)._round():U.y<o&&(U=new bt(N.x+(o-N.y)/(U.y-N.y)*(U.x-N.x),o)._round()),N.x>=h&&U.x>=h||(N.x>=h?N=new bt(h,N.y+(h-N.x)/(U.x-N.x)*(U.y-N.y))._round():U.x>=h&&(U=new bt(h,N.y+(h-N.x)/(U.x-N.x)*(U.y-N.y))._round()),N.y>=g&&U.y>=g||(N.y>=g?N=new bt(N.x+(g-N.y)/(U.y-N.y)*(U.x-N.x),g)._round():U.y>=g&&(U=new bt(N.x+(g-N.y)/(U.y-N.y)*(U.x-N.x),g)._round()),D&&N.equals(D[D.length-1])||(D=[N],b.push(D)),D.push(U)))))}}return b}function pp(i,t,o,h){const g=[],b=i.image,E=b.pixelRatio,z=b.paddedRect.w-2,D=b.paddedRect.h-2,O=i.right-i.left,N=i.bottom-i.top,U=b.stretchX||[[0,z]],K=b.stretchY||[[0,D]],$=(yt,kt)=>yt+kt[1]-kt[0],Q=U.reduce($,0),se=K.reduce($,0),pe=z-Q,Ae=D-se;let Be=0,je=Q,Ve=0,it=se,He=0,Ct=pe,Tt=0,ut=Ae;if(b.content&&h){const yt=b.content;Be=Dh(U,0,yt[0]),Ve=Dh(K,0,yt[1]),je=Dh(U,yt[0],yt[2]),it=Dh(K,yt[1],yt[3]),He=yt[0]-Be,Tt=yt[1]-Ve,Ct=yt[2]-yt[0]-je,ut=yt[3]-yt[1]-it}const St=(yt,kt,dt,vt)=>{const ti=Rh(yt.stretch-Be,je,O,i.left),$t=Bh(yt.fixed-He,Ct,yt.stretch,Q),Si=Rh(kt.stretch-Ve,it,N,i.top),ki=Bh(kt.fixed-Tt,ut,kt.stretch,se),Yi=Rh(dt.stretch-Be,je,O,i.left),sr=Bh(dt.fixed-He,Ct,dt.stretch,Q),Ir=Rh(vt.stretch-Ve,it,N,i.top),Sr=Bh(vt.fixed-Tt,ut,vt.stretch,se),dr=new bt(ti,Si),Pr=new bt(Yi,Si),fr=new bt(Yi,Ir),Mr=new bt(ti,Ir),Ri=new bt($t/E,ki/E),Wi=new bt(sr/E,Sr/E),$i=t*Math.PI/180;if($i){const Xr=Math.sin($i),cr=Math.cos($i),or=[cr,-Xr,Xr,cr];dr._matMult(or),Pr._matMult(or),Mr._matMult(or),fr._matMult(or)}const Vi=yt.stretch+yt.fixed,Qr=kt.stretch+kt.fixed;return{tl:dr,tr:Pr,bl:Mr,br:fr,tex:{x:b.paddedRect.x+1+Vi,y:b.paddedRect.y+1+Qr,w:dt.stretch+dt.fixed-Vi,h:vt.stretch+vt.fixed-Qr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ri,pixelOffsetBR:Wi,minFontScaleX:Ct/E/O,minFontScaleY:ut/E/N,isSDF:o}};if(h&&(b.stretchX||b.stretchY)){const yt=dp(U,pe,Q),kt=dp(K,Ae,se);for(let dt=0;dt<yt.length-1;dt++){const vt=yt[dt],ti=yt[dt+1];for(let $t=0;$t<kt.length-1;$t++)g.push(St(vt,kt[$t],ti,kt[$t+1]))}}else g.push(St({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:z+1},{fixed:0,stretch:D+1}));return g}function Dh(i,t,o){let h=0;for(const g of i)h+=Math.max(t,Math.min(o,g[1]))-Math.max(t,Math.min(o,g[0]));return h}function dp(i,t,o){const h=[{fixed:-1,stretch:0}];for(const[g,b]of i){const E=h[h.length-1];h.push({fixed:g-E.stretch,stretch:E.stretch}),h.push({fixed:g-E.stretch,stretch:E.stretch+(b-g)})}return h.push({fixed:t+1,stretch:o}),h}function Rh(i,t,o,h){return i/t*o+h}function Bh(i,t,o,h){return i-t*o/h}Jt("Anchor",cu);class fp{constructor(t,o,h,g,b,E,z,D,O,N){if(this.boxStartIndex=t.length,O){let U=E.top,K=E.bottom;const $=E.collisionPadding;$&&(U-=$[1],K+=$[3]);let Q=K-U;Q>0&&(Q=Math.max(10,Q),this.circleDiameter=Q)}else{let U=E.top*z-D,K=E.bottom*z+D,$=E.left*z-D,Q=E.right*z+D;const se=E.collisionPadding;if(se&&($-=se[0]*z,U-=se[1]*z,Q+=se[2]*z,K+=se[3]*z),N){const pe=new bt($,U),Ae=new bt(Q,U),Be=new bt($,K),je=new bt(Q,K),Ve=N*Math.PI/180;pe._rotate(Ve),Ae._rotate(Ve),Be._rotate(Ve),je._rotate(Ve),$=Math.min(pe.x,Ae.x,Be.x,je.x),Q=Math.max(pe.x,Ae.x,Be.x,je.x),U=Math.min(pe.y,Ae.y,Be.y,je.y),K=Math.max(pe.y,Ae.y,Be.y,je.y)}t.emplaceBack(o.x,o.y,$,U,Q,K,h,g,b)}this.boxEndIndex=t.length}}class Xm{constructor(t=[],o=Km){if(this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:o,compare:h}=this,g=o[t];for(;t>0;){const b=t-1>>1,E=o[b];if(h(g,E)>=0)break;o[t]=E,t=b}o[t]=g}_down(t){const{data:o,compare:h}=this,g=this.length>>1,b=o[t];for(;t<g;){let E=1+(t<<1),z=o[E];const D=E+1;if(D<this.length&&h(o[D],z)<0&&(E=D,z=o[D]),h(z,b)>=0)break;o[t]=z,t=E}o[t]=b}}function Km(i,t){return i<t?-1:i>t?1:0}function mp(i,t=1,o=!1){let h=1/0,g=1/0,b=-1/0,E=-1/0;const z=i[0];for(let $=0;$<z.length;$++){const Q=z[$];(!$||Q.x<h)&&(h=Q.x),(!$||Q.y<g)&&(g=Q.y),(!$||Q.x>b)&&(b=Q.x),(!$||Q.y>E)&&(E=Q.y)}const D=Math.min(b-h,E-g);let O=D/2;const N=new Xm([],md);if(D===0)return new bt(h,g);for(let $=h;$<b;$+=D)for(let Q=g;Q<E;Q+=D)N.push(new $c($+O,Q+O,O,i));let U=function($){let Q=0,se=0,pe=0;const Ae=$[0];for(let Be=0,je=Ae.length,Ve=je-1;Be<je;Ve=Be++){const it=Ae[Be],He=Ae[Ve],Ct=it.x*He.y-He.x*it.y;se+=(it.x+He.x)*Ct,pe+=(it.y+He.y)*Ct,Q+=3*Ct}return new $c(se/Q,pe/Q,0,$)}(i),K=N.length;for(;N.length;){const $=N.pop();($.d>U.d||!U.d)&&(U=$,o&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,K)),$.max-U.d<=t||(O=$.h/2,N.push(new $c($.p.x-O,$.p.y-O,O,i)),N.push(new $c($.p.x+O,$.p.y-O,O,i)),N.push(new $c($.p.x-O,$.p.y+O,O,i)),N.push(new $c($.p.x+O,$.p.y+O,O,i)),K+=4)}return o&&(console.log(`num probes: ${K}`),console.log(`best distance: ${U.d}`)),U.p}function md(i,t){return t.max-i.max}function $c(i,t,o,h){this.p=new bt(i,t),this.h=o,this.d=function(g,b){let E=!1,z=1/0;for(let D=0;D<b.length;D++){const O=b[D];for(let N=0,U=O.length,K=U-1;N<U;K=N++){const $=O[N],Q=O[K];$.y>g.y!=Q.y>g.y&&g.x<(Q.x-$.x)*(g.y-$.y)/(Q.y-$.y)+$.x&&(E=!E),z=Math.min(z,ds(g,$,Q))}}return(E?1:-1)*Math.sqrt(z)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}const Uu=Number.POSITIVE_INFINITY;function Qc(i,t){return t[1]!==Uu?function(o,h,g){let b=0,E=0;switch(h=Math.abs(h),g=Math.abs(g),o){case"top-right":case"top-left":case"top":E=g-7;break;case"bottom-right":case"bottom-left":case"bottom":E=7-g}switch(o){case"top-right":case"bottom-right":case"right":b=-h;break;case"top-left":case"bottom-left":case"left":b=h}return[b,E]}(i,t[0],t[1]):function(o,h){let g=0,b=0;h<0&&(h=0);const E=h/Math.sqrt(2);switch(o){case"top-right":case"top-left":b=E-7;break;case"bottom-right":case"bottom-left":b=7-E;break;case"bottom":b=7-h;break;case"top":b=h-7}switch(o){case"top-right":case"bottom-right":g=-E;break;case"top-left":case"bottom-left":g=E;break;case"left":g=h;break;case"right":g=-h}return[g,b]}(i,t[0])}function Or(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Jm(i,t,o,h,g,b,E,z,D,O,N){let U=b.textMaxSize.evaluate(t,{});U===void 0&&(U=E);const K=i.layers[0].layout,$=K.get("icon-offset").evaluate(t,{},N),Q=df(o.horizontal),se=E/24,pe=i.tilePixelRatio*se,Ae=i.tilePixelRatio*U/24,Be=i.tilePixelRatio*z,je=i.tilePixelRatio*K.get("symbol-spacing"),Ve=K.get("text-padding")*i.tilePixelRatio,it=K.get("icon-padding")*i.tilePixelRatio,He=K.get("text-max-angle")/180*Math.PI,Ct=K.get("text-rotation-alignment")!=="viewport"&&K.get("symbol-placement")!=="point",Tt=K.get("icon-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",ut=K.get("symbol-placement"),St=je/2,yt=K.get("icon-text-fit");let kt;h&&yt!=="none"&&(i.allowVerticalPlacement&&o.vertical&&(kt=fd(h,o.vertical,yt,K.get("icon-text-fit-padding"),$,se)),Q&&(h=fd(h,Q,yt,K.get("icon-text-fit-padding"),$,se)));const dt=(vt,ti)=>{ti.x<0||ti.x>=lr||ti.y<0||ti.y>=lr||function($t,Si,ki,Yi,sr,Ir,Sr,dr,Pr,fr,Mr,Ri,Wi,$i,Vi,Qr,Xr,cr,or,zr,ui,to,sn,Cn,Fr){const To=$t.addToLineVertexArray(Si,ki);let co,Wa,Jo,Yo,io=0,Xa=0,Zu=0,wc=0,Ec=-1,rh=-1;const Ds={};let zl=Lt(""),Ic=0,Hu=0;if(dr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Ic,Hu]=dr.layout.get("text-offset").evaluate(ui,{},Cn).map($o=>$o*So):(Ic=dr.layout.get("text-radial-offset").evaluate(ui,{},Cn)*So,Hu=Uu),$t.allowVerticalPlacement&&Yi.vertical){const $o=dr.layout.get("text-rotate").evaluate(ui,{},Cn)+90;Jo=new fp(Pr,Si,fr,Mr,Ri,Yi.vertical,Wi,$i,Vi,$o),Sr&&(Yo=new fp(Pr,Si,fr,Mr,Ri,Sr,Xr,cr,Vi,$o))}if(sr){const $o=dr.layout.get("icon-rotate").evaluate(ui,{}),Pa=dr.layout.get("icon-text-fit")!=="none",du=pp(sr,$o,sn,Pa),al=Sr?pp(Sr,$o,sn,Pa):void 0;Wa=new fp(Pr,Si,fr,Mr,Ri,sr,Xr,cr,!1,$o),io=4*du.length;const oh=$t.iconSizeData;let Rs=null;oh.kind==="source"?(Rs=[Cl*dr.layout.get("icon-size").evaluate(ui,{})],Rs[0]>kl&&ct(`${$t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):oh.kind==="composite"&&(Rs=[Cl*to.compositeIconSizes[0].evaluate(ui,{},Cn),Cl*to.compositeIconSizes[1].evaluate(ui,{},Cn)],(Rs[0]>kl||Rs[1]>kl)&&ct(`${$t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),$t.addSymbols($t.icon,du,Rs,zr,or,ui,d.WritingMode.none,Si,To.lineStartIndex,To.lineLength,-1,Cn),Ec=$t.icon.placedSymbolArray.length-1,al&&(Xa=4*al.length,$t.addSymbols($t.icon,al,Rs,zr,or,ui,d.WritingMode.vertical,Si,To.lineStartIndex,To.lineLength,-1,Cn),rh=$t.icon.placedSymbolArray.length-1)}const pu=Object.keys(Yi.horizontal);for(const $o of pu){const Pa=Yi.horizontal[$o];if(!co){zl=Lt(Pa.text);const al=dr.layout.get("text-rotate").evaluate(ui,{},Cn);co=new fp(Pr,Si,fr,Mr,Ri,Pa,Wi,$i,Vi,al)}const du=Pa.positionedLines.length===1;if(Zu+=vc($t,Si,Pa,Ir,dr,Vi,ui,Qr,To,Yi.vertical?d.WritingMode.horizontal:d.WritingMode.horizontalOnly,du?pu:[$o],Ds,Ec,to,Cn),du)break}Yi.vertical&&(wc+=vc($t,Si,Yi.vertical,Ir,dr,Vi,ui,Qr,To,d.WritingMode.vertical,["vertical"],Ds,rh,to,Cn));const nh=co?co.boxStartIndex:$t.collisionBoxArray.length,bp=co?co.boxEndIndex:$t.collisionBoxArray.length,wp=Jo?Jo.boxStartIndex:$t.collisionBoxArray.length,Fh=Jo?Jo.boxEndIndex:$t.collisionBoxArray.length,Uh=Wa?Wa.boxStartIndex:$t.collisionBoxArray.length,Ep=Wa?Wa.boxEndIndex:$t.collisionBoxArray.length,Nh=Yo?Yo.boxStartIndex:$t.collisionBoxArray.length,jh=Yo?Yo.boxEndIndex:$t.collisionBoxArray.length;let za=-1;const Sc=($o,Pa)=>$o&&$o.circleDiameter?Math.max($o.circleDiameter,Pa):Pa;za=Sc(co,za),za=Sc(Jo,za),za=Sc(Wa,za),za=Sc(Yo,za);const Tc=za>-1?1:0;Tc&&(za*=Fr/So),$t.glyphOffsetArray.length>=xc.MAX_GLYPHS&&ct("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ui.sortKey!==void 0&&$t.addToSortKeyRanges($t.symbolInstances.length,ui.sortKey),$t.symbolInstances.emplaceBack(Si.x,Si.y,Ds.right>=0?Ds.right:-1,Ds.center>=0?Ds.center:-1,Ds.left>=0?Ds.left:-1,Ds.vertical||-1,Ec,rh,zl,nh,bp,wp,Fh,Uh,Ep,Nh,jh,fr,Zu,wc,io,Xa,Tc,0,Wi,Ic,Hu,za)}(i,ti,vt,o,h,g,kt,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,pe,Ve,Ct,D,Be,it,Tt,$,t,b,O,N,E)};if(ut==="line")for(const vt of _c(t.geometry,0,0,lr,lr)){const ti=Wm(vt,je,He,o.vertical||Q,h,24,Ae,i.overscaling,lr);for(const $t of ti){const Si=Q;Si&&Ym(i,Si.text,St,$t)||dt(vt,$t)}}else if(ut==="line-center"){for(const vt of t.geometry)if(vt.length>1){const ti=Hm(vt,He,o.vertical||Q,h,24,Ae);ti&&dt(vt,ti)}}else if(t.type==="Polygon")for(const vt of Sh(t.geometry,0)){const ti=mp(vt,16);dt(vt[0],new cu(ti.x,ti.y,0))}else if(t.type==="LineString")for(const vt of t.geometry)dt(vt,new cu(vt[0].x,vt[0].y,0));else if(t.type==="Point")for(const vt of t.geometry)for(const ti of vt)dt([ti],new cu(ti.x,ti.y,0))}const kl=32640;function vc(i,t,o,h,g,b,E,z,D,O,N,U,K,$,Q){const se=function(Be,je,Ve,it,He,Ct,Tt,ut){const St=it.layout.get("text-rotate").evaluate(Ct,{})*Math.PI/180,yt=[];for(const kt of je.positionedLines)for(const dt of kt.positionedGlyphs){if(!dt.rect)continue;const vt=dt.rect||{};let ti=4,$t=!0,Si=1,ki=0;const Yi=(He||ut)&&dt.vertical,sr=dt.metrics.advance*dt.scale/2;if(ut&&je.verticalizable){const or=(dt.scale-1)*So,zr=(So-dt.metrics.width*dt.scale)/2;ki=kt.lineOffset/2-(dt.imageName?-zr:or)}if(dt.imageName){const or=Tt[dt.imageName];$t=or.sdf,Si=or.pixelRatio,ti=1/Si}const Ir=He?[dt.x+sr,dt.y]:[0,0];let Sr=He?[0,0]:[dt.x+sr+Ve[0],dt.y+Ve[1]-ki],dr=[0,0];Yi&&(dr=Sr,Sr=[0,0]);const Pr=(dt.metrics.left-ti)*dt.scale-sr+Sr[0],fr=(-dt.metrics.top-ti)*dt.scale+Sr[1],Mr=Pr+vt.w*dt.scale/Si,Ri=fr+vt.h*dt.scale/Si,Wi=new bt(Pr,fr),$i=new bt(Mr,fr),Vi=new bt(Pr,Ri),Qr=new bt(Mr,Ri);if(Yi){const or=new bt(-sr,sr-Jc),zr=-Math.PI/2,ui=12-sr,to=new bt(22-ui,-(dt.imageName?ui:0)),sn=new bt(...dr);Wi._rotateAround(zr,or)._add(to)._add(sn),$i._rotateAround(zr,or)._add(to)._add(sn),Vi._rotateAround(zr,or)._add(to)._add(sn),Qr._rotateAround(zr,or)._add(to)._add(sn)}if(St){const or=Math.sin(St),zr=Math.cos(St),ui=[zr,-or,or,zr];Wi._matMult(ui),$i._matMult(ui),Vi._matMult(ui),Qr._matMult(ui)}const Xr=new bt(0,0),cr=new bt(0,0);yt.push({tl:Wi,tr:$i,bl:Vi,br:Qr,tex:vt,writingMode:je.writingMode,glyphOffset:Ir,sectionIndex:dt.sectionIndex,isSDF:$t,pixelOffsetTL:Xr,pixelOffsetBR:cr,minFontScaleX:0,minFontScaleY:0})}return yt}(0,o,z,g,b,E,h,i.allowVerticalPlacement),pe=i.textSizeData;let Ae=null;pe.kind==="source"?(Ae=[Cl*g.layout.get("text-size").evaluate(E,{})],Ae[0]>kl&&ct(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):pe.kind==="composite"&&(Ae=[Cl*$.compositeTextSizes[0].evaluate(E,{},Q),Cl*$.compositeTextSizes[1].evaluate(E,{},Q)],(Ae[0]>kl||Ae[1]>kl)&&ct(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,se,Ae,z,b,E,O,t,D.lineStartIndex,D.lineLength,K,Q);for(const Be of N)U[Be]=i.text.placedSymbolArray.length-1;return 4*se.length}function df(i){for(const t in i)return i[t];return null}function Ym(i,t,o,h){const g=i.compareText;if(t in g){const b=g[t];for(let E=b.length-1;E>=0;E--)if(h.dist(b[E])<o)return!0}else g[t]=[];return g[t].push(h),!1}const $m=Ou.VectorTileFeature.types,Qm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function yp(i,t,o,h,g,b,E,z,D,O,N,U,K){const $=z?Math.min(kl,Math.round(z[0])):0,Q=z?Math.min(kl,Math.round(z[1])):0;i.emplaceBack(t,o,Math.round(32*h),Math.round(32*g),b,E,($<<1)+(D?1:0),Q,16*O,16*N,256*U,256*K)}function yd(i,t,o){i.emplaceBack(t.x,t.y,o),i.emplaceBack(t.x,t.y,o),i.emplaceBack(t.x,t.y,o),i.emplaceBack(t.x,t.y,o)}function ey(i){for(const t of i.sections)if(ni(t.text))return!0;return!1}class gp{constructor(t){this.layoutVertexArray=new j,this.indexArray=new me,this.programConfigurations=t,this.segments=new xe,this.dynamicLayoutVertexArray=new Y,this.opacityVertexArray=new ie,this.placedSymbolArray=new Pt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,o,h,g){this.isEmpty()||(h&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,tf.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,rf.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Qm,!0),this.opacityVertexBuffer.itemSize=1),(h||g)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Jt("SymbolBuffers",gp);class _p{constructor(t,o,h){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new h,this.segments=new xe,this.collisionVertexArray=new de}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,sp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Jt("CollisionBuffers",_p);class xc{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(E=>E.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ru([]),this.placementViewportMatrix=Ru([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=zh(this.zoom,o["text-size"]),this.iconSizeData=zh(this.zoom,o["icon-size"]);const h=this.layers[0].layout,g=h.get("symbol-sort-key"),b=h.get("symbol-z-order");this.canOverlap=ju(h,"text-overlap","text-allow-overlap")!=="never"||ju(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map(E=>d.WritingMode[E])),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=t.sourceID}createArrays(){this.text=new gp(new Ln(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new gp(new Ln(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ci,this.lineVertexArray=new ei,this.symbolInstances=new wt}calculateGlyphDependencies(t,o,h,g,b){for(let E=0;E<t.length;E++)if(o[t.charCodeAt(E)]=!0,(h||g)&&b){const z=Al[t.charAt(E)];z&&(o[z.charCodeAt(0)]=!0)}}populate(t,o,h){const g=this.layers[0],b=g.layout,E=b.get("text-font"),z=b.get("text-field"),D=b.get("icon-image"),O=(z.value.kind!=="constant"||z.value.value instanceof _e&&!z.value.value.isEmpty()||z.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),N=D.value.kind!=="constant"||!!D.value.value||Object.keys(D.parameters).length>0,U=b.get("symbol-sort-key");if(this.features=[],!O&&!N)return;const K=o.iconDependencies,$=o.glyphDependencies,Q=o.availableImages,se=new Yr(this.zoom);for(const{feature:pe,id:Ae,index:Be,sourceLayerIndex:je}of t){const Ve=g._featureFilter.needGeometry,it=Jn(pe,Ve);if(!g._featureFilter.filter(se,it,h))continue;let He,Ct;if(Ve||(it.geometry=_a(pe)),O){const ut=g.getValueAndResolveTokens("text-field",it,h,Q),St=_e.factory(ut);ey(St)&&(this.hasRTLText=!0),(!this.hasRTLText||Ql()==="unavailable"||this.hasRTLText&&un.isParsed())&&(He=ou(St,g,it))}if(N){const ut=g.getValueAndResolveTokens("icon-image",it,h,Q);Ct=ut instanceof fe?ut:fe.fromString(ut)}if(!He&&!Ct)continue;const Tt=this.sortFeaturesByKey?U.evaluate(it,{},h):void 0;if(this.features.push({id:Ae,text:He,icon:Ct,index:Be,sourceLayerIndex:je,geometry:it.geometry,properties:pe.properties,type:$m[pe.type],sortKey:Tt}),Ct&&(K[Ct.name]=!0),He){const ut=E.evaluate(it,{},h).join(","),St=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(d.WritingMode.vertical)>=0;for(const yt of He.sections)if(yt.image)K[yt.image.name]=!0;else{const kt=Qs(He.toString()),dt=yt.fontStack||ut,vt=$[dt]=$[dt]||{};this.calculateGlyphDependencies(yt.text,vt,St,this.allowVerticalPlacement,kt)}}}b.get("symbol-placement")==="line"&&(this.features=function(pe){const Ae={},Be={},je=[];let Ve=0;function it(ut){je.push(pe[ut]),Ve++}function He(ut,St,yt){const kt=Be[ut];return delete Be[ut],Be[St]=kt,je[kt].geometry[0].pop(),je[kt].geometry[0]=je[kt].geometry[0].concat(yt[0]),kt}function Ct(ut,St,yt){const kt=Ae[St];return delete Ae[St],Ae[ut]=kt,je[kt].geometry[0].shift(),je[kt].geometry[0]=yt[0].concat(je[kt].geometry[0]),kt}function Tt(ut,St,yt){const kt=yt?St[0][St[0].length-1]:St[0][0];return`${ut}:${kt.x}:${kt.y}`}for(let ut=0;ut<pe.length;ut++){const St=pe[ut],yt=St.geometry,kt=St.text?St.text.toString():null;if(!kt){it(ut);continue}const dt=Tt(kt,yt),vt=Tt(kt,yt,!0);if(dt in Be&&vt in Ae&&Be[dt]!==Ae[vt]){const ti=Ct(dt,vt,yt),$t=He(dt,vt,je[ti].geometry);delete Ae[dt],delete Be[vt],Be[Tt(kt,je[$t].geometry,!0)]=$t,je[ti].geometry=null}else dt in Be?He(dt,vt,yt):vt in Ae?Ct(dt,vt,yt):(it(ut),Ae[dt]=Ve-1,Be[vt]=Ve-1)}return je.filter(ut=>ut.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((pe,Ae)=>pe.sortKey-Ae.sortKey)}update(t,o,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,o,this.layers,h),this.icon.programConfigurations.updatePaintArrays(t,o,this.layers,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,o){const h=this.lineVertexArray.length;if(t.segment!==void 0){let g=t.dist(o[t.segment+1]),b=t.dist(o[t.segment]);const E={};for(let z=t.segment+1;z<o.length;z++)E[z]={x:o[z].x,y:o[z].y,tileUnitDistanceFromAnchor:g},z<o.length-1&&(g+=o[z+1].dist(o[z]));for(let z=t.segment||0;z>=0;z--)E[z]={x:o[z].x,y:o[z].y,tileUnitDistanceFromAnchor:b},z>0&&(b+=o[z-1].dist(o[z]));for(let z=0;z<o.length;z++){const D=E[z];this.lineVertexArray.emplaceBack(D.x,D.y,D.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(t,o,h,g,b,E,z,D,O,N,U,K){const $=t.indexArray,Q=t.layoutVertexArray,se=t.segments.prepareSegment(4*o.length,Q,$,this.canOverlap?E.sortKey:void 0),pe=this.glyphOffsetArray.length,Ae=se.vertexLength,Be=this.allowVerticalPlacement&&z===d.WritingMode.vertical?Math.PI/2:0,je=E.text&&E.text.sections;for(let Ve=0;Ve<o.length;Ve++){const{tl:it,tr:He,bl:Ct,br:Tt,tex:ut,pixelOffsetTL:St,pixelOffsetBR:yt,minFontScaleX:kt,minFontScaleY:dt,glyphOffset:vt,isSDF:ti,sectionIndex:$t}=o[Ve],Si=se.vertexLength,ki=vt[1];yp(Q,D.x,D.y,it.x,ki+it.y,ut.x,ut.y,h,ti,St.x,St.y,kt,dt),yp(Q,D.x,D.y,He.x,ki+He.y,ut.x+ut.w,ut.y,h,ti,yt.x,St.y,kt,dt),yp(Q,D.x,D.y,Ct.x,ki+Ct.y,ut.x,ut.y+ut.h,h,ti,St.x,yt.y,kt,dt),yp(Q,D.x,D.y,Tt.x,ki+Tt.y,ut.x+ut.w,ut.y+ut.h,h,ti,yt.x,yt.y,kt,dt),yd(t.dynamicLayoutVertexArray,D,Be),$.emplaceBack(Si,Si+1,Si+2),$.emplaceBack(Si+1,Si+2,Si+3),se.vertexLength+=4,se.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(vt[0]),Ve!==o.length-1&&$t===o[Ve+1].sectionIndex||t.programConfigurations.populatePaintArrays(Q.length,E,E.index,{},K,je&&je[$t])}t.placedSymbolArray.emplaceBack(D.x,D.y,pe,this.glyphOffsetArray.length-pe,Ae,O,N,D.segment,h?h[0]:0,h?h[1]:0,g[0],g[1],z,0,!1,0,U)}_addCollisionDebugVertex(t,o,h,g,b,E){return o.emplaceBack(0,0),t.emplaceBack(h.x,h.y,g,b,Math.round(E.x),Math.round(E.y))}addCollisionDebugVertices(t,o,h,g,b,E,z){const D=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),O=D.vertexLength,N=b.layoutVertexArray,U=b.collisionVertexArray,K=z.anchorX,$=z.anchorY;this._addCollisionDebugVertex(N,U,E,K,$,new bt(t,o)),this._addCollisionDebugVertex(N,U,E,K,$,new bt(h,o)),this._addCollisionDebugVertex(N,U,E,K,$,new bt(h,g)),this._addCollisionDebugVertex(N,U,E,K,$,new bt(t,g)),D.vertexLength+=4;const Q=b.indexArray;Q.emplaceBack(O,O+1),Q.emplaceBack(O+1,O+2),Q.emplaceBack(O+2,O+3),Q.emplaceBack(O+3,O),D.primitiveLength+=4}addDebugCollisionBoxes(t,o,h,g){for(let b=t;b<o;b++){const E=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(E.x1,E.y1,E.x2,E.y2,g?this.textCollisionBox:this.iconCollisionBox,E.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new _p(he,$r.members,Ce),this.iconCollisionBox=new _p(he,$r.members,Ce);for(let t=0;t<this.symbolInstances.length;t++){const o=this.symbolInstances.get(t);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(t,o,h,g,b,E,z,D,O){const N={};for(let U=o;U<h;U++){const K=t.get(U);N.textBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},N.textFeatureIndex=K.featureIndex;break}for(let U=g;U<b;U++){const K=t.get(U);N.verticalTextBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},N.verticalTextFeatureIndex=K.featureIndex;break}for(let U=E;U<z;U++){const K=t.get(U);N.iconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},N.iconFeatureIndex=K.featureIndex;break}for(let U=D;U<O;U++){const K=t.get(U);N.verticalIconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},N.verticalIconFeatureIndex=K.featureIndex;break}return N}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const h=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,o){const h=t.placedSymbolArray.get(o),g=h.vertexStartIndex+4*h.numGlyphs;for(let b=h.vertexStartIndex;b<g;b+=4)t.indexArray.emplaceBack(b,b+1,b+2),t.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(t),h=Math.cos(t),g=[],b=[],E=[];for(let z=0;z<this.symbolInstances.length;++z){E.push(z);const D=this.symbolInstances.get(z);g.push(0|Math.round(o*D.anchorX+h*D.anchorY)),b.push(D.featureIndex)}return E.sort((z,D)=>g[z]-g[D]||b[D]-b[z]),E}addToSortKeyRanges(t,o){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===o?h.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const h=this.symbolInstances.get(o);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((g,b,E)=>{g>=0&&E.indexOf(g)===b&&this.addIndicesForPlacedSymbol(this.text,g)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Jt("SymbolBucket",xc,{omit:["layers","collisionBoxArray","features","compareText"]}),xc.MAX_GLYPHS=65535,xc.addDynamicAttributes=yd;const ff=new cn({"symbol-placement":new ai(Ue.layout_symbol["symbol-placement"]),"symbol-spacing":new ai(Ue.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ai(Ue.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ut(Ue.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ai(Ue.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ai(Ue.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ai(Ue.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ai(Ue.layout_symbol["icon-ignore-placement"]),"icon-optional":new ai(Ue.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ai(Ue.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ut(Ue.layout_symbol["icon-size"]),"icon-text-fit":new ai(Ue.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ai(Ue.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ut(Ue.layout_symbol["icon-image"]),"icon-rotate":new Ut(Ue.layout_symbol["icon-rotate"]),"icon-padding":new ai(Ue.layout_symbol["icon-padding"]),"icon-keep-upright":new ai(Ue.layout_symbol["icon-keep-upright"]),"icon-offset":new Ut(Ue.layout_symbol["icon-offset"]),"icon-anchor":new Ut(Ue.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ai(Ue.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ai(Ue.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ai(Ue.layout_symbol["text-rotation-alignment"]),"text-field":new Ut(Ue.layout_symbol["text-field"]),"text-font":new Ut(Ue.layout_symbol["text-font"]),"text-size":new Ut(Ue.layout_symbol["text-size"]),"text-max-width":new Ut(Ue.layout_symbol["text-max-width"]),"text-line-height":new ai(Ue.layout_symbol["text-line-height"]),"text-letter-spacing":new Ut(Ue.layout_symbol["text-letter-spacing"]),"text-justify":new Ut(Ue.layout_symbol["text-justify"]),"text-radial-offset":new Ut(Ue.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ai(Ue.layout_symbol["text-variable-anchor"]),"text-anchor":new Ut(Ue.layout_symbol["text-anchor"]),"text-max-angle":new ai(Ue.layout_symbol["text-max-angle"]),"text-writing-mode":new ai(Ue.layout_symbol["text-writing-mode"]),"text-rotate":new Ut(Ue.layout_symbol["text-rotate"]),"text-padding":new ai(Ue.layout_symbol["text-padding"]),"text-keep-upright":new ai(Ue.layout_symbol["text-keep-upright"]),"text-transform":new Ut(Ue.layout_symbol["text-transform"]),"text-offset":new Ut(Ue.layout_symbol["text-offset"]),"text-allow-overlap":new ai(Ue.layout_symbol["text-allow-overlap"]),"text-overlap":new ai(Ue.layout_symbol["text-overlap"]),"text-ignore-placement":new ai(Ue.layout_symbol["text-ignore-placement"]),"text-optional":new ai(Ue.layout_symbol["text-optional"])});var eh={paint:new cn({"icon-opacity":new Ut(Ue.paint_symbol["icon-opacity"]),"icon-color":new Ut(Ue.paint_symbol["icon-color"]),"icon-halo-color":new Ut(Ue.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ut(Ue.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ut(Ue.paint_symbol["icon-halo-blur"]),"icon-translate":new ai(Ue.paint_symbol["icon-translate"]),"icon-translate-anchor":new ai(Ue.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ut(Ue.paint_symbol["text-opacity"]),"text-color":new Ut(Ue.paint_symbol["text-color"],{runtimeType:zn,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Ut(Ue.paint_symbol["text-halo-color"]),"text-halo-width":new Ut(Ue.paint_symbol["text-halo-width"]),"text-halo-blur":new Ut(Ue.paint_symbol["text-halo-blur"]),"text-translate":new ai(Ue.paint_symbol["text-translate"]),"text-translate-anchor":new ai(Ue.paint_symbol["text-translate-anchor"])}),layout:ff};class Nu{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Gr,this.defaultValue=t}evaluate(t){if(t.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Jt("FormatSectionOverride",Nu,{omit:["defaultValue"]});class th extends mn{constructor(t){super(t,eh)}recalculate(t,o){if(super.recalculate(t,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const g=[];for(const b of h)g.indexOf(b)<0&&g.push(b);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,o,h,g){const b=this.layout.get(t).evaluate(o,{},h,g),E=this._unevaluatedLayout._values[t];return E.isDataDriven()||ja(E.value)||!b?b:function(z,D){return D.replace(/{([^{}]+)}/g,(O,N)=>N in z?String(z[N]):"")}(o.properties,b)}createBucket(t){return new xc(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of eh.paint.overridableProperties){if(!th.hasPaintOverride(this.layout,t))continue;const o=this.paint.get(t),h=new Nu(o),g=new Au(h,o.property.specification);let b=null;b=o.value.kind==="constant"||o.value.kind==="source"?new Hl("source",g):new As("composite",g,o.value.zoomStops,o.value._interpolationType),this.paint._values[t]=new ga(o.property,b,o.parameters)}}_handleOverridablePaintPropertyUpdate(t,o,h){return!(!this.layout||o.isDataDriven()||h.isDataDriven())&&th.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,o){const h=t.get("text-field"),g=eh.paint.properties[o];let b=!1;const E=z=>{for(const D of z)if(g.overrides&&g.overrides.hasOverride(D))return void(b=!0)};if(h.value.kind==="constant"&&h.value.value instanceof _e)E(h.value.value.sections);else if(h.value.kind==="source"){const z=O=>{b||(O instanceof Ke&&Ie(O.value)===Lo?E(O.value.sections):O instanceof Bt?E(O.sections):O.eachChild(z))},D=h.value;D._styleExpression&&z(D._styleExpression.expression)}return b}}function ju(i,t,o){let h="never";const g=i.get(t);return g?h=g:i.get(o)&&(h="always"),h}var mf={paint:new cn({"background-color":new ai(Ue.paint_background["background-color"]),"background-pattern":new Eo(Ue.paint_background["background-pattern"]),"background-opacity":new ai(Ue.paint_background["background-opacity"])})},eo={paint:new cn({"raster-opacity":new ai(Ue.paint_raster["raster-opacity"]),"raster-hue-rotate":new ai(Ue.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ai(Ue.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ai(Ue.paint_raster["raster-brightness-max"]),"raster-saturation":new ai(Ue.paint_raster["raster-saturation"]),"raster-contrast":new ai(Ue.paint_raster["raster-contrast"]),"raster-resampling":new ai(Ue.paint_raster["raster-resampling"]),"raster-fade-duration":new ai(Ue.paint_raster["raster-fade-duration"])})};class pn extends mn{constructor(t){super(t,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}}const yf={circle:class extends mn{constructor(i){super(i,ru)}createBucket(i){return new xa(i)}queryRadius(i){const t=i;return fs("circle-radius",this,t)+fs("circle-stroke-width",this,t)+gr(this.paint.get("circle-translate"))}queryIntersectsFeature(i,t,o,h,g,b,E,z){const D=Wo(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,E),O=this.paint.get("circle-radius").evaluate(t,o)+this.paint.get("circle-stroke-width").evaluate(t,o),N=this.paint.get("circle-pitch-alignment")==="map",U=N?D:function($,Q){return $.map(se=>cc(se,Q))}(D,z),K=N?O*E:O;for(const $ of h)for(const Q of $){const se=N?Q:cc(Q,z);let pe=K;const Ae=rl([],[Q.x,Q.y,0,1],z);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?pe*=Ae[3]/b.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(pe*=b.cameraToCenterDistance/Ae[3]),Mu(U,se,pe))return!0}return!1}},heatmap:class extends mn{constructor(i){super(i,hc),this._updateColorRamp()}createBucket(i){return new rp(i)}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Zd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends mn{constructor(i){super(i,_m)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends mn{constructor(i){super(i,Hd)}recalculate(i,t){super.recalculate(i,t);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new ed(i)}queryRadius(){return gr(this.paint.get("fill-translate"))}queryIntersectsFeature(i,t,o,h,g,b,E){return tl(Wo(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,E),h)}isTileClipped(){return!0}},"fill-extrusion":class extends mn{constructor(i){super(i,Bm)}createBucket(i){return new id(i)}queryRadius(){return gr(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(i,t,o,h,g,b,E,z){const D=Wo(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,E),O=this.paint.get("fill-extrusion-height").evaluate(t,o),N=this.paint.get("fill-extrusion-base").evaluate(t,o),U=function($,Q,se,pe){const Ae=[];for(const Be of $){const je=[Be.x,Be.y,0,1];rl(je,je,Q),Ae.push(new bt(je[0]/je[3],je[1]/je[3]))}return Ae}(D,z),K=function($,Q,se,pe){const Ae=[],Be=[],je=pe[8]*Q,Ve=pe[9]*Q,it=pe[10]*Q,He=pe[11]*Q,Ct=pe[8]*se,Tt=pe[9]*se,ut=pe[10]*se,St=pe[11]*se;for(const yt of $){const kt=[],dt=[];for(const vt of yt){const ti=vt.x,$t=vt.y,Si=pe[0]*ti+pe[4]*$t+pe[12],ki=pe[1]*ti+pe[5]*$t+pe[13],Yi=pe[2]*ti+pe[6]*$t+pe[14],sr=pe[3]*ti+pe[7]*$t+pe[15],Ir=Yi+it,Sr=sr+He,dr=Si+Ct,Pr=ki+Tt,fr=Yi+ut,Mr=sr+St,Ri=new bt((Si+je)/Sr,(ki+Ve)/Sr);Ri.z=Ir/Sr,kt.push(Ri);const Wi=new bt(dr/Mr,Pr/Mr);Wi.z=fr/Mr,dt.push(Wi)}Ae.push(kt),Be.push(dt)}return[Ae,Be]}(h,N,O,z);return function($,Q,se){let pe=1/0;tl(se,Q)&&(pe=Ko(se,Q[0]));for(let Ae=0;Ae<Q.length;Ae++){const Be=Q[Ae],je=$[Ae];for(let Ve=0;Ve<Be.length-1;Ve++){const it=Be[Ve],He=[it,Be[Ve+1],je[Ve+1],je[Ve],it];Pu(se,He)&&(pe=Math.min(pe,Ko(se,He)))}}return pe!==1/0&&pe}(K[0],K[1],U)}},line:class extends mn{constructor(i){super(i,Qd),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Gs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,t){super.recalculate(i,t),this.paint._values["line-floorwidth"]=ef.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new rd(i)}queryRadius(i){const t=i,o=Kc(fs("line-width",this,t),fs("line-gap-width",this,t)),h=fs("line-offset",this,t);return o/2+Math.abs(h)+gr(this.paint.get("line-translate"))}queryIntersectsFeature(i,t,o,h,g,b,E){const z=Wo(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,E),D=E/2*Kc(this.paint.get("line-width").evaluate(t,o),this.paint.get("line-gap-width").evaluate(t,o)),O=this.paint.get("line-offset").evaluate(t,o);return O&&(h=function(N,U){const K=[];for(let $=0;$<N.length;$++){const Q=N[$],se=[];for(let pe=0;pe<Q.length;pe++){const Ae=Q[pe-1],Be=Q[pe],je=Q[pe+1],Ve=pe===0?new bt(0,0):Be.sub(Ae)._unit()._perp(),it=pe===Q.length-1?new bt(0,0):je.sub(Be)._unit()._perp(),He=Ve._add(it)._unit(),Ct=He.x*it.x+He.y*it.y;Ct!==0&&He._mult(1/Ct),se.push(He._mult(U)._add(Be))}K.push(se)}return K}(h,O*E)),function(N,U,K){for(let $=0;$<U.length;$++){const Q=U[$];if(N.length>=3){for(let se=0;se<Q.length;se++)if(ba(N,Q[se]))return!0}if(Lu(N,Q,K))return!0}return!1}(z,h,D)}isTileClipped(){return!0}},symbol:th,background:class extends mn{constructor(i){super(i,mf)}},raster:class extends mn{constructor(i){super(i,eo)}}};class gf{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const gd=63710088e-1;class Dn{constructor(t,o){if(isNaN(t)||isNaN(o))throw new Error(`Invalid LngLat object: (${t}, ${o})`);if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Dn(Me(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const o=Math.PI/180,h=this.lat*o,g=t.lat*o,b=Math.sin(h)*Math.sin(g)+Math.cos(h)*Math.cos(g)*Math.cos((t.lng-this.lng)*o);return gd*Math.acos(Math.min(b,1))}toBounds(t=0){const o=360*t/40075017,h=o/Math.cos(Math.PI/180*this.lat);return new Vu(new Dn(this.lng-h,this.lat-o),new Dn(this.lng+h,this.lat+o))}static convert(t){if(t instanceof Dn)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Dn(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Dn(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Vu{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Dn?new Dn(t.lng,t.lat):Dn.convert(t),this}setSouthWest(t){return this._sw=t instanceof Dn?new Dn(t.lng,t.lat):Dn.convert(t),this}extend(t){const o=this._sw,h=this._ne;let g,b;if(t instanceof Dn)g=t,b=t;else{if(!(t instanceof Vu))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Vu.convert(t)):this.extend(Dn.convert(t)):this;if(g=t._sw,b=t._ne,!g||!b)return this}return o||h?(o.lng=Math.min(g.lng,o.lng),o.lat=Math.min(g.lat,o.lat),h.lng=Math.max(b.lng,h.lng),h.lat=Math.max(b.lat,h.lat)):(this._sw=new Dn(g.lng,g.lat),this._ne=new Dn(b.lng,b.lat)),this}getCenter(){return new Dn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Dn(this.getWest(),this.getNorth())}getSouthEast(){return new Dn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:h}=Dn.convert(t);let g=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&g}static convert(t){return t instanceof Vu?t:t&&new Vu(t)}}const vp=2*Math.PI*gd;function qu(i){return vp*Math.cos(i*Math.PI/180)}function Gu(i){return(180+i)/360}function _d(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function jn(i,t){return i/qu(t)}function bc(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class Ls{constructor(t,o,h=0){this.x=+t,this.y=+o,this.z=+h}static fromLngLat(t,o=0){const h=Dn.convert(t);return new Ls(Gu(h.lng),_d(h.lat),jn(o,h.lat))}toLngLat(){return new Dn(360*this.x-180,bc(this.y))}toAltitude(){return this.z*qu(bc(this.y))}meterInMercatorCoordinateUnits(){return 1/vp*(t=bc(this.y),1/Math.cos(t*Math.PI/180));var t}}function Oh(i,t,o){var h=2*Math.PI*6378137/256/Math.pow(2,o);return[i*h-2*Math.PI*6378137/2,t*h-2*Math.PI*6378137/2]}class ih{constructor(t,o,h){this.z=t,this.x=o,this.y=h,this.key=ys(0,t,t,o,h)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,o,h){const g=(E=this.y,z=this.z,D=Oh(256*(b=this.x),256*(E=Math.pow(2,z)-E-1),z),O=Oh(256*(b+1),256*(E+1),z),D[0]+","+D[1]+","+O[0]+","+O[1]);var b,E,z,D,O;const N=function(U,K,$){let Q,se="";for(let pe=U;pe>0;pe--)Q=1<<pe-1,se+=(K&Q?1:0)+($&Q?2:0);return se}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,N).replace(/{bbox-epsg-3857}/g,g)}getTilePoint(t){const o=Math.pow(2,this.z);return new bt((t.x*o-this.x)*lr,(t.y*o-this.y)*lr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class xp{constructor(t,o){this.wrap=t,this.canonical=o,this.key=ys(t,o.z,o.z,o.x,o.y)}}class la{constructor(t,o,h,g,b){this.overscaledZ=t,this.wrap=o,this.canonical=new ih(h,+g,+b),this.key=ys(o,t,h,g,b)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const o=this.canonical.z-t;return t>this.canonical.z?new la(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new la(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(t,o){const h=this.canonical.z-t;return t>this.canonical.z?ys(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y):ys(this.wrap*+o,t,t,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o}children(t){if(this.overscaledZ>=t)return[new la(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,h=2*this.canonical.x,g=2*this.canonical.y;return[new la(o,this.wrap,o,h,g),new la(o,this.wrap,o,h+1,g),new la(o,this.wrap,o,h,g+1),new la(o,this.wrap,o,h+1,g+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new la(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new la(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new xp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Ls(t.x-this.wrap,t.y))}}function ys(i,t,o,h,g){(i*=2)<0&&(i=-1*i-1);const b=1<<o;return(b*b*i+b*g+h).toString(36)+o.toString(36)+t.toString(36)}Jt("CanonicalTileID",ih),Jt("OverscaledTileID",la,{omit:["posMatrix"]});class vd{constructor(t,o,h){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void ct(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const g=this.dim=o.height-2;this.data=new Uint32Array(o.data.buffer),this.encoding=h||"mapbox";for(let b=0;b<g;b++)this.data[this._idx(-1,b)]=this.data[this._idx(0,b)],this.data[this._idx(g,b)]=this.data[this._idx(g-1,b)],this.data[this._idx(b,-1)]=this.data[this._idx(b,0)],this.data[this._idx(b,g)]=this.data[this._idx(b,g-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(g,-1)]=this.data[this._idx(g-1,0)],this.data[this._idx(-1,g)]=this.data[this._idx(0,g-1)],this.data[this._idx(g,g)]=this.data[this._idx(g-1,g-1)]}get(t,o){const h=new Uint8Array(this.data.buffer),g=4*this._idx(t,o);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(h[g],h[g+1],h[g+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)}_unpackMapbox(t,o,h){return(256*t*256+256*o+h)/10-1e4}_unpackTerrarium(t,o,h){return 256*t+o+h/256-32768}getPixels(){return new ms({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,o,h){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let g=o*this.dim,b=o*this.dim+this.dim,E=h*this.dim,z=h*this.dim+this.dim;switch(o){case-1:g=b-1;break;case 1:b=g+1}switch(h){case-1:E=z-1;break;case 1:z=E+1}const D=-o*this.dim,O=-h*this.dim;for(let N=E;N<z;N++)for(let U=g;U<b;U++)this.data[this._idx(U,N)]=t.data[this._idx(U+D,N+O)]}}Jt("DEMData",vd);class xd{constructor(t){this._stringToNumber={},this._numberToString=[];for(let o=0;o<t.length;o++){const h=t[o];this._stringToNumber[h]=o,this._numberToString[o]=h}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}class _f{constructor(t,o,h,g,b){this.type="Feature",this._vectorTileFeature=t,t._z=o,t._x=h,t._y=g,this.properties=t.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(t[o]=this[o]);return t}}class uo{constructor(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Qi(lr,16,0),this.grid3D=new Qi(lr,16,0),this.featureIndexArray=new u,this.promoteId=o}insert(t,o,h,g,b,E){const z=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,g,b);const D=E?this.grid3D:this.grid;for(let O=0;O<o.length;O++){const N=o[O],U=[1/0,1/0,-1/0,-1/0];for(let K=0;K<N.length;K++){const $=N[K];U[0]=Math.min(U[0],$.x),U[1]=Math.min(U[1],$.y),U[2]=Math.max(U[2],$.x),U[3]=Math.max(U[3],$.y)}U[0]<lr&&U[1]<lr&&U[2]>=0&&U[3]>=0&&D.insert(z,U[0],U[1],U[2],U[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Ou.VectorTile(new nd(this.rawTileData)).layers,this.sourceLayerCoder=new xd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,o,h,g){this.loadVTLayers();const b=t.params||{},E=lr/t.tileSize/t.scale,z=Cs(b.filter),D=t.queryGeometry,O=t.queryPadding*E,N=bd(D),U=this.grid.query(N.minX-O,N.minY-O,N.maxX+O,N.maxY+O),K=bd(t.cameraQueryGeometry),$=this.grid3D.query(K.minX-O,K.minY-O,K.maxX+O,K.maxY+O,(pe,Ae,Be,je)=>function(Ve,it,He,Ct,Tt){for(const St of Ve)if(it<=St.x&&He<=St.y&&Ct>=St.x&&Tt>=St.y)return!0;const ut=[new bt(it,He),new bt(it,Tt),new bt(Ct,Tt),new bt(Ct,He)];if(Ve.length>2){for(const St of ut)if(ba(Ve,St))return!0}for(let St=0;St<Ve.length-1;St++)if(Tl(Ve[St],Ve[St+1],ut))return!0;return!1}(t.cameraQueryGeometry,pe-O,Ae-O,Be+O,je+O));for(const pe of $)U.push(pe);U.sort(e);const Q={};let se;for(let pe=0;pe<U.length;pe++){const Ae=U[pe];if(Ae===se)continue;se=Ae;const Be=this.featureIndexArray.get(Ae);let je=null;this.loadMatchingFeature(Q,Be.bucketIndex,Be.sourceLayerIndex,Be.featureIndex,z,b.layers,b.availableImages,o,h,g,(Ve,it,He)=>(je||(je=_a(Ve)),it.queryIntersectsFeature(D,Ve,He,je,this.z,t.transform,E,t.pixelPosMatrix)))}return Q}loadMatchingFeature(t,o,h,g,b,E,z,D,O,N,U){const K=this.bucketLayerIDs[o];if(E&&!function(pe,Ae){for(let Be=0;Be<pe.length;Be++)if(Ae.indexOf(pe[Be])>=0)return!0;return!1}(E,K))return;const $=this.sourceLayerCoder.decode(h),Q=this.vtLayers[$].feature(g);if(b.needGeometry){const pe=Jn(Q,!0);if(!b.filter(new Yr(this.tileID.overscaledZ),pe,this.tileID.canonical))return}else if(!b.filter(new Yr(this.tileID.overscaledZ),Q))return;const se=this.getId(Q,$);for(let pe=0;pe<K.length;pe++){const Ae=K[pe];if(E&&E.indexOf(Ae)<0)continue;const Be=D[Ae];if(!Be)continue;let je={};se&&N&&(je=N.getState(Be.sourceLayer||"_geojsonTileLayer",se));const Ve=ke({},O[Ae]);Ve.paint=hu(Ve.paint,Be.paint,Q,je,z),Ve.layout=hu(Ve.layout,Be.layout,Q,je,z);const it=!U||U(Q,Be,je);if(!it)continue;const He=new _f(Q,this.z,this.x,this.y,se);He.layer=Ve;let Ct=t[Ae];Ct===void 0&&(Ct=t[Ae]=[]),Ct.push({featureIndex:g,feature:He,intersectionZ:it})}}lookupSymbolFeatures(t,o,h,g,b,E,z,D){const O={};this.loadVTLayers();const N=Cs(b);for(const U of t)this.loadMatchingFeature(O,h,g,U,N,E,z,D,o);return O}hasLayer(t){for(const o of this.bucketLayerIDs)for(const h of o)if(t===h)return!0;return!1}getId(t,o){let h=t.id;return this.promoteId&&(h=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof h=="boolean"&&(h=Number(h))),h}}function hu(i,t,o,h,g){return ft(i,(b,E)=>{const z=t instanceof qo?t.get(E):null;return z&&z.evaluate?z.evaluate(o,h,g):z})}function bd(i){let t=1/0,o=1/0,h=-1/0,g=-1/0;for(const b of i)t=Math.min(t,b.x),o=Math.min(o,b.y),h=Math.max(h,b.x),g=Math.max(g,b.y);return{minX:t,minY:o,maxX:h,maxY:g}}function e(i,t){return t-i}var r;Jt("FeatureIndex",uo,{omit:["rawTileData","sourceLayerCoder"]}),d.PerformanceMarkers=void 0,(r=d.PerformanceMarkers||(d.PerformanceMarkers={})).create="create",r.load="load",r.fullLoad="fullLoad";let s=null,_=[];const w=1e3/30,C={mark(i){performance.mark(i)},frame(i){const t=i;s!=null&&_.push(t-s),s=t},clearMetrics(){s=null,_=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const i in d.PerformanceMarkers)performance.clearMarks(d.PerformanceMarkers[i])},getPerformanceMetrics(){performance.measure("loadTime",d.PerformanceMarkers.create,d.PerformanceMarkers.load),performance.measure("fullLoadTime",d.PerformanceMarkers.create,d.PerformanceMarkers.fullLoad);const i=performance.getEntriesByName("loadTime")[0].duration,t=performance.getEntriesByName("fullLoadTime")[0].duration,o=_.length,h=1/(_.reduce((b,E)=>b+E,0)/o/1e3),g=_.filter(b=>b>w).reduce((b,E)=>b+(E-w)/w,0);return{loadTime:i,fullLoadTime:t,fps:h,percentDroppedFrames:g/(o+g)*100}}};d.AJAXError=rt,d.ARRAY_TYPE=Du,d.Actor=class{constructor(i,t,o){this.target=i,this.parent=t,this.mapId=o,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},We(["receive","process"],this),this.invoker=new gf(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=pi()?i:window}send(i,t,o,h,g=!1){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(this.callbacks[b]=o);const E=Xt(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:i,hasCallback:!!o,targetMapId:h,mustQueue:g,sourceMapId:this.mapId,data:Ga(t,E)},E),{cancel:()=>{o&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(i){const t=i.data,o=t.id;if(o&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[o];const h=this.cancelCallbacks[o];delete this.cancelCallbacks[o],h&&h()}else pi()||t.mustQueue?(this.tasks[o]=t,this.taskQueue.push(o),this.invoker.trigger()):this.processTask(o,t)}process(){if(!this.taskQueue.length)return;const i=this.taskQueue.shift(),t=this.tasks[i];delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(i,t)}processTask(i,t){if(t.type==="<response>"){const o=this.callbacks[i];delete this.callbacks[i],o&&(t.error?o(Aa(t.error)):o(null,Aa(t.data)))}else{let o=!1;const h=Xt(this.globalScope)?void 0:[],g=t.hasCallback?(z,D)=>{o=!0,delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:z?Ga(z):null,data:Ga(D,h)},h)}:z=>{o=!0};let b=null;const E=Aa(t.data);if(this.parent[t.type])b=this.parent[t.type](t.sourceMapId,E,g);else if(this.parent.getWorkerSource){const z=t.type.split(".");b=this.parent.getWorkerSource(t.sourceMapId,z[0],E.source)[z[1]](E,g)}else g(new Error(`Could not find function ${t.type}`));!o&&b&&b.cancel&&(this.cancelCallbacks[i]=b.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},d.AlphaImage=_h,d.CanonicalTileID=ih,d.CollisionBoxArray=ht,d.CollisionCircleLayoutArray=class extends ee{},d.Color=W,d.DEMData=vd,d.DataConstantProperty=ai,d.DictionaryCoder=xd,d.EXTENT=lr,d.ErrorEvent=Zn,d.EvaluationParameters=Yr,d.Event=_o,d.Evented=Ra,d.FeatureIndex=uo,d.FillBucket=ed,d.FillExtrusionBucket=id,d.GeoJSONFeature=_f,d.ImageAtlas=ld,d.ImagePosition=sd,d.LineBucket=rd,d.LineStripIndexArray=class extends nt{},d.LngLat=Dn,d.LngLatBounds=Vu,d.MercatorCoordinate=Ls,d.ONE_EM=So,d.OverscaledTileID=la,d.PerformanceUtils=C,d.PosArray=class extends Mn{},d.Properties=cn,d.QuadTriangleArray=class extends ue{},d.RGBAImage=ms,d.RasterBoundsArray=class extends Bo{},d.RequestPerformance=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},d.ResourceType=Rt,d.SegmentVector=xe,d.SymbolBucket=xc,d.Transitionable=Ca,d.TriangleIndexArray=me,d.Uniform1f=ar,d.Uniform1i=class extends hi{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},d.Uniform2f=class extends hi{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},d.Uniform3f=class extends hi{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},d.Uniform4f=ri,d.UniformColor=Di,d.UniformMatrix4f=class extends hi{constructor(i,t){super(i,t),this.current=er}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},d.UnwrappedTileID=xp,d.ValidationError=_t,d.ZoomHistory=Yl,d.addDynamicAttributes=yd,d.asyncAll=function(i,t,o){if(!i.length)return o(null,[]);let h=i.length;const g=new Array(i.length);let b=null;i.forEach((E,z)=>{t(E,(D,O)=>{D&&(b=D),g[z]=O,--h==0&&o(b,g)})})},d.bezier=V,d.bindAll=We,d.cacheEntryPossiblyAdded=function(i){Xi++,Xi>Bi&&(i.getActor().send("enforceCacheSizeLimit",fi),Xi=0)},d.clamp=X,d.clearTileCache=function(i){const t=caches.delete(wr);i&&t.catch(i).then(()=>i())},d.clipLine=_c,d.clone=function(i){var t=new Du(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},d.clone$1=Ze,d.collisionCircleLayout=nf,d.config=hr,d.create=function(){var i=new Du(16);return Du!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},d.createExpression=Va,d.createFilter=Cs,d.createLayout=qt,d.createStyleLayer=function(i){return i.type==="custom"?new pn(i):new yf[i.type](i)},d.dot=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]*t[3]},d.ease=G,d.emitValidationErrors=us,d.enforceCacheSizeLimit=function(i){Nt(),Dt&&Dt.then(t=>{t.keys().then(o=>{for(let h=0;h<o.length-i;h++)t.delete(o[h])})})},d.evaluateSizeForFeature=function(i,{uSize:t,uSizeT:o},{lowerSize:h,upperSize:g}){return i.kind==="source"?h/Cl:i.kind==="composite"?Un(h/Cl,g/Cl,o):t},d.evaluateSizeForZoom=function(i,t){let o=0,h=0;if(i.kind==="constant")h=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:g,minZoom:b,maxZoom:E}=i,z=g?X(so.interpolationFactor(g,t,b,E),0,1):0;i.kind==="camera"?h=Un(i.minSize,i.maxSize,z):o=z}return{uSizeT:o,uSize:h}},d.evaluateVariableOffset=Qc,d.evented=hs,d.exported=Ei,d.exported$1=Li,d.extend=ke,d.filterObject=Ge,d.getAnchorAlignment=hp,d.getAnchorJustification=Or,d.getArrayBuffer=no,d.getImage=Gn,d.getJSON=function(i,t){return Cr(ke(i,{type:"json"}),t)},d.getOverlapMode=ju,d.getRTLTextPluginStatus=Ql,d.getReferrer=yi,d.getVideo=function(i,t){const o=window.document.createElement("video");o.muted=!0,o.onloadstart=function(){t(null,o)};for(let h=0;h<i.length;h++){const g=window.document.createElement("source");qn(i[h])||(o.crossOrigin="Anonymous"),g.src=i[h],o.appendChild(g)}return{cancel:()=>{}}},d.identity=Ru,d.invert=function(i,t){var o=t[0],h=t[1],g=t[2],b=t[3],E=t[4],z=t[5],D=t[6],O=t[7],N=t[8],U=t[9],K=t[10],$=t[11],Q=t[12],se=t[13],pe=t[14],Ae=t[15],Be=o*z-h*E,je=o*D-g*E,Ve=o*O-b*E,it=h*D-g*z,He=h*O-b*z,Ct=g*O-b*D,Tt=N*se-U*Q,ut=N*pe-K*Q,St=N*Ae-$*Q,yt=U*pe-K*se,kt=U*Ae-$*se,dt=K*Ae-$*pe,vt=Be*dt-je*kt+Ve*yt+it*St-He*ut+Ct*Tt;return vt?(i[0]=(z*dt-D*kt+O*yt)*(vt=1/vt),i[1]=(g*kt-h*dt-b*yt)*vt,i[2]=(se*Ct-pe*He+Ae*it)*vt,i[3]=(K*He-U*Ct-$*it)*vt,i[4]=(D*St-E*dt-O*ut)*vt,i[5]=(o*dt-g*St+b*ut)*vt,i[6]=(pe*Ve-Q*Ct-Ae*je)*vt,i[7]=(N*Ct-K*Ve+$*je)*vt,i[8]=(E*kt-z*St+O*Tt)*vt,i[9]=(h*St-o*kt-b*Tt)*vt,i[10]=(Q*He-se*Ve+Ae*Be)*vt,i[11]=(U*Ve-N*He-$*Be)*vt,i[12]=(z*ut-E*yt-D*Tt)*vt,i[13]=(o*yt-h*ut+g*Tt)*vt,i[14]=(se*je-Q*it-pe*Be)*vt,i[15]=(N*it-U*je+K*Be)*vt,i):null},d.isImageBitmap=Qt,d.isSafari=Xt,d.keysDifference=function(i,t){const o=[];for(const h in i)h in t||o.push(h);return o},d.lazyLoadRTLTextPlugin=function(){un.isLoading()||un.isLoaded()||Ql()!=="deferred"||Ro()},d.makeRequest=Cr,d.mapObject=ft,d.mercatorXfromLng=Gu,d.mercatorYfromLat=_d,d.mercatorZfromAltitude=jn,d.mul=ip,d.multiply=tp,d.nextPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},d.number=Un,d.ortho=function(i,t,o,h,g,b,E){var z=1/(t-o),D=1/(h-g),O=1/(b-E);return i[0]=-2*z,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*D,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*O,i[11]=0,i[12]=(t+o)*z,i[13]=(g+h)*D,i[14]=(E+b)*O,i[15]=1,i},d.parseCacheControl=Et,d.parseGlyphPBF=function(i){return new nd(i).readFields(up,[])},d.pbf=nd,d.performSymbolLayout=function(i,t,o,h,g,b,E){i.createArrays(),i.tilePixelRatio=lr/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const z=i.layers[0].layout,D=i.layers[0]._unevaluatedLayout._values,O={layoutIconSize:D["icon-size"].possiblyEvaluate(new Yr(i.zoom+1),E),layoutTextSize:D["text-size"].possiblyEvaluate(new Yr(i.zoom+1),E),textMaxSize:D["text-size"].possiblyEvaluate(new Yr(18))};if(i.textSizeData.kind==="composite"){const{minZoom:Q,maxZoom:se}=i.textSizeData;O.compositeTextSizes=[D["text-size"].possiblyEvaluate(new Yr(Q),E),D["text-size"].possiblyEvaluate(new Yr(se),E)]}if(i.iconSizeData.kind==="composite"){const{minZoom:Q,maxZoom:se}=i.iconSizeData;O.compositeIconSizes=[D["icon-size"].possiblyEvaluate(new Yr(Q),E),D["icon-size"].possiblyEvaluate(new Yr(se),E)]}const N=z.get("text-line-height")*So,U=z.get("text-rotation-alignment")!=="viewport"&&z.get("symbol-placement")!=="point",K=z.get("text-keep-upright"),$=z.get("text-size");for(const Q of i.features){const se=z.get("text-font").evaluate(Q,{},E).join(","),pe=$.evaluate(Q,{},E),Ae=O.layoutTextSize.evaluate(Q,{},E),Be=O.layoutIconSize.evaluate(Q,{},E),je={horizontal:{},vertical:void 0},Ve=Q.text;let it,He=[0,0];if(Ve){const ut=Ve.toString(),St=z.get("text-letter-spacing").evaluate(Q,{},E)*So,yt=wl(ut)?St:0,kt=z.get("text-anchor").evaluate(Q,{},E),dt=z.get("text-variable-anchor");if(!dt){const ki=z.get("text-radial-offset").evaluate(Q,{},E);He=ki?Qc(kt,[ki*So,Uu]):z.get("text-offset").evaluate(Q,{},E).map(Yi=>Yi*So)}let vt=U?"center":z.get("text-justify").evaluate(Q,{},E);const ti=z.get("symbol-placement"),$t=ti==="point"?z.get("text-max-width").evaluate(Q,{},E)*So:0,Si=()=>{i.allowVerticalPlacement&&Qs(ut)&&(je.vertical=kh(Ve,t,o,g,se,$t,N,kt,"left",yt,He,d.WritingMode.vertical,!0,ti,Ae,pe))};if(!U&&dt){const ki=vt==="auto"?dt.map(sr=>Or(sr)):[vt];let Yi=!1;for(let sr=0;sr<ki.length;sr++){const Ir=ki[sr];if(!je.horizontal[Ir])if(Yi)je.horizontal[Ir]=je.horizontal[0];else{const Sr=kh(Ve,t,o,g,se,$t,N,"center",Ir,yt,He,d.WritingMode.horizontal,!1,ti,Ae,pe);Sr&&(je.horizontal[Ir]=Sr,Yi=Sr.positionedLines.length===1)}}Si()}else{vt==="auto"&&(vt=Or(kt));const ki=kh(Ve,t,o,g,se,$t,N,kt,vt,yt,He,d.WritingMode.horizontal,!1,ti,Ae,pe);ki&&(je.horizontal[vt]=ki),Si(),Qs(ut)&&U&&K&&(je.vertical=kh(Ve,t,o,g,se,$t,N,kt,vt,yt,He,d.WritingMode.vertical,!1,ti,Ae,pe))}}let Ct=!1;if(Q.icon&&Q.icon.name){const ut=h[Q.icon.name];ut&&(it=Zm(g[Q.icon.name],z.get("icon-offset").evaluate(Q,{},E),z.get("icon-anchor").evaluate(Q,{},E)),Ct=!!ut.sdf,i.sdfIcons===void 0?i.sdfIcons=Ct:i.sdfIcons!==Ct&&ct("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ut.pixelRatio!==i.pixelRatio||z.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const Tt=df(je.horizontal)||je.vertical;i.iconsInText=!!Tt&&Tt.iconsInText,(Tt||it)&&Jm(i,Q,je,it,h,O,Ae,Be,He,Ct,E)}b&&i.generateCollisionDebugBuffers()},d.perspective=function(i,t,o,h,g){var b,E=1/Math.tan(t/2);return i[0]=E/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=E,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,g!=null&&g!==1/0?(i[10]=(g+h)*(b=1/(h-g)),i[14]=2*g*h*b):(i[10]=-1,i[14]=-2*h),i},d.pick=function(i,t){const o={};for(let h=0;h<t.length;h++){const g=t[h];g in i&&(o[g]=i[g])}return o},d.plugin=un,d.pointGeometry=bt,d.polygonIntersectsPolygon=Pu,d.potpack=ad,d.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],d.register=Jt,d.registerForPluginStateChange=function(i){return i({pluginStatus:on,pluginURL:Za}),hs.on("pluginStateChange",i),i},d.renderColorRamp=Zd,d.rotateX=function(i,t,o){var h=Math.sin(o),g=Math.cos(o),b=t[4],E=t[5],z=t[6],D=t[7],O=t[8],N=t[9],U=t[10],K=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=b*g+O*h,i[5]=E*g+N*h,i[6]=z*g+U*h,i[7]=D*g+K*h,i[8]=O*g-b*h,i[9]=N*g-E*h,i[10]=U*g-z*h,i[11]=K*g-D*h,i},d.rotateZ=function(i,t,o){var h=Math.sin(o),g=Math.cos(o),b=t[0],E=t[1],z=t[2],D=t[3],O=t[4],N=t[5],U=t[6],K=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=b*g+O*h,i[1]=E*g+N*h,i[2]=z*g+U*h,i[3]=D*g+K*h,i[4]=O*g-b*h,i[5]=N*g-E*h,i[6]=U*g-z*h,i[7]=K*g-D*h,i},d.scale=function(i,t,o){var h=o[0],g=o[1],b=o[2];return i[0]=t[0]*h,i[1]=t[1]*h,i[2]=t[2]*h,i[3]=t[3]*h,i[4]=t[4]*g,i[5]=t[5]*g,i[6]=t[6]*g,i[7]=t[7]*g,i[8]=t[8]*b,i[9]=t[9]*b,i[10]=t[10]*b,i[11]=t[11]*b,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},d.scale$1=function(i,t,o){return i[0]=t[0]*o,i[1]=t[1]*o,i[2]=t[2]*o,i[3]=t[3]*o,i},d.setCacheLimits=function(i,t){fi=i,Bi=t},d.setRTLTextPlugin=function(i,t,o=!1){if(on===fo||on===Il||on===zs)throw new Error("setRTLTextPlugin cannot be called multiple times.");Za=Ei.resolveURL(i),on=fo,aa=t,$l(),o||Ro()},d.spec=Ue,d.sphericalToCartesian=function([i,t,o]){return t+=90,t*=Math.PI/180,o*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(o),y:i*Math.sin(t)*Math.sin(o),z:i*Math.cos(o)}},d.toEvaluationFeature=Jn,d.transformMat4=rl,d.translate=function(i,t,o){var h,g,b,E,z,D,O,N,U,K,$,Q,se=o[0],pe=o[1],Ae=o[2];return t===i?(i[12]=t[0]*se+t[4]*pe+t[8]*Ae+t[12],i[13]=t[1]*se+t[5]*pe+t[9]*Ae+t[13],i[14]=t[2]*se+t[6]*pe+t[10]*Ae+t[14],i[15]=t[3]*se+t[7]*pe+t[11]*Ae+t[15]):(g=t[1],b=t[2],E=t[3],z=t[4],D=t[5],O=t[6],N=t[7],U=t[8],K=t[9],$=t[10],Q=t[11],i[0]=h=t[0],i[1]=g,i[2]=b,i[3]=E,i[4]=z,i[5]=D,i[6]=O,i[7]=N,i[8]=U,i[9]=K,i[10]=$,i[11]=Q,i[12]=h*se+z*pe+U*Ae+t[12],i[13]=g*se+D*pe+K*Ae+t[13],i[14]=b*se+O*pe+$*Ae+t[14],i[15]=E*se+N*pe+Q*Ae+t[15]),i},d.triggerPluginCompletionEvent=Vt,d.unicodeBlockLookup=ii,d.uniqueId=function(){return qe++},d.validateCustomStyleLayer=function(i){const t=[],o=i.id;return o===void 0&&t.push({message:`layers.${o}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${o}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),t},d.validateLight=nn,d.validateStyle=oa,d.vectorTile=Ou,d.warnOnce=ct,d.wrap=Me}),P(["./shared"],function(d){function R(ae){const H=typeof ae;if(H==="number"||H==="boolean"||H==="string"||ae==null)return JSON.stringify(ae);if(Array.isArray(ae)){let ce="[";for(const _e of ae)ce+=`${R(_e)},`;return`${ce}]`}const W=Object.keys(ae).sort();let ne="{";for(let ce=0;ce<W.length;ce++)ne+=`${JSON.stringify(W[ce])}:${R(ae[W[ce]])},`;return`${ne}}`}function q(ae){let H="";for(const W of d.refProperties)H+=`/${R(ae[W])}`;return H}class V{constructor(H){this.keyCache={},H&&this.replace(H)}replace(H){this._layerConfigs={},this._layers={},this.update(H,[])}update(H,W){for(const ce of H){this._layerConfigs[ce.id]=ce;const _e=this._layers[ce.id]=d.createStyleLayer(ce);_e._featureFilter=d.createFilter(_e.filter),this.keyCache[ce.id]&&delete this.keyCache[ce.id]}for(const ce of W)delete this.keyCache[ce],delete this._layerConfigs[ce],delete this._layers[ce];this.familiesBySource={};const ne=function(ce,_e){const fe={};for(let we=0;we<ce.length;we++){const Ie=_e&&_e[ce[we].id]||q(ce[we]);_e&&(_e[ce[we].id]=Ie);let et=fe[Ie];et||(et=fe[Ie]=[]),et.push(ce[we])}const Ee=[];for(const we in fe)Ee.push(fe[we]);return Ee}(Object.values(this._layerConfigs),this.keyCache);for(const ce of ne){const _e=ce.map(Ke=>this._layers[Ke.id]),fe=_e[0];if(fe.visibility==="none")continue;const Ee=fe.source||"";let we=this.familiesBySource[Ee];we||(we=this.familiesBySource[Ee]={});const Ie=fe.sourceLayer||"_geojsonTileLayer";let et=we[Ie];et||(et=we[Ie]=[]),et.push(_e)}}}class G{constructor(H){const W={},ne=[];for(const Ee in H){const we=H[Ee],Ie=W[Ee]={};for(const et in we){const Ke=we[+et];if(!Ke||Ke.bitmap.width===0||Ke.bitmap.height===0)continue;const tt={x:0,y:0,w:Ke.bitmap.width+2,h:Ke.bitmap.height+2};ne.push(tt),Ie[et]={rect:tt,metrics:Ke.metrics}}}const{w:ce,h:_e}=d.potpack(ne),fe=new d.AlphaImage({width:ce||1,height:_e||1});for(const Ee in H){const we=H[Ee];for(const Ie in we){const et=we[+Ie];if(!et||et.bitmap.width===0||et.bitmap.height===0)continue;const Ke=W[Ee][Ie].rect;d.AlphaImage.copy(et.bitmap,fe,{x:0,y:0},{x:Ke.x+1,y:Ke.y+1},et.bitmap)}}this.image=fe,this.positions=W}}d.register("GlyphAtlas",G);class X{constructor(H){this.tileID=new d.OverscaledTileID(H.tileID.overscaledZ,H.tileID.wrap,H.tileID.canonical.z,H.tileID.canonical.x,H.tileID.canonical.y),this.uid=H.uid,this.zoom=H.zoom,this.pixelRatio=H.pixelRatio,this.tileSize=H.tileSize,this.source=H.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=H.showCollisionBoxes,this.collectResourceTiming=!!H.collectResourceTiming,this.returnDependencies=!!H.returnDependencies,this.promoteId=H.promoteId}parse(H,W,ne,ce,_e){this.status="parsing",this.data=H,this.collisionBoxArray=new d.CollisionBoxArray;const fe=new d.DictionaryCoder(Object.keys(H.layers).sort()),Ee=new d.FeatureIndex(this.tileID,this.promoteId);Ee.bucketLayerIDs=[];const we={},Ie={featureIndex:Ee,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ne},et=W.familiesBySource[this.source];for(const Ii in et){const li=H.layers[Ii];if(!li)continue;li.version===1&&d.warnOnce(`Vector tile source "${this.source}" layer "${Ii}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Kt=fe.encode(Ii),Pi=[];for(let _r=0;_r<li.length;_r++){const Sn=li.feature(_r),Er=Ee.getId(Sn,Ii);Pi.push({feature:Sn,id:Er,index:_r,sourceLayerIndex:Kt})}for(const _r of et[Ii]){const Sn=_r[0];Sn.minzoom&&this.zoom<Math.floor(Sn.minzoom)||Sn.maxzoom&&this.zoom>=Sn.maxzoom||Sn.visibility!=="none"&&(Me(_r,this.zoom,ne),(we[Sn.id]=Sn.createBucket({index:Ee.bucketLayerIDs.length,layers:_r,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Kt,sourceID:this.source})).populate(Pi,Ie,this.tileID.canonical),Ee.bucketLayerIDs.push(_r.map(Er=>Er.id)))}}let Ke,tt,Ft,At;const Bt=d.mapObject(Ie.glyphDependencies,Ii=>Object.keys(Ii).map(Number));Object.keys(Bt).length?ce.send("getGlyphs",{uid:this.uid,stacks:Bt},(Ii,li)=>{Ke||(Ke=Ii,tt=li,mi.call(this))}):tt={};const jt=Object.keys(Ie.iconDependencies);jt.length?ce.send("getImages",{icons:jt,source:this.source,tileID:this.tileID,type:"icons"},(Ii,li)=>{Ke||(Ke=Ii,Ft=li,mi.call(this))}):Ft={};const Hi=Object.keys(Ie.patternDependencies);function mi(){if(Ke)return _e(Ke);if(tt&&Ft&&At){const Ii=new G(tt),li=new d.ImageAtlas(Ft,At);for(const Kt in we){const Pi=we[Kt];Pi instanceof d.SymbolBucket?(Me(Pi.layers,this.zoom,ne),d.performSymbolLayout(Pi,tt,Ii.positions,Ft,li.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Pi.hasPattern&&(Pi instanceof d.LineBucket||Pi instanceof d.FillBucket||Pi instanceof d.FillExtrusionBucket)&&(Me(Pi.layers,this.zoom,ne),Pi.addFeatures(Ie,this.tileID.canonical,li.patternPositions))}this.status="done",_e(null,{buckets:Object.values(we).filter(Kt=>!Kt.isEmpty()),featureIndex:Ee,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ii.image,imageAtlas:li,glyphMap:this.returnDependencies?tt:null,iconMap:this.returnDependencies?Ft:null,glyphPositions:this.returnDependencies?Ii.positions:null})}}Hi.length?ce.send("getImages",{icons:Hi,source:this.source,tileID:this.tileID,type:"patterns"},(Ii,li)=>{Ke||(Ke=Ii,At=li,mi.call(this))}):At={},mi.call(this)}}function Me(ae,H,W){const ne=new d.EvaluationParameters(H);for(const ce of ae)ce.recalculate(ne,W)}function ke(ae,H){const W=d.getArrayBuffer(ae.request,(ne,ce,_e,fe)=>{ne?H(ne):ce&&H(null,{vectorTile:new d.vectorTile.VectorTile(new d.pbf(ce)),rawData:ce,cacheControl:_e,expires:fe})});return()=>{W.cancel(),H()}}class qe{constructor(H,W,ne,ce){this.actor=H,this.layerIndex=W,this.availableImages=ne,this.loadVectorData=ce||ke,this.loading={},this.loaded={}}loadTile(H,W){const ne=H.uid;this.loading||(this.loading={});const ce=!!(H&&H.request&&H.request.collectResourceTiming)&&new d.RequestPerformance(H.request),_e=this.loading[ne]=new X(H);_e.abort=this.loadVectorData(H,(fe,Ee)=>{if(delete this.loading[ne],fe||!Ee)return _e.status="done",this.loaded[ne]=_e,W(fe);const we=Ee.rawData,Ie={};Ee.expires&&(Ie.expires=Ee.expires),Ee.cacheControl&&(Ie.cacheControl=Ee.cacheControl);const et={};if(ce){const Ke=ce.finish();Ke&&(et.resourceTiming=JSON.parse(JSON.stringify(Ke)))}_e.vectorTile=Ee.vectorTile,_e.parse(Ee.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ke,tt)=>{if(Ke||!tt)return W(Ke);W(null,d.extend({rawTileData:we.slice(0)},tt,Ie,et))}),this.loaded=this.loaded||{},this.loaded[ne]=_e})}reloadTile(H,W){const ne=this.loaded,ce=H.uid,_e=this;if(ne&&ne[ce]){const fe=ne[ce];fe.showCollisionBoxes=H.showCollisionBoxes;const Ee=(we,Ie)=>{const et=fe.reloadCallback;et&&(delete fe.reloadCallback,fe.parse(fe.vectorTile,_e.layerIndex,this.availableImages,_e.actor,et)),W(we,Ie)};fe.status==="parsing"?fe.reloadCallback=Ee:fe.status==="done"&&(fe.vectorTile?fe.parse(fe.vectorTile,this.layerIndex,this.availableImages,this.actor,Ee):Ee())}}abortTile(H,W){const ne=this.loading,ce=H.uid;ne&&ne[ce]&&ne[ce].abort&&(ne[ce].abort(),delete ne[ce]),W()}removeTile(H,W){const ne=this.loaded,ce=H.uid;ne&&ne[ce]&&delete ne[ce],W()}}class We{constructor(){this.loaded={}}loadTile(H,W){const{uid:ne,encoding:ce,rawImageData:_e}=H,fe=d.isImageBitmap(_e)?this.getImageData(_e):_e,Ee=new d.DEMData(ne,fe,ce);this.loaded=this.loaded||{},this.loaded[ne]=Ee,W(null,Ee)}getImageData(H){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(H.width,H.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=H.width,this.offscreenCanvas.height=H.height,this.offscreenCanvasContext.drawImage(H,0,0,H.width,H.height);const W=this.offscreenCanvasContext.getImageData(-1,-1,H.width+2,H.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new d.RGBAImage({width:W.width,height:W.height},W.data)}removeTile(H){const W=this.loaded,ne=H.uid;W&&W[ne]&&delete W[ne]}}var ft=function ae(H,W){var ne,ce=H&&H.type;if(ce==="FeatureCollection")for(ne=0;ne<H.features.length;ne++)ae(H.features[ne],W);else if(ce==="GeometryCollection")for(ne=0;ne<H.geometries.length;ne++)ae(H.geometries[ne],W);else if(ce==="Feature")ae(H.geometry,W);else if(ce==="Polygon")Ge(H.coordinates,W);else if(ce==="MultiPolygon")for(ne=0;ne<H.coordinates.length;ne++)Ge(H.coordinates[ne],W);return H};function Ge(ae,H){if(ae.length!==0){Ze(ae[0],H);for(var W=1;W<ae.length;W++)Ze(ae[W],!H)}}function Ze(ae,H){for(var W=0,ne=0,ce=0,_e=ae.length,fe=_e-1;ce<_e;fe=ce++){var Ee=(ae[ce][0]-ae[fe][0])*(ae[fe][1]+ae[ce][1]),we=W+Ee;ne+=Math.abs(W)>=Math.abs(Ee)?W-we+Ee:Ee-we+W,W=we}W+ne>=0!=!!H&&ae.reverse()}const gt=d.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ct{constructor(H){this._feature=H,this.extent=d.EXTENT,this.type=H.type,this.properties=H.tags,"id"in H&&!isNaN(H.id)&&(this.id=parseInt(H.id,10))}loadGeometry(){if(this._feature.type===1){const H=[];for(const W of this._feature.geometry)H.push([new d.pointGeometry(W[0],W[1])]);return H}{const H=[];for(const W of this._feature.geometry){const ne=[];for(const ce of W)ne.push(new d.pointGeometry(ce[0],ce[1]));H.push(ne)}return H}}toGeoJSON(H,W,ne){return gt.call(this,H,W,ne)}}class pt{constructor(H){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=d.EXTENT,this.length=H.length,this._features=H}feature(H){return new ct(this._features[H])}}var lt={exports:{}},pi=d.pointGeometry,Et=d.vectorTile.VectorTileFeature,Wt=vi;function vi(ae,H){this.options=H||{},this.features=ae,this.length=ae.length}function qi(ae,H){this.id=typeof ae.id=="number"?ae.id:void 0,this.type=ae.type,this.rawGeometry=ae.type===1?[ae.geometry]:ae.geometry,this.properties=ae.tags,this.extent=H||4096}vi.prototype.feature=function(ae){return new qi(this.features[ae],this.options.extent)},qi.prototype.loadGeometry=function(){var ae=this.rawGeometry;this.geometry=[];for(var H=0;H<ae.length;H++){for(var W=ae[H],ne=[],ce=0;ce<W.length;ce++)ne.push(new pi(W[ce][0],W[ce][1]));this.geometry.push(ne)}return this.geometry},qi.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ae=this.geometry,H=1/0,W=-1/0,ne=1/0,ce=-1/0,_e=0;_e<ae.length;_e++)for(var fe=ae[_e],Ee=0;Ee<fe.length;Ee++){var we=fe[Ee];H=Math.min(H,we.x),W=Math.max(W,we.x),ne=Math.min(ne,we.y),ce=Math.max(ce,we.y)}return[H,ne,W,ce]},qi.prototype.toGeoJSON=Et.prototype.toGeoJSON;var Xt=d.pbf,Qt=Wt;function Ei(ae){var H=new Xt;return function(W,ne){for(var ce in W.layers)ne.writeMessage(3,bt,W.layers[ce])}(ae,H),H.finish()}function bt(ae,H){var W;H.writeVarintField(15,ae.version||1),H.writeStringField(1,ae.name||""),H.writeVarintField(5,ae.extent||4096);var ne={keys:[],values:[],keycache:{},valuecache:{}};for(W=0;W<ae.length;W++)ne.feature=ae.feature(W),H.writeMessage(2,Gi,ne);var ce=ne.keys;for(W=0;W<ce.length;W++)H.writeStringField(3,ce[W]);var _e=ne.values;for(W=0;W<_e.length;W++)H.writeMessage(4,fi,_e[W])}function Gi(ae,H){var W=ae.feature;W.id!==void 0&&H.writeVarintField(1,W.id),H.writeMessage(2,hr,ae),H.writeVarintField(3,W.type),H.writeMessage(4,oi,W)}function hr(ae,H){var W=ae.feature,ne=ae.keys,ce=ae.values,_e=ae.keycache,fe=ae.valuecache;for(var Ee in W.properties){var we=W.properties[Ee],Ie=_e[Ee];if(we!==null){Ie===void 0&&(ne.push(Ee),_e[Ee]=Ie=ne.length-1),H.writeVarint(Ie);var et=typeof we;et!=="string"&&et!=="boolean"&&et!=="number"&&(we=JSON.stringify(we));var Ke=et+":"+we,tt=fe[Ke];tt===void 0&&(ce.push(we),fe[Ke]=tt=ce.length-1),H.writeVarint(tt)}}}function wr(ae,H){return(H<<3)+(7&ae)}function Dt(ae){return ae<<1^ae>>31}function oi(ae,H){for(var W=ae.loadGeometry(),ne=ae.type,ce=0,_e=0,fe=W.length,Ee=0;Ee<fe;Ee++){var we=W[Ee],Ie=1;ne===1&&(Ie=we.length),H.writeVarint(wr(1,Ie));for(var et=ne===3?we.length-1:we.length,Ke=0;Ke<et;Ke++){Ke===1&&ne!==1&&H.writeVarint(wr(2,et-1));var tt=we[Ke].x-ce,Ft=we[Ke].y-_e;H.writeVarint(Dt(tt)),H.writeVarint(Dt(Ft)),ce+=tt,_e+=Ft}ne===3&&H.writeVarint(wr(7,1))}}function fi(ae,H){var W=typeof ae;W==="string"?H.writeStringField(1,ae):W==="boolean"?H.writeBooleanField(7,ae):W==="number"&&(ae%1!=0?H.writeDoubleField(3,ae):ae<0?H.writeSVarintField(6,ae):H.writeVarintField(5,ae))}lt.exports=Ei,lt.exports.fromVectorTileJs=Ei,lt.exports.fromGeojsonVt=function(ae,H){H=H||{};var W={};for(var ne in ae)W[ne]=new Qt(ae[ne].features,H),W[ne].name=ne,W[ne].version=H.version,W[ne].extent=H.extent;return Ei({layers:W})},lt.exports.GeoJSONWrapper=Qt;var Bi=lt.exports;function Nt(ae,H,W,ne,ce,_e){if(ce-ne<=W)return;const fe=ne+ce>>1;Xi(ae,H,fe,ne,ce,_e%2),Nt(ae,H,W,ne,fe-1,_e+1),Nt(ae,H,W,fe+1,ce,_e+1)}function Xi(ae,H,W,ne,ce,_e){for(;ce>ne;){if(ce-ne>600){const Ie=ce-ne+1,et=W-ne+1,Ke=Math.log(Ie),tt=.5*Math.exp(2*Ke/3),Ft=.5*Math.sqrt(Ke*tt*(Ie-tt)/Ie)*(et-Ie/2<0?-1:1);Xi(ae,H,W,Math.max(ne,Math.floor(W-et*tt/Ie+Ft)),Math.min(ce,Math.floor(W+(Ie-et)*tt/Ie+Ft)),_e)}const fe=H[2*W+_e];let Ee=ne,we=ce;for(Li(ae,H,ne,W),H[2*ce+_e]>fe&&Li(ae,H,ne,ce);Ee<we;){for(Li(ae,H,Ee,we),Ee++,we--;H[2*Ee+_e]<fe;)Ee++;for(;H[2*we+_e]>fe;)we--}H[2*ne+_e]===fe?Li(ae,H,ne,we):(we++,Li(ae,H,we,ce)),we<=W&&(ne=we+1),W<=we&&(ce=we-1)}}function Li(ae,H,W,ne){xi(ae,W,ne),xi(H,2*W,2*ne),xi(H,2*W+1,2*ne+1)}function xi(ae,H,W){const ne=ae[H];ae[H]=ae[W],ae[W]=ne}function rr(ae,H,W,ne){const ce=ae-W,_e=H-ne;return ce*ce+_e*_e}const Ti=ae=>ae[0],zt=ae=>ae[1];class tr{constructor(H,W=Ti,ne=zt,ce=64,_e=Float64Array){this.nodeSize=ce,this.points=H;const fe=H.length<65536?Uint16Array:Uint32Array,Ee=this.ids=new fe(H.length),we=this.coords=new _e(2*H.length);for(let Ie=0;Ie<H.length;Ie++)Ee[Ie]=Ie,we[2*Ie]=W(H[Ie]),we[2*Ie+1]=ne(H[Ie]);Nt(Ee,we,ce,0,Ee.length-1,0)}range(H,W,ne,ce){return function(_e,fe,Ee,we,Ie,et,Ke){const tt=[0,_e.length-1,0],Ft=[];let At,Bt;for(;tt.length;){const jt=tt.pop(),Hi=tt.pop(),mi=tt.pop();if(Hi-mi<=Ke){for(let Kt=mi;Kt<=Hi;Kt++)At=fe[2*Kt],Bt=fe[2*Kt+1],At>=Ee&&At<=Ie&&Bt>=we&&Bt<=et&&Ft.push(_e[Kt]);continue}const Ii=Math.floor((mi+Hi)/2);At=fe[2*Ii],Bt=fe[2*Ii+1],At>=Ee&&At<=Ie&&Bt>=we&&Bt<=et&&Ft.push(_e[Ii]);const li=(jt+1)%2;(jt===0?Ee<=At:we<=Bt)&&(tt.push(mi),tt.push(Ii-1),tt.push(li)),(jt===0?Ie>=At:et>=Bt)&&(tt.push(Ii+1),tt.push(Hi),tt.push(li))}return Ft}(this.ids,this.coords,H,W,ne,ce,this.nodeSize)}within(H,W,ne){return function(ce,_e,fe,Ee,we,Ie){const et=[0,ce.length-1,0],Ke=[],tt=we*we;for(;et.length;){const Ft=et.pop(),At=et.pop(),Bt=et.pop();if(At-Bt<=Ie){for(let li=Bt;li<=At;li++)rr(_e[2*li],_e[2*li+1],fe,Ee)<=tt&&Ke.push(ce[li]);continue}const jt=Math.floor((Bt+At)/2),Hi=_e[2*jt],mi=_e[2*jt+1];rr(Hi,mi,fe,Ee)<=tt&&Ke.push(ce[jt]);const Ii=(Ft+1)%2;(Ft===0?fe-we<=Hi:Ee-we<=mi)&&(et.push(Bt),et.push(jt-1),et.push(Ii)),(Ft===0?fe+we>=Hi:Ee+we>=mi)&&(et.push(jt+1),et.push(At),et.push(Ii))}return Ke}(this.ids,this.coords,H,W,ne,this.nodeSize)}}const Rt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ae=>ae},rt=Math.fround||(yi=new Float32Array(1),ae=>(yi[0]=+ae,yi[0]));var yi;class ir{constructor(H){this.options=Zi(Object.create(Rt),H),this.trees=new Array(this.options.maxZoom+1)}load(H){const{log:W,minZoom:ne,maxZoom:ce,nodeSize:_e}=this.options;W&&console.time("total time");const fe=`prepare ${H.length} points`;W&&console.time(fe),this.points=H;let Ee=[];for(let we=0;we<H.length;we++)H[we].geometry&&Ee.push(no(H[we],we));this.trees[ce+1]=new tr(Ee,Fn,_o,_e,Float32Array),W&&console.timeEnd(fe);for(let we=ce;we>=ne;we--){const Ie=+Date.now();Ee=this._cluster(Ee,we),this.trees[we]=new tr(Ee,Fn,_o,_e,Float32Array),W&&console.log("z%d: %d clusters in %dms",we,Ee.length,+Date.now()-Ie)}return W&&console.timeEnd("total time"),this}getClusters(H,W){let ne=((H[0]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,H[1]));let _e=H[2]===180?180:((H[2]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,H[3]));if(H[2]-H[0]>=360)ne=-180,_e=180;else if(ne>_e){const et=this.getClusters([ne,ce,180,fe],W),Ke=this.getClusters([-180,ce,_e,fe],W);return et.concat(Ke)}const Ee=this.trees[this._limitZoom(W)],we=Ee.range(fn(ne),oo(fe),fn(_e),oo(ce)),Ie=[];for(const et of we){const Ke=Ee.points[et];Ie.push(Ke.numPoints?qn(Ke):this.points[Ke.index])}return Ie}getChildren(H){const W=this._getOriginId(H),ne=this._getOriginZoom(H),ce="No cluster with the specified id.",_e=this.trees[ne];if(!_e)throw new Error(ce);const fe=_e.points[W];if(!fe)throw new Error(ce);const Ee=this.options.radius/(this.options.extent*Math.pow(2,ne-1)),we=_e.within(fe.x,fe.y,Ee),Ie=[];for(const et of we){const Ke=_e.points[et];Ke.parentId===H&&Ie.push(Ke.numPoints?qn(Ke):this.points[Ke.index])}if(Ie.length===0)throw new Error(ce);return Ie}getLeaves(H,W,ne){const ce=[];return this._appendLeaves(ce,H,W=W||10,ne=ne||0,0),ce}getTile(H,W,ne){const ce=this.trees[this._limitZoom(H)],_e=Math.pow(2,H),{extent:fe,radius:Ee}=this.options,we=Ee/fe,Ie=(ne-we)/_e,et=(ne+1+we)/_e,Ke={features:[]};return this._addTileFeatures(ce.range((W-we)/_e,Ie,(W+1+we)/_e,et),ce.points,W,ne,_e,Ke),W===0&&this._addTileFeatures(ce.range(1-we/_e,Ie,1,et),ce.points,_e,ne,_e,Ke),W===_e-1&&this._addTileFeatures(ce.range(0,Ie,we/_e,et),ce.points,-1,ne,_e,Ke),Ke.features.length?Ke:null}getClusterExpansionZoom(H){let W=this._getOriginZoom(H)-1;for(;W<=this.options.maxZoom;){const ne=this.getChildren(H);if(W++,ne.length!==1)break;H=ne[0].properties.cluster_id}return W}_appendLeaves(H,W,ne,ce,_e){const fe=this.getChildren(W);for(const Ee of fe){const we=Ee.properties;if(we&&we.cluster?_e+we.point_count<=ce?_e+=we.point_count:_e=this._appendLeaves(H,we.cluster_id,ne,ce,_e):_e<ce?_e++:H.push(Ee),H.length===ne)break}return _e}_addTileFeatures(H,W,ne,ce,_e,fe){for(const Ee of H){const we=W[Ee],Ie=we.numPoints;let et,Ke,tt;if(Ie)et=Mo(we),Ke=we.x,tt=we.y;else{const Bt=this.points[we.index];et=Bt.properties,Ke=fn(Bt.geometry.coordinates[0]),tt=oo(Bt.geometry.coordinates[1])}const Ft={type:1,geometry:[[Math.round(this.options.extent*(Ke*_e-ne)),Math.round(this.options.extent*(tt*_e-ce))]],tags:et};let At;Ie?At=we.id:this.options.generateId?At=we.index:this.points[we.index].id&&(At=this.points[we.index].id),At!==void 0&&(Ft.id=At),fe.features.push(Ft)}}_limitZoom(H){return Math.max(this.options.minZoom,Math.min(+H,this.options.maxZoom+1))}_cluster(H,W){const ne=[],{radius:ce,extent:_e,reduce:fe,minPoints:Ee}=this.options,we=ce/(_e*Math.pow(2,W));for(let Ie=0;Ie<H.length;Ie++){const et=H[Ie];if(et.zoom<=W)continue;et.zoom=W;const Ke=this.trees[W+1],tt=Ke.within(et.x,et.y,we),Ft=et.numPoints||1;let At=Ft;for(const Bt of tt){const jt=Ke.points[Bt];jt.zoom>W&&(At+=jt.numPoints||1)}if(At>Ft&&At>=Ee){let Bt=et.x*Ft,jt=et.y*Ft,Hi=fe&&Ft>1?this._map(et,!0):null;const mi=(Ie<<5)+(W+1)+this.points.length;for(const Ii of tt){const li=Ke.points[Ii];if(li.zoom<=W)continue;li.zoom=W;const Kt=li.numPoints||1;Bt+=li.x*Kt,jt+=li.y*Kt,li.parentId=mi,fe&&(Hi||(Hi=this._map(et,!0)),fe(Hi,this._map(li)))}et.parentId=mi,ne.push(Cr(Bt/At,jt/At,mi,At,Hi))}else if(ne.push(et),At>1)for(const Bt of tt){const jt=Ke.points[Bt];jt.zoom<=W||(jt.zoom=W,ne.push(jt))}}return ne}_getOriginId(H){return H-this.points.length>>5}_getOriginZoom(H){return(H-this.points.length)%32}_map(H,W){if(H.numPoints)return W?Zi({},H.properties):H.properties;const ne=this.points[H.index].properties,ce=this.options.map(ne);return W&&ce===ne?Zi({},ce):ce}}function Cr(ae,H,W,ne,ce){return{x:rt(ae),y:rt(H),zoom:1/0,id:W,parentId:-1,numPoints:ne,properties:ce}}function no(ae,H){const[W,ne]=ae.geometry.coordinates;return{x:rt(fn(W)),y:rt(oo(ne)),zoom:1/0,index:H,parentId:-1}}function qn(ae){return{type:"Feature",id:ae.id,properties:Mo(ae),geometry:{type:"Point",coordinates:[(H=ae.x,360*(H-.5)),Gn(ae.y)]}};var H}function Mo(ae){const H=ae.numPoints,W=H>=1e4?`${Math.round(H/1e3)}k`:H>=1e3?Math.round(H/100)/10+"k":H;return Zi(Zi({},ae.properties),{cluster:!0,cluster_id:ae.id,point_count:H,point_count_abbreviated:W})}function fn(ae){return ae/360+.5}function oo(ae){const H=Math.sin(ae*Math.PI/180),W=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return W<0?0:W>1?1:W}function Gn(ae){const H=(180-360*ae)*Math.PI/180;return 360*Math.atan(Math.exp(H))/Math.PI-90}function Zi(ae,H){for(const W in H)ae[W]=H[W];return ae}function Fn(ae){return ae.x}function _o(ae){return ae.y}function Zn(ae,H,W,ne){for(var ce,_e=ne,fe=W-H>>1,Ee=W-H,we=ae[H],Ie=ae[H+1],et=ae[W],Ke=ae[W+1],tt=H+3;tt<W;tt+=3){var Ft=Ra(ae[tt],ae[tt+1],we,Ie,et,Ke);if(Ft>_e)ce=tt,_e=Ft;else if(Ft===_e){var At=Math.abs(tt-fe);At<Ee&&(ce=tt,Ee=At)}}_e>ne&&(ce-H>3&&Zn(ae,H,ce,ne),ae[ce+2]=_e,W-ce>3&&Zn(ae,ce,W,ne))}function Ra(ae,H,W,ne,ce,_e){var fe=ce-W,Ee=_e-ne;if(fe!==0||Ee!==0){var we=((ae-W)*fe+(H-ne)*Ee)/(fe*fe+Ee*Ee);we>1?(W=ce,ne=_e):we>0&&(W+=fe*we,ne+=Ee*we)}return(fe=ae-W)*fe+(Ee=H-ne)*Ee}function Ue(ae,H,W,ne){var ce={id:ae===void 0?null:ae,type:H,geometry:W,tags:ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(_e){var fe=_e.geometry,Ee=_e.type;if(Ee==="Point"||Ee==="MultiPoint"||Ee==="LineString")_t(_e,fe);else if(Ee==="Polygon"||Ee==="MultiLineString")for(var we=0;we<fe.length;we++)_t(_e,fe[we]);else if(Ee==="MultiPolygon")for(we=0;we<fe.length;we++)for(var Ie=0;Ie<fe[we].length;Ie++)_t(_e,fe[we][Ie])}(ce),ce}function _t(ae,H){for(var W=0;W<H.length;W+=3)ae.minX=Math.min(ae.minX,H[W]),ae.minY=Math.min(ae.minY,H[W+1]),ae.maxX=Math.max(ae.maxX,H[W]),ae.maxY=Math.max(ae.maxY,H[W+1])}function bi(ae,H,W,ne){if(H.geometry){var ce=H.geometry.coordinates,_e=H.geometry.type,fe=Math.pow(W.tolerance/((1<<W.maxZoom)*W.extent),2),Ee=[],we=H.id;if(W.promoteId?we=H.properties[W.promoteId]:W.generateId&&(we=ne||0),_e==="Point")pr(ce,Ee);else if(_e==="MultiPoint")for(var Ie=0;Ie<ce.length;Ie++)pr(ce[Ie],Ee);else if(_e==="LineString")mr(ce,Ee,fe,!1);else if(_e==="MultiLineString"){if(W.lineMetrics){for(Ie=0;Ie<ce.length;Ie++)mr(ce[Ie],Ee=[],fe,!1),ae.push(Ue(we,"LineString",Ee,H.properties));return}Hn(ce,Ee,fe,!1)}else if(_e==="Polygon")Hn(ce,Ee,fe,!0);else{if(_e!=="MultiPolygon"){if(_e==="GeometryCollection"){for(Ie=0;Ie<H.geometry.geometries.length;Ie++)bi(ae,{id:we,geometry:H.geometry.geometries[Ie],properties:H.properties},W,ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ie=0;Ie<ce.length;Ie++){var et=[];Hn(ce[Ie],et,fe,!0),Ee.push(et)}}ae.push(Ue(we,_e,Ee,H.properties))}}function pr(ae,H){H.push(Wn(ae[0])),H.push(ea(ae[1])),H.push(0)}function mr(ae,H,W,ne){for(var ce,_e,fe=0,Ee=0;Ee<ae.length;Ee++){var we=Wn(ae[Ee][0]),Ie=ea(ae[Ee][1]);H.push(we),H.push(Ie),H.push(0),Ee>0&&(fe+=ne?(ce*Ie-we*_e)/2:Math.sqrt(Math.pow(we-ce,2)+Math.pow(Ie-_e,2))),ce=we,_e=Ie}var et=H.length-3;H[2]=1,Zn(H,0,et,W),H[et+2]=1,H.size=Math.abs(fe),H.start=0,H.end=H.size}function Hn(ae,H,W,ne){for(var ce=0;ce<ae.length;ce++){var _e=[];mr(ae[ce],_e,W,ne),H.push(_e)}}function Wn(ae){return ae/360+.5}function ea(ae){var H=Math.sin(ae*Math.PI/180),W=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return W<0?0:W>1?1:W}function Gr(ae,H,W,ne,ce,_e,fe,Ee){if(ne/=H,_e>=(W/=H)&&fe<ne)return ae;if(fe<W||_e>=ne)return null;for(var we=[],Ie=0;Ie<ae.length;Ie++){var et=ae[Ie],Ke=et.geometry,tt=et.type,Ft=ce===0?et.minX:et.minY,At=ce===0?et.maxX:et.maxY;if(Ft>=W&&At<ne)we.push(et);else if(!(At<W||Ft>=ne)){var Bt=[];if(tt==="Point"||tt==="MultiPoint")Ht(Ke,Bt,W,ne,ce);else if(tt==="LineString")nr(Ke,Bt,W,ne,ce,!1,Ee.lineMetrics);else if(tt==="MultiLineString")zn(Ke,Bt,W,ne,ce,!1);else if(tt==="Polygon")zn(Ke,Bt,W,ne,ce,!0);else if(tt==="MultiPolygon")for(var jt=0;jt<Ke.length;jt++){var Hi=[];zn(Ke[jt],Hi,W,ne,ce,!0),Hi.length&&Bt.push(Hi)}if(Bt.length){if(Ee.lineMetrics&&tt==="LineString"){for(jt=0;jt<Bt.length;jt++)we.push(Ue(et.id,tt,Bt[jt],et.tags));continue}tt!=="LineString"&&tt!=="MultiLineString"||(Bt.length===1?(tt="LineString",Bt=Bt[0]):tt="MultiLineString"),tt!=="Point"&&tt!=="MultiPoint"||(tt=Bt.length===3?"Point":"MultiPoint"),we.push(Ue(et.id,tt,Bt,et.tags))}}}return we.length?we:null}function Ht(ae,H,W,ne,ce){for(var _e=0;_e<ae.length;_e+=3){var fe=ae[_e+ce];fe>=W&&fe<=ne&&(H.push(ae[_e]),H.push(ae[_e+1]),H.push(ae[_e+2]))}}function nr(ae,H,W,ne,ce,_e,fe){for(var Ee,we,Ie=Ki(ae),et=ce===0?Ni:fa,Ke=ae.start,tt=0;tt<ae.length-3;tt+=3){var Ft=ae[tt],At=ae[tt+1],Bt=ae[tt+2],jt=ae[tt+3],Hi=ae[tt+4],mi=ce===0?Ft:At,Ii=ce===0?jt:Hi,li=!1;fe&&(Ee=Math.sqrt(Math.pow(Ft-jt,2)+Math.pow(At-Hi,2))),mi<W?Ii>W&&(we=et(Ie,Ft,At,jt,Hi,W),fe&&(Ie.start=Ke+Ee*we)):mi>ne?Ii<ne&&(we=et(Ie,Ft,At,jt,Hi,ne),fe&&(Ie.start=Ke+Ee*we)):Xn(Ie,Ft,At,Bt),Ii<W&&mi>=W&&(we=et(Ie,Ft,At,jt,Hi,W),li=!0),Ii>ne&&mi<=ne&&(we=et(Ie,Ft,At,jt,Hi,ne),li=!0),!_e&&li&&(fe&&(Ie.end=Ke+Ee*we),H.push(Ie),Ie=Ki(ae)),fe&&(Ke+=Ee)}var Kt=ae.length-3;Ft=ae[Kt],At=ae[Kt+1],Bt=ae[Kt+2],(mi=ce===0?Ft:At)>=W&&mi<=ne&&Xn(Ie,Ft,At,Bt),Kt=Ie.length-3,_e&&Kt>=3&&(Ie[Kt]!==Ie[0]||Ie[Kt+1]!==Ie[1])&&Xn(Ie,Ie[0],Ie[1],Ie[2]),Ie.length&&H.push(Ie)}function Ki(ae){var H=[];return H.size=ae.size,H.start=ae.start,H.end=ae.end,H}function zn(ae,H,W,ne,ce,_e){for(var fe=0;fe<ae.length;fe++)nr(ae[fe],H,W,ne,ce,_e,!1)}function Xn(ae,H,W,ne){ae.push(H),ae.push(W),ae.push(ne)}function Ni(ae,H,W,ne,ce,_e){var fe=(_e-H)/(ne-H);return ae.push(_e),ae.push(W+(ce-W)*fe),ae.push(1),fe}function fa(ae,H,W,ne,ce,_e){var fe=(_e-W)/(ce-W);return ae.push(H+(ne-H)*fe),ae.push(_e),ae.push(1),fe}function Lo(ae,H){for(var W=[],ne=0;ne<ae.length;ne++){var ce,_e=ae[ne],fe=_e.type;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")ce=Nr(_e.geometry,H);else if(fe==="MultiLineString"||fe==="Polygon"){ce=[];for(var Ee=0;Ee<_e.geometry.length;Ee++)ce.push(Nr(_e.geometry[Ee],H))}else if(fe==="MultiPolygon")for(ce=[],Ee=0;Ee<_e.geometry.length;Ee++){for(var we=[],Ie=0;Ie<_e.geometry[Ee].length;Ie++)we.push(Nr(_e.geometry[Ee][Ie],H));ce.push(we)}W.push(Ue(_e.id,fe,ce,_e.tags))}return W}function Nr(ae,H){var W=[];W.size=ae.size,ae.start!==void 0&&(W.start=ae.start,W.end=ae.end);for(var ne=0;ne<ae.length;ne+=3)W.push(ae[ne]+H,ae[ne+1],ae[ne+2]);return W}function te(ae,H){if(ae.transformed)return ae;var W,ne,ce,_e=1<<ae.z,fe=ae.x,Ee=ae.y;for(W=0;W<ae.features.length;W++){var we=ae.features[W],Ie=we.geometry,et=we.type;if(we.geometry=[],et===1)for(ne=0;ne<Ie.length;ne+=2)we.geometry.push(oe(Ie[ne],Ie[ne+1],H,_e,fe,Ee));else for(ne=0;ne<Ie.length;ne++){var Ke=[];for(ce=0;ce<Ie[ne].length;ce+=2)Ke.push(oe(Ie[ne][ce],Ie[ne][ce+1],H,_e,fe,Ee));we.geometry.push(Ke)}}return ae.transformed=!0,ae}function oe(ae,H,W,ne,ce,_e){return[Math.round(W*(ae*ne-ce)),Math.round(W*(H*ne-_e))]}function le(ae,H,W,ne,ce){for(var _e=H===ce.maxZoom?0:ce.tolerance/((1<<H)*ce.extent),fe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:W,y:ne,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ee=0;Ee<ae.length;Ee++){fe.numFeatures++,ge(fe,ae[Ee],_e,ce);var we=ae[Ee].minX,Ie=ae[Ee].minY,et=ae[Ee].maxX,Ke=ae[Ee].maxY;we<fe.minX&&(fe.minX=we),Ie<fe.minY&&(fe.minY=Ie),et>fe.maxX&&(fe.maxX=et),Ke>fe.maxY&&(fe.maxY=Ke)}return fe}function ge(ae,H,W,ne){var ce=H.geometry,_e=H.type,fe=[];if(_e==="Point"||_e==="MultiPoint")for(var Ee=0;Ee<ce.length;Ee+=3)fe.push(ce[Ee]),fe.push(ce[Ee+1]),ae.numPoints++,ae.numSimplified++;else if(_e==="LineString")Se(fe,ce,ae,W,!1,!1);else if(_e==="MultiLineString"||_e==="Polygon")for(Ee=0;Ee<ce.length;Ee++)Se(fe,ce[Ee],ae,W,_e==="Polygon",Ee===0);else if(_e==="MultiPolygon")for(var we=0;we<ce.length;we++){var Ie=ce[we];for(Ee=0;Ee<Ie.length;Ee++)Se(fe,Ie[Ee],ae,W,!0,Ee===0)}if(fe.length){var et=H.tags||null;if(_e==="LineString"&&ne.lineMetrics){for(var Ke in et={},H.tags)et[Ke]=H.tags[Ke];et.mapbox_clip_start=ce.start/ce.size,et.mapbox_clip_end=ce.end/ce.size}var tt={geometry:fe,type:_e==="Polygon"||_e==="MultiPolygon"?3:_e==="LineString"||_e==="MultiLineString"?2:1,tags:et};H.id!==null&&(tt.id=H.id),ae.features.push(tt)}}function Se(ae,H,W,ne,ce,_e){var fe=ne*ne;if(ne>0&&H.size<(ce?fe:ne))W.numPoints+=H.length/3;else{for(var Ee=[],we=0;we<H.length;we+=3)(ne===0||H[we+2]>fe)&&(W.numSimplified++,Ee.push(H[we]),Ee.push(H[we+1])),W.numPoints++;ce&&function(Ie,et){for(var Ke=0,tt=0,Ft=Ie.length,At=Ft-2;tt<Ft;At=tt,tt+=2)Ke+=(Ie[tt]-Ie[At])*(Ie[tt+1]+Ie[At+1]);if(Ke>0===et)for(tt=0,Ft=Ie.length;tt<Ft/2;tt+=2){var Bt=Ie[tt],jt=Ie[tt+1];Ie[tt]=Ie[Ft-2-tt],Ie[tt+1]=Ie[Ft-1-tt],Ie[Ft-2-tt]=Bt,Ie[Ft-1-tt]=jt}}(Ee,_e),ae.push(Ee)}}function Oe(ae,H){var W=(H=this.options=function(ce,_e){for(var fe in _e)ce[fe]=_e[fe];return ce}(Object.create(this.options),H)).debug;if(W&&console.time("preprocess data"),H.maxZoom<0||H.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(H.promoteId&&H.generateId)throw new Error("promoteId and generateId cannot be used together.");var ne=function(ce,_e){var fe=[];if(ce.type==="FeatureCollection")for(var Ee=0;Ee<ce.features.length;Ee++)bi(fe,ce.features[Ee],_e,Ee);else bi(fe,ce.type==="Feature"?ce:{geometry:ce},_e);return fe}(ae,H);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",H.indexMaxZoom,H.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ne=function(ce,_e){var fe=_e.buffer/_e.extent,Ee=ce,we=Gr(ce,1,-1-fe,fe,0,-1,2,_e),Ie=Gr(ce,1,1-fe,2+fe,0,-1,2,_e);return(we||Ie)&&(Ee=Gr(ce,1,-fe,1+fe,0,-1,2,_e)||[],we&&(Ee=Lo(we,1).concat(Ee)),Ie&&(Ee=Ee.concat(Lo(Ie,-1)))),Ee}(ne,H),ne.length&&this.splitTile(ne,0,0,0),W&&(ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ne(ae,H,W){return 32*((1<<ae)*W+H)+ae}function ye(ae,H){const W=ae.tileID.canonical;if(!this._geoJSONIndex)return H(null,null);const ne=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!ne)return H(null,null);const ce=new pt(ne.features);let _e=Bi(ce);_e.byteOffset===0&&_e.byteLength===_e.buffer.byteLength||(_e=new Uint8Array(_e)),H(null,{vectorTile:ce,rawData:_e.buffer})}Oe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Oe.prototype.splitTile=function(ae,H,W,ne,ce,_e,fe){for(var Ee=[ae,H,W,ne],we=this.options,Ie=we.debug;Ee.length;){ne=Ee.pop(),W=Ee.pop(),H=Ee.pop(),ae=Ee.pop();var et=1<<H,Ke=Ne(H,W,ne),tt=this.tiles[Ke];if(!tt&&(Ie>1&&console.time("creation"),tt=this.tiles[Ke]=le(ae,H,W,ne,we),this.tileCoords.push({z:H,x:W,y:ne}),Ie)){Ie>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",H,W,ne,tt.numFeatures,tt.numPoints,tt.numSimplified),console.timeEnd("creation"));var Ft="z"+H;this.stats[Ft]=(this.stats[Ft]||0)+1,this.total++}if(tt.source=ae,ce){if(H===we.maxZoom||H===ce)continue;var At=1<<ce-H;if(W!==Math.floor(_e/At)||ne!==Math.floor(fe/At))continue}else if(H===we.indexMaxZoom||tt.numPoints<=we.indexMaxPoints)continue;if(tt.source=null,ae.length!==0){Ie>1&&console.time("clipping");var Bt,jt,Hi,mi,Ii,li,Kt=.5*we.buffer/we.extent,Pi=.5-Kt,_r=.5+Kt,Sn=1+Kt;Bt=jt=Hi=mi=null,Ii=Gr(ae,et,W-Kt,W+_r,0,tt.minX,tt.maxX,we),li=Gr(ae,et,W+Pi,W+Sn,0,tt.minX,tt.maxX,we),ae=null,Ii&&(Bt=Gr(Ii,et,ne-Kt,ne+_r,1,tt.minY,tt.maxY,we),jt=Gr(Ii,et,ne+Pi,ne+Sn,1,tt.minY,tt.maxY,we),Ii=null),li&&(Hi=Gr(li,et,ne-Kt,ne+_r,1,tt.minY,tt.maxY,we),mi=Gr(li,et,ne+Pi,ne+Sn,1,tt.minY,tt.maxY,we),li=null),Ie>1&&console.timeEnd("clipping"),Ee.push(Bt||[],H+1,2*W,2*ne),Ee.push(jt||[],H+1,2*W,2*ne+1),Ee.push(Hi||[],H+1,2*W+1,2*ne),Ee.push(mi||[],H+1,2*W+1,2*ne+1)}}},Oe.prototype.getTile=function(ae,H,W){var ne=this.options,ce=ne.extent,_e=ne.debug;if(ae<0||ae>24)return null;var fe=1<<ae,Ee=Ne(ae,H=(H%fe+fe)%fe,W);if(this.tiles[Ee])return te(this.tiles[Ee],ce);_e>1&&console.log("drilling down to z%d-%d-%d",ae,H,W);for(var we,Ie=ae,et=H,Ke=W;!we&&Ie>0;)Ie--,et=Math.floor(et/2),Ke=Math.floor(Ke/2),we=this.tiles[Ne(Ie,et,Ke)];return we&&we.source?(_e>1&&console.log("found parent tile z%d-%d-%d",Ie,et,Ke),_e>1&&console.time("drilling down"),this.splitTile(we.source,Ie,et,Ke,ae,H,W),_e>1&&console.timeEnd("drilling down"),this.tiles[Ee]?te(this.tiles[Ee],ce):null):null};class Pe extends qe{constructor(H,W,ne,ce){super(H,W,ne,ye),ce&&(this.loadGeoJSON=ce)}loadData(H,W){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=W,this._pendingLoadDataParams=H,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())}_loadData(){if(!this._pendingCallback||!this._pendingLoadDataParams)return;const H=this._pendingCallback,W=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;const ne=!!(W&&W.request&&W.request.collectResourceTiming)&&new d.RequestPerformance(W.request);this.loadGeoJSON(W,(ce,_e)=>{if(ce||!_e)return H(ce);if(typeof _e!="object")return H(new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`));{ft(_e,!0);try{if(W.filter){const Ee=d.createExpression(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ee.result==="error")throw new Error(Ee.value.map(Ie=>`${Ie.key}: ${Ie.message}`).join(", "));const we=_e.features.filter(Ie=>Ee.value.evaluate({zoom:0},Ie));_e={type:"FeatureCollection",features:we}}this._geoJSONIndex=W.cluster?new ir(function({superclusterOptions:Ee,clusterProperties:we}){if(!we||!Ee)return Ee;const Ie={},et={},Ke={accumulated:null,zoom:0},tt={properties:null},Ft=Object.keys(we);for(const At of Ft){const[Bt,jt]=we[At],Hi=d.createExpression(jt),mi=d.createExpression(typeof Bt=="string"?[Bt,["accumulated"],["get",At]]:Bt);Ie[At]=Hi.value,et[At]=mi.value}return Ee.map=At=>{tt.properties=At;const Bt={};for(const jt of Ft)Bt[jt]=Ie[jt].evaluate(Ke,tt);return Bt},Ee.reduce=(At,Bt)=>{tt.properties=Bt;for(const jt of Ft)Ke.accumulated=At[jt],At[jt]=et[jt].evaluate(Ke,tt)},Ee}(W)).load(_e.features):function(Ee,we){return new Oe(Ee,we)}(_e,W.geojsonVtOptions)}catch(Ee){return H(Ee)}this.loaded={};const fe={};if(ne){const Ee=ne.finish();Ee&&(fe.resourceTiming={},fe.resourceTiming[W.source]=JSON.parse(JSON.stringify(Ee)))}H(null,fe)}})}coalesce(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())}reloadTile(H,W){const ne=this.loaded;return ne&&ne[H.uid]?super.reloadTile(H,W):this.loadTile(H,W)}loadGeoJSON(H,W){if(H.request)d.getJSON(H.request,W);else{if(typeof H.data!="string")return W(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`));try{return W(null,JSON.parse(H.data))}catch{return W(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`))}}}removeSource(H,W){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),W()}getClusterExpansionZoom(H,W){try{W(null,this._geoJSONIndex.getClusterExpansionZoom(H.clusterId))}catch(ne){W(ne)}}getClusterChildren(H,W){try{W(null,this._geoJSONIndex.getChildren(H.clusterId))}catch(ne){W(ne)}}getClusterLeaves(H,W){try{W(null,this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset))}catch(ne){W(ne)}}}class Qe{constructor(H){this.self=H,this.actor=new d.Actor(H,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:qe,geojson:Pe},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(W,ne)=>{if(this.workerSourceTypes[W])throw new Error(`Worker source with name "${W}" already registered.`);this.workerSourceTypes[W]=ne},this.self.registerRTLTextPlugin=W=>{if(d.plugin.isParsed())throw new Error("RTL text plugin already registered.");d.plugin.applyArabicShaping=W.applyArabicShaping,d.plugin.processBidirectionalText=W.processBidirectionalText,d.plugin.processStyledBidirectionalText=W.processStyledBidirectionalText}}setReferrer(H,W){this.referrer=W}setImages(H,W,ne){this.availableImages[H]=W;for(const ce in this.workerSources[H]){const _e=this.workerSources[H][ce];for(const fe in _e)_e[fe].availableImages=W}ne()}setLayers(H,W,ne){this.getLayerIndex(H).replace(W),ne()}updateLayers(H,W,ne){this.getLayerIndex(H).update(W.layers,W.removedIds),ne()}loadTile(H,W,ne){this.getWorkerSource(H,W.type,W.source).loadTile(W,ne)}loadDEMTile(H,W,ne){this.getDEMWorkerSource(H,W.source).loadTile(W,ne)}reloadTile(H,W,ne){this.getWorkerSource(H,W.type,W.source).reloadTile(W,ne)}abortTile(H,W,ne){this.getWorkerSource(H,W.type,W.source).abortTile(W,ne)}removeTile(H,W,ne){this.getWorkerSource(H,W.type,W.source).removeTile(W,ne)}removeDEMTile(H,W){this.getDEMWorkerSource(H,W.source).removeTile(W)}removeSource(H,W,ne){if(!this.workerSources[H]||!this.workerSources[H][W.type]||!this.workerSources[H][W.type][W.source])return;const ce=this.workerSources[H][W.type][W.source];delete this.workerSources[H][W.type][W.source],ce.removeSource!==void 0?ce.removeSource(W,ne):ne()}loadWorkerSource(H,W,ne){try{this.self.importScripts(W.url),ne()}catch(ce){ne(ce.toString())}}syncRTLPluginState(H,W,ne){try{d.plugin.setState(W);const ce=d.plugin.getPluginURL();if(d.plugin.isLoaded()&&!d.plugin.isParsed()&&ce!=null){this.self.importScripts(ce);const _e=d.plugin.isParsed();ne(_e?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ce}`),_e)}}catch(ce){ne(ce.toString())}}getAvailableImages(H){let W=this.availableImages[H];return W||(W=[]),W}getLayerIndex(H){let W=this.layerIndexes[H];return W||(W=this.layerIndexes[H]=new V),W}getWorkerSource(H,W,ne){if(this.workerSources[H]||(this.workerSources[H]={}),this.workerSources[H][W]||(this.workerSources[H][W]={}),!this.workerSources[H][W][ne]){const ce={send:(_e,fe,Ee)=>{this.actor.send(_e,fe,Ee,H)}};this.workerSources[H][W][ne]=new this.workerSourceTypes[W](ce,this.getLayerIndex(H),this.getAvailableImages(H))}return this.workerSources[H][W][ne]}getDEMWorkerSource(H,W){return this.demWorkerSources[H]||(this.demWorkerSources[H]={}),this.demWorkerSources[H][W]||(this.demWorkerSources[H][W]=new We),this.demWorkerSources[H][W]}enforceCacheSizeLimit(H,W){d.enforceCacheSizeLimit(W)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Qe(self)),Qe}),P(["./shared"],function(d){var R=q;function q(S){return!function(n){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var I,A,M=new Blob([""],{type:"text/javascript"}),F=URL.createObjectURL(M);try{A=new Worker(F),I=!0}catch{I=!1}return A&&A.terminate(),URL.revokeObjectURL(F),I}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var I=document.createElement("canvas");I.width=I.height=1;var A=I.getContext("2d");if(!A)return!1;var M=A.getImageData(0,0,1,1);return M&&M.width===I.width}()?(V[y=n&&n.failIfMajorPerformanceCaveat]===void 0&&(V[y]=function(I){var A,M=function(F){var Z=document.createElement("canvas"),J=Object.create(q.webGLContextAttributes);return J.failIfMajorPerformanceCaveat=F,Z.getContext("webgl",J)||Z.getContext("experimental-webgl",J)}(I);if(!M)return!1;try{A=M.createShader(M.VERTEX_SHADER)}catch{return!1}return!(!A||M.isContextLost())&&(M.shaderSource(A,"void main() {}"),M.compileShader(A),M.getShaderParameter(A,M.COMPILE_STATUS)===!0)}(y)),V[y]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var y}(S)}var V={};function G(S,n){if(Array.isArray(S)){if(!Array.isArray(n)||S.length!==n.length)return!1;for(let y=0;y<S.length;y++)if(!G(S[y],n[y]))return!1;return!0}if(typeof S=="object"&&S!==null&&n!==null){if(typeof n!="object"||Object.keys(S).length!==Object.keys(n).length)return!1;for(const y in S)if(!G(S[y],n[y]))return!1;return!0}return S===n}q.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class X{static testProp(n){if(!X.docStyle)return n[0];for(let y=0;y<n.length;y++)if(n[y]in X.docStyle)return n[y];return n[0]}static create(n,y,I){const A=window.document.createElement(n);return y!==void 0&&(A.className=y),I&&I.appendChild(A),A}static createNS(n,y){return window.document.createElementNS(n,y)}static disableDrag(){X.docStyle&&X.selectProp&&(X.userSelect=X.docStyle[X.selectProp],X.docStyle[X.selectProp]="none")}static enableDrag(){X.docStyle&&X.selectProp&&(X.docStyle[X.selectProp]=X.userSelect)}static setTransform(n,y){n.style[X.transformProp]=y}static addEventListener(n,y,I,A={}){n.addEventListener(y,I,"passive"in A?A:A.capture)}static removeEventListener(n,y,I,A={}){n.removeEventListener(y,I,"passive"in A?A:A.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",X.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",X.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",X.suppressClickInternal,!0)},0)}static mousePos(n,y){const I=n.getBoundingClientRect();return new d.pointGeometry(y.clientX-I.left-n.clientLeft,y.clientY-I.top-n.clientTop)}static touchPos(n,y){const I=n.getBoundingClientRect(),A=[];for(let M=0;M<y.length;M++)A.push(new d.pointGeometry(y[M].clientX-I.left-n.clientLeft,y[M].clientY-I.top-n.clientTop));return A}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}}X.docStyle=typeof window!="undefined"&&window.document&&window.document.documentElement.style,X.selectProp=X.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),X.transformProp=X.testProp(["transform","WebkitTransform"]);class Me{constructor(n){this._transformRequestFn=n}transformRequest(n,y){return this._transformRequestFn&&this._transformRequestFn(n,y)||{url:n}}normalizeSpriteURL(n,y,I){const A=function(M){const F=M.match(ke);if(!F)throw new Error(`Unable to parse URL "${M}"`);return{protocol:F[1],authority:F[2],path:F[3]||"/",params:F[4]?F[4].split("&"):[]}}(n);return A.path+=`${y}${I}`,function(M){const F=M.params.length?`?${M.params.join("&")}`:"";return`${M.protocol}://${M.authority}${M.path}${F}`}(A)}setTransformRequest(n){this._transformRequestFn=n}}const ke=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function qe(S){var n=new d.ARRAY_TYPE(3);return n[0]=S[0],n[1]=S[1],n[2]=S[2],n}var We,ft=function(S,n,y){return S[0]=n[0]-y[0],S[1]=n[1]-y[1],S[2]=n[2]-y[2],S};We=new d.ARRAY_TYPE(3),d.ARRAY_TYPE!=Float32Array&&(We[0]=0,We[1]=0,We[2]=0);var Ge=function(S){var n=S[0],y=S[1];return n*n+y*y};(function(){var S=new d.ARRAY_TYPE(2);d.ARRAY_TYPE!=Float32Array&&(S[0]=0,S[1]=0)})();class Ze{constructor(n,y,I,A){this.context=n,this.format=I,this.texture=n.gl.createTexture(),this.update(y,A)}update(n,y,I){const{width:A,height:M}=n,F=!(this.size&&this.size[0]===A&&this.size[1]===M||I),{context:Z}=this,{gl:J}=Z;if(this.useMipmap=Boolean(y&&y.useMipmap),J.bindTexture(J.TEXTURE_2D,this.texture),Z.pixelStoreUnpackFlipY.set(!1),Z.pixelStoreUnpack.set(1),Z.pixelStoreUnpackPremultiplyAlpha.set(this.format===J.RGBA&&(!y||y.premultiply!==!1)),F)this.size=[A,M],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||d.isImageBitmap(n)?J.texImage2D(J.TEXTURE_2D,0,this.format,this.format,J.UNSIGNED_BYTE,n):J.texImage2D(J.TEXTURE_2D,0,this.format,A,M,0,this.format,J.UNSIGNED_BYTE,n.data);else{const{x:ee,y:re}=I||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||d.isImageBitmap(n)?J.texSubImage2D(J.TEXTURE_2D,0,ee,re,J.RGBA,J.UNSIGNED_BYTE,n):J.texSubImage2D(J.TEXTURE_2D,0,ee,re,A,M,J.RGBA,J.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&J.generateMipmap(J.TEXTURE_2D)}bind(n,y,I){const{context:A}=this,{gl:M}=A;M.bindTexture(M.TEXTURE_2D,this.texture),I!==M.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(I=M.LINEAR),n!==this.filter&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,n),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,I||n),this.filter=n),y!==this.wrap&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,y),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,y),this.wrap=y)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}function gt(S){const{userImage:n}=S;return!!(n&&n.render&&n.render())&&(S.data.replace(new Uint8Array(n.data.buffer)),!0)}class ct extends d.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new d.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:y,callback:I}of this.requestors)this._notify(y,I);this.requestors=[]}}getImage(n){return this.images[n]}addImage(n,y){this._validate(n,y)&&(this.images[n]=y)}_validate(n,y){let I=!0;return this._validateStretch(y.stretchX,y.data&&y.data.width)||(this.fire(new d.ErrorEvent(new Error(`Image "${n}" has invalid "stretchX" value`))),I=!1),this._validateStretch(y.stretchY,y.data&&y.data.height)||(this.fire(new d.ErrorEvent(new Error(`Image "${n}" has invalid "stretchY" value`))),I=!1),this._validateContent(y.content,y)||(this.fire(new d.ErrorEvent(new Error(`Image "${n}" has invalid "content" value`))),I=!1),I}_validateStretch(n,y){if(!n)return!0;let I=0;for(const A of n){if(A[0]<I||A[1]<A[0]||y<A[1])return!1;I=A[1]}return!0}_validateContent(n,y){return!(n&&(n.length!==4||n[0]<0||y.data.width<n[0]||n[1]<0||y.data.height<n[1]||n[2]<0||y.data.width<n[2]||n[3]<0||y.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))}updateImage(n,y){y.version=this.images[n].version+1,this.images[n]=y,this.updatedImages[n]=!0}removeImage(n){const y=this.images[n];delete this.images[n],delete this.patterns[n],y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n,y){let I=!0;if(!this.isLoaded())for(const A of n)this.images[A]||(I=!1);this.isLoaded()||I?this._notify(n,y):this.requestors.push({ids:n,callback:y})}_notify(n,y){const I={};for(const A of n){this.images[A]||this.fire(new d.Event("styleimagemissing",{id:A}));const M=this.images[A];M?I[A]={data:M.data.clone(),pixelRatio:M.pixelRatio,sdf:M.sdf,version:M.version,stretchX:M.stretchX,stretchY:M.stretchY,content:M.content,hasRenderCallback:Boolean(M.userImage&&M.userImage.render)}:d.warnOnce(`Image "${A}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}y(null,I)}getPixelSize(){const{width:n,height:y}=this.atlasImage;return{width:n,height:y}}getPattern(n){const y=this.patterns[n],I=this.getImage(n);if(!I)return null;if(y&&y.position.version===I.version)return y.position;if(y)y.position.version=I.version;else{const A={w:I.data.width+2,h:I.data.height+2,x:0,y:0},M=new d.ImagePosition(A,I);this.patterns[n]={bin:A,position:M}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const y=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ze(n,this.atlasImage,y.RGBA),this.atlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const M in this.patterns)n.push(this.patterns[M].bin);const{w:y,h:I}=d.potpack(n),A=this.atlasImage;A.resize({width:y||1,height:I||1});for(const M in this.patterns){const{bin:F}=this.patterns[M],Z=F.x+1,J=F.y+1,ee=this.images[M].data,re=ee.width,ue=ee.height;d.RGBAImage.copy(ee,A,{x:0,y:0},{x:Z,y:J},{width:re,height:ue}),d.RGBAImage.copy(ee,A,{x:0,y:ue-1},{x:Z,y:J-1},{width:re,height:1}),d.RGBAImage.copy(ee,A,{x:0,y:0},{x:Z,y:J+ue},{width:re,height:1}),d.RGBAImage.copy(ee,A,{x:re-1,y:0},{x:Z-1,y:J},{width:1,height:ue}),d.RGBAImage.copy(ee,A,{x:0,y:0},{x:Z+re,y:J},{width:1,height:ue})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const y of n){if(this.callbackDispatchedThisFrame[y])continue;this.callbackDispatchedThisFrame[y]=!0;const I=this.images[y];gt(I)&&this.updateImage(y,I)}}}const pt=1e20;function lt(S,n,y,I,A,M,F,Z,J){for(let ee=n;ee<n+I;ee++)pi(S,y*M+ee,M,A,F,Z,J);for(let ee=y;ee<y+A;ee++)pi(S,ee*M+n,1,I,F,Z,J)}function pi(S,n,y,I,A,M,F){M[0]=0,F[0]=-pt,F[1]=pt,A[0]=S[n];for(let Z=1,J=0,ee=0;Z<I;Z++){A[Z]=S[n+Z*y];const re=Z*Z;do{const ue=M[J];ee=(A[Z]-A[ue]+re-ue*ue)/(Z-ue)/2}while(ee<=F[J]&&--J>-1);J++,M[J]=Z,F[J]=ee,F[J+1]=pt}for(let Z=0,J=0;Z<I;Z++){for(;F[J+1]<Z;)J++;const ee=M[J],re=Z-ee;S[n+Z*y]=A[ee]+re*re}}class Et{constructor(n,y){this.requestManager=n,this.localIdeographFontFamily=y,this.entries={}}setURL(n){this.url=n}getGlyphs(n,y){const I=[];for(const A in n)for(const M of n[A])I.push({stack:A,id:M});d.asyncAll(I,({stack:A,id:M},F)=>{let Z=this.entries[A];Z||(Z=this.entries[A]={glyphs:{},requests:{},ranges:{}});let J=Z.glyphs[M];if(J!==void 0)return void F(null,{stack:A,id:M,glyph:J});if(J=this._tinySDF(Z,A,M),J)return Z.glyphs[M]=J,void F(null,{stack:A,id:M,glyph:J});const ee=Math.floor(M/256);if(256*ee>65535)return void F(new Error("glyphs > 65535 not supported"));if(Z.ranges[ee])return void F(null,{stack:A,id:M,glyph:J});let re=Z.requests[ee];re||(re=Z.requests[ee]=[],Et.loadGlyphRange(A,ee,this.url,this.requestManager,(ue,ve)=>{if(ve){for(const Re in ve)this._doesCharSupportLocalGlyph(+Re)||(Z.glyphs[+Re]=ve[+Re]);Z.ranges[ee]=!0}for(const Re of re)Re(ue,ve);delete Z.requests[ee]})),re.push((ue,ve)=>{ue?F(ue):ve&&F(null,{stack:A,id:M,glyph:ve[M]||null})})},(A,M)=>{if(A)y(A);else if(M){const F={};for(const{stack:Z,id:J,glyph:ee}of M)(F[Z]||(F[Z]={}))[J]=ee&&{id:ee.id,bitmap:ee.bitmap.clone(),metrics:ee.metrics};y(null,F)}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(d.unicodeBlockLookup["CJK Unified Ideographs"](n)||d.unicodeBlockLookup["Hangul Syllables"](n)||d.unicodeBlockLookup.Hiragana(n)||d.unicodeBlockLookup.Katakana(n))}_tinySDF(n,y,I){const A=this.localIdeographFontFamily;if(!A||!this._doesCharSupportLocalGlyph(I))return;let M=n.tinySDF;if(!M){let Z="400";/bold/i.test(y)?Z="900":/medium/i.test(y)?Z="500":/light/i.test(y)&&(Z="200"),M=n.tinySDF=new Et.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:A,fontWeight:Z})}const F=M.draw(String.fromCharCode(I));return{id:I,bitmap:new d.AlphaImage({width:F.width||30,height:F.height||30},F.data),metrics:{width:F.glyphWidth||24,height:F.glyphHeight||24,left:F.glyphLeft||0,top:F.glyphTop-27||-8,advance:F.glyphAdvance||24}}}}Et.loadGlyphRange=function(S,n,y,I,A){const M=256*n,F=M+255,Z=I.transformRequest(y.replace("{fontstack}",S).replace("{range}",`${M}-${F}`),d.ResourceType.Glyphs);d.getArrayBuffer(Z,(J,ee)=>{if(J)A(J);else if(ee){const re={};for(const ue of d.parseGlyphPBF(ee))re[ue.id]=ue;A(null,re)}})},Et.TinySDF=class{constructor({fontSize:S=24,buffer:n=3,radius:y=8,cutoff:I=.25,fontFamily:A="sans-serif",fontWeight:M="normal",fontStyle:F="normal"}={}){this.buffer=n,this.cutoff=I,this.radius=y;const Z=this.size=S+4*n,J=this._createCanvas(Z),ee=this.ctx=J.getContext("2d",{willReadFrequently:!0});ee.font=`${F} ${M} ${S}px ${A}`,ee.textBaseline="alphabetic",ee.textAlign="left",ee.fillStyle="black",this.gridOuter=new Float64Array(Z*Z),this.gridInner=new Float64Array(Z*Z),this.f=new Float64Array(Z),this.z=new Float64Array(Z+1),this.v=new Uint16Array(Z)}_createCanvas(S){const n=document.createElement("canvas");return n.width=n.height=S,n}draw(S){const{width:n,actualBoundingBoxAscent:y,actualBoundingBoxDescent:I,actualBoundingBoxLeft:A,actualBoundingBoxRight:M}=this.ctx.measureText(S),F=Math.ceil(y),Z=Math.min(this.size-this.buffer,Math.ceil(M-A)),J=Math.min(this.size-this.buffer,F+Math.ceil(I)),ee=Z+2*this.buffer,re=J+2*this.buffer,ue=Math.max(ee*re,0),ve=new Uint8ClampedArray(ue),Re={data:ve,width:ee,height:re,glyphWidth:Z,glyphHeight:J,glyphTop:F,glyphLeft:0,glyphAdvance:n};if(Z===0||J===0)return Re;const{ctx:be,buffer:De,gridInner:Je,gridOuter:Xe}=this;be.clearRect(De,De,Z,J),be.fillText(S,De,De+F);const nt=be.getImageData(De,De,Z,J);Xe.fill(pt,0,ue),Je.fill(0,0,ue);for(let $e=0;$e<J;$e++)for(let xt=0;xt<Z;xt++){const ht=nt.data[4*($e*Z+xt)+3]/255;if(ht===0)continue;const mt=($e+De)*ee+xt+De;if(ht===1)Xe[mt]=0,Je[mt]=pt;else{const Pt=.5-ht;Xe[mt]=Pt>0?Pt*Pt:0,Je[mt]=Pt<0?Pt*Pt:0}}lt(Xe,0,0,ee,re,ee,this.f,this.v,this.z),lt(Je,De,De,Z,J,ee,this.f,this.v,this.z);for(let $e=0;$e<ue;$e++){const xt=Math.sqrt(Xe[$e])-Math.sqrt(Je[$e]);ve[$e]=Math.round(255-255*(xt/this.radius+this.cutoff))}return Re}};const Wt=new d.Properties({anchor:new d.DataConstantProperty(d.spec.light.anchor),position:new class{constructor(){this.specification=d.spec.light.position}possiblyEvaluate(S,n){return d.sphericalToCartesian(S.expression.evaluate(n))}interpolate(S,n,y){return{x:d.number(S.x,n.x,y),y:d.number(S.y,n.y,y),z:d.number(S.z,n.z,y)}}},color:new d.DataConstantProperty(d.spec.light.color),intensity:new d.DataConstantProperty(d.spec.light.intensity)}),vi="-transition";class qi extends d.Evented{constructor(n){super(),this._transitionable=new d.Transitionable(Wt),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,y={}){if(!this._validate(d.validateLight,n,y))for(const I in n){const A=n[I];I.endsWith(vi)?this._transitionable.setTransition(I.slice(0,-vi.length),A):this._transitionable.setValue(I,A)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,y,I){return(!I||I.validate!==!1)&&d.emitValidationErrors(this,n.call(d.validateStyle,d.extend({value:y,style:{glyphs:!0,sprite:!0},styleSpec:d.spec})))}}class Xt{constructor(n,y){this.width=n,this.height=y,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,y){const I=n.join(",")+String(y);return this.dashEntry[I]||(this.dashEntry[I]=this.addDash(n,y)),this.dashEntry[I]}getDashRanges(n,y,I){const A=[];let M=n.length%2==1?-n[n.length-1]*I:0,F=n[0]*I,Z=!0;A.push({left:M,right:F,isDash:Z,zeroLength:n[0]===0});let J=n[0];for(let ee=1;ee<n.length;ee++){Z=!Z;const re=n[ee];M=J*I,J+=re,F=J*I,A.push({left:M,right:F,isDash:Z,zeroLength:re===0})}return A}addRoundDash(n,y,I){const A=y/2;for(let M=-I;M<=I;M++){const F=this.width*(this.nextRow+I+M);let Z=0,J=n[Z];for(let ee=0;ee<this.width;ee++){ee/J.right>1&&(J=n[++Z]);const re=Math.abs(ee-J.left),ue=Math.abs(ee-J.right),ve=Math.min(re,ue);let Re;const be=M/I*(A+1);if(J.isDash){const De=A-Math.abs(be);Re=Math.sqrt(ve*ve+De*De)}else Re=A-Math.sqrt(ve*ve+be*be);this.data[F+ee]=Math.max(0,Math.min(255,Re+128))}}}addRegularDash(n){for(let Z=n.length-1;Z>=0;--Z){const J=n[Z],ee=n[Z+1];J.zeroLength?n.splice(Z,1):ee&&ee.isDash===J.isDash&&(ee.left=J.left,n.splice(Z,1))}const y=n[0],I=n[n.length-1];y.isDash===I.isDash&&(y.left=I.left-this.width,I.right=y.right+this.width);const A=this.width*this.nextRow;let M=0,F=n[M];for(let Z=0;Z<this.width;Z++){Z/F.right>1&&(F=n[++M]);const J=Math.abs(Z-F.left),ee=Math.abs(Z-F.right),re=Math.min(J,ee);this.data[A+Z]=Math.max(0,Math.min(255,(F.isDash?re:-re)+128))}}addDash(n,y){const I=y?7:0,A=2*I+1;if(this.nextRow+A>this.height)return d.warnOnce("LineAtlas out of space"),null;let M=0;for(let Z=0;Z<n.length;Z++)M+=n[Z];if(M!==0){const Z=this.width/M,J=this.getDashRanges(n,this.width,Z);y?this.addRoundDash(J,Z,I):this.addRegularDash(J)}const F={y:(this.nextRow+I+.5)/this.height,height:2*I/this.height,width:M};return this.nextRow+=A,this.dirty=!0,F}bind(n){const y=n.gl;this.texture?(y.bindTexture(y.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,y.texSubImage2D(y.TEXTURE_2D,0,0,0,this.width,this.height,y.ALPHA,y.UNSIGNED_BYTE,this.data))):(this.texture=y.createTexture(),y.bindTexture(y.TEXTURE_2D,this.texture),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.REPEAT),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.REPEAT),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR),y.texImage2D(y.TEXTURE_2D,0,y.ALPHA,this.width,this.height,0,y.ALPHA,y.UNSIGNED_BYTE,this.data))}}class Qt{constructor(n,y){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=d.uniqueId();const I=this.workerPool.acquire(this.id);for(let A=0;A<I.length;A++){const M=new Qt.Actor(I[A],y,this.id);M.name=`Worker ${A}`,this.actors.push(M)}}broadcast(n,y,I){d.asyncAll(this.actors,(A,M)=>{A.send(n,y,M)},I=I||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ei(S,n,y){const I=function(A,M){if(A)return y(A);if(M){const F=d.pick(d.extend(M,S),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(F.vectorLayers=M.vector_layers,F.vectorLayerIds=F.vectorLayers.map(Z=>Z.id)),y(null,F)}};return S.url?d.getJSON(n.transformRequest(S.url,d.ResourceType.Source),I):d.exported.frame(()=>I(null,S))}Qt.Actor=d.Actor;class bt{constructor(n,y,I){this.bounds=d.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=y||0,this.maxzoom=I||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const y=Math.pow(2,n.z),I=Math.floor(d.mercatorXfromLng(this.bounds.getWest())*y),A=Math.floor(d.mercatorYfromLat(this.bounds.getNorth())*y),M=Math.ceil(d.mercatorXfromLng(this.bounds.getEast())*y),F=Math.ceil(d.mercatorYfromLat(this.bounds.getSouth())*y);return n.x>=I&&n.x<M&&n.y>=A&&n.y<F}}class Gi extends d.Evented{constructor(n,y,I,A){if(super(),this.id=n,this.dispatcher=I,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,d.extend(this,d.pick(y,["url","scheme","tileSize","promoteId"])),this._options=d.extend({type:"vector"},y),this._collectResourceTiming=y.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(A)}load(){this._loaded=!1,this.fire(new d.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ei(this._options,this.map._requestManager,(n,y)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n?this.fire(new d.ErrorEvent(n)):y&&(d.extend(this,y),y.bounds&&(this.tileBounds=new bt(y.bounds,this.minzoom,this.maxzoom)),this.fire(new d.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return d.extend({},this._options)}loadTile(n,y){const I=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),A={request:this.map._requestManager.transformRequest(I,d.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function M(F,Z){return delete n.request,n.aborted?y(null):F&&F.status!==404?y(F):(Z&&Z.resourceTiming&&(n.resourceTiming=Z.resourceTiming),this.map._refreshExpiredTiles&&Z&&n.setExpiryData(Z),n.loadVectorData(Z,this.map.painter),d.cacheEntryPossiblyAdded(this.dispatcher),y(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}A.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired"?n.state==="loading"?n.reloadCallback=y:n.request=n.actor.send("reloadTile",A,M.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",A,M.bind(this)))}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)}unloadTile(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class hr extends d.Evented{constructor(n,y,I,A){super(),this.id=n,this.dispatcher=I,this.setEventedParent(A),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.extend({type:"raster"},y),d.extend(this,d.pick(y,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new d.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ei(this._options,this.map._requestManager,(n,y)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new d.ErrorEvent(n)):y&&(d.extend(this,y),y.bounds&&(this.tileBounds=new bt(y.bounds,this.minzoom,this.maxzoom)),this.fire(new d.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return d.extend({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,y){const I=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.request=d.getImage(this.map._requestManager.transformRequest(I,d.ResourceType.Tile),(A,M,F)=>{if(delete n.request,n.aborted)n.state="unloaded",y(null);else if(A)n.state="errored",y(A);else if(M){this.map._refreshExpiredTiles&&n.setExpiryData(F);const Z=this.map.painter.context,J=Z.gl;n.texture=this.map.painter.getTileTexture(M.width),n.texture?n.texture.update(M,{useMipmap:!0}):(n.texture=new Ze(Z,M,J.RGBA,{useMipmap:!0}),n.texture.bind(J.LINEAR,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST),Z.extTextureFilterAnisotropic&&J.texParameterf(J.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax)),n.state="loaded",d.cacheEntryPossiblyAdded(this.dispatcher),y(null)}})}abortTile(n,y){n.request&&(n.request.cancel(),delete n.request),y()}unloadTile(n,y){n.texture&&this.map.painter.saveTileTexture(n.texture),y()}hasTransition(){return!1}}let wr;class Dt extends hr{constructor(n,y,I,A){super(n,y,I,A),this.type="raster-dem",this.maxzoom=22,this._options=d.extend({type:"raster-dem"},y),this.encoding=y.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(n,y){const I=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function A(M,F){M&&(n.state="errored",y(M)),F&&(n.dem=F,n.needsHillshadePrepare=!0,n.state="loaded",y(null))}n.request=d.getImage(this.map._requestManager.transformRequest(I,d.ResourceType.Tile),function(M,F){if(delete n.request,n.aborted)n.state="unloaded",y(null);else if(M)n.state="errored",y(M);else if(F){this.map._refreshExpiredTiles&&n.setExpiryData(F),delete F.cacheControl,delete F.expires;const Z=d.isImageBitmap(F)&&(wr==null&&(wr=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),wr)?F:d.exported.getImageData(F,1),J={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:Z,encoding:this.encoding};n.actor&&n.state!=="expired"||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",J,A.bind(this)))}}.bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)}_getNeighboringTiles(n){const y=n.canonical,I=Math.pow(2,y.z),A=(y.x-1+I)%I,M=y.x===0?n.wrap-1:n.wrap,F=(y.x+1+I)%I,Z=y.x+1===I?n.wrap+1:n.wrap,J={};return J[new d.OverscaledTileID(n.overscaledZ,M,y.z,A,y.y).key]={backfilled:!1},J[new d.OverscaledTileID(n.overscaledZ,Z,y.z,F,y.y).key]={backfilled:!1},y.y>0&&(J[new d.OverscaledTileID(n.overscaledZ,M,y.z,A,y.y-1).key]={backfilled:!1},J[new d.OverscaledTileID(n.overscaledZ,n.wrap,y.z,y.x,y.y-1).key]={backfilled:!1},J[new d.OverscaledTileID(n.overscaledZ,Z,y.z,F,y.y-1).key]={backfilled:!1}),y.y+1<I&&(J[new d.OverscaledTileID(n.overscaledZ,M,y.z,A,y.y+1).key]={backfilled:!1},J[new d.OverscaledTileID(n.overscaledZ,n.wrap,y.z,y.x,y.y+1).key]={backfilled:!1},J[new d.OverscaledTileID(n.overscaledZ,Z,y.z,F,y.y+1).key]={backfilled:!1}),J}unloadTile(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})}}class oi extends d.Evented{constructor(n,y,I,A){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=I.getActor(),this.setEventedParent(A),this._data=y.data,this._options=d.extend({},y),this._collectResourceTiming=y.collectResourceTiming,y.maxzoom!==void 0&&(this.maxzoom=y.maxzoom),y.type&&(this.type=y.type),y.attribution&&(this.attribution=y.attribution),this.promoteId=y.promoteId;const M=d.EXTENT/this.tileSize;this.workerOptions=d.extend({source:this.id,cluster:y.cluster||!1,geojsonVtOptions:{buffer:(y.buffer!==void 0?y.buffer:128)*M,tolerance:(y.tolerance!==void 0?y.tolerance:.375)*M,extent:d.EXTENT,maxZoom:this.maxzoom,lineMetrics:y.lineMetrics||!1,generateId:y.generateId||!1},superclusterOptions:{maxZoom:y.clusterMaxZoom!==void 0?y.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,y.clusterMinPoints||2),extent:d.EXTENT,radius:(y.clusterRadius||50)*M,log:!1,generateId:y.generateId||!1},clusterProperties:y.clusterProperties,filter:y.filter},y.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData("content"),this}getClusterExpansionZoom(n,y){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},y),this}getClusterChildren(n,y){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},y),this}getClusterLeaves(n,y,I,A){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:y,offset:I},A),this}_updateWorkerData(n){const y=d.extend({},this.workerOptions),I=this._data;typeof I=="string"?(y.request=this.map._requestManager.transformRequest(d.exported.resolveURL(I),d.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(I),this._pendingLoads++,this.fire(new d.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,y,(A,M)=>{if(this._pendingLoads--,this._removed||M&&M.abandoned)return;let F=null;if(M&&M.resourceTiming&&M.resourceTiming[this.id]&&(F=M.resourceTiming[this.id].slice(0)),this.actor.send(`${this.type}.coalesce`,{source:y.source},null),A)return void this.fire(new d.ErrorEvent(A));const Z={dataType:"source",sourceDataType:n};this._collectResourceTiming&&F&&F.length>0&&d.extend(Z,{resourceTiming:F}),this.fire(new d.Event("data",Z))})}loaded(){return this._pendingLoads===0}loadTile(n,y){const I=n.actor?"reloadTile":"loadTile";n.actor=this.actor;const A={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.request=this.actor.send(I,A,(M,F)=>(delete n.request,n.unloadVectorData(),n.aborted?y(null):M?y(M):(n.loadVectorData(F,this.map.painter,I==="reloadTile"),y(null))))}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0}unloadTile(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return d.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var fi=d.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Bi extends d.Evented{constructor(n,y,I,A){super(),this.id=n,this.dispatcher=I,this.coordinates=y.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(A),this.options=y}load(n,y){this._loaded=!1,this.fire(new d.Event("dataloading",{dataType:"source"})),this.url=this.options.url,d.getImage(this.map._requestManager.transformRequest(this.url,d.ResourceType.Image),(I,A)=>{this._loaded=!0,I?this.fire(new d.ErrorEvent(I)):A&&(this.image=A,n&&(this.coordinates=n),y&&y(),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new d.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}setCoordinates(n){this.coordinates=n;const y=n.map(d.MercatorCoordinate.fromLngLat);this.tileID=function(A){let M=1/0,F=1/0,Z=-1/0,J=-1/0;for(const ve of A)M=Math.min(M,ve.x),F=Math.min(F,ve.y),Z=Math.max(Z,ve.x),J=Math.max(J,ve.y);const ee=Math.max(Z-M,J-F),re=Math.max(0,Math.floor(-Math.log(ee)/Math.LN2)),ue=Math.pow(2,re);return new d.CanonicalTileID(re,Math.floor((M+Z)/2*ue),Math.floor((F+J)/2*ue))}(y),this.minzoom=this.maxzoom=this.tileID.z;const I=y.map(A=>this.tileID.getTilePoint(A)._round());return this._boundsArray=new d.RasterBoundsArray,this._boundsArray.emplaceBack(I[0].x,I[0].y,0,0),this._boundsArray.emplaceBack(I[1].x,I[1].y,d.EXTENT,0),this._boundsArray.emplaceBack(I[3].x,I[3].y,0,d.EXTENT),this._boundsArray.emplaceBack(I[2].x,I[2].y,d.EXTENT,d.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new d.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,y=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,fi.members)),this.boundsSegments||(this.boundsSegments=d.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ze(n,this.image,y.RGBA),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE));for(const I in this.tiles){const A=this.tiles[I];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture)}}loadTile(n,y){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},y(null)):(n.state="errored",y(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Nt extends Bi{constructor(n,y,I,A){super(n,y,I,A),this.roundZoom=!0,this.type="video",this.options=y}load(){this._loaded=!1;const n=this.options;this.urls=[];for(const y of n.urls)this.urls.push(this.map._requestManager.transformRequest(y,d.ResourceType.Source).url);d.getVideo(this.urls,(y,I)=>{this._loaded=!0,y?this.fire(new d.ErrorEvent(y)):I&&(this.video=I,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const y=this.video.seekable;n<y.start(0)||n>y.end(0)?this.fire(new d.ErrorEvent(new d.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${y.start(0)} and ${y.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,y=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,fi.members)),this.boundsSegments||(this.boundsSegments=d.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE),y.texSubImage2D(y.TEXTURE_2D,0,0,0,y.RGBA,y.UNSIGNED_BYTE,this.video)):(this.texture=new Ze(n,this.video,y.RGBA),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE));for(const I in this.tiles){const A=this.tiles[I];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Xi extends Bi{constructor(n,y,I,A){super(n,y,I,A),y.coordinates?Array.isArray(y.coordinates)&&y.coordinates.length===4&&!y.coordinates.some(M=>!Array.isArray(M)||M.length!==2||M.some(F=>typeof F!="number"))||this.fire(new d.ErrorEvent(new d.ValidationError(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new d.ErrorEvent(new d.ValidationError(`sources.${n}`,null,'missing required property "coordinates"'))),y.animate&&typeof y.animate!="boolean"&&this.fire(new d.ErrorEvent(new d.ValidationError(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),y.canvas?typeof y.canvas=="string"||y.canvas instanceof HTMLCanvasElement||this.fire(new d.ErrorEvent(new d.ValidationError(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new d.ErrorEvent(new d.ValidationError(`sources.${n}`,null,'missing required property "canvas"'))),this.options=y,this.animate=y.animate===void 0||y.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new d.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const y=this.map.painter.context,I=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,fi.members)),this.boundsSegments||(this.boundsSegments=d.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ze(y,this.canvas,I.RGBA,{premultiply:!0});for(const A in this.tiles){const M=this.tiles[A];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const Li={vector:Gi,raster:hr,"raster-dem":Dt,geojson:oi,video:Nt,image:Bi,canvas:Xi};function xi(S,n){const y=d.create();return d.translate(y,y,[1,1,0]),d.scale(y,y,[.5*S.width,.5*S.height,1]),d.multiply(y,y,S.calculatePosMatrix(n.toUnwrapped()))}function rr(S,n,y,I,A,M){const F=function(ue,ve,Re){if(ue)for(const be of ue){const De=ve[be];if(De&&De.source===Re&&De.type==="fill-extrusion")return!0}else for(const be in ve){const De=ve[be];if(De.source===Re&&De.type==="fill-extrusion")return!0}return!1}(A&&A.layers,n,S.id),Z=M.maxPitchScaleFactor(),J=S.tilesIn(I,Z,F);J.sort(Ti);const ee=[];for(const ue of J)ee.push({wrappedTileID:ue.tileID.wrapped().key,queryResults:ue.tile.queryRenderedFeatures(n,y,S._state,ue.queryGeometry,ue.cameraQueryGeometry,ue.scale,A,M,Z,xi(S.transform,ue.tileID))});const re=function(ue){const ve={},Re={};for(const be of ue){const De=be.queryResults,Je=be.wrappedTileID,Xe=Re[Je]=Re[Je]||{};for(const nt in De){const $e=De[nt],xt=Xe[nt]=Xe[nt]||{},ht=ve[nt]=ve[nt]||[];for(const mt of $e)xt[mt.featureIndex]||(xt[mt.featureIndex]=!0,ht.push(mt))}}return ve}(ee);for(const ue in re)re[ue].forEach(ve=>{const Re=ve.feature,be=S.getFeatureState(Re.layer["source-layer"],Re.id);Re.source=Re.layer.source,Re.layer["source-layer"]&&(Re.sourceLayer=Re.layer["source-layer"]),Re.state=be});return re}function Ti(S,n){const y=S.tileID,I=n.tileID;return y.overscaledZ-I.overscaledZ||y.canonical.y-I.canonical.y||y.wrap-I.wrap||y.canonical.x-I.canonical.x}class zt{constructor(n,y){this.tileID=n,this.uid=d.uniqueId(),this.uses=0,this.tileSize=y,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const y=n+this.timeAdded;y<d.exported.now()||this.fadeEndTime&&y<this.fadeEndTime||(this.fadeEndTime=y)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}loadVectorData(n,y,I){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(A,M){const F={};if(!M)return F;for(const Z of A){const J=Z.layerIds.map(ee=>M.getLayer(ee)).filter(Boolean);if(J.length!==0){Z.layers=J,Z.stateDependentLayerIds&&(Z.stateDependentLayers=Z.stateDependentLayerIds.map(ee=>J.filter(re=>re.id===ee)[0]));for(const ee of J)F[ee.id]=Z}}return F}(n.buckets,y.style),this.hasSymbolBuckets=!1;for(const A in this.buckets){const M=this.buckets[A];if(M instanceof d.SymbolBucket){if(this.hasSymbolBuckets=!0,!I)break;M.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const A in this.buckets){const M=this.buckets[A];if(M instanceof d.SymbolBucket&&M.hasRTLText){this.hasRTLText=!0,d.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const A in this.buckets){const M=this.buckets[A];this.queryPadding=Math.max(this.queryPadding,y.style.getLayer(A).queryRadius(M))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new d.CollisionBoxArray}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const I in this.buckets){const A=this.buckets[I];A.uploadPending()&&A.upload(n)}const y=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ze(n,this.imageAtlas.image,y.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ze(n,this.glyphAtlasImage,y.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,y,I,A,M,F,Z,J,ee,re){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:A,cameraQueryGeometry:M,scale:F,tileSize:this.tileSize,pixelPosMatrix:re,transform:J,params:Z,queryPadding:this.queryPadding*ee},n,y,I):{}}querySourceFeatures(n,y){const I=this.latestFeatureIndex;if(!I||!I.rawTileData)return;const A=I.loadVTLayers(),M=y?y.sourceLayer:"",F=A._geojsonTileLayer||A[M];if(!F)return;const Z=d.createFilter(y&&y.filter),{z:J,x:ee,y:re}=this.tileID.canonical,ue={z:J,x:ee,y:re};for(let ve=0;ve<F.length;ve++){const Re=F.feature(ve);if(Z.needGeometry){const Je=d.toEvaluationFeature(Re,!0);if(!Z.filter(new d.EvaluationParameters(this.tileID.overscaledZ),Je,this.tileID.canonical))continue}else if(!Z.filter(new d.EvaluationParameters(this.tileID.overscaledZ),Re))continue;const be=I.getId(Re,M),De=new d.GeoJSONFeature(Re,J,ee,re,be);De.tile=ue,n.push(De)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const y=this.expirationTime;if(n.cacheControl){const I=d.parseCacheControl(n.cacheControl);I["max-age"]&&(this.expirationTime=Date.now()+1e3*I["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const I=Date.now();let A=!1;if(this.expirationTime>I)A=!1;else if(y)if(this.expirationTime<y)A=!0;else{const M=this.expirationTime-y;M?this.expirationTime=I+Math.max(M,3e4):A=!0}else A=!0;A?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,y){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const I=this.latestFeatureIndex.loadVTLayers();for(const A in this.buckets){if(!y.style.hasLayer(A))continue;const M=this.buckets[A],F=M.layers[0].sourceLayer||"_geojsonTileLayer",Z=I[F],J=n[F];if(!Z||!J||Object.keys(J).length===0)continue;M.update(J,Z,this.imageAtlas&&this.imageAtlas.patternPositions||{});const ee=y&&y.style&&y.style.getLayer(A);ee&&(this.queryPadding=Math.max(this.queryPadding,ee.queryRadius(M)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<d.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=d.exported.now()+n}setDependencies(n,y){const I={};for(const A of y)I[A]=!0;this.dependencies[n]=I}hasDependency(n,y){for(const I of n){const A=this.dependencies[I];if(A){for(const M of y)if(A[M])return!0}}return!1}}class tr{constructor(n,y){this.max=n,this.onRemove=y,this.reset()}reset(){for(const n in this.data)for(const y of this.data[n])y.timeout&&clearTimeout(y.timeout),this.onRemove(y.value);return this.data={},this.order=[],this}add(n,y,I){const A=n.wrapped().key;this.data[A]===void 0&&(this.data[A]=[]);const M={value:y,timeout:void 0};if(I!==void 0&&(M.timeout=setTimeout(()=>{this.remove(n,M)},I)),this.data[A].push(M),this.order.push(A),this.order.length>this.max){const F=this._getAndRemoveByKey(this.order[0]);F&&this.onRemove(F)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const y=this.data[n].shift();return y.timeout&&clearTimeout(y.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),y.value}getByKey(n){const y=this.data[n];return y?y[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,y){if(!this.has(n))return this;const I=n.wrapped().key,A=y===void 0?0:this.data[I].indexOf(y),M=this.data[I][A];return this.data[I].splice(A,1),M.timeout&&clearTimeout(M.timeout),this.data[I].length===0&&delete this.data[I],this.onRemove(M.value),this.order.splice(this.order.indexOf(I),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}filter(n){const y=[];for(const I in this.data)for(const A of this.data[I])n(A.value)||y.push(A);for(const I of y)this.remove(I.value.tileID,I)}}class Rt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,y,I){const A=String(y);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][A]=this.stateChanges[n][A]||{},d.extend(this.stateChanges[n][A],I),this.deletedStates[n]===null){this.deletedStates[n]={};for(const M in this.state[n])M!==A&&(this.deletedStates[n][M]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][A]===null){this.deletedStates[n][A]={};for(const M in this.state[n][A])I[M]||(this.deletedStates[n][A][M]=null)}else for(const M in I)this.deletedStates[n]&&this.deletedStates[n][A]&&this.deletedStates[n][A][M]===null&&delete this.deletedStates[n][A][M]}removeFeatureState(n,y,I){if(this.deletedStates[n]===null)return;const A=String(y);if(this.deletedStates[n]=this.deletedStates[n]||{},I&&y!==void 0)this.deletedStates[n][A]!==null&&(this.deletedStates[n][A]=this.deletedStates[n][A]||{},this.deletedStates[n][A][I]=null);else if(y!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][A])for(I in this.deletedStates[n][A]={},this.stateChanges[n][A])this.deletedStates[n][A][I]=null;else this.deletedStates[n][A]=null;else this.deletedStates[n]=null}getState(n,y){const I=String(y),A=d.extend({},(this.state[n]||{})[I],(this.stateChanges[n]||{})[I]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const M=this.deletedStates[n][y];if(M===null)return{};for(const F in M)delete A[F]}return A}initializeTileState(n,y){n.setFeatureState(this.state,y)}coalesceChanges(n,y){const I={};for(const A in this.stateChanges){this.state[A]=this.state[A]||{};const M={};for(const F in this.stateChanges[A])this.state[A][F]||(this.state[A][F]={}),d.extend(this.state[A][F],this.stateChanges[A][F]),M[F]=this.state[A][F];I[A]=M}for(const A in this.deletedStates){this.state[A]=this.state[A]||{};const M={};if(this.deletedStates[A]===null)for(const F in this.state[A])M[F]={},this.state[A][F]={};else for(const F in this.deletedStates[A]){if(this.deletedStates[A][F]===null)this.state[A][F]={};else for(const Z of Object.keys(this.deletedStates[A][F]))delete this.state[A][F][Z];M[F]=this.state[A][F]}I[A]=I[A]||{},d.extend(I[A],M)}if(this.stateChanges={},this.deletedStates={},Object.keys(I).length!==0)for(const A in n)n[A].setFeatureState(I,y)}}class rt extends d.Evented{constructor(n,y,I){super(),this.id=n,this.dispatcher=I,this.on("data",A=>{A.dataType==="source"&&A.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&A.dataType==="source"&&A.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(A,M,F,Z){const J=new Li[M.type](A,M,F,Z);if(J.id!==A)throw new Error(`Expected Source id to be ${A} instead of ${J.id}`);return d.bindAll(["load","abort","unload","serialize","prepare"],J),J}(n,y,I,this),this._tiles={},this._cache=new tr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Rt}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles){const y=this._tiles[n];if(y.state!=="loaded"&&y.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,y){return this._source.loadTile(n,y)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n,()=>{})}_abortTile(n){this._source.abortTile&&this._source.abortTile(n,()=>{}),this._source.fire(new d.Event("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const y in this._tiles){const I=this._tiles[y];I.upload(n),I.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(yi).map(n=>n.key)}getRenderableIds(n){const y=[];for(const I in this._tiles)this._isIdRenderable(I,n)&&y.push(this._tiles[I]);return n?y.sort((I,A)=>{const M=I.tileID,F=A.tileID,Z=new d.pointGeometry(M.canonical.x,M.canonical.y)._rotate(this.transform.angle),J=new d.pointGeometry(F.canonical.x,F.canonical.y)._rotate(this.transform.angle);return M.overscaledZ-F.overscaledZ||J.y-Z.y||J.x-Z.x}).map(I=>I.tileID.key):y.map(I=>I.tileID).sort(yi).map(I=>I.key)}hasRenderableParent(n){const y=this.findLoadedParent(n,0);return!!y&&this._isIdRenderable(y.tileID.key)}_isIdRenderable(n,y){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(y||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")}}_reloadTile(n,y){const I=this._tiles[n];I&&(I.state!=="loading"&&(I.state=y),this._loadTile(I,this._tileLoaded.bind(this,I,n,y)))}_tileLoaded(n,y,I,A){if(A)return n.state="errored",void(A.status!==404?this._source.fire(new d.ErrorEvent(A,{tile:n})):this.update(this.transform));n.timeAdded=d.exported.now(),I==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(y,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new d.Event("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const y=this.getRenderableIds();for(let A=0;A<y.length;A++){const M=y[A];if(n.neighboringTiles&&n.neighboringTiles[M]){const F=this.getTileByID(M);I(n,F),I(F,n)}}function I(A,M){A.needsHillshadePrepare=!0;let F=M.tileID.canonical.x-A.tileID.canonical.x;const Z=M.tileID.canonical.y-A.tileID.canonical.y,J=Math.pow(2,A.tileID.canonical.z),ee=M.tileID.key;F===0&&Z===0||Math.abs(Z)>1||(Math.abs(F)>1&&(Math.abs(F+J)===1?F+=J:Math.abs(F-J)===1&&(F-=J)),M.dem&&A.dem&&(A.dem.backfillBorder(M.dem,F,Z),A.neighboringTiles&&A.neighboringTiles[ee]&&(A.neighboringTiles[ee].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,y,I,A){for(const M in this._tiles){let F=this._tiles[M];if(A[M]||!F.hasData()||F.tileID.overscaledZ<=y||F.tileID.overscaledZ>I)continue;let Z=F.tileID;for(;F&&F.tileID.overscaledZ>y+1;){const ee=F.tileID.scaledTo(F.tileID.overscaledZ-1);F=this._tiles[ee.key],F&&F.hasData()&&(Z=ee)}let J=Z;for(;J.overscaledZ>y;)if(J=J.scaledTo(J.overscaledZ-1),n[J.key]){A[Z.key]=Z;break}}}findLoadedParent(n,y){if(n.key in this._loadedParentTiles){const I=this._loadedParentTiles[n.key];return I&&I.tileID.overscaledZ>=y?I:null}for(let I=n.overscaledZ-1;I>=y;I--){const A=n.scaledTo(I),M=this._getLoadedTile(A);if(M)return M}}_getLoadedTile(n){const y=this._tiles[n.key];return y&&y.hasData()?y:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const y=Math.ceil(n.width/this._source.tileSize)+1,I=Math.ceil(n.height/this._source.tileSize)+1,A=Math.floor(y*I*5),M=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,A):A;this._cache.setMaxSize(M)}handleWrapJump(n){const y=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,y){const I={};for(const A in this._tiles){const M=this._tiles[A];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+y),I[M.tileID.key]=M}this._tiles=I;for(const A in this._timers)clearTimeout(this._timers[A]),delete this._timers[A];for(const A in this._tiles)this._setTileReloadTimer(A,this._tiles[A])}}update(n){if(this.transform=n,!this._sourceLoaded||this._paused)return;let y;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?y=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(J=>new d.OverscaledTileID(J.canonical.z,J.wrap,J.canonical.z,J.canonical.x,J.canonical.y)):(y=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(y=y.filter(J=>this._source.hasTile(J)))):y=[];const I=n.coveringZoomLevel(this._source),A=Math.max(I-rt.maxOverzooming,this._source.minzoom),M=Math.max(I+rt.maxUnderzooming,this._source.minzoom),F=this._updateRetainedTiles(y,I);if(ir(this._source.type)){const J={},ee={},re=Object.keys(F);for(const ue of re){const ve=F[ue],Re=this._tiles[ue];if(!Re||Re.fadeEndTime&&Re.fadeEndTime<=d.exported.now())continue;const be=this.findLoadedParent(ve,A);be&&(this._addTile(be.tileID),J[be.tileID.key]=be.tileID),ee[ue]=ve}this._retainLoadedChildren(ee,I,M,F);for(const ue in J)F[ue]||(this._coveredTiles[ue]=!0,F[ue]=J[ue])}for(const J in F)this._tiles[J].clearFadeHold();const Z=d.keysDifference(this._tiles,F);for(const J of Z){const ee=this._tiles[J];ee.hasSymbolBuckets&&!ee.holdingForFade()?ee.setHoldDuration(this.map._fadeDuration):ee.hasSymbolBuckets&&!ee.symbolFadeFinished()||this._removeTile(J)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,y){const I={},A={},M=Math.max(y-rt.maxOverzooming,this._source.minzoom),F=Math.max(y+rt.maxUnderzooming,this._source.minzoom),Z={};for(const J of n){const ee=this._addTile(J);I[J.key]=J,ee.hasData()||y<this._source.maxzoom&&(Z[J.key]=J)}this._retainLoadedChildren(Z,y,F,I);for(const J of n){let ee=this._tiles[J.key];if(ee.hasData())continue;if(y+1>this._source.maxzoom){const ue=J.children(this._source.maxzoom)[0],ve=this.getTile(ue);if(ve&&ve.hasData()){I[ue.key]=ue;continue}}else{const ue=J.children(this._source.maxzoom);if(I[ue[0].key]&&I[ue[1].key]&&I[ue[2].key]&&I[ue[3].key])continue}let re=ee.wasRequested();for(let ue=J.overscaledZ-1;ue>=M;--ue){const ve=J.scaledTo(ue);if(A[ve.key]||(A[ve.key]=!0,ee=this.getTile(ve),!ee&&re&&(ee=this._addTile(ve)),ee&&(I[ve.key]=ve,re=ee.wasRequested(),ee.hasData())))break}}return I}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const y=[];let I,A=this._tiles[n].tileID;for(;A.overscaledZ>0;){if(A.key in this._loadedParentTiles){I=this._loadedParentTiles[A.key];break}y.push(A.key);const M=A.scaledTo(A.overscaledZ-1);if(I=this._getLoadedTile(M),I)break;A=M}for(const M of y)this._loadedParentTiles[M]=I}}_addTile(n){let y=this._tiles[n.key];if(y)return y;y=this._cache.getAndRemove(n),y&&(this._setTileReloadTimer(n.key,y),y.tileID=n,this._state.initializeTileState(y,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,y)));const I=y;return y||(y=new zt(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(y,this._tileLoaded.bind(this,y,n.key,y.state))),y.uses++,this._tiles[n.key]=y,I||this._source.fire(new d.Event("dataloading",{tile:y,coord:y.tileID,dataType:"source"})),y}_setTileReloadTimer(n,y){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const I=y.getExpiryTimeout();I&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},I))}_removeTile(n){const y=this._tiles[n];y&&(y.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),y.uses>0||(y.hasData()&&y.state!=="reloading"?this._cache.add(y.tileID,y,y.getExpiryTimeout()):(y.aborted=!0,this._abortTile(y),this._unloadTile(y))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,y,I){const A=[],M=this.transform;if(!M)return A;const F=I?M.getCameraQueryGeometry(n):n,Z=n.map(be=>M.pointCoordinate(be)),J=F.map(be=>M.pointCoordinate(be)),ee=this.getIds();let re=1/0,ue=1/0,ve=-1/0,Re=-1/0;for(const be of J)re=Math.min(re,be.x),ue=Math.min(ue,be.y),ve=Math.max(ve,be.x),Re=Math.max(Re,be.y);for(let be=0;be<ee.length;be++){const De=this._tiles[ee[be]];if(De.holdingForFade())continue;const Je=De.tileID,Xe=Math.pow(2,M.zoom-De.tileID.overscaledZ),nt=y*De.queryPadding*d.EXTENT/De.tileSize/Xe,$e=[Je.getTilePoint(new d.MercatorCoordinate(re,ue)),Je.getTilePoint(new d.MercatorCoordinate(ve,Re))];if($e[0].x-nt<d.EXTENT&&$e[0].y-nt<d.EXTENT&&$e[1].x+nt>=0&&$e[1].y+nt>=0){const xt=Z.map(mt=>Je.getTilePoint(mt)),ht=J.map(mt=>Je.getTilePoint(mt));A.push({tile:De,tileID:Je,queryGeometry:xt,cameraQueryGeometry:ht,scale:Xe})}}return A}getVisibleCoordinates(n){const y=this.getRenderableIds(n).map(I=>this._tiles[I].tileID);for(const I of y)I.posMatrix=this.transform.calculatePosMatrix(I.toUnwrapped());return y}hasTransition(){if(this._source.hasTransition())return!0;if(ir(this._source.type))for(const n in this._tiles){const y=this._tiles[n];if(y.fadeEndTime!==void 0&&y.fadeEndTime>=d.exported.now())return!0}return!1}setFeatureState(n,y,I){this._state.updateState(n=n||"_geojsonTileLayer",y,I)}removeFeatureState(n,y,I){this._state.removeFeatureState(n=n||"_geojsonTileLayer",y,I)}getFeatureState(n,y){return this._state.getState(n=n||"_geojsonTileLayer",y)}setDependencies(n,y,I){const A=this._tiles[n];A&&A.setDependencies(y,I)}reloadTilesForDependencies(n,y){for(const I in this._tiles)this._tiles[I].hasDependency(n,y)&&this._reloadTile(I,"reloading");this._cache.filter(I=>!I.hasDependency(n,y))}}function yi(S,n){const y=Math.abs(2*S.wrap)-+(S.wrap<0),I=Math.abs(2*n.wrap)-+(n.wrap<0);return S.overscaledZ-n.overscaledZ||I-y||n.canonical.y-S.canonical.y||n.canonical.x-S.canonical.x}function ir(S){return S==="raster"||S==="image"||S==="video"}rt.maxOverzooming=10,rt.maxUnderzooming=3;const Cr="mapboxgl_preloaded_worker_pool";class no{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<no.workerCount;)this.workers.push(new Worker(Bo.workerUrl));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(y=>{y.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Cr]}numActive(){return Object.keys(this.active).length}}const qn=Math.floor(d.exported.hardwareConcurrency/2);let Mo;function fn(){return Mo||(Mo=new no),Mo}function oo(S,n){const y={};for(const I in S)I!=="ref"&&(y[I]=S[I]);return d.refProperties.forEach(I=>{I in n&&(y[I]=n[I])}),y}function Gn(S){S=S.slice();const n=Object.create(null);for(let y=0;y<S.length;y++)n[S[y].id]=S[y];for(let y=0;y<S.length;y++)"ref"in S[y]&&(S[y]=oo(S[y],n[S[y].ref]));return S}no.workerCount=Math.max(Math.min(qn,6),1);const Zi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Fn(S,n,y){y.push({command:Zi.addSource,args:[S,n[S]]})}function _o(S,n,y){n.push({command:Zi.removeSource,args:[S]}),y[S]=!0}function Zn(S,n,y,I){_o(S,y,I),Fn(S,n,y)}function Ra(S,n,y){let I;for(I in S[y])if(Object.prototype.hasOwnProperty.call(S[y],I)&&I!=="data"&&!G(S[y][I],n[y][I]))return!1;for(I in n[y])if(Object.prototype.hasOwnProperty.call(n[y],I)&&I!=="data"&&!G(S[y][I],n[y][I]))return!1;return!0}function Ue(S,n,y,I,A,M){let F;for(F in n=n||{},S=S||{})Object.prototype.hasOwnProperty.call(S,F)&&(G(S[F],n[F])||y.push({command:M,args:[I,F,n[F],A]}));for(F in n)Object.prototype.hasOwnProperty.call(n,F)&&!Object.prototype.hasOwnProperty.call(S,F)&&(G(S[F],n[F])||y.push({command:M,args:[I,F,n[F],A]}))}function _t(S){return S.id}function bi(S,n){return S[n.id]=n,S}class pr{constructor(n,y){this.reset(n,y)}reset(n,y){this.points=n||[],this._distances=[0];for(let I=1;I<this.points.length;I++)this._distances[I]=this._distances[I-1]+this.points[I].dist(this.points[I-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(y||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=d.clamp(n,0,1);let y=1,I=this._distances[y];const A=n*this.paddedLength+this.padding;for(;I<A&&y<this._distances.length;)I=this._distances[++y];const M=y-1,F=this._distances[M],Z=I-F,J=Z>0?(A-F)/Z:0;return this.points[M].mult(1-J).add(this.points[y].mult(J))}}function mr(S,n){let y=!0;return S==="always"||S!=="never"&&n!=="never"||(y=!1),y}class Hn{constructor(n,y,I){const A=this.boxCells=[],M=this.circleCells=[];this.xCellCount=Math.ceil(n/I),this.yCellCount=Math.ceil(y/I);for(let F=0;F<this.xCellCount*this.yCellCount;F++)A.push([]),M.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=y,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/y,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,y,I,A,M){this._forEachCell(y,I,A,M,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(y),this.bboxes.push(I),this.bboxes.push(A),this.bboxes.push(M)}insertCircle(n,y,I,A){this._forEachCell(y-A,I-A,y+A,I+A,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(y),this.circles.push(I),this.circles.push(A)}_insertBoxCell(n,y,I,A,M,F){this.boxCells[M].push(F)}_insertCircleCell(n,y,I,A,M,F){this.circleCells[M].push(F)}_query(n,y,I,A,M,F,Z){if(I<0||n>this.width||A<0||y>this.height)return[];const J=[];if(n<=0&&y<=0&&this.width<=I&&this.height<=A){if(M)return[{key:null,x1:n,y1:y,x2:I,y2:A}];for(let ee=0;ee<this.boxKeys.length;ee++)J.push({key:this.boxKeys[ee],x1:this.bboxes[4*ee],y1:this.bboxes[4*ee+1],x2:this.bboxes[4*ee+2],y2:this.bboxes[4*ee+3]});for(let ee=0;ee<this.circleKeys.length;ee++){const re=this.circles[3*ee],ue=this.circles[3*ee+1],ve=this.circles[3*ee+2];J.push({key:this.circleKeys[ee],x1:re-ve,y1:ue-ve,x2:re+ve,y2:ue+ve})}}else this._forEachCell(n,y,I,A,this._queryCell,J,{hitTest:M,overlapMode:F,seenUids:{box:{},circle:{}}},Z);return J}query(n,y,I,A){return this._query(n,y,I,A,!1,null)}hitTest(n,y,I,A,M,F){return this._query(n,y,I,A,!0,M,F).length>0}hitTestCircle(n,y,I,A,M){const F=n-I,Z=n+I,J=y-I,ee=y+I;if(Z<0||F>this.width||ee<0||J>this.height)return!1;const re=[];return this._forEachCell(F,J,Z,ee,this._queryCellCircle,re,{hitTest:!0,overlapMode:A,circle:{x:n,y,radius:I},seenUids:{box:{},circle:{}}},M),re.length>0}_queryCell(n,y,I,A,M,F,Z,J){const{seenUids:ee,hitTest:re,overlapMode:ue}=Z,ve=this.boxCells[M];if(ve!==null){const be=this.bboxes;for(const De of ve)if(!ee.box[De]){ee.box[De]=!0;const Je=4*De,Xe=this.boxKeys[De];if(n<=be[Je+2]&&y<=be[Je+3]&&I>=be[Je+0]&&A>=be[Je+1]&&(!J||J(Xe))&&(!re||!mr(ue,Xe.overlapMode))&&(F.push({key:Xe,x1:be[Je],y1:be[Je+1],x2:be[Je+2],y2:be[Je+3]}),re))return!0}}const Re=this.circleCells[M];if(Re!==null){const be=this.circles;for(const De of Re)if(!ee.circle[De]){ee.circle[De]=!0;const Je=3*De,Xe=this.circleKeys[De];if(this._circleAndRectCollide(be[Je],be[Je+1],be[Je+2],n,y,I,A)&&(!J||J(Xe))&&(!re||!mr(ue,Xe.overlapMode))){const nt=be[Je],$e=be[Je+1],xt=be[Je+2];if(F.push({key:Xe,x1:nt-xt,y1:$e-xt,x2:nt+xt,y2:$e+xt}),re)return!0}}}return!1}_queryCellCircle(n,y,I,A,M,F,Z,J){const{circle:ee,seenUids:re,overlapMode:ue}=Z,ve=this.boxCells[M];if(ve!==null){const be=this.bboxes;for(const De of ve)if(!re.box[De]){re.box[De]=!0;const Je=4*De,Xe=this.boxKeys[De];if(this._circleAndRectCollide(ee.x,ee.y,ee.radius,be[Je+0],be[Je+1],be[Je+2],be[Je+3])&&(!J||J(Xe))&&!mr(ue,Xe.overlapMode))return F.push(!0),!0}}const Re=this.circleCells[M];if(Re!==null){const be=this.circles;for(const De of Re)if(!re.circle[De]){re.circle[De]=!0;const Je=3*De,Xe=this.circleKeys[De];if(this._circlesCollide(be[Je],be[Je+1],be[Je+2],ee.x,ee.y,ee.radius)&&(!J||J(Xe))&&!mr(ue,Xe.overlapMode))return F.push(!0),!0}}}_forEachCell(n,y,I,A,M,F,Z,J){const ee=this._convertToXCellCoord(n),re=this._convertToYCellCoord(y),ue=this._convertToXCellCoord(I),ve=this._convertToYCellCoord(A);for(let Re=ee;Re<=ue;Re++)for(let be=re;be<=ve;be++)if(M.call(this,n,y,I,A,this.xCellCount*be+Re,F,Z,J))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,y,I,A,M,F){const Z=A-n,J=M-y,ee=I+F;return ee*ee>Z*Z+J*J}_circleAndRectCollide(n,y,I,A,M,F,Z){const J=(F-A)/2,ee=Math.abs(n-(A+J));if(ee>J+I)return!1;const re=(Z-M)/2,ue=Math.abs(y-(M+re));if(ue>re+I)return!1;if(ee<=J||ue<=re)return!0;const ve=ee-J,Re=ue-re;return ve*ve+Re*Re<=I*I}}function Wn(S,n,y,I,A){const M=d.create();return n?(d.scale(M,M,[1/A,1/A,1]),y||d.rotateZ(M,M,I.angle)):d.multiply(M,I.labelPlaneMatrix,S),M}function ea(S,n,y,I,A){if(n){const M=d.clone(S);return d.scale(M,M,[A,A,1]),y||d.rotateZ(M,M,-I.angle),M}return I.glCoordMatrix}function Gr(S,n){const y=[S.x,S.y,0,1];oe(y,y,n);const I=y[3];return{point:new d.pointGeometry(y[0]/I,y[1]/I),signedDistanceFromCamera:I}}function Ht(S,n){return .5+S/n*.5}function nr(S,n){const y=S[0]/S[3],I=S[1]/S[3];return y>=-n[0]&&y<=n[0]&&I>=-n[1]&&I<=n[1]}function Ki(S,n,y,I,A,M,F,Z,J){const ee=I?S.textSizeData:S.iconSizeData,re=d.evaluateSizeForZoom(ee,y.transform.zoom),ue=[256/y.width*2+1,256/y.height*2+1],ve=I?S.text.dynamicLayoutVertexArray:S.icon.dynamicLayoutVertexArray;ve.clear();const Re=S.lineVertexArray,be=I?S.text.placedSymbolArray:S.icon.placedSymbolArray,De=y.transform.width/y.transform.height;let Je=!1;for(let Xe=0;Xe<be.length;Xe++){const nt=be.get(Xe);if(nt.hidden||nt.writingMode===d.WritingMode.vertical&&!Je){te(nt.numGlyphs,ve);continue}Je=!1;const $e=[nt.anchorX,nt.anchorY,0,1];if(d.transformMat4($e,$e,n),!nr($e,ue)){te(nt.numGlyphs,ve);continue}const xt=Ht(y.transform.cameraToCenterDistance,$e[3]),ht=d.evaluateSizeForFeature(ee,re,nt),mt=F?ht/xt:ht*xt,Pt=new d.pointGeometry(nt.anchorX,nt.anchorY),Ot=Gr(Pt,A).point,wt={},ci=Ni(nt,mt,!1,Z,n,A,M,S.glyphOffsetArray,Re,ve,Ot,Pt,wt,De,J);Je=ci.useVertical,(ci.notEnoughRoom||Je||ci.needsFlipping&&Ni(nt,mt,!0,Z,n,A,M,S.glyphOffsetArray,Re,ve,Ot,Pt,wt,De,J).notEnoughRoom)&&te(nt.numGlyphs,ve)}I?S.text.dynamicLayoutVertexBuffer.updateData(ve):S.icon.dynamicLayoutVertexBuffer.updateData(ve)}function zn(S,n,y,I,A,M,F,Z,J,ee,re,ue){const ve=Z.glyphStartIndex+Z.numGlyphs,Re=Z.lineStartIndex,be=Z.lineStartIndex+Z.lineLength,De=n.getoffsetX(Z.glyphStartIndex),Je=n.getoffsetX(ve-1),Xe=Lo(S*De,y,I,A,M,F,Z.segment,Re,be,J,ee,re,ue);if(!Xe)return null;const nt=Lo(S*Je,y,I,A,M,F,Z.segment,Re,be,J,ee,re,ue);return nt?{first:Xe,last:nt}:null}function Xn(S,n,y,I){return S===d.WritingMode.horizontal&&Math.abs(y.y-n.y)>Math.abs(y.x-n.x)*I?{useVertical:!0}:(S===d.WritingMode.vertical?n.y<y.y:n.x>y.x)?{needsFlipping:!0}:null}function Ni(S,n,y,I,A,M,F,Z,J,ee,re,ue,ve,Re,be){const De=n/24,Je=S.lineOffsetX*De,Xe=S.lineOffsetY*De;let nt;if(S.numGlyphs>1){const $e=S.glyphStartIndex+S.numGlyphs,xt=S.lineStartIndex,ht=S.lineStartIndex+S.lineLength,mt=zn(De,Z,Je,Xe,y,re,ue,S,J,M,ve,be);if(!mt)return{notEnoughRoom:!0};const Pt=Gr(mt.first.point,F).point,Ot=Gr(mt.last.point,F).point;if(I&&!y){const wt=Xn(S.writingMode,Pt,Ot,Re);if(wt)return wt}nt=[mt.first];for(let wt=S.glyphStartIndex+1;wt<$e-1;wt++)nt.push(Lo(De*Z.getoffsetX(wt),Je,Xe,y,re,ue,S.segment,xt,ht,J,M,ve,be));nt.push(mt.last)}else{if(I&&!y){const xt=Gr(ue,A).point,ht=S.lineStartIndex+S.segment+1,mt=new d.pointGeometry(J.getx(ht),J.gety(ht)),Pt=Gr(mt,A),Ot=Pt.signedDistanceFromCamera>0?Pt.point:fa(ue,mt,xt,1,A),wt=Xn(S.writingMode,xt,Ot,Re);if(wt)return wt}const $e=Lo(De*Z.getoffsetX(S.glyphStartIndex),Je,Xe,y,re,ue,S.segment,S.lineStartIndex,S.lineStartIndex+S.lineLength,J,M,ve,be);if(!$e)return{notEnoughRoom:!0};nt=[$e]}for(const $e of nt)d.addDynamicAttributes(ee,$e.point,$e.angle);return{}}function fa(S,n,y,I,A){const M=Gr(S.add(S.sub(n)._unit()),A).point,F=y.sub(M);return y.add(F._mult(I/F.mag()))}function Lo(S,n,y,I,A,M,F,Z,J,ee,re,ue,ve){const Re=I?S-n:S+n;let be=Re>0?1:-1,De=0;I&&(be*=-1,De=Math.PI),be<0&&(De+=Math.PI);let Je=be>0?Z+F:Z+F+1,Xe=A,nt=A,$e=0,xt=0;const ht=Math.abs(Re),mt=[];for(;$e+xt<=ht;){if(Je+=be,Je<Z||Je>=J)return null;if(nt=Xe,mt.push(Xe),Xe=ue[Je],Xe===void 0){const ei=new d.pointGeometry(ee.getx(Je),ee.gety(Je)),Oi=Gr(ei,re);if(Oi.signedDistanceFromCamera>0)Xe=ue[Je]=Oi.point;else{const u=Je-be;Xe=fa($e===0?M:new d.pointGeometry(ee.getx(u),ee.gety(u)),ei,nt,ht-$e+1,re)}}$e+=xt,xt=nt.dist(Xe)}const Pt=(ht-$e)/xt,Ot=Xe.sub(nt),wt=Ot.mult(Pt)._add(nt);wt._add(Ot._unit()._perp()._mult(y*be));const ci=De+Math.atan2(Xe.y-nt.y,Xe.x-nt.x);return mt.push(wt),{point:wt,angle:ve?ci:0,path:mt}}const Nr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function te(S,n){for(let y=0;y<S;y++){const I=n.length;n.resize(I+4),n.float32.set(Nr,3*I)}}function oe(S,n,y){const I=n[0],A=n[1];return S[0]=y[0]*I+y[4]*A+y[12],S[1]=y[1]*I+y[5]*A+y[13],S[3]=y[3]*I+y[7]*A+y[15],S}const le=100;class ge{constructor(n,y=new Hn(n.width+200,n.height+200,25),I=new Hn(n.width+200,n.height+200,25)){this.transform=n,this.grid=y,this.ignoredGrid=I,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+le,this.screenBottomBoundary=n.height+le,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200}placeCollisionBox(n,y,I,A,M){const F=this.projectAndGetPerspectiveRatio(A,n.anchorPointX,n.anchorPointY),Z=I*F.perspectiveRatio,J=n.x1*Z+F.point.x,ee=n.y1*Z+F.point.y,re=n.x2*Z+F.point.x,ue=n.y2*Z+F.point.y;return!this.isInsideGrid(J,ee,re,ue)||y!=="always"&&this.grid.hitTest(J,ee,re,ue,y,M)?{box:[],offscreen:!1}:{box:[J,ee,re,ue],offscreen:this.isOffscreen(J,ee,re,ue)}}placeCollisionCircles(n,y,I,A,M,F,Z,J,ee,re,ue,ve,Re){const be=[],De=new d.pointGeometry(y.anchorX,y.anchorY),Je=Gr(De,F),Xe=Ht(this.transform.cameraToCenterDistance,Je.signedDistanceFromCamera),nt=(re?M/Xe:M*Xe)/d.ONE_EM,$e=Gr(De,Z).point,xt=zn(nt,A,y.lineOffsetX*nt,y.lineOffsetY*nt,!1,$e,De,y,I,Z,{},!1);let ht=!1,mt=!1,Pt=!0;if(xt){const Ot=.5*ve*Xe+Re,wt=new d.pointGeometry(-100,-100),ci=new d.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),ei=new pr,Oi=xt.first,u=xt.last;let m=[];for(let k=Oi.path.length-1;k>=1;k--)m.push(Oi.path[k]);for(let k=1;k<u.path.length;k++)m.push(u.path[k]);const p=2.5*Ot;if(J){const k=m.map(L=>Gr(L,J));m=k.some(L=>L.signedDistanceFromCamera<=0)?[]:k.map(L=>L.point)}let v=[];if(m.length>0){const k=m[0].clone(),L=m[0].clone();for(let B=1;B<m.length;B++)k.x=Math.min(k.x,m[B].x),k.y=Math.min(k.y,m[B].y),L.x=Math.max(L.x,m[B].x),L.y=Math.max(L.y,m[B].y);v=k.x>=wt.x&&L.x<=ci.x&&k.y>=wt.y&&L.y<=ci.y?[m]:L.x<wt.x||k.x>ci.x||L.y<wt.y||k.y>ci.y?[]:d.clipLine([m],wt.x,wt.y,ci.x,ci.y)}for(const k of v){ei.reset(k,.25*Ot);let L=0;L=ei.length<=.5*Ot?1:Math.ceil(ei.paddedLength/p)+1;for(let B=0;B<L;B++){const j=B/Math.max(L-1,1),Y=ei.lerp(j),ie=Y.x+le,he=Y.y+le;be.push(ie,he,Ot,0);const de=ie-Ot,me=he-Ot,Ce=ie+Ot,Te=he+Ot;if(Pt=Pt&&this.isOffscreen(de,me,Ce,Te),mt=mt||this.isInsideGrid(de,me,Ce,Te),n!=="always"&&this.grid.hitTestCircle(ie,he,Ot,n,ue)&&(ht=!0,!ee))return{circles:[],offscreen:!1,collisionDetected:ht}}}}return{circles:!ee&&ht||!mt?[]:be,offscreen:Pt,collisionDetected:ht}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const y=[];let I=1/0,A=1/0,M=-1/0,F=-1/0;for(const re of n){const ue=new d.pointGeometry(re.x+le,re.y+le);I=Math.min(I,ue.x),A=Math.min(A,ue.y),M=Math.max(M,ue.x),F=Math.max(F,ue.y),y.push(ue)}const Z=this.grid.query(I,A,M,F).concat(this.ignoredGrid.query(I,A,M,F)),J={},ee={};for(const re of Z){const ue=re.key;if(J[ue.bucketInstanceId]===void 0&&(J[ue.bucketInstanceId]={}),J[ue.bucketInstanceId][ue.featureIndex])continue;const ve=[new d.pointGeometry(re.x1,re.y1),new d.pointGeometry(re.x2,re.y1),new d.pointGeometry(re.x2,re.y2),new d.pointGeometry(re.x1,re.y2)];d.polygonIntersectsPolygon(y,ve)&&(J[ue.bucketInstanceId][ue.featureIndex]=!0,ee[ue.bucketInstanceId]===void 0&&(ee[ue.bucketInstanceId]=[]),ee[ue.bucketInstanceId].push(ue.featureIndex))}return ee}insertCollisionBox(n,y,I,A,M,F){(I?this.ignoredGrid:this.grid).insert({bucketInstanceId:A,featureIndex:M,collisionGroupID:F,overlapMode:y},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,y,I,A,M,F){const Z=I?this.ignoredGrid:this.grid,J={bucketInstanceId:A,featureIndex:M,collisionGroupID:F,overlapMode:y};for(let ee=0;ee<n.length;ee+=4)Z.insertCircle(J,n[ee],n[ee+1],n[ee+2])}projectAndGetPerspectiveRatio(n,y,I){const A=[y,I,0,1];return oe(A,A,n),{point:new d.pointGeometry((A[0]/A[3]+1)/2*this.transform.width+le,(-A[1]/A[3]+1)/2*this.transform.height+le),perspectiveRatio:.5+this.transform.cameraToCenterDistance/A[3]*.5}}isOffscreen(n,y,I,A){return I<le||n>=this.screenRightBoundary||A<le||y>this.screenBottomBoundary}isInsideGrid(n,y,I,A){return I>=0&&n<this.gridRightBoundary&&A>=0&&y<this.gridBottomBoundary}getViewportMatrix(){const n=d.identity([]);return d.translate(n,n,[-100,-100,0]),n}}function Se(S,n,y){return n*(d.EXTENT/(S.tileSize*Math.pow(2,y-S.tileID.overscaledZ)))}class Oe{constructor(n,y,I,A){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?y:-y))):A&&I?1:0,this.placed=I}isHidden(){return this.opacity===0&&!this.placed}}class Ne{constructor(n,y,I,A,M){this.text=new Oe(n?n.text:null,y,I,M),this.icon=new Oe(n?n.icon:null,y,A,M)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ye{constructor(n,y,I){this.text=n,this.icon=y,this.skipFade=I}}class Pe{constructor(){this.invProjMatrix=d.create(),this.viewportMatrix=d.create(),this.circles=[]}}class Qe{constructor(n,y,I,A,M){this.bucketInstanceId=n,this.featureIndex=y,this.sourceLayerIndex=I,this.bucketIndex=A,this.tileID=M}}class ae{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const y=++this.maxGroupID;this.collisionGroups[n]={ID:y,predicate:I=>I.collisionGroupID===y}}return this.collisionGroups[n]}}function H(S,n,y,I,A){const{horizontalAlign:M,verticalAlign:F}=d.getAnchorAlignment(S),Z=-(M-.5)*n,J=-(F-.5)*y,ee=d.evaluateVariableOffset(S,I);return new d.pointGeometry(Z+ee[0]*A,J+ee[1]*A)}function W(S,n,y,I,A,M){const{x1:F,x2:Z,y1:J,y2:ee,anchorPointX:re,anchorPointY:ue}=S,ve=new d.pointGeometry(n,y);return I&&ve._rotate(A?M:-M),{x1:F+ve.x,y1:J+ve.y,x2:Z+ve.x,y2:ee+ve.y,anchorPointX:re,anchorPointY:ue}}class ne{constructor(n,y,I,A){this.transform=n.clone(),this.collisionIndex=new ge(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=y,this.retainedQueryData={},this.collisionGroups=new ae(I),this.collisionCircleArrays={},this.prevPlacement=A,A&&(A.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,y,I,A){const M=I.getBucket(y),F=I.latestFeatureIndex;if(!M||!F||y.id!==M.layerIds[0])return;const Z=I.collisionBoxArray,J=M.layers[0].layout,ee=Math.pow(2,this.transform.zoom-I.tileID.overscaledZ),re=I.tileSize/d.EXTENT,ue=this.transform.calculatePosMatrix(I.tileID.toUnwrapped()),ve=J.get("text-pitch-alignment")==="map",Re=J.get("text-rotation-alignment")==="map",be=Se(I,1,this.transform.zoom),De=Wn(ue,ve,Re,this.transform,be);let Je=null;if(ve){const nt=ea(ue,ve,Re,this.transform,be);Je=d.multiply([],this.transform.labelPlaneMatrix,nt)}this.retainedQueryData[M.bucketInstanceId]=new Qe(M.bucketInstanceId,F,M.sourceLayerIndex,M.index,I.tileID);const Xe={bucket:M,layout:J,posMatrix:ue,textLabelPlaneMatrix:De,labelToScreenMatrix:Je,scale:ee,textPixelRatio:re,holdingForFade:I.holdingForFade(),collisionBoxArray:Z,partiallyEvaluatedTextSize:d.evaluateSizeForZoom(M.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(M.sourceID)};if(A)for(const nt of M.sortKeyRanges){const{sortKey:$e,symbolInstanceStart:xt,symbolInstanceEnd:ht}=nt;n.push({sortKey:$e,symbolInstanceStart:xt,symbolInstanceEnd:ht,parameters:Xe})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:M.symbolInstances.length,parameters:Xe})}attemptAnchorPlacement(n,y,I,A,M,F,Z,J,ee,re,ue,ve,Re,be,De){const Je=[ve.textOffset0,ve.textOffset1],Xe=H(n,I,A,Je,M),nt=this.collisionIndex.placeCollisionBox(W(y,Xe.x,Xe.y,F,Z,this.transform.angle),ue,J,ee,re.predicate);if((!De||this.collisionIndex.placeCollisionBox(W(De,Xe.x,Xe.y,F,Z,this.transform.angle),ue,J,ee,re.predicate).box.length!==0)&&nt.box.length>0){let $e;return this.prevPlacement&&this.prevPlacement.variableOffsets[ve.crossTileID]&&this.prevPlacement.placements[ve.crossTileID]&&this.prevPlacement.placements[ve.crossTileID].text&&($e=this.prevPlacement.variableOffsets[ve.crossTileID].anchor),this.variableOffsets[ve.crossTileID]={textOffset:Je,width:I,height:A,anchor:n,textBoxScale:M,prevAnchor:$e},this.markUsedJustification(Re,n,ve,be),Re.allowVerticalPlacement&&(this.markUsedOrientation(Re,be,ve),this.placedOrientations[ve.crossTileID]=be),{shift:Xe,placedGlyphBoxes:nt}}}placeLayerBucketPart(n,y,I){const{bucket:A,layout:M,posMatrix:F,textLabelPlaneMatrix:Z,labelToScreenMatrix:J,textPixelRatio:ee,holdingForFade:re,collisionBoxArray:ue,partiallyEvaluatedTextSize:ve,collisionGroup:Re}=n.parameters,be=M.get("text-optional"),De=M.get("icon-optional"),Je=d.getOverlapMode(M,"text-overlap","text-allow-overlap"),Xe=Je==="always",nt=d.getOverlapMode(M,"icon-overlap","icon-allow-overlap"),$e=nt==="always",xt=M.get("text-rotation-alignment")==="map",ht=M.get("text-pitch-alignment")==="map",mt=M.get("icon-text-fit")!=="none",Pt=M.get("symbol-z-order")==="viewport-y",Ot=Xe&&($e||!A.hasIconData()||De),wt=$e&&(Xe||!A.hasTextData()||be);!A.collisionArrays&&ue&&A.deserializeCollisionBoxes(ue);const ci=(ei,Oi)=>{if(y[ei.crossTileID])return;if(re)return void(this.placements[ei.crossTileID]=new ye(!1,!1,!1));let u=!1,m=!1,p=!0,v=null,k={box:null,offscreen:null},L={box:null,offscreen:null},B=null,j=null,Y=null,ie=0,he=0,de=0;Oi.textFeatureIndex?ie=Oi.textFeatureIndex:ei.useRuntimeCollisionCircles&&(ie=ei.featureIndex),Oi.verticalTextFeatureIndex&&(he=Oi.verticalTextFeatureIndex);const me=Oi.textBox;if(me){const Le=ze=>{let Fe=d.WritingMode.horizontal;if(A.allowVerticalPlacement&&!ze&&this.prevPlacement){const Ye=this.prevPlacement.placedOrientations[ei.crossTileID];Ye&&(this.placedOrientations[ei.crossTileID]=Ye,Fe=Ye,this.markUsedOrientation(A,Fe,ei))}return Fe},xe=(ze,Fe)=>{if(A.allowVerticalPlacement&&ei.numVerticalGlyphVertices>0&&Oi.verticalTextBox){for(const Ye of A.writingModes)if(Ye===d.WritingMode.vertical?(k=Fe(),L=k):k=ze(),k&&k.box&&k.box.length)break}else k=ze()};if(M.get("text-variable-anchor")){let ze=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ei.crossTileID]){const ot=this.prevPlacement.variableOffsets[ei.crossTileID];ze.indexOf(ot.anchor)>0&&(ze=ze.filter(at=>at!==ot.anchor),ze.unshift(ot.anchor))}const Fe=(ot,at,st)=>{const It=ot.x2-ot.x1,Lt=ot.y2-ot.y1,Mt=ei.textBoxScale,Yt=mt&&nt==="never"?at:null;let di={box:[],offscreen:!1};const _i=Je!=="never"?2*ze.length:ze.length;for(let hi=0;hi<_i;++hi){const ar=this.attemptAnchorPlacement(ze[hi%ze.length],ot,It,Lt,Mt,xt,ht,ee,F,Re,hi>=ze.length?Je:"never",ei,A,st,Yt);if(ar&&(di=ar.placedGlyphBoxes,di&&di.box&&di.box.length)){u=!0,v=ar.shift;break}}return di};xe(()=>Fe(me,Oi.iconBox,d.WritingMode.horizontal),()=>{const ot=Oi.verticalTextBox;return A.allowVerticalPlacement&&!(k&&k.box&&k.box.length)&&ei.numVerticalGlyphVertices>0&&ot?Fe(ot,Oi.verticalIconBox,d.WritingMode.vertical):{box:null,offscreen:null}}),k&&(u=k.box,p=k.offscreen);const Ye=Le(k&&k.box);if(!u&&this.prevPlacement){const ot=this.prevPlacement.variableOffsets[ei.crossTileID];ot&&(this.variableOffsets[ei.crossTileID]=ot,this.markUsedJustification(A,ot.anchor,ei,Ye))}}else{const ze=(Fe,Ye)=>{const ot=this.collisionIndex.placeCollisionBox(Fe,Je,ee,F,Re.predicate);return ot&&ot.box&&ot.box.length&&(this.markUsedOrientation(A,Ye,ei),this.placedOrientations[ei.crossTileID]=Ye),ot};xe(()=>ze(me,d.WritingMode.horizontal),()=>{const Fe=Oi.verticalTextBox;return A.allowVerticalPlacement&&ei.numVerticalGlyphVertices>0&&Fe?ze(Fe,d.WritingMode.vertical):{box:null,offscreen:null}}),Le(k&&k.box&&k.box.length)}}if(B=k,u=B&&B.box&&B.box.length>0,p=B&&B.offscreen,ei.useRuntimeCollisionCircles){const Le=A.text.placedSymbolArray.get(ei.centerJustifiedTextSymbolIndex),xe=d.evaluateSizeForFeature(A.textSizeData,ve,Le),ze=M.get("text-padding");j=this.collisionIndex.placeCollisionCircles(Je,Le,A.lineVertexArray,A.glyphOffsetArray,xe,F,Z,J,I,ht,Re.predicate,ei.collisionCircleDiameter,ze),u=Xe||j.circles.length>0&&!j.collisionDetected,p=p&&j.offscreen}if(Oi.iconFeatureIndex&&(de=Oi.iconFeatureIndex),Oi.iconBox){const Le=xe=>{const ze=mt&&v?W(xe,v.x,v.y,xt,ht,this.transform.angle):xe;return this.collisionIndex.placeCollisionBox(ze,nt,ee,F,Re.predicate)};L&&L.box&&L.box.length&&Oi.verticalIconBox?(Y=Le(Oi.verticalIconBox),m=Y.box.length>0):(Y=Le(Oi.iconBox),m=Y.box.length>0),p=p&&Y.offscreen}const Ce=be||ei.numHorizontalGlyphVertices===0&&ei.numVerticalGlyphVertices===0,Te=De||ei.numIconVertices===0;if(Ce||Te?Te?Ce||(m=m&&u):u=m&&u:m=u=m&&u,u&&B&&B.box&&this.collisionIndex.insertCollisionBox(B.box,Je,M.get("text-ignore-placement"),A.bucketInstanceId,L&&L.box&&he?he:ie,Re.ID),m&&Y&&this.collisionIndex.insertCollisionBox(Y.box,nt,M.get("icon-ignore-placement"),A.bucketInstanceId,de,Re.ID),j&&(u&&this.collisionIndex.insertCollisionCircles(j.circles,Je,M.get("text-ignore-placement"),A.bucketInstanceId,ie,Re.ID),I)){const Le=A.bucketInstanceId;let xe=this.collisionCircleArrays[Le];xe===void 0&&(xe=this.collisionCircleArrays[Le]=new Pe);for(let ze=0;ze<j.circles.length;ze+=4)xe.circles.push(j.circles[ze+0]),xe.circles.push(j.circles[ze+1]),xe.circles.push(j.circles[ze+2]),xe.circles.push(j.collisionDetected?1:0)}this.placements[ei.crossTileID]=new ye(u||Ot,m||wt,p||A.justReloaded),y[ei.crossTileID]=!0};if(Pt){const ei=A.getSortedSymbolIndexes(this.transform.angle);for(let Oi=ei.length-1;Oi>=0;--Oi){const u=ei[Oi];ci(A.symbolInstances.get(u),A.collisionArrays[u])}}else for(let ei=n.symbolInstanceStart;ei<n.symbolInstanceEnd;ei++)ci(A.symbolInstances.get(ei),A.collisionArrays[ei]);if(I&&A.bucketInstanceId in this.collisionCircleArrays){const ei=this.collisionCircleArrays[A.bucketInstanceId];d.invert(ei.invProjMatrix,F),ei.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(n,y,I,A){let M;M=A===d.WritingMode.vertical?I.verticalPlacedTextSymbolIndex:{left:I.leftJustifiedTextSymbolIndex,center:I.centerJustifiedTextSymbolIndex,right:I.rightJustifiedTextSymbolIndex}[d.getAnchorJustification(y)];const F=[I.leftJustifiedTextSymbolIndex,I.centerJustifiedTextSymbolIndex,I.rightJustifiedTextSymbolIndex,I.verticalPlacedTextSymbolIndex];for(const Z of F)Z>=0&&(n.text.placedSymbolArray.get(Z).crossTileID=M>=0&&Z!==M?0:I.crossTileID)}markUsedOrientation(n,y,I){const A=y===d.WritingMode.horizontal||y===d.WritingMode.horizontalOnly?y:0,M=y===d.WritingMode.vertical?y:0,F=[I.leftJustifiedTextSymbolIndex,I.centerJustifiedTextSymbolIndex,I.rightJustifiedTextSymbolIndex];for(const Z of F)n.text.placedSymbolArray.get(Z).placedOrientation=A;I.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(I.verticalPlacedTextSymbolIndex).placedOrientation=M)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const y=this.prevPlacement;let I=!1;this.prevZoomAdjustment=y?y.zoomAdjustment(this.transform.zoom):0;const A=y?y.symbolFadeChange(n):1,M=y?y.opacities:{},F=y?y.variableOffsets:{},Z=y?y.placedOrientations:{};for(const J in this.placements){const ee=this.placements[J],re=M[J];re?(this.opacities[J]=new Ne(re,A,ee.text,ee.icon),I=I||ee.text!==re.text.placed||ee.icon!==re.icon.placed):(this.opacities[J]=new Ne(null,A,ee.text,ee.icon,ee.skipFade),I=I||ee.text||ee.icon)}for(const J in M){const ee=M[J];if(!this.opacities[J]){const re=new Ne(ee,A,!1,!1);re.isHidden()||(this.opacities[J]=re,I=I||ee.text.placed||ee.icon.placed)}}for(const J in F)this.variableOffsets[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.variableOffsets[J]=F[J]);for(const J in Z)this.placedOrientations[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.placedOrientations[J]=Z[J]);I?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=y?y.lastPlacementChangeTime:n)}updateLayerOpacities(n,y){const I={};for(const A of y){const M=A.getBucket(n);M&&A.latestFeatureIndex&&n.id===M.layerIds[0]&&this.updateBucketOpacities(M,I,A.collisionBoxArray)}}updateBucketOpacities(n,y,I){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const A=n.layers[0].layout,M=new Ne(null,0,!1,!1,!0),F=A.get("text-allow-overlap"),Z=A.get("icon-allow-overlap"),J=A.get("text-variable-anchor"),ee=A.get("text-rotation-alignment")==="map",re=A.get("text-pitch-alignment")==="map",ue=A.get("icon-text-fit")!=="none",ve=new Ne(null,0,F&&(Z||!n.hasIconData()||A.get("icon-optional")),Z&&(F||!n.hasTextData()||A.get("text-optional")),!0);!n.collisionArrays&&I&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(I);const Re=(be,De,Je)=>{for(let Xe=0;Xe<De/4;Xe++)be.opacityVertexArray.emplaceBack(Je)};for(let be=0;be<n.symbolInstances.length;be++){const De=n.symbolInstances.get(be),{numHorizontalGlyphVertices:Je,numVerticalGlyphVertices:Xe,crossTileID:nt}=De;let $e=this.opacities[nt];y[nt]?$e=M:$e||($e=ve,this.opacities[nt]=$e),y[nt]=!0;const xt=De.numIconVertices>0,ht=this.placedOrientations[De.crossTileID],mt=ht===d.WritingMode.vertical,Pt=ht===d.WritingMode.horizontal||ht===d.WritingMode.horizontalOnly;if(Je>0||Xe>0){const Ot=tt($e.text);Re(n.text,Je,mt?Ft:Ot),Re(n.text,Xe,Pt?Ft:Ot);const wt=$e.text.isHidden();[De.rightJustifiedTextSymbolIndex,De.centerJustifiedTextSymbolIndex,De.leftJustifiedTextSymbolIndex].forEach(Oi=>{Oi>=0&&(n.text.placedSymbolArray.get(Oi).hidden=wt||mt?1:0)}),De.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(De.verticalPlacedTextSymbolIndex).hidden=wt||Pt?1:0);const ci=this.variableOffsets[De.crossTileID];ci&&this.markUsedJustification(n,ci.anchor,De,ht);const ei=this.placedOrientations[De.crossTileID];ei&&(this.markUsedJustification(n,"left",De,ei),this.markUsedOrientation(n,ei,De))}if(xt){const Ot=tt($e.icon),wt=!(ue&&De.verticalPlacedIconSymbolIndex&&mt);De.placedIconSymbolIndex>=0&&(Re(n.icon,De.numIconVertices,wt?Ot:Ft),n.icon.placedSymbolArray.get(De.placedIconSymbolIndex).hidden=$e.icon.isHidden()),De.verticalPlacedIconSymbolIndex>=0&&(Re(n.icon,De.numVerticalIconVertices,wt?Ft:Ot),n.icon.placedSymbolArray.get(De.verticalPlacedIconSymbolIndex).hidden=$e.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Ot=n.collisionArrays[be];if(Ot){let wt=new d.pointGeometry(0,0);if(Ot.textBox||Ot.verticalTextBox){let ei=!0;if(J){const Oi=this.variableOffsets[nt];Oi?(wt=H(Oi.anchor,Oi.width,Oi.height,Oi.textOffset,Oi.textBoxScale),ee&&wt._rotate(re?this.transform.angle:-this.transform.angle)):ei=!1}Ot.textBox&&ce(n.textCollisionBox.collisionVertexArray,$e.text.placed,!ei||mt,wt.x,wt.y),Ot.verticalTextBox&&ce(n.textCollisionBox.collisionVertexArray,$e.text.placed,!ei||Pt,wt.x,wt.y)}const ci=Boolean(!Pt&&Ot.verticalIconBox);Ot.iconBox&&ce(n.iconCollisionBox.collisionVertexArray,$e.icon.placed,ci,ue?wt.x:0,ue?wt.y:0),Ot.verticalIconBox&&ce(n.iconCollisionBox.collisionVertexArray,$e.icon.placed,!ci,ue?wt.x:0,ue?wt.y:0)}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const be=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=be.invProjMatrix,n.placementViewportMatrix=be.viewportMatrix,n.collisionCircleArray=be.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,y){const I=this.zoomAtLastRecencyCheck===y?1-this.zoomAdjustment(y):1;return this.zoomAtLastRecencyCheck=y,this.commitTime+this.fadeDuration*I>n}setStale(){this.stale=!0}}function ce(S,n,y,I,A){S.emplaceBack(n?1:0,y?1:0,I||0,A||0),S.emplaceBack(n?1:0,y?1:0,I||0,A||0),S.emplaceBack(n?1:0,y?1:0,I||0,A||0),S.emplaceBack(n?1:0,y?1:0,I||0,A||0)}const _e=Math.pow(2,25),fe=Math.pow(2,24),Ee=Math.pow(2,17),we=Math.pow(2,16),Ie=Math.pow(2,9),et=Math.pow(2,8),Ke=Math.pow(2,1);function tt(S){if(S.opacity===0&&!S.placed)return 0;if(S.opacity===1&&S.placed)return 4294967295;const n=S.placed?1:0,y=Math.floor(127*S.opacity);return y*_e+n*fe+y*Ee+n*we+y*Ie+n*et+y*Ke+n}const Ft=0;class At{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,y,I,A,M){const F=this._bucketParts;for(;this._currentTileIndex<n.length;)if(y.getBucketParts(F,A,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,M())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,F.sort((Z,J)=>Z.sortKey-J.sortKey));this._currentPartIndex<F.length;)if(y.placeLayerBucketPart(F[this._currentPartIndex],this._seenCrossTileIDs,I),this._currentPartIndex++,M())return!0;return!1}}class Bt{constructor(n,y,I,A,M,F,Z){this.placement=new ne(n,M,F,Z),this._currentPlacementIndex=y.length-1,this._forceFullPlacement=I,this._showCollisionBoxes=A,this._done=!1}isDone(){return this._done}continuePlacement(n,y,I){const A=d.exported.now(),M=()=>{const F=d.exported.now()-A;return!this._forceFullPlacement&&F>2};for(;this._currentPlacementIndex>=0;){const F=y[n[this._currentPlacementIndex]],Z=this.placement.collisionIndex.transform.zoom;if(F.type==="symbol"&&(!F.minzoom||F.minzoom<=Z)&&(!F.maxzoom||F.maxzoom>Z)){if(this._inProgressLayer||(this._inProgressLayer=new At(F)),this._inProgressLayer.continuePlacement(I[F.source],this.placement,this._showCollisionBoxes,F,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const jt=512/d.EXTENT/2;class Hi{constructor(n,y,I){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=I;for(let A=0;A<y.length;A++){const M=y.get(A),F=M.key;this.indexedSymbolInstances[F]||(this.indexedSymbolInstances[F]=[]),this.indexedSymbolInstances[F].push({crossTileID:M.crossTileID,coord:this.getScaledCoordinates(M,n)})}}getScaledCoordinates(n,y){const I=jt/Math.pow(2,y.canonical.z-this.tileID.canonical.z);return{x:Math.floor((y.canonical.x*d.EXTENT+n.anchorX)*I),y:Math.floor((y.canonical.y*d.EXTENT+n.anchorY)*I)}}findMatches(n,y,I){const A=this.tileID.canonical.z<y.canonical.z?1:Math.pow(2,this.tileID.canonical.z-y.canonical.z);for(let M=0;M<n.length;M++){const F=n.get(M);if(F.crossTileID)continue;const Z=this.indexedSymbolInstances[F.key];if(!Z)continue;const J=this.getScaledCoordinates(F,y);for(const ee of Z)if(Math.abs(ee.coord.x-J.x)<=A&&Math.abs(ee.coord.y-J.y)<=A&&!I[ee.crossTileID]){I[ee.crossTileID]=!0,F.crossTileID=ee.crossTileID;break}}}}class mi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ii{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const y=Math.round((n-this.lng)/360);if(y!==0)for(const I in this.indexes){const A=this.indexes[I],M={};for(const F in A){const Z=A[F];Z.tileID=Z.tileID.unwrapTo(Z.tileID.wrap+y),M[Z.tileID.key]=Z}this.indexes[I]=M}this.lng=n}addBucket(n,y,I){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===y.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let M=0;M<y.symbolInstances.length;M++)y.symbolInstances.get(M).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const A=this.usedCrossTileIDs[n.overscaledZ];for(const M in this.indexes){const F=this.indexes[M];if(Number(M)>n.overscaledZ)for(const Z in F){const J=F[Z];J.tileID.isChildOf(n)&&J.findMatches(y.symbolInstances,n,A)}else{const Z=F[n.scaledTo(Number(M)).key];Z&&Z.findMatches(y.symbolInstances,n,A)}}for(let M=0;M<y.symbolInstances.length;M++){const F=y.symbolInstances.get(M);F.crossTileID||(F.crossTileID=I.generate(),A[F.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Hi(n,y.symbolInstances,y.bucketInstanceId),!0}removeBucketCrossTileIDs(n,y){for(const I in y.indexedSymbolInstances)for(const A of y.indexedSymbolInstances[I])delete this.usedCrossTileIDs[n][A.crossTileID]}removeStaleBuckets(n){let y=!1;for(const I in this.indexes){const A=this.indexes[I];for(const M in A)n[A[M].bucketInstanceId]||(this.removeBucketCrossTileIDs(I,A[M]),delete A[M],y=!0)}return y}}class li{constructor(){this.layerIndexes={},this.crossTileIDs=new mi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,y,I){let A=this.layerIndexes[n.id];A===void 0&&(A=this.layerIndexes[n.id]=new Ii);let M=!1;const F={};A.handleWrapJump(I);for(const Z of y){const J=Z.getBucket(n);J&&n.id===J.layerIds[0]&&(J.bucketInstanceId||(J.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(Z.tileID,J,this.crossTileIDs)&&(M=!0),F[J.bucketInstanceId]=!0)}return A.removeStaleBuckets(F)&&(M=!0),M}pruneUnusedLayers(n){const y={};n.forEach(I=>{y[I]=!0});for(const I in this.layerIndexes)y[I]||delete this.layerIndexes[I]}}const Kt=(S,n)=>d.emitValidationErrors(S,n&&n.filter(y=>y.identifier!=="source.canvas")),Pi=d.pick(Zi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),_r=d.pick(Zi,["setCenter","setZoom","setBearing","setPitch"]),Sn=function(){const S={},n=d.spec.$version;for(const y in d.spec.$root){const I=d.spec.$root[y];if(I.required){let A=null;A=y==="version"?n:I.type==="array"?[]:{},A!=null&&(S[y]=A)}}return S}();class Er extends d.Evented{constructor(n,y={}){super(),this.map=n,this.dispatcher=new Qt(fn(),this),this.imageManager=new ct,this.imageManager.setEventedParent(this),this.glyphManager=new Et(n._requestManager,y.localIdeographFontFamily),this.lineAtlas=new Xt(256,512),this.crossTileSymbolIndex=new li,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new d.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",d.getReferrer());const I=this;this._rtlTextPluginCallback=Er.registerForPluginStateChange(A=>{I.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:A.pluginStatus,pluginURL:A.pluginURL},(M,F)=>{if(d.triggerPluginCompletionEvent(M),F&&F.every(Z=>Z))for(const Z in I.sourceCaches)I.sourceCaches[Z].reload()})}),this.on("data",A=>{if(A.dataType!=="source"||A.sourceDataType!=="metadata")return;const M=this.sourceCaches[A.sourceId];if(!M)return;const F=M.getSource();if(F&&F.vectorLayerIds)for(const Z in this._layers){const J=this._layers[Z];J.source===F.id&&this._validateLayer(J)}})}loadURL(n,y={}){this.fire(new d.Event("dataloading",{dataType:"style"}));const I=typeof y.validate!="boolean"||y.validate,A=this.map._requestManager.transformRequest(n,d.ResourceType.Style);this._request=d.getJSON(A,(M,F)=>{this._request=null,M?this.fire(new d.ErrorEvent(M)):F&&this._load(F,I)})}loadJSON(n,y={}){this.fire(new d.Event("dataloading",{dataType:"style"})),this._request=d.exported.frame(()=>{this._request=null,this._load(n,y.validate!==!1)})}loadEmpty(){this.fire(new d.Event("dataloading",{dataType:"style"})),this._load(Sn,!1)}_load(n,y){if(y&&Kt(this,d.validateStyle(n)))return;this._loaded=!0,this.stylesheet=n;for(const A in n.sources)this.addSource(A,n.sources[A],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);const I=Gn(this.stylesheet.layers);this._order=I.map(A=>A.id),this._layers={},this._serializedLayers={};for(let A of I)A=d.createStyleLayer(A),A.setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=A,this._serializedLayers[A.id]=A.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new qi(this.stylesheet.light),this.fire(new d.Event("data",{dataType:"style"})),this.fire(new d.Event("style.load"))}_loadSprite(n){this._spriteRequest=function(y,I,A,M){let F,Z,J;const ee=A>1?"@2x":"";let re=d.getJSON(I.transformRequest(I.normalizeSpriteURL(y,ee,".json"),d.ResourceType.SpriteJSON),(Re,be)=>{re=null,J||(J=Re,F=be,ve())}),ue=d.getImage(I.transformRequest(I.normalizeSpriteURL(y,ee,".png"),d.ResourceType.SpriteImage),(Re,be)=>{ue=null,J||(J=Re,Z=be,ve())});function ve(){if(J)M(J);else if(F&&Z){const Re=d.exported.getImageData(Z),be={};for(const De in F){const{width:Je,height:Xe,x:nt,y:$e,sdf:xt,pixelRatio:ht,stretchX:mt,stretchY:Pt,content:Ot}=F[De],wt=new d.RGBAImage({width:Je,height:Xe});d.RGBAImage.copy(Re,wt,{x:nt,y:$e},{x:0,y:0},{width:Je,height:Xe}),be[De]={data:wt,pixelRatio:ht,sdf:xt,stretchX:mt,stretchY:Pt,content:Ot}}M(null,be)}}return{cancel(){re&&(re.cancel(),re=null),ue&&(ue.cancel(),ue=null)}}}(n,this.map._requestManager,this.map.getPixelRatio(),(y,I)=>{if(this._spriteRequest=null,y)this.fire(new d.ErrorEvent(y));else if(I)for(const A in I)this.imageManager.addImage(A,I[A]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new d.Event("data",{dataType:"style"}))})}_validateLayer(n){const y=this.sourceCaches[n.source];if(!y)return;const I=n.sourceLayer;if(!I)return;const A=y.getSource();(A.type==="geojson"||A.vectorLayerIds&&A.vectorLayerIds.indexOf(I)===-1)&&this.fire(new d.ErrorEvent(new Error(`Source layer "${I}" does not exist on source "${A.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(n){const y=[];for(const I of n){const A=this._layers[I];A.type!=="custom"&&y.push(A.serialize())}return y}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const y=this._changed;if(this._changed){const A=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);(A.length||M.length)&&this._updateWorkerLayers(A,M);for(const F in this._updatedSources){const Z=this._updatedSources[F];Z==="reload"?this._reloadSource(F):Z==="clear"&&this._clearSource(F)}this._updateTilesForChangedImages();for(const F in this._updatedPaintProps)this._layers[F].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}const I={};for(const A in this.sourceCaches){const M=this.sourceCaches[A];I[A]=M.used,M.used=!1}for(const A of this._order){const M=this._layers[A];M.recalculate(n,this._availableImages),!M.isHidden(n.zoom)&&M.source&&(this.sourceCaches[M.source].used=!0)}for(const A in I){const M=this.sourceCaches[A];I[A]!==M.used&&M.fire(new d.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:A}))}this.light.recalculate(n),this.z=n.zoom,y&&this.fire(new d.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const y in this.sourceCaches)this.sourceCaches[y].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateWorkerLayers(n,y){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:y})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(n){if(this._checkLoaded(),Kt(this,d.validateStyle(n)))return!1;(n=d.clone$1(n)).layers=Gn(n.layers);const y=function(A,M){if(!A)return[{command:Zi.setStyle,args:[M]}];let F=[];try{if(!G(A.version,M.version))return[{command:Zi.setStyle,args:[M]}];G(A.center,M.center)||F.push({command:Zi.setCenter,args:[M.center]}),G(A.zoom,M.zoom)||F.push({command:Zi.setZoom,args:[M.zoom]}),G(A.bearing,M.bearing)||F.push({command:Zi.setBearing,args:[M.bearing]}),G(A.pitch,M.pitch)||F.push({command:Zi.setPitch,args:[M.pitch]}),G(A.sprite,M.sprite)||F.push({command:Zi.setSprite,args:[M.sprite]}),G(A.glyphs,M.glyphs)||F.push({command:Zi.setGlyphs,args:[M.glyphs]}),G(A.transition,M.transition)||F.push({command:Zi.setTransition,args:[M.transition]}),G(A.light,M.light)||F.push({command:Zi.setLight,args:[M.light]});const Z={},J=[];(function(re,ue,ve,Re){let be;for(be in ue=ue||{},re=re||{})Object.prototype.hasOwnProperty.call(re,be)&&(Object.prototype.hasOwnProperty.call(ue,be)||_o(be,ve,Re));for(be in ue)Object.prototype.hasOwnProperty.call(ue,be)&&(Object.prototype.hasOwnProperty.call(re,be)?G(re[be],ue[be])||(re[be].type==="geojson"&&ue[be].type==="geojson"&&Ra(re,ue,be)?ve.push({command:Zi.setGeoJSONSourceData,args:[be,ue[be].data]}):Zn(be,ue,ve,Re)):Fn(be,ue,ve))})(A.sources,M.sources,J,Z);const ee=[];A.layers&&A.layers.forEach(re=>{Z[re.source]?F.push({command:Zi.removeLayer,args:[re.id]}):ee.push(re)}),F=F.concat(J),function(re,ue,ve){ue=ue||[];const Re=(re=re||[]).map(_t),be=ue.map(_t),De=re.reduce(bi,{}),Je=ue.reduce(bi,{}),Xe=Re.slice(),nt=Object.create(null);let $e,xt,ht,mt,Pt,Ot,wt;for($e=0,xt=0;$e<Re.length;$e++)ht=Re[$e],Object.prototype.hasOwnProperty.call(Je,ht)?xt++:(ve.push({command:Zi.removeLayer,args:[ht]}),Xe.splice(Xe.indexOf(ht,xt),1));for($e=0,xt=0;$e<be.length;$e++)ht=be[be.length-1-$e],Xe[Xe.length-1-$e]!==ht&&(Object.prototype.hasOwnProperty.call(De,ht)?(ve.push({command:Zi.removeLayer,args:[ht]}),Xe.splice(Xe.lastIndexOf(ht,Xe.length-xt),1)):xt++,Ot=Xe[Xe.length-$e],ve.push({command:Zi.addLayer,args:[Je[ht],Ot]}),Xe.splice(Xe.length-$e,0,ht),nt[ht]=!0);for($e=0;$e<be.length;$e++)if(ht=be[$e],mt=De[ht],Pt=Je[ht],!nt[ht]&&!G(mt,Pt))if(G(mt.source,Pt.source)&&G(mt["source-layer"],Pt["source-layer"])&&G(mt.type,Pt.type)){for(wt in Ue(mt.layout,Pt.layout,ve,ht,null,Zi.setLayoutProperty),Ue(mt.paint,Pt.paint,ve,ht,null,Zi.setPaintProperty),G(mt.filter,Pt.filter)||ve.push({command:Zi.setFilter,args:[ht,Pt.filter]}),G(mt.minzoom,Pt.minzoom)&&G(mt.maxzoom,Pt.maxzoom)||ve.push({command:Zi.setLayerZoomRange,args:[ht,Pt.minzoom,Pt.maxzoom]}),mt)Object.prototype.hasOwnProperty.call(mt,wt)&&wt!=="layout"&&wt!=="paint"&&wt!=="filter"&&wt!=="metadata"&&wt!=="minzoom"&&wt!=="maxzoom"&&(wt.indexOf("paint.")===0?Ue(mt[wt],Pt[wt],ve,ht,wt.slice(6),Zi.setPaintProperty):G(mt[wt],Pt[wt])||ve.push({command:Zi.setLayerProperty,args:[ht,wt,Pt[wt]]}));for(wt in Pt)Object.prototype.hasOwnProperty.call(Pt,wt)&&!Object.prototype.hasOwnProperty.call(mt,wt)&&wt!=="layout"&&wt!=="paint"&&wt!=="filter"&&wt!=="metadata"&&wt!=="minzoom"&&wt!=="maxzoom"&&(wt.indexOf("paint.")===0?Ue(mt[wt],Pt[wt],ve,ht,wt.slice(6),Zi.setPaintProperty):G(mt[wt],Pt[wt])||ve.push({command:Zi.setLayerProperty,args:[ht,wt,Pt[wt]]}))}else ve.push({command:Zi.removeLayer,args:[ht]}),Ot=Xe[Xe.lastIndexOf(ht)+1],ve.push({command:Zi.addLayer,args:[Pt,Ot]})}(ee,M.layers,F)}catch(Z){console.warn("Unable to compute style diff:",Z),F=[{command:Zi.setStyle,args:[M]}]}return F}(this.serialize(),n).filter(A=>!(A.command in _r));if(y.length===0)return!1;const I=y.filter(A=>!(A.command in Pi));if(I.length>0)throw new Error(`Unimplemented: ${I.map(A=>A.command).join(", ")}.`);return y.forEach(A=>{A.command!=="setTransition"&&this[A.command].apply(this,A.args)}),this.stylesheet=n,!0}addImage(n,y){if(this.getImage(n))return this.fire(new d.ErrorEvent(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,y),this._afterImageUpdated(n)}updateImage(n,y){this.imageManager.updateImage(n,y)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new d.ErrorEvent(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new d.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,y,I={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!y.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(y).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(y.type)>=0&&this._validate(d.validateStyle.source,`sources.${n}`,y,null,I))return;this.map&&this.map._collectResourceTiming&&(y.collectResourceTiming=!0);const A=this.sourceCaches[n]=new rt(n,y,this.dispatcher);A.style=this,A.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:A.serialize(),sourceId:n})),A.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const I in this._layers)if(this._layers[I].source===n)return this.fire(new d.ErrorEvent(new Error(`Source "${n}" cannot be removed while layer "${I}" is using it.`)));const y=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],y.fire(new d.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),y.setEventedParent(null),y.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,y){this._checkLoaded(),this.sourceCaches[n].getSource().setData(y),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,y,I={}){this._checkLoaded();const A=n.id;if(this.getLayer(A))return void this.fire(new d.ErrorEvent(new Error(`Layer "${A}" already exists on this map.`)));let M;if(n.type==="custom"){if(Kt(this,d.validateCustomStyleLayer(n)))return;M=d.createStyleLayer(n)}else{if(typeof n.source=="object"&&(this.addSource(A,n.source),n=d.clone$1(n),n=d.extend(n,{source:A})),this._validate(d.validateStyle.layer,`layers.${A}`,n,{arrayIndex:-1},I))return;M=d.createStyleLayer(n),this._validateLayer(M),M.setEventedParent(this,{layer:{id:A}}),this._serializedLayers[M.id]=M.serialize()}const F=y?this._order.indexOf(y):this._order.length;if(y&&F===-1)this.fire(new d.ErrorEvent(new Error(`Cannot add layer "${A}" before non-existing layer "${y}".`)));else{if(this._order.splice(F,0,A),this._layerOrderChanged=!0,this._layers[A]=M,this._removedLayers[A]&&M.source&&M.type!=="custom"){const Z=this._removedLayers[A];delete this._removedLayers[A],Z.type!==M.type?this._updatedSources[M.source]="clear":(this._updatedSources[M.source]="reload",this.sourceCaches[M.source].pause())}this._updateLayer(M),M.onAdd&&M.onAdd(this.map)}}moveLayer(n,y){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new d.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===y)return;const I=this._order.indexOf(n);this._order.splice(I,1);const A=y?this._order.indexOf(y):this._order.length;y&&A===-1?this.fire(new d.ErrorEvent(new Error(`Cannot move layer "${n}" before non-existing layer "${y}".`))):(this._order.splice(A,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const y=this._layers[n];if(!y)return void this.fire(new d.ErrorEvent(new Error(`Cannot remove non-existing layer "${n}".`)));y.setEventedParent(null);const I=this._order.indexOf(n);this._order.splice(I,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=y,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],y.onRemove&&y.onRemove(this.map)}getLayer(n){return this._layers[n]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,y,I){this._checkLoaded();const A=this.getLayer(n);A?A.minzoom===y&&A.maxzoom===I||(y!=null&&(A.minzoom=y),I!=null&&(A.maxzoom=I),this._updateLayer(A)):this.fire(new d.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,y,I={}){this._checkLoaded();const A=this.getLayer(n);if(A){if(!G(A.filter,y))return y==null?(A.filter=void 0,void this._updateLayer(A)):void(this._validate(d.validateStyle.filter,`layers.${A.id}.filter`,y,null,I)||(A.filter=d.clone$1(y),this._updateLayer(A)))}else this.fire(new d.ErrorEvent(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return d.clone$1(this.getLayer(n).filter)}setLayoutProperty(n,y,I,A={}){this._checkLoaded();const M=this.getLayer(n);M?G(M.getLayoutProperty(y),I)||(M.setLayoutProperty(y,I,A),this._updateLayer(M)):this.fire(new d.ErrorEvent(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,y){const I=this.getLayer(n);if(I)return I.getLayoutProperty(y);this.fire(new d.ErrorEvent(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,y,I,A={}){this._checkLoaded();const M=this.getLayer(n);M?G(M.getPaintProperty(y),I)||(M.setPaintProperty(y,I,A)&&this._updateLayer(M),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new d.ErrorEvent(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,y){return this.getLayer(n).getPaintProperty(y)}setFeatureState(n,y){this._checkLoaded();const I=n.source,A=n.sourceLayer,M=this.sourceCaches[I];if(M===void 0)return void this.fire(new d.ErrorEvent(new Error(`The source '${I}' does not exist in the map's style.`)));const F=M.getSource().type;F==="geojson"&&A?this.fire(new d.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):F!=="vector"||A?(n.id===void 0&&this.fire(new d.ErrorEvent(new Error("The feature id parameter must be provided."))),M.setFeatureState(A,n.id,y)):this.fire(new d.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,y){this._checkLoaded();const I=n.source,A=this.sourceCaches[I];if(A===void 0)return void this.fire(new d.ErrorEvent(new Error(`The source '${I}' does not exist in the map's style.`)));const M=A.getSource().type,F=M==="vector"?n.sourceLayer:void 0;M!=="vector"||F?y&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new d.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):A.removeFeatureState(F,n.id,y):this.fire(new d.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const y=n.source,I=n.sourceLayer,A=this.sourceCaches[y];if(A!==void 0)return A.getSource().type!=="vector"||I?(n.id===void 0&&this.fire(new d.ErrorEvent(new Error("The feature id parameter must be provided."))),A.getFeatureState(I,n.id)):void this.fire(new d.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new d.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)))}getTransition(){return d.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return d.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:d.mapObject(this.sourceCaches,n=>n.serialize()),layers:this._serializeLayers(this._order)},n=>n!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(n){const y=F=>this._layers[F].type==="fill-extrusion",I={},A=[];for(let F=this._order.length-1;F>=0;F--){const Z=this._order[F];if(y(Z)){I[Z]=F;for(const J of n){const ee=J[Z];if(ee)for(const re of ee)A.push(re)}}}A.sort((F,Z)=>Z.intersectionZ-F.intersectionZ);const M=[];for(let F=this._order.length-1;F>=0;F--){const Z=this._order[F];if(y(Z))for(let J=A.length-1;J>=0;J--){const ee=A[J].feature;if(I[ee.layer.id]<F)break;M.push(ee),A.pop()}else for(const J of n){const ee=J[Z];if(ee)for(const re of ee)M.push(re.feature)}}return M}queryRenderedFeatures(n,y,I){y&&y.filter&&this._validate(d.validateStyle.filter,"queryRenderedFeatures.filter",y.filter,null,y);const A={};if(y&&y.layers){if(!Array.isArray(y.layers))return this.fire(new d.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const F of y.layers){const Z=this._layers[F];if(!Z)return this.fire(new d.ErrorEvent(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];A[Z.source]=!0}}const M=[];y.availableImages=this._availableImages;for(const F in this.sourceCaches)y.layers&&!A[F]||M.push(rr(this.sourceCaches[F],this._layers,this._serializedLayers,n,y,I));return this.placement&&M.push(function(F,Z,J,ee,re,ue,ve){const Re={},be=ue.queryRenderedSymbols(ee),De=[];for(const Je of Object.keys(be).map(Number))De.push(ve[Je]);De.sort(Ti);for(const Je of De){const Xe=Je.featureIndex.lookupSymbolFeatures(be[Je.bucketInstanceId],Z,Je.bucketIndex,Je.sourceLayerIndex,re.filter,re.layers,re.availableImages,F);for(const nt in Xe){const $e=Re[nt]=Re[nt]||[],xt=Xe[nt];xt.sort((ht,mt)=>{const Pt=Je.featureSortOrder;if(Pt){const Ot=Pt.indexOf(ht.featureIndex);return Pt.indexOf(mt.featureIndex)-Ot}return mt.featureIndex-ht.featureIndex});for(const ht of xt)$e.push(ht)}}for(const Je in Re)Re[Je].forEach(Xe=>{const nt=Xe.feature,$e=J[F[Je].source].getFeatureState(nt.layer["source-layer"],nt.id);nt.source=nt.layer.source,nt.layer["source-layer"]&&(nt.sourceLayer=nt.layer["source-layer"]),nt.state=$e});return Re}(this._layers,this._serializedLayers,this.sourceCaches,n,y,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(M)}querySourceFeatures(n,y){y&&y.filter&&this._validate(d.validateStyle.filter,"querySourceFeatures.filter",y.filter,null,y);const I=this.sourceCaches[n];return I?function(A,M){const F=A.getRenderableIds().map(ee=>A.getTileByID(ee)),Z=[],J={};for(let ee=0;ee<F.length;ee++){const re=F[ee],ue=re.tileID.canonical.key;J[ue]||(J[ue]=!0,re.querySourceFeatures(Z,M))}return Z}(I,y):[]}addSourceType(n,y,I){return Er.getSourceType(n)?I(new Error(`A source type called "${n}" already exists.`)):(Er.setSourceType(n,y),y.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:y.workerSourceURL},I):I(null,null))}getLight(){return this.light.getLight()}setLight(n,y={}){this._checkLoaded();const I=this.light.getLight();let A=!1;for(const F in n)if(!G(n[F],I[F])){A=!0;break}if(!A)return;const M={now:d.exported.now(),transition:d.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,y),this.light.updateTransitions(M)}_validate(n,y,I,A,M={}){return(!M||M.validate!==!1)&&Kt(this,n.call(d.validateStyle,d.extend({key:y,style:this.serialize(),value:I,styleSpec:d.spec},A)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),d.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this.sourceCaches){const y=this.sourceCaches[n];y.setEventedParent(null),y.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const y in this.sourceCaches)this.sourceCaches[y].update(n)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,y,I,A,M=!1){let F=!1,Z=!1;const J={};for(const ee of this._order){const re=this._layers[ee];if(re.type!=="symbol")continue;if(!J[re.source]){const ve=this.sourceCaches[re.source];J[re.source]=ve.getRenderableIds(!0).map(Re=>ve.getTileByID(Re)).sort((Re,be)=>be.tileID.overscaledZ-Re.tileID.overscaledZ||(Re.tileID.isLessThan(be.tileID)?-1:1))}const ue=this.crossTileSymbolIndex.addLayer(re,J[re.source],n.center.lng);F=F||ue}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((M=M||this._layerOrderChanged||I===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(d.exported.now(),n.zoom))&&(this.pauseablePlacement=new Bt(n,this._order,M,y,I,A,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,J),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(d.exported.now()),Z=!0),F&&this.pauseablePlacement.placement.setStale()),Z||F)for(const ee of this._order){const re=this._layers[ee];re.type==="symbol"&&this.placement.updateLayerOpacities(re,J[re.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(d.exported.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,y,I){this.imageManager.getImages(y.icons,I),this._updateTilesForChangedImages();const A=this.sourceCaches[y.source];A&&A.setDependencies(y.tileID.key,y.type,y.icons)}getGlyphs(n,y,I){this.glyphManager.getGlyphs(y.stacks,I)}getResource(n,y,I){return d.makeRequest(y,I)}}Er.getSourceType=function(S){return Li[S]},Er.setSourceType=function(S,n){Li[S]=n},Er.registerForPluginStateChange=d.registerForPluginStateChange;var po=d.createLayout([{name:"a_pos",type:"Int16",components:2}]),Rl={prelude:Rr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),background:Rr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Rr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Rr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Rr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Rr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Rr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Rr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Rr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Rr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),fill:Rr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Rr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Rr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Rr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Rr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Rr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Rr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Rr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Rr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),lineGradient:Rr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),linePattern:Rr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Rr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Rr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Rr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),symbolSDF:Rr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Rr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`)};function Rr(S,n){const y=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,I=n.match(/attribute ([\w]+) ([\w]+)/g),A=S.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),F=M?M.concat(A):A,Z={};return{fragmentSource:S=S.replace(y,(J,ee,re,ue,ve)=>(Z[ve]=!0,ee==="define"?`
#ifndef HAS_UNIFORM_u_${ve}
varying ${re} ${ue} ${ve};
#else
uniform ${re} ${ue} u_${ve};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ve}
    ${re} ${ue} ${ve} = u_${ve};
#endif
`)),vertexSource:n=n.replace(y,(J,ee,re,ue,ve)=>{const Re=ue==="float"?"vec2":"vec4",be=ve.match(/color/)?"color":Re;return Z[ve]?ee==="define"?`
#ifndef HAS_UNIFORM_u_${ve}
uniform lowp float u_${ve}_t;
attribute ${re} ${Re} a_${ve};
varying ${re} ${ue} ${ve};
#else
uniform ${re} ${ue} u_${ve};
#endif
`:be==="vec4"?`
#ifndef HAS_UNIFORM_u_${ve}
    ${ve} = a_${ve};
#else
    ${re} ${ue} ${ve} = u_${ve};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ve}
    ${ve} = unpack_mix_${be}(a_${ve}, u_${ve}_t);
#else
    ${re} ${ue} ${ve} = u_${ve};
#endif
`:ee==="define"?`
#ifndef HAS_UNIFORM_u_${ve}
uniform lowp float u_${ve}_t;
attribute ${re} ${Re} a_${ve};
#else
uniform ${re} ${ue} u_${ve};
#endif
`:be==="vec4"?`
#ifndef HAS_UNIFORM_u_${ve}
    ${re} ${ue} ${ve} = a_${ve};
#else
    ${re} ${ue} ${ve} = u_${ve};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ve}
    ${re} ${ue} ${ve} = unpack_mix_${be}(a_${ve}, u_${ve}_t);
#else
    ${re} ${ue} ${ve} = u_${ve};
#endif
`}),staticAttributes:I,staticUniforms:F}}class vn{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,y,I,A,M,F,Z,J){this.context=n;let ee=this.boundPaintVertexBuffers.length!==A.length;for(let re=0;!ee&&re<A.length;re++)this.boundPaintVertexBuffers[re]!==A[re]&&(ee=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===y&&this.boundLayoutVertexBuffer===I&&!ee&&this.boundIndexBuffer===M&&this.boundVertexOffset===F&&this.boundDynamicVertexBuffer===Z&&this.boundDynamicVertexBuffer2===J?(n.bindVertexArrayOES.set(this.vao),Z&&Z.bind(),M&&M.dynamicDraw&&M.bind(),J&&J.bind()):this.freshBind(y,I,A,M,F,Z,J)}freshBind(n,y,I,A,M,F,Z){let J;const ee=n.numAttributes,re=this.context,ue=re.gl;if(re.extVertexArrayObject)this.vao&&this.destroy(),this.vao=re.extVertexArrayObject.createVertexArrayOES(),re.bindVertexArrayOES.set(this.vao),J=0,this.boundProgram=n,this.boundLayoutVertexBuffer=y,this.boundPaintVertexBuffers=I,this.boundIndexBuffer=A,this.boundVertexOffset=M,this.boundDynamicVertexBuffer=F,this.boundDynamicVertexBuffer2=Z;else{J=re.currentNumAttributes||0;for(let ve=ee;ve<J;ve++)ue.disableVertexAttribArray(ve)}y.enableAttributes(ue,n);for(const ve of I)ve.enableAttributes(ue,n);F&&F.enableAttributes(ue,n),Z&&Z.enableAttributes(ue,n),y.bind(),y.setVertexAttribPointers(ue,n,M);for(const ve of I)ve.bind(),ve.setVertexAttribPointers(ue,n,M);F&&(F.bind(),F.setVertexAttribPointers(ue,n,M)),A&&A.bind(),Z&&(Z.bind(),Z.setVertexAttribPointers(ue,n,M)),re.currentNumAttributes=ee}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Vs(S){const n=[];for(let y=0;y<S.length;y++){if(S[y]===null)continue;const I=S[y].split(" ");n.push(I.pop())}return n}class vo{constructor(n,y,I,A,M,F){const Z=n.gl;this.program=Z.createProgram();const J=Vs(I.staticAttributes),ee=A?A.getBinderAttributes():[],re=J.concat(ee),ue=I.staticUniforms?Vs(I.staticUniforms):[],ve=A?A.getBinderUniforms():[],Re=ue.concat(ve),be=[];for(const ht of Re)be.indexOf(ht)<0&&be.push(ht);const De=A?A.defines():[];F&&De.push("#define OVERDRAW_INSPECTOR;");const Je=De.concat(Rl.prelude.fragmentSource,I.fragmentSource).join(`
`),Xe=De.concat(Rl.prelude.vertexSource,I.vertexSource).join(`
`),nt=Z.createShader(Z.FRAGMENT_SHADER);if(Z.isContextLost())return void(this.failedToCreate=!0);Z.shaderSource(nt,Je),Z.compileShader(nt),Z.attachShader(this.program,nt);const $e=Z.createShader(Z.VERTEX_SHADER);if(Z.isContextLost())return void(this.failedToCreate=!0);Z.shaderSource($e,Xe),Z.compileShader($e),Z.attachShader(this.program,$e),this.attributes={};const xt={};this.numAttributes=re.length;for(let ht=0;ht<this.numAttributes;ht++)re[ht]&&(Z.bindAttribLocation(this.program,ht,re[ht]),this.attributes[re[ht]]=ht);Z.linkProgram(this.program),Z.deleteShader($e),Z.deleteShader(nt);for(let ht=0;ht<be.length;ht++){const mt=be[ht];if(mt&&!xt[mt]){const Pt=Z.getUniformLocation(this.program,mt);Pt&&(xt[mt]=Pt)}}this.fixedUniforms=M(n,xt),this.binderUniforms=A?A.getUniforms(n,xt):[]}draw(n,y,I,A,M,F,Z,J,ee,re,ue,ve,Re,be,De,Je){const Xe=n.gl;if(this.failedToCreate)return;n.program.set(this.program),n.setDepthMode(I),n.setStencilMode(A),n.setColorMode(M),n.setCullFace(F);for(const $e in this.fixedUniforms)this.fixedUniforms[$e].set(Z[$e]);be&&be.setUniforms(n,this.binderUniforms,ve,{zoom:Re});const nt={[Xe.LINES]:2,[Xe.TRIANGLES]:3,[Xe.LINE_STRIP]:1}[y];for(const $e of ue.get()){const xt=$e.vaos||($e.vaos={});(xt[J]||(xt[J]=new vn)).bind(n,this,ee,be?be.getPaintVertexBuffers():[],re,$e.vertexOffset,De,Je),Xe.drawElements(y,$e.primitiveLength*nt,Xe.UNSIGNED_SHORT,$e.primitiveOffset*nt*2)}}}function Pn(S,n,y){const I=1/Se(y,1,n.transform.tileZoom),A=Math.pow(2,y.tileID.overscaledZ),M=y.tileSize*Math.pow(2,n.transform.tileZoom)/A,F=M*(y.tileID.canonical.x+y.tileID.wrap*A),Z=M*y.tileID.canonical.y;return{u_image:0,u_texsize:y.imageAtlasTexture.size,u_scale:[I,S.fromScale,S.toScale],u_fade:S.t,u_pixel_coord_upper:[F>>16,Z>>16],u_pixel_coord_lower:[65535&F,65535&Z]}}const ta=(S,n,y,I)=>{const A=n.style.light,M=A.properties.get("position"),F=[M.x,M.y,M.z],Z=function(){var ee=new d.ARRAY_TYPE(9);return d.ARRAY_TYPE!=Float32Array&&(ee[1]=0,ee[2]=0,ee[3]=0,ee[5]=0,ee[6]=0,ee[7]=0),ee[0]=1,ee[4]=1,ee[8]=1,ee}();A.properties.get("anchor")==="viewport"&&function(ee,re){var ue=Math.sin(re),ve=Math.cos(re);ee[0]=ve,ee[1]=ue,ee[2]=0,ee[3]=-ue,ee[4]=ve,ee[5]=0,ee[6]=0,ee[7]=0,ee[8]=1}(Z,-n.transform.angle),function(ee,re,ue){var ve=re[0],Re=re[1],be=re[2];ee[0]=ve*ue[0]+Re*ue[3]+be*ue[6],ee[1]=ve*ue[1]+Re*ue[4]+be*ue[7],ee[2]=ve*ue[2]+Re*ue[5]+be*ue[8]}(F,F,Z);const J=A.properties.get("color");return{u_matrix:S,u_lightpos:F,u_lightintensity:A.properties.get("intensity"),u_lightcolor:[J.r,J.g,J.b],u_vertical_gradient:+y,u_opacity:I}},Wr=(S,n,y,I,A,M,F)=>d.extend(ta(S,n,y,I),Pn(M,n,F),{u_height_factor:-Math.pow(2,A.overscaledZ)/F.tileSize/8}),ia=S=>({u_matrix:S}),Do=(S,n,y,I)=>d.extend(ia(S),Pn(y,n,I)),Yu=(S,n)=>({u_matrix:S,u_world:n}),ra=(S,n,y,I,A)=>d.extend(Do(S,n,y,I),{u_world:A}),qs=(S,n,y,I)=>{const A=S.transform;let M,F;if(I.paint.get("circle-pitch-alignment")==="map"){const Z=Se(y,1,A.zoom);M=!0,F=[Z,Z]}else M=!1,F=A.pixelsToGLUnits;return{u_camera_to_center_distance:A.cameraToCenterDistance,u_scale_with_map:+(I.paint.get("circle-pitch-scale")==="map"),u_matrix:S.translatePosMatrix(n.posMatrix,y,I.paint.get("circle-translate"),I.paint.get("circle-translate-anchor")),u_pitch_with_map:+M,u_device_pixel_ratio:S.pixelRatio,u_extrude_scale:F}},ma=(S,n,y)=>{const I=Se(y,1,n.zoom),A=Math.pow(2,n.zoom-y.tileID.overscaledZ),M=y.tileID.overscaleFactor();return{u_matrix:S,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:I,u_extrude_scale:[n.pixelsToGLUnits[0]/(I*A),n.pixelsToGLUnits[1]/(I*A)],u_overscale_factor:M}},xn=(S,n,y=1)=>({u_matrix:S,u_color:n,u_overlay:0,u_overlay_scale:y}),jo=S=>({u_matrix:S}),Kn=(S,n,y,I)=>({u_matrix:S,u_extrude_scale:Se(n,1,y),u_intensity:I});function Ba(S,n){const y=Math.pow(2,n.canonical.z),I=n.canonical.y;return[new d.MercatorCoordinate(0,I/y).toLngLat().lat,new d.MercatorCoordinate(0,(I+1)/y).toLngLat().lat]}const Bl=(S,n,y)=>{const I=S.transform;return{u_matrix:$u(S,n,y),u_ratio:1/Se(n,1,I.zoom),u_device_pixel_ratio:S.pixelRatio,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]]}},xu=(S,n,y,I)=>d.extend(Bl(S,n,y),{u_image:0,u_image_height:I}),Gs=(S,n,y,I)=>{const A=S.transform,M=dl(n,A);return{u_matrix:$u(S,n,y),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Se(n,1,A.zoom),u_device_pixel_ratio:S.pixelRatio,u_image:0,u_scale:[M,I.fromScale,I.toScale],u_fade:I.t,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]]}},Un=(S,n,y,I,A)=>{const M=S.lineAtlas,F=dl(n,S.transform),Z=y.layout.get("line-cap")==="round",J=M.getDash(I.from,Z),ee=M.getDash(I.to,Z),re=J.width*A.fromScale,ue=ee.width*A.toScale;return d.extend(Bl(S,n,y),{u_patternscale_a:[F/re,-J.height/2],u_patternscale_b:[F/ue,-ee.height/2],u_sdfgamma:M.width/(256*Math.min(re,ue)*S.pixelRatio)/2,u_image:0,u_tex_y_a:J.y,u_tex_y_b:ee.y,u_mix:A.t})};function dl(S,n){return 1/Se(S,1,n.tileZoom)}function $u(S,n,y){return S.translatePosMatrix(n.tileID.posMatrix,n,y.paint.get("line-translate"),y.paint.get("line-translate-anchor"))}const Qu=(S,n,y,I,A)=>{return{u_matrix:S,u_tl_parent:n,u_scale_parent:y,u_buffer_scale:1,u_fade_t:I.mix,u_opacity:I.opacity*A.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:A.paint.get("raster-brightness-min"),u_brightness_high:A.paint.get("raster-brightness-max"),u_saturation_factor:(F=A.paint.get("raster-saturation"),F>0?1-1/(1.001-F):-F),u_contrast_factor:(M=A.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:ec(A.paint.get("raster-hue-rotate"))};var M,F};function ec(S){S*=Math.PI/180;const n=Math.sin(S),y=Math.cos(S);return[(2*y+1)/3,(-Math.sqrt(3)*n-y+1)/3,(Math.sqrt(3)*n-y+1)/3]}const Qa=(S,n,y,I,A,M,F,Z,J,ee)=>{const re=A.transform;return{u_is_size_zoom_constant:+(S==="constant"||S==="source"),u_is_size_feature_constant:+(S==="constant"||S==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:re.cameraToCenterDistance,u_pitch:re.pitch/360*2*Math.PI,u_rotate_symbol:+y,u_aspect_ratio:re.width/re.height,u_fade_change:A.options.fadeDuration?A.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:F,u_coord_matrix:Z,u_is_text:+J,u_pitch_with_map:+I,u_texsize:ee,u_texture:0}},Ol=(S,n,y,I,A,M,F,Z,J,ee,re)=>{const ue=A.transform;return d.extend(Qa(S,n,y,I,A,M,F,Z,J,ee),{u_gamma_scale:I?Math.cos(ue._pitch)*ue.cameraToCenterDistance:1,u_device_pixel_ratio:A.pixelRatio,u_is_halo:+re})},Fl=(S,n,y,I,A,M,F,Z,J,ee)=>d.extend(Ol(S,n,y,I,A,M,F,Z,!0,J,!0),{u_texsize_icon:ee,u_texture_icon:1}),Mc=(S,n,y)=>({u_matrix:S,u_opacity:n,u_color:y}),fl=(S,n,y,I,A,M)=>d.extend(function(F,Z,J,ee){const re=J.imageManager.getPattern(F.from.toString()),ue=J.imageManager.getPattern(F.to.toString()),{width:ve,height:Re}=J.imageManager.getPixelSize(),be=Math.pow(2,ee.tileID.overscaledZ),De=ee.tileSize*Math.pow(2,J.transform.tileZoom)/be,Je=De*(ee.tileID.canonical.x+ee.tileID.wrap*be),Xe=De*ee.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:re.tl,u_pattern_br_a:re.br,u_pattern_tl_b:ue.tl,u_pattern_br_b:ue.br,u_texsize:[ve,Re],u_mix:Z.t,u_pattern_size_a:re.displaySize,u_pattern_size_b:ue.displaySize,u_scale_a:Z.fromScale,u_scale_b:Z.toScale,u_tile_units_to_pixels:1/Se(ee,1,J.transform.tileZoom),u_pixel_coord_upper:[Je>>16,Xe>>16],u_pixel_coord_lower:[65535&Je,65535&Xe]}}(I,M,y,A),{u_matrix:S,u_opacity:n}),Vo={fillExtrusion:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_lightpos:new d.Uniform3f(S,n.u_lightpos),u_lightintensity:new d.Uniform1f(S,n.u_lightintensity),u_lightcolor:new d.Uniform3f(S,n.u_lightcolor),u_vertical_gradient:new d.Uniform1f(S,n.u_vertical_gradient),u_opacity:new d.Uniform1f(S,n.u_opacity)}),fillExtrusionPattern:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_lightpos:new d.Uniform3f(S,n.u_lightpos),u_lightintensity:new d.Uniform1f(S,n.u_lightintensity),u_lightcolor:new d.Uniform3f(S,n.u_lightcolor),u_vertical_gradient:new d.Uniform1f(S,n.u_vertical_gradient),u_height_factor:new d.Uniform1f(S,n.u_height_factor),u_image:new d.Uniform1i(S,n.u_image),u_texsize:new d.Uniform2f(S,n.u_texsize),u_pixel_coord_upper:new d.Uniform2f(S,n.u_pixel_coord_upper),u_pixel_coord_lower:new d.Uniform2f(S,n.u_pixel_coord_lower),u_scale:new d.Uniform3f(S,n.u_scale),u_fade:new d.Uniform1f(S,n.u_fade),u_opacity:new d.Uniform1f(S,n.u_opacity)}),fill:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix)}),fillPattern:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_image:new d.Uniform1i(S,n.u_image),u_texsize:new d.Uniform2f(S,n.u_texsize),u_pixel_coord_upper:new d.Uniform2f(S,n.u_pixel_coord_upper),u_pixel_coord_lower:new d.Uniform2f(S,n.u_pixel_coord_lower),u_scale:new d.Uniform3f(S,n.u_scale),u_fade:new d.Uniform1f(S,n.u_fade)}),fillOutline:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_world:new d.Uniform2f(S,n.u_world)}),fillOutlinePattern:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_world:new d.Uniform2f(S,n.u_world),u_image:new d.Uniform1i(S,n.u_image),u_texsize:new d.Uniform2f(S,n.u_texsize),u_pixel_coord_upper:new d.Uniform2f(S,n.u_pixel_coord_upper),u_pixel_coord_lower:new d.Uniform2f(S,n.u_pixel_coord_lower),u_scale:new d.Uniform3f(S,n.u_scale),u_fade:new d.Uniform1f(S,n.u_fade)}),circle:(S,n)=>({u_camera_to_center_distance:new d.Uniform1f(S,n.u_camera_to_center_distance),u_scale_with_map:new d.Uniform1i(S,n.u_scale_with_map),u_pitch_with_map:new d.Uniform1i(S,n.u_pitch_with_map),u_extrude_scale:new d.Uniform2f(S,n.u_extrude_scale),u_device_pixel_ratio:new d.Uniform1f(S,n.u_device_pixel_ratio),u_matrix:new d.UniformMatrix4f(S,n.u_matrix)}),collisionBox:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_camera_to_center_distance:new d.Uniform1f(S,n.u_camera_to_center_distance),u_pixels_to_tile_units:new d.Uniform1f(S,n.u_pixels_to_tile_units),u_extrude_scale:new d.Uniform2f(S,n.u_extrude_scale),u_overscale_factor:new d.Uniform1f(S,n.u_overscale_factor)}),collisionCircle:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_inv_matrix:new d.UniformMatrix4f(S,n.u_inv_matrix),u_camera_to_center_distance:new d.Uniform1f(S,n.u_camera_to_center_distance),u_viewport_size:new d.Uniform2f(S,n.u_viewport_size)}),debug:(S,n)=>({u_color:new d.UniformColor(S,n.u_color),u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_overlay:new d.Uniform1i(S,n.u_overlay),u_overlay_scale:new d.Uniform1f(S,n.u_overlay_scale)}),clippingMask:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix)}),heatmap:(S,n)=>({u_extrude_scale:new d.Uniform1f(S,n.u_extrude_scale),u_intensity:new d.Uniform1f(S,n.u_intensity),u_matrix:new d.UniformMatrix4f(S,n.u_matrix)}),heatmapTexture:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_world:new d.Uniform2f(S,n.u_world),u_image:new d.Uniform1i(S,n.u_image),u_color_ramp:new d.Uniform1i(S,n.u_color_ramp),u_opacity:new d.Uniform1f(S,n.u_opacity)}),hillshade:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_image:new d.Uniform1i(S,n.u_image),u_latrange:new d.Uniform2f(S,n.u_latrange),u_light:new d.Uniform2f(S,n.u_light),u_shadow:new d.UniformColor(S,n.u_shadow),u_highlight:new d.UniformColor(S,n.u_highlight),u_accent:new d.UniformColor(S,n.u_accent)}),hillshadePrepare:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_image:new d.Uniform1i(S,n.u_image),u_dimension:new d.Uniform2f(S,n.u_dimension),u_zoom:new d.Uniform1f(S,n.u_zoom),u_unpack:new d.Uniform4f(S,n.u_unpack)}),line:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_ratio:new d.Uniform1f(S,n.u_ratio),u_device_pixel_ratio:new d.Uniform1f(S,n.u_device_pixel_ratio),u_units_to_pixels:new d.Uniform2f(S,n.u_units_to_pixels)}),lineGradient:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_ratio:new d.Uniform1f(S,n.u_ratio),u_device_pixel_ratio:new d.Uniform1f(S,n.u_device_pixel_ratio),u_units_to_pixels:new d.Uniform2f(S,n.u_units_to_pixels),u_image:new d.Uniform1i(S,n.u_image),u_image_height:new d.Uniform1f(S,n.u_image_height)}),linePattern:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_texsize:new d.Uniform2f(S,n.u_texsize),u_ratio:new d.Uniform1f(S,n.u_ratio),u_device_pixel_ratio:new d.Uniform1f(S,n.u_device_pixel_ratio),u_image:new d.Uniform1i(S,n.u_image),u_units_to_pixels:new d.Uniform2f(S,n.u_units_to_pixels),u_scale:new d.Uniform3f(S,n.u_scale),u_fade:new d.Uniform1f(S,n.u_fade)}),lineSDF:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_ratio:new d.Uniform1f(S,n.u_ratio),u_device_pixel_ratio:new d.Uniform1f(S,n.u_device_pixel_ratio),u_units_to_pixels:new d.Uniform2f(S,n.u_units_to_pixels),u_patternscale_a:new d.Uniform2f(S,n.u_patternscale_a),u_patternscale_b:new d.Uniform2f(S,n.u_patternscale_b),u_sdfgamma:new d.Uniform1f(S,n.u_sdfgamma),u_image:new d.Uniform1i(S,n.u_image),u_tex_y_a:new d.Uniform1f(S,n.u_tex_y_a),u_tex_y_b:new d.Uniform1f(S,n.u_tex_y_b),u_mix:new d.Uniform1f(S,n.u_mix)}),raster:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_tl_parent:new d.Uniform2f(S,n.u_tl_parent),u_scale_parent:new d.Uniform1f(S,n.u_scale_parent),u_buffer_scale:new d.Uniform1f(S,n.u_buffer_scale),u_fade_t:new d.Uniform1f(S,n.u_fade_t),u_opacity:new d.Uniform1f(S,n.u_opacity),u_image0:new d.Uniform1i(S,n.u_image0),u_image1:new d.Uniform1i(S,n.u_image1),u_brightness_low:new d.Uniform1f(S,n.u_brightness_low),u_brightness_high:new d.Uniform1f(S,n.u_brightness_high),u_saturation_factor:new d.Uniform1f(S,n.u_saturation_factor),u_contrast_factor:new d.Uniform1f(S,n.u_contrast_factor),u_spin_weights:new d.Uniform3f(S,n.u_spin_weights)}),symbolIcon:(S,n)=>({u_is_size_zoom_constant:new d.Uniform1i(S,n.u_is_size_zoom_constant),u_is_size_feature_constant:new d.Uniform1i(S,n.u_is_size_feature_constant),u_size_t:new d.Uniform1f(S,n.u_size_t),u_size:new d.Uniform1f(S,n.u_size),u_camera_to_center_distance:new d.Uniform1f(S,n.u_camera_to_center_distance),u_pitch:new d.Uniform1f(S,n.u_pitch),u_rotate_symbol:new d.Uniform1i(S,n.u_rotate_symbol),u_aspect_ratio:new d.Uniform1f(S,n.u_aspect_ratio),u_fade_change:new d.Uniform1f(S,n.u_fade_change),u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_label_plane_matrix:new d.UniformMatrix4f(S,n.u_label_plane_matrix),u_coord_matrix:new d.UniformMatrix4f(S,n.u_coord_matrix),u_is_text:new d.Uniform1i(S,n.u_is_text),u_pitch_with_map:new d.Uniform1i(S,n.u_pitch_with_map),u_texsize:new d.Uniform2f(S,n.u_texsize),u_texture:new d.Uniform1i(S,n.u_texture)}),symbolSDF:(S,n)=>({u_is_size_zoom_constant:new d.Uniform1i(S,n.u_is_size_zoom_constant),u_is_size_feature_constant:new d.Uniform1i(S,n.u_is_size_feature_constant),u_size_t:new d.Uniform1f(S,n.u_size_t),u_size:new d.Uniform1f(S,n.u_size),u_camera_to_center_distance:new d.Uniform1f(S,n.u_camera_to_center_distance),u_pitch:new d.Uniform1f(S,n.u_pitch),u_rotate_symbol:new d.Uniform1i(S,n.u_rotate_symbol),u_aspect_ratio:new d.Uniform1f(S,n.u_aspect_ratio),u_fade_change:new d.Uniform1f(S,n.u_fade_change),u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_label_plane_matrix:new d.UniformMatrix4f(S,n.u_label_plane_matrix),u_coord_matrix:new d.UniformMatrix4f(S,n.u_coord_matrix),u_is_text:new d.Uniform1i(S,n.u_is_text),u_pitch_with_map:new d.Uniform1i(S,n.u_pitch_with_map),u_texsize:new d.Uniform2f(S,n.u_texsize),u_texture:new d.Uniform1i(S,n.u_texture),u_gamma_scale:new d.Uniform1f(S,n.u_gamma_scale),u_device_pixel_ratio:new d.Uniform1f(S,n.u_device_pixel_ratio),u_is_halo:new d.Uniform1i(S,n.u_is_halo)}),symbolTextAndIcon:(S,n)=>({u_is_size_zoom_constant:new d.Uniform1i(S,n.u_is_size_zoom_constant),u_is_size_feature_constant:new d.Uniform1i(S,n.u_is_size_feature_constant),u_size_t:new d.Uniform1f(S,n.u_size_t),u_size:new d.Uniform1f(S,n.u_size),u_camera_to_center_distance:new d.Uniform1f(S,n.u_camera_to_center_distance),u_pitch:new d.Uniform1f(S,n.u_pitch),u_rotate_symbol:new d.Uniform1i(S,n.u_rotate_symbol),u_aspect_ratio:new d.Uniform1f(S,n.u_aspect_ratio),u_fade_change:new d.Uniform1f(S,n.u_fade_change),u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_label_plane_matrix:new d.UniformMatrix4f(S,n.u_label_plane_matrix),u_coord_matrix:new d.UniformMatrix4f(S,n.u_coord_matrix),u_is_text:new d.Uniform1i(S,n.u_is_text),u_pitch_with_map:new d.Uniform1i(S,n.u_pitch_with_map),u_texsize:new d.Uniform2f(S,n.u_texsize),u_texsize_icon:new d.Uniform2f(S,n.u_texsize_icon),u_texture:new d.Uniform1i(S,n.u_texture),u_texture_icon:new d.Uniform1i(S,n.u_texture_icon),u_gamma_scale:new d.Uniform1f(S,n.u_gamma_scale),u_device_pixel_ratio:new d.Uniform1f(S,n.u_device_pixel_ratio),u_is_halo:new d.Uniform1i(S,n.u_is_halo)}),background:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_opacity:new d.Uniform1f(S,n.u_opacity),u_color:new d.UniformColor(S,n.u_color)}),backgroundPattern:(S,n)=>({u_matrix:new d.UniformMatrix4f(S,n.u_matrix),u_opacity:new d.Uniform1f(S,n.u_opacity),u_image:new d.Uniform1i(S,n.u_image),u_pattern_tl_a:new d.Uniform2f(S,n.u_pattern_tl_a),u_pattern_br_a:new d.Uniform2f(S,n.u_pattern_br_a),u_pattern_tl_b:new d.Uniform2f(S,n.u_pattern_tl_b),u_pattern_br_b:new d.Uniform2f(S,n.u_pattern_br_b),u_texsize:new d.Uniform2f(S,n.u_texsize),u_mix:new d.Uniform1f(S,n.u_mix),u_pattern_size_a:new d.Uniform2f(S,n.u_pattern_size_a),u_pattern_size_b:new d.Uniform2f(S,n.u_pattern_size_b),u_scale_a:new d.Uniform1f(S,n.u_scale_a),u_scale_b:new d.Uniform1f(S,n.u_scale_b),u_pixel_coord_upper:new d.Uniform2f(S,n.u_pixel_coord_upper),u_pixel_coord_lower:new d.Uniform2f(S,n.u_pixel_coord_lower),u_tile_units_to_pixels:new d.Uniform1f(S,n.u_tile_units_to_pixels)})};class Oa{constructor(n,y,I){this.context=n;const A=n.gl;this.buffer=A.createBuffer(),this.dynamicDraw=Boolean(I),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,y.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||delete y.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const y=this.context.gl;this.context.unbindVAO(),this.bind(),y.bufferSubData(y.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Fa={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class xs{constructor(n,y,I,A){this.length=y.length,this.attributes=I,this.itemSize=y.bytesPerElement,this.dynamicDraw=A,this.context=n;const M=n.gl;this.buffer=M.createBuffer(),n.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,y.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||delete y.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const y=this.context.gl;this.bind(),y.bufferSubData(y.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,y){for(let I=0;I<this.attributes.length;I++){const A=y.attributes[this.attributes[I].name];A!==void 0&&n.enableVertexAttribArray(A)}}setVertexAttribPointers(n,y,I){for(let A=0;A<this.attributes.length;A++){const M=this.attributes[A],F=y.attributes[M.name];F!==void 0&&n.vertexAttribPointer(F,M.components,n[Fa[M.type]],!1,this.itemSize,M.offset+this.itemSize*(I||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ur{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class bs extends ur{getDefault(){return d.Color.transparent}set(n){const y=this.current;(n.r!==y.r||n.g!==y.g||n.b!==y.b||n.a!==y.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class ws extends ur{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class ao extends ur{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class bn extends ur{getDefault(){return[!0,!0,!0,!0]}set(n){const y=this.current;(n[0]!==y[0]||n[1]!==y[1]||n[2]!==y[2]||n[3]!==y[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class so extends ur{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class bu extends ur{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class wu extends ur{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const y=this.current;(n.func!==y.func||n.ref!==y.ref||n.mask!==y.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Eu extends ur{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const y=this.current;(n[0]!==y[0]||n[1]!==y[1]||n[2]!==y[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Ul extends ur{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const y=this.gl;n?y.enable(y.STENCIL_TEST):y.disable(y.STENCIL_TEST),this.current=n,this.dirty=!1}}class Nl extends ur{getDefault(){return[0,1]}set(n){const y=this.current;(n[0]!==y[0]||n[1]!==y[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class ml extends ur{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const y=this.gl;n?y.enable(y.DEPTH_TEST):y.disable(y.DEPTH_TEST),this.current=n,this.dirty=!1}}class jl extends ur{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Iu extends ur{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const y=this.gl;n?y.enable(y.BLEND):y.disable(y.BLEND),this.current=n,this.dirty=!1}}class Vl extends ur{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const y=this.current;(n[0]!==y[0]||n[1]!==y[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Lc extends ur{getDefault(){return d.Color.transparent}set(n){const y=this.current;(n.r!==y.r||n.g!==y.g||n.b!==y.b||n.a!==y.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class yl extends ur{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class Ua extends ur{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const y=this.gl;n?y.enable(y.CULL_FACE):y.disable(y.CULL_FACE),this.current=n,this.dirty=!1}}class Dc extends ur{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class lo extends ur{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class tc extends ur{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class Es extends ur{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Is extends ur{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const y=this.current;(n[0]!==y[0]||n[1]!==y[1]||n[2]!==y[2]||n[3]!==y[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Zs extends ur{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const y=this.gl;y.bindFramebuffer(y.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class es extends ur{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const y=this.gl;y.bindRenderbuffer(y.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Na extends ur{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const y=this.gl;y.bindTexture(y.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class ya extends ur{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const y=this.gl;y.bindBuffer(y.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Ss extends ur{getDefault(){return null}set(n){const y=this.gl;y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ts extends ur{constructor(n){super(n),this.vao=n.extVertexArrayObject}getDefault(){return null}set(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)}}class Su extends ur{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const y=this.gl;y.pixelStorei(y.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Ts extends ur{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const y=this.gl;y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Br extends ur{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const y=this.gl;y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Hs extends ur{constructor(n,y){super(n),this.context=n,this.parent=y}getDefault(){return null}}class is extends Hs{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const y=this.gl;y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class ic extends Hs{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const y=this.gl;y.framebufferRenderbuffer(y.FRAMEBUFFER,y.DEPTH_ATTACHMENT,y.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Tu{constructor(n,y,I,A){this.context=n,this.width=y,this.height=I;const M=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new is(n,M),A&&(this.depthAttachment=new ic(n,M))}destroy(){const n=this.context.gl,y=this.colorAttachment.get();if(y&&n.deleteTexture(y),this.depthAttachment){const I=this.depthAttachment.get();I&&n.deleteRenderbuffer(I)}n.deleteFramebuffer(this.framebuffer)}}class Ji{constructor(n,y,I){this.blendFunction=n,this.blendColor=y,this.mask=I}}Ji.Replace=[1,0],Ji.disabled=new Ji(Ji.Replace,d.Color.transparent,[!1,!1,!1,!1]),Ji.unblended=new Ji(Ji.Replace,d.Color.transparent,[!0,!0,!0,!0]),Ji.alphaBlended=new Ji([1,771],d.Color.transparent,[!0,!0,!0,!0]);class ql{constructor(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new bs(this),this.clearDepth=new ws(this),this.clearStencil=new ao(this),this.colorMask=new bn(this),this.depthMask=new so(this),this.stencilMask=new bu(this),this.stencilFunc=new wu(this),this.stencilOp=new Eu(this),this.stencilTest=new Ul(this),this.depthRange=new Nl(this),this.depthTest=new ml(this),this.depthFunc=new jl(this),this.blend=new Iu(this),this.blendFunc=new Vl(this),this.blendColor=new Lc(this),this.blendEquation=new yl(this),this.cullFace=new Ua(this),this.cullFaceSide=new Dc(this),this.frontFace=new lo(this),this.program=new tc(this),this.activeTexture=new Es(this),this.viewport=new Is(this),this.bindFramebuffer=new Zs(this),this.bindRenderbuffer=new es(this),this.bindTexture=new Na(this),this.bindVertexBuffer=new ya(this),this.bindElementBuffer=new Ss(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ts(this),this.pixelStoreUnpack=new Su(this),this.pixelStoreUnpackPremultiplyAlpha=new Ts(this),this.pixelStoreUnpackFlipY=new Br(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,y){return new Oa(this,n,y)}createVertexBuffer(n,y,I){return new xs(this,n,y,I)}createRenderbuffer(n,y,I){const A=this.gl,M=A.createRenderbuffer();return this.bindRenderbuffer.set(M),A.renderbufferStorage(A.RENDERBUFFER,n,y,I),this.bindRenderbuffer.set(null),M}createFramebuffer(n,y,I){return new Tu(this,n,y,I)}clear({color:n,depth:y}){const I=this.gl;let A=0;n&&(A|=I.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),y!==void 0&&(A|=I.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(y),this.depthMask.set(!0)),I.clear(A)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){G(n.blendFunction,Ji.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class yr{constructor(n,y,I){this.func=n,this.mask=y,this.range=I}}yr.ReadOnly=!1,yr.ReadWrite=!0,yr.disabled=new yr(519,yr.ReadOnly,[0,1]);const Sa=7680;class jr{constructor(n,y,I,A,M,F){this.test=n,this.ref=y,this.mask=I,this.fail=A,this.depthFail=M,this.pass=F}}jr.disabled=new jr({func:519,mask:0},0,0,Sa,Sa,Sa);class wn{constructor(n,y,I){this.enable=n,this.mode=y,this.frontFace=I}}let Gl;function Zl(S,n,y,I,A,M,F){const Z=S.context,J=Z.gl,ee=S.useProgram("collisionBox"),re=[];let ue=0,ve=0;for(let $e=0;$e<I.length;$e++){const xt=I[$e],ht=n.getTile(xt),mt=ht.getBucket(y);if(!mt)continue;let Pt=xt.posMatrix;A[0]===0&&A[1]===0||(Pt=S.translatePosMatrix(xt.posMatrix,ht,A,M));const Ot=F?mt.textCollisionBox:mt.iconCollisionBox,wt=mt.collisionCircleArray;if(wt.length>0){const ci=d.create(),ei=Pt;d.mul(ci,mt.placementInvProjMatrix,S.transform.glCoordMatrix),d.mul(ci,ci,mt.placementViewportMatrix),re.push({circleArray:wt,circleOffset:ve,transform:ei,invTransform:ci}),ue+=wt.length/4,ve=ue}Ot&&ee.draw(Z,J.LINES,yr.disabled,jr.disabled,S.colorModeForRenderPass(),wn.disabled,ma(Pt,S.transform,ht),y.id,Ot.layoutVertexBuffer,Ot.indexBuffer,Ot.segments,null,S.transform.zoom,null,null,Ot.collisionVertexBuffer)}if(!F||!re.length)return;const Re=S.useProgram("collisionCircle"),be=new d.CollisionCircleLayoutArray;be.resize(4*ue),be._trim();let De=0;for(const $e of re)for(let xt=0;xt<$e.circleArray.length/4;xt++){const ht=4*xt,mt=$e.circleArray[ht+0],Pt=$e.circleArray[ht+1],Ot=$e.circleArray[ht+2],wt=$e.circleArray[ht+3];be.emplace(De++,mt,Pt,Ot,wt,0),be.emplace(De++,mt,Pt,Ot,wt,1),be.emplace(De++,mt,Pt,Ot,wt,2),be.emplace(De++,mt,Pt,Ot,wt,3)}(!Gl||Gl.length<2*ue)&&(Gl=function($e){const xt=2*$e,ht=new d.QuadTriangleArray;ht.resize(xt),ht._trim();for(let mt=0;mt<xt;mt++){const Pt=6*mt;ht.uint16[Pt+0]=4*mt+0,ht.uint16[Pt+1]=4*mt+1,ht.uint16[Pt+2]=4*mt+2,ht.uint16[Pt+3]=4*mt+2,ht.uint16[Pt+4]=4*mt+3,ht.uint16[Pt+5]=4*mt+0}return ht}(ue));const Je=Z.createIndexBuffer(Gl,!0),Xe=Z.createVertexBuffer(be,d.collisionCircleLayout.members,!0);for(const $e of re){const xt={u_matrix:$e.transform,u_inv_matrix:$e.invTransform,u_camera_to_center_distance:(nt=S.transform).cameraToCenterDistance,u_viewport_size:[nt.width,nt.height]};Re.draw(Z,J.TRIANGLES,yr.disabled,jr.disabled,S.colorModeForRenderPass(),wn.disabled,xt,y.id,Xe,Je,d.SegmentVector.simpleSegment(0,2*$e.circleOffset,$e.circleArray.length,$e.circleArray.length/2),null,S.transform.zoom,null,null,null)}var nt;Xe.destroy(),Je.destroy()}wn.disabled=new wn(!1,1029,2305),wn.backCCW=new wn(!0,1029,2305);const Ws=d.identity(new Float32Array(16));function Au(S,n,y,I,A,M){const{horizontalAlign:F,verticalAlign:Z}=d.getAnchorAlignment(S),J=-(F-.5)*n,ee=-(Z-.5)*y,re=d.evaluateVariableOffset(S,I);return new d.pointGeometry((J/A+re[0])*M,(ee/A+re[1])*M)}function ja(S,n,y,I,A,M,F,Z,J,ee){const re=S.text.placedSymbolArray,ue=S.text.dynamicLayoutVertexArray,ve=S.icon.dynamicLayoutVertexArray,Re={};ue.clear();for(let be=0;be<re.length;be++){const De=re.get(be),Je=S.allowVerticalPlacement&&!De.placedOrientation,Xe=De.hidden||!De.crossTileID||Je?null:I[De.crossTileID];if(Xe){const nt=new d.pointGeometry(De.anchorX,De.anchorY),$e=Gr(nt,y?F:M),xt=Ht(A.cameraToCenterDistance,$e.signedDistanceFromCamera);let ht=d.evaluateSizeForFeature(S.textSizeData,J,De)*xt/d.ONE_EM;y&&(ht*=S.tilePixelRatio/Z);const{width:mt,height:Pt,anchor:Ot,textOffset:wt,textBoxScale:ci}=Xe,ei=Au(Ot,mt,Pt,wt,ci,ht),Oi=y?Gr(nt.add(ei),M).point:$e.point.add(n?ei.rotate(-A.angle):ei),u=S.allowVerticalPlacement&&De.placedOrientation===d.WritingMode.vertical?Math.PI/2:0;for(let m=0;m<De.numGlyphs;m++)d.addDynamicAttributes(ue,Oi,u);ee&&De.associatedIconIndex>=0&&(Re[De.associatedIconIndex]={shiftedAnchor:Oi,angle:u})}else te(De.numGlyphs,ue)}if(ee){ve.clear();const be=S.icon.placedSymbolArray;for(let De=0;De<be.length;De++){const Je=be.get(De);if(Je.hidden)te(Je.numGlyphs,ve);else{const Xe=Re[De];if(Xe)for(let nt=0;nt<Je.numGlyphs;nt++)d.addDynamicAttributes(ve,Xe.shiftedAnchor,Xe.angle);else te(Je.numGlyphs,ve)}}S.icon.dynamicLayoutVertexBuffer.updateData(ve)}S.text.dynamicLayoutVertexBuffer.updateData(ue)}function Va(S,n,y){return y.iconsInText&&n?"symbolTextAndIcon":S?"symbolSDF":"symbolIcon"}function Hl(S,n,y,I,A,M,F,Z,J,ee,re,ue){const ve=S.context,Re=ve.gl,be=S.transform,De=Z==="map",Je=J==="map",Xe=Z!=="viewport"&&y.layout.get("symbol-placement")!=="point",nt=De&&!Je&&!Xe,$e=!y.layout.get("symbol-sort-key").isConstant();let xt=!1;const ht=S.depthModeForSublayer(0,yr.ReadOnly),mt=y.layout.get("text-variable-anchor"),Pt=[];for(const Ot of I){const wt=n.getTile(Ot),ci=wt.getBucket(y);if(!ci)continue;const ei=A?ci.text:ci.icon;if(!ei||!ei.segments.get().length)continue;const Oi=ei.programConfigurations.get(y.id),u=A||ci.sdfIcons,m=A?ci.textSizeData:ci.iconSizeData,p=Je||be.pitch!==0,v=S.useProgram(Va(u,A,ci),Oi),k=d.evaluateSizeForZoom(m,be.zoom);let L,B,j,Y,ie=[0,0],he=null;if(A){if(B=wt.glyphAtlasTexture,j=Re.LINEAR,L=wt.glyphAtlasTexture.size,ci.iconsInText){ie=wt.imageAtlasTexture.size,he=wt.imageAtlasTexture;const st=m.kind==="composite"||m.kind==="camera";Y=p||S.options.rotating||S.options.zooming||st?Re.LINEAR:Re.NEAREST}}else{const st=y.layout.get("icon-size").constantOr(0)!==1||ci.iconsNeedLinear;B=wt.imageAtlasTexture,j=u||S.options.rotating||S.options.zooming||st||p?Re.LINEAR:Re.NEAREST,L=wt.imageAtlasTexture.size}const de=Se(wt,1,S.transform.zoom),me=Wn(Ot.posMatrix,Je,De,S.transform,de),Ce=ea(Ot.posMatrix,Je,De,S.transform,de),Te=mt&&ci.hasTextData(),Le=y.layout.get("icon-text-fit")!=="none"&&Te&&ci.hasIconData();if(Xe){const st=y.layout.get("text-rotation-alignment")==="map";Ki(ci,Ot.posMatrix,S,A,me,Ce,Je,ee,st)}const xe=S.translatePosMatrix(Ot.posMatrix,wt,M,F),ze=Xe||A&&mt||Le?Ws:me,Fe=S.translatePosMatrix(Ce,wt,M,F,!0),Ye=u&&y.paint.get(A?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ot;ot=u?ci.iconsInText?Fl(m.kind,k,nt,Je,S,xe,ze,Fe,L,ie):Ol(m.kind,k,nt,Je,S,xe,ze,Fe,A,L,!0):Qa(m.kind,k,nt,Je,S,xe,ze,Fe,A,L);const at={program:v,buffers:ei,uniformValues:ot,atlasTexture:B,atlasTextureIcon:he,atlasInterpolation:j,atlasInterpolationIcon:Y,isSDF:u,hasHalo:Ye};if($e&&ci.canOverlap){xt=!0;const st=ei.segments.get();for(const It of st)Pt.push({segments:new d.SegmentVector([It]),sortKey:It.sortKey,state:at})}else Pt.push({segments:ei.segments,sortKey:0,state:at})}xt&&Pt.sort((Ot,wt)=>Ot.sortKey-wt.sortKey);for(const Ot of Pt){const wt=Ot.state;if(ve.activeTexture.set(Re.TEXTURE0),wt.atlasTexture.bind(wt.atlasInterpolation,Re.CLAMP_TO_EDGE),wt.atlasTextureIcon&&(ve.activeTexture.set(Re.TEXTURE1),wt.atlasTextureIcon&&wt.atlasTextureIcon.bind(wt.atlasInterpolationIcon,Re.CLAMP_TO_EDGE)),wt.isSDF){const ci=wt.uniformValues;wt.hasHalo&&(ci.u_is_halo=1,As(wt.buffers,Ot.segments,y,S,wt.program,ht,re,ue,ci)),ci.u_is_halo=0}As(wt.buffers,Ot.segments,y,S,wt.program,ht,re,ue,wt.uniformValues)}}function As(S,n,y,I,A,M,F,Z,J){const ee=I.context;A.draw(ee,ee.gl.TRIANGLES,M,F,Z,wn.disabled,J,y.id,S.layoutVertexBuffer,S.indexBuffer,n,y.paint,I.transform.zoom,S.programConfigurations.get(y.id),S.dynamicLayoutVertexBuffer,S.opacityVertexBuffer)}function Vr(S,n,y,I,A,M,F){const Z=S.context.gl,J=y.paint.get("fill-pattern"),ee=J&&J.constantOr(1),re=y.getCrossfadeParameters();let ue,ve,Re,be,De;F?(ve=ee&&!y.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ue=Z.LINES):(ve=ee?"fillPattern":"fill",ue=Z.TRIANGLES);for(const Je of I){const Xe=n.getTile(Je);if(ee&&!Xe.patternsLoaded())continue;const nt=Xe.getBucket(y);if(!nt)continue;const $e=nt.programConfigurations.get(y.id),xt=S.useProgram(ve,$e);ee&&(S.context.activeTexture.set(Z.TEXTURE0),Xe.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),$e.updatePaintBuffers(re));const ht=J.constantOr(null);if(ht&&Xe.imageAtlas){const Pt=Xe.imageAtlas,Ot=Pt.patternPositions[ht.to.toString()],wt=Pt.patternPositions[ht.from.toString()];Ot&&wt&&$e.setConstantPatternPositions(Ot,wt)}const mt=S.translatePosMatrix(Je.posMatrix,Xe,y.paint.get("fill-translate"),y.paint.get("fill-translate-anchor"));if(F){be=nt.indexBuffer2,De=nt.segments2;const Pt=[Z.drawingBufferWidth,Z.drawingBufferHeight];Re=ve==="fillOutlinePattern"&&ee?ra(mt,S,re,Xe,Pt):Yu(mt,Pt)}else be=nt.indexBuffer,De=nt.segments,Re=ee?Do(mt,S,re,Xe):ia(mt);xt.draw(S.context,ue,A,S.stencilModeForClipping(Je),M,wn.disabled,Re,y.id,nt.layoutVertexBuffer,be,De,y.paint,S.transform.zoom,$e)}}function rs(S,n,y,I,A,M,F){const Z=S.context,J=Z.gl,ee=y.paint.get("fill-extrusion-pattern"),re=ee.constantOr(1),ue=y.getCrossfadeParameters(),ve=y.paint.get("fill-extrusion-opacity");for(const Re of I){const be=n.getTile(Re),De=be.getBucket(y);if(!De)continue;const Je=De.programConfigurations.get(y.id),Xe=S.useProgram(re?"fillExtrusionPattern":"fillExtrusion",Je);re&&(S.context.activeTexture.set(J.TEXTURE0),be.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),Je.updatePaintBuffers(ue));const nt=ee.constantOr(null);if(nt&&be.imageAtlas){const mt=be.imageAtlas,Pt=mt.patternPositions[nt.to.toString()],Ot=mt.patternPositions[nt.from.toString()];Pt&&Ot&&Je.setConstantPatternPositions(Pt,Ot)}const $e=S.translatePosMatrix(Re.posMatrix,be,y.paint.get("fill-extrusion-translate"),y.paint.get("fill-extrusion-translate-anchor")),xt=y.paint.get("fill-extrusion-vertical-gradient"),ht=re?Wr($e,S,xt,ve,Re,ue,be):ta($e,S,xt,ve);Xe.draw(Z,Z.gl.TRIANGLES,A,M,F,wn.backCCW,ht,y.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,y.paint,S.transform.zoom,Je)}}function Cu(S,n,y,I,A,M){const F=S.context,Z=F.gl,J=n.fbo;if(!J)return;const ee=S.useProgram("hillshade");F.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,J.colorAttachment.get());const re=((ue,ve,Re)=>{const be=Re.paint.get("hillshade-shadow-color"),De=Re.paint.get("hillshade-highlight-color"),Je=Re.paint.get("hillshade-accent-color");let Xe=Re.paint.get("hillshade-illumination-direction")*(Math.PI/180);Re.paint.get("hillshade-illumination-anchor")==="viewport"&&(Xe-=ue.transform.angle);const nt=!ue.options.moving;return{u_matrix:ue.transform.calculatePosMatrix(ve.tileID.toUnwrapped(),nt),u_image:0,u_latrange:Ba(0,ve.tileID),u_light:[Re.paint.get("hillshade-exaggeration"),Xe],u_shadow:be,u_highlight:De,u_accent:Je}})(S,n,y);ee.draw(F,Z.TRIANGLES,I,A,M,wn.disabled,re,y.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments)}function xo(S,n,y,I,A,M){const F=S.context,Z=F.gl,J=n.dem;if(J&&J.data){const ee=J.dim,re=J.stride,ue=J.getPixels();if(F.activeTexture.set(Z.TEXTURE1),F.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||S.getTileTexture(re),n.demTexture){const Re=n.demTexture;Re.update(ue,{premultiply:!1}),Re.bind(Z.NEAREST,Z.CLAMP_TO_EDGE)}else n.demTexture=new Ze(F,ue,Z.RGBA,{premultiply:!1}),n.demTexture.bind(Z.NEAREST,Z.CLAMP_TO_EDGE);F.activeTexture.set(Z.TEXTURE0);let ve=n.fbo;if(!ve){const Re=new Ze(F,{width:ee,height:ee,data:null},Z.RGBA);Re.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),ve=n.fbo=F.createFramebuffer(ee,ee,!0),ve.colorAttachment.set(Re.texture)}F.bindFramebuffer.set(ve.framebuffer),F.viewport.set([0,0,ee,ee]),S.useProgram("hillshadePrepare").draw(F,Z.TRIANGLES,I,A,M,wn.disabled,((Re,be)=>{const De=be.stride,Je=d.create();return d.ortho(Je,0,d.EXTENT,-d.EXTENT,0,0,1),d.translate(Je,Je,[0,-d.EXTENT,0]),{u_matrix:Je,u_image:1,u_dimension:[De,De],u_zoom:Re.overscaledZ,u_unpack:be.getUnpackVector()}})(n.tileID,J),y.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function rc(S,n,y,I,A){const M=I.paint.get("raster-fade-duration");if(M>0){const F=d.exported.now(),Z=(F-S.timeAdded)/M,J=n?(F-n.timeAdded)/M:-1,ee=y.getSource(),re=A.coveringZoomLevel({tileSize:ee.tileSize,roundZoom:ee.roundZoom}),ue=!n||Math.abs(n.tileID.overscaledZ-re)>Math.abs(S.tileID.overscaledZ-re),ve=ue&&S.refreshedUponExpiration?1:d.clamp(ue?Z:1-J,0,1);return S.refreshedUponExpiration&&Z>=1&&(S.refreshedUponExpiration=!1),n?{opacity:1,mix:1-ve}:{opacity:ve,mix:0}}return{opacity:1,mix:0}}const Rc=new d.Color(1,0,0,1),nc=new d.Color(0,1,0,1),ns=new d.Color(0,0,1,1),os=new d.Color(1,0,1,1),Xs=new d.Color(0,1,1,1);function Wl(S,n,y,I){as(S,0,n+y/2,S.transform.width,y,I)}function Cs(S,n,y,I){as(S,n-y/2,0,y,S.transform.height,I)}function as(S,n,y,I,A,M){const F=S.context,Z=F.gl;Z.enable(Z.SCISSOR_TEST),Z.scissor(n*S.pixelRatio,y*S.pixelRatio,I*S.pixelRatio,A*S.pixelRatio),F.clear({color:M}),Z.disable(Z.SCISSOR_TEST)}function oc(S,n,y){const I=S.context,A=I.gl,M=y.posMatrix,F=S.useProgram("debug"),Z=yr.disabled,J=jr.disabled,ee=S.colorModeForRenderPass(),re="$debug";I.activeTexture.set(A.TEXTURE0),S.emptyTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),F.draw(I,A.LINE_STRIP,Z,J,ee,wn.disabled,xn(M,d.Color.red),re,S.debugBuffer,S.tileBorderIndexBuffer,S.debugSegments);const ue=n.getTileByID(y.key).latestRawTileData,ve=Math.floor((ue&&ue.byteLength||0)/1024),Re=n.getTile(y).tileSize,be=512/Math.min(Re,512)*(y.overscaledZ/S.transform.zoom)*.5;let De=y.canonical.toString();y.overscaledZ!==y.canonical.z&&(De+=` => ${y.overscaledZ}`),function(Je,Xe){Je.initDebugOverlayCanvas();const nt=Je.debugOverlayCanvas,$e=Je.context.gl,xt=Je.debugOverlayCanvas.getContext("2d");xt.clearRect(0,0,nt.width,nt.height),xt.shadowColor="white",xt.shadowBlur=2,xt.lineWidth=1.5,xt.strokeStyle="white",xt.textBaseline="top",xt.font="bold 36px Open Sans, sans-serif",xt.fillText(Xe,5,5),xt.strokeText(Xe,5,5),Je.debugOverlayTexture.update(nt),Je.debugOverlayTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE)}(S,`${De} ${ve}kb`),F.draw(I,A.TRIANGLES,Z,J,Ji.alphaBlended,wn.disabled,xn(M,d.Color.transparent,be),re,S.debugBuffer,S.quadTriangleIndexBuffer,S.debugSegments)}const qa={symbol:function(S,n,y,I,A){if(S.renderPass!=="translucent")return;const M=jr.disabled,F=S.colorModeForRenderPass();y.layout.get("text-variable-anchor")&&function(Z,J,ee,re,ue,ve,Re){const be=J.transform,De=ue==="map",Je=ve==="map";for(const Xe of Z){const nt=re.getTile(Xe),$e=nt.getBucket(ee);if(!$e||!$e.text||!$e.text.segments.get().length)continue;const xt=d.evaluateSizeForZoom($e.textSizeData,be.zoom),ht=Se(nt,1,J.transform.zoom),mt=Wn(Xe.posMatrix,Je,De,J.transform,ht),Pt=ee.layout.get("icon-text-fit")!=="none"&&$e.hasIconData();if(xt){const Ot=Math.pow(2,be.zoom-nt.tileID.overscaledZ);ja($e,De,Je,Re,be,mt,Xe.posMatrix,Ot,xt,Pt)}}}(I,S,y,n,y.layout.get("text-rotation-alignment"),y.layout.get("text-pitch-alignment"),A),y.paint.get("icon-opacity").constantOr(1)!==0&&Hl(S,n,y,I,!1,y.paint.get("icon-translate"),y.paint.get("icon-translate-anchor"),y.layout.get("icon-rotation-alignment"),y.layout.get("icon-pitch-alignment"),y.layout.get("icon-keep-upright"),M,F),y.paint.get("text-opacity").constantOr(1)!==0&&Hl(S,n,y,I,!0,y.paint.get("text-translate"),y.paint.get("text-translate-anchor"),y.layout.get("text-rotation-alignment"),y.layout.get("text-pitch-alignment"),y.layout.get("text-keep-upright"),M,F),n.map.showCollisionBoxes&&(Zl(S,n,y,I,y.paint.get("text-translate"),y.paint.get("text-translate-anchor"),!0),Zl(S,n,y,I,y.paint.get("icon-translate"),y.paint.get("icon-translate-anchor"),!1))},circle:function(S,n,y,I){if(S.renderPass!=="translucent")return;const A=y.paint.get("circle-opacity"),M=y.paint.get("circle-stroke-width"),F=y.paint.get("circle-stroke-opacity"),Z=!y.layout.get("circle-sort-key").isConstant();if(A.constantOr(1)===0&&(M.constantOr(1)===0||F.constantOr(1)===0))return;const J=S.context,ee=J.gl,re=S.depthModeForSublayer(0,yr.ReadOnly),ue=jr.disabled,ve=S.colorModeForRenderPass(),Re=[];for(let be=0;be<I.length;be++){const De=I[be],Je=n.getTile(De),Xe=Je.getBucket(y);if(!Xe)continue;const nt=Xe.programConfigurations.get(y.id),$e={programConfiguration:nt,program:S.useProgram("circle",nt),layoutVertexBuffer:Xe.layoutVertexBuffer,indexBuffer:Xe.indexBuffer,uniformValues:qs(S,De,Je,y)};if(Z){const xt=Xe.segments.get();for(const ht of xt)Re.push({segments:new d.SegmentVector([ht]),sortKey:ht.sortKey,state:$e})}else Re.push({segments:Xe.segments,sortKey:0,state:$e})}Z&&Re.sort((be,De)=>be.sortKey-De.sortKey);for(const be of Re){const{programConfiguration:De,program:Je,layoutVertexBuffer:Xe,indexBuffer:nt,uniformValues:$e}=be.state;Je.draw(J,ee.TRIANGLES,re,ue,ve,wn.disabled,$e,y.id,Xe,nt,be.segments,y.paint,S.transform.zoom,De)}},heatmap:function(S,n,y,I){if(y.paint.get("heatmap-opacity")!==0)if(S.renderPass==="offscreen"){const A=S.context,M=A.gl,F=jr.disabled,Z=new Ji([M.ONE,M.ONE],d.Color.transparent,[!0,!0,!0,!0]);(function(J,ee,re){const ue=J.gl;J.activeTexture.set(ue.TEXTURE1),J.viewport.set([0,0,ee.width/4,ee.height/4]);let ve=re.heatmapFbo;if(ve)ue.bindTexture(ue.TEXTURE_2D,ve.colorAttachment.get()),J.bindFramebuffer.set(ve.framebuffer);else{const Re=ue.createTexture();ue.bindTexture(ue.TEXTURE_2D,Re),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MAG_FILTER,ue.LINEAR),ve=re.heatmapFbo=J.createFramebuffer(ee.width/4,ee.height/4,!1),function(be,De,Je,Xe){const nt=be.gl;nt.texImage2D(nt.TEXTURE_2D,0,nt.RGBA,De.width/4,De.height/4,0,nt.RGBA,be.extRenderToTextureHalfFloat?be.extTextureHalfFloat.HALF_FLOAT_OES:nt.UNSIGNED_BYTE,null),Xe.colorAttachment.set(Je)}(J,ee,Re,ve)}})(A,S,y),A.clear({color:d.Color.transparent});for(let J=0;J<I.length;J++){const ee=I[J];if(n.hasRenderableParent(ee))continue;const re=n.getTile(ee),ue=re.getBucket(y);if(!ue)continue;const ve=ue.programConfigurations.get(y.id),Re=S.useProgram("heatmap",ve),{zoom:be}=S.transform;Re.draw(A,M.TRIANGLES,yr.disabled,F,Z,wn.disabled,Kn(ee.posMatrix,re,be,y.paint.get("heatmap-intensity")),y.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,y.paint,S.transform.zoom,ve)}A.viewport.set([0,0,S.width,S.height])}else S.renderPass==="translucent"&&(S.context.setColorMode(S.colorModeForRenderPass()),function(A,M){const F=A.context,Z=F.gl,J=M.heatmapFbo;if(!J)return;F.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,J.colorAttachment.get()),F.activeTexture.set(Z.TEXTURE1);let ee=M.colorRampTexture;ee||(ee=M.colorRampTexture=new Ze(F,M.colorRamp,Z.RGBA)),ee.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),A.useProgram("heatmapTexture").draw(F,Z.TRIANGLES,yr.disabled,jr.disabled,A.colorModeForRenderPass(),wn.disabled,((re,ue,ve,Re)=>{const be=d.create();d.ortho(be,0,re.width,re.height,0,0,1);const De=re.context.gl;return{u_matrix:be,u_world:[De.drawingBufferWidth,De.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ue.paint.get("heatmap-opacity")}})(A,M),M.id,A.viewportBuffer,A.quadTriangleIndexBuffer,A.viewportSegments,M.paint,A.transform.zoom)}(S,y))},line:function(S,n,y,I){if(S.renderPass!=="translucent")return;const A=y.paint.get("line-opacity"),M=y.paint.get("line-width");if(A.constantOr(1)===0||M.constantOr(1)===0)return;const F=S.depthModeForSublayer(0,yr.ReadOnly),Z=S.colorModeForRenderPass(),J=y.paint.get("line-dasharray"),ee=y.paint.get("line-pattern"),re=ee.constantOr(1),ue=y.paint.get("line-gradient"),ve=y.getCrossfadeParameters(),Re=re?"linePattern":J?"lineSDF":ue?"lineGradient":"line",be=S.context,De=be.gl;let Je=!0;for(const Xe of I){const nt=n.getTile(Xe);if(re&&!nt.patternsLoaded())continue;const $e=nt.getBucket(y);if(!$e)continue;const xt=$e.programConfigurations.get(y.id),ht=S.context.program.get(),mt=S.useProgram(Re,xt),Pt=Je||mt.program!==ht,Ot=ee.constantOr(null);if(Ot&&nt.imageAtlas){const ci=nt.imageAtlas,ei=ci.patternPositions[Ot.to.toString()],Oi=ci.patternPositions[Ot.from.toString()];ei&&Oi&&xt.setConstantPatternPositions(ei,Oi)}const wt=re?Gs(S,nt,y,ve):J?Un(S,nt,y,J,ve):ue?xu(S,nt,y,$e.lineClipsArray.length):Bl(S,nt,y);if(re)be.activeTexture.set(De.TEXTURE0),nt.imageAtlasTexture.bind(De.LINEAR,De.CLAMP_TO_EDGE),xt.updatePaintBuffers(ve);else if(J&&(Pt||S.lineAtlas.dirty))be.activeTexture.set(De.TEXTURE0),S.lineAtlas.bind(be);else if(ue){const ci=$e.gradients[y.id];let ei=ci.texture;if(y.gradientVersion!==ci.version){let Oi=256;if(y.stepInterpolant){const u=n.getSource().maxzoom,m=Xe.canonical.z===u?Math.ceil(1<<S.transform.maxZoom-Xe.canonical.z):1;Oi=d.clamp(d.nextPowerOfTwo($e.maxLineLength/d.EXTENT*1024*m),256,be.maxTextureSize)}ci.gradient=d.renderColorRamp({expression:y.gradientExpression(),evaluationKey:"lineProgress",resolution:Oi,image:ci.gradient||void 0,clips:$e.lineClipsArray}),ci.texture?ci.texture.update(ci.gradient):ci.texture=new Ze(be,ci.gradient,De.RGBA),ci.version=y.gradientVersion,ei=ci.texture}be.activeTexture.set(De.TEXTURE0),ei.bind(y.stepInterpolant?De.NEAREST:De.LINEAR,De.CLAMP_TO_EDGE)}mt.draw(be,De.TRIANGLES,F,S.stencilModeForClipping(Xe),Z,wn.disabled,wt,y.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,y.paint,S.transform.zoom,xt,$e.layoutVertexBuffer2),Je=!1}},fill:function(S,n,y,I){const A=y.paint.get("fill-color"),M=y.paint.get("fill-opacity");if(M.constantOr(1)===0)return;const F=S.colorModeForRenderPass(),Z=y.paint.get("fill-pattern"),J=S.opaquePassEnabledForLayer()&&!Z.constantOr(1)&&A.constantOr(d.Color.transparent).a===1&&M.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===J){const ee=S.depthModeForSublayer(1,S.renderPass==="opaque"?yr.ReadWrite:yr.ReadOnly);Vr(S,n,y,I,ee,F,!1)}if(S.renderPass==="translucent"&&y.paint.get("fill-antialias")){const ee=S.depthModeForSublayer(y.getPaintProperty("fill-outline-color")?2:0,yr.ReadOnly);Vr(S,n,y,I,ee,F,!0)}},"fill-extrusion":function(S,n,y,I){const A=y.paint.get("fill-extrusion-opacity");if(A!==0&&S.renderPass==="translucent"){const M=new yr(S.context.gl.LEQUAL,yr.ReadWrite,S.depthRangeFor3D);if(A!==1||y.paint.get("fill-extrusion-pattern").constantOr(1))rs(S,n,y,I,M,jr.disabled,Ji.disabled),rs(S,n,y,I,M,S.stencilModeFor3D(),S.colorModeForRenderPass());else{const F=S.colorModeForRenderPass();rs(S,n,y,I,M,jr.disabled,F)}}},hillshade:function(S,n,y,I){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const A=S.context,M=S.depthModeForSublayer(0,yr.ReadOnly),F=S.colorModeForRenderPass(),[Z,J]=S.renderPass==="translucent"?S.stencilConfigForOverlap(I):[{},I];for(const ee of J){const re=n.getTile(ee);re.needsHillshadePrepare&&S.renderPass==="offscreen"?xo(S,re,y,M,jr.disabled,F):S.renderPass==="translucent"&&Cu(S,re,y,M,Z[ee.overscaledZ],F)}A.viewport.set([0,0,S.width,S.height])},raster:function(S,n,y,I){if(S.renderPass!=="translucent"||y.paint.get("raster-opacity")===0||!I.length)return;const A=S.context,M=A.gl,F=n.getSource(),Z=S.useProgram("raster"),J=S.colorModeForRenderPass(),[ee,re]=F instanceof Bi?[{},I]:S.stencilConfigForOverlap(I),ue=re[re.length-1].overscaledZ,ve=!S.options.moving;for(const Re of re){const be=S.depthModeForSublayer(Re.overscaledZ-ue,y.paint.get("raster-opacity")===1?yr.ReadWrite:yr.ReadOnly,M.LESS),De=n.getTile(Re),Je=S.transform.calculatePosMatrix(Re.toUnwrapped(),ve);De.registerFadeDuration(y.paint.get("raster-fade-duration"));const Xe=n.findLoadedParent(Re,0),nt=rc(De,Xe,n,y,S.transform);let $e,xt;const ht=y.paint.get("raster-resampling")==="nearest"?M.NEAREST:M.LINEAR;A.activeTexture.set(M.TEXTURE0),De.texture.bind(ht,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),A.activeTexture.set(M.TEXTURE1),Xe?(Xe.texture.bind(ht,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),$e=Math.pow(2,Xe.tileID.overscaledZ-De.tileID.overscaledZ),xt=[De.tileID.canonical.x*$e%1,De.tileID.canonical.y*$e%1]):De.texture.bind(ht,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST);const mt=Qu(Je,xt||[0,0],$e||1,nt,y);F instanceof Bi?Z.draw(A,M.TRIANGLES,be,jr.disabled,J,wn.disabled,mt,y.id,F.boundsBuffer,S.quadTriangleIndexBuffer,F.boundsSegments):Z.draw(A,M.TRIANGLES,be,ee[Re.overscaledZ],J,wn.disabled,mt,y.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments)}},background:function(S,n,y){const I=y.paint.get("background-color"),A=y.paint.get("background-opacity");if(A===0)return;const M=S.context,F=M.gl,Z=S.transform,J=Z.tileSize,ee=y.paint.get("background-pattern");if(S.isPatternMissing(ee))return;const re=!ee&&I.a===1&&A===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==re)return;const ue=jr.disabled,ve=S.depthModeForSublayer(0,re==="opaque"?yr.ReadWrite:yr.ReadOnly),Re=S.colorModeForRenderPass(),be=S.useProgram(ee?"backgroundPattern":"background"),De=Z.coveringTiles({tileSize:J});ee&&(M.activeTexture.set(F.TEXTURE0),S.imageManager.bind(S.context));const Je=y.getCrossfadeParameters();for(const Xe of De){const nt=S.transform.calculatePosMatrix(Xe.toUnwrapped()),$e=ee?fl(nt,A,S,ee,{tileID:Xe,tileSize:J},Je):Mc(nt,A,I);be.draw(M,F.TRIANGLES,ve,ue,Re,wn.disabled,$e,y.id,S.tileExtentBuffer,S.quadTriangleIndexBuffer,S.tileExtentSegments)}},debug:function(S,n,y){for(let I=0;I<y.length;I++)oc(S,n,y[I])},custom:function(S,n,y){const I=S.context,A=y.implementation;if(S.renderPass==="offscreen"){const M=A.prerender;M&&(S.setCustomLayerDefaults(),I.setColorMode(S.colorModeForRenderPass()),M.call(A,I.gl,S.transform.customLayerMatrix()),I.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),I.setColorMode(S.colorModeForRenderPass()),I.setStencilMode(jr.disabled);const M=A.renderingMode==="3d"?new yr(S.context.gl.LEQUAL,yr.ReadWrite,S.depthRangeFor3D):S.depthModeForSublayer(0,yr.ReadOnly);I.setDepthMode(M),A.render(I.gl,S.transform.customLayerMatrix()),I.setDirty(),S.setBaseState(),I.bindFramebuffer.set(null)}}};class na{constructor(n,y){this.context=new ql(n),this.transform=y,this._tileTextures={},this.setup(),this.numSublayers=rt.maxUnderzooming+rt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new li,this.gpuTimers={}}resize(n,y,I){if(this.width=n*I,this.height=y*I,this.pixelRatio=I,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const A of this.style._order)this.style._layers[A].resize()}setup(){const n=this.context,y=new d.PosArray;y.emplaceBack(0,0),y.emplaceBack(d.EXTENT,0),y.emplaceBack(0,d.EXTENT),y.emplaceBack(d.EXTENT,d.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(y,po.members),this.tileExtentSegments=d.SegmentVector.simpleSegment(0,0,4,2);const I=new d.PosArray;I.emplaceBack(0,0),I.emplaceBack(d.EXTENT,0),I.emplaceBack(0,d.EXTENT),I.emplaceBack(d.EXTENT,d.EXTENT),this.debugBuffer=n.createVertexBuffer(I,po.members),this.debugSegments=d.SegmentVector.simpleSegment(0,0,4,5);const A=new d.RasterBoundsArray;A.emplaceBack(0,0,0,0),A.emplaceBack(d.EXTENT,0,d.EXTENT,0),A.emplaceBack(0,d.EXTENT,0,d.EXTENT),A.emplaceBack(d.EXTENT,d.EXTENT,d.EXTENT,d.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(A,fi.members),this.rasterBoundsSegments=d.SegmentVector.simpleSegment(0,0,4,2);const M=new d.PosArray;M.emplaceBack(0,0),M.emplaceBack(1,0),M.emplaceBack(0,1),M.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(M,po.members),this.viewportSegments=d.SegmentVector.simpleSegment(0,0,4,2);const F=new d.LineStripIndexArray;F.emplaceBack(0),F.emplaceBack(1),F.emplaceBack(3),F.emplaceBack(2),F.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(F);const Z=new d.TriangleIndexArray;Z.emplaceBack(0,1,2),Z.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(Z),this.emptyTexture=new Ze(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);const J=this.context.gl;this.stencilClearMode=new jr({func:J.ALWAYS,mask:0},0,255,J.ZERO,J.ZERO,J.ZERO)}clearStencil(){const n=this.context,y=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const I=d.create();d.ortho(I,0,this.width,this.height,0,0,1),d.scale(I,I,[y.drawingBufferWidth,y.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,y.TRIANGLES,yr.disabled,this.stencilClearMode,Ji.disabled,wn.disabled,jo(I),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,y){if(this.currentStencilSource===n.source||!n.isTileClipped()||!y||!y.length)return;this.currentStencilSource=n.source;const I=this.context,A=I.gl;this.nextStencilID+y.length>256&&this.clearStencil(),I.setColorMode(Ji.disabled),I.setDepthMode(yr.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const F of y){const Z=this._tileClippingMaskIDs[F.key]=this.nextStencilID++;M.draw(I,A.TRIANGLES,yr.disabled,new jr({func:A.ALWAYS,mask:0},Z,255,A.KEEP,A.KEEP,A.REPLACE),Ji.disabled,wn.disabled,jo(F.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,y=this.context.gl;return new jr({func:y.NOTEQUAL,mask:255},n,255,y.KEEP,y.KEEP,y.REPLACE)}stencilModeForClipping(n){const y=this.context.gl;return new jr({func:y.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,y.KEEP,y.KEEP,y.REPLACE)}stencilConfigForOverlap(n){const y=this.context.gl,I=n.sort((F,Z)=>Z.overscaledZ-F.overscaledZ),A=I[I.length-1].overscaledZ,M=I[0].overscaledZ-A+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();const F={};for(let Z=0;Z<M;Z++)F[Z+A]=new jr({func:y.GEQUAL,mask:255},Z+this.nextStencilID,255,y.KEEP,y.KEEP,y.REPLACE);return this.nextStencilID+=M,[F,I]}return[{[A]:jr.disabled},I]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new Ji([n.CONSTANT_COLOR,n.ONE],new d.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ji.unblended:Ji.alphaBlended}depthModeForSublayer(n,y,I){if(!this.opaquePassEnabledForLayer())return yr.disabled;const A=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new yr(I||this.context.gl.LEQUAL,y,[A,A])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,y){this.style=n,this.options=y,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(d.exported.now()),this.imageManager.beginFrame();const I=this.style._order,A=this.style.sourceCaches;for(const J in A){const ee=A[J];ee.used&&ee.prepare(this.context)}const M={},F={},Z={};for(const J in A){const ee=A[J];M[J]=ee.getVisibleCoordinates(),F[J]=M[J].slice().reverse(),Z[J]=ee.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let J=0;J<I.length;J++)if(this.style._layers[I[J]].is3D()){this.opaquePassCutoff=J;break}this.renderPass="offscreen";for(const J of I){const ee=this.style._layers[J];if(!ee.hasOffscreenPass()||ee.isHidden(this.transform.zoom))continue;const re=F[ee.source];(ee.type==="custom"||re.length)&&this.renderLayer(this,A[ee.source],ee,re)}for(this.context.bindFramebuffer.set(null),this.context.clear({color:y.showOverdrawInspector?d.Color.black:d.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=y.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=I.length-1;this.currentLayer>=0;this.currentLayer--){const J=this.style._layers[I[this.currentLayer]],ee=A[J.source],re=M[J.source];this._renderTileClippingMasks(J,re),this.renderLayer(this,ee,J,re)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<I.length;this.currentLayer++){const J=this.style._layers[I[this.currentLayer]],ee=A[J.source],re=(J.type==="symbol"?Z:F)[J.source];this._renderTileClippingMasks(J,M[J.source]),this.renderLayer(this,ee,J,re)}if(this.options.showTileBoundaries){let J,ee;Object.values(this.style._layers).forEach(re=>{re.source&&!re.isHidden(this.transform.zoom)&&(re.source!==(ee&&ee.id)&&(ee=this.style.sourceCaches[re.source]),(!J||J.getSource().maxzoom<ee.getSource().maxzoom)&&(J=ee))}),J&&qa.debug(this,J,J.getVisibleCoordinates())}this.options.showPadding&&function(J){const ee=J.transform.padding;Wl(J,J.transform.height-(ee.top||0),3,Rc),Wl(J,ee.bottom||0,3,nc),Cs(J,ee.left||0,3,ns),Cs(J,J.transform.width-(ee.right||0),3,os);const re=J.transform.centerPoint;(function(ue,ve,Re,be){as(ue,ve-1,Re-10,2,20,be),as(ue,ve-10,Re-1,20,2,be)})(J,re.x,J.transform.height-re.y,Xs)}(this),this.context.setDefault()}renderLayer(n,y,I,A){I.isHidden(this.transform.zoom)||(I.type==="background"||I.type==="custom"||A.length)&&(this.id=I.id,this.gpuTimingStart(I),qa[I.type](n,y,I,A,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const y=this.context.extTimerQuery;let I=this.gpuTimers[n.id];I||(I=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:y.createQueryEXT()}),I.calls++,y.beginQueryEXT(y.TIME_ELAPSED_EXT,I.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}queryGpuTimers(n){const y={};for(const I in n){const A=n[I],M=this.context.extTimerQuery,F=M.getQueryObjectEXT(A.query,M.QUERY_RESULT_EXT)/1e6;M.deleteQueryEXT(A.query),y[I]=F}return y}translatePosMatrix(n,y,I,A,M){if(!I[0]&&!I[1])return n;const F=M?A==="map"?this.transform.angle:0:A==="viewport"?-this.transform.angle:0;if(F){const ee=Math.sin(F),re=Math.cos(F);I=[I[0]*re-I[1]*ee,I[0]*ee+I[1]*re]}const Z=[M?I[0]:Se(y,I[0],this.transform.zoom),M?I[1]:Se(y,I[1],this.transform.zoom),0],J=new Float32Array(16);return d.translate(J,n,Z),J}saveTileTexture(n){const y=this._tileTextures[n.size[0]];y?y.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const y=this._tileTextures[n];return y&&y.length>0?y.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const y=this.imageManager.getPattern(n.from.toString()),I=this.imageManager.getPattern(n.to.toString());return!y||!I}useProgram(n,y){this.cache=this.cache||{};const I=`${n}${y?y.cacheKey:""}${this._showOverdrawInspector?"/overdraw":""}`;return this.cache[I]||(this.cache[I]=new vo(this.context,n,Rl[n],y,Vo[n],this._showOverdrawInspector)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ze(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Xl{constructor(n,y){this.points=n,this.planes=y}static fromInvProjectionMatrix(n,y,I){const A=Math.pow(2,I),M=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(Z=>d.transformMat4([],Z,n)).map(Z=>d.scale$1([],Z,1/Z[3]/y*A)),F=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(Z=>{const J=function(ve,Re){var be=Re[0],De=Re[1],Je=Re[2],Xe=be*be+De*De+Je*Je;return Xe>0&&(Xe=1/Math.sqrt(Xe)),ve[0]=Re[0]*Xe,ve[1]=Re[1]*Xe,ve[2]=Re[2]*Xe,ve}([],function(ve,Re,be){var De=Re[0],Je=Re[1],Xe=Re[2],nt=be[0],$e=be[1],xt=be[2];return ve[0]=Je*xt-Xe*$e,ve[1]=Xe*nt-De*xt,ve[2]=De*$e-Je*nt,ve}([],ft([],M[Z[0]],M[Z[1]]),ft([],M[Z[2]],M[Z[1]]))),ee=-((re=J)[0]*(ue=M[Z[1]])[0]+re[1]*ue[1]+re[2]*ue[2]);var re,ue;return J.concat(ee)});return new Xl(M,F)}}class Kl{constructor(n,y){this.min=n,this.max=y,this.center=function(I,A,M){return I[0]=.5*A[0],I[1]=.5*A[1],I[2]=.5*A[2],I}([],function(I,A,M){return I[0]=A[0]+M[0],I[1]=A[1]+M[1],I[2]=A[2]+M[2],I}([],this.min,this.max))}quadrant(n){const y=[n%2==0,n<2],I=qe(this.min),A=qe(this.max);for(let M=0;M<y.length;M++)I[M]=y[M]?this.min[M]:this.center[M],A[M]=y[M]?this.center[M]:this.max[M];return A[2]=this.max[2],new Kl(I,A)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersects(n){const y=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]];let I=!0;for(let A=0;A<n.planes.length;A++){const M=n.planes[A];let F=0;for(let Z=0;Z<y.length;Z++)d.dot(M,y[Z])>=0&&F++;if(F===0)return 0;F!==y.length&&(I=!1)}if(I)return 2;for(let A=0;A<3;A++){let M=Number.MAX_VALUE,F=-Number.MAX_VALUE;for(let Z=0;Z<n.points.length;Z++){const J=n.points[Z][A]-this.min[A];M=Math.min(M,J),F=Math.max(F,J)}if(F<0||M>this.max[A]-this.min[A])return 0}return 1}}class Ks{constructor(n=0,y=0,I=0,A=0){if(isNaN(n)||n<0||isNaN(y)||y<0||isNaN(I)||I<0||isNaN(A)||A<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=y,this.left=I,this.right=A}interpolate(n,y,I){return y.top!=null&&n.top!=null&&(this.top=d.number(n.top,y.top,I)),y.bottom!=null&&n.bottom!=null&&(this.bottom=d.number(n.bottom,y.bottom,I)),y.left!=null&&n.left!=null&&(this.left=d.number(n.left,y.left,I)),y.right!=null&&n.right!=null&&(this.right=d.number(n.right,y.right,I)),this}getCenter(n,y){const I=d.clamp((this.left+n-this.right)/2,0,n),A=d.clamp((this.top+y-this.bottom)/2,0,y);return new d.pointGeometry(I,A)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Ks(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Ta{constructor(n,y,I,A,M){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=M===void 0||!!M,this._minZoom=n||0,this._maxZoom=y||22,this._minPitch=I==null?0:I,this._maxPitch=A==null?60:A,this.setMaxBounds(),this.width=0,this.height=0,this._center=new d.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ks,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const n=new Ta(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new d.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){const y=-d.wrap(n,-180,180)*Math.PI/180;this.angle!==y&&(this._unmodified=!1,this.angle=y,this._calcMatrices(),this.rotationMatrix=function(){var I=new d.ARRAY_TYPE(4);return d.ARRAY_TYPE!=Float32Array&&(I[1]=0,I[2]=0),I[0]=1,I[3]=1,I}(),function(I,A,M){var F=A[0],Z=A[1],J=A[2],ee=A[3],re=Math.sin(M),ue=Math.cos(M);I[0]=F*ue+J*re,I[1]=Z*ue+ee*re,I[2]=F*-re+J*ue,I[3]=Z*-re+ee*ue}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const y=d.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==y&&(this._unmodified=!1,this._pitch=y,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(n){const y=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==y&&(this._unmodified=!1,this._zoom=y,this.scale=this.zoomScale(y),this.tileZoom=Math.floor(y),this.zoomFraction=y-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,y,I){this._unmodified=!1,this._edgeInsets.interpolate(n,y,I),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const y=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,y)}getVisibleUnwrappedCoordinates(n){const y=[new d.UnwrappedTileID(0,n)];if(this._renderWorldCopies){const I=this.pointCoordinate(new d.pointGeometry(0,0)),A=this.pointCoordinate(new d.pointGeometry(this.width,0)),M=this.pointCoordinate(new d.pointGeometry(this.width,this.height)),F=this.pointCoordinate(new d.pointGeometry(0,this.height)),Z=Math.floor(Math.min(I.x,A.x,M.x,F.x)),J=Math.floor(Math.max(I.x,A.x,M.x,F.x)),ee=1;for(let re=Z-ee;re<=J+ee;re++)re!==0&&y.push(new d.UnwrappedTileID(re,n))}return y}coveringTiles(n){let y=this.coveringZoomLevel(n);const I=y;if(n.minzoom!==void 0&&y<n.minzoom)return[];n.maxzoom!==void 0&&y>n.maxzoom&&(y=n.maxzoom);const A=d.MercatorCoordinate.fromLngLat(this.center),M=Math.pow(2,y),F=[M*A.x,M*A.y,0],Z=Xl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,y);let J=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(J=y);const ee=be=>({aabb:new Kl([be*M,0,0],[(be+1)*M,M,0]),zoom:0,x:0,y:0,wrap:be,fullyVisible:!1}),re=[],ue=[],ve=y,Re=n.reparseOverscaled?I:y;if(this._renderWorldCopies)for(let be=1;be<=3;be++)re.push(ee(-be)),re.push(ee(be));for(re.push(ee(0));re.length>0;){const be=re.pop(),De=be.x,Je=be.y;let Xe=be.fullyVisible;if(!Xe){const mt=be.aabb.intersects(Z);if(mt===0)continue;Xe=mt===2}const nt=be.aabb.distanceX(F),$e=be.aabb.distanceY(F),xt=Math.max(Math.abs(nt),Math.abs($e)),ht=3+(1<<ve-be.zoom)-2;if(be.zoom===ve||xt>ht&&be.zoom>=J)ue.push({tileID:new d.OverscaledTileID(be.zoom===ve?Re:be.zoom,be.wrap,be.zoom,De,Je),distanceSq:Ge([F[0]-.5-De,F[1]-.5-Je])});else for(let mt=0;mt<4;mt++){const Pt=(De<<1)+mt%2,Ot=(Je<<1)+(mt>>1);re.push({aabb:be.aabb.quadrant(mt),zoom:be.zoom+1,x:Pt,y:Ot,wrap:be.wrap,fullyVisible:Xe})}}return ue.sort((be,De)=>be.distanceSq-De.distanceSq).map(be=>be.tileID)}resize(n,y){this.width=n,this.height=y,this.pixelsToGLUnits=[2/n,-2/y],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const y=d.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new d.pointGeometry(d.mercatorXfromLng(n.lng)*this.worldSize,d.mercatorYfromLat(y)*this.worldSize)}unproject(n){return new d.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(n,y){const I=this.pointCoordinate(y),A=this.pointCoordinate(this.centerPoint),M=this.locationCoordinate(n),F=new d.MercatorCoordinate(M.x-(I.x-A.x),M.y-(I.y-A.y));this.center=this.coordinateLocation(F),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n){return this.coordinatePoint(this.locationCoordinate(n))}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}locationCoordinate(n){return d.MercatorCoordinate.fromLngLat(n)}coordinateLocation(n){return n.toLngLat()}pointCoordinate(n){const y=[n.x,n.y,0,1],I=[n.x,n.y,1,1];d.transformMat4(y,y,this.pixelMatrixInverse),d.transformMat4(I,I,this.pixelMatrixInverse);const A=y[3],M=I[3],F=y[1]/A,Z=I[1]/M,J=y[2]/A,ee=I[2]/M,re=J===ee?0:(0-J)/(ee-J);return new d.MercatorCoordinate(d.number(y[0]/A,I[0]/M,re)/this.worldSize,d.number(F,Z,re)/this.worldSize)}coordinatePoint(n){const y=[n.x*this.worldSize,n.y*this.worldSize,0,1];return d.transformMat4(y,y,this.pixelMatrix),new d.pointGeometry(y[0]/y[3],y[1]/y[3])}getBounds(){return new d.LngLatBounds().extend(this.pointLocation(new d.pointGeometry(0,0))).extend(this.pointLocation(new d.pointGeometry(this.width,0))).extend(this.pointLocation(new d.pointGeometry(this.width,this.height))).extend(this.pointLocation(new d.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new d.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(n,y=!1){const I=n.key,A=y?this._alignedPosMatrixCache:this._posMatrixCache;if(A[I])return A[I];const M=n.canonical,F=this.worldSize/this.zoomScale(M.z),Z=M.x+Math.pow(2,M.z)*n.wrap,J=d.identity(new Float64Array(16));return d.translate(J,J,[Z*F,M.y*F,0]),d.scale(J,J,[F/d.EXTENT,F/d.EXTENT,1]),d.multiply(J,y?this.alignedProjMatrix:this.projMatrix,J),A[I]=new Float32Array(J),A[I]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let n,y,I,A,M=-90,F=90,Z=-180,J=180;const ee=this.size,re=this._unmodified;if(this.latRange){const Re=this.latRange;M=d.mercatorYfromLat(Re[1])*this.worldSize,F=d.mercatorYfromLat(Re[0])*this.worldSize,n=F-M<ee.y?ee.y/(F-M):0}if(this.lngRange){const Re=this.lngRange;Z=d.mercatorXfromLng(Re[0])*this.worldSize,J=d.mercatorXfromLng(Re[1])*this.worldSize,y=J-Z<ee.x?ee.x/(J-Z):0}const ue=this.point,ve=Math.max(y||0,n||0);if(ve)return this.center=this.unproject(new d.pointGeometry(y?(J+Z)/2:ue.x,n?(F+M)/2:ue.y)),this.zoom+=this.scaleZoom(ve),this._unmodified=re,void(this._constraining=!1);if(this.latRange){const Re=ue.y,be=ee.y/2;Re-be<M&&(A=M+be),Re+be>F&&(A=F-be)}if(this.lngRange){const Re=ue.x,be=ee.x/2;Re-be<Z&&(I=Z+be),Re+be>J&&(I=J-be)}I===void 0&&A===void 0||(this.center=this.unproject(new d.pointGeometry(I!==void 0?I:ue.x,A!==void 0?A:ue.y))),this._unmodified=re,this._constraining=!1}_calcMatrices(){if(!this.height)return;const n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const y=Math.PI/2+this._pitch,I=this._fov*(.5+n.y/this.height),A=Math.sin(I)*this.cameraToCenterDistance/Math.sin(d.clamp(Math.PI-y-I,.01,Math.PI-.01)),M=this.point,F=M.x,Z=M.y,J=1.01*(Math.cos(Math.PI/2-this._pitch)*A+this.cameraToCenterDistance),ee=this.height/50;let re=new Float64Array(16);d.perspective(re,this._fov,this.width/this.height,ee,J),re[8]=2*-n.x/this.width,re[9]=2*n.y/this.height,d.scale(re,re,[1,-1,1]),d.translate(re,re,[0,0,-this.cameraToCenterDistance]),d.rotateX(re,re,this._pitch),d.rotateZ(re,re,this.angle),d.translate(re,re,[-F,-Z,0]),this.mercatorMatrix=d.scale([],re,[this.worldSize,this.worldSize,this.worldSize]),d.scale(re,re,[1,1,d.mercatorZfromAltitude(1,this.center.lat)*this.worldSize]),this.projMatrix=re,this.invProjMatrix=d.invert([],this.projMatrix);const ue=this.width%2/2,ve=this.height%2/2,Re=Math.cos(this.angle),be=Math.sin(this.angle),De=F-Math.round(F)+Re*ue+be*ve,Je=Z-Math.round(Z)+Re*ve+be*ue,Xe=new Float64Array(re);if(d.translate(Xe,Xe,[De>.5?De-1:De,Je>.5?Je-1:Je,0]),this.alignedProjMatrix=Xe,re=d.create(),d.scale(re,re,[this.width/2,-this.height/2,1]),d.translate(re,re,[1,-1,0]),this.labelPlaneMatrix=re,re=d.create(),d.scale(re,re,[1,-1,1]),d.translate(re,re,[-1,-1,0]),d.scale(re,re,[2/this.width,2/this.height,1]),this.glCoordMatrix=re,this.pixelMatrix=d.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),re=d.invert(new Float64Array(16),this.pixelMatrix),!re)throw new Error("failed to invert matrix");this.pixelMatrixInverse=re,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const n=this.pointCoordinate(new d.pointGeometry(0,0)),y=[n.x*this.worldSize,n.y*this.worldSize,0,1];return d.transformMat4(y,y,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new d.pointGeometry(0,n))}getCameraQueryGeometry(n){const y=this.getCameraPoint();if(n.length===1)return[n[0],y];{let I=y.x,A=y.y,M=y.x,F=y.y;for(const Z of n)I=Math.min(I,Z.x),A=Math.min(A,Z.y),M=Math.max(M,Z.x),F=Math.max(F,Z.y);return[new d.pointGeometry(I,A),new d.pointGeometry(M,A),new d.pointGeometry(M,F),new d.pointGeometry(I,F),new d.pointGeometry(I,A)]}}}class gl{constructor(n){this._hashName=n&&encodeURIComponent(n),d.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(y,I){let A=!1,M=null;const F=()=>{M=null,A&&(y(),M=setTimeout(F,300),A=!1)};return()=>(A=!0,M||F(),M)}(this._updateHashUnthrottled.bind(this))}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(n){const y=this._map.getCenter(),I=Math.round(100*this._map.getZoom())/100,A=Math.ceil((I*Math.LN2+Math.log(512/360/.5))/Math.LN10),M=Math.pow(10,A),F=Math.round(y.lng*M)/M,Z=Math.round(y.lat*M)/M,J=this._map.getBearing(),ee=this._map.getPitch();let re="";if(re+=n?`/${F}/${Z}/${I}`:`${I}/${Z}/${F}`,(J||ee)&&(re+="/"+Math.round(10*J)/10),ee&&(re+=`/${Math.round(ee)}`),this._hashName){const ue=this._hashName;let ve=!1;const Re=window.location.hash.slice(1).split("&").map(be=>{const De=be.split("=")[0];return De===ue?(ve=!0,`${De}=${re}`):be}).filter(be=>be);return ve||Re.push(`${ue}=${re}`),`#${Re.join("&")}`}return`#${re}`}_getCurrentHash(){const n=window.location.hash.replace("#","");if(this._hashName){let y;return n.split("&").map(I=>I.split("=")).forEach(I=>{I[0]===this._hashName&&(y=I)}),(y&&y[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._getCurrentHash();if(n.length>=3&&!n.some(y=>isNaN(y))){const y=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:y,pitch:+(n[4]||0)}),!0}return!1}_updateHashUnthrottled(){const n=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,n)}catch{}}}const ks={linearity:.3,easing:d.bezier(0,0,.3,1)},ku=d.extend({deceleration:2500,maxSpeed:1400},ks),Jl=d.extend({deceleration:20,maxSpeed:1400},ks),Bc=d.extend({deceleration:1e3,maxSpeed:360},ks),ss=d.extend({deceleration:1e3,maxSpeed:90},ks);class zu{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:d.exported.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,y=d.exported.now();for(;n.length>0&&y-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const y={zoom:0,bearing:0,pitch:0,pan:new d.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:M}of this._inertiaBuffer)y.zoom+=M.zoomDelta||0,y.bearing+=M.bearingDelta||0,y.pitch+=M.pitchDelta||0,M.panDelta&&y.pan._add(M.panDelta),M.around&&(y.around=M.around),M.pinchAround&&(y.pinchAround=M.pinchAround);const I=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,A={};if(y.pan.mag()){const M=vl(y.pan.mag(),I,d.extend({},ku,n||{}));A.offset=y.pan.mult(M.amount/y.pan.mag()),A.center=this._map.transform.center,_l(A,M)}if(y.zoom){const M=vl(y.zoom,I,Jl);A.zoom=this._map.transform.zoom+M.amount,_l(A,M)}if(y.bearing){const M=vl(y.bearing,I,Bc);A.bearing=this._map.transform.bearing+d.clamp(M.amount,-179,179),_l(A,M)}if(y.pitch){const M=vl(y.pitch,I,ss);A.pitch=this._map.transform.pitch+M.amount,_l(A,M)}if(A.zoom||A.bearing){const M=y.pinchAround===void 0?y.around:y.pinchAround;A.around=M?this._map.unproject(M):this._map.getCenter()}return this.clear(),d.extend(A,{noMoveStart:!0})}}function _l(S,n){(!S.duration||S.duration<n.duration)&&(S.duration=n.duration,S.easing=n.easing)}function vl(S,n,y){const{maxSpeed:I,linearity:A,deceleration:M}=y,F=d.clamp(S*A/(n/1e3),-I,I),Z=Math.abs(F)/(M*A);return{easing:y.easing,duration:1e3*Z,amount:F*(Z/2)}}class bo extends d.Event{constructor(n,y,I,A={}){const M=X.mousePos(y.getCanvasContainer(),I),F=y.unproject(M);super(n,d.extend({point:M,lngLat:F,originalEvent:I},A)),this._defaultPrevented=!1,this.target=y}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class wo extends d.Event{constructor(n,y,I){const A=n==="touchend"?I.changedTouches:I.touches,M=X.touchPos(y.getCanvasContainer(),A),F=M.map(J=>y.unproject(J)),Z=M.reduce((J,ee,re,ue)=>J.add(ee.div(ue.length)),new d.pointGeometry(0,0));super(n,{points:M,point:Z,lngLats:F,lngLat:y.unproject(Z),originalEvent:I}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class ac extends d.Event{constructor(n,y,I){super(n,{originalEvent:I}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class ls{constructor(n,y){this._map=n,this._clickTolerance=y.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new ac(n.type,this._map,n))}mousedown(n,y){return this._mousedownPos=y,this._firePreventable(new bo(n.type,this._map,n))}mouseup(n){this._map.fire(new bo(n.type,this._map,n))}click(n,y){this._mousedownPos&&this._mousedownPos.dist(y)>=this._clickTolerance||this._map.fire(new bo(n.type,this._map,n))}dblclick(n){return this._firePreventable(new bo(n.type,this._map,n))}mouseover(n){this._map.fire(new bo(n.type,this._map,n))}mouseout(n){this._map.fire(new bo(n.type,this._map,n))}touchstart(n){return this._firePreventable(new wo(n.type,this._map,n))}touchmove(n){this._map.fire(new wo(n.type,this._map,n))}touchend(n){this._map.fire(new wo(n.type,this._map,n))}touchcancel(n){this._map.fire(new wo(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class xl{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(n){this._map.fire(new bo(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new bo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new bo(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Js{constructor(n,y){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=y.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,y){this.isEnabled()&&n.shiftKey&&n.button===0&&(X.disableDrag(),this._startPos=this._lastPos=y,this._active=!0)}mousemoveWindow(n,y){if(!this._active)return;const I=y;if(this._lastPos.equals(I)||!this._box&&I.dist(this._startPos)<this._clickTolerance)return;const A=this._startPos;this._lastPos=I,this._box||(this._box=X.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const M=Math.min(A.x,I.x),F=Math.max(A.x,I.x),Z=Math.min(A.y,I.y),J=Math.max(A.y,I.y);X.setTransform(this._box,`translate(${M}px,${Z}px)`),this._box.style.width=F-M+"px",this._box.style.height=J-Z+"px"}mouseupWindow(n,y){if(!this._active||n.button!==0)return;const I=this._startPos,A=y;if(this.reset(),X.suppressClick(),I.x!==A.x||I.y!==A.y)return this._map.fire(new d.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:M=>M.fitScreenCoordinates(I,A,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(X.remove(this._box),this._box=null),X.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,y){return this._map.fire(new d.Event(n,{originalEvent:y}))}}function oa(S,n){const y={};for(let I=0;I<S.length;I++)y[S[I].identifier]=n[I];return y}class nn{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,y,I){(this.centroid||I.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),I.length===this.numTouches&&(this.centroid=function(A){const M=new d.pointGeometry(0,0);for(const F of A)M._add(F);return M.div(A.length)}(y),this.touches=oa(I,y)))}touchmove(n,y,I){if(this.aborted||!this.centroid)return;const A=oa(I,y);for(const M in this.touches){const F=this.touches[M],Z=A[M];(!Z||Z.dist(F)>30)&&(this.aborted=!0)}}touchend(n,y,I){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),I.length===0){const A=!this.aborted&&this.centroid;if(this.reset(),A)return A}}}class bl{constructor(n){this.singleTap=new nn(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,y,I){this.singleTap.touchstart(n,y,I)}touchmove(n,y,I){this.singleTap.touchmove(n,y,I)}touchend(n,y,I){const A=this.singleTap.touchend(n,y,I);if(A){const M=n.timeStamp-this.lastTime<500,F=!this.lastTap||this.lastTap.dist(A)<30;if(M&&F||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=A,this.count===this.numTaps)return this.reset(),A}}}class Ys{constructor(){this._zoomIn=new bl({numTouches:1,numTaps:2}),this._zoomOut=new bl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,y,I){this._zoomIn.touchstart(n,y,I),this._zoomOut.touchstart(n,y,I)}touchmove(n,y,I){this._zoomIn.touchmove(n,y,I),this._zoomOut.touchmove(n,y,I)}touchend(n,y,I){const A=this._zoomIn.touchend(n,y,I),M=this._zoomOut.touchend(n,y,I);return A?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:F.getZoom()+1,around:F.unproject(A)},{originalEvent:n})}):M?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:F.getZoom()-1,around:F.unproject(M)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const us={0:1,2:2};class Qi{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(n,y){return!1}_move(n,y){return{}}mousedown(n,y){if(this._lastPoint)return;const I=X.mouseButton(n);this._correctButton(n,I)&&(this._lastPoint=y,this._eventButton=I)}mousemoveWindow(n,y){const I=this._lastPoint;if(I){if(n.preventDefault(),function(A,M){const F=us[M];return A.buttons===void 0||(A.buttons&F)!==F}(n,this._eventButton))this.reset();else if(this._moved||!(y.dist(I)<this._clickTolerance))return this._moved=!0,this._lastPoint=y,this._move(I,y)}}mouseupWindow(n){this._lastPoint&&X.mouseButton(n)===this._eventButton&&(this._moved&&X.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kr extends Qi{mousedown(n,y){super.mousedown(n,y),this._lastPoint&&(this._active=!0)}_correctButton(n,y){return y===0&&!n.ctrlKey}_move(n,y){return{around:y,panDelta:y.sub(n)}}}class Jt extends Qi{_correctButton(n,y){return y===0&&n.ctrlKey||y===2}_move(n,y){const I=.8*(y.x-n.x);if(I)return this._active=!0,{bearingDelta:I}}contextmenu(n){n.preventDefault()}}class $s extends Qi{_correctButton(n,y){return y===0&&n.ctrlKey||y===2}_move(n,y){const I=-.5*(y.y-n.y);if(I)return this._active=!0,{pitchDelta:I}}contextmenu(n){n.preventDefault()}}class Ga{constructor(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new d.pointGeometry(0,0)}touchstart(n,y,I){return this._calculateTransform(n,y,I)}touchmove(n,y,I){if(this._active&&!(I.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,y,I)}touchend(n,y,I){this._calculateTransform(n,y,I),this._active&&I.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,y,I){I.length>0&&(this._active=!0);const A=oa(I,y),M=new d.pointGeometry(0,0),F=new d.pointGeometry(0,0);let Z=0;for(const ee in A){const re=A[ee],ue=this._touches[ee];ue&&(M._add(re),F._add(re.sub(ue)),Z++,A[ee]=re)}if(this._touches=A,Z<this._minTouches||!F.mag())return;const J=F.div(Z);return this._sum._add(J),this._sum.mag()<this._clickTolerance?void 0:{around:M.div(Z),panDelta:J}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Aa{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(n){}_move(n,y,I){return{}}touchstart(n,y,I){this._firstTwoTouches||I.length<2||(this._firstTwoTouches=[I[0].identifier,I[1].identifier],this._start([y[0],y[1]]))}touchmove(n,y,I){if(!this._firstTwoTouches)return;n.preventDefault();const[A,M]=this._firstTwoTouches,F=Yl(I,y,A),Z=Yl(I,y,M);if(!F||!Z)return;const J=this._aroundCenter?null:F.add(Z).div(2);return this._move([F,Z],J,n)}touchend(n,y,I){if(!this._firstTwoTouches)return;const[A,M]=this._firstTwoTouches,F=Yl(I,y,A),Z=Yl(I,y,M);F&&Z||(this._active&&X.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Yl(S,n,y){for(let I=0;I<S.length;I++)if(S[I].identifier===y)return n[I]}function ii(S,n){return Math.log(S/n)/Math.LN2}class Qs extends Aa{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,y){const I=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(ii(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ii(this._distance,I),pinchAround:y}}}function wl(S,n){return 180*S.angleWith(n)/Math.PI}class cs extends Aa{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,y){const I=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:wl(this._vector,I),pinchAround:y}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const y=25/(Math.PI*this._minDiameter)*360,I=wl(n,this._startVector);return Math.abs(I)<y}}function ln(S){return Math.abs(S.y)>Math.abs(S.x)}class El extends Aa{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(n){this._lastPoints=n,ln(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,y,I){const A=n[0].sub(this._lastPoints[0]),M=n[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(A,M,I.timeStamp),this._valid)return this._lastPoints=n,this._active=!0,{pitchDelta:(A.y+M.y)/2*-.5}}gestureBeginsVertically(n,y,I){if(this._valid!==void 0)return this._valid;const A=n.mag()>=2,M=y.mag()>=2;if(!A&&!M)return;if(!A||!M)return this._firstMove===void 0&&(this._firstMove=I),I-this._firstMove<100&&void 0;const F=n.y>0==y.y>0;return ln(n)&&ln(y)&&F}}const sc={panStep:100,bearingStep:15,pitchStep:10};class Tn{constructor(){const n=sc;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let y=0,I=0,A=0,M=0,F=0;switch(n.keyCode){case 61:case 107:case 171:case 187:y=1;break;case 189:case 109:case 173:y=-1;break;case 37:n.shiftKey?I=-1:(n.preventDefault(),M=-1);break;case 39:n.shiftKey?I=1:(n.preventDefault(),M=1);break;case 38:n.shiftKey?A=1:(n.preventDefault(),F=-1);break;case 40:n.shiftKey?A=-1:(n.preventDefault(),F=1);break;default:return}return this._rotationDisabled&&(I=0,A=0),{cameraAnimation:Z=>{const J=Z.getZoom();Z.easeTo({duration:300,easeId:"keyboardHandler",easing:ni,zoom:y?Math.round(J)+y*(n.shiftKey?2:1):J,bearing:Z.getBearing()+I*this._bearingStep,pitch:Z.getPitch()+A*this._pitchStep,offset:[-M*this._panStep,-F*this._panStep],center:Z.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ni(S){return S*(2-S)}const fo=4.000244140625;class Il{constructor(n,y){this._map=n,this._el=n.getCanvasContainer(),this._handler=y,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,d.bindAll(["_onTimeout"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(n){if(!this.isEnabled())return;let y=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const I=d.exported.now(),A=I-(this._lastWheelEventTime||0);this._lastWheelEventTime=I,y!==0&&y%fo==0?this._type="wheel":y!==0&&Math.abs(y)<4?this._type="trackpad":A>400?(this._type=null,this._lastValue=y,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(A*y)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,y+=this._lastValue)),n.shiftKey&&y&&(y/=4),this._type&&(this._lastWheelEvent=n,this._delta-=y,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const y=X.mousePos(this._el,n);this._around=d.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(y)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;if(this._delta!==0){const Z=this._type==="wheel"&&Math.abs(this._delta)>fo?this._wheelZoomRate:this._defaultZoomRate;let J=2/(1+Math.exp(-Math.abs(this._delta*Z)));this._delta<0&&J!==0&&(J=1/J);const ee=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(ee*J))),this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:n.zoom,I=this._startZoom,A=this._easing;let M,F=!1;if(this._type==="wheel"&&I&&A){const Z=Math.min((d.exported.now()-this._lastWheelEventTime)/200,1),J=A(Z);M=d.number(I,y,J),Z<1?this._frameId||(this._frameId=!0):F=!0}else M=y,F=!0;return this._active=!0,F&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!F,zoomDelta:M-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let y=d.ease;if(this._prevEase){const I=this._prevEase,A=(d.exported.now()-I.start)/I.duration,M=I.easing(A+.01)-I.easing(A),F=.27/Math.sqrt(M*M+1e-4)*.01,Z=Math.sqrt(.0729-F*F);y=d.bezier(F,Z,.25,1)}return this._prevEase={start:d.exported.now(),duration:n,easing:y},y}reset(){this._active=!1}}class zs{constructor(n,y){this._clickZoom=n,this._tapZoom=y}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class aa{constructor(){this.reset()}reset(){this._active=!1}dblclick(n,y){return n.preventDefault(),{cameraAnimation:I=>{I.easeTo({duration:300,zoom:I.getZoom()+(n.shiftKey?-1:1),around:I.unproject(y)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class on{constructor(){this._tap=new bl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(n,y,I){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?I.length>0&&(this._swipePoint=y[0],this._swipeTouch=I[0].identifier):this._tap.touchstart(n,y,I))}touchmove(n,y,I){if(this._tapTime){if(this._swipePoint){if(I[0].identifier!==this._swipeTouch)return;const A=y[0],M=A.y-this._swipePoint.y;return this._swipePoint=A,n.preventDefault(),this._active=!0,{zoomDelta:M/128}}}else this._tap.touchmove(n,y,I)}touchend(n,y,I){this._tapTime?this._swipePoint&&I.length===0&&this.reset():this._tap.touchend(n,y,I)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Za{constructor(n,y,I){this._el=n,this._mousePan=y,this._touchPan=I}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Vt{constructor(n,y,I){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=y,this._mousePitch=I}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class $l{constructor(n,y,I,A){this._el=n,this._touchZoom=y,this._touchRotate=I,this._tapDragZoom=A,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const hs=S=>S.zoom||S.drag||S.pitch||S.rotate;class Ql extends d.Event{}function Ro(S){return S.panDelta&&S.panDelta.mag()||S.zoomDelta||S.bearingDelta||S.pitchDelta}class un{constructor(n,y){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new zu(n),this._bearingSnap=y.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(y),d.bindAll(["handleEvent","handleWindowEvent"],this);const I=this._el;this._listeners=[[I,"touchstart",{passive:!0}],[I,"touchmove",{passive:!1}],[I,"touchend",void 0],[I,"touchcancel",void 0],[I,"mousedown",void 0],[I,"mousemove",void 0],[I,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[I,"mouseover",void 0],[I,"mouseout",void 0],[I,"dblclick",void 0],[I,"click",void 0],[I,"keydown",{capture:!1}],[I,"keyup",void 0],[I,"wheel",{passive:!1}],[I,"contextmenu",void 0],[window,"blur",void 0]];for(const[A,M,F]of this._listeners)X.addEventListener(A,M,A===document?this.handleWindowEvent:this.handleEvent,F)}destroy(){for(const[n,y,I]of this._listeners)X.removeEventListener(n,y,n===document?this.handleWindowEvent:this.handleEvent,I)}_addDefaultHandlers(n){const y=this._map,I=y.getCanvasContainer();this._add("mapEvent",new ls(y,n));const A=y.boxZoom=new Js(y,n);this._add("boxZoom",A);const M=new Ys,F=new aa;y.doubleClickZoom=new zs(F,M),this._add("tapZoom",M),this._add("clickZoom",F);const Z=new on;this._add("tapDragZoom",Z);const J=y.touchPitch=new El;this._add("touchPitch",J);const ee=new Jt(n),re=new $s(n);y.dragRotate=new Vt(n,ee,re),this._add("mouseRotate",ee,["mousePitch"]),this._add("mousePitch",re,["mouseRotate"]);const ue=new kr(n),ve=new Ga(n);y.dragPan=new Za(I,ue,ve),this._add("mousePan",ue),this._add("touchPan",ve,["touchZoom","touchRotate"]);const Re=new cs,be=new Qs;y.touchZoomRotate=new $l(I,be,Re,Z),this._add("touchRotate",Re,["touchPan","touchZoom"]),this._add("touchZoom",be,["touchPan","touchRotate"]);const De=y.scrollZoom=new Il(y,this);this._add("scrollZoom",De,["mousePan"]);const Je=y.keyboard=new Tn;this._add("keyboard",Je),this._add("blockableMapEvent",new xl(y));for(const Xe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[Xe]&&y[Xe].enable(n[Xe])}_add(n,y,I){this._handlers.push({handlerName:n,handler:y,allowed:I}),this._handlersById[n]=y}stop(n){if(!this._updatingCamera){for(const{handler:y}of this._handlers)y.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(hs(this._eventsInProgress))||this.isZooming()}_blockedByActive(n,y,I){for(const A in n)if(A!==I&&(!y||y.indexOf(A)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const y=[];for(const I of n)this._el.contains(I.target)&&y.push(I);return y}handleEvent(n,y){if(n.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const I=n.type==="renderFrame"?void 0:n,A={needsRenderFrame:!1},M={},F={},Z=n.touches,J=Z?this._getMapTouches(Z):void 0,ee=J?X.touchPos(this._el,J):X.mousePos(this._el,n);for(const{handlerName:ve,handler:Re,allowed:be}of this._handlers){if(!Re.isEnabled())continue;let De;this._blockedByActive(F,be,ve)?Re.reset():Re[y||n.type]&&(De=Re[y||n.type](n,ee,J),this.mergeHandlerResult(A,M,De,ve,I),De&&De.needsRenderFrame&&this._triggerRenderFrame()),(De||Re.isActive())&&(F[ve]=Re)}const re={};for(const ve in this._previousActiveHandlers)F[ve]||(re[ve]=I);this._previousActiveHandlers=F,(Object.keys(re).length||Ro(A))&&(this._changes.push([A,M,re]),this._triggerRenderFrame()),(Object.keys(F).length||Ro(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ue}=A;ue&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ue(this._map))}mergeHandlerResult(n,y,I,A,M){if(!I)return;d.extend(n,I);const F={handlerName:A,originalEvent:I.originalEvent||M};I.zoomDelta!==void 0&&(y.zoom=F),I.panDelta!==void 0&&(y.drag=F),I.pitchDelta!==void 0&&(y.pitch=F),I.bearingDelta!==void 0&&(y.rotate=F)}_applyChanges(){const n={},y={},I={};for(const[A,M,F]of this._changes)A.panDelta&&(n.panDelta=(n.panDelta||new d.pointGeometry(0,0))._add(A.panDelta)),A.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+A.zoomDelta),A.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+A.bearingDelta),A.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+A.pitchDelta),A.around!==void 0&&(n.around=A.around),A.pinchAround!==void 0&&(n.pinchAround=A.pinchAround),A.noInertia&&(n.noInertia=A.noInertia),d.extend(y,M),d.extend(I,F);this._updateMapTransform(n,y,I),this._changes=[]}_updateMapTransform(n,y,I){const A=this._map,M=A.transform;if(!Ro(n))return this._fireEvents(y,I,!0);let{panDelta:F,zoomDelta:Z,bearingDelta:J,pitchDelta:ee,around:re,pinchAround:ue}=n;ue!==void 0&&(re=ue),A._stop(!0),re=re||A.transform.centerPoint;const ve=M.pointLocation(F?re.sub(F):re);J&&(M.bearing+=J),ee&&(M.pitch+=ee),Z&&(M.zoom+=Z),M.setLocationAtPoint(ve,re),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(y,I,!0)}_fireEvents(n,y,I){const A=hs(this._eventsInProgress),M=hs(n),F={};for(const re in n){const{originalEvent:ue}=n[re];this._eventsInProgress[re]||(F[`${re}start`]=ue),this._eventsInProgress[re]=n[re]}!A&&M&&this._fireEvent("movestart",M.originalEvent);for(const re in F)this._fireEvent(re,F[re]);M&&this._fireEvent("move",M.originalEvent);for(const re in n){const{originalEvent:ue}=n[re];this._fireEvent(re,ue)}const Z={};let J;for(const re in this._eventsInProgress){const{handlerName:ue,originalEvent:ve}=this._eventsInProgress[re];this._handlersById[ue].isActive()||(delete this._eventsInProgress[re],J=y[ue]||ve,Z[`${re}end`]=J)}for(const re in Z)this._fireEvent(re,Z[re]);const ee=hs(this._eventsInProgress);if(I&&(A||M)&&!ee){this._updatingCamera=!0;const re=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ue=ve=>ve!==0&&-this._bearingSnap<ve&&ve<this._bearingSnap;re?(ue(re.bearing||this._map.getBearing())&&(re.bearing=0),this._map.easeTo(re,{originalEvent:J})):(this._map.fire(new d.Event("moveend",{originalEvent:J})),ue(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,y){this._map.fire(new d.Event(n,y?{originalEvent:y}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new Ql("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Yr={extend:(S,...n)=>d.extend(S,...n),run(S){S()},logToElement(S,n=!1,y="log"){const I=window.document.getElementById(y);I&&(n&&(I.innerHTML=""),I.innerHTML+=`<br>${S}`)}};class el extends d.Evented{constructor(n,y){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=y.bearingSnap,d.bindAll(["_renderFrameCallback"],this)}getCenter(){return new d.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(n,y){return this.jumpTo({center:n},y)}panBy(n,y,I){return n=d.pointGeometry.convert(n).mult(-1),this.panTo(this.transform.center,d.extend({offset:n},y),I)}panTo(n,y,I){return this.easeTo(d.extend({center:n},y),I)}getZoom(){return this.transform.zoom}setZoom(n,y){return this.jumpTo({zoom:n},y),this}zoomTo(n,y,I){return this.easeTo(d.extend({zoom:n},y),I)}zoomIn(n,y){return this.zoomTo(this.getZoom()+1,n,y),this}zoomOut(n,y){return this.zoomTo(this.getZoom()-1,n,y),this}getBearing(){return this.transform.bearing}setBearing(n,y){return this.jumpTo({bearing:n},y),this}getPadding(){return this.transform.padding}setPadding(n,y){return this.jumpTo({padding:n},y),this}rotateTo(n,y,I){return this.easeTo(d.extend({bearing:n},y),I)}resetNorth(n,y){return this.rotateTo(0,d.extend({duration:1e3},n),y),this}resetNorthPitch(n,y){return this.easeTo(d.extend({bearing:0,pitch:0,duration:1e3},n),y),this}snapToNorth(n,y){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,y):this}getPitch(){return this.transform.pitch}setPitch(n,y){return this.jumpTo({pitch:n},y),this}cameraForBounds(n,y){n=d.LngLatBounds.convert(n);const I=y&&y.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),I,y)}_cameraForBoxAndBearing(n,y,I,A){const M={top:0,bottom:0,right:0,left:0};if(typeof(A=d.extend({padding:M,offset:[0,0],maxZoom:this.transform.maxZoom},A)).padding=="number"){const ht=A.padding;A.padding={top:ht,bottom:ht,right:ht,left:ht}}A.padding=d.extend(M,A.padding);const F=this.transform,Z=F.padding,J=F.project(d.LngLat.convert(n)),ee=F.project(d.LngLat.convert(y)),re=J.rotate(-I*Math.PI/180),ue=ee.rotate(-I*Math.PI/180),ve=new d.pointGeometry(Math.max(re.x,ue.x),Math.max(re.y,ue.y)),Re=new d.pointGeometry(Math.min(re.x,ue.x),Math.min(re.y,ue.y)),be=ve.sub(Re),De=(F.width-(Z.left+Z.right+A.padding.left+A.padding.right))/be.x,Je=(F.height-(Z.top+Z.bottom+A.padding.top+A.padding.bottom))/be.y;if(Je<0||De<0)return void d.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Xe=Math.min(F.scaleZoom(F.scale*Math.min(De,Je)),A.maxZoom),nt=d.pointGeometry.convert(A.offset),$e=new d.pointGeometry((A.padding.left-A.padding.right)/2,(A.padding.top-A.padding.bottom)/2).rotate(I*Math.PI/180),xt=nt.add($e).mult(F.scale/F.zoomScale(Xe));return{center:F.unproject(J.add(ee).div(2).sub(xt)),zoom:Xe,bearing:I}}fitBounds(n,y,I){return this._fitInternal(this.cameraForBounds(n,y),y,I)}fitScreenCoordinates(n,y,I,A,M){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(d.pointGeometry.convert(n)),this.transform.pointLocation(d.pointGeometry.convert(y)),I,A),A,M)}_fitInternal(n,y,I){return n?(delete(y=d.extend(n,y)).padding,y.linear?this.easeTo(y,I):this.flyTo(y,I)):this}jumpTo(n,y){this.stop();const I=this.transform;let A=!1,M=!1,F=!1;return"zoom"in n&&I.zoom!==+n.zoom&&(A=!0,I.zoom=+n.zoom),n.center!==void 0&&(I.center=d.LngLat.convert(n.center)),"bearing"in n&&I.bearing!==+n.bearing&&(M=!0,I.bearing=+n.bearing),"pitch"in n&&I.pitch!==+n.pitch&&(F=!0,I.pitch=+n.pitch),n.padding==null||I.isPaddingEqual(n.padding)||(I.padding=n.padding),this.fire(new d.Event("movestart",y)).fire(new d.Event("move",y)),A&&this.fire(new d.Event("zoomstart",y)).fire(new d.Event("zoom",y)).fire(new d.Event("zoomend",y)),M&&this.fire(new d.Event("rotatestart",y)).fire(new d.Event("rotate",y)).fire(new d.Event("rotateend",y)),F&&this.fire(new d.Event("pitchstart",y)).fire(new d.Event("pitch",y)).fire(new d.Event("pitchend",y)),this.fire(new d.Event("moveend",y))}easeTo(n,y){this._stop(!1,n.easeId),((n=d.extend({offset:[0,0],duration:500,easing:d.ease},n)).animate===!1||!n.essential&&d.exported.prefersReducedMotion)&&(n.duration=0);const I=this.transform,A=this.getZoom(),M=this.getBearing(),F=this.getPitch(),Z=this.getPadding(),J="zoom"in n?+n.zoom:A,ee="bearing"in n?this._normalizeBearing(n.bearing,M):M,re="pitch"in n?+n.pitch:F,ue="padding"in n?n.padding:I.padding,ve=d.pointGeometry.convert(n.offset);let Re=I.centerPoint.add(ve);const be=I.pointLocation(Re),De=d.LngLat.convert(n.center||be);this._normalizeCenter(De);const Je=I.project(be),Xe=I.project(De).sub(Je),nt=I.zoomScale(J-A);let $e,xt;n.around&&($e=d.LngLat.convert(n.around),xt=I.locationPoint($e));const ht={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||J!==A,this._rotating=this._rotating||M!==ee,this._pitching=this._pitching||re!==F,this._padding=!I.isPaddingEqual(ue),this._easeId=n.easeId,this._prepareEase(y,n.noMoveStart,ht),this._ease(mt=>{if(this._zooming&&(I.zoom=d.number(A,J,mt)),this._rotating&&(I.bearing=d.number(M,ee,mt)),this._pitching&&(I.pitch=d.number(F,re,mt)),this._padding&&(I.interpolatePadding(Z,ue,mt),Re=I.centerPoint.add(ve)),$e)I.setLocationAtPoint($e,xt);else{const Pt=I.zoomScale(I.zoom-A),Ot=J>A?Math.min(2,nt):Math.max(.5,nt),wt=Math.pow(Ot,1-mt),ci=I.unproject(Je.add(Xe.mult(mt*wt)).mult(Pt));I.setLocationAtPoint(I.renderWorldCopies?ci.wrap():ci,Re)}this._fireMoveEvents(y)},mt=>{this._afterEase(y,mt)},n),this}_prepareEase(n,y,I={}){this._moving=!0,y||I.moving||this.fire(new d.Event("movestart",n)),this._zooming&&!I.zooming&&this.fire(new d.Event("zoomstart",n)),this._rotating&&!I.rotating&&this.fire(new d.Event("rotatestart",n)),this._pitching&&!I.pitching&&this.fire(new d.Event("pitchstart",n))}_fireMoveEvents(n){this.fire(new d.Event("move",n)),this._zooming&&this.fire(new d.Event("zoom",n)),this._rotating&&this.fire(new d.Event("rotate",n)),this._pitching&&this.fire(new d.Event("pitch",n))}_afterEase(n,y){if(this._easeId&&y&&this._easeId===y)return;delete this._easeId;const I=this._zooming,A=this._rotating,M=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,I&&this.fire(new d.Event("zoomend",n)),A&&this.fire(new d.Event("rotateend",n)),M&&this.fire(new d.Event("pitchend",n)),this.fire(new d.Event("moveend",n))}flyTo(n,y){if(!n.essential&&d.exported.prefersReducedMotion){const p=d.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(p,y)}this.stop(),n=d.extend({offset:[0,0],speed:1.2,curve:1.42,easing:d.ease},n);const I=this.transform,A=this.getZoom(),M=this.getBearing(),F=this.getPitch(),Z=this.getPadding(),J="zoom"in n?d.clamp(+n.zoom,I.minZoom,I.maxZoom):A,ee="bearing"in n?this._normalizeBearing(n.bearing,M):M,re="pitch"in n?+n.pitch:F,ue="padding"in n?n.padding:I.padding,ve=I.zoomScale(J-A),Re=d.pointGeometry.convert(n.offset);let be=I.centerPoint.add(Re);const De=I.pointLocation(be),Je=d.LngLat.convert(n.center||De);this._normalizeCenter(Je);const Xe=I.project(De),nt=I.project(Je).sub(Xe);let $e=n.curve;const xt=Math.max(I.width,I.height),ht=xt/ve,mt=nt.mag();if("minZoom"in n){const p=d.clamp(Math.min(n.minZoom,A,J),I.minZoom,I.maxZoom),v=xt/I.zoomScale(p-A);$e=Math.sqrt(v/mt*2)}const Pt=$e*$e;function Ot(p){const v=(ht*ht-xt*xt+(p?-1:1)*Pt*Pt*mt*mt)/(2*(p?ht:xt)*Pt*mt);return Math.log(Math.sqrt(v*v+1)-v)}function wt(p){return(Math.exp(p)-Math.exp(-p))/2}function ci(p){return(Math.exp(p)+Math.exp(-p))/2}const ei=Ot(0);let Oi=function(p){return ci(ei)/ci(ei+$e*p)},u=function(p){return xt*((ci(ei)*(wt(v=ei+$e*p)/ci(v))-wt(ei))/Pt)/mt;var v},m=(Ot(1)-ei)/$e;if(Math.abs(mt)<1e-6||!isFinite(m)){if(Math.abs(xt-ht)<1e-6)return this.easeTo(n,y);const p=ht<xt?-1:1;m=Math.abs(Math.log(ht/xt))/$e,u=function(){return 0},Oi=function(v){return Math.exp(p*$e*v)}}return n.duration="duration"in n?+n.duration:1e3*m/("screenSpeed"in n?+n.screenSpeed/$e:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=M!==ee,this._pitching=re!==F,this._padding=!I.isPaddingEqual(ue),this._prepareEase(y,!1),this._ease(p=>{const v=p*m,k=1/Oi(v);I.zoom=p===1?J:A+I.scaleZoom(k),this._rotating&&(I.bearing=d.number(M,ee,p)),this._pitching&&(I.pitch=d.number(F,re,p)),this._padding&&(I.interpolatePadding(Z,ue,p),be=I.centerPoint.add(Re));const L=p===1?Je:I.unproject(Xe.add(nt.mult(u(v))).mult(k));I.setLocationAtPoint(I.renderWorldCopies?L.wrap():L,be),this._fireMoveEvents(y)},()=>this._afterEase(y),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,y){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const I=this._onEaseEnd;delete this._onEaseEnd,I.call(this,y)}if(!n){const I=this.handlers;I&&I.stop(!1)}return this}_ease(n,y,I){I.animate===!1||I.duration===0?(n(1),y()):(this._easeStart=d.exported.now(),this._easeOptions=I,this._onEaseFrame=n,this._onEaseEnd=y,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((d.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,y){n=d.wrap(n,-180,180);const I=Math.abs(n-y);return Math.abs(n-360-y)<I&&(n-=360),Math.abs(n+360-y)<I&&(n+=360),n}_normalizeCenter(n){const y=this.transform;if(!y.renderWorldCopies||y.lngRange)return;const I=n.lng-y.center.lng;n.lng+=I>180?-360:I<-180?360:0}}class mo{constructor(n={}){this.options=n,d.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options&&this.options.compact,this._container=X.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=X.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=X.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){X.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,y){const I=this._map._getUIString(`AttributionControl.${y}`);n.title=I,n.setAttribute("aria-label",I)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(A=>typeof A!="string"?"":A)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const A=this._map.style.stylesheet;this.styleOwner=A.owner,this.styleId=A.id}const y=this._map.style.sourceCaches;for(const A in y){const M=y[A];if(M.used){const F=M.getSource();F.attribution&&n.indexOf(F.attribution)<0&&n.push(F.attribution)}}n=n.filter(A=>String(A).trim()),n.sort((A,M)=>A.length-M.length),n=n.filter((A,M)=>{for(let F=M+1;F<n.length;F++)if(n[F].indexOf(A)>=0)return!1;return!0});const I=n.join(" | ");I!==this._attribHTML&&(this._attribHTML=I,n.length?(this._innerContainer.innerHTML=I,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Ca{constructor(n={}){this.options=n,d.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=X.create("div","maplibregl-ctrl mapboxgl-ctrl");const y=X.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return y.target="_blank",y.rel="noopener nofollow",y.href="https://maplibre.org/",y.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),y.setAttribute("rel","noopener nofollow"),this._container.appendChild(y),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){X.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const n=this._container.children;if(n.length){const y=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&y.classList.add("maplibregl-compact","mapboxgl-compact"):y.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class lc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const y=++this._id;return this._queue.push({callback:n,id:y,cancelled:!1}),y}remove(n){const y=this._currentlyRunning,I=y?this._queue.concat(y):this._queue;for(const A of I)if(A.id===n)return void(A.cancelled=!0)}run(n=0){const y=this._currentlyRunning=this._queue;this._queue=[];for(const I of y)if(!I.cancelled&&(I.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Sl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},uc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},ga={showCompass:!0,showZoom:!0,visualizePitch:!1};class qo{constructor(n,y,I=!1){this._clickTolerance=10,this.element=y,this.mouseRotate=new Jt({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,I&&(this.mousePitch=new $s({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),d.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),X.addEventListener(y,"mousedown",this.mousedown),X.addEventListener(y,"touchstart",this.touchstart,{passive:!1}),X.addEventListener(y,"touchmove",this.touchmove),X.addEventListener(y,"touchend",this.touchend),X.addEventListener(y,"touchcancel",this.reset)}down(n,y){this.mouseRotate.mousedown(n,y),this.mousePitch&&this.mousePitch.mousedown(n,y),X.disableDrag()}move(n,y){const I=this.map,A=this.mouseRotate.mousemoveWindow(n,y);if(A&&A.bearingDelta&&I.setBearing(I.getBearing()+A.bearingDelta),this.mousePitch){const M=this.mousePitch.mousemoveWindow(n,y);M&&M.pitchDelta&&I.setPitch(I.getPitch()+M.pitchDelta)}}off(){const n=this.element;X.removeEventListener(n,"mousedown",this.mousedown),X.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),X.removeEventListener(n,"touchmove",this.touchmove),X.removeEventListener(n,"touchend",this.touchend),X.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){X.enableDrag(),X.removeEventListener(window,"mousemove",this.mousemove),X.removeEventListener(window,"mouseup",this.mouseup)}mousedown(n){this.down(d.extend({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),X.mousePos(this.element,n)),X.addEventListener(window,"mousemove",this.mousemove),X.addEventListener(window,"mouseup",this.mouseup)}mousemove(n){this.move(n,X.mousePos(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=X.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=X.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function ai(S,n,y){if(S=new d.LngLat(S.lng,S.lat),n){const I=new d.LngLat(S.lng-360,S.lat),A=new d.LngLat(S.lng+360,S.lat),M=y.locationPoint(S).distSqr(n);y.locationPoint(I).distSqr(n)<M?S=I:y.locationPoint(A).distSqr(n)<M&&(S=A)}for(;Math.abs(S.lng-y.center.lng)>180;){const I=y.locationPoint(S);if(I.x>=0&&I.y>=0&&I.x<=y.width&&I.y<=y.height)break;S.lng>y.center.lng?S.lng-=360:S.lng+=360}return S}const Ut={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Go(S,n,y){const I=S.classList;for(const A in Ut)I.remove(`maplibregl-${y}-anchor-${A}`,`mapboxgl-${y}-anchor-${A}`);I.add(`maplibregl-${y}-anchor-${n}`,`mapboxgl-${y}-anchor-${n}`)}class Eo extends d.Evented{constructor(n,y){if(super(),(n instanceof HTMLElement||y)&&(n=d.extend({element:n},y)),d.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=d.pointGeometry.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=X.create("div"),this._element.setAttribute("aria-label","Map marker");const I=X.createNS("http://www.w3.org/2000/svg","svg"),A=41,M=27;I.setAttributeNS(null,"display","block"),I.setAttributeNS(null,"height",`${A}px`),I.setAttributeNS(null,"width",`${M}px`),I.setAttributeNS(null,"viewBox",`0 0 ${M} ${A}`);const F=X.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"stroke","none"),F.setAttributeNS(null,"stroke-width","1"),F.setAttributeNS(null,"fill","none"),F.setAttributeNS(null,"fill-rule","evenodd");const Z=X.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"fill-rule","nonzero");const J=X.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(3.0, 29.0)"),J.setAttributeNS(null,"fill","#000000");const ee=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const nt of ee){const $e=X.createNS("http://www.w3.org/2000/svg","ellipse");$e.setAttributeNS(null,"opacity","0.04"),$e.setAttributeNS(null,"cx","10.5"),$e.setAttributeNS(null,"cy","5.80029008"),$e.setAttributeNS(null,"rx",nt.rx),$e.setAttributeNS(null,"ry",nt.ry),J.appendChild($e)}const re=X.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"fill",this._color);const ue=X.createNS("http://www.w3.org/2000/svg","path");ue.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),re.appendChild(ue);const ve=X.createNS("http://www.w3.org/2000/svg","g");ve.setAttributeNS(null,"opacity","0.25"),ve.setAttributeNS(null,"fill","#000000");const Re=X.createNS("http://www.w3.org/2000/svg","path");Re.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ve.appendChild(Re);const be=X.createNS("http://www.w3.org/2000/svg","g");be.setAttributeNS(null,"transform","translate(6.0, 7.0)"),be.setAttributeNS(null,"fill","#FFFFFF");const De=X.createNS("http://www.w3.org/2000/svg","g");De.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Je=X.createNS("http://www.w3.org/2000/svg","circle");Je.setAttributeNS(null,"fill","#000000"),Je.setAttributeNS(null,"opacity","0.25"),Je.setAttributeNS(null,"cx","5.5"),Je.setAttributeNS(null,"cy","5.5"),Je.setAttributeNS(null,"r","5.4999962");const Xe=X.createNS("http://www.w3.org/2000/svg","circle");Xe.setAttributeNS(null,"fill","#FFFFFF"),Xe.setAttributeNS(null,"cx","5.5"),Xe.setAttributeNS(null,"cy","5.5"),Xe.setAttributeNS(null,"r","5.4999962"),De.appendChild(Je),De.appendChild(Xe),Z.appendChild(J),Z.appendChild(re),Z.appendChild(ve),Z.appendChild(be),Z.appendChild(De),I.appendChild(Z),I.setAttributeNS(null,"height",A*this._scale+"px"),I.setAttributeNS(null,"width",M*this._scale+"px"),this._element.appendChild(I),this._offset=d.pointGeometry.convert(n&&n.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",I=>{I.preventDefault()}),this._element.addEventListener("mousedown",I=>{I.preventDefault()}),Go(this._element,this._anchor,"marker"),this._popup=null}addTo(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),X.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=d.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const A=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[A,-1*(38.1-13.5+A)],"bottom-right":[-A,-1*(38.1-13.5+A)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(n){const y=n.code,I=n.charCode||n.keyCode;y!=="Space"&&y!=="Enter"&&I!==32&&I!==13||this.togglePopup()}_onMapClick(n){const y=n.originalEvent.target,I=this._element;this._popup&&(y===I||I.contains(y))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this}_update(n){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=ai(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let I="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?I="rotateX(0deg)":this._pitchAlignment==="map"&&(I=`rotateX(${this._map.getPitch()}deg)`),n&&n.type!=="moveend"||(this._pos=this._pos.round()),X.setTransform(this._element,`${Ut[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${I} ${y}`)}getOffset(){return this._offset}setOffset(n){return this._offset=d.pointGeometry.convert(n),this._update(),this}_onMove(n){if(!this._isDragging){const y=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=y}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new d.Event("dragstart"))),this.fire(new d.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new d.Event("dragend")),this._state="inactive"}_addDragHandler(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Nn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let cn,Zo=0,mn=!1;const Io={maxWidth:100,unit:"metric"};function ps(S,n,y){const I=y&&y.maxWidth||100,A=S._container.clientHeight/2,M=S.unproject([0,A]),F=S.unproject([I,A]),Z=M.distanceTo(F);if(y&&y.unit==="imperial"){const J=3.2808*Z;J>5280?Gt(n,I,J/5280,S._getUIString("ScaleControl.Miles")):Gt(n,I,J,S._getUIString("ScaleControl.Feet"))}else y&&y.unit==="nautical"?Gt(n,I,Z/1852,S._getUIString("ScaleControl.NauticalMiles")):Z>=1e3?Gt(n,I,Z/1e3,S._getUIString("ScaleControl.Kilometers")):Gt(n,I,Z,S._getUIString("ScaleControl.Meters"))}function Gt(S,n,y,I){const A=function(M){const F=Math.pow(10,`${Math.floor(M)}`.length-1);let Z=M/F;return Z=Z>=10?10:Z>=5?5:Z>=3?3:Z>=2?2:Z>=1?1:function(J){const ee=Math.pow(10,Math.ceil(-Math.log(J)/Math.LN10));return Math.round(J*ee)/ee}(Z),F*Z}(y);S.style.width=n*(A/y)+"px",S.innerHTML=`${A}&nbsp;${I}`}const qt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},eu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Mn(S){if(S){if(typeof S=="number"){const n=Math.round(Math.sqrt(.5*Math.pow(S,2)));return{center:new d.pointGeometry(0,0),top:new d.pointGeometry(0,S),"top-left":new d.pointGeometry(n,n),"top-right":new d.pointGeometry(-n,n),bottom:new d.pointGeometry(0,-S),"bottom-left":new d.pointGeometry(n,-n),"bottom-right":new d.pointGeometry(-n,-n),left:new d.pointGeometry(S,0),right:new d.pointGeometry(-S,0)}}if(S instanceof d.pointGeometry||Array.isArray(S)){const n=d.pointGeometry.convert(S);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:d.pointGeometry.convert(S.center||[0,0]),top:d.pointGeometry.convert(S.top||[0,0]),"top-left":d.pointGeometry.convert(S["top-left"]||[0,0]),"top-right":d.pointGeometry.convert(S["top-right"]||[0,0]),bottom:d.pointGeometry.convert(S.bottom||[0,0]),"bottom-left":d.pointGeometry.convert(S["bottom-left"]||[0,0]),"bottom-right":d.pointGeometry.convert(S["bottom-right"]||[0,0]),left:d.pointGeometry.convert(S.left||[0,0]),right:d.pointGeometry.convert(S.right||[0,0])}}return Mn(new d.pointGeometry(0,0))}const Bo={supported:R,setRTLTextPlugin:d.setRTLTextPlugin,getRTLTextPluginStatus:d.getRTLTextPluginStatus,Map:class extends el{constructor(S){var n;if(d.PerformanceUtils.mark(d.PerformanceMarkers.create),(S=d.extend({},uc,S)).minZoom!=null&&S.maxZoom!=null&&S.minZoom>S.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(S.minPitch!=null&&S.maxPitch!=null&&S.minPitch>S.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(S.minPitch!=null&&S.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(S.maxPitch!=null&&S.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ta(S.minZoom,S.maxZoom,S.minPitch,S.maxPitch,S.renderWorldCopies),{bearingSnap:S.bearingSnap}),this._interactive=S.interactive,this._maxTileCacheSize=S.maxTileCacheSize,this._failIfMajorPerformanceCaveat=S.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=S.preserveDrawingBuffer,this._antialias=S.antialias,this._trackResize=S.trackResize,this._bearingSnap=S.bearingSnap,this._refreshExpiredTiles=S.refreshExpiredTiles,this._fadeDuration=S.fadeDuration,this._crossSourceCollisions=S.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=S.collectResourceTiming,this._renderTaskQueue=new lc,this._controls=[],this._mapId=d.uniqueId(),this._locale=d.extend({},Sl,S.locale),this._clickTolerance=S.clickTolerance,this._pixelRatio=(n=S.pixelRatio)!==null&&n!==void 0?n:devicePixelRatio,this._requestManager=new Me(S.transformRequest),typeof S.container=="string"){if(this._container=document.getElementById(S.container),!this._container)throw new Error(`Container '${S.container}' not found.`)}else{if(!(S.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=S.container}if(S.maxBounds&&this.setMaxBounds(S.maxBounds),d.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),typeof window!="undefined"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new un(this,S),this._hash=S.hash&&new gl(typeof S.hash=="string"&&S.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:S.center,zoom:S.zoom,bearing:S.bearing,pitch:S.pitch}),S.bounds&&(this.resize(),this.fitBounds(S.bounds,d.extend({},S.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=S.localIdeographFontFamily,S.style&&this.setStyle(S.style,{localIdeographFontFamily:S.localIdeographFontFamily}),S.attributionControl&&this.addControl(new mo({customAttribution:S.customAttribution})),S.maplibreLogo&&this.addControl(new Ca,S.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",y=>{this._update(y.dataType==="style"),this.fire(new d.Event(`${y.dataType}data`,y))}),this.on("dataloading",y=>{this.fire(new d.Event(`${y.dataType}dataloading`,y))}),this.on("dataabort",y=>{this.fire(new d.Event("sourcedataabort",y))})}_getMapId(){return this._mapId}addControl(S,n){if(n===void 0&&(n=S.getDefaultPosition?S.getDefaultPosition():"top-right"),!S||!S.onAdd)return this.fire(new d.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const y=S.onAdd(this);this._controls.push(S);const I=this._controlPositions[n];return n.indexOf("bottom")!==-1?I.insertBefore(y,I.firstChild):I.appendChild(y),this}removeControl(S){if(!S||!S.onRemove)return this.fire(new d.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(S);return n>-1&&this._controls.splice(n,1),S.onRemove(this),this}hasControl(S){return this._controls.indexOf(S)>-1}resize(S){const n=this._containerDimensions(),y=n[0],I=n[1];this._resizeCanvas(y,I,this.getPixelRatio()),this.transform.resize(y,I),this.painter.resize(y,I,this.getPixelRatio());const A=!this._moving;return A&&(this.stop(),this.fire(new d.Event("movestart",S)).fire(new d.Event("move",S))),this.fire(new d.Event("resize",S)),A&&this.fire(new d.Event("moveend",S)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(S){const[n,y]=this._containerDimensions();this._pixelRatio=S,this._resizeCanvas(n,y,S),this.painter.resize(n,y,S)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(S){return this.transform.setMaxBounds(d.LngLatBounds.convert(S)),this._update()}setMinZoom(S){if((S=S==null?-2:S)>=-2&&S<=this.transform.maxZoom)return this.transform.minZoom=S,this._update(),this.getZoom()<S&&this.setZoom(S),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(S){if((S=S==null?22:S)>=this.transform.minZoom)return this.transform.maxZoom=S,this._update(),this.getZoom()>S&&this.setZoom(S),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(S){if((S=S==null?0:S)<0)throw new Error("minPitch must be greater than or equal to 0");if(S>=0&&S<=this.transform.maxPitch)return this.transform.minPitch=S,this._update(),this.getPitch()<S&&this.setPitch(S),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(S){if((S=S==null?60:S)>85)throw new Error("maxPitch must be less than or equal to 85");if(S>=this.transform.minPitch)return this.transform.maxPitch=S,this._update(),this.getPitch()>S&&this.setPitch(S),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(S){return this.transform.renderWorldCopies=S,this._update()}project(S){return this.transform.locationPoint(d.LngLat.convert(S))}unproject(S){return this.transform.pointLocation(d.pointGeometry.convert(S))}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(S,n,y){if(S==="mouseenter"||S==="mouseover"){let I=!1;return{layer:n,listener:y,delegates:{mousemove:M=>{const F=this.getLayer(n)?this.queryRenderedFeatures(M.point,{layers:[n]}):[];F.length?I||(I=!0,y.call(this,new bo(S,this,M.originalEvent,{features:F}))):I=!1},mouseout:()=>{I=!1}}}}if(S==="mouseleave"||S==="mouseout"){let I=!1;return{layer:n,listener:y,delegates:{mousemove:F=>{(this.getLayer(n)?this.queryRenderedFeatures(F.point,{layers:[n]}):[]).length?I=!0:I&&(I=!1,y.call(this,new bo(S,this,F.originalEvent)))},mouseout:F=>{I&&(I=!1,y.call(this,new bo(S,this,F.originalEvent)))}}}}{const I=A=>{const M=this.getLayer(n)?this.queryRenderedFeatures(A.point,{layers:[n]}):[];M.length&&(A.features=M,y.call(this,A),delete A.features)};return{layer:n,listener:y,delegates:{[S]:I}}}}on(S,n,y){if(y===void 0)return super.on(S,n);const I=this._createDelegatedListener(S,n,y);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[S]=this._delegatedListeners[S]||[],this._delegatedListeners[S].push(I);for(const A in I.delegates)this.on(A,I.delegates[A]);return this}once(S,n,y){if(y===void 0)return super.once(S,n);const I=this._createDelegatedListener(S,n,y);for(const A in I.delegates)this.once(A,I.delegates[A]);return this}off(S,n,y){return y===void 0?super.off(S,n):(this._delegatedListeners&&this._delegatedListeners[S]&&(I=>{const A=this._delegatedListeners[S];for(let M=0;M<A.length;M++){const F=A[M];if(F.layer===n&&F.listener===y){for(const Z in F.delegates)this.off(Z,F.delegates[Z]);return A.splice(M,1),this}}})(),this)}queryRenderedFeatures(S,n){if(!this.style)return[];let y;if(n!==void 0||S===void 0||S instanceof d.pointGeometry||Array.isArray(S)||(n=S,S=void 0),n=n||{},(S=S||[[0,0],[this.transform.width,this.transform.height]])instanceof d.pointGeometry||typeof S[0]=="number")y=[d.pointGeometry.convert(S)];else{const I=d.pointGeometry.convert(S[0]),A=d.pointGeometry.convert(S[1]);y=[I,new d.pointGeometry(A.x,I.y),A,new d.pointGeometry(I.x,A.y),I]}return this.style.queryRenderedFeatures(y,n,this.transform)}querySourceFeatures(S,n){return this.style.querySourceFeatures(S,n)}setStyle(S,n){return(n=d.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&S?(this._diffStyle(S,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(S,n))}setTransformRequest(S){return this._requestManager.setTransformRequest(S),this}_getUIString(S){const n=this._locale[S];if(n==null)throw new Error(`Missing UI string '${S}'`);return n}_updateStyle(S,n){return this.style&&(this.style.setEventedParent(null),this.style._remove()),S?(this.style=new Er(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof S=="string"?this.style.loadURL(S):this.style.loadJSON(S),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Er(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(S,n){if(typeof S=="string"){const y=this._requestManager.transformRequest(S,d.ResourceType.Style);d.getJSON(y,(I,A)=>{I?this.fire(new d.ErrorEvent(I)):A&&this._updateDiff(A,n)})}else typeof S=="object"&&this._updateDiff(S,n)}_updateDiff(S,n){try{this.style.setState(S)&&this._update(!0)}catch(y){d.warnOnce(`Unable to perform style diff: ${y.message||y.error||y}.  Rebuilding the style from scratch.`),this._updateStyle(S,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():d.warnOnce("There is no style added to the map.")}addSource(S,n){return this._lazyInitEmptyStyle(),this.style.addSource(S,n),this._update(!0)}isSourceLoaded(S){const n=this.style&&this.style.sourceCaches[S];if(n!==void 0)return n.loaded();this.fire(new d.ErrorEvent(new Error(`There is no source with ID '${S}'`)))}areTilesLoaded(){const S=this.style&&this.style.sourceCaches;for(const n in S){const y=S[n]._tiles;for(const I in y){const A=y[I];if(A.state!=="loaded"&&A.state!=="errored")return!1}}return!0}addSourceType(S,n,y){return this._lazyInitEmptyStyle(),this.style.addSourceType(S,n,y)}removeSource(S){return this.style.removeSource(S),this._update(!0)}getSource(S){return this.style.getSource(S)}addImage(S,n,{pixelRatio:y=1,sdf:I=!1,stretchX:A,stretchY:M,content:F}={}){if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||d.isImageBitmap(n)){const{width:Z,height:J,data:ee}=d.exported.getImageData(n);this.style.addImage(S,{data:new d.RGBAImage({width:Z,height:J},ee),pixelRatio:y,stretchX:A,stretchY:M,content:F,sdf:I,version:0})}else{if(n.width===void 0||n.height===void 0)return this.fire(new d.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Z,height:J,data:ee}=n,re=n;this.style.addImage(S,{data:new d.RGBAImage({width:Z,height:J},new Uint8Array(ee)),pixelRatio:y,stretchX:A,stretchY:M,content:F,sdf:I,version:0,userImage:re}),re.onAdd&&re.onAdd(this,S)}}}updateImage(S,n){const y=this.style.getImage(S);if(!y)return this.fire(new d.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const I=n instanceof HTMLImageElement||d.isImageBitmap(n)?d.exported.getImageData(n):n,{width:A,height:M,data:F}=I;if(A===void 0||M===void 0)return this.fire(new d.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(A!==y.data.width||M!==y.data.height)return this.fire(new d.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const Z=!(n instanceof HTMLImageElement||d.isImageBitmap(n));y.data.replace(F,Z),this.style.updateImage(S,y)}hasImage(S){return S?!!this.style.getImage(S):(this.fire(new d.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(S){this.style.removeImage(S)}loadImage(S,n){d.getImage(this._requestManager.transformRequest(S,d.ResourceType.Image),n)}listImages(){return this.style.listImages()}addLayer(S,n){return this._lazyInitEmptyStyle(),this.style.addLayer(S,n),this._update(!0)}moveLayer(S,n){return this.style.moveLayer(S,n),this._update(!0)}removeLayer(S){return this.style.removeLayer(S),this._update(!0)}getLayer(S){return this.style.getLayer(S)}setLayerZoomRange(S,n,y){return this.style.setLayerZoomRange(S,n,y),this._update(!0)}setFilter(S,n,y={}){return this.style.setFilter(S,n,y),this._update(!0)}getFilter(S){return this.style.getFilter(S)}setPaintProperty(S,n,y,I={}){return this.style.setPaintProperty(S,n,y,I),this._update(!0)}getPaintProperty(S,n){return this.style.getPaintProperty(S,n)}setLayoutProperty(S,n,y,I={}){return this.style.setLayoutProperty(S,n,y,I),this._update(!0)}getLayoutProperty(S,n){return this.style.getLayoutProperty(S,n)}setLight(S,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(S,n),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(S,n){return this.style.setFeatureState(S,n),this._update()}removeFeatureState(S,n){return this.style.removeFeatureState(S,n),this._update()}getFeatureState(S){return this.style.getFeatureState(S)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let S=0,n=0;return this._container&&(S=this._container.clientWidth||400,n=this._container.clientHeight||300),[S,n]}_setupContainer(){const S=this._container;S.classList.add("maplibregl-map","mapboxgl-map");const n=this._canvasContainer=X.create("div","maplibregl-canvas-container mapboxgl-canvas-container",S);this._interactive&&n.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=X.create("canvas","maplibregl-canvas mapboxgl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const y=this._containerDimensions();this._resizeCanvas(y[0],y[1],this.getPixelRatio());const I=this._controlContainer=X.create("div","maplibregl-control-container mapboxgl-control-container",S),A=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(M=>{A[M]=X.create("div",`maplibregl-ctrl-${M} mapboxgl-ctrl-${M}`,I)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(S,n,y){this._canvas.width=y*S,this._canvas.height=y*n,this._canvas.style.width=`${S}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const S=d.extend({},R.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl",S)||this._canvas.getContext("experimental-webgl",S);n?(this.painter=new na(n,this.transform),d.exported$1.testSupport(n)):this.fire(new d.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(S){S.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new d.Event("webglcontextlost",{originalEvent:S}))}_contextRestored(S){this._setupPainter(),this.resize(),this._update(),this.fire(new d.Event("webglcontextrestored",{originalEvent:S}))}_onMapScroll(S){if(S.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(S){return this.style?(this._styleDirty=this._styleDirty||S,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(S){return this._update(),this._renderTaskQueue.add(S)}_cancelRenderFrame(S){this._renderTaskQueue.remove(S)}_render(S){let n,y=0;const I=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(n=I.createQueryEXT(),I.beginQueryEXT(I.TIME_ELAPSED_EXT,n),y=d.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(S),this._removed)return;let A=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const F=this.transform.zoom,Z=d.exported.now();this.style.zoomHistory.update(F,Z);const J=new d.EvaluationParameters(F,{now:Z,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ee=J.crossFadingFactor();ee===1&&ee===this._crossFadingFactor||(A=!0,this._crossFadingFactor=ee),this.style.update(J)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new d.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,d.PerformanceUtils.mark(d.PerformanceMarkers.load),this.fire(new d.Event("load"))),this.style&&(this.style.hasTransitions()||A)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const F=d.exported.now()-y;I.endQueryEXT(I.TIME_ELAPSED_EXT,n),setTimeout(()=>{const Z=I.getQueryObjectEXT(n,I.QUERY_RESULT_EXT)/1e6;I.deleteQueryEXT(n),this.fire(new d.Event("gpu-timing-frame",{cpuTime:F,gpuTime:Z}))},50)}if(this.listens("gpu-timing-layer")){const F=this.painter.collectGpuTimers();setTimeout(()=>{const Z=this.painter.queryGpuTimers(F);this.fire(new d.Event("gpu-timing-layer",{layerTimes:Z}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty;return M||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new d.Event("idle")),!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,d.PerformanceUtils.mark(d.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window!="undefined"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const S=this.painter.context.gl.getExtension("WEBGL_lose_context");S&&S.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),X.remove(this._canvasContainer),X.remove(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),d.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new d.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=d.exported.frame(S=>{d.PerformanceUtils.frame(S),this._frame=null,this._render(S)}))}_onWindowOnline(){this._update()}_onWindowResize(S){this._trackResize&&this.resize({originalEvent:S})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(S){this._showTileBoundaries!==S&&(this._showTileBoundaries=S,this._update())}get showPadding(){return!!this._showPadding}set showPadding(S){this._showPadding!==S&&(this._showPadding=S,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(S){this._showCollisionBoxes!==S&&(this._showCollisionBoxes=S,S?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(S){this._showOverdrawInspector!==S&&(this._showOverdrawInspector=S,this._update())}get repaint(){return!!this._repaint}set repaint(S){this._repaint!==S&&(this._repaint=S,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(S){this._vertices=S,this._update()}_setCacheLimits(S,n){d.setCacheLimits(S,n)}},NavigationControl:class{constructor(S){this.options=d.extend({},ga,S),this._container=X.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(d.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),X.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),X.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(d.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=X.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const S=this._map.getZoom(),n=S===this._map.getMaxZoom(),y=S===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const S=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=S}onAdd(S){return this._map=S,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){X.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(S,n){const y=X.create("button",S,this._container);return y.type="button",y.addEventListener("click",n),y}_setButtonTitle(S,n){const y=this._map._getUIString(`NavigationControl.${n}`);S.title=y,S.setAttribute("aria-label",y)}},GeolocateControl:class extends d.Evented{constructor(S){super(),this.options=d.extend({},Nn,S),d.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(S){var n;return this._map=S,this._container=X.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,cn!==void 0?n(cn):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(y=>{cn=y.state!=="denied",n(cn)}):(cn=!!window.navigator.geolocation,n(cn)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),X.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Zo=0,mn=!1}_isOutOfMapMaxBounds(S){const n=this._map.getMaxBounds(),y=S.coords;return n&&(y.longitude<n.getWest()||y.longitude>n.getEast()||y.latitude<n.getSouth()||y.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(S){if(this._map){if(this._isOutOfMapMaxBounds(S))return this._setErrorState(),this.fire(new d.Event("outofmaxbounds",S)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=S,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(S),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(S),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new d.Event("geolocate",S)),this._finish()}}_updateCamera(S){const n=new d.LngLat(S.coords.longitude,S.coords.latitude),y=S.coords.accuracy,I=this._map.getBearing(),A=d.extend({bearing:I},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(y),A,{geolocateSource:!0})}_updateMarker(S){if(S){const n=new d.LngLat(S.coords.longitude,S.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=S.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const S=this._map._container.clientHeight/2,n=this._map.unproject([0,S]),y=this._map.unproject([1,S]),I=n.distanceTo(y),A=Math.ceil(2*this._accuracy/I);this._circleElement.style.width=`${A}px`,this._circleElement.style.height=`${A}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(S){if(this._map){if(this.options.trackUserLocation)if(S.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(S.code===3&&mn)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new d.Event("error",S)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(S){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=X.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),X.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",S===!1){d.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=X.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Eo(this._dotElement),this._circleElement=X.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Eo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new d.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return d.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new d.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Zo--,mn=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new d.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new d.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let S;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Zo++,Zo>1?(S={maximumAge:6e5,timeout:0},mn=!0):(S=this.options.positionOptions,mn=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,S)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:mo,LogoControl:Ca,ScaleControl:class{constructor(S){this.options=d.extend({},Io,S),d.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){ps(this._map,this._container,this.options)}onAdd(S){return this._map=S,this._container=X.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",S.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){X.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(S){this.options.unit=S,ps(this._map,this._container,this.options)}},FullscreenControl:class{constructor(S){this._fullscreen=!1,S&&S.container&&(S.container instanceof HTMLElement?this._container=S.container:d.warnOnce("Full screen control 'container' must be a DOM element.")),d.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(S){return this._map=S,this._container||(this._container=this._map.getContainer()),this._controlContainer=X.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",d.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){X.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const S=this._fullscreenButton=X.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);X.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",S).setAttribute("aria-hidden","true"),S.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const S=this._getTitle();this._fullscreenButton.setAttribute("aria-label",S),this._fullscreenButton.title=S}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends d.Evented{constructor(S){super(),this.options=d.extend(Object.create(qt),S),d.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(S){return this._map&&this.remove(),this._map=S,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new d.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&X.remove(this._content),this._container&&(X.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new d.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(S){return this._lngLat=d.LngLat.convert(S),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(S){return this.setDOMContent(document.createTextNode(S))}setHTML(S){const n=document.createDocumentFragment(),y=document.createElement("body");let I;for(y.innerHTML=S;I=y.firstChild,I;)n.appendChild(I);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(S){return this.options.maxWidth=S,this._update(),this}setDOMContent(S){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=X.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(S),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(S){this._container&&this._container.classList.add(S)}removeClassName(S){this._container&&this._container.classList.remove(S)}setOffset(S){return this.options.offset=S,this._update(),this}toggleClassName(S){if(this._container)return this._container.classList.toggle(S)}_createCloseButton(){this.options.closeButton&&(this._closeButton=X.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(S){this._update(S.point)}_onMouseMove(S){this._update(S.point)}_onDrag(S){this._update(S.point)}_update(S){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=X.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=X.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(M=>this._container.classList.add(M)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ai(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!S))return;const n=this._pos=this._trackPointer&&S?S:this._map.project(this._lngLat);let y=this.options.anchor;const I=Mn(this.options.offset);if(!y){const M=this._container.offsetWidth,F=this._container.offsetHeight;let Z;Z=n.y+I.bottom.y<F?["top"]:n.y>this._map.transform.height-F?["bottom"]:[],n.x<M/2?Z.push("left"):n.x>this._map.transform.width-M/2&&Z.push("right"),y=Z.length===0?"bottom":Z.join("-")}const A=n.add(I[y]).round();X.setTransform(this._container,`${Ut[y]} translate(${A.x}px,${A.y}px)`),Go(this._container,y,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const S=this._container.querySelector(eu);S&&S.focus()}_onClose(){this.remove()}},Marker:Eo,Style:Er,LngLat:d.LngLat,LngLatBounds:d.LngLatBounds,Point:d.pointGeometry,MercatorCoordinate:d.MercatorCoordinate,Evented:d.Evented,AJAXError:d.AJAXError,config:d.config,CanvasSource:Xi,GeoJSONSource:oi,ImageSource:Bi,RasterDEMTileSource:Dt,RasterTileSource:hr,VectorTileSource:Gi,VideoSource:Nt,prewarm:function(){fn().acquire(Cr)},clearPrewarmedResources:function(){const S=Mo;S&&(S.isPreloaded()&&S.numActive()===1?(S.release(Cr),Mo=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get workerCount(){return no.workerCount},set workerCount(S){no.workerCount=S},get maxParallelImageRequests(){return d.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(S){d.config.MAX_PARALLEL_IMAGE_REQUESTS=S},clearStorage(S){d.clearTileCache(S)},workerUrl:"",addProtocol(S,n){d.config.REGISTERED_PROTOCOLS[S]=n},removeProtocol(S){delete d.config.REGISTERED_PROTOCOLS[S]}};return Yr.extend(Bo,{isSafari:d.isSafari,getPerformanceMetrics:d.PerformanceUtils.getPerformanceMetrics}),Bo});var f=T;return f})})(Wh);var sE=Wh.exports,Zp=uE,lE=Object.prototype.hasOwnProperty;function uE(){for(var c={},a=0;a<arguments.length;a++){var l=arguments[a];for(var x in l)lE.call(l,x)&&(c[x]=l[x])}return c}var Fv={exports:{}};(function(c,a){(function(){var l={};c.exports=l,l.simpleFilter=function(x,T){return T.filter(function(P){return l.test(x,P)})},l.test=function(x,T){return l.match(x,T)!==null},l.match=function(x,T,P){P=P||{};var f=0,d=[],R=T.length,q=0,V=0,G=P.pre||"",X=P.post||"",Me=P.caseSensitive&&T||T.toLowerCase(),ke;x=P.caseSensitive&&x||x.toLowerCase();for(var qe=0;qe<R;qe++)ke=T[qe],Me[qe]===x[f]?(ke=G+ke+X,f+=1,V+=1+V):V=0,q+=V,d[d.length]=ke;return f===x.length?(q=Me===x?1/0:q,{rendered:d.join(""),score:q}):null},l.filter=function(x,T,P){return!T||T.length===0?[]:typeof x!="string"?T:(P=P||{},T.reduce(function(f,d,R,q){var V=d;P.extract&&(V=P.extract(d));var G=l.match(x,V,P);return G!=null&&(f[f.length]={string:G.rendered,score:G.score,index:R,original:d}),f},[]).sort(function(f,d){var R=d.score-f.score;return R||f.index-d.index}))}})()})(Fv);var js=function(c){return this.component=c,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,c.el.parentNode.insertBefore(this.wrapper,c.el.nextSibling),this};js.prototype.show=function(){this.element.style.display="block"};js.prototype.hide=function(){this.element.style.display="none"};js.prototype.add=function(c){this.items.push(c)};js.prototype.clear=function(){this.items=[],this.active=0};js.prototype.isEmpty=function(){return!this.items.length};js.prototype.isVisible=function(){return this.element.style.display==="block"};js.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var c=0;c<this.items.length;c++)this.drawItem(this.items[c],this.active===c);this.show()};js.prototype.drawItem=function(c,a){var l=document.createElement("li"),x=document.createElement("a");a&&(l.className+=" active"),x.innerHTML=c.string,l.appendChild(x),this.element.appendChild(l),l.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),l.addEventListener("mouseup",function(){this.handleMouseUp.call(this,c)}.bind(this))};js.prototype.handleMouseUp=function(c){this.selectingListItem=!1,this.component.value(c.original),this.clear(),this.draw()};js.prototype.move=function(c){this.active=c,this.draw()};js.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)};js.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)};js.prototype.drawError=function(c){var a=document.createElement("li");a.innerHTML=c,this.element.appendChild(a),this.show()};var cE=js,hE=Zp,pE=Fv.exports,dE=cE,$a=function(c,a,l){return l=l||{},this.options=hE({minLength:2,limit:5,filter:!0,hideOnBlur:!0},l),this.el=c,this.data=a||[],this.list=new dE(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(x){this.handleKeyUp(x.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(x){this.handleKeyDown(x)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(x){this.handlePaste(x)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};$a.prototype.handleKeyUp=function(c){c===40||c===38||c===27||c===13||c===9||this.handleInputChange(this.el.value)};$a.prototype.handleKeyDown=function(c){switch(c.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&c.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};$a.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};$a.prototype.handlePaste=function(c){if(c.clipboardData)this.handleInputChange(c.clipboardData.getData("Text"));else{var a=this;setTimeout(function(){a.handleInputChange(c.target.value)},100)}};$a.prototype.handleInputChange=function(c){if(this.query=this.normalize(c),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates(function(a){for(var l=0;l<a.length&&(this.list.add(a[l]),l!==this.options.limit-1);l++);this.list.draw()}.bind(this))};$a.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};$a.prototype.update=function(c){this.data=c,this.handleKeyUp()};$a.prototype.clear=function(){this.data=[],this.list.clear()};$a.prototype.normalize=function(c){return c=c.toLowerCase(),c};$a.prototype.match=function(c,a){return c.indexOf(a)>-1};$a.prototype.value=function(c){if(this.selected=c,this.el.value=this.getItemValue(c),document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent("change",!0,!1),this.el.dispatchEvent(a)}else this.el.fireEvent("onchange")};$a.prototype.getCandidates=function(c){var a={pre:"<strong>",post:"</strong>",extract:function(x){return this.getItemValue(x)}.bind(this)},l;this.options.filter?(l=pE.filter(this.query,this.data,a),l=l.map(function(x){return{original:x.original,string:this.render(x.original,x.string)}}.bind(this))):l=this.data.map(function(x){var T=this.render(x);return{original:x,string:T}}.bind(this)),c(l)};$a.prototype.getItemValue=function(c){return c};$a.prototype.render=function(c,a){if(a)return a;for(var l=c.original?this.getItemValue(c.original):this.getItemValue(c),x=this.normalize(l),T=x.lastIndexOf(this.query);T>-1;){var P=T+this.query.length;l=l.slice(0,T)+"<strong>"+l.slice(T,P)+"</strong>"+l.slice(P),T=x.slice(0,T).lastIndexOf(this.query)}return l};$a.prototype.renderError=function(c){this.list.drawError(c)};var fE=$a,Uv=fE,mE=Uv;typeof window!="undefined"&&(window.Suggestions=Uv);var yE="Expected a function",D_=0/0,gE="[object Symbol]",_E=/^\s+|\s+$/g,vE=/^[-+]0x[0-9a-f]+$/i,xE=/^0b[01]+$/i,bE=/^0o[0-7]+$/i,wE=parseInt,EE=typeof Ll=="object"&&Ll&&Ll.Object===Object&&Ll,IE=typeof self=="object"&&self&&self.Object===Object&&self,SE=EE||IE||Function("return this")(),TE=Object.prototype,AE=TE.toString,CE=Math.max,kE=Math.min,wy=function(){return SE.Date.now()};function zE(c,a,l){var x,T,P,f,d,R,q=0,V=!1,G=!1,X=!0;if(typeof c!="function")throw new TypeError(yE);a=R_(a)||0,Gy(l)&&(V=!!l.leading,G="maxWait"in l,P=G?CE(R_(l.maxWait)||0,a):P,X="trailing"in l?!!l.trailing:X);function Me(pt){var lt=x,pi=T;return x=T=void 0,q=pt,f=c.apply(pi,lt),f}function ke(pt){return q=pt,d=setTimeout(ft,a),V?Me(pt):f}function qe(pt){var lt=pt-R,pi=pt-q,Et=a-lt;return G?kE(Et,P-pi):Et}function We(pt){var lt=pt-R,pi=pt-q;return R===void 0||lt>=a||lt<0||G&&pi>=P}function ft(){var pt=wy();if(We(pt))return Ge(pt);d=setTimeout(ft,qe(pt))}function Ge(pt){return d=void 0,X&&x?Me(pt):(x=T=void 0,f)}function Ze(){d!==void 0&&clearTimeout(d),q=0,x=R=T=d=void 0}function gt(){return d===void 0?f:Ge(wy())}function ct(){var pt=wy(),lt=We(pt);if(x=arguments,T=this,R=pt,lt){if(d===void 0)return ke(R);if(G)return d=setTimeout(ft,a),Me(R)}return d===void 0&&(d=setTimeout(ft,a)),f}return ct.cancel=Ze,ct.flush=gt,ct}function Gy(c){var a=typeof c;return!!c&&(a=="object"||a=="function")}function PE(c){return!!c&&typeof c=="object"}function ME(c){return typeof c=="symbol"||PE(c)&&AE.call(c)==gE}function R_(c){if(typeof c=="number")return c;if(ME(c))return D_;if(Gy(c)){var a=typeof c.valueOf=="function"?c.valueOf():c;c=Gy(a)?a+"":a}if(typeof c!="string")return c===0?c:+c;c=c.replace(_E,"");var l=xE.test(c);return l||bE.test(c)?wE(c.slice(2),l?2:8):vE.test(c)?D_:+c}var LE=zE,gg={exports:{}},Rp=typeof Reflect=="object"?Reflect:null,B_=Rp&&typeof Rp.apply=="function"?Rp.apply:function(a,l,x){return Function.prototype.apply.call(a,l,x)},Ff;Rp&&typeof Rp.ownKeys=="function"?Ff=Rp.ownKeys:Object.getOwnPropertySymbols?Ff=function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:Ff=function(a){return Object.getOwnPropertyNames(a)};function DE(c){console&&console.warn&&console.warn(c)}var Nv=Number.isNaN||function(a){return a!==a};function kn(){kn.init.call(this)}gg.exports=kn;gg.exports.once=FE;kn.EventEmitter=kn;kn.prototype._events=void 0;kn.prototype._eventsCount=0;kn.prototype._maxListeners=void 0;var O_=10;function hm(c){if(typeof c!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof c)}Object.defineProperty(kn,"defaultMaxListeners",{enumerable:!0,get:function(){return O_},set:function(c){if(typeof c!="number"||c<0||Nv(c))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+c+".");O_=c}});kn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};kn.prototype.setMaxListeners=function(a){if(typeof a!="number"||a<0||Nv(a))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this};function jv(c){return c._maxListeners===void 0?kn.defaultMaxListeners:c._maxListeners}kn.prototype.getMaxListeners=function(){return jv(this)};kn.prototype.emit=function(a){for(var l=[],x=1;x<arguments.length;x++)l.push(arguments[x]);var T=a==="error",P=this._events;if(P!==void 0)T=T&&P.error===void 0;else if(!T)return!1;if(T){var f;if(l.length>0&&(f=l[0]),f instanceof Error)throw f;var d=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw d.context=f,d}var R=P[a];if(R===void 0)return!1;if(typeof R=="function")B_(R,this,l);else for(var q=R.length,V=Hv(R,q),x=0;x<q;++x)B_(V[x],this,l);return!0};function Vv(c,a,l,x){var T,P,f;if(hm(l),P=c._events,P===void 0?(P=c._events=Object.create(null),c._eventsCount=0):(P.newListener!==void 0&&(c.emit("newListener",a,l.listener?l.listener:l),P=c._events),f=P[a]),f===void 0)f=P[a]=l,++c._eventsCount;else if(typeof f=="function"?f=P[a]=x?[l,f]:[f,l]:x?f.unshift(l):f.push(l),T=jv(c),T>0&&f.length>T&&!f.warned){f.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(a)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=c,d.type=a,d.count=f.length,DE(d)}return c}kn.prototype.addListener=function(a,l){return Vv(this,a,l,!1)};kn.prototype.on=kn.prototype.addListener;kn.prototype.prependListener=function(a,l){return Vv(this,a,l,!0)};function RE(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function qv(c,a,l){var x={fired:!1,wrapFn:void 0,target:c,type:a,listener:l},T=RE.bind(x);return T.listener=l,x.wrapFn=T,T}kn.prototype.once=function(a,l){return hm(l),this.on(a,qv(this,a,l)),this};kn.prototype.prependOnceListener=function(a,l){return hm(l),this.prependListener(a,qv(this,a,l)),this};kn.prototype.removeListener=function(a,l){var x,T,P,f,d;if(hm(l),T=this._events,T===void 0)return this;if(x=T[a],x===void 0)return this;if(x===l||x.listener===l)--this._eventsCount===0?this._events=Object.create(null):(delete T[a],T.removeListener&&this.emit("removeListener",a,x.listener||l));else if(typeof x!="function"){for(P=-1,f=x.length-1;f>=0;f--)if(x[f]===l||x[f].listener===l){d=x[f].listener,P=f;break}if(P<0)return this;P===0?x.shift():BE(x,P),x.length===1&&(T[a]=x[0]),T.removeListener!==void 0&&this.emit("removeListener",a,d||l)}return this};kn.prototype.off=kn.prototype.removeListener;kn.prototype.removeAllListeners=function(a){var l,x,T;if(x=this._events,x===void 0)return this;if(x.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):x[a]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete x[a]),this;if(arguments.length===0){var P=Object.keys(x),f;for(T=0;T<P.length;++T)f=P[T],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(l=x[a],typeof l=="function")this.removeListener(a,l);else if(l!==void 0)for(T=l.length-1;T>=0;T--)this.removeListener(a,l[T]);return this};function Gv(c,a,l){var x=c._events;if(x===void 0)return[];var T=x[a];return T===void 0?[]:typeof T=="function"?l?[T.listener||T]:[T]:l?OE(T):Hv(T,T.length)}kn.prototype.listeners=function(a){return Gv(this,a,!0)};kn.prototype.rawListeners=function(a){return Gv(this,a,!1)};kn.listenerCount=function(c,a){return typeof c.listenerCount=="function"?c.listenerCount(a):Zv.call(c,a)};kn.prototype.listenerCount=Zv;function Zv(c){var a=this._events;if(a!==void 0){var l=a[c];if(typeof l=="function")return 1;if(l!==void 0)return l.length}return 0}kn.prototype.eventNames=function(){return this._eventsCount>0?Ff(this._events):[]};function Hv(c,a){for(var l=new Array(a),x=0;x<a;++x)l[x]=c[x];return l}function BE(c,a){for(;a+1<c.length;a++)c[a]=c[a+1];c.pop()}function OE(c){for(var a=new Array(c.length),l=0;l<a.length;++l)a[l]=c[l].listener||c[l];return a}function FE(c,a){return new Promise(function(l,x){function T(f){c.removeListener(a,P),x(f)}function P(){typeof c.removeListener=="function"&&c.removeListener("error",T),l([].slice.call(arguments))}Wv(c,a,P,{once:!0}),a!=="error"&&UE(c,T,{once:!0})})}function UE(c,a,l){typeof c.on=="function"&&Wv(c,"error",a,l)}function Wv(c,a,l,x){if(typeof c.on=="function")x.once?c.once(a,l):c.on(a,l);else if(typeof c.addEventListener=="function")c.addEventListener(a,function T(P){x.once&&c.removeEventListener(a,T),l(P)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof c)}var NE={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};function jE(c){var a=c.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return a?{key:a[1],value:a[2]}:null}function VE(c){var a=c.match(/<?([^>]*)>(.*)/);if(!a)return null;var l=a[1],x=a[2].split(";"),T=null,P=x.reduce(function(f,d){var R=jE(d);return R?R.key==="rel"?(T||(T=R.value),f):(f[R.key]=R.value,f):f},{});return T?{url:l,rel:T,params:P}:null}function qE(c){return c?c.split(/,\s*</).reduce(function(a,l){var x=VE(l);if(!x)return a;var T=x.rel.split(/\s+/);return T.forEach(function(P){a[P]||(a[P]={url:x.url,params:x.params})}),a},{}):{}}var GE=qE,ZE=GE;function _g(c,a){this.request=c,this.headers=a.headers,this.rawBody=a.body,this.statusCode=a.statusCode;try{this.body=JSON.parse(a.body||"{}")}catch{this.body=a.body}this.links=ZE(this.headers.link)}_g.prototype.hasNextPage=function(){return!!this.links.next};_g.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null};var HE=_g,pm={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"},F_=pm;function WE(c){var a=c.type||F_.ERROR_HTTP,l;if(c.body)try{l=JSON.parse(c.body)}catch{l=c.body}else l=null;var x=c.message||null;x||(typeof l=="string"?x=l:l&&typeof l.message=="string"?x=l.message:a===F_.ERROR_REQUEST_ABORTED&&(x="Request aborted")),this.message=x,this.type=a,this.statusCode=c.statusCode||null,this.request=c.request,this.body=l}var XE=WE;function KE(c){var a=c.indexOf(":"),l=c.substring(0,a).trim().toLowerCase(),x=c.substring(a+1).trim();return{name:l,value:x}}function JE(c){var a={};return c&&c.trim().split(/[\r|\n]+/).forEach(function(l){var x=KE(l);a[x.name]=x.value}),a}var YE=JE,$E=HE,U_=XE,Ey=pm,QE=YE,Xf={};function eI(c){var a=Xf[c.id];!a||(a.abort(),delete Xf[c.id])}function tI(c,a){return new $E(c,{body:a.response,headers:QE(a.getAllResponseHeaders()),statusCode:a.status})}function N_(c){var a=c.total,l=c.loaded,x=100*l/a;return{total:a,transferred:l,percent:x}}function Xv(c,a){return new Promise(function(l,x){a.onprogress=function(f){c.emitter.emit(Ey.EVENT_PROGRESS_DOWNLOAD,N_(f))};var T=c.file;T&&(a.upload.onprogress=function(f){c.emitter.emit(Ey.EVENT_PROGRESS_UPLOAD,N_(f))}),a.onerror=function(f){x(f)},a.onabort=function(){var f=new U_({request:c,type:Ey.ERROR_REQUEST_ABORTED});x(f)},a.onload=function(){if(delete Xf[c.id],a.status<200||a.status>=400){var f=new U_({request:c,body:a.response,statusCode:a.status});x(f);return}l(a)};var P=c.body;typeof P=="string"?a.send(P):P?a.send(JSON.stringify(P)):T?a.send(T):a.send(),Xf[c.id]=a}).then(function(l){return tI(c,l)})}function Kv(c,a){var l=c.url(a),x=new window.XMLHttpRequest;return x.open(c.method,l),Object.keys(c.headers).forEach(function(T){x.setRequestHeader(T,c.headers[T])}),x}function iI(c){return Promise.resolve().then(function(){var a=Kv(c,c.client.accessToken);return Xv(c,a)})}var rI={browserAbort:eI,sendRequestXhr:Xv,browserSend:iI,createRequestXhr:Kv},Zy={exports:{}};/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */(function(c,a){(function(l){var x=a,T=c&&c.exports==x&&c,P=typeof Ll=="object"&&Ll;(P.global===P||P.window===P)&&(l=P);var f=function(ke){this.message=ke};f.prototype=new Error,f.prototype.name="InvalidCharacterError";var d=function(ke){throw new f(ke)},R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",q=/[\t\n\f\r ]/g,V=function(ke){ke=String(ke).replace(q,"");var qe=ke.length;qe%4==0&&(ke=ke.replace(/==?$/,""),qe=ke.length),(qe%4==1||/[^+a-zA-Z0-9/]/.test(ke))&&d("Invalid character: the string to be decoded is not correctly encoded.");for(var We=0,ft,Ge,Ze="",gt=-1;++gt<qe;)Ge=R.indexOf(ke.charAt(gt)),ft=We%4?ft*64+Ge:Ge,We++%4&&(Ze+=String.fromCharCode(255&ft>>(-2*We&6)));return Ze},G=function(ke){ke=String(ke),/[^\0-\xFF]/.test(ke)&&d("The string to be encoded contains characters outside of the Latin1 range.");for(var qe=ke.length%3,We="",ft=-1,Ge,Ze,gt,ct,pt=ke.length-qe;++ft<pt;)Ge=ke.charCodeAt(ft)<<16,Ze=ke.charCodeAt(++ft)<<8,gt=ke.charCodeAt(++ft),ct=Ge+Ze+gt,We+=R.charAt(ct>>18&63)+R.charAt(ct>>12&63)+R.charAt(ct>>6&63)+R.charAt(ct&63);return qe==2?(Ge=ke.charCodeAt(ft)<<8,Ze=ke.charCodeAt(++ft),ct=Ge+Ze,We+=R.charAt(ct>>10)+R.charAt(ct>>4&63)+R.charAt(ct<<2&63)+"="):qe==1&&(ct=ke.charCodeAt(ft),We+=R.charAt(ct>>2)+R.charAt(ct<<4&63)+"=="),We},X={encode:G,decode:V,version:"0.1.0"};if(x&&!x.nodeType)if(T)T.exports=X;else for(var Me in X)X.hasOwnProperty(Me)&&(x[Me]=X[Me]);else l.base64=X})(Ll)})(Zy,Zy.exports);var nI=Zy.exports,Iy={};function oI(c){if(Iy[c])return Iy[c];var a=c.split("."),l=a[0],x=a[1];if(!x)throw new Error("Invalid token");var T=aI(x),P={usage:l,user:T.u};return Gh(T,"a")&&(P.authorization=T.a),Gh(T,"exp")&&(P.expires=T.exp*1e3),Gh(T,"iat")&&(P.created=T.iat*1e3),Gh(T,"scopes")&&(P.scopes=T.scopes),Gh(T,"client")&&(P.client=T.client),Gh(T,"ll")&&(P.lastLogin=T.ll),Gh(T,"iu")&&(P.impersonator=T.iu),Iy[c]=P,P}function aI(c){try{return JSON.parse(nI.decode(c))}catch{throw new Error("Invalid token")}}function Gh(c,a){return Object.prototype.hasOwnProperty.call(c,a)}var Jv=oI,Yv={exports:{}};(function(c){var a=Object.prototype.hasOwnProperty,l="~";function x(){}Object.create&&(x.prototype=Object.create(null),new x().__proto__||(l=!1));function T(R,q,V){this.fn=R,this.context=q,this.once=V||!1}function P(R,q,V,G,X){if(typeof V!="function")throw new TypeError("The listener must be a function");var Me=new T(V,G||R,X),ke=l?l+q:q;return R._events[ke]?R._events[ke].fn?R._events[ke]=[R._events[ke],Me]:R._events[ke].push(Me):(R._events[ke]=Me,R._eventsCount++),R}function f(R,q){--R._eventsCount===0?R._events=new x:delete R._events[q]}function d(){this._events=new x,this._eventsCount=0}d.prototype.eventNames=function(){var q=[],V,G;if(this._eventsCount===0)return q;for(G in V=this._events)a.call(V,G)&&q.push(l?G.slice(1):G);return Object.getOwnPropertySymbols?q.concat(Object.getOwnPropertySymbols(V)):q},d.prototype.listeners=function(q){var V=l?l+q:q,G=this._events[V];if(!G)return[];if(G.fn)return[G.fn];for(var X=0,Me=G.length,ke=new Array(Me);X<Me;X++)ke[X]=G[X].fn;return ke},d.prototype.listenerCount=function(q){var V=l?l+q:q,G=this._events[V];return G?G.fn?1:G.length:0},d.prototype.emit=function(q,V,G,X,Me,ke){var qe=l?l+q:q;if(!this._events[qe])return!1;var We=this._events[qe],ft=arguments.length,Ge,Ze;if(We.fn){switch(We.once&&this.removeListener(q,We.fn,void 0,!0),ft){case 1:return We.fn.call(We.context),!0;case 2:return We.fn.call(We.context,V),!0;case 3:return We.fn.call(We.context,V,G),!0;case 4:return We.fn.call(We.context,V,G,X),!0;case 5:return We.fn.call(We.context,V,G,X,Me),!0;case 6:return We.fn.call(We.context,V,G,X,Me,ke),!0}for(Ze=1,Ge=new Array(ft-1);Ze<ft;Ze++)Ge[Ze-1]=arguments[Ze];We.fn.apply(We.context,Ge)}else{var gt=We.length,ct;for(Ze=0;Ze<gt;Ze++)switch(We[Ze].once&&this.removeListener(q,We[Ze].fn,void 0,!0),ft){case 1:We[Ze].fn.call(We[Ze].context);break;case 2:We[Ze].fn.call(We[Ze].context,V);break;case 3:We[Ze].fn.call(We[Ze].context,V,G);break;case 4:We[Ze].fn.call(We[Ze].context,V,G,X);break;default:if(!Ge)for(ct=1,Ge=new Array(ft-1);ct<ft;ct++)Ge[ct-1]=arguments[ct];We[Ze].fn.apply(We[Ze].context,Ge)}}return!0},d.prototype.on=function(q,V,G){return P(this,q,V,G,!1)},d.prototype.once=function(q,V,G){return P(this,q,V,G,!0)},d.prototype.removeListener=function(q,V,G,X){var Me=l?l+q:q;if(!this._events[Me])return this;if(!V)return f(this,Me),this;var ke=this._events[Me];if(ke.fn)ke.fn===V&&(!X||ke.once)&&(!G||ke.context===G)&&f(this,Me);else{for(var qe=0,We=[],ft=ke.length;qe<ft;qe++)(ke[qe].fn!==V||X&&!ke[qe].once||G&&ke[qe].context!==G)&&We.push(ke[qe]);We.length?this._events[Me]=We.length===1?We[0]:We:f(this,Me)}return this},d.prototype.removeAllListeners=function(q){var V;return q?(V=l?l+q:q,this._events[V]&&f(this,V)):(this._events=new x,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=l,d.EventEmitter=d,c.exports=d})(Yv);function sI(c){return c.map(encodeURIComponent).join(",")}function $v(c){return Array.isArray(c)?sI(c):encodeURIComponent(String(c))}function Qv(c,a,l){if(l===!1||l===null)return c;var x=/\?/.test(c)?"&":"?",T=encodeURIComponent(a);return l!==void 0&&l!==""&&l!==!0&&(T+="="+$v(l)),""+c+x+T}function lI(c,a){if(!a)return c;var l=c;return Object.keys(a).forEach(function(x){var T=a[x];T!==void 0&&(Array.isArray(T)&&(T=T.filter(function(P){return P!=null}).join(",")),l=Qv(l,x,T))}),l}function uI(c,a){if(!a||c.slice(0,4)==="http")return c;var l=c[0]==="/"?"":"/";return""+a.replace(/\/$/,"")+l+c}function cI(c,a){return a?c.replace(/\/:([a-zA-Z0-9]+)/g,function(l,x){var T=a[x];if(T===void 0)throw new Error("Unspecified route parameter "+x);var P=$v(T);return"/"+P}):c}var hI={appendQueryObject:lI,appendQueryParam:Qv,prependOrigin:uI,interpolateRouteParams:cI},pI=Jv,vg=Zp,dI=Yv.exports,Mf=hI,j_=pm,fI=1;function fh(c,a){if(!c)throw new Error("MapiRequest requires a client");if(!a||!a.path||!a.method)throw new Error("MapiRequest requires an options object with path and method properties");var l={};a.body&&(l["content-type"]="application/json");var x=vg(l,a.headers),T=Object.keys(x).reduce(function(P,f){return P[f.toLowerCase()]=x[f],P},{});this.id=fI++,this._options=a,this.emitter=new dI,this.client=c,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=a.path,this.method=a.method,this.origin=a.origin||c.origin,this.query=a.query||{},this.params=a.params||{},this.body=a.body||null,this.file=a.file||null,this.encoding=a.encoding||"utf8",this.sendFileAs=a.sendFileAs||null,this.headers=T}fh.prototype.url=function(a){var l=Mf.prependOrigin(this.path,this.origin);l=Mf.appendQueryObject(l,this.query);var x=this.params,T=a==null?this.client.accessToken:a;if(T){l=Mf.appendQueryParam(l,"access_token",T);var P=pI(T).user;x=vg({ownerId:P},x)}return l=Mf.interpolateRouteParams(l,x),l};fh.prototype.send=function(){var a=this;if(a.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return a.sent=!0,a.client.sendRequest(a).then(function(l){return a.response=l,a.emitter.emit(j_.EVENT_RESPONSE,l),l},function(l){throw a.error=l,a.emitter.emit(j_.EVENT_ERROR,l),l})};fh.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))};fh.prototype.eachPage=function(a){var l=this;function x(f){function d(){delete l._nextPageRequest;var R=f.nextPage();R&&(l._nextPageRequest=R,P(R))}a(null,f,d)}function T(f){a(f,null,function(){})}function P(f){f.send().then(x,T)}P(this)};fh.prototype.clone=function(){return this._extend()};fh.prototype._extend=function(a){var l=vg(this._options,a);return new fh(this.client,l)};var mI=fh,yI=Jv,gI=mI,_I=pm;function e0(c){if(!c||!c.accessToken)throw new Error("Cannot create a client without an access token");yI(c.accessToken),this.accessToken=c.accessToken,this.origin=c.origin||_I.API_ORIGIN}e0.prototype.createRequest=function(a){return new gI(this,a)};var t0=e0,i0=rI,r0=t0;function Fp(c){r0.call(this,c)}Fp.prototype=Object.create(r0.prototype);Fp.prototype.constructor=Fp;Fp.prototype.sendRequest=i0.browserSend;Fp.prototype.abortRequest=i0.browserAbort;function vI(c){return new Fp(c)}var n0=vI,xI=n0,bI=xI,wI=Object.prototype.toString,EI=function(c){var a;return wI.call(c)==="[object Object]"&&(a=Object.getPrototypeOf(c),a===null||a===Object.getPrototypeOf({}))},II=EI,SI=Zp,o0="value",Sy=`
  `,Vn={};Vn.assert=function(c,a){return a=a||{},function(l){var x=mh(c,l);if(!!x){var T=xg(x,a);throw a.apiName&&(T=a.apiName+": "+T),new Error(T)}}};Vn.shape=function(a){var l=kI(a);return function(T){var P=mh(Vn.plainObject,T);if(P)return P;for(var f,d,R=[],q=0;q<l.length;q++)f=l[q].key,d=l[q].value,P=mh(d,T[f]),P&&R.push([f].concat(P));return R.length<2?R[0]:function(V){R=R.map(function(Me){var ke=Me[0],qe=xg(Me,V).split(`
`).join(Sy);return"- "+ke+": "+qe});var G=V.path.join("."),X=G===o0?"":" of "+G;return"The following properties"+X+" have invalid values:"+Sy+R.join(Sy)}}};Vn.strictShape=function(a){var l=Vn.shape(a);return function(T){var P=l(T);if(P)return P;var f=Object.keys(T).reduce(function(d,R){return a[R]===void 0&&d.push(R),d},[]);if(f.length!==0)return function(){return"The following keys are invalid: "+f.join(", ")}}};Vn.arrayOf=function(a){return a0(a)};Vn.tuple=function(){var a=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return a0(a)};function a0(c){var a=Array.isArray(c),l=function(x){return a?c[x]:c};return function(T){var P=mh(Vn.plainArray,T);if(P)return P;if(a&&T.length!==c.length)return"an array with "+c.length+" items";for(var f=0;f<T.length;f++)if(P=mh(l(f),T[f]),P)return[f].concat(P)}}Vn.required=function(a){function l(x){return x==null?function(T){return s0(T,l0(T.path)?"cannot be undefined/null.":"is required.")}:a.apply(this,arguments)}return l.__required=!0,l};Vn.oneOfType=function(){var a=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(x){var T=a.map(function(P){return mh(P,x)}).filter(Boolean);if(T.length===a.length)return T.every(function(P){return P.length===1&&typeof P[0]=="string"})?TI(T.map(function(P){return P[0]})):T.reduce(function(P,f){return f.length>P.length?f:P})}};Vn.equal=function(a){return function(x){if(x!==a)return JSON.stringify(a)}};Vn.oneOf=function(){var a=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),l=a.map(function(x){return Vn.equal(x)});return Vn.oneOfType.apply(this,l)};Vn.range=function(a){var l=a[0],x=a[1];return function(P){var f=mh(Vn.number,P);if(f||P<l||P>x)return"number between "+l+" & "+x+" (inclusive)"}};Vn.any=function(){};Vn.boolean=function(a){if(typeof a!="boolean")return"boolean"};Vn.number=function(a){if(typeof a!="number")return"number"};Vn.plainArray=function(a){if(!Array.isArray(a))return"array"};Vn.plainObject=function(a){if(!II(a))return"object"};Vn.string=function(a){if(typeof a!="string")return"string"};Vn.func=function(a){if(typeof a!="function")return"function"};function mh(c,a){if(!(a==null&&!c.hasOwnProperty("__required"))){var l=c(a);if(l)return Array.isArray(l)?l:[l]}}function xg(c,a){var l=c.length,x=c[l-1],T=c.slice(0,l-1);return T.length===0&&(T=[o0]),a=SI(a,{path:T}),typeof x=="function"?x(a):s0(a,AI(x))}function TI(c){return c.length<2?c[0]:c.length===2?c.join(" or "):c.slice(0,-1).join(", ")+", or "+c.slice(-1)}function AI(c){return"must be "+CI(c)+"."}function CI(c){return/^an? /.test(c)?c:/^[aeiou]/i.test(c)?"an "+c:/^[a-z]/i.test(c)?"a "+c:c}function s0(c,a){var l=l0(c.path),x=c.path.join(".")+" "+a,T=l?"Item at position ":"";return T+x}function l0(c){return typeof c[c.length-1]=="number"||typeof c[0]=="number"}function kI(c){return Object.keys(c||{}).map(function(a){return{key:a,value:c[a]}})}Vn.validate=mh;Vn.processMessage=xg;var zI=Vn,PI=Zp,Bp=zI;function MI(c){if(typeof window!="undefined")return c instanceof Ll.Blob||c instanceof Ll.ArrayBuffer?void 0:"Blob or ArrayBuffer";if(!(typeof c=="string"||c.pipe!==void 0))return"Filename or Readable stream"}function LI(c,a){return Bp.assert(Bp.strictShape(c),a)}function DI(c){var a="date";if(typeof c=="boolean")return a;try{var l=new Date(c);if(l.getTime&&isNaN(l.getTime()))return a}catch{return a}}function RI(c){return Bp.tuple(Bp.number,Bp.number)(c)}var BI=PI(Bp,{file:MI,date:DI,coordinates:RI,assertShape:LI});function OI(c,a){var l=function(x,T){return a.indexOf(x)!==-1&&T!==void 0};return typeof a=="function"&&(l=a),Object.keys(c).filter(function(x){return l(x,c[x])}).reduce(function(x,T){return x[T]=c[T],x},{})}var FI=OI;function UI(c,a){return Object.keys(c).reduce(function(l,x){return l[x]=a(x,c[x]),l},{})}var NI=UI,jI=NI;function VI(c){return jI(c,function(a,l){return typeof l=="boolean"?JSON.stringify(l):l})}var qI=VI,GI=t0,ZI=n0;function HI(c){return function(a){var l;GI.prototype.isPrototypeOf(a)?l=a:l=ZI(a);var x=Object.create(c);return x.client=l,x}}var WI=HI,u0=Zp,Kr=BI,Kf=FI,c0=qI,XI=WI,bg={},h0=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];bg.forwardGeocode=function(c){Kr.assertShape({query:Kr.required(Kr.string),mode:Kr.oneOf("mapbox.places","mapbox.places-permanent"),countries:Kr.arrayOf(Kr.string),proximity:Kr.oneOf(Kr.coordinates,"ip"),types:Kr.arrayOf(Kr.oneOf(h0)),autocomplete:Kr.boolean,bbox:Kr.arrayOf(Kr.number),limit:Kr.number,language:Kr.arrayOf(Kr.string),routing:Kr.boolean,fuzzyMatch:Kr.boolean,worldview:Kr.string})(c),c.mode=c.mode||"mapbox.places";var a=c0(u0({country:c.countries},Kf(c,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Kf(c,["mode","query"]),query:a})};bg.reverseGeocode=function(c){Kr.assertShape({query:Kr.required(Kr.coordinates),mode:Kr.oneOf("mapbox.places","mapbox.places-permanent"),countries:Kr.arrayOf(Kr.string),types:Kr.arrayOf(Kr.oneOf(h0)),bbox:Kr.arrayOf(Kr.number),limit:Kr.number,language:Kr.arrayOf(Kr.string),reverseMode:Kr.oneOf("distance","score"),routing:Kr.boolean,worldview:Kr.string})(c),c.mode=c.mode||"mapbox.places";var a=c0(u0({country:c.countries},Kf(c,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Kf(c,["mode","query"]),query:a})};var KI=XI(bg);let JI="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",p0=c=>crypto.getRandomValues(new Uint8Array(c)),d0=(c,a,l)=>{let x=(2<<Math.log(c.length-1)/Math.LN2)-1,T=-~(1.6*x*a/c.length);return(P=a)=>{let f="";for(;;){let d=l(T),R=T;for(;R--;)if(f+=c[d[R]&x]||"",f.length===P)return f}}},YI=(c,a=21)=>d0(c,a,p0),$I=(c=21)=>{let a="",l=crypto.getRandomValues(new Uint8Array(c));for(;c--;){let x=l[c]&63;x<36?a+=x.toString(36):x<62?a+=(x-26).toString(36).toUpperCase():x<63?a+="_":a+="-"}return a};var QI=Object.freeze(Object.defineProperty({__proto__:null,nanoid:$I,customAlphabet:YI,customRandom:d0,urlAlphabet:JI,random:p0},Symbol.toStringTag,{value:"Module"})),eS=aE(QI),tS=eS.nanoid;function f0(c){this.origin=c.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=c.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=c,this.send=this.send.bind(this),this.countries=c.countries?c.countries.split(","):null,this.types=c.types?c.types.split(","):null,this.bbox=c.bbox?c.bbox:null,this.language=c.language?c.language.split(","):null,this.limit=c.limit?+c.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(c),this.eventQueue=new Array,this.flushInterval=c.flushInterval||1e3,this.maxQueueSize=c.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}f0.prototype={select:function(c,a){var l=this.getSelectedIndex(c,a),x=this.getEventPayload("search.select",a);if(x.resultIndex=l,x.resultPlaceName=c.place_name,x.resultId=c.id,!(l===this.lastSentIndex&&x.queryString===this.lastSentInput||l==-1)&&(this.lastSentIndex=l,this.lastSentInput=x.queryString,!!x.queryString))return this.push(x)},start:function(c){var a=this.getEventPayload("search.start",c);if(!!a.queryString)return this.push(a)},keyevent:function(c,a){if(!!c.key&&!(c.metaKey||[9,27,37,39,13,38,40].indexOf(c.keyCode)!==-1)){var l=this.getEventPayload("search.keystroke",a);if(l.lastAction=c.key,!!l.queryString)return this.push(l)}},send:function(c,a){if(!this.enableEventLogging)return a?a():void 0;var l=this.getRequestOptions(c);this.request(l,function(x){if(x)return this.handleError(x,a);if(a)return a()}.bind(this))},getRequestOptions:function(c){Array.isArray(c)||(c=[c]);var a={method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(c)};return a},getEventPayload:function(c,a){var l;a.options.proximity?typeof a.options.proximity=="object"?l=[a.options.proximity.longitude,a.options.proximity.latitude]:a.options.proximity==="ip"?l=[999,999]:l=a.options.proximity:l=null;var x=a._map?a._map.getZoom():void 0,T={event:c,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:a.options.autocomplete,fuzzyMatch:a.options.fuzzyMatch,proximity:l,limit:a.options.limit,routing:a.options.routing,worldview:a.options.worldview,mapZoom:x,keyboardLocale:this.locale};return c==="search.select"?T.queryString=a.inputString:c!="search.select"&&a._inputEl?T.queryString=a._inputEl.value:T.queryString=a.inputString,T},request:function(c,a){var l=new XMLHttpRequest;l.onreadystatechange=function(){if(this.readyState==4)return this.status==204?a(null):a(this.statusText)},l.open(c.method,c.host+"/"+c.path,!0);for(var x in c.headers){var T=c.headers[x];l.setRequestHeader(x,T)}l.send(c.body)},handleError:function(c,a){if(a)return a(c)},generateSessionID:function(){return tS()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(c,a){if(!!a._typeahead){var l=a._typeahead.data,x=c.id,T=l.map(function(f){return f.id}),P=T.indexOf(x);return P}},shouldEnableLogging:function(c){return!(c.enableEventLogging===!1||c.origin&&c.origin.indexOf("api.mapbox.com")==-1||c.localGeocoder||c.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(c,a){this.eventQueue.push(c),(this.eventQueue.length>=this.maxQueueSize||a)&&this.flush()},remove:function(){this.flush()}};var iS=f0,rS={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05DC\u05D7\u05E4\u05E9",ja:"\u30B5\u30FC\u30C1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041F\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641C\u7D22",cs:"Vyhled\xE1v\xE1n\xED",hu:"Keres\xE9s",ka:"\u10EB\u10D8\u10D4\u10D1\u10D0",nb:"S\xF8ke",sk:"Vyh\u013Ead\xE1vanie",th:"\u0E04\u0E49\u0E19\u0E2B\u0E32",fi:"Hae",is:"Leita",ko:"\uC218\uC0C9",pl:"Szukaj",sl:"Iskanje",fa:"\u062C\u0633\u062A\u062C\u0648",ru:"\u041F\u043E\u0438\u0441\u043A"},nS={placeholder:rS},m0={exports:{}};(function(c){(function(a,l,x){c.exports?c.exports=x():a[l]=x()})(Ll,"subtag",function(){var a="",l=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function x(R){return R.match(l)||[]}function T(R){return x(R).filter(function(q,V){return q&&V})}function P(R){return R=x(R),{language:R[1]||a,extlang:R[2]||a,script:R[3]||a,region:R[4]||a}}function f(R,q,V){Object.defineProperty(R,q,{value:V,enumerable:!0})}function d(R,q,V){function G(X){return x(X)[R]||a}f(G,"pattern",q),f(P,V,G)}return d(1,/^[a-zA-Z]{2,3}$/,"language"),d(2,/^[a-zA-Z]{3}$/,"extlang"),d(3,/^[a-zA-Z]{4}$/,"script"),d(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),f(P,"split",T),P})})(m0);function y0(){}y0.prototype={isSupport:function(){return Boolean(window.navigator.geolocation)},getCurrentPosition:function(){const c={enableHighAccuracy:!0};return new Promise(function(a,l){window.navigator.geolocation.getCurrentPosition(a,l,c)})}};var oS=y0;function aS(c,a){const l=g0(c),x=["address","street","place","country"];var T;if(typeof a=="function")return a(l);const P=x.indexOf(a);return P===-1?T=x:T=x.slice(P),T.reduce(function(f,d){return l[d]?(f!==""&&(f=f+", "),f+l[d]):f},"")}function g0(c){const a=c.address||"",l=c.text||"",x=c.place_name||"",P={address:x.split(",")[0],houseNumber:a,street:l,placeName:x};return c.context.forEach(function(f){const d=f.id.split(".")[0];P[d]=f.text}),P}var sS={transformFeatureToGeolocationText:aS,getAddressInfo:g0},lS=mE,uS=LE,Zh=Zp,cS=gg.exports.EventEmitter,V_=NE,Ty=bI,Ay=KI,hS=iS,pS=nS,dS=m0.exports,fS=oS,mS=sS;const uh={FORWARD:0,LOCAL:1,REVERSE:2};function yS(){var c=document.createElement("div");return c.className="mapboxgl-ctrl-geocoder--powered-by",c.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',c}function _0(c){this._eventEmitter=new cS,this.options=Zh({},this.options,c),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new fS}_0.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(c){return c.place_name},render:function(c){var a=c.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+a[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+a.splice(1,a.length).join(",")+"</div></div>"}},addTo:function(c){function a(l,x){if(!document.body.contains(x))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const T=l.onAdd();x.appendChild(T)}if(c._controlContainer)c.addControl(this);else if(c instanceof HTMLElement)a(this,c);else if(typeof c=="string"){const l=document.querySelectorAll(c);if(l.length===0)throw new Error("Element ",c,"not found.");if(l.length>1)throw new Error("Geocoder can only be added to a single html element");a(this,l[0])}else throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(c){if(c&&typeof c!="string"&&(this._map=c),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=Ay(Ty({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new hS(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var a=this.container=document.createElement("div");a.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var l=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",uS(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",function(q){this.eventManager.keyevent(q,this)}.bind(this));var x=document.createElement("div");x.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var T=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(T),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),x.appendChild(this._clearEl),x.appendChild(this._loadingEl),a.appendChild(l),a.appendChild(this._inputEl),a.appendChild(x),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var P=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(P),x.appendChild(this._geolocateEl),this._showGeolocateButton()}var f=this._typeahead=new lS(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),f.getItemValue=this.options.getItemValue;var d=f.list.draw,R=this._footerNode=yS();return f.list.draw=function(){d.call(this),R.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),R.addEventListener("mouseup",function(){this.selectingListItem=!1}.bind(this)),this.element.appendChild(R)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),a},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then(function(c){this._hideLoadingIcon();const a={geometry:{type:"Point",coordinates:[c.coords.longitude,c.coords.latitude]}};this._handleMarker(a),this._fly(a),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(a),this._showClearButton(),this.fresh=!1;const l={limit:1,language:[this.options.language],query:a.geometry.coordinates,types:["address"]};if(this.options.localGeocoderOnly){const x=a.geometry.coordinates[0]+","+a.geometry.coordinates[1];this._setInputValue(x),this._eventEmitter.emit("result",{result:a})}else this.geocoderService.reverseGeocode(l).send().then(function(x){const T=x.body.features[0];if(T){const P=mS.transformFeatureToGeolocationText(T,this.options.addressAccuracy);this._setInputValue(P),T.user_coordinates=a.geometry.coordinates,this._eventEmitter.emit("result",{result:T})}else this._eventEmitter.emit("result",{result:{user_coordinates:a.geometry.coordinates}})}.bind(this))}.bind(this)).catch(function(c){c.code===1?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}.bind(this))},createIcon:function(c,a){var l=document.createElementNS("http://www.w3.org/2000/svg","svg");return l.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+c),l.setAttribute("viewBox","0 0 18 18"),l.setAttribute("xml:space","preserve"),l.setAttribute("width",18),l.setAttribute("height",18),l.innerHTML=a,l},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(c){this._inputEl.value=c,setTimeout(function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}.bind(this),1)},_onPaste:function(c){var a=(c.clipboardData||window.clipboardData).getData("text");a.length>=this.options.minLength&&this._geocode(a)},_onKeyDown:function(c){var a=27,l=9;if(c.keyCode===a&&this.options.clearAndBlurOnEsc)return this._clear(c),this._inputEl.blur();var x=c.target&&c.target.shadowRoot?c.target.shadowRoot.activeElement:c.target,T=x?x.value:"";if(!T)return this.fresh=!0,c.keyCode!==l&&this.clear(c),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!(c.metaKey||[l,a,37,39,13,38,40].indexOf(c.keyCode)!==-1)&&x.value.length>=this.options.minLength&&this._geocode(x.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(c){this.options.clearOnBlur&&this._clearOnBlur(c),this.options.collapsed&&this._collapse()},_onChange:function(){var c=this._typeahead.selected;c&&JSON.stringify(c)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(c),this.options.marker&&this._mapboxgl&&this._handleMarker(c),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(c),this._eventEmitter.emit("result",{result:c}),this.eventManager.select(c,this))},_fly:function(c){var a;if(c.properties&&V_[c.properties.short_code])a=Zh({},this.options.flyTo),this._map&&this._map.fitBounds(V_[c.properties.short_code].bbox,a);else if(c.bbox){var l=c.bbox;a=Zh({},this.options.flyTo),this._map&&this._map.fitBounds([[l[0],l[1]],[l[2],l[3]]],a)}else{var x={zoom:this.options.zoom};a=Zh({},x,this.options.flyTo),c.center?a.center=c.center:c.geometry&&c.geometry.type&&c.geometry.type==="Point"&&c.geometry.coordinates&&(a.center=c.geometry.coordinates),this._map&&this._map.flyTo(a)}},_requestType:function(c,a){var l;const x=/^[ ]*(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/;return c.localGeocoderOnly?l=uh.LOCAL:c.reverseGeocode&&x.test(a)?l=uh.REVERSE:l=uh.FORWARD,l},_setupConfig:function(c,a){const l=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"],x=/[\s,]+/;var T=this,P=l.reduce(function(d,R){if(T.options[R]===void 0||T.options[R]===null)return d;["countries","types","language"].indexOf(R)>-1?d[R]=T.options[R].split(x):d[R]=T.options[R];const q=typeof T.options[R].longitude=="number"&&typeof T.options[R].latitude=="number";if(R==="proximity"&&q){const V=T.options[R].longitude,G=T.options[R].latitude;d[R]=[V,G]}return d},{});switch(c){case uh.REVERSE:{var f=a.split(x).map(function(d){return parseFloat(d,10)});T.options.flipCoordinates||f.reverse(),P.types&&P.types[0],P=Zh(P,{query:f,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(d){d in P&&delete P[d]})}break;case uh.FORWARD:/^[ ]*(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)*[ ]*$/.test(a)&&(a=a.replace(/,/g," ")),P=Zh(P,{query:a});break}return P},_geocode:function(c){this.inputString=c,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:c});const a=this._requestType(this.options,c),l=this._setupConfig(a,c);var x;switch(a){case uh.LOCAL:x=Promise.resolve();break;case uh.FORWARD:x=this.geocoderService.forwardGeocode(l).send();break;case uh.REVERSE:x=this.geocoderService.reverseGeocode(l).send();break}var T=this.options.localGeocoder?this.options.localGeocoder(c)||[]:[],P=[],f=null;return x.catch(function(d){f=d}.bind(this)).then(function(d){this._hideLoadingIcon();var R={};return d?d.statusCode=="200"&&(R=d.body,R.request=d.request,R.headers=d.headers):R={type:"FeatureCollection",features:[]},R.config=l,this.fresh&&(this.eventManager.start(this),this.fresh=!1),R.features=R.features?T.concat(R.features):T,this.options.externalGeocoder?(P=this.options.externalGeocoder(c,R.features)||Promise.resolve([]),P.then(function(q){return R.features=R.features?q.concat(R.features):q,R},function(){return R})):R}.bind(this)).then(function(d){if(f)throw f;this.options.filter&&d.features.length&&(d.features=d.features.filter(this.options.filter)),d.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",d),this._typeahead.update(d.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",d))}.bind(this)).catch(function(d){this._hideLoadingIcon(),this._hideAttribution(),T.length&&this.options.localGeocoder||P.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(T)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:T}),this._eventEmitter.emit("error",{error:d})}.bind(this)),x},_clear:function(c){c&&c.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(c){this._clear(c),this._inputEl.focus()},_clearOnBlur:function(c){var a=this;c.relatedTarget&&a._clear(c)},_onQueryResult:function(c){var a=c.body;if(!!a.features.length){var l=a.features[0];this._typeahead.selected=l,this._inputEl.value=l.place_name,this._onChange()}},_updateProximity:function(){if(!(!this._map||!this.options.trackProximity))if(this._map.getZoom()>9){var c=this._map.getCenter().wrap();this.setProximity({longitude:c.lng,latitude:c.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(c){return this._geocode(c).then(this._onQueryResult),this},_renderError:function(){var c="<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(c)},_renderLocationError:function(){var c="<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>";this._renderMessage(c)},_renderNoResults:function(){var c="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>";this._renderMessage(c)},_renderUserDeniedGeolocationError:function(){var c="<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>";this._renderMessage(c)},_renderMessage:function(c){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(c)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var c=this.options.language.split(",")[0],a=dS.language(c),l=pS.placeholder[a];if(l)return l}return"Search"},setInput:function(c){return this._inputEl.value=c,this._typeahead.selected=null,this._typeahead.clear(),c.length>=this.options.minLength&&this._geocode(c),this},setProximity:function(c,a=!0){return this.options.proximity=c,a&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(c){return c&&typeof c=="function"&&(this._typeahead.render=c),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(c){var a=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=c||this.options.language||a,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(c){return this.options.zoom=c,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(c){return this.options.flyTo=c,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(c){return this.placeholder=c||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(c){return this.options.bbox=c,this},getCountries:function(){return this.options.countries},setCountries:function(c){return this.options.countries=c,this},getTypes:function(){return this.options.types},setTypes:function(c){return this.options.types=c,this},getMinLength:function(){return this.options.minLength},setMinLength:function(c){return this.options.minLength=c,this._typeahead&&(this._typeahead.options.minLength=c),this},getLimit:function(){return this.options.limit},setLimit:function(c){return this.options.limit=c,this._typeahead&&(this._typeahead.options.limit=c),this},getFilter:function(){return this.options.filter},setFilter:function(c){return this.options.filter=c,this},setOrigin:function(c){return this.options.origin=c,this.geocoderService=Ay(Ty({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(c){return this.options.accessToken=c,this.geocoderService=Ay(Ty({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(c){return this.options.autocomplete=c,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(c){return this.options.fuzzyMatch=c,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(c){return this.options.routing=c,this},getRouting:function(){return this.options.routing},setWorldview:function(c){return this.options.worldview=c,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(c){if(!!this._map){this._removeMarker();var a={color:"#4668F2"},l=Zh({},a,this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(l),c.center?this.mapMarker.setLngLat(c.center).addTo(this._map):c.geometry&&c.geometry.type&&c.geometry.type==="Point"&&c.geometry.coordinates&&this.mapMarker.setLngLat(c.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(c,a){return this._eventEmitter.on(c,a),this},off:function(c,a){return this._eventEmitter.removeListener(c,a),this.eventManager.remove(),this}};var gS=_0,v0={};Object.defineProperty(v0,"__esModule",{value:!0});class dh{constructor(a,l){this.areas=a||dh.DEFAULT_AREAS,this.limit_no_areas=l||dh.DEFAULT_NO_AREAS,this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}onAdd(a){this.map=a;const l=this;if(this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.areas.length<=this.limit_no_areas){this.mapAreaContainer=document.createElement("div"),this.areaButton=document.createElement("button"),this.mapAreaContainer.classList.add("mapboxgl-area-list");for(const x of this.areas){const T=document.createElement("button");T.innerText=x.title,T.classList.add(x.title.replace(/[^a-z0-9-]/gi,"_")),T.value=JSON.stringify({center:x.latlng,zoom:x.zoom}),T.addEventListener("click",P=>{const f=P.srcElement;this.map.jumpTo(JSON.parse(f.value)),this.mapAreaContainer.style.display="none",this.areaButton.style.display="block";const d=this.mapAreaContainer.getElementsByClassName("active");for(;d[0];)d[0].classList.remove("active");f.classList.add("active")}),x.title===dh.DEFAULT_AREA&&T.classList.add("active"),this.mapAreaContainer.appendChild(T)}this.areaButton.classList.add("mapboxgl-ctrl-icon"),this.areaButton.classList.add("mapboxgl-area-switcher"),this.areaButton.addEventListener("click",()=>{this.areaButton.style.display="none",this.mapAreaContainer.style.display="block"}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.areaButton),this.controlContainer.appendChild(this.mapAreaContainer)}else this.controlContainer.classList.add("mapboxgl-ctrl-area-switch"),this.select=document.createElement("select"),this.select.setAttribute("type","select"),this.select.addEventListener("change",function(x){!x.target||l.map.flyTo(JSON.parse(x.target[this.selectedIndex].value))}),this.controlContainer.appendChild(this.select),this.areas.forEach(function(x){var T=document.createElement("option");T.setAttribute("type","option"),T.text=x.title,T.value=JSON.stringify({center:x.latlng,zoom:x.zoom}),l.select.appendChild(T)});return this.controlContainer}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.areaButton||(this.areaButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.map=void 0)}onDocumentClick(a){this.controlContainer&&!this.controlContainer.contains(a.target)&&this.mapAreaContainer&&this.areaButton&&(this.mapAreaContainer.style.display="none",this.areaButton.style.display="block")}}var _S=v0.default=dh;dh.DEFAULT_AREA="Narok";dh.DEFAULT_AREAS=[{title:"Narok",latlng:[35.86974,-1.08707],zoom:13},{title:"Nairobi",latlng:[36.8034,-1.2809],zoom:11},{title:"Mombasa",latlng:[39.65449,-4.05099],zoom:12}];dh.DEFAULT_NO_AREAS=5;var x0={},wg={exports:{}};(function(c,a){(function(l,x){c.exports=x()})(Ll,function(){var l,x,T;function P(f,d){if(!l)l=d;else if(!x)x=d;else{var R="var sharedChunk = {}; ("+l+")(sharedChunk); ("+x+")(sharedChunk);",q={};l(q),T=d(q),typeof window!="undefined"&&(T.workerUrl=window.URL.createObjectURL(new Blob([R],{type:"text/javascript"})))}}return P(["exports"],function(f){function d(e,r){return e(r={exports:{}},r.exports),r.exports}var R=q;function q(e,r,s,_){this.cx=3*e,this.bx=3*(s-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(_-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=_,this.p2x=s,this.p2y=_}q.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},q.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},q.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},q.prototype.solveCurveX=function(e,r){var s,_,w,C,i;for(r===void 0&&(r=1e-6),w=e,i=0;i<8;i++){if(C=this.sampleCurveX(w)-e,Math.abs(C)<r)return w;var t=this.sampleCurveDerivativeX(w);if(Math.abs(t)<1e-6)break;w-=C/t}if((w=e)<(s=0))return s;if(w>(_=1))return _;for(;s<_;){if(C=this.sampleCurveX(w),Math.abs(C-e)<r)return w;e>C?s=w:_=w,w=.5*(_-s)+s}return w},q.prototype.solve=function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))};var V=G;function G(e,r){this.x=e,this.y=r}G.prototype={clone:function(){return new G(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,r){return this.clone()._rotateAround(e,r)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var r=e.x-this.x,s=e.y-this.y;return r*r+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,r){return Math.atan2(this.x*r-this.y*e,this.x*e+this.y*r)},_matMult:function(e){var r=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var r=Math.cos(e),s=Math.sin(e),_=s*this.x+r*this.y;return this.x=r*this.x-s*this.y,this.y=_,this},_rotateAround:function(e,r){var s=Math.cos(e),_=Math.sin(e),w=r.y+_*(this.x-r.x)+s*(this.y-r.y);return this.x=r.x+s*(this.x-r.x)-_*(this.y-r.y),this.y=w,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},G.convert=function(e){return e instanceof G?e:Array.isArray(e)?new G(e[0],e[1]):e};var X=typeof self!="undefined"?self:{},Me=Math.pow(2,53)-1;function ke(e,r,s,_){var w=new R(e,r,s,_);return function(C){return w.solve(C)}}var qe=ke(.25,.1,.25,1);function We(e,r,s){return Math.min(s,Math.max(r,e))}function ft(e,r,s){var _=s-r,w=((e-r)%_+_)%_+r;return w===r?s:w}function Ge(e){for(var r=[],s=arguments.length-1;s-- >0;)r[s]=arguments[s+1];for(var _=0,w=r;_<w.length;_+=1){var C=w[_];for(var i in C)e[i]=C[i]}return e}var Ze=1;function gt(){return Ze++}function ct(){return function e(r){return r?(r^16*Math.random()>>r/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function pt(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function lt(e,r){e.forEach(function(s){r[s]&&(r[s]=r[s].bind(r))})}function pi(e,r){return e.indexOf(r,e.length-r.length)!==-1}function Et(e,r,s){var _={};for(var w in e)_[w]=r.call(s||this,e[w],w,e);return _}function Wt(e,r,s){var _={};for(var w in e)r.call(s||this,e[w],w,e)&&(_[w]=e[w]);return _}function vi(e){return Array.isArray(e)?e.map(vi):typeof e=="object"&&e?Et(e,vi):e}var qi={};function Xt(e){qi[e]||(typeof console!="undefined"&&console.warn(e),qi[e]=!0)}function Qt(e,r,s){return(s.y-e.y)*(r.x-e.x)>(r.y-e.y)*(s.x-e.x)}function Ei(e){for(var r=0,s=0,_=e.length,w=_-1,C=void 0,i=void 0;s<_;w=s++)r+=((i=e[w]).x-(C=e[s]).x)*(C.y+i.y);return r}function bt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Gi(e){var r={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(_,w,C,i){var t=C||i;return r[w]=!t||t.toLowerCase(),""}),r["max-age"]){var s=parseInt(r["max-age"],10);isNaN(s)?delete r["max-age"]:r["max-age"]=s}return r}var hr=null;function wr(e){if(hr==null){var r=e.navigator?e.navigator.userAgent:null;hr=!!e.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return hr}function Dt(e){try{var r=X[e];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}}var oi,fi,Bi,Nt,Xi=X.performance&&X.performance.now?X.performance.now.bind(X.performance):Date.now.bind(Date),Li=X.requestAnimationFrame||X.mozRequestAnimationFrame||X.webkitRequestAnimationFrame||X.msRequestAnimationFrame,xi=X.cancelAnimationFrame||X.mozCancelAnimationFrame||X.webkitCancelAnimationFrame||X.msCancelAnimationFrame,rr={now:Xi,frame:function(e){var r=Li(e);return{cancel:function(){return xi(r)}}},getImageData:function(e,r){r===void 0&&(r=0);var s=X.document.createElement("canvas"),_=s.getContext("2d");if(!_)throw new Error("failed to create canvas 2d context");return s.width=e.width,s.height=e.height,_.drawImage(e,0,0,e.width,e.height),_.getImageData(-r,-r,e.width+2*r,e.height+2*r)},resolveURL:function(e){return oi||(oi=X.document.createElement("a")),oi.href=e,oi.href},hardwareConcurrency:X.navigator&&X.navigator.hardwareConcurrency||4,get devicePixelRatio(){return X.devicePixelRatio},get prefersReducedMotion(){return!!X.matchMedia&&(fi==null&&(fi=X.matchMedia("(prefers-reduced-motion: reduce)")),fi.matches)}},Ti={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},zt={supported:!1,testSupport:function(e){!tr&&Nt&&(Rt?rt(e):Bi=e)}},tr=!1,Rt=!1;function rt(e){var r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Nt),e.isContextLost())return;zt.supported=!0}catch{}e.deleteTexture(r),tr=!0}X.document&&((Nt=X.document.createElement("img")).onload=function(){Bi&&rt(Bi),Bi=null,Rt=!0},Nt.onerror=function(){tr=!0,Bi=null},Nt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var yi="01",ir=function(e,r){this._transformRequestFn=e,this._customAccessToken=r,this._createSkuToken()};function Cr(e){return e.indexOf("mapbox:")===0}ir.prototype._createSkuToken=function(){var e=function(){for(var r="",s=0;s<10;s++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",yi,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},ir.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ir.prototype.transformRequest=function(e,r){return this._transformRequestFn&&this._transformRequestFn(e,r)||{url:e}},ir.prototype.normalizeStyleURL=function(e,r){if(!Cr(e))return e;var s=fn(e);return s.path="/styles/v1"+s.path,this._makeAPIURL(s,this._customAccessToken||r)},ir.prototype.normalizeGlyphsURL=function(e,r){if(!Cr(e))return e;var s=fn(e);return s.path="/fonts/v1"+s.path,this._makeAPIURL(s,this._customAccessToken||r)},ir.prototype.normalizeSourceURL=function(e,r){if(!Cr(e))return e;var s=fn(e);return s.path="/v4/"+s.authority+".json",s.params.push("secure"),this._makeAPIURL(s,this._customAccessToken||r)},ir.prototype.normalizeSpriteURL=function(e,r,s,_){var w=fn(e);return Cr(e)?(w.path="/styles/v1"+w.path+"/sprite"+r+s,this._makeAPIURL(w,this._customAccessToken||_)):(w.path+=""+r+s,oo(w))},ir.prototype.normalizeTileURL=function(e,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Cr(e))return e;var s=fn(e);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,(rr.devicePixelRatio>=2||r===512?"@2x":"")+(zt.supported?".webp":"$1")),s.path=s.path.replace(/^.+\/v4\//,"/"),s.path="/v4"+s.path;var _=this._customAccessToken||function(w){for(var C=0,i=w;C<i.length;C+=1){var t=i[C].match(/^access_token=(.*)$/);if(t)return t[1]}return null}(s.params)||Ti.ACCESS_TOKEN;return Ti.REQUIRE_ACCESS_TOKEN&&_&&this._skuToken&&s.params.push("sku="+this._skuToken),this._makeAPIURL(s,_)},ir.prototype.canonicalizeTileURL=function(e,r){var s=fn(e);if(!s.path.match(/(^\/v4\/)/)||!s.path.match(/\.[\w]+$/))return e;var _="mapbox://tiles/";_+=s.path.replace("/v4/","");var w=s.params;return r&&(w=w.filter(function(C){return!C.match(/^access_token=/)})),w.length&&(_+="?"+w.join("&")),_},ir.prototype.canonicalizeTileset=function(e,r){for(var s=!!r&&Cr(r),_=[],w=0,C=e.tiles||[];w<C.length;w+=1){var i=C[w];qn(i)?_.push(this.canonicalizeTileURL(i,s)):_.push(i)}return _},ir.prototype._makeAPIURL=function(e,r){var s="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",_=fn(Ti.API_URL);if(e.protocol=_.protocol,e.authority=_.authority,e.protocol==="http"){var w=e.params.indexOf("secure");w>=0&&e.params.splice(w,1)}if(_.path!=="/"&&(e.path=""+_.path+e.path),!Ti.REQUIRE_ACCESS_TOKEN)return oo(e);if(!(r=r||Ti.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+s);if(r[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+s);return e.params=e.params.filter(function(C){return C.indexOf("access_token")===-1}),e.params.push("access_token="+r),oo(e)};var no=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function qn(e){return no.test(e)}var Mo=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function fn(e){var r=e.match(Mo);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function oo(e){var r=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+r}function Gn(e){if(!e)return null;var r=e.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(decodeURIComponent(X.atob(r[1]).split("").map(function(s){return"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Zi=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Zi.prototype.getStorageKey=function(e){var r,s=Gn(Ti.ACCESS_TOKEN);return r=s&&s.u?X.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,function(_,w){return String.fromCharCode(Number("0x"+w))})):Ti.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+r:"mapbox.eventData:"+r},Zi.prototype.fetchEventData=function(){var e=Dt("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{var _=X.localStorage.getItem(r);_&&(this.eventData=JSON.parse(_));var w=X.localStorage.getItem(s);w&&(this.anonId=w)}catch{Xt("Unable to read from LocalStorage")}},Zi.prototype.saveEventData=function(){var e=Dt("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{X.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&X.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{Xt("Unable to write to LocalStorage")}},Zi.prototype.processRequests=function(e){},Zi.prototype.postEvent=function(e,r,s,_){var w=this;if(Ti.EVENTS_URL){var C=fn(Ti.EVENTS_URL);C.params.push("access_token="+(_||Ti.ACCESS_TOKEN||""));var i={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:yi,userId:this.anonId},t=r?Ge(i,r):i,o={url:oo(C),headers:{"Content-Type":"text/plain"},body:JSON.stringify([t])};this.pendingRequest=Nr(o,function(h){w.pendingRequest=null,s(h),w.saveEventData(),w.processRequests(_)})}},Zi.prototype.queueRequest=function(e,r){this.queue.push(e),this.processRequests(r)};var Fn,_o,Zn=function(e){function r(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.postMapLoadEvent=function(s,_,w,C){this.skuToken=w,(Ti.EVENTS_URL&&C||Ti.ACCESS_TOKEN&&Array.isArray(s)&&s.some(function(i){return Cr(i)||qn(i)}))&&this.queueRequest({id:_,timestamp:Date.now()},C)},r.prototype.processRequests=function(s){var _=this;if(!this.pendingRequest&&this.queue.length!==0){var w=this.queue.shift(),C=w.id,i=w.timestamp;C&&this.success[C]||(this.anonId||this.fetchEventData(),pt(this.anonId)||(this.anonId=ct()),this.postEvent(i,{skuToken:this.skuToken},function(t){t||C&&(_.success[C]=!0)},s))}},r}(Zi),Ra=new(function(e){function r(s){e.call(this,"appUserTurnstile"),this._customAccessToken=s}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.postTurnstileEvent=function(s,_){Ti.EVENTS_URL&&Ti.ACCESS_TOKEN&&Array.isArray(s)&&s.some(function(w){return Cr(w)||qn(w)})&&this.queueRequest(Date.now(),_)},r.prototype.processRequests=function(s){var _=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var w=Gn(Ti.ACCESS_TOKEN),C=w?w.u:Ti.ACCESS_TOKEN,i=C!==this.eventData.tokenU;pt(this.anonId)||(this.anonId=ct(),i=!0);var t=this.queue.shift();if(this.eventData.lastSuccess){var o=new Date(this.eventData.lastSuccess),h=new Date(t),g=(t-this.eventData.lastSuccess)/864e5;i=i||g>=1||g<-1||o.getDate()!==h.getDate()}else i=!0;if(!i)return this.processRequests();this.postEvent(t,{"enabled.telemetry":!1},function(b){b||(_.eventData.lastSuccess=t,_.eventData.tokenU=C)},s)}},r}(Zi)),Ue=Ra.postTurnstileEvent.bind(Ra),_t=new Zn,bi=_t.postMapLoadEvent.bind(_t),pr=500,mr=50;function Hn(){X.caches&&!Fn&&(Fn=X.caches.open("mapbox-tiles"))}function Wn(e){var r=e.indexOf("?");return r<0?e:e.slice(0,r)}var ea,Gr=1/0;function Ht(){return ea==null&&(ea=X.OffscreenCanvas&&new X.OffscreenCanvas(1,1).getContext("2d")&&typeof X.createImageBitmap=="function"),ea}var nr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(nr);var Ki=function(e){function r(s,_,w){_===401&&qn(w)&&(s+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,s),this.status=_,this.url=w,this.name=this.constructor.name,this.message=s}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},r}(Error),zn=bt()?function(){return self.worker&&self.worker.referrer}:function(){return(X.location.protocol==="blob:"?X.parent:X).location.href},Xn,Ni,fa=function(e,r){if(!(/^file:/.test(s=e.url)||/^file:/.test(zn())&&!/^\w+:/.test(s))){if(X.fetch&&X.Request&&X.AbortController&&X.Request.prototype.hasOwnProperty("signal"))return function(_,w){var C,i=new X.AbortController,t=new X.Request(_.url,{method:_.method||"GET",body:_.body,credentials:_.credentials,headers:_.headers,referrer:zn(),signal:i.signal}),o=!1,h=!1,g=(C=t.url).indexOf("sku=")>0&&qn(C);_.type==="json"&&t.headers.set("Accept","application/json");var b=function(z,D,O){if(!h){if(z&&z.message!=="SecurityError"&&Xt(z),D&&O)return E(D);var N=Date.now();X.fetch(t).then(function(U){if(U.ok){var K=g?U.clone():null;return E(U,K,N)}return w(new Ki(U.statusText,U.status,_.url))}).catch(function(U){U.code!==20&&w(new Error(U.message))})}},E=function(z,D,O){(_.type==="arrayBuffer"?z.arrayBuffer():_.type==="json"?z.json():z.text()).then(function(N){h||(D&&O&&function(U,K,$){if(Hn(),Fn){var Q={status:K.status,statusText:K.statusText,headers:new X.Headers};K.headers.forEach(function(pe,Ae){return Q.headers.set(Ae,pe)});var se=Gi(K.headers.get("Cache-Control")||"");se["no-store"]||(se["max-age"]&&Q.headers.set("Expires",new Date($+1e3*se["max-age"]).toUTCString()),new Date(Q.headers.get("Expires")).getTime()-$<42e4||function(pe,Ae){if(_o===void 0)try{new Response(new ReadableStream),_o=!0}catch{_o=!1}_o?Ae(pe.body):pe.blob().then(Ae)}(K,function(pe){var Ae=new X.Response(pe,Q);Hn(),Fn&&Fn.then(function(Be){return Be.put(Wn(U.url),Ae)}).catch(function(Be){return Xt(Be.message)})}))}}(t,D,O),o=!0,w(null,N,z.headers.get("Cache-Control"),z.headers.get("Expires")))}).catch(function(N){h||w(new Error(N.message))})};return g?function(z,D){if(Hn(),!Fn)return D(null);var O=Wn(z.url);Fn.then(function(N){N.match(O).then(function(U){var K=function($){if(!$)return!1;var Q=new Date($.headers.get("Expires")||0),se=Gi($.headers.get("Cache-Control")||"");return Q>Date.now()&&!se["no-cache"]}(U);N.delete(O),K&&N.put(O,U.clone()),D(null,U,K)}).catch(D)}).catch(D)}(t,b):b(null,null),{cancel:function(){h=!0,o||i.abort()}}}(e,r);if(bt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,r,void 0,!0)}var s;return function(_,w){var C=new X.XMLHttpRequest;for(var i in C.open(_.method||"GET",_.url,!0),_.type==="arrayBuffer"&&(C.responseType="arraybuffer"),_.headers)C.setRequestHeader(i,_.headers[i]);return _.type==="json"&&(C.responseType="text",C.setRequestHeader("Accept","application/json")),C.withCredentials=_.credentials==="include",C.onerror=function(){w(new Error(C.statusText))},C.onload=function(){if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){var t=C.response;if(_.type==="json")try{t=JSON.parse(C.response)}catch(o){return w(o)}w(null,t,C.getResponseHeader("Cache-Control"),C.getResponseHeader("Expires"))}else w(new Ki(C.statusText,C.status,_.url))},C.send(_.body),{cancel:function(){return C.abort()}}}(e,r)},Lo=function(e,r){return fa(Ge(e,{type:"arrayBuffer"}),r)},Nr=function(e,r){return fa(Ge(e,{method:"POST"}),r)},te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Xn=[],Ni=0;var oe=function(e,r){if(zt.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),Ni>=Ti.MAX_PARALLEL_IMAGE_REQUESTS){var s={requestParameters:e,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return Xn.push(s),s}Ni++;var _=!1,w=function(){if(!_)for(_=!0,Ni--;Xn.length&&Ni<Ti.MAX_PARALLEL_IMAGE_REQUESTS;){var i=Xn.shift();i.cancelled||(i.cancel=oe(i.requestParameters,i.callback).cancel)}},C=Lo(e,function(i,t,o,h){w(),i?r(i):t&&(Ht()?function(g,b){var E=new X.Blob([new Uint8Array(g)],{type:"image/png"});X.createImageBitmap(E).then(function(z){b(null,z)}).catch(function(z){b(new Error("Could not load image because of "+z.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(t,r):function(g,b,E,z){var D=new X.Image,O=X.URL;D.onload=function(){b(null,D),O.revokeObjectURL(D.src),D.onload=null,X.requestAnimationFrame(function(){D.src=te})},D.onerror=function(){return b(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var N=new X.Blob([new Uint8Array(g)],{type:"image/png"});D.cacheControl=E,D.expires=z,D.src=g.byteLength?O.createObjectURL(N):te}(t,r,o,h))});return{cancel:function(){C.cancel(),w()}}};function le(e,r,s){s[e]&&s[e].indexOf(r)!==-1||(s[e]=s[e]||[],s[e].push(r))}function ge(e,r,s){if(s&&s[e]){var _=s[e].indexOf(r);_!==-1&&s[e].splice(_,1)}}var Se=function(e,r){r===void 0&&(r={}),Ge(this,r),this.type=e},Oe=function(e){function r(s,_){_===void 0&&(_={}),e.call(this,"error",Ge({error:s},_))}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r}(Se),Ne=function(){};Ne.prototype.on=function(e,r){return this._listeners=this._listeners||{},le(e,r,this._listeners),this},Ne.prototype.off=function(e,r){return ge(e,r,this._listeners),ge(e,r,this._oneTimeListeners),this},Ne.prototype.once=function(e,r){return this._oneTimeListeners=this._oneTimeListeners||{},le(e,r,this._oneTimeListeners),this},Ne.prototype.fire=function(e,r){typeof e=="string"&&(e=new Se(e,r||{}));var s=e.type;if(this.listens(s)){e.target=this;for(var _=0,w=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];_<w.length;_+=1)w[_].call(this,e);for(var C=0,i=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];C<i.length;C+=1){var t=i[C];ge(s,t,this._oneTimeListeners),t.call(this,e)}var o=this._eventedParent;o&&(Ge(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),o.fire(e))}else e instanceof Oe&&console.error(e.error);return this},Ne.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Ne.prototype.setEventedParent=function(e,r){return this._eventedParent=e,this._eventedParentData=r,this};var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Pe=function(e,r,s,_){this.message=(e?e+": ":"")+s,_&&(this.identifier=_),r!=null&&r.__line__&&(this.line=r.__line__)};function Qe(e){var r=e.value;return r?[new Pe(e.key,r,"constants have been deprecated as of v8")]:[]}function ae(e){for(var r=[],s=arguments.length-1;s-- >0;)r[s]=arguments[s+1];for(var _=0,w=r;_<w.length;_+=1){var C=w[_];for(var i in C)e[i]=C[i]}return e}function H(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function W(e){if(Array.isArray(e))return e.map(W);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var r={};for(var s in e)r[s]=W(e[s]);return r}return H(e)}var ne=function(e){function r(s,_){e.call(this,_),this.message=_,this.key=s}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r}(Error),ce=function(e,r){r===void 0&&(r=[]),this.parent=e,this.bindings={};for(var s=0,_=r;s<_.length;s+=1){var w=_[s];this.bindings[w[0]]=w[1]}};ce.prototype.concat=function(e){return new ce(this,e)},ce.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},ce.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var _e={kind:"null"},fe={kind:"number"},Ee={kind:"string"},we={kind:"boolean"},Ie={kind:"color"},et={kind:"object"},Ke={kind:"value"},tt={kind:"collator"},Ft={kind:"formatted"},At={kind:"resolvedImage"};function Bt(e,r){return{kind:"array",itemType:e,N:r}}function jt(e){if(e.kind==="array"){var r=jt(e.itemType);return typeof e.N=="number"?"array<"+r+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+r+">"}return e.kind}var Hi=[_e,fe,Ee,we,Ie,Ft,et,Bt(Ke),At];function mi(e,r){if(r.kind==="error")return null;if(e.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!mi(e.itemType,r.itemType))&&(typeof e.N!="number"||e.N===r.N))return null}else{if(e.kind===r.kind)return null;if(e.kind==="value"){for(var s=0,_=Hi;s<_.length;s+=1)if(!mi(_[s],r))return null}}return"Expected "+jt(e)+" but found "+jt(r)+" instead."}function Ii(e,r){return r.some(function(s){return s.kind===e.kind})}function li(e,r){return r.some(function(s){return s==="null"?e===null:s==="array"?Array.isArray(e):s==="object"?e&&!Array.isArray(e)&&typeof e=="object":s===typeof e})}var Kt=d(function(e,r){var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function _(t){return(t=Math.round(t))<0?0:t>255?255:t}function w(t){return _(t[t.length-1]==="%"?parseFloat(t)/100*255:parseInt(t))}function C(t){return(o=t[t.length-1]==="%"?parseFloat(t)/100:parseFloat(t))<0?0:o>1?1:o;var o}function i(t,o,h){return h<0?h+=1:h>1&&(h-=1),6*h<1?t+(o-t)*h*6:2*h<1?o:3*h<2?t+(o-t)*(2/3-h)*6:t}try{r.parseCSSColor=function(t){var o,h=t.replace(/ /g,"").toLowerCase();if(h in s)return s[h].slice();if(h[0]==="#")return h.length===4?(o=parseInt(h.substr(1),16))>=0&&o<=4095?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null:h.length===7&&(o=parseInt(h.substr(1),16))>=0&&o<=16777215?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null;var g=h.indexOf("("),b=h.indexOf(")");if(g!==-1&&b+1===h.length){var E=h.substr(0,g),z=h.substr(g+1,b-(g+1)).split(","),D=1;switch(E){case"rgba":if(z.length!==4)return null;D=C(z.pop());case"rgb":return z.length!==3?null:[w(z[0]),w(z[1]),w(z[2]),D];case"hsla":if(z.length!==4)return null;D=C(z.pop());case"hsl":if(z.length!==3)return null;var O=(parseFloat(z[0])%360+360)%360/360,N=C(z[1]),U=C(z[2]),K=U<=.5?U*(N+1):U+N-U*N,$=2*U-K;return[_(255*i($,K,O+1/3)),_(255*i($,K,O)),_(255*i($,K,O-1/3)),D];default:return null}}return null}}catch{}}).parseCSSColor,Pi=function(e,r,s,_){_===void 0&&(_=1),this.r=e,this.g=r,this.b=s,this.a=_};Pi.parse=function(e){if(e){if(e instanceof Pi)return e;if(typeof e=="string"){var r=Kt(e);if(r)return new Pi(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3])}}},Pi.prototype.toString=function(){var e=this.toArray(),r=e[1],s=e[2],_=e[3];return"rgba("+Math.round(e[0])+","+Math.round(r)+","+Math.round(s)+","+_+")"},Pi.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Pi.black=new Pi(0,0,0,1),Pi.white=new Pi(1,1,1,1),Pi.transparent=new Pi(0,0,0,0),Pi.red=new Pi(1,0,0,1);var _r=function(e,r,s){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};_r.prototype.compare=function(e,r){return this.collator.compare(e,r)},_r.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Sn=function(e,r,s,_,w){this.text=e,this.image=r,this.scale=s,this.fontStack=_,this.textColor=w},Er=function(e){this.sections=e};Er.fromString=function(e){return new Er([new Sn(e,null,null,null,null)])},Er.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Er.factory=function(e){return e instanceof Er?e:Er.fromString(e)},Er.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Er.prototype.serialize=function(){for(var e=["format"],r=0,s=this.sections;r<s.length;r+=1){var _=s[r];if(_.image)e.push(["image",_.image.name]);else{e.push(_.text);var w={};_.fontStack&&(w["text-font"]=["literal",_.fontStack.split(",")]),_.scale&&(w["font-scale"]=_.scale),_.textColor&&(w["text-color"]=["rgba"].concat(_.textColor.toArray())),e.push(w)}}return e};var po=function(e){this.name=e.name,this.available=e.available};function Rl(e,r,s,_){return typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof s=="number"&&s>=0&&s<=255?_===void 0||typeof _=="number"&&_>=0&&_<=1?null:"Invalid rgba value ["+[e,r,s,_].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof _=="number"?[e,r,s,_]:[e,r,s]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Rr(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof Pi||e instanceof _r||e instanceof Er||e instanceof po)return!0;if(Array.isArray(e)){for(var r=0,s=e;r<s.length;r+=1)if(!Rr(s[r]))return!1;return!0}if(typeof e=="object"){for(var _ in e)if(!Rr(e[_]))return!1;return!0}return!1}function vn(e){if(e===null)return _e;if(typeof e=="string")return Ee;if(typeof e=="boolean")return we;if(typeof e=="number")return fe;if(e instanceof Pi)return Ie;if(e instanceof _r)return tt;if(e instanceof Er)return Ft;if(e instanceof po)return At;if(Array.isArray(e)){for(var r,s=e.length,_=0,w=e;_<w.length;_+=1){var C=vn(w[_]);if(r){if(r===C)continue;r=Ke;break}r=C}return Bt(r||Ke,s)}return et}function Vs(e){var r=typeof e;return e===null?"":r==="string"||r==="number"||r==="boolean"?String(e):e instanceof Pi||e instanceof Er||e instanceof po?e.toString():JSON.stringify(e)}po.prototype.toString=function(){return this.name},po.fromString=function(e){return e?new po({name:e,available:!1}):null},po.prototype.serialize=function(){return["image",this.name]};var vo=function(e,r){this.type=e,this.value=r};vo.parse=function(e,r){if(e.length!==2)return r.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Rr(e[1]))return r.error("invalid value");var s=e[1],_=vn(s),w=r.expectedType;return _.kind!=="array"||_.N!==0||!w||w.kind!=="array"||typeof w.N=="number"&&w.N!==0||(_=w),new vo(_,s)},vo.prototype.evaluate=function(){return this.value},vo.prototype.eachChild=function(){},vo.prototype.outputDefined=function(){return!0},vo.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Pi?["rgba"].concat(this.value.toArray()):this.value instanceof Er?this.value.serialize():this.value};var Pn=function(e){this.name="ExpressionEvaluationError",this.message=e};Pn.prototype.toJSON=function(){return this.message};var ta={string:Ee,number:fe,boolean:we,object:et},Wr=function(e,r){this.type=e,this.args=r};Wr.parse=function(e,r){if(e.length<2)return r.error("Expected at least one argument.");var s,_=1,w=e[0];if(w==="array"){var C,i;if(e.length>2){var t=e[1];if(typeof t!="string"||!(t in ta)||t==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);C=ta[t],_++}else C=Ke;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);i=e[2],_++}s=Bt(C,i)}else s=ta[w];for(var o=[];_<e.length;_++){var h=r.parse(e[_],_,Ke);if(!h)return null;o.push(h)}return new Wr(s,o)},Wr.prototype.evaluate=function(e){for(var r=0;r<this.args.length;r++){var s=this.args[r].evaluate(e);if(!mi(this.type,vn(s)))return s;if(r===this.args.length-1)throw new Pn("Expected value to be of type "+jt(this.type)+", but found "+jt(vn(s))+" instead.")}return null},Wr.prototype.eachChild=function(e){this.args.forEach(e)},Wr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Wr.prototype.serialize=function(){var e=this.type,r=[e.kind];if(e.kind==="array"){var s=e.itemType;if(s.kind==="string"||s.kind==="number"||s.kind==="boolean"){r.push(s.kind);var _=e.N;(typeof _=="number"||this.args.length>1)&&r.push(_)}}return r.concat(this.args.map(function(w){return w.serialize()}))};var ia=function(e){this.type=Ft,this.sections=e};ia.parse=function(e,r){if(e.length<2)return r.error("Expected at least one argument.");var s=e[1];if(!Array.isArray(s)&&typeof s=="object")return r.error("First argument must be an image or text section.");for(var _=[],w=!1,C=1;C<=e.length-1;++C){var i=e[C];if(w&&typeof i=="object"&&!Array.isArray(i)){w=!1;var t=null;if(i["font-scale"]&&!(t=r.parse(i["font-scale"],1,fe)))return null;var o=null;if(i["text-font"]&&!(o=r.parse(i["text-font"],1,Bt(Ee))))return null;var h=null;if(i["text-color"]&&!(h=r.parse(i["text-color"],1,Ie)))return null;var g=_[_.length-1];g.scale=t,g.font=o,g.textColor=h}else{var b=r.parse(e[C],1,Ke);if(!b)return null;var E=b.type.kind;if(E!=="string"&&E!=="value"&&E!=="null"&&E!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");w=!0,_.push({content:b,scale:null,font:null,textColor:null})}}return new ia(_)},ia.prototype.evaluate=function(e){return new Er(this.sections.map(function(r){var s=r.content.evaluate(e);return vn(s)===At?new Sn("",s,null,null,null):new Sn(Vs(s),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))},ia.prototype.eachChild=function(e){for(var r=0,s=this.sections;r<s.length;r+=1){var _=s[r];e(_.content),_.scale&&e(_.scale),_.font&&e(_.font),_.textColor&&e(_.textColor)}},ia.prototype.outputDefined=function(){return!1},ia.prototype.serialize=function(){for(var e=["format"],r=0,s=this.sections;r<s.length;r+=1){var _=s[r];e.push(_.content.serialize());var w={};_.scale&&(w["font-scale"]=_.scale.serialize()),_.font&&(w["text-font"]=_.font.serialize()),_.textColor&&(w["text-color"]=_.textColor.serialize()),e.push(w)}return e};var Do=function(e){this.type=At,this.input=e};Do.parse=function(e,r){if(e.length!==2)return r.error("Expected two arguments.");var s=r.parse(e[1],1,Ee);return s?new Do(s):r.error("No image name provided.")},Do.prototype.evaluate=function(e){var r=this.input.evaluate(e),s=po.fromString(r);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(r)>-1),s},Do.prototype.eachChild=function(e){e(this.input)},Do.prototype.outputDefined=function(){return!1},Do.prototype.serialize=function(){return["image",this.input.serialize()]};var Yu={"to-boolean":we,"to-color":Ie,"to-number":fe,"to-string":Ee},ra=function(e,r){this.type=e,this.args=r};ra.parse=function(e,r){if(e.length<2)return r.error("Expected at least one argument.");var s=e[0];if((s==="to-boolean"||s==="to-string")&&e.length!==2)return r.error("Expected one argument.");for(var _=Yu[s],w=[],C=1;C<e.length;C++){var i=r.parse(e[C],C,Ke);if(!i)return null;w.push(i)}return new ra(_,w)},ra.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var r,s,_=0,w=this.args;_<w.length;_+=1){if(s=null,(r=w[_].evaluate(e))instanceof Pi)return r;if(typeof r=="string"){var C=e.parseColor(r);if(C)return C}else if(Array.isArray(r)&&!(s=r.length<3||r.length>4?"Invalid rbga value "+JSON.stringify(r)+": expected an array containing either three or four numeric values.":Rl(r[0],r[1],r[2],r[3])))return new Pi(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Pn(s||"Could not parse color from value '"+(typeof r=="string"?r:String(JSON.stringify(r)))+"'")}if(this.type.kind==="number"){for(var i=null,t=0,o=this.args;t<o.length;t+=1){if((i=o[t].evaluate(e))===null)return 0;var h=Number(i);if(!isNaN(h))return h}throw new Pn("Could not convert "+JSON.stringify(i)+" to number.")}return this.type.kind==="formatted"?Er.fromString(Vs(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?po.fromString(Vs(this.args[0].evaluate(e))):Vs(this.args[0].evaluate(e))},ra.prototype.eachChild=function(e){this.args.forEach(e)},ra.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},ra.prototype.serialize=function(){if(this.type.kind==="formatted")return new ia([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Do(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(r){e.push(r.serialize())}),e};var qs=["Unknown","Point","LineString","Polygon"],ma=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ma.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ma.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?qs[this.feature.type]:this.feature.type:null},ma.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ma.prototype.canonicalID=function(){return this.canonical},ma.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ma.prototype.parseColor=function(e){var r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=Pi.parse(e)),r};var xn=function(e,r,s,_){this.name=e,this.type=r,this._evaluate=s,this.args=_};xn.prototype.evaluate=function(e){return this._evaluate(e,this.args)},xn.prototype.eachChild=function(e){this.args.forEach(e)},xn.prototype.outputDefined=function(){return!1},xn.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},xn.parse=function(e,r){var s,_=e[0],w=xn.definitions[_];if(!w)return r.error('Unknown expression "'+_+'". If you wanted a literal array, use ["literal", [...]].',0);for(var C=Array.isArray(w)?w[0]:w.type,i=Array.isArray(w)?[[w[1],w[2]]]:w.overloads,t=i.filter(function(it){var He=it[0];return!Array.isArray(He)||He.length===e.length-1}),o=null,h=0,g=t;h<g.length;h+=1){var b=g[h],E=b[0],z=b[1];o=new bs(r.registry,r.path,null,r.scope);for(var D=[],O=!1,N=1;N<e.length;N++){var U=e[N],K=Array.isArray(E)?E[N-1]:E.type,$=o.parse(U,1+D.length,K);if(!$){O=!0;break}D.push($)}if(!O)if(Array.isArray(E)&&E.length!==D.length)o.error("Expected "+E.length+" arguments, but found "+D.length+" instead.");else{for(var Q=0;Q<D.length;Q++){var se=Array.isArray(E)?E[Q]:E.type,pe=D[Q];o.concat(Q+1).checkSubtype(se,pe.type)}if(o.errors.length===0)return new xn(_,C,z,D)}}if(t.length===1)(s=r.errors).push.apply(s,o.errors);else{for(var Ae=(t.length?t:i).map(function(it){var He;return He=it[0],Array.isArray(He)?"("+He.map(jt).join(", ")+")":"("+jt(He.type)+"...)"}).join(" | "),Be=[],je=1;je<e.length;je++){var Ve=r.parse(e[je],1+Be.length);if(!Ve)return null;Be.push(jt(Ve.type))}r.error("Expected arguments of type "+Ae+", but found ("+Be.join(", ")+") instead.")}return null},xn.register=function(e,r){for(var s in xn.definitions=r,r)e[s]=xn};var jo=function(e,r,s){this.type=tt,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=r};function Kn(e,r){e[0]=Math.min(e[0],r[0]),e[1]=Math.min(e[1],r[1]),e[2]=Math.max(e[2],r[0]),e[3]=Math.max(e[3],r[1])}function Ba(e,r){return!(e[0]<=r[0]||e[2]>=r[2]||e[1]<=r[1]||e[3]>=r[3])}function Bl(e,r){var s=(180+e[0])/360,_=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,w=Math.pow(2,r.z);return[Math.round(s*w*8192),Math.round(_*w*8192)]}function xu(e,r,s){return r[1]>e[1]!=s[1]>e[1]&&e[0]<(s[0]-r[0])*(e[1]-r[1])/(s[1]-r[1])+r[0]}function Gs(e,r){for(var s,_,w,C,i,t,o,h=!1,g=0,b=r.length;g<b;g++)for(var E=r[g],z=0,D=E.length;z<D-1;z++){if((C=(s=e)[0]-(_=E[z])[0])*(o=s[1]-(w=E[z+1])[1])-(t=s[0]-w[0])*(i=s[1]-_[1])==0&&C*t<=0&&i*o<=0)return!1;xu(e,E[z],E[z+1])&&(h=!h)}return h}function Un(e,r){for(var s=0;s<r.length;s++)if(Gs(e,r[s]))return!0;return!1}function dl(e,r,s,_){var w=_[0]-s[0],C=_[1]-s[1],i=(e[0]-s[0])*C-w*(e[1]-s[1]),t=(r[0]-s[0])*C-w*(r[1]-s[1]);return i>0&&t<0||i<0&&t>0}function $u(e,r,s){for(var _=0,w=s;_<w.length;_+=1)for(var C=w[_],i=0;i<C.length-1;++i)if((b=[(g=C[i+1])[0]-(h=C[i])[0],g[1]-h[1]])[0]*(E=[(o=r)[0]-(t=e)[0],o[1]-t[1]])[1]-b[1]*E[0]!=0&&dl(t,o,h,g)&&dl(h,g,t,o))return!0;var t,o,h,g,b,E;return!1}function Qu(e,r){for(var s=0;s<e.length;++s)if(!Gs(e[s],r))return!1;for(var _=0;_<e.length-1;++_)if($u(e[_],e[_+1],r))return!1;return!0}function ec(e,r){for(var s=0;s<r.length;s++)if(Qu(e,r[s]))return!0;return!1}function Qa(e,r,s){for(var _=[],w=0;w<e.length;w++){for(var C=[],i=0;i<e[w].length;i++){var t=Bl(e[w][i],s);Kn(r,t),C.push(t)}_.push(C)}return _}function Ol(e,r,s){for(var _=[],w=0;w<e.length;w++){var C=Qa(e[w],r,s);_.push(C)}return _}function Fl(e,r,s,_){if(e[0]<s[0]||e[0]>s[2]){var w=.5*_,C=e[0]-s[0]>w?-_:s[0]-e[0]>w?_:0;C===0&&(C=e[0]-s[2]>w?-_:s[2]-e[0]>w?_:0),e[0]+=C}Kn(r,e)}function Mc(e,r,s,_){for(var w=8192*Math.pow(2,_.z),C=[8192*_.x,8192*_.y],i=[],t=0,o=e;t<o.length;t+=1)for(var h=0,g=o[t];h<g.length;h+=1){var b=g[h],E=[b.x+C[0],b.y+C[1]];Fl(E,r,s,w),i.push(E)}return i}function fl(e,r,s,_){for(var w,C=8192*Math.pow(2,_.z),i=[8192*_.x,8192*_.y],t=[],o=0,h=e;o<h.length;o+=1){for(var g=[],b=0,E=h[o];b<E.length;b+=1){var z=E[b],D=[z.x+i[0],z.y+i[1]];Kn(r,D),g.push(D)}t.push(g)}if(r[2]-r[0]<=C/2){(w=r)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(var O=0,N=t;O<N.length;O+=1)for(var U=0,K=N[O];U<K.length;U+=1)Fl(K[U],r,s,C)}return t}jo.parse=function(e,r){if(e.length!==2)return r.error("Expected one argument.");var s=e[1];if(typeof s!="object"||Array.isArray(s))return r.error("Collator options argument must be an object.");var _=r.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,we);if(!_)return null;var w=r.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,we);if(!w)return null;var C=null;return s.locale&&!(C=r.parse(s.locale,1,Ee))?null:new jo(_,w,C)},jo.prototype.evaluate=function(e){return new _r(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},jo.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},jo.prototype.outputDefined=function(){return!1},jo.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Vo=function(e,r){this.type=we,this.geojson=e,this.geometries=r};function Oa(e){if(e instanceof xn&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Vo)return!1;var r=!0;return e.eachChild(function(s){r&&!Oa(s)&&(r=!1)}),r}function Fa(e){if(e instanceof xn&&e.name==="feature-state")return!1;var r=!0;return e.eachChild(function(s){r&&!Fa(s)&&(r=!1)}),r}function xs(e,r){if(e instanceof xn&&r.indexOf(e.name)>=0)return!1;var s=!0;return e.eachChild(function(_){s&&!xs(_,r)&&(s=!1)}),s}Vo.parse=function(e,r){if(e.length!==2)return r.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Rr(e[1])){var s=e[1];if(s.type==="FeatureCollection")for(var _=0;_<s.features.length;++_){var w=s.features[_].geometry.type;if(w==="Polygon"||w==="MultiPolygon")return new Vo(s,s.features[_].geometry)}else if(s.type==="Feature"){var C=s.geometry.type;if(C==="Polygon"||C==="MultiPolygon")return new Vo(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new Vo(s,s)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Vo.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,s){var _=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],C=r.canonicalID();if(s.type==="Polygon"){var i=Qa(s.coordinates,w,C),t=Mc(r.geometry(),_,w,C);if(!Ba(_,w))return!1;for(var o=0,h=t;o<h.length;o+=1)if(!Gs(h[o],i))return!1}if(s.type==="MultiPolygon"){var g=Ol(s.coordinates,w,C),b=Mc(r.geometry(),_,w,C);if(!Ba(_,w))return!1;for(var E=0,z=b;E<z.length;E+=1)if(!Un(z[E],g))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,s){var _=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],C=r.canonicalID();if(s.type==="Polygon"){var i=Qa(s.coordinates,w,C),t=fl(r.geometry(),_,w,C);if(!Ba(_,w))return!1;for(var o=0,h=t;o<h.length;o+=1)if(!Qu(h[o],i))return!1}if(s.type==="MultiPolygon"){var g=Ol(s.coordinates,w,C),b=fl(r.geometry(),_,w,C);if(!Ba(_,w))return!1;for(var E=0,z=b;E<z.length;E+=1)if(!ec(z[E],g))return!1}return!0}(e,this.geometries)}return!1},Vo.prototype.eachChild=function(){},Vo.prototype.outputDefined=function(){return!0},Vo.prototype.serialize=function(){return["within",this.geojson]};var ur=function(e,r){this.type=r.type,this.name=e,this.boundExpression=r};ur.parse=function(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");var s=e[1];return r.scope.has(s)?new ur(s,r.scope.get(s)):r.error('Unknown variable "'+s+'". Make sure "'+s+'" has been bound in an enclosing "let" expression before using it.',1)},ur.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},ur.prototype.eachChild=function(){},ur.prototype.outputDefined=function(){return!1},ur.prototype.serialize=function(){return["var",this.name]};var bs=function(e,r,s,_,w){r===void 0&&(r=[]),_===void 0&&(_=new ce),w===void 0&&(w=[]),this.registry=e,this.path=r,this.key=r.map(function(C){return"["+C+"]"}).join(""),this.scope=_,this.errors=w,this.expectedType=s};function ws(e,r){for(var s,_=e.length-1,w=0,C=_,i=0;w<=C;)if((s=e[i=Math.floor((w+C)/2)])<=r){if(i===_||r<e[i+1])return i;w=i+1}else{if(!(s>r))throw new Pn("Input is not a number.");C=i-1}return 0}bs.prototype.parse=function(e,r,s,_,w){return w===void 0&&(w={}),r?this.concat(r,s,_)._parse(e,w):this._parse(e,w)},bs.prototype._parse=function(e,r){function s(h,g,b){return b==="assert"?new Wr(g,[h]):b==="coerce"?new ra(g,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var _=e[0];if(typeof _!="string")return this.error("Expression name must be a string, but found "+typeof _+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var w=this.registry[_];if(w){var C=w.parse(e,this);if(!C)return null;if(this.expectedType){var i=this.expectedType,t=C.type;if(i.kind!=="string"&&i.kind!=="number"&&i.kind!=="boolean"&&i.kind!=="object"&&i.kind!=="array"||t.kind!=="value")if(i.kind!=="color"&&i.kind!=="formatted"&&i.kind!=="resolvedImage"||t.kind!=="value"&&t.kind!=="string"){if(this.checkSubtype(i,t))return null}else C=s(C,i,r.typeAnnotation||"coerce");else C=s(C,i,r.typeAnnotation||"assert")}if(!(C instanceof vo)&&C.type.kind!=="resolvedImage"&&function h(g){if(g instanceof ur)return h(g.boundExpression);if(g instanceof xn&&g.name==="error"||g instanceof jo||g instanceof Vo)return!1;var b=g instanceof ra||g instanceof Wr,E=!0;return g.eachChild(function(z){E=b?E&&h(z):E&&z instanceof vo}),!!E&&Oa(g)&&xs(g,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(C)){var o=new ma;try{C=new vo(C.type,C.evaluate(o))}catch(h){return this.error(h.message),null}}return C}return this.error('Unknown expression "'+_+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},bs.prototype.concat=function(e,r,s){var _=typeof e=="number"?this.path.concat(e):this.path,w=s?this.scope.concat(s):this.scope;return new bs(this.registry,_,r||null,w,this.errors)},bs.prototype.error=function(e){for(var r=[],s=arguments.length-1;s-- >0;)r[s]=arguments[s+1];var _=""+this.key+r.map(function(w){return"["+w+"]"}).join("");this.errors.push(new ne(_,e))},bs.prototype.checkSubtype=function(e,r){var s=mi(e,r);return s&&this.error(s),s};var ao=function(e,r,s){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(var _=0,w=s;_<w.length;_+=1){var C=w[_],i=C[1];this.labels.push(C[0]),this.outputs.push(i)}};function bn(e,r,s){return e*(1-s)+r*s}ao.parse=function(e,r){if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");var s=r.parse(e[1],1,fe);if(!s)return null;var _=[],w=null;r.expectedType&&r.expectedType.kind!=="value"&&(w=r.expectedType);for(var C=1;C<e.length;C+=2){var i=C===1?-1/0:e[C],t=e[C+1],o=C,h=C+1;if(typeof i!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',o);if(_.length&&_[_.length-1][0]>=i)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',o);var g=r.parse(t,h,w);if(!g)return null;w=w||g.type,_.push([i,g])}return new ao(w,s,_)},ao.prototype.evaluate=function(e){var r=this.labels,s=this.outputs;if(r.length===1)return s[0].evaluate(e);var _=this.input.evaluate(e);if(_<=r[0])return s[0].evaluate(e);var w=r.length;return _>=r[w-1]?s[w-1].evaluate(e):s[ws(r,_)].evaluate(e)},ao.prototype.eachChild=function(e){e(this.input);for(var r=0,s=this.outputs;r<s.length;r+=1)e(s[r])},ao.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},ao.prototype.serialize=function(){for(var e=["step",this.input.serialize()],r=0;r<this.labels.length;r++)r>0&&e.push(this.labels[r]),e.push(this.outputs[r].serialize());return e};var so=Object.freeze({__proto__:null,number:bn,color:function(e,r,s){return new Pi(bn(e.r,r.r,s),bn(e.g,r.g,s),bn(e.b,r.b,s),bn(e.a,r.a,s))},array:function(e,r,s){return e.map(function(_,w){return bn(_,r[w],s)})}}),bu=6/29*3*(6/29),wu=Math.PI/180,Eu=180/Math.PI;function Ul(e){return e>.008856451679035631?Math.pow(e,1/3):e/bu+4/29}function Nl(e){return e>6/29?e*e*e:bu*(e-4/29)}function ml(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function jl(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Iu(e){var r=jl(e.r),s=jl(e.g),_=jl(e.b),w=Ul((.4124564*r+.3575761*s+.1804375*_)/.95047),C=Ul((.2126729*r+.7151522*s+.072175*_)/1);return{l:116*C-16,a:500*(w-C),b:200*(C-Ul((.0193339*r+.119192*s+.9503041*_)/1.08883)),alpha:e.a}}function Vl(e){var r=(e.l+16)/116,s=isNaN(e.a)?r:r+e.a/500,_=isNaN(e.b)?r:r-e.b/200;return r=1*Nl(r),s=.95047*Nl(s),_=1.08883*Nl(_),new Pi(ml(3.2404542*s-1.5371385*r-.4985314*_),ml(-.969266*s+1.8760108*r+.041556*_),ml(.0556434*s-.2040259*r+1.0572252*_),e.alpha)}function Lc(e,r,s){var _=r-e;return e+s*(_>180||_<-180?_-360*Math.round(_/360):_)}var yl={forward:Iu,reverse:Vl,interpolate:function(e,r,s){return{l:bn(e.l,r.l,s),a:bn(e.a,r.a,s),b:bn(e.b,r.b,s),alpha:bn(e.alpha,r.alpha,s)}}},Ua={forward:function(e){var r=Iu(e),s=r.l,_=r.a,w=r.b,C=Math.atan2(w,_)*Eu;return{h:C<0?C+360:C,c:Math.sqrt(_*_+w*w),l:s,alpha:e.a}},reverse:function(e){var r=e.h*wu,s=e.c;return Vl({l:e.l,a:Math.cos(r)*s,b:Math.sin(r)*s,alpha:e.alpha})},interpolate:function(e,r,s){return{h:Lc(e.h,r.h,s),c:bn(e.c,r.c,s),l:bn(e.l,r.l,s),alpha:bn(e.alpha,r.alpha,s)}}},Dc=Object.freeze({__proto__:null,lab:yl,hcl:Ua}),lo=function(e,r,s,_,w){this.type=e,this.operator=r,this.interpolation=s,this.input=_,this.labels=[],this.outputs=[];for(var C=0,i=w;C<i.length;C+=1){var t=i[C],o=t[1];this.labels.push(t[0]),this.outputs.push(o)}};function tc(e,r,s,_){var w=_-s,C=e-s;return w===0?0:r===1?C/w:(Math.pow(r,C)-1)/(Math.pow(r,w)-1)}lo.interpolationFactor=function(e,r,s,_){var w=0;if(e.name==="exponential")w=tc(r,e.base,s,_);else if(e.name==="linear")w=tc(r,1,s,_);else if(e.name==="cubic-bezier"){var C=e.controlPoints;w=new R(C[0],C[1],C[2],C[3]).solve(tc(r,1,s,_))}return w},lo.parse=function(e,r){var s=e[0],_=e[1],w=e[2],C=e.slice(3);if(!Array.isArray(_)||_.length===0)return r.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){var i=_[1];if(typeof i!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:i}}else{if(_[0]!=="cubic-bezier")return r.error("Unknown interpolation type "+String(_[0]),1,0);var t=_.slice(1);if(t.length!==4||t.some(function(N){return typeof N!="number"||N<0||N>1}))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:t}}if(e.length-1<4)return r.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(!(w=r.parse(w,2,fe)))return null;var o=[],h=null;s==="interpolate-hcl"||s==="interpolate-lab"?h=Ie:r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);for(var g=0;g<C.length;g+=2){var b=C[g],E=C[g+1],z=g+3,D=g+4;if(typeof b!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(o.length&&o[o.length-1][0]>=b)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);var O=r.parse(E,D,h);if(!O)return null;h=h||O.type,o.push([b,O])}return h.kind==="number"||h.kind==="color"||h.kind==="array"&&h.itemType.kind==="number"&&typeof h.N=="number"?new lo(h,s,_,w,o):r.error("Type "+jt(h)+" is not interpolatable.")},lo.prototype.evaluate=function(e){var r=this.labels,s=this.outputs;if(r.length===1)return s[0].evaluate(e);var _=this.input.evaluate(e);if(_<=r[0])return s[0].evaluate(e);var w=r.length;if(_>=r[w-1])return s[w-1].evaluate(e);var C=ws(r,_),i=lo.interpolationFactor(this.interpolation,_,r[C],r[C+1]),t=s[C].evaluate(e),o=s[C+1].evaluate(e);return this.operator==="interpolate"?so[this.type.kind.toLowerCase()](t,o,i):this.operator==="interpolate-hcl"?Ua.reverse(Ua.interpolate(Ua.forward(t),Ua.forward(o),i)):yl.reverse(yl.interpolate(yl.forward(t),yl.forward(o),i))},lo.prototype.eachChild=function(e){e(this.input);for(var r=0,s=this.outputs;r<s.length;r+=1)e(s[r])},lo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},lo.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var r=[this.operator,e,this.input.serialize()],s=0;s<this.labels.length;s++)r.push(this.labels[s],this.outputs[s].serialize());return r};var Es=function(e,r){this.type=e,this.args=r};Es.parse=function(e,r){if(e.length<2)return r.error("Expectected at least one argument.");var s=null,_=r.expectedType;_&&_.kind!=="value"&&(s=_);for(var w=[],C=0,i=e.slice(1);C<i.length;C+=1){var t=r.parse(i[C],1+w.length,s,void 0,{typeAnnotation:"omit"});if(!t)return null;s=s||t.type,w.push(t)}var o=_&&w.some(function(h){return mi(_,h.type)});return new Es(o?Ke:s,w)},Es.prototype.evaluate=function(e){for(var r,s=null,_=0,w=0,C=this.args;w<C.length&&(_++,(s=C[w].evaluate(e))&&s instanceof po&&!s.available&&(r||(r=s.name),s=null,_===this.args.length&&(s=r)),s===null);w+=1);return s},Es.prototype.eachChild=function(e){this.args.forEach(e)},Es.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Es.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(r){e.push(r.serialize())}),e};var Is=function(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r};Is.prototype.evaluate=function(e){return this.result.evaluate(e)},Is.prototype.eachChild=function(e){for(var r=0,s=this.bindings;r<s.length;r+=1)e(s[r][1]);e(this.result)},Is.parse=function(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var s=[],_=1;_<e.length-1;_+=2){var w=e[_];if(typeof w!="string")return r.error("Expected string, but found "+typeof w+" instead.",_);if(/[^a-zA-Z0-9_]/.test(w))return r.error("Variable names must contain only alphanumeric characters or '_'.",_);var C=r.parse(e[_+1],_+1);if(!C)return null;s.push([w,C])}var i=r.parse(e[e.length-1],e.length-1,r.expectedType,s);return i?new Is(s,i):null},Is.prototype.outputDefined=function(){return this.result.outputDefined()},Is.prototype.serialize=function(){for(var e=["let"],r=0,s=this.bindings;r<s.length;r+=1){var _=s[r];e.push(_[0],_[1].serialize())}return e.push(this.result.serialize()),e};var Zs=function(e,r,s){this.type=e,this.index=r,this.input=s};Zs.parse=function(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var s=r.parse(e[1],1,fe),_=r.parse(e[2],2,Bt(r.expectedType||Ke));return s&&_?new Zs(_.type.itemType,s,_):null},Zs.prototype.evaluate=function(e){var r=this.index.evaluate(e),s=this.input.evaluate(e);if(r<0)throw new Pn("Array index out of bounds: "+r+" < 0.");if(r>=s.length)throw new Pn("Array index out of bounds: "+r+" > "+(s.length-1)+".");if(r!==Math.floor(r))throw new Pn("Array index must be an integer, but found "+r+" instead.");return s[r]},Zs.prototype.eachChild=function(e){e(this.index),e(this.input)},Zs.prototype.outputDefined=function(){return!1},Zs.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var es=function(e,r){this.type=we,this.needle=e,this.haystack=r};es.parse=function(e,r){if(e.length!==3)return r.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var s=r.parse(e[1],1,Ke),_=r.parse(e[2],2,Ke);return s&&_?Ii(s.type,[we,Ee,fe,_e,Ke])?new es(s,_):r.error("Expected first argument to be of type boolean, string, number or null, but found "+jt(s.type)+" instead"):null},es.prototype.evaluate=function(e){var r=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!s)return!1;if(!li(r,["boolean","string","number","null"]))throw new Pn("Expected first argument to be of type boolean, string, number or null, but found "+jt(vn(r))+" instead.");if(!li(s,["string","array"]))throw new Pn("Expected second argument to be of type array or string, but found "+jt(vn(s))+" instead.");return s.indexOf(r)>=0},es.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},es.prototype.outputDefined=function(){return!0},es.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Na=function(e,r,s){this.type=fe,this.needle=e,this.haystack=r,this.fromIndex=s};Na.parse=function(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var s=r.parse(e[1],1,Ke),_=r.parse(e[2],2,Ke);if(!s||!_)return null;if(!Ii(s.type,[we,Ee,fe,_e,Ke]))return r.error("Expected first argument to be of type boolean, string, number or null, but found "+jt(s.type)+" instead");if(e.length===4){var w=r.parse(e[3],3,fe);return w?new Na(s,_,w):null}return new Na(s,_)},Na.prototype.evaluate=function(e){var r=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!li(r,["boolean","string","number","null"]))throw new Pn("Expected first argument to be of type boolean, string, number or null, but found "+jt(vn(r))+" instead.");if(!li(s,["string","array"]))throw new Pn("Expected second argument to be of type array or string, but found "+jt(vn(s))+" instead.");if(this.fromIndex){var _=this.fromIndex.evaluate(e);return s.indexOf(r,_)}return s.indexOf(r)},Na.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Na.prototype.outputDefined=function(){return!1},Na.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var ya=function(e,r,s,_,w,C){this.inputType=e,this.type=r,this.input=s,this.cases=_,this.outputs=w,this.otherwise=C};ya.parse=function(e,r){if(e.length<5)return r.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return r.error("Expected an even number of arguments.");var s,_;r.expectedType&&r.expectedType.kind!=="value"&&(_=r.expectedType);for(var w={},C=[],i=2;i<e.length-1;i+=2){var t=e[i],o=e[i+1];Array.isArray(t)||(t=[t]);var h=r.concat(i);if(t.length===0)return h.error("Expected at least one branch label.");for(var g=0,b=t;g<b.length;g+=1){var E=b[g];if(typeof E!="number"&&typeof E!="string")return h.error("Branch labels must be numbers or strings.");if(typeof E=="number"&&Math.abs(E)>Number.MAX_SAFE_INTEGER)return h.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof E=="number"&&Math.floor(E)!==E)return h.error("Numeric branch labels must be integer values.");if(s){if(h.checkSubtype(s,vn(E)))return null}else s=vn(E);if(w[String(E)]!==void 0)return h.error("Branch labels must be unique.");w[String(E)]=C.length}var z=r.parse(o,i,_);if(!z)return null;_=_||z.type,C.push(z)}var D=r.parse(e[1],1,Ke);if(!D)return null;var O=r.parse(e[e.length-1],e.length-1,_);return O?D.type.kind!=="value"&&r.concat(1).checkSubtype(s,D.type)?null:new ya(s,_,D,w,C,O):null},ya.prototype.evaluate=function(e){var r=this.input.evaluate(e);return(vn(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)},ya.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},ya.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},ya.prototype.serialize=function(){for(var e=this,r=["match",this.input.serialize()],s=[],_={},w=0,C=Object.keys(this.cases).sort();w<C.length;w+=1){var i=C[w];(b=_[this.cases[i]])===void 0?(_[this.cases[i]]=s.length,s.push([this.cases[i],[i]])):s[b][1].push(i)}for(var t=function(z){return e.inputType.kind==="number"?Number(z):z},o=0,h=s;o<h.length;o+=1){var g=h[o],b=g[0],E=g[1];r.push(E.length===1?t(E[0]):E.map(t)),r.push(this.outputs[outputIndex$1].serialize())}return r.push(this.otherwise.serialize()),r};var Ss=function(e,r,s){this.type=e,this.branches=r,this.otherwise=s};Ss.parse=function(e,r){if(e.length<4)return r.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return r.error("Expected an odd number of arguments.");var s;r.expectedType&&r.expectedType.kind!=="value"&&(s=r.expectedType);for(var _=[],w=1;w<e.length-1;w+=2){var C=r.parse(e[w],w,we);if(!C)return null;var i=r.parse(e[w+1],w+1,s);if(!i)return null;_.push([C,i]),s=s||i.type}var t=r.parse(e[e.length-1],e.length-1,s);return t?new Ss(s,_,t):null},Ss.prototype.evaluate=function(e){for(var r=0,s=this.branches;r<s.length;r+=1){var _=s[r],w=_[1];if(_[0].evaluate(e))return w.evaluate(e)}return this.otherwise.evaluate(e)},Ss.prototype.eachChild=function(e){for(var r=0,s=this.branches;r<s.length;r+=1){var _=s[r],w=_[1];e(_[0]),e(w)}e(this.otherwise)},Ss.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},Ss.prototype.serialize=function(){var e=["case"];return this.eachChild(function(r){e.push(r.serialize())}),e};var ts=function(e,r,s,_){this.type=e,this.input=r,this.beginIndex=s,this.endIndex=_};function Su(e,r){return e==="=="||e==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function Ts(e,r,s,_){return _.compare(r,s)===0}function Br(e,r,s){var _=e!=="=="&&e!=="!=";return function(){function w(C,i,t){this.type=we,this.lhs=C,this.rhs=i,this.collator=t,this.hasUntypedArgument=C.type.kind==="value"||i.type.kind==="value"}return w.parse=function(C,i){if(C.length!==3&&C.length!==4)return i.error("Expected two or three arguments.");var t=C[0],o=i.parse(C[1],1,Ke);if(!o)return null;if(!Su(t,o.type))return i.concat(1).error('"'+t+`" comparisons are not supported for type '`+jt(o.type)+"'.");var h=i.parse(C[2],2,Ke);if(!h)return null;if(!Su(t,h.type))return i.concat(2).error('"'+t+`" comparisons are not supported for type '`+jt(h.type)+"'.");if(o.type.kind!==h.type.kind&&o.type.kind!=="value"&&h.type.kind!=="value")return i.error("Cannot compare types '"+jt(o.type)+"' and '"+jt(h.type)+"'.");_&&(o.type.kind==="value"&&h.type.kind!=="value"?o=new Wr(h.type,[o]):o.type.kind!=="value"&&h.type.kind==="value"&&(h=new Wr(o.type,[h])));var g=null;if(C.length===4){if(o.type.kind!=="string"&&h.type.kind!=="string"&&o.type.kind!=="value"&&h.type.kind!=="value")return i.error("Cannot use collator to compare non-string types.");if(!(g=i.parse(C[3],3,tt)))return null}return new w(o,h,g)},w.prototype.evaluate=function(C){var i=this.lhs.evaluate(C),t=this.rhs.evaluate(C);if(_&&this.hasUntypedArgument){var o=vn(i),h=vn(t);if(o.kind!==h.kind||o.kind!=="string"&&o.kind!=="number")throw new Pn('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+o.kind+", "+h.kind+") instead.")}if(this.collator&&!_&&this.hasUntypedArgument){var g=vn(i),b=vn(t);if(g.kind!=="string"||b.kind!=="string")return r(C,i,t)}return this.collator?s(C,i,t,this.collator.evaluate(C)):r(C,i,t)},w.prototype.eachChild=function(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)},w.prototype.outputDefined=function(){return!0},w.prototype.serialize=function(){var C=[e];return this.eachChild(function(i){C.push(i.serialize())}),C},w}()}ts.parse=function(e,r){if(e.length<=2||e.length>=5)return r.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var s=r.parse(e[1],1,Ke),_=r.parse(e[2],2,fe);if(!s||!_)return null;if(!Ii(s.type,[Bt(Ke),Ee,Ke]))return r.error("Expected first argument to be of type array or string, but found "+jt(s.type)+" instead");if(e.length===4){var w=r.parse(e[3],3,fe);return w?new ts(s.type,s,_,w):null}return new ts(s.type,s,_)},ts.prototype.evaluate=function(e){var r=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!li(r,["string","array"]))throw new Pn("Expected first argument to be of type array or string, but found "+jt(vn(r))+" instead.");if(this.endIndex){var _=this.endIndex.evaluate(e);return r.slice(s,_)}return r.slice(s)},ts.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},ts.prototype.outputDefined=function(){return!1},ts.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Hs=Br("==",function(e,r,s){return r===s},Ts),is=Br("!=",function(e,r,s){return r!==s},function(e,r,s,_){return!Ts(0,r,s,_)}),ic=Br("<",function(e,r,s){return r<s},function(e,r,s,_){return _.compare(r,s)<0}),Tu=Br(">",function(e,r,s){return r>s},function(e,r,s,_){return _.compare(r,s)>0}),Ji=Br("<=",function(e,r,s){return r<=s},function(e,r,s,_){return _.compare(r,s)<=0}),ql=Br(">=",function(e,r,s){return r>=s},function(e,r,s,_){return _.compare(r,s)>=0}),yr=function(e,r,s,_,w){this.type=Ee,this.number=e,this.locale=r,this.currency=s,this.minFractionDigits=_,this.maxFractionDigits=w};yr.parse=function(e,r){if(e.length!==3)return r.error("Expected two arguments.");var s=r.parse(e[1],1,fe);if(!s)return null;var _=e[2];if(typeof _!="object"||Array.isArray(_))return r.error("NumberFormat options argument must be an object.");var w=null;if(_.locale&&!(w=r.parse(_.locale,1,Ee)))return null;var C=null;if(_.currency&&!(C=r.parse(_.currency,1,Ee)))return null;var i=null;if(_["min-fraction-digits"]&&!(i=r.parse(_["min-fraction-digits"],1,fe)))return null;var t=null;return _["max-fraction-digits"]&&!(t=r.parse(_["max-fraction-digits"],1,fe))?null:new yr(s,w,C,i,t)},yr.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},yr.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},yr.prototype.outputDefined=function(){return!1},yr.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Sa=function(e){this.type=fe,this.input=e};Sa.parse=function(e,r){if(e.length!==2)return r.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var s=r.parse(e[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?r.error("Expected argument of type string or array, but found "+jt(s.type)+" instead."):new Sa(s):null},Sa.prototype.evaluate=function(e){var r=this.input.evaluate(e);if(typeof r=="string"||Array.isArray(r))return r.length;throw new Pn("Expected value to be of type string or array, but found "+jt(vn(r))+" instead.")},Sa.prototype.eachChild=function(e){e(this.input)},Sa.prototype.outputDefined=function(){return!1},Sa.prototype.serialize=function(){var e=["length"];return this.eachChild(function(r){e.push(r.serialize())}),e};var jr={"==":Hs,"!=":is,">":Tu,"<":ic,">=":ql,"<=":Ji,array:Wr,at:Zs,boolean:Wr,case:Ss,coalesce:Es,collator:jo,format:ia,image:Do,in:es,"index-of":Na,interpolate:lo,"interpolate-hcl":lo,"interpolate-lab":lo,length:Sa,let:Is,literal:vo,match:ya,number:Wr,"number-format":yr,object:Wr,slice:ts,step:ao,string:Wr,"to-boolean":ra,"to-color":ra,"to-number":ra,"to-string":ra,var:ur,within:Vo};function wn(e,r){var s=r[0],_=r[1],w=r[2],C=r[3];s=s.evaluate(e),_=_.evaluate(e),w=w.evaluate(e);var i=C?C.evaluate(e):1,t=Rl(s,_,w,i);if(t)throw new Pn(t);return new Pi(s/255*i,_/255*i,w/255*i,i)}function Gl(e,r){return e in r}function Zl(e,r){var s=r[e];return s===void 0?null:s}function Ws(e){return{type:e}}function Au(e){return{result:"success",value:e}}function ja(e){return{result:"error",value:e}}function Va(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Hl(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function As(e){return!!e.expression&&e.expression.interpolated}function Vr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function rs(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Cu(e){return e}function xo(e,r,s){return e!==void 0?e:r!==void 0?r:s!==void 0?s:void 0}function rc(e,r,s,_,w){return xo(typeof s===w?_[s]:void 0,e.default,r.default)}function Rc(e,r,s){if(Vr(s)!=="number")return xo(e.default,r.default);var _=e.stops.length;if(_===1||s<=e.stops[0][0])return e.stops[0][1];if(s>=e.stops[_-1][0])return e.stops[_-1][1];var w=ws(e.stops.map(function(C){return C[0]}),s);return e.stops[w][1]}function nc(e,r,s){var _=e.base!==void 0?e.base:1;if(Vr(s)!=="number")return xo(e.default,r.default);var w=e.stops.length;if(w===1||s<=e.stops[0][0])return e.stops[0][1];if(s>=e.stops[w-1][0])return e.stops[w-1][1];var C=ws(e.stops.map(function(b){return b[0]}),s),i=function(b,E,z,D){var O=D-z,N=b-z;return O===0?0:E===1?N/O:(Math.pow(E,N)-1)/(Math.pow(E,O)-1)}(s,_,e.stops[C][0],e.stops[C+1][0]),t=e.stops[C][1],o=e.stops[C+1][1],h=so[r.type]||Cu;if(e.colorSpace&&e.colorSpace!=="rgb"){var g=Dc[e.colorSpace];h=function(b,E){return g.reverse(g.interpolate(g.forward(b),g.forward(E),i))}}return typeof t.evaluate=="function"?{evaluate:function(){for(var b=[],E=arguments.length;E--;)b[E]=arguments[E];var z=t.evaluate.apply(void 0,b),D=o.evaluate.apply(void 0,b);if(z!==void 0&&D!==void 0)return h(z,D,i)}}:h(t,o,i)}function ns(e,r,s){return r.type==="color"?s=Pi.parse(s):r.type==="formatted"?s=Er.fromString(s.toString()):r.type==="resolvedImage"?s=po.fromString(s.toString()):Vr(s)===r.type||r.type==="enum"&&r.values[s]||(s=void 0),xo(s,e.default,r.default)}xn.register(jr,{error:[{kind:"error"},[Ee],function(e,r){throw new Pn(r[0].evaluate(e))}],typeof:[Ee,[Ke],function(e,r){return jt(vn(r[0].evaluate(e)))}],"to-rgba":[Bt(fe,4),[Ie],function(e,r){return r[0].evaluate(e).toArray()}],rgb:[Ie,[fe,fe,fe],wn],rgba:[Ie,[fe,fe,fe,fe],wn],has:{type:we,overloads:[[[Ee],function(e,r){return Gl(r[0].evaluate(e),e.properties())}],[[Ee,et],function(e,r){var s=r[1];return Gl(r[0].evaluate(e),s.evaluate(e))}]]},get:{type:Ke,overloads:[[[Ee],function(e,r){return Zl(r[0].evaluate(e),e.properties())}],[[Ee,et],function(e,r){var s=r[1];return Zl(r[0].evaluate(e),s.evaluate(e))}]]},"feature-state":[Ke,[Ee],function(e,r){return Zl(r[0].evaluate(e),e.featureState||{})}],properties:[et,[],function(e){return e.properties()}],"geometry-type":[Ee,[],function(e){return e.geometryType()}],id:[Ke,[],function(e){return e.id()}],zoom:[fe,[],function(e){return e.globals.zoom}],"heatmap-density":[fe,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[fe,[],function(e){return e.globals.lineProgress||0}],accumulated:[Ke,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[fe,Ws(fe),function(e,r){for(var s=0,_=0,w=r;_<w.length;_+=1)s+=w[_].evaluate(e);return s}],"*":[fe,Ws(fe),function(e,r){for(var s=1,_=0,w=r;_<w.length;_+=1)s*=w[_].evaluate(e);return s}],"-":{type:fe,overloads:[[[fe,fe],function(e,r){var s=r[1];return r[0].evaluate(e)-s.evaluate(e)}],[[fe],function(e,r){return-r[0].evaluate(e)}]]},"/":[fe,[fe,fe],function(e,r){var s=r[1];return r[0].evaluate(e)/s.evaluate(e)}],"%":[fe,[fe,fe],function(e,r){var s=r[1];return r[0].evaluate(e)%s.evaluate(e)}],ln2:[fe,[],function(){return Math.LN2}],pi:[fe,[],function(){return Math.PI}],e:[fe,[],function(){return Math.E}],"^":[fe,[fe,fe],function(e,r){var s=r[1];return Math.pow(r[0].evaluate(e),s.evaluate(e))}],sqrt:[fe,[fe],function(e,r){return Math.sqrt(r[0].evaluate(e))}],log10:[fe,[fe],function(e,r){return Math.log(r[0].evaluate(e))/Math.LN10}],ln:[fe,[fe],function(e,r){return Math.log(r[0].evaluate(e))}],log2:[fe,[fe],function(e,r){return Math.log(r[0].evaluate(e))/Math.LN2}],sin:[fe,[fe],function(e,r){return Math.sin(r[0].evaluate(e))}],cos:[fe,[fe],function(e,r){return Math.cos(r[0].evaluate(e))}],tan:[fe,[fe],function(e,r){return Math.tan(r[0].evaluate(e))}],asin:[fe,[fe],function(e,r){return Math.asin(r[0].evaluate(e))}],acos:[fe,[fe],function(e,r){return Math.acos(r[0].evaluate(e))}],atan:[fe,[fe],function(e,r){return Math.atan(r[0].evaluate(e))}],min:[fe,Ws(fe),function(e,r){return Math.min.apply(Math,r.map(function(s){return s.evaluate(e)}))}],max:[fe,Ws(fe),function(e,r){return Math.max.apply(Math,r.map(function(s){return s.evaluate(e)}))}],abs:[fe,[fe],function(e,r){return Math.abs(r[0].evaluate(e))}],round:[fe,[fe],function(e,r){var s=r[0].evaluate(e);return s<0?-Math.round(-s):Math.round(s)}],floor:[fe,[fe],function(e,r){return Math.floor(r[0].evaluate(e))}],ceil:[fe,[fe],function(e,r){return Math.ceil(r[0].evaluate(e))}],"filter-==":[we,[Ee,Ke],function(e,r){var s=r[0],_=r[1];return e.properties()[s.value]===_.value}],"filter-id-==":[we,[Ke],function(e,r){var s=r[0];return e.id()===s.value}],"filter-type-==":[we,[Ee],function(e,r){var s=r[0];return e.geometryType()===s.value}],"filter-<":[we,[Ee,Ke],function(e,r){var s=r[0],_=r[1],w=e.properties()[s.value],C=_.value;return typeof w==typeof C&&w<C}],"filter-id-<":[we,[Ke],function(e,r){var s=r[0],_=e.id(),w=s.value;return typeof _==typeof w&&_<w}],"filter->":[we,[Ee,Ke],function(e,r){var s=r[0],_=r[1],w=e.properties()[s.value],C=_.value;return typeof w==typeof C&&w>C}],"filter-id->":[we,[Ke],function(e,r){var s=r[0],_=e.id(),w=s.value;return typeof _==typeof w&&_>w}],"filter-<=":[we,[Ee,Ke],function(e,r){var s=r[0],_=r[1],w=e.properties()[s.value],C=_.value;return typeof w==typeof C&&w<=C}],"filter-id-<=":[we,[Ke],function(e,r){var s=r[0],_=e.id(),w=s.value;return typeof _==typeof w&&_<=w}],"filter->=":[we,[Ee,Ke],function(e,r){var s=r[0],_=r[1],w=e.properties()[s.value],C=_.value;return typeof w==typeof C&&w>=C}],"filter-id->=":[we,[Ke],function(e,r){var s=r[0],_=e.id(),w=s.value;return typeof _==typeof w&&_>=w}],"filter-has":[we,[Ke],function(e,r){return r[0].value in e.properties()}],"filter-has-id":[we,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[we,[Bt(Ee)],function(e,r){return r[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[we,[Bt(Ke)],function(e,r){return r[0].value.indexOf(e.id())>=0}],"filter-in-small":[we,[Ee,Bt(Ke)],function(e,r){var s=r[0];return r[1].value.indexOf(e.properties()[s.value])>=0}],"filter-in-large":[we,[Ee,Bt(Ke)],function(e,r){var s=r[0],_=r[1];return function(w,C,i,t){for(;i<=t;){var o=i+t>>1;if(C[o]===w)return!0;C[o]>w?t=o-1:i=o+1}return!1}(e.properties()[s.value],_.value,0,_.value.length-1)}],all:{type:we,overloads:[[[we,we],function(e,r){var s=r[1];return r[0].evaluate(e)&&s.evaluate(e)}],[Ws(we),function(e,r){for(var s=0,_=r;s<_.length;s+=1)if(!_[s].evaluate(e))return!1;return!0}]]},any:{type:we,overloads:[[[we,we],function(e,r){var s=r[1];return r[0].evaluate(e)||s.evaluate(e)}],[Ws(we),function(e,r){for(var s=0,_=r;s<_.length;s+=1)if(_[s].evaluate(e))return!0;return!1}]]},"!":[we,[we],function(e,r){return!r[0].evaluate(e)}],"is-supported-script":[we,[Ee],function(e,r){var s=e.globals&&e.globals.isSupportedScript;return!s||s(r[0].evaluate(e))}],upcase:[Ee,[Ee],function(e,r){return r[0].evaluate(e).toUpperCase()}],downcase:[Ee,[Ee],function(e,r){return r[0].evaluate(e).toLowerCase()}],concat:[Ee,Ws(Ke),function(e,r){return r.map(function(s){return Vs(s.evaluate(e))}).join("")}],"resolved-locale":[Ee,[tt],function(e,r){return r[0].evaluate(e).resolvedLocale()}]});var os=function(e,r){this.expression=e,this._warningHistory={},this._evaluator=new ma,this._defaultValue=r?function(s){return s.type==="color"&&rs(s.default)?new Pi(0,0,0,0):s.type==="color"?Pi.parse(s.default)||null:s.default===void 0?null:s.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null};function Xs(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in jr}function Wl(e,r){var s=new bs(jr,[],r?function(w){var C={color:Ie,string:Ee,number:fe,enum:Ee,boolean:we,formatted:Ft,resolvedImage:At};return w.type==="array"?Bt(C[w.value]||Ke,w.length):C[w.type]}(r):void 0),_=s.parse(e,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return _?Au(new os(_,r)):ja(s.errors)}os.prototype.evaluateWithoutErrorHandling=function(e,r,s,_,w,C){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=s,this._evaluator.canonical=_,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=C,this.expression.evaluate(this._evaluator)},os.prototype.evaluate=function(e,r,s,_,w,C){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=s||null,this._evaluator.canonical=_,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=C||null;try{var i=this.expression.evaluate(this._evaluator);if(i==null||typeof i=="number"&&i!=i)return this._defaultValue;if(this._enumValues&&!(i in this._enumValues))throw new Pn("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(i)+" instead.");return i}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,typeof console!="undefined"&&console.warn(t.message)),this._defaultValue}};var Cs=function(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!Fa(r.expression)};Cs.prototype.evaluateWithoutErrorHandling=function(e,r,s,_,w,C){return this._styleExpression.evaluateWithoutErrorHandling(e,r,s,_,w,C)},Cs.prototype.evaluate=function(e,r,s,_,w,C){return this._styleExpression.evaluate(e,r,s,_,w,C)};var as=function(e,r,s,_){this.kind=e,this.zoomStops=s,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!Fa(r.expression),this.interpolationType=_};function oc(e,r){if((e=Wl(e,r)).result==="error")return e;var s=e.value.expression,_=Oa(s);if(!_&&!Va(r))return ja([new ne("","data expressions not supported")]);var w=xs(s,["zoom"]);if(!w&&!Hl(r))return ja([new ne("","zoom expressions not supported")]);var C=function i(t){var o=null;if(t instanceof Is)o=i(t.result);else if(t instanceof Es)for(var h=0,g=t.args;h<g.length&&!(o=i(g[h]));h+=1);else(t instanceof ao||t instanceof lo)&&t.input instanceof xn&&t.input.name==="zoom"&&(o=t);return o instanceof ne||t.eachChild(function(b){var E=i(b);E instanceof ne?o=E:!o&&E?o=new ne("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&E&&o!==E&&(o=new ne("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}(s);return C||w?C instanceof ne?ja([C]):C instanceof lo&&!As(r)?ja([new ne("",'"interpolate" expressions cannot be used with this property')]):Au(C?new as(_?"camera":"composite",e.value,C.labels,C instanceof lo?C.interpolation:void 0):new Cs(_?"constant":"source",e.value)):ja([new ne("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}as.prototype.evaluateWithoutErrorHandling=function(e,r,s,_,w,C){return this._styleExpression.evaluateWithoutErrorHandling(e,r,s,_,w,C)},as.prototype.evaluate=function(e,r,s,_,w,C){return this._styleExpression.evaluate(e,r,s,_,w,C)},as.prototype.interpolationFactor=function(e,r,s){return this.interpolationType?lo.interpolationFactor(this.interpolationType,e,r,s):0};var qa=function(e,r){this._parameters=e,this._specification=r,ae(this,function s(_,w){var C,i,t,o=w.type==="color",h=_.stops&&typeof _.stops[0][0]=="object",g=h||!(h||_.property!==void 0),b=_.type||(As(w)?"exponential":"interval");if(o&&((_=ae({},_)).stops&&(_.stops=_.stops.map(function(Ve){return[Ve[0],Pi.parse(Ve[1])]})),_.default=Pi.parse(_.default?_.default:w.default)),_.colorSpace&&_.colorSpace!=="rgb"&&!Dc[_.colorSpace])throw new Error("Unknown color space: "+_.colorSpace);if(b==="exponential")C=nc;else if(b==="interval")C=Rc;else if(b==="categorical"){C=rc,i=Object.create(null);for(var E=0,z=_.stops;E<z.length;E+=1){var D=z[E];i[D[0]]=D[1]}t=typeof _.stops[0][0]}else{if(b!=="identity")throw new Error('Unknown function type "'+b+'"');C=ns}if(h){for(var O={},N=[],U=0;U<_.stops.length;U++){var K=_.stops[U],$=K[0].zoom;O[$]===void 0&&(O[$]={zoom:$,type:_.type,property:_.property,default:_.default,stops:[]},N.push($)),O[$].stops.push([K[0].value,K[1]])}for(var Q=[],se=0,pe=N;se<pe.length;se+=1){var Ae=pe[se];Q.push([O[Ae].zoom,s(O[Ae],w)])}var Be={name:"linear"};return{kind:"composite",interpolationType:Be,interpolationFactor:lo.interpolationFactor.bind(void 0,Be),zoomStops:Q.map(function(Ve){return Ve[0]}),evaluate:function(Ve,it){var He=Ve.zoom;return nc({stops:Q,base:_.base},w,He).evaluate(He,it)}}}if(g){var je=b==="exponential"?{name:"exponential",base:_.base!==void 0?_.base:1}:null;return{kind:"camera",interpolationType:je,interpolationFactor:lo.interpolationFactor.bind(void 0,je),zoomStops:_.stops.map(function(Ve){return Ve[0]}),evaluate:function(Ve){return C(_,w,Ve.zoom,i,t)}}}return{kind:"source",evaluate:function(Ve,it){var He=it&&it.properties?it.properties[_.property]:void 0;return He===void 0?xo(_.default,w.default):C(_,w,He,i,t)}}}(this._parameters,this._specification))};function na(e){var r=e.key,s=e.value,_=e.valueSpec||{},w=e.objectElementValidators||{},C=e.style,i=e.styleSpec,t=[],o=Vr(s);if(o!=="object")return[new Pe(r,s,"object expected, "+o+" found")];for(var h in s){var g=h.split(".")[0],b=_[g]||_["*"],E=void 0;if(w[g])E=w[g];else if(_[g])E=Qi;else if(w["*"])E=w["*"];else{if(!_["*"]){t.push(new Pe(r,s[h],'unknown property "'+h+'"'));continue}E=Qi}t=t.concat(E({key:(r&&r+".")+h,value:s[h],valueSpec:b,style:C,styleSpec:i,object:s,objectKey:h},s))}for(var z in _)w[z]||_[z].required&&_[z].default===void 0&&s[z]===void 0&&t.push(new Pe(r,s,'missing required property "'+z+'"'));return t}function Xl(e){var r=e.value,s=e.valueSpec,_=e.style,w=e.styleSpec,C=e.key,i=e.arrayElementValidator||Qi;if(Vr(r)!=="array")return[new Pe(C,r,"array expected, "+Vr(r)+" found")];if(s.length&&r.length!==s.length)return[new Pe(C,r,"array length "+s.length+" expected, length "+r.length+" found")];if(s["min-length"]&&r.length<s["min-length"])return[new Pe(C,r,"array length at least "+s["min-length"]+" expected, length "+r.length+" found")];var t={type:s.value,values:s.values};w.$version<7&&(t.function=s.function),Vr(s.value)==="object"&&(t=s.value);for(var o=[],h=0;h<r.length;h++)o=o.concat(i({array:r,arrayIndex:h,value:r[h],valueSpec:t,style:_,styleSpec:w,key:C+"["+h+"]"}));return o}function Kl(e){var r=e.key,s=e.value,_=e.valueSpec,w=Vr(s);return w==="number"&&s!=s&&(w="NaN"),w!=="number"?[new Pe(r,s,"number expected, "+w+" found")]:"minimum"in _&&s<_.minimum?[new Pe(r,s,s+" is less than the minimum value "+_.minimum)]:"maximum"in _&&s>_.maximum?[new Pe(r,s,s+" is greater than the maximum value "+_.maximum)]:[]}function Ks(e){var r,s,_,w=e.valueSpec,C=H(e.value.type),i={},t=C!=="categorical"&&e.value.property===void 0,o=!t,h=Vr(e.value.stops)==="array"&&Vr(e.value.stops[0])==="array"&&Vr(e.value.stops[0][0])==="object",g=na({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(z){if(C==="identity")return[new Pe(z.key,z.value,'identity function may not have a "stops" property')];var D=[],O=z.value;return D=D.concat(Xl({key:z.key,value:O,valueSpec:z.valueSpec,style:z.style,styleSpec:z.styleSpec,arrayElementValidator:b})),Vr(O)==="array"&&O.length===0&&D.push(new Pe(z.key,O,"array must have at least one stop")),D},default:function(z){return Qi({key:z.key,value:z.value,valueSpec:w,style:z.style,styleSpec:z.styleSpec})}}});return C==="identity"&&t&&g.push(new Pe(e.key,e.value,'missing required property "property"')),C==="identity"||e.value.stops||g.push(new Pe(e.key,e.value,'missing required property "stops"')),C==="exponential"&&e.valueSpec.expression&&!As(e.valueSpec)&&g.push(new Pe(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(o&&!Va(e.valueSpec)?g.push(new Pe(e.key,e.value,"property functions not supported")):t&&!Hl(e.valueSpec)&&g.push(new Pe(e.key,e.value,"zoom functions not supported"))),C!=="categorical"&&!h||e.value.property!==void 0||g.push(new Pe(e.key,e.value,'"property" property is required')),g;function b(z){var D=[],O=z.value,N=z.key;if(Vr(O)!=="array")return[new Pe(N,O,"array expected, "+Vr(O)+" found")];if(O.length!==2)return[new Pe(N,O,"array length 2 expected, length "+O.length+" found")];if(h){if(Vr(O[0])!=="object")return[new Pe(N,O,"object expected, "+Vr(O[0])+" found")];if(O[0].zoom===void 0)return[new Pe(N,O,"object stop key must have zoom")];if(O[0].value===void 0)return[new Pe(N,O,"object stop key must have value")];if(_&&_>H(O[0].zoom))return[new Pe(N,O[0].zoom,"stop zoom values must appear in ascending order")];H(O[0].zoom)!==_&&(_=H(O[0].zoom),s=void 0,i={}),D=D.concat(na({key:N+"[0]",value:O[0],valueSpec:{zoom:{}},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{zoom:Kl,value:E}}))}else D=D.concat(E({key:N+"[0]",value:O[0],valueSpec:{},style:z.style,styleSpec:z.styleSpec},O));return Xs(W(O[1]))?D.concat([new Pe(N+"[1]",O[1],"expressions are not allowed in function stops.")]):D.concat(Qi({key:N+"[1]",value:O[1],valueSpec:w,style:z.style,styleSpec:z.styleSpec}))}function E(z,D){var O=Vr(z.value),N=H(z.value),U=z.value!==null?z.value:D;if(r){if(O!==r)return[new Pe(z.key,U,O+" stop domain type must match previous stop domain type "+r)]}else r=O;if(O!=="number"&&O!=="string"&&O!=="boolean")return[new Pe(z.key,U,"stop domain value must be a number, string, or boolean")];if(O!=="number"&&C!=="categorical"){var K="number expected, "+O+" found";return Va(w)&&C===void 0&&(K+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Pe(z.key,U,K)]}return C!=="categorical"||O!=="number"||isFinite(N)&&Math.floor(N)===N?C!=="categorical"&&O==="number"&&s!==void 0&&N<s?[new Pe(z.key,U,"stop domain values must appear in ascending order")]:(s=N,C==="categorical"&&N in i?[new Pe(z.key,U,"stop domain values must be unique")]:(i[N]=!0,[])):[new Pe(z.key,U,"integer expected, found "+N)]}}function Ta(e){var r=(e.expressionContext==="property"?oc:Wl)(W(e.value),e.valueSpec);if(r.result==="error")return r.value.map(function(_){return new Pe(""+e.key+_.key,e.value,_.message)});var s=r.value.expression||r.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!s.outputDefined())return[new Pe(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!Fa(s))return[new Pe(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!Fa(s))return[new Pe(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!xs(s,["zoom","feature-state"]))return[new Pe(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Oa(s))return[new Pe(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function gl(e){var r=e.key,s=e.value,_=e.valueSpec,w=[];return Array.isArray(_.values)?_.values.indexOf(H(s))===-1&&w.push(new Pe(r,s,"expected one of ["+_.values.join(", ")+"], "+JSON.stringify(s)+" found")):Object.keys(_.values).indexOf(H(s))===-1&&w.push(new Pe(r,s,"expected one of ["+Object.keys(_.values).join(", ")+"], "+JSON.stringify(s)+" found")),w}function ks(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var r=0,s=e.slice(1);r<s.length;r+=1){var _=s[r];if(!ks(_)&&typeof _!="boolean")return!1}return!0;default:return!0}}qa.deserialize=function(e){return new qa(e._parameters,e._specification)},qa.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var ku={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Jl(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};ks(e)||(e=ss(e));var r=Wl(e,ku);if(r.result==="error")throw new Error(r.value.map(function(s){return s.key+": "+s.message}).join(", "));return{filter:function(s,_,w){return r.value.evaluate(s,_,{},w)},needGeometry:function s(_){if(!Array.isArray(_))return!1;if(_[0]==="within")return!0;for(var w=1;w<_.length;w++)if(s(_[w]))return!0;return!1}(e)}}function Bc(e,r){return e<r?-1:e>r?1:0}function ss(e){if(!e)return!0;var r,s=e[0];return e.length<=1?s!=="any":s==="=="?zu(e[1],e[2],"=="):s==="!="?bo(zu(e[1],e[2],"==")):s==="<"||s===">"||s==="<="||s===">="?zu(e[1],e[2],s):s==="any"?(r=e.slice(1),["any"].concat(r.map(ss))):s==="all"?["all"].concat(e.slice(1).map(ss)):s==="none"?["all"].concat(e.slice(1).map(ss).map(bo)):s==="in"?_l(e[1],e.slice(2)):s==="!in"?bo(_l(e[1],e.slice(2))):s==="has"?vl(e[1]):s==="!has"?bo(vl(e[1])):s!=="within"||e}function zu(e,r,s){switch(e){case"$type":return["filter-type-"+s,r];case"$id":return["filter-id-"+s,r];default:return["filter-"+s,e,r]}}function _l(e,r){if(r.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(function(s){return typeof s!=typeof r[0]})?["filter-in-large",e,["literal",r.sort(Bc)]]:["filter-in-small",e,["literal",r]]}}function vl(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function bo(e){return["!",e]}function wo(e){return ks(W(e.value))?Ta(ae({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function r(s){var _=s.value,w=s.key;if(Vr(_)!=="array")return[new Pe(w,_,"array expected, "+Vr(_)+" found")];var C,i=s.styleSpec,t=[];if(_.length<1)return[new Pe(w,_,"filter array must have at least 1 element")];switch(t=t.concat(gl({key:w+"[0]",value:_[0],valueSpec:i.filter_operator,style:s.style,styleSpec:s.styleSpec})),H(_[0])){case"<":case"<=":case">":case">=":_.length>=2&&H(_[1])==="$type"&&t.push(new Pe(w,_,'"$type" cannot be use with operator "'+_[0]+'"'));case"==":case"!=":_.length!==3&&t.push(new Pe(w,_,'filter array for operator "'+_[0]+'" must have 3 elements'));case"in":case"!in":_.length>=2&&(C=Vr(_[1]))!=="string"&&t.push(new Pe(w+"[1]",_[1],"string expected, "+C+" found"));for(var o=2;o<_.length;o++)C=Vr(_[o]),H(_[1])==="$type"?t=t.concat(gl({key:w+"["+o+"]",value:_[o],valueSpec:i.geometry_type,style:s.style,styleSpec:s.styleSpec})):C!=="string"&&C!=="number"&&C!=="boolean"&&t.push(new Pe(w+"["+o+"]",_[o],"string, number, or boolean expected, "+C+" found"));break;case"any":case"all":case"none":for(var h=1;h<_.length;h++)t=t.concat(r({key:w+"["+h+"]",value:_[h],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":C=Vr(_[1]),_.length!==2?t.push(new Pe(w,_,'filter array for "'+_[0]+'" operator must have 2 elements')):C!=="string"&&t.push(new Pe(w+"[1]",_[1],"string expected, "+C+" found"));break;case"within":C=Vr(_[1]),_.length!==2?t.push(new Pe(w,_,'filter array for "'+_[0]+'" operator must have 2 elements')):C!=="object"&&t.push(new Pe(w+"[1]",_[1],"object expected, "+C+" found"))}return t}(e)}function ac(e,r){var s=e.key,_=e.style,w=e.styleSpec,C=e.value,i=e.objectKey,t=w[r+"_"+e.layerType];if(!t)return[];var o=i.match(/^(.*)-transition$/);if(r==="paint"&&o&&t[o[1]]&&t[o[1]].transition)return Qi({key:s,value:C,valueSpec:w.transition,style:_,styleSpec:w});var h,g=e.valueSpec||t[i];if(!g)return[new Pe(s,C,'unknown property "'+i+'"')];if(Vr(C)==="string"&&Va(g)&&!g.tokens&&(h=/^{([^}]+)}$/.exec(C)))return[new Pe(s,C,'"'+i+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(h[1])+" }`.")];var b=[];return e.layerType==="symbol"&&(i==="text-field"&&_&&!_.glyphs&&b.push(new Pe(s,C,'use of "text-field" requires a style "glyphs" property')),i==="text-font"&&rs(W(C))&&H(C.type)==="identity"&&b.push(new Pe(s,C,'"text-font" does not support identity functions'))),b.concat(Qi({key:e.key,value:C,valueSpec:g,style:_,styleSpec:w,expressionContext:"property",propertyType:r,propertyKey:i}))}function ls(e){return ac(e,"paint")}function xl(e){return ac(e,"layout")}function Js(e){var r=[],s=e.value,_=e.key,w=e.style,C=e.styleSpec;s.type||s.ref||r.push(new Pe(_,s,'either "type" or "ref" is required'));var i,t=H(s.type),o=H(s.ref);if(s.id)for(var h=H(s.id),g=0;g<e.arrayIndex;g++){var b=w.layers[g];H(b.id)===h&&r.push(new Pe(_,s.id,'duplicate layer id "'+s.id+'", previously used at line '+b.id.__line__))}if("ref"in s)["type","source","source-layer","filter","layout"].forEach(function(D){D in s&&r.push(new Pe(_,s[D],'"'+D+'" is prohibited for ref layers'))}),w.layers.forEach(function(D){H(D.id)===o&&(i=D)}),i?i.ref?r.push(new Pe(_,s.ref,"ref cannot reference another ref layer")):t=H(i.type):r.push(new Pe(_,s.ref,'ref layer "'+o+'" not found'));else if(t!=="background")if(s.source){var E=w.sources&&w.sources[s.source],z=E&&H(E.type);E?z==="vector"&&t==="raster"?r.push(new Pe(_,s.source,'layer "'+s.id+'" requires a raster source')):z==="raster"&&t!=="raster"?r.push(new Pe(_,s.source,'layer "'+s.id+'" requires a vector source')):z!=="vector"||s["source-layer"]?z==="raster-dem"&&t!=="hillshade"?r.push(new Pe(_,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):t!=="line"||!s.paint||!s.paint["line-gradient"]||z==="geojson"&&E.lineMetrics||r.push(new Pe(_,s,'layer "'+s.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):r.push(new Pe(_,s,'layer "'+s.id+'" must specify a "source-layer"')):r.push(new Pe(_,s.source,'source "'+s.source+'" not found'))}else r.push(new Pe(_,s,'missing required property "source"'));return r=r.concat(na({key:_,value:s,valueSpec:C.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Qi({key:_+".type",value:s.type,valueSpec:C.layer.type,style:e.style,styleSpec:e.styleSpec,object:s,objectKey:"type"})},filter:wo,layout:function(D){return na({layer:s,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":function(O){return xl(ae({layerType:t},O))}}})},paint:function(D){return na({layer:s,key:D.key,value:D.value,style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":function(O){return ls(ae({layerType:t},O))}}})}}}))}function oa(e){var r=e.value,s=e.key,_=Vr(r);return _!=="string"?[new Pe(s,r,"string expected, "+_+" found")]:[]}var nn={promoteId:function(e){var r=e.key,s=e.value;if(Vr(s)==="string")return oa({key:r,value:s});var _=[];for(var w in s)_.push.apply(_,oa({key:r+"."+w,value:s[w]}));return _}};function bl(e){var r=e.value,s=e.key,_=e.styleSpec,w=e.style;if(!r.type)return[new Pe(s,r,'"type" is required')];var C,i=H(r.type);switch(i){case"vector":case"raster":case"raster-dem":return na({key:s,value:r,valueSpec:_["source_"+i.replace("-","_")],style:e.style,styleSpec:_,objectElementValidators:nn});case"geojson":if(C=na({key:s,value:r,valueSpec:_.source_geojson,style:w,styleSpec:_,objectElementValidators:nn}),r.cluster)for(var t in r.clusterProperties){var o=r.clusterProperties[t],h=o[0],g=typeof h=="string"?[h,["accumulated"],["get",t]]:h;C.push.apply(C,Ta({key:s+"."+t+".map",value:o[1],expressionContext:"cluster-map"})),C.push.apply(C,Ta({key:s+"."+t+".reduce",value:g,expressionContext:"cluster-reduce"}))}return C;case"video":return na({key:s,value:r,valueSpec:_.source_video,style:w,styleSpec:_});case"image":return na({key:s,value:r,valueSpec:_.source_image,style:w,styleSpec:_});case"canvas":return[new Pe(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return gl({key:s+".type",value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:w,styleSpec:_})}}function Ys(e){var r=e.value,s=e.styleSpec,_=s.light,w=e.style,C=[],i=Vr(r);if(r===void 0)return C;if(i!=="object")return C.concat([new Pe("light",r,"object expected, "+i+" found")]);for(var t in r){var o=t.match(/^(.*)-transition$/);C=C.concat(o&&_[o[1]]&&_[o[1]].transition?Qi({key:t,value:r[t],valueSpec:s.transition,style:w,styleSpec:s}):_[t]?Qi({key:t,value:r[t],valueSpec:_[t],style:w,styleSpec:s}):[new Pe(t,r[t],'unknown property "'+t+'"')])}return C}var us={"*":function(){return[]},array:Xl,boolean:function(e){var r=e.value,s=e.key,_=Vr(r);return _!=="boolean"?[new Pe(s,r,"boolean expected, "+_+" found")]:[]},number:Kl,color:function(e){var r=e.key,s=e.value,_=Vr(s);return _!=="string"?[new Pe(r,s,"color expected, "+_+" found")]:Kt(s)===null?[new Pe(r,s,'color expected, "'+s+'" found')]:[]},constants:Qe,enum:gl,filter:wo,function:Ks,layer:Js,object:na,source:bl,light:Ys,string:oa,formatted:function(e){return oa(e).length===0?[]:Ta(e)},resolvedImage:function(e){return oa(e).length===0?[]:Ta(e)}};function Qi(e){var r=e.value,s=e.valueSpec,_=e.styleSpec;return s.expression&&rs(H(r))?Ks(e):s.expression&&Xs(W(r))?Ta(e):s.type&&us[s.type]?us[s.type](e):na(ae({},e,{valueSpec:s.type?_[s.type]:s}))}function kr(e){var r=e.value,s=e.key,_=oa(e);return _.length||(r.indexOf("{fontstack}")===-1&&_.push(new Pe(s,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&_.push(new Pe(s,r,'"glyphs" url must include a "{range}" token'))),_}function Jt(e,r){r===void 0&&(r=ye);var s=[];return s=s.concat(Qi({key:"",value:e,valueSpec:r.$root,styleSpec:r,style:e,objectElementValidators:{glyphs:kr,"*":function(){return[]}}})),e.constants&&(s=s.concat(Qe({key:"constants",value:e.constants,style:e,styleSpec:r}))),$s(s)}function $s(e){return[].concat(e).sort(function(r,s){return r.line-s.line})}function Ga(e){return function(){for(var r=[],s=arguments.length;s--;)r[s]=arguments[s];return $s(e.apply(this,r))}}Jt.source=Ga(bl),Jt.light=Ga(Ys),Jt.layer=Ga(Js),Jt.filter=Ga(wo),Jt.paintProperty=Ga(ls),Jt.layoutProperty=Ga(xl);var Aa=Jt,Yl=Aa.light,ii=Aa.paintProperty,Qs=Aa.layoutProperty;function wl(e,r){var s=!1;if(r&&r.length)for(var _=0,w=r;_<w.length;_+=1)e.fire(new Oe(new Error(w[_].message))),s=!0;return s}var cs=ln;function ln(e,r,s){var _=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var w=new Int32Array(this.arrayBuffer);e=w[0],this.d=(r=w[1])+2*(s=w[2]);for(var C=0;C<this.d*this.d;C++){var i=w[3+C],t=w[3+C+1];_.push(i===t?null:w.subarray(i,t))}var o=w[3+_.length+1];this.keys=w.subarray(w[3+_.length],o),this.bboxes=w.subarray(o),this.insert=this._insertReadonly}else{this.d=r+2*s;for(var h=0;h<this.d*this.d;h++)_.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=s,this.scale=r/e,this.uid=0;var g=s/r*e;this.min=-g,this.max=e+g}ln.prototype.insert=function(e,r,s,_,w){this._forEachCell(r,s,_,w,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(_),this.bboxes.push(w)},ln.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ln.prototype._insertCell=function(e,r,s,_,w,C){this.cells[w].push(C)},ln.prototype.query=function(e,r,s,_,w){var C=this.min,i=this.max;if(e<=C&&r<=C&&i<=s&&i<=_&&!w)return Array.prototype.slice.call(this.keys);var t=[];return this._forEachCell(e,r,s,_,this._queryCell,t,{},w),t},ln.prototype._queryCell=function(e,r,s,_,w,C,i,t){var o=this.cells[w];if(o!==null)for(var h=this.keys,g=this.bboxes,b=0;b<o.length;b++){var E=o[b];if(i[E]===void 0){var z=4*E;(t?t(g[z+0],g[z+1],g[z+2],g[z+3]):e<=g[z+2]&&r<=g[z+3]&&s>=g[z+0]&&_>=g[z+1])?(i[E]=!0,C.push(h[E])):i[E]=!1}}},ln.prototype._forEachCell=function(e,r,s,_,w,C,i,t){for(var o=this._convertToCellCoord(e),h=this._convertToCellCoord(r),g=this._convertToCellCoord(s),b=this._convertToCellCoord(_),E=o;E<=g;E++)for(var z=h;z<=b;z++){var D=this.d*z+E;if((!t||t(this._convertFromCellCoord(E),this._convertFromCellCoord(z),this._convertFromCellCoord(E+1),this._convertFromCellCoord(z+1)))&&w.call(this,e,r,s,_,D,C,i,t))return}},ln.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},ln.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},ln.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,r=3+this.cells.length+1+1,s=0,_=0;_<this.cells.length;_++)s+=this.cells[_].length;var w=new Int32Array(r+s+this.keys.length+this.bboxes.length);w[0]=this.extent,w[1]=this.n,w[2]=this.padding;for(var C=r,i=0;i<e.length;i++){var t=e[i];w[3+i]=C,w.set(t,C),C+=t.length}return w[3+e.length]=C,w.set(this.keys,C),w[3+e.length+1]=C+=this.keys.length,w.set(this.bboxes,C),C+=this.bboxes.length,w.buffer};var El=X.ImageData,sc=X.ImageBitmap,Tn={};function ni(e,r,s){s===void 0&&(s={}),Object.defineProperty(r,"_classRegistryKey",{value:e,writeable:!1}),Tn[e]={klass:r,omit:s.omit||[],shallow:s.shallow||[]}}for(var fo in ni("Object",Object),cs.serialize=function(e,r){var s=e.toArrayBuffer();return r&&r.push(s),{buffer:s}},cs.deserialize=function(e){return new cs(e.buffer)},ni("Grid",cs),ni("Color",Pi),ni("Error",Error),ni("ResolvedImage",po),ni("StylePropertyFunction",qa),ni("StyleExpression",os,{omit:["_evaluator"]}),ni("ZoomDependentExpression",as),ni("ZoomConstantExpression",Cs),ni("CompoundExpression",xn,{omit:["_evaluate"]}),jr)jr[fo]._classRegistryKey||ni("Expression_"+fo,jr[fo]);function Il(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function zs(e){return sc&&e instanceof sc}function aa(e,r){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Il(e)||zs(e))return r&&r.push(e),e;if(ArrayBuffer.isView(e)){var s=e;return r&&r.push(s.buffer),s}if(e instanceof El)return r&&r.push(e.data.buffer),e;if(Array.isArray(e)){for(var _=[],w=0,C=e;w<C.length;w+=1)_.push(aa(C[w],r));return _}if(typeof e=="object"){var i=e.constructor,t=i._classRegistryKey;if(!t)throw new Error("can't serialize object of unregistered class");var o=i.serialize?i.serialize(e,r):{};if(!i.serialize){for(var h in e)if(e.hasOwnProperty(h)&&!(Tn[t].omit.indexOf(h)>=0)){var g=e[h];o[h]=Tn[t].shallow.indexOf(h)>=0?g:aa(g,r)}e instanceof Error&&(o.message=e.message)}if(o.$name)throw new Error("$name property is reserved for worker serialization logic.");return t!=="Object"&&(o.$name=t),o}throw new Error("can't serialize object of type "+typeof e)}function on(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Il(e)||zs(e)||ArrayBuffer.isView(e)||e instanceof El)return e;if(Array.isArray(e))return e.map(on);if(typeof e=="object"){var r=e.$name||"Object",s=Tn[r].klass;if(!s)throw new Error("can't deserialize unregistered class "+r);if(s.deserialize)return s.deserialize(e);for(var _=Object.create(s.prototype),w=0,C=Object.keys(e);w<C.length;w+=1){var i=C[w];if(i!=="$name"){var t=e[i];_[i]=Tn[r].shallow.indexOf(i)>=0?t:on(t)}}return _}throw new Error("can't deserialize object of type "+typeof e)}var Za=function(){this.first=!0};Za.prototype.update=function(e,r){var s=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=r),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=s,!0))};var Vt={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function $l(e){for(var r=0,s=e;r<s.length;r+=1)if(hs(s[r].charCodeAt(0)))return!0;return!1}function hs(e){return!(e!==746&&e!==747&&(e<4352||!(Vt["Bopomofo Extended"](e)||Vt.Bopomofo(e)||Vt["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Vt["CJK Compatibility Ideographs"](e)||Vt["CJK Compatibility"](e)||Vt["CJK Radicals Supplement"](e)||Vt["CJK Strokes"](e)||!(!Vt["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||Vt["CJK Unified Ideographs Extension A"](e)||Vt["CJK Unified Ideographs"](e)||Vt["Enclosed CJK Letters and Months"](e)||Vt["Hangul Compatibility Jamo"](e)||Vt["Hangul Jamo Extended-A"](e)||Vt["Hangul Jamo Extended-B"](e)||Vt["Hangul Jamo"](e)||Vt["Hangul Syllables"](e)||Vt.Hiragana(e)||Vt["Ideographic Description Characters"](e)||Vt.Kanbun(e)||Vt["Kangxi Radicals"](e)||Vt["Katakana Phonetic Extensions"](e)||Vt.Katakana(e)&&e!==12540||!(!Vt["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!Vt["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Vt["Unified Canadian Aboriginal Syllabics"](e)||Vt["Unified Canadian Aboriginal Syllabics Extended"](e)||Vt["Vertical Forms"](e)||Vt["Yijing Hexagram Symbols"](e)||Vt["Yi Syllables"](e)||Vt["Yi Radicals"](e))))}function Ql(e){return!(hs(e)||function(r){return!!(Vt["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||Vt["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||Vt["Letterlike Symbols"](r)||Vt["Number Forms"](r)||Vt["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||Vt["Control Pictures"](r)&&r!==9251||Vt["Optical Character Recognition"](r)||Vt["Enclosed Alphanumerics"](r)||Vt["Geometric Shapes"](r)||Vt["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||Vt["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Vt["CJK Symbols and Punctuation"](r)||Vt.Katakana(r)||Vt["Private Use Area"](r)||Vt["CJK Compatibility Forms"](r)||Vt["Small Form Variants"](r)||Vt["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(e))}function Ro(e){return e>=1424&&e<=2303||Vt["Arabic Presentation Forms-A"](e)||Vt["Arabic Presentation Forms-B"](e)}function un(e,r){return!(!r&&Ro(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Vt.Khmer(e))}function Yr(e){for(var r=0,s=e;r<s.length;r+=1)if(Ro(s[r].charCodeAt(0)))return!0;return!1}var el=null,mo="unavailable",Ca=null,lc=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(mo="error"),el&&el(e)};function Sl(){uc.fire(new Se("pluginStateChange",{pluginStatus:mo,pluginURL:Ca}))}var uc=new Ne,ga=function(){return mo},qo=function(){if(mo!=="deferred"||!Ca)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");mo="loading",Sl(),Ca&&Lo({url:Ca},function(e){e?lc(e):(mo="loaded",Sl())})},ai={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return mo==="loaded"||ai.applyArabicShaping!=null},isLoading:function(){return mo==="loading"},setState:function(e){mo=e.pluginStatus,Ca=e.pluginURL},isParsed:function(){return ai.applyArabicShaping!=null&&ai.processBidirectionalText!=null&&ai.processStyledBidirectionalText!=null},getPluginURL:function(){return Ca}},Ut=function(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Za,this.transition={})};Ut.prototype.isSupportedScript=function(e){return function(r,s){for(var _=0,w=r;_<w.length;_+=1)if(!un(w[_].charCodeAt(0),s))return!1;return!0}(e,ai.isLoaded())},Ut.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Ut.prototype.getCrossfadeParameters=function(){var e=this.zoom,r=e-Math.floor(e),s=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*r}};var Go=function(e,r){this.property=e,this.value=r,this.expression=function(s,_){if(rs(s))return new qa(s,_);if(Xs(s)){var w=oc(s,_);if(w.result==="error")throw new Error(w.value.map(function(i){return i.key+": "+i.message}).join(", "));return w.value}var C=s;return typeof s=="string"&&_.type==="color"&&(C=Pi.parse(s)),{kind:"constant",evaluate:function(){return C}}}(r===void 0?e.specification.default:r,e.specification)};Go.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Go.prototype.possiblyEvaluate=function(e,r,s){return this.property.possiblyEvaluate(this,e,r,s)};var Eo=function(e){this.property=e,this.value=new Go(e,void 0)};Eo.prototype.transitioned=function(e,r){return new cn(this.property,this.value,r,Ge({},e.transition,this.transition),e.now)},Eo.prototype.untransitioned=function(){return new cn(this.property,this.value,null,{},0)};var Nn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};Nn.prototype.getValue=function(e){return vi(this._values[e].value.value)},Nn.prototype.setValue=function(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new Eo(this._values[e].property)),this._values[e].value=new Go(this._values[e].property,r===null?void 0:vi(r))},Nn.prototype.getTransition=function(e){return vi(this._values[e].transition)},Nn.prototype.setTransition=function(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new Eo(this._values[e].property)),this._values[e].transition=vi(r)||void 0},Nn.prototype.serialize=function(){for(var e={},r=0,s=Object.keys(this._values);r<s.length;r+=1){var _=s[r],w=this.getValue(_);w!==void 0&&(e[_]=w);var C=this.getTransition(_);C!==void 0&&(e[_+"-transition"]=C)}return e},Nn.prototype.transitioned=function(e,r){for(var s=new Zo(this._properties),_=0,w=Object.keys(this._values);_<w.length;_+=1){var C=w[_];s._values[C]=this._values[C].transitioned(e,r._values[C])}return s},Nn.prototype.untransitioned=function(){for(var e=new Zo(this._properties),r=0,s=Object.keys(this._values);r<s.length;r+=1){var _=s[r];e._values[_]=this._values[_].untransitioned()}return e};var cn=function(e,r,s,_,w){this.property=e,this.value=r,this.begin=w+_.delay||0,this.end=this.begin+_.duration||0,e.specification.transition&&(_.delay||_.duration)&&(this.prior=s)};cn.prototype.possiblyEvaluate=function(e,r,s){var _=e.now||0,w=this.value.possiblyEvaluate(e,r,s),C=this.prior;if(C){if(_>this.end)return this.prior=null,w;if(this.value.isDataDriven())return this.prior=null,w;if(_<this.begin)return C.possiblyEvaluate(e,r,s);var i=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(C.possiblyEvaluate(e,r,s),w,function(t){if(t<=0)return 0;if(t>=1)return 1;var o=t*t,h=o*t;return 4*(t<.5?h:3*(t-o)+h-.75)}(i))}return w};var Zo=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Zo.prototype.possiblyEvaluate=function(e,r,s){for(var _=new ps(this._properties),w=0,C=Object.keys(this._values);w<C.length;w+=1){var i=C[w];_._values[i]=this._values[i].possiblyEvaluate(e,r,s)}return _},Zo.prototype.hasTransition=function(){for(var e=0,r=Object.keys(this._values);e<r.length;e+=1)if(this._values[r[e]].prior)return!0;return!1};var mn=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};mn.prototype.getValue=function(e){return vi(this._values[e].value)},mn.prototype.setValue=function(e,r){this._values[e]=new Go(this._values[e].property,r===null?void 0:vi(r))},mn.prototype.serialize=function(){for(var e={},r=0,s=Object.keys(this._values);r<s.length;r+=1){var _=s[r],w=this.getValue(_);w!==void 0&&(e[_]=w)}return e},mn.prototype.possiblyEvaluate=function(e,r,s){for(var _=new ps(this._properties),w=0,C=Object.keys(this._values);w<C.length;w+=1){var i=C[w];_._values[i]=this._values[i].possiblyEvaluate(e,r,s)}return _};var Io=function(e,r,s){this.property=e,this.value=r,this.parameters=s};Io.prototype.isConstant=function(){return this.value.kind==="constant"},Io.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Io.prototype.evaluate=function(e,r,s,_){return this.property.evaluate(this.value,this.parameters,e,r,s,_)};var ps=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};ps.prototype.get=function(e){return this._values[e]};var Gt=function(e){this.specification=e};Gt.prototype.possiblyEvaluate=function(e,r){return e.expression.evaluate(r)},Gt.prototype.interpolate=function(e,r,s){var _=so[this.specification.type];return _?_(e,r,s):e};var qt=function(e,r){this.specification=e,this.overrides=r};qt.prototype.possiblyEvaluate=function(e,r,s,_){return new Io(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},s,_)}:e.expression,r)},qt.prototype.interpolate=function(e,r,s){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new Io(this,{kind:"constant",value:void 0},e.parameters);var _=so[this.specification.type];return _?new Io(this,{kind:"constant",value:_(e.value.value,r.value.value,s)},e.parameters):e},qt.prototype.evaluate=function(e,r,s,_,w,C){return e.kind==="constant"?e.value:e.evaluate(r,s,_,w,C)};var eu=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.possiblyEvaluate=function(s,_,w,C){if(s.value===void 0)return new Io(this,{kind:"constant",value:void 0},_);if(s.expression.kind==="constant"){var i=s.expression.evaluate(_,null,{},w,C),t=s.property.specification.type==="resolvedImage"&&typeof i!="string"?i.name:i,o=this._calculate(t,t,t,_);return new Io(this,{kind:"constant",value:o},_)}if(s.expression.kind==="camera"){var h=this._calculate(s.expression.evaluate({zoom:_.zoom-1}),s.expression.evaluate({zoom:_.zoom}),s.expression.evaluate({zoom:_.zoom+1}),_);return new Io(this,{kind:"constant",value:h},_)}return new Io(this,s.expression,_)},r.prototype.evaluate=function(s,_,w,C,i,t){if(s.kind==="source"){var o=s.evaluate(_,w,C,i,t);return this._calculate(o,o,o,_)}return s.kind==="composite"?this._calculate(s.evaluate({zoom:Math.floor(_.zoom)-1},w,C),s.evaluate({zoom:Math.floor(_.zoom)},w,C),s.evaluate({zoom:Math.floor(_.zoom)+1},w,C),_):s.value},r.prototype._calculate=function(s,_,w,C){return C.zoom>C.zoomHistory.lastIntegerZoom?{from:s,to:_}:{from:w,to:_}},r.prototype.interpolate=function(s){return s},r}(qt),Mn=function(e){this.specification=e};Mn.prototype.possiblyEvaluate=function(e,r,s,_){if(e.value!==void 0){if(e.expression.kind==="constant"){var w=e.expression.evaluate(r,null,{},s,_);return this._calculate(w,w,w,r)}return this._calculate(e.expression.evaluate(new Ut(Math.floor(r.zoom-1),r)),e.expression.evaluate(new Ut(Math.floor(r.zoom),r)),e.expression.evaluate(new Ut(Math.floor(r.zoom+1),r)),r)}},Mn.prototype._calculate=function(e,r,s,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:s,to:r}},Mn.prototype.interpolate=function(e){return e};var Bo=function(e){this.specification=e};Bo.prototype.possiblyEvaluate=function(e,r,s,_){return!!e.expression.evaluate(r,null,{},s,_)},Bo.prototype.interpolate=function(){return!1};var S=function(e){for(var r in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var s=e[r];s.specification.overridable&&this.overridableProperties.push(r);var _=this.defaultPropertyValues[r]=new Go(s,void 0),w=this.defaultTransitionablePropertyValues[r]=new Eo(s);this.defaultTransitioningPropertyValues[r]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=_.possiblyEvaluate({})}};ni("DataDrivenProperty",qt),ni("DataConstantProperty",Gt),ni("CrossFadedDataDrivenProperty",eu),ni("CrossFadedProperty",Mn),ni("ColorRampProperty",Bo);var n=function(e){function r(s,_){if(e.call(this),this.id=s.id,this.type=s.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},s.type!=="custom"&&(this.metadata=(s=s).metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),_.layout&&(this._unevaluatedLayout=new mn(_.layout)),_.paint)){for(var w in this._transitionablePaint=new Nn(_.paint),s.paint)this.setPaintProperty(w,s.paint[w],{validate:!1});for(var C in s.layout)this.setLayoutProperty(C,s.layout[C],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ps(_.paint)}}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},r.prototype.getLayoutProperty=function(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)},r.prototype.setLayoutProperty=function(s,_,w){w===void 0&&(w={}),_!=null&&this._validate(Qs,"layers."+this.id+".layout."+s,s,_,w)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,_):this.visibility=_)},r.prototype.getPaintProperty=function(s){return pi(s,"-transition")?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)},r.prototype.setPaintProperty=function(s,_,w){if(w===void 0&&(w={}),_!=null&&this._validate(ii,"layers."+this.id+".paint."+s,s,_,w))return!1;if(pi(s,"-transition"))return this._transitionablePaint.setTransition(s.slice(0,-11),_||void 0),!1;var C=this._transitionablePaint._values[s],i=C.property.specification["property-type"]==="cross-faded-data-driven",t=C.value.isDataDriven(),o=C.value;this._transitionablePaint.setValue(s,_),this._handleSpecialPaintPropertyUpdate(s);var h=this._transitionablePaint._values[s].value;return h.isDataDriven()||t||i||this._handleOverridablePaintPropertyUpdate(s,o,h)},r.prototype._handleSpecialPaintPropertyUpdate=function(s){},r.prototype._handleOverridablePaintPropertyUpdate=function(s,_,w){return!1},r.prototype.isHidden=function(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"},r.prototype.updateTransitions=function(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)},r.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},r.prototype.recalculate=function(s,_){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,_)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,_)},r.prototype.serialize=function(){var s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),Wt(s,function(_,w){return!(_===void 0||w==="layout"&&!Object.keys(_).length||w==="paint"&&!Object.keys(_).length)})},r.prototype._validate=function(s,_,w,C,i){return i===void 0&&(i={}),(!i||i.validate!==!1)&&wl(this,s.call(Aa,{key:_,layerType:this.type,objectKey:w,value:C,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))},r.prototype.is3D=function(){return!1},r.prototype.isTileClipped=function(){return!1},r.prototype.hasOffscreenPass=function(){return!1},r.prototype.resize=function(){},r.prototype.isStateDependent=function(){for(var s in this.paint._values){var _=this.paint.get(s);if(_ instanceof Io&&Va(_.property.specification)&&(_.value.kind==="source"||_.value.kind==="composite")&&_.value.isStateDependent)return!0}return!1},r}(Ne),y={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},I=function(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},A=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function M(e,r){r===void 0&&(r=1);var s=0,_=0;return{members:e.map(function(w){var C=y[w.type].BYTES_PER_ELEMENT,i=s=F(s,Math.max(r,C)),t=w.components||1;return _=Math.max(_,C),s+=C*t,{name:w.name,type:w.type,components:t,offset:i}}),size:F(s,Math.max(_,r)),alignment:r}}function F(e,r){return Math.ceil(e/r)*r}A.serialize=function(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},A.deserialize=function(e){var r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r},A.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},A.prototype.clear=function(){this.length=0},A.prototype.resize=function(e){this.reserve(e),this.length=e},A.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}},A.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Z=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_){var w=this.length;return this.resize(w+1),this.emplace(w,s,_)},r.prototype.emplace=function(s,_,w){var C=2*s;return this.int16[C+0]=_,this.int16[C+1]=w,s},r}(A);Z.prototype.bytesPerElement=4,ni("StructArrayLayout2i4",Z);var J=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w,C){var i=this.length;return this.resize(i+1),this.emplace(i,s,_,w,C)},r.prototype.emplace=function(s,_,w,C,i){var t=4*s;return this.int16[t+0]=_,this.int16[t+1]=w,this.int16[t+2]=C,this.int16[t+3]=i,s},r}(A);J.prototype.bytesPerElement=8,ni("StructArrayLayout4i8",J);var ee=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w,C,i,t){var o=this.length;return this.resize(o+1),this.emplace(o,s,_,w,C,i,t)},r.prototype.emplace=function(s,_,w,C,i,t,o){var h=6*s;return this.int16[h+0]=_,this.int16[h+1]=w,this.int16[h+2]=C,this.int16[h+3]=i,this.int16[h+4]=t,this.int16[h+5]=o,s},r}(A);ee.prototype.bytesPerElement=12,ni("StructArrayLayout2i4i12",ee);var re=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w,C,i,t){var o=this.length;return this.resize(o+1),this.emplace(o,s,_,w,C,i,t)},r.prototype.emplace=function(s,_,w,C,i,t,o){var h=4*s,g=8*s;return this.int16[h+0]=_,this.int16[h+1]=w,this.uint8[g+4]=C,this.uint8[g+5]=i,this.uint8[g+6]=t,this.uint8[g+7]=o,s},r}(A);re.prototype.bytesPerElement=8,ni("StructArrayLayout2i4ub8",re);var ue=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_){var w=this.length;return this.resize(w+1),this.emplace(w,s,_)},r.prototype.emplace=function(s,_,w){var C=2*s;return this.float32[C+0]=_,this.float32[C+1]=w,s},r}(A);ue.prototype.bytesPerElement=8,ni("StructArrayLayout2f8",ue);var ve=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w,C,i,t,o,h,g,b){var E=this.length;return this.resize(E+1),this.emplace(E,s,_,w,C,i,t,o,h,g,b)},r.prototype.emplace=function(s,_,w,C,i,t,o,h,g,b,E){var z=10*s;return this.uint16[z+0]=_,this.uint16[z+1]=w,this.uint16[z+2]=C,this.uint16[z+3]=i,this.uint16[z+4]=t,this.uint16[z+5]=o,this.uint16[z+6]=h,this.uint16[z+7]=g,this.uint16[z+8]=b,this.uint16[z+9]=E,s},r}(A);ve.prototype.bytesPerElement=20,ni("StructArrayLayout10ui20",ve);var Re=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w,C,i,t,o,h,g,b,E,z){var D=this.length;return this.resize(D+1),this.emplace(D,s,_,w,C,i,t,o,h,g,b,E,z)},r.prototype.emplace=function(s,_,w,C,i,t,o,h,g,b,E,z,D){var O=12*s;return this.int16[O+0]=_,this.int16[O+1]=w,this.int16[O+2]=C,this.int16[O+3]=i,this.uint16[O+4]=t,this.uint16[O+5]=o,this.uint16[O+6]=h,this.uint16[O+7]=g,this.int16[O+8]=b,this.int16[O+9]=E,this.int16[O+10]=z,this.int16[O+11]=D,s},r}(A);Re.prototype.bytesPerElement=24,ni("StructArrayLayout4i4ui4i24",Re);var be=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w){var C=this.length;return this.resize(C+1),this.emplace(C,s,_,w)},r.prototype.emplace=function(s,_,w,C){var i=3*s;return this.float32[i+0]=_,this.float32[i+1]=w,this.float32[i+2]=C,s},r}(A);be.prototype.bytesPerElement=12,ni("StructArrayLayout3f12",be);var De=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s){var _=this.length;return this.resize(_+1),this.emplace(_,s)},r.prototype.emplace=function(s,_){return this.uint32[1*s+0]=_,s},r}(A);De.prototype.bytesPerElement=4,ni("StructArrayLayout1ul4",De);var Je=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w,C,i,t,o,h,g){var b=this.length;return this.resize(b+1),this.emplace(b,s,_,w,C,i,t,o,h,g)},r.prototype.emplace=function(s,_,w,C,i,t,o,h,g,b){var E=10*s,z=5*s;return this.int16[E+0]=_,this.int16[E+1]=w,this.int16[E+2]=C,this.int16[E+3]=i,this.int16[E+4]=t,this.int16[E+5]=o,this.uint32[z+3]=h,this.uint16[E+8]=g,this.uint16[E+9]=b,s},r}(A);Je.prototype.bytesPerElement=20,ni("StructArrayLayout6i1ul2ui20",Je);var Xe=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w,C,i,t){var o=this.length;return this.resize(o+1),this.emplace(o,s,_,w,C,i,t)},r.prototype.emplace=function(s,_,w,C,i,t,o){var h=6*s;return this.int16[h+0]=_,this.int16[h+1]=w,this.int16[h+2]=C,this.int16[h+3]=i,this.int16[h+4]=t,this.int16[h+5]=o,s},r}(A);Xe.prototype.bytesPerElement=12,ni("StructArrayLayout2i2i2i12",Xe);var nt=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w,C,i){var t=this.length;return this.resize(t+1),this.emplace(t,s,_,w,C,i)},r.prototype.emplace=function(s,_,w,C,i,t){var o=4*s,h=8*s;return this.float32[o+0]=_,this.float32[o+1]=w,this.float32[o+2]=C,this.int16[h+6]=i,this.int16[h+7]=t,s},r}(A);nt.prototype.bytesPerElement=16,ni("StructArrayLayout2f1f2i16",nt);var $e=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w,C){var i=this.length;return this.resize(i+1),this.emplace(i,s,_,w,C)},r.prototype.emplace=function(s,_,w,C,i){var t=12*s,o=3*s;return this.uint8[t+0]=_,this.uint8[t+1]=w,this.float32[o+1]=C,this.float32[o+2]=i,s},r}(A);$e.prototype.bytesPerElement=12,ni("StructArrayLayout2ub2f12",$e);var xt=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w){var C=this.length;return this.resize(C+1),this.emplace(C,s,_,w)},r.prototype.emplace=function(s,_,w,C){var i=3*s;return this.uint16[i+0]=_,this.uint16[i+1]=w,this.uint16[i+2]=C,s},r}(A);xt.prototype.bytesPerElement=6,ni("StructArrayLayout3ui6",xt);var ht=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w,C,i,t,o,h,g,b,E,z,D,O,N,U,K){var $=this.length;return this.resize($+1),this.emplace($,s,_,w,C,i,t,o,h,g,b,E,z,D,O,N,U,K)},r.prototype.emplace=function(s,_,w,C,i,t,o,h,g,b,E,z,D,O,N,U,K,$){var Q=24*s,se=12*s,pe=48*s;return this.int16[Q+0]=_,this.int16[Q+1]=w,this.uint16[Q+2]=C,this.uint16[Q+3]=i,this.uint32[se+2]=t,this.uint32[se+3]=o,this.uint32[se+4]=h,this.uint16[Q+10]=g,this.uint16[Q+11]=b,this.uint16[Q+12]=E,this.float32[se+7]=z,this.float32[se+8]=D,this.uint8[pe+36]=O,this.uint8[pe+37]=N,this.uint8[pe+38]=U,this.uint32[se+10]=K,this.int16[Q+22]=$,s},r}(A);ht.prototype.bytesPerElement=48,ni("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ht);var mt=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w,C,i,t,o,h,g,b,E,z,D,O,N,U,K,$,Q,se,pe,Ae,Be,je,Ve,it,He,Ct){var Tt=this.length;return this.resize(Tt+1),this.emplace(Tt,s,_,w,C,i,t,o,h,g,b,E,z,D,O,N,U,K,$,Q,se,pe,Ae,Be,je,Ve,it,He,Ct)},r.prototype.emplace=function(s,_,w,C,i,t,o,h,g,b,E,z,D,O,N,U,K,$,Q,se,pe,Ae,Be,je,Ve,it,He,Ct,Tt){var ut=34*s,St=17*s;return this.int16[ut+0]=_,this.int16[ut+1]=w,this.int16[ut+2]=C,this.int16[ut+3]=i,this.int16[ut+4]=t,this.int16[ut+5]=o,this.int16[ut+6]=h,this.int16[ut+7]=g,this.uint16[ut+8]=b,this.uint16[ut+9]=E,this.uint16[ut+10]=z,this.uint16[ut+11]=D,this.uint16[ut+12]=O,this.uint16[ut+13]=N,this.uint16[ut+14]=U,this.uint16[ut+15]=K,this.uint16[ut+16]=$,this.uint16[ut+17]=Q,this.uint16[ut+18]=se,this.uint16[ut+19]=pe,this.uint16[ut+20]=Ae,this.uint16[ut+21]=Be,this.uint16[ut+22]=je,this.uint32[St+12]=Ve,this.float32[St+13]=it,this.float32[St+14]=He,this.float32[St+15]=Ct,this.float32[St+16]=Tt,s},r}(A);mt.prototype.bytesPerElement=68,ni("StructArrayLayout8i15ui1ul4f68",mt);var Pt=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s){var _=this.length;return this.resize(_+1),this.emplace(_,s)},r.prototype.emplace=function(s,_){return this.float32[1*s+0]=_,s},r}(A);Pt.prototype.bytesPerElement=4,ni("StructArrayLayout1f4",Pt);var Ot=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w){var C=this.length;return this.resize(C+1),this.emplace(C,s,_,w)},r.prototype.emplace=function(s,_,w,C){var i=3*s;return this.int16[i+0]=_,this.int16[i+1]=w,this.int16[i+2]=C,s},r}(A);Ot.prototype.bytesPerElement=6,ni("StructArrayLayout3i6",Ot);var wt=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w){var C=this.length;return this.resize(C+1),this.emplace(C,s,_,w)},r.prototype.emplace=function(s,_,w,C){var i=4*s;return this.uint32[2*s+0]=_,this.uint16[i+2]=w,this.uint16[i+3]=C,s},r}(A);wt.prototype.bytesPerElement=8,ni("StructArrayLayout1ul2ui8",wt);var ci=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_){var w=this.length;return this.resize(w+1),this.emplace(w,s,_)},r.prototype.emplace=function(s,_,w){var C=2*s;return this.uint16[C+0]=_,this.uint16[C+1]=w,s},r}(A);ci.prototype.bytesPerElement=4,ni("StructArrayLayout2ui4",ci);var ei=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s){var _=this.length;return this.resize(_+1),this.emplace(_,s)},r.prototype.emplace=function(s,_){return this.uint16[1*s+0]=_,s},r}(A);ei.prototype.bytesPerElement=2,ni("StructArrayLayout1ui2",ei);var Oi=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},r.prototype.emplaceBack=function(s,_,w,C){var i=this.length;return this.resize(i+1),this.emplace(i,s,_,w,C)},r.prototype.emplace=function(s,_,w,C,i){var t=4*s;return this.float32[t+0]=_,this.float32[t+1]=w,this.float32[t+2]=C,this.float32[t+3]=i,s},r}(A);Oi.prototype.bytesPerElement=16,ni("StructArrayLayout4f16",Oi);var u=function(e){function r(){e.apply(this,arguments)}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var s={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return s.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},s.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},s.x1.get=function(){return this._structArray.int16[this._pos2+2]},s.y1.get=function(){return this._structArray.int16[this._pos2+3]},s.x2.get=function(){return this._structArray.int16[this._pos2+4]},s.y2.get=function(){return this._structArray.int16[this._pos2+5]},s.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},s.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},s.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},s.anchorPoint.get=function(){return new V(this.anchorPointX,this.anchorPointY)},Object.defineProperties(r.prototype,s),r}(I);u.prototype.size=20;var m=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.get=function(s){return new u(this,s)},r}(Je);ni("CollisionBoxArray",m);var p=function(e){function r(){e.apply(this,arguments)}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var s={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return s.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},s.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},s.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},s.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},s.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},s.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},s.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},s.segment.get=function(){return this._structArray.uint16[this._pos2+10]},s.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},s.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},s.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},s.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},s.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},s.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},s.placedOrientation.set=function(_){this._structArray.uint8[this._pos1+37]=_},s.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},s.hidden.set=function(_){this._structArray.uint8[this._pos1+38]=_},s.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},s.crossTileID.set=function(_){this._structArray.uint32[this._pos4+10]=_},s.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(r.prototype,s),r}(I);p.prototype.size=48;var v=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.get=function(s){return new p(this,s)},r}(ht);ni("PlacedSymbolArray",v);var k=function(e){function r(){e.apply(this,arguments)}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var s={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return s.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},s.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},s.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},s.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},s.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},s.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},s.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},s.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},s.key.get=function(){return this._structArray.uint16[this._pos2+8]},s.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},s.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},s.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},s.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},s.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},s.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},s.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},s.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},s.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},s.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},s.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},s.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},s.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},s.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},s.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},s.crossTileID.set=function(_){this._structArray.uint32[this._pos4+12]=_},s.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},s.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},s.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},s.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(r.prototype,s),r}(I);k.prototype.size=68;var L=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.get=function(s){return new k(this,s)},r}(mt);ni("SymbolInstanceArray",L);var B=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.getoffsetX=function(s){return this.float32[1*s+0]},r}(Pt);ni("GlyphOffsetArray",B);var j=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.getx=function(s){return this.int16[3*s+0]},r.prototype.gety=function(s){return this.int16[3*s+1]},r.prototype.gettileUnitDistanceFromAnchor=function(s){return this.int16[3*s+2]},r}(Ot);ni("SymbolLineVertexArray",j);var Y=function(e){function r(){e.apply(this,arguments)}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var s={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return s.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},s.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},s.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(r.prototype,s),r}(I);Y.prototype.size=8;var ie=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.get=function(s){return new Y(this,s)},r}(wt);ni("FeatureIndexArray",ie);var he=M([{name:"a_pos",components:2,type:"Int16"}],4).members,de=function(e){e===void 0&&(e=[]),this.segments=e};function me(e,r){return 256*(e=We(Math.floor(e),0,255))+We(Math.floor(r),0,255)}de.prototype.prepareSegment=function(e,r,s,_){var w=this.segments[this.segments.length-1];return e>de.MAX_VERTEX_ARRAY_LENGTH&&Xt("Max vertices per segment is "+de.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!w||w.vertexLength+e>de.MAX_VERTEX_ARRAY_LENGTH||w.sortKey!==_)&&(w={vertexOffset:r.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},_!==void 0&&(w.sortKey=_),this.segments.push(w)),w},de.prototype.get=function(){return this.segments},de.prototype.destroy=function(){for(var e=0,r=this.segments;e<r.length;e+=1){var s=r[e];for(var _ in s.vaos)s.vaos[_].destroy()}},de.simpleSegment=function(e,r,s,_){return new de([{vertexOffset:e,primitiveOffset:r,vertexLength:s,primitiveLength:_,vaos:{},sortKey:0}])},de.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ni("SegmentVector",de);var Ce=M([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Te=d(function(e){e.exports=function(r,s){var _,w,C,i,t,o,h,g;for(w=r.length-(_=3&r.length),C=s,t=3432918353,o=461845907,g=0;g<w;)h=255&r.charCodeAt(g)|(255&r.charCodeAt(++g))<<8|(255&r.charCodeAt(++g))<<16|(255&r.charCodeAt(++g))<<24,++g,C=27492+(65535&(i=5*(65535&(C=(C^=h=(65535&(h=(h=(65535&h)*t+(((h>>>16)*t&65535)<<16)&4294967295)<<15|h>>>17))*o+(((h>>>16)*o&65535)<<16)&4294967295)<<13|C>>>19))+((5*(C>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(h=0,_){case 3:h^=(255&r.charCodeAt(g+2))<<16;case 2:h^=(255&r.charCodeAt(g+1))<<8;case 1:C^=h=(65535&(h=(h=(65535&(h^=255&r.charCodeAt(g)))*t+(((h>>>16)*t&65535)<<16)&4294967295)<<15|h>>>17))*o+(((h>>>16)*o&65535)<<16)&4294967295}return C^=r.length,C=2246822507*(65535&(C^=C>>>16))+((2246822507*(C>>>16)&65535)<<16)&4294967295,C=3266489909*(65535&(C^=C>>>13))+((3266489909*(C>>>16)&65535)<<16)&4294967295,(C^=C>>>16)>>>0}}),Le=d(function(e){e.exports=function(r,s){for(var _,w=r.length,C=s^w,i=0;w>=4;)_=1540483477*(65535&(_=255&r.charCodeAt(i)|(255&r.charCodeAt(++i))<<8|(255&r.charCodeAt(++i))<<16|(255&r.charCodeAt(++i))<<24))+((1540483477*(_>>>16)&65535)<<16),C=1540483477*(65535&C)+((1540483477*(C>>>16)&65535)<<16)^(_=1540483477*(65535&(_^=_>>>24))+((1540483477*(_>>>16)&65535)<<16)),w-=4,++i;switch(w){case 3:C^=(255&r.charCodeAt(i+2))<<16;case 2:C^=(255&r.charCodeAt(i+1))<<8;case 1:C=1540483477*(65535&(C^=255&r.charCodeAt(i)))+((1540483477*(C>>>16)&65535)<<16)}return C=1540483477*(65535&(C^=C>>>13))+((1540483477*(C>>>16)&65535)<<16),(C^=C>>>15)>>>0}}),xe=Te,ze=Le;xe.murmur3=Te,xe.murmur2=ze;var Fe=function(){this.ids=[],this.positions=[],this.indexed=!1};Fe.prototype.add=function(e,r,s,_){this.ids.push(ot(e)),this.positions.push(r,s,_)},Fe.prototype.getPositions=function(e){for(var r=ot(e),s=0,_=this.ids.length-1;s<_;){var w=s+_>>1;this.ids[w]>=r?_=w:s=w+1}for(var C=[];this.ids[s]===r;)C.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return C},Fe.serialize=function(e,r){var s=new Float64Array(e.ids),_=new Uint32Array(e.positions);return function w(C,i,t,o){for(;t<o;){for(var h=C[t+o>>1],g=t-1,b=o+1;;){do g++;while(C[g]<h);do b--;while(C[b]>h);if(g>=b)break;at(C,g,b),at(i,3*g,3*b),at(i,3*g+1,3*b+1),at(i,3*g+2,3*b+2)}b-t<o-b?(w(C,i,t,b),t=b+1):(w(C,i,b+1,o),o=b)}}(s,_,0,s.length-1),r&&r.push(s.buffer,_.buffer),{ids:s,positions:_}},Fe.deserialize=function(e){var r=new Fe;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r};var Ye=Math.pow(2,53)-1;function ot(e){var r=+e;return!isNaN(r)&&r<=Ye?r:xe(String(e))}function at(e,r,s){var _=e[r];e[r]=e[s],e[s]=_}ni("FeaturePositionMap",Fe);var st=function(e,r){this.gl=e.gl,this.location=r},It=function(e){function r(s,_){e.call(this,s,_),this.current=0}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))},r}(st),Lt=function(e){function r(s,_){e.call(this,s,_),this.current=0}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))},r}(st),Mt=function(e){function r(s,_){e.call(this,s,_),this.current=[0,0]}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))},r}(st),Yt=function(e){function r(s,_){e.call(this,s,_),this.current=[0,0,0]}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))},r}(st),di=function(e){function r(s,_){e.call(this,s,_),this.current=[0,0,0,0]}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))},r}(st),_i=function(e){function r(s,_){e.call(this,s,_),this.current=Pi.transparent}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))},r}(st),hi=new Float32Array(16),ar=function(e){function r(s,_){e.call(this,s,_),this.current=hi}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.set=function(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(var _=1;_<16;_++)if(s[_]!==this.current[_]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}},r}(st);function ri(e){return[me(255*e.r,255*e.g),me(255*e.b,255*e.a)]}var Di=function(e,r,s){this.value=e,this.uniformNames=r.map(function(_){return"u_"+_}),this.type=s};Di.prototype.setUniform=function(e,r,s){e.set(s.constantOr(this.value))},Di.prototype.getBinding=function(e,r,s){return this.type==="color"?new _i(e,r):new Lt(e,r)};var er=function(e,r){this.uniformNames=r.map(function(s){return"u_"+s}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};er.prototype.setConstantPatternPositions=function(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr},er.prototype.setUniform=function(e,r,s,_){var w=_==="u_pattern_to"?this.patternTo:_==="u_pattern_from"?this.patternFrom:_==="u_pixel_ratio_to"?this.pixelRatioTo:_==="u_pixel_ratio_from"?this.pixelRatioFrom:null;w&&e.set(w)},er.prototype.getBinding=function(e,r,s){return s.substr(0,9)==="u_pattern"?new di(e,r):new Lt(e,r)};var zi=function(e,r,s,_){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=r.map(function(w){return{name:"a_"+w,type:"Float32",components:s==="color"?2:1,offset:0}}),this.paintVertexArray=new _};zi.prototype.populatePaintArray=function(e,r,s,_,w){var C=this.paintVertexArray.length,i=this.expression.evaluate(new Ut(0),r,{},_,[],w);this.paintVertexArray.resize(e),this._setPaintValue(C,e,i)},zi.prototype.updatePaintArray=function(e,r,s,_){var w=this.expression.evaluate({zoom:0},s,_);this._setPaintValue(e,r,w)},zi.prototype._setPaintValue=function(e,r,s){if(this.type==="color")for(var _=ri(s),w=e;w<r;w++)this.paintVertexArray.emplace(w,_[0],_[1]);else{for(var C=e;C<r;C++)this.paintVertexArray.emplace(C,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}},zi.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},zi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ai=function(e,r,s,_,w,C){this.expression=e,this.uniformNames=r.map(function(i){return"u_"+i+"_t"}),this.type=s,this.useIntegerZoom=_,this.zoom=w,this.maxValue=0,this.paintVertexAttributes=r.map(function(i){return{name:"a_"+i,type:"Float32",components:s==="color"?4:2,offset:0}}),this.paintVertexArray=new C};Ai.prototype.populatePaintArray=function(e,r,s,_,w){var C=this.expression.evaluate(new Ut(this.zoom),r,{},_,[],w),i=this.expression.evaluate(new Ut(this.zoom+1),r,{},_,[],w),t=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(t,e,C,i)},Ai.prototype.updatePaintArray=function(e,r,s,_){var w=this.expression.evaluate({zoom:this.zoom},s,_),C=this.expression.evaluate({zoom:this.zoom+1},s,_);this._setPaintValue(e,r,w,C)},Ai.prototype._setPaintValue=function(e,r,s,_){if(this.type==="color")for(var w=ri(s),C=ri(_),i=e;i<r;i++)this.paintVertexArray.emplace(i,w[0],w[1],C[0],C[1]);else{for(var t=e;t<r;t++)this.paintVertexArray.emplace(t,s,_);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(_))}},Ai.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ai.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ai.prototype.setUniform=function(e,r){var s=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,_=We(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);e.set(_)},Ai.prototype.getBinding=function(e,r,s){return new Lt(e,r)};var ji=function(e,r,s,_,w,C){this.expression=e,this.type=r,this.useIntegerZoom=s,this.zoom=_,this.layerId=C,this.zoomInPaintVertexArray=new w,this.zoomOutPaintVertexArray=new w};ji.prototype.populatePaintArray=function(e,r,s){var _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(_,e,r.patterns&&r.patterns[this.layerId],s)},ji.prototype.updatePaintArray=function(e,r,s,_,w){this._setPaintValues(e,r,s.patterns&&s.patterns[this.layerId],w)},ji.prototype._setPaintValues=function(e,r,s,_){if(_&&s){var w=_[s.min],C=_[s.mid],i=_[s.max];if(w&&C&&i)for(var t=e;t<r;t++)this.zoomInPaintVertexArray.emplace(t,C.tl[0],C.tl[1],C.br[0],C.br[1],w.tl[0],w.tl[1],w.br[0],w.br[1],C.pixelRatio,w.pixelRatio),this.zoomOutPaintVertexArray.emplace(t,C.tl[0],C.tl[1],C.br[0],C.br[1],i.tl[0],i.tl[1],i.br[0],i.br[1],C.pixelRatio,i.pixelRatio)}},ji.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Ce.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Ce.members,this.expression.isStateDependent))},ji.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var wi=function(e,r,s){this.binders={},this._buffers=[];var _=[];for(var w in e.paint._values)if(s(w)){var C=e.paint.get(w);if(C instanceof Io&&Va(C.property.specification)){var i=hn(w,e.type),t=C.value,o=C.property.specification.type,h=C.property.useIntegerZoom,g=C.property.specification["property-type"],b=g==="cross-faded"||g==="cross-faded-data-driven";if(t.kind==="constant")this.binders[w]=b?new er(t.value,i):new Di(t.value,i,o),_.push("/u_"+w);else if(t.kind==="source"||b){var E=En(w,o,"source");this.binders[w]=b?new ji(t,o,h,r,E,e.id):new zi(t,i,o,E),_.push("/a_"+w)}else{var z=En(w,o,"composite");this.binders[w]=new Ai(t,i,o,h,r,z),_.push("/z_"+w)}}}this.cacheKey=_.sort().join("")};wi.prototype.getMaxValue=function(e){var r=this.binders[e];return r instanceof zi||r instanceof Ai?r.maxValue:0},wi.prototype.populatePaintArrays=function(e,r,s,_,w){for(var C in this.binders){var i=this.binders[C];(i instanceof zi||i instanceof Ai||i instanceof ji)&&i.populatePaintArray(e,r,s,_,w)}},wi.prototype.setConstantPatternPositions=function(e,r){for(var s in this.binders){var _=this.binders[s];_ instanceof er&&_.setConstantPatternPositions(e,r)}},wi.prototype.updatePaintArrays=function(e,r,s,_,w){var C=!1;for(var i in e)for(var t=0,o=r.getPositions(i);t<o.length;t+=1){var h=o[t],g=s.feature(h.index);for(var b in this.binders){var E=this.binders[b];if((E instanceof zi||E instanceof Ai||E instanceof ji)&&E.expression.isStateDependent===!0){var z=_.paint.get(b);E.expression=z.value,E.updatePaintArray(h.start,h.end,g,e[i],w),C=!0}}}return C},wi.prototype.defines=function(){var e=[];for(var r in this.binders){var s=this.binders[r];(s instanceof Di||s instanceof er)&&e.push.apply(e,s.uniformNames.map(function(_){return"#define HAS_UNIFORM_"+_}))}return e},wi.prototype.getBinderAttributes=function(){var e=[];for(var r in this.binders){var s=this.binders[r];if(s instanceof zi||s instanceof Ai)for(var _=0;_<s.paintVertexAttributes.length;_++)e.push(s.paintVertexAttributes[_].name);else if(s instanceof ji)for(var w=0;w<Ce.members.length;w++)e.push(Ce.members[w].name)}return e},wi.prototype.getBinderUniforms=function(){var e=[];for(var r in this.binders){var s=this.binders[r];if(s instanceof Di||s instanceof er||s instanceof Ai)for(var _=0,w=s.uniformNames;_<w.length;_+=1)e.push(w[_])}return e},wi.prototype.getPaintVertexBuffers=function(){return this._buffers},wi.prototype.getUniforms=function(e,r){var s=[];for(var _ in this.binders){var w=this.binders[_];if(w instanceof Di||w instanceof er||w instanceof Ai)for(var C=0,i=w.uniformNames;C<i.length;C+=1){var t=i[C];if(r[t]){var o=w.getBinding(e,r[t],t);s.push({name:t,property:_,binding:o})}}}return s},wi.prototype.setUniforms=function(e,r,s,_){for(var w=0,C=r;w<C.length;w+=1){var i=C[w],t=i.name,o=i.property;this.binders[o].setUniform(i.binding,_,s.get(o),t)}},wi.prototype.updatePaintBuffers=function(e){for(var r in this._buffers=[],this.binders){var s=this.binders[r];if(e&&s instanceof ji){var _=e.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(s instanceof zi||s instanceof Ai)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}},wi.prototype.upload=function(e){for(var r in this.binders){var s=this.binders[r];(s instanceof zi||s instanceof Ai||s instanceof ji)&&s.upload(e)}this.updatePaintBuffers()},wi.prototype.destroy=function(){for(var e in this.binders){var r=this.binders[e];(r instanceof zi||r instanceof Ai||r instanceof ji)&&r.destroy()}};var gi=function(e,r,s){s===void 0&&(s=function(){return!0}),this.programConfigurations={};for(var _=0,w=e;_<w.length;_+=1){var C=w[_];this.programConfigurations[C.id]=new wi(C,r,s)}this.needsUpload=!1,this._featureMap=new Fe,this._bufferOffset=0};function hn(e,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(r+"-","").replace(/-/g,"_")]}function En(e,r,s){var _={color:{source:ue,composite:Oi},number:{source:Pt,composite:ue}},w=function(C){return{"line-pattern":{source:ve,composite:ve},"fill-pattern":{source:ve,composite:ve},"fill-extrusion-pattern":{source:ve,composite:ve}}[C]}(e);return w&&w[s]||_[r][s]}gi.prototype.populatePaintArrays=function(e,r,s,_,w,C){for(var i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(e,r,_,w,C);r.id!==void 0&&this._featureMap.add(r.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},gi.prototype.updatePaintArrays=function(e,r,s,_){for(var w=0,C=s;w<C.length;w+=1){var i=C[w];this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(e,this._featureMap,r,i,_)||this.needsUpload}},gi.prototype.get=function(e){return this.programConfigurations[e]},gi.prototype.upload=function(e){if(this.needsUpload){for(var r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}},gi.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},ni("ConstantBinder",Di),ni("CrossFadedConstantBinder",er),ni("SourceExpressionBinder",zi),ni("CrossFadedCompositeBinder",ji),ni("CompositeExpressionBinder",Ai),ni("ProgramConfiguration",wi,{omit:["_buffers"]}),ni("ProgramConfigurationSet",gi);var Ln=Math.pow(2,14)-1,yo=-Ln-1;function yn(e){for(var r=8192/e.extent,s=e.loadGeometry(),_=0;_<s.length;_++)for(var w=s[_],C=0;C<w.length;C++){var i=w[C],t=Math.round(i.x*r),o=Math.round(i.y*r);i.x=We(t,yo,Ln),i.y=We(o,yo,Ln),(t<i.x||t>i.x+1||o<i.y||o>i.y+1)&&Xt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return s}function lr(e,r){return{type:e.type,id:e.id,properties:e.properties,geometry:r?yn(e):[]}}function Ho(e,r,s,_,w){e.emplaceBack(2*r+(_+1)/2,2*s+(w+1)/2)}var Oo=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Z,this.indexArray=new xt,this.segments=new de,this.programConfigurations=new gi(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function _a(e,r){for(var s=0;s<e.length;s++)if(Ps(r,e[s]))return!0;for(var _=0;_<r.length;_++)if(Ps(e,r[_]))return!0;return!!Pu(e,r)}function Jn(e,r,s){return!!Ps(e,r)||!!tl(r,e,s)}function va(e,r){if(e.length===1)return tu(r,e[0]);for(var s=0;s<r.length;s++)for(var _=r[s],w=0;w<_.length;w++)if(Ps(e,_[w]))return!0;for(var C=0;C<e.length;C++)if(tu(r,e[C]))return!0;for(var i=0;i<r.length;i++)if(Pu(e,r[i]))return!0;return!1}function xa(e,r,s){if(e.length>1){if(Pu(e,r))return!0;for(var _=0;_<r.length;_++)if(tl(r[_],e,s))return!0}for(var w=0;w<e.length;w++)if(tl(e[w],r,s))return!0;return!1}function Pu(e,r){if(e.length===0||r.length===0)return!1;for(var s=0;s<e.length-1;s++)for(var _=e[s],w=e[s+1],C=0;C<r.length-1;C++)if(Mu(_,w,r[C],r[C+1]))return!0;return!1}function Mu(e,r,s,_){return Qt(e,s,_)!==Qt(r,s,_)&&Qt(e,r,s)!==Qt(e,r,_)}function tl(e,r,s){var _=s*s;if(r.length===1)return e.distSqr(r[0])<_;for(var w=1;w<r.length;w++)if(Lu(e,r[w-1],r[w])<_)return!0;return!1}function Lu(e,r,s){var _=r.distSqr(s);if(_===0)return e.distSqr(r);var w=((e.x-r.x)*(s.x-r.x)+(e.y-r.y)*(s.y-r.y))/_;return e.distSqr(w<0?r:w>1?s:s.sub(r)._mult(w)._add(r))}function tu(e,r){for(var s,_,w,C=!1,i=0;i<e.length;i++)for(var t=0,o=(s=e[i]).length-1;t<s.length;o=t++)(_=s[t]).y>r.y!=(w=s[o]).y>r.y&&r.x<(w.x-_.x)*(r.y-_.y)/(w.y-_.y)+_.x&&(C=!C);return C}function Ps(e,r){for(var s=!1,_=0,w=e.length-1;_<e.length;w=_++){var C=e[_],i=e[w];C.y>r.y!=i.y>r.y&&r.x<(i.x-C.x)*(r.y-C.y)/(i.y-C.y)+C.x&&(s=!s)}return s}function iu(e,r,s){var _=s[0],w=s[2];if(e.x<_.x&&r.x<_.x||e.x>w.x&&r.x>w.x||e.y<_.y&&r.y<_.y||e.y>w.y&&r.y>w.y)return!1;var C=Qt(e,r,s[0]);return C!==Qt(e,r,s[1])||C!==Qt(e,r,s[2])||C!==Qt(e,r,s[3])}function ds(e,r,s){var _=r.paint.get(e).value;return _.kind==="constant"?_.value:s.programConfigurations.get(r.id).getMaxValue(e)}function Yn(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function ba(e,r,s,_,w){if(!r[0]&&!r[1])return e;var C=V.convert(r)._mult(w);s==="viewport"&&C._rotate(-_);for(var i=[],t=0;t<e.length;t++)i.push(e[t].sub(C));return i}Oo.prototype.populate=function(e,r,s){var _=this.layers[0],w=[],C=null;_.type==="circle"&&(C=_.layout.get("circle-sort-key"));for(var i=0,t=e;i<t.length;i+=1){var o=t[i],h=o.feature,g=o.id,b=o.index,E=o.sourceLayerIndex,z=this.layers[0]._featureFilter.needGeometry,D=lr(h,z);if(this.layers[0]._featureFilter.filter(new Ut(this.zoom),D,s)){var O=C?C.evaluate(D,{},s):void 0,N={id:g,properties:h.properties,type:h.type,sourceLayerIndex:E,index:b,geometry:z?D.geometry:yn(h),patterns:{},sortKey:O};w.push(N)}}C&&w.sort(function(Be,je){return Be.sortKey-je.sortKey});for(var U=0,K=w;U<K.length;U+=1){var $=K[U],Q=$.geometry,se=$.index,pe=$.sourceLayerIndex,Ae=e[se].feature;this.addFeature($,Q,se,s),r.featureIndex.insert(Ae,Q,se,pe,this.index)}},Oo.prototype.update=function(e,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s)},Oo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Oo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Oo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,he),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Oo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Oo.prototype.addFeature=function(e,r,s,_){for(var w=0,C=r;w<C.length;w+=1)for(var i=0,t=C[w];i<t.length;i+=1){var o=t[i],h=o.x,g=o.y;if(!(h<0||h>=8192||g<0||g>=8192)){var b=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),E=b.vertexLength;Ho(this.layoutVertexArray,h,g,-1,-1),Ho(this.layoutVertexArray,h,g,1,-1),Ho(this.layoutVertexArray,h,g,1,1),Ho(this.layoutVertexArray,h,g,-1,1),this.indexArray.emplaceBack(E,E+1,E+2),this.indexArray.emplaceBack(E,E+3,E+2),b.vertexLength+=4,b.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},_)},ni("CircleBucket",Oo,{omit:["layers"]});var Tl=new S({"circle-sort-key":new qt(ye.layout_circle["circle-sort-key"])}),fs={paint:new S({"circle-radius":new qt(ye.paint_circle["circle-radius"]),"circle-color":new qt(ye.paint_circle["circle-color"]),"circle-blur":new qt(ye.paint_circle["circle-blur"]),"circle-opacity":new qt(ye.paint_circle["circle-opacity"]),"circle-translate":new Gt(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new Gt(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Gt(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Gt(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new qt(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new qt(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new qt(ye.paint_circle["circle-stroke-opacity"])}),layout:Tl},gr=typeof Float32Array!="undefined"?Float32Array:Array;function Wo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function sa(e,r,s){var _=r[0],w=r[1],C=r[2],i=r[3],t=r[4],o=r[5],h=r[6],g=r[7],b=r[8],E=r[9],z=r[10],D=r[11],O=r[12],N=r[13],U=r[14],K=r[15],$=s[0],Q=s[1],se=s[2],pe=s[3];return e[0]=$*_+Q*t+se*b+pe*O,e[1]=$*w+Q*o+se*E+pe*N,e[2]=$*C+Q*h+se*z+pe*U,e[3]=$*i+Q*g+se*D+pe*K,e[4]=($=s[4])*_+(Q=s[5])*t+(se=s[6])*b+(pe=s[7])*O,e[5]=$*w+Q*o+se*E+pe*N,e[6]=$*C+Q*h+se*z+pe*U,e[7]=$*i+Q*g+se*D+pe*K,e[8]=($=s[8])*_+(Q=s[9])*t+(se=s[10])*b+(pe=s[11])*O,e[9]=$*w+Q*o+se*E+pe*N,e[10]=$*C+Q*h+se*z+pe*U,e[11]=$*i+Q*g+se*D+pe*K,e[12]=($=s[12])*_+(Q=s[13])*t+(se=s[14])*b+(pe=s[15])*O,e[13]=$*w+Q*o+se*E+pe*N,e[14]=$*C+Q*h+se*z+pe*U,e[15]=$*i+Q*g+se*D+pe*K,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,r=0,s=arguments.length;s--;)r+=e[s]*e[s];return Math.sqrt(r)});var ru,Du=sa;function Ru(e,r,s){var _=r[0],w=r[1],C=r[2],i=r[3];return e[0]=s[0]*_+s[4]*w+s[8]*C+s[12]*i,e[1]=s[1]*_+s[5]*w+s[9]*C+s[13]*i,e[2]=s[2]*_+s[6]*w+s[10]*C+s[14]*i,e[3]=s[3]*_+s[7]*w+s[11]*C+s[15]*i,e}ru=new gr(3),gr!=Float32Array&&(ru[0]=0,ru[1]=0,ru[2]=0),function(){var e=new gr(4);gr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var tp=(function(){var e=new gr(2);gr!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function r(s){e.call(this,s,fs)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.createBucket=function(s){return new Oo(s)},r.prototype.queryRadius=function(s){var _=s;return ds("circle-radius",this,_)+ds("circle-stroke-width",this,_)+Yn(this.paint.get("circle-translate"))},r.prototype.queryIntersectsFeature=function(s,_,w,C,i,t,o,h){for(var g=ba(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),t.angle,o),b=this.paint.get("circle-radius").evaluate(_,w)+this.paint.get("circle-stroke-width").evaluate(_,w),E=this.paint.get("circle-pitch-alignment")==="map",z=E?g:function(Ae,Be){return Ae.map(function(je){return il(je,Be)})}(g,h),D=E?b*o:b,O=0,N=C;O<N.length;O+=1)for(var U=0,K=N[O];U<K.length;U+=1){var $=K[U],Q=E?$:il($,h),se=D,pe=Ru([],[$.x,$.y,0,1],h);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?se*=pe[3]/t.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(se*=t.cameraToCenterDistance/pe[3]),Jn(z,Q,se))return!0}return!1},r}(n));function il(e,r){var s=Ru([],[e.x,e.y,0,1],r);return new V(s[0]/s[3],s[1]/s[3])}var ip=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r}(Oo);function rl(e,r,s,_){var w=r.width,C=r.height;if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==w*C*s)throw new RangeError("mismatched image size")}else _=new Uint8Array(w*C*s);return e.width=w,e.height=C,e.data=_,e}function cc(e,r,s){var _=r.width,w=r.height;if(_!==e.width||w!==e.height){var C=rl({},{width:_,height:w},s);rp(e,C,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,_),height:Math.min(e.height,w)},s),e.width=_,e.height=w,e.data=C.data}}function rp(e,r,s,_,w,C){if(w.width===0||w.height===0)return r;if(w.width>e.width||w.height>e.height||s.x>e.width-w.width||s.y>e.height-w.height)throw new RangeError("out of range source coordinates for image copy");if(w.width>r.width||w.height>r.height||_.x>r.width-w.width||_.y>r.height-w.height)throw new RangeError("out of range destination coordinates for image copy");for(var i=e.data,t=r.data,o=0;o<w.height;o++)for(var h=((s.y+o)*e.width+s.x)*C,g=((_.y+o)*r.width+_.x)*C,b=0;b<w.width*C;b++)t[g+b]=i[h+b];return r}ni("HeatmapBucket",ip,{omit:["layers"]});var hc=function(e,r){rl(this,e,1,r)};hc.prototype.resize=function(e){cc(this,e,1)},hc.prototype.clone=function(){return new hc({width:this.width,height:this.height},new Uint8Array(this.data))},hc.copy=function(e,r,s,_,w){rp(e,r,s,_,w,1)};var Xo=function(e,r){rl(this,e,4,r)};Xo.prototype.resize=function(e){cc(this,e,4)},Xo.prototype.replace=function(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Xo.prototype.clone=function(){return new Xo({width:this.width,height:this.height},new Uint8Array(this.data))},Xo.copy=function(e,r,s,_,w){rp(e,r,s,_,w,4)},ni("AlphaImage",hc),ni("RGBAImage",Xo);var Gd={paint:new S({"heatmap-radius":new qt(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new qt(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Gt(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Bo(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Gt(ye.paint_heatmap["heatmap-opacity"])})};function np(e){var r={},s=e.resolution||256,_=e.clips?e.clips.length:1,w=e.image||new Xo({width:s,height:_}),C=function(D,O,N){r[e.evaluationKey]=N;var U=e.expression.evaluate(r);w.data[D+O+0]=Math.floor(255*U.r/U.a),w.data[D+O+1]=Math.floor(255*U.g/U.a),w.data[D+O+2]=Math.floor(255*U.b/U.a),w.data[D+O+3]=Math.floor(255*U.a)};if(e.clips)for(var i=0,t=0;i<_;++i,t+=4*s)for(var o=0,h=0;o<s;o++,h+=4){var g=o/(s-1),b=e.clips[i];C(t,h,b.start*(1-g)+b.end*g)}else for(var E=0,z=0;E<s;E++,z+=4)C(0,z,E/(s-1));return w}var _h=function(e){function r(s){e.call(this,s,Gd),this._updateColorRamp()}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.createBucket=function(s){return new ip(s)},r.prototype._handleSpecialPaintPropertyUpdate=function(s){s==="heatmap-color"&&this._updateColorRamp()},r.prototype._updateColorRamp=function(){this.colorRamp=np({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},r.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},r.prototype.queryRadius=function(){return 0},r.prototype.queryIntersectsFeature=function(){return!1},r.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},r}(n),ms={paint:new S({"hillshade-illumination-direction":new Gt(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Gt(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Gt(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Gt(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Gt(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Gt(ye.paint_hillshade["hillshade-accent-color"])})},Zd=function(e){function r(s){e.call(this,s,ms)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},r}(n),_m=M([{name:"a_pos",components:2,type:"Int16"}],4).members,Hp=Oc,vm=Oc;function Oc(e,r,s){s=s||2;var _,w,C,i,t,o,h,g=r&&r.length,b=g?r[0]*s:e.length,E=vh(e,0,b,s,!0),z=[];if(!E||E.next===E.prev)return z;if(g&&(E=function(O,N,U,K){var $,Q,se,pe=[];for($=0,Q=N.length;$<Q;$++)(se=vh(O,N[$]*K,$<Q-1?N[$+1]*K:O.length,K,!1))===se.next&&(se.steiner=!0),pe.push(Xp(se));for(pe.sort(Em),$=0;$<pe.length;$++)Im(pe[$],U),U=nu(U,U.next);return U}(e,r,E,s)),e.length>80*s){_=C=e[0],w=i=e[1];for(var D=s;D<b;D+=s)(t=e[D])<_&&(_=t),(o=e[D+1])<w&&(w=o),t>C&&(C=t),o>i&&(i=o);h=(h=Math.max(C-_,i-w))!==0?1/h:0}return Ms(E,z,s,_,w,h),z}function vh(e,r,s,_,w){var C,i;if(w===Eh(e,r,s,_)>0)for(C=r;C<s;C+=_)i=Kp(C,e[C],e[C+1],i);else for(C=s-_;C>=r;C-=_)i=Kp(C,e[C],e[C+1],i);return i&&An(i,i.next)&&(jc(i),i=i.next),i}function nu(e,r){if(!e)return e;r||(r=e);var s,_=e;do if(s=!1,_.steiner||!An(_,_.next)&&$n(_.prev,_,_.next)!==0)_=_.next;else{if(jc(_),(_=r=_.prev)===_.next)break;s=!0}while(s||_!==r);return r}function Ms(e,r,s,_,w,C,i){if(e){!i&&C&&function(g,b,E,z){var D=g;do D.z===null&&(D.z=Wp(D.x,D.y,b,E,z)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==g);D.prevZ.nextZ=null,D.prevZ=null,function(O){var N,U,K,$,Q,se,pe,Ae,Be=1;do{for(U=O,O=null,Q=null,se=0;U;){for(se++,K=U,pe=0,N=0;N<Be&&(pe++,K=K.nextZ);N++);for(Ae=Be;pe>0||Ae>0&&K;)pe!==0&&(Ae===0||!K||U.z<=K.z)?($=U,U=U.nextZ,pe--):($=K,K=K.nextZ,Ae--),Q?Q.nextZ=$:O=$,$.prevZ=Q,Q=$;U=K}Q.nextZ=null,Be*=2}while(se>1)}(D)}(e,_,w,C);for(var t,o,h=e;e.prev!==e.next;)if(t=e.prev,o=e.next,C?xm(e,_,w,C):xh(e))r.push(t.i/s),r.push(e.i/s),r.push(o.i/s),jc(e),e=o.next,h=o.next;else if((e=o)===h){i?i===1?Ms(e=bm(nu(e),r,s),r,s,_,w,C,2):i===2&&wm(e,r,s,_,w,C):Ms(nu(e),r,s,_,w,C,1);break}}}function xh(e){var r=e.prev,s=e,_=e.next;if($n(r,s,_)>=0)return!1;for(var w=e.next.next;w!==e.prev;){if(Fc(r.x,r.y,s.x,s.y,_.x,_.y,w.x,w.y)&&$n(w.prev,w,w.next)>=0)return!1;w=w.next}return!0}function xm(e,r,s,_){var w=e.prev,C=e,i=e.next;if($n(w,C,i)>=0)return!1;for(var t=w.x>C.x?w.x>i.x?w.x:i.x:C.x>i.x?C.x:i.x,o=w.y>C.y?w.y>i.y?w.y:i.y:C.y>i.y?C.y:i.y,h=Wp(w.x<C.x?w.x<i.x?w.x:i.x:C.x<i.x?C.x:i.x,w.y<C.y?w.y<i.y?w.y:i.y:C.y<i.y?C.y:i.y,r,s,_),g=Wp(t,o,r,s,_),b=e.prevZ,E=e.nextZ;b&&b.z>=h&&E&&E.z<=g;){if(b!==e.prev&&b!==e.next&&Fc(w.x,w.y,C.x,C.y,i.x,i.y,b.x,b.y)&&$n(b.prev,b,b.next)>=0||(b=b.prevZ,E!==e.prev&&E!==e.next&&Fc(w.x,w.y,C.x,C.y,i.x,i.y,E.x,E.y)&&$n(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;b&&b.z>=h;){if(b!==e.prev&&b!==e.next&&Fc(w.x,w.y,C.x,C.y,i.x,i.y,b.x,b.y)&&$n(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;E&&E.z<=g;){if(E!==e.prev&&E!==e.next&&Fc(w.x,w.y,C.x,C.y,i.x,i.y,E.x,E.y)&&$n(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function bm(e,r,s){var _=e;do{var w=_.prev,C=_.next.next;!An(w,C)&&bh(w,_,_.next,C)&&Bu(w,C)&&Bu(C,w)&&(r.push(w.i/s),r.push(_.i/s),r.push(C.i/s),jc(_),jc(_.next),_=e=C),_=_.next}while(_!==e);return nu(_)}function wm(e,r,s,_,w,C){var i=e;do{for(var t=i.next.next;t!==i.prev;){if(i.i!==t.i&&Uc(i,t)){var o=Nc(i,t);return i=nu(i,i.next),o=nu(o,o.next),Ms(i,r,s,_,w,C),void Ms(o,r,s,_,w,C)}t=t.next}i=i.next}while(i!==e)}function Em(e,r){return e.x-r.x}function Im(e,r){if(r=function(_,w){var C,i=w,t=_.x,o=_.y,h=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var g=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(g<=t&&g>h){if(h=g,g===t){if(o===i.y)return i;if(o===i.next.y)return i.next}C=i.x<i.next.x?i:i.next}}i=i.next}while(i!==w);if(!C)return null;if(t===h)return C;var b,E=C,z=C.x,D=C.y,O=1/0;i=C;do t>=i.x&&i.x>=z&&t!==i.x&&Fc(o<D?t:h,o,z,D,o<D?h:t,o,i.x,i.y)&&(b=Math.abs(o-i.y)/(t-i.x),Bu(i,_)&&(b<O||b===O&&(i.x>C.x||i.x===C.x&&Sm(C,i)))&&(C=i,O=b)),i=i.next;while(i!==E);return C}(e,r)){var s=Nc(r,e);nu(r,r.next),nu(s,s.next)}}function Sm(e,r){return $n(e.prev,e,r.prev)<0&&$n(r.next,e,e.next)<0}function Wp(e,r,s,_,w){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)*w)|e<<8))|e<<4))|e<<2))|e<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-_)*w)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function Xp(e){var r=e,s=e;do(r.x<s.x||r.x===s.x&&r.y<s.y)&&(s=r),r=r.next;while(r!==e);return s}function Fc(e,r,s,_,w,C,i,t){return(w-i)*(r-t)-(e-i)*(C-t)>=0&&(e-i)*(_-t)-(s-i)*(r-t)>=0&&(s-i)*(C-t)-(w-i)*(_-t)>=0}function Uc(e,r){return e.next.i!==r.i&&e.prev.i!==r.i&&!function(s,_){var w=s;do{if(w.i!==s.i&&w.next.i!==s.i&&w.i!==_.i&&w.next.i!==_.i&&bh(w,w.next,s,_))return!0;w=w.next}while(w!==s);return!1}(e,r)&&(Bu(e,r)&&Bu(r,e)&&function(s,_){var w=s,C=!1,i=(s.x+_.x)/2,t=(s.y+_.y)/2;do w.y>t!=w.next.y>t&&w.next.y!==w.y&&i<(w.next.x-w.x)*(t-w.y)/(w.next.y-w.y)+w.x&&(C=!C),w=w.next;while(w!==s);return C}(e,r)&&($n(e.prev,e,r.prev)||$n(e,r.prev,r))||An(e,r)&&$n(e.prev,e,e.next)>0&&$n(r.prev,r,r.next)>0)}function $n(e,r,s){return(r.y-e.y)*(s.x-r.x)-(r.x-e.x)*(s.y-r.y)}function An(e,r){return e.x===r.x&&e.y===r.y}function bh(e,r,s,_){var w=pc($n(e,r,s)),C=pc($n(e,r,_)),i=pc($n(s,_,e)),t=pc($n(s,_,r));return w!==C&&i!==t||!(w!==0||!wh(e,s,r))||!(C!==0||!wh(e,_,r))||!(i!==0||!wh(s,e,_))||!(t!==0||!wh(s,r,_))}function wh(e,r,s){return r.x<=Math.max(e.x,s.x)&&r.x>=Math.min(e.x,s.x)&&r.y<=Math.max(e.y,s.y)&&r.y>=Math.min(e.y,s.y)}function pc(e){return e>0?1:e<0?-1:0}function Bu(e,r){return $n(e.prev,e,e.next)<0?$n(e,r,e.next)>=0&&$n(e,e.prev,r)>=0:$n(e,r,e.prev)<0||$n(e,e.next,r)<0}function Nc(e,r){var s=new dc(e.i,e.x,e.y),_=new dc(r.i,r.x,r.y),w=e.next,C=r.prev;return e.next=r,r.prev=e,s.next=w,w.prev=s,_.next=s,s.prev=_,C.next=_,_.prev=C,_}function Kp(e,r,s,_){var w=new dc(e,r,s);return _?(w.next=_.next,w.prev=_,_.next.prev=w,_.next=w):(w.prev=w,w.next=w),w}function jc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function dc(e,r,s){this.i=e,this.x=r,this.y=s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Eh(e,r,s,_){for(var w=0,C=r,i=s-_;C<s;C+=_)w+=(e[i]-e[C])*(e[C+1]+e[i+1]),i=C;return w}function Jp(e,r,s,_,w){(function C(i,t,o,h,g){for(;h>o;){if(h-o>600){var b=h-o+1,E=t-o+1,z=Math.log(b),D=.5*Math.exp(2*z/3),O=.5*Math.sqrt(z*D*(b-D)/b)*(E-b/2<0?-1:1);C(i,t,Math.max(o,Math.floor(t-E*D/b+O)),Math.min(h,Math.floor(t+(b-E)*D/b+O)),g)}var N=i[t],U=o,K=h;for(Vc(i,o,t),g(i[h],N)>0&&Vc(i,o,h);U<K;){for(Vc(i,U,K),U++,K--;g(i[U],N)<0;)U++;for(;g(i[K],N)>0;)K--}g(i[o],N)===0?Vc(i,o,K):Vc(i,++K,h),K<=t&&(o=K+1),t<=K&&(h=K-1)}})(e,r,s||0,_||e.length-1,w||Tm)}function Vc(e,r,s){var _=e[r];e[r]=e[s],e[s]=_}function Tm(e,r){return e<r?-1:e>r?1:0}function op(e,r){var s=e.length;if(s<=1)return[e];for(var _,w,C=[],i=0;i<s;i++){var t=Ei(e[i]);t!==0&&(e[i].area=Math.abs(t),w===void 0&&(w=t<0),w===t<0?(_&&C.push(_),_=[e[i]]):_.push(e[i]))}if(_&&C.push(_),r>1)for(var o=0;o<C.length;o++)C[o].length<=r||(Jp(C[o],r,1,C[o].length-1,Ih),C[o]=C[o].slice(0,r));return C}function Ih(e,r){return r.area-e.area}function Yp(e,r,s){for(var _=s.patternDependencies,w=!1,C=0,i=r;C<i.length;C+=1){var t=i[C].paint.get(e+"-pattern");t.isConstant()||(w=!0);var o=t.constantOr(null);o&&(w=!0,_[o.to]=!0,_[o.from]=!0)}return w}function Sh(e,r,s,_,w){for(var C=w.patternDependencies,i=0,t=r;i<t.length;i+=1){var o=t[i],h=o.paint.get(e+"-pattern").value;if(h.kind!=="constant"){var g=h.evaluate({zoom:_-1},s,{},w.availableImages),b=h.evaluate({zoom:_},s,{},w.availableImages),E=h.evaluate({zoom:_+1},s,{},w.availableImages);b=b&&b.name?b.name:b,E=E&&E.name?E.name:E,C[g=g&&g.name?g.name:g]=!0,C[b]=!0,C[E]=!0,s.patterns[o.id]={min:g,mid:b,max:E}}}return s}Oc.deviation=function(e,r,s,_){var w=r&&r.length,C=Math.abs(Eh(e,0,w?r[0]*s:e.length,s));if(w)for(var i=0,t=r.length;i<t;i++)C-=Math.abs(Eh(e,r[i]*s,i<t-1?r[i+1]*s:e.length,s));var o=0;for(i=0;i<_.length;i+=3){var h=_[i]*s,g=_[i+1]*s,b=_[i+2]*s;o+=Math.abs((e[h]-e[b])*(e[g+1]-e[h+1])-(e[h]-e[g])*(e[b+1]-e[h+1]))}return C===0&&o===0?0:Math.abs((o-C)/C)},Oc.flatten=function(e){for(var r=e[0][0].length,s={vertices:[],holes:[],dimensions:r},_=0,w=0;w<e.length;w++){for(var C=0;C<e[w].length;C++)for(var i=0;i<r;i++)s.vertices.push(e[w][C][i]);w>0&&s.holes.push(_+=e[w-1].length)}return s},Hp.default=vm;var nl=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Z,this.indexArray=new xt,this.indexArray2=new ci,this.programConfigurations=new gi(e.layers,e.zoom),this.segments=new de,this.segments2=new de,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};nl.prototype.populate=function(e,r,s){this.hasPattern=Yp("fill",this.layers,r);for(var _=this.layers[0].layout.get("fill-sort-key"),w=[],C=0,i=e;C<i.length;C+=1){var t=i[C],o=t.feature,h=t.id,g=t.index,b=t.sourceLayerIndex,E=this.layers[0]._featureFilter.needGeometry,z=lr(o,E);if(this.layers[0]._featureFilter.filter(new Ut(this.zoom),z,s)){var D=_?_.evaluate(z,{},s,r.availableImages):void 0,O={id:h,properties:o.properties,type:o.type,sourceLayerIndex:b,index:g,geometry:E?z.geometry:yn(o),patterns:{},sortKey:D};w.push(O)}}_&&w.sort(function(Ae,Be){return Ae.sortKey-Be.sortKey});for(var N=0,U=w;N<U.length;N+=1){var K=U[N],$=K.geometry,Q=K.index,se=K.sourceLayerIndex;if(this.hasPattern){var pe=Sh("fill",this.layers,K,this.zoom,r);this.patternFeatures.push(pe)}else this.addFeature(K,$,Q,s,{});r.featureIndex.insert(e[Q].feature,$,Q,se,this.index)}},nl.prototype.update=function(e,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s)},nl.prototype.addFeatures=function(e,r,s){for(var _=0,w=this.patternFeatures;_<w.length;_+=1){var C=w[_];this.addFeature(C,C.geometry,C.index,r,s)}},nl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},nl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},nl.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_m),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},nl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},nl.prototype.addFeature=function(e,r,s,_,w){for(var C=0,i=op(r,500);C<i.length;C+=1){for(var t=i[C],o=0,h=0,g=t;h<g.length;h+=1)o+=g[h].length;for(var b=this.segments.prepareSegment(o,this.layoutVertexArray,this.indexArray),E=b.vertexLength,z=[],D=[],O=0,N=t;O<N.length;O+=1){var U=N[O];if(U.length!==0){U!==t[0]&&D.push(z.length/2);var K=this.segments2.prepareSegment(U.length,this.layoutVertexArray,this.indexArray2),$=K.vertexLength;this.layoutVertexArray.emplaceBack(U[0].x,U[0].y),this.indexArray2.emplaceBack($+U.length-1,$),z.push(U[0].x),z.push(U[0].y);for(var Q=1;Q<U.length;Q++)this.layoutVertexArray.emplaceBack(U[Q].x,U[Q].y),this.indexArray2.emplaceBack($+Q-1,$+Q),z.push(U[Q].x),z.push(U[Q].y);K.vertexLength+=U.length,K.primitiveLength+=U.length}}for(var se=Hp(z,D),pe=0;pe<se.length;pe+=3)this.indexArray.emplaceBack(E+se[pe],E+se[pe+1],E+se[pe+2]);b.vertexLength+=o,b.primitiveLength+=se.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,w,_)},ni("FillBucket",nl,{omit:["layers","patternFeatures"]});var $p=new S({"fill-sort-key":new qt(ye.layout_fill["fill-sort-key"])}),Qp={paint:new S({"fill-antialias":new Gt(ye.paint_fill["fill-antialias"]),"fill-opacity":new qt(ye.paint_fill["fill-opacity"]),"fill-color":new qt(ye.paint_fill["fill-color"]),"fill-outline-color":new qt(ye.paint_fill["fill-outline-color"]),"fill-translate":new Gt(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new Gt(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new eu(ye.paint_fill["fill-pattern"])}),layout:$p},ed=function(e){function r(s){e.call(this,s,Qp)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.recalculate=function(s,_){e.prototype.recalculate.call(this,s,_);var w=this.paint._values["fill-outline-color"];w.value.kind==="constant"&&w.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},r.prototype.createBucket=function(s){return new nl(s)},r.prototype.queryRadius=function(){return Yn(this.paint.get("fill-translate"))},r.prototype.queryIntersectsFeature=function(s,_,w,C,i,t,o){return va(ba(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),t.angle,o),C)},r.prototype.isTileClipped=function(){return!0},r}(n),Am=M([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Hd=qc;function qc(e,r,s,_,w){this.properties={},this.extent=s,this.type=0,this._pbf=e,this._geometry=-1,this._keys=_,this._values=w,e.readFields(Cm,this,r)}function Cm(e,r,s){e==1?r.id=s.readVarint():e==2?function(_,w){for(var C=_.readVarint()+_.pos;_.pos<C;){var i=w._keys[_.readVarint()],t=w._values[_.readVarint()];w.properties[i]=t}}(s,r):e==3?r.type=s.readVarint():e==4&&(r._geometry=s.pos)}function Ou(e){for(var r,s,_=0,w=0,C=e.length,i=C-1;w<C;i=w++)_+=((s=e[i]).x-(r=e[w]).x)*(r.y+s.y);return _}qc.types=["Unknown","Point","LineString","Polygon"],qc.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var r,s=e.readVarint()+e.pos,_=1,w=0,C=0,i=0,t=[];e.pos<s;){if(w<=0){var o=e.readVarint();_=7&o,w=o>>3}if(w--,_===1||_===2)C+=e.readSVarint(),i+=e.readSVarint(),_===1&&(r&&t.push(r),r=[]),r.push(new V(C,i));else{if(_!==7)throw new Error("unknown command "+_);r&&r.push(r[0].clone())}}return r&&t.push(r),t},qc.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var r=e.readVarint()+e.pos,s=1,_=0,w=0,C=0,i=1/0,t=-1/0,o=1/0,h=-1/0;e.pos<r;){if(_<=0){var g=e.readVarint();s=7&g,_=g>>3}if(_--,s===1||s===2)(w+=e.readSVarint())<i&&(i=w),w>t&&(t=w),(C+=e.readSVarint())<o&&(o=C),C>h&&(h=C);else if(s!==7)throw new Error("unknown command "+s)}return[i,o,t,h]},qc.prototype.toGeoJSON=function(e,r,s){var _,w,C=this.extent*Math.pow(2,s),i=this.extent*e,t=this.extent*r,o=this.loadGeometry(),h=qc.types[this.type];function g(z){for(var D=0;D<z.length;D++){var O=z[D];z[D]=[360*(O.x+i)/C-180,360/Math.PI*Math.atan(Math.exp((180-360*(O.y+t)/C)*Math.PI/180))-90]}}switch(this.type){case 1:var b=[];for(_=0;_<o.length;_++)b[_]=o[_][0];g(o=b);break;case 2:for(_=0;_<o.length;_++)g(o[_]);break;case 3:for(o=function(z){var D=z.length;if(D<=1)return[z];for(var O,N,U=[],K=0;K<D;K++){var $=Ou(z[K]);$!==0&&(N===void 0&&(N=$<0),N===$<0?(O&&U.push(O),O=[z[K]]):O.push(z[K]))}return O&&U.push(O),U}(o),_=0;_<o.length;_++)for(w=0;w<o[_].length;w++)g(o[_][w])}o.length===1?o=o[0]:h="Multi"+h;var E={type:"Feature",geometry:{type:h,coordinates:o},properties:this.properties};return"id"in this&&(E.id=this.id),E};var Wd=td;function td(e,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Gc,this,r),this.length=this._features.length}function Gc(e,r,s){e===15?r.version=s.readVarint():e===1?r.name=s.readString():e===5?r.extent=s.readVarint():e===2?r._features.push(s.pos):e===3?r._keys.push(s.readString()):e===4&&r._values.push(function(_){for(var w=null,C=_.readVarint()+_.pos;_.pos<C;){var i=_.readVarint()>>3;w=i===1?_.readString():i===2?_.readFloat():i===3?_.readDouble():i===4?_.readVarint64():i===5?_.readVarint():i===6?_.readSVarint():i===7?_.readBoolean():null}return w}(s))}function km(e,r,s){if(e===3){var _=new Wd(s,s.readVarint()+s.pos);_.length&&(r[_.name]=_)}}td.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var r=this._pbf.readVarint()+this._pbf.pos;return new Hd(this._pbf,r,this.extent,this._keys,this._values)};var Zc={VectorTile:function(e,r){this.layers=e.readFields(km,{},r)},VectorTileFeature:Hd,VectorTileLayer:Wd},zm=Zc.VectorTileFeature.types,ap=Math.pow(2,13);function Hc(e,r,s,_,w,C,i,t){e.emplaceBack(r,s,2*Math.floor(_*ap)+i,w*ap*2,C*ap*2,Math.round(t))}var ol=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ee,this.indexArray=new xt,this.programConfigurations=new gi(e.layers,e.zoom),this.segments=new de,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function Pm(e,r){return e.x===r.x&&(e.x<0||e.x>8192)||e.y===r.y&&(e.y<0||e.y>8192)}ol.prototype.populate=function(e,r,s){this.features=[],this.hasPattern=Yp("fill-extrusion",this.layers,r);for(var _=0,w=e;_<w.length;_+=1){var C=w[_],i=C.feature,t=C.id,o=C.index,h=C.sourceLayerIndex,g=this.layers[0]._featureFilter.needGeometry,b=lr(i,g);if(this.layers[0]._featureFilter.filter(new Ut(this.zoom),b,s)){var E={id:t,sourceLayerIndex:h,index:o,geometry:g?b.geometry:yn(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(Sh("fill-extrusion",this.layers,E,this.zoom,r)):this.addFeature(E,E.geometry,o,s,{}),r.featureIndex.insert(i,E.geometry,o,h,this.index,!0)}}},ol.prototype.addFeatures=function(e,r,s){for(var _=0,w=this.features;_<w.length;_+=1){var C=w[_];this.addFeature(C,C.geometry,C.index,r,s)}},ol.prototype.update=function(e,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s)},ol.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ol.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ol.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Am),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},ol.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ol.prototype.addFeature=function(e,r,s,_,w){for(var C=0,i=op(r,500);C<i.length;C+=1){for(var t=i[C],o=0,h=0,g=t;h<g.length;h+=1)o+=g[h].length;for(var b=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),E=0,z=t;E<z.length;E+=1){var D=z[E];if(D.length!==0&&!((St=D).every(function(yt){return yt.x<0})||St.every(function(yt){return yt.x>8192})||St.every(function(yt){return yt.y<0})||St.every(function(yt){return yt.y>8192})))for(var O=0,N=0;N<D.length;N++){var U=D[N];if(N>=1){var K=D[N-1];if(!Pm(U,K)){b.vertexLength+4>de.MAX_VERTEX_ARRAY_LENGTH&&(b=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var $=U.sub(K)._perp()._unit(),Q=K.dist(U);O+Q>32768&&(O=0),Hc(this.layoutVertexArray,U.x,U.y,$.x,$.y,0,0,O),Hc(this.layoutVertexArray,U.x,U.y,$.x,$.y,0,1,O),Hc(this.layoutVertexArray,K.x,K.y,$.x,$.y,0,0,O+=Q),Hc(this.layoutVertexArray,K.x,K.y,$.x,$.y,0,1,O);var se=b.vertexLength;this.indexArray.emplaceBack(se,se+2,se+1),this.indexArray.emplaceBack(se+1,se+2,se+3),b.vertexLength+=4,b.primitiveLength+=2}}}}if(b.vertexLength+o>de.MAX_VERTEX_ARRAY_LENGTH&&(b=this.segments.prepareSegment(o,this.layoutVertexArray,this.indexArray)),zm[e.type]==="Polygon"){for(var pe=[],Ae=[],Be=b.vertexLength,je=0,Ve=t;je<Ve.length;je+=1){var it=Ve[je];if(it.length!==0){it!==t[0]&&Ae.push(pe.length/2);for(var He=0;He<it.length;He++){var Ct=it[He];Hc(this.layoutVertexArray,Ct.x,Ct.y,0,0,1,1,0),pe.push(Ct.x),pe.push(Ct.y)}}}for(var Tt=Hp(pe,Ae),ut=0;ut<Tt.length;ut+=3)this.indexArray.emplaceBack(Be+Tt[ut],Be+Tt[ut+2],Be+Tt[ut+1]);b.primitiveLength+=Tt.length/3,b.vertexLength+=o}}var St;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,w,_)},ni("FillExtrusionBucket",ol,{omit:["layers","features"]});var Mm={paint:new S({"fill-extrusion-opacity":new Gt(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qt(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Gt(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Gt(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new eu(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new qt(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qt(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Gt(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Lm=function(e){function r(s){e.call(this,s,Mm)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.createBucket=function(s){return new ol(s)},r.prototype.queryRadius=function(){return Yn(this.paint.get("fill-extrusion-translate"))},r.prototype.is3D=function(){return!0},r.prototype.queryIntersectsFeature=function(s,_,w,C,i,t,o,h){var g=ba(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),t.angle,o),b=this.paint.get("fill-extrusion-height").evaluate(_,w),E=this.paint.get("fill-extrusion-base").evaluate(_,w),z=function(O,N,U,K){for(var $=[],Q=0,se=O;Q<se.length;Q+=1){var pe=se[Q],Ae=[pe.x,pe.y,0,1];Ru(Ae,Ae,N),$.push(new V(Ae[0]/Ae[3],Ae[1]/Ae[3]))}return $}(g,h),D=function(O,N,U,K){for(var $=[],Q=[],se=K[8]*N,pe=K[9]*N,Ae=K[10]*N,Be=K[11]*N,je=K[8]*U,Ve=K[9]*U,it=K[10]*U,He=K[11]*U,Ct=0,Tt=O;Ct<Tt.length;Ct+=1){for(var ut=[],St=[],yt=0,kt=Tt[Ct];yt<kt.length;yt+=1){var dt=kt[yt],vt=dt.x,ti=dt.y,$t=K[0]*vt+K[4]*ti+K[12],Si=K[1]*vt+K[5]*ti+K[13],ki=K[2]*vt+K[6]*ti+K[14],Yi=K[3]*vt+K[7]*ti+K[15],sr=ki+Ae,Ir=Yi+Be,Sr=$t+je,dr=Si+Ve,Pr=ki+it,fr=Yi+He,Mr=new V(($t+se)/Ir,(Si+pe)/Ir);Mr.z=sr/Ir,ut.push(Mr);var Ri=new V(Sr/fr,dr/fr);Ri.z=Pr/fr,St.push(Ri)}$.push(ut),Q.push(St)}return[$,Q]}(C,E,b,h);return function(O,N,U){var K=1/0;va(U,N)&&(K=Wc(U,N[0]));for(var $=0;$<N.length;$++)for(var Q=N[$],se=O[$],pe=0;pe<Q.length-1;pe++){var Ae=Q[pe],Be=[Ae,Q[pe+1],se[pe+1],se[pe],Ae];_a(U,Be)&&(K=Math.min(K,Wc(U,Be)))}return K!==1/0&&K}(D[0],D[1],z)},r}(n);function fc(e,r){return e.x*r.x+e.y*r.y}function Wc(e,r){if(e.length===1){for(var s,_=0,w=r[_++];!s||w.equals(s);)if(!(s=r[_++]))return 1/0;for(;_<r.length;_++){var C=r[_],i=e[0],t=s.sub(w),o=C.sub(w),h=i.sub(w),g=fc(t,t),b=fc(t,o),E=fc(o,o),z=fc(h,t),D=fc(h,o),O=g*E-b*b,N=(E*z-b*D)/O,U=(g*D-b*z)/O,K=w.z*(1-N-U)+s.z*N+C.z*U;if(isFinite(K))return K}return 1/0}for(var $=1/0,Q=0,se=r;Q<se.length;Q+=1)$=Math.min($,se[Q].z);return $}var id=M([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Dm=M([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Rm=Zc.VectorTileFeature.types,Bm=Math.cos(Math.PI/180*37.5),Xc=Math.pow(2,14)/.5,Ko=function(e){var r=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(s){return s.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(s){r.gradients[s.id]={}}),this.layoutVertexArray=new re,this.layoutVertexArray2=new ue,this.indexArray=new xt,this.programConfigurations=new gi(e.layers,e.zoom),this.segments=new de,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(s){return s.isStateDependent()}).map(function(s){return s.id})};Ko.prototype.populate=function(e,r,s){this.hasPattern=Yp("line",this.layers,r);for(var _=this.layers[0].layout.get("line-sort-key"),w=[],C=0,i=e;C<i.length;C+=1){var t=i[C],o=t.feature,h=t.id,g=t.index,b=t.sourceLayerIndex,E=this.layers[0]._featureFilter.needGeometry,z=lr(o,E);if(this.layers[0]._featureFilter.filter(new Ut(this.zoom),z,s)){var D=_?_.evaluate(z,{},s):void 0,O={id:h,properties:o.properties,type:o.type,sourceLayerIndex:b,index:g,geometry:E?z.geometry:yn(o),patterns:{},sortKey:D};w.push(O)}}_&&w.sort(function(Ae,Be){return Ae.sortKey-Be.sortKey});for(var N=0,U=w;N<U.length;N+=1){var K=U[N],$=K.geometry,Q=K.index,se=K.sourceLayerIndex;if(this.hasPattern){var pe=Sh("line",this.layers,K,this.zoom,r);this.patternFeatures.push(pe)}else this.addFeature(K,$,Q,s,{});r.featureIndex.insert(e[Q].feature,$,Q,se,this.index)}},Ko.prototype.update=function(e,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,s)},Ko.prototype.addFeatures=function(e,r,s){for(var _=0,w=this.patternFeatures;_<w.length;_+=1){var C=w[_];this.addFeature(C,C.geometry,C.index,r,s)}},Ko.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ko.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ko.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Dm)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,id),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ko.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ko.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Ko.prototype.addFeature=function(e,r,s,_,w){var C=this.layers[0].layout,i=C.get("line-join").evaluate(e,{}),t=C.get("line-cap"),o=C.get("line-miter-limit"),h=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var g=0,b=r;g<b.length;g+=1)this.addLine(b[g],e,i,t,o,h);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,w,_)},Ko.prototype.addLine=function(e,r,s,_,w,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var i=0;i<e.length-1;i++)this.totalDistance+=e[i].dist(e[i+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var t=Rm[r.type]==="Polygon",o=e.length;o>=2&&e[o-1].equals(e[o-2]);)o--;for(var h=0;h<o-1&&e[h].equals(e[h+1]);)h++;if(!(o<(t?3:2))){s==="bevel"&&(w=1.05);var g,b=this.overscaling<=16?122880/(512*this.overscaling):0,E=this.segments.prepareSegment(10*o,this.layoutVertexArray,this.indexArray),z=void 0,D=void 0,O=void 0,N=void 0;this.e1=this.e2=-1,t&&(N=e[h].sub(g=e[o-2])._unit()._perp());for(var U=h;U<o;U++)if(!(D=U===o-1?t?e[h+1]:void 0:e[U+1])||!e[U].equals(D)){N&&(O=N),g&&(z=g),g=e[U],N=D?D.sub(g)._unit()._perp():O;var K=(O=O||N).add(N);K.x===0&&K.y===0||K._unit();var $=O.x*N.x+O.y*N.y,Q=K.x*N.x+K.y*N.y,se=Q!==0?1/Q:1/0,pe=2*Math.sqrt(2-2*Q),Ae=Q<Bm&&z&&D,Be=O.x*N.y-O.y*N.x>0;if(Ae&&U>h){var je=g.dist(z);if(je>2*b){var Ve=g.sub(g.sub(z)._mult(b/je)._round());this.updateDistance(z,Ve),this.addCurrentVertex(Ve,O,0,0,E),z=Ve}}var it=z&&D,He=it?s:t?"butt":_;if(it&&He==="round"&&(se<C?He="miter":se<=2&&(He="fakeround")),He==="miter"&&se>w&&(He="bevel"),He==="bevel"&&(se>2&&(He="flipbevel"),se<w&&(He="miter")),z&&this.updateDistance(z,g),He==="miter")K._mult(se),this.addCurrentVertex(g,K,0,0,E);else if(He==="flipbevel"){if(se>100)K=N.mult(-1);else{var Ct=se*O.add(N).mag()/O.sub(N).mag();K._perp()._mult(Ct*(Be?-1:1))}this.addCurrentVertex(g,K,0,0,E),this.addCurrentVertex(g,K.mult(-1),0,0,E)}else if(He==="bevel"||He==="fakeround"){var Tt=-Math.sqrt(se*se-1),ut=Be?Tt:0,St=Be?0:Tt;if(z&&this.addCurrentVertex(g,O,ut,St,E),He==="fakeround")for(var yt=Math.round(180*pe/Math.PI/20),kt=1;kt<yt;kt++){var dt=kt/yt;if(dt!==.5){var vt=dt-.5;dt+=dt*vt*(dt-1)*((1.0904+$*($*(3.55645-1.43519*$)-3.2452))*vt*vt+(.848013+$*(.215638*$-1.06021)))}var ti=N.sub(O)._mult(dt)._add(O)._unit()._mult(Be?-1:1);this.addHalfVertex(g,ti.x,ti.y,!1,Be,0,E)}D&&this.addCurrentVertex(g,N,-ut,-St,E)}else if(He==="butt")this.addCurrentVertex(g,K,0,0,E);else if(He==="square"){var $t=z?1:-1;this.addCurrentVertex(g,K,$t,$t,E)}else He==="round"&&(z&&(this.addCurrentVertex(g,O,0,0,E),this.addCurrentVertex(g,O,1,1,E,!0)),D&&(this.addCurrentVertex(g,N,-1,-1,E,!0),this.addCurrentVertex(g,N,0,0,E)));if(Ae&&U<o-1){var Si=g.dist(D);if(Si>2*b){var ki=g.add(D.sub(g)._mult(b/Si)._round());this.updateDistance(g,ki),this.addCurrentVertex(ki,N,0,0,E),g=ki}}}}},Ko.prototype.addCurrentVertex=function(e,r,s,_,w,C){C===void 0&&(C=!1);var i=r.y*_-r.x,t=-r.y-r.x*_;this.addHalfVertex(e,r.x+r.y*s,r.y-r.x*s,C,!1,s,w),this.addHalfVertex(e,i,t,C,!0,-_,w),this.distance>Xc/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,r,s,_,w,C))},Ko.prototype.addHalfVertex=function(e,r,s,_,w,C,i){var t=.5*(this.lineClips?this.scaledDistance*(Xc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(_?1:0),(e.y<<1)+(w?1:0),Math.round(63*r)+128,Math.round(63*s)+128,1+(C===0?0:C<0?-1:1)|(63&t)<<2,t>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var o=i.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,o),i.primitiveLength++),w?this.e2=o:this.e1=o},Ko.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Ko.prototype.updateDistance=function(e,r){this.distance+=e.dist(r),this.updateScaledDistance()},ni("LineBucket",Ko,{omit:["layers","patternFeatures"]});var Om=new S({"line-cap":new Gt(ye.layout_line["line-cap"]),"line-join":new qt(ye.layout_line["line-join"]),"line-miter-limit":new Gt(ye.layout_line["line-miter-limit"]),"line-round-limit":new Gt(ye.layout_line["line-round-limit"]),"line-sort-key":new qt(ye.layout_line["line-sort-key"])}),Xd={paint:new S({"line-opacity":new qt(ye.paint_line["line-opacity"]),"line-color":new qt(ye.paint_line["line-color"]),"line-translate":new Gt(ye.paint_line["line-translate"]),"line-translate-anchor":new Gt(ye.paint_line["line-translate-anchor"]),"line-width":new qt(ye.paint_line["line-width"]),"line-gap-width":new qt(ye.paint_line["line-gap-width"]),"line-offset":new qt(ye.paint_line["line-offset"]),"line-blur":new qt(ye.paint_line["line-blur"]),"line-dasharray":new Mn(ye.paint_line["line-dasharray"]),"line-pattern":new eu(ye.paint_line["line-pattern"]),"line-gradient":new Bo(ye.paint_line["line-gradient"])}),layout:Om},Kd=new(function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.possiblyEvaluate=function(s,_){return _=new Ut(Math.floor(_.zoom),{now:_.now,fadeDuration:_.fadeDuration,zoomHistory:_.zoomHistory,transition:_.transition}),e.prototype.possiblyEvaluate.call(this,s,_)},r.prototype.evaluate=function(s,_,w,C){return _=Ge({},_,{zoom:Math.floor(_.zoom)}),e.prototype.evaluate.call(this,s,_,w,C)},r}(qt))(Xd.paint.properties["line-width"].specification);Kd.useIntegerZoom=!0;var Fm=function(e){function r(s){e.call(this,s,Xd),this.gradientVersion=0}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype._handleSpecialPaintPropertyUpdate=function(s){s==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof ao,this.gradientVersion=(this.gradientVersion+1)%Me)},r.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},r.prototype.recalculate=function(s,_){e.prototype.recalculate.call(this,s,_),this.paint._values["line-floorwidth"]=Kd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)},r.prototype.createBucket=function(s){return new Ko(s)},r.prototype.queryRadius=function(s){var _=s,w=Jd(ds("line-width",this,_),ds("line-gap-width",this,_)),C=ds("line-offset",this,_);return w/2+Math.abs(C)+Yn(this.paint.get("line-translate"))},r.prototype.queryIntersectsFeature=function(s,_,w,C,i,t,o){var h=ba(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),t.angle,o),g=o/2*Jd(this.paint.get("line-width").evaluate(_,w),this.paint.get("line-gap-width").evaluate(_,w)),b=this.paint.get("line-offset").evaluate(_,w);return b&&(C=function(E,z){for(var D=[],O=new V(0,0),N=0;N<E.length;N++){for(var U=E[N],K=[],$=0;$<U.length;$++){var Q=U[$],se=U[$+1],pe=$===0?O:Q.sub(U[$-1])._unit()._perp(),Ae=$===U.length-1?O:se.sub(Q)._unit()._perp(),Be=pe._add(Ae)._unit();Be._mult(1/(Be.x*Ae.x+Be.y*Ae.y)),K.push(Be._mult(z)._add(Q))}D.push(K)}return D}(C,b*o)),function(E,z,D){for(var O=0;O<z.length;O++){var N=z[O];if(E.length>=3){for(var U=0;U<N.length;U++)if(Ps(E,N[U]))return!0}if(xa(E,N,D))return!0}return!1}(h,C,g)},r.prototype.isTileClipped=function(){return!0},r}(n);function Jd(e,r){return r>0?r+2*e:e}var Um=M([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Yd=M([{name:"a_projected_pos",components:3,type:"Float32"}],4),rd=(M([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),M([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),$d=(M([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),M([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Qd=M([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ef(e,r,s){return e.sections.forEach(function(_){_.text=function(w,C,i){var t=C.layout.get("text-transform").evaluate(i,{});return t==="uppercase"?w=w.toLocaleUpperCase():t==="lowercase"&&(w=w.toLocaleLowerCase()),ai.applyArabicShaping&&(w=ai.applyArabicShaping(w)),w}(_.text,r,s)}),e}M([{name:"triangle",components:3,type:"Uint16"}]),M([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),M([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),M([{type:"Float32",name:"offsetX"}]),M([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Kc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},tf=function(e,r,s,_,w){var C,i,t=8*w-_-1,o=(1<<t)-1,h=o>>1,g=-7,b=s?w-1:0,E=s?-1:1,z=e[r+b];for(b+=E,C=z&(1<<-g)-1,z>>=-g,g+=t;g>0;C=256*C+e[r+b],b+=E,g-=8);for(i=C&(1<<-g)-1,C>>=-g,g+=_;g>0;i=256*i+e[r+b],b+=E,g-=8);if(C===0)C=1-h;else{if(C===o)return i?NaN:1/0*(z?-1:1);i+=Math.pow(2,_),C-=h}return(z?-1:1)*i*Math.pow(2,C-_)},rf=function(e,r,s,_,w,C){var i,t,o,h=8*C-w-1,g=(1<<h)-1,b=g>>1,E=w===23?Math.pow(2,-24)-Math.pow(2,-77):0,z=_?0:C-1,D=_?1:-1,O=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(t=isNaN(r)?1:0,i=g):(i=Math.floor(Math.log(r)/Math.LN2),r*(o=Math.pow(2,-i))<1&&(i--,o*=2),(r+=i+b>=1?E/o:E*Math.pow(2,1-b))*o>=2&&(i++,o/=2),i+b>=g?(t=0,i=g):i+b>=1?(t=(r*o-1)*Math.pow(2,w),i+=b):(t=r*Math.pow(2,b-1)*Math.pow(2,w),i=0));w>=8;e[s+z]=255&t,z+=D,t/=256,w-=8);for(i=i<<w|t,h+=w;h>0;e[s+z]=255&i,z+=D,i/=256,h-=8);e[s+z-D]|=128*O},sp=$r;function $r(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}$r.Varint=0,$r.Fixed64=1,$r.Bytes=2,$r.Fixed32=5;var nf=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function ou(e){return e.type===$r.Bytes?e.readVarint()+e.pos:e.pos+1}function Al(e,r,s){return s?4294967296*r+(e>>>0):4294967296*(r>>>0)+(e>>>0)}function So(e,r,s){var _=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));s.realloc(_);for(var w=s.pos-1;w>=e;w--)s.buf[w+_]=s.buf[w]}function nd(e,r){for(var s=0;s<e.length;s++)r.writeVarint(e[s])}function of(e,r){for(var s=0;s<e.length;s++)r.writeSVarint(e[s])}function af(e,r){for(var s=0;s<e.length;s++)r.writeFloat(e[s])}function an(e,r){for(var s=0;s<e.length;s++)r.writeDouble(e[s])}function Fu(e,r){for(var s=0;s<e.length;s++)r.writeBoolean(e[s])}function od(e,r){for(var s=0;s<e.length;s++)r.writeFixed32(e[s])}function sf(e,r){for(var s=0;s<e.length;s++)r.writeSFixed32(e[s])}function lf(e,r){for(var s=0;s<e.length;s++)r.writeFixed64(e[s])}function au(e,r){for(var s=0;s<e.length;s++)r.writeSFixed64(e[s])}function su(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16)+16777216*e[r+3]}function mc(e,r,s){e[s]=r,e[s+1]=r>>>8,e[s+2]=r>>>16,e[s+3]=r>>>24}function uf(e,r){return(e[r]|e[r+1]<<8|e[r+2]<<16)+(e[r+3]<<24)}function Nm(e,r,s){e===1&&s.readMessage(jm,r)}function jm(e,r,s){if(e===3){var _=s.readMessage(Vm,{}),w=_.width,C=_.height,i=_.left,t=_.top,o=_.advance;r.push({id:_.id,bitmap:new hc({width:w+6,height:C+6},_.bitmap),metrics:{width:w,height:C,left:i,top:t,advance:o}})}}function Vm(e,r,s){e===1?r.id=s.readVarint():e===2?r.bitmap=s.readBytes():e===3?r.width=s.readVarint():e===4?r.height=s.readVarint():e===5?r.left=s.readSVarint():e===6?r.top=s.readSVarint():e===7&&(r.advance=s.readVarint())}function cf(e){for(var r=0,s=0,_=0,w=e;_<w.length;_+=1){var C=w[_];r+=C.w*C.h,s=Math.max(s,C.w)}e.sort(function(O,N){return N.h-O.h});for(var i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),s),h:1/0}],t=0,o=0,h=0,g=e;h<g.length;h+=1)for(var b=g[h],E=i.length-1;E>=0;E--){var z=i[E];if(!(b.w>z.w||b.h>z.h)){if(b.x=z.x,b.y=z.y,o=Math.max(o,b.y+b.h),t=Math.max(t,b.x+b.w),b.w===z.w&&b.h===z.h){var D=i.pop();E<i.length&&(i[E]=D)}else b.h===z.h?(z.x+=b.w,z.w-=b.w):b.w===z.w?(z.y+=b.h,z.h-=b.h):(i.push({x:z.x+b.w,y:z.y,w:z.w-b.w,h:b.h}),z.y+=b.h,z.h-=b.h);break}}return{w:t,h:o,fill:r/(t*o)||0}}$r.prototype={destroy:function(){this.buf=null},readFields:function(e,r,s){for(s=s||this.length;this.pos<s;){var _=this.readVarint(),w=_>>3,C=this.pos;this.type=7&_,e(w,r,this),this.pos===C&&this.skip(_)}return r},readMessage:function(e,r){return this.readFields(e,r,this.readVarint()+this.pos)},readFixed32:function(){var e=su(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=uf(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=su(this.buf,this.pos)+4294967296*su(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=su(this.buf,this.pos)+4294967296*uf(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=tf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=tf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var r,s,_=this.buf;return r=127&(s=_[this.pos++]),s<128?r:(r|=(127&(s=_[this.pos++]))<<7,s<128?r:(r|=(127&(s=_[this.pos++]))<<14,s<128?r:(r|=(127&(s=_[this.pos++]))<<21,s<128?r:function(w,C,i){var t,o,h=i.buf;if(t=(112&(o=h[i.pos++]))>>4,o<128||(t|=(127&(o=h[i.pos++]))<<3,o<128)||(t|=(127&(o=h[i.pos++]))<<10,o<128)||(t|=(127&(o=h[i.pos++]))<<17,o<128)||(t|=(127&(o=h[i.pos++]))<<24,o<128)||(t|=(1&(o=h[i.pos++]))<<31,o<128))return Al(w,t,C);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(s=_[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,r=this.pos;return this.pos=e,e-r>=12&&nf?function(s,_,w){return nf.decode(s.subarray(_,w))}(this.buf,r,e):function(s,_,w){for(var C="",i=_;i<w;){var t,o,h,g=s[i],b=null,E=g>239?4:g>223?3:g>191?2:1;if(i+E>w)break;E===1?g<128&&(b=g):E===2?(192&(t=s[i+1]))==128&&(b=(31&g)<<6|63&t)<=127&&(b=null):E===3?(o=s[i+2],(192&(t=s[i+1]))==128&&(192&o)==128&&((b=(15&g)<<12|(63&t)<<6|63&o)<=2047||b>=55296&&b<=57343)&&(b=null)):E===4&&(o=s[i+2],h=s[i+3],(192&(t=s[i+1]))==128&&(192&o)==128&&(192&h)==128&&((b=(15&g)<<18|(63&t)<<12|(63&o)<<6|63&h)<=65535||b>=1114112)&&(b=null)),b===null?(b=65533,E=1):b>65535&&(b-=65536,C+=String.fromCharCode(b>>>10&1023|55296),b=56320|1023&b),C+=String.fromCharCode(b),i+=E}return C}(this.buf,r,e)},readBytes:function(){var e=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,e);return this.pos=e,r},readPackedVarint:function(e,r){if(this.type!==$r.Bytes)return e.push(this.readVarint(r));var s=ou(this);for(e=e||[];this.pos<s;)e.push(this.readVarint(r));return e},readPackedSVarint:function(e){if(this.type!==$r.Bytes)return e.push(this.readSVarint());var r=ou(this);for(e=e||[];this.pos<r;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==$r.Bytes)return e.push(this.readBoolean());var r=ou(this);for(e=e||[];this.pos<r;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==$r.Bytes)return e.push(this.readFloat());var r=ou(this);for(e=e||[];this.pos<r;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==$r.Bytes)return e.push(this.readDouble());var r=ou(this);for(e=e||[];this.pos<r;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==$r.Bytes)return e.push(this.readFixed32());var r=ou(this);for(e=e||[];this.pos<r;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==$r.Bytes)return e.push(this.readSFixed32());var r=ou(this);for(e=e||[];this.pos<r;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==$r.Bytes)return e.push(this.readFixed64());var r=ou(this);for(e=e||[];this.pos<r;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==$r.Bytes)return e.push(this.readSFixed64());var r=ou(this);for(e=e||[];this.pos<r;)e.push(this.readSFixed64());return e},skip:function(e){var r=7&e;if(r===$r.Varint)for(;this.buf[this.pos++]>127;);else if(r===$r.Bytes)this.pos=this.readVarint()+this.pos;else if(r===$r.Fixed32)this.pos+=4;else{if(r!==$r.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(e,r){this.writeVarint(e<<3|r)},realloc:function(e){for(var r=this.length||16;r<this.pos+e;)r*=2;if(r!==this.length){var s=new Uint8Array(r);s.set(this.buf),this.buf=s,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),mc(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),mc(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),mc(this.buf,-1&e,this.pos),mc(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),mc(this.buf,-1&e,this.pos),mc(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(r,s){var _,w;if(r>=0?(_=r%4294967296|0,w=r/4294967296|0):(w=~(-r/4294967296),4294967295^(_=~(-r%4294967296))?_=_+1|0:(_=0,w=w+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(C,i,t){t.buf[t.pos++]=127&C|128,C>>>=7,t.buf[t.pos++]=127&C|128,C>>>=7,t.buf[t.pos++]=127&C|128,C>>>=7,t.buf[t.pos++]=127&C|128,t.buf[t.pos]=127&(C>>>=7)}(_,0,s),function(C,i){var t=(7&C)<<4;i.buf[i.pos++]|=t|((C>>>=3)?128:0),C&&(i.buf[i.pos++]=127&C|((C>>>=7)?128:0),C&&(i.buf[i.pos++]=127&C|((C>>>=7)?128:0),C&&(i.buf[i.pos++]=127&C|((C>>>=7)?128:0),C&&(i.buf[i.pos++]=127&C|((C>>>=7)?128:0),C&&(i.buf[i.pos++]=127&C)))))}(w,s)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var r=this.pos;this.pos=function(_,w,C){for(var i,t,o=0;o<w.length;o++){if((i=w.charCodeAt(o))>55295&&i<57344){if(!t){i>56319||o+1===w.length?(_[C++]=239,_[C++]=191,_[C++]=189):t=i;continue}if(i<56320){_[C++]=239,_[C++]=191,_[C++]=189,t=i;continue}i=t-55296<<10|i-56320|65536,t=null}else t&&(_[C++]=239,_[C++]=191,_[C++]=189,t=null);i<128?_[C++]=i:(i<2048?_[C++]=i>>6|192:(i<65536?_[C++]=i>>12|224:(_[C++]=i>>18|240,_[C++]=i>>12&63|128),_[C++]=i>>6&63|128),_[C++]=63&i|128)}return C}(this.buf,e,this.pos);var s=this.pos-r;s>=128&&So(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeFloat:function(e){this.realloc(4),rf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),rf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var r=e.length;this.writeVarint(r),this.realloc(r);for(var s=0;s<r;s++)this.buf[this.pos++]=e[s]},writeRawMessage:function(e,r){this.pos++;var s=this.pos;e(r,this);var _=this.pos-s;_>=128&&So(s,_,this),this.pos=s-1,this.writeVarint(_),this.pos+=_},writeMessage:function(e,r,s){this.writeTag(e,$r.Bytes),this.writeRawMessage(r,s)},writePackedVarint:function(e,r){r.length&&this.writeMessage(e,nd,r)},writePackedSVarint:function(e,r){r.length&&this.writeMessage(e,of,r)},writePackedBoolean:function(e,r){r.length&&this.writeMessage(e,Fu,r)},writePackedFloat:function(e,r){r.length&&this.writeMessage(e,af,r)},writePackedDouble:function(e,r){r.length&&this.writeMessage(e,an,r)},writePackedFixed32:function(e,r){r.length&&this.writeMessage(e,od,r)},writePackedSFixed32:function(e,r){r.length&&this.writeMessage(e,sf,r)},writePackedFixed64:function(e,r){r.length&&this.writeMessage(e,lf,r)},writePackedSFixed64:function(e,r){r.length&&this.writeMessage(e,au,r)},writeBytesField:function(e,r){this.writeTag(e,$r.Bytes),this.writeBytes(r)},writeFixed32Field:function(e,r){this.writeTag(e,$r.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(e,r){this.writeTag(e,$r.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(e,r){this.writeTag(e,$r.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(e,r){this.writeTag(e,$r.Fixed64),this.writeSFixed64(r)},writeVarintField:function(e,r){this.writeTag(e,$r.Varint),this.writeVarint(r)},writeSVarintField:function(e,r){this.writeTag(e,$r.Varint),this.writeSVarint(r)},writeStringField:function(e,r){this.writeTag(e,$r.Bytes),this.writeString(r)},writeFloatField:function(e,r){this.writeTag(e,$r.Fixed32),this.writeFloat(r)},writeDoubleField:function(e,r){this.writeTag(e,$r.Fixed64),this.writeDouble(r)},writeBooleanField:function(e,r){this.writeVarintField(e,Boolean(r))}};var lp=function(e,r){var s=r.pixelRatio,_=r.version,w=r.stretchX,C=r.stretchY,i=r.content;this.paddedRect=e,this.pixelRatio=s,this.stretchX=w,this.stretchY=C,this.content=i,this.version=_},Th={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Th.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Th.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Th.tlbr.get=function(){return this.tl.concat(this.br)},Th.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(lp.prototype,Th);var Ah=function(e,r){var s={},_={};this.haveRenderCallbacks=[];var w=[];this.addImages(e,s,w),this.addImages(r,_,w);var C=cf(w),i=new Xo({width:C.w||1,height:C.h||1});for(var t in e){var o=e[t],h=s[t].paddedRect;Xo.copy(o.data,i,{x:0,y:0},{x:h.x+1,y:h.y+1},o.data)}for(var g in r){var b=r[g],E=_[g].paddedRect,z=E.x+1,D=E.y+1,O=b.data.width,N=b.data.height;Xo.copy(b.data,i,{x:0,y:0},{x:z,y:D},b.data),Xo.copy(b.data,i,{x:0,y:N-1},{x:z,y:D-1},{width:O,height:1}),Xo.copy(b.data,i,{x:0,y:0},{x:z,y:D+N},{width:O,height:1}),Xo.copy(b.data,i,{x:O-1,y:0},{x:z-1,y:D},{width:1,height:N}),Xo.copy(b.data,i,{x:0,y:0},{x:z+O,y:D},{width:1,height:N})}this.image=i,this.iconPositions=s,this.patternPositions=_};Ah.prototype.addImages=function(e,r,s){for(var _ in e){var w=e[_],C={x:0,y:0,w:w.data.width+2,h:w.data.height+2};s.push(C),r[_]=new lp(C,w),w.hasRenderCallback&&this.haveRenderCallbacks.push(_)}},Ah.prototype.patchUpdatedImages=function(e,r){for(var s in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),r),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),r)},Ah.prototype.patchUpdatedImage=function(e,r,s){if(e&&r&&e.version!==r.version){e.version=r.version;var _=e.tl;s.update(r.data,void 0,{x:_[0],y:_[1]})}},ni("ImagePosition",lp),ni("ImageAtlas",Ah);var Ha={horizontal:1,vertical:2,horizontalOnly:3},lu=function(){this.scale=1,this.fontStack="",this.imageName=null};lu.forText=function(e,r){var s=new lu;return s.scale=e||1,s.fontStack=r,s},lu.forImage=function(e){var r=new lu;return r.imageName=e,r};var Qn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Ch(e,r,s,_,w,C,i,t,o,h,g,b,E,z,D,O){var N,U=Qn.fromFeature(e,w);b===Ha.vertical&&U.verticalizePunctuation();var K=ai.processBidirectionalText,$=ai.processStyledBidirectionalText;if(K&&U.sections.length===1){N=[];for(var Q=0,se=K(U.toString(),Jc(U,h,C,r,_,z,D));Q<se.length;Q+=1){var pe=se[Q],Ae=new Qn;Ae.text=pe,Ae.sections=U.sections;for(var Be=0;Be<pe.length;Be++)Ae.sectionIndex.push(0);N.push(Ae)}}else if($){N=[];for(var je=0,Ve=$(U.text,U.sectionIndex,Jc(U,h,C,r,_,z,D));je<Ve.length;je+=1){var it=Ve[je],He=new Qn;He.text=it[0],He.sectionIndex=it[1],He.sections=U.sections,N.push(He)}}else N=function(ut,St){for(var yt=[],kt=ut.text,dt=0,vt=0,ti=St;vt<ti.length;vt+=1){var $t=ti[vt];yt.push(ut.substring(dt,$t)),dt=$t}return dt<kt.length&&yt.push(ut.substring(dt,kt.length)),yt}(U,Jc(U,h,C,r,_,z,D));var Ct=[],Tt={positionedLines:Ct,text:U.toString(),top:g[1],bottom:g[1],left:g[0],right:g[0],writingMode:b,iconsInText:!1,verticalizable:!1};return function(ut,St,yt,kt,dt,vt,ti,$t,Si,ki,Yi,sr){for(var Ir=0,Sr=-17,dr=0,Pr=0,fr=$t==="right"?1:$t==="left"?0:.5,Mr=0,Ri=0,Wi=dt;Ri<Wi.length;Ri+=1){var $i=Wi[Ri];$i.trim();var Vi=$i.getMaxScale(),Qr=24*(Vi-1),Xr={positionedGlyphs:[],lineOffset:0};ut.positionedLines[Mr]=Xr;var cr=Xr.positionedGlyphs,or=0;if($i.length()){for(var zr=0;zr<$i.length();zr++){var ui=$i.getSection(zr),to=$i.getSectionIndex(zr),sn=$i.getCharCode(zr),Cn=0,Fr=null,To=null,co=null,Wa=24,Jo=!(Si===Ha.horizontal||!Yi&&!hs(sn)||Yi&&(up[sn]||(zl=sn,Vt.Arabic(zl)||Vt["Arabic Supplement"](zl)||Vt["Arabic Extended-A"](zl)||Vt["Arabic Presentation Forms-A"](zl)||Vt["Arabic Presentation Forms-B"](zl))));if(ui.imageName){var Yo=kt[ui.imageName];if(!Yo)continue;co=ui.imageName,ut.iconsInText=ut.iconsInText||!0,To=Yo.paddedRect;var io=Yo.displaySize;ui.scale=24*ui.scale/sr,Cn=Qr+(24-io[1]*ui.scale),Wa=(Fr={width:io[0],height:io[1],left:1,top:-3,advance:Jo?io[1]:io[0]}).advance;var Xa=Jo?io[0]*ui.scale-24*Vi:io[1]*ui.scale-24*Vi;Xa>0&&Xa>or&&(or=Xa)}else{var Zu=yt[ui.fontStack],wc=Zu&&Zu[sn];if(wc&&wc.rect)To=wc.rect,Fr=wc.metrics;else{var Ec=St[ui.fontStack],rh=Ec&&Ec[sn];if(!rh)continue;Fr=rh.metrics}Cn=24*(Vi-ui.scale)}Jo?(ut.verticalizable=!0,cr.push({glyph:sn,imageName:co,x:Ir,y:Sr+Cn,vertical:Jo,scale:ui.scale,fontStack:ui.fontStack,sectionIndex:to,metrics:Fr,rect:To}),Ir+=Wa*ui.scale+ki):(cr.push({glyph:sn,imageName:co,x:Ir,y:Sr+Cn,vertical:Jo,scale:ui.scale,fontStack:ui.fontStack,sectionIndex:to,metrics:Fr,rect:To}),Ir+=Fr.advance*ui.scale+ki)}cr.length!==0&&(dr=Math.max(Ir-ki,dr),Yc(cr,0,cr.length-1,fr,or)),Ir=0;var Ds=vt*Vi+or;Xr.lineOffset=Math.max(or,Qr),Sr+=Ds,Pr=Math.max(Ds,Pr),++Mr}else Sr+=vt,++Mr}var zl,Ic=Sr- -17,Hu=yc(ti),pu=Hu.horizontalAlign,nh=Hu.verticalAlign;(function(bp,wp,Fh,Uh,Ep,Nh,jh,za,Sc){var Tc,$o=(wp-Fh)*Ep;Tc=Nh!==jh?-za*Uh- -17:(-Uh*Sc+.5)*jh;for(var Pa=0,du=bp;Pa<du.length;Pa+=1)for(var al=0,oh=du[Pa].positionedGlyphs;al<oh.length;al+=1){var Rs=oh[al];Rs.x+=$o,Rs.y+=Tc}})(ut.positionedLines,fr,pu,nh,dr,Pr,vt,Ic,dt.length),ut.top+=-nh*Ic,ut.bottom=ut.top+Ic,ut.left+=-pu*dr,ut.right=ut.left+dr}(Tt,r,s,_,N,i,t,o,b,h,E,O),!function(ut){for(var St=0,yt=ut;St<yt.length;St+=1)if(yt[St].positionedGlyphs.length!==0)return!1;return!0}(Ct)&&Tt}Qn.fromFeature=function(e,r){for(var s=new Qn,_=0;_<e.sections.length;_++){var w=e.sections[_];w.image?s.addImageSection(w):s.addTextSection(w,r)}return s},Qn.prototype.length=function(){return this.text.length},Qn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Qn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Qn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Qn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var r="",s=0;s<e.length;s++){var _=e.charCodeAt(s+1)||null,w=e.charCodeAt(s-1)||null;r+=_&&Ql(_)&&!Kc[e[s+1]]||w&&Ql(w)&&!Kc[e[s-1]]||!Kc[e[s]]?e[s]:Kc[e[s]]}return r}(this.text)},Qn.prototype.trim=function(){for(var e=0,r=0;r<this.text.length&&up[this.text.charCodeAt(r)];r++)e++;for(var s=this.text.length,_=this.text.length-1;_>=0&&_>=e&&up[this.text.charCodeAt(_)];_--)s--;this.text=this.text.substring(e,s),this.sectionIndex=this.sectionIndex.slice(e,s)},Qn.prototype.substring=function(e,r){var s=new Qn;return s.text=this.text.substring(e,r),s.sectionIndex=this.sectionIndex.slice(e,r),s.sections=this.sections,s},Qn.prototype.toString=function(){return this.text},Qn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(r,s){return Math.max(r,e.sections[s].scale)},0)},Qn.prototype.addTextSection=function(e,r){this.text+=e.text,this.sections.push(lu.forText(e.scale,e.fontStack||r));for(var s=this.sections.length-1,_=0;_<e.text.length;++_)this.sectionIndex.push(s)},Qn.prototype.addImageSection=function(e){var r=e.image?e.image.name:"";if(r.length!==0){var s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(lu.forImage(r)),this.sectionIndex.push(this.sections.length-1)):Xt("Reached maximum number of images 6401")}else Xt("Can't add FormattedSection with an empty image.")},Qn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var up={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ka={};function hf(e,r,s,_,w,C){if(r.imageName){var i=_[r.imageName];return i?i.displaySize[0]*r.scale*24/C+w:0}var t=s[r.fontStack],o=t&&t[e];return o?o.metrics.advance*r.scale+w:0}function ad(e,r,s,_){var w=Math.pow(e-r,2);return _?e<r?w/2:2*w:w+Math.abs(s)*s}function sd(e,r,s){var _=0;return e===10&&(_-=1e4),s&&(_+=150),e!==40&&e!==65288||(_+=50),r!==41&&r!==65289||(_+=50),_}function ld(e,r,s,_,w,C){for(var i=null,t=ad(r,s,w,C),o=0,h=_;o<h.length;o+=1){var g=h[o],b=ad(r-g.x,s,w,C)+g.badness;b<=t&&(i=g,t=b)}return{index:e,x:r,priorBreak:i,badness:t}}function Jc(e,r,s,_,w,C,i){if(C!=="point")return[];if(!e)return[];for(var t,o=[],h=function(N,U,K,$,Q,se){for(var pe=0,Ae=0;Ae<N.length();Ae++){var Be=N.getSection(Ae);pe+=hf(N.getCharCode(Ae),Be,$,Q,U,se)}return pe/Math.max(1,Math.ceil(pe/K))}(e,r,s,_,w,i),g=e.text.indexOf("\u200B")>=0,b=0,E=0;E<e.length();E++){var z=e.getSection(E),D=e.getCharCode(E);if(up[D]||(b+=hf(D,z,_,w,r,i)),E<e.length()-1){var O=!((t=D)<11904||!(Vt["Bopomofo Extended"](t)||Vt.Bopomofo(t)||Vt["CJK Compatibility Forms"](t)||Vt["CJK Compatibility Ideographs"](t)||Vt["CJK Compatibility"](t)||Vt["CJK Radicals Supplement"](t)||Vt["CJK Strokes"](t)||Vt["CJK Symbols and Punctuation"](t)||Vt["CJK Unified Ideographs Extension A"](t)||Vt["CJK Unified Ideographs"](t)||Vt["Enclosed CJK Letters and Months"](t)||Vt["Halfwidth and Fullwidth Forms"](t)||Vt.Hiragana(t)||Vt["Ideographic Description Characters"](t)||Vt["Kangxi Radicals"](t)||Vt["Katakana Phonetic Extensions"](t)||Vt.Katakana(t)||Vt["Vertical Forms"](t)||Vt["Yi Radicals"](t)||Vt["Yi Syllables"](t)));(ka[D]||O||z.imageName)&&o.push(ld(E+1,b,h,o,sd(D,e.getCharCode(E+1),O&&g),!1))}}return function N(U){return U?N(U.priorBreak).concat(U.index):[]}(ld(e.length(),b,h,o,0,!0))}function yc(e){var r=.5,s=.5;switch(e){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:r,verticalAlign:s}}function Yc(e,r,s,_,w){if(_||w)for(var C=e[s],i=(e[s].x+C.metrics.advance*C.scale)*_,t=r;t<=s;t++)e[t].x-=i,e[t].y+=w}function kh(e,r,s,_,w,C){var i,t=e.image;if(t.content){var o=t.content,h=t.pixelRatio||1;i=[o[0]/h,o[1]/h,t.displaySize[0]-o[2]/h,t.displaySize[1]-o[3]/h]}var g,b,E,z,D=r.left*C,O=r.right*C;s==="width"||s==="both"?(z=w[0]+D-_[3],b=w[0]+O+_[1]):b=(z=w[0]+(D+O-t.displaySize[0])/2)+t.displaySize[0];var N=r.top*C,U=r.bottom*C;return s==="height"||s==="both"?(g=w[1]+N-_[0],E=w[1]+U+_[2]):E=(g=w[1]+(N+U-t.displaySize[1])/2)+t.displaySize[1],{image:t,top:g,right:b,bottom:E,left:z,collisionPadding:i}}ka[10]=!0,ka[32]=!0,ka[38]=!0,ka[40]=!0,ka[41]=!0,ka[43]=!0,ka[45]=!0,ka[47]=!0,ka[173]=!0,ka[183]=!0,ka[8203]=!0,ka[8208]=!0,ka[8211]=!0,ka[8231]=!0;var uu=function(e){function r(s,_,w,C){e.call(this,s,_),this.angle=w,C!==void 0&&(this.segment=C)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.clone=function(){return new r(this.x,this.y,this.angle,this.segment)},r}(V);function ud(e,r){var s=r.expression;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Ut(e+1))};if(s.kind==="source")return{kind:"source"};for(var _=s.zoomStops,w=s.interpolationType,C=0;C<_.length&&_[C]<=e;)C++;for(var i=C=Math.max(0,C-1);i<_.length&&_[i]<e+1;)i++;i=Math.min(_.length-1,i);var t=_[C],o=_[i];return s.kind==="composite"?{kind:"composite",minZoom:t,maxZoom:o,interpolationType:w}:{kind:"camera",minZoom:t,maxZoom:o,minSize:s.evaluate(new Ut(t)),maxSize:s.evaluate(new Ut(o)),interpolationType:w}}function cd(e,r,s){var _=r.uSize,w=s.lowerSize;return e.kind==="source"?w/128:e.kind==="composite"?bn(w/128,s.upperSize/128,r.uSizeT):_}function hd(e,r){var s=0,_=0;if(e.kind==="constant")_=e.layoutSize;else if(e.kind!=="source"){var w=e.interpolationType,C=w?We(lo.interpolationFactor(w,r,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?_=bn(e.minSize,e.maxSize,C):s=C}return{uSizeT:s,uSize:_}}ni("Anchor",uu);var qm=Object.freeze({__proto__:null,getSizeData:ud,evaluateSizeForFeature:cd,evaluateSizeForZoom:hd,SIZE_PACK_FACTOR:128});function pd(e,r,s,_,w){if(r.segment===void 0)return!0;for(var C=r,i=r.segment+1,t=0;t>-s/2;){if(--i<0)return!1;t-=e[i].dist(C),C=e[i]}t+=e[i].dist(e[i+1]),i++;for(var o=[],h=0;t<s/2;){var g=e[i],b=e[i+1];if(!b)return!1;var E=e[i-1].angleTo(g)-g.angleTo(b);for(E=Math.abs((E+3*Math.PI)%(2*Math.PI)-Math.PI),o.push({distance:t,angleDelta:E}),h+=E;t-o[0].distance>_;)h-=o.shift().angleDelta;if(h>w)return!1;i++,t+=g.dist(b)}return!0}function dd(e){for(var r=0,s=0;s<e.length-1;s++)r+=e[s].dist(e[s+1]);return r}function cp(e,r,s){return e?.6*r*s:0}function hp(e,r){return Math.max(e?e.right-e.left:0,r?r.right-r.left:0)}function Gm(e,r,s,_,w,C){for(var i=cp(s,w,C),t=hp(s,_)*C,o=0,h=dd(e)/2,g=0;g<e.length-1;g++){var b=e[g],E=e[g+1],z=b.dist(E);if(o+z>h){var D=(h-o)/z,O=bn(b.x,E.x,D),N=bn(b.y,E.y,D),U=new uu(O,N,E.angleTo(b),g);return U._round(),!i||pd(e,U,t,i,r)?U:void 0}o+=z}}function Zm(e,r,s,_,w,C,i,t,o){var h=cp(_,C,i),g=hp(_,w),b=g*i,E=e[0].x===0||e[0].x===o||e[0].y===0||e[0].y===o;return r-b<r/4&&(r=b+r/4),function z(D,O,N,U,K,$,Q,se,pe){for(var Ae=$/2,Be=dd(D),je=0,Ve=O-N,it=[],He=0;He<D.length-1;He++){for(var Ct=D[He],Tt=D[He+1],ut=Ct.dist(Tt),St=Tt.angleTo(Ct);Ve+N<je+ut;){var yt=((Ve+=N)-je)/ut,kt=bn(Ct.x,Tt.x,yt),dt=bn(Ct.y,Tt.y,yt);if(kt>=0&&kt<pe&&dt>=0&&dt<pe&&Ve-Ae>=0&&Ve+Ae<=Be){var vt=new uu(kt,dt,St,He);vt._round(),U&&!pd(D,vt,$,U,K)||it.push(vt)}}je+=ut}return se||it.length||Q||(it=z(D,je/2,N,U,K,$,Q,!0,pe)),it}(e,E?r/2*t%r:(g/2+2*C)*i*t%r,r,h,s,b,E,!1,o)}function fd(e,r,s,_,w){for(var C=[],i=0;i<e.length;i++)for(var t=e[i],o=void 0,h=0;h<t.length-1;h++){var g=t[h],b=t[h+1];g.x<r&&b.x<r||(g.x<r?g=new V(r,g.y+(r-g.x)/(b.x-g.x)*(b.y-g.y))._round():b.x<r&&(b=new V(r,g.y+(r-g.x)/(b.x-g.x)*(b.y-g.y))._round()),g.y<s&&b.y<s||(g.y<s?g=new V(g.x+(s-g.y)/(b.y-g.y)*(b.x-g.x),s)._round():b.y<s&&(b=new V(g.x+(s-g.y)/(b.y-g.y)*(b.x-g.x),s)._round()),g.x>=_&&b.x>=_||(g.x>=_?g=new V(_,g.y+(_-g.x)/(b.x-g.x)*(b.y-g.y))._round():b.x>=_&&(b=new V(_,g.y+(_-g.x)/(b.x-g.x)*(b.y-g.y))._round()),g.y>=w&&b.y>=w||(g.y>=w?g=new V(g.x+(w-g.y)/(b.y-g.y)*(b.x-g.x),w)._round():b.y>=w&&(b=new V(g.x+(w-g.y)/(b.y-g.y)*(b.x-g.x),w)._round()),o&&g.equals(o[o.length-1])||C.push(o=[g]),o.push(b)))))}return C}function Cl(e,r,s,_){var w=[],C=e.image,i=C.pixelRatio,t=C.paddedRect.w-2,o=C.paddedRect.h-2,h=e.right-e.left,g=e.bottom-e.top,b=C.stretchX||[[0,t]],E=C.stretchY||[[0,o]],z=function(kt,dt){return kt+dt[1]-dt[0]},D=b.reduce(z,0),O=E.reduce(z,0),N=t-D,U=o-O,K=0,$=D,Q=0,se=O,pe=0,Ae=N,Be=0,je=U;if(C.content&&_){var Ve=C.content;K=zh(b,0,Ve[0]),Q=zh(E,0,Ve[1]),$=zh(b,Ve[0],Ve[2]),se=zh(E,Ve[1],Ve[3]),pe=Ve[0]-K,Be=Ve[1]-Q,Ae=Ve[2]-Ve[0]-$,je=Ve[3]-Ve[1]-se}var it=function(kt,dt,vt,ti){var $t=Ph(kt.stretch-K,$,h,e.left),Si=Mh(kt.fixed-pe,Ae,kt.stretch,D),ki=Ph(dt.stretch-Q,se,g,e.top),Yi=Mh(dt.fixed-Be,je,dt.stretch,O),sr=Ph(vt.stretch-K,$,h,e.left),Ir=Mh(vt.fixed-pe,Ae,vt.stretch,D),Sr=Ph(ti.stretch-Q,se,g,e.top),dr=Mh(ti.fixed-Be,je,ti.stretch,O),Pr=new V($t,ki),fr=new V(sr,ki),Mr=new V(sr,Sr),Ri=new V($t,Sr),Wi=new V(Si/i,Yi/i),$i=new V(Ir/i,dr/i),Vi=r*Math.PI/180;if(Vi){var Qr=Math.sin(Vi),Xr=Math.cos(Vi),cr=[Xr,-Qr,Qr,Xr];Pr._matMult(cr),fr._matMult(cr),Ri._matMult(cr),Mr._matMult(cr)}var or=kt.stretch+kt.fixed,zr=dt.stretch+dt.fixed;return{tl:Pr,tr:fr,bl:Ri,br:Mr,tex:{x:C.paddedRect.x+1+or,y:C.paddedRect.y+1+zr,w:vt.stretch+vt.fixed-or,h:ti.stretch+ti.fixed-zr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Wi,pixelOffsetBR:$i,minFontScaleX:Ae/i/h,minFontScaleY:je/i/g,isSDF:s}};if(_&&(C.stretchX||C.stretchY))for(var He=cu(b,N,D),Ct=cu(E,U,O),Tt=0;Tt<He.length-1;Tt++)for(var ut=He[Tt],St=He[Tt+1],yt=0;yt<Ct.length-1;yt++)w.push(it(ut,Ct[yt],St,Ct[yt+1]));else w.push(it({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:t+1},{fixed:0,stretch:o+1}));return w}function zh(e,r,s){for(var _=0,w=0,C=e;w<C.length;w+=1){var i=C[w];_+=Math.max(r,Math.min(s,i[1]))-Math.max(r,Math.min(s,i[0]))}return _}function cu(e,r,s){for(var _=[{fixed:-1,stretch:0}],w=0,C=e;w<C.length;w+=1){var i=C[w],t=i[0],o=i[1],h=_[_.length-1];_.push({fixed:t-h.stretch,stretch:h.stretch}),_.push({fixed:t-h.stretch,stretch:h.stretch+(o-t)})}return _.push({fixed:r+1,stretch:s}),_}function Ph(e,r,s,_){return e/r*s+_}function Mh(e,r,s,_){return e-r*s/_}var Lh=function(e,r,s,_,w,C,i,t,o,h){if(this.boxStartIndex=e.length,o){var g=C.top,b=C.bottom,E=C.collisionPadding;E&&(g-=E[1],b+=E[3]);var z=b-g;z>0&&(z=Math.max(10,z),this.circleDiameter=z)}else{var D=C.top*i-t,O=C.bottom*i+t,N=C.left*i-t,U=C.right*i+t,K=C.collisionPadding;if(K&&(N-=K[0]*i,D-=K[1]*i,U+=K[2]*i,O+=K[3]*i),h){var $=new V(N,D),Q=new V(U,D),se=new V(N,O),pe=new V(U,O),Ae=h*Math.PI/180;$._rotate(Ae),Q._rotate(Ae),se._rotate(Ae),pe._rotate(Ae),N=Math.min($.x,Q.x,se.x,pe.x),U=Math.max($.x,Q.x,se.x,pe.x),D=Math.min($.y,Q.y,se.y,pe.y),O=Math.max($.y,Q.y,se.y,pe.y)}e.emplaceBack(r.x,r.y,N,D,U,O,s,_,w)}this.boxEndIndex=e.length},gc=function(e,r){if(e===void 0&&(e=[]),r===void 0&&(r=Hm),this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(var s=(this.length>>1)-1;s>=0;s--)this._down(s)};function Hm(e,r){return e<r?-1:e>r?1:0}function Wm(e,r,s){r===void 0&&(r=1),s===void 0&&(s=!1);for(var _=1/0,w=1/0,C=-1/0,i=-1/0,t=e[0],o=0;o<t.length;o++){var h=t[o];(!o||h.x<_)&&(_=h.x),(!o||h.y<w)&&(w=h.y),(!o||h.x>C)&&(C=h.x),(!o||h.y>i)&&(i=h.y)}var g=Math.min(C-_,i-w),b=g/2,E=new gc([],pf);if(g===0)return new V(_,w);for(var z=_;z<C;z+=g)for(var D=w;D<i;D+=g)E.push(new _c(z+b,D+b,b,e));for(var O=function(K){for(var $=0,Q=0,se=0,pe=K[0],Ae=0,Be=pe.length,je=Be-1;Ae<Be;je=Ae++){var Ve=pe[Ae],it=pe[je],He=Ve.x*it.y-it.x*Ve.y;Q+=(Ve.x+it.x)*He,se+=(Ve.y+it.y)*He,$+=3*He}return new _c(Q/$,se/$,0,K)}(e),N=E.length;E.length;){var U=E.pop();(U.d>O.d||!O.d)&&(O=U,s&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,N)),U.max-O.d<=r||(E.push(new _c(U.p.x-(b=U.h/2),U.p.y-b,b,e)),E.push(new _c(U.p.x+b,U.p.y-b,b,e)),E.push(new _c(U.p.x-b,U.p.y+b,b,e)),E.push(new _c(U.p.x+b,U.p.y+b,b,e)),N+=4)}return s&&(console.log("num probes: "+N),console.log("best distance: "+O.d)),O.p}function pf(e,r){return r.max-e.max}function _c(e,r,s,_){this.p=new V(e,r),this.h=s,this.d=function(w,C){for(var i=!1,t=1/0,o=0;o<C.length;o++)for(var h=C[o],g=0,b=h.length,E=b-1;g<b;E=g++){var z=h[g],D=h[E];z.y>w.y!=D.y>w.y&&w.x<(D.x-z.x)*(w.y-z.y)/(D.y-z.y)+z.x&&(i=!i),t=Math.min(t,Lu(w,z,D))}return(i?1:-1)*Math.sqrt(t)}(this.p,_),this.max=this.d+this.h*Math.SQRT2}gc.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},gc.prototype.pop=function(){if(this.length!==0){var e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}},gc.prototype.peek=function(){return this.data[0]},gc.prototype._up=function(e){for(var r=this.data,s=this.compare,_=r[e];e>0;){var w=e-1>>1,C=r[w];if(s(_,C)>=0)break;r[e]=C,e=w}r[e]=_},gc.prototype._down=function(e){for(var r=this.data,s=this.compare,_=this.length>>1,w=r[e];e<_;){var C=1+(e<<1),i=r[C],t=C+1;if(t<this.length&&s(r[t],i)<0&&(C=t,i=r[t]),s(i,w)>=0)break;r[e]=i,e=C}r[e]=w};var pp=Number.POSITIVE_INFINITY;function Dh(e,r){return r[1]!==pp?function(s,_,w){var C=0,i=0;switch(_=Math.abs(_),w=Math.abs(w),s){case"top-right":case"top-left":case"top":i=w-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-w}switch(s){case"top-right":case"bottom-right":case"right":C=-_;break;case"top-left":case"bottom-left":case"left":C=_}return[C,i]}(e,r[0],r[1]):function(s,_){var w=0,C=0;_<0&&(_=0);var i=_/Math.sqrt(2);switch(s){case"top-right":case"top-left":C=i-7;break;case"bottom-right":case"bottom-left":C=7-i;break;case"bottom":C=7-_;break;case"top":C=_-7}switch(s){case"top-right":case"bottom-right":w=-i;break;case"top-left":case"bottom-left":w=i;break;case"left":w=_;break;case"right":w=-_}return[w,C]}(e,r[0])}function dp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Rh(e,r,s,_,w,C,i,t,o,h,g,b,E,z,D){var O=function(Q,se,pe,Ae,Be,je,Ve,it){for(var He=Ae.layout.get("text-rotate").evaluate(je,{})*Math.PI/180,Ct=[],Tt=0,ut=se.positionedLines;Tt<ut.length;Tt+=1)for(var St=ut[Tt],yt=0,kt=St.positionedGlyphs;yt<kt.length;yt+=1){var dt=kt[yt];if(dt.rect){var vt=dt.rect||{},ti=4,$t=!0,Si=1,ki=0,Yi=(Be||it)&&dt.vertical,sr=dt.metrics.advance*dt.scale/2;if(it&&se.verticalizable&&(ki=St.lineOffset/2-(dt.imageName?-(24-dt.metrics.width*dt.scale)/2:24*(dt.scale-1))),dt.imageName){var Ir=Ve[dt.imageName];$t=Ir.sdf,ti=1/(Si=Ir.pixelRatio)}var Sr=Be?[dt.x+sr,dt.y]:[0,0],dr=Be?[0,0]:[dt.x+sr+pe[0],dt.y+pe[1]-ki],Pr=[0,0];Yi&&(Pr=dr,dr=[0,0]);var fr=(dt.metrics.left-ti)*dt.scale-sr+dr[0],Mr=(-dt.metrics.top-ti)*dt.scale+dr[1],Ri=fr+vt.w*dt.scale/Si,Wi=Mr+vt.h*dt.scale/Si,$i=new V(fr,Mr),Vi=new V(Ri,Mr),Qr=new V(fr,Wi),Xr=new V(Ri,Wi);if(Yi){var cr=new V(-sr,sr- -17),or=-Math.PI/2,zr=12-sr,ui=new V(22-zr,-(dt.imageName?zr:0)),to=new(Function.prototype.bind.apply(V,[null].concat(Pr)));$i._rotateAround(or,cr)._add(ui)._add(to),Vi._rotateAround(or,cr)._add(ui)._add(to),Qr._rotateAround(or,cr)._add(ui)._add(to),Xr._rotateAround(or,cr)._add(ui)._add(to)}if(He){var sn=Math.sin(He),Cn=Math.cos(He),Fr=[Cn,-sn,sn,Cn];$i._matMult(Fr),Vi._matMult(Fr),Qr._matMult(Fr),Xr._matMult(Fr)}var To=new V(0,0),co=new V(0,0);Ct.push({tl:$i,tr:Vi,bl:Qr,br:Xr,tex:vt,writingMode:se.writingMode,glyphOffset:Sr,sectionIndex:dt.sectionIndex,isSDF:$t,pixelOffsetTL:To,pixelOffsetBR:co,minFontScaleX:0,minFontScaleY:0})}}return Ct}(0,s,t,w,C,i,_,e.allowVerticalPlacement),N=e.textSizeData,U=null;N.kind==="source"?(U=[128*w.layout.get("text-size").evaluate(i,{})])[0]>32640&&Xt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):N.kind==="composite"&&((U=[128*z.compositeTextSizes[0].evaluate(i,{},D),128*z.compositeTextSizes[1].evaluate(i,{},D)])[0]>32640||U[1]>32640)&&Xt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,O,U,t,C,i,h,r,o.lineStartIndex,o.lineLength,E,D);for(var K=0,$=g;K<$.length;K+=1)b[$[K]]=e.text.placedSymbolArray.length-1;return 4*O.length}function Bh(e){for(var r in e)return e[r];return null}function fp(e,r,s,_){var w=e.compareText;if(r in w){for(var C=w[r],i=C.length-1;i>=0;i--)if(_.dist(C[i])<s)return!0}else w[r]=[];return w[r].push(_),!1}var Xm=Zc.VectorTileFeature.types,Km=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function mp(e,r,s,_,w,C,i,t,o,h,g,b,E){var z=t?Math.min(32640,Math.round(t[0])):0,D=t?Math.min(32640,Math.round(t[1])):0;e.emplaceBack(r,s,Math.round(32*_),Math.round(32*w),C,i,(z<<1)+(o?1:0),D,16*h,16*g,256*b,256*E)}function md(e,r,s){e.emplaceBack(r.x,r.y,s),e.emplaceBack(r.x,r.y,s),e.emplaceBack(r.x,r.y,s),e.emplaceBack(r.x,r.y,s)}function $c(e){for(var r=0,s=e.sections;r<s.length;r+=1)if(Yr(s[r].text))return!0;return!1}var Uu=function(e){this.layoutVertexArray=new Re,this.indexArray=new xt,this.programConfigurations=e,this.segments=new de,this.dynamicLayoutVertexArray=new be,this.opacityVertexArray=new De,this.placedSymbolArray=new v};Uu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Uu.prototype.upload=function(e,r,s,_){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Um.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Yd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Km,!0),this.opacityVertexBuffer.itemSize=1),(s||_)&&this.programConfigurations.upload(e))},Uu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ni("SymbolBuffers",Uu);var Qc=function(e,r,s){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new s,this.segments=new de,this.collisionVertexArray=new $e};Qc.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,rd.members,!0)},Qc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ni("CollisionBuffers",Qc);var Or=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(C){return C.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Wo([]),this.placementViewportMatrix=Wo([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ud(this.zoom,r["text-size"]),this.iconSizeData=ud(this.zoom,r["icon-size"]);var s=this.layers[0].layout,_=s.get("symbol-sort-key"),w=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=w!=="viewport-y"&&_.constantOr(1)!==void 0,this.sortFeaturesByY=(w==="viewport-y"||w==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,s.get("symbol-placement")==="point"&&(this.writingModes=s.get("text-writing-mode").map(function(C){return Ha[C]})),this.stateDependentLayerIds=this.layers.filter(function(C){return C.isStateDependent()}).map(function(C){return C.id}),this.sourceID=e.sourceID};Or.prototype.createArrays=function(){this.text=new Uu(new gi(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new Uu(new gi(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new B,this.lineVertexArray=new j,this.symbolInstances=new L},Or.prototype.calculateGlyphDependencies=function(e,r,s,_,w){for(var C=0;C<e.length;C++)if(r[e.charCodeAt(C)]=!0,(s||_)&&w){var i=Kc[e.charAt(C)];i&&(r[i.charCodeAt(0)]=!0)}},Or.prototype.populate=function(e,r,s){var _=this.layers[0],w=_.layout,C=w.get("text-font"),i=w.get("text-field"),t=w.get("icon-image"),o=(i.value.kind!=="constant"||i.value.value instanceof Er&&!i.value.value.isEmpty()||i.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),h=t.value.kind!=="constant"||!!t.value.value||Object.keys(t.parameters).length>0,g=w.get("symbol-sort-key");if(this.features=[],o||h){for(var b=r.iconDependencies,E=r.glyphDependencies,z=r.availableImages,D=new Ut(this.zoom),O=0,N=e;O<N.length;O+=1){var U=N[O],K=U.feature,$=U.id,Q=U.index,se=U.sourceLayerIndex,pe=_._featureFilter.needGeometry,Ae=lr(K,pe);if(_._featureFilter.filter(D,Ae,s)){pe||(Ae.geometry=yn(K));var Be=void 0;if(o){var je=_.getValueAndResolveTokens("text-field",Ae,s,z),Ve=Er.factory(je);$c(Ve)&&(this.hasRTLText=!0),(!this.hasRTLText||ga()==="unavailable"||this.hasRTLText&&ai.isParsed())&&(Be=ef(Ve,_,Ae))}var it=void 0;if(h){var He=_.getValueAndResolveTokens("icon-image",Ae,s,z);it=He instanceof po?He:po.fromString(He)}if(Be||it){var Ct=this.sortFeaturesByKey?g.evaluate(Ae,{},s):void 0;if(this.features.push({id:$,text:Be,icon:it,index:Q,sourceLayerIndex:se,geometry:Ae.geometry,properties:K.properties,type:Xm[K.type],sortKey:Ct}),it&&(b[it.name]=!0),Be){var Tt=C.evaluate(Ae,{},s).join(","),ut=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ha.vertical)>=0;for(var St=0,yt=Be.sections;St<yt.length;St+=1){var kt=yt[St];if(kt.image)b[kt.image.name]=!0;else{var dt=$l(Be.toString()),vt=kt.fontStack||Tt,ti=E[vt]=E[vt]||{};this.calculateGlyphDependencies(kt.text,ti,ut,this.allowVerticalPlacement,dt)}}}}}}w.get("symbol-placement")==="line"&&(this.features=function($t){var Si={},ki={},Yi=[],sr=0;function Ir(cr){Yi.push($t[cr]),sr++}function Sr(cr,or,zr){var ui=ki[cr];return delete ki[cr],ki[or]=ui,Yi[ui].geometry[0].pop(),Yi[ui].geometry[0]=Yi[ui].geometry[0].concat(zr[0]),ui}function dr(cr,or,zr){var ui=Si[or];return delete Si[or],Si[cr]=ui,Yi[ui].geometry[0].shift(),Yi[ui].geometry[0]=zr[0].concat(Yi[ui].geometry[0]),ui}function Pr(cr,or,zr){var ui=zr?or[0][or[0].length-1]:or[0][0];return cr+":"+ui.x+":"+ui.y}for(var fr=0;fr<$t.length;fr++){var Mr=$t[fr],Ri=Mr.geometry,Wi=Mr.text?Mr.text.toString():null;if(Wi){var $i=Pr(Wi,Ri),Vi=Pr(Wi,Ri,!0);if($i in ki&&Vi in Si&&ki[$i]!==Si[Vi]){var Qr=dr($i,Vi,Ri),Xr=Sr($i,Vi,Yi[Qr].geometry);delete Si[$i],delete ki[Vi],ki[Pr(Wi,Yi[Xr].geometry,!0)]=Xr,Yi[Qr].geometry=null}else $i in ki?Sr($i,Vi,Ri):Vi in Si?dr($i,Vi,Ri):(Ir(fr),Si[$i]=sr-1,ki[Vi]=sr-1)}else Ir(fr)}return Yi.filter(function(cr){return cr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function($t,Si){return $t.sortKey-Si.sortKey})}},Or.prototype.update=function(e,r,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,s),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,s))},Or.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Or.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Or.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Or.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Or.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Or.prototype.addToLineVertexArray=function(e,r){var s=this.lineVertexArray.length;if(e.segment!==void 0){for(var _=e.dist(r[e.segment+1]),w=e.dist(r[e.segment]),C={},i=e.segment+1;i<r.length;i++)C[i]={x:r[i].x,y:r[i].y,tileUnitDistanceFromAnchor:_},i<r.length-1&&(_+=r[i+1].dist(r[i]));for(var t=e.segment||0;t>=0;t--)C[t]={x:r[t].x,y:r[t].y,tileUnitDistanceFromAnchor:w},t>0&&(w+=r[t-1].dist(r[t]));for(var o=0;o<r.length;o++){var h=C[o];this.lineVertexArray.emplaceBack(h.x,h.y,h.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}},Or.prototype.addSymbols=function(e,r,s,_,w,C,i,t,o,h,g,b){for(var E=e.indexArray,z=e.layoutVertexArray,D=e.segments.prepareSegment(4*r.length,z,E,this.canOverlap?C.sortKey:void 0),O=this.glyphOffsetArray.length,N=D.vertexLength,U=this.allowVerticalPlacement&&i===Ha.vertical?Math.PI/2:0,K=C.text&&C.text.sections,$=0;$<r.length;$++){var Q=r[$],se=Q.tl,pe=Q.tr,Ae=Q.bl,Be=Q.br,je=Q.tex,Ve=Q.pixelOffsetTL,it=Q.pixelOffsetBR,He=Q.minFontScaleX,Ct=Q.minFontScaleY,Tt=Q.glyphOffset,ut=Q.isSDF,St=Q.sectionIndex,yt=D.vertexLength,kt=Tt[1];mp(z,t.x,t.y,se.x,kt+se.y,je.x,je.y,s,ut,Ve.x,Ve.y,He,Ct),mp(z,t.x,t.y,pe.x,kt+pe.y,je.x+je.w,je.y,s,ut,it.x,Ve.y,He,Ct),mp(z,t.x,t.y,Ae.x,kt+Ae.y,je.x,je.y+je.h,s,ut,Ve.x,it.y,He,Ct),mp(z,t.x,t.y,Be.x,kt+Be.y,je.x+je.w,je.y+je.h,s,ut,it.x,it.y,He,Ct),md(e.dynamicLayoutVertexArray,t,U),E.emplaceBack(yt,yt+1,yt+2),E.emplaceBack(yt+1,yt+2,yt+3),D.vertexLength+=4,D.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Tt[0]),$!==r.length-1&&St===r[$+1].sectionIndex||e.programConfigurations.populatePaintArrays(z.length,C,C.index,{},b,K&&K[St])}e.placedSymbolArray.emplaceBack(t.x,t.y,O,this.glyphOffsetArray.length-O,N,o,h,t.segment,s?s[0]:0,s?s[1]:0,_[0],_[1],i,0,!1,0,g)},Or.prototype._addCollisionDebugVertex=function(e,r,s,_,w,C){return r.emplaceBack(0,0),e.emplaceBack(s.x,s.y,_,w,Math.round(C.x),Math.round(C.y))},Or.prototype.addCollisionDebugVertices=function(e,r,s,_,w,C,i){var t=w.segments.prepareSegment(4,w.layoutVertexArray,w.indexArray),o=t.vertexLength,h=w.layoutVertexArray,g=w.collisionVertexArray,b=i.anchorX,E=i.anchorY;this._addCollisionDebugVertex(h,g,C,b,E,new V(e,r)),this._addCollisionDebugVertex(h,g,C,b,E,new V(s,r)),this._addCollisionDebugVertex(h,g,C,b,E,new V(s,_)),this._addCollisionDebugVertex(h,g,C,b,E,new V(e,_)),t.vertexLength+=4;var z=w.indexArray;z.emplaceBack(o,o+1),z.emplaceBack(o+1,o+2),z.emplaceBack(o+2,o+3),z.emplaceBack(o+3,o),t.primitiveLength+=4},Or.prototype.addDebugCollisionBoxes=function(e,r,s,_){for(var w=e;w<r;w++){var C=this.collisionBoxArray.get(w);this.addCollisionDebugVertices(C.x1,C.y1,C.x2,C.y2,_?this.textCollisionBox:this.iconCollisionBox,C.anchorPoint,s)}},Or.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Qc(Xe,$d.members,ci),this.iconCollisionBox=new Qc(Xe,$d.members,ci);for(var e=0;e<this.symbolInstances.length;e++){var r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}},Or.prototype._deserializeCollisionBoxesForSymbol=function(e,r,s,_,w,C,i,t,o){for(var h={},g=r;g<s;g++){var b=e.get(g);h.textBox={x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2,anchorPointX:b.anchorPointX,anchorPointY:b.anchorPointY},h.textFeatureIndex=b.featureIndex;break}for(var E=_;E<w;E++){var z=e.get(E);h.verticalTextBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,anchorPointX:z.anchorPointX,anchorPointY:z.anchorPointY},h.verticalTextFeatureIndex=z.featureIndex;break}for(var D=C;D<i;D++){var O=e.get(D);h.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},h.iconFeatureIndex=O.featureIndex;break}for(var N=t;N<o;N++){var U=e.get(N);h.verticalIconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},h.verticalIconFeatureIndex=U.featureIndex;break}return h},Or.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var r=0;r<this.symbolInstances.length;r++){var s=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}},Or.prototype.hasTextData=function(){return this.text.segments.get().length>0},Or.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Or.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Or.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Or.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Or.prototype.addIndicesForPlacedSymbol=function(e,r){for(var s=e.placedSymbolArray.get(r),_=s.vertexStartIndex+4*s.numGlyphs,w=s.vertexStartIndex;w<_;w+=4)e.indexArray.emplaceBack(w,w+1,w+2),e.indexArray.emplaceBack(w+1,w+2,w+3)},Or.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var r=Math.sin(e),s=Math.cos(e),_=[],w=[],C=[],i=0;i<this.symbolInstances.length;++i){C.push(i);var t=this.symbolInstances.get(i);_.push(0|Math.round(r*t.anchorX+s*t.anchorY)),w.push(t.featureIndex)}return C.sort(function(o,h){return _[o]-_[h]||w[h]-w[o]}),C},Or.prototype.addToSortKeyRanges=function(e,r){var s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===r?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Or.prototype.sortFeatures=function(e){var r=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var s=0,_=this.symbolInstanceIndexes;s<_.length;s+=1){var w=this.symbolInstances.get(_[s]);this.featureSortOrder.push(w.featureIndex),[w.rightJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.leftJustifiedTextSymbolIndex].forEach(function(C,i,t){C>=0&&t.indexOf(C)===i&&r.addIndicesForPlacedSymbol(r.text,C)}),w.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,w.verticalPlacedTextSymbolIndex),w.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,w.placedIconSymbolIndex),w.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,w.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ni("SymbolBucket",Or,{omit:["layers","collisionBoxArray","features","compareText"]}),Or.MAX_GLYPHS=65535,Or.addDynamicAttributes=md;var Jm=new S({"symbol-placement":new Gt(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new Gt(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Gt(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new qt(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Gt(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Gt(ye.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Gt(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new Gt(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Gt(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new qt(ye.layout_symbol["icon-size"]),"icon-text-fit":new Gt(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Gt(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new qt(ye.layout_symbol["icon-image"]),"icon-rotate":new qt(ye.layout_symbol["icon-rotate"]),"icon-padding":new Gt(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new Gt(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new qt(ye.layout_symbol["icon-offset"]),"icon-anchor":new qt(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Gt(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Gt(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Gt(ye.layout_symbol["text-rotation-alignment"]),"text-field":new qt(ye.layout_symbol["text-field"]),"text-font":new qt(ye.layout_symbol["text-font"]),"text-size":new qt(ye.layout_symbol["text-size"]),"text-max-width":new qt(ye.layout_symbol["text-max-width"]),"text-line-height":new Gt(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new qt(ye.layout_symbol["text-letter-spacing"]),"text-justify":new qt(ye.layout_symbol["text-justify"]),"text-radial-offset":new qt(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Gt(ye.layout_symbol["text-variable-anchor"]),"text-anchor":new qt(ye.layout_symbol["text-anchor"]),"text-max-angle":new Gt(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new Gt(ye.layout_symbol["text-writing-mode"]),"text-rotate":new qt(ye.layout_symbol["text-rotate"]),"text-padding":new Gt(ye.layout_symbol["text-padding"]),"text-keep-upright":new Gt(ye.layout_symbol["text-keep-upright"]),"text-transform":new qt(ye.layout_symbol["text-transform"]),"text-offset":new qt(ye.layout_symbol["text-offset"]),"text-allow-overlap":new Gt(ye.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Gt(ye.layout_symbol["text-ignore-placement"]),"text-optional":new Gt(ye.layout_symbol["text-optional"])}),kl={paint:new S({"icon-opacity":new qt(ye.paint_symbol["icon-opacity"]),"icon-color":new qt(ye.paint_symbol["icon-color"]),"icon-halo-color":new qt(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new qt(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new qt(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new Gt(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new Gt(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new qt(ye.paint_symbol["text-opacity"]),"text-color":new qt(ye.paint_symbol["text-color"],{runtimeType:Ie,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new qt(ye.paint_symbol["text-halo-color"]),"text-halo-width":new qt(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new qt(ye.paint_symbol["text-halo-blur"]),"text-translate":new Gt(ye.paint_symbol["text-translate"]),"text-translate-anchor":new Gt(ye.paint_symbol["text-translate-anchor"])}),layout:Jm},vc=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:_e,this.defaultValue=e};vc.prototype.evaluate=function(e){if(e.formattedSection){var r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},vc.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},vc.prototype.outputDefined=function(){return!1},vc.prototype.serialize=function(){return null},ni("FormatSectionOverride",vc,{omit:["defaultValue"]});var df=function(e){function r(s){e.call(this,s,kl)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.recalculate=function(s,_){if(e.prototype.recalculate.call(this,s,_),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var w=this.layout.get("text-writing-mode");if(w){for(var C=[],i=0,t=w;i<t.length;i+=1){var o=t[i];C.indexOf(o)<0&&C.push(o)}this.layout._values["text-writing-mode"]=C}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},r.prototype.getValueAndResolveTokens=function(s,_,w,C){var i=this.layout.get(s).evaluate(_,{},w,C),t=this._unevaluatedLayout._values[s];return t.isDataDriven()||Xs(t.value)||!i?i:function(o,h){return h.replace(/{([^{}]+)}/g,function(g,b){return b in o?String(o[b]):""})}(_.properties,i)},r.prototype.createBucket=function(s){return new Or(s)},r.prototype.queryRadius=function(){return 0},r.prototype.queryIntersectsFeature=function(){return!1},r.prototype._setPaintOverrides=function(){for(var s=0,_=kl.paint.overridableProperties;s<_.length;s+=1){var w=_[s];if(r.hasPaintOverride(this.layout,w)){var C,i=this.paint.get(w),t=new vc(i),o=new os(t,i.property.specification);C=i.value.kind==="constant"||i.value.kind==="source"?new Cs("source",o):new as("composite",o,i.value.zoomStops,i.value._interpolationType),this.paint._values[w]=new Io(i.property,C,i.parameters)}}},r.prototype._handleOverridablePaintPropertyUpdate=function(s,_,w){return!(!this.layout||_.isDataDriven()||w.isDataDriven())&&r.hasPaintOverride(this.layout,s)},r.hasPaintOverride=function(s,_){var w=s.get("text-field"),C=kl.paint.properties[_],i=!1,t=function(g){for(var b=0,E=g;b<E.length;b+=1)if(C.overrides&&C.overrides.hasOverride(E[b]))return void(i=!0)};if(w.value.kind==="constant"&&w.value.value instanceof Er)t(w.value.value.sections);else if(w.value.kind==="source"){var o=function(g){i||(g instanceof vo&&vn(g.value)===Ft?t(g.value.sections):g instanceof ia?t(g.sections):g.eachChild(o))},h=w.value;h._styleExpression&&o(h._styleExpression.expression)}return i},r}(n),Ym={paint:new S({"background-color":new Gt(ye.paint_background["background-color"]),"background-pattern":new Mn(ye.paint_background["background-pattern"]),"background-opacity":new Gt(ye.paint_background["background-opacity"])})},$m=function(e){function r(s){e.call(this,s,Ym)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r}(n),Qm={paint:new S({"raster-opacity":new Gt(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new Gt(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Gt(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Gt(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new Gt(ye.paint_raster["raster-saturation"]),"raster-contrast":new Gt(ye.paint_raster["raster-contrast"]),"raster-resampling":new Gt(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new Gt(ye.paint_raster["raster-fade-duration"])})},yp=function(e){function r(s){e.call(this,s,Qm)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r}(n),yd=function(e){function r(s){e.call(this,s,{}),this.implementation=s}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},r.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},r.prototype.recalculate=function(){},r.prototype.updateTransitions=function(){},r.prototype.hasTransition=function(){},r.prototype.serialize=function(){},r.prototype.onAdd=function(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},r.prototype.onRemove=function(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},r}(n),ey={circle:tp,heatmap:_h,hillshade:Zd,fill:ed,"fill-extrusion":Lm,line:Fm,symbol:df,background:$m,raster:yp},gp=X.HTMLImageElement,_p=X.HTMLCanvasElement,xc=X.HTMLVideoElement,ff=X.ImageData,eh=X.ImageBitmap,Nu=function(e,r,s,_){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(r,_)};Nu.prototype.update=function(e,r,s){var _=e.width,w=e.height,C=!(this.size&&this.size[0]===_&&this.size[1]===w||s),i=this.context,t=i.gl;if(this.useMipmap=Boolean(r&&r.useMipmap),t.bindTexture(t.TEXTURE_2D,this.texture),i.pixelStoreUnpackFlipY.set(!1),i.pixelStoreUnpack.set(1),i.pixelStoreUnpackPremultiplyAlpha.set(this.format===t.RGBA&&(!r||r.premultiply!==!1)),C)this.size=[_,w],e instanceof gp||e instanceof _p||e instanceof xc||e instanceof ff||eh&&e instanceof eh?t.texImage2D(t.TEXTURE_2D,0,this.format,this.format,t.UNSIGNED_BYTE,e):t.texImage2D(t.TEXTURE_2D,0,this.format,_,w,0,this.format,t.UNSIGNED_BYTE,e.data);else{var o=s||{x:0,y:0},h=o.x,g=o.y;e instanceof gp||e instanceof _p||e instanceof xc||e instanceof ff||eh&&e instanceof eh?t.texSubImage2D(t.TEXTURE_2D,0,h,g,t.RGBA,t.UNSIGNED_BYTE,e):t.texSubImage2D(t.TEXTURE_2D,0,h,g,_,w,t.RGBA,t.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&t.generateMipmap(t.TEXTURE_2D)},Nu.prototype.bind=function(e,r,s){var _=this.context.gl;_.bindTexture(_.TEXTURE_2D,this.texture),s!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(s=_.LINEAR),e!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,e),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,s||e),this.filter=e),r!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,r),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,r),this.wrap=r)},Nu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Nu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var th=function(e){var r=this;this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})};th.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},th.prototype.remove=function(){delete this._channel,this._callback=function(){}};var ju=function(e,r,s){this.target=e,this.parent=r,this.mapId=s,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},lt(["receive","process"],this),this.invoker=new th(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=bt()?e:X};function mf(e,r,s){var _=2*Math.PI*6378137/256/Math.pow(2,s);return[e*_-2*Math.PI*6378137/2,r*_-2*Math.PI*6378137/2]}ju.prototype.send=function(e,r,s,_,w){var C=this;w===void 0&&(w=!1);var i=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(this.callbacks[i]=s);var t=wr(this.globalScope)?void 0:[];return this.target.postMessage({id:i,type:e,hasCallback:!!s,targetMapId:_,mustQueue:w,sourceMapId:this.mapId,data:aa(r,t)},t),{cancel:function(){s&&delete C.callbacks[i],C.target.postMessage({id:i,type:"<cancel>",targetMapId:_,sourceMapId:C.mapId})}}},ju.prototype.receive=function(e){var r=e.data,s=r.id;if(s&&(!r.targetMapId||this.mapId===r.targetMapId))if(r.type==="<cancel>"){delete this.tasks[s];var _=this.cancelCallbacks[s];delete this.cancelCallbacks[s],_&&_()}else bt()||r.mustQueue?(this.tasks[s]=r,this.taskQueue.push(s),this.invoker.trigger()):this.processTask(s,r)},ju.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),r=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),r&&this.processTask(e,r)}},ju.prototype.processTask=function(e,r){var s=this;if(r.type==="<response>"){var _=this.callbacks[e];delete this.callbacks[e],_&&(r.error?_(on(r.error)):_(null,on(r.data)))}else{var w=!1,C=wr(this.globalScope)?void 0:[],i=r.hasCallback?function(g,b){w=!0,delete s.cancelCallbacks[e],s.target.postMessage({id:e,type:"<response>",sourceMapId:s.mapId,error:g?aa(g):null,data:aa(b,C)},C)}:function(g){w=!0},t=null,o=on(r.data);if(this.parent[r.type])t=this.parent[r.type](r.sourceMapId,o,i);else if(this.parent.getWorkerSource){var h=r.type.split(".");t=this.parent.getWorkerSource(r.sourceMapId,h[0],o.source)[h[1]](o,i)}else i(new Error("Could not find function "+r.type));!w&&t&&t.cancel&&(this.cancelCallbacks[e]=t.cancel)}},ju.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var eo=function(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};eo.prototype.setNorthEast=function(e){return this._ne=e instanceof pn?new pn(e.lng,e.lat):pn.convert(e),this},eo.prototype.setSouthWest=function(e){return this._sw=e instanceof pn?new pn(e.lng,e.lat):pn.convert(e),this},eo.prototype.extend=function(e){var r,s,_=this._sw,w=this._ne;if(e instanceof pn)r=e,s=e;else{if(!(e instanceof eo))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(eo.convert(e)):this.extend(pn.convert(e)):this;if(s=e._ne,!(r=e._sw)||!s)return this}return _||w?(_.lng=Math.min(r.lng,_.lng),_.lat=Math.min(r.lat,_.lat),w.lng=Math.max(s.lng,w.lng),w.lat=Math.max(s.lat,w.lat)):(this._sw=new pn(r.lng,r.lat),this._ne=new pn(s.lng,s.lat)),this},eo.prototype.getCenter=function(){return new pn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},eo.prototype.getSouthWest=function(){return this._sw},eo.prototype.getNorthEast=function(){return this._ne},eo.prototype.getNorthWest=function(){return new pn(this.getWest(),this.getNorth())},eo.prototype.getSouthEast=function(){return new pn(this.getEast(),this.getSouth())},eo.prototype.getWest=function(){return this._sw.lng},eo.prototype.getSouth=function(){return this._sw.lat},eo.prototype.getEast=function(){return this._ne.lng},eo.prototype.getNorth=function(){return this._ne.lat},eo.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},eo.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},eo.prototype.isEmpty=function(){return!(this._sw&&this._ne)},eo.prototype.contains=function(e){var r=pn.convert(e),s=r.lng,_=r.lat,w=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(w=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=_&&_<=this._ne.lat&&w},eo.convert=function(e){return!e||e instanceof eo?e:new eo(e)};var pn=function(e,r){if(isNaN(e)||isNaN(r))throw new Error("Invalid LngLat object: ("+e+", "+r+")");if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};pn.prototype.wrap=function(){return new pn(ft(this.lng,-180,180),this.lat)},pn.prototype.toArray=function(){return[this.lng,this.lat]},pn.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},pn.prototype.distanceTo=function(e){var r=Math.PI/180,s=this.lat*r,_=e.lat*r,w=Math.sin(s)*Math.sin(_)+Math.cos(s)*Math.cos(_)*Math.cos((e.lng-this.lng)*r);return 63710088e-1*Math.acos(Math.min(w,1))},pn.prototype.toBounds=function(e){e===void 0&&(e=0);var r=360*e/40075017,s=r/Math.cos(Math.PI/180*this.lat);return new eo(new pn(this.lng-s,this.lat-r),new pn(this.lng+s,this.lat+r))},pn.convert=function(e){if(e instanceof pn)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new pn(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new pn(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var yf=2*Math.PI*63710088e-1;function gf(e){return yf*Math.cos(e*Math.PI/180)}function gd(e){return(180+e)/360}function Dn(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Vu(e,r){return e/gf(r)}function vp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var qu=function(e,r,s){s===void 0&&(s=0),this.x=+e,this.y=+r,this.z=+s};qu.fromLngLat=function(e,r){r===void 0&&(r=0);var s=pn.convert(e);return new qu(gd(s.lng),Dn(s.lat),Vu(r,s.lat))},qu.prototype.toLngLat=function(){return new pn(360*this.x-180,vp(this.y))},qu.prototype.toAltitude=function(){return this.z*gf(vp(this.y))},qu.prototype.meterInMercatorCoordinateUnits=function(){return 1/yf*(e=vp(this.y),1/Math.cos(e*Math.PI/180));var e};var Gu=function(e,r,s){this.z=e,this.x=r,this.y=s,this.key=bc(0,e,e,r,s)};Gu.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Gu.prototype.url=function(e,r){var s,_,w,C,i,t=(_=this.y,w=this.z,C=mf(256*(s=this.x),256*(_=Math.pow(2,w)-_-1),w),i=mf(256*(s+1),256*(_+1),w),C[0]+","+C[1]+","+i[0]+","+i[1]),o=function(h,g,b){for(var E,z="",D=h;D>0;D--)z+=(g&(E=1<<D-1)?1:0)+(b&E?2:0);return z}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",o).replace("{bbox-epsg-3857}",t)},Gu.prototype.getTilePoint=function(e){var r=Math.pow(2,this.z);return new V(8192*(e.x*r-this.x),8192*(e.y*r-this.y))},Gu.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var _d=function(e,r){this.wrap=e,this.canonical=r,this.key=bc(e,r.z,r.z,r.x,r.y)},jn=function(e,r,s,_,w){this.overscaledZ=e,this.wrap=r,this.canonical=new Gu(s,+_,+w),this.key=bc(r,e,s,_,w)};function bc(e,r,s,_,w){(e*=2)<0&&(e=-1*e-1);var C=1<<s;return(C*C*e+C*w+_).toString(36)+s.toString(36)+r.toString(36)}jn.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},jn.prototype.scaledTo=function(e){var r=this.canonical.z-e;return e>this.canonical.z?new jn(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new jn(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)},jn.prototype.calculateScaledKey=function(e,r){var s=this.canonical.z-e;return e>this.canonical.z?bc(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):bc(this.wrap*+r,e,e,this.canonical.x>>s,this.canonical.y>>s)},jn.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r},jn.prototype.children=function(e){if(this.overscaledZ>=e)return[new jn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var r=this.canonical.z+1,s=2*this.canonical.x,_=2*this.canonical.y;return[new jn(r,this.wrap,r,s,_),new jn(r,this.wrap,r,s+1,_),new jn(r,this.wrap,r,s,_+1),new jn(r,this.wrap,r,s+1,_+1)]},jn.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},jn.prototype.wrapped=function(){return new jn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},jn.prototype.unwrapTo=function(e){return new jn(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},jn.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},jn.prototype.toUnwrapped=function(){return new _d(this.wrap,this.canonical)},jn.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},jn.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new qu(e.x-this.wrap,e.y))},ni("CanonicalTileID",Gu),ni("OverscaledTileID",jn,{omit:["posMatrix"]});var Ls=function(e,r,s){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(s&&s!=="mapbox"&&s!=="terrarium")return Xt('"'+s+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=r.height;var _=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=s||"mapbox";for(var w=0;w<_;w++)this.data[this._idx(-1,w)]=this.data[this._idx(0,w)],this.data[this._idx(_,w)]=this.data[this._idx(_-1,w)],this.data[this._idx(w,-1)]=this.data[this._idx(w,0)],this.data[this._idx(w,_)]=this.data[this._idx(w,_-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(_,-1)]=this.data[this._idx(_-1,0)],this.data[this._idx(-1,_)]=this.data[this._idx(0,_-1)],this.data[this._idx(_,_)]=this.data[this._idx(_-1,_-1)]};Ls.prototype.get=function(e,r){var s=new Uint8Array(this.data.buffer),_=4*this._idx(e,r);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(s[_],s[_+1],s[_+2])},Ls.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ls.prototype._idx=function(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)},Ls.prototype._unpackMapbox=function(e,r,s){return(256*e*256+256*r+s)/10-1e4},Ls.prototype._unpackTerrarium=function(e,r,s){return 256*e+r+s/256-32768},Ls.prototype.getPixels=function(){return new Xo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ls.prototype.backfillBorder=function(e,r,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var _=r*this.dim,w=r*this.dim+this.dim,C=s*this.dim,i=s*this.dim+this.dim;switch(r){case-1:_=w-1;break;case 1:w=_+1}switch(s){case-1:C=i-1;break;case 1:i=C+1}for(var t=-r*this.dim,o=-s*this.dim,h=C;h<i;h++)for(var g=_;g<w;g++)this.data[this._idx(g,h)]=e.data[this._idx(g+t,h+o)]},ni("DEMData",Ls);var Oh=function(e){this._stringToNumber={},this._numberToString=[];for(var r=0;r<e.length;r++){var s=e[r];this._stringToNumber[s]=r,this._numberToString[r]=s}};Oh.prototype.encode=function(e){return this._stringToNumber[e]},Oh.prototype.decode=function(e){return this._numberToString[e]};var ih=function(e,r,s,_,w){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=s,e._y=_,this.properties=e.properties,this.id=w},xp={geometry:{configurable:!0}};xp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},xp.geometry.set=function(e){this._geometry=e},ih.prototype.toJSON=function(){var e={geometry:this.geometry};for(var r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(e[r]=this[r]);return e},Object.defineProperties(ih.prototype,xp);var la=function(){this.state={},this.stateChanges={},this.deletedStates={}};la.prototype.updateState=function(e,r,s){var _=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][_]=this.stateChanges[e][_]||{},Ge(this.stateChanges[e][_],s),this.deletedStates[e]===null)for(var w in this.deletedStates[e]={},this.state[e])w!==_&&(this.deletedStates[e][w]=null);else if(this.deletedStates[e]&&this.deletedStates[e][_]===null)for(var C in this.deletedStates[e][_]={},this.state[e][_])s[C]||(this.deletedStates[e][_][C]=null);else for(var i in s)this.deletedStates[e]&&this.deletedStates[e][_]&&this.deletedStates[e][_][i]===null&&delete this.deletedStates[e][_][i]},la.prototype.removeFeatureState=function(e,r,s){if(this.deletedStates[e]!==null){var _=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&r!==void 0)this.deletedStates[e][_]!==null&&(this.deletedStates[e][_]=this.deletedStates[e][_]||{},this.deletedStates[e][_][s]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][_])for(s in this.deletedStates[e][_]={},this.stateChanges[e][_])this.deletedStates[e][_][s]=null;else this.deletedStates[e][_]=null;else this.deletedStates[e]=null}},la.prototype.getState=function(e,r){var s=String(r),_=Ge({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var w=this.deletedStates[e][r];if(w===null)return{};for(var C in w)delete _[C]}return _},la.prototype.initializeTileState=function(e,r){e.setFeatureState(this.state,r)},la.prototype.coalesceChanges=function(e,r){var s={};for(var _ in this.stateChanges){this.state[_]=this.state[_]||{};var w={};for(var C in this.stateChanges[_])this.state[_][C]||(this.state[_][C]={}),Ge(this.state[_][C],this.stateChanges[_][C]),w[C]=this.state[_][C];s[_]=w}for(var i in this.deletedStates){this.state[i]=this.state[i]||{};var t={};if(this.deletedStates[i]===null)for(var o in this.state[i])t[o]={},this.state[i][o]={};else for(var h in this.deletedStates[i]){if(this.deletedStates[i][h]===null)this.state[i][h]={};else for(var g=0,b=Object.keys(this.deletedStates[i][h]);g<b.length;g+=1)delete this.state[i][h][b[g]];t[h]=this.state[i][h]}s[i]=s[i]||{},Ge(s[i],t)}if(this.stateChanges={},this.deletedStates={},Object.keys(s).length!==0)for(var E in e)e[E].setFeatureState(s,r)};var ys=function(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new cs(8192,16,0),this.grid3D=new cs(8192,16,0),this.featureIndexArray=new ie,this.promoteId=r};function vd(e,r,s,_,w){return Et(e,function(C,i){var t=r instanceof ps?r.get(i):null;return t&&t.evaluate?t.evaluate(s,_,w):t})}function xd(e){for(var r=1/0,s=1/0,_=-1/0,w=-1/0,C=0,i=e;C<i.length;C+=1){var t=i[C];r=Math.min(r,t.x),s=Math.min(s,t.y),_=Math.max(_,t.x),w=Math.max(w,t.y)}return{minX:r,minY:s,maxX:_,maxY:w}}function _f(e,r){return r-e}ys.prototype.insert=function(e,r,s,_,w,C){var i=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,_,w);for(var t=C?this.grid3D:this.grid,o=0;o<r.length;o++){for(var h=r[o],g=[1/0,1/0,-1/0,-1/0],b=0;b<h.length;b++){var E=h[b];g[0]=Math.min(g[0],E.x),g[1]=Math.min(g[1],E.y),g[2]=Math.max(g[2],E.x),g[3]=Math.max(g[3],E.y)}g[0]<8192&&g[1]<8192&&g[2]>=0&&g[3]>=0&&t.insert(i,g[0],g[1],g[2],g[3])}},ys.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Zc.VectorTile(new sp(this.rawTileData)).layers,this.sourceLayerCoder=new Oh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},ys.prototype.query=function(e,r,s,_){var w=this;this.loadVTLayers();for(var C=e.params||{},i=8192/e.tileSize/e.scale,t=Jl(C.filter),o=e.queryGeometry,h=e.queryPadding*i,g=xd(o),b=this.grid.query(g.minX-h,g.minY-h,g.maxX+h,g.maxY+h),E=xd(e.cameraQueryGeometry),z=this.grid3D.query(E.minX-h,E.minY-h,E.maxX+h,E.maxY+h,function(Q,se,pe,Ae){return function(Be,je,Ve,it,He){for(var Ct=0,Tt=Be;Ct<Tt.length;Ct+=1){var ut=Tt[Ct];if(je<=ut.x&&Ve<=ut.y&&it>=ut.x&&He>=ut.y)return!0}var St=[new V(je,Ve),new V(je,He),new V(it,He),new V(it,Ve)];if(Be.length>2){for(var yt=0,kt=St;yt<kt.length;yt+=1)if(Ps(Be,kt[yt]))return!0}for(var dt=0;dt<Be.length-1;dt++)if(iu(Be[dt],Be[dt+1],St))return!0;return!1}(e.cameraQueryGeometry,Q-h,se-h,pe+h,Ae+h)}),D=0,O=z;D<O.length;D+=1)b.push(O[D]);b.sort(_f);for(var N,U={},K=function(Q){var se=b[Q];if(se!==N){N=se;var pe=w.featureIndexArray.get(se),Ae=null;w.loadMatchingFeature(U,pe.bucketIndex,pe.sourceLayerIndex,pe.featureIndex,t,C.layers,C.availableImages,r,s,_,function(Be,je,Ve){return Ae||(Ae=yn(Be)),je.queryIntersectsFeature(o,Be,Ve,Ae,w.z,e.transform,i,e.pixelPosMatrix)})}},$=0;$<b.length;$++)K($);return U},ys.prototype.loadMatchingFeature=function(e,r,s,_,w,C,i,t,o,h,g){var b=this.bucketLayerIDs[r];if(!C||function(Be,je){for(var Ve=0;Ve<Be.length;Ve++)if(je.indexOf(Be[Ve])>=0)return!0;return!1}(C,b)){var E=this.sourceLayerCoder.decode(s),z=this.vtLayers[E].feature(_);if(w.needGeometry){var D=lr(z,!0);if(!w.filter(new Ut(this.tileID.overscaledZ),D,this.tileID.canonical))return}else if(!w.filter(new Ut(this.tileID.overscaledZ),z))return;for(var O=this.getId(z,E),N=0;N<b.length;N++){var U=b[N];if(!(C&&C.indexOf(U)<0)){var K=t[U];if(K){var $={};O!==void 0&&h&&($=h.getState(K.sourceLayer||"_geojsonTileLayer",O));var Q=Ge({},o[U]);Q.paint=vd(Q.paint,K.paint,z,$,i),Q.layout=vd(Q.layout,K.layout,z,$,i);var se=!g||g(z,K,$);if(se){var pe=new ih(z,this.z,this.x,this.y,O);pe.layer=Q;var Ae=e[U];Ae===void 0&&(Ae=e[U]=[]),Ae.push({featureIndex:_,feature:pe,intersectionZ:se})}}}}}},ys.prototype.lookupSymbolFeatures=function(e,r,s,_,w,C,i,t){var o={};this.loadVTLayers();for(var h=Jl(w),g=0,b=e;g<b.length;g+=1)this.loadMatchingFeature(o,s,_,b[g],h,C,i,t,r);return o},ys.prototype.hasLayer=function(e){for(var r=0,s=this.bucketLayerIDs;r<s.length;r+=1)for(var _=0,w=s[r];_<w.length;_+=1)if(e===w[_])return!0;return!1},ys.prototype.getId=function(e,r){var s=e.id;return this.promoteId&&typeof(s=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]])=="boolean"&&(s=Number(s)),s},ni("FeatureIndex",ys,{omit:["rawTileData","sourceLayerCoder"]});var uo=function(e,r){this.tileID=e,this.uid=gt(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};uo.prototype.registerFadeDuration=function(e){var r=e+this.timeAdded;r<rr.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)},uo.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},uo.prototype.loadVectorData=function(e,r,s){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var _ in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,g){var b={};if(!g)return b;for(var E=function(){var O=D[z],N=O.layerIds.map(function($){return g.getLayer($)}).filter(Boolean);if(N.length!==0){O.layers=N,O.stateDependentLayerIds&&(O.stateDependentLayers=O.stateDependentLayerIds.map(function($){return N.filter(function(Q){return Q.id===$})[0]}));for(var U=0,K=N;U<K.length;U+=1)b[K[U].id]=O}},z=0,D=h;z<D.length;z+=1)E();return b}(e.buckets,r.style),this.hasSymbolBuckets=!1,this.buckets){var w=this.buckets[_];if(w instanceof Or){if(this.hasSymbolBuckets=!0,!s)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var C in this.buckets){var i=this.buckets[C];if(i instanceof Or&&i.hasRTLText){this.hasRTLText=!0,ai.isLoading()||ai.isLoaded()||ga()!=="deferred"||qo();break}}for(var t in this.queryPadding=0,this.buckets){var o=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(t).queryRadius(o))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new m},uo.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},uo.prototype.getBucket=function(e){return this.buckets[e.id]},uo.prototype.upload=function(e){for(var r in this.buckets){var s=this.buckets[r];s.uploadPending()&&s.upload(e)}var _=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Nu(e,this.imageAtlas.image,_.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Nu(e,this.glyphAtlasImage,_.ALPHA),this.glyphAtlasImage=null)},uo.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},uo.prototype.queryRenderedFeatures=function(e,r,s,_,w,C,i,t,o,h){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:w,scale:C,tileSize:this.tileSize,pixelPosMatrix:h,transform:t,params:i,queryPadding:this.queryPadding*o},e,r,s):{}},uo.prototype.querySourceFeatures=function(e,r){var s=this.latestFeatureIndex;if(s&&s.rawTileData){var _=s.loadVTLayers(),w=r?r.sourceLayer:"",C=_._geojsonTileLayer||_[w];if(C)for(var i=Jl(r&&r.filter),t=this.tileID.canonical,o=t.z,h=t.x,g=t.y,b={z:o,x:h,y:g},E=0;E<C.length;E++){var z=C.feature(E);if(i.needGeometry){var D=lr(z,!0);if(!i.filter(new Ut(this.tileID.overscaledZ),D,this.tileID.canonical))continue}else if(!i.filter(new Ut(this.tileID.overscaledZ),z))continue;var O=s.getId(z,w),N=new ih(z,o,h,g,O);N.tile=b,e.push(N)}}},uo.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},uo.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},uo.prototype.setExpiryData=function(e){var r=this.expirationTime;if(e.cacheControl){var s=Gi(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var _=Date.now(),w=!1;if(this.expirationTime>_)w=!1;else if(r)if(this.expirationTime<r)w=!0;else{var C=this.expirationTime-r;C?this.expirationTime=_+Math.max(C,3e4):w=!0}else w=!0;w?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},uo.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},uo.prototype.setFeatureState=function(e,r){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var s=this.latestFeatureIndex.loadVTLayers();for(var _ in this.buckets)if(r.style.hasLayer(_)){var w=this.buckets[_],C=w.layers[0].sourceLayer||"_geojsonTileLayer",i=s[C],t=e[C];if(i&&t&&Object.keys(t).length!==0){w.update(t,i,this.imageAtlas&&this.imageAtlas.patternPositions||{});var o=r&&r.style&&r.style.getLayer(_);o&&(this.queryPadding=Math.max(this.queryPadding,o.queryRadius(w)))}}}},uo.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},uo.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<rr.now()},uo.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},uo.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=rr.now()+e},uo.prototype.setDependencies=function(e,r){for(var s={},_=0,w=r;_<w.length;_+=1)s[w[_]]=!0;this.dependencies[e]=s},uo.prototype.hasDependency=function(e,r){for(var s=0,_=e;s<_.length;s+=1){var w=this.dependencies[_[s]];if(w){for(var C=0,i=r;C<i.length;C+=1)if(w[i[C]])return!0}}return!1};var hu=X.performance,bd=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},hu.mark(this._marks.start)};bd.prototype.finish=function(){hu.mark(this._marks.end);var e=hu.getEntriesByName(this._marks.measure);return e.length===0&&(hu.measure(this._marks.measure,this._marks.start,this._marks.end),e=hu.getEntriesByName(this._marks.measure),hu.clearMarks(this._marks.start),hu.clearMarks(this._marks.end),hu.clearMeasures(this._marks.measure)),e},f.Actor=ju,f.AlphaImage=hc,f.CanonicalTileID=Gu,f.CollisionBoxArray=m,f.Color=Pi,f.DEMData=Ls,f.DataConstantProperty=Gt,f.DictionaryCoder=Oh,f.EXTENT=8192,f.ErrorEvent=Oe,f.EvaluationParameters=Ut,f.Event=Se,f.Evented=Ne,f.FeatureIndex=ys,f.FillBucket=nl,f.FillExtrusionBucket=ol,f.ImageAtlas=Ah,f.ImagePosition=lp,f.LineBucket=Ko,f.LngLat=pn,f.LngLatBounds=eo,f.MercatorCoordinate=qu,f.ONE_EM=24,f.OverscaledTileID=jn,f.Point=V,f.Point$1=V,f.Properties=S,f.Protobuf=sp,f.RGBAImage=Xo,f.RequestManager=ir,f.RequestPerformance=bd,f.ResourceType=nr,f.SegmentVector=de,f.SourceFeatureState=la,f.StructArrayLayout1ui2=ei,f.StructArrayLayout2f1f2i16=nt,f.StructArrayLayout2i4=Z,f.StructArrayLayout3ui6=xt,f.StructArrayLayout4i8=J,f.SymbolBucket=Or,f.Texture=Nu,f.Tile=uo,f.Transitionable=Nn,f.Uniform1f=Lt,f.Uniform1i=It,f.Uniform2f=Mt,f.Uniform3f=Yt,f.Uniform4f=di,f.UniformColor=_i,f.UniformMatrix4f=ar,f.UnwrappedTileID=_d,f.ValidationError=Pe,f.WritingMode=Ha,f.ZoomHistory=Za,f.add=function(e,r,s){return e[0]=r[0]+s[0],e[1]=r[1]+s[1],e[2]=r[2]+s[2],e},f.addDynamicAttributes=md,f.asyncAll=function(e,r,s){if(!e.length)return s(null,[]);var _=e.length,w=new Array(e.length),C=null;e.forEach(function(i,t){r(i,function(o,h){o&&(C=o),w[t]=h,--_==0&&s(C,w)})})},f.bezier=ke,f.bindAll=lt,f.browser=rr,f.cacheEntryPossiblyAdded=function(e){++Gr>mr&&(e.getActor().send("enforceCacheSizeLimit",pr),Gr=0)},f.clamp=We,f.clearTileCache=function(e){var r=X.caches.delete("mapbox-tiles");e&&r.catch(e).then(function(){return e()})},f.clipLine=fd,f.clone=function(e){var r=new gr(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r},f.clone$1=vi,f.clone$2=function(e){var r=new gr(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r},f.collisionCircleLayout=Qd,f.config=Ti,f.create=function(){var e=new gr(16);return gr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},f.create$1=function(){var e=new gr(9);return gr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},f.create$2=function(){var e=new gr(4);return gr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},f.createCommonjsModule=d,f.createExpression=Wl,f.createLayout=M,f.createStyleLayer=function(e){return e.type==="custom"?new yd(e):new ey[e.type](e)},f.cross=function(e,r,s){var _=r[0],w=r[1],C=r[2],i=s[0],t=s[1],o=s[2];return e[0]=w*o-C*t,e[1]=C*i-_*o,e[2]=_*t-w*i,e},f.deepEqual=function e(r,s){if(Array.isArray(r)){if(!Array.isArray(s)||r.length!==s.length)return!1;for(var _=0;_<r.length;_++)if(!e(r[_],s[_]))return!1;return!0}if(typeof r=="object"&&r!==null&&s!==null){if(typeof s!="object"||Object.keys(r).length!==Object.keys(s).length)return!1;for(var w in r)if(!e(r[w],s[w]))return!1;return!0}return r===s},f.dot=function(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]},f.dot$1=function(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]},f.ease=qe,f.emitValidationErrors=wl,f.endsWith=pi,f.enforceCacheSizeLimit=function(e){Hn(),Fn&&Fn.then(function(r){r.keys().then(function(s){for(var _=0;_<s.length-e;_++)r.delete(s[_])})})},f.evaluateSizeForFeature=cd,f.evaluateSizeForZoom=hd,f.evaluateVariableOffset=Dh,f.evented=uc,f.extend=Ge,f.featureFilter=Jl,f.filterObject=Wt,f.fromRotation=function(e,r){var s=Math.sin(r),_=Math.cos(r);return e[0]=_,e[1]=s,e[2]=0,e[3]=-s,e[4]=_,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},f.getAnchorAlignment=yc,f.getAnchorJustification=dp,f.getArrayBuffer=Lo,f.getImage=oe,f.getJSON=function(e,r){return fa(Ge(e,{type:"json"}),r)},f.getRTLTextPluginStatus=ga,f.getReferrer=zn,f.getVideo=function(e,r){var s,_,w=X.document.createElement("video");w.muted=!0,w.onloadstart=function(){r(null,w)};for(var C=0;C<e.length;C++){var i=X.document.createElement("source");s=e[C],_=void 0,(_=X.document.createElement("a")).href=s,(_.protocol!==X.document.location.protocol||_.host!==X.document.location.host)&&(w.crossOrigin="Anonymous"),i.src=e[C],w.appendChild(i)}return{cancel:function(){}}},f.identity=Wo,f.invert=function(e,r){var s=r[0],_=r[1],w=r[2],C=r[3],i=r[4],t=r[5],o=r[6],h=r[7],g=r[8],b=r[9],E=r[10],z=r[11],D=r[12],O=r[13],N=r[14],U=r[15],K=s*t-_*i,$=s*o-w*i,Q=s*h-C*i,se=_*o-w*t,pe=_*h-C*t,Ae=w*h-C*o,Be=g*O-b*D,je=g*N-E*D,Ve=g*U-z*D,it=b*N-E*O,He=b*U-z*O,Ct=E*U-z*N,Tt=K*Ct-$*He+Q*it+se*Ve-pe*je+Ae*Be;return Tt?(e[0]=(t*Ct-o*He+h*it)*(Tt=1/Tt),e[1]=(w*He-_*Ct-C*it)*Tt,e[2]=(O*Ae-N*pe+U*se)*Tt,e[3]=(E*pe-b*Ae-z*se)*Tt,e[4]=(o*Ve-i*Ct-h*je)*Tt,e[5]=(s*Ct-w*Ve+C*je)*Tt,e[6]=(N*Q-D*Ae-U*$)*Tt,e[7]=(g*Ae-E*Q+z*$)*Tt,e[8]=(i*He-t*Ve+h*Be)*Tt,e[9]=(_*Ve-s*He-C*Be)*Tt,e[10]=(D*pe-O*Q+U*K)*Tt,e[11]=(b*Q-g*pe-z*K)*Tt,e[12]=(t*je-i*it-o*Be)*Tt,e[13]=(s*it-_*je+w*Be)*Tt,e[14]=(O*$-D*se-N*K)*Tt,e[15]=(g*se-b*$+E*K)*Tt,e):null},f.isChar=Vt,f.isMapboxURL=Cr,f.keysDifference=function(e,r){var s=[];for(var _ in e)_ in r||s.push(_);return s},f.makeRequest=fa,f.mapObject=Et,f.mercatorXfromLng=gd,f.mercatorYfromLat=Dn,f.mercatorZfromAltitude=Vu,f.mul=Du,f.multiply=sa,f.mvt=Zc,f.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},f.normalize=function(e,r){var s=r[0],_=r[1],w=r[2],C=s*s+_*_+w*w;return C>0&&(C=1/Math.sqrt(C)),e[0]=r[0]*C,e[1]=r[1]*C,e[2]=r[2]*C,e},f.number=bn,f.offscreenCanvasSupported=Ht,f.ortho=function(e,r,s,_,w,C,i){var t=1/(r-s),o=1/(_-w),h=1/(C-i);return e[0]=-2*t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*h,e[11]=0,e[12]=(r+s)*t,e[13]=(w+_)*o,e[14]=(i+C)*h,e[15]=1,e},f.parseGlyphPBF=function(e){return new sp(e).readFields(Nm,[])},f.pbf=sp,f.performSymbolLayout=function(e,r,s,_,w,C,i){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var t=e.layers[0].layout,o=e.layers[0]._unevaluatedLayout._values,h={};if(e.textSizeData.kind==="composite"){var g=e.textSizeData,b=g.maxZoom;h.compositeTextSizes=[o["text-size"].possiblyEvaluate(new Ut(g.minZoom),i),o["text-size"].possiblyEvaluate(new Ut(b),i)]}if(e.iconSizeData.kind==="composite"){var E=e.iconSizeData,z=E.maxZoom;h.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new Ut(E.minZoom),i),o["icon-size"].possiblyEvaluate(new Ut(z),i)]}h.layoutTextSize=o["text-size"].possiblyEvaluate(new Ut(e.zoom+1),i),h.layoutIconSize=o["icon-size"].possiblyEvaluate(new Ut(e.zoom+1),i),h.textMaxSize=o["text-size"].possiblyEvaluate(new Ut(18));for(var D=24*t.get("text-line-height"),O=t.get("text-rotation-alignment")==="map"&&t.get("symbol-placement")!=="point",N=t.get("text-keep-upright"),U=t.get("text-size"),K=function(){var se=Q[$],pe=t.get("text-font").evaluate(se,{},i).join(","),Ae=U.evaluate(se,{},i),Be=h.layoutTextSize.evaluate(se,{},i),je=h.layoutIconSize.evaluate(se,{},i),Ve={horizontal:{},vertical:void 0},it=se.text,He=[0,0];if(it){var Ct=it.toString(),Tt=24*t.get("text-letter-spacing").evaluate(se,{},i),ut=function(Ri){for(var Wi=0,$i=Ri;Wi<$i.length;Wi+=1)if(Vi=$i[Wi].charCodeAt(0),Vt.Arabic(Vi)||Vt["Arabic Supplement"](Vi)||Vt["Arabic Extended-A"](Vi)||Vt["Arabic Presentation Forms-A"](Vi)||Vt["Arabic Presentation Forms-B"](Vi))return!1;var Vi;return!0}(Ct)?Tt:0,St=t.get("text-anchor").evaluate(se,{},i),yt=t.get("text-variable-anchor");if(!yt){var kt=t.get("text-radial-offset").evaluate(se,{},i);He=kt?Dh(St,[24*kt,pp]):t.get("text-offset").evaluate(se,{},i).map(function(Ri){return 24*Ri})}var dt=O?"center":t.get("text-justify").evaluate(se,{},i),vt=t.get("symbol-placement"),ti=vt==="point"?24*t.get("text-max-width").evaluate(se,{},i):0,$t=function(){e.allowVerticalPlacement&&$l(Ct)&&(Ve.vertical=Ch(it,r,s,w,pe,ti,D,St,"left",ut,He,Ha.vertical,!0,vt,Be,Ae))};if(!O&&yt){for(var Si=dt==="auto"?yt.map(function(Ri){return dp(Ri)}):[dt],ki=!1,Yi=0;Yi<Si.length;Yi++){var sr=Si[Yi];if(!Ve.horizontal[sr])if(ki)Ve.horizontal[sr]=Ve.horizontal[0];else{var Ir=Ch(it,r,s,w,pe,ti,D,"center",sr,ut,He,Ha.horizontal,!1,vt,Be,Ae);Ir&&(Ve.horizontal[sr]=Ir,ki=Ir.positionedLines.length===1)}}$t()}else{dt==="auto"&&(dt=dp(St));var Sr=Ch(it,r,s,w,pe,ti,D,St,dt,ut,He,Ha.horizontal,!1,vt,Be,Ae);Sr&&(Ve.horizontal[dt]=Sr),$t(),$l(Ct)&&O&&N&&(Ve.vertical=Ch(it,r,s,w,pe,ti,D,St,dt,ut,He,Ha.vertical,!1,vt,Be,Ae))}}var dr=void 0,Pr=!1;if(se.icon&&se.icon.name){var fr=_[se.icon.name];fr&&(dr=function(Ri,Wi,$i){var Vi=yc($i),Qr=Wi[0]-Ri.displaySize[0]*Vi.horizontalAlign,Xr=Wi[1]-Ri.displaySize[1]*Vi.verticalAlign;return{image:Ri,top:Xr,bottom:Xr+Ri.displaySize[1],left:Qr,right:Qr+Ri.displaySize[0]}}(w[se.icon.name],t.get("icon-offset").evaluate(se,{},i),t.get("icon-anchor").evaluate(se,{},i)),Pr=fr.sdf,e.sdfIcons===void 0?e.sdfIcons=fr.sdf:e.sdfIcons!==fr.sdf&&Xt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(fr.pixelRatio!==e.pixelRatio||t.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Mr=Bh(Ve.horizontal)||Ve.vertical;e.iconsInText=!!Mr&&Mr.iconsInText,(Mr||dr)&&function(Ri,Wi,$i,Vi,Qr,Xr,cr,or,zr,ui,to){var sn=Xr.textMaxSize.evaluate(Wi,{});sn===void 0&&(sn=cr);var Cn,Fr=Ri.layers[0].layout,To=Fr.get("icon-offset").evaluate(Wi,{},to),co=Bh($i.horizontal),Wa=cr/24,Jo=Ri.tilePixelRatio*Wa,Yo=Ri.tilePixelRatio*sn/24,io=Ri.tilePixelRatio*or,Xa=Ri.tilePixelRatio*Fr.get("symbol-spacing"),Zu=Fr.get("text-padding")*Ri.tilePixelRatio,wc=Fr.get("icon-padding")*Ri.tilePixelRatio,Ec=Fr.get("text-max-angle")/180*Math.PI,rh=Fr.get("text-rotation-alignment")==="map"&&Fr.get("symbol-placement")!=="point",Ds=Fr.get("icon-rotation-alignment")==="map"&&Fr.get("symbol-placement")!=="point",zl=Fr.get("symbol-placement"),Ic=Xa/2,Hu=Fr.get("icon-text-fit");Vi&&Hu!=="none"&&(Ri.allowVerticalPlacement&&$i.vertical&&(Cn=kh(Vi,$i.vertical,Hu,Fr.get("icon-text-fit-padding"),To,Wa)),co&&(Vi=kh(Vi,co,Hu,Fr.get("icon-text-fit-padding"),To,Wa)));var pu=function(O0,wd){wd.x<0||wd.x>=8192||wd.y<0||wd.y>=8192||function(ro,fu,F0,ah,ny,Rg,vf,Wu,xf,Ed,bf,wf,oy,Bg,Id,Og,Fg,Ug,Ng,jg,Bs,Ef,Vg,Xu,U0){var qg,Vh,Ip,Sp,Tp,Ap=ro.addToLineVertexArray(fu,F0),Gg=0,Zg=0,Hg=0,Wg=0,ay=-1,sy=-1,Ac={},Xg=xe(""),ly=0,uy=0;if(Wu._unevaluatedLayout.getValue("text-radial-offset")===void 0?(ly=(qg=Wu.layout.get("text-offset").evaluate(Bs,{},Xu).map(function(Td){return 24*Td}))[0],uy=qg[1]):(ly=24*Wu.layout.get("text-radial-offset").evaluate(Bs,{},Xu),uy=pp),ro.allowVerticalPlacement&&ah.vertical){var Kg=Wu.layout.get("text-rotate").evaluate(Bs,{},Xu)+90;Sp=new Lh(xf,fu,Ed,bf,wf,ah.vertical,oy,Bg,Id,Kg),vf&&(Tp=new Lh(xf,fu,Ed,bf,wf,vf,Fg,Ug,Id,Kg))}if(ny){var cy=Wu.layout.get("icon-rotate").evaluate(Bs,{}),Jg=Wu.layout.get("icon-text-fit")!=="none",Yg=Cl(ny,cy,Vg,Jg),hy=vf?Cl(vf,cy,Vg,Jg):void 0;Ip=new Lh(xf,fu,Ed,bf,wf,ny,Fg,Ug,!1,cy),Gg=4*Yg.length;var $g=ro.iconSizeData,Sd=null;$g.kind==="source"?(Sd=[128*Wu.layout.get("icon-size").evaluate(Bs,{})])[0]>32640&&Xt(ro.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):$g.kind==="composite"&&((Sd=[128*Ef.compositeIconSizes[0].evaluate(Bs,{},Xu),128*Ef.compositeIconSizes[1].evaluate(Bs,{},Xu)])[0]>32640||Sd[1]>32640)&&Xt(ro.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),ro.addSymbols(ro.icon,Yg,Sd,jg,Ng,Bs,!1,fu,Ap.lineStartIndex,Ap.lineLength,-1,Xu),ay=ro.icon.placedSymbolArray.length-1,hy&&(Zg=4*hy.length,ro.addSymbols(ro.icon,hy,Sd,jg,Ng,Bs,Ha.vertical,fu,Ap.lineStartIndex,Ap.lineLength,-1,Xu),sy=ro.icon.placedSymbolArray.length-1)}for(var Qg in ah.horizontal){var If=ah.horizontal[Qg];if(!Vh){Xg=xe(If.text);var N0=Wu.layout.get("text-rotate").evaluate(Bs,{},Xu);Vh=new Lh(xf,fu,Ed,bf,wf,If,oy,Bg,Id,N0)}var e_=If.positionedLines.length===1;if(Hg+=Rh(ro,fu,If,Rg,Wu,Id,Bs,Og,Ap,ah.vertical?Ha.horizontal:Ha.horizontalOnly,e_?Object.keys(ah.horizontal):[Qg],Ac,ay,Ef,Xu),e_)break}ah.vertical&&(Wg+=Rh(ro,fu,ah.vertical,Rg,Wu,Id,Bs,Og,Ap,Ha.vertical,["vertical"],Ac,sy,Ef,Xu));var j0=Vh?Vh.boxStartIndex:ro.collisionBoxArray.length,V0=Vh?Vh.boxEndIndex:ro.collisionBoxArray.length,q0=Sp?Sp.boxStartIndex:ro.collisionBoxArray.length,G0=Sp?Sp.boxEndIndex:ro.collisionBoxArray.length,Z0=Ip?Ip.boxStartIndex:ro.collisionBoxArray.length,H0=Ip?Ip.boxEndIndex:ro.collisionBoxArray.length,W0=Tp?Tp.boxStartIndex:ro.collisionBoxArray.length,X0=Tp?Tp.boxEndIndex:ro.collisionBoxArray.length,Ku=-1,Sf=function(Td,i_){return Td&&Td.circleDiameter?Math.max(Td.circleDiameter,i_):i_};Ku=Sf(Vh,Ku),Ku=Sf(Sp,Ku),Ku=Sf(Ip,Ku);var t_=(Ku=Sf(Tp,Ku))>-1?1:0;t_&&(Ku*=U0/24),ro.glyphOffsetArray.length>=Or.MAX_GLYPHS&&Xt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Bs.sortKey!==void 0&&ro.addToSortKeyRanges(ro.symbolInstances.length,Bs.sortKey),ro.symbolInstances.emplaceBack(fu.x,fu.y,Ac.right>=0?Ac.right:-1,Ac.center>=0?Ac.center:-1,Ac.left>=0?Ac.left:-1,Ac.vertical||-1,ay,sy,Xg,j0,V0,q0,G0,Z0,H0,W0,X0,Ed,Hg,Wg,Gg,Zg,t_,0,oy,ly,uy,Ku)}(Ri,wd,O0,$i,Vi,Qr,Cn,Ri.layers[0],Ri.collisionBoxArray,Wi.index,Wi.sourceLayerIndex,Ri.index,Jo,Zu,rh,zr,io,wc,Ds,To,Wi,Xr,ui,to,cr)};if(zl==="line")for(var nh=0,bp=fd(Wi.geometry,0,0,8192,8192);nh<bp.length;nh+=1)for(var wp=bp[nh],Fh=0,Uh=Zm(wp,Xa,Ec,$i.vertical||co,Vi,24,Yo,Ri.overscaling,8192);Fh<Uh.length;Fh+=1){var Ep=Uh[Fh];co&&fp(Ri,co.text,Ic,Ep)||pu(wp,Ep)}else if(zl==="line-center")for(var Nh=0,jh=Wi.geometry;Nh<jh.length;Nh+=1){var za=jh[Nh];if(za.length>1){var Sc=Gm(za,Ec,$i.vertical||co,Vi,24,Yo);Sc&&pu(za,Sc)}}else if(Wi.type==="Polygon")for(var Tc=0,$o=op(Wi.geometry,0);Tc<$o.length;Tc+=1){var Pa=$o[Tc],du=Wm(Pa,16);pu(Pa[0],new uu(du.x,du.y,0))}else if(Wi.type==="LineString")for(var al=0,oh=Wi.geometry;al<oh.length;al+=1){var Rs=oh[al];pu(Rs,new uu(Rs[0].x,Rs[0].y,0))}else if(Wi.type==="Point")for(var ty=0,Lg=Wi.geometry;ty<Lg.length;ty+=1)for(var iy=0,Dg=Lg[ty];iy<Dg.length;iy+=1){var ry=Dg[iy];pu([ry],new uu(ry.x,ry.y,0))}}(e,se,Ve,dr,_,h,Be,je,He,Pr,i)},$=0,Q=e.features;$<Q.length;$+=1)K();C&&e.generateCollisionDebugBuffers()},f.perspective=function(e,r,s,_,w){var C,i=1/Math.tan(r/2);return e[0]=i/s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,w!=null&&w!==1/0?(e[10]=(w+_)*(C=1/(_-w)),e[14]=2*w*_*C):(e[10]=-1,e[14]=-2*_),e},f.pick=function(e,r){for(var s={},_=0;_<r.length;_++){var w=r[_];w in e&&(s[w]=e[w])}return s},f.plugin=ai,f.polygonIntersectsPolygon=_a,f.postMapLoadEvent=bi,f.postTurnstileEvent=Ue,f.potpack=cf,f.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],f.register=ni,f.registerForPluginStateChange=function(e){return e({pluginStatus:mo,pluginURL:Ca}),uc.on("pluginStateChange",e),e},f.renderColorRamp=np,f.rotate=function(e,r,s){var _=r[0],w=r[1],C=r[2],i=r[3],t=Math.sin(s),o=Math.cos(s);return e[0]=_*o+C*t,e[1]=w*o+i*t,e[2]=_*-t+C*o,e[3]=w*-t+i*o,e},f.rotateX=function(e,r,s){var _=Math.sin(s),w=Math.cos(s),C=r[4],i=r[5],t=r[6],o=r[7],h=r[8],g=r[9],b=r[10],E=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=C*w+h*_,e[5]=i*w+g*_,e[6]=t*w+b*_,e[7]=o*w+E*_,e[8]=h*w-C*_,e[9]=g*w-i*_,e[10]=b*w-t*_,e[11]=E*w-o*_,e},f.rotateZ=function(e,r,s){var _=Math.sin(s),w=Math.cos(s),C=r[0],i=r[1],t=r[2],o=r[3],h=r[4],g=r[5],b=r[6],E=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=C*w+h*_,e[1]=i*w+g*_,e[2]=t*w+b*_,e[3]=o*w+E*_,e[4]=h*w-C*_,e[5]=g*w-i*_,e[6]=b*w-t*_,e[7]=E*w-o*_,e},f.scale=function(e,r,s){var _=s[0],w=s[1],C=s[2];return e[0]=r[0]*_,e[1]=r[1]*_,e[2]=r[2]*_,e[3]=r[3]*_,e[4]=r[4]*w,e[5]=r[5]*w,e[6]=r[6]*w,e[7]=r[7]*w,e[8]=r[8]*C,e[9]=r[9]*C,e[10]=r[10]*C,e[11]=r[11]*C,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},f.scale$1=function(e,r,s){return e[0]=r[0]*s,e[1]=r[1]*s,e[2]=r[2]*s,e[3]=r[3]*s,e},f.scale$2=function(e,r,s){return e[0]=r[0]*s,e[1]=r[1]*s,e[2]=r[2]*s,e},f.setCacheLimits=function(e,r){pr=e,mr=r},f.setRTLTextPlugin=function(e,r,s){if(s===void 0&&(s=!1),mo==="deferred"||mo==="loading"||mo==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Ca=rr.resolveURL(e),mo="deferred",el=r,Sl(),s||qo()},f.sphericalToCartesian=function(e){var r=e[0],s=e[1],_=e[2];return s+=90,s*=Math.PI/180,_*=Math.PI/180,{x:r*Math.cos(s)*Math.sin(_),y:r*Math.sin(s)*Math.sin(_),z:r*Math.cos(_)}},f.sqrLen=function(e){var r=e[0],s=e[1];return r*r+s*s},f.styleSpec=ye,f.sub=function(e,r,s){return e[0]=r[0]-s[0],e[1]=r[1]-s[1],e[2]=r[2]-s[2],e},f.symbolSize=qm,f.transformMat3=function(e,r,s){var _=r[0],w=r[1],C=r[2];return e[0]=_*s[0]+w*s[3]+C*s[6],e[1]=_*s[1]+w*s[4]+C*s[7],e[2]=_*s[2]+w*s[5]+C*s[8],e},f.transformMat4=Ru,f.translate=function(e,r,s){var _,w,C,i,t,o,h,g,b,E,z,D,O=s[0],N=s[1],U=s[2];return r===e?(e[12]=r[0]*O+r[4]*N+r[8]*U+r[12],e[13]=r[1]*O+r[5]*N+r[9]*U+r[13],e[14]=r[2]*O+r[6]*N+r[10]*U+r[14],e[15]=r[3]*O+r[7]*N+r[11]*U+r[15]):(w=r[1],C=r[2],i=r[3],t=r[4],o=r[5],h=r[6],g=r[7],b=r[8],E=r[9],z=r[10],D=r[11],e[0]=_=r[0],e[1]=w,e[2]=C,e[3]=i,e[4]=t,e[5]=o,e[6]=h,e[7]=g,e[8]=b,e[9]=E,e[10]=z,e[11]=D,e[12]=_*O+t*N+b*U+r[12],e[13]=w*O+o*N+E*U+r[13],e[14]=C*O+h*N+z*U+r[14],e[15]=i*O+g*N+D*U+r[15]),e},f.triggerPluginCompletionEvent=lc,f.uniqueId=gt,f.validateCustomStyleLayer=function(e){var r=[],s=e.id;return s===void 0&&r.push({message:"layers."+s+': missing required property "id"'}),e.render===void 0&&r.push({message:"layers."+s+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&r.push({message:"layers."+s+': property "renderingMode" must be either "2d" or "3d"'}),r},f.validateLight=Yl,f.validateStyle=Aa,f.values=function(e){var r=[];for(var s in e)r.push(e[s]);return r},f.vectorTile=Zc,f.version="1.13.2",f.warnOnce=Xt,f.webpSupported=zt,f.window=X,f.wrap=ft}),P(["./shared"],function(f){function d(te){var oe=typeof te;if(oe==="number"||oe==="boolean"||oe==="string"||te==null)return JSON.stringify(te);if(Array.isArray(te)){for(var le="[",ge=0,Se=te;ge<Se.length;ge+=1)le+=d(Se[ge])+",";return le+"]"}for(var Oe=Object.keys(te).sort(),Ne="{",ye=0;ye<Oe.length;ye++)Ne+=JSON.stringify(Oe[ye])+":"+d(te[Oe[ye]])+",";return Ne+"}"}function R(te){for(var oe="",le=0,ge=f.refProperties;le<ge.length;le+=1)oe+="/"+d(te[ge[le]]);return oe}var q=function(te){this.keyCache={},te&&this.replace(te)};q.prototype.replace=function(te){this._layerConfigs={},this._layers={},this.update(te,[])},q.prototype.update=function(te,oe){for(var le=this,ge=0,Se=te;ge<Se.length;ge+=1){var Oe=Se[ge];this._layerConfigs[Oe.id]=Oe;var Ne=this._layers[Oe.id]=f.createStyleLayer(Oe);Ne._featureFilter=f.featureFilter(Ne.filter),this.keyCache[Oe.id]&&delete this.keyCache[Oe.id]}for(var ye=0,Pe=oe;ye<Pe.length;ye+=1){var Qe=Pe[ye];delete this.keyCache[Qe],delete this._layerConfigs[Qe],delete this._layers[Qe]}this.familiesBySource={};for(var ae=0,H=function(we,Ie){for(var et={},Ke=0;Ke<we.length;Ke++){var tt=Ie&&Ie[we[Ke].id]||R(we[Ke]);Ie&&(Ie[we[Ke].id]=tt);var Ft=et[tt];Ft||(Ft=et[tt]=[]),Ft.push(we[Ke])}var At=[];for(var Bt in et)At.push(et[Bt]);return At}(f.values(this._layerConfigs),this.keyCache);ae<H.length;ae+=1){var W=H[ae].map(function(we){return le._layers[we.id]}),ne=W[0];if(ne.visibility!=="none"){var ce=ne.source||"",_e=this.familiesBySource[ce];_e||(_e=this.familiesBySource[ce]={});var fe=ne.sourceLayer||"_geojsonTileLayer",Ee=_e[fe];Ee||(Ee=_e[fe]=[]),Ee.push(W)}}};var V=function(te){var oe={},le=[];for(var ge in te){var Se=te[ge],Oe=oe[ge]={};for(var Ne in Se){var ye=Se[+Ne];if(ye&&ye.bitmap.width!==0&&ye.bitmap.height!==0){var Pe={x:0,y:0,w:ye.bitmap.width+2,h:ye.bitmap.height+2};le.push(Pe),Oe[Ne]={rect:Pe,metrics:ye.metrics}}}}var Qe=f.potpack(le),ae=new f.AlphaImage({width:Qe.w||1,height:Qe.h||1});for(var H in te){var W=te[H];for(var ne in W){var ce=W[+ne];if(ce&&ce.bitmap.width!==0&&ce.bitmap.height!==0){var _e=oe[H][ne].rect;f.AlphaImage.copy(ce.bitmap,ae,{x:0,y:0},{x:_e.x+1,y:_e.y+1},ce.bitmap)}}}this.image=ae,this.positions=oe};f.register("GlyphAtlas",V);var G=function(te){this.tileID=new f.OverscaledTileID(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.uid=te.uid,this.zoom=te.zoom,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.collectResourceTiming,this.returnDependencies=!!te.returnDependencies,this.promoteId=te.promoteId};function X(te,oe,le){for(var ge=new f.EvaluationParameters(oe),Se=0,Oe=te;Se<Oe.length;Se+=1)Oe[Se].recalculate(ge,le)}function Me(te,oe){var le=f.getArrayBuffer(te.request,function(ge,Se,Oe,Ne){ge?oe(ge):Se&&oe(null,{vectorTile:new f.vectorTile.VectorTile(new f.pbf(Se)),rawData:Se,cacheControl:Oe,expires:Ne})});return function(){le.cancel(),oe()}}G.prototype.parse=function(te,oe,le,ge,Se){var Oe=this;this.status="parsing",this.data=te,this.collisionBoxArray=new f.CollisionBoxArray;var Ne=new f.DictionaryCoder(Object.keys(te.layers).sort()),ye=new f.FeatureIndex(this.tileID,this.promoteId);ye.bucketLayerIDs=[];var Pe,Qe,ae,H,W={},ne={featureIndex:ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le},ce=oe.familiesBySource[this.source];for(var _e in ce){var fe=te.layers[_e];if(fe){fe.version===1&&f.warnOnce('Vector tile source "'+this.source+'" layer "'+_e+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ee=Ne.encode(_e),we=[],Ie=0;Ie<fe.length;Ie++){var et=fe.feature(Ie),Ke=ye.getId(et,_e);we.push({feature:et,id:Ke,index:Ie,sourceLayerIndex:Ee})}for(var tt=0,Ft=ce[_e];tt<Ft.length;tt+=1){var At=Ft[tt],Bt=At[0];Bt.minzoom&&this.zoom<Math.floor(Bt.minzoom)||Bt.maxzoom&&this.zoom>=Bt.maxzoom||Bt.visibility!=="none"&&(X(At,this.zoom,le),(W[Bt.id]=Bt.createBucket({index:ye.bucketLayerIDs.length,layers:At,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ee,sourceID:this.source})).populate(we,ne,this.tileID.canonical),ye.bucketLayerIDs.push(At.map(function(li){return li.id})))}}}var jt=f.mapObject(ne.glyphDependencies,function(li){return Object.keys(li).map(Number)});Object.keys(jt).length?ge.send("getGlyphs",{uid:this.uid,stacks:jt},function(li,Kt){Pe||(Pe=li,Qe=Kt,Ii.call(Oe))}):Qe={};var Hi=Object.keys(ne.iconDependencies);Hi.length?ge.send("getImages",{icons:Hi,source:this.source,tileID:this.tileID,type:"icons"},function(li,Kt){Pe||(Pe=li,ae=Kt,Ii.call(Oe))}):ae={};var mi=Object.keys(ne.patternDependencies);function Ii(){if(Pe)return Se(Pe);if(Qe&&ae&&H){var li=new V(Qe),Kt=new f.ImageAtlas(ae,H);for(var Pi in W){var _r=W[Pi];_r instanceof f.SymbolBucket?(X(_r.layers,this.zoom,le),f.performSymbolLayout(_r,Qe,li.positions,ae,Kt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):_r.hasPattern&&(_r instanceof f.LineBucket||_r instanceof f.FillBucket||_r instanceof f.FillExtrusionBucket)&&(X(_r.layers,this.zoom,le),_r.addFeatures(ne,this.tileID.canonical,Kt.patternPositions))}this.status="done",Se(null,{buckets:f.values(W).filter(function(Sn){return!Sn.isEmpty()}),featureIndex:ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:li.image,imageAtlas:Kt,glyphMap:this.returnDependencies?Qe:null,iconMap:this.returnDependencies?ae:null,glyphPositions:this.returnDependencies?li.positions:null})}}mi.length?ge.send("getImages",{icons:mi,source:this.source,tileID:this.tileID,type:"patterns"},function(li,Kt){Pe||(Pe=li,H=Kt,Ii.call(Oe))}):H={},Ii.call(this)};var ke=function(te,oe,le,ge){this.actor=te,this.layerIndex=oe,this.availableImages=le,this.loadVectorData=ge||Me,this.loading={},this.loaded={}};ke.prototype.loadTile=function(te,oe){var le=this,ge=te.uid;this.loading||(this.loading={});var Se=!!(te&&te.request&&te.request.collectResourceTiming)&&new f.RequestPerformance(te.request),Oe=this.loading[ge]=new G(te);Oe.abort=this.loadVectorData(te,function(Ne,ye){if(delete le.loading[ge],Ne||!ye)return Oe.status="done",le.loaded[ge]=Oe,oe(Ne);var Pe=ye.rawData,Qe={};ye.expires&&(Qe.expires=ye.expires),ye.cacheControl&&(Qe.cacheControl=ye.cacheControl);var ae={};if(Se){var H=Se.finish();H&&(ae.resourceTiming=JSON.parse(JSON.stringify(H)))}Oe.vectorTile=ye.vectorTile,Oe.parse(ye.vectorTile,le.layerIndex,le.availableImages,le.actor,function(W,ne){if(W||!ne)return oe(W);oe(null,f.extend({rawTileData:Pe.slice(0)},ne,Qe,ae))}),le.loaded=le.loaded||{},le.loaded[ge]=Oe})},ke.prototype.reloadTile=function(te,oe){var le=this,ge=this.loaded,Se=te.uid,Oe=this;if(ge&&ge[Se]){var Ne=ge[Se];Ne.showCollisionBoxes=te.showCollisionBoxes;var ye=function(Pe,Qe){var ae=Ne.reloadCallback;ae&&(delete Ne.reloadCallback,Ne.parse(Ne.vectorTile,Oe.layerIndex,le.availableImages,Oe.actor,ae)),oe(Pe,Qe)};Ne.status==="parsing"?Ne.reloadCallback=ye:Ne.status==="done"&&(Ne.vectorTile?Ne.parse(Ne.vectorTile,this.layerIndex,this.availableImages,this.actor,ye):ye())}},ke.prototype.abortTile=function(te,oe){var le=this.loading,ge=te.uid;le&&le[ge]&&le[ge].abort&&(le[ge].abort(),delete le[ge]),oe()},ke.prototype.removeTile=function(te,oe){var le=this.loaded,ge=te.uid;le&&le[ge]&&delete le[ge],oe()};var qe=f.window.ImageBitmap,We=function(){this.loaded={}};function ft(te,oe){if(te.length!==0){Ge(te[0],oe);for(var le=1;le<te.length;le++)Ge(te[le],!oe)}}function Ge(te,oe){for(var le=0,ge=0,Se=te.length,Oe=Se-1;ge<Se;Oe=ge++)le+=(te[ge][0]-te[Oe][0])*(te[Oe][1]+te[ge][1]);le>=0!=!!oe&&te.reverse()}We.prototype.loadTile=function(te,oe){var le=te.uid,ge=te.encoding,Se=te.rawImageData,Oe=qe&&Se instanceof qe?this.getImageData(Se):Se,Ne=new f.DEMData(le,Oe,ge);this.loaded=this.loaded||{},this.loaded[le]=Ne,oe(null,Ne)},We.prototype.getImageData=function(te){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(te.width,te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=te.width,this.offscreenCanvas.height=te.height,this.offscreenCanvasContext.drawImage(te,0,0,te.width,te.height);var oe=this.offscreenCanvasContext.getImageData(-1,-1,te.width+2,te.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new f.RGBAImage({width:oe.width,height:oe.height},oe.data)},We.prototype.removeTile=function(te){var oe=this.loaded,le=te.uid;oe&&oe[le]&&delete oe[le]};var Ze=f.vectorTile.VectorTileFeature.prototype.toGeoJSON,gt=function(te){this._feature=te,this.extent=f.EXTENT,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))};gt.prototype.loadGeometry=function(){if(this._feature.type===1){for(var te=[],oe=0,le=this._feature.geometry;oe<le.length;oe+=1){var ge=le[oe];te.push([new f.Point$1(ge[0],ge[1])])}return te}for(var Se=[],Oe=0,Ne=this._feature.geometry;Oe<Ne.length;Oe+=1){for(var ye=[],Pe=0,Qe=Ne[Oe];Pe<Qe.length;Pe+=1){var ae=Qe[Pe];ye.push(new f.Point$1(ae[0],ae[1]))}Se.push(ye)}return Se},gt.prototype.toGeoJSON=function(te,oe,le){return Ze.call(this,te,oe,le)};var ct=function(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.EXTENT,this.length=te.length,this._features=te};ct.prototype.feature=function(te){return new gt(this._features[te])};var pt=f.vectorTile.VectorTileFeature,lt=pi;function pi(te,oe){this.options=oe||{},this.features=te,this.length=te.length}function Et(te,oe){this.id=typeof te.id=="number"?te.id:void 0,this.type=te.type,this.rawGeometry=te.type===1?[te.geometry]:te.geometry,this.properties=te.tags,this.extent=oe||4096}pi.prototype.feature=function(te){return new Et(this.features[te],this.options.extent)},Et.prototype.loadGeometry=function(){var te=this.rawGeometry;this.geometry=[];for(var oe=0;oe<te.length;oe++){for(var le=te[oe],ge=[],Se=0;Se<le.length;Se++)ge.push(new f.Point$1(le[Se][0],le[Se][1]));this.geometry.push(ge)}return this.geometry},Et.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var te=this.geometry,oe=1/0,le=-1/0,ge=1/0,Se=-1/0,Oe=0;Oe<te.length;Oe++)for(var Ne=te[Oe],ye=0;ye<Ne.length;ye++){var Pe=Ne[ye];oe=Math.min(oe,Pe.x),le=Math.max(le,Pe.x),ge=Math.min(ge,Pe.y),Se=Math.max(Se,Pe.y)}return[oe,ge,le,Se]},Et.prototype.toGeoJSON=pt.prototype.toGeoJSON;var Wt=qi,vi=lt;function qi(te){var oe=new f.pbf;return function(le,ge){for(var Se in le.layers)ge.writeMessage(3,Xt,le.layers[Se])}(te,oe),oe.finish()}function Xt(te,oe){var le;oe.writeVarintField(15,te.version||1),oe.writeStringField(1,te.name||""),oe.writeVarintField(5,te.extent||4096);var ge={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<te.length;le++)ge.feature=te.feature(le),oe.writeMessage(2,Qt,ge);var Se=ge.keys;for(le=0;le<Se.length;le++)oe.writeStringField(3,Se[le]);var Oe=ge.values;for(le=0;le<Oe.length;le++)oe.writeMessage(4,wr,Oe[le])}function Qt(te,oe){var le=te.feature;le.id!==void 0&&oe.writeVarintField(1,le.id),oe.writeMessage(2,Ei,te),oe.writeVarintField(3,le.type),oe.writeMessage(4,hr,le)}function Ei(te,oe){var le=te.feature,ge=te.keys,Se=te.values,Oe=te.keycache,Ne=te.valuecache;for(var ye in le.properties){var Pe=Oe[ye];Pe===void 0&&(ge.push(ye),Oe[ye]=Pe=ge.length-1),oe.writeVarint(Pe);var Qe=le.properties[ye],ae=typeof Qe;ae!=="string"&&ae!=="boolean"&&ae!=="number"&&(Qe=JSON.stringify(Qe));var H=ae+":"+Qe,W=Ne[H];W===void 0&&(Se.push(Qe),Ne[H]=W=Se.length-1),oe.writeVarint(W)}}function bt(te,oe){return(oe<<3)+(7&te)}function Gi(te){return te<<1^te>>31}function hr(te,oe){for(var le=te.loadGeometry(),ge=te.type,Se=0,Oe=0,Ne=le.length,ye=0;ye<Ne;ye++){var Pe=le[ye],Qe=1;ge===1&&(Qe=Pe.length),oe.writeVarint(bt(1,Qe));for(var ae=ge===3?Pe.length-1:Pe.length,H=0;H<ae;H++){H===1&&ge!==1&&oe.writeVarint(bt(2,ae-1));var W=Pe[H].x-Se,ne=Pe[H].y-Oe;oe.writeVarint(Gi(W)),oe.writeVarint(Gi(ne)),Se+=W,Oe+=ne}ge===3&&oe.writeVarint(bt(7,1))}}function wr(te,oe){var le=typeof te;le==="string"?oe.writeStringField(1,te):le==="boolean"?oe.writeBooleanField(7,te):le==="number"&&(te%1!=0?oe.writeDoubleField(3,te):te<0?oe.writeSVarintField(6,te):oe.writeVarintField(5,te))}function Dt(te,oe,le,ge){oi(te,le,ge),oi(oe,2*le,2*ge),oi(oe,2*le+1,2*ge+1)}function oi(te,oe,le){var ge=te[oe];te[oe]=te[le],te[le]=ge}function fi(te,oe,le,ge){var Se=te-le,Oe=oe-ge;return Se*Se+Oe*Oe}Wt.fromVectorTileJs=qi,Wt.fromGeojsonVt=function(te,oe){oe=oe||{};var le={};for(var ge in te)le[ge]=new lt(te[ge].features,oe),le[ge].name=ge,le[ge].version=oe.version,le[ge].extent=oe.extent;return qi({layers:le})},Wt.GeoJSONWrapper=vi;var Bi=function(te){return te[0]},Nt=function(te){return te[1]},Xi=function(te,oe,le,ge,Se){oe===void 0&&(oe=Bi),le===void 0&&(le=Nt),ge===void 0&&(ge=64),Se===void 0&&(Se=Float64Array),this.nodeSize=ge,this.points=te;for(var Oe=te.length<65536?Uint16Array:Uint32Array,Ne=this.ids=new Oe(te.length),ye=this.coords=new Se(2*te.length),Pe=0;Pe<te.length;Pe++)Ne[Pe]=Pe,ye[2*Pe]=oe(te[Pe]),ye[2*Pe+1]=le(te[Pe]);(function Qe(ae,H,W,ne,ce,_e){if(!(ce-ne<=W)){var fe=ne+ce>>1;(function Ee(we,Ie,et,Ke,tt,Ft){for(;tt>Ke;){if(tt-Ke>600){var At=tt-Ke+1,Bt=et-Ke+1,jt=Math.log(At),Hi=.5*Math.exp(2*jt/3),mi=.5*Math.sqrt(jt*Hi*(At-Hi)/At)*(Bt-At/2<0?-1:1);Ee(we,Ie,et,Math.max(Ke,Math.floor(et-Bt*Hi/At+mi)),Math.min(tt,Math.floor(et+(At-Bt)*Hi/At+mi)),Ft)}var Ii=Ie[2*et+Ft],li=Ke,Kt=tt;for(Dt(we,Ie,Ke,et),Ie[2*tt+Ft]>Ii&&Dt(we,Ie,Ke,tt);li<Kt;){for(Dt(we,Ie,li,Kt),li++,Kt--;Ie[2*li+Ft]<Ii;)li++;for(;Ie[2*Kt+Ft]>Ii;)Kt--}Ie[2*Ke+Ft]===Ii?Dt(we,Ie,Ke,Kt):Dt(we,Ie,++Kt,tt),Kt<=et&&(Ke=Kt+1),et<=Kt&&(tt=Kt-1)}})(ae,H,fe,ne,ce,_e%2),Qe(ae,H,W,ne,fe-1,_e+1),Qe(ae,H,W,fe+1,ce,_e+1)}})(Ne,ye,ge,0,Ne.length-1,0)};Xi.prototype.range=function(te,oe,le,ge){return function(Se,Oe,Ne,ye,Pe,Qe,ae){for(var H,W,ne=[0,Se.length-1,0],ce=[];ne.length;){var _e=ne.pop(),fe=ne.pop(),Ee=ne.pop();if(fe-Ee<=ae)for(var we=Ee;we<=fe;we++)W=Oe[2*we+1],(H=Oe[2*we])>=Ne&&H<=Pe&&W>=ye&&W<=Qe&&ce.push(Se[we]);else{var Ie=Math.floor((Ee+fe)/2);W=Oe[2*Ie+1],(H=Oe[2*Ie])>=Ne&&H<=Pe&&W>=ye&&W<=Qe&&ce.push(Se[Ie]);var et=(_e+1)%2;(_e===0?Ne<=H:ye<=W)&&(ne.push(Ee),ne.push(Ie-1),ne.push(et)),(_e===0?Pe>=H:Qe>=W)&&(ne.push(Ie+1),ne.push(fe),ne.push(et))}}return ce}(this.ids,this.coords,te,oe,le,ge,this.nodeSize)},Xi.prototype.within=function(te,oe,le){return function(ge,Se,Oe,Ne,ye,Pe){for(var Qe=[0,ge.length-1,0],ae=[],H=ye*ye;Qe.length;){var W=Qe.pop(),ne=Qe.pop(),ce=Qe.pop();if(ne-ce<=Pe)for(var _e=ce;_e<=ne;_e++)fi(Se[2*_e],Se[2*_e+1],Oe,Ne)<=H&&ae.push(ge[_e]);else{var fe=Math.floor((ce+ne)/2),Ee=Se[2*fe],we=Se[2*fe+1];fi(Ee,we,Oe,Ne)<=H&&ae.push(ge[fe]);var Ie=(W+1)%2;(W===0?Oe-ye<=Ee:Ne-ye<=we)&&(Qe.push(ce),Qe.push(fe-1),Qe.push(Ie)),(W===0?Oe+ye>=Ee:Ne+ye>=we)&&(Qe.push(fe+1),Qe.push(ne),Qe.push(Ie))}}return ae}(this.ids,this.coords,te,oe,le,this.nodeSize)};var Li={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(te){return te}},xi=function(te){this.options=yi(Object.create(Li),te),this.trees=new Array(this.options.maxZoom+1)};function rr(te,oe,le,ge,Se){return{x:te,y:oe,zoom:1/0,id:le,parentId:-1,numPoints:ge,properties:Se}}function Ti(te,oe){var le=te.geometry.coordinates,ge=le[1];return{x:Rt(le[0]),y:rt(ge),zoom:1/0,index:oe,parentId:-1}}function zt(te){return{type:"Feature",id:te.id,properties:tr(te),geometry:{type:"Point",coordinates:[(ge=te.x,360*(ge-.5)),(oe=te.y,le=(180-360*oe)*Math.PI/180,360*Math.atan(Math.exp(le))/Math.PI-90)]}};var oe,le,ge}function tr(te){var oe=te.numPoints,le=oe>=1e4?Math.round(oe/1e3)+"k":oe>=1e3?Math.round(oe/100)/10+"k":oe;return yi(yi({},te.properties),{cluster:!0,cluster_id:te.id,point_count:oe,point_count_abbreviated:le})}function Rt(te){return te/360+.5}function rt(te){var oe=Math.sin(te*Math.PI/180),le=.5-.25*Math.log((1+oe)/(1-oe))/Math.PI;return le<0?0:le>1?1:le}function yi(te,oe){for(var le in oe)te[le]=oe[le];return te}function ir(te){return te.x}function Cr(te){return te.y}function no(te,oe,le,ge,Se,Oe){var Ne=Se-le,ye=Oe-ge;if(Ne!==0||ye!==0){var Pe=((te-le)*Ne+(oe-ge)*ye)/(Ne*Ne+ye*ye);Pe>1?(le=Se,ge=Oe):Pe>0&&(le+=Ne*Pe,ge+=ye*Pe)}return(Ne=te-le)*Ne+(ye=oe-ge)*ye}function qn(te,oe,le,ge){var Se={id:te===void 0?null:te,type:oe,geometry:le,tags:ge,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Oe){var Ne=Oe.geometry,ye=Oe.type;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")Mo(Oe,Ne);else if(ye==="Polygon"||ye==="MultiLineString")for(var Pe=0;Pe<Ne.length;Pe++)Mo(Oe,Ne[Pe]);else if(ye==="MultiPolygon")for(Pe=0;Pe<Ne.length;Pe++)for(var Qe=0;Qe<Ne[Pe].length;Qe++)Mo(Oe,Ne[Pe][Qe])}(Se),Se}function Mo(te,oe){for(var le=0;le<oe.length;le+=3)te.minX=Math.min(te.minX,oe[le]),te.minY=Math.min(te.minY,oe[le+1]),te.maxX=Math.max(te.maxX,oe[le]),te.maxY=Math.max(te.maxY,oe[le+1])}function fn(te,oe,le,ge){if(oe.geometry){var Se=oe.geometry.coordinates,Oe=oe.geometry.type,Ne=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),ye=[],Pe=oe.id;if(le.promoteId?Pe=oe.properties[le.promoteId]:le.generateId&&(Pe=ge||0),Oe==="Point")oo(Se,ye);else if(Oe==="MultiPoint")for(var Qe=0;Qe<Se.length;Qe++)oo(Se[Qe],ye);else if(Oe==="LineString")Gn(Se,ye,Ne,!1);else if(Oe==="MultiLineString"){if(le.lineMetrics){for(Qe=0;Qe<Se.length;Qe++)Gn(Se[Qe],ye=[],Ne,!1),te.push(qn(Pe,"LineString",ye,oe.properties));return}Zi(Se,ye,Ne,!1)}else if(Oe==="Polygon")Zi(Se,ye,Ne,!0);else{if(Oe!=="MultiPolygon"){if(Oe==="GeometryCollection"){for(Qe=0;Qe<oe.geometry.geometries.length;Qe++)fn(te,{id:Pe,geometry:oe.geometry.geometries[Qe],properties:oe.properties},le,ge);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Qe=0;Qe<Se.length;Qe++){var ae=[];Zi(Se[Qe],ae,Ne,!0),ye.push(ae)}}te.push(qn(Pe,Oe,ye,oe.properties))}}function oo(te,oe){oe.push(Fn(te[0])),oe.push(_o(te[1])),oe.push(0)}function Gn(te,oe,le,ge){for(var Se,Oe,Ne=0,ye=0;ye<te.length;ye++){var Pe=Fn(te[ye][0]),Qe=_o(te[ye][1]);oe.push(Pe),oe.push(Qe),oe.push(0),ye>0&&(Ne+=ge?(Se*Qe-Pe*Oe)/2:Math.sqrt(Math.pow(Pe-Se,2)+Math.pow(Qe-Oe,2))),Se=Pe,Oe=Qe}var ae=oe.length-3;oe[2]=1,function H(W,ne,ce,_e){for(var fe,Ee=_e,we=ce-ne>>1,Ie=ce-ne,et=W[ne],Ke=W[ne+1],tt=W[ce],Ft=W[ce+1],At=ne+3;At<ce;At+=3){var Bt=no(W[At],W[At+1],et,Ke,tt,Ft);if(Bt>Ee)fe=At,Ee=Bt;else if(Bt===Ee){var jt=Math.abs(At-we);jt<Ie&&(fe=At,Ie=jt)}}Ee>_e&&(fe-ne>3&&H(W,ne,fe,_e),W[fe+2]=Ee,ce-fe>3&&H(W,fe,ce,_e))}(oe,0,ae,le),oe[ae+2]=1,oe.size=Math.abs(Ne),oe.start=0,oe.end=oe.size}function Zi(te,oe,le,ge){for(var Se=0;Se<te.length;Se++){var Oe=[];Gn(te[Se],Oe,le,ge),oe.push(Oe)}}function Fn(te){return te/360+.5}function _o(te){var oe=Math.sin(te*Math.PI/180),le=.5-.25*Math.log((1+oe)/(1-oe))/Math.PI;return le<0?0:le>1?1:le}function Zn(te,oe,le,ge,Se,Oe,Ne,ye){if(ge/=oe,Oe>=(le/=oe)&&Ne<ge)return te;if(Ne<le||Oe>=ge)return null;for(var Pe=[],Qe=0;Qe<te.length;Qe++){var ae=te[Qe],H=ae.geometry,W=ae.type,ne=Se===0?ae.minX:ae.minY,ce=Se===0?ae.maxX:ae.maxY;if(ne>=le&&ce<ge)Pe.push(ae);else if(!(ce<le||ne>=ge)){var _e=[];if(W==="Point"||W==="MultiPoint")Ra(H,_e,le,ge,Se);else if(W==="LineString")Ue(H,_e,le,ge,Se,!1,ye.lineMetrics);else if(W==="MultiLineString")bi(H,_e,le,ge,Se,!1);else if(W==="Polygon")bi(H,_e,le,ge,Se,!0);else if(W==="MultiPolygon")for(var fe=0;fe<H.length;fe++){var Ee=[];bi(H[fe],Ee,le,ge,Se,!0),Ee.length&&_e.push(Ee)}if(_e.length){if(ye.lineMetrics&&W==="LineString"){for(fe=0;fe<_e.length;fe++)Pe.push(qn(ae.id,W,_e[fe],ae.tags));continue}W!=="LineString"&&W!=="MultiLineString"||(_e.length===1?(W="LineString",_e=_e[0]):W="MultiLineString"),W!=="Point"&&W!=="MultiPoint"||(W=_e.length===3?"Point":"MultiPoint"),Pe.push(qn(ae.id,W,_e,ae.tags))}}}return Pe.length?Pe:null}function Ra(te,oe,le,ge,Se){for(var Oe=0;Oe<te.length;Oe+=3){var Ne=te[Oe+Se];Ne>=le&&Ne<=ge&&(oe.push(te[Oe]),oe.push(te[Oe+1]),oe.push(te[Oe+2]))}}function Ue(te,oe,le,ge,Se,Oe,Ne){for(var ye,Pe,Qe=_t(te),ae=Se===0?mr:Hn,H=te.start,W=0;W<te.length-3;W+=3){var ne=te[W],ce=te[W+1],_e=te[W+2],fe=te[W+3],Ee=te[W+4],we=Se===0?ne:ce,Ie=Se===0?fe:Ee,et=!1;Ne&&(ye=Math.sqrt(Math.pow(ne-fe,2)+Math.pow(ce-Ee,2))),we<le?Ie>le&&(Pe=ae(Qe,ne,ce,fe,Ee,le),Ne&&(Qe.start=H+ye*Pe)):we>ge?Ie<ge&&(Pe=ae(Qe,ne,ce,fe,Ee,ge),Ne&&(Qe.start=H+ye*Pe)):pr(Qe,ne,ce,_e),Ie<le&&we>=le&&(Pe=ae(Qe,ne,ce,fe,Ee,le),et=!0),Ie>ge&&we<=ge&&(Pe=ae(Qe,ne,ce,fe,Ee,ge),et=!0),!Oe&&et&&(Ne&&(Qe.end=H+ye*Pe),oe.push(Qe),Qe=_t(te)),Ne&&(H+=ye)}var Ke=te.length-3;ne=te[Ke],ce=te[Ke+1],_e=te[Ke+2],(we=Se===0?ne:ce)>=le&&we<=ge&&pr(Qe,ne,ce,_e),Ke=Qe.length-3,Oe&&Ke>=3&&(Qe[Ke]!==Qe[0]||Qe[Ke+1]!==Qe[1])&&pr(Qe,Qe[0],Qe[1],Qe[2]),Qe.length&&oe.push(Qe)}function _t(te){var oe=[];return oe.size=te.size,oe.start=te.start,oe.end=te.end,oe}function bi(te,oe,le,ge,Se,Oe){for(var Ne=0;Ne<te.length;Ne++)Ue(te[Ne],oe,le,ge,Se,Oe,!1)}function pr(te,oe,le,ge){te.push(oe),te.push(le),te.push(ge)}function mr(te,oe,le,ge,Se,Oe){var Ne=(Oe-oe)/(ge-oe);return te.push(Oe),te.push(le+(Se-le)*Ne),te.push(1),Ne}function Hn(te,oe,le,ge,Se,Oe){var Ne=(Oe-le)/(Se-le);return te.push(oe+(ge-oe)*Ne),te.push(Oe),te.push(1),Ne}function Wn(te,oe){for(var le=[],ge=0;ge<te.length;ge++){var Se,Oe=te[ge],Ne=Oe.type;if(Ne==="Point"||Ne==="MultiPoint"||Ne==="LineString")Se=ea(Oe.geometry,oe);else if(Ne==="MultiLineString"||Ne==="Polygon"){Se=[];for(var ye=0;ye<Oe.geometry.length;ye++)Se.push(ea(Oe.geometry[ye],oe))}else if(Ne==="MultiPolygon")for(Se=[],ye=0;ye<Oe.geometry.length;ye++){for(var Pe=[],Qe=0;Qe<Oe.geometry[ye].length;Qe++)Pe.push(ea(Oe.geometry[ye][Qe],oe));Se.push(Pe)}le.push(qn(Oe.id,Ne,Se,Oe.tags))}return le}function ea(te,oe){var le=[];le.size=te.size,te.start!==void 0&&(le.start=te.start,le.end=te.end);for(var ge=0;ge<te.length;ge+=3)le.push(te[ge]+oe,te[ge+1],te[ge+2]);return le}function Gr(te,oe){if(te.transformed)return te;var le,ge,Se,Oe=1<<te.z,Ne=te.x,ye=te.y;for(le=0;le<te.features.length;le++){var Pe=te.features[le],Qe=Pe.geometry,ae=Pe.type;if(Pe.geometry=[],ae===1)for(ge=0;ge<Qe.length;ge+=2)Pe.geometry.push(Ht(Qe[ge],Qe[ge+1],oe,Oe,Ne,ye));else for(ge=0;ge<Qe.length;ge++){var H=[];for(Se=0;Se<Qe[ge].length;Se+=2)H.push(Ht(Qe[ge][Se],Qe[ge][Se+1],oe,Oe,Ne,ye));Pe.geometry.push(H)}}return te.transformed=!0,te}function Ht(te,oe,le,ge,Se,Oe){return[Math.round(le*(te*ge-Se)),Math.round(le*(oe*ge-Oe))]}function nr(te,oe,le,ge,Se){for(var Oe=oe===Se.maxZoom?0:Se.tolerance/((1<<oe)*Se.extent),Ne={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:ge,z:oe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ye=0;ye<te.length;ye++){Ne.numFeatures++,Ki(Ne,te[ye],Oe,Se);var Pe=te[ye].minX,Qe=te[ye].minY,ae=te[ye].maxX,H=te[ye].maxY;Pe<Ne.minX&&(Ne.minX=Pe),Qe<Ne.minY&&(Ne.minY=Qe),ae>Ne.maxX&&(Ne.maxX=ae),H>Ne.maxY&&(Ne.maxY=H)}return Ne}function Ki(te,oe,le,ge){var Se=oe.geometry,Oe=oe.type,Ne=[];if(Oe==="Point"||Oe==="MultiPoint")for(var ye=0;ye<Se.length;ye+=3)Ne.push(Se[ye]),Ne.push(Se[ye+1]),te.numPoints++,te.numSimplified++;else if(Oe==="LineString")zn(Ne,Se,te,le,!1,!1);else if(Oe==="MultiLineString"||Oe==="Polygon")for(ye=0;ye<Se.length;ye++)zn(Ne,Se[ye],te,le,Oe==="Polygon",ye===0);else if(Oe==="MultiPolygon")for(var Pe=0;Pe<Se.length;Pe++){var Qe=Se[Pe];for(ye=0;ye<Qe.length;ye++)zn(Ne,Qe[ye],te,le,!0,ye===0)}if(Ne.length){var ae=oe.tags||null;if(Oe==="LineString"&&ge.lineMetrics){for(var H in ae={},oe.tags)ae[H]=oe.tags[H];ae.mapbox_clip_start=Se.start/Se.size,ae.mapbox_clip_end=Se.end/Se.size}var W={geometry:Ne,type:Oe==="Polygon"||Oe==="MultiPolygon"?3:Oe==="LineString"||Oe==="MultiLineString"?2:1,tags:ae};oe.id!==null&&(W.id=oe.id),te.features.push(W)}}function zn(te,oe,le,ge,Se,Oe){var Ne=ge*ge;if(ge>0&&oe.size<(Se?Ne:ge))le.numPoints+=oe.length/3;else{for(var ye=[],Pe=0;Pe<oe.length;Pe+=3)(ge===0||oe[Pe+2]>Ne)&&(le.numSimplified++,ye.push(oe[Pe]),ye.push(oe[Pe+1])),le.numPoints++;Se&&function(Qe,ae){for(var H=0,W=0,ne=Qe.length,ce=ne-2;W<ne;ce=W,W+=2)H+=(Qe[W]-Qe[ce])*(Qe[W+1]+Qe[ce+1]);if(H>0===ae)for(W=0,ne=Qe.length;W<ne/2;W+=2){var _e=Qe[W],fe=Qe[W+1];Qe[W]=Qe[ne-2-W],Qe[W+1]=Qe[ne-1-W],Qe[ne-2-W]=_e,Qe[ne-1-W]=fe}}(ye,Oe),te.push(ye)}}function Xn(te,oe){var le=(oe=this.options=function(Se,Oe){for(var Ne in Oe)Se[Ne]=Oe[Ne];return Se}(Object.create(this.options),oe)).debug;if(le&&console.time("preprocess data"),oe.maxZoom<0||oe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(oe.promoteId&&oe.generateId)throw new Error("promoteId and generateId cannot be used together.");var ge=function(Se,Oe){var Ne=[];if(Se.type==="FeatureCollection")for(var ye=0;ye<Se.features.length;ye++)fn(Ne,Se.features[ye],Oe,ye);else fn(Ne,Se.type==="Feature"?Se:{geometry:Se},Oe);return Ne}(te,oe);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",oe.indexMaxZoom,oe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ge=function(Se,Oe){var Ne=Oe.buffer/Oe.extent,ye=Se,Pe=Zn(Se,1,-1-Ne,Ne,0,-1,2,Oe),Qe=Zn(Se,1,1-Ne,2+Ne,0,-1,2,Oe);return(Pe||Qe)&&(ye=Zn(Se,1,-Ne,1+Ne,0,-1,2,Oe)||[],Pe&&(ye=Wn(Pe,1).concat(ye)),Qe&&(ye=ye.concat(Wn(Qe,-1)))),ye}(ge,oe)).length&&this.splitTile(ge,0,0,0),le&&(ge.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ni(te,oe,le){return 32*((1<<te)*le+oe)+te}function fa(te,oe){var le=te.tileID.canonical;if(!this._geoJSONIndex)return oe(null,null);var ge=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!ge)return oe(null,null);var Se=new ct(ge.features),Oe=Wt(Se);Oe.byteOffset===0&&Oe.byteLength===Oe.buffer.byteLength||(Oe=new Uint8Array(Oe)),oe(null,{vectorTile:Se,rawData:Oe.buffer})}xi.prototype.load=function(te){var oe=this.options,le=oe.log,ge=oe.minZoom,Se=oe.maxZoom,Oe=oe.nodeSize;le&&console.time("total time");var Ne="prepare "+te.length+" points";le&&console.time(Ne),this.points=te;for(var ye=[],Pe=0;Pe<te.length;Pe++)te[Pe].geometry&&ye.push(Ti(te[Pe],Pe));this.trees[Se+1]=new Xi(ye,ir,Cr,Oe,Float32Array),le&&console.timeEnd(Ne);for(var Qe=Se;Qe>=ge;Qe--){var ae=+Date.now();ye=this._cluster(ye,Qe),this.trees[Qe]=new Xi(ye,ir,Cr,Oe,Float32Array),le&&console.log("z%d: %d clusters in %dms",Qe,ye.length,+Date.now()-ae)}return le&&console.timeEnd("total time"),this},xi.prototype.getClusters=function(te,oe){var le=((te[0]+180)%360+360)%360-180,ge=Math.max(-90,Math.min(90,te[1])),Se=te[2]===180?180:((te[2]+180)%360+360)%360-180,Oe=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)le=-180,Se=180;else if(le>Se){var Ne=this.getClusters([le,ge,180,Oe],oe),ye=this.getClusters([-180,ge,Se,Oe],oe);return Ne.concat(ye)}for(var Pe=this.trees[this._limitZoom(oe)],Qe=[],ae=0,H=Pe.range(Rt(le),rt(Oe),Rt(Se),rt(ge));ae<H.length;ae+=1){var W=Pe.points[H[ae]];Qe.push(W.numPoints?zt(W):this.points[W.index])}return Qe},xi.prototype.getChildren=function(te){var oe=this._getOriginId(te),le=this._getOriginZoom(te),ge="No cluster with the specified id.",Se=this.trees[le];if(!Se)throw new Error(ge);var Oe=Se.points[oe];if(!Oe)throw new Error(ge);for(var Ne=this.options.radius/(this.options.extent*Math.pow(2,le-1)),ye=[],Pe=0,Qe=Se.within(Oe.x,Oe.y,Ne);Pe<Qe.length;Pe+=1){var ae=Se.points[Qe[Pe]];ae.parentId===te&&ye.push(ae.numPoints?zt(ae):this.points[ae.index])}if(ye.length===0)throw new Error(ge);return ye},xi.prototype.getLeaves=function(te,oe,le){var ge=[];return this._appendLeaves(ge,te,oe=oe||10,le=le||0,0),ge},xi.prototype.getTile=function(te,oe,le){var ge=this.trees[this._limitZoom(te)],Se=Math.pow(2,te),Oe=this.options,Ne=Oe.radius/Oe.extent,ye=(le-Ne)/Se,Pe=(le+1+Ne)/Se,Qe={features:[]};return this._addTileFeatures(ge.range((oe-Ne)/Se,ye,(oe+1+Ne)/Se,Pe),ge.points,oe,le,Se,Qe),oe===0&&this._addTileFeatures(ge.range(1-Ne/Se,ye,1,Pe),ge.points,Se,le,Se,Qe),oe===Se-1&&this._addTileFeatures(ge.range(0,ye,Ne/Se,Pe),ge.points,-1,le,Se,Qe),Qe.features.length?Qe:null},xi.prototype.getClusterExpansionZoom=function(te){for(var oe=this._getOriginZoom(te)-1;oe<=this.options.maxZoom;){var le=this.getChildren(te);if(oe++,le.length!==1)break;te=le[0].properties.cluster_id}return oe},xi.prototype._appendLeaves=function(te,oe,le,ge,Se){for(var Oe=0,Ne=this.getChildren(oe);Oe<Ne.length;Oe+=1){var ye=Ne[Oe],Pe=ye.properties;if(Pe&&Pe.cluster?Se+Pe.point_count<=ge?Se+=Pe.point_count:Se=this._appendLeaves(te,Pe.cluster_id,le,ge,Se):Se<ge?Se++:te.push(ye),te.length===le)break}return Se},xi.prototype._addTileFeatures=function(te,oe,le,ge,Se,Oe){for(var Ne=0,ye=te;Ne<ye.length;Ne+=1){var Pe=oe[ye[Ne]],Qe=Pe.numPoints,ae={type:1,geometry:[[Math.round(this.options.extent*(Pe.x*Se-le)),Math.round(this.options.extent*(Pe.y*Se-ge))]],tags:Qe?tr(Pe):this.points[Pe.index].properties},H=void 0;Qe?H=Pe.id:this.options.generateId?H=Pe.index:this.points[Pe.index].id&&(H=this.points[Pe.index].id),H!==void 0&&(ae.id=H),Oe.features.push(ae)}},xi.prototype._limitZoom=function(te){return Math.max(this.options.minZoom,Math.min(+te,this.options.maxZoom+1))},xi.prototype._cluster=function(te,oe){for(var le=[],ge=this.options,Se=ge.reduce,Oe=ge.minPoints,Ne=ge.radius/(ge.extent*Math.pow(2,oe)),ye=0;ye<te.length;ye++){var Pe=te[ye];if(!(Pe.zoom<=oe)){Pe.zoom=oe;for(var Qe=this.trees[oe+1],ae=Qe.within(Pe.x,Pe.y,Ne),H=Pe.numPoints||1,W=H,ne=0,ce=ae;ne<ce.length;ne+=1){var _e=Qe.points[ce[ne]];_e.zoom>oe&&(W+=_e.numPoints||1)}if(W>=Oe){for(var fe=Pe.x*H,Ee=Pe.y*H,we=Se&&H>1?this._map(Pe,!0):null,Ie=(ye<<5)+(oe+1)+this.points.length,et=0,Ke=ae;et<Ke.length;et+=1){var tt=Qe.points[Ke[et]];if(!(tt.zoom<=oe)){tt.zoom=oe;var Ft=tt.numPoints||1;fe+=tt.x*Ft,Ee+=tt.y*Ft,tt.parentId=Ie,Se&&(we||(we=this._map(Pe,!0)),Se(we,this._map(tt)))}}Pe.parentId=Ie,le.push(rr(fe/W,Ee/W,Ie,W,we))}else if(le.push(Pe),W>1)for(var At=0,Bt=ae;At<Bt.length;At+=1){var jt=Qe.points[Bt[At]];jt.zoom<=oe||(jt.zoom=oe,le.push(jt))}}}return le},xi.prototype._getOriginId=function(te){return te-this.points.length>>5},xi.prototype._getOriginZoom=function(te){return(te-this.points.length)%32},xi.prototype._map=function(te,oe){if(te.numPoints)return oe?yi({},te.properties):te.properties;var le=this.points[te.index].properties,ge=this.options.map(le);return oe&&ge===le?yi({},ge):ge},Xn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Xn.prototype.splitTile=function(te,oe,le,ge,Se,Oe,Ne){for(var ye=[te,oe,le,ge],Pe=this.options,Qe=Pe.debug;ye.length;){ge=ye.pop(),le=ye.pop(),oe=ye.pop(),te=ye.pop();var ae=1<<oe,H=Ni(oe,le,ge),W=this.tiles[H];if(!W&&(Qe>1&&console.time("creation"),W=this.tiles[H]=nr(te,oe,le,ge,Pe),this.tileCoords.push({z:oe,x:le,y:ge}),Qe)){Qe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",oe,le,ge,W.numFeatures,W.numPoints,W.numSimplified),console.timeEnd("creation"));var ne="z"+oe;this.stats[ne]=(this.stats[ne]||0)+1,this.total++}if(W.source=te,Se){if(oe===Pe.maxZoom||oe===Se)continue;var ce=1<<Se-oe;if(le!==Math.floor(Oe/ce)||ge!==Math.floor(Ne/ce))continue}else if(oe===Pe.indexMaxZoom||W.numPoints<=Pe.indexMaxPoints)continue;if(W.source=null,te.length!==0){Qe>1&&console.time("clipping");var _e,fe,Ee,we,Ie,et,Ke=.5*Pe.buffer/Pe.extent,tt=.5-Ke,Ft=.5+Ke,At=1+Ke;_e=fe=Ee=we=null,Ie=Zn(te,ae,le-Ke,le+Ft,0,W.minX,W.maxX,Pe),et=Zn(te,ae,le+tt,le+At,0,W.minX,W.maxX,Pe),te=null,Ie&&(_e=Zn(Ie,ae,ge-Ke,ge+Ft,1,W.minY,W.maxY,Pe),fe=Zn(Ie,ae,ge+tt,ge+At,1,W.minY,W.maxY,Pe),Ie=null),et&&(Ee=Zn(et,ae,ge-Ke,ge+Ft,1,W.minY,W.maxY,Pe),we=Zn(et,ae,ge+tt,ge+At,1,W.minY,W.maxY,Pe),et=null),Qe>1&&console.timeEnd("clipping"),ye.push(_e||[],oe+1,2*le,2*ge),ye.push(fe||[],oe+1,2*le,2*ge+1),ye.push(Ee||[],oe+1,2*le+1,2*ge),ye.push(we||[],oe+1,2*le+1,2*ge+1)}}},Xn.prototype.getTile=function(te,oe,le){var ge=this.options,Se=ge.extent,Oe=ge.debug;if(te<0||te>24)return null;var Ne=1<<te,ye=Ni(te,oe=(oe%Ne+Ne)%Ne,le);if(this.tiles[ye])return Gr(this.tiles[ye],Se);Oe>1&&console.log("drilling down to z%d-%d-%d",te,oe,le);for(var Pe,Qe=te,ae=oe,H=le;!Pe&&Qe>0;)Qe--,ae=Math.floor(ae/2),H=Math.floor(H/2),Pe=this.tiles[Ni(Qe,ae,H)];return Pe&&Pe.source?(Oe>1&&console.log("found parent tile z%d-%d-%d",Qe,ae,H),Oe>1&&console.time("drilling down"),this.splitTile(Pe.source,Qe,ae,H,te,oe,le),Oe>1&&console.timeEnd("drilling down"),this.tiles[ye]?Gr(this.tiles[ye],Se):null):null};var Lo=function(te){function oe(le,ge,Se,Oe){te.call(this,le,ge,Se,fa),Oe&&(this.loadGeoJSON=Oe)}return te&&(oe.__proto__=te),(oe.prototype=Object.create(te&&te.prototype)).constructor=oe,oe.prototype.loadData=function(le,ge){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=ge,this._pendingLoadDataParams=le,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},oe.prototype._loadData=function(){var le=this;if(this._pendingCallback&&this._pendingLoadDataParams){var ge=this._pendingCallback,Se=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Oe=!!(Se&&Se.request&&Se.request.collectResourceTiming)&&new f.RequestPerformance(Se.request);this.loadGeoJSON(Se,function(Ne,ye){if(Ne||!ye)return ge(Ne);if(typeof ye!="object")return ge(new Error("Input data given to '"+Se.source+"' is not a valid GeoJSON object."));(function W(ne,ce){var _e,fe=ne&&ne.type;if(fe==="FeatureCollection")for(_e=0;_e<ne.features.length;_e++)W(ne.features[_e],ce);else if(fe==="GeometryCollection")for(_e=0;_e<ne.geometries.length;_e++)W(ne.geometries[_e],ce);else if(fe==="Feature")W(ne.geometry,ce);else if(fe==="Polygon")ft(ne.coordinates,ce);else if(fe==="MultiPolygon")for(_e=0;_e<ne.coordinates.length;_e++)ft(ne.coordinates[_e],ce);return ne})(ye,!0);try{if(Se.filter){var Pe=f.createExpression(Se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Pe.result==="error")throw new Error(Pe.value.map(function(W){return W.key+": "+W.message}).join(", "));var Qe=ye.features.filter(function(W){return Pe.value.evaluate({zoom:0},W)});ye={type:"FeatureCollection",features:Qe}}le._geoJSONIndex=Se.cluster?new xi(function(W){var ne=W.superclusterOptions,ce=W.clusterProperties;if(!ce||!ne)return ne;for(var _e={},fe={},Ee={accumulated:null,zoom:0},we={properties:null},Ie=Object.keys(ce),et=0,Ke=Ie;et<Ke.length;et+=1){var tt=Ke[et],Ft=ce[tt],At=Ft[0],Bt=f.createExpression(Ft[1]),jt=f.createExpression(typeof At=="string"?[At,["accumulated"],["get",tt]]:At);_e[tt]=Bt.value,fe[tt]=jt.value}return ne.map=function(Hi){we.properties=Hi;for(var mi={},Ii=0,li=Ie;Ii<li.length;Ii+=1){var Kt=li[Ii];mi[Kt]=_e[Kt].evaluate(Ee,we)}return mi},ne.reduce=function(Hi,mi){we.properties=mi;for(var Ii=0,li=Ie;Ii<li.length;Ii+=1){var Kt=li[Ii];Ee.accumulated=Hi[Kt],Hi[Kt]=fe[Kt].evaluate(Ee,we)}},ne}(Se)).load(ye.features):function(W,ne){return new Xn(W,ne)}(ye,Se.geojsonVtOptions)}catch(W){return ge(W)}le.loaded={};var ae={};if(Oe){var H=Oe.finish();H&&(ae.resourceTiming={},ae.resourceTiming[Se.source]=JSON.parse(JSON.stringify(H)))}ge(null,ae)})}},oe.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},oe.prototype.reloadTile=function(le,ge){var Se=this.loaded;return Se&&Se[le.uid]?te.prototype.reloadTile.call(this,le,ge):this.loadTile(le,ge)},oe.prototype.loadGeoJSON=function(le,ge){if(le.request)f.getJSON(le.request,ge);else{if(typeof le.data!="string")return ge(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."));try{return ge(null,JSON.parse(le.data))}catch{return ge(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."))}}},oe.prototype.removeSource=function(le,ge){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ge()},oe.prototype.getClusterExpansionZoom=function(le,ge){try{ge(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(Se){ge(Se)}},oe.prototype.getClusterChildren=function(le,ge){try{ge(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(Se){ge(Se)}},oe.prototype.getClusterLeaves=function(le,ge){try{ge(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(Se){ge(Se)}},oe}(ke),Nr=function(te){var oe=this;this.self=te,this.actor=new f.Actor(te,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ke,geojson:Lo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(le,ge){if(oe.workerSourceTypes[le])throw new Error('Worker source with name "'+le+'" already registered.');oe.workerSourceTypes[le]=ge},this.self.registerRTLTextPlugin=function(le){if(f.plugin.isParsed())throw new Error("RTL text plugin already registered.");f.plugin.applyArabicShaping=le.applyArabicShaping,f.plugin.processBidirectionalText=le.processBidirectionalText,f.plugin.processStyledBidirectionalText=le.processStyledBidirectionalText}};return Nr.prototype.setReferrer=function(te,oe){this.referrer=oe},Nr.prototype.setImages=function(te,oe,le){for(var ge in this.availableImages[te]=oe,this.workerSources[te]){var Se=this.workerSources[te][ge];for(var Oe in Se)Se[Oe].availableImages=oe}le()},Nr.prototype.setLayers=function(te,oe,le){this.getLayerIndex(te).replace(oe),le()},Nr.prototype.updateLayers=function(te,oe,le){this.getLayerIndex(te).update(oe.layers,oe.removedIds),le()},Nr.prototype.loadTile=function(te,oe,le){this.getWorkerSource(te,oe.type,oe.source).loadTile(oe,le)},Nr.prototype.loadDEMTile=function(te,oe,le){this.getDEMWorkerSource(te,oe.source).loadTile(oe,le)},Nr.prototype.reloadTile=function(te,oe,le){this.getWorkerSource(te,oe.type,oe.source).reloadTile(oe,le)},Nr.prototype.abortTile=function(te,oe,le){this.getWorkerSource(te,oe.type,oe.source).abortTile(oe,le)},Nr.prototype.removeTile=function(te,oe,le){this.getWorkerSource(te,oe.type,oe.source).removeTile(oe,le)},Nr.prototype.removeDEMTile=function(te,oe){this.getDEMWorkerSource(te,oe.source).removeTile(oe)},Nr.prototype.removeSource=function(te,oe,le){if(this.workerSources[te]&&this.workerSources[te][oe.type]&&this.workerSources[te][oe.type][oe.source]){var ge=this.workerSources[te][oe.type][oe.source];delete this.workerSources[te][oe.type][oe.source],ge.removeSource!==void 0?ge.removeSource(oe,le):le()}},Nr.prototype.loadWorkerSource=function(te,oe,le){try{this.self.importScripts(oe.url),le()}catch(ge){le(ge.toString())}},Nr.prototype.syncRTLPluginState=function(te,oe,le){try{f.plugin.setState(oe);var ge=f.plugin.getPluginURL();if(f.plugin.isLoaded()&&!f.plugin.isParsed()&&ge!=null){this.self.importScripts(ge);var Se=f.plugin.isParsed();le(Se?void 0:new Error("RTL Text Plugin failed to import scripts from "+ge),Se)}}catch(Oe){le(Oe.toString())}},Nr.prototype.getAvailableImages=function(te){var oe=this.availableImages[te];return oe||(oe=[]),oe},Nr.prototype.getLayerIndex=function(te){var oe=this.layerIndexes[te];return oe||(oe=this.layerIndexes[te]=new q),oe},Nr.prototype.getWorkerSource=function(te,oe,le){var ge=this;return this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][oe]||(this.workerSources[te][oe]={}),this.workerSources[te][oe][le]||(this.workerSources[te][oe][le]=new this.workerSourceTypes[oe]({send:function(Se,Oe,Ne){ge.actor.send(Se,Oe,Ne,te)}},this.getLayerIndex(te),this.getAvailableImages(te))),this.workerSources[te][oe][le]},Nr.prototype.getDEMWorkerSource=function(te,oe){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][oe]||(this.demWorkerSources[te][oe]=new We),this.demWorkerSources[te][oe]},Nr.prototype.enforceCacheSizeLimit=function(te,oe){f.enforceCacheSizeLimit(oe)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Nr(self)),Nr}),P(["./shared"],function(f){var d=f.createCommonjsModule(function(u){function m(k){return!p(k)}function p(k){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var B,j,Y=new Blob([""],{type:"text/javascript"}),ie=URL.createObjectURL(Y);try{j=new Worker(ie),B=!0}catch{B=!1}return j&&j.terminate(),URL.revokeObjectURL(ie),B}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var B=document.createElement("canvas");B.width=B.height=1;var j=B.getContext("2d");if(!j)return!1;var Y=j.getImageData(0,0,1,1);return Y&&Y.width===B.width}()?(v[L=k&&k.failIfMajorPerformanceCaveat]===void 0&&(v[L]=function(B){var j=function(ie){var he=document.createElement("canvas"),de=Object.create(m.webGLContextAttributes);return de.failIfMajorPerformanceCaveat=ie,he.probablySupportsContext?he.probablySupportsContext("webgl",de)||he.probablySupportsContext("experimental-webgl",de):he.supportsContext?he.supportsContext("webgl",de)||he.supportsContext("experimental-webgl",de):he.getContext("webgl",de)||he.getContext("experimental-webgl",de)}(B);if(!j)return!1;var Y=j.createShader(j.VERTEX_SHADER);return!(!Y||j.isContextLost())&&(j.shaderSource(Y,"void main() {}"),j.compileShader(Y),j.getShaderParameter(Y,j.COMPILE_STATUS)===!0)}(L)),v[L]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var L}u.exports?u.exports=m:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=m,window.mapboxgl.notSupportedReason=p);var v={};m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),R={create:function(u,m,p){var v=f.window.document.createElement(u);return m!==void 0&&(v.className=m),p&&p.appendChild(v),v},createNS:function(u,m){return f.window.document.createElementNS(u,m)}},q=f.window.document&&f.window.document.documentElement.style;function V(u){if(!q)return u[0];for(var m=0;m<u.length;m++)if(u[m]in q)return u[m];return u[0]}var G,X=V(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);R.disableDrag=function(){q&&X&&(G=q[X],q[X]="none")},R.enableDrag=function(){q&&X&&(q[X]=G)};var Me=V(["transform","WebkitTransform"]);R.setTransform=function(u,m){u.style[Me]=m};var ke=!1;try{var qe=Object.defineProperty({},"passive",{get:function(){ke=!0}});f.window.addEventListener("test",qe,qe),f.window.removeEventListener("test",qe,qe)}catch{ke=!1}R.addEventListener=function(u,m,p,v){v===void 0&&(v={}),u.addEventListener(m,p,"passive"in v&&ke?v:v.capture)},R.removeEventListener=function(u,m,p,v){v===void 0&&(v={}),u.removeEventListener(m,p,"passive"in v&&ke?v:v.capture)};var We=function(u){u.preventDefault(),u.stopPropagation(),f.window.removeEventListener("click",We,!0)};function ft(u){var m=u.userImage;return!!(m&&m.render&&m.render())&&(u.data.replace(new Uint8Array(m.data.buffer)),!0)}R.suppressClick=function(){f.window.addEventListener("click",We,!0),f.window.setTimeout(function(){f.window.removeEventListener("click",We,!0)},0)},R.mousePos=function(u,m){var p=u.getBoundingClientRect();return new f.Point(m.clientX-p.left-u.clientLeft,m.clientY-p.top-u.clientTop)},R.touchPos=function(u,m){for(var p=u.getBoundingClientRect(),v=[],k=0;k<m.length;k++)v.push(new f.Point(m[k].clientX-p.left-u.clientLeft,m[k].clientY-p.top-u.clientTop));return v},R.mouseButton=function(u){return f.window.InstallTrigger!==void 0&&u.button===2&&u.ctrlKey&&f.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:u.button},R.remove=function(u){u.parentNode&&u.parentNode.removeChild(u)};var Ge=function(u){function m(){u.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new f.RGBAImage({width:1,height:1}),this.dirty=!0}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.isLoaded=function(){return this.loaded},m.prototype.setLoaded=function(p){if(this.loaded!==p&&(this.loaded=p,p)){for(var v=0,k=this.requestors;v<k.length;v+=1){var L=k[v];this._notify(L.ids,L.callback)}this.requestors=[]}},m.prototype.getImage=function(p){return this.images[p]},m.prototype.addImage=function(p,v){this._validate(p,v)&&(this.images[p]=v)},m.prototype._validate=function(p,v){var k=!0;return this._validateStretch(v.stretchX,v.data&&v.data.width)||(this.fire(new f.ErrorEvent(new Error('Image "'+p+'" has invalid "stretchX" value'))),k=!1),this._validateStretch(v.stretchY,v.data&&v.data.height)||(this.fire(new f.ErrorEvent(new Error('Image "'+p+'" has invalid "stretchY" value'))),k=!1),this._validateContent(v.content,v)||(this.fire(new f.ErrorEvent(new Error('Image "'+p+'" has invalid "content" value'))),k=!1),k},m.prototype._validateStretch=function(p,v){if(!p)return!0;for(var k=0,L=0,B=p;L<B.length;L+=1){var j=B[L];if(j[0]<k||j[1]<j[0]||v<j[1])return!1;k=j[1]}return!0},m.prototype._validateContent=function(p,v){return!(p&&(p.length!==4||p[0]<0||v.data.width<p[0]||p[1]<0||v.data.height<p[1]||p[2]<0||v.data.width<p[2]||p[3]<0||v.data.height<p[3]||p[2]<p[0]||p[3]<p[1]))},m.prototype.updateImage=function(p,v){v.version=this.images[p].version+1,this.images[p]=v,this.updatedImages[p]=!0},m.prototype.removeImage=function(p){var v=this.images[p];delete this.images[p],delete this.patterns[p],v.userImage&&v.userImage.onRemove&&v.userImage.onRemove()},m.prototype.listImages=function(){return Object.keys(this.images)},m.prototype.getImages=function(p,v){var k=!0;if(!this.isLoaded())for(var L=0,B=p;L<B.length;L+=1)this.images[B[L]]||(k=!1);this.isLoaded()||k?this._notify(p,v):this.requestors.push({ids:p,callback:v})},m.prototype._notify=function(p,v){for(var k={},L=0,B=p;L<B.length;L+=1){var j=B[L];this.images[j]||this.fire(new f.Event("styleimagemissing",{id:j}));var Y=this.images[j];Y?k[j]={data:Y.data.clone(),pixelRatio:Y.pixelRatio,sdf:Y.sdf,version:Y.version,stretchX:Y.stretchX,stretchY:Y.stretchY,content:Y.content,hasRenderCallback:Boolean(Y.userImage&&Y.userImage.render)}:f.warnOnce('Image "'+j+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}v(null,k)},m.prototype.getPixelSize=function(){var p=this.atlasImage;return{width:p.width,height:p.height}},m.prototype.getPattern=function(p){var v=this.patterns[p],k=this.getImage(p);if(!k)return null;if(v&&v.position.version===k.version)return v.position;if(v)v.position.version=k.version;else{var L={w:k.data.width+2,h:k.data.height+2,x:0,y:0},B=new f.ImagePosition(L,k);this.patterns[p]={bin:L,position:B}}return this._updatePatternAtlas(),this.patterns[p].position},m.prototype.bind=function(p){var v=p.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new f.Texture(p,this.atlasImage,v.RGBA),this.atlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE)},m.prototype._updatePatternAtlas=function(){var p=[];for(var v in this.patterns)p.push(this.patterns[v].bin);var k=f.potpack(p),L=k.w,B=k.h,j=this.atlasImage;for(var Y in j.resize({width:L||1,height:B||1}),this.patterns){var ie=this.patterns[Y].bin,he=ie.x+1,de=ie.y+1,me=this.images[Y].data,Ce=me.width,Te=me.height;f.RGBAImage.copy(me,j,{x:0,y:0},{x:he,y:de},{width:Ce,height:Te}),f.RGBAImage.copy(me,j,{x:0,y:Te-1},{x:he,y:de-1},{width:Ce,height:1}),f.RGBAImage.copy(me,j,{x:0,y:0},{x:he,y:de+Te},{width:Ce,height:1}),f.RGBAImage.copy(me,j,{x:Ce-1,y:0},{x:he-1,y:de},{width:1,height:Te}),f.RGBAImage.copy(me,j,{x:0,y:0},{x:he+Ce,y:de},{width:1,height:Te})}this.dirty=!0},m.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},m.prototype.dispatchRenderCallbacks=function(p){for(var v=0,k=p;v<k.length;v+=1){var L=k[v];if(!this.callbackDispatchedThisFrame[L]){this.callbackDispatchedThisFrame[L]=!0;var B=this.images[L];ft(B)&&this.updateImage(L,B)}}},m}(f.Evented),Ze=pt,gt=pt,ct=1e20;function pt(u,m,p,v,k,L){this.fontSize=u||24,this.buffer=m===void 0?3:m,this.cutoff=v||.25,this.fontFamily=k||"sans-serif",this.fontWeight=L||"normal",this.radius=p||8;var B=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=B,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(B*B),this.gridInner=new Float64Array(B*B),this.f=new Float64Array(B),this.d=new Float64Array(B),this.z=new Float64Array(B+1),this.v=new Int16Array(B),this.middle=Math.round(B/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function lt(u,m,p,v,k,L,B){for(var j=0;j<m;j++){for(var Y=0;Y<p;Y++)v[Y]=u[Y*m+j];for(pi(v,k,L,B,p),Y=0;Y<p;Y++)u[Y*m+j]=k[Y]}for(Y=0;Y<p;Y++){for(j=0;j<m;j++)v[j]=u[Y*m+j];for(pi(v,k,L,B,m),j=0;j<m;j++)u[Y*m+j]=Math.sqrt(k[j])}}function pi(u,m,p,v,k){p[0]=0,v[0]=-ct,v[1]=+ct;for(var L=1,B=0;L<k;L++){for(var j=(u[L]+L*L-(u[p[B]]+p[B]*p[B]))/(2*L-2*p[B]);j<=v[B];)B--,j=(u[L]+L*L-(u[p[B]]+p[B]*p[B]))/(2*L-2*p[B]);p[++B]=L,v[B]=j,v[B+1]=+ct}for(L=0,B=0;L<k;L++){for(;v[B+1]<L;)B++;m[L]=(L-p[B])*(L-p[B])+u[p[B]]}}pt.prototype.draw=function(u){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(u,this.buffer,this.middle);for(var m=this.ctx.getImageData(0,0,this.size,this.size),p=new Uint8ClampedArray(this.size*this.size),v=0;v<this.size*this.size;v++){var k=m.data[4*v+3]/255;this.gridOuter[v]=k===1?0:k===0?ct:Math.pow(Math.max(0,.5-k),2),this.gridInner[v]=k===1?ct:k===0?0:Math.pow(Math.max(0,k-.5),2)}for(lt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),lt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),v=0;v<this.size*this.size;v++)p[v]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[v]-this.gridInner[v])/this.radius+this.cutoff))));return p},Ze.default=gt;var Et=function(u,m){this.requestManager=u,this.localIdeographFontFamily=m,this.entries={}};Et.prototype.setURL=function(u){this.url=u},Et.prototype.getGlyphs=function(u,m){var p=this,v=[];for(var k in u)for(var L=0,B=u[k];L<B.length;L+=1)v.push({stack:k,id:B[L]});f.asyncAll(v,function(j,Y){var ie=j.stack,he=j.id,de=p.entries[ie];de||(de=p.entries[ie]={glyphs:{},requests:{},ranges:{}});var me=de.glyphs[he];if(me===void 0){if(me=p._tinySDF(de,ie,he))return de.glyphs[he]=me,void Y(null,{stack:ie,id:he,glyph:me});var Ce=Math.floor(he/256);if(256*Ce>65535)Y(new Error("glyphs > 65535 not supported"));else if(de.ranges[Ce])Y(null,{stack:ie,id:he,glyph:me});else{var Te=de.requests[Ce];Te||(Te=de.requests[Ce]=[],Et.loadGlyphRange(ie,Ce,p.url,p.requestManager,function(Le,xe){if(xe){for(var ze in xe)p._doesCharSupportLocalGlyph(+ze)||(de.glyphs[+ze]=xe[+ze]);de.ranges[Ce]=!0}for(var Fe=0,Ye=Te;Fe<Ye.length;Fe+=1)(0,Ye[Fe])(Le,xe);delete de.requests[Ce]})),Te.push(function(Le,xe){Le?Y(Le):xe&&Y(null,{stack:ie,id:he,glyph:xe[he]||null})})}}else Y(null,{stack:ie,id:he,glyph:me})},function(j,Y){if(j)m(j);else if(Y){for(var ie={},he=0,de=Y;he<de.length;he+=1){var me=de[he],Ce=me.stack,Te=me.id,Le=me.glyph;(ie[Ce]||(ie[Ce]={}))[Te]=Le&&{id:Le.id,bitmap:Le.bitmap.clone(),metrics:Le.metrics}}m(null,ie)}})},Et.prototype._doesCharSupportLocalGlyph=function(u){return!!this.localIdeographFontFamily&&(f.isChar["CJK Unified Ideographs"](u)||f.isChar["Hangul Syllables"](u)||f.isChar.Hiragana(u)||f.isChar.Katakana(u))},Et.prototype._tinySDF=function(u,m,p){var v=this.localIdeographFontFamily;if(v&&this._doesCharSupportLocalGlyph(p)){var k=u.tinySDF;if(!k){var L="400";/bold/i.test(m)?L="900":/medium/i.test(m)?L="500":/light/i.test(m)&&(L="200"),k=u.tinySDF=new Et.TinySDF(24,3,8,.25,v,L)}return{id:p,bitmap:new f.AlphaImage({width:30,height:30},k.draw(String.fromCharCode(p))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Et.loadGlyphRange=function(u,m,p,v,k){var L=256*m,B=L+255,j=v.transformRequest(v.normalizeGlyphsURL(p).replace("{fontstack}",u).replace("{range}",L+"-"+B),f.ResourceType.Glyphs);f.getArrayBuffer(j,function(Y,ie){if(Y)k(Y);else if(ie){for(var he={},de=0,me=f.parseGlyphPBF(ie);de<me.length;de+=1){var Ce=me[de];he[Ce.id]=Ce}k(null,he)}})},Et.TinySDF=Ze;var Wt=function(){this.specification=f.styleSpec.light.position};Wt.prototype.possiblyEvaluate=function(u,m){return f.sphericalToCartesian(u.expression.evaluate(m))},Wt.prototype.interpolate=function(u,m,p){return{x:f.number(u.x,m.x,p),y:f.number(u.y,m.y,p),z:f.number(u.z,m.z,p)}};var vi=new f.Properties({anchor:new f.DataConstantProperty(f.styleSpec.light.anchor),position:new Wt,color:new f.DataConstantProperty(f.styleSpec.light.color),intensity:new f.DataConstantProperty(f.styleSpec.light.intensity)}),qi=function(u){function m(p){u.call(this),this._transitionable=new f.Transitionable(vi),this.setLight(p),this._transitioning=this._transitionable.untransitioned()}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getLight=function(){return this._transitionable.serialize()},m.prototype.setLight=function(p,v){if(v===void 0&&(v={}),!this._validate(f.validateLight,p,v))for(var k in p){var L=p[k];f.endsWith(k,"-transition")?this._transitionable.setTransition(k.slice(0,-11),L):this._transitionable.setValue(k,L)}},m.prototype.updateTransitions=function(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)},m.prototype.hasTransition=function(){return this._transitioning.hasTransition()},m.prototype.recalculate=function(p){this.properties=this._transitioning.possiblyEvaluate(p)},m.prototype._validate=function(p,v,k){return(!k||k.validate!==!1)&&f.emitValidationErrors(this,p.call(f.validateStyle,f.extend({value:v,style:{glyphs:!0,sprite:!0},styleSpec:f.styleSpec})))},m}(f.Evented),Xt=function(u,m){this.width=u,this.height=m,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Xt.prototype.getDash=function(u,m){var p=u.join(",")+String(m);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(u,m)),this.dashEntry[p]},Xt.prototype.getDashRanges=function(u,m,p){var v=[],k=u.length%2==1?-u[u.length-1]*p:0,L=u[0]*p,B=!0;v.push({left:k,right:L,isDash:B,zeroLength:u[0]===0});for(var j=u[0],Y=1;Y<u.length;Y++){var ie=u[Y];v.push({left:k=j*p,right:L=(j+=ie)*p,isDash:B=!B,zeroLength:ie===0})}return v},Xt.prototype.addRoundDash=function(u,m,p){for(var v=m/2,k=-p;k<=p;k++)for(var L=this.width*(this.nextRow+p+k),B=0,j=u[B],Y=0;Y<this.width;Y++){Y/j.right>1&&(j=u[++B]);var ie=Math.abs(Y-j.left),he=Math.abs(Y-j.right),de=Math.min(ie,he),me=void 0,Ce=k/p*(v+1);if(j.isDash){var Te=v-Math.abs(Ce);me=Math.sqrt(de*de+Te*Te)}else me=v-Math.sqrt(de*de+Ce*Ce);this.data[L+Y]=Math.max(0,Math.min(255,me+128))}},Xt.prototype.addRegularDash=function(u){for(var m=u.length-1;m>=0;--m){var p=u[m],v=u[m+1];p.zeroLength?u.splice(m,1):v&&v.isDash===p.isDash&&(v.left=p.left,u.splice(m,1))}var k=u[0],L=u[u.length-1];k.isDash===L.isDash&&(k.left=L.left-this.width,L.right=k.right+this.width);for(var B=this.width*this.nextRow,j=0,Y=u[j],ie=0;ie<this.width;ie++){ie/Y.right>1&&(Y=u[++j]);var he=Math.abs(ie-Y.left),de=Math.abs(ie-Y.right),me=Math.min(he,de);this.data[B+ie]=Math.max(0,Math.min(255,(Y.isDash?me:-me)+128))}},Xt.prototype.addDash=function(u,m){var p=m?7:0,v=2*p+1;if(this.nextRow+v>this.height)return f.warnOnce("LineAtlas out of space"),null;for(var k=0,L=0;L<u.length;L++)k+=u[L];if(k!==0){var B=this.width/k,j=this.getDashRanges(u,this.width,B);m?this.addRoundDash(j,B,p):this.addRegularDash(j)}var Y={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:k};return this.nextRow+=v,this.dirty=!0,Y},Xt.prototype.bind=function(u){var m=u.gl;this.texture?(m.bindTexture(m.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,m.texSubImage2D(m.TEXTURE_2D,0,0,0,this.width,this.height,m.ALPHA,m.UNSIGNED_BYTE,this.data))):(this.texture=m.createTexture(),m.bindTexture(m.TEXTURE_2D,this.texture),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),m.texImage2D(m.TEXTURE_2D,0,m.ALPHA,this.width,this.height,0,m.ALPHA,m.UNSIGNED_BYTE,this.data))};var Qt=function u(m,p){this.workerPool=m,this.actors=[],this.currentActor=0,this.id=f.uniqueId();for(var v=this.workerPool.acquire(this.id),k=0;k<v.length;k++){var L=new u.Actor(v[k],p,this.id);L.name="Worker "+k,this.actors.push(L)}};function Ei(u,m,p){var v=function(k,L){if(k)return p(k);if(L){var B=f.pick(f.extend(L,u),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);L.vector_layers&&(B.vectorLayers=L.vector_layers,B.vectorLayerIds=B.vectorLayers.map(function(j){return j.id})),B.tiles=m.canonicalizeTileset(B,u.url),p(null,B)}};return u.url?f.getJSON(m.transformRequest(m.normalizeSourceURL(u.url),f.ResourceType.Source),v):f.browser.frame(function(){return v(null,u)})}Qt.prototype.broadcast=function(u,m,p){f.asyncAll(this.actors,function(v,k){v.send(u,m,k)},p=p||function(){})},Qt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Qt.prototype.remove=function(){this.actors.forEach(function(u){u.remove()}),this.actors=[],this.workerPool.release(this.id)},Qt.Actor=f.Actor;var bt=function(u,m,p){this.bounds=f.LngLatBounds.convert(this.validateBounds(u)),this.minzoom=m||0,this.maxzoom=p||24};bt.prototype.validateBounds=function(u){return Array.isArray(u)&&u.length===4?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]},bt.prototype.contains=function(u){var m=Math.pow(2,u.z),p=Math.floor(f.mercatorXfromLng(this.bounds.getWest())*m),v=Math.floor(f.mercatorYfromLat(this.bounds.getNorth())*m),k=Math.ceil(f.mercatorXfromLng(this.bounds.getEast())*m),L=Math.ceil(f.mercatorYfromLat(this.bounds.getSouth())*m);return u.x>=p&&u.x<k&&u.y>=v&&u.y<L};var Gi=function(u){function m(p,v,k,L){if(u.call(this),this.id=p,this.dispatcher=k,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,f.extend(this,f.pick(v,["url","scheme","tileSize","promoteId"])),this._options=f.extend({type:"vector"},v),this._collectResourceTiming=v.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(L)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.load=function(){var p=this;this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ei(this._options,this.map._requestManager,function(v,k){p._tileJSONRequest=null,p._loaded=!0,v?p.fire(new f.ErrorEvent(v)):k&&(f.extend(p,k),k.bounds&&(p.tileBounds=new bt(k.bounds,p.minzoom,p.maxzoom)),f.postTurnstileEvent(k.tiles,p.map._requestManager._customAccessToken),f.postMapLoadEvent(k.tiles,p.map._getMapId(),p.map._requestManager._skuToken,p.map._requestManager._customAccessToken),p.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),p.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"})))})},m.prototype.loaded=function(){return this._loaded},m.prototype.hasTile=function(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)},m.prototype.onAdd=function(p){this.map=p,this.load()},m.prototype.setSourceProperty=function(p){this._tileJSONRequest&&this._tileJSONRequest.cancel(),p(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},m.prototype.setTiles=function(p){var v=this;return this.setSourceProperty(function(){v._options.tiles=p}),this},m.prototype.setUrl=function(p){var v=this;return this.setSourceProperty(function(){v.url=p,v._options.url=p}),this},m.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},m.prototype.serialize=function(){return f.extend({},this._options)},m.prototype.loadTile=function(p,v){var k=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),L={request:this.map._requestManager.transformRequest(k,f.ResourceType.Tile),uid:p.uid,tileID:p.tileID,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:f.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function B(j,Y){return delete p.request,p.aborted?v(null):j&&j.status!==404?v(j):(Y&&Y.resourceTiming&&(p.resourceTiming=Y.resourceTiming),this.map._refreshExpiredTiles&&Y&&p.setExpiryData(Y),p.loadVectorData(Y,this.map.painter),f.cacheEntryPossiblyAdded(this.dispatcher),v(null),void(p.reloadCallback&&(this.loadTile(p,p.reloadCallback),p.reloadCallback=null)))}L.request.collectResourceTiming=this._collectResourceTiming,p.actor&&p.state!=="expired"?p.state==="loading"?p.reloadCallback=v:p.request=p.actor.send("reloadTile",L,B.bind(this)):(p.actor=this.dispatcher.getActor(),p.request=p.actor.send("loadTile",L,B.bind(this)))},m.prototype.abortTile=function(p){p.request&&(p.request.cancel(),delete p.request),p.actor&&p.actor.send("abortTile",{uid:p.uid,type:this.type,source:this.id},void 0)},m.prototype.unloadTile=function(p){p.unloadVectorData(),p.actor&&p.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id},void 0)},m.prototype.hasTransition=function(){return!1},m}(f.Evented),hr=function(u){function m(p,v,k,L){u.call(this),this.id=p,this.dispatcher=k,this.setEventedParent(L),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=f.extend({type:"raster"},v),f.extend(this,f.pick(v,["url","scheme","tileSize"]))}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.load=function(){var p=this;this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ei(this._options,this.map._requestManager,function(v,k){p._tileJSONRequest=null,p._loaded=!0,v?p.fire(new f.ErrorEvent(v)):k&&(f.extend(p,k),k.bounds&&(p.tileBounds=new bt(k.bounds,p.minzoom,p.maxzoom)),f.postTurnstileEvent(k.tiles),f.postMapLoadEvent(k.tiles,p.map._getMapId(),p.map._requestManager._skuToken),p.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),p.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"})))})},m.prototype.loaded=function(){return this._loaded},m.prototype.onAdd=function(p){this.map=p,this.load()},m.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},m.prototype.serialize=function(){return f.extend({},this._options)},m.prototype.hasTile=function(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)},m.prototype.loadTile=function(p,v){var k=this,L=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);p.request=f.getImage(this.map._requestManager.transformRequest(L,f.ResourceType.Tile),function(B,j){if(delete p.request,p.aborted)p.state="unloaded",v(null);else if(B)p.state="errored",v(B);else if(j){k.map._refreshExpiredTiles&&p.setExpiryData(j),delete j.cacheControl,delete j.expires;var Y=k.map.painter.context,ie=Y.gl;p.texture=k.map.painter.getTileTexture(j.width),p.texture?p.texture.update(j,{useMipmap:!0}):(p.texture=new f.Texture(Y,j,ie.RGBA,{useMipmap:!0}),p.texture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE,ie.LINEAR_MIPMAP_NEAREST),Y.extTextureFilterAnisotropic&&ie.texParameterf(ie.TEXTURE_2D,Y.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Y.extTextureFilterAnisotropicMax)),p.state="loaded",f.cacheEntryPossiblyAdded(k.dispatcher),v(null)}})},m.prototype.abortTile=function(p,v){p.request&&(p.request.cancel(),delete p.request),v()},m.prototype.unloadTile=function(p,v){p.texture&&this.map.painter.saveTileTexture(p.texture),v()},m.prototype.hasTransition=function(){return!1},m}(f.Evented),wr=function(u){function m(p,v,k,L){u.call(this,p,v,k,L),this.type="raster-dem",this.maxzoom=22,this._options=f.extend({type:"raster-dem"},v),this.encoding=v.encoding||"mapbox"}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},m.prototype.loadTile=function(p,v){var k=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function L(B,j){B&&(p.state="errored",v(B)),j&&(p.dem=j,p.needsHillshadePrepare=!0,p.state="loaded",v(null))}p.request=f.getImage(this.map._requestManager.transformRequest(k,f.ResourceType.Tile),function(B,j){if(delete p.request,p.aborted)p.state="unloaded",v(null);else if(B)p.state="errored",v(B);else if(j){this.map._refreshExpiredTiles&&p.setExpiryData(j),delete j.cacheControl,delete j.expires;var Y=f.window.ImageBitmap&&j instanceof f.window.ImageBitmap&&f.offscreenCanvasSupported()?j:f.browser.getImageData(j,1),ie={uid:p.uid,coord:p.tileID,source:this.id,rawImageData:Y,encoding:this.encoding};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadDEMTile",ie,L.bind(this)))}}.bind(this)),p.neighboringTiles=this._getNeighboringTiles(p.tileID)},m.prototype._getNeighboringTiles=function(p){var v=p.canonical,k=Math.pow(2,v.z),L=(v.x-1+k)%k,B=v.x===0?p.wrap-1:p.wrap,j=(v.x+1+k)%k,Y=v.x+1===k?p.wrap+1:p.wrap,ie={};return ie[new f.OverscaledTileID(p.overscaledZ,B,v.z,L,v.y).key]={backfilled:!1},ie[new f.OverscaledTileID(p.overscaledZ,Y,v.z,j,v.y).key]={backfilled:!1},v.y>0&&(ie[new f.OverscaledTileID(p.overscaledZ,B,v.z,L,v.y-1).key]={backfilled:!1},ie[new f.OverscaledTileID(p.overscaledZ,p.wrap,v.z,v.x,v.y-1).key]={backfilled:!1},ie[new f.OverscaledTileID(p.overscaledZ,Y,v.z,j,v.y-1).key]={backfilled:!1}),v.y+1<k&&(ie[new f.OverscaledTileID(p.overscaledZ,B,v.z,L,v.y+1).key]={backfilled:!1},ie[new f.OverscaledTileID(p.overscaledZ,p.wrap,v.z,v.x,v.y+1).key]={backfilled:!1},ie[new f.OverscaledTileID(p.overscaledZ,Y,v.z,j,v.y+1).key]={backfilled:!1}),ie},m.prototype.unloadTile=function(p){p.demTexture&&this.map.painter.saveTileTexture(p.demTexture),p.fbo&&(p.fbo.destroy(),delete p.fbo),p.dem&&delete p.dem,delete p.neighboringTiles,p.state="unloaded",p.actor&&p.actor.send("removeDEMTile",{uid:p.uid,source:this.id})},m}(hr),Dt=function(u){function m(p,v,k,L){u.call(this),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=k.getActor(),this.setEventedParent(L),this._data=v.data,this._options=f.extend({},v),this._collectResourceTiming=v.collectResourceTiming,this._resourceTiming=[],v.maxzoom!==void 0&&(this.maxzoom=v.maxzoom),v.type&&(this.type=v.type),v.attribution&&(this.attribution=v.attribution),this.promoteId=v.promoteId;var B=f.EXTENT/this.tileSize;this.workerOptions=f.extend({source:this.id,cluster:v.cluster||!1,geojsonVtOptions:{buffer:(v.buffer!==void 0?v.buffer:128)*B,tolerance:(v.tolerance!==void 0?v.tolerance:.375)*B,extent:f.EXTENT,maxZoom:this.maxzoom,lineMetrics:v.lineMetrics||!1,generateId:v.generateId||!1},superclusterOptions:{maxZoom:v.clusterMaxZoom!==void 0?Math.min(v.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,v.clusterMinPoints||2),extent:f.EXTENT,radius:(v.clusterRadius||50)*B,log:!1,generateId:v.generateId||!1},clusterProperties:v.clusterProperties,filter:v.filter},v.workerOptions)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.load=function(){var p=this;this.fire(new f.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(v){if(v)p.fire(new f.ErrorEvent(v));else{var k={dataType:"source",sourceDataType:"metadata"};p._collectResourceTiming&&p._resourceTiming&&p._resourceTiming.length>0&&(k.resourceTiming=p._resourceTiming,p._resourceTiming=[]),p.fire(new f.Event("data",k))}})},m.prototype.onAdd=function(p){this.map=p,this.load()},m.prototype.setData=function(p){var v=this;return this._data=p,this.fire(new f.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(k){if(k)v.fire(new f.ErrorEvent(k));else{var L={dataType:"source",sourceDataType:"content"};v._collectResourceTiming&&v._resourceTiming&&v._resourceTiming.length>0&&(L.resourceTiming=v._resourceTiming,v._resourceTiming=[]),v.fire(new f.Event("data",L))}}),this},m.prototype.getClusterExpansionZoom=function(p,v){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id},v),this},m.prototype.getClusterChildren=function(p,v){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id},v),this},m.prototype.getClusterLeaves=function(p,v,k,L){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:p,limit:v,offset:k},L),this},m.prototype._updateWorkerData=function(p){var v=this;this._loaded=!1;var k=f.extend({},this.workerOptions),L=this._data;typeof L=="string"?(k.request=this.map._requestManager.transformRequest(f.browser.resolveURL(L),f.ResourceType.Source),k.request.collectResourceTiming=this._collectResourceTiming):k.data=JSON.stringify(L),this.actor.send(this.type+".loadData",k,function(B,j){v._removed||j&&j.abandoned||(v._loaded=!0,j&&j.resourceTiming&&j.resourceTiming[v.id]&&(v._resourceTiming=j.resourceTiming[v.id].slice(0)),v.actor.send(v.type+".coalesce",{source:k.source},null),p(B))})},m.prototype.loaded=function(){return this._loaded},m.prototype.loadTile=function(p,v){var k=this,L=p.actor?"reloadTile":"loadTile";p.actor=this.actor,p.request=this.actor.send(L,{type:this.type,uid:p.uid,tileID:p.tileID,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:f.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(B,j){return delete p.request,p.unloadVectorData(),p.aborted?v(null):B?v(B):(p.loadVectorData(j,k.map.painter,L==="reloadTile"),v(null))})},m.prototype.abortTile=function(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0},m.prototype.unloadTile=function(p){p.unloadVectorData(),this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id})},m.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},m.prototype.serialize=function(){return f.extend({},this._options,{type:this.type,data:this._data})},m.prototype.hasTransition=function(){return!1},m}(f.Evented),oi=f.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),fi=function(u){function m(p,v,k,L){u.call(this),this.id=p,this.dispatcher=k,this.coordinates=v.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(L),this.options=v}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.load=function(p,v){var k=this;this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this.url=this.options.url,f.getImage(this.map._requestManager.transformRequest(this.url,f.ResourceType.Image),function(L,B){k._loaded=!0,L?k.fire(new f.ErrorEvent(L)):B&&(k.image=B,p&&(k.coordinates=p),v&&v(),k._finishLoading())})},m.prototype.loaded=function(){return this._loaded},m.prototype.updateImage=function(p){var v=this;return this.image&&p.url?(this.options.url=p.url,this.load(p.coordinates,function(){v.texture=null}),this):this},m.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})))},m.prototype.onAdd=function(p){this.map=p,this.load()},m.prototype.setCoordinates=function(p){var v=this;this.coordinates=p;var k=p.map(f.MercatorCoordinate.fromLngLat);this.tileID=function(B){for(var j=1/0,Y=1/0,ie=-1/0,he=-1/0,de=0,me=B;de<me.length;de+=1){var Ce=me[de];j=Math.min(j,Ce.x),Y=Math.min(Y,Ce.y),ie=Math.max(ie,Ce.x),he=Math.max(he,Ce.y)}var Te=Math.max(ie-j,he-Y),Le=Math.max(0,Math.floor(-Math.log(Te)/Math.LN2)),xe=Math.pow(2,Le);return new f.CanonicalTileID(Le,Math.floor((j+ie)/2*xe),Math.floor((Y+he)/2*xe))}(k),this.minzoom=this.maxzoom=this.tileID.z;var L=k.map(function(B){return v.tileID.getTilePoint(B)._round()});return this._boundsArray=new f.StructArrayLayout4i8,this._boundsArray.emplaceBack(L[0].x,L[0].y,0,0),this._boundsArray.emplaceBack(L[1].x,L[1].y,f.EXTENT,0),this._boundsArray.emplaceBack(L[3].x,L[3].y,0,f.EXTENT),this._boundsArray.emplaceBack(L[2].x,L[2].y,f.EXTENT,f.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"})),this},m.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var p=this.map.painter.context,v=p.gl;for(var k in this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,oi.members)),this.boundsSegments||(this.boundsSegments=f.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new f.Texture(p,this.image,v.RGBA),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE)),this.tiles){var L=this.tiles[k];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture)}}},m.prototype.loadTile=function(p,v){this.tileID&&this.tileID.equals(p.tileID.canonical)?(this.tiles[String(p.tileID.wrap)]=p,p.buckets={},v(null)):(p.state="errored",v(null))},m.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},m.prototype.hasTransition=function(){return!1},m}(f.Evented),Bi=function(u){function m(p,v,k,L){u.call(this,p,v,k,L),this.roundZoom=!0,this.type="video",this.options=v}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.load=function(){var p=this;this._loaded=!1;var v=this.options;this.urls=[];for(var k=0,L=v.urls;k<L.length;k+=1)this.urls.push(this.map._requestManager.transformRequest(L[k],f.ResourceType.Source).url);f.getVideo(this.urls,function(B,j){p._loaded=!0,B?p.fire(new f.ErrorEvent(B)):j&&(p.video=j,p.video.loop=!0,p.video.addEventListener("playing",function(){p.map.triggerRepaint()}),p.map&&p.video.play(),p._finishLoading())})},m.prototype.pause=function(){this.video&&this.video.pause()},m.prototype.play=function(){this.video&&this.video.play()},m.prototype.seek=function(p){if(this.video){var v=this.video.seekable;p<v.start(0)||p>v.end(0)?this.fire(new f.ErrorEvent(new f.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+v.start(0)+" and "+v.end(0)+"-second mark."))):this.video.currentTime=p}},m.prototype.getVideo=function(){return this.video},m.prototype.onAdd=function(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},m.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var p=this.map.painter.context,v=p.gl;for(var k in this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,oi.members)),this.boundsSegments||(this.boundsSegments=f.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE),v.texSubImage2D(v.TEXTURE_2D,0,0,0,v.RGBA,v.UNSIGNED_BYTE,this.video)):(this.texture=new f.Texture(p,this.video,v.RGBA),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE)),this.tiles){var L=this.tiles[k];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture)}}},m.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},m.prototype.hasTransition=function(){return this.video&&!this.video.paused},m}(fi),Nt=function(u){function m(p,v,k,L){u.call(this,p,v,k,L),v.coordinates?Array.isArray(v.coordinates)&&v.coordinates.length===4&&!v.coordinates.some(function(B){return!Array.isArray(B)||B.length!==2||B.some(function(j){return typeof j!="number"})})||this.fire(new f.ErrorEvent(new f.ValidationError("sources."+p,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new f.ErrorEvent(new f.ValidationError("sources."+p,null,'missing required property "coordinates"'))),v.animate&&typeof v.animate!="boolean"&&this.fire(new f.ErrorEvent(new f.ValidationError("sources."+p,null,'optional "animate" property must be a boolean value'))),v.canvas?typeof v.canvas=="string"||v.canvas instanceof f.window.HTMLCanvasElement||this.fire(new f.ErrorEvent(new f.ValidationError("sources."+p,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new f.ErrorEvent(new f.ValidationError("sources."+p,null,'missing required property "canvas"'))),this.options=v,this.animate=v.animate===void 0||v.animate}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof f.window.HTMLCanvasElement?this.options.canvas:f.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new f.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},m.prototype.getCanvas=function(){return this.canvas},m.prototype.onAdd=function(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()},m.prototype.onRemove=function(){this.pause()},m.prototype.prepare=function(){var p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var v=this.map.painter.context,k=v.gl;for(var L in this.boundsBuffer||(this.boundsBuffer=v.createVertexBuffer(this._boundsArray,oi.members)),this.boundsSegments||(this.boundsSegments=f.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(p||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new f.Texture(v,this.canvas,k.RGBA,{premultiply:!0}),this.tiles){var B=this.tiles[L];B.state!=="loaded"&&(B.state="loaded",B.texture=this.texture)}}},m.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},m.prototype.hasTransition=function(){return this._playing},m.prototype._hasInvalidDimensions=function(){for(var p=0,v=[this.canvas.width,this.canvas.height];p<v.length;p+=1){var k=v[p];if(isNaN(k)||k<=0)return!0}return!1},m}(fi),Xi={vector:Gi,raster:hr,"raster-dem":wr,geojson:Dt,video:Bi,image:fi,canvas:Nt};function Li(u,m){var p=f.identity([]);return f.translate(p,p,[1,1,0]),f.scale(p,p,[.5*u.width,.5*u.height,1]),f.multiply(p,p,u.calculatePosMatrix(m.toUnwrapped()))}function xi(u,m,p,v,k,L){var B=function(Le,xe,ze){if(Le)for(var Fe=0,Ye=Le;Fe<Ye.length;Fe+=1){var ot=xe[Ye[Fe]];if(ot&&ot.source===ze&&ot.type==="fill-extrusion")return!0}else for(var at in xe){var st=xe[at];if(st.source===ze&&st.type==="fill-extrusion")return!0}return!1}(k&&k.layers,m,u.id),j=L.maxPitchScaleFactor(),Y=u.tilesIn(v,j,B);Y.sort(rr);for(var ie=[],he=0,de=Y;he<de.length;he+=1){var me=de[he];ie.push({wrappedTileID:me.tileID.wrapped().key,queryResults:me.tile.queryRenderedFeatures(m,p,u._state,me.queryGeometry,me.cameraQueryGeometry,me.scale,k,L,j,Li(u.transform,me.tileID))})}var Ce=function(Le){for(var xe={},ze={},Fe=0,Ye=Le;Fe<Ye.length;Fe+=1){var ot=Ye[Fe],at=ot.queryResults,st=ot.wrappedTileID,It=ze[st]=ze[st]||{};for(var Lt in at)for(var Mt=at[Lt],Yt=It[Lt]=It[Lt]||{},di=xe[Lt]=xe[Lt]||[],_i=0,hi=Mt;_i<hi.length;_i+=1){var ar=hi[_i];Yt[ar.featureIndex]||(Yt[ar.featureIndex]=!0,di.push(ar))}}return xe}(ie);for(var Te in Ce)Ce[Te].forEach(function(Le){var xe=Le.feature,ze=u.getFeatureState(xe.layer["source-layer"],xe.id);xe.source=xe.layer.source,xe.layer["source-layer"]&&(xe.sourceLayer=xe.layer["source-layer"]),xe.state=ze});return Ce}function rr(u,m){var p=u.tileID,v=m.tileID;return p.overscaledZ-v.overscaledZ||p.canonical.y-v.canonical.y||p.wrap-v.wrap||p.canonical.x-v.canonical.x}var Ti=function(u,m){this.max=u,this.onRemove=m,this.reset()};Ti.prototype.reset=function(){for(var u in this.data)for(var m=0,p=this.data[u];m<p.length;m+=1){var v=p[m];v.timeout&&clearTimeout(v.timeout),this.onRemove(v.value)}return this.data={},this.order=[],this},Ti.prototype.add=function(u,m,p){var v=this,k=u.wrapped().key;this.data[k]===void 0&&(this.data[k]=[]);var L={value:m,timeout:void 0};if(p!==void 0&&(L.timeout=setTimeout(function(){v.remove(u,L)},p)),this.data[k].push(L),this.order.push(k),this.order.length>this.max){var B=this._getAndRemoveByKey(this.order[0]);B&&this.onRemove(B)}return this},Ti.prototype.has=function(u){return u.wrapped().key in this.data},Ti.prototype.getAndRemove=function(u){return this.has(u)?this._getAndRemoveByKey(u.wrapped().key):null},Ti.prototype._getAndRemoveByKey=function(u){var m=this.data[u].shift();return m.timeout&&clearTimeout(m.timeout),this.data[u].length===0&&delete this.data[u],this.order.splice(this.order.indexOf(u),1),m.value},Ti.prototype.getByKey=function(u){var m=this.data[u];return m?m[0].value:null},Ti.prototype.get=function(u){return this.has(u)?this.data[u.wrapped().key][0].value:null},Ti.prototype.remove=function(u,m){if(!this.has(u))return this;var p=u.wrapped().key,v=m===void 0?0:this.data[p].indexOf(m),k=this.data[p][v];return this.data[p].splice(v,1),k.timeout&&clearTimeout(k.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(k.value),this.order.splice(this.order.indexOf(p),1),this},Ti.prototype.setMaxSize=function(u){for(this.max=u;this.order.length>this.max;){var m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this},Ti.prototype.filter=function(u){var m=[];for(var p in this.data)for(var v=0,k=this.data[p];v<k.length;v+=1){var L=k[v];u(L.value)||m.push(L)}for(var B=0,j=m;B<j.length;B+=1){var Y=j[B];this.remove(Y.value.tileID,Y)}};var zt=function(u,m,p){this.context=u;var v=u.gl;this.buffer=v.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer};zt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},zt.prototype.updateData=function(u){var m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)},zt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var tr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Rt=function(u,m,p,v){this.length=m.length,this.attributes=p,this.itemSize=m.bytesPerElement,this.dynamicDraw=v,this.context=u;var k=u.gl;this.buffer=k.createBuffer(),u.bindVertexBuffer.set(this.buffer),k.bufferData(k.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?k.DYNAMIC_DRAW:k.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer};Rt.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Rt.prototype.updateData=function(u){var m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,u.arrayBuffer)},Rt.prototype.enableAttributes=function(u,m){for(var p=0;p<this.attributes.length;p++){var v=m.attributes[this.attributes[p].name];v!==void 0&&u.enableVertexAttribArray(v)}},Rt.prototype.setVertexAttribPointers=function(u,m,p){for(var v=0;v<this.attributes.length;v++){var k=this.attributes[v],L=m.attributes[k.name];L!==void 0&&u.vertexAttribPointer(L,k.components,u[tr[k.type]],!1,this.itemSize,k.offset+this.itemSize*(p||0))}},Rt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var rt=function(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};rt.prototype.get=function(){return this.current},rt.prototype.set=function(u){},rt.prototype.getDefault=function(){return this.default},rt.prototype.setDefault=function(){this.set(this.default)};var yi=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return f.Color.transparent},m.prototype.set=function(p){var v=this.current;(p.r!==v.r||p.g!==v.g||p.b!==v.b||p.a!==v.a||this.dirty)&&(this.gl.clearColor(p.r,p.g,p.b,p.a),this.current=p,this.dirty=!1)},m}(rt),ir=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return 1},m.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.clearDepth(p),this.current=p,this.dirty=!1)},m}(rt),Cr=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return 0},m.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.clearStencil(p),this.current=p,this.dirty=!1)},m}(rt),no=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return[!0,!0,!0,!0]},m.prototype.set=function(p){var v=this.current;(p[0]!==v[0]||p[1]!==v[1]||p[2]!==v[2]||p[3]!==v[3]||this.dirty)&&(this.gl.colorMask(p[0],p[1],p[2],p[3]),this.current=p,this.dirty=!1)},m}(rt),qn=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return!0},m.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.depthMask(p),this.current=p,this.dirty=!1)},m}(rt),Mo=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return 255},m.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.stencilMask(p),this.current=p,this.dirty=!1)},m}(rt),fn=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},m.prototype.set=function(p){var v=this.current;(p.func!==v.func||p.ref!==v.ref||p.mask!==v.mask||this.dirty)&&(this.gl.stencilFunc(p.func,p.ref,p.mask),this.current=p,this.dirty=!1)},m}(rt),oo=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){var p=this.gl;return[p.KEEP,p.KEEP,p.KEEP]},m.prototype.set=function(p){var v=this.current;(p[0]!==v[0]||p[1]!==v[1]||p[2]!==v[2]||this.dirty)&&(this.gl.stencilOp(p[0],p[1],p[2]),this.current=p,this.dirty=!1)},m}(rt),Gn=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(p){if(p!==this.current||this.dirty){var v=this.gl;p?v.enable(v.STENCIL_TEST):v.disable(v.STENCIL_TEST),this.current=p,this.dirty=!1}},m}(rt),Zi=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return[0,1]},m.prototype.set=function(p){var v=this.current;(p[0]!==v[0]||p[1]!==v[1]||this.dirty)&&(this.gl.depthRange(p[0],p[1]),this.current=p,this.dirty=!1)},m}(rt),Fn=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(p){if(p!==this.current||this.dirty){var v=this.gl;p?v.enable(v.DEPTH_TEST):v.disable(v.DEPTH_TEST),this.current=p,this.dirty=!1}},m}(rt),_o=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.LESS},m.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.depthFunc(p),this.current=p,this.dirty=!1)},m}(rt),Zn=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(p){if(p!==this.current||this.dirty){var v=this.gl;p?v.enable(v.BLEND):v.disable(v.BLEND),this.current=p,this.dirty=!1}},m}(rt),Ra=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){var p=this.gl;return[p.ONE,p.ZERO]},m.prototype.set=function(p){var v=this.current;(p[0]!==v[0]||p[1]!==v[1]||this.dirty)&&(this.gl.blendFunc(p[0],p[1]),this.current=p,this.dirty=!1)},m}(rt),Ue=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return f.Color.transparent},m.prototype.set=function(p){var v=this.current;(p.r!==v.r||p.g!==v.g||p.b!==v.b||p.a!==v.a||this.dirty)&&(this.gl.blendColor(p.r,p.g,p.b,p.a),this.current=p,this.dirty=!1)},m}(rt),_t=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.FUNC_ADD},m.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.blendEquation(p),this.current=p,this.dirty=!1)},m}(rt),bi=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(p){if(p!==this.current||this.dirty){var v=this.gl;p?v.enable(v.CULL_FACE):v.disable(v.CULL_FACE),this.current=p,this.dirty=!1}},m}(rt),pr=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.BACK},m.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.cullFace(p),this.current=p,this.dirty=!1)},m}(rt),mr=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.CCW},m.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.frontFace(p),this.current=p,this.dirty=!1)},m}(rt),Hn=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)},m}(rt),Wn=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.TEXTURE0},m.prototype.set=function(p){(p!==this.current||this.dirty)&&(this.gl.activeTexture(p),this.current=p,this.dirty=!1)},m}(rt),ea=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){var p=this.gl;return[0,0,p.drawingBufferWidth,p.drawingBufferHeight]},m.prototype.set=function(p){var v=this.current;(p[0]!==v[0]||p[1]!==v[1]||p[2]!==v[2]||p[3]!==v[3]||this.dirty)&&(this.gl.viewport(p[0],p[1],p[2],p[3]),this.current=p,this.dirty=!1)},m}(rt),Gr=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(p){if(p!==this.current||this.dirty){var v=this.gl;v.bindFramebuffer(v.FRAMEBUFFER,p),this.current=p,this.dirty=!1}},m}(rt),Ht=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(p){if(p!==this.current||this.dirty){var v=this.gl;v.bindRenderbuffer(v.RENDERBUFFER,p),this.current=p,this.dirty=!1}},m}(rt),nr=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(p){if(p!==this.current||this.dirty){var v=this.gl;v.bindTexture(v.TEXTURE_2D,p),this.current=p,this.dirty=!1}},m}(rt),Ki=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(p){if(p!==this.current||this.dirty){var v=this.gl;v.bindBuffer(v.ARRAY_BUFFER,p),this.current=p,this.dirty=!1}},m}(rt),zn=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(p){var v=this.gl;v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,p),this.current=p,this.dirty=!1},m}(rt),Xn=function(u){function m(p){u.call(this,p),this.vao=p.extVertexArrayObject}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(p){this.vao&&(p!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(p),this.current=p,this.dirty=!1)},m}(rt),Ni=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return 4},m.prototype.set=function(p){if(p!==this.current||this.dirty){var v=this.gl;v.pixelStorei(v.UNPACK_ALIGNMENT,p),this.current=p,this.dirty=!1}},m}(rt),fa=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(p){if(p!==this.current||this.dirty){var v=this.gl;v.pixelStorei(v.UNPACK_PREMULTIPLY_ALPHA_WEBGL,p),this.current=p,this.dirty=!1}},m}(rt),Lo=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(p){if(p!==this.current||this.dirty){var v=this.gl;v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,p),this.current=p,this.dirty=!1}},m}(rt),Nr=function(u){function m(p,v){u.call(this,p),this.context=p,this.parent=v}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m}(rt),te=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.setDirty=function(){this.dirty=!0},m.prototype.set=function(p){if(p!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var v=this.gl;v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,p,0),this.current=p,this.dirty=!1}},m}(Nr),oe=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.set=function(p){if(p!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var v=this.gl;v.framebufferRenderbuffer(v.FRAMEBUFFER,v.DEPTH_ATTACHMENT,v.RENDERBUFFER,p),this.current=p,this.dirty=!1}},m}(Nr),le=function(u,m,p,v){this.context=u,this.width=m,this.height=p;var k=this.framebuffer=u.gl.createFramebuffer();this.colorAttachment=new te(u,k),v&&(this.depthAttachment=new oe(u,k))};le.prototype.destroy=function(){var u=this.context.gl,m=this.colorAttachment.get();if(m&&u.deleteTexture(m),this.depthAttachment){var p=this.depthAttachment.get();p&&u.deleteRenderbuffer(p)}u.deleteFramebuffer(this.framebuffer)};var ge=function(u,m,p){this.func=u,this.mask=m,this.range=p};ge.ReadOnly=!1,ge.ReadWrite=!0,ge.disabled=new ge(519,ge.ReadOnly,[0,1]);var Se=function(u,m,p,v,k,L){this.test=u,this.ref=m,this.mask=p,this.fail=v,this.depthFail=k,this.pass=L};Se.disabled=new Se({func:519,mask:0},0,0,7680,7680,7680);var Oe=function(u,m,p){this.blendFunction=u,this.blendColor=m,this.mask=p};Oe.disabled=new Oe(Oe.Replace=[1,0],f.Color.transparent,[!1,!1,!1,!1]),Oe.unblended=new Oe(Oe.Replace,f.Color.transparent,[!0,!0,!0,!0]),Oe.alphaBlended=new Oe([1,771],f.Color.transparent,[!0,!0,!0,!0]);var Ne=function(u,m,p){this.enable=u,this.mode=m,this.frontFace=p};Ne.disabled=new Ne(!1,1029,2305),Ne.backCCW=new Ne(!0,1029,2305);var ye=function(u){this.gl=u,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new yi(this),this.clearDepth=new ir(this),this.clearStencil=new Cr(this),this.colorMask=new no(this),this.depthMask=new qn(this),this.stencilMask=new Mo(this),this.stencilFunc=new fn(this),this.stencilOp=new oo(this),this.stencilTest=new Gn(this),this.depthRange=new Zi(this),this.depthTest=new Fn(this),this.depthFunc=new _o(this),this.blend=new Zn(this),this.blendFunc=new Ra(this),this.blendColor=new Ue(this),this.blendEquation=new _t(this),this.cullFace=new bi(this),this.cullFaceSide=new pr(this),this.frontFace=new mr(this),this.program=new Hn(this),this.activeTexture=new Wn(this),this.viewport=new ea(this),this.bindFramebuffer=new Gr(this),this.bindRenderbuffer=new Ht(this),this.bindTexture=new nr(this),this.bindVertexBuffer=new Ki(this),this.bindElementBuffer=new zn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Xn(this),this.pixelStoreUnpack=new Ni(this),this.pixelStoreUnpackPremultiplyAlpha=new fa(this),this.pixelStoreUnpackFlipY=new Lo(this),this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=u.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(u.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=u.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=u.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE)};ye.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ye.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ye.prototype.createIndexBuffer=function(u,m){return new zt(this,u,m)},ye.prototype.createVertexBuffer=function(u,m,p){return new Rt(this,u,m,p)},ye.prototype.createRenderbuffer=function(u,m,p){var v=this.gl,k=v.createRenderbuffer();return this.bindRenderbuffer.set(k),v.renderbufferStorage(v.RENDERBUFFER,u,m,p),this.bindRenderbuffer.set(null),k},ye.prototype.createFramebuffer=function(u,m,p){return new le(this,u,m,p)},ye.prototype.clear=function(u){var m=u.color,p=u.depth,v=this.gl,k=0;m&&(k|=v.COLOR_BUFFER_BIT,this.clearColor.set(m),this.colorMask.set([!0,!0,!0,!0])),p!==void 0&&(k|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),v.clear(k)},ye.prototype.setCullFace=function(u){u.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))},ye.prototype.setDepthMode=function(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)},ye.prototype.setStencilMode=function(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)},ye.prototype.setColorMode=function(u){f.deepEqual(u.blendFunction,Oe.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)},ye.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Pe=function(u){function m(p,v,k){var L=this;u.call(this),this.id=p,this.dispatcher=k,this.on("data",function(B){B.dataType==="source"&&B.sourceDataType==="metadata"&&(L._sourceLoaded=!0),L._sourceLoaded&&!L._paused&&B.dataType==="source"&&B.sourceDataType==="content"&&(L.reload(),L.transform&&L.update(L.transform))}),this.on("error",function(){L._sourceErrored=!0}),this._source=function(B,j,Y,ie){var he=new Xi[j.type](B,j,Y,ie);if(he.id!==B)throw new Error("Expected Source id to be "+B+" instead of "+he.id);return f.bindAll(["load","abort","unload","serialize","prepare"],he),he}(p,v,k,this),this._tiles={},this._cache=new Ti(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new f.SourceFeatureState}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.onAdd=function(p){this.map=p,this._maxTileCacheSize=p?p._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(p)},m.prototype.onRemove=function(p){this._source&&this._source.onRemove&&this._source.onRemove(p)},m.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var p in this._tiles){var v=this._tiles[p];if(v.state!=="loaded"&&v.state!=="errored")return!1}return!0},m.prototype.getSource=function(){return this._source},m.prototype.pause=function(){this._paused=!0},m.prototype.resume=function(){if(this._paused){var p=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,p&&this.reload(),this.transform&&this.update(this.transform)}},m.prototype._loadTile=function(p,v){return this._source.loadTile(p,v)},m.prototype._unloadTile=function(p){if(this._source.unloadTile)return this._source.unloadTile(p,function(){})},m.prototype._abortTile=function(p){if(this._source.abortTile)return this._source.abortTile(p,function(){})},m.prototype.serialize=function(){return this._source.serialize()},m.prototype.prepare=function(p){for(var v in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var k=this._tiles[v];k.upload(p),k.prepare(this.map.style.imageManager)}},m.prototype.getIds=function(){return f.values(this._tiles).map(function(p){return p.tileID}).sort(Qe).map(function(p){return p.key})},m.prototype.getRenderableIds=function(p){var v=this,k=[];for(var L in this._tiles)this._isIdRenderable(L,p)&&k.push(this._tiles[L]);return p?k.sort(function(B,j){var Y=B.tileID,ie=j.tileID,he=new f.Point(Y.canonical.x,Y.canonical.y)._rotate(v.transform.angle),de=new f.Point(ie.canonical.x,ie.canonical.y)._rotate(v.transform.angle);return Y.overscaledZ-ie.overscaledZ||de.y-he.y||de.x-he.x}).map(function(B){return B.tileID.key}):k.map(function(B){return B.tileID}).sort(Qe).map(function(B){return B.key})},m.prototype.hasRenderableParent=function(p){var v=this.findLoadedParent(p,0);return!!v&&this._isIdRenderable(v.tileID.key)},m.prototype._isIdRenderable=function(p,v){return this._tiles[p]&&this._tiles[p].hasData()&&!this._coveredTiles[p]&&(v||!this._tiles[p].holdingForFade())},m.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var p in this._cache.reset(),this._tiles)this._tiles[p].state!=="errored"&&this._reloadTile(p,"reloading")},m.prototype._reloadTile=function(p,v){var k=this._tiles[p];k&&(k.state!=="loading"&&(k.state=v),this._loadTile(k,this._tileLoaded.bind(this,k,p,v)))},m.prototype._tileLoaded=function(p,v,k,L){if(L)return p.state="errored",void(L.status!==404?this._source.fire(new f.ErrorEvent(L,{tile:p})):this.update(this.transform));p.timeAdded=f.browser.now(),k==="expired"&&(p.refreshedUponExpiration=!0),this._setTileReloadTimer(v,p),this.getSource().type==="raster-dem"&&p.dem&&this._backfillDEM(p),this._state.initializeTileState(p,this.map?this.map.painter:null),this._source.fire(new f.Event("data",{dataType:"source",tile:p,coord:p.tileID}))},m.prototype._backfillDEM=function(p){for(var v=this.getRenderableIds(),k=0;k<v.length;k++){var L=v[k];if(p.neighboringTiles&&p.neighboringTiles[L]){var B=this.getTileByID(L);j(p,B),j(B,p)}}function j(Y,ie){Y.needsHillshadePrepare=!0;var he=ie.tileID.canonical.x-Y.tileID.canonical.x,de=ie.tileID.canonical.y-Y.tileID.canonical.y,me=Math.pow(2,Y.tileID.canonical.z),Ce=ie.tileID.key;he===0&&de===0||Math.abs(de)>1||(Math.abs(he)>1&&(Math.abs(he+me)===1?he+=me:Math.abs(he-me)===1&&(he-=me)),ie.dem&&Y.dem&&(Y.dem.backfillBorder(ie.dem,he,de),Y.neighboringTiles&&Y.neighboringTiles[Ce]&&(Y.neighboringTiles[Ce].backfilled=!0)))}},m.prototype.getTile=function(p){return this.getTileByID(p.key)},m.prototype.getTileByID=function(p){return this._tiles[p]},m.prototype._retainLoadedChildren=function(p,v,k,L){for(var B in this._tiles){var j=this._tiles[B];if(!(L[B]||!j.hasData()||j.tileID.overscaledZ<=v||j.tileID.overscaledZ>k)){for(var Y=j.tileID;j&&j.tileID.overscaledZ>v+1;){var ie=j.tileID.scaledTo(j.tileID.overscaledZ-1);(j=this._tiles[ie.key])&&j.hasData()&&(Y=ie)}for(var he=Y;he.overscaledZ>v;)if(p[(he=he.scaledTo(he.overscaledZ-1)).key]){L[Y.key]=Y;break}}}},m.prototype.findLoadedParent=function(p,v){if(p.key in this._loadedParentTiles){var k=this._loadedParentTiles[p.key];return k&&k.tileID.overscaledZ>=v?k:null}for(var L=p.overscaledZ-1;L>=v;L--){var B=p.scaledTo(L),j=this._getLoadedTile(B);if(j)return j}},m.prototype._getLoadedTile=function(p){var v=this._tiles[p.key];return v&&v.hasData()?v:this._cache.getByKey(p.wrapped().key)},m.prototype.updateCacheSize=function(p){var v=Math.ceil(p.width/this._source.tileSize)+1,k=Math.ceil(p.height/this._source.tileSize)+1,L=Math.floor(v*k*5),B=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,L):L;this._cache.setMaxSize(B)},m.prototype.handleWrapJump=function(p){var v=Math.round((p-(this._prevLng===void 0?p:this._prevLng))/360);if(this._prevLng=p,v){var k={};for(var L in this._tiles){var B=this._tiles[L];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+v),k[B.tileID.key]=B}for(var j in this._tiles=k,this._timers)clearTimeout(this._timers[j]),delete this._timers[j];for(var Y in this._tiles)this._setTileReloadTimer(Y,this._tiles[Y])}},m.prototype.update=function(p){var v=this;if(this.transform=p,this._sourceLoaded&&!this._paused){var k;this.updateCacheSize(p),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?k=p.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(It){return new f.OverscaledTileID(It.canonical.z,It.wrap,It.canonical.z,It.canonical.x,It.canonical.y)}):(k=p.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(k=k.filter(function(It){return v._source.hasTile(It)}))):k=[];var L=p.coveringZoomLevel(this._source),B=Math.max(L-m.maxOverzooming,this._source.minzoom),j=Math.max(L+m.maxUnderzooming,this._source.minzoom),Y=this._updateRetainedTiles(k,L);if(ae(this._source.type)){for(var ie={},he={},de=0,me=Object.keys(Y);de<me.length;de+=1){var Ce=me[de],Te=Y[Ce],Le=this._tiles[Ce];if(Le&&!(Le.fadeEndTime&&Le.fadeEndTime<=f.browser.now())){var xe=this.findLoadedParent(Te,B);xe&&(this._addTile(xe.tileID),ie[xe.tileID.key]=xe.tileID),he[Ce]=Te}}for(var ze in this._retainLoadedChildren(he,L,j,Y),ie)Y[ze]||(this._coveredTiles[ze]=!0,Y[ze]=ie[ze])}for(var Fe in Y)this._tiles[Fe].clearFadeHold();for(var Ye=0,ot=f.keysDifference(this._tiles,Y);Ye<ot.length;Ye+=1){var at=ot[Ye],st=this._tiles[at];st.hasSymbolBuckets&&!st.holdingForFade()?st.setHoldDuration(this.map._fadeDuration):st.hasSymbolBuckets&&!st.symbolFadeFinished()||this._removeTile(at)}this._updateLoadedParentTileCache()}},m.prototype.releaseSymbolFadeTiles=function(){for(var p in this._tiles)this._tiles[p].holdingForFade()&&this._removeTile(p)},m.prototype._updateRetainedTiles=function(p,v){for(var k={},L={},B=Math.max(v-m.maxOverzooming,this._source.minzoom),j=Math.max(v+m.maxUnderzooming,this._source.minzoom),Y={},ie=0,he=p;ie<he.length;ie+=1){var de=he[ie],me=this._addTile(de);k[de.key]=de,me.hasData()||v<this._source.maxzoom&&(Y[de.key]=de)}this._retainLoadedChildren(Y,v,j,k);for(var Ce=0,Te=p;Ce<Te.length;Ce+=1){var Le=Te[Ce],xe=this._tiles[Le.key];if(!xe.hasData()){if(v+1>this._source.maxzoom){var ze=Le.children(this._source.maxzoom)[0],Fe=this.getTile(ze);if(Fe&&Fe.hasData()){k[ze.key]=ze;continue}}else{var Ye=Le.children(this._source.maxzoom);if(k[Ye[0].key]&&k[Ye[1].key]&&k[Ye[2].key]&&k[Ye[3].key])continue}for(var ot=xe.wasRequested(),at=Le.overscaledZ-1;at>=B;--at){var st=Le.scaledTo(at);if(L[st.key]||(L[st.key]=!0,!(xe=this.getTile(st))&&ot&&(xe=this._addTile(st)),xe&&(k[st.key]=st,ot=xe.wasRequested(),xe.hasData())))break}}}return k},m.prototype._updateLoadedParentTileCache=function(){for(var p in this._loadedParentTiles={},this._tiles){for(var v=[],k=void 0,L=this._tiles[p].tileID;L.overscaledZ>0;){if(L.key in this._loadedParentTiles){k=this._loadedParentTiles[L.key];break}v.push(L.key);var B=L.scaledTo(L.overscaledZ-1);if(k=this._getLoadedTile(B))break;L=B}for(var j=0,Y=v;j<Y.length;j+=1)this._loadedParentTiles[Y[j]]=k}},m.prototype._addTile=function(p){var v=this._tiles[p.key];if(v)return v;(v=this._cache.getAndRemove(p))&&(this._setTileReloadTimer(p.key,v),v.tileID=p,this._state.initializeTileState(v,this.map?this.map.painter:null),this._cacheTimers[p.key]&&(clearTimeout(this._cacheTimers[p.key]),delete this._cacheTimers[p.key],this._setTileReloadTimer(p.key,v)));var k=Boolean(v);return k||(v=new f.Tile(p,this._source.tileSize*p.overscaleFactor()),this._loadTile(v,this._tileLoaded.bind(this,v,p.key,v.state))),v?(v.uses++,this._tiles[p.key]=v,k||this._source.fire(new f.Event("dataloading",{tile:v,coord:v.tileID,dataType:"source"})),v):null},m.prototype._setTileReloadTimer=function(p,v){var k=this;p in this._timers&&(clearTimeout(this._timers[p]),delete this._timers[p]);var L=v.getExpiryTimeout();L&&(this._timers[p]=setTimeout(function(){k._reloadTile(p,"expired"),delete k._timers[p]},L))},m.prototype._removeTile=function(p){var v=this._tiles[p];v&&(v.uses--,delete this._tiles[p],this._timers[p]&&(clearTimeout(this._timers[p]),delete this._timers[p]),v.uses>0||(v.hasData()&&v.state!=="reloading"?this._cache.add(v.tileID,v,v.getExpiryTimeout()):(v.aborted=!0,this._abortTile(v),this._unloadTile(v))))},m.prototype.clearTiles=function(){for(var p in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(p);this._cache.reset()},m.prototype.tilesIn=function(p,v,k){var L=this,B=[],j=this.transform;if(!j)return B;for(var Y=k?j.getCameraQueryGeometry(p):p,ie=p.map(function(at){return j.pointCoordinate(at)}),he=Y.map(function(at){return j.pointCoordinate(at)}),de=this.getIds(),me=1/0,Ce=1/0,Te=-1/0,Le=-1/0,xe=0,ze=he;xe<ze.length;xe+=1){var Fe=ze[xe];me=Math.min(me,Fe.x),Ce=Math.min(Ce,Fe.y),Te=Math.max(Te,Fe.x),Le=Math.max(Le,Fe.y)}for(var Ye=function(at){var st=L._tiles[de[at]];if(!st.holdingForFade()){var It=st.tileID,Lt=Math.pow(2,j.zoom-st.tileID.overscaledZ),Mt=v*st.queryPadding*f.EXTENT/st.tileSize/Lt,Yt=[It.getTilePoint(new f.MercatorCoordinate(me,Ce)),It.getTilePoint(new f.MercatorCoordinate(Te,Le))];if(Yt[0].x-Mt<f.EXTENT&&Yt[0].y-Mt<f.EXTENT&&Yt[1].x+Mt>=0&&Yt[1].y+Mt>=0){var di=ie.map(function(hi){return It.getTilePoint(hi)}),_i=he.map(function(hi){return It.getTilePoint(hi)});B.push({tile:st,tileID:It,queryGeometry:di,cameraQueryGeometry:_i,scale:Lt})}}},ot=0;ot<de.length;ot++)Ye(ot);return B},m.prototype.getVisibleCoordinates=function(p){for(var v=this,k=this.getRenderableIds(p).map(function(Y){return v._tiles[Y].tileID}),L=0,B=k;L<B.length;L+=1){var j=B[L];j.posMatrix=this.transform.calculatePosMatrix(j.toUnwrapped())}return k},m.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(ae(this._source.type))for(var p in this._tiles){var v=this._tiles[p];if(v.fadeEndTime!==void 0&&v.fadeEndTime>=f.browser.now())return!0}return!1},m.prototype.setFeatureState=function(p,v,k){this._state.updateState(p=p||"_geojsonTileLayer",v,k)},m.prototype.removeFeatureState=function(p,v,k){this._state.removeFeatureState(p=p||"_geojsonTileLayer",v,k)},m.prototype.getFeatureState=function(p,v){return this._state.getState(p=p||"_geojsonTileLayer",v)},m.prototype.setDependencies=function(p,v,k){var L=this._tiles[p];L&&L.setDependencies(v,k)},m.prototype.reloadTilesForDependencies=function(p,v){for(var k in this._tiles)this._tiles[k].hasDependency(p,v)&&this._reloadTile(k,"reloading");this._cache.filter(function(L){return!L.hasDependency(p,v)})},m}(f.Evented);function Qe(u,m){var p=Math.abs(2*u.wrap)-+(u.wrap<0),v=Math.abs(2*m.wrap)-+(m.wrap<0);return u.overscaledZ-m.overscaledZ||v-p||m.canonical.y-u.canonical.y||m.canonical.x-u.canonical.x}function ae(u){return u==="raster"||u==="image"||u==="video"}function H(){return new f.window.Worker(Oi.workerUrl)}Pe.maxOverzooming=10,Pe.maxUnderzooming=3;var W="mapboxgl_preloaded_worker_pool",ne=function(){this.active={}};ne.prototype.acquire=function(u){if(!this.workers)for(this.workers=[];this.workers.length<ne.workerCount;)this.workers.push(new H);return this.active[u]=!0,this.workers.slice()},ne.prototype.release=function(u){delete this.active[u],this.numActive()===0&&(this.workers.forEach(function(m){m.terminate()}),this.workers=null)},ne.prototype.isPreloaded=function(){return!!this.active[W]},ne.prototype.numActive=function(){return Object.keys(this.active).length};var ce,_e=Math.floor(f.browser.hardwareConcurrency/2);function fe(){return ce||(ce=new ne),ce}function Ee(u,m){var p={};for(var v in u)v!=="ref"&&(p[v]=u[v]);return f.refProperties.forEach(function(k){k in m&&(p[k]=m[k])}),p}function we(u){u=u.slice();for(var m=Object.create(null),p=0;p<u.length;p++)m[u[p].id]=u[p];for(var v=0;v<u.length;v++)"ref"in u[v]&&(u[v]=Ee(u[v],m[u[v].ref]));return u}ne.workerCount=Math.max(Math.min(_e,6),1);var Ie={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function et(u,m,p){p.push({command:Ie.addSource,args:[u,m[u]]})}function Ke(u,m,p){m.push({command:Ie.removeSource,args:[u]}),p[u]=!0}function tt(u,m,p,v){Ke(u,p,v),et(u,m,p)}function Ft(u,m,p){var v;for(v in u[p])if(u[p].hasOwnProperty(v)&&v!=="data"&&!f.deepEqual(u[p][v],m[p][v]))return!1;for(v in m[p])if(m[p].hasOwnProperty(v)&&v!=="data"&&!f.deepEqual(u[p][v],m[p][v]))return!1;return!0}function At(u,m,p,v,k,L){var B;for(B in m=m||{},u=u||{})u.hasOwnProperty(B)&&(f.deepEqual(u[B],m[B])||p.push({command:L,args:[v,B,m[B],k]}));for(B in m)m.hasOwnProperty(B)&&!u.hasOwnProperty(B)&&(f.deepEqual(u[B],m[B])||p.push({command:L,args:[v,B,m[B],k]}))}function Bt(u){return u.id}function jt(u,m){return u[m.id]=m,u}var Hi=function(u,m){this.reset(u,m)};Hi.prototype.reset=function(u,m){this.points=u||[],this._distances=[0];for(var p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Hi.prototype.lerp=function(u){if(this.points.length===1)return this.points[0];u=f.clamp(u,0,1);for(var m=1,p=this._distances[m],v=u*this.paddedLength+this.padding;p<v&&m<this._distances.length;)p=this._distances[++m];var k=m-1,L=this._distances[k],B=p-L,j=B>0?(v-L)/B:0;return this.points[k].mult(1-j).add(this.points[m].mult(j))};var mi=function(u,m,p){var v=this.boxCells=[],k=this.circleCells=[];this.xCellCount=Math.ceil(u/p),this.yCellCount=Math.ceil(m/p);for(var L=0;L<this.xCellCount*this.yCellCount;L++)v.push([]),k.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=m,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0};function Ii(u,m,p,v,k){var L=f.create();return m?(f.scale(L,L,[1/k,1/k,1]),p||f.rotateZ(L,L,v.angle)):f.multiply(L,v.labelPlaneMatrix,u),L}function li(u,m,p,v,k){if(m){var L=f.clone(u);return f.scale(L,L,[k,k,1]),p||f.rotateZ(L,L,-v.angle),L}return v.glCoordMatrix}function Kt(u,m){var p=[u.x,u.y,0,1];Pn(p,p,m);var v=p[3];return{point:new f.Point(p[0]/v,p[1]/v),signedDistanceFromCamera:v}}function Pi(u,m){return .5+u/m*.5}function _r(u,m){var p=u[0]/u[3],v=u[1]/u[3];return p>=-m[0]&&p<=m[0]&&v>=-m[1]&&v<=m[1]}function Sn(u,m,p,v,k,L,B,j){var Y=v?u.textSizeData:u.iconSizeData,ie=f.evaluateSizeForZoom(Y,p.transform.zoom),he=[256/p.width*2+1,256/p.height*2+1],de=v?u.text.dynamicLayoutVertexArray:u.icon.dynamicLayoutVertexArray;de.clear();for(var me=u.lineVertexArray,Ce=v?u.text.placedSymbolArray:u.icon.placedSymbolArray,Te=p.transform.width/p.transform.height,Le=!1,xe=0;xe<Ce.length;xe++){var ze=Ce.get(xe);if(ze.hidden||ze.writingMode===f.WritingMode.vertical&&!Le)vo(ze.numGlyphs,de);else{Le=!1;var Fe=[ze.anchorX,ze.anchorY,0,1];if(f.transformMat4(Fe,Fe,m),_r(Fe,he)){var Ye=Pi(p.transform.cameraToCenterDistance,Fe[3]),ot=f.evaluateSizeForFeature(Y,ie,ze),at=B?ot/Ye:ot*Ye,st=new f.Point(ze.anchorX,ze.anchorY),It=Kt(st,k).point,Lt={},Mt=Rl(ze,at,!1,j,m,k,L,u.glyphOffsetArray,me,de,It,st,Lt,Te);Le=Mt.useVertical,(Mt.notEnoughRoom||Le||Mt.needsFlipping&&Rl(ze,at,!0,j,m,k,L,u.glyphOffsetArray,me,de,It,st,Lt,Te).notEnoughRoom)&&vo(ze.numGlyphs,de)}else vo(ze.numGlyphs,de)}}v?u.text.dynamicLayoutVertexBuffer.updateData(de):u.icon.dynamicLayoutVertexBuffer.updateData(de)}function Er(u,m,p,v,k,L,B,j,Y,ie,he){var de=j.glyphStartIndex+j.numGlyphs,me=j.lineStartIndex,Ce=j.lineStartIndex+j.lineLength,Te=m.getoffsetX(j.glyphStartIndex),Le=m.getoffsetX(de-1),xe=vn(u*Te,p,v,k,L,B,j.segment,me,Ce,Y,ie,he);if(!xe)return null;var ze=vn(u*Le,p,v,k,L,B,j.segment,me,Ce,Y,ie,he);return ze?{first:xe,last:ze}:null}function po(u,m,p,v){return u===f.WritingMode.horizontal&&Math.abs(p.y-m.y)>Math.abs(p.x-m.x)*v?{useVertical:!0}:(u===f.WritingMode.vertical?m.y<p.y:m.x>p.x)?{needsFlipping:!0}:null}function Rl(u,m,p,v,k,L,B,j,Y,ie,he,de,me,Ce){var Te,Le=m/24,xe=u.lineOffsetX*Le,ze=u.lineOffsetY*Le;if(u.numGlyphs>1){var Fe=u.glyphStartIndex+u.numGlyphs,Ye=u.lineStartIndex,ot=u.lineStartIndex+u.lineLength,at=Er(Le,j,xe,ze,p,he,de,u,Y,L,me);if(!at)return{notEnoughRoom:!0};var st=Kt(at.first.point,B).point,It=Kt(at.last.point,B).point;if(v&&!p){var Lt=po(u.writingMode,st,It,Ce);if(Lt)return Lt}Te=[at.first];for(var Mt=u.glyphStartIndex+1;Mt<Fe-1;Mt++)Te.push(vn(Le*j.getoffsetX(Mt),xe,ze,p,he,de,u.segment,Ye,ot,Y,L,me));Te.push(at.last)}else{if(v&&!p){var Yt=Kt(de,k).point,di=u.lineStartIndex+u.segment+1,_i=new f.Point(Y.getx(di),Y.gety(di)),hi=Kt(_i,k),ar=hi.signedDistanceFromCamera>0?hi.point:Rr(de,_i,Yt,1,k),ri=po(u.writingMode,Yt,ar,Ce);if(ri)return ri}var Di=vn(Le*j.getoffsetX(u.glyphStartIndex),xe,ze,p,he,de,u.segment,u.lineStartIndex,u.lineStartIndex+u.lineLength,Y,L,me);if(!Di)return{notEnoughRoom:!0};Te=[Di]}for(var er=0,zi=Te;er<zi.length;er+=1){var Ai=zi[er];f.addDynamicAttributes(ie,Ai.point,Ai.angle)}return{}}function Rr(u,m,p,v,k){var L=Kt(u.add(u.sub(m)._unit()),k).point,B=p.sub(L);return p.add(B._mult(v/B.mag()))}function vn(u,m,p,v,k,L,B,j,Y,ie,he,de){var me=v?u-m:u+m,Ce=me>0?1:-1,Te=0;v&&(Ce*=-1,Te=Math.PI),Ce<0&&(Te+=Math.PI);for(var Le=Ce>0?j+B:j+B+1,xe=k,ze=k,Fe=0,Ye=0,ot=Math.abs(me),at=[];Fe+Ye<=ot;){if((Le+=Ce)<j||Le>=Y)return null;if(ze=xe,at.push(xe),(xe=de[Le])===void 0){var st=new f.Point(ie.getx(Le),ie.gety(Le)),It=Kt(st,he);if(It.signedDistanceFromCamera>0)xe=de[Le]=It.point;else{var Lt=Le-Ce;xe=Rr(Fe===0?L:new f.Point(ie.getx(Lt),ie.gety(Lt)),st,ze,ot-Fe+1,he)}}Fe+=Ye,Ye=ze.dist(xe)}var Mt=(ot-Fe)/Ye,Yt=xe.sub(ze),di=Yt.mult(Mt)._add(ze);di._add(Yt._unit()._perp()._mult(p*Ce));var _i=Te+Math.atan2(xe.y-ze.y,xe.x-ze.x);return at.push(di),{point:di,angle:_i,path:at}}mi.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},mi.prototype.insert=function(u,m,p,v,k){this._forEachCell(m,p,v,k,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(m),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(k)},mi.prototype.insertCircle=function(u,m,p,v){this._forEachCell(m-v,p-v,m+v,p+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(m),this.circles.push(p),this.circles.push(v)},mi.prototype._insertBoxCell=function(u,m,p,v,k,L){this.boxCells[k].push(L)},mi.prototype._insertCircleCell=function(u,m,p,v,k,L){this.circleCells[k].push(L)},mi.prototype._query=function(u,m,p,v,k,L){if(p<0||u>this.width||v<0||m>this.height)return!k&&[];var B=[];if(u<=0&&m<=0&&this.width<=p&&this.height<=v){if(k)return!0;for(var j=0;j<this.boxKeys.length;j++)B.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(var Y=0;Y<this.circleKeys.length;Y++){var ie=this.circles[3*Y],he=this.circles[3*Y+1],de=this.circles[3*Y+2];B.push({key:this.circleKeys[Y],x1:ie-de,y1:he-de,x2:ie+de,y2:he+de})}return L?B.filter(L):B}return this._forEachCell(u,m,p,v,this._queryCell,B,{hitTest:k,seenUids:{box:{},circle:{}}},L),k?B.length>0:B},mi.prototype._queryCircle=function(u,m,p,v,k){var L=u-p,B=u+p,j=m-p,Y=m+p;if(B<0||L>this.width||Y<0||j>this.height)return!v&&[];var ie=[];return this._forEachCell(L,j,B,Y,this._queryCellCircle,ie,{hitTest:v,circle:{x:u,y:m,radius:p},seenUids:{box:{},circle:{}}},k),v?ie.length>0:ie},mi.prototype.query=function(u,m,p,v,k){return this._query(u,m,p,v,!1,k)},mi.prototype.hitTest=function(u,m,p,v,k){return this._query(u,m,p,v,!0,k)},mi.prototype.hitTestCircle=function(u,m,p,v){return this._queryCircle(u,m,p,!0,v)},mi.prototype._queryCell=function(u,m,p,v,k,L,B,j){var Y=B.seenUids,ie=this.boxCells[k];if(ie!==null)for(var he=this.bboxes,de=0,me=ie;de<me.length;de+=1){var Ce=me[de];if(!Y.box[Ce]){Y.box[Ce]=!0;var Te=4*Ce;if(u<=he[Te+2]&&m<=he[Te+3]&&p>=he[Te+0]&&v>=he[Te+1]&&(!j||j(this.boxKeys[Ce]))){if(B.hitTest)return L.push(!0),!0;L.push({key:this.boxKeys[Ce],x1:he[Te],y1:he[Te+1],x2:he[Te+2],y2:he[Te+3]})}}}var Le=this.circleCells[k];if(Le!==null)for(var xe=this.circles,ze=0,Fe=Le;ze<Fe.length;ze+=1){var Ye=Fe[ze];if(!Y.circle[Ye]){Y.circle[Ye]=!0;var ot=3*Ye;if(this._circleAndRectCollide(xe[ot],xe[ot+1],xe[ot+2],u,m,p,v)&&(!j||j(this.circleKeys[Ye]))){if(B.hitTest)return L.push(!0),!0;var at=xe[ot],st=xe[ot+1],It=xe[ot+2];L.push({key:this.circleKeys[Ye],x1:at-It,y1:st-It,x2:at+It,y2:st+It})}}}},mi.prototype._queryCellCircle=function(u,m,p,v,k,L,B,j){var Y=B.circle,ie=B.seenUids,he=this.boxCells[k];if(he!==null)for(var de=this.bboxes,me=0,Ce=he;me<Ce.length;me+=1){var Te=Ce[me];if(!ie.box[Te]){ie.box[Te]=!0;var Le=4*Te;if(this._circleAndRectCollide(Y.x,Y.y,Y.radius,de[Le+0],de[Le+1],de[Le+2],de[Le+3])&&(!j||j(this.boxKeys[Te])))return L.push(!0),!0}}var xe=this.circleCells[k];if(xe!==null)for(var ze=this.circles,Fe=0,Ye=xe;Fe<Ye.length;Fe+=1){var ot=Ye[Fe];if(!ie.circle[ot]){ie.circle[ot]=!0;var at=3*ot;if(this._circlesCollide(ze[at],ze[at+1],ze[at+2],Y.x,Y.y,Y.radius)&&(!j||j(this.circleKeys[ot])))return L.push(!0),!0}}},mi.prototype._forEachCell=function(u,m,p,v,k,L,B,j){for(var Y=this._convertToXCellCoord(u),ie=this._convertToYCellCoord(m),he=this._convertToXCellCoord(p),de=this._convertToYCellCoord(v),me=Y;me<=he;me++)for(var Ce=ie;Ce<=de;Ce++)if(k.call(this,u,m,p,v,this.xCellCount*Ce+me,L,B,j))return},mi.prototype._convertToXCellCoord=function(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))},mi.prototype._convertToYCellCoord=function(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))},mi.prototype._circlesCollide=function(u,m,p,v,k,L){var B=v-u,j=k-m,Y=p+L;return Y*Y>B*B+j*j},mi.prototype._circleAndRectCollide=function(u,m,p,v,k,L,B){var j=(L-v)/2,Y=Math.abs(u-(v+j));if(Y>j+p)return!1;var ie=(B-k)/2,he=Math.abs(m-(k+ie));if(he>ie+p)return!1;if(Y<=j||he<=ie)return!0;var de=Y-j,me=he-ie;return de*de+me*me<=p*p};var Vs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function vo(u,m){for(var p=0;p<u;p++){var v=m.length;m.resize(v+4),m.float32.set(Vs,3*v)}}function Pn(u,m,p){var v=m[0],k=m[1];return u[0]=p[0]*v+p[4]*k+p[12],u[1]=p[1]*v+p[5]*k+p[13],u[3]=p[3]*v+p[7]*k+p[15],u}var ta=function(u,m,p){m===void 0&&(m=new mi(u.width+200,u.height+200,25)),p===void 0&&(p=new mi(u.width+200,u.height+200,25)),this.transform=u,this.grid=m,this.ignoredGrid=p,this.pitchfactor=Math.cos(u._pitch)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+100,this.screenBottomBoundary=u.height+100,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200};function Wr(u,m,p){return m*(f.EXTENT/(u.tileSize*Math.pow(2,p-u.tileID.overscaledZ)))}ta.prototype.placeCollisionBox=function(u,m,p,v,k){var L=this.projectAndGetPerspectiveRatio(v,u.anchorPointX,u.anchorPointY),B=p*L.perspectiveRatio,j=u.x1*B+L.point.x,Y=u.y1*B+L.point.y,ie=u.x2*B+L.point.x,he=u.y2*B+L.point.y;return!this.isInsideGrid(j,Y,ie,he)||!m&&this.grid.hitTest(j,Y,ie,he,k)?{box:[],offscreen:!1}:{box:[j,Y,ie,he],offscreen:this.isOffscreen(j,Y,ie,he)}},ta.prototype.placeCollisionCircles=function(u,m,p,v,k,L,B,j,Y,ie,he,de,me){var Ce=[],Te=new f.Point(m.anchorX,m.anchorY),Le=Kt(Te,L),xe=Pi(this.transform.cameraToCenterDistance,Le.signedDistanceFromCamera),ze=(ie?k/xe:k*xe)/f.ONE_EM,Fe=Kt(Te,B).point,Ye=Er(ze,v,m.lineOffsetX*ze,m.lineOffsetY*ze,!1,Fe,Te,m,p,B,{}),ot=!1,at=!1,st=!0;if(Ye){for(var It=.5*de*xe+me,Lt=new f.Point(-100,-100),Mt=new f.Point(this.screenRightBoundary,this.screenBottomBoundary),Yt=new Hi,di=Ye.first,_i=Ye.last,hi=[],ar=di.path.length-1;ar>=1;ar--)hi.push(di.path[ar]);for(var ri=1;ri<_i.path.length;ri++)hi.push(_i.path[ri]);var Di=2.5*It;if(j){var er=hi.map(function(xa){return Kt(xa,j)});hi=er.some(function(xa){return xa.signedDistanceFromCamera<=0})?[]:er.map(function(xa){return xa.point})}var zi=[];if(hi.length>0){for(var Ai=hi[0].clone(),ji=hi[0].clone(),wi=1;wi<hi.length;wi++)Ai.x=Math.min(Ai.x,hi[wi].x),Ai.y=Math.min(Ai.y,hi[wi].y),ji.x=Math.max(ji.x,hi[wi].x),ji.y=Math.max(ji.y,hi[wi].y);zi=Ai.x>=Lt.x&&ji.x<=Mt.x&&Ai.y>=Lt.y&&ji.y<=Mt.y?[hi]:ji.x<Lt.x||Ai.x>Mt.x||ji.y<Lt.y||Ai.y>Mt.y?[]:f.clipLine([hi],Lt.x,Lt.y,Mt.x,Mt.y)}for(var gi=0,hn=zi;gi<hn.length;gi+=1){var En;Yt.reset(hn[gi],.25*It),En=Yt.length<=.5*It?1:Math.ceil(Yt.paddedLength/Di)+1;for(var Ln=0;Ln<En;Ln++){var yo=Ln/Math.max(En-1,1),yn=Yt.lerp(yo),lr=yn.x+100,Ho=yn.y+100;Ce.push(lr,Ho,It,0);var Oo=lr-It,_a=Ho-It,Jn=lr+It,va=Ho+It;if(st=st&&this.isOffscreen(Oo,_a,Jn,va),at=at||this.isInsideGrid(Oo,_a,Jn,va),!u&&this.grid.hitTestCircle(lr,Ho,It,he)&&(ot=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:ot}}}}return{circles:!Y&&ot||!at?[]:Ce,offscreen:st,collisionDetected:ot}},ta.prototype.queryRenderedSymbols=function(u){if(u.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var m=[],p=1/0,v=1/0,k=-1/0,L=-1/0,B=0,j=u;B<j.length;B+=1){var Y=j[B],ie=new f.Point(Y.x+100,Y.y+100);p=Math.min(p,ie.x),v=Math.min(v,ie.y),k=Math.max(k,ie.x),L=Math.max(L,ie.y),m.push(ie)}for(var he={},de={},me=0,Ce=this.grid.query(p,v,k,L).concat(this.ignoredGrid.query(p,v,k,L));me<Ce.length;me+=1){var Te=Ce[me],Le=Te.key;if(he[Le.bucketInstanceId]===void 0&&(he[Le.bucketInstanceId]={}),!he[Le.bucketInstanceId][Le.featureIndex]){var xe=[new f.Point(Te.x1,Te.y1),new f.Point(Te.x2,Te.y1),new f.Point(Te.x2,Te.y2),new f.Point(Te.x1,Te.y2)];f.polygonIntersectsPolygon(m,xe)&&(he[Le.bucketInstanceId][Le.featureIndex]=!0,de[Le.bucketInstanceId]===void 0&&(de[Le.bucketInstanceId]=[]),de[Le.bucketInstanceId].push(Le.featureIndex))}}return de},ta.prototype.insertCollisionBox=function(u,m,p,v,k){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:v,collisionGroupID:k},u[0],u[1],u[2],u[3])},ta.prototype.insertCollisionCircles=function(u,m,p,v,k){for(var L=m?this.ignoredGrid:this.grid,B={bucketInstanceId:p,featureIndex:v,collisionGroupID:k},j=0;j<u.length;j+=4)L.insertCircle(B,u[j],u[j+1],u[j+2])},ta.prototype.projectAndGetPerspectiveRatio=function(u,m,p){var v=[m,p,0,1];return Pn(v,v,u),{point:new f.Point((v[0]/v[3]+1)/2*this.transform.width+100,(-v[1]/v[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/v[3]*.5}},ta.prototype.isOffscreen=function(u,m,p,v){return p<100||u>=this.screenRightBoundary||v<100||m>this.screenBottomBoundary},ta.prototype.isInsideGrid=function(u,m,p,v){return p>=0&&u<this.gridRightBoundary&&v>=0&&m<this.gridBottomBoundary},ta.prototype.getViewportMatrix=function(){var u=f.identity([]);return f.translate(u,u,[-100,-100,0]),u};var ia=function(u,m,p,v){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?m:-m))):v&&p?1:0,this.placed=p};ia.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Do=function(u,m,p,v,k){this.text=new ia(u?u.text:null,m,p,k),this.icon=new ia(u?u.icon:null,m,v,k)};Do.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Yu=function(u,m,p){this.text=u,this.icon=m,this.skipFade=p},ra=function(){this.invProjMatrix=f.create(),this.viewportMatrix=f.create(),this.circles=[]},qs=function(u,m,p,v,k){this.bucketInstanceId=u,this.featureIndex=m,this.sourceLayerIndex=p,this.bucketIndex=v,this.tileID=k},ma=function(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}};function xn(u,m,p,v,k){var L=f.getAnchorAlignment(u),B=-(L.horizontalAlign-.5)*m,j=-(L.verticalAlign-.5)*p,Y=f.evaluateVariableOffset(u,v);return new f.Point(B+Y[0]*k,j+Y[1]*k)}function jo(u,m,p,v,k,L){var B=u.x1,j=u.x2,Y=u.y1,ie=u.y2,he=u.anchorPointX,de=u.anchorPointY,me=new f.Point(m,p);return v&&me._rotate(k?L:-L),{x1:B+me.x,y1:Y+me.y,x2:j+me.x,y2:ie+me.y,anchorPointX:he,anchorPointY:de}}ma.prototype.get=function(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){var m=++this.maxGroupID;this.collisionGroups[u]={ID:m,predicate:function(p){return p.collisionGroupID===m}}}return this.collisionGroups[u]};var Kn=function(u,m,p,v){this.transform=u.clone(),this.collisionIndex=new ta(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new ma(p),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}};function Ba(u,m,p,v,k){u.emplaceBack(m?1:0,p?1:0,v||0,k||0),u.emplaceBack(m?1:0,p?1:0,v||0,k||0),u.emplaceBack(m?1:0,p?1:0,v||0,k||0),u.emplaceBack(m?1:0,p?1:0,v||0,k||0)}Kn.prototype.getBucketParts=function(u,m,p,v){var k=p.getBucket(m),L=p.latestFeatureIndex;if(k&&L&&m.id===k.layerIds[0]){var B=p.collisionBoxArray,j=k.layers[0].layout,Y=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),ie=p.tileSize/f.EXTENT,he=this.transform.calculatePosMatrix(p.tileID.toUnwrapped()),de=j.get("text-pitch-alignment")==="map",me=j.get("text-rotation-alignment")==="map",Ce=Wr(p,1,this.transform.zoom),Te=Ii(he,de,me,this.transform,Ce),Le=null;if(de){var xe=li(he,de,me,this.transform,Ce);Le=f.multiply([],this.transform.labelPlaneMatrix,xe)}this.retainedQueryData[k.bucketInstanceId]=new qs(k.bucketInstanceId,L,k.sourceLayerIndex,k.index,p.tileID);var ze={bucket:k,layout:j,posMatrix:he,textLabelPlaneMatrix:Te,labelToScreenMatrix:Le,scale:Y,textPixelRatio:ie,holdingForFade:p.holdingForFade(),collisionBoxArray:B,partiallyEvaluatedTextSize:f.evaluateSizeForZoom(k.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(k.sourceID)};if(v)for(var Fe=0,Ye=k.sortKeyRanges;Fe<Ye.length;Fe+=1){var ot=Ye[Fe];u.push({sortKey:ot.sortKey,symbolInstanceStart:ot.symbolInstanceStart,symbolInstanceEnd:ot.symbolInstanceEnd,parameters:ze})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:k.symbolInstances.length,parameters:ze})}},Kn.prototype.attemptAnchorPlacement=function(u,m,p,v,k,L,B,j,Y,ie,he,de,me,Ce,Te){var Le,xe=[de.textOffset0,de.textOffset1],ze=xn(u,p,v,xe,k),Fe=this.collisionIndex.placeCollisionBox(jo(m,ze.x,ze.y,L,B,this.transform.angle),he,j,Y,ie.predicate);if(!Te||this.collisionIndex.placeCollisionBox(jo(Te,ze.x,ze.y,L,B,this.transform.angle),he,j,Y,ie.predicate).box.length!==0)return Fe.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[de.crossTileID]&&this.prevPlacement.placements[de.crossTileID]&&this.prevPlacement.placements[de.crossTileID].text&&(Le=this.prevPlacement.variableOffsets[de.crossTileID].anchor),this.variableOffsets[de.crossTileID]={textOffset:xe,width:p,height:v,anchor:u,textBoxScale:k,prevAnchor:Le},this.markUsedJustification(me,u,de,Ce),me.allowVerticalPlacement&&(this.markUsedOrientation(me,Ce,de),this.placedOrientations[de.crossTileID]=Ce),{shift:ze,placedGlyphBoxes:Fe}):void 0},Kn.prototype.placeLayerBucketPart=function(u,m,p){var v=this,k=u.parameters,L=k.bucket,B=k.layout,j=k.posMatrix,Y=k.textLabelPlaneMatrix,ie=k.labelToScreenMatrix,he=k.textPixelRatio,de=k.holdingForFade,me=k.collisionBoxArray,Ce=k.partiallyEvaluatedTextSize,Te=k.collisionGroup,Le=B.get("text-optional"),xe=B.get("icon-optional"),ze=B.get("text-allow-overlap"),Fe=B.get("icon-allow-overlap"),Ye=B.get("text-rotation-alignment")==="map",ot=B.get("text-pitch-alignment")==="map",at=B.get("icon-text-fit")!=="none",st=B.get("symbol-z-order")==="viewport-y",It=ze&&(Fe||!L.hasIconData()||xe),Lt=Fe&&(ze||!L.hasTextData()||Le);!L.collisionArrays&&me&&L.deserializeCollisionBoxes(me);var Mt=function(ri,Di){if(!m[ri.crossTileID])if(de)v.placements[ri.crossTileID]=new Yu(!1,!1,!1);else{var er,zi=!1,Ai=!1,ji=!0,wi=null,gi={box:null,offscreen:null},hn={box:null,offscreen:null},En=null,Ln=null,yo=0,yn=0,lr=0;Di.textFeatureIndex?yo=Di.textFeatureIndex:ri.useRuntimeCollisionCircles&&(yo=ri.featureIndex),Di.verticalTextFeatureIndex&&(yn=Di.verticalTextFeatureIndex);var Ho=Di.textBox;if(Ho){var Oo=function(gr){var Wo=f.WritingMode.horizontal;if(L.allowVerticalPlacement&&!gr&&v.prevPlacement){var sa=v.prevPlacement.placedOrientations[ri.crossTileID];sa&&(v.placedOrientations[ri.crossTileID]=sa,v.markUsedOrientation(L,Wo=sa,ri))}return Wo},_a=function(gr,Wo){if(L.allowVerticalPlacement&&ri.numVerticalGlyphVertices>0&&Di.verticalTextBox)for(var sa=0,ru=L.writingModes;sa<ru.length&&(ru[sa]===f.WritingMode.vertical?(gi=Wo(),hn=gi):gi=gr(),!(gi&&gi.box&&gi.box.length));sa+=1);else gi=gr()};if(B.get("text-variable-anchor")){var Jn=B.get("text-variable-anchor");if(v.prevPlacement&&v.prevPlacement.variableOffsets[ri.crossTileID]){var va=v.prevPlacement.variableOffsets[ri.crossTileID];Jn.indexOf(va.anchor)>0&&(Jn=Jn.filter(function(gr){return gr!==va.anchor})).unshift(va.anchor)}var xa=function(gr,Wo,sa){for(var ru=gr.x2-gr.x1,Du=gr.y2-gr.y1,Ru=ri.textBoxScale,tp=at&&!Fe?Wo:null,il={box:[],offscreen:!1},ip=ze?2*Jn.length:Jn.length,rl=0;rl<ip;++rl){var cc=v.attemptAnchorPlacement(Jn[rl%Jn.length],gr,ru,Du,Ru,Ye,ot,he,j,Te,rl>=Jn.length,ri,L,sa,tp);if(cc&&(il=cc.placedGlyphBoxes)&&il.box&&il.box.length){zi=!0,wi=cc.shift;break}}return il};_a(function(){return xa(Ho,Di.iconBox,f.WritingMode.horizontal)},function(){var gr=Di.verticalTextBox;return L.allowVerticalPlacement&&!(gi&&gi.box&&gi.box.length)&&ri.numVerticalGlyphVertices>0&&gr?xa(gr,Di.verticalIconBox,f.WritingMode.vertical):{box:null,offscreen:null}}),gi&&(zi=gi.box,ji=gi.offscreen);var Pu=Oo(gi&&gi.box);if(!zi&&v.prevPlacement){var Mu=v.prevPlacement.variableOffsets[ri.crossTileID];Mu&&(v.variableOffsets[ri.crossTileID]=Mu,v.markUsedJustification(L,Mu.anchor,ri,Pu))}}else{var tl=function(gr,Wo){var sa=v.collisionIndex.placeCollisionBox(gr,ze,he,j,Te.predicate);return sa&&sa.box&&sa.box.length&&(v.markUsedOrientation(L,Wo,ri),v.placedOrientations[ri.crossTileID]=Wo),sa};_a(function(){return tl(Ho,f.WritingMode.horizontal)},function(){var gr=Di.verticalTextBox;return L.allowVerticalPlacement&&ri.numVerticalGlyphVertices>0&&gr?tl(gr,f.WritingMode.vertical):{box:null,offscreen:null}}),Oo(gi&&gi.box&&gi.box.length)}}if(zi=(er=gi)&&er.box&&er.box.length>0,ji=er&&er.offscreen,ri.useRuntimeCollisionCircles){var Lu=L.text.placedSymbolArray.get(ri.centerJustifiedTextSymbolIndex),tu=f.evaluateSizeForFeature(L.textSizeData,Ce,Lu),Ps=B.get("text-padding");En=v.collisionIndex.placeCollisionCircles(ze,Lu,L.lineVertexArray,L.glyphOffsetArray,tu,j,Y,ie,p,ot,Te.predicate,ri.collisionCircleDiameter,Ps),zi=ze||En.circles.length>0&&!En.collisionDetected,ji=ji&&En.offscreen}if(Di.iconFeatureIndex&&(lr=Di.iconFeatureIndex),Di.iconBox){var iu=function(gr){var Wo=at&&wi?jo(gr,wi.x,wi.y,Ye,ot,v.transform.angle):gr;return v.collisionIndex.placeCollisionBox(Wo,Fe,he,j,Te.predicate)};Ai=hn&&hn.box&&hn.box.length&&Di.verticalIconBox?(Ln=iu(Di.verticalIconBox)).box.length>0:(Ln=iu(Di.iconBox)).box.length>0,ji=ji&&Ln.offscreen}var ds=Le||ri.numHorizontalGlyphVertices===0&&ri.numVerticalGlyphVertices===0,Yn=xe||ri.numIconVertices===0;if(ds||Yn?Yn?ds||(Ai=Ai&&zi):zi=Ai&&zi:Ai=zi=Ai&&zi,zi&&er&&er.box&&v.collisionIndex.insertCollisionBox(er.box,B.get("text-ignore-placement"),L.bucketInstanceId,hn&&hn.box&&yn?yn:yo,Te.ID),Ai&&Ln&&v.collisionIndex.insertCollisionBox(Ln.box,B.get("icon-ignore-placement"),L.bucketInstanceId,lr,Te.ID),En&&(zi&&v.collisionIndex.insertCollisionCircles(En.circles,B.get("text-ignore-placement"),L.bucketInstanceId,yo,Te.ID),p)){var ba=L.bucketInstanceId,Tl=v.collisionCircleArrays[ba];Tl===void 0&&(Tl=v.collisionCircleArrays[ba]=new ra);for(var fs=0;fs<En.circles.length;fs+=4)Tl.circles.push(En.circles[fs+0]),Tl.circles.push(En.circles[fs+1]),Tl.circles.push(En.circles[fs+2]),Tl.circles.push(En.collisionDetected?1:0)}v.placements[ri.crossTileID]=new Yu(zi||It,Ai||Lt,ji||L.justReloaded),m[ri.crossTileID]=!0}};if(st)for(var Yt=L.getSortedSymbolIndexes(this.transform.angle),di=Yt.length-1;di>=0;--di){var _i=Yt[di];Mt(L.symbolInstances.get(_i),L.collisionArrays[_i])}else for(var hi=u.symbolInstanceStart;hi<u.symbolInstanceEnd;hi++)Mt(L.symbolInstances.get(hi),L.collisionArrays[hi]);if(p&&L.bucketInstanceId in this.collisionCircleArrays){var ar=this.collisionCircleArrays[L.bucketInstanceId];f.invert(ar.invProjMatrix,j),ar.viewportMatrix=this.collisionIndex.getViewportMatrix()}L.justReloaded=!1},Kn.prototype.markUsedJustification=function(u,m,p,v){var k;k=v===f.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[f.getAnchorJustification(m)];for(var L=0,B=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];L<B.length;L+=1){var j=B[L];j>=0&&(u.text.placedSymbolArray.get(j).crossTileID=k>=0&&j!==k?0:p.crossTileID)}},Kn.prototype.markUsedOrientation=function(u,m,p){for(var v=m===f.WritingMode.horizontal||m===f.WritingMode.horizontalOnly?m:0,k=m===f.WritingMode.vertical?m:0,L=0,B=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];L<B.length;L+=1)u.text.placedSymbolArray.get(B[L]).placedOrientation=v;p.verticalPlacedTextSymbolIndex&&(u.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=k)},Kn.prototype.commit=function(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;var m=this.prevPlacement,p=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;var v=m?m.symbolFadeChange(u):1,k=m?m.opacities:{},L=m?m.variableOffsets:{},B=m?m.placedOrientations:{};for(var j in this.placements){var Y=this.placements[j],ie=k[j];ie?(this.opacities[j]=new Do(ie,v,Y.text,Y.icon),p=p||Y.text!==ie.text.placed||Y.icon!==ie.icon.placed):(this.opacities[j]=new Do(null,v,Y.text,Y.icon,Y.skipFade),p=p||Y.text||Y.icon)}for(var he in k){var de=k[he];if(!this.opacities[he]){var me=new Do(de,v,!1,!1);me.isHidden()||(this.opacities[he]=me,p=p||de.text.placed||de.icon.placed)}}for(var Ce in L)this.variableOffsets[Ce]||!this.opacities[Ce]||this.opacities[Ce].isHidden()||(this.variableOffsets[Ce]=L[Ce]);for(var Te in B)this.placedOrientations[Te]||!this.opacities[Te]||this.opacities[Te].isHidden()||(this.placedOrientations[Te]=B[Te]);p?this.lastPlacementChangeTime=u:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:u)},Kn.prototype.updateLayerOpacities=function(u,m){for(var p={},v=0,k=m;v<k.length;v+=1){var L=k[v],B=L.getBucket(u);B&&L.latestFeatureIndex&&u.id===B.layerIds[0]&&this.updateBucketOpacities(B,p,L.collisionBoxArray)}},Kn.prototype.updateBucketOpacities=function(u,m,p){var v=this;u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();var k=u.layers[0].layout,L=new Do(null,0,!1,!1,!0),B=k.get("text-allow-overlap"),j=k.get("icon-allow-overlap"),Y=k.get("text-variable-anchor"),ie=k.get("text-rotation-alignment")==="map",he=k.get("text-pitch-alignment")==="map",de=k.get("icon-text-fit")!=="none",me=new Do(null,0,B&&(j||!u.hasIconData()||k.get("icon-optional")),j&&(B||!u.hasTextData()||k.get("text-optional")),!0);!u.collisionArrays&&p&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(p);for(var Ce=function(ze,Fe,Ye){for(var ot=0;ot<Fe/4;ot++)ze.opacityVertexArray.emplaceBack(Ye)},Te=function(ze){var Fe=u.symbolInstances.get(ze),Ye=Fe.numHorizontalGlyphVertices,ot=Fe.numVerticalGlyphVertices,at=Fe.crossTileID,st=v.opacities[at];m[at]?st=L:st||(v.opacities[at]=st=me),m[at]=!0;var It=Fe.numIconVertices>0,Lt=v.placedOrientations[Fe.crossTileID],Mt=Lt===f.WritingMode.vertical,Yt=Lt===f.WritingMode.horizontal||Lt===f.WritingMode.horizontalOnly;if(Ye>0||ot>0){var di=ec(st.text);Ce(u.text,Ye,Mt?Qa:di),Ce(u.text,ot,Yt?Qa:di);var _i=st.text.isHidden();[Fe.rightJustifiedTextSymbolIndex,Fe.centerJustifiedTextSymbolIndex,Fe.leftJustifiedTextSymbolIndex].forEach(function(gi){gi>=0&&(u.text.placedSymbolArray.get(gi).hidden=_i||Mt?1:0)}),Fe.verticalPlacedTextSymbolIndex>=0&&(u.text.placedSymbolArray.get(Fe.verticalPlacedTextSymbolIndex).hidden=_i||Yt?1:0);var hi=v.variableOffsets[Fe.crossTileID];hi&&v.markUsedJustification(u,hi.anchor,Fe,Lt);var ar=v.placedOrientations[Fe.crossTileID];ar&&(v.markUsedJustification(u,"left",Fe,ar),v.markUsedOrientation(u,ar,Fe))}if(It){var ri=ec(st.icon),Di=!(de&&Fe.verticalPlacedIconSymbolIndex&&Mt);Fe.placedIconSymbolIndex>=0&&(Ce(u.icon,Fe.numIconVertices,Di?ri:Qa),u.icon.placedSymbolArray.get(Fe.placedIconSymbolIndex).hidden=st.icon.isHidden()),Fe.verticalPlacedIconSymbolIndex>=0&&(Ce(u.icon,Fe.numVerticalIconVertices,Di?Qa:ri),u.icon.placedSymbolArray.get(Fe.verticalPlacedIconSymbolIndex).hidden=st.icon.isHidden())}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){var er=u.collisionArrays[ze];if(er){var zi=new f.Point(0,0);if(er.textBox||er.verticalTextBox){var Ai=!0;if(Y){var ji=v.variableOffsets[at];ji?(zi=xn(ji.anchor,ji.width,ji.height,ji.textOffset,ji.textBoxScale),ie&&zi._rotate(he?v.transform.angle:-v.transform.angle)):Ai=!1}er.textBox&&Ba(u.textCollisionBox.collisionVertexArray,st.text.placed,!Ai||Mt,zi.x,zi.y),er.verticalTextBox&&Ba(u.textCollisionBox.collisionVertexArray,st.text.placed,!Ai||Yt,zi.x,zi.y)}var wi=Boolean(!Yt&&er.verticalIconBox);er.iconBox&&Ba(u.iconCollisionBox.collisionVertexArray,st.icon.placed,wi,de?zi.x:0,de?zi.y:0),er.verticalIconBox&&Ba(u.iconCollisionBox.collisionVertexArray,st.icon.placed,!wi,de?zi.x:0,de?zi.y:0)}}},Le=0;Le<u.symbolInstances.length;Le++)Te(Le);if(u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){var xe=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=xe.invProjMatrix,u.placementViewportMatrix=xe.viewportMatrix,u.collisionCircleArray=xe.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}},Kn.prototype.symbolFadeChange=function(u){return this.fadeDuration===0?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Kn.prototype.zoomAdjustment=function(u){return Math.max(0,(this.transform.zoom-u)/1.5)},Kn.prototype.hasTransitions=function(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration},Kn.prototype.stillRecent=function(u,m){var p=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*p>u},Kn.prototype.setStale=function(){this.stale=!0};var Bl=Math.pow(2,25),xu=Math.pow(2,24),Gs=Math.pow(2,17),Un=Math.pow(2,16),dl=Math.pow(2,9),$u=Math.pow(2,8),Qu=Math.pow(2,1);function ec(u){if(u.opacity===0&&!u.placed)return 0;if(u.opacity===1&&u.placed)return 4294967295;var m=u.placed?1:0,p=Math.floor(127*u.opacity);return p*Bl+m*xu+p*Gs+m*Un+p*dl+m*$u+p*Qu+m}var Qa=0,Ol=function(u){this._sortAcrossTiles=u.layout.get("symbol-z-order")!=="viewport-y"&&u.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ol.prototype.continuePlacement=function(u,m,p,v,k){for(var L=this._bucketParts;this._currentTileIndex<u.length;)if(m.getBucketParts(L,v,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,k())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort(function(B,j){return B.sortKey-j.sortKey}));this._currentPartIndex<L.length;)if(m.placeLayerBucketPart(L[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,k())return!0;return!1};var Fl=function(u,m,p,v,k,L,B){this.placement=new Kn(u,k,L,B),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=v,this._done=!1};Fl.prototype.isDone=function(){return this._done},Fl.prototype.continuePlacement=function(u,m,p){for(var v=this,k=f.browser.now(),L=function(){var Y=f.browser.now()-k;return!v._forceFullPlacement&&Y>2};this._currentPlacementIndex>=0;){var B=m[u[this._currentPlacementIndex]],j=this.placement.collisionIndex.transform.zoom;if(B.type==="symbol"&&(!B.minzoom||B.minzoom<=j)&&(!B.maxzoom||B.maxzoom>j)){if(this._inProgressLayer||(this._inProgressLayer=new Ol(B)),this._inProgressLayer.continuePlacement(p[B.source],this.placement,this._showCollisionBoxes,B,L))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Fl.prototype.commit=function(u){return this.placement.commit(u),this.placement};var Mc=512/f.EXTENT/2,fl=function(u,m,p){this.tileID=u,this.indexedSymbolInstances={},this.bucketInstanceId=p;for(var v=0;v<m.length;v++){var k=m.get(v),L=k.key;this.indexedSymbolInstances[L]||(this.indexedSymbolInstances[L]=[]),this.indexedSymbolInstances[L].push({crossTileID:k.crossTileID,coord:this.getScaledCoordinates(k,u)})}};fl.prototype.getScaledCoordinates=function(u,m){var p=Mc/Math.pow(2,m.canonical.z-this.tileID.canonical.z);return{x:Math.floor((m.canonical.x*f.EXTENT+u.anchorX)*p),y:Math.floor((m.canonical.y*f.EXTENT+u.anchorY)*p)}},fl.prototype.findMatches=function(u,m,p){for(var v=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z),k=0;k<u.length;k++){var L=u.get(k);if(!L.crossTileID){var B=this.indexedSymbolInstances[L.key];if(B)for(var j=this.getScaledCoordinates(L,m),Y=0,ie=B;Y<ie.length;Y+=1){var he=ie[Y];if(Math.abs(he.coord.x-j.x)<=v&&Math.abs(he.coord.y-j.y)<=v&&!p[he.crossTileID]){p[he.crossTileID]=!0,L.crossTileID=he.crossTileID;break}}}}};var Vo=function(){this.maxCrossTileID=0};Vo.prototype.generate=function(){return++this.maxCrossTileID};var Oa=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Oa.prototype.handleWrapJump=function(u){var m=Math.round((u-this.lng)/360);if(m!==0)for(var p in this.indexes){var v=this.indexes[p],k={};for(var L in v){var B=v[L];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+m),k[B.tileID.key]=B}this.indexes[p]=k}this.lng=u},Oa.prototype.addBucket=function(u,m,p){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(var v=0;v<m.symbolInstances.length;v++)m.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]={});var k=this.usedCrossTileIDs[u.overscaledZ];for(var L in this.indexes){var B=this.indexes[L];if(Number(L)>u.overscaledZ)for(var j in B){var Y=B[j];Y.tileID.isChildOf(u)&&Y.findMatches(m.symbolInstances,u,k)}else{var ie=B[u.scaledTo(Number(L)).key];ie&&ie.findMatches(m.symbolInstances,u,k)}}for(var he=0;he<m.symbolInstances.length;he++){var de=m.symbolInstances.get(he);de.crossTileID||(de.crossTileID=p.generate(),k[de.crossTileID]=!0)}return this.indexes[u.overscaledZ]===void 0&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new fl(u,m.symbolInstances,m.bucketInstanceId),!0},Oa.prototype.removeBucketCrossTileIDs=function(u,m){for(var p in m.indexedSymbolInstances)for(var v=0,k=m.indexedSymbolInstances[p];v<k.length;v+=1)delete this.usedCrossTileIDs[u][k[v].crossTileID]},Oa.prototype.removeStaleBuckets=function(u){var m=!1;for(var p in this.indexes){var v=this.indexes[p];for(var k in v)u[v[k].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,v[k]),delete v[k],m=!0)}return m};var Fa=function(){this.layerIndexes={},this.crossTileIDs=new Vo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Fa.prototype.addLayer=function(u,m,p){var v=this.layerIndexes[u.id];v===void 0&&(v=this.layerIndexes[u.id]=new Oa);var k=!1,L={};v.handleWrapJump(p);for(var B=0,j=m;B<j.length;B+=1){var Y=j[B],ie=Y.getBucket(u);ie&&u.id===ie.layerIds[0]&&(ie.bucketInstanceId||(ie.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(Y.tileID,ie,this.crossTileIDs)&&(k=!0),L[ie.bucketInstanceId]=!0)}return v.removeStaleBuckets(L)&&(k=!0),k},Fa.prototype.pruneUnusedLayers=function(u){var m={};for(var p in u.forEach(function(v){m[v]=!0}),this.layerIndexes)m[p]||delete this.layerIndexes[p]};var xs=function(u,m){return f.emitValidationErrors(u,m&&m.filter(function(p){return p.identifier!=="source.canvas"}))},ur=f.pick(Ie,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),bs=f.pick(Ie,["setCenter","setZoom","setBearing","setPitch"]),ws=function(){var u={},m=f.styleSpec.$version;for(var p in f.styleSpec.$root){var v,k=f.styleSpec.$root[p];k.required&&(v=p==="version"?m:k.type==="array"?[]:{})!=null&&(u[p]=v)}return u}(),ao=function(u){function m(p,v){var k=this;v===void 0&&(v={}),u.call(this),this.map=p,this.dispatcher=new Qt(fe(),this),this.imageManager=new Ge,this.imageManager.setEventedParent(this),this.glyphManager=new Et(p._requestManager,v.localIdeographFontFamily),this.lineAtlas=new Xt(256,512),this.crossTileSymbolIndex=new Fa,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new f.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",f.getReferrer());var L=this;this._rtlTextPluginCallback=m.registerForPluginStateChange(function(B){L.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:B.pluginStatus,pluginURL:B.pluginURL},function(j,Y){if(f.triggerPluginCompletionEvent(j),Y&&Y.every(function(he){return he}))for(var ie in L.sourceCaches)L.sourceCaches[ie].reload()})}),this.on("data",function(B){if(B.dataType==="source"&&B.sourceDataType==="metadata"){var j=k.sourceCaches[B.sourceId];if(j){var Y=j.getSource();if(Y&&Y.vectorLayerIds)for(var ie in k._layers){var he=k._layers[ie];he.source===Y.id&&k._validateLayer(he)}}}})}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.loadURL=function(p,v){var k=this;v===void 0&&(v={}),this.fire(new f.Event("dataloading",{dataType:"style"}));var L=typeof v.validate=="boolean"?v.validate:!f.isMapboxURL(p);p=this.map._requestManager.normalizeStyleURL(p,v.accessToken);var B=this.map._requestManager.transformRequest(p,f.ResourceType.Style);this._request=f.getJSON(B,function(j,Y){k._request=null,j?k.fire(new f.ErrorEvent(j)):Y&&k._load(Y,L)})},m.prototype.loadJSON=function(p,v){var k=this;v===void 0&&(v={}),this.fire(new f.Event("dataloading",{dataType:"style"})),this._request=f.browser.frame(function(){k._request=null,k._load(p,v.validate!==!1)})},m.prototype.loadEmpty=function(){this.fire(new f.Event("dataloading",{dataType:"style"})),this._load(ws,!1)},m.prototype._load=function(p,v){if(!v||!xs(this,f.validateStyle(p))){for(var k in this._loaded=!0,this.stylesheet=p,p.sources)this.addSource(k,p.sources[k],{validate:!1});p.sprite?this._loadSprite(p.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(p.glyphs);var L=we(this.stylesheet.layers);this._order=L.map(function(ie){return ie.id}),this._layers={},this._serializedLayers={};for(var B=0,j=L;B<j.length;B+=1){var Y=j[B];(Y=f.createStyleLayer(Y)).setEventedParent(this,{layer:{id:Y.id}}),this._layers[Y.id]=Y,this._serializedLayers[Y.id]=Y.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new qi(this.stylesheet.light),this.fire(new f.Event("data",{dataType:"style"})),this.fire(new f.Event("style.load"))}},m.prototype._loadSprite=function(p){var v=this;this._spriteRequest=function(k,L,B){var j,Y,ie,he=f.browser.devicePixelRatio>1?"@2x":"",de=f.getJSON(L.transformRequest(L.normalizeSpriteURL(k,he,".json"),f.ResourceType.SpriteJSON),function(Te,Le){de=null,ie||(ie=Te,j=Le,Ce())}),me=f.getImage(L.transformRequest(L.normalizeSpriteURL(k,he,".png"),f.ResourceType.SpriteImage),function(Te,Le){me=null,ie||(ie=Te,Y=Le,Ce())});function Ce(){if(ie)B(ie);else if(j&&Y){var Te=f.browser.getImageData(Y),Le={};for(var xe in j){var ze=j[xe],Fe=ze.width,Ye=ze.height,ot=ze.x,at=ze.y,st=ze.sdf,It=ze.pixelRatio,Lt=ze.stretchX,Mt=ze.stretchY,Yt=ze.content,di=new f.RGBAImage({width:Fe,height:Ye});f.RGBAImage.copy(Te,di,{x:ot,y:at},{x:0,y:0},{width:Fe,height:Ye}),Le[xe]={data:di,pixelRatio:It,sdf:st,stretchX:Lt,stretchY:Mt,content:Yt}}B(null,Le)}}return{cancel:function(){de&&(de.cancel(),de=null),me&&(me.cancel(),me=null)}}}(p,this.map._requestManager,function(k,L){if(v._spriteRequest=null,k)v.fire(new f.ErrorEvent(k));else if(L)for(var B in L)v.imageManager.addImage(B,L[B]);v.imageManager.setLoaded(!0),v._availableImages=v.imageManager.listImages(),v.dispatcher.broadcast("setImages",v._availableImages),v.fire(new f.Event("data",{dataType:"style"}))})},m.prototype._validateLayer=function(p){var v=this.sourceCaches[p.source];if(v){var k=p.sourceLayer;if(k){var L=v.getSource();(L.type==="geojson"||L.vectorLayerIds&&L.vectorLayerIds.indexOf(k)===-1)&&this.fire(new f.ErrorEvent(new Error('Source layer "'+k+'" does not exist on source "'+L.id+'" as specified by style layer "'+p.id+'"')))}}},m.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var p in this.sourceCaches)if(!this.sourceCaches[p].loaded())return!1;return!!this.imageManager.isLoaded()},m.prototype._serializeLayers=function(p){for(var v=[],k=0,L=p;k<L.length;k+=1){var B=this._layers[L[k]];B.type!=="custom"&&v.push(B.serialize())}return v},m.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var p in this.sourceCaches)if(this.sourceCaches[p].hasTransition())return!0;for(var v in this._layers)if(this._layers[v].hasTransition())return!0;return!1},m.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},m.prototype.update=function(p){if(this._loaded){var v=this._changed;if(this._changed){var k=Object.keys(this._updatedLayers),L=Object.keys(this._removedLayers);for(var B in(k.length||L.length)&&this._updateWorkerLayers(k,L),this._updatedSources){var j=this._updatedSources[B];j==="reload"?this._reloadSource(B):j==="clear"&&this._clearSource(B)}for(var Y in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Y].updateTransitions(p);this.light.updateTransitions(p),this._resetUpdates()}var ie={};for(var he in this.sourceCaches){var de=this.sourceCaches[he];ie[he]=de.used,de.used=!1}for(var me=0,Ce=this._order;me<Ce.length;me+=1){var Te=this._layers[Ce[me]];Te.recalculate(p,this._availableImages),!Te.isHidden(p.zoom)&&Te.source&&(this.sourceCaches[Te.source].used=!0)}for(var Le in ie){var xe=this.sourceCaches[Le];ie[Le]!==xe.used&&xe.fire(new f.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Le}))}this.light.recalculate(p),this.z=p.zoom,v&&this.fire(new f.Event("data",{dataType:"style"}))}},m.prototype._updateTilesForChangedImages=function(){var p=Object.keys(this._changedImages);if(p.length){for(var v in this.sourceCaches)this.sourceCaches[v].reloadTilesForDependencies(["icons","patterns"],p);this._changedImages={}}},m.prototype._updateWorkerLayers=function(p,v){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(p),removedIds:v})},m.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},m.prototype.setState=function(p){var v=this;if(this._checkLoaded(),xs(this,f.validateStyle(p)))return!1;(p=f.clone$1(p)).layers=we(p.layers);var k=function(B,j){if(!B)return[{command:Ie.setStyle,args:[j]}];var Y=[];try{if(!f.deepEqual(B.version,j.version))return[{command:Ie.setStyle,args:[j]}];f.deepEqual(B.center,j.center)||Y.push({command:Ie.setCenter,args:[j.center]}),f.deepEqual(B.zoom,j.zoom)||Y.push({command:Ie.setZoom,args:[j.zoom]}),f.deepEqual(B.bearing,j.bearing)||Y.push({command:Ie.setBearing,args:[j.bearing]}),f.deepEqual(B.pitch,j.pitch)||Y.push({command:Ie.setPitch,args:[j.pitch]}),f.deepEqual(B.sprite,j.sprite)||Y.push({command:Ie.setSprite,args:[j.sprite]}),f.deepEqual(B.glyphs,j.glyphs)||Y.push({command:Ie.setGlyphs,args:[j.glyphs]}),f.deepEqual(B.transition,j.transition)||Y.push({command:Ie.setTransition,args:[j.transition]}),f.deepEqual(B.light,j.light)||Y.push({command:Ie.setLight,args:[j.light]});var ie={},he=[];(function(me,Ce,Te,Le){var xe;for(xe in Ce=Ce||{},me=me||{})me.hasOwnProperty(xe)&&(Ce.hasOwnProperty(xe)||Ke(xe,Te,Le));for(xe in Ce)Ce.hasOwnProperty(xe)&&(me.hasOwnProperty(xe)?f.deepEqual(me[xe],Ce[xe])||(me[xe].type==="geojson"&&Ce[xe].type==="geojson"&&Ft(me,Ce,xe)?Te.push({command:Ie.setGeoJSONSourceData,args:[xe,Ce[xe].data]}):tt(xe,Ce,Te,Le)):et(xe,Ce,Te))})(B.sources,j.sources,he,ie);var de=[];B.layers&&B.layers.forEach(function(me){ie[me.source]?Y.push({command:Ie.removeLayer,args:[me.id]}):de.push(me)}),Y=Y.concat(he),function(me,Ce,Te){Ce=Ce||[];var Le,xe,ze,Fe,Ye,ot,at,st=(me=me||[]).map(Bt),It=Ce.map(Bt),Lt=me.reduce(jt,{}),Mt=Ce.reduce(jt,{}),Yt=st.slice(),di=Object.create(null);for(Le=0,xe=0;Le<st.length;Le++)Mt.hasOwnProperty(ze=st[Le])?xe++:(Te.push({command:Ie.removeLayer,args:[ze]}),Yt.splice(Yt.indexOf(ze,xe),1));for(Le=0,xe=0;Le<It.length;Le++)Yt[Yt.length-1-Le]!==(ze=It[It.length-1-Le])&&(Lt.hasOwnProperty(ze)?(Te.push({command:Ie.removeLayer,args:[ze]}),Yt.splice(Yt.lastIndexOf(ze,Yt.length-xe),1)):xe++,Te.push({command:Ie.addLayer,args:[Mt[ze],ot=Yt[Yt.length-Le]]}),Yt.splice(Yt.length-Le,0,ze),di[ze]=!0);for(Le=0;Le<It.length;Le++)if(Fe=Lt[ze=It[Le]],Ye=Mt[ze],!di[ze]&&!f.deepEqual(Fe,Ye))if(f.deepEqual(Fe.source,Ye.source)&&f.deepEqual(Fe["source-layer"],Ye["source-layer"])&&f.deepEqual(Fe.type,Ye.type)){for(at in At(Fe.layout,Ye.layout,Te,ze,null,Ie.setLayoutProperty),At(Fe.paint,Ye.paint,Te,ze,null,Ie.setPaintProperty),f.deepEqual(Fe.filter,Ye.filter)||Te.push({command:Ie.setFilter,args:[ze,Ye.filter]}),f.deepEqual(Fe.minzoom,Ye.minzoom)&&f.deepEqual(Fe.maxzoom,Ye.maxzoom)||Te.push({command:Ie.setLayerZoomRange,args:[ze,Ye.minzoom,Ye.maxzoom]}),Fe)Fe.hasOwnProperty(at)&&at!=="layout"&&at!=="paint"&&at!=="filter"&&at!=="metadata"&&at!=="minzoom"&&at!=="maxzoom"&&(at.indexOf("paint.")===0?At(Fe[at],Ye[at],Te,ze,at.slice(6),Ie.setPaintProperty):f.deepEqual(Fe[at],Ye[at])||Te.push({command:Ie.setLayerProperty,args:[ze,at,Ye[at]]}));for(at in Ye)Ye.hasOwnProperty(at)&&!Fe.hasOwnProperty(at)&&at!=="layout"&&at!=="paint"&&at!=="filter"&&at!=="metadata"&&at!=="minzoom"&&at!=="maxzoom"&&(at.indexOf("paint.")===0?At(Fe[at],Ye[at],Te,ze,at.slice(6),Ie.setPaintProperty):f.deepEqual(Fe[at],Ye[at])||Te.push({command:Ie.setLayerProperty,args:[ze,at,Ye[at]]}))}else Te.push({command:Ie.removeLayer,args:[ze]}),ot=Yt[Yt.lastIndexOf(ze)+1],Te.push({command:Ie.addLayer,args:[Ye,ot]})}(de,j.layers,Y)}catch(me){console.warn("Unable to compute style diff:",me),Y=[{command:Ie.setStyle,args:[j]}]}return Y}(this.serialize(),p).filter(function(B){return!(B.command in bs)});if(k.length===0)return!1;var L=k.filter(function(B){return!(B.command in ur)});if(L.length>0)throw new Error("Unimplemented: "+L.map(function(B){return B.command}).join(", ")+".");return k.forEach(function(B){B.command!=="setTransition"&&v[B.command].apply(v,B.args)}),this.stylesheet=p,!0},m.prototype.addImage=function(p,v){if(this.getImage(p))return this.fire(new f.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(p,v),this._afterImageUpdated(p)},m.prototype.updateImage=function(p,v){this.imageManager.updateImage(p,v)},m.prototype.getImage=function(p){return this.imageManager.getImage(p)},m.prototype.removeImage=function(p){if(!this.getImage(p))return this.fire(new f.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(p),this._afterImageUpdated(p)},m.prototype._afterImageUpdated=function(p){this._availableImages=this.imageManager.listImages(),this._changedImages[p]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new f.Event("data",{dataType:"style"}))},m.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},m.prototype.addSource=function(p,v,k){var L=this;if(k===void 0&&(k={}),this._checkLoaded(),this.sourceCaches[p]!==void 0)throw new Error("There is already a source with this ID");if(!v.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(v).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(v.type)>=0&&this._validate(f.validateStyle.source,"sources."+p,v,null,k))){this.map&&this.map._collectResourceTiming&&(v.collectResourceTiming=!0);var B=this.sourceCaches[p]=new Pe(p,v,this.dispatcher);B.style=this,B.setEventedParent(this,function(){return{isSourceLoaded:L.loaded(),source:B.serialize(),sourceId:p}}),B.onAdd(this.map),this._changed=!0}},m.prototype.removeSource=function(p){if(this._checkLoaded(),this.sourceCaches[p]===void 0)throw new Error("There is no source with this ID");for(var v in this._layers)if(this._layers[v].source===p)return this.fire(new f.ErrorEvent(new Error('Source "'+p+'" cannot be removed while layer "'+v+'" is using it.')));var k=this.sourceCaches[p];delete this.sourceCaches[p],delete this._updatedSources[p],k.fire(new f.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:p})),k.setEventedParent(null),k.clearTiles(),k.onRemove&&k.onRemove(this.map),this._changed=!0},m.prototype.setGeoJSONSourceData=function(p,v){this._checkLoaded(),this.sourceCaches[p].getSource().setData(v),this._changed=!0},m.prototype.getSource=function(p){return this.sourceCaches[p]&&this.sourceCaches[p].getSource()},m.prototype.addLayer=function(p,v,k){k===void 0&&(k={}),this._checkLoaded();var L=p.id;if(this.getLayer(L))this.fire(new f.ErrorEvent(new Error('Layer with id "'+L+'" already exists on this map')));else{var B;if(p.type==="custom"){if(xs(this,f.validateCustomStyleLayer(p)))return;B=f.createStyleLayer(p)}else{if(typeof p.source=="object"&&(this.addSource(L,p.source),p=f.clone$1(p),p=f.extend(p,{source:L})),this._validate(f.validateStyle.layer,"layers."+L,p,{arrayIndex:-1},k))return;B=f.createStyleLayer(p),this._validateLayer(B),B.setEventedParent(this,{layer:{id:L}}),this._serializedLayers[B.id]=B.serialize()}var j=v?this._order.indexOf(v):this._order.length;if(v&&j===-1)this.fire(new f.ErrorEvent(new Error('Layer with id "'+v+'" does not exist on this map.')));else{if(this._order.splice(j,0,L),this._layerOrderChanged=!0,this._layers[L]=B,this._removedLayers[L]&&B.source&&B.type!=="custom"){var Y=this._removedLayers[L];delete this._removedLayers[L],Y.type!==B.type?this._updatedSources[B.source]="clear":(this._updatedSources[B.source]="reload",this.sourceCaches[B.source].pause())}this._updateLayer(B),B.onAdd&&B.onAdd(this.map)}}},m.prototype.moveLayer=function(p,v){if(this._checkLoaded(),this._changed=!0,this._layers[p]){if(p!==v){var k=this._order.indexOf(p);this._order.splice(k,1);var L=v?this._order.indexOf(v):this._order.length;v&&L===-1?this.fire(new f.ErrorEvent(new Error('Layer with id "'+v+'" does not exist on this map.'))):(this._order.splice(L,0,p),this._layerOrderChanged=!0)}}else this.fire(new f.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be moved.")))},m.prototype.removeLayer=function(p){this._checkLoaded();var v=this._layers[p];if(v){v.setEventedParent(null);var k=this._order.indexOf(p);this._order.splice(k,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[p]=v,delete this._layers[p],delete this._serializedLayers[p],delete this._updatedLayers[p],delete this._updatedPaintProps[p],v.onRemove&&v.onRemove(this.map)}else this.fire(new f.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be removed.")))},m.prototype.getLayer=function(p){return this._layers[p]},m.prototype.hasLayer=function(p){return p in this._layers},m.prototype.setLayerZoomRange=function(p,v,k){this._checkLoaded();var L=this.getLayer(p);L?L.minzoom===v&&L.maxzoom===k||(v!=null&&(L.minzoom=v),k!=null&&(L.maxzoom=k),this._updateLayer(L)):this.fire(new f.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot have zoom extent.")))},m.prototype.setFilter=function(p,v,k){k===void 0&&(k={}),this._checkLoaded();var L=this.getLayer(p);if(L){if(!f.deepEqual(L.filter,v))return v==null?(L.filter=void 0,void this._updateLayer(L)):void(this._validate(f.validateStyle.filter,"layers."+L.id+".filter",v,null,k)||(L.filter=f.clone$1(v),this._updateLayer(L)))}else this.fire(new f.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be filtered.")))},m.prototype.getFilter=function(p){return f.clone$1(this.getLayer(p).filter)},m.prototype.setLayoutProperty=function(p,v,k,L){L===void 0&&(L={}),this._checkLoaded();var B=this.getLayer(p);B?f.deepEqual(B.getLayoutProperty(v),k)||(B.setLayoutProperty(v,k,L),this._updateLayer(B)):this.fire(new f.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be styled.")))},m.prototype.getLayoutProperty=function(p,v){var k=this.getLayer(p);if(k)return k.getLayoutProperty(v);this.fire(new f.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style.")))},m.prototype.setPaintProperty=function(p,v,k,L){L===void 0&&(L={}),this._checkLoaded();var B=this.getLayer(p);B?f.deepEqual(B.getPaintProperty(v),k)||(B.setPaintProperty(v,k,L)&&this._updateLayer(B),this._changed=!0,this._updatedPaintProps[p]=!0):this.fire(new f.ErrorEvent(new Error("The layer '"+p+"' does not exist in the map's style and cannot be styled.")))},m.prototype.getPaintProperty=function(p,v){return this.getLayer(p).getPaintProperty(v)},m.prototype.setFeatureState=function(p,v){this._checkLoaded();var k=p.source,L=p.sourceLayer,B=this.sourceCaches[k];if(B!==void 0){var j=B.getSource().type;j==="geojson"&&L?this.fire(new f.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):j!=="vector"||L?(p.id===void 0&&this.fire(new f.ErrorEvent(new Error("The feature id parameter must be provided."))),B.setFeatureState(L,p.id,v)):this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new f.ErrorEvent(new Error("The source '"+k+"' does not exist in the map's style.")))},m.prototype.removeFeatureState=function(p,v){this._checkLoaded();var k=p.source,L=this.sourceCaches[k];if(L!==void 0){var B=L.getSource().type,j=B==="vector"?p.sourceLayer:void 0;B!=="vector"||j?v&&typeof p.id!="string"&&typeof p.id!="number"?this.fire(new f.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):L.removeFeatureState(j,p.id,v):this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new f.ErrorEvent(new Error("The source '"+k+"' does not exist in the map's style.")))},m.prototype.getFeatureState=function(p){this._checkLoaded();var v=p.source,k=p.sourceLayer,L=this.sourceCaches[v];if(L!==void 0){if(L.getSource().type!=="vector"||k)return p.id===void 0&&this.fire(new f.ErrorEvent(new Error("The feature id parameter must be provided."))),L.getFeatureState(k,p.id);this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new f.ErrorEvent(new Error("The source '"+v+"' does not exist in the map's style.")))},m.prototype.getTransition=function(){return f.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},m.prototype.serialize=function(){return f.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:f.mapObject(this.sourceCaches,function(p){return p.serialize()}),layers:this._serializeLayers(this._order)},function(p){return p!==void 0})},m.prototype._updateLayer=function(p){this._updatedLayers[p.id]=!0,p.source&&!this._updatedSources[p.source]&&this.sourceCaches[p.source].getSource().type!=="raster"&&(this._updatedSources[p.source]="reload",this.sourceCaches[p.source].pause()),this._changed=!0},m.prototype._flattenAndSortRenderedFeatures=function(p){for(var v=this,k=function(Lt){return v._layers[Lt].type==="fill-extrusion"},L={},B=[],j=this._order.length-1;j>=0;j--){var Y=this._order[j];if(k(Y)){L[Y]=j;for(var ie=0,he=p;ie<he.length;ie+=1){var de=he[ie][Y];if(de)for(var me=0,Ce=de;me<Ce.length;me+=1)B.push(Ce[me])}}}B.sort(function(Lt,Mt){return Mt.intersectionZ-Lt.intersectionZ});for(var Te=[],Le=this._order.length-1;Le>=0;Le--){var xe=this._order[Le];if(k(xe))for(var ze=B.length-1;ze>=0;ze--){var Fe=B[ze].feature;if(L[Fe.layer.id]<Le)break;Te.push(Fe),B.pop()}else for(var Ye=0,ot=p;Ye<ot.length;Ye+=1){var at=ot[Ye][xe];if(at)for(var st=0,It=at;st<It.length;st+=1)Te.push(It[st].feature)}}return Te},m.prototype.queryRenderedFeatures=function(p,v,k){v&&v.filter&&this._validate(f.validateStyle.filter,"queryRenderedFeatures.filter",v.filter,null,v);var L={};if(v&&v.layers){if(!Array.isArray(v.layers))return this.fire(new f.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var B=0,j=v.layers;B<j.length;B+=1){var Y=j[B],ie=this._layers[Y];if(!ie)return this.fire(new f.ErrorEvent(new Error("The layer '"+Y+"' does not exist in the map's style and cannot be queried for features."))),[];L[ie.source]=!0}}var he=[];for(var de in v.availableImages=this._availableImages,this.sourceCaches)v.layers&&!L[de]||he.push(xi(this.sourceCaches[de],this._layers,this._serializedLayers,p,v,k));return this.placement&&he.push(function(me,Ce,Te,Le,xe,ze,Fe){for(var Ye={},ot=ze.queryRenderedSymbols(Le),at=[],st=0,It=Object.keys(ot).map(Number);st<It.length;st+=1)at.push(Fe[It[st]]);at.sort(rr);for(var Lt=function(){var hi=Yt[Mt],ar=hi.featureIndex.lookupSymbolFeatures(ot[hi.bucketInstanceId],Ce,hi.bucketIndex,hi.sourceLayerIndex,xe.filter,xe.layers,xe.availableImages,me);for(var ri in ar){var Di=Ye[ri]=Ye[ri]||[],er=ar[ri];er.sort(function(ji,wi){var gi=hi.featureSortOrder;if(gi){var hn=gi.indexOf(ji.featureIndex);return gi.indexOf(wi.featureIndex)-hn}return wi.featureIndex-ji.featureIndex});for(var zi=0,Ai=er;zi<Ai.length;zi+=1)Di.push(Ai[zi])}},Mt=0,Yt=at;Mt<Yt.length;Mt+=1)Lt();var di=function(hi){Ye[hi].forEach(function(ar){var ri=ar.feature,Di=Te[me[hi].source].getFeatureState(ri.layer["source-layer"],ri.id);ri.source=ri.layer.source,ri.layer["source-layer"]&&(ri.sourceLayer=ri.layer["source-layer"]),ri.state=Di})};for(var _i in Ye)di(_i);return Ye}(this._layers,this._serializedLayers,this.sourceCaches,p,v,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(he)},m.prototype.querySourceFeatures=function(p,v){v&&v.filter&&this._validate(f.validateStyle.filter,"querySourceFeatures.filter",v.filter,null,v);var k=this.sourceCaches[p];return k?function(L,B){for(var j=L.getRenderableIds().map(function(Ce){return L.getTileByID(Ce)}),Y=[],ie={},he=0;he<j.length;he++){var de=j[he],me=de.tileID.canonical.key;ie[me]||(ie[me]=!0,de.querySourceFeatures(Y,B))}return Y}(k,v):[]},m.prototype.addSourceType=function(p,v,k){return m.getSourceType(p)?k(new Error('A source type called "'+p+'" already exists.')):(m.setSourceType(p,v),v.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:p,url:v.workerSourceURL},k):k(null,null))},m.prototype.getLight=function(){return this.light.getLight()},m.prototype.setLight=function(p,v){v===void 0&&(v={}),this._checkLoaded();var k=this.light.getLight(),L=!1;for(var B in p)if(!f.deepEqual(p[B],k[B])){L=!0;break}if(L){var j={now:f.browser.now(),transition:f.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(p,v),this.light.updateTransitions(j)}},m.prototype._validate=function(p,v,k,L,B){return B===void 0&&(B={}),(!B||B.validate!==!1)&&xs(this,p.call(f.validateStyle,f.extend({key:v,style:this.serialize(),value:k,styleSpec:f.styleSpec},L)))},m.prototype._remove=function(){for(var p in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),f.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[p].setEventedParent(null);for(var v in this.sourceCaches)this.sourceCaches[v].clearTiles(),this.sourceCaches[v].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},m.prototype._clearSource=function(p){this.sourceCaches[p].clearTiles()},m.prototype._reloadSource=function(p){this.sourceCaches[p].resume(),this.sourceCaches[p].reload()},m.prototype._updateSources=function(p){for(var v in this.sourceCaches)this.sourceCaches[v].update(p)},m.prototype._generateCollisionBoxes=function(){for(var p in this.sourceCaches)this._reloadSource(p)},m.prototype._updatePlacement=function(p,v,k,L,B){B===void 0&&(B=!1);for(var j=!1,Y=!1,ie={},he=0,de=this._order;he<de.length;he+=1){var me=this._layers[de[he]];if(me.type==="symbol"){if(!ie[me.source]){var Ce=this.sourceCaches[me.source];ie[me.source]=Ce.getRenderableIds(!0).map(function(Fe){return Ce.getTileByID(Fe)}).sort(function(Fe,Ye){return Ye.tileID.overscaledZ-Fe.tileID.overscaledZ||(Fe.tileID.isLessThan(Ye.tileID)?-1:1)})}var Te=this.crossTileSymbolIndex.addLayer(me,ie[me.source],p.center.lng);j=j||Te}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((B=B||this._layerOrderChanged||k===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(f.browser.now(),p.zoom))&&(this.pauseablePlacement=new Fl(p,this._order,B,v,k,L,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,ie),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(f.browser.now()),Y=!0),j&&this.pauseablePlacement.placement.setStale()),Y||j)for(var Le=0,xe=this._order;Le<xe.length;Le+=1){var ze=this._layers[xe[Le]];ze.type==="symbol"&&this.placement.updateLayerOpacities(ze,ie[ze.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(f.browser.now())},m.prototype._releaseSymbolFadeTiles=function(){for(var p in this.sourceCaches)this.sourceCaches[p].releaseSymbolFadeTiles()},m.prototype.getImages=function(p,v,k){this.imageManager.getImages(v.icons,k),this._updateTilesForChangedImages();var L=this.sourceCaches[v.source];L&&L.setDependencies(v.tileID.key,v.type,v.icons)},m.prototype.getGlyphs=function(p,v,k){this.glyphManager.getGlyphs(v.stacks,k)},m.prototype.getResource=function(p,v,k){return f.makeRequest(v,k)},m}(f.Evented);ao.getSourceType=function(u){return Xi[u]},ao.setSourceType=function(u,m){Xi[u]=m},ao.registerForPluginStateChange=f.registerForPluginStateChange;var bn=f.createLayout([{name:"a_pos",type:"Int16",components:2}]),so=Br(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),bu=Br(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),wu=Br(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Eu=Br(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Ul=Br("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Nl=Br(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),ml=Br(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),jl=Br("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Iu=Br("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Vl=Br("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Lc=Br(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),yl=Br(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ua=Br(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Dc=Br(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),lo=Br(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),tc=Br(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Es=Br(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Is=Br(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Zs=Br(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),es=Br(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Na=Br(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),ya=Br(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Ss=Br(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ts=Br(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Su=Br(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Ts=Br(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Br(u,m){var p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,v=m.match(/attribute ([\w]+) ([\w]+)/g),k=u.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),B=L?L.concat(k):k,j={};return{fragmentSource:u=u.replace(p,function(Y,ie,he,de,me){return j[me]=!0,ie==="define"?`
#ifndef HAS_UNIFORM_u_`+me+`
varying `+he+" "+de+" "+me+`;
#else
uniform `+he+" "+de+" u_"+me+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+me+`
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`}),vertexSource:m=m.replace(p,function(Y,ie,he,de,me){var Ce=de==="float"?"vec2":"vec4",Te=me.match(/color/)?"color":Ce;return j[me]?ie==="define"?`
#ifndef HAS_UNIFORM_u_`+me+`
uniform lowp float u_`+me+`_t;
attribute `+he+" "+Ce+" a_"+me+`;
varying `+he+" "+de+" "+me+`;
#else
uniform `+he+" "+de+" u_"+me+`;
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+me+`
    `+me+" = a_"+me+`;
#else
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+me+`
    `+me+" = unpack_mix_"+Te+"(a_"+me+", u_"+me+`_t);
#else
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`:ie==="define"?`
#ifndef HAS_UNIFORM_u_`+me+`
uniform lowp float u_`+me+`_t;
attribute `+he+" "+Ce+" a_"+me+`;
#else
uniform `+he+" "+de+" u_"+me+`;
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+me+`
    `+he+" "+de+" "+me+" = a_"+me+`;
#else
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+me+`
    `+he+" "+de+" "+me+" = unpack_mix_"+Te+"(a_"+me+", u_"+me+`_t);
#else
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`}),staticAttributes:v,staticUniforms:B}}var Hs=Object.freeze({__proto__:null,prelude:so,background:bu,backgroundPattern:wu,circle:Eu,clippingMask:Ul,heatmap:Nl,heatmapTexture:ml,collisionBox:jl,collisionCircle:Iu,debug:Vl,fill:Lc,fillOutline:yl,fillOutlinePattern:Ua,fillPattern:Dc,fillExtrusion:lo,fillExtrusionPattern:tc,hillshadePrepare:Es,hillshade:Is,line:Zs,lineGradient:es,linePattern:Na,lineSDF:ya,raster:Ss,symbolIcon:ts,symbolSDF:Su,symbolTextAndIcon:Ts}),is=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function ic(u){for(var m=[],p=0;p<u.length;p++)if(u[p]!==null){var v=u[p].split(" ");m.push(v.pop())}return m}is.prototype.bind=function(u,m,p,v,k,L,B,j){this.context=u;for(var Y=this.boundPaintVertexBuffers.length!==v.length,ie=0;!Y&&ie<v.length;ie++)this.boundPaintVertexBuffers[ie]!==v[ie]&&(Y=!0);u.extVertexArrayObject&&this.vao&&this.boundProgram===m&&this.boundLayoutVertexBuffer===p&&!Y&&this.boundIndexBuffer===k&&this.boundVertexOffset===L&&this.boundDynamicVertexBuffer===B&&this.boundDynamicVertexBuffer2===j?(u.bindVertexArrayOES.set(this.vao),B&&B.bind(),k&&k.dynamicDraw&&k.bind(),j&&j.bind()):this.freshBind(m,p,v,k,L,B,j)},is.prototype.freshBind=function(u,m,p,v,k,L,B){var j,Y=u.numAttributes,ie=this.context,he=ie.gl;if(ie.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ie.extVertexArrayObject.createVertexArrayOES(),ie.bindVertexArrayOES.set(this.vao),j=0,this.boundProgram=u,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=v,this.boundVertexOffset=k,this.boundDynamicVertexBuffer=L,this.boundDynamicVertexBuffer2=B;else{j=ie.currentNumAttributes||0;for(var de=Y;de<j;de++)he.disableVertexAttribArray(de)}m.enableAttributes(he,u);for(var me=0,Ce=p;me<Ce.length;me+=1)Ce[me].enableAttributes(he,u);L&&L.enableAttributes(he,u),B&&B.enableAttributes(he,u),m.bind(),m.setVertexAttribPointers(he,u,k);for(var Te=0,Le=p;Te<Le.length;Te+=1){var xe=Le[Te];xe.bind(),xe.setVertexAttribPointers(he,u,k)}L&&(L.bind(),L.setVertexAttribPointers(he,u,k)),v&&v.bind(),B&&(B.bind(),B.setVertexAttribPointers(he,u,k)),ie.currentNumAttributes=Y},is.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Tu=function(u,m,p,v,k,L){var B=u.gl;this.program=B.createProgram();for(var j=ic(p.staticAttributes),Y=v?v.getBinderAttributes():[],ie=j.concat(Y),he=p.staticUniforms?ic(p.staticUniforms):[],de=v?v.getBinderUniforms():[],me=[],Ce=0,Te=he.concat(de);Ce<Te.length;Ce+=1){var Le=Te[Ce];me.indexOf(Le)<0&&me.push(Le)}var xe=v?v.defines():[];L&&xe.push("#define OVERDRAW_INSPECTOR;");var ze=xe.concat(so.fragmentSource,p.fragmentSource).join(`
`),Fe=xe.concat(so.vertexSource,p.vertexSource).join(`
`),Ye=B.createShader(B.FRAGMENT_SHADER);if(B.isContextLost())this.failedToCreate=!0;else{B.shaderSource(Ye,ze),B.compileShader(Ye),B.attachShader(this.program,Ye);var ot=B.createShader(B.VERTEX_SHADER);if(B.isContextLost())this.failedToCreate=!0;else{B.shaderSource(ot,Fe),B.compileShader(ot),B.attachShader(this.program,ot),this.attributes={};var at={};this.numAttributes=ie.length;for(var st=0;st<this.numAttributes;st++)ie[st]&&(B.bindAttribLocation(this.program,st,ie[st]),this.attributes[ie[st]]=st);B.linkProgram(this.program),B.deleteShader(ot),B.deleteShader(Ye);for(var It=0;It<me.length;It++){var Lt=me[It];if(Lt&&!at[Lt]){var Mt=B.getUniformLocation(this.program,Lt);Mt&&(at[Lt]=Mt)}}this.fixedUniforms=k(u,at),this.binderUniforms=v?v.getUniforms(u,at):[]}}};function Ji(u,m,p){var v=1/Wr(p,1,m.transform.tileZoom),k=Math.pow(2,p.tileID.overscaledZ),L=p.tileSize*Math.pow(2,m.transform.tileZoom)/k,B=L*(p.tileID.canonical.x+p.tileID.wrap*k),j=L*p.tileID.canonical.y;return{u_image:0,u_texsize:p.imageAtlasTexture.size,u_scale:[v,u.fromScale,u.toScale],u_fade:u.t,u_pixel_coord_upper:[B>>16,j>>16],u_pixel_coord_lower:[65535&B,65535&j]}}Tu.prototype.draw=function(u,m,p,v,k,L,B,j,Y,ie,he,de,me,Ce,Te,Le){var xe,ze=u.gl;if(!this.failedToCreate){for(var Fe in u.program.set(this.program),u.setDepthMode(p),u.setStencilMode(v),u.setColorMode(k),u.setCullFace(L),this.fixedUniforms)this.fixedUniforms[Fe].set(B[Fe]);Ce&&Ce.setUniforms(u,this.binderUniforms,de,{zoom:me});for(var Ye=(xe={},xe[ze.LINES]=2,xe[ze.TRIANGLES]=3,xe[ze.LINE_STRIP]=1,xe)[m],ot=0,at=he.get();ot<at.length;ot+=1){var st=at[ot],It=st.vaos||(st.vaos={});(It[j]||(It[j]=new is)).bind(u,this,Y,Ce?Ce.getPaintVertexBuffers():[],ie,st.vertexOffset,Te,Le),ze.drawElements(m,st.primitiveLength*Ye,ze.UNSIGNED_SHORT,st.primitiveOffset*Ye*2)}}};var ql=function(u,m,p,v){var k=m.style.light,L=k.properties.get("position"),B=[L.x,L.y,L.z],j=f.create$1();k.properties.get("anchor")==="viewport"&&f.fromRotation(j,-m.transform.angle),f.transformMat3(B,B,j);var Y=k.properties.get("color");return{u_matrix:u,u_lightpos:B,u_lightintensity:k.properties.get("intensity"),u_lightcolor:[Y.r,Y.g,Y.b],u_vertical_gradient:+p,u_opacity:v}},yr=function(u,m,p,v,k,L,B){return f.extend(ql(u,m,p,v),Ji(L,m,B),{u_height_factor:-Math.pow(2,k.overscaledZ)/B.tileSize/8})},Sa=function(u){return{u_matrix:u}},jr=function(u,m,p,v){return f.extend(Sa(u),Ji(p,m,v))},wn=function(u,m){return{u_matrix:u,u_world:m}},Gl=function(u,m,p,v,k){return f.extend(jr(u,m,p,v),{u_world:k})},Zl=function(u,m,p,v){var k,L,B=u.transform;if(v.paint.get("circle-pitch-alignment")==="map"){var j=Wr(p,1,B.zoom);k=!0,L=[j,j]}else k=!1,L=B.pixelsToGLUnits;return{u_camera_to_center_distance:B.cameraToCenterDistance,u_scale_with_map:+(v.paint.get("circle-pitch-scale")==="map"),u_matrix:u.translatePosMatrix(m.posMatrix,p,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_pitch_with_map:+k,u_device_pixel_ratio:f.browser.devicePixelRatio,u_extrude_scale:L}},Ws=function(u,m,p){var v=Wr(p,1,m.zoom),k=Math.pow(2,m.zoom-p.tileID.overscaledZ),L=p.tileID.overscaleFactor();return{u_matrix:u,u_camera_to_center_distance:m.cameraToCenterDistance,u_pixels_to_tile_units:v,u_extrude_scale:[m.pixelsToGLUnits[0]/(v*k),m.pixelsToGLUnits[1]/(v*k)],u_overscale_factor:L}},Au=function(u,m,p){return{u_matrix:u,u_inv_matrix:m,u_camera_to_center_distance:p.cameraToCenterDistance,u_viewport_size:[p.width,p.height]}},ja=function(u,m,p){return p===void 0&&(p=1),{u_matrix:u,u_color:m,u_overlay:0,u_overlay_scale:p}},Va=function(u){return{u_matrix:u}},Hl=function(u,m,p,v){return{u_matrix:u,u_extrude_scale:Wr(m,1,p),u_intensity:v}},As=function(u,m,p){var v=u.transform;return{u_matrix:rc(u,m,p),u_ratio:1/Wr(m,1,v.zoom),u_device_pixel_ratio:f.browser.devicePixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Vr=function(u,m,p,v){return f.extend(As(u,m,p),{u_image:0,u_image_height:v})},rs=function(u,m,p,v){var k=u.transform,L=xo(m,k);return{u_matrix:rc(u,m,p),u_texsize:m.imageAtlasTexture.size,u_ratio:1/Wr(m,1,k.zoom),u_device_pixel_ratio:f.browser.devicePixelRatio,u_image:0,u_scale:[L,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]]}},Cu=function(u,m,p,v,k){var L=u.lineAtlas,B=xo(m,u.transform),j=p.layout.get("line-cap")==="round",Y=L.getDash(v.from,j),ie=L.getDash(v.to,j),he=Y.width*k.fromScale,de=ie.width*k.toScale;return f.extend(As(u,m,p),{u_patternscale_a:[B/he,-Y.height/2],u_patternscale_b:[B/de,-ie.height/2],u_sdfgamma:L.width/(256*Math.min(he,de)*f.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Y.y,u_tex_y_b:ie.y,u_mix:k.t})};function xo(u,m){return 1/Wr(u,1,m.tileZoom)}function rc(u,m,p){return u.translatePosMatrix(m.tileID.posMatrix,m,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}var Rc=function(u,m,p,v,k){return{u_matrix:u,u_tl_parent:m,u_scale_parent:p,u_buffer_scale:1,u_fade_t:v.mix,u_opacity:v.opacity*k.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:k.paint.get("raster-brightness-min"),u_brightness_high:k.paint.get("raster-brightness-max"),u_saturation_factor:(B=k.paint.get("raster-saturation"),B>0?1-1/(1.001-B):-B),u_contrast_factor:(L=k.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:nc(k.paint.get("raster-hue-rotate"))};var L,B};function nc(u){u*=Math.PI/180;var m=Math.sin(u),p=Math.cos(u);return[(2*p+1)/3,(-Math.sqrt(3)*m-p+1)/3,(Math.sqrt(3)*m-p+1)/3]}var ns,os=function(u,m,p,v,k,L,B,j,Y,ie){var he=k.transform;return{u_is_size_zoom_constant:+(u==="constant"||u==="source"),u_is_size_feature_constant:+(u==="constant"||u==="camera"),u_size_t:m?m.uSizeT:0,u_size:m?m.uSize:0,u_camera_to_center_distance:he.cameraToCenterDistance,u_pitch:he.pitch/360*2*Math.PI,u_rotate_symbol:+p,u_aspect_ratio:he.width/he.height,u_fade_change:k.options.fadeDuration?k.symbolFadeChange:1,u_matrix:L,u_label_plane_matrix:B,u_coord_matrix:j,u_is_text:+Y,u_pitch_with_map:+v,u_texsize:ie,u_texture:0}},Xs=function(u,m,p,v,k,L,B,j,Y,ie,he){var de=k.transform;return f.extend(os(u,m,p,v,k,L,B,j,Y,ie),{u_gamma_scale:v?Math.cos(de._pitch)*de.cameraToCenterDistance:1,u_device_pixel_ratio:f.browser.devicePixelRatio,u_is_halo:+he})},Wl=function(u,m,p,v,k,L,B,j,Y,ie){return f.extend(Xs(u,m,p,v,k,L,B,j,!0,Y,!0),{u_texsize_icon:ie,u_texture_icon:1})},Cs=function(u,m,p){return{u_matrix:u,u_opacity:m,u_color:p}},as=function(u,m,p,v,k,L){return f.extend(function(B,j,Y,ie){var he=Y.imageManager.getPattern(B.from.toString()),de=Y.imageManager.getPattern(B.to.toString()),me=Y.imageManager.getPixelSize(),Ce=me.width,Te=me.height,Le=Math.pow(2,ie.tileID.overscaledZ),xe=ie.tileSize*Math.pow(2,Y.transform.tileZoom)/Le,ze=xe*(ie.tileID.canonical.x+ie.tileID.wrap*Le),Fe=xe*ie.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:he.tl,u_pattern_br_a:he.br,u_pattern_tl_b:de.tl,u_pattern_br_b:de.br,u_texsize:[Ce,Te],u_mix:j.t,u_pattern_size_a:he.displaySize,u_pattern_size_b:de.displaySize,u_scale_a:j.fromScale,u_scale_b:j.toScale,u_tile_units_to_pixels:1/Wr(ie,1,Y.transform.tileZoom),u_pixel_coord_upper:[ze>>16,Fe>>16],u_pixel_coord_lower:[65535&ze,65535&Fe]}}(v,L,p,k),{u_matrix:u,u_opacity:m})},oc={fillExtrusion:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_lightpos:new f.Uniform3f(u,m.u_lightpos),u_lightintensity:new f.Uniform1f(u,m.u_lightintensity),u_lightcolor:new f.Uniform3f(u,m.u_lightcolor),u_vertical_gradient:new f.Uniform1f(u,m.u_vertical_gradient),u_opacity:new f.Uniform1f(u,m.u_opacity)}},fillExtrusionPattern:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_lightpos:new f.Uniform3f(u,m.u_lightpos),u_lightintensity:new f.Uniform1f(u,m.u_lightintensity),u_lightcolor:new f.Uniform3f(u,m.u_lightcolor),u_vertical_gradient:new f.Uniform1f(u,m.u_vertical_gradient),u_height_factor:new f.Uniform1f(u,m.u_height_factor),u_image:new f.Uniform1i(u,m.u_image),u_texsize:new f.Uniform2f(u,m.u_texsize),u_pixel_coord_upper:new f.Uniform2f(u,m.u_pixel_coord_upper),u_pixel_coord_lower:new f.Uniform2f(u,m.u_pixel_coord_lower),u_scale:new f.Uniform3f(u,m.u_scale),u_fade:new f.Uniform1f(u,m.u_fade),u_opacity:new f.Uniform1f(u,m.u_opacity)}},fill:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix)}},fillPattern:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_image:new f.Uniform1i(u,m.u_image),u_texsize:new f.Uniform2f(u,m.u_texsize),u_pixel_coord_upper:new f.Uniform2f(u,m.u_pixel_coord_upper),u_pixel_coord_lower:new f.Uniform2f(u,m.u_pixel_coord_lower),u_scale:new f.Uniform3f(u,m.u_scale),u_fade:new f.Uniform1f(u,m.u_fade)}},fillOutline:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_world:new f.Uniform2f(u,m.u_world)}},fillOutlinePattern:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_world:new f.Uniform2f(u,m.u_world),u_image:new f.Uniform1i(u,m.u_image),u_texsize:new f.Uniform2f(u,m.u_texsize),u_pixel_coord_upper:new f.Uniform2f(u,m.u_pixel_coord_upper),u_pixel_coord_lower:new f.Uniform2f(u,m.u_pixel_coord_lower),u_scale:new f.Uniform3f(u,m.u_scale),u_fade:new f.Uniform1f(u,m.u_fade)}},circle:function(u,m){return{u_camera_to_center_distance:new f.Uniform1f(u,m.u_camera_to_center_distance),u_scale_with_map:new f.Uniform1i(u,m.u_scale_with_map),u_pitch_with_map:new f.Uniform1i(u,m.u_pitch_with_map),u_extrude_scale:new f.Uniform2f(u,m.u_extrude_scale),u_device_pixel_ratio:new f.Uniform1f(u,m.u_device_pixel_ratio),u_matrix:new f.UniformMatrix4f(u,m.u_matrix)}},collisionBox:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_camera_to_center_distance:new f.Uniform1f(u,m.u_camera_to_center_distance),u_pixels_to_tile_units:new f.Uniform1f(u,m.u_pixels_to_tile_units),u_extrude_scale:new f.Uniform2f(u,m.u_extrude_scale),u_overscale_factor:new f.Uniform1f(u,m.u_overscale_factor)}},collisionCircle:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_inv_matrix:new f.UniformMatrix4f(u,m.u_inv_matrix),u_camera_to_center_distance:new f.Uniform1f(u,m.u_camera_to_center_distance),u_viewport_size:new f.Uniform2f(u,m.u_viewport_size)}},debug:function(u,m){return{u_color:new f.UniformColor(u,m.u_color),u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_overlay:new f.Uniform1i(u,m.u_overlay),u_overlay_scale:new f.Uniform1f(u,m.u_overlay_scale)}},clippingMask:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix)}},heatmap:function(u,m){return{u_extrude_scale:new f.Uniform1f(u,m.u_extrude_scale),u_intensity:new f.Uniform1f(u,m.u_intensity),u_matrix:new f.UniformMatrix4f(u,m.u_matrix)}},heatmapTexture:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_world:new f.Uniform2f(u,m.u_world),u_image:new f.Uniform1i(u,m.u_image),u_color_ramp:new f.Uniform1i(u,m.u_color_ramp),u_opacity:new f.Uniform1f(u,m.u_opacity)}},hillshade:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_image:new f.Uniform1i(u,m.u_image),u_latrange:new f.Uniform2f(u,m.u_latrange),u_light:new f.Uniform2f(u,m.u_light),u_shadow:new f.UniformColor(u,m.u_shadow),u_highlight:new f.UniformColor(u,m.u_highlight),u_accent:new f.UniformColor(u,m.u_accent)}},hillshadePrepare:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_image:new f.Uniform1i(u,m.u_image),u_dimension:new f.Uniform2f(u,m.u_dimension),u_zoom:new f.Uniform1f(u,m.u_zoom),u_unpack:new f.Uniform4f(u,m.u_unpack)}},line:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_ratio:new f.Uniform1f(u,m.u_ratio),u_device_pixel_ratio:new f.Uniform1f(u,m.u_device_pixel_ratio),u_units_to_pixels:new f.Uniform2f(u,m.u_units_to_pixels)}},lineGradient:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_ratio:new f.Uniform1f(u,m.u_ratio),u_device_pixel_ratio:new f.Uniform1f(u,m.u_device_pixel_ratio),u_units_to_pixels:new f.Uniform2f(u,m.u_units_to_pixels),u_image:new f.Uniform1i(u,m.u_image),u_image_height:new f.Uniform1f(u,m.u_image_height)}},linePattern:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_texsize:new f.Uniform2f(u,m.u_texsize),u_ratio:new f.Uniform1f(u,m.u_ratio),u_device_pixel_ratio:new f.Uniform1f(u,m.u_device_pixel_ratio),u_image:new f.Uniform1i(u,m.u_image),u_units_to_pixels:new f.Uniform2f(u,m.u_units_to_pixels),u_scale:new f.Uniform3f(u,m.u_scale),u_fade:new f.Uniform1f(u,m.u_fade)}},lineSDF:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_ratio:new f.Uniform1f(u,m.u_ratio),u_device_pixel_ratio:new f.Uniform1f(u,m.u_device_pixel_ratio),u_units_to_pixels:new f.Uniform2f(u,m.u_units_to_pixels),u_patternscale_a:new f.Uniform2f(u,m.u_patternscale_a),u_patternscale_b:new f.Uniform2f(u,m.u_patternscale_b),u_sdfgamma:new f.Uniform1f(u,m.u_sdfgamma),u_image:new f.Uniform1i(u,m.u_image),u_tex_y_a:new f.Uniform1f(u,m.u_tex_y_a),u_tex_y_b:new f.Uniform1f(u,m.u_tex_y_b),u_mix:new f.Uniform1f(u,m.u_mix)}},raster:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_tl_parent:new f.Uniform2f(u,m.u_tl_parent),u_scale_parent:new f.Uniform1f(u,m.u_scale_parent),u_buffer_scale:new f.Uniform1f(u,m.u_buffer_scale),u_fade_t:new f.Uniform1f(u,m.u_fade_t),u_opacity:new f.Uniform1f(u,m.u_opacity),u_image0:new f.Uniform1i(u,m.u_image0),u_image1:new f.Uniform1i(u,m.u_image1),u_brightness_low:new f.Uniform1f(u,m.u_brightness_low),u_brightness_high:new f.Uniform1f(u,m.u_brightness_high),u_saturation_factor:new f.Uniform1f(u,m.u_saturation_factor),u_contrast_factor:new f.Uniform1f(u,m.u_contrast_factor),u_spin_weights:new f.Uniform3f(u,m.u_spin_weights)}},symbolIcon:function(u,m){return{u_is_size_zoom_constant:new f.Uniform1i(u,m.u_is_size_zoom_constant),u_is_size_feature_constant:new f.Uniform1i(u,m.u_is_size_feature_constant),u_size_t:new f.Uniform1f(u,m.u_size_t),u_size:new f.Uniform1f(u,m.u_size),u_camera_to_center_distance:new f.Uniform1f(u,m.u_camera_to_center_distance),u_pitch:new f.Uniform1f(u,m.u_pitch),u_rotate_symbol:new f.Uniform1i(u,m.u_rotate_symbol),u_aspect_ratio:new f.Uniform1f(u,m.u_aspect_ratio),u_fade_change:new f.Uniform1f(u,m.u_fade_change),u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_label_plane_matrix:new f.UniformMatrix4f(u,m.u_label_plane_matrix),u_coord_matrix:new f.UniformMatrix4f(u,m.u_coord_matrix),u_is_text:new f.Uniform1i(u,m.u_is_text),u_pitch_with_map:new f.Uniform1i(u,m.u_pitch_with_map),u_texsize:new f.Uniform2f(u,m.u_texsize),u_texture:new f.Uniform1i(u,m.u_texture)}},symbolSDF:function(u,m){return{u_is_size_zoom_constant:new f.Uniform1i(u,m.u_is_size_zoom_constant),u_is_size_feature_constant:new f.Uniform1i(u,m.u_is_size_feature_constant),u_size_t:new f.Uniform1f(u,m.u_size_t),u_size:new f.Uniform1f(u,m.u_size),u_camera_to_center_distance:new f.Uniform1f(u,m.u_camera_to_center_distance),u_pitch:new f.Uniform1f(u,m.u_pitch),u_rotate_symbol:new f.Uniform1i(u,m.u_rotate_symbol),u_aspect_ratio:new f.Uniform1f(u,m.u_aspect_ratio),u_fade_change:new f.Uniform1f(u,m.u_fade_change),u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_label_plane_matrix:new f.UniformMatrix4f(u,m.u_label_plane_matrix),u_coord_matrix:new f.UniformMatrix4f(u,m.u_coord_matrix),u_is_text:new f.Uniform1i(u,m.u_is_text),u_pitch_with_map:new f.Uniform1i(u,m.u_pitch_with_map),u_texsize:new f.Uniform2f(u,m.u_texsize),u_texture:new f.Uniform1i(u,m.u_texture),u_gamma_scale:new f.Uniform1f(u,m.u_gamma_scale),u_device_pixel_ratio:new f.Uniform1f(u,m.u_device_pixel_ratio),u_is_halo:new f.Uniform1i(u,m.u_is_halo)}},symbolTextAndIcon:function(u,m){return{u_is_size_zoom_constant:new f.Uniform1i(u,m.u_is_size_zoom_constant),u_is_size_feature_constant:new f.Uniform1i(u,m.u_is_size_feature_constant),u_size_t:new f.Uniform1f(u,m.u_size_t),u_size:new f.Uniform1f(u,m.u_size),u_camera_to_center_distance:new f.Uniform1f(u,m.u_camera_to_center_distance),u_pitch:new f.Uniform1f(u,m.u_pitch),u_rotate_symbol:new f.Uniform1i(u,m.u_rotate_symbol),u_aspect_ratio:new f.Uniform1f(u,m.u_aspect_ratio),u_fade_change:new f.Uniform1f(u,m.u_fade_change),u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_label_plane_matrix:new f.UniformMatrix4f(u,m.u_label_plane_matrix),u_coord_matrix:new f.UniformMatrix4f(u,m.u_coord_matrix),u_is_text:new f.Uniform1i(u,m.u_is_text),u_pitch_with_map:new f.Uniform1i(u,m.u_pitch_with_map),u_texsize:new f.Uniform2f(u,m.u_texsize),u_texsize_icon:new f.Uniform2f(u,m.u_texsize_icon),u_texture:new f.Uniform1i(u,m.u_texture),u_texture_icon:new f.Uniform1i(u,m.u_texture_icon),u_gamma_scale:new f.Uniform1f(u,m.u_gamma_scale),u_device_pixel_ratio:new f.Uniform1f(u,m.u_device_pixel_ratio),u_is_halo:new f.Uniform1i(u,m.u_is_halo)}},background:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_opacity:new f.Uniform1f(u,m.u_opacity),u_color:new f.UniformColor(u,m.u_color)}},backgroundPattern:function(u,m){return{u_matrix:new f.UniformMatrix4f(u,m.u_matrix),u_opacity:new f.Uniform1f(u,m.u_opacity),u_image:new f.Uniform1i(u,m.u_image),u_pattern_tl_a:new f.Uniform2f(u,m.u_pattern_tl_a),u_pattern_br_a:new f.Uniform2f(u,m.u_pattern_br_a),u_pattern_tl_b:new f.Uniform2f(u,m.u_pattern_tl_b),u_pattern_br_b:new f.Uniform2f(u,m.u_pattern_br_b),u_texsize:new f.Uniform2f(u,m.u_texsize),u_mix:new f.Uniform1f(u,m.u_mix),u_pattern_size_a:new f.Uniform2f(u,m.u_pattern_size_a),u_pattern_size_b:new f.Uniform2f(u,m.u_pattern_size_b),u_scale_a:new f.Uniform1f(u,m.u_scale_a),u_scale_b:new f.Uniform1f(u,m.u_scale_b),u_pixel_coord_upper:new f.Uniform2f(u,m.u_pixel_coord_upper),u_pixel_coord_lower:new f.Uniform2f(u,m.u_pixel_coord_lower),u_tile_units_to_pixels:new f.Uniform1f(u,m.u_tile_units_to_pixels)}}};function qa(u,m,p,v,k,L,B){for(var j=u.context,Y=j.gl,ie=u.useProgram("collisionBox"),he=[],de=0,me=0,Ce=0;Ce<v.length;Ce++){var Te=v[Ce],Le=m.getTile(Te),xe=Le.getBucket(p);if(xe){var ze=Te.posMatrix;k[0]===0&&k[1]===0||(ze=u.translatePosMatrix(Te.posMatrix,Le,k,L));var Fe=B?xe.textCollisionBox:xe.iconCollisionBox,Ye=xe.collisionCircleArray;if(Ye.length>0){var ot=f.create(),at=ze;f.mul(ot,xe.placementInvProjMatrix,u.transform.glCoordMatrix),f.mul(ot,ot,xe.placementViewportMatrix),he.push({circleArray:Ye,circleOffset:me,transform:at,invTransform:ot}),me=de+=Ye.length/4}Fe&&ie.draw(j,Y.LINES,ge.disabled,Se.disabled,u.colorModeForRenderPass(),Ne.disabled,Ws(ze,u.transform,Le),p.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,null,u.transform.zoom,null,null,Fe.collisionVertexBuffer)}}if(B&&he.length){var st=u.useProgram("collisionCircle"),It=new f.StructArrayLayout2f1f2i16;It.resize(4*de),It._trim();for(var Lt=0,Mt=0,Yt=he;Mt<Yt.length;Mt+=1)for(var di=Yt[Mt],_i=0;_i<di.circleArray.length/4;_i++){var hi=4*_i,ar=di.circleArray[hi+0],ri=di.circleArray[hi+1],Di=di.circleArray[hi+2],er=di.circleArray[hi+3];It.emplace(Lt++,ar,ri,Di,er,0),It.emplace(Lt++,ar,ri,Di,er,1),It.emplace(Lt++,ar,ri,Di,er,2),It.emplace(Lt++,ar,ri,Di,er,3)}(!ns||ns.length<2*de)&&(ns=function(En){var Ln=2*En,yo=new f.StructArrayLayout3ui6;yo.resize(Ln),yo._trim();for(var yn=0;yn<Ln;yn++){var lr=6*yn;yo.uint16[lr+0]=4*yn+0,yo.uint16[lr+1]=4*yn+1,yo.uint16[lr+2]=4*yn+2,yo.uint16[lr+3]=4*yn+2,yo.uint16[lr+4]=4*yn+3,yo.uint16[lr+5]=4*yn+0}return yo}(de));for(var zi=j.createIndexBuffer(ns,!0),Ai=j.createVertexBuffer(It,f.collisionCircleLayout.members,!0),ji=0,wi=he;ji<wi.length;ji+=1){var gi=wi[ji],hn=Au(gi.transform,gi.invTransform,u.transform);st.draw(j,Y.TRIANGLES,ge.disabled,Se.disabled,u.colorModeForRenderPass(),Ne.disabled,hn,p.id,Ai,zi,f.SegmentVector.simpleSegment(0,2*gi.circleOffset,gi.circleArray.length,gi.circleArray.length/2),null,u.transform.zoom,null,null,null)}Ai.destroy(),zi.destroy()}}var na=f.identity(new Float32Array(16));function Xl(u,m,p,v,k,L){var B=f.getAnchorAlignment(u),j=-(B.horizontalAlign-.5)*m,Y=-(B.verticalAlign-.5)*p,ie=f.evaluateVariableOffset(u,v);return new f.Point((j/k+ie[0])*L,(Y/k+ie[1])*L)}function Kl(u,m,p,v,k,L,B,j,Y,ie,he){var de=u.text.placedSymbolArray,me=u.text.dynamicLayoutVertexArray,Ce=u.icon.dynamicLayoutVertexArray,Te={};me.clear();for(var Le=0;Le<de.length;Le++){var xe=de.get(Le),ze=xe.hidden||!xe.crossTileID||u.allowVerticalPlacement&&!xe.placedOrientation?null:v[xe.crossTileID];if(ze){var Fe=new f.Point(xe.anchorX,xe.anchorY),Ye=Kt(Fe,p?j:B),ot=Pi(L.cameraToCenterDistance,Ye.signedDistanceFromCamera),at=k.evaluateSizeForFeature(u.textSizeData,ie,xe)*ot/f.ONE_EM;p&&(at*=u.tilePixelRatio/Y);for(var st=Xl(ze.anchor,ze.width,ze.height,ze.textOffset,ze.textBoxScale,at),It=p?Kt(Fe.add(st),B).point:Ye.point.add(m?st.rotate(-L.angle):st),Lt=u.allowVerticalPlacement&&xe.placedOrientation===f.WritingMode.vertical?Math.PI/2:0,Mt=0;Mt<xe.numGlyphs;Mt++)f.addDynamicAttributes(me,It,Lt);he&&xe.associatedIconIndex>=0&&(Te[xe.associatedIconIndex]={shiftedAnchor:It,angle:Lt})}else vo(xe.numGlyphs,me)}if(he){Ce.clear();for(var Yt=u.icon.placedSymbolArray,di=0;di<Yt.length;di++){var _i=Yt.get(di);if(_i.hidden)vo(_i.numGlyphs,Ce);else{var hi=Te[di];if(hi)for(var ar=0;ar<_i.numGlyphs;ar++)f.addDynamicAttributes(Ce,hi.shiftedAnchor,hi.angle);else vo(_i.numGlyphs,Ce)}}u.icon.dynamicLayoutVertexBuffer.updateData(Ce)}u.text.dynamicLayoutVertexBuffer.updateData(me)}function Ks(u,m,p){return p.iconsInText&&m?"symbolTextAndIcon":u?"symbolSDF":"symbolIcon"}function Ta(u,m,p,v,k,L,B,j,Y,ie,he,de){for(var me=u.context,Ce=me.gl,Te=u.transform,Le=j==="map",xe=Y==="map",ze=Le&&p.layout.get("symbol-placement")!=="point",Fe=Le&&!xe&&!ze,Ye=p.layout.get("symbol-sort-key").constantOr(1)!==void 0,ot=!1,at=u.depthModeForSublayer(0,ge.ReadOnly),st=p.layout.get("text-variable-anchor"),It=[],Lt=0,Mt=v;Lt<Mt.length;Lt+=1){var Yt=Mt[Lt],di=m.getTile(Yt),_i=di.getBucket(p);if(_i){var hi=k?_i.text:_i.icon;if(hi&&hi.segments.get().length){var ar=hi.programConfigurations.get(p.id),ri=k||_i.sdfIcons,Di=k?_i.textSizeData:_i.iconSizeData,er=xe||Te.pitch!==0,zi=u.useProgram(Ks(ri,k,_i),ar),Ai=f.evaluateSizeForZoom(Di,Te.zoom),ji=void 0,wi=[0,0],gi=void 0,hn=void 0,En=null,Ln=void 0;if(k)gi=di.glyphAtlasTexture,hn=Ce.LINEAR,ji=di.glyphAtlasTexture.size,_i.iconsInText&&(wi=di.imageAtlasTexture.size,En=di.imageAtlasTexture,Ln=er||u.options.rotating||u.options.zooming||Di.kind==="composite"||Di.kind==="camera"?Ce.LINEAR:Ce.NEAREST);else{var yo=p.layout.get("icon-size").constantOr(0)!==1||_i.iconsNeedLinear;gi=di.imageAtlasTexture,hn=ri||u.options.rotating||u.options.zooming||yo||er?Ce.LINEAR:Ce.NEAREST,ji=di.imageAtlasTexture.size}var yn=Wr(di,1,u.transform.zoom),lr=Ii(Yt.posMatrix,xe,Le,u.transform,yn),Ho=li(Yt.posMatrix,xe,Le,u.transform,yn),Oo=st&&_i.hasTextData(),_a=p.layout.get("icon-text-fit")!=="none"&&Oo&&_i.hasIconData();ze&&Sn(_i,Yt.posMatrix,u,k,lr,Ho,xe,ie);var Jn=u.translatePosMatrix(Yt.posMatrix,di,L,B),va=ze||k&&st||_a?na:lr,xa=u.translatePosMatrix(Ho,di,L,B,!0),Pu=ri&&p.paint.get(k?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Mu={program:zi,buffers:hi,uniformValues:ri?_i.iconsInText?Wl(Di.kind,Ai,Fe,xe,u,Jn,va,xa,ji,wi):Xs(Di.kind,Ai,Fe,xe,u,Jn,va,xa,k,ji,!0):os(Di.kind,Ai,Fe,xe,u,Jn,va,xa,k,ji),atlasTexture:gi,atlasTextureIcon:En,atlasInterpolation:hn,atlasInterpolationIcon:Ln,isSDF:ri,hasHalo:Pu};if(Ye&&_i.canOverlap){ot=!0;for(var tl=0,Lu=hi.segments.get();tl<Lu.length;tl+=1){var tu=Lu[tl];It.push({segments:new f.SegmentVector([tu]),sortKey:tu.sortKey,state:Mu})}}else It.push({segments:hi.segments,sortKey:0,state:Mu})}}}ot&&It.sort(function(Tl,fs){return Tl.sortKey-fs.sortKey});for(var Ps=0,iu=It;Ps<iu.length;Ps+=1){var ds=iu[Ps],Yn=ds.state;if(me.activeTexture.set(Ce.TEXTURE0),Yn.atlasTexture.bind(Yn.atlasInterpolation,Ce.CLAMP_TO_EDGE),Yn.atlasTextureIcon&&(me.activeTexture.set(Ce.TEXTURE1),Yn.atlasTextureIcon&&Yn.atlasTextureIcon.bind(Yn.atlasInterpolationIcon,Ce.CLAMP_TO_EDGE)),Yn.isSDF){var ba=Yn.uniformValues;Yn.hasHalo&&(ba.u_is_halo=1,gl(Yn.buffers,ds.segments,p,u,Yn.program,at,he,de,ba)),ba.u_is_halo=0}gl(Yn.buffers,ds.segments,p,u,Yn.program,at,he,de,Yn.uniformValues)}}function gl(u,m,p,v,k,L,B,j,Y){var ie=v.context;k.draw(ie,ie.gl.TRIANGLES,L,B,j,Ne.disabled,Y,p.id,u.layoutVertexBuffer,u.indexBuffer,m,p.paint,v.transform.zoom,u.programConfigurations.get(p.id),u.dynamicLayoutVertexBuffer,u.opacityVertexBuffer)}function ks(u,m,p,v,k,L,B){var j,Y,ie,he,de,me=u.context.gl,Ce=p.paint.get("fill-pattern"),Te=Ce&&Ce.constantOr(1),Le=p.getCrossfadeParameters();B?(Y=Te&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=me.LINES):(Y=Te?"fillPattern":"fill",j=me.TRIANGLES);for(var xe=0,ze=v;xe<ze.length;xe+=1){var Fe=ze[xe],Ye=m.getTile(Fe);if(!Te||Ye.patternsLoaded()){var ot=Ye.getBucket(p);if(ot){var at=ot.programConfigurations.get(p.id),st=u.useProgram(Y,at);Te&&(u.context.activeTexture.set(me.TEXTURE0),Ye.imageAtlasTexture.bind(me.LINEAR,me.CLAMP_TO_EDGE),at.updatePaintBuffers(Le));var It=Ce.constantOr(null);if(It&&Ye.imageAtlas){var Lt=Ye.imageAtlas,Mt=Lt.patternPositions[It.to.toString()],Yt=Lt.patternPositions[It.from.toString()];Mt&&Yt&&at.setConstantPatternPositions(Mt,Yt)}var di=u.translatePosMatrix(Fe.posMatrix,Ye,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(B){he=ot.indexBuffer2,de=ot.segments2;var _i=[me.drawingBufferWidth,me.drawingBufferHeight];ie=Y==="fillOutlinePattern"&&Te?Gl(di,u,Le,Ye,_i):wn(di,_i)}else he=ot.indexBuffer,de=ot.segments,ie=Te?jr(di,u,Le,Ye):Sa(di);st.draw(u.context,j,k,u.stencilModeForClipping(Fe),L,Ne.disabled,ie,p.id,ot.layoutVertexBuffer,he,de,p.paint,u.transform.zoom,at)}}}}function ku(u,m,p,v,k,L,B){for(var j=u.context,Y=j.gl,ie=p.paint.get("fill-extrusion-pattern"),he=ie.constantOr(1),de=p.getCrossfadeParameters(),me=p.paint.get("fill-extrusion-opacity"),Ce=0,Te=v;Ce<Te.length;Ce+=1){var Le=Te[Ce],xe=m.getTile(Le),ze=xe.getBucket(p);if(ze){var Fe=ze.programConfigurations.get(p.id),Ye=u.useProgram(he?"fillExtrusionPattern":"fillExtrusion",Fe);he&&(u.context.activeTexture.set(Y.TEXTURE0),xe.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Fe.updatePaintBuffers(de));var ot=ie.constantOr(null);if(ot&&xe.imageAtlas){var at=xe.imageAtlas,st=at.patternPositions[ot.to.toString()],It=at.patternPositions[ot.from.toString()];st&&It&&Fe.setConstantPatternPositions(st,It)}var Lt=u.translatePosMatrix(Le.posMatrix,xe,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),Mt=p.paint.get("fill-extrusion-vertical-gradient"),Yt=he?yr(Lt,u,Mt,me,Le,de,xe):ql(Lt,u,Mt,me);Ye.draw(j,j.gl.TRIANGLES,k,L,B,Ne.backCCW,Yt,p.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,p.paint,u.transform.zoom,Fe)}}}function Jl(u,m,p,v,k,L){var B=u.context,j=B.gl,Y=m.fbo;if(Y){var ie=u.useProgram("hillshade");B.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,Y.colorAttachment.get());var he=function(de,me,Ce){var Te=Ce.paint.get("hillshade-shadow-color"),Le=Ce.paint.get("hillshade-highlight-color"),xe=Ce.paint.get("hillshade-accent-color"),ze=Ce.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ce.paint.get("hillshade-illumination-anchor")==="viewport"&&(ze-=de.transform.angle);var Fe,Ye,ot,at=!de.options.moving;return{u_matrix:de.transform.calculatePosMatrix(me.tileID.toUnwrapped(),at),u_image:0,u_latrange:(Fe=me.tileID,Ye=Math.pow(2,Fe.canonical.z),ot=Fe.canonical.y,[new f.MercatorCoordinate(0,ot/Ye).toLngLat().lat,new f.MercatorCoordinate(0,(ot+1)/Ye).toLngLat().lat]),u_light:[Ce.paint.get("hillshade-exaggeration"),ze],u_shadow:Te,u_highlight:Le,u_accent:xe}}(u,m,p);ie.draw(B,j.TRIANGLES,v,k,L,Ne.disabled,he,p.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments)}}function Bc(u,m,p,v,k,L){var B=u.context,j=B.gl,Y=m.dem;if(Y&&Y.data){var ie=Y.dim,he=Y.stride,de=Y.getPixels();if(B.activeTexture.set(j.TEXTURE1),B.pixelStoreUnpackPremultiplyAlpha.set(!1),m.demTexture=m.demTexture||u.getTileTexture(he),m.demTexture){var me=m.demTexture;me.update(de,{premultiply:!1}),me.bind(j.NEAREST,j.CLAMP_TO_EDGE)}else m.demTexture=new f.Texture(B,de,j.RGBA,{premultiply:!1}),m.demTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE);B.activeTexture.set(j.TEXTURE0);var Ce=m.fbo;if(!Ce){var Te=new f.Texture(B,{width:ie,height:ie,data:null},j.RGBA);Te.bind(j.LINEAR,j.CLAMP_TO_EDGE),(Ce=m.fbo=B.createFramebuffer(ie,ie,!0)).colorAttachment.set(Te.texture)}B.bindFramebuffer.set(Ce.framebuffer),B.viewport.set([0,0,ie,ie]),u.useProgram("hillshadePrepare").draw(B,j.TRIANGLES,v,k,L,Ne.disabled,function(Le,xe){var ze=xe.stride,Fe=f.create();return f.ortho(Fe,0,f.EXTENT,-f.EXTENT,0,0,1),f.translate(Fe,Fe,[0,-f.EXTENT,0]),{u_matrix:Fe,u_image:1,u_dimension:[ze,ze],u_zoom:Le.overscaledZ,u_unpack:xe.getUnpackVector()}}(m.tileID,Y),p.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments),m.needsHillshadePrepare=!1}}function ss(u,m,p,v,k){var L=v.paint.get("raster-fade-duration");if(L>0){var B=f.browser.now(),j=(B-u.timeAdded)/L,Y=m?(B-m.timeAdded)/L:-1,ie=p.getSource(),he=k.coveringZoomLevel({tileSize:ie.tileSize,roundZoom:ie.roundZoom}),de=!m||Math.abs(m.tileID.overscaledZ-he)>Math.abs(u.tileID.overscaledZ-he),me=de&&u.refreshedUponExpiration?1:f.clamp(de?j:1-Y,0,1);return u.refreshedUponExpiration&&j>=1&&(u.refreshedUponExpiration=!1),m?{opacity:1,mix:1-me}:{opacity:me,mix:0}}return{opacity:1,mix:0}}var zu=new f.Color(1,0,0,1),_l=new f.Color(0,1,0,1),vl=new f.Color(0,0,1,1),bo=new f.Color(1,0,1,1),wo=new f.Color(0,1,1,1);function ac(u,m,p,v){xl(u,0,m+p/2,u.transform.width,p,v)}function ls(u,m,p,v){xl(u,m-p/2,0,p,u.transform.height,v)}function xl(u,m,p,v,k,L){var B=u.context,j=B.gl;j.enable(j.SCISSOR_TEST),j.scissor(m*f.browser.devicePixelRatio,p*f.browser.devicePixelRatio,v*f.browser.devicePixelRatio,k*f.browser.devicePixelRatio),B.clear({color:L}),j.disable(j.SCISSOR_TEST)}function Js(u,m,p){var v=u.context,k=v.gl,L=p.posMatrix,B=u.useProgram("debug"),j=ge.disabled,Y=Se.disabled,ie=u.colorModeForRenderPass();v.activeTexture.set(k.TEXTURE0),u.emptyTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),B.draw(v,k.LINE_STRIP,j,Y,ie,Ne.disabled,ja(L,f.Color.red),"$debug",u.debugBuffer,u.tileBorderIndexBuffer,u.debugSegments);var he=m.getTileByID(p.key).latestRawTileData,de=Math.floor((he&&he.byteLength||0)/1024),me=m.getTile(p).tileSize,Ce=512/Math.min(me,512)*(p.overscaledZ/u.transform.zoom)*.5,Te=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(Te+=" => "+p.overscaledZ),function(Le,xe){Le.initDebugOverlayCanvas();var ze=Le.debugOverlayCanvas,Fe=Le.context.gl,Ye=Le.debugOverlayCanvas.getContext("2d");Ye.clearRect(0,0,ze.width,ze.height),Ye.shadowColor="white",Ye.shadowBlur=2,Ye.lineWidth=1.5,Ye.strokeStyle="white",Ye.textBaseline="top",Ye.font="bold 36px Open Sans, sans-serif",Ye.fillText(xe,5,5),Ye.strokeText(xe,5,5),Le.debugOverlayTexture.update(ze),Le.debugOverlayTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE)}(u,Te+" "+de+"kb"),B.draw(v,k.TRIANGLES,j,Y,Oe.alphaBlended,Ne.disabled,ja(L,f.Color.transparent,Ce),"$debug",u.debugBuffer,u.quadTriangleIndexBuffer,u.debugSegments)}var oa={symbol:function(u,m,p,v,k){if(u.renderPass==="translucent"){var L=Se.disabled,B=u.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&function(j,Y,ie,he,de,me,Ce){for(var Te=Y.transform,Le=de==="map",xe=me==="map",ze=0,Fe=j;ze<Fe.length;ze+=1){var Ye=Fe[ze],ot=he.getTile(Ye),at=ot.getBucket(ie);if(at&&at.text&&at.text.segments.get().length){var st=f.evaluateSizeForZoom(at.textSizeData,Te.zoom),It=Wr(ot,1,Y.transform.zoom),Lt=Ii(Ye.posMatrix,xe,Le,Y.transform,It),Mt=ie.layout.get("icon-text-fit")!=="none"&&at.hasIconData();if(st){var Yt=Math.pow(2,Te.zoom-ot.tileID.overscaledZ);Kl(at,Le,xe,Ce,f.symbolSize,Te,Lt,Ye.posMatrix,Yt,st,Mt)}}}}(v,u,p,m,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),k),p.paint.get("icon-opacity").constantOr(1)!==0&&Ta(u,m,p,v,!1,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),p.layout.get("icon-rotation-alignment"),p.layout.get("icon-pitch-alignment"),p.layout.get("icon-keep-upright"),L,B),p.paint.get("text-opacity").constantOr(1)!==0&&Ta(u,m,p,v,!0,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),p.layout.get("text-keep-upright"),L,B),m.map.showCollisionBoxes&&(qa(u,m,p,v,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),qa(u,m,p,v,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))}},circle:function(u,m,p,v){if(u.renderPass==="translucent"){var k=p.paint.get("circle-opacity"),L=p.paint.get("circle-stroke-width"),B=p.paint.get("circle-stroke-opacity"),j=p.layout.get("circle-sort-key").constantOr(1)!==void 0;if(k.constantOr(1)!==0||L.constantOr(1)!==0&&B.constantOr(1)!==0){for(var Y=u.context,ie=Y.gl,he=u.depthModeForSublayer(0,ge.ReadOnly),de=Se.disabled,me=u.colorModeForRenderPass(),Ce=[],Te=0;Te<v.length;Te++){var Le=v[Te],xe=m.getTile(Le),ze=xe.getBucket(p);if(ze){var Fe=ze.programConfigurations.get(p.id),Ye={programConfiguration:Fe,program:u.useProgram("circle",Fe),layoutVertexBuffer:ze.layoutVertexBuffer,indexBuffer:ze.indexBuffer,uniformValues:Zl(u,Le,xe,p)};if(j)for(var ot=0,at=ze.segments.get();ot<at.length;ot+=1){var st=at[ot];Ce.push({segments:new f.SegmentVector([st]),sortKey:st.sortKey,state:Ye})}else Ce.push({segments:ze.segments,sortKey:0,state:Ye})}}j&&Ce.sort(function(di,_i){return di.sortKey-_i.sortKey});for(var It=0,Lt=Ce;It<Lt.length;It+=1){var Mt=Lt[It],Yt=Mt.state;Yt.program.draw(Y,ie.TRIANGLES,he,de,me,Ne.disabled,Yt.uniformValues,p.id,Yt.layoutVertexBuffer,Yt.indexBuffer,Mt.segments,p.paint,u.transform.zoom,Yt.programConfiguration)}}}},heatmap:function(u,m,p,v){if(p.paint.get("heatmap-opacity")!==0)if(u.renderPass==="offscreen"){var k=u.context,L=k.gl,B=Se.disabled,j=new Oe([L.ONE,L.ONE],f.Color.transparent,[!0,!0,!0,!0]);(function(Ce,Te,Le){var xe=Ce.gl;Ce.activeTexture.set(xe.TEXTURE1),Ce.viewport.set([0,0,Te.width/4,Te.height/4]);var ze=Le.heatmapFbo;if(ze)xe.bindTexture(xe.TEXTURE_2D,ze.colorAttachment.get()),Ce.bindFramebuffer.set(ze.framebuffer);else{var Fe=xe.createTexture();xe.bindTexture(xe.TEXTURE_2D,Fe),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_S,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_T,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MIN_FILTER,xe.LINEAR),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MAG_FILTER,xe.LINEAR),ze=Le.heatmapFbo=Ce.createFramebuffer(Te.width/4,Te.height/4,!1),function(Ye,ot,at,st){var It=Ye.gl;It.texImage2D(It.TEXTURE_2D,0,It.RGBA,ot.width/4,ot.height/4,0,It.RGBA,Ye.extRenderToTextureHalfFloat?Ye.extTextureHalfFloat.HALF_FLOAT_OES:It.UNSIGNED_BYTE,null),st.colorAttachment.set(at)}(Ce,Te,Fe,ze)}})(k,u,p),k.clear({color:f.Color.transparent});for(var Y=0;Y<v.length;Y++){var ie=v[Y];if(!m.hasRenderableParent(ie)){var he=m.getTile(ie),de=he.getBucket(p);if(de){var me=de.programConfigurations.get(p.id);u.useProgram("heatmap",me).draw(k,L.TRIANGLES,ge.disabled,B,j,Ne.disabled,Hl(ie.posMatrix,he,u.transform.zoom,p.paint.get("heatmap-intensity")),p.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,p.paint,u.transform.zoom,me)}}}k.viewport.set([0,0,u.width,u.height])}else u.renderPass==="translucent"&&(u.context.setColorMode(u.colorModeForRenderPass()),function(Ce,Te){var Le=Ce.context,xe=Le.gl,ze=Te.heatmapFbo;if(ze){Le.activeTexture.set(xe.TEXTURE0),xe.bindTexture(xe.TEXTURE_2D,ze.colorAttachment.get()),Le.activeTexture.set(xe.TEXTURE1);var Fe=Te.colorRampTexture;Fe||(Fe=Te.colorRampTexture=new f.Texture(Le,Te.colorRamp,xe.RGBA)),Fe.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),Ce.useProgram("heatmapTexture").draw(Le,xe.TRIANGLES,ge.disabled,Se.disabled,Ce.colorModeForRenderPass(),Ne.disabled,function(Ye,ot,at,st){var It=f.create();f.ortho(It,0,Ye.width,Ye.height,0,0,1);var Lt=Ye.context.gl;return{u_matrix:It,u_world:[Lt.drawingBufferWidth,Lt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ot.paint.get("heatmap-opacity")}}(Ce,Te),Te.id,Ce.viewportBuffer,Ce.quadTriangleIndexBuffer,Ce.viewportSegments,Te.paint,Ce.transform.zoom)}}(u,p))},line:function(u,m,p,v){if(u.renderPass==="translucent"){var k=p.paint.get("line-opacity"),L=p.paint.get("line-width");if(k.constantOr(1)!==0&&L.constantOr(1)!==0)for(var B=u.depthModeForSublayer(0,ge.ReadOnly),j=u.colorModeForRenderPass(),Y=p.paint.get("line-dasharray"),ie=p.paint.get("line-pattern"),he=ie.constantOr(1),de=p.paint.get("line-gradient"),me=p.getCrossfadeParameters(),Ce=he?"linePattern":Y?"lineSDF":de?"lineGradient":"line",Te=u.context,Le=Te.gl,xe=!0,ze=0,Fe=v;ze<Fe.length;ze+=1){var Ye=Fe[ze],ot=m.getTile(Ye);if(!he||ot.patternsLoaded()){var at=ot.getBucket(p);if(at){var st=at.programConfigurations.get(p.id),It=u.context.program.get(),Lt=u.useProgram(Ce,st),Mt=xe||Lt.program!==It,Yt=ie.constantOr(null);if(Yt&&ot.imageAtlas){var di=ot.imageAtlas,_i=di.patternPositions[Yt.to.toString()],hi=di.patternPositions[Yt.from.toString()];_i&&hi&&st.setConstantPatternPositions(_i,hi)}var ar=he?rs(u,ot,p,me):Y?Cu(u,ot,p,Y,me):de?Vr(u,ot,p,at.lineClipsArray.length):As(u,ot,p);if(he)Te.activeTexture.set(Le.TEXTURE0),ot.imageAtlasTexture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),st.updatePaintBuffers(me);else if(Y&&(Mt||u.lineAtlas.dirty))Te.activeTexture.set(Le.TEXTURE0),u.lineAtlas.bind(Te);else if(de){var ri=at.gradients[p.id],Di=ri.texture;if(p.gradientVersion!==ri.version){var er=256;if(p.stepInterpolant){var zi=m.getSource().maxzoom,Ai=Ye.canonical.z===zi?Math.ceil(1<<u.transform.maxZoom-Ye.canonical.z):1;er=f.clamp(f.nextPowerOfTwo(at.maxLineLength/f.EXTENT*1024*Ai),256,Te.maxTextureSize)}ri.gradient=f.renderColorRamp({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:er,image:ri.gradient||void 0,clips:at.lineClipsArray}),ri.texture?ri.texture.update(ri.gradient):ri.texture=new f.Texture(Te,ri.gradient,Le.RGBA),ri.version=p.gradientVersion,Di=ri.texture}Te.activeTexture.set(Le.TEXTURE0),Di.bind(p.stepInterpolant?Le.NEAREST:Le.LINEAR,Le.CLAMP_TO_EDGE)}Lt.draw(Te,Le.TRIANGLES,B,u.stencilModeForClipping(Ye),j,Ne.disabled,ar,p.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,p.paint,u.transform.zoom,st,at.layoutVertexBuffer2),xe=!1}}}}},fill:function(u,m,p,v){var k=p.paint.get("fill-color"),L=p.paint.get("fill-opacity");if(L.constantOr(1)!==0){var B=u.colorModeForRenderPass(),j=p.paint.get("fill-pattern"),Y=u.opaquePassEnabledForLayer()&&!j.constantOr(1)&&k.constantOr(f.Color.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(u.renderPass===Y){var ie=u.depthModeForSublayer(1,u.renderPass==="opaque"?ge.ReadWrite:ge.ReadOnly);ks(u,m,p,v,ie,B,!1)}if(u.renderPass==="translucent"&&p.paint.get("fill-antialias")){var he=u.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,ge.ReadOnly);ks(u,m,p,v,he,B,!0)}}},"fill-extrusion":function(u,m,p,v){var k=p.paint.get("fill-extrusion-opacity");if(k!==0&&u.renderPass==="translucent"){var L=new ge(u.context.gl.LEQUAL,ge.ReadWrite,u.depthRangeFor3D);if(k!==1||p.paint.get("fill-extrusion-pattern").constantOr(1))ku(u,m,p,v,L,Se.disabled,Oe.disabled),ku(u,m,p,v,L,u.stencilModeFor3D(),u.colorModeForRenderPass());else{var B=u.colorModeForRenderPass();ku(u,m,p,v,L,Se.disabled,B)}}},hillshade:function(u,m,p,v){if(u.renderPass==="offscreen"||u.renderPass==="translucent"){for(var k=u.context,L=u.depthModeForSublayer(0,ge.ReadOnly),B=u.colorModeForRenderPass(),j=u.renderPass==="translucent"?u.stencilConfigForOverlap(v):[{},v],Y=j[0],ie=0,he=j[1];ie<he.length;ie+=1){var de=he[ie],me=m.getTile(de);me.needsHillshadePrepare&&u.renderPass==="offscreen"?Bc(u,me,p,L,Se.disabled,B):u.renderPass==="translucent"&&Jl(u,me,p,L,Y[de.overscaledZ],B)}k.viewport.set([0,0,u.width,u.height])}},raster:function(u,m,p,v){if(u.renderPass==="translucent"&&p.paint.get("raster-opacity")!==0&&v.length)for(var k=u.context,L=k.gl,B=m.getSource(),j=u.useProgram("raster"),Y=u.colorModeForRenderPass(),ie=B instanceof fi?[{},v]:u.stencilConfigForOverlap(v),he=ie[0],de=ie[1],me=de[de.length-1].overscaledZ,Ce=!u.options.moving,Te=0,Le=de;Te<Le.length;Te+=1){var xe=Le[Te],ze=u.depthModeForSublayer(xe.overscaledZ-me,p.paint.get("raster-opacity")===1?ge.ReadWrite:ge.ReadOnly,L.LESS),Fe=m.getTile(xe),Ye=u.transform.calculatePosMatrix(xe.toUnwrapped(),Ce);Fe.registerFadeDuration(p.paint.get("raster-fade-duration"));var ot=m.findLoadedParent(xe,0),at=ss(Fe,ot,m,p,u.transform),st=void 0,It=void 0,Lt=p.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;k.activeTexture.set(L.TEXTURE0),Fe.texture.bind(Lt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),k.activeTexture.set(L.TEXTURE1),ot?(ot.texture.bind(Lt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),st=Math.pow(2,ot.tileID.overscaledZ-Fe.tileID.overscaledZ),It=[Fe.tileID.canonical.x*st%1,Fe.tileID.canonical.y*st%1]):Fe.texture.bind(Lt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST);var Mt=Rc(Ye,It||[0,0],st||1,at,p);B instanceof fi?j.draw(k,L.TRIANGLES,ze,Se.disabled,Y,Ne.disabled,Mt,p.id,B.boundsBuffer,u.quadTriangleIndexBuffer,B.boundsSegments):j.draw(k,L.TRIANGLES,ze,he[xe.overscaledZ],Y,Ne.disabled,Mt,p.id,u.rasterBoundsBuffer,u.quadTriangleIndexBuffer,u.rasterBoundsSegments)}},background:function(u,m,p){var v=p.paint.get("background-color"),k=p.paint.get("background-opacity");if(k!==0){var L=u.context,B=L.gl,j=u.transform,Y=j.tileSize,ie=p.paint.get("background-pattern");if(!u.isPatternMissing(ie)){var he=!ie&&v.a===1&&k===1&&u.opaquePassEnabledForLayer()?"opaque":"translucent";if(u.renderPass===he){var de=Se.disabled,me=u.depthModeForSublayer(0,he==="opaque"?ge.ReadWrite:ge.ReadOnly),Ce=u.colorModeForRenderPass(),Te=u.useProgram(ie?"backgroundPattern":"background"),Le=j.coveringTiles({tileSize:Y});ie&&(L.activeTexture.set(B.TEXTURE0),u.imageManager.bind(u.context));for(var xe=p.getCrossfadeParameters(),ze=0,Fe=Le;ze<Fe.length;ze+=1){var Ye=Fe[ze],ot=u.transform.calculatePosMatrix(Ye.toUnwrapped()),at=ie?as(ot,k,u,ie,{tileID:Ye,tileSize:Y},xe):Cs(ot,k,v);Te.draw(L,B.TRIANGLES,me,de,Ce,Ne.disabled,at,p.id,u.tileExtentBuffer,u.quadTriangleIndexBuffer,u.tileExtentSegments)}}}}},debug:function(u,m,p){for(var v=0;v<p.length;v++)Js(u,m,p[v])},custom:function(u,m,p){var v=u.context,k=p.implementation;if(u.renderPass==="offscreen"){var L=k.prerender;L&&(u.setCustomLayerDefaults(),v.setColorMode(u.colorModeForRenderPass()),L.call(k,v.gl,u.transform.customLayerMatrix()),v.setDirty(),u.setBaseState())}else if(u.renderPass==="translucent"){u.setCustomLayerDefaults(),v.setColorMode(u.colorModeForRenderPass()),v.setStencilMode(Se.disabled);var B=k.renderingMode==="3d"?new ge(u.context.gl.LEQUAL,ge.ReadWrite,u.depthRangeFor3D):u.depthModeForSublayer(0,ge.ReadOnly);v.setDepthMode(B),k.render(v.gl,u.transform.customLayerMatrix()),v.setDirty(),u.setBaseState(),v.bindFramebuffer.set(null)}}},nn=function(u,m){this.context=new ye(u),this.transform=m,this._tileTextures={},this.setup(),this.numSublayers=Pe.maxUnderzooming+Pe.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Fa,this.gpuTimers={}};nn.prototype.resize=function(u,m){if(this.width=u*f.browser.devicePixelRatio,this.height=m*f.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var p=0,v=this.style._order;p<v.length;p+=1)this.style._layers[v[p]].resize()},nn.prototype.setup=function(){var u=this.context,m=new f.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(f.EXTENT,0),m.emplaceBack(0,f.EXTENT),m.emplaceBack(f.EXTENT,f.EXTENT),this.tileExtentBuffer=u.createVertexBuffer(m,bn.members),this.tileExtentSegments=f.SegmentVector.simpleSegment(0,0,4,2);var p=new f.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(f.EXTENT,0),p.emplaceBack(0,f.EXTENT),p.emplaceBack(f.EXTENT,f.EXTENT),this.debugBuffer=u.createVertexBuffer(p,bn.members),this.debugSegments=f.SegmentVector.simpleSegment(0,0,4,5);var v=new f.StructArrayLayout4i8;v.emplaceBack(0,0,0,0),v.emplaceBack(f.EXTENT,0,f.EXTENT,0),v.emplaceBack(0,f.EXTENT,0,f.EXTENT),v.emplaceBack(f.EXTENT,f.EXTENT,f.EXTENT,f.EXTENT),this.rasterBoundsBuffer=u.createVertexBuffer(v,oi.members),this.rasterBoundsSegments=f.SegmentVector.simpleSegment(0,0,4,2);var k=new f.StructArrayLayout2i4;k.emplaceBack(0,0),k.emplaceBack(1,0),k.emplaceBack(0,1),k.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(k,bn.members),this.viewportSegments=f.SegmentVector.simpleSegment(0,0,4,2);var L=new f.StructArrayLayout1ui2;L.emplaceBack(0),L.emplaceBack(1),L.emplaceBack(3),L.emplaceBack(2),L.emplaceBack(0),this.tileBorderIndexBuffer=u.createIndexBuffer(L);var B=new f.StructArrayLayout3ui6;B.emplaceBack(0,1,2),B.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(B),this.emptyTexture=new f.Texture(u,{width:1,height:1,data:new Uint8Array([0,0,0,0])},u.gl.RGBA);var j=this.context.gl;this.stencilClearMode=new Se({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO)},nn.prototype.clearStencil=function(){var u=this.context,m=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var p=f.create();f.ortho(p,0,this.width,this.height,0,0,1),f.scale(p,p,[m.drawingBufferWidth,m.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(u,m.TRIANGLES,ge.disabled,this.stencilClearMode,Oe.disabled,Ne.disabled,Va(p),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},nn.prototype._renderTileClippingMasks=function(u,m){if(this.currentStencilSource!==u.source&&u.isTileClipped()&&m&&m.length){this.currentStencilSource=u.source;var p=this.context,v=p.gl;this.nextStencilID+m.length>256&&this.clearStencil(),p.setColorMode(Oe.disabled),p.setDepthMode(ge.disabled);var k=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var L=0,B=m;L<B.length;L+=1){var j=B[L],Y=this._tileClippingMaskIDs[j.key]=this.nextStencilID++;k.draw(p,v.TRIANGLES,ge.disabled,new Se({func:v.ALWAYS,mask:0},Y,255,v.KEEP,v.KEEP,v.REPLACE),Oe.disabled,Ne.disabled,Va(j.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},nn.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var u=this.nextStencilID++,m=this.context.gl;return new Se({func:m.NOTEQUAL,mask:255},u,255,m.KEEP,m.KEEP,m.REPLACE)},nn.prototype.stencilModeForClipping=function(u){var m=this.context.gl;return new Se({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,m.KEEP,m.KEEP,m.REPLACE)},nn.prototype.stencilConfigForOverlap=function(u){var m,p=this.context.gl,v=u.sort(function(Y,ie){return ie.overscaledZ-Y.overscaledZ}),k=v[v.length-1].overscaledZ,L=v[0].overscaledZ-k+1;if(L>1){this.currentStencilSource=void 0,this.nextStencilID+L>256&&this.clearStencil();for(var B={},j=0;j<L;j++)B[j+k]=new Se({func:p.GEQUAL,mask:255},j+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=L,[B,v]}return[(m={},m[k]=Se.disabled,m),v]},nn.prototype.colorModeForRenderPass=function(){var u=this.context.gl;return this._showOverdrawInspector?new Oe([u.CONSTANT_COLOR,u.ONE],new f.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Oe.unblended:Oe.alphaBlended},nn.prototype.depthModeForSublayer=function(u,m,p){if(!this.opaquePassEnabledForLayer())return ge.disabled;var v=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new ge(p||this.context.gl.LEQUAL,m,[v,v])},nn.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},nn.prototype.render=function(u,m){var p=this;this.style=u,this.options=m,this.lineAtlas=u.lineAtlas,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(f.browser.now()),this.imageManager.beginFrame();var v=this.style._order,k=this.style.sourceCaches;for(var L in k){var B=k[L];B.used&&B.prepare(this.context)}var j,Y,ie={},he={},de={};for(var me in k){var Ce=k[me];ie[me]=Ce.getVisibleCoordinates(),he[me]=ie[me].slice().reverse(),de[me]=Ce.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Te=0;Te<v.length;Te++)if(this.style._layers[v[Te]].is3D()){this.opaquePassCutoff=Te;break}this.renderPass="offscreen";for(var Le=0,xe=v;Le<xe.length;Le+=1){var ze=this.style._layers[xe[Le]];if(ze.hasOffscreenPass()&&!ze.isHidden(this.transform.zoom)){var Fe=he[ze.source];(ze.type==="custom"||Fe.length)&&this.renderLayer(this,k[ze.source],ze,Fe)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:m.showOverdrawInspector?f.Color.black:f.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.depthRangeFor3D=[0,1-(u._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){var Ye=this.style._layers[v[this.currentLayer]],ot=k[Ye.source],at=ie[Ye.source];this._renderTileClippingMasks(Ye,at),this.renderLayer(this,ot,Ye,at)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){var st=this.style._layers[v[this.currentLayer]],It=k[st.source],Lt=(st.type==="symbol"?de:he)[st.source];this._renderTileClippingMasks(st,ie[st.source]),this.renderLayer(this,It,st,Lt)}this.options.showTileBoundaries&&(f.values(this.style._layers).forEach(function(Mt){Mt.source&&!Mt.isHidden(p.transform.zoom)&&(Mt.source!==(Y&&Y.id)&&(Y=p.style.sourceCaches[Mt.source]),(!j||j.getSource().maxzoom<Y.getSource().maxzoom)&&(j=Y))}),j&&oa.debug(this,j,j.getVisibleCoordinates())),this.options.showPadding&&function(Mt){var Yt=Mt.transform.padding;ac(Mt,Mt.transform.height-(Yt.top||0),3,zu),ac(Mt,Yt.bottom||0,3,_l),ls(Mt,Yt.left||0,3,vl),ls(Mt,Mt.transform.width-(Yt.right||0),3,bo);var di=Mt.transform.centerPoint;(function(_i,hi,ar,ri){xl(_i,hi-1,ar-10,2,20,ri),xl(_i,hi-10,ar-1,20,2,ri)})(Mt,di.x,Mt.transform.height-di.y,wo)}(this),this.context.setDefault()},nn.prototype.renderLayer=function(u,m,p,v){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="custom"||v.length)&&(this.id=p.id,this.gpuTimingStart(p),oa[p.type](u,m,p,v,this.style.placement.variableOffsets),this.gpuTimingEnd())},nn.prototype.gpuTimingStart=function(u){if(this.options.gpuTiming){var m=this.context.extTimerQuery,p=this.gpuTimers[u.id];p||(p=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),p.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,p.query)}},nn.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}},nn.prototype.collectGpuTimers=function(){var u=this.gpuTimers;return this.gpuTimers={},u},nn.prototype.queryGpuTimers=function(u){var m={};for(var p in u){var v=u[p],k=this.context.extTimerQuery,L=k.getQueryObjectEXT(v.query,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(v.query),m[p]=L}return m},nn.prototype.translatePosMatrix=function(u,m,p,v,k){if(!p[0]&&!p[1])return u;var L=k?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(L){var B=Math.sin(L),j=Math.cos(L);p=[p[0]*j-p[1]*B,p[0]*B+p[1]*j]}var Y=[k?p[0]:Wr(m,p[0],this.transform.zoom),k?p[1]:Wr(m,p[1],this.transform.zoom),0],ie=new Float32Array(16);return f.translate(ie,u,Y),ie},nn.prototype.saveTileTexture=function(u){var m=this._tileTextures[u.size[0]];m?m.push(u):this._tileTextures[u.size[0]]=[u]},nn.prototype.getTileTexture=function(u){var m=this._tileTextures[u];return m&&m.length>0?m.pop():null},nn.prototype.isPatternMissing=function(u){if(!u)return!1;if(!u.from||!u.to)return!0;var m=this.imageManager.getPattern(u.from.toString()),p=this.imageManager.getPattern(u.to.toString());return!m||!p},nn.prototype.useProgram=function(u,m){this.cache=this.cache||{};var p=""+u+(m?m.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[p]||(this.cache[p]=new Tu(this.context,u,Hs[u],m,oc[u],this._showOverdrawInspector)),this.cache[p]},nn.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},nn.prototype.setBaseState=function(){var u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)},nn.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=f.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new f.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},nn.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var bl=function(u,m){this.points=u,this.planes=m};bl.fromInvProjectionMatrix=function(u,m,p){var v=Math.pow(2,p),k=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(B){return f.transformMat4([],B,u)}).map(function(B){return f.scale$1([],B,1/B[3]/m*v)}),L=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(B){var j=f.sub([],k[B[0]],k[B[1]]),Y=f.sub([],k[B[2]],k[B[1]]),ie=f.normalize([],f.cross([],j,Y)),he=-f.dot(ie,k[B[1]]);return ie.concat(he)});return new bl(k,L)};var Ys=function(u,m){this.min=u,this.max=m,this.center=f.scale$2([],f.add([],this.min,this.max),.5)};Ys.prototype.quadrant=function(u){for(var m=[u%2==0,u<2],p=f.clone$2(this.min),v=f.clone$2(this.max),k=0;k<m.length;k++)p[k]=m[k]?this.min[k]:this.center[k],v[k]=m[k]?this.center[k]:this.max[k];return v[2]=this.max[2],new Ys(p,v)},Ys.prototype.distanceX=function(u){return Math.max(Math.min(this.max[0],u[0]),this.min[0])-u[0]},Ys.prototype.distanceY=function(u){return Math.max(Math.min(this.max[1],u[1]),this.min[1])-u[1]},Ys.prototype.intersects=function(u){for(var m=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],p=!0,v=0;v<u.planes.length;v++){for(var k=u.planes[v],L=0,B=0;B<m.length;B++)L+=f.dot$1(k,m[B])>=0;if(L===0)return 0;L!==m.length&&(p=!1)}if(p)return 2;for(var j=0;j<3;j++){for(var Y=Number.MAX_VALUE,ie=-Number.MAX_VALUE,he=0;he<u.points.length;he++){var de=u.points[he][j]-this.min[j];Y=Math.min(Y,de),ie=Math.max(ie,de)}if(ie<0||Y>this.max[j]-this.min[j])return 0}return 1};var us=function(u,m,p,v){if(u===void 0&&(u=0),m===void 0&&(m=0),p===void 0&&(p=0),v===void 0&&(v=0),isNaN(u)||u<0||isNaN(m)||m<0||isNaN(p)||p<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=m,this.left=p,this.right=v};us.prototype.interpolate=function(u,m,p){return m.top!=null&&u.top!=null&&(this.top=f.number(u.top,m.top,p)),m.bottom!=null&&u.bottom!=null&&(this.bottom=f.number(u.bottom,m.bottom,p)),m.left!=null&&u.left!=null&&(this.left=f.number(u.left,m.left,p)),m.right!=null&&u.right!=null&&(this.right=f.number(u.right,m.right,p)),this},us.prototype.getCenter=function(u,m){var p=f.clamp((this.left+u-this.right)/2,0,u),v=f.clamp((this.top+m-this.bottom)/2,0,m);return new f.Point(p,v)},us.prototype.equals=function(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right},us.prototype.clone=function(){return new us(this.top,this.bottom,this.left,this.right)},us.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Qi=function(u,m,p,v,k){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=k===void 0||k,this._minZoom=u||0,this._maxZoom=m||22,this._minPitch=p==null?0:p,this._maxPitch=v==null?60:v,this.setMaxBounds(),this.width=0,this.height=0,this._center=new f.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new us,this._posMatrixCache={},this._alignedPosMatrixCache={}},kr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Qi.prototype.clone=function(){var u=new Qi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return u.tileSize=this.tileSize,u.latRange=this.latRange,u.width=this.width,u.height=this.height,u._center=this._center,u.zoom=this.zoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._calcMatrices(),u},kr.minZoom.get=function(){return this._minZoom},kr.minZoom.set=function(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))},kr.maxZoom.get=function(){return this._maxZoom},kr.maxZoom.set=function(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))},kr.minPitch.get=function(){return this._minPitch},kr.minPitch.set=function(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))},kr.maxPitch.get=function(){return this._maxPitch},kr.maxPitch.set=function(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))},kr.renderWorldCopies.get=function(){return this._renderWorldCopies},kr.renderWorldCopies.set=function(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u},kr.worldSize.get=function(){return this.tileSize*this.scale},kr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},kr.size.get=function(){return new f.Point(this.width,this.height)},kr.bearing.get=function(){return-this.angle/Math.PI*180},kr.bearing.set=function(u){var m=-f.wrap(u,-180,180)*Math.PI/180;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=f.create$2(),f.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},kr.pitch.get=function(){return this._pitch/Math.PI*180},kr.pitch.set=function(u){var m=f.clamp(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())},kr.fov.get=function(){return this._fov/Math.PI*180},kr.fov.set=function(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=u/180*Math.PI,this._calcMatrices())},kr.zoom.get=function(){return this._zoom},kr.zoom.set=function(u){var m=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._zoom=m,this.scale=this.zoomScale(m),this.tileZoom=Math.floor(m),this.zoomFraction=m-this.tileZoom,this._constrain(),this._calcMatrices())},kr.center.get=function(){return this._center},kr.center.set=function(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._constrain(),this._calcMatrices())},kr.padding.get=function(){return this._edgeInsets.toJSON()},kr.padding.set=function(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())},kr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Qi.prototype.isPaddingEqual=function(u){return this._edgeInsets.equals(u)},Qi.prototype.interpolatePadding=function(u,m,p){this._unmodified=!1,this._edgeInsets.interpolate(u,m,p),this._constrain(),this._calcMatrices()},Qi.prototype.coveringZoomLevel=function(u){var m=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,m)},Qi.prototype.getVisibleUnwrappedCoordinates=function(u){var m=[new f.UnwrappedTileID(0,u)];if(this._renderWorldCopies)for(var p=this.pointCoordinate(new f.Point(0,0)),v=this.pointCoordinate(new f.Point(this.width,0)),k=this.pointCoordinate(new f.Point(this.width,this.height)),L=this.pointCoordinate(new f.Point(0,this.height)),B=Math.floor(Math.min(p.x,v.x,k.x,L.x)),j=Math.floor(Math.max(p.x,v.x,k.x,L.x)),Y=B-1;Y<=j+1;Y++)Y!==0&&m.push(new f.UnwrappedTileID(Y,u));return m},Qi.prototype.coveringTiles=function(u){var m=this.coveringZoomLevel(u),p=m;if(u.minzoom!==void 0&&m<u.minzoom)return[];u.maxzoom!==void 0&&m>u.maxzoom&&(m=u.maxzoom);var v=f.MercatorCoordinate.fromLngLat(this.center),k=Math.pow(2,m),L=[k*v.x,k*v.y,0],B=bl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m),j=u.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(j=m);var Y=function(Mt){return{aabb:new Ys([Mt*k,0,0],[(Mt+1)*k,k,0]),zoom:0,x:0,y:0,wrap:Mt,fullyVisible:!1}},ie=[],he=[],de=m,me=u.reparseOverscaled?p:m;if(this._renderWorldCopies)for(var Ce=1;Ce<=3;Ce++)ie.push(Y(-Ce)),ie.push(Y(Ce));for(ie.push(Y(0));ie.length>0;){var Te=ie.pop(),Le=Te.x,xe=Te.y,ze=Te.fullyVisible;if(!ze){var Fe=Te.aabb.intersects(B);if(Fe===0)continue;ze=Fe===2}var Ye=Te.aabb.distanceX(L),ot=Te.aabb.distanceY(L),at=Math.max(Math.abs(Ye),Math.abs(ot));if(Te.zoom===de||at>3+(1<<de-Te.zoom)-2&&Te.zoom>=j)he.push({tileID:new f.OverscaledTileID(Te.zoom===de?me:Te.zoom,Te.wrap,Te.zoom,Le,xe),distanceSq:f.sqrLen([L[0]-.5-Le,L[1]-.5-xe])});else for(var st=0;st<4;st++){var It=(Le<<1)+st%2,Lt=(xe<<1)+(st>>1);ie.push({aabb:Te.aabb.quadrant(st),zoom:Te.zoom+1,x:It,y:Lt,wrap:Te.wrap,fullyVisible:ze})}}return he.sort(function(Mt,Yt){return Mt.distanceSq-Yt.distanceSq}).map(function(Mt){return Mt.tileID})},Qi.prototype.resize=function(u,m){this.width=u,this.height=m,this.pixelsToGLUnits=[2/u,-2/m],this._constrain(),this._calcMatrices()},kr.unmodified.get=function(){return this._unmodified},Qi.prototype.zoomScale=function(u){return Math.pow(2,u)},Qi.prototype.scaleZoom=function(u){return Math.log(u)/Math.LN2},Qi.prototype.project=function(u){var m=f.clamp(u.lat,-this.maxValidLatitude,this.maxValidLatitude);return new f.Point(f.mercatorXfromLng(u.lng)*this.worldSize,f.mercatorYfromLat(m)*this.worldSize)},Qi.prototype.unproject=function(u){return new f.MercatorCoordinate(u.x/this.worldSize,u.y/this.worldSize).toLngLat()},kr.point.get=function(){return this.project(this.center)},Qi.prototype.setLocationAtPoint=function(u,m){var p=this.pointCoordinate(m),v=this.pointCoordinate(this.centerPoint),k=this.locationCoordinate(u),L=new f.MercatorCoordinate(k.x-(p.x-v.x),k.y-(p.y-v.y));this.center=this.coordinateLocation(L),this._renderWorldCopies&&(this.center=this.center.wrap())},Qi.prototype.locationPoint=function(u){return this.coordinatePoint(this.locationCoordinate(u))},Qi.prototype.pointLocation=function(u){return this.coordinateLocation(this.pointCoordinate(u))},Qi.prototype.locationCoordinate=function(u){return f.MercatorCoordinate.fromLngLat(u)},Qi.prototype.coordinateLocation=function(u){return u.toLngLat()},Qi.prototype.pointCoordinate=function(u){var m=[u.x,u.y,0,1],p=[u.x,u.y,1,1];f.transformMat4(m,m,this.pixelMatrixInverse),f.transformMat4(p,p,this.pixelMatrixInverse);var v=m[3],k=p[3],L=m[1]/v,B=p[1]/k,j=m[2]/v,Y=p[2]/k,ie=j===Y?0:(0-j)/(Y-j);return new f.MercatorCoordinate(f.number(m[0]/v,p[0]/k,ie)/this.worldSize,f.number(L,B,ie)/this.worldSize)},Qi.prototype.coordinatePoint=function(u){var m=[u.x*this.worldSize,u.y*this.worldSize,0,1];return f.transformMat4(m,m,this.pixelMatrix),new f.Point(m[0]/m[3],m[1]/m[3])},Qi.prototype.getBounds=function(){return new f.LngLatBounds().extend(this.pointLocation(new f.Point(0,0))).extend(this.pointLocation(new f.Point(this.width,0))).extend(this.pointLocation(new f.Point(this.width,this.height))).extend(this.pointLocation(new f.Point(0,this.height)))},Qi.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new f.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Qi.prototype.setMaxBounds=function(u){u?(this.lngRange=[u.getWest(),u.getEast()],this.latRange=[u.getSouth(),u.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Qi.prototype.calculatePosMatrix=function(u,m){m===void 0&&(m=!1);var p=u.key,v=m?this._alignedPosMatrixCache:this._posMatrixCache;if(v[p])return v[p];var k=u.canonical,L=this.worldSize/this.zoomScale(k.z),B=k.x+Math.pow(2,k.z)*u.wrap,j=f.identity(new Float64Array(16));return f.translate(j,j,[B*L,k.y*L,0]),f.scale(j,j,[L/f.EXTENT,L/f.EXTENT,1]),f.multiply(j,m?this.alignedProjMatrix:this.projMatrix,j),v[p]=new Float32Array(j),v[p]},Qi.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Qi.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var u,m,p,v,k=-90,L=90,B=-180,j=180,Y=this.size,ie=this._unmodified;if(this.latRange){var he=this.latRange;k=f.mercatorYfromLat(he[1])*this.worldSize,u=(L=f.mercatorYfromLat(he[0])*this.worldSize)-k<Y.y?Y.y/(L-k):0}if(this.lngRange){var de=this.lngRange;B=f.mercatorXfromLng(de[0])*this.worldSize,m=(j=f.mercatorXfromLng(de[1])*this.worldSize)-B<Y.x?Y.x/(j-B):0}var me=this.point,Ce=Math.max(m||0,u||0);if(Ce)return this.center=this.unproject(new f.Point(m?(j+B)/2:me.x,u?(L+k)/2:me.y)),this.zoom+=this.scaleZoom(Ce),this._unmodified=ie,void(this._constraining=!1);if(this.latRange){var Te=me.y,Le=Y.y/2;Te-Le<k&&(v=k+Le),Te+Le>L&&(v=L-Le)}if(this.lngRange){var xe=me.x,ze=Y.x/2;xe-ze<B&&(p=B+ze),xe+ze>j&&(p=j-ze)}p===void 0&&v===void 0||(this.center=this.unproject(new f.Point(p!==void 0?p:me.x,v!==void 0?v:me.y))),this._unmodified=ie,this._constraining=!1}},Qi.prototype._calcMatrices=function(){if(this.height){var u=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var m=Math.PI/2+this._pitch,p=this._fov*(.5+u.y/this.height),v=Math.sin(p)*this.cameraToCenterDistance/Math.sin(f.clamp(Math.PI-m-p,.01,Math.PI-.01)),k=this.point,L=k.x,B=k.y,j=1.01*(Math.cos(Math.PI/2-this._pitch)*v+this.cameraToCenterDistance),Y=this.height/50,ie=new Float64Array(16);f.perspective(ie,this._fov,this.width/this.height,Y,j),ie[8]=2*-u.x/this.width,ie[9]=2*u.y/this.height,f.scale(ie,ie,[1,-1,1]),f.translate(ie,ie,[0,0,-this.cameraToCenterDistance]),f.rotateX(ie,ie,this._pitch),f.rotateZ(ie,ie,this.angle),f.translate(ie,ie,[-L,-B,0]),this.mercatorMatrix=f.scale([],ie,[this.worldSize,this.worldSize,this.worldSize]),f.scale(ie,ie,[1,1,f.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=ie,this.invProjMatrix=f.invert([],this.projMatrix);var he=this.width%2/2,de=this.height%2/2,me=Math.cos(this.angle),Ce=Math.sin(this.angle),Te=L-Math.round(L)+me*he+Ce*de,Le=B-Math.round(B)+me*de+Ce*he,xe=new Float64Array(ie);if(f.translate(xe,xe,[Te>.5?Te-1:Te,Le>.5?Le-1:Le,0]),this.alignedProjMatrix=xe,ie=f.create(),f.scale(ie,ie,[this.width/2,-this.height/2,1]),f.translate(ie,ie,[1,-1,0]),this.labelPlaneMatrix=ie,ie=f.create(),f.scale(ie,ie,[1,-1,1]),f.translate(ie,ie,[-1,-1,0]),f.scale(ie,ie,[2/this.width,2/this.height,1]),this.glCoordMatrix=ie,this.pixelMatrix=f.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(ie=f.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=ie,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Qi.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var u=this.pointCoordinate(new f.Point(0,0)),m=[u.x*this.worldSize,u.y*this.worldSize,0,1];return f.transformMat4(m,m,this.pixelMatrix)[3]/this.cameraToCenterDistance},Qi.prototype.getCameraPoint=function(){var u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new f.Point(0,u))},Qi.prototype.getCameraQueryGeometry=function(u){var m=this.getCameraPoint();if(u.length===1)return[u[0],m];for(var p=m.x,v=m.y,k=m.x,L=m.y,B=0,j=u;B<j.length;B+=1){var Y=j[B];p=Math.min(p,Y.x),v=Math.min(v,Y.y),k=Math.max(k,Y.x),L=Math.max(L,Y.y)}return[new f.Point(p,v),new f.Point(k,v),new f.Point(k,L),new f.Point(p,L),new f.Point(p,v)]},Object.defineProperties(Qi.prototype,kr);var Jt=function(u){var m,p,v,k;this._hashName=u&&encodeURIComponent(u),f.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(m=this._updateHashUnthrottled.bind(this),p=!1,v=null,k=function(){v=null,p&&(m(),v=setTimeout(k,300),p=!1)},function(){return p=!0,v||k(),v})};Jt.prototype.addTo=function(u){return this._map=u,f.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Jt.prototype.remove=function(){return f.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Jt.prototype.getHashString=function(u){var m=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,v=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),k=Math.pow(10,v),L=Math.round(m.lng*k)/k,B=Math.round(m.lat*k)/k,j=this._map.getBearing(),Y=this._map.getPitch(),ie="";if(ie+=u?"/"+L+"/"+B+"/"+p:p+"/"+B+"/"+L,(j||Y)&&(ie+="/"+Math.round(10*j)/10),Y&&(ie+="/"+Math.round(Y)),this._hashName){var he=this._hashName,de=!1,me=f.window.location.hash.slice(1).split("&").map(function(Ce){var Te=Ce.split("=")[0];return Te===he?(de=!0,Te+"="+ie):Ce}).filter(function(Ce){return Ce});return de||me.push(he+"="+ie),"#"+me.join("&")}return"#"+ie},Jt.prototype._getCurrentHash=function(){var u,m=this,p=f.window.location.hash.replace("#","");return this._hashName?(p.split("&").map(function(v){return v.split("=")}).forEach(function(v){v[0]===m._hashName&&(u=v)}),(u&&u[1]||"").split("/")):p.split("/")},Jt.prototype._onHashChange=function(){var u=this._getCurrentHash();if(u.length>=3&&!u.some(function(p){return isNaN(p)})){var m=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:m,pitch:+(u[4]||0)}),!0}return!1},Jt.prototype._updateHashUnthrottled=function(){var u=f.window.location.href.replace(/(#.+)?$/,this.getHashString());try{f.window.history.replaceState(f.window.history.state,null,u)}catch{}};var $s={linearity:.3,easing:f.bezier(0,0,.3,1)},Ga=f.extend({deceleration:2500,maxSpeed:1400},$s),Aa=f.extend({deceleration:20,maxSpeed:1400},$s),Yl=f.extend({deceleration:1e3,maxSpeed:360},$s),ii=f.extend({deceleration:1e3,maxSpeed:90},$s),Qs=function(u){this._map=u,this.clear()};function wl(u,m){(!u.duration||u.duration<m.duration)&&(u.duration=m.duration,u.easing=m.easing)}function cs(u,m,p){var v=p.maxSpeed,k=p.linearity,L=p.deceleration,B=f.clamp(u*k/(m/1e3),-v,v),j=Math.abs(B)/(L*k);return{easing:p.easing,duration:1e3*j,amount:B*(j/2)}}Qs.prototype.clear=function(){this._inertiaBuffer=[]},Qs.prototype.record=function(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:f.browser.now(),settings:u})},Qs.prototype._drainInertiaBuffer=function(){for(var u=this._inertiaBuffer,m=f.browser.now();u.length>0&&m-u[0].time>160;)u.shift()},Qs.prototype._onMoveEnd=function(u){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var m={zoom:0,bearing:0,pitch:0,pan:new f.Point(0,0),pinchAround:void 0,around:void 0},p=0,v=this._inertiaBuffer;p<v.length;p+=1){var k=v[p].settings;m.zoom+=k.zoomDelta||0,m.bearing+=k.bearingDelta||0,m.pitch+=k.pitchDelta||0,k.panDelta&&m.pan._add(k.panDelta),k.around&&(m.around=k.around),k.pinchAround&&(m.pinchAround=k.pinchAround)}var L=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,B={};if(m.pan.mag()){var j=cs(m.pan.mag(),L,f.extend({},Ga,u||{}));B.offset=m.pan.mult(j.amount/m.pan.mag()),B.center=this._map.transform.center,wl(B,j)}if(m.zoom){var Y=cs(m.zoom,L,Aa);B.zoom=this._map.transform.zoom+Y.amount,wl(B,Y)}if(m.bearing){var ie=cs(m.bearing,L,Yl);B.bearing=this._map.transform.bearing+f.clamp(ie.amount,-179,179),wl(B,ie)}if(m.pitch){var he=cs(m.pitch,L,ii);B.pitch=this._map.transform.pitch+he.amount,wl(B,he)}if(B.zoom||B.bearing){var de=m.pinchAround===void 0?m.around:m.pinchAround;B.around=de?this._map.unproject(de):this._map.getCenter()}return this.clear(),f.extend(B,{noMoveStart:!0})}};var ln=function(u){function m(v,k,L,B){B===void 0&&(B={});var j=R.mousePos(k.getCanvasContainer(),L),Y=k.unproject(j);u.call(this,v,f.extend({point:j,lngLat:Y,originalEvent:L},B)),this._defaultPrevented=!1,this.target=k}u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m;var p={defaultPrevented:{configurable:!0}};return m.prototype.preventDefault=function(){this._defaultPrevented=!0},p.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(m.prototype,p),m}(f.Event),El=function(u){function m(v,k,L){var B=v==="touchend"?L.changedTouches:L.touches,j=R.touchPos(k.getCanvasContainer(),B),Y=j.map(function(de){return k.unproject(de)}),ie=j.reduce(function(de,me,Ce,Te){return de.add(me.div(Te.length))},new f.Point(0,0)),he=k.unproject(ie);u.call(this,v,{points:j,point:ie,lngLats:Y,lngLat:he,originalEvent:L}),this._defaultPrevented=!1}u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m;var p={defaultPrevented:{configurable:!0}};return m.prototype.preventDefault=function(){this._defaultPrevented=!0},p.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(m.prototype,p),m}(f.Event),sc=function(u){function m(v,k,L){u.call(this,v,{originalEvent:L}),this._defaultPrevented=!1}u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m;var p={defaultPrevented:{configurable:!0}};return m.prototype.preventDefault=function(){this._defaultPrevented=!0},p.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(m.prototype,p),m}(f.Event),Tn=function(u,m){this._map=u,this._clickTolerance=m.clickTolerance};Tn.prototype.reset=function(){delete this._mousedownPos},Tn.prototype.wheel=function(u){return this._firePreventable(new sc(u.type,this._map,u))},Tn.prototype.mousedown=function(u,m){return this._mousedownPos=m,this._firePreventable(new ln(u.type,this._map,u))},Tn.prototype.mouseup=function(u){this._map.fire(new ln(u.type,this._map,u))},Tn.prototype.click=function(u,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||this._map.fire(new ln(u.type,this._map,u))},Tn.prototype.dblclick=function(u){return this._firePreventable(new ln(u.type,this._map,u))},Tn.prototype.mouseover=function(u){this._map.fire(new ln(u.type,this._map,u))},Tn.prototype.mouseout=function(u){this._map.fire(new ln(u.type,this._map,u))},Tn.prototype.touchstart=function(u){return this._firePreventable(new El(u.type,this._map,u))},Tn.prototype.touchmove=function(u){this._map.fire(new El(u.type,this._map,u))},Tn.prototype.touchend=function(u){this._map.fire(new El(u.type,this._map,u))},Tn.prototype.touchcancel=function(u){this._map.fire(new El(u.type,this._map,u))},Tn.prototype._firePreventable=function(u){if(this._map.fire(u),u.defaultPrevented)return{}},Tn.prototype.isEnabled=function(){return!0},Tn.prototype.isActive=function(){return!1},Tn.prototype.enable=function(){},Tn.prototype.disable=function(){};var ni=function(u){this._map=u};ni.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ni.prototype.mousemove=function(u){this._map.fire(new ln(u.type,this._map,u))},ni.prototype.mousedown=function(){this._delayContextMenu=!0},ni.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ln("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ni.prototype.contextmenu=function(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new ln(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()},ni.prototype.isEnabled=function(){return!0},ni.prototype.isActive=function(){return!1},ni.prototype.enable=function(){},ni.prototype.disable=function(){};var fo=function(u,m){this._map=u,this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=m.clickTolerance||1};function Il(u,m){for(var p={},v=0;v<u.length;v++)p[u[v].identifier]=m[v];return p}fo.prototype.isEnabled=function(){return!!this._enabled},fo.prototype.isActive=function(){return!!this._active},fo.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},fo.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},fo.prototype.mousedown=function(u,m){this.isEnabled()&&u.shiftKey&&u.button===0&&(R.disableDrag(),this._startPos=this._lastPos=m,this._active=!0)},fo.prototype.mousemoveWindow=function(u,m){if(this._active){var p=m;if(!(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)){var v=this._startPos;this._lastPos=p,this._box||(this._box=R.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));var k=Math.min(v.x,p.x),L=Math.max(v.x,p.x),B=Math.min(v.y,p.y),j=Math.max(v.y,p.y);R.setTransform(this._box,"translate("+k+"px,"+B+"px)"),this._box.style.width=L-k+"px",this._box.style.height=j-B+"px"}}},fo.prototype.mouseupWindow=function(u,m){var p=this;if(this._active&&u.button===0){var v=this._startPos,k=m;if(this.reset(),R.suppressClick(),v.x!==k.x||v.y!==k.y)return this._map.fire(new f.Event("boxzoomend",{originalEvent:u})),{cameraAnimation:function(L){return L.fitScreenCoordinates(v,k,p._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",u)}},fo.prototype.keydown=function(u){this._active&&u.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",u))},fo.prototype.blur=function(){this.reset()},fo.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(R.remove(this._box),this._box=null),R.enableDrag(),delete this._startPos,delete this._lastPos},fo.prototype._fireEvent=function(u,m){return this._map.fire(new f.Event(u,{originalEvent:m}))};var zs=function(u){this.reset(),this.numTouches=u.numTouches};zs.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},zs.prototype.touchstart=function(u,m,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=u.timeStamp),p.length===this.numTouches&&(this.centroid=function(v){for(var k=new f.Point(0,0),L=0,B=v;L<B.length;L+=1)k._add(B[L]);return k.div(v.length)}(m),this.touches=Il(p,m)))},zs.prototype.touchmove=function(u,m,p){if(!this.aborted&&this.centroid){var v=Il(p,m);for(var k in this.touches){var L=v[k];(!L||L.dist(this.touches[k])>30)&&(this.aborted=!0)}}},zs.prototype.touchend=function(u,m,p){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){var v=!this.aborted&&this.centroid;if(this.reset(),v)return v}};var aa=function(u){this.singleTap=new zs(u),this.numTaps=u.numTaps,this.reset()};aa.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},aa.prototype.touchstart=function(u,m,p){this.singleTap.touchstart(u,m,p)},aa.prototype.touchmove=function(u,m,p){this.singleTap.touchmove(u,m,p)},aa.prototype.touchend=function(u,m,p){var v=this.singleTap.touchend(u,m,p);if(v){var k=u.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(v)<30;if(k&&L||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}};var on=function(){this._zoomIn=new aa({numTouches:1,numTaps:2}),this._zoomOut=new aa({numTouches:2,numTaps:1}),this.reset()};on.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},on.prototype.touchstart=function(u,m,p){this._zoomIn.touchstart(u,m,p),this._zoomOut.touchstart(u,m,p)},on.prototype.touchmove=function(u,m,p){this._zoomIn.touchmove(u,m,p),this._zoomOut.touchmove(u,m,p)},on.prototype.touchend=function(u,m,p){var v=this,k=this._zoomIn.touchend(u,m,p),L=this._zoomOut.touchend(u,m,p);return k?(this._active=!0,u.preventDefault(),setTimeout(function(){return v.reset()},0),{cameraAnimation:function(B){return B.easeTo({duration:300,zoom:B.getZoom()+1,around:B.unproject(k)},{originalEvent:u})}}):L?(this._active=!0,u.preventDefault(),setTimeout(function(){return v.reset()},0),{cameraAnimation:function(B){return B.easeTo({duration:300,zoom:B.getZoom()-1,around:B.unproject(L)},{originalEvent:u})}}):void 0},on.prototype.touchcancel=function(){this.reset()},on.prototype.enable=function(){this._enabled=!0},on.prototype.disable=function(){this._enabled=!1,this.reset()},on.prototype.isEnabled=function(){return this._enabled},on.prototype.isActive=function(){return this._active};var Za={0:1,2:2},Vt=function(u){this.reset(),this._clickTolerance=u.clickTolerance||1};Vt.prototype.blur=function(){this.reset()},Vt.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Vt.prototype._correctButton=function(u,m){return!1},Vt.prototype._move=function(u,m){return{}},Vt.prototype.mousedown=function(u,m){if(!this._lastPoint){var p=R.mouseButton(u);this._correctButton(u,p)&&(this._lastPoint=m,this._eventButton=p)}},Vt.prototype.mousemoveWindow=function(u,m){var p=this._lastPoint;if(p){if(u.preventDefault(),function(v,k){var L=Za[k];return v.buttons===void 0||(v.buttons&L)!==L}(u,this._eventButton))this.reset();else if(this._moved||!(m.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(p,m)}},Vt.prototype.mouseupWindow=function(u){this._lastPoint&&R.mouseButton(u)===this._eventButton&&(this._moved&&R.suppressClick(),this.reset())},Vt.prototype.enable=function(){this._enabled=!0},Vt.prototype.disable=function(){this._enabled=!1,this.reset()},Vt.prototype.isEnabled=function(){return this._enabled},Vt.prototype.isActive=function(){return this._active};var $l=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.mousedown=function(p,v){u.prototype.mousedown.call(this,p,v),this._lastPoint&&(this._active=!0)},m.prototype._correctButton=function(p,v){return v===0&&!p.ctrlKey},m.prototype._move=function(p,v){return{around:v,panDelta:v.sub(p)}},m}(Vt),hs=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype._correctButton=function(p,v){return v===0&&p.ctrlKey||v===2},m.prototype._move=function(p,v){var k=.8*(v.x-p.x);if(k)return this._active=!0,{bearingDelta:k}},m.prototype.contextmenu=function(p){p.preventDefault()},m}(Vt),Ql=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype._correctButton=function(p,v){return v===0&&p.ctrlKey||v===2},m.prototype._move=function(p,v){var k=-.5*(v.y-p.y);if(k)return this._active=!0,{pitchDelta:k}},m.prototype.contextmenu=function(p){p.preventDefault()},m}(Vt),Ro=function(u){this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset()};Ro.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new f.Point(0,0)},Ro.prototype.touchstart=function(u,m,p){return this._calculateTransform(u,m,p)},Ro.prototype.touchmove=function(u,m,p){if(this._active&&!(p.length<this._minTouches))return u.preventDefault(),this._calculateTransform(u,m,p)},Ro.prototype.touchend=function(u,m,p){this._calculateTransform(u,m,p),this._active&&p.length<this._minTouches&&this.reset()},Ro.prototype.touchcancel=function(){this.reset()},Ro.prototype._calculateTransform=function(u,m,p){p.length>0&&(this._active=!0);var v=Il(p,m),k=new f.Point(0,0),L=new f.Point(0,0),B=0;for(var j in v){var Y=v[j],ie=this._touches[j];ie&&(k._add(Y),L._add(Y.sub(ie)),B++,v[j]=Y)}if(this._touches=v,!(B<this._minTouches)&&L.mag()){var he=L.div(B);if(this._sum._add(he),!(this._sum.mag()<this._clickTolerance))return{around:k.div(B),panDelta:he}}},Ro.prototype.enable=function(){this._enabled=!0},Ro.prototype.disable=function(){this._enabled=!1,this.reset()},Ro.prototype.isEnabled=function(){return this._enabled},Ro.prototype.isActive=function(){return this._active};var un=function(){this.reset()};function Yr(u,m,p){for(var v=0;v<u.length;v++)if(u[v].identifier===p)return m[v]}function el(u,m){return Math.log(u/m)/Math.LN2}un.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},un.prototype._start=function(u){},un.prototype._move=function(u,m,p){return{}},un.prototype.touchstart=function(u,m,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([m[0],m[1]]))},un.prototype.touchmove=function(u,m,p){if(this._firstTwoTouches){u.preventDefault();var v=this._firstTwoTouches,k=v[1],L=Yr(p,m,v[0]),B=Yr(p,m,k);if(L&&B){var j=this._aroundCenter?null:L.add(B).div(2);return this._move([L,B],j,u)}}},un.prototype.touchend=function(u,m,p){if(this._firstTwoTouches){var v=this._firstTwoTouches,k=v[1],L=Yr(p,m,v[0]),B=Yr(p,m,k);L&&B||(this._active&&R.suppressClick(),this.reset())}},un.prototype.touchcancel=function(){this.reset()},un.prototype.enable=function(u){this._enabled=!0,this._aroundCenter=!!u&&u.around==="center"},un.prototype.disable=function(){this._enabled=!1,this.reset()},un.prototype.isEnabled=function(){return this._enabled},un.prototype.isActive=function(){return this._active};var mo=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.reset=function(){u.prototype.reset.call(this),delete this._distance,delete this._startDistance},m.prototype._start=function(p){this._startDistance=this._distance=p[0].dist(p[1])},m.prototype._move=function(p,v){var k=this._distance;if(this._distance=p[0].dist(p[1]),this._active||!(Math.abs(el(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:el(this._distance,k),pinchAround:v}},m}(un);function Ca(u,m){return 180*u.angleWith(m)/Math.PI}var lc=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.reset=function(){u.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},m.prototype._start=function(p){this._startVector=this._vector=p[0].sub(p[1]),this._minDiameter=p[0].dist(p[1])},m.prototype._move=function(p,v){var k=this._vector;if(this._vector=p[0].sub(p[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ca(this._vector,k),pinchAround:v}},m.prototype._isBelowThreshold=function(p){this._minDiameter=Math.min(this._minDiameter,p.mag());var v=25/(Math.PI*this._minDiameter)*360,k=Ca(p,this._startVector);return Math.abs(k)<v},m}(un);function Sl(u){return Math.abs(u.y)>Math.abs(u.x)}var uc=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.reset=function(){u.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},m.prototype._start=function(p){this._lastPoints=p,Sl(p[0].sub(p[1]))&&(this._valid=!1)},m.prototype._move=function(p,v,k){var L=p[0].sub(this._lastPoints[0]),B=p[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(L,B,k.timeStamp),this._valid)return this._lastPoints=p,this._active=!0,{pitchDelta:(L.y+B.y)/2*-.5}},m.prototype.gestureBeginsVertically=function(p,v,k){if(this._valid!==void 0)return this._valid;var L=p.mag()>=2,B=v.mag()>=2;if(L||B){if(!L||!B)return this._firstMove===void 0&&(this._firstMove=k),k-this._firstMove<100&&void 0;var j=p.y>0==v.y>0;return Sl(p)&&Sl(v)&&j}},m}(un),ga={panStep:100,bearingStep:15,pitchStep:10},qo=function(){var u=ga;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1};function ai(u){return u*(2-u)}qo.prototype.blur=function(){this.reset()},qo.prototype.reset=function(){this._active=!1},qo.prototype.keydown=function(u){var m=this;if(!(u.altKey||u.ctrlKey||u.metaKey)){var p=0,v=0,k=0,L=0,B=0;switch(u.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:u.shiftKey?v=-1:(u.preventDefault(),L=-1);break;case 39:u.shiftKey?v=1:(u.preventDefault(),L=1);break;case 38:u.shiftKey?k=1:(u.preventDefault(),B=-1);break;case 40:u.shiftKey?k=-1:(u.preventDefault(),B=1);break;default:return}return this._rotationDisabled&&(v=0,k=0),{cameraAnimation:function(j){var Y=j.getZoom();j.easeTo({duration:300,easeId:"keyboardHandler",easing:ai,zoom:p?Math.round(Y)+p*(u.shiftKey?2:1):Y,bearing:j.getBearing()+v*m._bearingStep,pitch:j.getPitch()+k*m._pitchStep,offset:[-L*m._panStep,-B*m._panStep],center:j.getCenter()},{originalEvent:u})}}}},qo.prototype.enable=function(){this._enabled=!0},qo.prototype.disable=function(){this._enabled=!1,this.reset()},qo.prototype.isEnabled=function(){return this._enabled},qo.prototype.isActive=function(){return this._active},qo.prototype.disableRotation=function(){this._rotationDisabled=!0},qo.prototype.enableRotation=function(){this._rotationDisabled=!1};var Ut=function(u,m){this._map=u,this._el=u.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,f.bindAll(["_onTimeout"],this)};Ut.prototype.setZoomRate=function(u){this._defaultZoomRate=u},Ut.prototype.setWheelZoomRate=function(u){this._wheelZoomRate=u},Ut.prototype.isEnabled=function(){return!!this._enabled},Ut.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ut.prototype.isZooming=function(){return!!this._zooming},Ut.prototype.enable=function(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=u&&u.around==="center")},Ut.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ut.prototype.wheel=function(u){if(this.isEnabled()){var m=u.deltaMode===f.window.WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY,p=f.browser.now(),v=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,m!==0&&m%4.000244140625==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(v*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),u.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=u,this._delta-=m,this._active||this._start(u)),u.preventDefault()}},Ut.prototype._onTimeout=function(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},Ut.prototype._start=function(u){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var m=R.mousePos(this._el,u);this._around=f.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(m)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ut.prototype.renderFrame=function(){var u=this;if(this._frameId&&(this._frameId=null,this.isActive())){var m=this._map.transform;if(this._delta!==0){var p=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,v=2/(1+Math.exp(-Math.abs(this._delta*p)));this._delta<0&&v!==0&&(v=1/v);var k=typeof this._targetZoom=="number"?m.zoomScale(this._targetZoom):m.scale;this._targetZoom=Math.min(m.maxZoom,Math.max(m.minZoom,m.scaleZoom(k*v))),this._type==="wheel"&&(this._startZoom=m.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var L,B=typeof this._targetZoom=="number"?this._targetZoom:m.zoom,j=this._startZoom,Y=this._easing,ie=!1;if(this._type==="wheel"&&j&&Y){var he=Math.min((f.browser.now()-this._lastWheelEventTime)/200,1),de=Y(he);L=f.number(j,B,de),he<1?this._frameId||(this._frameId=!0):ie=!0}else L=B,ie=!0;return this._active=!0,ie&&(this._active=!1,this._finishTimeout=setTimeout(function(){u._zooming=!1,u._handler._triggerRenderFrame(),delete u._targetZoom,delete u._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!ie,zoomDelta:L-m.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ut.prototype._smoothOutEasing=function(u){var m=f.ease;if(this._prevEase){var p=this._prevEase,v=(f.browser.now()-p.start)/p.duration,k=p.easing(v+.01)-p.easing(v),L=.27/Math.sqrt(k*k+1e-4)*.01,B=Math.sqrt(.0729-L*L);m=f.bezier(L,B,.25,1)}return this._prevEase={start:f.browser.now(),duration:u,easing:m},m},Ut.prototype.blur=function(){this.reset()},Ut.prototype.reset=function(){this._active=!1};var Go=function(u,m){this._clickZoom=u,this._tapZoom=m};Go.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Go.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Go.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Go.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Eo=function(){this.reset()};Eo.prototype.reset=function(){this._active=!1},Eo.prototype.blur=function(){this.reset()},Eo.prototype.dblclick=function(u,m){return u.preventDefault(),{cameraAnimation:function(p){p.easeTo({duration:300,zoom:p.getZoom()+(u.shiftKey?-1:1),around:p.unproject(m)},{originalEvent:u})}}},Eo.prototype.enable=function(){this._enabled=!0},Eo.prototype.disable=function(){this._enabled=!1,this.reset()},Eo.prototype.isEnabled=function(){return this._enabled},Eo.prototype.isActive=function(){return this._active};var Nn=function(){this._tap=new aa({numTouches:1,numTaps:1}),this.reset()};Nn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Nn.prototype.touchstart=function(u,m,p){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=m[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(u,m,p))},Nn.prototype.touchmove=function(u,m,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;var v=m[0],k=v.y-this._swipePoint.y;return this._swipePoint=v,u.preventDefault(),this._active=!0,{zoomDelta:k/128}}}else this._tap.touchmove(u,m,p)},Nn.prototype.touchend=function(u,m,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(u,m,p)&&(this._tapTime=u.timeStamp)},Nn.prototype.touchcancel=function(){this.reset()},Nn.prototype.enable=function(){this._enabled=!0},Nn.prototype.disable=function(){this._enabled=!1,this.reset()},Nn.prototype.isEnabled=function(){return this._enabled},Nn.prototype.isActive=function(){return this._active};var cn=function(u,m,p){this._el=u,this._mousePan=m,this._touchPan=p};cn.prototype.enable=function(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},cn.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},cn.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},cn.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Zo=function(u,m,p){this._pitchWithRotate=u.pitchWithRotate,this._mouseRotate=m,this._mousePitch=p};Zo.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Zo.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Zo.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Zo.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var mn=function(u,m,p,v){this._el=u,this._touchZoom=m,this._touchRotate=p,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0};mn.prototype.enable=function(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},mn.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},mn.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},mn.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},mn.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},mn.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Io=function(u){return u.zoom||u.drag||u.pitch||u.rotate},ps=function(u){function m(){u.apply(this,arguments)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m}(f.Event);function Gt(u){return u.panDelta&&u.panDelta.mag()||u.zoomDelta||u.bearingDelta||u.pitchDelta}var qt=function(u,m){this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Qs(u),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(m),f.bindAll(["handleEvent","handleWindowEvent"],this);var p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[f.window.document,"mousemove",{capture:!0}],[f.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[f.window,"blur",void 0]];for(var v=0,k=this._listeners;v<k.length;v+=1){var L=k[v],B=L[0];R.addEventListener(B,L[1],B===f.window.document?this.handleWindowEvent:this.handleEvent,L[2])}};qt.prototype.destroy=function(){for(var u=0,m=this._listeners;u<m.length;u+=1){var p=m[u],v=p[0];R.removeEventListener(v,p[1],v===f.window.document?this.handleWindowEvent:this.handleEvent,p[2])}},qt.prototype._addDefaultHandlers=function(u){var m=this._map,p=m.getCanvasContainer();this._add("mapEvent",new Tn(m,u));var v=m.boxZoom=new fo(m,u);this._add("boxZoom",v);var k=new on,L=new Eo;m.doubleClickZoom=new Go(L,k),this._add("tapZoom",k),this._add("clickZoom",L);var B=new Nn;this._add("tapDragZoom",B);var j=m.touchPitch=new uc;this._add("touchPitch",j);var Y=new hs(u),ie=new Ql(u);m.dragRotate=new Zo(u,Y,ie),this._add("mouseRotate",Y,["mousePitch"]),this._add("mousePitch",ie,["mouseRotate"]);var he=new $l(u),de=new Ro(u);m.dragPan=new cn(p,he,de),this._add("mousePan",he),this._add("touchPan",de,["touchZoom","touchRotate"]);var me=new lc,Ce=new mo;m.touchZoomRotate=new mn(p,Ce,me,B),this._add("touchRotate",me,["touchPan","touchZoom"]),this._add("touchZoom",Ce,["touchPan","touchRotate"]);var Te=m.scrollZoom=new Ut(m,this);this._add("scrollZoom",Te,["mousePan"]);var Le=m.keyboard=new qo;this._add("keyboard",Le),this._add("blockableMapEvent",new ni(m));for(var xe=0,ze=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];xe<ze.length;xe+=1){var Fe=ze[xe];u.interactive&&u[Fe]&&m[Fe].enable(u[Fe])}},qt.prototype._add=function(u,m,p){this._handlers.push({handlerName:u,handler:m,allowed:p}),this._handlersById[u]=m},qt.prototype.stop=function(u){if(!this._updatingCamera){for(var m=0,p=this._handlers;m<p.length;m+=1)p[m].handler.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}},qt.prototype.isActive=function(){for(var u=0,m=this._handlers;u<m.length;u+=1)if(m[u].handler.isActive())return!0;return!1},qt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},qt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},qt.prototype.isMoving=function(){return Boolean(Io(this._eventsInProgress))||this.isZooming()},qt.prototype._blockedByActive=function(u,m,p){for(var v in u)if(v!==p&&(!m||m.indexOf(v)<0))return!0;return!1},qt.prototype.handleWindowEvent=function(u){this.handleEvent(u,u.type+"Window")},qt.prototype._getMapTouches=function(u){for(var m=[],p=0,v=u;p<v.length;p+=1){var k=v[p];this._el.contains(k.target)&&m.push(k)}return m},qt.prototype.handleEvent=function(u,m){this._updatingCamera=!0;for(var p=u.type==="renderFrame"?void 0:u,v={needsRenderFrame:!1},k={},L={},B=u.touches?this._getMapTouches(u.touches):void 0,j=B?R.touchPos(this._el,B):R.mousePos(this._el,u),Y=0,ie=this._handlers;Y<ie.length;Y+=1){var he=ie[Y],de=he.handlerName,me=he.handler,Ce=he.allowed;if(me.isEnabled()){var Te=void 0;this._blockedByActive(L,Ce,de)?me.reset():me[m||u.type]&&(Te=me[m||u.type](u,j,B),this.mergeHandlerResult(v,k,Te,de,p),Te&&Te.needsRenderFrame&&this._triggerRenderFrame()),(Te||me.isActive())&&(L[de]=me)}}var Le={};for(var xe in this._previousActiveHandlers)L[xe]||(Le[xe]=p);this._previousActiveHandlers=L,(Object.keys(Le).length||Gt(v))&&(this._changes.push([v,k,Le]),this._triggerRenderFrame()),(Object.keys(L).length||Gt(v))&&this._map._stop(!0),this._updatingCamera=!1;var ze=v.cameraAnimation;ze&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ze(this._map))},qt.prototype.mergeHandlerResult=function(u,m,p,v,k){if(p){f.extend(u,p);var L={handlerName:v,originalEvent:p.originalEvent||k};p.zoomDelta!==void 0&&(m.zoom=L),p.panDelta!==void 0&&(m.drag=L),p.pitchDelta!==void 0&&(m.pitch=L),p.bearingDelta!==void 0&&(m.rotate=L)}},qt.prototype._applyChanges=function(){for(var u={},m={},p={},v=0,k=this._changes;v<k.length;v+=1){var L=k[v],B=L[0],j=L[1],Y=L[2];B.panDelta&&(u.panDelta=(u.panDelta||new f.Point(0,0))._add(B.panDelta)),B.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+B.zoomDelta),B.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+B.bearingDelta),B.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+B.pitchDelta),B.around!==void 0&&(u.around=B.around),B.pinchAround!==void 0&&(u.pinchAround=B.pinchAround),B.noInertia&&(u.noInertia=B.noInertia),f.extend(m,j),f.extend(p,Y)}this._updateMapTransform(u,m,p),this._changes=[]},qt.prototype._updateMapTransform=function(u,m,p){var v=this._map,k=v.transform;if(!Gt(u))return this._fireEvents(m,p,!0);var L=u.panDelta,B=u.zoomDelta,j=u.bearingDelta,Y=u.pitchDelta,ie=u.around,he=u.pinchAround;he!==void 0&&(ie=he),v._stop(!0),ie=ie||v.transform.centerPoint;var de=k.pointLocation(L?ie.sub(L):ie);j&&(k.bearing+=j),Y&&(k.pitch+=Y),B&&(k.zoom+=B),k.setLocationAtPoint(de,ie),this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(m,p,!0)},qt.prototype._fireEvents=function(u,m,p){var v=this,k=Io(this._eventsInProgress),L=Io(u),B={};for(var j in u)this._eventsInProgress[j]||(B[j+"start"]=u[j].originalEvent),this._eventsInProgress[j]=u[j];for(var Y in!k&&L&&this._fireEvent("movestart",L.originalEvent),B)this._fireEvent(Y,B[Y]);for(var ie in L&&this._fireEvent("move",L.originalEvent),u)this._fireEvent(ie,u[ie].originalEvent);var he,de={};for(var me in this._eventsInProgress){var Ce=this._eventsInProgress[me],Te=Ce.handlerName,Le=Ce.originalEvent;this._handlersById[Te].isActive()||(delete this._eventsInProgress[me],de[me+"end"]=he=m[Te]||Le)}for(var xe in de)this._fireEvent(xe,de[xe]);var ze=Io(this._eventsInProgress);if(p&&(k||L)&&!ze){this._updatingCamera=!0;var Fe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Ye=function(ot){return ot!==0&&-v._bearingSnap<ot&&ot<v._bearingSnap};Fe?(Ye(Fe.bearing||this._map.getBearing())&&(Fe.bearing=0),this._map.easeTo(Fe,{originalEvent:he})):(this._map.fire(new f.Event("moveend",{originalEvent:he})),Ye(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},qt.prototype._fireEvent=function(u,m){this._map.fire(new f.Event(u,m?{originalEvent:m}:{}))},qt.prototype._requestFrame=function(){var u=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(m){delete u._frameId,u.handleEvent(new ps("renderFrame",{timeStamp:m})),u._applyChanges()})},qt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var eu=function(u){function m(p,v){u.call(this),this._moving=!1,this._zooming=!1,this.transform=p,this._bearingSnap=v.bearingSnap,f.bindAll(["_renderFrameCallback"],this)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.getCenter=function(){return new f.LngLat(this.transform.center.lng,this.transform.center.lat)},m.prototype.setCenter=function(p,v){return this.jumpTo({center:p},v)},m.prototype.panBy=function(p,v,k){return p=f.Point.convert(p).mult(-1),this.panTo(this.transform.center,f.extend({offset:p},v),k)},m.prototype.panTo=function(p,v,k){return this.easeTo(f.extend({center:p},v),k)},m.prototype.getZoom=function(){return this.transform.zoom},m.prototype.setZoom=function(p,v){return this.jumpTo({zoom:p},v),this},m.prototype.zoomTo=function(p,v,k){return this.easeTo(f.extend({zoom:p},v),k)},m.prototype.zoomIn=function(p,v){return this.zoomTo(this.getZoom()+1,p,v),this},m.prototype.zoomOut=function(p,v){return this.zoomTo(this.getZoom()-1,p,v),this},m.prototype.getBearing=function(){return this.transform.bearing},m.prototype.setBearing=function(p,v){return this.jumpTo({bearing:p},v),this},m.prototype.getPadding=function(){return this.transform.padding},m.prototype.setPadding=function(p,v){return this.jumpTo({padding:p},v),this},m.prototype.rotateTo=function(p,v,k){return this.easeTo(f.extend({bearing:p},v),k)},m.prototype.resetNorth=function(p,v){return this.rotateTo(0,f.extend({duration:1e3},p),v),this},m.prototype.resetNorthPitch=function(p,v){return this.easeTo(f.extend({bearing:0,pitch:0,duration:1e3},p),v),this},m.prototype.snapToNorth=function(p,v){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(p,v):this},m.prototype.getPitch=function(){return this.transform.pitch},m.prototype.setPitch=function(p,v){return this.jumpTo({pitch:p},v),this},m.prototype.cameraForBounds=function(p,v){p=f.LngLatBounds.convert(p);var k=v&&v.bearing||0;return this._cameraForBoxAndBearing(p.getNorthWest(),p.getSouthEast(),k,v)},m.prototype._cameraForBoxAndBearing=function(p,v,k,L){var B={top:0,bottom:0,right:0,left:0};if(typeof(L=f.extend({padding:B,offset:[0,0],maxZoom:this.transform.maxZoom},L)).padding=="number"){var j=L.padding;L.padding={top:j,bottom:j,right:j,left:j}}L.padding=f.extend(B,L.padding);var Y=this.transform,ie=Y.padding,he=Y.project(f.LngLat.convert(p)),de=Y.project(f.LngLat.convert(v)),me=he.rotate(-k*Math.PI/180),Ce=de.rotate(-k*Math.PI/180),Te=new f.Point(Math.max(me.x,Ce.x),Math.max(me.y,Ce.y)),Le=new f.Point(Math.min(me.x,Ce.x),Math.min(me.y,Ce.y)),xe=Te.sub(Le),ze=(Y.width-(ie.left+ie.right+L.padding.left+L.padding.right))/xe.x,Fe=(Y.height-(ie.top+ie.bottom+L.padding.top+L.padding.bottom))/xe.y;if(!(Fe<0||ze<0)){var Ye=Math.min(Y.scaleZoom(Y.scale*Math.min(ze,Fe)),L.maxZoom),ot=typeof L.offset.x=="number"?new f.Point(L.offset.x,L.offset.y):f.Point.convert(L.offset),at=new f.Point((L.padding.left-L.padding.right)/2,(L.padding.top-L.padding.bottom)/2).rotate(k*Math.PI/180),st=ot.add(at).mult(Y.scale/Y.zoomScale(Ye));return{center:Y.unproject(he.add(de).div(2).sub(st)),zoom:Ye,bearing:k}}f.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},m.prototype.fitBounds=function(p,v,k){return this._fitInternal(this.cameraForBounds(p,v),v,k)},m.prototype.fitScreenCoordinates=function(p,v,k,L,B){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(f.Point.convert(p)),this.transform.pointLocation(f.Point.convert(v)),k,L),L,B)},m.prototype._fitInternal=function(p,v,k){return p?(delete(v=f.extend(p,v)).padding,v.linear?this.easeTo(v,k):this.flyTo(v,k)):this},m.prototype.jumpTo=function(p,v){this.stop();var k=this.transform,L=!1,B=!1,j=!1;return"zoom"in p&&k.zoom!==+p.zoom&&(L=!0,k.zoom=+p.zoom),p.center!==void 0&&(k.center=f.LngLat.convert(p.center)),"bearing"in p&&k.bearing!==+p.bearing&&(B=!0,k.bearing=+p.bearing),"pitch"in p&&k.pitch!==+p.pitch&&(j=!0,k.pitch=+p.pitch),p.padding==null||k.isPaddingEqual(p.padding)||(k.padding=p.padding),this.fire(new f.Event("movestart",v)).fire(new f.Event("move",v)),L&&this.fire(new f.Event("zoomstart",v)).fire(new f.Event("zoom",v)).fire(new f.Event("zoomend",v)),B&&this.fire(new f.Event("rotatestart",v)).fire(new f.Event("rotate",v)).fire(new f.Event("rotateend",v)),j&&this.fire(new f.Event("pitchstart",v)).fire(new f.Event("pitch",v)).fire(new f.Event("pitchend",v)),this.fire(new f.Event("moveend",v))},m.prototype.easeTo=function(p,v){var k=this;this._stop(!1,p.easeId),((p=f.extend({offset:[0,0],duration:500,easing:f.ease},p)).animate===!1||!p.essential&&f.browser.prefersReducedMotion)&&(p.duration=0);var L=this.transform,B=this.getZoom(),j=this.getBearing(),Y=this.getPitch(),ie=this.getPadding(),he="zoom"in p?+p.zoom:B,de="bearing"in p?this._normalizeBearing(p.bearing,j):j,me="pitch"in p?+p.pitch:Y,Ce="padding"in p?p.padding:L.padding,Te=f.Point.convert(p.offset),Le=L.centerPoint.add(Te),xe=L.pointLocation(Le),ze=f.LngLat.convert(p.center||xe);this._normalizeCenter(ze);var Fe,Ye,ot=L.project(xe),at=L.project(ze).sub(ot),st=L.zoomScale(he-B);p.around&&(Fe=f.LngLat.convert(p.around),Ye=L.locationPoint(Fe));var It={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||he!==B,this._rotating=this._rotating||j!==de,this._pitching=this._pitching||me!==Y,this._padding=!L.isPaddingEqual(Ce),this._easeId=p.easeId,this._prepareEase(v,p.noMoveStart,It),this._ease(function(Lt){if(k._zooming&&(L.zoom=f.number(B,he,Lt)),k._rotating&&(L.bearing=f.number(j,de,Lt)),k._pitching&&(L.pitch=f.number(Y,me,Lt)),k._padding&&(L.interpolatePadding(ie,Ce,Lt),Le=L.centerPoint.add(Te)),Fe)L.setLocationAtPoint(Fe,Ye);else{var Mt=L.zoomScale(L.zoom-B),Yt=he>B?Math.min(2,st):Math.max(.5,st),di=Math.pow(Yt,1-Lt),_i=L.unproject(ot.add(at.mult(Lt*di)).mult(Mt));L.setLocationAtPoint(L.renderWorldCopies?_i.wrap():_i,Le)}k._fireMoveEvents(v)},function(Lt){k._afterEase(v,Lt)},p),this},m.prototype._prepareEase=function(p,v,k){k===void 0&&(k={}),this._moving=!0,v||k.moving||this.fire(new f.Event("movestart",p)),this._zooming&&!k.zooming&&this.fire(new f.Event("zoomstart",p)),this._rotating&&!k.rotating&&this.fire(new f.Event("rotatestart",p)),this._pitching&&!k.pitching&&this.fire(new f.Event("pitchstart",p))},m.prototype._fireMoveEvents=function(p){this.fire(new f.Event("move",p)),this._zooming&&this.fire(new f.Event("zoom",p)),this._rotating&&this.fire(new f.Event("rotate",p)),this._pitching&&this.fire(new f.Event("pitch",p))},m.prototype._afterEase=function(p,v){if(!this._easeId||!v||this._easeId!==v){delete this._easeId;var k=this._zooming,L=this._rotating,B=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,k&&this.fire(new f.Event("zoomend",p)),L&&this.fire(new f.Event("rotateend",p)),B&&this.fire(new f.Event("pitchend",p)),this.fire(new f.Event("moveend",p))}},m.prototype.flyTo=function(p,v){var k=this;if(!p.essential&&f.browser.prefersReducedMotion){var L=f.pick(p,["center","zoom","bearing","pitch","around"]);return this.jumpTo(L,v)}this.stop(),p=f.extend({offset:[0,0],speed:1.2,curve:1.42,easing:f.ease},p);var B=this.transform,j=this.getZoom(),Y=this.getBearing(),ie=this.getPitch(),he=this.getPadding(),de="zoom"in p?f.clamp(+p.zoom,B.minZoom,B.maxZoom):j,me="bearing"in p?this._normalizeBearing(p.bearing,Y):Y,Ce="pitch"in p?+p.pitch:ie,Te="padding"in p?p.padding:B.padding,Le=B.zoomScale(de-j),xe=f.Point.convert(p.offset),ze=B.centerPoint.add(xe),Fe=B.pointLocation(ze),Ye=f.LngLat.convert(p.center||Fe);this._normalizeCenter(Ye);var ot=B.project(Fe),at=B.project(Ye).sub(ot),st=p.curve,It=Math.max(B.width,B.height),Lt=It/Le,Mt=at.mag();if("minZoom"in p){var Yt=f.clamp(Math.min(p.minZoom,j,de),B.minZoom,B.maxZoom),di=It/B.zoomScale(Yt-j);st=Math.sqrt(di/Mt*2)}var _i=st*st;function hi(wi){var gi=(Lt*Lt-It*It+(wi?-1:1)*_i*_i*Mt*Mt)/(2*(wi?Lt:It)*_i*Mt);return Math.log(Math.sqrt(gi*gi+1)-gi)}function ar(wi){return(Math.exp(wi)-Math.exp(-wi))/2}function ri(wi){return(Math.exp(wi)+Math.exp(-wi))/2}var Di=hi(0),er=function(wi){return ri(Di)/ri(Di+st*wi)},zi=function(wi){return It*((ri(Di)*(ar(gi=Di+st*wi)/ri(gi))-ar(Di))/_i)/Mt;var gi},Ai=(hi(1)-Di)/st;if(Math.abs(Mt)<1e-6||!isFinite(Ai)){if(Math.abs(It-Lt)<1e-6)return this.easeTo(p,v);var ji=Lt<It?-1:1;Ai=Math.abs(Math.log(Lt/It))/st,zi=function(){return 0},er=function(wi){return Math.exp(ji*st*wi)}}return p.duration="duration"in p?+p.duration:1e3*Ai/("screenSpeed"in p?+p.screenSpeed/st:+p.speed),p.maxDuration&&p.duration>p.maxDuration&&(p.duration=0),this._zooming=!0,this._rotating=Y!==me,this._pitching=Ce!==ie,this._padding=!B.isPaddingEqual(Te),this._prepareEase(v,!1),this._ease(function(wi){var gi=wi*Ai,hn=1/er(gi);B.zoom=wi===1?de:j+B.scaleZoom(hn),k._rotating&&(B.bearing=f.number(Y,me,wi)),k._pitching&&(B.pitch=f.number(ie,Ce,wi)),k._padding&&(B.interpolatePadding(he,Te,wi),ze=B.centerPoint.add(xe));var En=wi===1?Ye:B.unproject(ot.add(at.mult(zi(gi))).mult(hn));B.setLocationAtPoint(B.renderWorldCopies?En.wrap():En,ze),k._fireMoveEvents(v)},function(){return k._afterEase(v)},p),this},m.prototype.isEasing=function(){return!!this._easeFrameId},m.prototype.stop=function(){return this._stop()},m.prototype._stop=function(p,v){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var k=this._onEaseEnd;delete this._onEaseEnd,k.call(this,v)}if(!p){var L=this.handlers;L&&L.stop(!1)}return this},m.prototype._ease=function(p,v,k){k.animate===!1||k.duration===0?(p(1),v()):(this._easeStart=f.browser.now(),this._easeOptions=k,this._onEaseFrame=p,this._onEaseEnd=v,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},m.prototype._renderFrameCallback=function(){var p=Math.min((f.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},m.prototype._normalizeBearing=function(p,v){p=f.wrap(p,-180,180);var k=Math.abs(p-v);return Math.abs(p-360-v)<k&&(p-=360),Math.abs(p+360-v)<k&&(p+=360),p},m.prototype._normalizeCenter=function(p){var v=this.transform;if(v.renderWorldCopies&&!v.lngRange){var k=p.lng-v.center.lng;p.lng+=k>180?-360:k<-180?360:0}},m}(f.Evented),Mn=function(u){u===void 0&&(u={}),this.options=u,f.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Mn.prototype.getDefaultPosition=function(){return"bottom-right"},Mn.prototype.onAdd=function(u){var m=this.options&&this.options.compact;return this._map=u,this._container=R.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=R.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=R.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),m===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Mn.prototype.onRemove=function(){R.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Mn.prototype._setElementTitle=function(u,m){var p=this._map._getUIString("AttributionControl."+m);u.title=p,u.setAttribute("aria-label",p)},Mn.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Mn.prototype._updateEditLink=function(){var u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));var m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||f.config.ACCESS_TOKEN}];if(u){var p=m.reduce(function(v,k,L){return k.value&&(v+=k.key+"="+k.value+(L<m.length-1?"&":"")),v},"?");u.href=f.config.FEEDBACK_URL+"/"+p+(this._map._hash?this._map._hash.getHashString(!0):""),u.rel="noopener nofollow",this._setElementTitle(u,"MapFeedback")}},Mn.prototype._updateData=function(u){!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Mn.prototype._updateAttributions=function(){if(this._map.style){var u=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=u.concat(this.options.customAttribution.map(function(j){return typeof j!="string"?"":j})):typeof this.options.customAttribution=="string"&&u.push(this.options.customAttribution)),this._map.style.stylesheet){var m=this._map.style.stylesheet;this.styleOwner=m.owner,this.styleId=m.id}var p=this._map.style.sourceCaches;for(var v in p){var k=p[v];if(k.used){var L=k.getSource();L.attribution&&u.indexOf(L.attribution)<0&&u.push(L.attribution)}}u.sort(function(j,Y){return j.length-Y.length});var B=(u=u.filter(function(j,Y){for(var ie=Y+1;ie<u.length;ie++)if(u[ie].indexOf(j)>=0)return!1;return!0})).join(" | ");B!==this._attribHTML&&(this._attribHTML=B,u.length?(this._innerContainer.innerHTML=B,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Mn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Bo=function(){f.bindAll(["_updateLogo"],this),f.bindAll(["_updateCompact"],this)};Bo.prototype.onAdd=function(u){this._map=u,this._container=R.create("div","mapboxgl-ctrl");var m=R.create("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Bo.prototype.onRemove=function(){R.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Bo.prototype.getDefaultPosition=function(){return"bottom-left"},Bo.prototype._updateLogo=function(u){u&&u.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Bo.prototype._logoRequired=function(){if(this._map.style){var u=this._map.style.sourceCaches;for(var m in u)if(u[m].getSource().mapbox_logo)return!0;return!1}},Bo.prototype._updateCompact=function(){var u=this._container.children;if(u.length){var m=u[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}};var S=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};S.prototype.add=function(u){var m=++this._id;return this._queue.push({callback:u,id:m,cancelled:!1}),m},S.prototype.remove=function(u){for(var m=this._currentlyRunning,p=0,v=m?this._queue.concat(m):this._queue;p<v.length;p+=1){var k=v[p];if(k.id===u)return void(k.cancelled=!0)}},S.prototype.run=function(u){u===void 0&&(u=0);var m=this._currentlyRunning=this._queue;this._queue=[];for(var p=0,v=m;p<v.length;p+=1){var k=v[p];if(!k.cancelled&&(k.callback(u),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},S.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var n={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},y=f.window.HTMLImageElement,I=f.window.HTMLElement,A=f.window.ImageBitmap,M={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},F=function(u){function m(v){var k=this;if((v=f.extend({},M,v)).minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var L=new Qi(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies);if(u.call(this,L,v),this._interactive=v.interactive,this._maxTileCacheSize=v.maxTileCacheSize,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._crossSourceCollisions=v.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=v.collectResourceTiming,this._renderTaskQueue=new S,this._controls=[],this._mapId=f.uniqueId(),this._locale=f.extend({},n,v.locale),this._clickTolerance=v.clickTolerance,this._requestManager=new f.RequestManager(v.transformRequest,v.accessToken),typeof v.container=="string"){if(this._container=f.window.document.getElementById(v.container),!this._container)throw new Error("Container '"+v.container+"' not found.")}else{if(!(v.container instanceof I))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(v.maxBounds&&this.setMaxBounds(v.maxBounds),f.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return k._update(!1)}),this.on("moveend",function(){return k._update(!1)}),this.on("zoom",function(){return k._update(!0)}),f.window!==void 0&&(f.window.addEventListener("online",this._onWindowOnline,!1),f.window.addEventListener("resize",this._onWindowResize,!1),f.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new qt(this,v),this._hash=v.hash&&new Jt(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,f.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=v.localIdeographFontFamily,v.style&&this.setStyle(v.style,{localIdeographFontFamily:v.localIdeographFontFamily}),v.attributionControl&&this.addControl(new Mn({customAttribution:v.customAttribution})),this.addControl(new Bo,v.logoPosition),this.on("style.load",function(){k.transform.unmodified&&k.jumpTo(k.style.stylesheet)}),this.on("data",function(B){k._update(B.dataType==="style"),k.fire(new f.Event(B.dataType+"data",B))}),this.on("dataloading",function(B){k.fire(new f.Event(B.dataType+"dataloading",B))})}u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m;var p={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return m.prototype._getMapId=function(){return this._mapId},m.prototype.addControl=function(v,k){if(k===void 0&&(k=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new f.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var L=v.onAdd(this);this._controls.push(v);var B=this._controlPositions[k];return k.indexOf("bottom")!==-1?B.insertBefore(L,B.firstChild):B.appendChild(L),this},m.prototype.removeControl=function(v){if(!v||!v.onRemove)return this.fire(new f.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var k=this._controls.indexOf(v);return k>-1&&this._controls.splice(k,1),v.onRemove(this),this},m.prototype.hasControl=function(v){return this._controls.indexOf(v)>-1},m.prototype.resize=function(v){var k=this._containerDimensions(),L=k[0],B=k[1];if(L===this.transform.width&&B===this.transform.height)return this;this._resizeCanvas(L,B),this.transform.resize(L,B),this.painter.resize(L,B);var j=!this._moving;return j&&this.fire(new f.Event("movestart",v)).fire(new f.Event("move",v)),this.fire(new f.Event("resize",v)),j&&this.fire(new f.Event("moveend",v)),this},m.prototype.getBounds=function(){return this.transform.getBounds()},m.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},m.prototype.setMaxBounds=function(v){return this.transform.setMaxBounds(f.LngLatBounds.convert(v)),this._update()},m.prototype.setMinZoom=function(v){if((v=v==null?-2:v)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v&&this.setZoom(v),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},m.prototype.getMinZoom=function(){return this.transform.minZoom},m.prototype.setMaxZoom=function(v){if((v=v==null?22:v)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v&&this.setZoom(v),this;throw new Error("maxZoom must be greater than the current minZoom")},m.prototype.getMaxZoom=function(){return this.transform.maxZoom},m.prototype.setMinPitch=function(v){if((v=v==null?0:v)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v&&this.setPitch(v),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},m.prototype.getMinPitch=function(){return this.transform.minPitch},m.prototype.setMaxPitch=function(v){if((v=v==null?60:v)>60)throw new Error("maxPitch must be less than or equal to 60");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v&&this.setPitch(v),this;throw new Error("maxPitch must be greater than the current minPitch")},m.prototype.getMaxPitch=function(){return this.transform.maxPitch},m.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},m.prototype.setRenderWorldCopies=function(v){return this.transform.renderWorldCopies=v,this._update()},m.prototype.project=function(v){return this.transform.locationPoint(f.LngLat.convert(v))},m.prototype.unproject=function(v){return this.transform.pointLocation(f.Point.convert(v))},m.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},m.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},m.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},m.prototype._createDelegatedListener=function(v,k,L){var B,j=this;if(v==="mouseenter"||v==="mouseover"){var Y=!1;return{layer:k,listener:L,delegates:{mousemove:function(he){var de=j.getLayer(k)?j.queryRenderedFeatures(he.point,{layers:[k]}):[];de.length?Y||(Y=!0,L.call(j,new ln(v,j,he.originalEvent,{features:de}))):Y=!1},mouseout:function(){Y=!1}}}}if(v==="mouseleave"||v==="mouseout"){var ie=!1;return{layer:k,listener:L,delegates:{mousemove:function(he){(j.getLayer(k)?j.queryRenderedFeatures(he.point,{layers:[k]}):[]).length?ie=!0:ie&&(ie=!1,L.call(j,new ln(v,j,he.originalEvent)))},mouseout:function(he){ie&&(ie=!1,L.call(j,new ln(v,j,he.originalEvent)))}}}}return{layer:k,listener:L,delegates:(B={},B[v]=function(he){var de=j.getLayer(k)?j.queryRenderedFeatures(he.point,{layers:[k]}):[];de.length&&(he.features=de,L.call(j,he),delete he.features)},B)}},m.prototype.on=function(v,k,L){if(L===void 0)return u.prototype.on.call(this,v,k);var B=this._createDelegatedListener(v,k,L);for(var j in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(B),B.delegates)this.on(j,B.delegates[j]);return this},m.prototype.once=function(v,k,L){if(L===void 0)return u.prototype.once.call(this,v,k);var B=this._createDelegatedListener(v,k,L);for(var j in B.delegates)this.once(j,B.delegates[j]);return this},m.prototype.off=function(v,k,L){var B=this;return L===void 0?u.prototype.off.call(this,v,k):(this._delegatedListeners&&this._delegatedListeners[v]&&function(j){for(var Y=j[v],ie=0;ie<Y.length;ie++){var he=Y[ie];if(he.layer===k&&he.listener===L){for(var de in he.delegates)B.off(de,he.delegates[de]);return Y.splice(ie,1),B}}}(this._delegatedListeners),this)},m.prototype.queryRenderedFeatures=function(v,k){if(!this.style)return[];var L;if(k!==void 0||v===void 0||v instanceof f.Point||Array.isArray(v)||(k=v,v=void 0),k=k||{},(v=v||[[0,0],[this.transform.width,this.transform.height]])instanceof f.Point||typeof v[0]=="number")L=[f.Point.convert(v)];else{var B=f.Point.convert(v[0]),j=f.Point.convert(v[1]);L=[B,new f.Point(j.x,B.y),j,new f.Point(B.x,j.y),B]}return this.style.queryRenderedFeatures(L,k,this.transform)},m.prototype.querySourceFeatures=function(v,k){return this.style.querySourceFeatures(v,k)},m.prototype.setStyle=function(v,k){return(k=f.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},k)).diff!==!1&&k.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&v?(this._diffStyle(v,k),this):(this._localIdeographFontFamily=k.localIdeographFontFamily,this._updateStyle(v,k))},m.prototype._getUIString=function(v){var k=this._locale[v];if(k==null)throw new Error("Missing UI string '"+v+"'");return k},m.prototype._updateStyle=function(v,k){return this.style&&(this.style.setEventedParent(null),this.style._remove()),v?(this.style=new ao(this,k||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v):this.style.loadJSON(v),this):(delete this.style,this)},m.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new ao(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},m.prototype._diffStyle=function(v,k){var L=this;if(typeof v=="string"){var B=this._requestManager.normalizeStyleURL(v),j=this._requestManager.transformRequest(B,f.ResourceType.Style);f.getJSON(j,function(Y,ie){Y?L.fire(new f.ErrorEvent(Y)):ie&&L._updateDiff(ie,k)})}else typeof v=="object"&&this._updateDiff(v,k)},m.prototype._updateDiff=function(v,k){try{this.style.setState(v)&&this._update(!0)}catch(L){f.warnOnce("Unable to perform style diff: "+(L.message||L.error||L)+".  Rebuilding the style from scratch."),this._updateStyle(v,k)}},m.prototype.getStyle=function(){if(this.style)return this.style.serialize()},m.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():f.warnOnce("There is no style added to the map.")},m.prototype.addSource=function(v,k){return this._lazyInitEmptyStyle(),this.style.addSource(v,k),this._update(!0)},m.prototype.isSourceLoaded=function(v){var k=this.style&&this.style.sourceCaches[v];if(k!==void 0)return k.loaded();this.fire(new f.ErrorEvent(new Error("There is no source with ID '"+v+"'")))},m.prototype.areTilesLoaded=function(){var v=this.style&&this.style.sourceCaches;for(var k in v){var L=v[k]._tiles;for(var B in L){var j=L[B];if(j.state!=="loaded"&&j.state!=="errored")return!1}}return!0},m.prototype.addSourceType=function(v,k,L){return this._lazyInitEmptyStyle(),this.style.addSourceType(v,k,L)},m.prototype.removeSource=function(v){return this.style.removeSource(v),this._update(!0)},m.prototype.getSource=function(v){return this.style.getSource(v)},m.prototype.addImage=function(v,k,L){L===void 0&&(L={});var B=L.pixelRatio;B===void 0&&(B=1);var j=L.sdf;j===void 0&&(j=!1);var Y=L.stretchX,ie=L.stretchY,he=L.content;if(this._lazyInitEmptyStyle(),k instanceof y||A&&k instanceof A){var de=f.browser.getImageData(k);this.style.addImage(v,{data:new f.RGBAImage({width:de.width,height:de.height},de.data),pixelRatio:B,stretchX:Y,stretchY:ie,content:he,sdf:j,version:0})}else{if(k.width===void 0||k.height===void 0)return this.fire(new f.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var me=k;this.style.addImage(v,{data:new f.RGBAImage({width:k.width,height:k.height},new Uint8Array(k.data)),pixelRatio:B,stretchX:Y,stretchY:ie,content:he,sdf:j,version:0,userImage:me}),me.onAdd&&me.onAdd(this,v)}},m.prototype.updateImage=function(v,k){var L=this.style.getImage(v);if(!L)return this.fire(new f.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var B=k instanceof y||A&&k instanceof A?f.browser.getImageData(k):k,j=B.width,Y=B.height,ie=B.data;return j===void 0||Y===void 0?this.fire(new f.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):j!==L.data.width||Y!==L.data.height?this.fire(new f.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(L.data.replace(ie,!(k instanceof y||A&&k instanceof A)),void this.style.updateImage(v,L))},m.prototype.hasImage=function(v){return v?!!this.style.getImage(v):(this.fire(new f.ErrorEvent(new Error("Missing required image id"))),!1)},m.prototype.removeImage=function(v){this.style.removeImage(v)},m.prototype.loadImage=function(v,k){f.getImage(this._requestManager.transformRequest(v,f.ResourceType.Image),k)},m.prototype.listImages=function(){return this.style.listImages()},m.prototype.addLayer=function(v,k){return this._lazyInitEmptyStyle(),this.style.addLayer(v,k),this._update(!0)},m.prototype.moveLayer=function(v,k){return this.style.moveLayer(v,k),this._update(!0)},m.prototype.removeLayer=function(v){return this.style.removeLayer(v),this._update(!0)},m.prototype.getLayer=function(v){return this.style.getLayer(v)},m.prototype.setLayerZoomRange=function(v,k,L){return this.style.setLayerZoomRange(v,k,L),this._update(!0)},m.prototype.setFilter=function(v,k,L){return L===void 0&&(L={}),this.style.setFilter(v,k,L),this._update(!0)},m.prototype.getFilter=function(v){return this.style.getFilter(v)},m.prototype.setPaintProperty=function(v,k,L,B){return B===void 0&&(B={}),this.style.setPaintProperty(v,k,L,B),this._update(!0)},m.prototype.getPaintProperty=function(v,k){return this.style.getPaintProperty(v,k)},m.prototype.setLayoutProperty=function(v,k,L,B){return B===void 0&&(B={}),this.style.setLayoutProperty(v,k,L,B),this._update(!0)},m.prototype.getLayoutProperty=function(v,k){return this.style.getLayoutProperty(v,k)},m.prototype.setLight=function(v,k){return k===void 0&&(k={}),this._lazyInitEmptyStyle(),this.style.setLight(v,k),this._update(!0)},m.prototype.getLight=function(){return this.style.getLight()},m.prototype.setFeatureState=function(v,k){return this.style.setFeatureState(v,k),this._update()},m.prototype.removeFeatureState=function(v,k){return this.style.removeFeatureState(v,k),this._update()},m.prototype.getFeatureState=function(v){return this.style.getFeatureState(v)},m.prototype.getContainer=function(){return this._container},m.prototype.getCanvasContainer=function(){return this._canvasContainer},m.prototype.getCanvas=function(){return this._canvas},m.prototype._containerDimensions=function(){var v=0,k=0;return this._container&&(v=this._container.clientWidth||400,k=this._container.clientHeight||300),[v,k]},m.prototype._detectMissingCSS=function(){f.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&f.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},m.prototype._setupContainer=function(){var v=this._container;v.classList.add("mapboxgl-map"),(this._missingCSSCanary=R.create("div","mapboxgl-canary",v)).style.visibility="hidden",this._detectMissingCSS();var k=this._canvasContainer=R.create("div","mapboxgl-canvas-container",v);this._interactive&&k.classList.add("mapboxgl-interactive"),this._canvas=R.create("canvas","mapboxgl-canvas",k),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var L=this._containerDimensions();this._resizeCanvas(L[0],L[1]);var B=this._controlContainer=R.create("div","mapboxgl-control-container",v),j=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Y){j[Y]=R.create("div","mapboxgl-ctrl-"+Y,B)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},m.prototype._resizeCanvas=function(v,k){var L=f.browser.devicePixelRatio||1;this._canvas.width=L*v,this._canvas.height=L*k,this._canvas.style.width=v+"px",this._canvas.style.height=k+"px"},m.prototype._setupPainter=function(){var v=f.extend({},d.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),k=this._canvas.getContext("webgl",v)||this._canvas.getContext("experimental-webgl",v);k?(this.painter=new nn(k,this.transform),f.webpSupported.testSupport(k)):this.fire(new f.ErrorEvent(new Error("Failed to initialize WebGL")))},m.prototype._contextLost=function(v){v.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new f.Event("webglcontextlost",{originalEvent:v}))},m.prototype._contextRestored=function(v){this._setupPainter(),this.resize(),this._update(),this.fire(new f.Event("webglcontextrestored",{originalEvent:v}))},m.prototype._onMapScroll=function(v){if(v.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},m.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},m.prototype._update=function(v){return this.style?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this},m.prototype._requestRenderFrame=function(v){return this._update(),this._renderTaskQueue.add(v)},m.prototype._cancelRenderFrame=function(v){this._renderTaskQueue.remove(v)},m.prototype._render=function(v){var k,L=this,B=0,j=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(k=j.createQueryEXT(),j.beginQueryEXT(j.TIME_ELAPSED_EXT,k),B=f.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(v),!this._removed){var Y=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var ie=this.transform.zoom,he=f.browser.now();this.style.zoomHistory.update(ie,he);var de=new f.EvaluationParameters(ie,{now:he,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),me=de.crossFadingFactor();me===1&&me===this._crossFadingFactor||(Y=!0,this._crossFadingFactor=me),this.style.update(de)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new f.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new f.Event("load"))),this.style&&(this.style.hasTransitions()||Y)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ce=f.browser.now()-B;j.endQueryEXT(j.TIME_ELAPSED_EXT,k),setTimeout(function(){var xe=j.getQueryObjectEXT(k,j.QUERY_RESULT_EXT)/1e6;j.deleteQueryEXT(k),L.fire(new f.Event("gpu-timing-frame",{cpuTime:Ce,gpuTime:xe}))},50)}if(this.listens("gpu-timing-layer")){var Te=this.painter.collectGpuTimers();setTimeout(function(){var xe=L.painter.queryGpuTimers(Te);L.fire(new f.Event("gpu-timing-layer",{layerTimes:xe}))},50)}var Le=this._sourcesDirty||this._styleDirty||this._placementDirty;return Le||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new f.Event("idle")),!this._loaded||this._fullyLoaded||Le||(this._fullyLoaded=!0),this}},m.prototype.remove=function(){this._hash&&this._hash.remove();for(var v=0,k=this._controls;v<k.length;v+=1)k[v].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),f.window!==void 0&&(f.window.removeEventListener("resize",this._onWindowResize,!1),f.window.removeEventListener("orientationchange",this._onWindowResize,!1),f.window.removeEventListener("online",this._onWindowOnline,!1));var L=this.painter.context.gl.getExtension("WEBGL_lose_context");L&&L.loseContext(),Z(this._canvasContainer),Z(this._controlContainer),Z(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new f.Event("remove"))},m.prototype.triggerRepaint=function(){var v=this;this.style&&!this._frame&&(this._frame=f.browser.frame(function(k){v._frame=null,v._render(k)}))},m.prototype._onWindowOnline=function(){this._update()},m.prototype._onWindowResize=function(v){this._trackResize&&this.resize({originalEvent:v})._update()},p.showTileBoundaries.get=function(){return!!this._showTileBoundaries},p.showTileBoundaries.set=function(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())},p.showPadding.get=function(){return!!this._showPadding},p.showPadding.set=function(v){this._showPadding!==v&&(this._showPadding=v,this._update())},p.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},p.showCollisionBoxes.set=function(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())},p.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},p.showOverdrawInspector.set=function(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())},p.repaint.get=function(){return!!this._repaint},p.repaint.set=function(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())},p.vertices.get=function(){return!!this._vertices},p.vertices.set=function(v){this._vertices=v,this._update()},m.prototype._setCacheLimits=function(v,k){f.setCacheLimits(v,k)},p.version.get=function(){return f.version},Object.defineProperties(m.prototype,p),m}(eu);function Z(u){u.parentNode&&u.parentNode.removeChild(u)}var J={showCompass:!0,showZoom:!0,visualizePitch:!1},ee=function(u){var m=this;this.options=f.extend({},J,u),this._container=R.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(p){return p.preventDefault()}),this.options.showZoom&&(f.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(p){return m._map.zoomIn({},{originalEvent:p})}),R.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(p){return m._map.zoomOut({},{originalEvent:p})}),R.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(f.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(p){m.options.visualizePitch?m._map.resetNorthPitch({},{originalEvent:p}):m._map.resetNorth({},{originalEvent:p})}),this._compassIcon=R.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ee.prototype._updateZoomButtons=function(){var u=this._map.getZoom(),m=u===this._map.getMaxZoom(),p=u===this._map.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},ee.prototype._rotateCompassArrow=function(){var u=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=u},ee.prototype.onAdd=function(u){return this._map=u,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new re(this._map,this._compass,this.options.visualizePitch)),this._container},ee.prototype.onRemove=function(){R.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ee.prototype._createButton=function(u,m){var p=R.create("button",u,this._container);return p.type="button",p.addEventListener("click",m),p},ee.prototype._setButtonTitle=function(u,m){var p=this._map._getUIString("NavigationControl."+m);u.title=p,u.setAttribute("aria-label",p)};var re=function(u,m,p){p===void 0&&(p=!1),this._clickTolerance=10,this.element=m,this.mouseRotate=new hs({clickTolerance:u.dragRotate._mouseRotate._clickTolerance}),this.map=u,p&&(this.mousePitch=new Ql({clickTolerance:u.dragRotate._mousePitch._clickTolerance})),f.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),R.addEventListener(m,"mousedown",this.mousedown),R.addEventListener(m,"touchstart",this.touchstart,{passive:!1}),R.addEventListener(m,"touchmove",this.touchmove),R.addEventListener(m,"touchend",this.touchend),R.addEventListener(m,"touchcancel",this.reset)};function ue(u,m,p){if(u=new f.LngLat(u.lng,u.lat),m){var v=new f.LngLat(u.lng-360,u.lat),k=new f.LngLat(u.lng+360,u.lat),L=p.locationPoint(u).distSqr(m);p.locationPoint(v).distSqr(m)<L?u=v:p.locationPoint(k).distSqr(m)<L&&(u=k)}for(;Math.abs(u.lng-p.center.lng)>180;){var B=p.locationPoint(u);if(B.x>=0&&B.y>=0&&B.x<=p.width&&B.y<=p.height)break;u.lng>p.center.lng?u.lng-=360:u.lng+=360}return u}re.prototype.down=function(u,m){this.mouseRotate.mousedown(u,m),this.mousePitch&&this.mousePitch.mousedown(u,m),R.disableDrag()},re.prototype.move=function(u,m){var p=this.map,v=this.mouseRotate.mousemoveWindow(u,m);if(v&&v.bearingDelta&&p.setBearing(p.getBearing()+v.bearingDelta),this.mousePitch){var k=this.mousePitch.mousemoveWindow(u,m);k&&k.pitchDelta&&p.setPitch(p.getPitch()+k.pitchDelta)}},re.prototype.off=function(){var u=this.element;R.removeEventListener(u,"mousedown",this.mousedown),R.removeEventListener(u,"touchstart",this.touchstart,{passive:!1}),R.removeEventListener(u,"touchmove",this.touchmove),R.removeEventListener(u,"touchend",this.touchend),R.removeEventListener(u,"touchcancel",this.reset),this.offTemp()},re.prototype.offTemp=function(){R.enableDrag(),R.removeEventListener(f.window,"mousemove",this.mousemove),R.removeEventListener(f.window,"mouseup",this.mouseup)},re.prototype.mousedown=function(u){this.down(f.extend({},u,{ctrlKey:!0,preventDefault:function(){return u.preventDefault()}}),R.mousePos(this.element,u)),R.addEventListener(f.window,"mousemove",this.mousemove),R.addEventListener(f.window,"mouseup",this.mouseup)},re.prototype.mousemove=function(u){this.move(u,R.mousePos(this.element,u))},re.prototype.mouseup=function(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()},re.prototype.touchstart=function(u){u.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=R.touchPos(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return u.preventDefault()}},this._startPos))},re.prototype.touchmove=function(u){u.targetTouches.length!==1?this.reset():(this._lastPos=R.touchPos(this.element,u.targetTouches)[0],this.move({preventDefault:function(){return u.preventDefault()}},this._lastPos))},re.prototype.touchend=function(u){u.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},re.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ve={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Re(u,m,p){var v=u.classList;for(var k in ve)v.remove("mapboxgl-"+p+"-anchor-"+k);v.add("mapboxgl-"+p+"-anchor-"+m)}var be,De=function(u){function m(p,v){if(u.call(this),(p instanceof f.window.HTMLElement||v)&&(p=f.extend({element:p},v)),f.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=p&&p.anchor||"center",this._color=p&&p.color||"#3FB1CE",this._scale=p&&p.scale||1,this._draggable=p&&p.draggable||!1,this._clickTolerance=p&&p.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=p&&p.rotation||0,this._rotationAlignment=p&&p.rotationAlignment||"auto",this._pitchAlignment=p&&p.pitchAlignment&&p.pitchAlignment!=="auto"?p.pitchAlignment:this._rotationAlignment,p&&p.element)this._element=p.element,this._offset=f.Point.convert(p&&p.offset||[0,0]);else{this._defaultMarker=!0,this._element=R.create("div"),this._element.setAttribute("aria-label","Map marker");var k=R.createNS("http://www.w3.org/2000/svg","svg");k.setAttributeNS(null,"display","block"),k.setAttributeNS(null,"height","41px"),k.setAttributeNS(null,"width","27px"),k.setAttributeNS(null,"viewBox","0 0 27 41");var L=R.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"stroke","none"),L.setAttributeNS(null,"stroke-width","1"),L.setAttributeNS(null,"fill","none"),L.setAttributeNS(null,"fill-rule","evenodd");var B=R.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill-rule","nonzero");var j=R.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"transform","translate(3.0, 29.0)"),j.setAttributeNS(null,"fill","#000000");for(var Y=0,ie=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Y<ie.length;Y+=1){var he=ie[Y],de=R.createNS("http://www.w3.org/2000/svg","ellipse");de.setAttributeNS(null,"opacity","0.04"),de.setAttributeNS(null,"cx","10.5"),de.setAttributeNS(null,"cy","5.80029008"),de.setAttributeNS(null,"rx",he.rx),de.setAttributeNS(null,"ry",he.ry),j.appendChild(de)}var me=R.createNS("http://www.w3.org/2000/svg","g");me.setAttributeNS(null,"fill",this._color);var Ce=R.createNS("http://www.w3.org/2000/svg","path");Ce.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),me.appendChild(Ce);var Te=R.createNS("http://www.w3.org/2000/svg","g");Te.setAttributeNS(null,"opacity","0.25"),Te.setAttributeNS(null,"fill","#000000");var Le=R.createNS("http://www.w3.org/2000/svg","path");Le.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Te.appendChild(Le);var xe=R.createNS("http://www.w3.org/2000/svg","g");xe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),xe.setAttributeNS(null,"fill","#FFFFFF");var ze=R.createNS("http://www.w3.org/2000/svg","g");ze.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Fe=R.createNS("http://www.w3.org/2000/svg","circle");Fe.setAttributeNS(null,"fill","#000000"),Fe.setAttributeNS(null,"opacity","0.25"),Fe.setAttributeNS(null,"cx","5.5"),Fe.setAttributeNS(null,"cy","5.5"),Fe.setAttributeNS(null,"r","5.4999962");var Ye=R.createNS("http://www.w3.org/2000/svg","circle");Ye.setAttributeNS(null,"fill","#FFFFFF"),Ye.setAttributeNS(null,"cx","5.5"),Ye.setAttributeNS(null,"cy","5.5"),Ye.setAttributeNS(null,"r","5.4999962"),ze.appendChild(Fe),ze.appendChild(Ye),B.appendChild(j),B.appendChild(me),B.appendChild(Te),B.appendChild(xe),B.appendChild(ze),k.appendChild(B),k.setAttributeNS(null,"height",41*this._scale+"px"),k.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(k),this._offset=f.Point.convert(p&&p.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(ot){ot.preventDefault()}),this._element.addEventListener("mousedown",function(ot){ot.preventDefault()}),Re(this._element,this._anchor,"marker"),this._popup=null}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.addTo=function(p){return this.remove(),this._map=p,p.getCanvasContainer().appendChild(this._element),p.on("move",this._update),p.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},m.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),R.remove(this._element),this._popup&&this._popup.remove(),this},m.prototype.getLngLat=function(){return this._lngLat},m.prototype.setLngLat=function(p){return this._lngLat=f.LngLat.convert(p),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},m.prototype.getElement=function(){return this._element},m.prototype.setPopup=function(p){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),p){if(!("offset"in p.options)){var v=Math.sqrt(Math.pow(13.5,2)/2);p.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(24.6+v)],"bottom-right":[-v,-1*(24.6+v)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=p,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},m.prototype._onKeyPress=function(p){var v=p.code,k=p.charCode||p.keyCode;v!=="Space"&&v!=="Enter"&&k!==32&&k!==13||this.togglePopup()},m.prototype._onMapClick=function(p){var v=p.originalEvent.target,k=this._element;this._popup&&(v===k||k.contains(v))&&this.togglePopup()},m.prototype.getPopup=function(){return this._popup},m.prototype.togglePopup=function(){var p=this._popup;return p?(p.isOpen()?p.remove():p.addTo(this._map),this):this},m.prototype._update=function(p){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ue(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(v="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var k="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?k="rotateX(0deg)":this._pitchAlignment==="map"&&(k="rotateX("+this._map.getPitch()+"deg)"),p&&p.type!=="moveend"||(this._pos=this._pos.round()),R.setTransform(this._element,ve[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+k+" "+v)}},m.prototype.getOffset=function(){return this._offset},m.prototype.setOffset=function(p){return this._offset=f.Point.convert(p),this._update(),this},m.prototype._onMove=function(p){if(!this._isDragging){var v=this._clickTolerance||this._map._clickTolerance;this._isDragging=p.point.dist(this._pointerdownPos)>=v}this._isDragging&&(this._pos=p.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new f.Event("dragstart"))),this.fire(new f.Event("drag")))},m.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new f.Event("dragend")),this._state="inactive"},m.prototype._addDragHandler=function(p){this._element.contains(p.originalEvent.target)&&(p.preventDefault(),this._positionDelta=p.point.sub(this._pos).add(this._offset),this._pointerdownPos=p.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},m.prototype.setDraggable=function(p){return this._draggable=!!p,this._map&&(p?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},m.prototype.isDraggable=function(){return this._draggable},m.prototype.setRotation=function(p){return this._rotation=p||0,this._update(),this},m.prototype.getRotation=function(){return this._rotation},m.prototype.setRotationAlignment=function(p){return this._rotationAlignment=p||"auto",this._update(),this},m.prototype.getRotationAlignment=function(){return this._rotationAlignment},m.prototype.setPitchAlignment=function(p){return this._pitchAlignment=p&&p!=="auto"?p:this._rotationAlignment,this._update(),this},m.prototype.getPitchAlignment=function(){return this._pitchAlignment},m}(f.Evented),Je={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Xe=0,nt=!1,$e=function(u){function m(p){u.call(this),this.options=f.extend({},Je,p),f.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.onAdd=function(p){var v;return this._map=p,this._container=R.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),v=this._setupUI,be!==void 0?v(be):f.window.navigator.permissions!==void 0?f.window.navigator.permissions.query({name:"geolocation"}).then(function(k){v(be=k.state!=="denied")}):v(be=!!f.window.navigator.geolocation),this._container},m.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(f.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),R.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Xe=0,nt=!1},m.prototype._isOutOfMapMaxBounds=function(p){var v=this._map.getMaxBounds(),k=p.coords;return v&&(k.longitude<v.getWest()||k.longitude>v.getEast()||k.latitude<v.getSouth()||k.latitude>v.getNorth())},m.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},m.prototype._onSuccess=function(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new f.Event("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(p),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new f.Event("geolocate",p)),this._finish()}},m.prototype._updateCamera=function(p){var v=new f.LngLat(p.coords.longitude,p.coords.latitude),k=p.coords.accuracy,L=this._map.getBearing(),B=f.extend({bearing:L},this.options.fitBoundsOptions);this._map.fitBounds(v.toBounds(k),B,{geolocateSource:!0})},m.prototype._updateMarker=function(p){if(p){var v=new f.LngLat(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(v).addTo(this._map),this._userLocationDotMarker.setLngLat(v).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},m.prototype._updateCircleRadius=function(){var p=this._map._container.clientHeight/2,v=this._map.unproject([0,p]),k=this._map.unproject([1,p]),L=v.distanceTo(k),B=Math.ceil(2*this._accuracy/L);this._circleElement.style.width=B+"px",this._circleElement.style.height=B+"px"},m.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},m.prototype._onError=function(p){if(this._map){if(this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var v=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=v,this._geolocateButton.setAttribute("aria-label",v),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&nt)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new f.Event("error",p)),this._finish()}},m.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},m.prototype._setupUI=function(p){var v=this;if(this._container.addEventListener("contextmenu",function(B){return B.preventDefault()}),this._geolocateButton=R.create("button","mapboxgl-ctrl-geolocate",this._container),R.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",p===!1){f.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var k=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=k,this._geolocateButton.setAttribute("aria-label",k)}else{var L=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=L,this._geolocateButton.setAttribute("aria-label",L)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=R.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new De(this._dotElement),this._circleElement=R.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new De({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(B){B.geolocateSource||v._watchState!=="ACTIVE_LOCK"||B.originalEvent&&B.originalEvent.type==="resize"||(v._watchState="BACKGROUND",v._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),v._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),v.fire(new f.Event("trackuserlocationend")))})},m.prototype.trigger=function(){if(!this._setup)return f.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new f.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Xe--,nt=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new f.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new f.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Xe>1?(p={maximumAge:6e5,timeout:0},nt=!0):(p=this.options.positionOptions,nt=!1),this._geolocationWatchID=f.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else f.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},m.prototype._clearWatch=function(){f.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},m}(f.Evented),xt={maxWidth:100,unit:"metric"},ht=function(u){this.options=f.extend({},xt,u),f.bindAll(["_onMove","setUnit"],this)};function mt(u,m,p){var v=p&&p.maxWidth||100,k=u._container.clientHeight/2,L=u.unproject([0,k]),B=u.unproject([v,k]),j=L.distanceTo(B);if(p&&p.unit==="imperial"){var Y=3.2808*j;Y>5280?Pt(m,v,Y/5280,u._getUIString("ScaleControl.Miles")):Pt(m,v,Y,u._getUIString("ScaleControl.Feet"))}else p&&p.unit==="nautical"?Pt(m,v,j/1852,u._getUIString("ScaleControl.NauticalMiles")):j>=1e3?Pt(m,v,j/1e3,u._getUIString("ScaleControl.Kilometers")):Pt(m,v,j,u._getUIString("ScaleControl.Meters"))}function Pt(u,m,p,v){var k,L,B,j=(k=p,(L=Math.pow(10,(""+Math.floor(k)).length-1))*(B=(B=k/L)>=10?10:B>=5?5:B>=3?3:B>=2?2:B>=1?1:function(Y){var ie=Math.pow(10,Math.ceil(-Math.log(Y)/Math.LN10));return Math.round(Y*ie)/ie}(B)));u.style.width=m*(j/p)+"px",u.innerHTML=j+"&nbsp;"+v}ht.prototype.getDefaultPosition=function(){return"bottom-left"},ht.prototype._onMove=function(){mt(this._map,this._container,this.options)},ht.prototype.onAdd=function(u){return this._map=u,this._container=R.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",u.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ht.prototype.onRemove=function(){R.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ht.prototype.setUnit=function(u){this.options.unit=u,mt(this._map,this._container,this.options)};var Ot=function(u){this._fullscreen=!1,u&&u.container&&(u.container instanceof f.window.HTMLElement?this._container=u.container:f.warnOnce("Full screen control 'container' must be a DOM element.")),f.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in f.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in f.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in f.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in f.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ot.prototype.onAdd=function(u){return this._map=u,this._container||(this._container=this._map.getContainer()),this._controlContainer=R.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",f.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ot.prototype.onRemove=function(){R.remove(this._controlContainer),this._map=null,f.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ot.prototype._checkFullscreenSupport=function(){return!!(f.window.document.fullscreenEnabled||f.window.document.mozFullScreenEnabled||f.window.document.msFullscreenEnabled||f.window.document.webkitFullscreenEnabled)},Ot.prototype._setupUI=function(){var u=this._fullscreenButton=R.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);R.create("span","mapboxgl-ctrl-icon",u).setAttribute("aria-hidden",!0),u.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),f.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ot.prototype._updateTitle=function(){var u=this._getTitle();this._fullscreenButton.setAttribute("aria-label",u),this._fullscreenButton.title=u},Ot.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ot.prototype._isFullscreen=function(){return this._fullscreen},Ot.prototype._changeIcon=function(){(f.window.document.fullscreenElement||f.window.document.mozFullScreenElement||f.window.document.webkitFullscreenElement||f.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ot.prototype._onClickFullscreen=function(){this._isFullscreen()?f.window.document.exitFullscreen?f.window.document.exitFullscreen():f.window.document.mozCancelFullScreen?f.window.document.mozCancelFullScreen():f.window.document.msExitFullscreen?f.window.document.msExitFullscreen():f.window.document.webkitCancelFullScreen&&f.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var wt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ci=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),ei=function(u){function m(p){u.call(this),this.options=f.extend(Object.create(wt),p),f.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return u&&(m.__proto__=u),(m.prototype=Object.create(u&&u.prototype)).constructor=m,m.prototype.addTo=function(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new f.Event("open")),this},m.prototype.isOpen=function(){return!!this._map},m.prototype.remove=function(){return this._content&&R.remove(this._content),this._container&&(R.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new f.Event("close")),this},m.prototype.getLngLat=function(){return this._lngLat},m.prototype.setLngLat=function(p){return this._lngLat=f.LngLat.convert(p),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},m.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},m.prototype.getElement=function(){return this._container},m.prototype.setText=function(p){return this.setDOMContent(f.window.document.createTextNode(p))},m.prototype.setHTML=function(p){var v,k=f.window.document.createDocumentFragment(),L=f.window.document.createElement("body");for(L.innerHTML=p;v=L.firstChild;)k.appendChild(v);return this.setDOMContent(k)},m.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},m.prototype.setMaxWidth=function(p){return this.options.maxWidth=p,this._update(),this},m.prototype.setDOMContent=function(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=R.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this},m.prototype.addClassName=function(p){this._container&&this._container.classList.add(p)},m.prototype.removeClassName=function(p){this._container&&this._container.classList.remove(p)},m.prototype.setOffset=function(p){return this.options.offset=p,this._update(),this},m.prototype.toggleClassName=function(p){if(this._container)return this._container.classList.toggle(p)},m.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=R.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},m.prototype._onMouseUp=function(p){this._update(p.point)},m.prototype._onMouseMove=function(p){this._update(p.point)},m.prototype._onDrag=function(p){this._update(p.point)},m.prototype._update=function(p){var v=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=R.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=R.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(de){return v._container.classList.add(de)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ue(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||p)){var k=this._pos=this._trackPointer&&p?p:this._map.project(this._lngLat),L=this.options.anchor,B=function de(me){if(me){if(typeof me=="number"){var Ce=Math.round(Math.sqrt(.5*Math.pow(me,2)));return{center:new f.Point(0,0),top:new f.Point(0,me),"top-left":new f.Point(Ce,Ce),"top-right":new f.Point(-Ce,Ce),bottom:new f.Point(0,-me),"bottom-left":new f.Point(Ce,-Ce),"bottom-right":new f.Point(-Ce,-Ce),left:new f.Point(me,0),right:new f.Point(-me,0)}}if(me instanceof f.Point||Array.isArray(me)){var Te=f.Point.convert(me);return{center:Te,top:Te,"top-left":Te,"top-right":Te,bottom:Te,"bottom-left":Te,"bottom-right":Te,left:Te,right:Te}}return{center:f.Point.convert(me.center||[0,0]),top:f.Point.convert(me.top||[0,0]),"top-left":f.Point.convert(me["top-left"]||[0,0]),"top-right":f.Point.convert(me["top-right"]||[0,0]),bottom:f.Point.convert(me.bottom||[0,0]),"bottom-left":f.Point.convert(me["bottom-left"]||[0,0]),"bottom-right":f.Point.convert(me["bottom-right"]||[0,0]),left:f.Point.convert(me.left||[0,0]),right:f.Point.convert(me.right||[0,0])}}return de(new f.Point(0,0))}(this.options.offset);if(!L){var j,Y=this._container.offsetWidth,ie=this._container.offsetHeight;j=k.y+B.bottom.y<ie?["top"]:k.y>this._map.transform.height-ie?["bottom"]:[],k.x<Y/2?j.push("left"):k.x>this._map.transform.width-Y/2&&j.push("right"),L=j.length===0?"bottom":j.join("-")}var he=k.add(B[L]).round();R.setTransform(this._container,ve[L]+" translate("+he.x+"px,"+he.y+"px)"),Re(this._container,L,"popup")}},m.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var p=this._container.querySelector(ci);p&&p.focus()}},m.prototype._onClose=function(){this.remove()},m}(f.Evented),Oi={version:f.version,supported:d,setRTLTextPlugin:f.setRTLTextPlugin,getRTLTextPluginStatus:f.getRTLTextPluginStatus,Map:F,NavigationControl:ee,GeolocateControl:$e,AttributionControl:Mn,ScaleControl:ht,FullscreenControl:Ot,Popup:ei,Marker:De,Style:ao,LngLat:f.LngLat,LngLatBounds:f.LngLatBounds,Point:f.Point,MercatorCoordinate:f.MercatorCoordinate,Evented:f.Evented,config:f.config,prewarm:function(){fe().acquire(W)},clearPrewarmedResources:function(){var u=ce;u&&(u.isPreloaded()&&u.numActive()===1?(u.release(W),ce=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return f.config.ACCESS_TOKEN},set accessToken(u){f.config.ACCESS_TOKEN=u},get baseApiUrl(){return f.config.API_URL},set baseApiUrl(u){f.config.API_URL=u},get workerCount(){return ne.workerCount},set workerCount(u){ne.workerCount=u},get maxParallelImageRequests(){return f.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(u){f.config.MAX_PARALLEL_IMAGE_REQUESTS=u},clearStorage:function(u){f.clearTileCache(u)},workerUrl:""};return Oi}),T})})(wg);Object.defineProperty(x0,"__esModule",{value:!0});const vS=wg.exports;class xS{constructor(a){this.map=a,this.contents=[]}add(a,l,x){var T;let P=`
    <div class="mapboxgl-popup-layer-name">${x}</div>
    <div class="mapboxgl-popup-panel_area"><table class="mapboxgl-popup-table">
    ${Object.keys(l.properties).map(R=>`<tr><th class="mapboxgl-popup-th">${R.replace(/_/g," ").replace(/-/g," ")}</th><td class="mapboxgl-popup-td">${l.properties[R]}</td></tr>`).join("")}
    </table></div>`;this.contents.push(P);let f;if(this.contents.length===1?f=this.contents[0]:f=`
      <div class="mapboxgl-popup-tab_wrap">
      ${this.contents.map(R=>{let q=this.contents.indexOf(R)+1;return`<input id="mapboxgl-popup-tab${q}" type="radio" name="tab_btn" ${q===0?"checked":""}>`}).join("")}
      <div class="mapboxgl-popup-tab_area">
      ${this.contents.map(R=>{let q=this.contents.indexOf(R)+1;return`<label class="mapboxgl-popup-tab${q}_label" for="mapboxgl-popup-tab${q}">${q}</label>`}).join("")}
      </div>
      <div class="mapboxgl-popup-panel_area">
      ${this.contents.map(R=>`<div id="mapboxgl-popup-panel${this.contents.indexOf(R)+1}" class="mapboxgl-popup-tab_panel">${R}</div>`).join("")}
      </div>
     </div>`,this.popup?this.popup.setHTML(f):this.popup=new vS.Popup().setLngLat(a).setHTML(f).setMaxWidth("400px").addTo(this.map),this.contents.length>1){const R=document.getElementById("mapboxgl-popup-tab1");R.checked=!0}var d=this;(T=d.popup)===null||T===void 0||T.on("close",function(){d.popup=null,d.contents=[]})}}class bS{constructor(a=[]){this.targets=a}createPopup(a,l){var x;let T=a.lngLat;const P=a.features[0];for(P.geometry.type==="Point"&&(T=P.geometry.coordinates.slice());Math.abs(a.lngLat.lng-T[0])>180;)T[0]+=a.lngLat.lng>T[0]?360:-360;!this.map||(x=this.popupManager)===null||x===void 0||x.add(T,P,l)}onAdd(a){if(this.map=a,this.popupManager=new xS(this.map),this.targets.length>0){const l=this;this.targets.forEach(x=>{a.on("click",x,function(T){l.createPopup(T,x)})})}return this.controlContainer=document.createElement("div"),this.controlContainer.className="mapboxgl-ctrl mapboxgl-ctrl-group",Object.assign(this.controlContainer,{style:"display:none"}),this.popupButton=document.createElement("button"),this.popupButton.className="mapboxgl-ctrl-icon",this.popupButton.type="button",this.controlContainer.appendChild(this.popupButton),this.controlContainer}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.popupButton||(this.controlContainer.parentNode.removeChild(this.controlContainer),this.map=void 0)}}var wS=x0.default=bS,Eg={};Object.defineProperty(Eg,"__esModule",{value:!0});var b0=Eg.MapboxStyleSwitcherControl=void 0;class Up{constructor(a,l){this.styles=a||Up.DEFAULT_STYLES,this.defaultStyle=l||Up.DEFAULT_STYLE,this.styleUrl=new ES,this.defaultStyleFromUrl=this.styleUrl.get();let x=!1;for(const T of this.styles)T.title===this.defaultStyleFromUrl&&(x=!0);x||(this.styleUrl.delete(),this.defaultStyleFromUrl=null),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}onAdd(a){this.map=a,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.mapStyleContainer=document.createElement("div"),this.styleButton=document.createElement("button"),this.styleButton.type="button",this.mapStyleContainer.classList.add("mapboxgl-style-list");for(const l of this.styles){const x=document.createElement("button");x.type="button",x.innerText=l.title,x.classList.add(l.title.replace(/[^a-z0-9-]/gi,"_")),x.dataset.uri=JSON.stringify(l.uri),x.dataset.title=l.title,x.addEventListener("click",T=>{const P=T.srcElement;if(P.classList.contains("active"))return;this.map.setStyle(JSON.parse(P.dataset.uri)),this.styleUrl.set(P.dataset.title),this.mapStyleContainer.style.display="none",this.styleButton.style.display="block";const f=this.mapStyleContainer.getElementsByClassName("active");for(;f[0];)f[0].classList.remove("active");P.classList.add("active")}),l.title===this.defaultStyleFromUrl&&this.mapStyleContainer.getElementsByClassName("active").length===0&&(x.classList.add("active"),this.map.setStyle(l.uri)),!this.defaultStyleFromUrl&&l.title===this.defaultStyle&&this.mapStyleContainer.getElementsByClassName("active").length===0&&(x.classList.add("active"),this.map.setStyle(l.uri)),this.mapStyleContainer.appendChild(x)}return this.styleButton.classList.add("mapboxgl-ctrl-icon"),this.styleButton.classList.add("mapboxgl-style-switcher"),this.styleButton.addEventListener("click",()=>{this.styleButton.style.display="none",this.mapStyleContainer.style.display="block"}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.styleButton),this.controlContainer.appendChild(this.mapStyleContainer),this.controlContainer}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.styleButton||(this.styleButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.map=void 0)}onDocumentClick(a){this.controlContainer&&!this.controlContainer.contains(a.target)&&this.mapStyleContainer&&this.styleButton&&(this.mapStyleContainer.style.display="none",this.styleButton.style.display="block")}}b0=Eg.MapboxStyleSwitcherControl=Up;Up.DEFAULT_STYLE="Streets";Up.DEFAULT_STYLES=[{title:"Dark",uri:"mapbox://styles/mapbox/dark-v10"},{title:"Light",uri:"mapbox://styles/mapbox/light-v10"},{title:"Outdoors",uri:"mapbox://styles/mapbox/outdoors-v11"},{title:"Satellite",uri:"mapbox://styles/mapbox/satellite-streets-v11"},{title:"Streets",uri:"mapbox://styles/mapbox/streets-v11"}];class ES{constructor(){this.STYLE_PATHNAME="style"}getUrl(){const a=window.location,l=new URL(a.href);return l.hash=a.hash,l}updateUrl(a){history.replaceState("","",a.toString())}get(){return this.getUrl().searchParams.get(this.STYLE_PATHNAME)}set(a){const l=this.getUrl();l.searchParams.set(this.STYLE_PATHNAME,a),this.updateUrl(l)}delete(){const a=this.getUrl();a.searchParams.delete(this.STYLE_PATHNAME),this.updateUrl(a)}}var w0={},Ig={},Sg={},dm={},Tg={exports:{}},E0=function(a,l){return function(){for(var T=new Array(arguments.length),P=0;P<T.length;P++)T[P]=arguments[P];return a.apply(l,T)}},IS=E0,ep=Object.prototype.toString;function Ag(c){return ep.call(c)==="[object Array]"}function Hy(c){return typeof c=="undefined"}function SS(c){return c!==null&&!Hy(c)&&c.constructor!==null&&!Hy(c.constructor)&&typeof c.constructor.isBuffer=="function"&&c.constructor.isBuffer(c)}function TS(c){return ep.call(c)==="[object ArrayBuffer]"}function AS(c){return typeof FormData!="undefined"&&c instanceof FormData}function CS(c){var a;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?a=ArrayBuffer.isView(c):a=c&&c.buffer&&c.buffer instanceof ArrayBuffer,a}function kS(c){return typeof c=="string"}function zS(c){return typeof c=="number"}function I0(c){return c!==null&&typeof c=="object"}function Uf(c){if(ep.call(c)!=="[object Object]")return!1;var a=Object.getPrototypeOf(c);return a===null||a===Object.prototype}function PS(c){return ep.call(c)==="[object Date]"}function MS(c){return ep.call(c)==="[object File]"}function LS(c){return ep.call(c)==="[object Blob]"}function S0(c){return ep.call(c)==="[object Function]"}function DS(c){return I0(c)&&S0(c.pipe)}function RS(c){return typeof URLSearchParams!="undefined"&&c instanceof URLSearchParams}function BS(c){return c.trim?c.trim():c.replace(/^\s+|\s+$/g,"")}function OS(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function Cg(c,a){if(!(c===null||typeof c=="undefined"))if(typeof c!="object"&&(c=[c]),Ag(c))for(var l=0,x=c.length;l<x;l++)a.call(null,c[l],l,c);else for(var T in c)Object.prototype.hasOwnProperty.call(c,T)&&a.call(null,c[T],T,c)}function Wy(){var c={};function a(T,P){Uf(c[P])&&Uf(T)?c[P]=Wy(c[P],T):Uf(T)?c[P]=Wy({},T):Ag(T)?c[P]=T.slice():c[P]=T}for(var l=0,x=arguments.length;l<x;l++)Cg(arguments[l],a);return c}function FS(c,a,l){return Cg(a,function(T,P){l&&typeof T=="function"?c[P]=IS(T,l):c[P]=T}),c}function US(c){return c.charCodeAt(0)===65279&&(c=c.slice(1)),c}var pl={isArray:Ag,isArrayBuffer:TS,isBuffer:SS,isFormData:AS,isArrayBufferView:CS,isString:kS,isNumber:zS,isObject:I0,isPlainObject:Uf,isUndefined:Hy,isDate:PS,isFile:MS,isBlob:LS,isFunction:S0,isStream:DS,isURLSearchParams:RS,isStandardBrowserEnv:OS,forEach:Cg,merge:Wy,extend:FS,trim:BS,stripBOM:US},kp=pl;function q_(c){return encodeURIComponent(c).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var T0=function(a,l,x){if(!l)return a;var T;if(x)T=x(l);else if(kp.isURLSearchParams(l))T=l.toString();else{var P=[];kp.forEach(l,function(R,q){R===null||typeof R=="undefined"||(kp.isArray(R)?q=q+"[]":R=[R],kp.forEach(R,function(G){kp.isDate(G)?G=G.toISOString():kp.isObject(G)&&(G=JSON.stringify(G)),P.push(q_(q)+"="+q_(G))}))}),T=P.join("&")}if(T){var f=a.indexOf("#");f!==-1&&(a=a.slice(0,f)),a+=(a.indexOf("?")===-1?"?":"&")+T}return a},NS=pl;function fm(){this.handlers=[]}fm.prototype.use=function(a,l,x){return this.handlers.push({fulfilled:a,rejected:l,synchronous:x?x.synchronous:!1,runWhen:x?x.runWhen:null}),this.handlers.length-1};fm.prototype.eject=function(a){this.handlers[a]&&(this.handlers[a]=null)};fm.prototype.forEach=function(a){NS.forEach(this.handlers,function(x){x!==null&&a(x)})};var jS=fm,VS=pl,qS=function(a,l){VS.forEach(a,function(T,P){P!==l&&P.toUpperCase()===l.toUpperCase()&&(a[l]=T,delete a[P])})},A0=function(a,l,x,T,P){return a.config=l,x&&(a.code=x),a.request=T,a.response=P,a.isAxiosError=!0,a.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},a},GS=A0,C0=function(a,l,x,T,P){var f=new Error(a);return GS(f,l,x,T,P)},ZS=C0,HS=function(a,l,x){var T=x.config.validateStatus;!x.status||!T||T(x.status)?a(x):l(ZS("Request failed with status code "+x.status,x.config,null,x.request,x))},Lf=pl,WS=Lf.isStandardBrowserEnv()?function(){return{write:function(l,x,T,P,f,d){var R=[];R.push(l+"="+encodeURIComponent(x)),Lf.isNumber(T)&&R.push("expires="+new Date(T).toGMTString()),Lf.isString(P)&&R.push("path="+P),Lf.isString(f)&&R.push("domain="+f),d===!0&&R.push("secure"),document.cookie=R.join("; ")},read:function(l){var x=document.cookie.match(new RegExp("(^|;\\s*)("+l+")=([^;]*)"));return x?decodeURIComponent(x[3]):null},remove:function(l){this.write(l,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),XS=function(a){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(a)},KS=function(a,l){return l?a.replace(/\/+$/,"")+"/"+l.replace(/^\/+/,""):a},JS=XS,YS=KS,$S=function(a,l){return a&&!JS(l)?YS(a,l):l},Cy=pl,QS=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],eT=function(a){var l={},x,T,P;return a&&Cy.forEach(a.split(`
`),function(d){if(P=d.indexOf(":"),x=Cy.trim(d.substr(0,P)).toLowerCase(),T=Cy.trim(d.substr(P+1)),x){if(l[x]&&QS.indexOf(x)>=0)return;x==="set-cookie"?l[x]=(l[x]?l[x]:[]).concat([T]):l[x]=l[x]?l[x]+", "+T:T}}),l},G_=pl,tT=G_.isStandardBrowserEnv()?function(){var a=/(msie|trident)/i.test(navigator.userAgent),l=document.createElement("a"),x;function T(P){var f=P;return a&&(l.setAttribute("href",f),f=l.href),l.setAttribute("href",f),{href:l.href,protocol:l.protocol?l.protocol.replace(/:$/,""):"",host:l.host,search:l.search?l.search.replace(/^\?/,""):"",hash:l.hash?l.hash.replace(/^#/,""):"",hostname:l.hostname,port:l.port,pathname:l.pathname.charAt(0)==="/"?l.pathname:"/"+l.pathname}}return x=T(window.location.href),function(f){var d=G_.isString(f)?T(f):f;return d.protocol===x.protocol&&d.host===x.host}}():function(){return function(){return!0}}(),Df=pl,iT=HS,rT=WS,nT=T0,oT=$S,aT=eT,sT=tT,ky=C0,Z_=function(a){return new Promise(function(x,T){var P=a.data,f=a.headers,d=a.responseType;Df.isFormData(P)&&delete f["Content-Type"];var R=new XMLHttpRequest;if(a.auth){var q=a.auth.username||"",V=a.auth.password?unescape(encodeURIComponent(a.auth.password)):"";f.Authorization="Basic "+btoa(q+":"+V)}var G=oT(a.baseURL,a.url);R.open(a.method.toUpperCase(),nT(G,a.params,a.paramsSerializer),!0),R.timeout=a.timeout;function X(){if(!!R){var ke="getAllResponseHeaders"in R?aT(R.getAllResponseHeaders()):null,qe=!d||d==="text"||d==="json"?R.responseText:R.response,We={data:qe,status:R.status,statusText:R.statusText,headers:ke,config:a,request:R};iT(x,T,We),R=null}}if("onloadend"in R?R.onloadend=X:R.onreadystatechange=function(){!R||R.readyState!==4||R.status===0&&!(R.responseURL&&R.responseURL.indexOf("file:")===0)||setTimeout(X)},R.onabort=function(){!R||(T(ky("Request aborted",a,"ECONNABORTED",R)),R=null)},R.onerror=function(){T(ky("Network Error",a,null,R)),R=null},R.ontimeout=function(){var qe="timeout of "+a.timeout+"ms exceeded";a.timeoutErrorMessage&&(qe=a.timeoutErrorMessage),T(ky(qe,a,a.transitional&&a.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",R)),R=null},Df.isStandardBrowserEnv()){var Me=(a.withCredentials||sT(G))&&a.xsrfCookieName?rT.read(a.xsrfCookieName):void 0;Me&&(f[a.xsrfHeaderName]=Me)}"setRequestHeader"in R&&Df.forEach(f,function(qe,We){typeof P=="undefined"&&We.toLowerCase()==="content-type"?delete f[We]:R.setRequestHeader(We,qe)}),Df.isUndefined(a.withCredentials)||(R.withCredentials=!!a.withCredentials),d&&d!=="json"&&(R.responseType=a.responseType),typeof a.onDownloadProgress=="function"&&R.addEventListener("progress",a.onDownloadProgress),typeof a.onUploadProgress=="function"&&R.upload&&R.upload.addEventListener("progress",a.onUploadProgress),a.cancelToken&&a.cancelToken.promise.then(function(qe){!R||(R.abort(),T(qe),R=null)}),P||(P=null),R.send(P)})},Ma=pl,H_=qS,lT=A0,uT={"Content-Type":"application/x-www-form-urlencoded"};function W_(c,a){!Ma.isUndefined(c)&&Ma.isUndefined(c["Content-Type"])&&(c["Content-Type"]=a)}function cT(){var c;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(c=Z_),c}function hT(c,a,l){if(Ma.isString(c))try{return(a||JSON.parse)(c),Ma.trim(c)}catch(x){if(x.name!=="SyntaxError")throw x}return(l||JSON.stringify)(c)}var mm={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:cT(),transformRequest:[function(a,l){return H_(l,"Accept"),H_(l,"Content-Type"),Ma.isFormData(a)||Ma.isArrayBuffer(a)||Ma.isBuffer(a)||Ma.isStream(a)||Ma.isFile(a)||Ma.isBlob(a)?a:Ma.isArrayBufferView(a)?a.buffer:Ma.isURLSearchParams(a)?(W_(l,"application/x-www-form-urlencoded;charset=utf-8"),a.toString()):Ma.isObject(a)||l&&l["Content-Type"]==="application/json"?(W_(l,"application/json"),hT(a)):a}],transformResponse:[function(a){var l=this.transitional,x=l&&l.silentJSONParsing,T=l&&l.forcedJSONParsing,P=!x&&this.responseType==="json";if(P||T&&Ma.isString(a)&&a.length)try{return JSON.parse(a)}catch(f){if(P)throw f.name==="SyntaxError"?lT(f,this,"E_JSON_PARSE"):f}return a}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(a){return a>=200&&a<300}};mm.headers={common:{Accept:"application/json, text/plain, */*"}};Ma.forEach(["delete","get","head"],function(a){mm.headers[a]={}});Ma.forEach(["post","put","patch"],function(a){mm.headers[a]=Ma.merge(uT)});var kg=mm,pT=pl,dT=kg,fT=function(a,l,x){var T=this||dT;return pT.forEach(x,function(f){a=f.call(T,a,l)}),a},k0=function(a){return!!(a&&a.__CANCEL__)},X_=pl,zy=fT,mT=k0,yT=kg;function Py(c){c.cancelToken&&c.cancelToken.throwIfRequested()}var gT=function(a){Py(a),a.headers=a.headers||{},a.data=zy.call(a,a.data,a.headers,a.transformRequest),a.headers=X_.merge(a.headers.common||{},a.headers[a.method]||{},a.headers),X_.forEach(["delete","get","head","post","put","patch","common"],function(T){delete a.headers[T]});var l=a.adapter||yT.adapter;return l(a).then(function(T){return Py(a),T.data=zy.call(a,T.data,T.headers,a.transformResponse),T},function(T){return mT(T)||(Py(a),T&&T.response&&(T.response.data=zy.call(a,T.response.data,T.response.headers,a.transformResponse))),Promise.reject(T)})},Ka=pl,z0=function(a,l){l=l||{};var x={},T=["url","method","data"],P=["headers","auth","proxy","params"],f=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],d=["validateStatus"];function R(X,Me){return Ka.isPlainObject(X)&&Ka.isPlainObject(Me)?Ka.merge(X,Me):Ka.isPlainObject(Me)?Ka.merge({},Me):Ka.isArray(Me)?Me.slice():Me}function q(X){Ka.isUndefined(l[X])?Ka.isUndefined(a[X])||(x[X]=R(void 0,a[X])):x[X]=R(a[X],l[X])}Ka.forEach(T,function(Me){Ka.isUndefined(l[Me])||(x[Me]=R(void 0,l[Me]))}),Ka.forEach(P,q),Ka.forEach(f,function(Me){Ka.isUndefined(l[Me])?Ka.isUndefined(a[Me])||(x[Me]=R(void 0,a[Me])):x[Me]=R(void 0,l[Me])}),Ka.forEach(d,function(Me){Me in l?x[Me]=R(a[Me],l[Me]):Me in a&&(x[Me]=R(void 0,a[Me]))});var V=T.concat(P).concat(f).concat(d),G=Object.keys(a).concat(Object.keys(l)).filter(function(Me){return V.indexOf(Me)===-1});return Ka.forEach(G,q),x};const _T="axios",vT="0.21.4",xT="Promise based HTTP client for the browser and node.js",bT="index.js",wT={test:"grunt test",start:"node ./sandbox/server.js",build:"NODE_ENV=production grunt build",preversion:"npm test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json",postversion:"git push && git push --tags",examples:"node ./examples/server.js",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",fix:"eslint --fix lib/**/*.js"},ET={type:"git",url:"https://github.com/axios/axios.git"},IT=["xhr","http","ajax","promise","node"],ST="Matt Zabriskie",TT="MIT",AT={url:"https://github.com/axios/axios/issues"},CT="https://axios-http.com",kT={coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",mocha:"^8.2.1",sinon:"^4.5.0","terser-webpack-plugin":"^4.2.3",typescript:"^4.0.5","url-search-params":"^0.10.0",webpack:"^4.44.2","webpack-dev-server":"^3.11.0"},zT={"./lib/adapters/http.js":"./lib/adapters/xhr.js"},PT="dist/axios.min.js",MT="dist/axios.min.js",LT="./index.d.ts",DT={"follow-redirects":"^1.14.0"},RT=[{path:"./dist/axios.min.js",threshold:"5kB"}];var BT={name:_T,version:vT,description:xT,main:bT,scripts:wT,repository:ET,keywords:IT,author:ST,license:TT,bugs:AT,homepage:CT,devDependencies:kT,browser:zT,jsdelivr:PT,unpkg:MT,typings:LT,dependencies:DT,bundlesize:RT},P0=BT,zg={};["object","boolean","number","function","string","symbol"].forEach(function(c,a){zg[c]=function(x){return typeof x===c||"a"+(a<1?"n ":" ")+c}});var K_={},OT=P0.version.split(".");function M0(c,a){for(var l=a?a.split("."):OT,x=c.split("."),T=0;T<3;T++){if(l[T]>x[T])return!0;if(l[T]<x[T])return!1}return!1}zg.transitional=function(a,l,x){var T=l&&M0(l);function P(f,d){return"[Axios v"+P0.version+"] Transitional option '"+f+"'"+d+(x?". "+x:"")}return function(f,d,R){if(a===!1)throw new Error(P(d," has been removed in "+l));return T&&!K_[d]&&(K_[d]=!0,console.warn(P(d," has been deprecated since v"+l+" and will be removed in the near future"))),a?a(f,d,R):!0}};function FT(c,a,l){if(typeof c!="object")throw new TypeError("options must be an object");for(var x=Object.keys(c),T=x.length;T-- >0;){var P=x[T],f=a[P];if(f){var d=c[P],R=d===void 0||f(d,P,c);if(R!==!0)throw new TypeError("option "+P+" must be "+R);continue}if(l!==!0)throw Error("Unknown option "+P)}}var UT={isOlderVersion:M0,assertOptions:FT,validators:zg},L0=pl,NT=T0,J_=jS,Y_=gT,ym=z0,D0=UT,zp=D0.validators;function qd(c){this.defaults=c,this.interceptors={request:new J_,response:new J_}}qd.prototype.request=function(a){typeof a=="string"?(a=arguments[1]||{},a.url=arguments[0]):a=a||{},a=ym(this.defaults,a),a.method?a.method=a.method.toLowerCase():this.defaults.method?a.method=this.defaults.method.toLowerCase():a.method="get";var l=a.transitional;l!==void 0&&D0.assertOptions(l,{silentJSONParsing:zp.transitional(zp.boolean,"1.0.0"),forcedJSONParsing:zp.transitional(zp.boolean,"1.0.0"),clarifyTimeoutError:zp.transitional(zp.boolean,"1.0.0")},!1);var x=[],T=!0;this.interceptors.request.forEach(function(X){typeof X.runWhen=="function"&&X.runWhen(a)===!1||(T=T&&X.synchronous,x.unshift(X.fulfilled,X.rejected))});var P=[];this.interceptors.response.forEach(function(X){P.push(X.fulfilled,X.rejected)});var f;if(!T){var d=[Y_,void 0];for(Array.prototype.unshift.apply(d,x),d=d.concat(P),f=Promise.resolve(a);d.length;)f=f.then(d.shift(),d.shift());return f}for(var R=a;x.length;){var q=x.shift(),V=x.shift();try{R=q(R)}catch(G){V(G);break}}try{f=Y_(R)}catch(G){return Promise.reject(G)}for(;P.length;)f=f.then(P.shift(),P.shift());return f};qd.prototype.getUri=function(a){return a=ym(this.defaults,a),NT(a.url,a.params,a.paramsSerializer).replace(/^\?/,"")};L0.forEach(["delete","get","head","options"],function(a){qd.prototype[a]=function(l,x){return this.request(ym(x||{},{method:a,url:l,data:(x||{}).data}))}});L0.forEach(["post","put","patch"],function(a){qd.prototype[a]=function(l,x,T){return this.request(ym(T||{},{method:a,url:l,data:x}))}});var jT=qd;function Pg(c){this.message=c}Pg.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};Pg.prototype.__CANCEL__=!0;var R0=Pg,VT=R0;function Jf(c){if(typeof c!="function")throw new TypeError("executor must be a function.");var a;this.promise=new Promise(function(T){a=T});var l=this;c(function(T){l.reason||(l.reason=new VT(T),a(l.reason))})}Jf.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};Jf.source=function(){var a,l=new Jf(function(T){a=T});return{token:l,cancel:a}};var qT=Jf,GT=function(a){return function(x){return a.apply(null,x)}},ZT=function(a){return typeof a=="object"&&a.isAxiosError===!0},$_=pl,HT=E0,Nf=jT,WT=z0,XT=kg;function B0(c){var a=new Nf(c),l=HT(Nf.prototype.request,a);return $_.extend(l,Nf.prototype,a),$_.extend(l,a),l}var _u=B0(XT);_u.Axios=Nf;_u.create=function(a){return B0(WT(_u.defaults,a))};_u.Cancel=R0;_u.CancelToken=qT;_u.isCancel=k0;_u.all=function(a){return Promise.all(a)};_u.spread=GT;_u.isAxiosError=ZT;Tg.exports=_u;Tg.exports.default=_u;var KT=Tg.exports;(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.ContourType=c.Costing=void 0;const a=KT,l=wg.exports;c.Costing={Walking:"pedestrian",Bicycle:"bicycle",Car:"auto"},c.ContourType={Time:"time",Distance:"distance"};class x{constructor(P,f,d){this.contourSources=[],this.contourLayers=[],this.contourMaker=void 0,this.contours=[{time:5,distance:1,color:"ff0000"},{time:10,distance:3,color:"ffff00"},{time:15,distance:5,color:"0000ff"}],this.map=P,this.url=f,d&&(this.contours=d)}clearFeatures(){this.contourLayers&&this.contourLayers.length>0&&(this.contourLayers.forEach(P=>{var f;(f=this.map)===null||f===void 0||f.removeLayer(P)}),this.contourLayers=[]),this.contourSources&&this.contourSources.length>0&&(this.contourSources.forEach(P=>{var f;(f=this.map)===null||f===void 0||f.removeSource(P)}),this.contourSources=[]),this.contourMaker&&(this.contourMaker.remove(),this.contourMaker=void 0)}getIsochrone(P,f,d,R,q){this.clearFeatures();let V=JSON.parse(JSON.stringify(this.contours));q&&(V=q),V.forEach(X=>{d===c.ContourType.Time?delete X.distance:delete X.time});let G="km";return d===c.ContourType.Time&&(G="min"),new Promise((X,Me)=>{const ke={locations:[{lat:f,lon:P}],costing:R,contours:V,polygons:!0},qe=`${this.url}/isochrone?json=${JSON.stringify(ke)}`;a.default.get(qe).then(We=>{We.data.features.forEach(Ge=>{var Ze,gt,ct,pt;const lt=`isochrone-${Ge.properties.contour}`;(Ze=this.map)===null||Ze===void 0||Ze.addSource(lt,{type:"geojson",data:Ge}),this.contourSources.push(lt),(gt=this.map)===null||gt===void 0||gt.addLayer({id:`pg-${lt}`,type:"fill",source:lt,layout:{},paint:{"fill-color":Ge.properties.fillColor,"fill-opacity":.1}}),this.contourLayers.push(`pg-${lt}`),(ct=this.map)===null||ct===void 0||ct.addLayer({id:`ls-${lt}`,type:"line",source:lt,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":Ge.properties.fillColor,"line-width":3}}),this.contourLayers.push(`ls-${lt}`),(pt=this.map)===null||pt===void 0||pt.addLayer({id:`symbol-${lt}`,type:"symbol",source:lt,layout:{"symbol-placement":"line","text-pitch-alignment":"viewport","text-font":["Roboto Bold"],"text-field":["concat",["get","contour"],` ${G}`],"text-size":16},paint:{"text-color":"#000000","text-halo-width":1,"text-halo-color":"#FFFFFF"}}),this.contourLayers.push(`symbol-${lt}`)}),this.map&&(this.contourMaker=new l.Marker().setLngLat([P,f]).addTo(this.map)),X()}).catch(We=>Me(We))})}getContoursOption(){return this.contours}}c.default=x})(dm);var gm={};Object.defineProperty(gm,"__esModule",{value:!0});class JT{constructor(a){this.color="#535353",this.map=a}create(){this.updateValues(),this.map!==void 0?(this.map.on("resize",this.mapResize.bind(this)),this.createCanvas(this.map.getCanvasContainer())):console.error("map object is null")}updateValues(){var a,l;this.width=(a=this.map)===null||a===void 0?void 0:a.getCanvas().clientWidth,this.height=(l=this.map)===null||l===void 0?void 0:l.getCanvas().clientHeight}mapResize(){this.updateValues(),this.updateCanvas()}updateCanvas(){if(this.svgCanvas!==void 0&&this.yLine!==void 0&&this.xLine!==void 0&&this.width!==void 0&&this.height!==void 0){this.svgCanvas.setAttribute("width",`${this.width}px`),this.svgCanvas.setAttribute("height",`${this.height}px`);const a=this.width/2,l=this.height/2;this.yLine.setAttribute("x1",`${a}px`),this.yLine.setAttribute("y1","0px"),this.yLine.setAttribute("x2",`${a}px`),this.yLine.setAttribute("y2",`${this.height}px`),this.xLine.setAttribute("x1",`${0}px`),this.xLine.setAttribute("y1",`${l}px`),this.xLine.setAttribute("x2",`${this.width}px`),this.xLine.setAttribute("y2",`${l}px`)}}createCanvas(a){if(this.width!==void 0&&this.height!==void 0){const l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.style.position="relative",l.setAttribute("width",`${this.width}px`),l.setAttribute("height",`${this.height}px`);const x=this.width/2,T=this.height/2;this.yLine=l.appendChild(this.createLine(x,0,x,this.height,this.color,"2px")),this.xLine=l.appendChild(this.createLine(0,T,this.width,T,this.color,"2px")),a==null||a.appendChild(l),this.svgCanvas=l}}createLine(a,l,x,T,P,f){const d=document.createElementNS("http://www.w3.org/2000/svg","line");return d.setAttribute("x1",a),d.setAttribute("y1",l),d.setAttribute("x2",x),d.setAttribute("y2",T),d.setAttribute("stroke-dasharray","5,5"),d.setAttribute("stroke",P),d.setAttribute("stroke-width",f),d}destroy(){this.xLine!==void 0&&(this.xLine.remove(),this.xLine=void 0),this.yLine!==void 0&&(this.yLine.remove(),this.yLine=void 0),this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map.off("resize",this.mapResize),this.map=void 0)}}gm.default=JT;var Jh={};Object.defineProperty(Jh,"__esModule",{value:!0});Jh.createTextbox=Jh.createSelection=void 0;const YT=(c,a,l,x,T)=>{const P=document.createElement("label");P.textContent=a;const f=document.createElement("select");f.setAttribute("id",`mapbox-gl-valhalla-${l}`),f.style.width="100%",Object.keys(c).forEach(V=>{const G=document.createElement("option");G.setAttribute("value",T(c,V)),G.appendChild(document.createTextNode(V)),G.setAttribute("name",l),x===c[V]&&(G.selected=!0),f.appendChild(G)});const d=document.createElement("TR"),R=document.createElement("TD"),q=document.createElement("TD");return R.appendChild(P),q.appendChild(f),d.appendChild(R),d.appendChild(q),d};Jh.createSelection=YT;const $T=(c,a,l,x,T)=>{const P=document.createElement("label");P.textContent=c,T||(T="text");const f=document.createElement("input");f.setAttribute("id",`mapbox-gl-valhalla-${a}`),f.setAttribute("type",T),f.setAttribute("value",l),f.readOnly=x;const d=document.createElement("TR"),R=document.createElement("TD"),q=document.createElement("TD");return R.appendChild(P),q.appendChild(f),d.appendChild(R),d.appendChild(q),d};Jh.createTextbox=$T;Object.defineProperty(Sg,"__esModule",{value:!0});const My=dm,QT=gm,Rf=Jh;class eA{constructor(a,l){this.map=a,this.valhalla=l,this.onDocumentClick=this.onDocumentClick.bind(this)}addTo(a){var l,x;this.map||console.error("map object is null"),this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.mainContainer=document.createElement("div"),this.mainContainer.classList.add("mapboxgl-valhalla-list"),this.mainButton=document.createElement("button"),this.mainButton.classList.add("mapboxgl-ctrl-icon"),this.mainButton.classList.add("mapboxgl-valhalla-time-isochrone-control"),this.mainButton.addEventListener("click",()=>{this.mainButton.style.display="none",this.mainContainer.style.display="block",this.toggleCrosshair(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.mainButton),this.controlContainer.appendChild(this.mainContainer);const T=document.createElement("TABLE");T.className="valhalla-table",this.mainContainer.appendChild(T);const P=Rf.createSelection(My.Costing,"Means of transport","costing",My.Costing.Walking,(V,G)=>V[G]);T.appendChild(P);const f=(l=this.map)===null||l===void 0?void 0:l.getCenter();if(f){const V=Rf.createTextbox("Longitude","lon-time",f.lng,!0);T.appendChild(V);const G=Rf.createTextbox("Latitude","lat-time",f.lat,!0);T.appendChild(G)}const d=this.valhalla.getContoursOption();for(let V=0;V<d.length;V+=1){const G=d[V],X=Rf.createTextbox(`Contour ${V+1} (min)`,`contour-time-${V}`,G.time,!1,"number");T.appendChild(X)}const R=document.createElement("button");R.textContent="Clear",R.classList.add("mapbox-valhalla-control-button"),R.addEventListener("click",()=>{this.valhalla.clearFeatures()}),this.mainContainer.appendChild(R);const q=document.createElement("button");return q.textContent="Calculate",q.classList.add("mapbox-valhalla-control-button"),q.addEventListener("click",()=>{const V=document.getElementById("mapbox-gl-valhalla-lon-time"),G=document.getElementById("mapbox-gl-valhalla-lat-time"),X=document.getElementById("mapbox-gl-valhalla-costing"),Me=this.valhalla.getContoursOption();for(let ke=0;ke<Me.length;ke+=1){const qe=Me[ke],We=document.getElementById(`mapbox-gl-valhalla-contour-time-${ke}`);qe.time=Number(We.value)}this.valhalla.getIsochrone(Number(V.value),Number(G.value),My.ContourType.Time,X.value,Me)}),this.mainContainer.appendChild(q),(x=this.map)===null||x===void 0||x.on("moveend",()=>{var V;const G=(V=this.map)===null||V===void 0?void 0:V.getCenter(),X=document.getElementById("mapbox-gl-valhalla-lon-time"),Me=document.getElementById("mapbox-gl-valhalla-lat-time");G||(X.setAttribute("value",""),Me.setAttribute("value",""));const ke=G,qe=ke!=null&&ke.lng?ke.lng.toString():"";X.setAttribute("value",qe);const We=ke!=null&&ke.lat?ke.lat.toString():"";Me.setAttribute("value",We)}),a.appendChild(this.controlContainer),a}onDocumentClick(a){this.controlContainer&&!this.controlContainer.contains(a.target)&&this.hide()}hide(){this.mainContainer&&this.mainButton&&(this.mainContainer.style.display="none",this.mainButton.style.display="block",this.toggleCrosshair(!1))}destroy(){!this.mainContainer||!this.mainContainer.parentNode||!this.map||!this.mainButton||(this.mainButton.removeEventListener("click",this.onDocumentClick),this.mainContainer.parentNode.removeChild(this.mainContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.map=void 0)}toggleCrosshair(a){a===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new QT.default(this.map),this.crosshair.create())}}Sg.default=eA;var Mg={};Object.defineProperty(Mg,"__esModule",{value:!0});const Q_=dm,tA=gm,Ly=Jh;class iA{constructor(a,l){this.map=a,this.valhalla=l,this.onDocumentClick=this.onDocumentClick.bind(this)}addTo(a){var l,x;this.map||console.error("map object is null"),this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.mainContainer=document.createElement("div"),this.mainContainer.classList.add("mapboxgl-valhalla-list"),this.mainButton=document.createElement("button"),this.mainButton.classList.add("mapboxgl-ctrl-icon"),this.mainButton.classList.add("mapboxgl-valhalla-distance-isochrone-control"),this.mainButton.addEventListener("click",()=>{this.mainButton.style.display="none",this.mainContainer.style.display="block",this.toggleCrosshair(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.mainButton),this.controlContainer.appendChild(this.mainContainer);const T=document.createElement("TABLE");T.className="valhalla-table",this.mainContainer.appendChild(T);const P=(l=this.map)===null||l===void 0?void 0:l.getCenter();if(P){const q=Ly.createTextbox("Longitude","lon-distance",P.lng,!0);T.appendChild(q);const V=Ly.createTextbox("Latitude","lat-distance",P.lat,!0);T.appendChild(V)}const f=this.valhalla.getContoursOption();for(let q=0;q<f.length;q+=1){const V=f[q],G=Ly.createTextbox(`Contour ${q+1} (km)`,`contour-distance-${q}`,V.distance,!1,"number");T.appendChild(G)}const d=document.createElement("button");d.textContent="Clear",d.classList.add("mapbox-valhalla-control-button"),d.addEventListener("click",()=>{this.valhalla.clearFeatures()}),this.mainContainer.appendChild(d);const R=document.createElement("button");return R.textContent="Calculate",R.classList.add("mapbox-valhalla-control-button"),R.addEventListener("click",()=>{const q=document.getElementById("mapbox-gl-valhalla-lon-distance"),V=document.getElementById("mapbox-gl-valhalla-lat-distance"),G=this.valhalla.getContoursOption();for(let X=0;X<G.length;X+=1){const Me=G[X],ke=document.getElementById(`mapbox-gl-valhalla-contour-distance-${X}`);Me.distance=Number(ke.value)}this.valhalla.getIsochrone(Number(q.value),Number(V.value),Q_.ContourType.Distance,Q_.Costing.Walking,G)}),this.mainContainer.appendChild(R),(x=this.map)===null||x===void 0||x.on("moveend",()=>{var q;const V=(q=this.map)===null||q===void 0?void 0:q.getCenter(),G=document.getElementById("mapbox-gl-valhalla-lon-distance"),X=document.getElementById("mapbox-gl-valhalla-lat-distance");V||(G.setAttribute("value",""),X.setAttribute("value",""));const Me=V,ke=Me!=null&&Me.lng?Me.lng.toString():"";G.setAttribute("value",ke);const qe=Me!=null&&Me.lat?Me.lat.toString():"";X.setAttribute("value",qe)}),a.appendChild(this.controlContainer),a}onDocumentClick(a){this.controlContainer&&!this.controlContainer.contains(a.target)&&this.hide()}hide(){this.mainContainer&&this.mainButton&&(this.mainContainer.style.display="none",this.mainButton.style.display="block",this.toggleCrosshair(!1))}destroy(){!this.mainContainer||!this.mainContainer.parentNode||!this.map||!this.mainButton||(this.mainButton.removeEventListener("click",this.onDocumentClick),this.mainContainer.parentNode.removeChild(this.mainContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.map=void 0)}toggleCrosshair(a){a===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new tA.default(this.map),this.crosshair.create())}}Mg.default=iA;Object.defineProperty(Ig,"__esModule",{value:!0});const rA=Sg,nA=Mg,oA=dm;class aA{constructor(a,l){this.options={Contours:[{time:5,distance:1,color:"ff0000"},{time:10,distance:3,color:"ffff00"},{time:15,distance:5,color:"0000ff"}]},this.url=a,l&&(this.options=Object.assign(this.options,l)),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}onAdd(a){return this.map=a,this.map&&(this.valhalla=new oA.default(this.map,this.url,this.options.Contours)),this.controlContainer=document.createElement("div"),this.timeIsochroneControl=new rA.default(this.map,this.valhalla),this.controlContainer=this.timeIsochroneControl.addTo(this.controlContainer),this.distanceIsochroneControl=new nA.default(this.map,this.valhalla),this.controlContainer=this.distanceIsochroneControl.addTo(this.controlContainer),document.addEventListener("click",this.onDocumentClick),this.controlContainer}onDocumentClick(a){this.controlContainer&&!this.controlContainer.contains(a.target)&&this.timeIsochroneControl&&this.distanceIsochroneControl&&(this.timeIsochroneControl.hide(),this.distanceIsochroneControl.hide())}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.timeIsochroneControl||!this.distanceIsochroneControl||(this.timeIsochroneControl.destroy(),this.distanceIsochroneControl.destroy(),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.map=void 0)}}Ig.default=aA;(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.MapboxValhallaControl=void 0;var a=Ig;Object.defineProperty(c,"MapboxValhallaControl",{enumerable:!0,get:function(){return a.default}})})(w0);function sA(c){let a,l;return{c(){a=Tr("div"),l=Tr("div"),this.h()},l(x){a=Ar(x,"DIV",{class:!0});var T=Zr(a);l=Ar(T,"DIV",{class:!0,id:!0}),Zr(l).forEach(Zt),T.forEach(Zt),this.h()},h(){Ur(l,"class","map svelte-1ljuzl6"),Ur(l,"id","map"),Ur(a,"class","map-wrap svelte-1ljuzl6")},m(x,T){Fi(x,a,T),wa(a,l),c[1](l)},p:cl,i:cl,o:cl,d(x){x&&Zt(a),c[1](null)}}}function lA(c,a,l){let x;yh(async()=>{const d=new Wh.exports.Map({container:x,style:dn.styles[0].uri,center:dn.center,zoom:dn.zoom,hash:!0,attributionControl:!1});if(d.addControl(new Wh.exports.NavigationControl({}),"top-right"),d.addControl(new Wh.exports.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"top-right"),d.addControl(new Wh.exports.ScaleControl({maxWidth:80,unit:"metric"}),"bottom-left"),d.addControl(new Wh.exports.AttributionControl({compact:!0}),"bottom-right"),d.addControl(new b0(dn.styles),"top-right"),d.addControl(new _S(dn.areaSwitcher.areas),"top-right"),dn.elevation){const qe=await(await py(()=>import("./index-4d94b6ba.js").then(function(We){return We.i}),[])).default;d.addControl(new qe(dn.elevation.url,dn.elevation.options),"top-right")}const{MaplibreExportControl:R,Size:q,PageOrientation:V,Format:G,DPI:X}=await py(()=>import("./index-4a7e4ae9.js").then(function(qe){return qe.i}),[]);if(d.addControl(new R({PageSize:q.A4,PageOrientation:V.Landscape,Format:G.PNG,DPI:X[96],Crosshair:!0,PrintableArea:!0}),"top-right"),dn.valhalla&&d.addControl(new w0.MapboxValhallaControl(dn.valhalla.url,dn.valhalla.options),"top-right"),dn.legend){const{MaplibreLegendControl:qe}=await py(()=>import("./index-c50e7a50.js").then(function(We){return We.i}),[]);d.addControl(new qe(dn.legend.targets,dn.legend.options),"bottom-left")}if(dn.popup&&d.addControl(new wS(dn.popup.target)),!dn.search)return;const Me=await fetch(dn.search.url).then(qe=>qe.json());function ke(qe){for(var We=[],ft=0;ft<Me.features.length;ft++){var Ge=Me.features[ft];dn.search.target.forEach(Ze=>{var gt=Ge.properties[Ze];!gt||gt.toString().toLowerCase().search(qe.toString().toLowerCase())!==-1&&(Ge.place_name=dn.search.format(Ge.properties),Ge.center=Ge.geometry.coordinates,Ge.place_type=dn.search.place_type,We.push(Ge))})}return We}d.addControl(new gS({localGeocoder:ke,localGeocoderOnly:!0,zoom:dn.search.zoom,placeholder:dn.search.placeholder,mapboxgl:sE}),"top-left"),d.on("load",()=>{const qe=d.getStyle().sprite;Promise.all([T(`${qe}@2x.png`),P(`${qe}@2x.json`)]).then(([ft,Ge])=>({image:ft,json:Ge})).then(ft=>{pv.update(()=>ft)})}),Yf.update(()=>d)});const T=d=>{let R=!1;const q=new Promise((V,G)=>{const X=new Image;X.crossOrigin="Anonymous",X.onload=()=>{R||V(X)},X.onerror=Me=>{R||G(Me)},X.src=d});return q.cancel=()=>{R=!0},q},P=async d=>(await fetch(d)).json();function f(d){_n[d?"unshift":"push"](()=>{x=d,l(0,x)})}return[x,f]}class uA extends Rn{constructor(a){super(),Bn(this,a,lA,sA,On,{})}}function cA(c){let a,l;return a=new uA({}),{c(){en(a.$$.fragment)},l(x){In(a.$$.fragment,x)},m(x,T){tn(a,x,T),l=!0},i(x){l||(Mi(a.$$.fragment,x),l=!0)},o(x){Ui(a.$$.fragment,x),l=!1},d(x){rn(a,x)}}}function hA(c){let a,l,x,T,P,f;function d(G){c[1](G)}let R={};c[0]!==void 0&&(R.drawerOpen=c[0]),a=new q1({props:R}),_n.push(()=>Md(a,"drawerOpen",d));function q(G){c[2](G)}let V={$$slots:{default:[cA]},$$scope:{ctx:c}};return c[0]!==void 0&&(V.open=c[0]),T=new oE({props:V}),_n.push(()=>Md(T,"open",q)),{c(){en(a.$$.fragment),x=pa(),en(T.$$.fragment)},l(G){In(a.$$.fragment,G),x=da(G),In(T.$$.fragment,G)},m(G,X){tn(a,G,X),Fi(G,x,X),tn(T,G,X),f=!0},p(G,[X]){const Me={};!l&&X&1&&(l=!0,Me.drawerOpen=G[0],Ld(()=>l=!1)),a.$set(Me);const ke={};X&8&&(ke.$$scope={dirty:X,ctx:G}),!P&&X&1&&(P=!0,ke.open=G[0],Ld(()=>P=!1)),T.$set(ke)},i(G){f||(Mi(a.$$.fragment,G),Mi(T.$$.fragment,G),f=!0)},o(G){Ui(a.$$.fragment,G),Ui(T.$$.fragment,G),f=!1},d(G){rn(a,G),G&&Zt(x),rn(T,G)}}}function pA(c,a,l){let x=!1;function T(f){x=f,l(0,x)}function P(f){x=f,l(0,x)}return[x,T,P]}class _A extends Rn{constructor(a){super(),Bn(this,a,pA,hA,On,{})}}export{_A as _,KT as a,gA as b,Ll as c,aE as g,yA as i,Wh as m};
