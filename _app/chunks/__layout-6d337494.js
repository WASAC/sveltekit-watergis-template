var rx=Object.defineProperty;var s_=Object.getOwnPropertySymbols;var nx=Object.prototype.hasOwnProperty,ox=Object.prototype.propertyIsEnumerable;var l_=(u,r,s)=>r in u?rx(u,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[r]=s,ll=(u,r)=>{for(var s in r||(r={}))nx.call(r,s)&&l_(u,s,r[s]);if(s_)for(var s of s_(r))ox.call(r,s)&&l_(u,s,r[s]);return u};import{F as ul,G as By,H as ax,I as sx,S as wn,i as En,s as gn,J as ao,C as wi,e as gr,c as _r,a as Dr,d as Mt,K as Wr,g as xi,L as Vr,M as so,N as lo,O as uo,z as Gn,P as Vo,q as ii,o as ui,Q as Sa,R as lr,T as xo,v as xh,U as bo,V as lx,W as an,w as pr,l as hn,x as Rr,y as dr,A as Ya,p as hl,B as fr,X as Qa,r as Ia,Y as Ud,n as pl,Z as Oy,_ as Fy,$ as u_,a0 as ux,E as vs,b as jr,k as qo,m as Go,a1 as cx,a2 as fa,a3 as hx,t as Lc,h as Dc,j as hv,a4 as jf,a5 as Up,f as c_,a6 as Np,a7 as px}from"./index-c300e5a7.js";import{r as dx,w as pv,_ as h_}from"./preload-helper-e505b05f.js";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Uy=function(u,r){return Uy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,g){s.__proto__=g}||function(s,g){for(var w in g)Object.prototype.hasOwnProperty.call(g,w)&&(s[w]=g[w])},Uy(u,r)};function bu(u,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");Uy(u,r);function s(){this.constructor=u}u.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}var Da=function(){return Da=Object.assign||function(r){for(var s,g=1,w=arguments.length;g<w;g++){s=arguments[g];for(var z in s)Object.prototype.hasOwnProperty.call(s,z)&&(r[z]=s[z])}return r},Da.apply(this,arguments)};function Tf(u){var r=typeof Symbol=="function"&&Symbol.iterator,s=r&&u[r],g=0;if(s)return s.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&g>=u.length&&(u=void 0),{value:u&&u[g++],done:!u}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var tp=function(){function u(r){r===void 0&&(r={}),this.adapter=r}return Object.defineProperty(u,"cssClasses",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(u,"strings",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(u,"numbers",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(u,"defaultAdapter",{get:function(){return{}},enumerable:!1,configurable:!0}),u.prototype.init=function(){},u.prototype.destroy=function(){},u}();/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function fx(u){return u===void 0&&(u=window),mx(u)?{passive:!0}:!1}function mx(u){u===void 0&&(u=window);var r=!1;try{var s={get passive(){return r=!0,!1}},g=function(){};u.document.addEventListener("test",g,s),u.document.removeEventListener("test",g,s)}catch{r=!1}return r}var yx=Object.freeze(Object.defineProperty({__proto__:null,applyPassive:fx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function gx(u,r){if(u.closest)return u.closest(r);for(var s=u;s;){if(dv(s,r))return s;s=s.parentElement}return null}function dv(u,r){var s=u.matches||u.webkitMatchesSelector||u.msMatchesSelector;return s.call(u,r)}function _x(u){var r=u;if(r.offsetParent!==null)return r.scrollWidth;var s=r.cloneNode(!0);s.style.setProperty("position","absolute"),s.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(s);var g=s.scrollWidth;return document.documentElement.removeChild(s),g}var fv=Object.freeze(Object.defineProperty({__proto__:null,closest:gx,matches:dv,estimateScrollWidth:_x},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var vx={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},xx={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},p_={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300},Af;function bx(u,r){r===void 0&&(r=!1);var s=u.CSS,g=Af;if(typeof Af=="boolean"&&!r)return Af;var w=s&&typeof s.supports=="function";if(!w)return!1;var z=s.supports("--css-vars","yes"),f=s.supports("(--css-vars: yes)")&&s.supports("color","#00000000");return g=z||f,r||(Af=g),g}function wx(u,r,s){if(!u)return{x:0,y:0};var g=r.x,w=r.y,z=g+s.left,f=w+s.top,h,D;if(u.type==="touchstart"){var N=u;h=N.changedTouches[0].pageX-z,D=N.changedTouches[0].pageY-f}else{var F=u;h=F.pageX-z,D=F.pageY-f}return{x:h,y:D}}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var d_=["touchstart","pointerdown","mousedown","keydown"],f_=["touchend","pointerup","mouseup","contextmenu"],Cf=[],Ex=function(u){bu(r,u);function r(s){var g=u.call(this,Da(Da({},r.defaultAdapter),s))||this;return g.activationAnimationHasEnded=!1,g.activationTimer=0,g.fgDeactivationRemovalTimer=0,g.fgScale="0",g.frame={width:0,height:0},g.initialSize=0,g.layoutFrame=0,g.maxRadius=0,g.unboundedCoords={left:0,top:0},g.activationState=g.defaultActivationState(),g.activationTimerCallback=function(){g.activationAnimationHasEnded=!0,g.runDeactivationUXLogicIfReady()},g.activateHandler=function(w){g.activateImpl(w)},g.deactivateHandler=function(){g.deactivateImpl()},g.focusHandler=function(){g.handleFocus()},g.blurHandler=function(){g.handleBlur()},g.resizeHandler=function(){g.layout()},g}return Object.defineProperty(r,"cssClasses",{get:function(){return vx},enumerable:!1,configurable:!0}),Object.defineProperty(r,"strings",{get:function(){return xx},enumerable:!1,configurable:!0}),Object.defineProperty(r,"numbers",{get:function(){return p_},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!1,configurable:!0}),r.prototype.init=function(){var s=this,g=this.supportsPressRipple();if(this.registerRootHandlers(g),g){var w=r.cssClasses,z=w.ROOT,f=w.UNBOUNDED;requestAnimationFrame(function(){s.adapter.addClass(z),s.adapter.isUnbounded()&&(s.adapter.addClass(f),s.layoutInternal())})}},r.prototype.destroy=function(){var s=this;if(this.supportsPressRipple()){this.activationTimer&&(clearTimeout(this.activationTimer),this.activationTimer=0,this.adapter.removeClass(r.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer&&(clearTimeout(this.fgDeactivationRemovalTimer),this.fgDeactivationRemovalTimer=0,this.adapter.removeClass(r.cssClasses.FG_DEACTIVATION));var g=r.cssClasses,w=g.ROOT,z=g.UNBOUNDED;requestAnimationFrame(function(){s.adapter.removeClass(w),s.adapter.removeClass(z),s.removeCssVars()})}this.deregisterRootHandlers(),this.deregisterDeactivationHandlers()},r.prototype.activate=function(s){this.activateImpl(s)},r.prototype.deactivate=function(){this.deactivateImpl()},r.prototype.layout=function(){var s=this;this.layoutFrame&&cancelAnimationFrame(this.layoutFrame),this.layoutFrame=requestAnimationFrame(function(){s.layoutInternal(),s.layoutFrame=0})},r.prototype.setUnbounded=function(s){var g=r.cssClasses.UNBOUNDED;s?this.adapter.addClass(g):this.adapter.removeClass(g)},r.prototype.handleFocus=function(){var s=this;requestAnimationFrame(function(){return s.adapter.addClass(r.cssClasses.BG_FOCUSED)})},r.prototype.handleBlur=function(){var s=this;requestAnimationFrame(function(){return s.adapter.removeClass(r.cssClasses.BG_FOCUSED)})},r.prototype.supportsPressRipple=function(){return this.adapter.browserSupportsCssVars()},r.prototype.defaultActivationState=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},r.prototype.registerRootHandlers=function(s){var g,w;if(s){try{for(var z=Tf(d_),f=z.next();!f.done;f=z.next()){var h=f.value;this.adapter.registerInteractionHandler(h,this.activateHandler)}}catch(D){g={error:D}}finally{try{f&&!f.done&&(w=z.return)&&w.call(z)}finally{if(g)throw g.error}}this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler)}this.adapter.registerInteractionHandler("focus",this.focusHandler),this.adapter.registerInteractionHandler("blur",this.blurHandler)},r.prototype.registerDeactivationHandlers=function(s){var g,w;if(s.type==="keydown")this.adapter.registerInteractionHandler("keyup",this.deactivateHandler);else try{for(var z=Tf(f_),f=z.next();!f.done;f=z.next()){var h=f.value;this.adapter.registerDocumentInteractionHandler(h,this.deactivateHandler)}}catch(D){g={error:D}}finally{try{f&&!f.done&&(w=z.return)&&w.call(z)}finally{if(g)throw g.error}}},r.prototype.deregisterRootHandlers=function(){var s,g;try{for(var w=Tf(d_),z=w.next();!z.done;z=w.next()){var f=z.value;this.adapter.deregisterInteractionHandler(f,this.activateHandler)}}catch(h){s={error:h}}finally{try{z&&!z.done&&(g=w.return)&&g.call(w)}finally{if(s)throw s.error}}this.adapter.deregisterInteractionHandler("focus",this.focusHandler),this.adapter.deregisterInteractionHandler("blur",this.blurHandler),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler)},r.prototype.deregisterDeactivationHandlers=function(){var s,g;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler);try{for(var w=Tf(f_),z=w.next();!z.done;z=w.next()){var f=z.value;this.adapter.deregisterDocumentInteractionHandler(f,this.deactivateHandler)}}catch(h){s={error:h}}finally{try{z&&!z.done&&(g=w.return)&&g.call(w)}finally{if(s)throw s.error}}},r.prototype.removeCssVars=function(){var s=this,g=r.strings,w=Object.keys(g);w.forEach(function(z){z.indexOf("VAR_")===0&&s.adapter.updateCssVariable(g[z],null)})},r.prototype.activateImpl=function(s){var g=this;if(!this.adapter.isSurfaceDisabled()){var w=this.activationState;if(!w.isActivated){var z=this.previousActivationEvent,f=z&&s!==void 0&&z.type!==s.type;if(!f){w.isActivated=!0,w.isProgrammatic=s===void 0,w.activationEvent=s,w.wasActivatedByPointer=w.isProgrammatic?!1:s!==void 0&&(s.type==="mousedown"||s.type==="touchstart"||s.type==="pointerdown");var h=s!==void 0&&Cf.length>0&&Cf.some(function(D){return g.adapter.containsEventTarget(D)});if(h){this.resetActivationState();return}s!==void 0&&(Cf.push(s.target),this.registerDeactivationHandlers(s)),w.wasElementMadeActive=this.checkElementMadeActive(s),w.wasElementMadeActive&&this.animateActivation(),requestAnimationFrame(function(){Cf=[],!w.wasElementMadeActive&&s!==void 0&&(s.key===" "||s.keyCode===32)&&(w.wasElementMadeActive=g.checkElementMadeActive(s),w.wasElementMadeActive&&g.animateActivation()),w.wasElementMadeActive||(g.activationState=g.defaultActivationState())})}}}},r.prototype.checkElementMadeActive=function(s){return s!==void 0&&s.type==="keydown"?this.adapter.isSurfaceActive():!0},r.prototype.animateActivation=function(){var s=this,g=r.strings,w=g.VAR_FG_TRANSLATE_START,z=g.VAR_FG_TRANSLATE_END,f=r.cssClasses,h=f.FG_DEACTIVATION,D=f.FG_ACTIVATION,N=r.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal();var F="",G="";if(!this.adapter.isUnbounded()){var H=this.getFgTranslationCoordinates(),Pe=H.startPoint,ke=H.endPoint;F=Pe.x+"px, "+Pe.y+"px",G=ke.x+"px, "+ke.y+"px"}this.adapter.updateCssVariable(w,F),this.adapter.updateCssVariable(z,G),clearTimeout(this.activationTimer),clearTimeout(this.fgDeactivationRemovalTimer),this.rmBoundedActivationClasses(),this.adapter.removeClass(h),this.adapter.computeBoundingRect(),this.adapter.addClass(D),this.activationTimer=setTimeout(function(){s.activationTimerCallback()},N)},r.prototype.getFgTranslationCoordinates=function(){var s=this.activationState,g=s.activationEvent,w=s.wasActivatedByPointer,z;w?z=wx(g,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):z={x:this.frame.width/2,y:this.frame.height/2},z={x:z.x-this.initialSize/2,y:z.y-this.initialSize/2};var f={x:this.frame.width/2-this.initialSize/2,y:this.frame.height/2-this.initialSize/2};return{startPoint:z,endPoint:f}},r.prototype.runDeactivationUXLogicIfReady=function(){var s=this,g=r.cssClasses.FG_DEACTIVATION,w=this.activationState,z=w.hasDeactivationUXRun,f=w.isActivated,h=z||!f;h&&this.activationAnimationHasEnded&&(this.rmBoundedActivationClasses(),this.adapter.addClass(g),this.fgDeactivationRemovalTimer=setTimeout(function(){s.adapter.removeClass(g)},p_.FG_DEACTIVATION_MS))},r.prototype.rmBoundedActivationClasses=function(){var s=r.cssClasses.FG_ACTIVATION;this.adapter.removeClass(s),this.activationAnimationHasEnded=!1,this.adapter.computeBoundingRect()},r.prototype.resetActivationState=function(){var s=this;this.previousActivationEvent=this.activationState.activationEvent,this.activationState=this.defaultActivationState(),setTimeout(function(){return s.previousActivationEvent=void 0},r.numbers.TAP_DELAY_MS)},r.prototype.deactivateImpl=function(){var s=this,g=this.activationState;if(!!g.isActivated){var w=Da({},g);g.isProgrammatic?(requestAnimationFrame(function(){s.animateDeactivation(w)}),this.resetActivationState()):(this.deregisterDeactivationHandlers(),requestAnimationFrame(function(){s.activationState.hasDeactivationUXRun=!0,s.animateDeactivation(w),s.resetActivationState()}))}},r.prototype.animateDeactivation=function(s){var g=s.wasActivatedByPointer,w=s.wasElementMadeActive;(g||w)&&this.runDeactivationUXLogicIfReady()},r.prototype.layoutInternal=function(){var s=this;this.frame=this.adapter.computeBoundingRect();var g=Math.max(this.frame.height,this.frame.width),w=function(){var f=Math.sqrt(Math.pow(s.frame.width,2)+Math.pow(s.frame.height,2));return f+r.numbers.PADDING};this.maxRadius=this.adapter.isUnbounded()?g:w();var z=Math.floor(g*r.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&z%2!==0?this.initialSize=z-1:this.initialSize=z,this.fgScale=""+this.maxRadius/this.initialSize,this.updateLayoutCssVars()},r.prototype.updateLayoutCssVars=function(){var s=r.strings,g=s.VAR_FG_SIZE,w=s.VAR_LEFT,z=s.VAR_TOP,f=s.VAR_FG_SCALE;this.adapter.updateCssVariable(g,this.initialSize+"px"),this.adapter.updateCssVariable(f,this.fgScale),this.adapter.isUnbounded()&&(this.unboundedCoords={left:Math.round(this.frame.width/2-this.initialSize/2),top:Math.round(this.frame.height/2-this.initialSize/2)},this.adapter.updateCssVariable(w,this.unboundedCoords.left+"px"),this.adapter.updateCssVariable(z,this.unboundedCoords.top+"px"))},r}(tp);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Yh={FIXED_CLASS:"mdc-top-app-bar--fixed",FIXED_SCROLLED_CLASS:"mdc-top-app-bar--fixed-scrolled",SHORT_CLASS:"mdc-top-app-bar--short",SHORT_COLLAPSED_CLASS:"mdc-top-app-bar--short-collapsed",SHORT_HAS_ACTION_ITEM_CLASS:"mdc-top-app-bar--short-has-action-item"},Bf={DEBOUNCE_THROTTLE_RESIZE_TIME_MS:100,MAX_TOP_APP_BAR_HEIGHT:128},Ix={ACTION_ITEM_SELECTOR:".mdc-top-app-bar__action-item",NAVIGATION_EVENT:"MDCTopAppBar:nav",NAVIGATION_ICON_SELECTOR:".mdc-top-app-bar__navigation-icon",ROOT_SELECTOR:".mdc-top-app-bar",TITLE_SELECTOR:".mdc-top-app-bar__title"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Yy=function(u){bu(r,u);function r(s){return u.call(this,Da(Da({},r.defaultAdapter),s))||this}return Object.defineProperty(r,"strings",{get:function(){return Ix},enumerable:!1,configurable:!0}),Object.defineProperty(r,"cssClasses",{get:function(){return Yh},enumerable:!1,configurable:!0}),Object.defineProperty(r,"numbers",{get:function(){return Bf},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},getTopAppBarHeight:function(){return 0},notifyNavigationIconClicked:function(){},getViewportScrollY:function(){return 0},getTotalActionItems:function(){return 0}}},enumerable:!1,configurable:!0}),r.prototype.handleTargetScroll=function(){},r.prototype.handleWindowResize=function(){},r.prototype.handleNavigationClick=function(){this.adapter.notifyNavigationIconClicked()},r}(tp);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var kf=0,mv=function(u){bu(r,u);function r(s){var g=u.call(this,s)||this;return g.wasDocked=!0,g.isDockedShowing=!0,g.currentAppBarOffsetTop=0,g.isCurrentlyBeingResized=!1,g.resizeThrottleId=kf,g.resizeDebounceId=kf,g.lastScrollPosition=g.adapter.getViewportScrollY(),g.topAppBarHeight=g.adapter.getTopAppBarHeight(),g}return r.prototype.destroy=function(){u.prototype.destroy.call(this),this.adapter.setStyle("top","")},r.prototype.handleTargetScroll=function(){var s=Math.max(this.adapter.getViewportScrollY(),0),g=s-this.lastScrollPosition;this.lastScrollPosition=s,this.isCurrentlyBeingResized||(this.currentAppBarOffsetTop-=g,this.currentAppBarOffsetTop>0?this.currentAppBarOffsetTop=0:Math.abs(this.currentAppBarOffsetTop)>this.topAppBarHeight&&(this.currentAppBarOffsetTop=-this.topAppBarHeight),this.moveTopAppBar())},r.prototype.handleWindowResize=function(){var s=this;this.resizeThrottleId||(this.resizeThrottleId=setTimeout(function(){s.resizeThrottleId=kf,s.throttledResizeHandler()},Bf.DEBOUNCE_THROTTLE_RESIZE_TIME_MS)),this.isCurrentlyBeingResized=!0,this.resizeDebounceId&&clearTimeout(this.resizeDebounceId),this.resizeDebounceId=setTimeout(function(){s.handleTargetScroll(),s.isCurrentlyBeingResized=!1,s.resizeDebounceId=kf},Bf.DEBOUNCE_THROTTLE_RESIZE_TIME_MS)},r.prototype.checkForUpdate=function(){var s=-this.topAppBarHeight,g=this.currentAppBarOffsetTop<0,w=this.currentAppBarOffsetTop>s,z=g&&w;if(z)this.wasDocked=!1;else if(this.wasDocked){if(this.isDockedShowing!==w)return this.isDockedShowing=w,!0}else return this.wasDocked=!0,!0;return z},r.prototype.moveTopAppBar=function(){if(this.checkForUpdate()){var s=this.currentAppBarOffsetTop;Math.abs(s)>=this.topAppBarHeight&&(s=-Bf.MAX_TOP_APP_BAR_HEIGHT),this.adapter.setStyle("top",s+"px")}},r.prototype.throttledResizeHandler=function(){var s=this.adapter.getTopAppBarHeight();this.topAppBarHeight!==s&&(this.wasDocked=!1,this.currentAppBarOffsetTop-=this.topAppBarHeight-s,this.topAppBarHeight=s),this.handleTargetScroll()},r}(Yy);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Sx=function(u){bu(r,u);function r(){var s=u!==null&&u.apply(this,arguments)||this;return s.wasScrolled=!1,s}return r.prototype.handleTargetScroll=function(){var s=this.adapter.getViewportScrollY();s<=0?this.wasScrolled&&(this.adapter.removeClass(Yh.FIXED_SCROLLED_CLASS),this.wasScrolled=!1):this.wasScrolled||(this.adapter.addClass(Yh.FIXED_SCROLLED_CLASS),this.wasScrolled=!0)},r}(mv);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Tx=function(u){bu(r,u);function r(s){var g=u.call(this,s)||this;return g.collapsed=!1,g.isAlwaysCollapsed=!1,g}return Object.defineProperty(r.prototype,"isCollapsed",{get:function(){return this.collapsed},enumerable:!1,configurable:!0}),r.prototype.init=function(){u.prototype.init.call(this),this.adapter.getTotalActionItems()>0&&this.adapter.addClass(Yh.SHORT_HAS_ACTION_ITEM_CLASS),this.setAlwaysCollapsed(this.adapter.hasClass(Yh.SHORT_COLLAPSED_CLASS))},r.prototype.setAlwaysCollapsed=function(s){this.isAlwaysCollapsed=!!s,this.isAlwaysCollapsed?this.collapse():this.maybeCollapseBar()},r.prototype.getAlwaysCollapsed=function(){return this.isAlwaysCollapsed},r.prototype.handleTargetScroll=function(){this.maybeCollapseBar()},r.prototype.maybeCollapseBar=function(){if(!this.isAlwaysCollapsed){var s=this.adapter.getViewportScrollY();s<=0?this.collapsed&&this.uncollapse():this.collapsed||this.collapse()}},r.prototype.uncollapse=function(){this.adapter.removeClass(Yh.SHORT_COLLAPSED_CLASS),this.collapsed=!1},r.prototype.collapse=function(){this.adapter.addClass(Yh.SHORT_COLLAPSED_CLASS),this.collapsed=!0},r}(Yy);function _o(u){return Object.entries(u).filter(([r,s])=>r!==""&&s).map(([r])=>r).join(" ")}function Ns(u,r,s,g={bubbles:!0},w=!1){if(typeof Event!="undefined"&&u){const z=new CustomEvent(r,Object.assign(Object.assign({},g),{detail:s}));if(u==null||u.dispatchEvent(z),w&&r.startsWith("SMUI")){const f=new CustomEvent(r.replace(/^SMUI/g,()=>"MDC"),Object.assign(Object.assign({},g),{detail:s}));u==null||u.dispatchEvent(f),f.defaultPrevented&&z.preventDefault()}return z}}function Vf(u,r){let s=Object.getOwnPropertyNames(u);const g={};for(let w=0;w<s.length;w++){const z=s[w],f=z.indexOf("$");f!==-1&&r.indexOf(z.substring(0,f+1))!==-1||r.indexOf(z)===-1&&(g[z]=u[z])}return g}const m_=/^[a-z]+(?::(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/,Ax=/^[^$]+(?:\$(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/;function wo(u){let r,s=[];u.$on=(w,z)=>{let f=w,h=()=>{};return r?h=r(f,z):s.push([f,z]),f.match(m_)&&console&&console.warn('Event modifiers in SMUI now use "$" instead of ":", so that all events can be bound with modifiers. Please update your event binding: ',f),()=>{h()}};function g(w){By(u,w)}return w=>{const z=[],f={};r=(h,D)=>{let N=h,F=D,G=!1;const H=N.match(m_),Pe=N.match(Ax),ke=H||Pe;if(N.match(/^SMUI:\w+:/)){const yt=N.split(":");let Ne="";for(let Ze=0;Ze<yt.length;Ze++)Ne+=Ze===yt.length-1?":"+yt[Ze]:yt[Ze].split("-").map(vt=>vt.slice(0,1).toUpperCase()+vt.slice(1)).join("");console.warn(`The event ${N.split("$")[0]} has been renamed to ${Ne.split("$")[0]}.`),N=Ne}if(ke){const yt=N.split(H?":":"$");N=yt[0];const Ne=Object.fromEntries(yt.slice(1).map(Ze=>[Ze,!0]));Ne.passive&&(G=G||{},G.passive=!0),Ne.nonpassive&&(G=G||{},G.passive=!1),Ne.capture&&(G=G||{},G.capture=!0),Ne.once&&(G=G||{},G.once=!0),Ne.preventDefault&&(F=ax(F)),Ne.stopPropagation&&(F=sx(F))}const We=ul(w,N,F,G),je=()=>{We();const yt=z.indexOf(je);yt>-1&&z.splice(yt,1)};return z.push(je),N in f||(f[N]=ul(w,N,g)),je};for(let h=0;h<s.length;h++)r(s[h][0],s[h][1]);return{destroy:()=>{for(let h=0;h<z.length;h++)z[h]();for(let h of Object.entries(f))h[1]()}}}}function qf(u,r){let s=Object.getOwnPropertyNames(u);const g={};for(let w=0;w<s.length;w++){const z=s[w];z.substring(0,r.length)===r&&(g[z.substring(r.length)]=u[z])}return g}function ra(u,r){let s=[];if(r)for(let g=0;g<r.length;g++){const w=r[g],z=Array.isArray(w)?w[0]:w;Array.isArray(w)&&w.length>1?s.push(z(u,w[1])):s.push(z(u))}return{update(g){if((g&&g.length||0)!=s.length)throw new Error("You must not change the length of an actions array.");if(g)for(let w=0;w<g.length;w++){const z=s[w];if(z&&z.update){const f=g[w];Array.isArray(f)&&f.length>1?z.update(f[1]):z.update()}}},destroy(){for(let g=0;g<s.length;g++){const w=s[g];w&&w.destroy&&w.destroy()}}}}const{window:y_}=lx;function Cx(u){let r,s,g,w,z,f,h;const D=u[22].default,N=ao(D,u,u[21],null);let F=[{class:s=_o(ll({[u[2]]:!0,"mdc-top-app-bar":!0,"mdc-top-app-bar--short":u[4]==="short","mdc-top-app-bar--short-collapsed":u[0],"mdc-top-app-bar--fixed":u[4]==="fixed","smui-top-app-bar--static":u[4]==="static","smui-top-app-bar--color-secondary":u[5]==="secondary","mdc-top-app-bar--prominent":u[6],"mdc-top-app-bar--dense":u[7]},u[11]))},{style:g=Object.entries(u[12]).map(g_).concat([u[3]]).join(" ")},u[15]],G={};for(let H=0;H<F.length;H+=1)G=wi(G,F[H]);return{c(){r=gr("header"),N&&N.c(),this.h()},l(H){r=_r(H,"HEADER",{class:!0,style:!0});var Pe=Dr(r);N&&N.l(Pe),Pe.forEach(Mt),this.h()},h(){Wr(r,G)},m(H,Pe){xi(H,r,Pe),N&&N.m(r,null),u[25](r),z=!0,f||(h=[ul(y_,"resize",u[23]),ul(y_,"scroll",u[24]),Vr(w=ra.call(null,r,u[1])),Vr(u[13].call(null,r)),ul(r,"SMUITopAppBarIconButton:nav",u[26])],f=!0)},p(H,Pe){N&&N.p&&(!z||Pe[0]&2097152)&&so(N,D,H,H[21],z?uo(D,H[21],Pe,null):lo(H[21]),null),Wr(r,G=Gn(F,[(!z||Pe[0]&2293&&s!==(s=_o(ll({[H[2]]:!0,"mdc-top-app-bar":!0,"mdc-top-app-bar--short":H[4]==="short","mdc-top-app-bar--short-collapsed":H[0],"mdc-top-app-bar--fixed":H[4]==="fixed","smui-top-app-bar--static":H[4]==="static","smui-top-app-bar--color-secondary":H[5]==="secondary","mdc-top-app-bar--prominent":H[6],"mdc-top-app-bar--dense":H[7]},H[11]))))&&{class:s},(!z||Pe[0]&4104&&g!==(g=Object.entries(H[12]).map(g_).concat([H[3]]).join(" ")))&&{style:g},Pe[0]&32768&&H[15]])),w&&Vo(w.update)&&Pe[0]&2&&w.update.call(null,H[1])},i(H){z||(ii(N,H),z=!0)},o(H){ui(N,H),z=!1},d(H){H&&Mt(r),N&&N.d(H),u[25](null),f=!1,Sa(h)}}}const g_=([u,r])=>`${u}: ${r};`;function kx(u,r,s){const g=["use","class","style","variant","color","collapsed","prominent","dense","scrollTarget","getPropStore","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r;const h=wo(xo());let D=()=>{};function N(jt){return jt===D}let{use:F=[]}=r,{class:G=""}=r,{style:H=""}=r,{variant:Pe="standard"}=r,{color:ke="primary"}=r,{collapsed:We=D}=r;const je=!N(We)&&!!We;N(We)&&(We=!1);let{prominent:yt=!1}=r,{dense:Ne=!1}=r,{scrollTarget:Ze=void 0}=r,vt,ct,pt={},lt={},fi,Et=dx({variant:Pe,prominent:yt,dense:Ne},jt=>{s(18,fi=jt)}),Wt,Ei=Pe;xh(()=>(s(9,ct=qi()),ct.init(),()=>{ct.destroy()}));function qi(){const jt={static:Yy,short:Tx,fixed:Sx}[Pe]||mv;return new jt({hasClass:Xt,addClass:Qt,removeClass:Ai,setStyle:bt,getTopAppBarHeight:()=>vt.clientHeight,notifyNavigationIconClicked:()=>Ns(vt,"SMUITopAppBar:nav",void 0,void 0,!0),getViewportScrollY:()=>Ze==null?window.pageYOffset:Ze.scrollTop,getTotalActionItems:()=>vt.querySelectorAll(".mdc-top-app-bar__action-item").length})}function Xt(jt){return jt in pt?pt[jt]:Ar().classList.contains(jt)}function Qt(jt){pt[jt]||s(11,pt[jt]=!0,pt)}function Ai(jt){(!(jt in pt)||pt[jt])&&s(11,pt[jt]=!1,pt)}function bt(jt,Xi){lt[jt]!=Xi&&(Xi===""||Xi==null?(delete lt[jt],s(12,lt),s(20,Ei),s(4,Pe),s(9,ct)):s(12,lt[jt]=Xi,lt))}function Gi(){ct&&(ct.handleTargetScroll(),Pe==="short"&&s(0,We="isCollapsed"in ct&&ct.isCollapsed))}function mr(){return Et}function Ar(){return vt}const Rt=()=>Pe!=="short"&&Pe!=="fixed"&&ct&&ct.handleWindowResize(),ai=()=>Ze==null&&Gi();function yi(jt){an[jt?"unshift":"push"](()=>{vt=jt,s(10,vt)})}const Fi=()=>ct&&ct.handleNavigationClick();return u.$$set=jt=>{r=wi(wi({},r),bo(jt)),s(15,w=lr(r,g)),"use"in jt&&s(1,F=jt.use),"class"in jt&&s(2,G=jt.class),"style"in jt&&s(3,H=jt.style),"variant"in jt&&s(4,Pe=jt.variant),"color"in jt&&s(5,ke=jt.color),"collapsed"in jt&&s(0,We=jt.collapsed),"prominent"in jt&&s(6,yt=jt.prominent),"dense"in jt&&s(7,Ne=jt.dense),"scrollTarget"in jt&&s(8,Ze=jt.scrollTarget),"$$scope"in jt&&s(21,f=jt.$$scope)},u.$$.update=()=>{u.$$.dirty[0]&262352&&fi&&fi({variant:Pe,prominent:yt,dense:Ne}),u.$$.dirty[0]&1049104&&Ei!==Pe&&ct&&(s(20,Ei=Pe),ct.destroy(),s(11,pt={}),s(12,lt={}),s(9,ct=qi()),ct.init()),u.$$.dirty[0]&528&&ct&&Pe==="short"&&"setAlwaysCollapsed"in ct&&ct.setAlwaysCollapsed(je),u.$$.dirty[0]&524544&&Wt!==Ze&&(Wt&&Wt.removeEventListener("scroll",Gi),Ze&&Ze.addEventListener("scroll",Gi),s(19,Wt=Ze))},[We,F,G,H,Pe,ke,yt,Ne,Ze,ct,vt,pt,lt,h,Gi,w,mr,Ar,fi,Wt,Ei,f,z,Rt,ai,yi,Fi]}class zx extends wn{constructor(r){super(),En(this,r,kx,Cx,gn,{use:1,class:2,style:3,variant:4,color:5,collapsed:0,prominent:6,dense:7,scrollTarget:8,getPropStore:16,getElement:17},null,[-1,-1])}get getPropStore(){return this.$$.ctx[16]}get getElement(){return this.$$.ctx[17]}}function Px(u){let r,s,g,w,z;const f=u[6].default,h=ao(f,u,u[5],null);let D=[u[3]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=gr("div"),h&&h.c(),this.h()},l(F){r=_r(F,"DIV",{});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){Wr(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),u[7](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[2].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&32)&&so(h,f,F,F[5],g?uo(f,F[5],G,null):lo(F[5]),null),Wr(r,N=Gn(D,[G&8&&F[3]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[7](null),w=!1,Sa(z)}}}function Mx(u,r,s){const g=["use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r;const D=wo(xo());let N;function F(){return N}function G(H){an[H?"unshift":"push"](()=>{N=H,s(1,N)})}return u.$$set=H=>{r=wi(wi({},r),bo(H)),s(3,w=lr(r,g)),"use"in H&&s(0,h=H.use),"$$scope"in H&&s(5,f=H.$$scope)},[h,N,D,w,F,f,z,G]}class yv extends wn{constructor(r){super(),En(this,r,Mx,Px,gn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function Lx(u){let r;const s=u[10].default,g=ao(s,u,u[12],null);return{c(){g&&g.c()},l(w){g&&g.l(w)},m(w,z){g&&g.m(w,z),r=!0},p(w,z){g&&g.p&&(!r||z&4096)&&so(g,s,w,w[12],r?uo(s,w[12],z,null):lo(w[12]),null)},i(w){r||(ii(g,w),r=!0)},o(w){ui(g,w),r=!1},d(w){g&&g.d(w)}}}function Dx(u){let r,s,g;const w=[{use:[u[7],...u[0]]},{class:_o(ll({[u[1]]:!0,[u[5]]:!0},u[4]))},u[6],u[8]];var z=u[2];function f(h){let D={$$slots:{default:[Lx]},$$scope:{ctx:h}};for(let N=0;N<w.length;N+=1)D=wi(D,w[N]);return{props:D}}return z&&(r=new z(f(u)),u[11](r)),{c(){r&&pr(r.$$.fragment),s=hn()},l(h){r&&Rr(r.$$.fragment,h),s=hn()},m(h,D){r&&dr(r,h,D),xi(h,s,D),g=!0},p(h,[D]){const N=D&499?Gn(w,[D&129&&{use:[h[7],...h[0]]},D&50&&{class:_o(ll({[h[1]]:!0,[h[5]]:!0},h[4]))},D&64&&Ya(h[6]),D&256&&Ya(h[8])]):{};if(D&4096&&(N.$$scope={dirty:D,ctx:h}),z!==(z=h[2])){if(r){pl();const F=r;ui(F.$$.fragment,1,0,()=>{fr(F,1)}),hl()}z?(r=new z(f(h)),h[11](r),pr(r.$$.fragment),ii(r.$$.fragment,1),dr(r,s.parentNode,s)):r=null}else z&&r.$set(N)},i(h){g||(r&&ii(r.$$.fragment,h),g=!0)},o(h){r&&ui(r.$$.fragment,h),g=!1},d(h){u[11](null),h&&Mt(s),r&&fr(r,h)}}}const fh={component:yv,class:"",classMap:{},contexts:{},props:{}};function Rx(u,r,s){const g=["use","class","component","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r,{class:D=""}=r,N;const F=fh.class,G={},H=[],Pe=fh.contexts,ke=fh.props;let{component:We=fh.component}=r;Object.entries(fh.classMap).forEach(([Ze,vt])=>{const ct=Qa(vt);ct&&"subscribe"in ct&&H.push(ct.subscribe(pt=>{s(4,G[Ze]=pt,G)}))});const je=wo(xo());for(let Ze in Pe)Pe.hasOwnProperty(Ze)&&Ia(Ze,Pe[Ze]);Ud(()=>{for(const Ze of H)Ze()});function yt(){return N.getElement()}function Ne(Ze){an[Ze?"unshift":"push"](()=>{N=Ze,s(3,N)})}return u.$$set=Ze=>{r=wi(wi({},r),bo(Ze)),s(8,w=lr(r,g)),"use"in Ze&&s(0,h=Ze.use),"class"in Ze&&s(1,D=Ze.class),"component"in Ze&&s(2,We=Ze.component),"$$scope"in Ze&&s(12,f=Ze.$$scope)},[h,D,We,N,G,F,ke,je,w,yt,z,Ne,f]}class Bx extends wn{constructor(r){super(),En(this,r,Rx,Dx,gn,{use:0,class:1,component:2,getElement:9})}get getElement(){return this.$$.ctx[9]}}const __=Object.assign({},fh);function dl(u){return new Proxy(Bx,{construct:function(r,s){return Object.assign(fh,__,u),new r(...s)},get:function(r,s){return Object.assign(fh,__,u),r[s]}})}function Ox(u){let r,s,g,w,z;const f=u[7].default,h=ao(f,u,u[6],null);let D=[{href:u[1]},u[4]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=gr("a"),h&&h.c(),this.h()},l(F){r=_r(F,"A",{href:!0});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){Wr(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),u[8](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[3].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&64)&&so(h,f,F,F[6],g?uo(f,F[6],G,null):lo(F[6]),null),Wr(r,N=Gn(D,[(!g||G&2)&&{href:F[1]},G&16&&F[4]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[8](null),w=!1,Sa(z)}}}function Fx(u,r,s){const g=["use","href","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r,{href:D="javascript:void(0);"}=r;const N=wo(xo());let F;function G(){return F}function H(Pe){an[Pe?"unshift":"push"](()=>{F=Pe,s(2,F)})}return u.$$set=Pe=>{r=wi(wi({},r),bo(Pe)),s(4,w=lr(r,g)),"use"in Pe&&s(0,h=Pe.use),"href"in Pe&&s(1,D=Pe.href),"$$scope"in Pe&&s(6,f=Pe.$$scope)},[h,D,F,N,w,G,f,z,H]}class Ux extends wn{constructor(r){super(),En(this,r,Fx,Ox,gn,{use:0,href:1,getElement:5})}get getElement(){return this.$$.ctx[5]}}function Nx(u){let r,s,g,w,z;const f=u[6].default,h=ao(f,u,u[5],null);let D=[u[3]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=gr("button"),h&&h.c(),this.h()},l(F){r=_r(F,"BUTTON",{});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){Wr(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),r.autofocus&&r.focus(),u[7](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[2].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&32)&&so(h,f,F,F[5],g?uo(f,F[5],G,null):lo(F[5]),null),Wr(r,N=Gn(D,[G&8&&F[3]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[7](null),w=!1,Sa(z)}}}function jx(u,r,s){const g=["use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r;const D=wo(xo());let N;function F(){return N}function G(H){an[H?"unshift":"push"](()=>{N=H,s(1,N)})}return u.$$set=H=>{r=wi(wi({},r),bo(H)),s(3,w=lr(r,g)),"use"in H&&s(0,h=H.use),"$$scope"in H&&s(5,f=H.$$scope)},[h,N,D,w,F,f,z,G]}class Vx extends wn{constructor(r){super(),En(this,r,jx,Nx,gn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function qx(u){let r,s,g,w,z;const f=u[6].default,h=ao(f,u,u[5],null);let D=[u[3]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=gr("h1"),h&&h.c(),this.h()},l(F){r=_r(F,"H1",{});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){Wr(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),u[7](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[2].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&32)&&so(h,f,F,F[5],g?uo(f,F[5],G,null):lo(F[5]),null),Wr(r,N=Gn(D,[G&8&&F[3]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[7](null),w=!1,Sa(z)}}}function Gx(u,r,s){const g=["use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r;const D=wo(xo());let N;function F(){return N}function G(H){an[H?"unshift":"push"](()=>{N=H,s(1,N)})}return u.$$set=H=>{r=wi(wi({},r),bo(H)),s(3,w=lr(r,g)),"use"in H&&s(0,h=H.use),"$$scope"in H&&s(5,f=H.$$scope)},[h,N,D,w,F,f,z,G]}class Zx extends wn{constructor(r){super(),En(this,r,Gx,qx,gn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function Hx(u){let r,s,g,w,z;const f=u[6].default,h=ao(f,u,u[5],null);let D=[u[3]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=gr("h2"),h&&h.c(),this.h()},l(F){r=_r(F,"H2",{});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){Wr(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),u[7](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[2].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&32)&&so(h,f,F,F[5],g?uo(f,F[5],G,null):lo(F[5]),null),Wr(r,N=Gn(D,[G&8&&F[3]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[7](null),w=!1,Sa(z)}}}function Wx(u,r,s){const g=["use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r;const D=wo(xo());let N;function F(){return N}function G(H){an[H?"unshift":"push"](()=>{N=H,s(1,N)})}return u.$$set=H=>{r=wi(wi({},r),bo(H)),s(3,w=lr(r,g)),"use"in H&&s(0,h=H.use),"$$scope"in H&&s(5,f=H.$$scope)},[h,N,D,w,F,f,z,G]}class Xx extends wn{constructor(r){super(),En(this,r,Wx,Hx,gn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function Kx(u){let r,s,g,w,z;const f=u[6].default,h=ao(f,u,u[5],null);let D=[u[3]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=gr("h3"),h&&h.c(),this.h()},l(F){r=_r(F,"H3",{});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){Wr(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),u[7](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[2].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&32)&&so(h,f,F,F[5],g?uo(f,F[5],G,null):lo(F[5]),null),Wr(r,N=Gn(D,[G&8&&F[3]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[7](null),w=!1,Sa(z)}}}function Jx(u,r,s){const g=["use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r;const D=wo(xo());let N;function F(){return N}function G(H){an[H?"unshift":"push"](()=>{N=H,s(1,N)})}return u.$$set=H=>{r=wi(wi({},r),bo(H)),s(3,w=lr(r,g)),"use"in H&&s(0,h=H.use),"$$scope"in H&&s(5,f=H.$$scope)},[h,N,D,w,F,f,z,G]}class $x extends wn{constructor(r){super(),En(this,r,Jx,Kx,gn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function Yx(u){let r,s,g,w,z;const f=u[6].default,h=ao(f,u,u[5],null);let D=[u[3]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=gr("i"),h&&h.c(),this.h()},l(F){r=_r(F,"I",{});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){Wr(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),u[7](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[2].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&32)&&so(h,f,F,F[5],g?uo(f,F[5],G,null):lo(F[5]),null),Wr(r,N=Gn(D,[G&8&&F[3]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[7](null),w=!1,Sa(z)}}}function Qx(u,r,s){const g=["use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r;const D=wo(xo());let N;function F(){return N}function G(H){an[H?"unshift":"push"](()=>{N=H,s(1,N)})}return u.$$set=H=>{r=wi(wi({},r),bo(H)),s(3,w=lr(r,g)),"use"in H&&s(0,h=H.use),"$$scope"in H&&s(5,f=H.$$scope)},[h,N,D,w,F,f,z,G]}class e1 extends wn{constructor(r){super(),En(this,r,Qx,Yx,gn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function t1(u){let r,s,g,w,z;const f=u[6].default,h=ao(f,u,u[5],null);let D=[u[3]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=gr("li"),h&&h.c(),this.h()},l(F){r=_r(F,"LI",{});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){Wr(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),u[7](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[2].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&32)&&so(h,f,F,F[5],g?uo(f,F[5],G,null):lo(F[5]),null),Wr(r,N=Gn(D,[G&8&&F[3]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[7](null),w=!1,Sa(z)}}}function i1(u,r,s){const g=["use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r;const D=wo(xo());let N;function F(){return N}function G(H){an[H?"unshift":"push"](()=>{N=H,s(1,N)})}return u.$$set=H=>{r=wi(wi({},r),bo(H)),s(3,w=lr(r,g)),"use"in H&&s(0,h=H.use),"$$scope"in H&&s(5,f=H.$$scope)},[h,N,D,w,F,f,z,G]}class r1 extends wn{constructor(r){super(),En(this,r,i1,t1,gn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function n1(u){let r,s,g,w,z;const f=u[6].default,h=ao(f,u,u[5],null);let D=[u[3]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=gr("main"),h&&h.c(),this.h()},l(F){r=_r(F,"MAIN",{});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){Wr(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),u[7](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[2].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&32)&&so(h,f,F,F[5],g?uo(f,F[5],G,null):lo(F[5]),null),Wr(r,N=Gn(D,[G&8&&F[3]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[7](null),w=!1,Sa(z)}}}function o1(u,r,s){const g=["use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r;const D=wo(xo());let N;function F(){return N}function G(H){an[H?"unshift":"push"](()=>{N=H,s(1,N)})}return u.$$set=H=>{r=wi(wi({},r),bo(H)),s(3,w=lr(r,g)),"use"in H&&s(0,h=H.use),"$$scope"in H&&s(5,f=H.$$scope)},[h,N,D,w,F,f,z,G]}class a1 extends wn{constructor(r){super(),En(this,r,o1,n1,gn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function s1(u){let r,s,g,w,z;const f=u[6].default,h=ao(f,u,u[5],null);let D=[u[3]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=gr("nav"),h&&h.c(),this.h()},l(F){r=_r(F,"NAV",{});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){Wr(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),u[7](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[2].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&32)&&so(h,f,F,F[5],g?uo(f,F[5],G,null):lo(F[5]),null),Wr(r,N=Gn(D,[G&8&&F[3]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[7](null),w=!1,Sa(z)}}}function l1(u,r,s){const g=["use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r;const D=wo(xo());let N;function F(){return N}function G(H){an[H?"unshift":"push"](()=>{N=H,s(1,N)})}return u.$$set=H=>{r=wi(wi({},r),bo(H)),s(3,w=lr(r,g)),"use"in H&&s(0,h=H.use),"$$scope"in H&&s(5,f=H.$$scope)},[h,N,D,w,F,f,z,G]}class u1 extends wn{constructor(r){super(),En(this,r,l1,s1,gn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function c1(u){let r,s,g,w,z;const f=u[6].default,h=ao(f,u,u[5],null);let D=[u[3]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=gr("span"),h&&h.c(),this.h()},l(F){r=_r(F,"SPAN",{});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){Wr(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),u[7](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[2].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&32)&&so(h,f,F,F[5],g?uo(f,F[5],G,null):lo(F[5]),null),Wr(r,N=Gn(D,[G&8&&F[3]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[7](null),w=!1,Sa(z)}}}function h1(u,r,s){const g=["use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r;const D=wo(xo());let N;function F(){return N}function G(H){an[H?"unshift":"push"](()=>{N=H,s(1,N)})}return u.$$set=H=>{r=wi(wi({},r),bo(H)),s(3,w=lr(r,g)),"use"in H&&s(0,h=H.use),"$$scope"in H&&s(5,f=H.$$scope)},[h,N,D,w,F,f,z,G]}class p1 extends wn{constructor(r){super(),En(this,r,h1,c1,gn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function d1(u){let r,s,g,w,z;const f=u[6].default,h=ao(f,u,u[5],null);let D=[u[3]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=Oy("svg"),h&&h.c(),this.h()},l(F){r=Fy(F,"svg",{});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){u_(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),u[7](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[2].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&32)&&so(h,f,F,F[5],g?uo(f,F[5],G,null):lo(F[5]),null),u_(r,N=Gn(D,[G&8&&F[3]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[7](null),w=!1,Sa(z)}}}function f1(u,r,s){const g=["use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r;const D=wo(xo());let N;function F(){return N}function G(H){an[H?"unshift":"push"](()=>{N=H,s(1,N)})}return u.$$set=H=>{r=wi(wi({},r),bo(H)),s(3,w=lr(r,g)),"use"in H&&s(0,h=H.use),"$$scope"in H&&s(5,f=H.$$scope)},[h,N,D,w,F,f,z,G]}class v_ extends wn{constructor(r){super(),En(this,r,f1,d1,gn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function m1(u){let r,s,g,w,z;const f=u[6].default,h=ao(f,u,u[5],null);let D=[u[3]],N={};for(let F=0;F<D.length;F+=1)N=wi(N,D[F]);return{c(){r=gr("ul"),h&&h.c(),this.h()},l(F){r=_r(F,"UL",{});var G=Dr(r);h&&h.l(G),G.forEach(Mt),this.h()},h(){Wr(r,N)},m(F,G){xi(F,r,G),h&&h.m(r,null),u[7](r),g=!0,w||(z=[Vr(s=ra.call(null,r,u[0])),Vr(u[2].call(null,r))],w=!0)},p(F,[G]){h&&h.p&&(!g||G&32)&&so(h,f,F,F[5],g?uo(f,F[5],G,null):lo(F[5]),null),Wr(r,N=Gn(D,[G&8&&F[3]])),s&&Vo(s.update)&&G&1&&s.update.call(null,F[0])},i(F){g||(ii(h,F),g=!0)},o(F){ui(h,F),g=!1},d(F){F&&Mt(r),h&&h.d(F),u[7](null),w=!1,Sa(z)}}}function y1(u,r,s){const g=["use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r,{use:h=[]}=r;const D=wo(xo());let N;function F(){return N}function G(H){an[H?"unshift":"push"](()=>{N=H,s(1,N)})}return u.$$set=H=>{r=wi(wi({},r),bo(H)),s(3,w=lr(r,g)),"use"in H&&s(0,h=H.use),"$$scope"in H&&s(5,f=H.$$scope)},[h,N,D,w,F,f,z,G]}class g1 extends wn{constructor(r){super(),En(this,r,y1,m1,gn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}const gv=Ux,_1=Vx,Nd=yv,v1=Zx,x1=Xx,b1=$x,w1=r1,E1=a1,I1=u1,Gp=p1,S1=g1;var T1=dl({class:"mdc-top-app-bar__row",component:Nd});function A1(u){let r,s,g,w,z,f;const h=u[9].default,D=ao(h,u,u[8],null);let N=[{class:s=_o({[u[1]]:!0,"mdc-top-app-bar__section":!0,"mdc-top-app-bar__section--align-start":u[2]==="start","mdc-top-app-bar__section--align-end":u[2]==="end"})},u[3]?{role:"toolbar"}:{},u[6]],F={};for(let G=0;G<N.length;G+=1)F=wi(F,N[G]);return{c(){r=gr("section"),D&&D.c(),this.h()},l(G){r=_r(G,"SECTION",{class:!0});var H=Dr(r);D&&D.l(H),H.forEach(Mt),this.h()},h(){Wr(r,F)},m(G,H){xi(G,r,H),D&&D.m(r,null),u[10](r),w=!0,z||(f=[Vr(g=ra.call(null,r,u[0])),Vr(u[5].call(null,r))],z=!0)},p(G,[H]){D&&D.p&&(!w||H&256)&&so(D,h,G,G[8],w?uo(h,G[8],H,null):lo(G[8]),null),Wr(r,F=Gn(N,[(!w||H&6&&s!==(s=_o({[G[1]]:!0,"mdc-top-app-bar__section":!0,"mdc-top-app-bar__section--align-start":G[2]==="start","mdc-top-app-bar__section--align-end":G[2]==="end"})))&&{class:s},H&8&&(G[3]?{role:"toolbar"}:{}),H&64&&G[6]])),g&&Vo(g.update)&&H&1&&g.update.call(null,G[0])},i(G){w||(ii(D,G),w=!0)},o(G){ui(D,G),w=!1},d(G){G&&Mt(r),D&&D.d(G),u[10](null),z=!1,Sa(f)}}}function C1(u,r,s){const g=["use","class","align","toolbar","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r;const h=wo(xo());let{use:D=[]}=r,{class:N=""}=r,{align:F="start"}=r,{toolbar:G=!1}=r,H;Ia("SMUI:icon-button:context",G?"top-app-bar:action":"top-app-bar:navigation"),Ia("SMUI:button:context",G?"top-app-bar:action":"top-app-bar:navigation");function Pe(){return H}function ke(We){an[We?"unshift":"push"](()=>{H=We,s(4,H)})}return u.$$set=We=>{r=wi(wi({},r),bo(We)),s(6,w=lr(r,g)),"use"in We&&s(0,D=We.use),"class"in We&&s(1,N=We.class),"align"in We&&s(2,F=We.align),"toolbar"in We&&s(3,G=We.toolbar),"$$scope"in We&&s(8,f=We.$$scope)},[D,N,F,G,H,h,w,Pe,f,z,ke]}class k1 extends wn{constructor(r){super(),En(this,r,C1,A1,gn,{use:0,class:1,align:2,toolbar:3,getElement:7})}get getElement(){return this.$$.ctx[7]}}var z1=dl({class:"mdc-top-app-bar__title",component:Gp});function P1(u){let r;const s=u[11].default,g=ao(s,u,u[13],null);return{c(){g&&g.c()},l(w){g&&g.l(w)},m(w,z){g&&g.m(w,z),r=!0},p(w,z){g&&g.p&&(!r||z&8192)&&so(g,s,w,w[13],r?uo(s,w[13],z,null):lo(w[13]),null)},i(w){r||(ii(g,w),r=!0)},o(w){ui(g,w),r=!1},d(w){g&&g.d(w)}}}function M1(u){let r,s,g;const w=[{use:[u[6],...u[0]]},{class:_o({[u[1]]:!0,[u[5]]:!0})},u[7]];var z=u[2];function f(h){let D={$$slots:{default:[P1]},$$scope:{ctx:h}};for(let N=0;N<w.length;N+=1)D=wi(D,w[N]);return{props:D}}return z&&(r=new z(f(u)),u[12](r)),{c(){r&&pr(r.$$.fragment),s=hn()},l(h){r&&Rr(r.$$.fragment,h),s=hn()},m(h,D){r&&dr(r,h,D),xi(h,s,D),g=!0},p(h,[D]){const N=D&227?Gn(w,[D&65&&{use:[h[6],...h[0]]},D&34&&{class:_o({[h[1]]:!0,[h[5]]:!0})},D&128&&Ya(h[7])]):{};if(D&8192&&(N.$$scope={dirty:D,ctx:h}),z!==(z=h[2])){if(r){pl();const F=r;ui(F.$$.fragment,1,0,()=>{fr(F,1)}),hl()}z?(r=new z(f(h)),h[12](r),pr(r.$$.fragment),ii(r.$$.fragment,1),dr(r,s.parentNode,s)):r=null}else z&&r.$set(N)},i(h){g||(r&&ii(r.$$.fragment,h),g=!0)},o(h){r&&ui(r.$$.fragment,h),g=!1},d(h){u[12](null),h&&Mt(s),r&&fr(r,h)}}}function L1(u,r,s){let g,w;const z=["use","class","topAppBar","component","getElement"];let f=lr(r,z),h,D=vs,N=()=>(D(),D=ux(g,vt=>s(10,h=vt)),g);u.$$.on_destroy.push(()=>D());let{$$slots:F={},$$scope:G}=r;const H=wo(xo());let{use:Pe=[]}=r,{class:ke=""}=r,{topAppBar:We}=r,je,{component:yt=E1}=r;function Ne(){return je.getElement()}function Ze(vt){an[vt?"unshift":"push"](()=>{je=vt,s(4,je)})}return u.$$set=vt=>{r=wi(wi({},r),bo(vt)),s(7,f=lr(r,z)),"use"in vt&&s(0,Pe=vt.use),"class"in vt&&s(1,ke=vt.class),"topAppBar"in vt&&s(8,We=vt.topAppBar),"component"in vt&&s(2,yt=vt.component),"$$scope"in vt&&s(13,G=vt.$$scope)},u.$$.update=()=>{u.$$.dirty&256&&N(s(3,g=We&&We.getPropStore())),u.$$.dirty&1032&&s(5,w=(()=>!g||h.variant==="static"?"":h.variant==="short"?"mdc-top-app-bar--short-fixed-adjust":h.prominent&&h.dense?"mdc-top-app-bar--dense-prominent-fixed-adjust":h.prominent?"mdc-top-app-bar--prominent-fixed-adjust":h.dense?"mdc-top-app-bar--dense-fixed-adjust":"mdc-top-app-bar--fixed-adjust")())},[Pe,ke,yt,g,je,w,H,f,We,Ne,h,F,Ze,G]}class D1 extends wn{constructor(r){super(),En(this,r,L1,M1,gn,{use:0,class:1,topAppBar:8,component:2,getElement:9})}get getElement(){return this.$$.ctx[9]}}const x_=k1,R1=D1;/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var zf={ICON_BUTTON_ON:"mdc-icon-button--on",ROOT:"mdc-icon-button"},zc={ARIA_LABEL:"aria-label",ARIA_PRESSED:"aria-pressed",DATA_ARIA_LABEL_OFF:"data-aria-label-off",DATA_ARIA_LABEL_ON:"data-aria-label-on",CHANGE_EVENT:"MDCIconButtonToggle:change"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var B1=function(u){bu(r,u);function r(s){var g=u.call(this,Da(Da({},r.defaultAdapter),s))||this;return g.hasToggledAriaLabel=!1,g}return Object.defineProperty(r,"cssClasses",{get:function(){return zf},enumerable:!1,configurable:!0}),Object.defineProperty(r,"strings",{get:function(){return zc},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{addClass:function(){},hasClass:function(){return!1},notifyChange:function(){},removeClass:function(){},getAttr:function(){return null},setAttr:function(){}}},enumerable:!1,configurable:!0}),r.prototype.init=function(){var s=this.adapter.getAttr(zc.DATA_ARIA_LABEL_ON),g=this.adapter.getAttr(zc.DATA_ARIA_LABEL_OFF);if(s&&g){if(this.adapter.getAttr(zc.ARIA_PRESSED)!==null)throw new Error("MDCIconButtonToggleFoundation: Button should not set `aria-pressed` if it has a toggled aria label.");this.hasToggledAriaLabel=!0}else this.adapter.setAttr(zc.ARIA_PRESSED,String(this.isOn()))},r.prototype.handleClick=function(){this.toggle(),this.adapter.notifyChange({isOn:this.isOn()})},r.prototype.isOn=function(){return this.adapter.hasClass(zf.ICON_BUTTON_ON)},r.prototype.toggle=function(s){if(s===void 0&&(s=!this.isOn()),s?this.adapter.addClass(zf.ICON_BUTTON_ON):this.adapter.removeClass(zf.ICON_BUTTON_ON),this.hasToggledAriaLabel){var g=s?this.adapter.getAttr(zc.DATA_ARIA_LABEL_ON):this.adapter.getAttr(zc.DATA_ARIA_LABEL_OFF);this.adapter.setAttr(zc.ARIA_LABEL,g||"")}else this.adapter.setAttr(zc.ARIA_PRESSED,""+s)},r}(tp);/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var my="mdc-dom-focus-sentinel",O1=function(){function u(r,s){s===void 0&&(s={}),this.root=r,this.options=s,this.elFocusedBeforeTrapFocus=null}return u.prototype.trapFocus=function(){var r=this.getFocusableElements(this.root);if(r.length===0)throw new Error("FocusTrap: Element must have at least one focusable child.");this.elFocusedBeforeTrapFocus=document.activeElement instanceof HTMLElement?document.activeElement:null,this.wrapTabFocus(this.root),this.options.skipInitialFocus||this.focusInitialElement(r,this.options.initialFocusEl)},u.prototype.releaseFocus=function(){[].slice.call(this.root.querySelectorAll("."+my)).forEach(function(r){r.parentElement.removeChild(r)}),!this.options.skipRestoreFocus&&this.elFocusedBeforeTrapFocus&&this.elFocusedBeforeTrapFocus.focus()},u.prototype.wrapTabFocus=function(r){var s=this,g=this.createSentinel(),w=this.createSentinel();g.addEventListener("focus",function(){var z=s.getFocusableElements(r);z.length>0&&z[z.length-1].focus()}),w.addEventListener("focus",function(){var z=s.getFocusableElements(r);z.length>0&&z[0].focus()}),r.insertBefore(g,r.children[0]),r.appendChild(w)},u.prototype.focusInitialElement=function(r,s){var g=0;s&&(g=Math.max(r.indexOf(s),0)),r[g].focus()},u.prototype.getFocusableElements=function(r){var s=[].slice.call(r.querySelectorAll("[autofocus], [tabindex], a, input, textarea, select, button"));return s.filter(function(g){var w=g.getAttribute("aria-disabled")==="true"||g.getAttribute("disabled")!=null||g.getAttribute("hidden")!=null||g.getAttribute("aria-hidden")==="true",z=g.tabIndex>=0&&g.getBoundingClientRect().width>0&&!g.classList.contains(my)&&!w,f=!1;if(z){var h=getComputedStyle(g);f=h.display==="none"||h.visibility==="hidden"}return z&&!f})},u.prototype.createSentinel=function(){var r=document.createElement("div");return r.setAttribute("tabindex","0"),r.setAttribute("aria-hidden","true"),r.classList.add(my),r},u}(),F1=Object.freeze(Object.defineProperty({__proto__:null,FocusTrap:O1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var $r={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape",TAB:"Tab"},xs=new Set;xs.add($r.BACKSPACE);xs.add($r.ENTER);xs.add($r.SPACEBAR);xs.add($r.PAGE_UP);xs.add($r.PAGE_DOWN);xs.add($r.END);xs.add($r.HOME);xs.add($r.ARROW_LEFT);xs.add($r.ARROW_UP);xs.add($r.ARROW_RIGHT);xs.add($r.ARROW_DOWN);xs.add($r.DELETE);xs.add($r.ESCAPE);xs.add($r.TAB);var js={BACKSPACE:8,ENTER:13,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ESCAPE:27,TAB:9},bs=new Map;bs.set(js.BACKSPACE,$r.BACKSPACE);bs.set(js.ENTER,$r.ENTER);bs.set(js.SPACEBAR,$r.SPACEBAR);bs.set(js.PAGE_UP,$r.PAGE_UP);bs.set(js.PAGE_DOWN,$r.PAGE_DOWN);bs.set(js.END,$r.END);bs.set(js.HOME,$r.HOME);bs.set(js.ARROW_LEFT,$r.ARROW_LEFT);bs.set(js.ARROW_UP,$r.ARROW_UP);bs.set(js.ARROW_RIGHT,$r.ARROW_RIGHT);bs.set(js.ARROW_DOWN,$r.ARROW_DOWN);bs.set(js.DELETE,$r.DELETE);bs.set(js.ESCAPE,$r.ESCAPE);bs.set(js.TAB,$r.TAB);var bh=new Set;bh.add($r.PAGE_UP);bh.add($r.PAGE_DOWN);bh.add($r.END);bh.add($r.HOME);bh.add($r.ARROW_LEFT);bh.add($r.ARROW_UP);bh.add($r.ARROW_RIGHT);bh.add($r.ARROW_DOWN);function $a(u){var r=u.key;if(xs.has(r))return r;var s=bs.get(u.keyCode);return s||$r.UNKNOWN}const{applyPassive:Pf}=yx,{matches:U1}=fv;function Dd(u,{ripple:r=!0,surface:s=!1,unbounded:g=!1,disabled:w=!1,color:z,active:f,rippleElement:h,eventTarget:D,activeTarget:N,addClass:F=ke=>u.classList.add(ke),removeClass:G=ke=>u.classList.remove(ke),addStyle:H=(ke,We)=>u.style.setProperty(ke,We),initPromise:Pe=Promise.resolve()}={}){let ke,We=Qa("SMUI:addLayoutListener"),je,yt=f,Ne=D,Ze=N;function vt(){s?(F("mdc-ripple-surface"),z==="primary"?(F("smui-ripple-surface--primary"),G("smui-ripple-surface--secondary")):z==="secondary"?(G("smui-ripple-surface--primary"),F("smui-ripple-surface--secondary")):(G("smui-ripple-surface--primary"),G("smui-ripple-surface--secondary"))):(G("mdc-ripple-surface"),G("smui-ripple-surface--primary"),G("smui-ripple-surface--secondary")),ke&&yt!==f&&(yt=f,f?ke.activate():f===!1&&ke.deactivate()),r&&!ke?(ke=new Ex({addClass:F,browserSupportsCssVars:()=>bx(window),computeBoundingRect:()=>(h||u).getBoundingClientRect(),containsEventTarget:pt=>u.contains(pt),deregisterDocumentInteractionHandler:(pt,lt)=>document.documentElement.removeEventListener(pt,lt,Pf()),deregisterInteractionHandler:(pt,lt)=>(D||u).removeEventListener(pt,lt,Pf()),deregisterResizeHandler:pt=>window.removeEventListener("resize",pt),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset}),isSurfaceActive:()=>f==null?U1(N||u,":active"):f,isSurfaceDisabled:()=>!!w,isUnbounded:()=>!!g,registerDocumentInteractionHandler:(pt,lt)=>document.documentElement.addEventListener(pt,lt,Pf()),registerInteractionHandler:(pt,lt)=>(D||u).addEventListener(pt,lt,Pf()),registerResizeHandler:pt=>window.addEventListener("resize",pt),removeClass:G,updateCssVariable:H}),Pe.then(()=>{ke&&(ke.init(),ke.setUnbounded(g))})):ke&&!r&&Pe.then(()=>{ke&&(ke.destroy(),ke=void 0)}),ke&&(Ne!==D||Ze!==N)&&(Ne=D,Ze=N,ke.destroy(),requestAnimationFrame(()=>{ke&&(ke.init(),ke.setUnbounded(g))})),!r&&g&&F("mdc-ripple-upgraded--unbounded")}vt(),We&&(je=We(ct));function ct(){ke&&ke.layout()}return{update(pt){({ripple:r,surface:s,unbounded:g,disabled:w,color:z,active:f,rippleElement:h,eventTarget:D,activeTarget:N,addClass:F,removeClass:G,addStyle:H,initPromise:Pe}=Object.assign({ripple:!0,surface:!1,unbounded:!1,disabled:!1,color:void 0,active:void 0,rippleElement:void 0,eventTarget:void 0,activeTarget:void 0,addClass:lt=>u.classList.add(lt),removeClass:lt=>u.classList.remove(lt),addStyle:(lt,fi)=>u.style.setProperty(lt,fi),initPromise:Promise.resolve()},pt)),vt()},destroy(){ke&&(ke.destroy(),ke=void 0,G("mdc-ripple-surface"),G("smui-ripple-surface--primary"),G("smui-ripple-surface--secondary")),je&&je()}}}function b_(u){let r;return{c(){r=gr("div"),this.h()},l(s){r=_r(s,"DIV",{class:!0}),Dr(r).forEach(Mt),this.h()},h(){jr(r,"class","mdc-icon-button__touch")},m(s,g){xi(s,r,g)},d(s){s&&Mt(r)}}}function N1(u){let r,s,g,w;const z=u[32].default,f=ao(z,u,u[36],null);let h=u[8]&&b_();return{c(){r=gr("div"),s=qo(),f&&f.c(),h&&h.c(),g=hn(),this.h()},l(D){r=_r(D,"DIV",{class:!0}),Dr(r).forEach(Mt),s=Go(D),f&&f.l(D),h&&h.l(D),g=hn(),this.h()},h(){jr(r,"class","mdc-icon-button__ripple")},m(D,N){xi(D,r,N),xi(D,s,N),f&&f.m(D,N),h&&h.m(D,N),xi(D,g,N),w=!0},p(D,N){f&&f.p&&(!w||N[1]&32)&&so(f,z,D,D[36],w?uo(z,D[36],N,null):lo(D[36]),null),D[8]?h||(h=b_(),h.c(),h.m(g.parentNode,g)):h&&(h.d(1),h=null)},i(D){w||(ii(f,D),w=!0)},o(D){ui(f,D),w=!1},d(D){D&&Mt(r),D&&Mt(s),f&&f.d(D),h&&h.d(D),D&&Mt(g)}}}function j1(u){let r,s,g;const w=[{use:[[Dd,{ripple:u[4],unbounded:!0,color:u[5],disabled:!!u[28].disabled,addClass:u[25],removeClass:u[26],addStyle:u[27]}],u[21],...u[1]]},{class:_o(ll({[u[2]]:!0,"mdc-icon-button":!0,"mdc-icon-button--on":!u[22](u[0])&&u[0],"mdc-icon-button--touch":u[8],"mdc-icon-button--display-flex":u[9],"smui-icon-button--size-button":u[10]==="button","mdc-icon-button--reduced-size":u[10]==="mini"||u[10]==="button","mdc-card__action":u[23]==="card:action","mdc-card__action--icon":u[23]==="card:action","mdc-top-app-bar__navigation-icon":u[23]==="top-app-bar:navigation","mdc-top-app-bar__action-item":u[23]==="top-app-bar:action","mdc-snackbar__dismiss":u[23]==="snackbar:actions","mdc-data-table__pagination-button":u[23]==="data-table:pagination","mdc-data-table__sort-icon-button":u[23]==="data-table:sortable-header-cell","mdc-dialog__close":u[23]==="dialog:header"&&u[12]==="close"},u[17]))},{style:Object.entries(u[18]).map(w_).concat([u[3]]).join(" ")},{"aria-pressed":u[22](u[0])?null:u[0]?"true":"false"},{"aria-label":u[0]?u[6]:u[7]},{"data-aria-label-on":u[6]},{"data-aria-label-off":u[7]},{"aria-describedby":u[24]},{href:u[11]},u[20],u[19],u[28]];var z=u[13];function f(h){let D={$$slots:{default:[N1]},$$scope:{ctx:h}};for(let N=0;N<w.length;N+=1)D=wi(D,w[N]);return{props:D}}return z&&(r=new z(f(u)),u[33](r),r.$on("click",u[34]),r.$on("click",u[35])),{c(){r&&pr(r.$$.fragment),s=hn()},l(h){r&&Rr(r.$$.fragment,h),s=hn()},m(h,D){r&&dr(r,h,D),xi(h,s,D),g=!0},p(h,D){const N=D[0]&536748031?Gn(w,[D[0]&505413682&&{use:[[Dd,{ripple:h[4],unbounded:!0,color:h[5],disabled:!!h[28].disabled,addClass:h[25],removeClass:h[26],addStyle:h[27]}],h[21],...h[1]]},D[0]&12719877&&{class:_o(ll({[h[2]]:!0,"mdc-icon-button":!0,"mdc-icon-button--on":!h[22](h[0])&&h[0],"mdc-icon-button--touch":h[8],"mdc-icon-button--display-flex":h[9],"smui-icon-button--size-button":h[10]==="button","mdc-icon-button--reduced-size":h[10]==="mini"||h[10]==="button","mdc-card__action":h[23]==="card:action","mdc-card__action--icon":h[23]==="card:action","mdc-top-app-bar__navigation-icon":h[23]==="top-app-bar:navigation","mdc-top-app-bar__action-item":h[23]==="top-app-bar:action","mdc-snackbar__dismiss":h[23]==="snackbar:actions","mdc-data-table__pagination-button":h[23]==="data-table:pagination","mdc-data-table__sort-icon-button":h[23]==="data-table:sortable-header-cell","mdc-dialog__close":h[23]==="dialog:header"&&h[12]==="close"},h[17]))},D[0]&262152&&{style:Object.entries(h[18]).map(w_).concat([h[3]]).join(" ")},D[0]&4194305&&{"aria-pressed":h[22](h[0])?null:h[0]?"true":"false"},D[0]&193&&{"aria-label":h[0]?h[6]:h[7]},D[0]&64&&{"data-aria-label-on":h[6]},D[0]&128&&{"data-aria-label-off":h[7]},D[0]&16777216&&{"aria-describedby":h[24]},D[0]&2048&&{href:h[11]},D[0]&1048576&&Ya(h[20]),D[0]&524288&&Ya(h[19]),D[0]&268435456&&Ya(h[28])]):{};if(D[0]&256|D[1]&32&&(N.$$scope={dirty:D,ctx:h}),z!==(z=h[13])){if(r){pl();const F=r;ui(F.$$.fragment,1,0,()=>{fr(F,1)}),hl()}z?(r=new z(f(h)),h[33](r),r.$on("click",h[34]),r.$on("click",h[35]),pr(r.$$.fragment),ii(r.$$.fragment,1),dr(r,s.parentNode,s)):r=null}else z&&r.$set(N)},i(h){g||(r&&ii(r.$$.fragment,h),g=!0)},o(h){r&&ui(r.$$.fragment,h),g=!1},d(h){u[33](null),h&&Mt(s),r&&fr(r,h)}}}const w_=([u,r])=>`${u}: ${r};`;function V1(u,r,s){let g;const w=["use","class","style","ripple","color","toggle","pressed","ariaLabelOn","ariaLabelOff","touch","displayFlex","size","href","action","component","getElement"];let z=lr(r,w),{$$slots:f={},$$scope:h}=r;const D=wo(xo());let N=()=>{};function F(zt){return zt===N}let{use:G=[]}=r,{class:H=""}=r,{style:Pe=""}=r,{ripple:ke=!0}=r,{color:We=void 0}=r,{toggle:je=!1}=r,{pressed:yt=N}=r,{ariaLabelOn:Ne=void 0}=r,{ariaLabelOff:Ze=void 0}=r,{touch:vt=!1}=r,{displayFlex:ct=!0}=r,{size:pt="normal"}=r,{href:lt=void 0}=r,{action:fi=void 0}=r,Et,Wt,Ei={},qi={},Xt={},Qt=Qa("SMUI:icon-button:context"),Ai=Qa("SMUI:icon-button:aria-describedby"),{component:bt=lt==null?_1:gv}=r,Gi=z.disabled;Ia("SMUI:icon:context","icon-button");let mr=null;Ud(()=>{Wt&&Wt.destroy()});function Ar(zt){return zt in Ei?Ei[zt]:Ri().classList.contains(zt)}function Rt(zt){Ei[zt]||s(17,Ei[zt]=!0,Ei)}function ai(zt){(!(zt in Ei)||Ei[zt])&&s(17,Ei[zt]=!1,Ei)}function yi(zt,tr){qi[zt]!=tr&&(tr===""||tr==null?(delete qi[zt],s(18,qi)):s(18,qi[zt]=tr,qi))}function Fi(zt){var tr;return zt in Xt?(tr=Xt[zt])!==null&&tr!==void 0?tr:null:Ri().getAttribute(zt)}function jt(zt,tr){Xt[zt]!==tr&&s(19,Xt[zt]=tr,Xt)}function Xi(zt){s(0,yt=zt.isOn)}function Ri(){return Et.getElement()}function Ii(zt){an[zt?"unshift":"push"](()=>{Et=zt,s(15,Et)})}const rr=()=>Wt&&Wt.handleClick(),zi=()=>Qt==="top-app-bar:navigation"&&Ns(Ri(),"SMUITopAppBarIconButton:nav");return u.$$set=zt=>{r=wi(wi({},r),bo(zt)),s(28,z=lr(r,w)),"use"in zt&&s(1,G=zt.use),"class"in zt&&s(2,H=zt.class),"style"in zt&&s(3,Pe=zt.style),"ripple"in zt&&s(4,ke=zt.ripple),"color"in zt&&s(5,We=zt.color),"toggle"in zt&&s(29,je=zt.toggle),"pressed"in zt&&s(0,yt=zt.pressed),"ariaLabelOn"in zt&&s(6,Ne=zt.ariaLabelOn),"ariaLabelOff"in zt&&s(7,Ze=zt.ariaLabelOff),"touch"in zt&&s(8,vt=zt.touch),"displayFlex"in zt&&s(9,ct=zt.displayFlex),"size"in zt&&s(10,pt=zt.size),"href"in zt&&s(11,lt=zt.href),"action"in zt&&s(12,fi=zt.action),"component"in zt&&s(13,bt=zt.component),"$$scope"in zt&&s(36,h=zt.$$scope)},u.$$.update=()=>{if(u.$$.dirty[0]&4096&&s(20,g=(()=>{if(Qt==="data-table:pagination")switch(fi){case"first-page":return{"data-first-page":"true"};case"prev-page":return{"data-prev-page":"true"};case"next-page":return{"data-next-page":"true"};case"last-page":return{"data-last-page":"true"};default:return{"data-action":"true"}}else return Qt==="dialog:header"?{"data-mdc-dialog-action":fi}:{action:fi}})()),Gi!==z.disabled){const zt=Ri();"blur"in zt&&zt.blur(),s(30,Gi=z.disabled)}u.$$.dirty[0]&536969216|u.$$.dirty[1]&1&&Et&&Ri()&&je!==mr&&(je&&!Wt?(s(16,Wt=new B1({addClass:Rt,hasClass:Ar,notifyChange:zt=>{Xi(zt),Ns(Ri(),"SMUIIconButtonToggle:change",zt,void 0,!0)},removeClass:ai,getAttr:Fi,setAttr:jt})),Wt.init()):!je&&Wt&&(Wt.destroy(),s(16,Wt=void 0),s(17,Ei={}),s(19,Xt={})),s(31,mr=je)),u.$$.dirty[0]&65537&&Wt&&!F(yt)&&Wt.isOn()!==yt&&Wt.toggle(yt)},[yt,G,H,Pe,ke,We,Ne,Ze,vt,ct,pt,lt,fi,bt,Ri,Et,Wt,Ei,qi,Xt,g,D,F,Qt,Ai,Rt,ai,yi,z,je,Gi,mr,f,Ii,rr,zi,h]}class Gf extends wn{constructor(r){super(),En(this,r,V1,j1,gn,{use:1,class:2,style:3,ripple:4,color:5,toggle:29,pressed:0,ariaLabelOn:6,ariaLabelOff:7,touch:8,displayFlex:9,size:10,href:11,action:12,component:13,getElement:14},null,[-1,-1])}get getElement(){return this.$$.ctx[14]}}function q1(u){let r;const s=u[9].default,g=ao(s,u,u[11],null);return{c(){g&&g.c()},l(w){g&&g.l(w)},m(w,z){g&&g.m(w,z),r=!0},p(w,z){g&&g.p&&(!r||z&2048)&&so(g,s,w,w[11],r?uo(s,w[11],z,null):lo(w[11]),null)},i(w){r||(ii(g,w),r=!0)},o(w){ui(g,w),r=!1},d(w){g&&g.d(w)}}}function G1(u){let r,s,g;const w=[{use:[u[5],...u[0]]},{class:_o({[u[1]]:!0,"mdc-button__icon":u[6]==="button","mdc-fab__icon":u[6]==="fab","mdc-icon-button__icon":u[6]==="icon-button","mdc-icon-button__icon--on":u[6]==="icon-button"&&u[2],"mdc-tab__icon":u[6]==="tab","mdc-banner__icon":u[6]==="banner","mdc-segmented-button__icon":u[6]==="segmented-button"})},{"aria-hidden":"true"},u[3]===v_?{focusable:"false",tabindex:"-1"}:{},u[7]];var z=u[3];function f(h){let D={$$slots:{default:[q1]},$$scope:{ctx:h}};for(let N=0;N<w.length;N+=1)D=wi(D,w[N]);return{props:D}}return z&&(r=new z(f(u)),u[10](r)),{c(){r&&pr(r.$$.fragment),s=hn()},l(h){r&&Rr(r.$$.fragment,h),s=hn()},m(h,D){r&&dr(r,h,D),xi(h,s,D),g=!0},p(h,[D]){const N=D&239?Gn(w,[D&33&&{use:[h[5],...h[0]]},D&70&&{class:_o({[h[1]]:!0,"mdc-button__icon":h[6]==="button","mdc-fab__icon":h[6]==="fab","mdc-icon-button__icon":h[6]==="icon-button","mdc-icon-button__icon--on":h[6]==="icon-button"&&h[2],"mdc-tab__icon":h[6]==="tab","mdc-banner__icon":h[6]==="banner","mdc-segmented-button__icon":h[6]==="segmented-button"})},w[2],D&8&&Ya(h[3]===v_?{focusable:"false",tabindex:"-1"}:{}),D&128&&Ya(h[7])]):{};if(D&2048&&(N.$$scope={dirty:D,ctx:h}),z!==(z=h[3])){if(r){pl();const F=r;ui(F.$$.fragment,1,0,()=>{fr(F,1)}),hl()}z?(r=new z(f(h)),h[10](r),pr(r.$$.fragment),ii(r.$$.fragment,1),dr(r,s.parentNode,s)):r=null}else z&&r.$set(N)},i(h){g||(r&&ii(r.$$.fragment,h),g=!0)},o(h){r&&ui(r.$$.fragment,h),g=!1},d(h){u[10](null),h&&Mt(s),r&&fr(r,h)}}}function Z1(u,r,s){const g=["use","class","on","component","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r;const h=wo(xo());let{use:D=[]}=r,{class:N=""}=r,{on:F=!1}=r,G,{component:H=e1}=r;const Pe=Qa("SMUI:icon:context");function ke(){return G.getElement()}function We(je){an[je?"unshift":"push"](()=>{G=je,s(4,G)})}return u.$$set=je=>{r=wi(wi({},r),bo(je)),s(7,w=lr(r,g)),"use"in je&&s(0,D=je.use),"class"in je&&s(1,N=je.class),"on"in je&&s(2,F=je.on),"component"in je&&s(3,H=je.component),"$$scope"in je&&s(11,f=je.$$scope)},[D,N,F,H,G,h,Pe,w,ke,z,We,f]}class H1 extends wn{constructor(r){super(),En(this,r,Z1,G1,gn,{use:0,class:1,on:2,component:3,getElement:8})}get getElement(){return this.$$.ctx[8]}}const E_=H1,Ur={title:"GIS for Water",url:"https://water-gis.com",logo:"https://raw.githubusercontent.com/watergis/logo/main/logo.svg",basePath:"/sveltekit-watergis-template",attribution:"\xA9NARWASSCO",styles:[{title:"UNVT(Water)",uri:"https://narwassco.github.io/mapbox-stylefiles/unvt/style.json"},{title:"UNVT(Sewer",uri:"https://narwassco.github.io/mapbox-stylefiles/unvt/style-sewer.json"}],center:{lng:35.87063,lat:-1.08551},zoom:13,search:{url:"https://narwassco.github.io/vt/meter.geojson",target:["connno","serialno"],format:u=>`${u.customer}, ${u.connno}, ${u.serialno}, ${u.village}`,place_type:["meter"],placeholder:"Search CONN NO or S/N",zoom:17},popup:{target:["meter","flow meter","valve","washout","firehydrant","tank","pipeline"]},areaSwitcher:{areas:[{title:"Narok",latlng:[35.87063,-1.08551],zoom:14},{title:"Ololulung'a",latlng:[35.65072,-1.0085],zoom:13},{title:"Kilgoris",latlng:[34.87533,-1.00278],zoom:14},{title:"Suswa",latlng:[36.33078,-1.05307],zoom:13}]},legend:{targets:{pipeline:"Pipeline",pipeline_annotation:"Pipeline Label",meter:"Water Meter","flow meter":"Flow Meter",valve:"Valve",firehydrant:"Fire Hydrant",washout:"Washout",tank:"Tank",tank_annotation:"Tank Label",wtp:"WTP",wtp_annotation:"WTP Label",intake:"Intake",intake_annotation:"Intake Label",parcels:"Parcels",parcels_annotation:"Parcels Label",village:"Village",village_annotation:"Village Label",dma:"DMA","dma-annotation":"DMA Label","contour-line":"Countour","contour-label":"Contour Label",hillshade:"Hillshade",sewer_connection:"Households (Sewer)",sewer_commercial:"Commecial (Sewer)",sewer_institution:"Institution (Sewer)",sewer_public_toilet:"Public Toilet (Sewer)",manhole:"Manhole",sewer_pipeline:"Sewer pipeline",sewer_treatment_plant:"Wastewater treatment plant"}},elevation:{url:"https://narwassco.github.io/narok-terrain/tiles/{z}/{x}/{y}.png",options:{tileSize:512,font:["Roboto Medium"],fontSize:12,fontHalo:1,mainColor:"#263238",haloColor:"#fff",units:"kilometers"}},valhalla:{url:"https://valhalla.water-gis.com",options:{Contours:[{time:3,distance:1,color:"ff0000"},{time:5,distance:2,color:"ffff00"},{time:10,distance:3,color:"0000ff"},{time:15,distance:4,color:"ff00ff"}]}}};function W1(u){let r;return{c(){r=gr("link"),this.h()},l(s){r=_r(s,"LINK",{rel:!0,href:!0}),this.h()},h(){jr(r,"rel","stylesheet"),jr(r,"href",Ur.basePath+"/smui.css")},m(s,g){xi(s,r,g)},p:vs,d(s){s&&Mt(r)}}}function X1(u){let r,s,g;return{c(){r=gr("link"),s=qo(),g=gr("link"),this.h()},l(w){r=_r(w,"LINK",{rel:!0,href:!0,media:!0}),s=Go(w),g=_r(w,"LINK",{rel:!0,href:!0,media:!0}),this.h()},h(){jr(r,"rel","stylesheet"),jr(r,"href",Ur.basePath+"/smui.css"),jr(r,"media","print"),jr(g,"rel","stylesheet"),jr(g,"href",Ur.basePath+"/smui-dark.css"),jr(g,"media","screen")},m(w,z){xi(w,r,z),xi(w,s,z),xi(w,g,z)},p:vs,d(w){w&&Mt(r),w&&Mt(s),w&&Mt(g)}}}function K1(u){let r,s,g;return{c(){r=gr("link"),s=qo(),g=gr("link"),this.h()},l(w){r=_r(w,"LINK",{rel:!0,href:!0,media:!0}),s=Go(w),g=_r(w,"LINK",{rel:!0,href:!0,media:!0}),this.h()},h(){jr(r,"rel","stylesheet"),jr(r,"href",Ur.basePath+"/smui.css"),jr(r,"media","(prefers-color-scheme: light)"),jr(g,"rel","stylesheet"),jr(g,"href",Ur.basePath+"/smui-dark.css"),jr(g,"media","screen and (prefers-color-scheme: dark)")},m(w,z){xi(w,r,z),xi(w,s,z),xi(w,g,z)},p:vs,d(w){w&&Mt(r),w&&Mt(s),w&&Mt(g)}}}function J1(u){let r;return{c(){r=Lc("menu")},l(s){r=Dc(s,"menu")},m(s,g){xi(s,r,g)},d(s){s&&Mt(r)}}}function $1(u){let r=Ur.title+"",s;return{c(){s=Lc(r)},l(g){s=Dc(g,r)},m(g,w){xi(g,s,w)},p:vs,d(g){g&&Mt(s)}}}function Y1(u){let r,s,g,w,z,f,h,D;return r=new Gf({props:{class:"material-icons",$$slots:{default:[J1]},$$scope:{ctx:u}}}),r.$on("click",u[6]),h=new z1({props:{$$slots:{default:[$1]},$$scope:{ctx:u}}}),{c(){pr(r.$$.fragment),s=qo(),g=gr("a"),w=gr("img"),f=qo(),pr(h.$$.fragment),this.h()},l(N){Rr(r.$$.fragment,N),s=Go(N),g=_r(N,"A",{href:!0});var F=Dr(g);w=_r(F,"IMG",{src:!0,alt:!0,class:!0}),F.forEach(Mt),f=Go(N),Rr(h.$$.fragment,N),this.h()},h(){hx(w.src,z=Ur.logo)||jr(w,"src",z),jr(w,"alt","logo"),jr(w,"class","logo svelte-1cnjkz4"),jr(g,"href",Ur.url)},m(N,F){dr(r,N,F),xi(N,s,F),xi(N,g,F),fa(g,w),xi(N,f,F),dr(h,N,F),D=!0},p(N,F){const G={};F&256&&(G.$$scope={dirty:F,ctx:N}),r.$set(G);const H={};F&256&&(H.$$scope={dirty:F,ctx:N}),h.$set(H)},i(N){D||(ii(r.$$.fragment,N),ii(h.$$.fragment,N),D=!0)},o(N){ui(r.$$.fragment,N),ui(h.$$.fragment,N),D=!1},d(N){fr(r,N),N&&Mt(s),N&&Mt(g),N&&Mt(f),fr(h,N)}}}function Q1(u){let r;return{c(){r=Lc("print")},l(s){r=Dc(s,"print")},m(s,g){xi(s,r,g)},d(s){s&&Mt(r)}}}function eb(u){let r;return{c(){r=Lc(u[3])},l(s){r=Dc(s,u[3])},m(s,g){xi(s,r,g)},p(s,g){g&8&&hv(r,s[3])},d(s){s&&Mt(r)}}}function tb(u){let r,s,g,w;return r=new Gf({props:{class:"material-icons","aria-label":"Print",$$slots:{default:[Q1]},$$scope:{ctx:u}}}),g=new Gf({props:{"aria-label":u[4],class:"material-icons",title:u[4],$$slots:{default:[eb]},$$scope:{ctx:u}}}),g.$on("click",u[5]),{c(){pr(r.$$.fragment),s=qo(),pr(g.$$.fragment)},l(z){Rr(r.$$.fragment,z),s=Go(z),Rr(g.$$.fragment,z)},m(z,f){dr(r,z,f),xi(z,s,f),dr(g,z,f),w=!0},p(z,f){const h={};f&256&&(h.$$scope={dirty:f,ctx:z}),r.$set(h);const D={};f&16&&(D["aria-label"]=z[4]),f&16&&(D.title=z[4]),f&264&&(D.$$scope={dirty:f,ctx:z}),g.$set(D)},i(z){w||(ii(r.$$.fragment,z),ii(g.$$.fragment,z),w=!0)},o(z){ui(r.$$.fragment,z),ui(g.$$.fragment,z),w=!1},d(z){fr(r,z),z&&Mt(s),fr(g,z)}}}function ib(u){let r,s,g,w,z,f;return r=new x_({props:{$$slots:{default:[Y1]},$$scope:{ctx:u}}}),z=new x_({props:{align:"end",toolbar:!0,$$slots:{default:[tb]},$$scope:{ctx:u}}}),{c(){pr(r.$$.fragment),s=qo(),g=gr("section"),w=qo(),pr(z.$$.fragment)},l(h){Rr(r.$$.fragment,h),s=Go(h),g=_r(h,"SECTION",{}),Dr(g).forEach(Mt),w=Go(h),Rr(z.$$.fragment,h)},m(h,D){dr(r,h,D),xi(h,s,D),xi(h,g,D),xi(h,w,D),dr(z,h,D),f=!0},p(h,D){const N={};D&257&&(N.$$scope={dirty:D,ctx:h}),r.$set(N);const F={};D&280&&(F.$$scope={dirty:D,ctx:h}),z.$set(F)},i(h){f||(ii(r.$$.fragment,h),ii(z.$$.fragment,h),f=!0)},o(h){ui(r.$$.fragment,h),ui(z.$$.fragment,h),f=!1},d(h){fr(r,h),h&&Mt(s),h&&Mt(g),h&&Mt(w),fr(z,h)}}}function rb(u){let r,s;return r=new T1({props:{$$slots:{default:[ib]},$$scope:{ctx:u}}}),{c(){pr(r.$$.fragment)},l(g){Rr(r.$$.fragment,g)},m(g,w){dr(r,g,w),s=!0},p(g,w){const z={};w&281&&(z.$$scope={dirty:w,ctx:g}),r.$set(z)},i(g){s||(ii(r.$$.fragment,g),s=!0)},o(g){ui(r.$$.fragment,g),s=!1},d(g){fr(r,g)}}}function nb(u){let r,s,g,w,z,f;function h(G,H){return G[1]===void 0?K1:G[1]?X1:W1}let D=h(u),N=D(u),F={variant:"fixed",$$slots:{default:[rb]},$$scope:{ctx:u}};return g=new zx({props:F}),u[7](g),z=new R1({props:{topAppBar:u[2]}}),{c(){N.c(),r=hn(),s=qo(),pr(g.$$.fragment),w=qo(),pr(z.$$.fragment)},l(G){const H=cx('[data-svelte="svelte-7r4yyr"]',document.head);N.l(H),r=hn(),H.forEach(Mt),s=Go(G),Rr(g.$$.fragment,G),w=Go(G),Rr(z.$$.fragment,G)},m(G,H){N.m(document.head,null),fa(document.head,r),xi(G,s,H),dr(g,G,H),xi(G,w,H),dr(z,G,H),f=!0},p(G,[H]){D===(D=h(G))&&N?N.p(G,H):(N.d(1),N=D(G),N&&(N.c(),N.m(r.parentNode,r)));const Pe={};H&281&&(Pe.$$scope={dirty:H,ctx:G}),g.$set(Pe);const ke={};H&4&&(ke.topAppBar=G[2]),z.$set(ke)},i(G){f||(ii(g.$$.fragment,G),ii(z.$$.fragment,G),f=!0)},o(G){ui(g.$$.fragment,G),ui(z.$$.fragment,G),f=!1},d(G){N.d(G),Mt(r),G&&Mt(s),u[7](null),fr(g,G),G&&Mt(w),fr(z,G)}}}function ob(u,r,s){let g,w,{drawerOpen:z=!1}=r,f,h;xh(()=>{s(1,f=window.matchMedia("(prefers-color-scheme: dark)").matches)});const D=()=>s(1,f=!f),N=()=>s(0,z=!z);function F(G){an[G?"unshift":"push"](()=>{h=G,s(2,h)})}return u.$$set=G=>{"drawerOpen"in G&&s(0,z=G.drawerOpen)},u.$$.update=()=>{u.$$.dirty&2&&s(4,g=`switch to ${f?"light":"dark"} mode`),u.$$.dirty&2&&s(3,w=f?"light_mode":"dark_mode")},[z,f,h,w,g,D,N,F]}class ab extends wn{constructor(r){super(),En(this,r,ob,nb,gn,{drawerOpen:0})}}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var hh,Pc,Nr={LIST_ITEM_ACTIVATED_CLASS:"mdc-list-item--activated",LIST_ITEM_CLASS:"mdc-list-item",LIST_ITEM_DISABLED_CLASS:"mdc-list-item--disabled",LIST_ITEM_SELECTED_CLASS:"mdc-list-item--selected",LIST_ITEM_TEXT_CLASS:"mdc-list-item__text",LIST_ITEM_PRIMARY_TEXT_CLASS:"mdc-list-item__primary-text",ROOT:"mdc-list"};hh={},hh[""+Nr.LIST_ITEM_ACTIVATED_CLASS]="mdc-list-item--activated",hh[""+Nr.LIST_ITEM_CLASS]="mdc-list-item",hh[""+Nr.LIST_ITEM_DISABLED_CLASS]="mdc-list-item--disabled",hh[""+Nr.LIST_ITEM_SELECTED_CLASS]="mdc-list-item--selected",hh[""+Nr.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-list-item__primary-text",hh[""+Nr.ROOT]="mdc-list";var zp=(Pc={},Pc[""+Nr.LIST_ITEM_ACTIVATED_CLASS]="mdc-deprecated-list-item--activated",Pc[""+Nr.LIST_ITEM_CLASS]="mdc-deprecated-list-item",Pc[""+Nr.LIST_ITEM_DISABLED_CLASS]="mdc-deprecated-list-item--disabled",Pc[""+Nr.LIST_ITEM_SELECTED_CLASS]="mdc-deprecated-list-item--selected",Pc[""+Nr.LIST_ITEM_TEXT_CLASS]="mdc-deprecated-list-item__text",Pc[""+Nr.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-deprecated-list-item__primary-text",Pc[""+Nr.ROOT]="mdc-deprecated-list",Pc),ph={ACTION_EVENT:"MDCList:action",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",ARIA_INTERACTIVE_ROLES_SELECTOR:'[role="listbox"], [role="menu"]',ARIA_MULTI_SELECTABLE_SELECTOR:'[aria-multiselectable="true"]',CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:`
    .`+Nr.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+Nr.LIST_ITEM_CLASS+` a,
    .`+zp[Nr.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+zp[Nr.LIST_ITEM_CLASS]+` a
  `,DEPRECATED_SELECTOR:".mdc-deprecated-list",FOCUSABLE_CHILD_ELEMENTS:`
    .`+Nr.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+Nr.LIST_ITEM_CLASS+` a,
    .`+Nr.LIST_ITEM_CLASS+` input[type="radio"]:not(:disabled),
    .`+Nr.LIST_ITEM_CLASS+` input[type="checkbox"]:not(:disabled),
    .`+zp[Nr.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+zp[Nr.LIST_ITEM_CLASS]+` a,
    .`+zp[Nr.LIST_ITEM_CLASS]+` input[type="radio"]:not(:disabled),
    .`+zp[Nr.LIST_ITEM_CLASS]+` input[type="checkbox"]:not(:disabled)
  `,RADIO_SELECTOR:'input[type="radio"]',SELECTED_ITEM_SELECTOR:'[aria-selected="true"], [aria-current="true"]'},da={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var sb=["input","button","textarea","select"],Jh=function(u){var r=u.target;if(!!r){var s=(""+r.tagName).toLowerCase();sb.indexOf(s)===-1&&u.preventDefault()}};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function lb(){var u={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""};return u}function ub(u,r){for(var s=new Map,g=0;g<u;g++){var w=r(g).trim();if(!!w){var z=w[0].toLowerCase();s.has(z)||s.set(z,[]),s.get(z).push({text:w.toLowerCase(),index:g})}}return s.forEach(function(f){f.sort(function(h,D){return h.index-D.index})}),s}function Ny(u,r){var s=u.nextChar,g=u.focusItemAtIndex,w=u.sortedIndexByFirstChar,z=u.focusedItemIndex,f=u.skipFocus,h=u.isItemAtIndexDisabled;clearTimeout(r.bufferClearTimeout),r.bufferClearTimeout=setTimeout(function(){vv(r)},da.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),r.typeaheadBuffer=r.typeaheadBuffer+s;var D;return r.typeaheadBuffer.length===1?D=cb(w,z,h,r):D=hb(w,h,r),D!==-1&&!f&&g(D),D}function cb(u,r,s,g){var w=g.typeaheadBuffer[0],z=u.get(w);if(!z)return-1;if(w===g.currentFirstChar&&z[g.sortedIndexCursor].index===r){g.sortedIndexCursor=(g.sortedIndexCursor+1)%z.length;var f=z[g.sortedIndexCursor].index;if(!s(f))return f}g.currentFirstChar=w;var h=-1,D;for(D=0;D<z.length;D++)if(!s(z[D].index)){h=D;break}for(;D<z.length;D++)if(z[D].index>r&&!s(z[D].index)){h=D;break}return h!==-1?(g.sortedIndexCursor=h,z[g.sortedIndexCursor].index):-1}function hb(u,r,s){var g=s.typeaheadBuffer[0],w=u.get(g);if(!w)return-1;var z=w[s.sortedIndexCursor];if(z.text.lastIndexOf(s.typeaheadBuffer,0)===0&&!r(z.index))return z.index;for(var f=(s.sortedIndexCursor+1)%w.length,h=-1;f!==s.sortedIndexCursor;){var D=w[f],N=D.text.lastIndexOf(s.typeaheadBuffer,0)===0,F=!r(D.index);if(N&&F){h=f;break}f=(f+1)%w.length}return h!==-1?(s.sortedIndexCursor=h,w[s.sortedIndexCursor].index):-1}function _v(u){return u.typeaheadBuffer.length>0}function vv(u){u.typeaheadBuffer=""}function I_(u,r){var s=u.event,g=u.isTargetListItem,w=u.focusedItemIndex,z=u.focusItemAtIndex,f=u.sortedIndexByFirstChar,h=u.isItemAtIndexDisabled,D=$a(s)==="ArrowLeft",N=$a(s)==="ArrowUp",F=$a(s)==="ArrowRight",G=$a(s)==="ArrowDown",H=$a(s)==="Home",Pe=$a(s)==="End",ke=$a(s)==="Enter",We=$a(s)==="Spacebar";if(s.ctrlKey||s.metaKey||D||N||F||G||H||Pe||ke)return-1;var je=!We&&s.key.length===1;if(je){Jh(s);var yt={focusItemAtIndex:z,focusedItemIndex:w,nextChar:s.key.toLowerCase(),sortedIndexByFirstChar:f,skipFocus:!1,isItemAtIndexDisabled:h};return Ny(yt,r)}if(!We)return-1;g&&Jh(s);var Ne=g&&_v(r);if(Ne){var yt={focusItemAtIndex:z,focusedItemIndex:w,nextChar:" ",sortedIndexByFirstChar:f,skipFocus:!1,isItemAtIndexDisabled:h};return Ny(yt,r)}return-1}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function pb(u){return u instanceof Array}var db=function(u){bu(r,u);function r(s){var g=u.call(this,Da(Da({},r.defaultAdapter),s))||this;return g.wrapFocus=!1,g.isVertical=!0,g.isSingleSelectionList=!1,g.selectedIndex=da.UNSET_INDEX,g.focusedItemIndex=da.UNSET_INDEX,g.useActivatedClass=!1,g.useSelectedAttr=!1,g.ariaCurrentAttrValue=null,g.isCheckboxList=!1,g.isRadioList=!1,g.hasTypeahead=!1,g.typeaheadState=lb(),g.sortedIndexByFirstChar=new Map,g}return Object.defineProperty(r,"strings",{get:function(){return ph},enumerable:!1,configurable:!0}),Object.defineProperty(r,"cssClasses",{get:function(){return Nr},enumerable:!1,configurable:!0}),Object.defineProperty(r,"numbers",{get:function(){return da},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{addClassForElementIndex:function(){},focusItemAtIndex:function(){},getAttributeForElementIndex:function(){return null},getFocusedElementIndex:function(){return 0},getListItemCount:function(){return 0},hasCheckboxAtIndex:function(){return!1},hasRadioAtIndex:function(){return!1},isCheckboxCheckedAtIndex:function(){return!1},isFocusInsideList:function(){return!1},isRootFocused:function(){return!1},listItemAtIndexHasClass:function(){return!1},notifyAction:function(){},removeClassForElementIndex:function(){},setAttributeForElementIndex:function(){},setCheckedCheckboxOrRadioAtIndex:function(){},setTabIndexForListItemChildren:function(){},getPrimaryTextAtIndex:function(){return""}}},enumerable:!1,configurable:!0}),r.prototype.layout=function(){this.adapter.getListItemCount()!==0&&(this.adapter.hasCheckboxAtIndex(0)?this.isCheckboxList=!0:this.adapter.hasRadioAtIndex(0)?this.isRadioList=!0:this.maybeInitializeSingleSelection(),this.hasTypeahead&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex()))},r.prototype.getFocusedItemIndex=function(){return this.focusedItemIndex},r.prototype.setWrapFocus=function(s){this.wrapFocus=s},r.prototype.setVerticalOrientation=function(s){this.isVertical=s},r.prototype.setSingleSelection=function(s){this.isSingleSelectionList=s,s&&(this.maybeInitializeSingleSelection(),this.selectedIndex=this.getSelectedIndexFromDOM())},r.prototype.maybeInitializeSingleSelection=function(){var s=this.getSelectedIndexFromDOM();if(s!==da.UNSET_INDEX){var g=this.adapter.listItemAtIndexHasClass(s,Nr.LIST_ITEM_ACTIVATED_CLASS);g&&this.setUseActivatedClass(!0),this.isSingleSelectionList=!0,this.selectedIndex=s}},r.prototype.getSelectedIndexFromDOM=function(){for(var s=da.UNSET_INDEX,g=this.adapter.getListItemCount(),w=0;w<g;w++){var z=this.adapter.listItemAtIndexHasClass(w,Nr.LIST_ITEM_SELECTED_CLASS),f=this.adapter.listItemAtIndexHasClass(w,Nr.LIST_ITEM_ACTIVATED_CLASS);if(!!(z||f)){s=w;break}}return s},r.prototype.setHasTypeahead=function(s){this.hasTypeahead=s,s&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex())},r.prototype.isTypeaheadInProgress=function(){return this.hasTypeahead&&_v(this.typeaheadState)},r.prototype.setUseActivatedClass=function(s){this.useActivatedClass=s},r.prototype.setUseSelectedAttribute=function(s){this.useSelectedAttr=s},r.prototype.getSelectedIndex=function(){return this.selectedIndex},r.prototype.setSelectedIndex=function(s,g){var w=g===void 0?{}:g,z=w.forceUpdate;!this.isIndexValid(s)||(this.isCheckboxList?this.setCheckboxAtIndex(s):this.isRadioList?this.setRadioAtIndex(s):this.setSingleSelectionAtIndex(s,{forceUpdate:z}))},r.prototype.handleFocusIn=function(s){s>=0&&(this.focusedItemIndex=s,this.adapter.setAttributeForElementIndex(s,"tabindex","0"),this.adapter.setTabIndexForListItemChildren(s,"0"))},r.prototype.handleFocusOut=function(s){var g=this;s>=0&&(this.adapter.setAttributeForElementIndex(s,"tabindex","-1"),this.adapter.setTabIndexForListItemChildren(s,"-1")),setTimeout(function(){g.adapter.isFocusInsideList()||g.setTabindexToFirstSelectedOrFocusedItem()},0)},r.prototype.handleKeydown=function(s,g,w){var z=this,f=$a(s)==="ArrowLeft",h=$a(s)==="ArrowUp",D=$a(s)==="ArrowRight",N=$a(s)==="ArrowDown",F=$a(s)==="Home",G=$a(s)==="End",H=$a(s)==="Enter",Pe=$a(s)==="Spacebar",ke=s.key==="A"||s.key==="a";if(this.adapter.isRootFocused()){if(h||G?(s.preventDefault(),this.focusLastElement()):(N||F)&&(s.preventDefault(),this.focusFirstElement()),this.hasTypeahead){var We={event:s,focusItemAtIndex:function(Ne){z.focusItemAtIndex(Ne)},focusedItemIndex:-1,isTargetListItem:g,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(Ne){return z.adapter.listItemAtIndexHasClass(Ne,Nr.LIST_ITEM_DISABLED_CLASS)}};I_(We,this.typeaheadState)}return}var je=this.adapter.getFocusedElementIndex();if(!(je===-1&&(je=w,je<0))){if(this.isVertical&&N||!this.isVertical&&D)Jh(s),this.focusNextElement(je);else if(this.isVertical&&h||!this.isVertical&&f)Jh(s),this.focusPrevElement(je);else if(F)Jh(s),this.focusFirstElement();else if(G)Jh(s),this.focusLastElement();else if(ke&&s.ctrlKey&&this.isCheckboxList)s.preventDefault(),this.toggleAll(this.selectedIndex===da.UNSET_INDEX?[]:this.selectedIndex);else if((H||Pe)&&g){var yt=s.target;if(yt&&yt.tagName==="A"&&H||(Jh(s),this.adapter.listItemAtIndexHasClass(je,Nr.LIST_ITEM_DISABLED_CLASS)))return;this.isTypeaheadInProgress()||(this.isSelectableList()&&this.setSelectedIndexOnAction(je),this.adapter.notifyAction(je))}if(this.hasTypeahead){var We={event:s,focusItemAtIndex:function(Ze){z.focusItemAtIndex(Ze)},focusedItemIndex:this.focusedItemIndex,isTargetListItem:g,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(Ze){return z.adapter.listItemAtIndexHasClass(Ze,Nr.LIST_ITEM_DISABLED_CLASS)}};I_(We,this.typeaheadState)}}},r.prototype.handleClick=function(s,g){s!==da.UNSET_INDEX&&(this.adapter.listItemAtIndexHasClass(s,Nr.LIST_ITEM_DISABLED_CLASS)||(this.isSelectableList()&&this.setSelectedIndexOnAction(s,g),this.adapter.notifyAction(s)))},r.prototype.focusNextElement=function(s){var g=this.adapter.getListItemCount(),w=s+1;if(w>=g)if(this.wrapFocus)w=0;else return s;return this.focusItemAtIndex(w),w},r.prototype.focusPrevElement=function(s){var g=s-1;if(g<0)if(this.wrapFocus)g=this.adapter.getListItemCount()-1;else return s;return this.focusItemAtIndex(g),g},r.prototype.focusFirstElement=function(){return this.focusItemAtIndex(0),0},r.prototype.focusLastElement=function(){var s=this.adapter.getListItemCount()-1;return this.focusItemAtIndex(s),s},r.prototype.focusInitialElement=function(){var s=this.getFirstSelectedOrFocusedItemIndex();return this.focusItemAtIndex(s),s},r.prototype.setEnabled=function(s,g){!this.isIndexValid(s)||(g?(this.adapter.removeClassForElementIndex(s,Nr.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(s,ph.ARIA_DISABLED,"false")):(this.adapter.addClassForElementIndex(s,Nr.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(s,ph.ARIA_DISABLED,"true")))},r.prototype.setSingleSelectionAtIndex=function(s,g){var w=g===void 0?{}:g,z=w.forceUpdate;if(!(this.selectedIndex===s&&!z)){var f=Nr.LIST_ITEM_SELECTED_CLASS;this.useActivatedClass&&(f=Nr.LIST_ITEM_ACTIVATED_CLASS),this.selectedIndex!==da.UNSET_INDEX&&this.adapter.removeClassForElementIndex(this.selectedIndex,f),this.setAriaForSingleSelectionAtIndex(s),this.setTabindexAtIndex(s),s!==da.UNSET_INDEX&&this.adapter.addClassForElementIndex(s,f),this.selectedIndex=s}},r.prototype.setAriaForSingleSelectionAtIndex=function(s){this.selectedIndex===da.UNSET_INDEX&&(this.ariaCurrentAttrValue=this.adapter.getAttributeForElementIndex(s,ph.ARIA_CURRENT));var g=this.ariaCurrentAttrValue!==null,w=g?ph.ARIA_CURRENT:ph.ARIA_SELECTED;if(this.selectedIndex!==da.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,w,"false"),s!==da.UNSET_INDEX){var z=g?this.ariaCurrentAttrValue:"true";this.adapter.setAttributeForElementIndex(s,w,z)}},r.prototype.getSelectionAttribute=function(){return this.useSelectedAttr?ph.ARIA_SELECTED:ph.ARIA_CHECKED},r.prototype.setRadioAtIndex=function(s){var g=this.getSelectionAttribute();this.adapter.setCheckedCheckboxOrRadioAtIndex(s,!0),this.selectedIndex!==da.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,g,"false"),this.adapter.setAttributeForElementIndex(s,g,"true"),this.selectedIndex=s},r.prototype.setCheckboxAtIndex=function(s){for(var g=this.getSelectionAttribute(),w=0;w<this.adapter.getListItemCount();w++){var z=!1;s.indexOf(w)>=0&&(z=!0),this.adapter.setCheckedCheckboxOrRadioAtIndex(w,z),this.adapter.setAttributeForElementIndex(w,g,z?"true":"false")}this.selectedIndex=s},r.prototype.setTabindexAtIndex=function(s){this.focusedItemIndex===da.UNSET_INDEX&&s!==0?this.adapter.setAttributeForElementIndex(0,"tabindex","-1"):this.focusedItemIndex>=0&&this.focusedItemIndex!==s&&this.adapter.setAttributeForElementIndex(this.focusedItemIndex,"tabindex","-1"),!(this.selectedIndex instanceof Array)&&this.selectedIndex!==s&&this.adapter.setAttributeForElementIndex(this.selectedIndex,"tabindex","-1"),s!==da.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(s,"tabindex","0")},r.prototype.isSelectableList=function(){return this.isSingleSelectionList||this.isCheckboxList||this.isRadioList},r.prototype.setTabindexToFirstSelectedOrFocusedItem=function(){var s=this.getFirstSelectedOrFocusedItemIndex();this.setTabindexAtIndex(s)},r.prototype.getFirstSelectedOrFocusedItemIndex=function(){return this.isSelectableList()?typeof this.selectedIndex=="number"&&this.selectedIndex!==da.UNSET_INDEX?this.selectedIndex:pb(this.selectedIndex)&&this.selectedIndex.length>0?this.selectedIndex.reduce(function(s,g){return Math.min(s,g)}):0:Math.max(this.focusedItemIndex,0)},r.prototype.isIndexValid=function(s){var g=this;if(s instanceof Array){if(!this.isCheckboxList)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");return s.length===0?!0:s.some(function(w){return g.isIndexInRange(w)})}else if(typeof s=="number"){if(this.isCheckboxList)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+s);return this.isIndexInRange(s)||this.isSingleSelectionList&&s===da.UNSET_INDEX}else return!1},r.prototype.isIndexInRange=function(s){var g=this.adapter.getListItemCount();return s>=0&&s<g},r.prototype.setSelectedIndexOnAction=function(s,g){g===void 0&&(g=!0),this.isCheckboxList?this.toggleCheckboxAtIndex(s,g):this.setSelectedIndex(s)},r.prototype.toggleCheckboxAtIndex=function(s,g){var w=this.getSelectionAttribute(),z=this.adapter.isCheckboxCheckedAtIndex(s);g&&(z=!z,this.adapter.setCheckedCheckboxOrRadioAtIndex(s,z)),this.adapter.setAttributeForElementIndex(s,w,z?"true":"false");var f=this.selectedIndex===da.UNSET_INDEX?[]:this.selectedIndex.slice();z?f.push(s):f=f.filter(function(h){return h!==s}),this.selectedIndex=f},r.prototype.focusItemAtIndex=function(s){this.adapter.focusItemAtIndex(s),this.focusedItemIndex=s},r.prototype.toggleAll=function(s){var g=this.adapter.getListItemCount();if(s.length===g)this.setCheckboxAtIndex([]);else{for(var w=[],z=0;z<g;z++)(!this.adapter.listItemAtIndexHasClass(z,Nr.LIST_ITEM_DISABLED_CLASS)||s.indexOf(z)>-1)&&w.push(z);this.setCheckboxAtIndex(w)}},r.prototype.typeaheadMatchItem=function(s,g,w){var z=this;w===void 0&&(w=!1);var f={focusItemAtIndex:function(h){z.focusItemAtIndex(h)},focusedItemIndex:g||this.focusedItemIndex,nextChar:s,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:w,isItemAtIndexDisabled:function(h){return z.adapter.listItemAtIndexHasClass(h,Nr.LIST_ITEM_DISABLED_CLASS)}};return Ny(f,this.typeaheadState)},r.prototype.typeaheadInitSortedIndex=function(){return ub(this.adapter.getListItemCount(),this.adapter.getPrimaryTextAtIndex)},r.prototype.clearTypeaheadBuffer=function(){vv(this.typeaheadState)},r}(tp);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Us={ANIMATE:"mdc-drawer--animate",CLOSING:"mdc-drawer--closing",DISMISSIBLE:"mdc-drawer--dismissible",MODAL:"mdc-drawer--modal",OPEN:"mdc-drawer--open",OPENING:"mdc-drawer--opening",ROOT:"mdc-drawer"},fb={APP_CONTENT_SELECTOR:".mdc-drawer-app-content",CLOSE_EVENT:"MDCDrawer:closed",OPEN_EVENT:"MDCDrawer:opened",SCRIM_SELECTOR:".mdc-drawer-scrim",LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",LIST_ITEM_ACTIVATED_SELECTOR:".mdc-list-item--activated,.mdc-deprecated-list-item--activated"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var xv=function(u){bu(r,u);function r(s){var g=u.call(this,Da(Da({},r.defaultAdapter),s))||this;return g.animationFrame=0,g.animationTimer=0,g}return Object.defineProperty(r,"strings",{get:function(){return fb},enumerable:!1,configurable:!0}),Object.defineProperty(r,"cssClasses",{get:function(){return Us},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},elementHasClass:function(){return!1},notifyClose:function(){},notifyOpen:function(){},saveFocus:function(){},restoreFocus:function(){},focusActiveNavigationItem:function(){},trapFocus:function(){},releaseFocus:function(){}}},enumerable:!1,configurable:!0}),r.prototype.destroy=function(){this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.animationTimer&&clearTimeout(this.animationTimer)},r.prototype.open=function(){var s=this;this.isOpen()||this.isOpening()||this.isClosing()||(this.adapter.addClass(Us.OPEN),this.adapter.addClass(Us.ANIMATE),this.runNextAnimationFrame(function(){s.adapter.addClass(Us.OPENING)}),this.adapter.saveFocus())},r.prototype.close=function(){!this.isOpen()||this.isOpening()||this.isClosing()||this.adapter.addClass(Us.CLOSING)},r.prototype.isOpen=function(){return this.adapter.hasClass(Us.OPEN)},r.prototype.isOpening=function(){return this.adapter.hasClass(Us.OPENING)||this.adapter.hasClass(Us.ANIMATE)},r.prototype.isClosing=function(){return this.adapter.hasClass(Us.CLOSING)},r.prototype.handleKeydown=function(s){var g=s.keyCode,w=s.key,z=w==="Escape"||g===27;z&&this.close()},r.prototype.handleTransitionEnd=function(s){var g=Us.OPENING,w=Us.CLOSING,z=Us.OPEN,f=Us.ANIMATE,h=Us.ROOT,D=this.isElement(s.target)&&this.adapter.elementHasClass(s.target,h);!D||(this.isClosing()?(this.adapter.removeClass(z),this.closed(),this.adapter.restoreFocus(),this.adapter.notifyClose()):(this.adapter.focusActiveNavigationItem(),this.opened(),this.adapter.notifyOpen()),this.adapter.removeClass(f),this.adapter.removeClass(g),this.adapter.removeClass(w))},r.prototype.opened=function(){},r.prototype.closed=function(){},r.prototype.runNextAnimationFrame=function(s){var g=this;cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(function(){g.animationFrame=0,clearTimeout(g.animationTimer),g.animationTimer=setTimeout(s,0)})},r.prototype.isElement=function(s){return Boolean(s.classList)},r}(tp);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var mb=function(u){bu(r,u);function r(){return u!==null&&u.apply(this,arguments)||this}return r.prototype.handleScrimClick=function(){this.close()},r.prototype.opened=function(){this.adapter.trapFocus()},r.prototype.closed=function(){this.adapter.releaseFocus()},r}(xv);function yb(u){let r,s,g,w,z,f;const h=u[15].default,D=ao(h,u,u[14],null);let N=[{class:s=_o(ll({[u[1]]:!0,"mdc-drawer":!0,"mdc-drawer--dismissible":u[2]==="dismissible","mdc-drawer--modal":u[2]==="modal","smui-drawer__absolute":u[2]==="modal"&&!u[3]},u[6]))},u[8]],F={};for(let G=0;G<N.length;G+=1)F=wi(F,N[G]);return{c(){r=gr("aside"),D&&D.c(),this.h()},l(G){r=_r(G,"ASIDE",{class:!0});var H=Dr(r);D&&D.l(H),H.forEach(Mt),this.h()},h(){Wr(r,F)},m(G,H){xi(G,r,H),D&&D.m(r,null),u[16](r),w=!0,z||(f=[Vr(g=ra.call(null,r,u[0])),Vr(u[7].call(null,r)),ul(r,"keydown",u[17]),ul(r,"transitionend",u[18])],z=!0)},p(G,[H]){D&&D.p&&(!w||H&16384)&&so(D,h,G,G[14],w?uo(h,G[14],H,null):lo(G[14]),null),Wr(r,F=Gn(N,[(!w||H&78&&s!==(s=_o(ll({[G[1]]:!0,"mdc-drawer":!0,"mdc-drawer--dismissible":G[2]==="dismissible","mdc-drawer--modal":G[2]==="modal","smui-drawer__absolute":G[2]==="modal"&&!G[3]},G[6]))))&&{class:s},H&256&&G[8]])),g&&Vo(g.update)&&H&1&&g.update.call(null,G[0])},i(G){w||(ii(D,G),w=!0)},o(G){ui(D,G),w=!1},d(G){G&&Mt(r),D&&D.d(G),u[16](null),z=!1,Sa(f)}}}function gb(u,r,s){const g=["use","class","variant","open","fixed","setOpen","isOpen","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r;const{FocusTrap:h}=F1,D=wo(xo());let{use:N=[]}=r,{class:F=""}=r,{variant:G=void 0}=r,{open:H=!1}=r,{fixed:Pe=!0}=r,ke,We,je={},yt=null,Ne,Ze=!1;Ia("SMUI:list:nav",!0),Ia("SMUI:list:item:nav",!0),Ia("SMUI:list:wrapFocus",!0);let vt=G;xh(()=>{Ne=new h(ke,{skipInitialFocus:!0}),s(4,We=ct()),We&&We.init()}),Ud(()=>{We&&We.destroy(),Ze&&Ze.removeEventListener("SMUIDrawerScrim:click",Et)});function ct(){var bt,Gi;Ze&&Ze.removeEventListener("SMUIDrawerScrim:click",Et),G==="modal"&&(Ze=(Gi=(bt=ke.parentNode)===null||bt===void 0?void 0:bt.querySelector(".mdc-drawer-scrim"))!==null&&Gi!==void 0?Gi:!1,Ze&&Ze.addEventListener("SMUIDrawerScrim:click",Et));const mr=G==="dismissible"?xv:G==="modal"?mb:void 0;return mr?new mr({addClass:lt,removeClass:fi,hasClass:pt,elementHasClass:(Ar,Rt)=>Ar.classList.contains(Rt),saveFocus:()=>yt=document.activeElement,restoreFocus:()=>{yt&&"focus"in yt&&ke.contains(document.activeElement)&&yt.focus()},focusActiveNavigationItem:()=>{const Ar=ke.querySelector(".mdc-list-item--activated,.mdc-deprecated-list-item--activated");Ar&&Ar.focus()},notifyClose:()=>{s(9,H=!1),Ns(ke,"SMUIDrawer:closed",void 0,void 0,!0)},notifyOpen:()=>{s(9,H=!0),Ns(ke,"SMUIDrawer:opened",void 0,void 0,!0)},trapFocus:()=>Ne.trapFocus(),releaseFocus:()=>Ne.releaseFocus()}):void 0}function pt(bt){return bt in je?je[bt]:qi().classList.contains(bt)}function lt(bt){je[bt]||s(6,je[bt]=!0,je)}function fi(bt){(!(bt in je)||je[bt])&&s(6,je[bt]=!1,je)}function Et(){We&&"handleScrimClick"in We&&We.handleScrimClick()}function Wt(bt){s(9,H=bt)}function Ei(){return H}function qi(){return ke}function Xt(bt){an[bt?"unshift":"push"](()=>{ke=bt,s(5,ke)})}const Qt=bt=>We&&We.handleKeydown(bt),Ai=bt=>We&&We.handleTransitionEnd(bt);return u.$$set=bt=>{r=wi(wi({},r),bo(bt)),s(8,w=lr(r,g)),"use"in bt&&s(0,N=bt.use),"class"in bt&&s(1,F=bt.class),"variant"in bt&&s(2,G=bt.variant),"open"in bt&&s(9,H=bt.open),"fixed"in bt&&s(3,Pe=bt.fixed),"$$scope"in bt&&s(14,f=bt.$$scope)},u.$$.update=()=>{u.$$.dirty&8212&&vt!==G&&(s(13,vt=G),We&&We.destroy(),s(6,je={}),s(4,We=ct()),We&&We.init()),u.$$.dirty&528&&We&&We.isOpen()!==H&&(H?We.open():We.close())},[N,F,G,Pe,We,ke,je,D,w,H,Wt,Ei,qi,vt,f,z,Xt,Qt,Ai]}class _b extends wn{constructor(r){super(),En(this,r,gb,yb,gn,{use:0,class:1,variant:2,open:9,fixed:3,setOpen:10,isOpen:11,getElement:12})}get setOpen(){return this.$$.ctx[10]}get isOpen(){return this.$$.ctx[11]}get getElement(){return this.$$.ctx[12]}}var vb=dl({class:"mdc-drawer-app-content",component:Nd}),xb=dl({class:"mdc-drawer__content",component:Nd}),bb=dl({class:"mdc-drawer__header",component:Nd});dl({class:"mdc-drawer__title",component:v1});dl({class:"mdc-drawer__subtitle",component:x1});function wb(u){let r;const s=u[37].default,g=ao(s,u,u[43],null);return{c(){g&&g.c()},l(w){g&&g.l(w)},m(w,z){g&&g.m(w,z),r=!0},p(w,z){g&&g.p&&(!r||z[1]&4096)&&so(g,s,w,w[43],r?uo(s,w[43],z,null):lo(w[43]),null)},i(w){r||(ii(g,w),r=!0)},o(w){ui(g,w),r=!1},d(w){g&&g.d(w)}}}function Eb(u){let r,s,g;const w=[{use:[u[17],...u[0]]},{class:_o({[u[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":u[2],"mdc-deprecated-list--dense":u[3],"mdc-deprecated-list--textual-list":u[4],"mdc-deprecated-list--avatar-list":u[5]||u[18],"mdc-deprecated-list--icon-list":u[6],"mdc-deprecated-list--image-list":u[7],"mdc-deprecated-list--thumbnail-list":u[8],"mdc-deprecated-list--video-list":u[9],"mdc-deprecated-list--two-line":u[10],"smui-list--three-line":u[11]&&!u[10]})},{role:u[15]},u[23]];var z=u[12];function f(h){let D={$$slots:{default:[wb]},$$scope:{ctx:h}};for(let N=0;N<w.length;N+=1)D=wi(D,w[N]);return{props:D}}return z&&(r=new z(f(u)),u[38](r),r.$on("keydown",u[39]),r.$on("focusin",u[40]),r.$on("focusout",u[41]),r.$on("click",u[42]),r.$on("SMUIListItem:mount",u[19]),r.$on("SMUIListItem:unmount",u[20]),r.$on("SMUI:action",u[21])),{c(){r&&pr(r.$$.fragment),s=hn()},l(h){r&&Rr(r.$$.fragment,h),s=hn()},m(h,D){r&&dr(r,h,D),xi(h,s,D),g=!0},p(h,D){const N=D[0]&8818687?Gn(w,[D[0]&131073&&{use:[h[17],...h[0]]},D[0]&266238&&{class:_o({[h[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":h[2],"mdc-deprecated-list--dense":h[3],"mdc-deprecated-list--textual-list":h[4],"mdc-deprecated-list--avatar-list":h[5]||h[18],"mdc-deprecated-list--icon-list":h[6],"mdc-deprecated-list--image-list":h[7],"mdc-deprecated-list--thumbnail-list":h[8],"mdc-deprecated-list--video-list":h[9],"mdc-deprecated-list--two-line":h[10],"smui-list--three-line":h[11]&&!h[10]})},D[0]&32768&&{role:h[15]},D[0]&8388608&&Ya(h[23])]):{};if(D[1]&4096&&(N.$$scope={dirty:D,ctx:h}),z!==(z=h[12])){if(r){pl();const F=r;ui(F.$$.fragment,1,0,()=>{fr(F,1)}),hl()}z?(r=new z(f(h)),h[38](r),r.$on("keydown",h[39]),r.$on("focusin",h[40]),r.$on("focusout",h[41]),r.$on("click",h[42]),r.$on("SMUIListItem:mount",h[19]),r.$on("SMUIListItem:unmount",h[20]),r.$on("SMUI:action",h[21]),pr(r.$$.fragment),ii(r.$$.fragment,1),dr(r,s.parentNode,s)):r=null}else z&&r.$set(N)},i(h){g||(r&&ii(r.$$.fragment,h),g=!0)},o(h){r&&ui(r.$$.fragment,h),g=!1},d(h){u[38](null),h&&Mt(s),r&&fr(r,h)}}}function Ib(u,r,s){const g=["use","class","nonInteractive","dense","textualList","avatarList","iconList","imageList","thumbnailList","videoList","twoLine","threeLine","vertical","wrapFocus","singleSelection","selectedIndex","radioList","checkList","hasTypeahead","component","layout","setEnabled","getTypeaheadInProgress","getSelectedIndex","getFocusedItemIndex","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r;var h;const{closest:D,matches:N}=fv,F=wo(xo());let{use:G=[]}=r,{class:H=""}=r,{nonInteractive:Pe=!1}=r,{dense:ke=!1}=r,{textualList:We=!1}=r,{avatarList:je=!1}=r,{iconList:yt=!1}=r,{imageList:Ne=!1}=r,{thumbnailList:Ze=!1}=r,{videoList:vt=!1}=r,{twoLine:ct=!1}=r,{threeLine:pt=!1}=r,{vertical:lt=!0}=r,{wrapFocus:fi=(h=Qa("SMUI:list:wrapFocus"))!==null&&h!==void 0?h:!1}=r,{singleSelection:Et=!1}=r,{selectedIndex:Wt=-1}=r,{radioList:Ei=!1}=r,{checkList:qi=!1}=r,{hasTypeahead:Xt=!1}=r,Qt,Ai,bt=[],Gi=Qa("SMUI:list:role"),mr=Qa("SMUI:list:nav");const Ar=new WeakMap;let Rt=Qa("SMUI:dialog:selection"),ai=Qa("SMUI:addLayoutListener"),yi,{component:Fi=mr?I1:S1}=r;Ia("SMUI:list:nonInteractive",Pe),Ia("SMUI:separator:context","list"),Gi||(Et?(Gi="listbox",Ia("SMUI:list:item:role","option")):Ei?(Gi="radiogroup",Ia("SMUI:list:item:role","radio")):qi?(Gi="group",Ia("SMUI:list:item:role","checkbox")):(Gi="list",Ia("SMUI:list:item:role",void 0))),ai&&(yi=ai(co)),xh(()=>{s(13,Ai=new db({addClassForElementIndex:zt,focusItemAtIndex:rr,getAttributeForElementIndex:(gt,Si)=>{var yr,br;return(br=(yr=Ii()[gt])===null||yr===void 0?void 0:yr.getAttr(Si))!==null&&br!==void 0?br:null},getFocusedElementIndex:()=>document.activeElement?Ii().map(gt=>gt.element).indexOf(document.activeElement):-1,getListItemCount:()=>bt.length,getPrimaryTextAtIndex:ir,hasCheckboxAtIndex:gt=>{var Si,yr;return(yr=(Si=Ii()[gt])===null||Si===void 0?void 0:Si.hasCheckbox)!==null&&yr!==void 0?yr:!1},hasRadioAtIndex:gt=>{var Si,yr;return(yr=(Si=Ii()[gt])===null||Si===void 0?void 0:Si.hasRadio)!==null&&yr!==void 0?yr:!1},isCheckboxCheckedAtIndex:gt=>{var Si;const yr=Ii()[gt];return(Si=(yr==null?void 0:yr.hasCheckbox)&&yr.checked)!==null&&Si!==void 0?Si:!1},isFocusInsideList:()=>Qt!=null&&Hn()!==document.activeElement&&Hn().contains(document.activeElement),isRootFocused:()=>Qt!=null&&document.activeElement===Hn(),listItemAtIndexHasClass:zi,notifyAction:gt=>{s(24,Wt=gt),Qt!=null&&Ns(Hn(),"SMUIList:action",{index:gt},void 0,!0)},removeClassForElementIndex:tr,setAttributeForElementIndex:Bt,setCheckedCheckboxOrRadioAtIndex:(gt,Si)=>{Ii()[gt].checked=Si},setTabIndexForListItemChildren:(gt,Si)=>{const yr=Ii()[gt],br="button:not(:disabled), a";Array.prototype.forEach.call(yr.element.querySelectorAll(br),Xn=>{Xn.setAttribute("tabindex",Si)})}}));const Ue={get element(){return Hn()},get items(){return bt},get typeaheadInProgress(){return Ai.isTypeaheadInProgress()},typeaheadMatchItem(gt,Si){return Ai.typeaheadMatchItem(gt,Si,!0)},getOrderedList:Ii,focusItemAtIndex:rr,addClassForElementIndex:zt,removeClassForElementIndex:tr,setAttributeForElementIndex:Bt,removeAttributeForElementIndex:rt,getAttributeFromElementIndex:_i,getPrimaryTextAtIndex:ir};return Ns(Hn(),"SMUIList:mount",Ue),Ai.init(),()=>{Ai.destroy()}}),Ud(()=>{yi&&yi()});function jt(Ue){bt.push(Ue.detail),Ar.set(Ue.detail.element,Ue.detail),Et&&Ue.detail.selected&&s(24,Wt=Pr(Ue.detail.element)),Ue.stopPropagation()}function Xi(Ue){var gt;const Si=(gt=Ue.detail&&bt.indexOf(Ue.detail))!==null&&gt!==void 0?gt:-1;Si!==-1&&(bt.splice(Si,1),bt=bt,Ar.delete(Ue.detail.element)),Ue.stopPropagation()}function Ri(Ue){if(Ei||qi){const gt=Pr(Ue.target);if(gt!==-1){const Si=Ii()[gt];Si&&(Ei&&!Si.checked||qi)&&(Si.checked=!Si.checked,Si.activateRipple(),window.requestAnimationFrame(()=>{Si.deactivateRipple()}))}}}function Ii(){return Qt==null?[]:[...Hn().children].map(Ue=>Ar.get(Ue)).filter(Ue=>Ue&&Ue._smui_list_item_accessor)}function rr(Ue){const gt=Ii()[Ue];gt&&"focus"in gt.element&&gt.element.focus()}function zi(Ue,gt){var Si;const yr=Ii()[Ue];return(Si=yr&&yr.hasClass(gt))!==null&&Si!==void 0?Si:!1}function zt(Ue,gt){const Si=Ii()[Ue];Si&&Si.addClass(gt)}function tr(Ue,gt){const Si=Ii()[Ue];Si&&Si.removeClass(gt)}function Bt(Ue,gt,Si){const yr=Ii()[Ue];yr&&yr.addAttr(gt,Si)}function rt(Ue,gt){const Si=Ii()[Ue];Si&&Si.removeAttr(gt)}function _i(Ue,gt){const Si=Ii()[Ue];return Si?Si.getAttr(gt):null}function ir(Ue){var gt;const Si=Ii()[Ue];return(gt=Si&&Si.getPrimaryText())!==null&&gt!==void 0?gt:""}function Pr(Ue){const gt=D(Ue,".mdc-deprecated-list-item, .mdc-deprecated-list");return gt&&N(gt,".mdc-deprecated-list-item")?Ii().map(Si=>Si==null?void 0:Si.element).indexOf(gt):-1}function co(){return Ai.layout()}function Zn(Ue,gt){return Ai.setEnabled(Ue,gt)}function Bo(){return Ai.isTypeaheadInProgress()}function _n(){return Ai.getSelectedIndex()}function ho(){return Ai.getFocusedItemIndex()}function Hn(){return Qt.getElement()}function Zi(Ue){an[Ue?"unshift":"push"](()=>{Qt=Ue,s(14,Qt)})}const Un=Ue=>Ai&&Ai.handleKeydown(Ue,Ue.target.classList.contains("mdc-deprecated-list-item"),Pr(Ue.target)),Ao=Ue=>Ai&&Ai.handleFocusIn(Pr(Ue.target)),Wn=Ue=>Ai&&Ai.handleFocusOut(Pr(Ue.target)),Ba=Ue=>Ai&&Ai.handleClick(Pr(Ue.target),!N(Ue.target,'input[type="checkbox"], input[type="radio"]'));return u.$$set=Ue=>{r=wi(wi({},r),bo(Ue)),s(23,w=lr(r,g)),"use"in Ue&&s(0,G=Ue.use),"class"in Ue&&s(1,H=Ue.class),"nonInteractive"in Ue&&s(2,Pe=Ue.nonInteractive),"dense"in Ue&&s(3,ke=Ue.dense),"textualList"in Ue&&s(4,We=Ue.textualList),"avatarList"in Ue&&s(5,je=Ue.avatarList),"iconList"in Ue&&s(6,yt=Ue.iconList),"imageList"in Ue&&s(7,Ne=Ue.imageList),"thumbnailList"in Ue&&s(8,Ze=Ue.thumbnailList),"videoList"in Ue&&s(9,vt=Ue.videoList),"twoLine"in Ue&&s(10,ct=Ue.twoLine),"threeLine"in Ue&&s(11,pt=Ue.threeLine),"vertical"in Ue&&s(25,lt=Ue.vertical),"wrapFocus"in Ue&&s(26,fi=Ue.wrapFocus),"singleSelection"in Ue&&s(27,Et=Ue.singleSelection),"selectedIndex"in Ue&&s(24,Wt=Ue.selectedIndex),"radioList"in Ue&&s(28,Ei=Ue.radioList),"checkList"in Ue&&s(29,qi=Ue.checkList),"hasTypeahead"in Ue&&s(30,Xt=Ue.hasTypeahead),"component"in Ue&&s(12,Fi=Ue.component),"$$scope"in Ue&&s(43,f=Ue.$$scope)},u.$$.update=()=>{u.$$.dirty[0]&33562624&&Ai&&Ai.setVerticalOrientation(lt),u.$$.dirty[0]&67117056&&Ai&&Ai.setWrapFocus(fi),u.$$.dirty[0]&1073750016&&Ai&&Ai.setHasTypeahead(Xt),u.$$.dirty[0]&134225920&&Ai&&Ai.setSingleSelection(Et),u.$$.dirty[0]&151003136&&Ai&&Et&&_n()!==Wt&&Ai.setSelectedIndex(Wt)},[G,H,Pe,ke,We,je,yt,Ne,Ze,vt,ct,pt,Fi,Ai,Qt,Gi,N,F,Rt,jt,Xi,Ri,Pr,w,Wt,lt,fi,Et,Ei,qi,Xt,co,Zn,Bo,_n,ho,Hn,z,Zi,Un,Ao,Wn,Ba,f]}class Sb extends wn{constructor(r){super(),En(this,r,Ib,Eb,gn,{use:0,class:1,nonInteractive:2,dense:3,textualList:4,avatarList:5,iconList:6,imageList:7,thumbnailList:8,videoList:9,twoLine:10,threeLine:11,vertical:25,wrapFocus:26,singleSelection:27,selectedIndex:24,radioList:28,checkList:29,hasTypeahead:30,component:12,layout:31,setEnabled:32,getTypeaheadInProgress:33,getSelectedIndex:34,getFocusedItemIndex:35,getElement:36},null,[-1,-1])}get layout(){return this.$$.ctx[31]}get setEnabled(){return this.$$.ctx[32]}get getTypeaheadInProgress(){return this.$$.ctx[33]}get getSelectedIndex(){return this.$$.ctx[34]}get getFocusedItemIndex(){return this.$$.ctx[35]}get getElement(){return this.$$.ctx[36]}}function S_(u){let r;return{c(){r=gr("span"),this.h()},l(s){r=_r(s,"SPAN",{class:!0}),Dr(r).forEach(Mt),this.h()},h(){jr(r,"class","mdc-deprecated-list-item__ripple")},m(s,g){xi(s,r,g)},d(s){s&&Mt(r)}}}function Tb(u){let r,s,g=u[7]&&S_();const w=u[32].default,z=ao(w,u,u[35],null);return{c(){g&&g.c(),r=hn(),z&&z.c()},l(f){g&&g.l(f),r=hn(),z&&z.l(f)},m(f,h){g&&g.m(f,h),xi(f,r,h),z&&z.m(f,h),s=!0},p(f,h){f[7]?g||(g=S_(),g.c(),g.m(r.parentNode,r)):g&&(g.d(1),g=null),z&&z.p&&(!s||h[1]&16)&&so(z,w,f,f[35],s?uo(w,f[35],h,null):lo(f[35]),null)},i(f){s||(ii(z,f),s=!0)},o(f){ui(z,f),s=!1},d(f){g&&g.d(f),f&&Mt(r),z&&z.d(f)}}}function Ab(u){let r,s,g;const w=[{use:[...u[6]?[]:[[Dd,{ripple:!u[14],unbounded:!1,color:(u[1]||u[0])&&u[5]==null?"primary":u[5],disabled:u[9],addClass:u[22],removeClass:u[23],addStyle:u[24]}]],u[20],...u[2]]},{class:_o(ll({[u[3]]:!0,"mdc-deprecated-list-item":!0,"mdc-deprecated-list-item--activated":u[1],"mdc-deprecated-list-item--selected":u[0],"mdc-deprecated-list-item--disabled":u[9],"mdc-menu-item--selected":!u[21]&&u[8]==="menuitem"&&u[0],"smui-menu-item--non-interactive":u[6]},u[16]))},{style:Object.entries(u[17]).map(T_).concat([u[4]]).join(" ")},u[21]&&u[1]?{"aria-current":"page"}:{},u[21]?{}:{role:u[8]},!u[21]&&u[8]==="option"?{"aria-selected":u[0]?"true":"false"}:{},!u[21]&&(u[8]==="radio"||u[8]==="checkbox")?{"aria-checked":u[14]&&u[14].checked?"true":"false"}:{},u[21]?{}:{"aria-disabled":u[9]?"true":"false"},{"data-menu-item-skip-restore-focus":u[10]||void 0},{tabindex:u[19]},{href:u[11]},u[18],u[27]];var z=u[12];function f(h){let D={$$slots:{default:[Tb]},$$scope:{ctx:h}};for(let N=0;N<w.length;N+=1)D=wi(D,w[N]);return{props:D}}return z&&(r=new z(f(u)),u[33](r),r.$on("click",u[13]),r.$on("keydown",u[25]),r.$on("SMUIGenericInput:mount",u[26]),r.$on("SMUIGenericInput:unmount",u[34])),{c(){r&&pr(r.$$.fragment),s=hn()},l(h){r&&Rr(r.$$.fragment,h),s=hn()},m(h,D){r&&dr(r,h,D),xi(h,s,D),g=!0},p(h,D){const N=D[0]&167726975?Gn(w,[D[0]&30425703&&{use:[...h[6]?[]:[[Dd,{ripple:!h[14],unbounded:!1,color:(h[1]||h[0])&&h[5]==null?"primary":h[5],disabled:h[9],addClass:h[22],removeClass:h[23],addStyle:h[24]}]],h[20],...h[2]]},D[0]&2163531&&{class:_o(ll({[h[3]]:!0,"mdc-deprecated-list-item":!0,"mdc-deprecated-list-item--activated":h[1],"mdc-deprecated-list-item--selected":h[0],"mdc-deprecated-list-item--disabled":h[9],"mdc-menu-item--selected":!h[21]&&h[8]==="menuitem"&&h[0],"smui-menu-item--non-interactive":h[6]},h[16]))},D[0]&131088&&{style:Object.entries(h[17]).map(T_).concat([h[4]]).join(" ")},D[0]&2097154&&Ya(h[21]&&h[1]?{"aria-current":"page"}:{}),D[0]&2097408&&Ya(h[21]?{}:{role:h[8]}),D[0]&2097409&&Ya(!h[21]&&h[8]==="option"?{"aria-selected":h[0]?"true":"false"}:{}),D[0]&2113792&&Ya(!h[21]&&(h[8]==="radio"||h[8]==="checkbox")?{"aria-checked":h[14]&&h[14].checked?"true":"false"}:{}),D[0]&2097664&&Ya(h[21]?{}:{"aria-disabled":h[9]?"true":"false"}),D[0]&1024&&{"data-menu-item-skip-restore-focus":h[10]||void 0},D[0]&524288&&{tabindex:h[19]},D[0]&2048&&{href:h[11]},D[0]&262144&&Ya(h[18]),D[0]&134217728&&Ya(h[27])]):{};if(D[0]&128|D[1]&16&&(N.$$scope={dirty:D,ctx:h}),z!==(z=h[12])){if(r){pl();const F=r;ui(F.$$.fragment,1,0,()=>{fr(F,1)}),hl()}z?(r=new z(f(h)),h[33](r),r.$on("click",h[13]),r.$on("keydown",h[25]),r.$on("SMUIGenericInput:mount",h[26]),r.$on("SMUIGenericInput:unmount",h[34]),pr(r.$$.fragment),ii(r.$$.fragment,1),dr(r,s.parentNode,s)):r=null}else z&&r.$set(N)},i(h){g||(r&&ii(r.$$.fragment,h),g=!0)},o(h){r&&ui(r.$$.fragment,h),g=!1},d(h){u[33](null),h&&Mt(s),r&&fr(r,h)}}}let Cb=0;const T_=([u,r])=>`${u}: ${r};`;function kb(u,r,s){let g;const w=["use","class","style","color","nonInteractive","ripple","activated","role","selected","disabled","skipRestoreFocus","tabindex","inputId","href","component","action","getPrimaryText","getElement"];let z=lr(r,w),{$$slots:f={},$$scope:h}=r;var D;const N=wo(xo());let F=()=>{};function G(rt){return rt===F}let{use:H=[]}=r,{class:Pe=""}=r,{style:ke=""}=r,{color:We=void 0}=r,{nonInteractive:je=(D=Qa("SMUI:list:nonInteractive"))!==null&&D!==void 0?D:!1}=r;Ia("SMUI:list:nonInteractive",void 0);let{ripple:yt=!je}=r,{activated:Ne=!1}=r,{role:Ze=Qa("SMUI:list:item:role")}=r;Ia("SMUI:list:item:role",void 0);let{selected:vt=!1}=r,{disabled:ct=!1}=r,{skipRestoreFocus:pt=!1}=r,{tabindex:lt=F}=r,{inputId:fi="SMUI-form-field-list-"+Cb++}=r,{href:Et=void 0}=r,Wt,Ei={},qi={},Xt={},Qt,Ai,bt=Qa("SMUI:list:item:nav"),{component:Gi=bt?Et?gv:Gp:w1}=r;Ia("SMUI:generic:input:props",{id:fi}),Ia("SMUI:separator:context",void 0),xh(()=>{if(!vt&&!je){let _i=!0,ir=Wt;for(;ir.previousSibling;)if(ir=ir.previousSibling,ir.nodeType===1&&ir.classList.contains("mdc-deprecated-list-item")&&!ir.classList.contains("mdc-deprecated-list-item--disabled")){_i=!1;break}_i&&(Ai=window.requestAnimationFrame(Xi))}const rt={_smui_list_item_accessor:!0,get element(){return zt()},get selected(){return vt},set selected(_i){s(0,vt=_i)},hasClass:mr,addClass:Ar,removeClass:Rt,getAttr:yi,addAttr:Fi,removeAttr:jt,getPrimaryText:zi,get checked(){var _i;return(_i=Qt&&Qt.checked)!==null&&_i!==void 0?_i:!1},set checked(_i){Qt&&s(14,Qt.checked=!!_i,Qt)},get hasCheckbox(){return!!(Qt&&"_smui_checkbox_accessor"in Qt)},get hasRadio(){return!!(Qt&&"_smui_radio_accessor"in Qt)},activateRipple(){Qt&&Qt.activateRipple()},deactivateRipple(){Qt&&Qt.deactivateRipple()},getValue(){return z.value},action:rr,get tabindex(){return g},set tabindex(_i){s(28,lt=_i)},get disabled(){return ct},get activated(){return Ne},set activated(_i){s(1,Ne=_i)}};return Ns(zt(),"SMUIListItem:mount",rt),()=>{Ns(zt(),"SMUIListItem:unmount",rt)}}),Ud(()=>{Ai&&window.cancelAnimationFrame(Ai)});function mr(rt){return rt in Ei?Ei[rt]:zt().classList.contains(rt)}function Ar(rt){Ei[rt]||s(16,Ei[rt]=!0,Ei)}function Rt(rt){(!(rt in Ei)||Ei[rt])&&s(16,Ei[rt]=!1,Ei)}function ai(rt,_i){qi[rt]!=_i&&(_i===""||_i==null?(delete qi[rt],s(17,qi)):s(17,qi[rt]=_i,qi))}function yi(rt){var _i;return rt in Xt?(_i=Xt[rt])!==null&&_i!==void 0?_i:null:zt().getAttribute(rt)}function Fi(rt,_i){Xt[rt]!==_i&&s(18,Xt[rt]=_i,Xt)}function jt(rt){(!(rt in Xt)||Xt[rt]!=null)&&s(18,Xt[rt]=void 0,Xt)}function Xi(){let rt=!0,_i=Wt.getElement();for(;_i.nextElementSibling;)if(_i=_i.nextElementSibling,_i.nodeType===1&&_i.classList.contains("mdc-deprecated-list-item")){const ir=_i.attributes.getNamedItem("tabindex");if(ir&&ir.value==="0"){rt=!1;break}}rt&&s(19,g=0)}function Ri(rt){const _i=rt.key==="Enter",ir=rt.key==="Space";(_i||ir)&&rr(rt)}function Ii(rt){("_smui_checkbox_accessor"in rt.detail||"_smui_radio_accessor"in rt.detail)&&s(14,Qt=rt.detail)}function rr(rt){ct||Ns(zt(),"SMUI:action",rt)}function zi(){var rt,_i,ir;const Pr=zt(),co=Pr.querySelector(".mdc-deprecated-list-item__primary-text");if(co)return(rt=co.textContent)!==null&&rt!==void 0?rt:"";const Zn=Pr.querySelector(".mdc-deprecated-list-item__text");return Zn?(_i=Zn.textContent)!==null&&_i!==void 0?_i:"":(ir=Pr.textContent)!==null&&ir!==void 0?ir:""}function zt(){return Wt.getElement()}function tr(rt){an[rt?"unshift":"push"](()=>{Wt=rt,s(15,Wt)})}const Bt=()=>s(14,Qt=void 0);return u.$$set=rt=>{r=wi(wi({},r),bo(rt)),s(27,z=lr(r,w)),"use"in rt&&s(2,H=rt.use),"class"in rt&&s(3,Pe=rt.class),"style"in rt&&s(4,ke=rt.style),"color"in rt&&s(5,We=rt.color),"nonInteractive"in rt&&s(6,je=rt.nonInteractive),"ripple"in rt&&s(7,yt=rt.ripple),"activated"in rt&&s(1,Ne=rt.activated),"role"in rt&&s(8,Ze=rt.role),"selected"in rt&&s(0,vt=rt.selected),"disabled"in rt&&s(9,ct=rt.disabled),"skipRestoreFocus"in rt&&s(10,pt=rt.skipRestoreFocus),"tabindex"in rt&&s(28,lt=rt.tabindex),"inputId"in rt&&s(29,fi=rt.inputId),"href"in rt&&s(11,Et=rt.href),"component"in rt&&s(12,Gi=rt.component),"$$scope"in rt&&s(35,h=rt.$$scope)},u.$$.update=()=>{u.$$.dirty[0]&268452417&&s(19,g=G(lt)?!je&&!ct&&(vt||Qt&&Qt.checked)?0:-1:lt)},[vt,Ne,H,Pe,ke,We,je,yt,Ze,ct,pt,Et,Gi,rr,Qt,Wt,Ei,qi,Xt,g,N,bt,Ar,Rt,ai,Ri,Ii,z,lt,fi,zi,zt,f,tr,Bt,h]}class zb extends wn{constructor(r){super(),En(this,r,kb,Ab,gn,{use:2,class:3,style:4,color:5,nonInteractive:6,ripple:7,activated:1,role:8,selected:0,disabled:9,skipRestoreFocus:10,tabindex:28,inputId:29,href:11,component:12,action:13,getPrimaryText:30,getElement:31},null,[-1,-1])}get action(){return this.$$.ctx[13]}get getPrimaryText(){return this.$$.ctx[30]}get getElement(){return this.$$.ctx[31]}}dl({class:"mdc-deprecated-list-item__text",component:Gp});dl({class:"mdc-deprecated-list-item__primary-text",component:Gp});dl({class:"mdc-deprecated-list-item__secondary-text",component:Gp});dl({class:"mdc-deprecated-list-item__meta",component:Gp});dl({class:"mdc-deprecated-list-group",component:Nd});dl({class:"mdc-deprecated-list-group__subheader",component:b1});const Yf=zb;/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Pb={ROOT:"mdc-form-field"},Mb={LABEL_SELECTOR:".mdc-form-field > label"};/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Lb=function(u){bu(r,u);function r(s){var g=u.call(this,Da(Da({},r.defaultAdapter),s))||this;return g.click=function(){g.handleClick()},g}return Object.defineProperty(r,"cssClasses",{get:function(){return Pb},enumerable:!1,configurable:!0}),Object.defineProperty(r,"strings",{get:function(){return Mb},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{activateInputRipple:function(){},deactivateInputRipple:function(){},deregisterInteractionHandler:function(){},registerInteractionHandler:function(){}}},enumerable:!1,configurable:!0}),r.prototype.init=function(){this.adapter.registerInteractionHandler("click",this.click)},r.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("click",this.click)},r.prototype.handleClick=function(){var s=this;this.adapter.activateInputRipple(),requestAnimationFrame(function(){s.adapter.deactivateInputRipple()})},r}(tp);const Db=u=>({}),A_=u=>({});function Rb(u){let r,s,g,w,z,f,h,D,N;const F=u[13].default,G=ao(F,u,u[12],null),H=u[13].label,Pe=ao(H,u,u[12],A_);let ke=[{for:u[4]},qf(u[10],"label$")],We={};for(let Ne=0;Ne<ke.length;Ne+=1)We=wi(We,ke[Ne]);let je=[{class:z=_o({[u[1]]:!0,"mdc-form-field":!0,"mdc-form-field--align-end":u[2]==="end","mdc-form-field--nowrap":u[3]})},Vf(u[10],["label$"])],yt={};for(let Ne=0;Ne<je.length;Ne+=1)yt=wi(yt,je[Ne]);return{c(){r=gr("div"),G&&G.c(),s=qo(),g=gr("label"),Pe&&Pe.c(),this.h()},l(Ne){r=_r(Ne,"DIV",{class:!0});var Ze=Dr(r);G&&G.l(Ze),s=Go(Ze),g=_r(Ze,"LABEL",{for:!0});var vt=Dr(g);Pe&&Pe.l(vt),vt.forEach(Mt),Ze.forEach(Mt),this.h()},h(){Wr(g,We),Wr(r,yt)},m(Ne,Ze){xi(Ne,r,Ze),G&&G.m(r,null),fa(r,s),fa(r,g),Pe&&Pe.m(g,null),u[14](g),u[15](r),h=!0,D||(N=[Vr(w=ra.call(null,g,u[5])),Vr(f=ra.call(null,r,u[0])),Vr(u[9].call(null,r)),ul(r,"SMUIGenericInput:mount",u[16]),ul(r,"SMUIGenericInput:unmount",u[17])],D=!0)},p(Ne,[Ze]){G&&G.p&&(!h||Ze&4096)&&so(G,F,Ne,Ne[12],h?uo(F,Ne[12],Ze,null):lo(Ne[12]),null),Pe&&Pe.p&&(!h||Ze&4096)&&so(Pe,H,Ne,Ne[12],h?uo(H,Ne[12],Ze,Db):lo(Ne[12]),A_),Wr(g,We=Gn(ke,[(!h||Ze&16)&&{for:Ne[4]},Ze&1024&&qf(Ne[10],"label$")])),w&&Vo(w.update)&&Ze&32&&w.update.call(null,Ne[5]),Wr(r,yt=Gn(je,[(!h||Ze&14&&z!==(z=_o({[Ne[1]]:!0,"mdc-form-field":!0,"mdc-form-field--align-end":Ne[2]==="end","mdc-form-field--nowrap":Ne[3]})))&&{class:z},Ze&1024&&Vf(Ne[10],["label$"])])),f&&Vo(f.update)&&Ze&1&&f.update.call(null,Ne[0])},i(Ne){h||(ii(G,Ne),ii(Pe,Ne),h=!0)},o(Ne){ui(G,Ne),ui(Pe,Ne),h=!1},d(Ne){Ne&&Mt(r),G&&G.d(Ne),Pe&&Pe.d(Ne),u[14](null),u[15](null),D=!1,Sa(N)}}}let Bb=0;function Ob(u,r,s){const g=["use","class","align","noWrap","inputId","label$use","getElement"];let w=lr(r,g),{$$slots:z={},$$scope:f}=r;const h=wo(xo());let{use:D=[]}=r,{class:N=""}=r,{align:F="start"}=r,{noWrap:G=!1}=r,{inputId:H="SMUI-form-field-"+Bb++}=r,{label$use:Pe=[]}=r,ke,We,je,yt;Ia("SMUI:generic:input:props",{id:H}),xh(()=>(We=new Lb({activateInputRipple:()=>{yt&&yt.activateRipple()},deactivateInputRipple:()=>{yt&&yt.deactivateRipple()},deregisterInteractionHandler:(lt,fi)=>{je.removeEventListener(lt,fi)},registerInteractionHandler:(lt,fi)=>{je.addEventListener(lt,fi)}}),We.init(),()=>{We.destroy()}));function Ne(){return ke}function Ze(lt){an[lt?"unshift":"push"](()=>{je=lt,s(7,je)})}function vt(lt){an[lt?"unshift":"push"](()=>{ke=lt,s(6,ke)})}const ct=lt=>s(8,yt=lt.detail),pt=()=>s(8,yt=void 0);return u.$$set=lt=>{r=wi(wi({},r),bo(lt)),s(10,w=lr(r,g)),"use"in lt&&s(0,D=lt.use),"class"in lt&&s(1,N=lt.class),"align"in lt&&s(2,F=lt.align),"noWrap"in lt&&s(3,G=lt.noWrap),"inputId"in lt&&s(4,H=lt.inputId),"label$use"in lt&&s(5,Pe=lt.label$use),"$$scope"in lt&&s(12,f=lt.$$scope)},[D,N,F,G,H,Pe,ke,je,yt,h,w,Ne,f,z,Ze,vt,ct,pt]}class jy extends wn{constructor(r){super(),En(this,r,Ob,Rb,gn,{use:0,class:1,align:2,noWrap:3,inputId:4,label$use:5,getElement:11})}get getElement(){return this.$$.ctx[11]}}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var kd={ANIM_CHECKED_INDETERMINATE:"mdc-checkbox--anim-checked-indeterminate",ANIM_CHECKED_UNCHECKED:"mdc-checkbox--anim-checked-unchecked",ANIM_INDETERMINATE_CHECKED:"mdc-checkbox--anim-indeterminate-checked",ANIM_INDETERMINATE_UNCHECKED:"mdc-checkbox--anim-indeterminate-unchecked",ANIM_UNCHECKED_CHECKED:"mdc-checkbox--anim-unchecked-checked",ANIM_UNCHECKED_INDETERMINATE:"mdc-checkbox--anim-unchecked-indeterminate",BACKGROUND:"mdc-checkbox__background",CHECKED:"mdc-checkbox--checked",CHECKMARK:"mdc-checkbox__checkmark",CHECKMARK_PATH:"mdc-checkbox__checkmark-path",DISABLED:"mdc-checkbox--disabled",INDETERMINATE:"mdc-checkbox--indeterminate",MIXEDMARK:"mdc-checkbox__mixedmark",NATIVE_CONTROL:"mdc-checkbox__native-control",ROOT:"mdc-checkbox",SELECTED:"mdc-checkbox--selected",UPGRADED:"mdc-checkbox--upgraded"},Ll={ARIA_CHECKED_ATTR:"aria-checked",ARIA_CHECKED_INDETERMINATE_VALUE:"mixed",DATA_INDETERMINATE_ATTR:"data-indeterminate",NATIVE_CONTROL_SELECTOR:".mdc-checkbox__native-control",TRANSITION_STATE_CHECKED:"checked",TRANSITION_STATE_INDETERMINATE:"indeterminate",TRANSITION_STATE_INIT:"init",TRANSITION_STATE_UNCHECKED:"unchecked"},C_={ANIM_END_LATCH_MS:250};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Fb=function(u){bu(r,u);function r(s){var g=u.call(this,Da(Da({},r.defaultAdapter),s))||this;return g.currentCheckState=Ll.TRANSITION_STATE_INIT,g.currentAnimationClass="",g.animEndLatchTimer=0,g.enableAnimationEndHandler=!1,g}return Object.defineProperty(r,"cssClasses",{get:function(){return kd},enumerable:!1,configurable:!0}),Object.defineProperty(r,"strings",{get:function(){return Ll},enumerable:!1,configurable:!0}),Object.defineProperty(r,"numbers",{get:function(){return C_},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{addClass:function(){},forceLayout:function(){},hasNativeControl:function(){return!1},isAttachedToDOM:function(){return!1},isChecked:function(){return!1},isIndeterminate:function(){return!1},removeClass:function(){},removeNativeControlAttr:function(){},setNativeControlAttr:function(){},setNativeControlDisabled:function(){}}},enumerable:!1,configurable:!0}),r.prototype.init=function(){this.currentCheckState=this.determineCheckState(),this.updateAriaChecked(),this.adapter.addClass(kd.UPGRADED)},r.prototype.destroy=function(){clearTimeout(this.animEndLatchTimer)},r.prototype.setDisabled=function(s){this.adapter.setNativeControlDisabled(s),s?this.adapter.addClass(kd.DISABLED):this.adapter.removeClass(kd.DISABLED)},r.prototype.handleAnimationEnd=function(){var s=this;!this.enableAnimationEndHandler||(clearTimeout(this.animEndLatchTimer),this.animEndLatchTimer=setTimeout(function(){s.adapter.removeClass(s.currentAnimationClass),s.enableAnimationEndHandler=!1},C_.ANIM_END_LATCH_MS))},r.prototype.handleChange=function(){this.transitionCheckState()},r.prototype.transitionCheckState=function(){if(!!this.adapter.hasNativeControl()){var s=this.currentCheckState,g=this.determineCheckState();if(s!==g){this.updateAriaChecked();var w=Ll.TRANSITION_STATE_UNCHECKED,z=kd.SELECTED;g===w?this.adapter.removeClass(z):this.adapter.addClass(z),this.currentAnimationClass.length>0&&(clearTimeout(this.animEndLatchTimer),this.adapter.forceLayout(),this.adapter.removeClass(this.currentAnimationClass)),this.currentAnimationClass=this.getTransitionAnimationClass(s,g),this.currentCheckState=g,this.adapter.isAttachedToDOM()&&this.currentAnimationClass.length>0&&(this.adapter.addClass(this.currentAnimationClass),this.enableAnimationEndHandler=!0)}}},r.prototype.determineCheckState=function(){var s=Ll.TRANSITION_STATE_INDETERMINATE,g=Ll.TRANSITION_STATE_CHECKED,w=Ll.TRANSITION_STATE_UNCHECKED;return this.adapter.isIndeterminate()?s:this.adapter.isChecked()?g:w},r.prototype.getTransitionAnimationClass=function(s,g){var w=Ll.TRANSITION_STATE_INIT,z=Ll.TRANSITION_STATE_CHECKED,f=Ll.TRANSITION_STATE_UNCHECKED,h=r.cssClasses,D=h.ANIM_UNCHECKED_CHECKED,N=h.ANIM_UNCHECKED_INDETERMINATE,F=h.ANIM_CHECKED_UNCHECKED,G=h.ANIM_CHECKED_INDETERMINATE,H=h.ANIM_INDETERMINATE_CHECKED,Pe=h.ANIM_INDETERMINATE_UNCHECKED;switch(s){case w:return g===f?"":g===z?H:Pe;case f:return g===z?D:N;case z:return g===f?F:G;default:return g===z?H:Pe}},r.prototype.updateAriaChecked=function(){this.adapter.isIndeterminate()?this.adapter.setNativeControlAttr(Ll.ARIA_CHECKED_ATTR,Ll.ARIA_CHECKED_INDETERMINATE_VALUE):this.adapter.removeNativeControlAttr(Ll.ARIA_CHECKED_ATTR)},r}(tp);function Ub(u){let r,s,g,w,z,f,h,D,N,F,G,H,Pe,ke,We,je,yt,Ne,Ze,vt,ct=[{class:g=_o({[u[9]]:!0,"mdc-checkbox__native-control":!0})},{type:"checkbox"},u[20],{disabled:u[1]},{__value:w=u[19](u[7])?u[6]:u[7]},{"data-indeterminate":z=!u[19](u[0])&&u[0]?"true":void 0},u[16],qf(u[26],"input$")],pt={};for(let Et=0;Et<ct.length;Et+=1)pt=wi(pt,ct[Et]);let lt=[{class:We=_o(ll({[u[3]]:!0,"mdc-checkbox":!0,"mdc-checkbox--disabled":u[1],"mdc-checkbox--touch":u[5],"mdc-data-table__header-row-checkbox":u[21]==="data-table"&&u[22],"mdc-data-table__row-checkbox":u[21]==="data-table"&&!u[22]},u[14]))},{style:je=Object.entries(u[15]).map(k_).concat([u[4]]).join(" ")},Vf(u[26],["input$"])],fi={};for(let Et=0;Et<lt.length;Et+=1)fi=wi(fi,lt[Et]);return{c(){r=gr("div"),s=gr("input"),h=qo(),D=gr("div"),N=Oy("svg"),F=Oy("path"),G=qo(),H=gr("div"),Pe=qo(),ke=gr("div"),this.h()},l(Et){r=_r(Et,"DIV",{class:!0,style:!0});var Wt=Dr(r);s=_r(Wt,"INPUT",{class:!0,type:!0,"data-indeterminate":!0}),h=Go(Wt),D=_r(Wt,"DIV",{class:!0});var Ei=Dr(D);N=Fy(Ei,"svg",{class:!0,viewBox:!0});var qi=Dr(N);F=Fy(qi,"path",{class:!0,fill:!0,d:!0}),Dr(F).forEach(Mt),qi.forEach(Mt),G=Go(Ei),H=_r(Ei,"DIV",{class:!0}),Dr(H).forEach(Mt),Ei.forEach(Mt),Pe=Go(Wt),ke=_r(Wt,"DIV",{class:!0}),Dr(ke).forEach(Mt),Wt.forEach(Mt),this.h()},h(){Wr(s,pt),jr(F,"class","mdc-checkbox__checkmark-path"),jr(F,"fill","none"),jr(F,"d","M1.73,12.91 8.1,19.28 22.79,4.59"),jr(N,"class","mdc-checkbox__checkmark"),jr(N,"viewBox","0 0 24 24"),jr(H,"class","mdc-checkbox__mixedmark"),jr(D,"class","mdc-checkbox__background"),jr(ke,"class","mdc-checkbox__ripple"),Wr(r,fi)},m(Et,Wt){xi(Et,r,Wt),fa(r,s),s.autofocus&&s.focus(),u[36](s),s.checked=u[12],fa(r,h),fa(r,D),fa(D,N),fa(N,F),fa(D,G),fa(D,H),fa(r,Pe),fa(r,ke),u[38](r),Ze||(vt=[Vr(f=ra.call(null,s,u[8])),ul(s,"change",u[37]),ul(s,"blur",u[34]),ul(s,"focus",u[35]),Vr(yt=ra.call(null,r,u[2])),Vr(u[18].call(null,r)),Vr(Ne=Dd.call(null,r,{unbounded:!0,addClass:u[23],removeClass:u[24],addStyle:u[25],active:u[17],eventTarget:u[11]})),ul(r,"animationend",u[39])],Ze=!0)},p(Et,Wt){Wr(s,pt=Gn(ct,[Wt[0]&512&&g!==(g=_o({[Et[9]]:!0,"mdc-checkbox__native-control":!0}))&&{class:g},{type:"checkbox"},Et[20],Wt[0]&2&&{disabled:Et[1]},Wt[0]&192&&w!==(w=Et[19](Et[7])?Et[6]:Et[7])&&{__value:w},Wt[0]&1&&z!==(z=!Et[19](Et[0])&&Et[0]?"true":void 0)&&{"data-indeterminate":z},Wt[0]&65536&&Et[16],Wt[0]&67108864&&qf(Et[26],"input$")])),f&&Vo(f.update)&&Wt[0]&256&&f.update.call(null,Et[8]),Wt[0]&4096&&(s.checked=Et[12]),Wr(r,fi=Gn(lt,[Wt[0]&16426&&We!==(We=_o(ll({[Et[3]]:!0,"mdc-checkbox":!0,"mdc-checkbox--disabled":Et[1],"mdc-checkbox--touch":Et[5],"mdc-data-table__header-row-checkbox":Et[21]==="data-table"&&Et[22],"mdc-data-table__row-checkbox":Et[21]==="data-table"&&!Et[22]},Et[14])))&&{class:We},Wt[0]&32784&&je!==(je=Object.entries(Et[15]).map(k_).concat([Et[4]]).join(" "))&&{style:je},Wt[0]&67108864&&Vf(Et[26],["input$"])])),yt&&Vo(yt.update)&&Wt[0]&4&&yt.update.call(null,Et[2]),Ne&&Vo(Ne.update)&&Wt[0]&133120&&Ne.update.call(null,{unbounded:!0,addClass:Et[23],removeClass:Et[24],addStyle:Et[25],active:Et[17],eventTarget:Et[11]})},i:vs,o:vs,d(Et){Et&&Mt(r),u[36](null),u[38](null),Ze=!1,Sa(vt)}}}const k_=([u,r])=>`${u}: ${r};`;function Nb(u,r,s){const g=["use","class","style","disabled","touch","indeterminate","group","checked","value","valueKey","input$use","input$class","getId","getElement"];let w=lr(r,g);var z;const f=wo(xo());let h=()=>{};function D(Bt){return Bt===h}let{use:N=[]}=r,{class:F=""}=r,{style:G=""}=r,{disabled:H=!1}=r,{touch:Pe=!1}=r,{indeterminate:ke=h}=r,{group:We=h}=r,{checked:je=h}=r,{value:yt=null}=r,{valueKey:Ne=h}=r,{input$use:Ze=[]}=r,{input$class:vt=""}=r,ct,pt,lt,fi={},Et={},Wt={},Ei=!1,qi=(z=Qa("SMUI:generic:input:props"))!==null&&z!==void 0?z:{},Xt=D(We)?D(je)?!1:je!=null?je:void 0:We.indexOf(yt)!==-1,Qt=Qa("SMUI:checkbox:context"),Ai=Qa("SMUI:data-table:row:header"),bt=je,Gi=D(We)?[]:[...We],mr=Xt;xh(()=>{s(11,lt.indeterminate=!D(ke)&&ke,lt),s(10,pt=new Fb({addClass:Ar,forceLayout:()=>ct.offsetWidth,hasNativeControl:()=>!0,isAttachedToDOM:()=>Boolean(ct.parentNode),isChecked:()=>Xt!=null?Xt:!1,isIndeterminate:()=>D(ke)?!1:ke,removeClass:Rt,removeNativeControlAttr:Fi,setNativeControlAttr:yi,setNativeControlDisabled:rt=>s(1,H=rt)}));const Bt={_smui_checkbox_accessor:!0,get element(){return Xi()},get checked(){return Xt!=null?Xt:!1},set checked(rt){Xt!==rt&&s(12,Xt=rt)},get indeterminate(){return D(ke)?!1:ke},set indeterminate(rt){s(0,ke=rt)},activateRipple(){H||s(17,Ei=!0)},deactivateRipple(){s(17,Ei=!1)}};return Ns(ct,"SMUIGenericInput:mount",Bt),Ns(ct,"SMUICheckbox:mount",Bt),pt.init(),()=>{Ns(ct,"SMUIGenericInput:unmount",Bt),Ns(ct,"SMUICheckbox:unmount",Bt),pt.destroy()}});function Ar(Bt){fi[Bt]||s(14,fi[Bt]=!0,fi)}function Rt(Bt){(!(Bt in fi)||fi[Bt])&&s(14,fi[Bt]=!1,fi)}function ai(Bt,rt){Et[Bt]!=rt&&(rt===""||rt==null?(delete Et[Bt],s(15,Et)):s(15,Et[Bt]=rt,Et))}function yi(Bt,rt){Wt[Bt]!==rt&&s(16,Wt[Bt]=rt,Wt)}function Fi(Bt){(!(Bt in Wt)||Wt[Bt]!=null)&&s(16,Wt[Bt]=void 0,Wt)}function jt(){return qi&&qi.id}function Xi(){return ct}function Ri(Bt){By.call(this,u,Bt)}function Ii(Bt){By.call(this,u,Bt)}function rr(Bt){an[Bt?"unshift":"push"](()=>{lt=Bt,s(11,lt),s(27,We),s(33,mr),s(12,Xt),s(6,yt),s(32,Gi),s(28,je),s(31,bt),s(0,ke),s(10,pt)})}function zi(){Xt=this.checked,s(12,Xt),s(27,We),s(33,mr),s(6,yt),s(32,Gi),s(28,je),s(31,bt),s(0,ke),s(11,lt),s(10,pt)}function zt(Bt){an[Bt?"unshift":"push"](()=>{ct=Bt,s(13,ct)})}const tr=()=>pt&&pt.handleAnimationEnd();return u.$$set=Bt=>{r=wi(wi({},r),bo(Bt)),s(26,w=lr(r,g)),"use"in Bt&&s(2,N=Bt.use),"class"in Bt&&s(3,F=Bt.class),"style"in Bt&&s(4,G=Bt.style),"disabled"in Bt&&s(1,H=Bt.disabled),"touch"in Bt&&s(5,Pe=Bt.touch),"indeterminate"in Bt&&s(0,ke=Bt.indeterminate),"group"in Bt&&s(27,We=Bt.group),"checked"in Bt&&s(28,je=Bt.checked),"value"in Bt&&s(6,yt=Bt.value),"valueKey"in Bt&&s(7,Ne=Bt.valueKey),"input$use"in Bt&&s(8,Ze=Bt.input$use),"input$class"in Bt&&s(9,vt=Bt.input$class)},u.$$.update=()=>{if(u.$$.dirty[0]&402660417|u.$$.dirty[1]&7){let Bt=!1;if(!D(We))if(mr!==Xt){const rt=We.indexOf(yt);Xt&&rt===-1?(We.push(yt),s(27,We),s(33,mr),s(12,Xt),s(6,yt),s(32,Gi),s(28,je),s(31,bt),s(0,ke),s(11,lt),s(10,pt)):!Xt&&rt!==-1&&(We.splice(rt,1),s(27,We),s(33,mr),s(12,Xt),s(6,yt),s(32,Gi),s(28,je),s(31,bt),s(0,ke),s(11,lt),s(10,pt)),Bt=!0}else{const rt=Gi.indexOf(yt),_i=We.indexOf(yt);rt>-1&&_i===-1?(s(12,Xt=!1),Bt=!0):_i>-1&&rt===-1&&(s(12,Xt=!0),Bt=!0)}D(je)?!!mr!=!!Xt&&(Bt=!0):je!==(Xt!=null?Xt:null)&&(je===bt?(s(28,je=Xt!=null?Xt:null),D(ke)||s(0,ke=!1)):s(12,Xt=je!=null?je:void 0),Bt=!0),lt&&(D(ke)?lt.indeterminate&&(s(11,lt.indeterminate=!1,lt),Bt=!0):!ke&&lt.indeterminate?(s(11,lt.indeterminate=!1,lt),Bt=!0):ke&&!lt.indeterminate&&(s(11,lt.indeterminate=!0,lt),Bt=!0)),s(31,bt=je),s(32,Gi=D(We)?[]:[...We]),s(33,mr=Xt),Bt&&pt&&pt.handleChange()}},[ke,H,N,F,G,Pe,yt,Ne,Ze,vt,pt,lt,Xt,ct,fi,Et,Wt,Ei,f,D,qi,Qt,Ai,Ar,Rt,ai,w,We,je,jt,Xi,bt,Gi,mr,Ri,Ii,rr,zi,zt,tr]}class bv extends wn{constructor(r){super(),En(this,r,Nb,Ub,gn,{use:2,class:3,style:4,disabled:1,touch:5,indeterminate:0,group:27,checked:28,value:6,valueKey:7,input$use:8,input$class:9,getId:29,getElement:30},null,[-1,-1])}get getId(){return this.$$.ctx[29]}get getElement(){return this.$$.ctx[30]}}const Qf=pv(null),z_=pv(null);var jb=8,Vb={version:{required:!0,type:"enum",values:[8],doc:"Style specification version number. Must be 8.",example:8},name:{type:"string",doc:"A human-readable name for the style.",example:"Bright"},metadata:{type:"*",doc:"Arbitrary properties useful to track with the stylesheet, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},center:{type:"array",value:"number",doc:"Default map center in longitude and latitude.  The style center will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:[-73.9749,40.7736]},zoom:{type:"number",doc:"Default zoom level.  The style zoom will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:12.5},bearing:{type:"number",default:0,period:360,units:"degrees",doc:'Default bearing, in degrees. The bearing is the compass direction that is "up"; for example, a bearing of 90\xB0 orients the map so that east is up. This value will be used only if the map has not been positioned by other means (e.g. map options or user interaction).',example:29},pitch:{type:"number",default:0,units:"degrees",doc:"Default pitch, in degrees. Zero is perpendicular to the surface, for a look straight down at the map, while a greater value like 60 looks ahead towards the horizon. The style pitch will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:50},light:{type:"light",doc:"The global light source.",example:{anchor:"viewport",color:"white",intensity:.4}},terrain:{type:"terrain",doc:"A global modifier that elevates layers and markers based on a DEM data source."},fog:{type:"fog",doc:"A global effect that fades layers and markers based on their distance to the camera. The fog can be used to approximate the effect of atmosphere on distant objects and enhance the depth perception of the map when used with terrain or 3D features."},sources:{required:!0,type:"sources",doc:"Data source specifications.",example:{"mapbox-streets":{type:"vector",url:"mapbox://mapbox.mapbox-streets-v6"}}},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended. This property is required if any layer uses the `background-pattern`, `fill-pattern`, `line-pattern`, `fill-extrusion-pattern`, or `icon-image` properties. The URL must be absolute, containing the [scheme, authority and path components](https://en.wikipedia.org/wiki/URL#Syntax).",example:"mapbox://sprites/mapbox/bright-v8"},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. The URL must include `{fontstack}` and `{range}` tokens. This property is required if any layer uses the `text-field` layout property. The URL must be absolute, containing the [scheme, authority and path components](https://en.wikipedia.org/wiki/URL#Syntax).",example:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},transition:{type:"transition",doc:"A global transition definition to use as a default across properties, to be used for timing transitions between one value and the next when no property-specific transition is set. Collision-based symbol fading is controlled independently of the style's `transition` property.",example:{duration:300,delay:0}},projection:{type:"projection",doc:"The projection the map should be rendered in. Supported projections are Albers, Equal Earth, Equirectangular (WGS84), Lambert conformal conic, Mercator, Natural Earth, and Winkel Tripel. Terrain, fog, sky and CustomLayerInterface are not supported for projections other than mercator.",example:{name:"albers",center:[-154,50],parallels:[55,65]}},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array.",example:[{id:"water",source:"mapbox-streets","source-layer":"water",type:"fill",paint:{"fill-color":"#00ffff"}}]}},qb={"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For image and video sources, a URL must be provided. For GeoJSON sources, a URL or inline GeoJSON must be provided."}},Gb=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],Zb={type:{required:!0,type:"enum",values:{vector:{doc:"A vector tile source."}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},scheme:{type:"enum",values:{xyz:{doc:"Slippy map tilenames scheme."},tms:{doc:"OSGeo spec scheme."}},default:"xyz",doc:"Influences the y direction of the tile coordinates. The global-mercator (aka Spherical Mercator) profile is assumed."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},promoteId:{type:"promoteId",doc:"A property to use as a feature id (for feature state). Either a property name, or an object of the form `{<sourceLayer>: <propertyName>}`. If specified as a string for a vector tile source, the same property is used across all its source layers."},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},Hb={type:{required:!0,type:"enum",values:{raster:{doc:"A raster tile source."}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},scheme:{type:"enum",values:{xyz:{doc:"Slippy map tilenames scheme."},tms:{doc:"OSGeo spec scheme."}},default:"xyz",doc:"Influences the y direction of the tile coordinates. The global-mercator (aka Spherical Mercator) profile is assumed."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},Wb={type:{required:!0,type:"enum",values:{"raster-dem":{doc:"A RGB-encoded raster DEM source"}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},encoding:{type:"enum",values:{terrarium:{doc:"Terrarium format PNG tiles. See https://aws.amazon.com/es/public-datasets/terrain/ for more info."},mapbox:{doc:"Mapbox Terrain RGB tiles. See https://www.mapbox.com/help/access-elevation-data/#mapbox-terrain-rgb for more info."}},default:"mapbox",doc:"The encoding used by this source. Mapbox Terrain RGB is used by default"},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},Xb={type:{required:!0,type:"enum",values:{geojson:{doc:"A GeoJSON data source."}},doc:"The data type of the GeoJSON source."},data:{type:"*",doc:"A URL to a GeoJSON file, or inline GeoJSON."},maxzoom:{type:"number",default:18,doc:"Maximum zoom level at which to create vector tiles (higher means greater detail at high zoom levels)."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},buffer:{type:"number",default:128,maximum:512,minimum:0,doc:"Size of the tile buffer on each side. A value of 0 produces no buffer. A value of 512 produces a buffer as wide as the tile itself. Larger values produce fewer rendering artifacts near tile edges and slower performance."},filter:{type:"*",doc:"An expression for filtering features prior to processing them for rendering."},tolerance:{type:"number",default:.375,doc:"Douglas-Peucker simplification tolerance (higher means simpler geometries and faster performance)."},cluster:{type:"boolean",default:!1,doc:"If the data is a collection of point features, setting this to true clusters the points by radius into groups. Cluster groups become new `Point` features in the source with additional properties:\n * `cluster` Is `true` if the point is a cluster \n * `cluster_id` A unqiue id for the cluster to be used in conjunction with the [cluster inspection methods](https://www.mapbox.com/mapbox-gl-js/api/#geojsonsource#getclusterexpansionzoom)\n * `point_count` Number of original points grouped into this cluster\n * `point_count_abbreviated` An abbreviated point count"},clusterRadius:{type:"number",default:50,minimum:0,doc:"Radius of each cluster if clustering is enabled. A value of 512 indicates a radius equal to the width of a tile."},clusterMaxZoom:{type:"number",doc:"Max zoom on which to cluster points if clustering is enabled. Defaults to one zoom less than maxzoom (so that last zoom features are not clustered). Clusters are re-evaluated at integer zoom levels so setting clusterMaxZoom to 14 means the clusters will be displayed until z15."},clusterMinPoints:{type:"number",doc:"Minimum number of points necessary to form a cluster if clustering is enabled. Defaults to `2`."},clusterProperties:{type:"*",doc:'An object defining custom properties on the generated clusters if clustering is enabled, aggregating values from clustered points. Has the form `{"property_name": [operator, map_expression]}`. `operator` is any expression function that accepts at least 2 operands (e.g. `"+"` or `"max"`) \u2014 it accumulates the property value from clusters/points the cluster contains; `map_expression` produces the value of a single point.\n\nExample: `{"sum": ["+", ["get", "scalerank"]]}`.\n\nFor more advanced use cases, in place of `operator`, you can use a custom reduce expression that references a special `["accumulated"]` value, e.g.:\n`{"sum": [["+", ["accumulated"], ["get", "sum"]], ["get", "scalerank"]]}`'},lineMetrics:{type:"boolean",default:!1,doc:"Whether to calculate line distance metrics. This is required for line layers that specify `line-gradient` values."},generateId:{type:"boolean",default:!1,doc:"Whether to generate ids for the geojson features. When enabled, the `feature.id` property will be auto assigned based on its index in the `features` array, over-writing any previous values."},promoteId:{type:"promoteId",doc:"A property to use as a feature id (for feature state). Either a property name, or an object of the form `{<sourceLayer>: <propertyName>}`."}},Kb={type:{required:!0,type:"enum",values:{video:{doc:"A video data source."}},doc:"The data type of the video source."},urls:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,doc:"Corners of video specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},Jb={type:{required:!0,type:"enum",values:{image:{doc:"An image data source."}},doc:"The data type of the image source."},url:{required:!0,type:"string",doc:"URL that points to an image."},coordinates:{required:!0,doc:"Corners of image specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},$b={id:{type:"string",doc:"Unique layer name.",required:!0},type:{type:"enum",values:{fill:{doc:"A filled polygon with an optional stroked border.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},line:{doc:"A stroked line.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},symbol:{doc:"An icon or a text label.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},circle:{doc:"A filled circle.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},heatmap:{doc:"A heatmap.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"fill-extrusion":{doc:"An extruded (3D) polygon.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},raster:{doc:"Raster map textures such as satellite imagery.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},hillshade:{doc:"Client-side hillshading visualization based on DEM data. Currently, the implementation only supports Mapbox Terrain RGB and Mapzen Terrarium tiles.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},background:{doc:"The background color or pattern of the map.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},sky:{doc:"A spherical dome around the map that is always rendered behind all other layers.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}}},doc:"Rendering type of this layer.",required:!0},metadata:{type:"*",doc:"Arbitrary properties useful to track with the layer, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},source:{type:"string",doc:"Name of a source description to be used for this layer. Required for all layer types except `background`."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required for vector tile sources; prohibited for all other source types, including GeoJSON sources."},minzoom:{type:"number",minimum:0,maximum:24,doc:"The minimum zoom level for the layer. At zoom levels less than the minzoom, the layer will be hidden."},maxzoom:{type:"number",minimum:0,maximum:24,doc:"The maximum zoom level for the layer. At zoom levels equal to or greater than the maxzoom, the layer will be hidden."},filter:{type:"filter",doc:'An expression specifying conditions on source features. Only features that match the filter are displayed. Zoom expressions in filters are only evaluated at integer zoom levels. The `["feature-state", ...]` expression is not supported in filter expressions.  The `["pitch"]` and `["distance-from-center"]` expressions are supported only for filter expressions on the symbol layer.'},layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."}},Yb=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],Qb={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},ew={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"constant"}},tw={"fill-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"},"data-driven styling":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},iw={"circle-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.2.0",ios:"5.9.0",macos:"0.16.0"},"data-driven styling":{js:"1.2.0",android:"9.2.0",ios:"5.9.0",macos:"0.16.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},rw={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},"property-type":"constant"}},nw={"line-cap":{type:"enum",values:{butt:{doc:"A cap with a squared-off end which is drawn to the exact endpoint of the line."},round:{doc:"A cap with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},square:{doc:"A cap with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."}},default:"butt",doc:"The display of line endings.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{doc:"A join with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."},round:{doc:"A join with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},miter:{doc:"A join with a sharp, angled corner which is drawn with the outer sides beyond the endpoint of the path until they meet."}},default:"miter",doc:"The display of lines when joining.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"},"data-driven styling":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},ow={"symbol-placement":{type:"enum",values:{point:{doc:"The label is placed at the point where the geometry is located."},line:{doc:"The label is placed along the line of the geometry. Can only be used on `LineString` and `Polygon` geometries."},"line-center":{doc:"The label is placed at the center of the line of the geometry. Can only be used on `LineString` and `Polygon` geometries. Note that a single feature in a vector tile may contain multiple line geometries."}},default:"point",doc:"Label placement relative to its geometry.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`line-center` value":{js:"0.47.0",android:"6.4.0",ios:"4.3.0",macos:"0.10.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",doc:"Distance between two symbol anchors.",requires:[{"symbol-placement":"line"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,doc:"If true, the symbols will not cross tile edges to avoid mutual collisions. Recommended in layers that don't have enough padding in the vector tile to prevent collisions, or if it is a point symbol layer placed after a line symbol layer. When using a client that supports global collision detection, like Mapbox GL JS version 0.42.0 or greater, enabling this property is not needed to prevent clipped labels at tile boundaries.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with lower sort keys are drawn and placed first.  When `icon-allow-overlap` or `text-allow-overlap` is `false`, features with a lower sort key will have priority during placement. When `icon-allow-overlap` or `text-allow-overlap` is set to `true`, features with a higher sort key will overlap over features with a lower sort key.","sdk-support":{"basic functionality":{js:"0.53.0",android:"7.4.0",ios:"4.11.0",macos:"0.14.0"},"data-driven styling":{js:"0.53.0",android:"7.4.0",ios:"4.11.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{doc:"Sorts symbols by `symbol-sort-key` if set. Otherwise, sorts symbols by their y-position relative to the viewport if `icon-allow-overlap` or `text-allow-overlap` is set to `true` or `icon-ignore-placement` or `text-ignore-placement` is `false`."},"viewport-y":{doc:"Sorts symbols by their y-position relative to the viewport if `icon-allow-overlap` or `text-allow-overlap` is set to `true` or `icon-ignore-placement` or `text-ignore-placement` is `false`."},source:{doc:"Sorts symbols by `symbol-sort-key` if set. Otherwise, no sorting is applied; symbols are rendered in the same order as the source data."}},default:"auto",doc:"Determines whether overlapping symbols in the same layer are rendered in the order that they appear in the data source or by their y-position relative to the viewport. To control the order and prioritization of symbols otherwise, use `symbol-sort-key`.","sdk-support":{"basic functionality":{js:"0.49.0",android:"6.6.0",ios:"4.5.0",macos:"0.12.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,doc:"If true, the icon will be visible even if it collides with other previously drawn symbols.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,doc:"If true, other symbols can be visible even if they collide with the icon.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,doc:"If true, text will display without their corresponding icons when the icon collides with other symbols and the text does not.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{doc:"When `symbol-placement` is set to `point`, aligns icons east-west. When `symbol-placement` is set to `line` or `line-center`, aligns icon x-axes with the line."},viewport:{doc:"Produces icons whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line` or `line-center`, this is equivalent to `map`."}},default:"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of icons.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",doc:"Scales the original size of the icon by the provided factor. The new pixel size of the image will be the original pixel size multiplied by `icon-size`. 1 is the original size; 3 triples the size of the image.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{doc:"The icon is displayed at its intrinsic aspect ratio."},width:{doc:"The icon is scaled in the x-dimension to fit the width of the text."},height:{doc:"The icon is scaled in the y-dimension to fit the height of the text."},both:{doc:"The icon is scaled in both x- and y-dimensions."}},default:"none",doc:"Scales the icon to fit around the associated text.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"stretchable icons":{js:"1.6.0",android:"9.2.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",doc:"Size of the additional area added to dimensions determined by `icon-text-fit`, in clockwise order: top, right, bottom, left.",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",doc:"Name of image in sprite to use for drawing an image background.",tokens:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",doc:"Size of the additional area around the icon bounding box used for detecting symbol collisions.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down.",requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],doc:"Offset distance of icon from its anchor. Positive values indicate right and down, while negative values indicate left and up. Each component is multiplied by the value of `icon-size` to obtain the final offset in pixels. When combined with `icon-rotate` the offset will be as if the rotated direction was up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{doc:"The center of the icon is placed closest to the anchor."},left:{doc:"The left side of the icon is placed closest to the anchor."},right:{doc:"The right side of the icon is placed closest to the anchor."},top:{doc:"The top of the icon is placed closest to the anchor."},bottom:{doc:"The bottom of the icon is placed closest to the anchor."},"top-left":{doc:"The top left corner of the icon is placed closest to the anchor."},"top-right":{doc:"The top right corner of the icon is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the icon is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the icon is placed closest to the anchor."}},default:"center",doc:"Part of the icon placed closest to the anchor.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{doc:"The icon is aligned to the plane of the map."},viewport:{doc:"The icon is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `icon-rotation-alignment`."}},default:"auto",doc:"Orientation of icon when map is pitched.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{doc:"The text is aligned to the plane of the map."},viewport:{doc:"The text is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `text-rotation-alignment`."}},default:"auto",doc:"Orientation of text when map is pitched.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{doc:"When `symbol-placement` is set to `point`, aligns text east-west. When `symbol-placement` is set to `line` or `line-center`, aligns text x-axes with the line."},viewport:{doc:"Produces glyphs whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line` or `line-center`, this is equivalent to `map`."}},default:"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of the individual glyphs forming the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,doc:"Value to use for a text label. If a plain `string` is provided, it will be treated as a `formatted` with default/inherited formatting options. SDF images are not supported in formatted text and will be ignored.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],doc:"Font stack to use for displaying text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",doc:"Font size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",doc:"The maximum line width for text wrapping.",requires:["text-field",{"symbol-placement":["point"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",doc:"Text leading value for multi-line text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",doc:"Text tracking amount.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{doc:"The text is aligned towards the anchor position."},left:{doc:"The text is aligned to the left."},center:{doc:"The text is centered."},right:{doc:"The text is aligned to the right."}},default:"center",doc:"Text justification options.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"},auto:{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,doc:"Radial offset of text, in the direction of the symbol's anchor. Useful in combination with `text-variable-anchor`, which defaults to using the two-dimensional `text-offset` if present.","sdk-support":{"basic functionality":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"},"data-driven styling":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},requires:["text-field",{"symbol-placement":["point"]}],doc:"To increase the chance of placing high-priority labels on the map, you can provide an array of `text-anchor` locations: the renderer will attempt to place the label at each location, in order, before moving onto the next label. Use `text-justify: auto` to choose justification based on anchor position. To apply an offset, use the `text-radial-offset` or the two-dimensional `text-offset`.","sdk-support":{"basic functionality":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},default:"center",doc:"Part of the text placed closest to the anchor.",requires:["text-field",{"!":"text-variable-anchor"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{doc:"If a text's language supports horizontal writing mode, symbols would be laid out horizontally."},vertical:{doc:"If a text's language supports vertical writing mode, symbols would be laid out vertically."}},doc:"The property allows control over a symbol's orientation. Note that the property values act as a hint, so that a symbol whose language doesn\u2019t support the provided orientation will be laid out in its natural orientation. Example: English point symbol will be rendered horizontally even if array value contains single 'vertical' enum value. For symbol with point placement, the order of elements in an array define priority order for the placement of an orientation variant. For symbol with line placement, the default text writing mode is either ['horizontal', 'vertical'] or ['vertical', 'horizontal'], the order doesn't affect the placement.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"1.3.0",android:"8.3.0",ios:"5.3.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",doc:"Rotates the text clockwise.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",doc:"Size of the additional area around the text bounding box used for detecting symbol collisions.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{doc:"The text is not altered."},uppercase:{doc:"Forces all letters to be displayed in uppercase."},lowercase:{doc:"Forces all letters to be displayed in lowercase."}},default:"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",doc:"Offset distance of text from its anchor. Positive values indicate right and down, while negative values indicate left and up. If used with text-variable-anchor, input values will be taken as absolute values. Offsets along the x- and y-axis will be applied automatically based on the anchor position.",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,doc:"If true, the text will be visible even if it collides with other previously drawn symbols.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,doc:"If true, other symbols can be visible even if they collide with the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,doc:"If true, icons will display without their corresponding text when the text collides with other symbols and the icon does not.",requires:["text-field","icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},aw={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},sw={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},"property-type":"constant"}},lw={type:"array",value:"*",doc:"A filter selects specific features from a layer."},uw={type:"boolean",doc:'Expression which determines whether or not to display a symbol. Symbols support dynamic filtering, meaning this expression can use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},cw={type:"boolean",doc:'Expression which determines whether or not to display a polygon. Fill layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},hw={type:"boolean",doc:'Expression which determines whether or not to display a Polygon or LineString. Line layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},pw={type:"boolean",doc:'Expression which determines whether or not to display a circle. Circle layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},dw={type:"boolean",doc:'Expression used to determine whether a point is being displayed or not. Heatmap layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},fw={type:"enum",values:{"==":{doc:'`["==", key, value]` equality: `feature[key] = value`'},"!=":{doc:'`["!=", key, value]` inequality: `feature[key] \u2260 value`'},">":{doc:'`[">", key, value]` greater than: `feature[key] > value`'},">=":{doc:'`[">=", key, value]` greater than or equal: `feature[key] \u2265 value`'},"<":{doc:'`["<", key, value]` less than: `feature[key] < value`'},"<=":{doc:'`["<=", key, value]` less than or equal: `feature[key] \u2264 value`'},in:{doc:'`["in", key, v0, ..., vn]` set inclusion: `feature[key] \u2208 {v0, ..., vn}`'},"!in":{doc:'`["!in", key, v0, ..., vn]` set exclusion: `feature[key] \u2209 {v0, ..., vn}`'},all:{doc:'`["all", f0, ..., fn]` logical `AND`: `f0 \u2227 ... \u2227 fn`'},any:{doc:'`["any", f0, ..., fn]` logical `OR`: `f0 \u2228 ... \u2228 fn`'},none:{doc:'`["none", f0, ..., fn]` logical `NOR`: `\xACf0 \u2227 ... \u2227 \xACfn`'},has:{doc:'`["has", key]` `feature[key]` exists'},"!has":{doc:'`["!has", key]` `feature[key]` does not exist'},within:{doc:'`["within", object]` feature geometry is within object geometry'}},doc:"The filter operator."},mw={type:"enum",values:{Point:{doc:"Filter to point geometries."},LineString:{doc:"Filter to line geometries."},Polygon:{doc:"Filter to polygon geometries."}},doc:"The geometry type for the filter to select."},yw={type:"array",minimum:0,maximum:24,value:["number","color"],length:2,doc:"Zoom level and value pair."},gw={type:"array",value:"*",minimum:1,doc:"An expression defines a function that can be used for data-driven style properties or feature filters."},_w={doc:"",type:"enum",values:{let:{doc:'Binds expressions to named variables, which can then be referenced in the result expression using ["var", "variable_name"].',group:"Variable binding","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},var:{doc:'References variable bound using "let".',group:"Variable binding","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},literal:{doc:"Provides a literal array or object value.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},array:{doc:"Asserts that the input is an array (optionally with a specific item type and length).  If, when the input expression is evaluated, it is not of the asserted type, then this assertion will cause the whole expression to be aborted.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},at:{doc:"Retrieves an item from an array.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},in:{doc:"Determines whether an item exists in an array or a substring exists in a string. In the specific case when the second and third arguments are string literals, you must wrap at least one of them in a [`literal`](#types-literal) expression to hint correct interpretation to the [type system](#type-system).",group:"Lookup","sdk-support":{"basic functionality":{js:"1.6.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}}},"index-of":{doc:"Returns the first position at which an item can be found in an array or a substring can be found in a string, or `-1` if the input cannot be found. Accepts an optional index from where to begin the search.",group:"Lookup","sdk-support":{"basic functionality":{js:"1.10.0"}}},slice:{doc:"Returns an item from an array or a substring from a string from a specified start index, or between a start index and an end index if set. The return value is inclusive of the start index but not of the end index.",group:"Lookup","sdk-support":{"basic functionality":{js:"1.10.0"}}},case:{doc:"Selects the first output whose corresponding test condition evaluates to true, or the fallback value otherwise.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},match:{doc:'Selects the output for which the label value matches the input value, or the fallback value if no match is found. The input can be any expression (for example, `["get", "building_type"]`). Each label must be unique, and must be either:\n - a single literal value; or\n - an array of literal values, the values of which must be all strings or all numbers (for example `[100, 101]` or `["c", "b"]`).\n\nThe input matches if any of the values in the array matches using strict equality, similar to the `"in"` operator.\nIf the input type does not match the type of the labels, the result will be the fallback value.',group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},coalesce:{doc:"Evaluates each expression in turn until the first valid value is obtained. Invalid values are `null` and [`'image'`](#types-image) expressions that are unavailable in the style. If all values are invalid, `coalesce` returns the first value listed.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},step:{doc:'Produces discrete, stepped results by evaluating a piecewise-constant function defined by pairs of input and output values ("stops"). The `input` may be any numeric expression (e.g., `["get", "population"]`). Stop inputs must be numeric literals in strictly ascending order. Returns the output value of the stop just less than the input, or the first output if the input is less than the first stop.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},interpolate:{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). The `input` may be any numeric expression (e.g., `["get", "population"]`). Stop inputs must be numeric literals in strictly ascending order. The output type must be `number`, `array<number>`, or `color`.\n\nInterpolation types:\n- `["linear"]`: Interpolates linearly between the pair of stops just less than and just greater than the input.\n- `["exponential", base]`: Interpolates exponentially between the stops just less than and just greater than the input. `base` controls the rate at which the output increases: higher values make the output increase more towards the high end of the range. With values close to 1 the output increases linearly.\n- `["cubic-bezier", x1, y1, x2, y2]`: Interpolates using the cubic bezier curve defined by the given control points.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"interpolate-hcl":{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). Works like `interpolate`, but the output type must be `color`, and the interpolation is performed in the Hue-Chroma-Luminance color space.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.49.0"}}},"interpolate-lab":{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). Works like `interpolate`, but the output type must be `color`, and the interpolation is performed in the CIELAB color space.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.49.0"}}},ln2:{doc:"Returns mathematical constant ln(2).",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},pi:{doc:"Returns the mathematical constant pi.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},e:{doc:"Returns the mathematical constant e.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},typeof:{doc:"Returns a string describing the type of the given value.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},string:{doc:"Asserts that the input value is a string. If multiple values are provided, each one is evaluated in order until a string is obtained. If none of the inputs are strings, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},number:{doc:"Asserts that the input value is a number. If multiple values are provided, each one is evaluated in order until a number is obtained. If none of the inputs are numbers, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},boolean:{doc:"Asserts that the input value is a boolean. If multiple values are provided, each one is evaluated in order until a boolean is obtained. If none of the inputs are booleans, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},object:{doc:"Asserts that the input value is an object. If multiple values are provided, each one is evaluated in order until an object is obtained. If none of the inputs are objects, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},collator:{doc:"Returns a `collator` for use in locale-dependent comparison operations. The `case-sensitive` and `diacritic-sensitive` options default to `false`. The `locale` argument specifies the IETF language tag of the locale to use. If none is provided, the default locale is used. If the requested locale is not available, the `collator` will use a system-defined fallback locale. Use `resolved-locale` to test the results of locale fallback behavior.",group:"Types","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},format:{doc:'Returns a `formatted` string for displaying mixed-format text in the `text-field` property. The input may contain a string literal or expression, including an [`\'image\'`](#types-image) expression. Strings may be followed by a style override object that supports the following properties:\n- `"text-font"`: Overrides the font stack specified by the root layout property.\n- `"text-color"`: Overrides the color specified by the root paint property.\n- `"font-scale"`: Applies a scaling factor on `text-size` as specified by the root layout property.',group:"Types","sdk-support":{"basic functionality":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"text-font":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"font-scale":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"text-color":{js:"1.3.0",android:"7.3.0",ios:"4.10.0",macos:"0.14.0"},image:{js:"1.6.0",android:"8.6.0",ios:"5.7.0",macos:"0.15.0"}}},image:{doc:"Returns a [`ResolvedImage`](/mapbox-gl-js/style-spec/types/#resolvedimage) for use in [`icon-image`](/mapbox-gl-js/style-spec/layers/#layout-symbol-icon-image), `*-pattern` entries, and as a section in the [`'format'`](#types-format) expression. A [`'coalesce'`](#coalesce) expression containing `image` expressions will evaluate to the first listed image that is currently in the style. This validation process is synchronous and requires the image to have been added to the style before requesting it in the `'image'` argument.",group:"Types","sdk-support":{"basic functionality":{js:"1.4.0",android:"8.6.0",ios:"5.7.0",macos:"0.15.0"}}},"number-format":{doc:"Converts the input number into a string representation using the providing formatting rules. If set, the `locale` argument specifies the locale to use, as a BCP 47 language tag. If set, the `currency` argument specifies an ISO 4217 code to use for currency-style formatting. If set, the `min-fraction-digits` and `max-fraction-digits` arguments specify the minimum and maximum number of fractional digits to include.",group:"Types","sdk-support":{"basic functionality":{js:"0.54.0",android:"8.4.0",ios:"5.4.0",macos:"0.15.0"}}},"to-string":{doc:'Converts the input value to a string. If the input is `null`, the result is `""`. If the input is a [`boolean`](#types-boolean), the result is `"true"` or `"false"`. If the input is a number, it is converted to a string as specified by the ["NumberToString" algorithm](https://tc39.github.io/ecma262/#sec-tostring-applied-to-the-number-type) of the ECMAScript Language Specification. If the input is a [`color`](#color), it is converted to a string of the form `"rgba(r,g,b,a)"`, where `r`, `g`, and `b` are numerals ranging from 0 to 255, and `a` ranges from 0 to 1. If the input is an [`\'image\'`](#types-image) expression, `\'to-string\'` returns the image name. Otherwise, the input is converted to a string in the format specified by the [`JSON.stringify`](https://tc39.github.io/ecma262/#sec-json.stringify) function of the ECMAScript Language Specification.',group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-number":{doc:'Converts the input value to a number, if possible. If the input is `null` or `false`, the result is 0. If the input is `true`, the result is 1. If the input is a string, it is converted to a number as specified by the ["ToNumber Applied to the String Type" algorithm](https://tc39.github.io/ecma262/#sec-tonumber-applied-to-the-string-type) of the ECMAScript Language Specification. If multiple values are provided, each one is evaluated in order until the first successful conversion is obtained. If none of the inputs can be converted, the expression is an error.',group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-boolean":{doc:"Converts the input value to a boolean. The result is `false` when then input is an empty string, 0, `false`, `null`, or `NaN`; otherwise it is `true`.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-rgba":{doc:"Returns a four-element array containing the input color's red, green, blue, and alpha components, in that order.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-color":{doc:"Converts the input value to a color. If multiple values are provided, each one is evaluated in order until the first successful conversion is obtained. If none of the inputs can be converted, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},rgb:{doc:"Creates a color value from red, green, and blue components, which must range between 0 and 255, and an alpha component of 1. If any component is out of range, the expression is an error.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},rgba:{doc:"Creates a color value from red, green, blue components, which must range between 0 and 255, and an alpha component which must range between 0 and 1. If any component is out of range, the expression is an error.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},get:{doc:"Retrieves a property value from the current feature's properties, or from another object if a second argument is provided. Returns `null` if the requested property is missing.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},has:{doc:"Tests for the presence of an property value in the current feature's properties, or from another object if a second argument is provided.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},length:{doc:"Returns the length of an array or string.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},properties:{doc:'Returns the feature properties object.  Note that in some cases, it may be more efficient to use `["get", "property_name"]` directly.',group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"feature-state":{doc:"Retrieves a property value from the current feature's state. Returns `null` if the requested property is not present on the feature's state. A feature's state is not part of the GeoJSON or vector tile data, and must be set programmatically on each feature. Features are identified by their `id` attribute, which must be an integer or a string that can be cast to an integer. Note that [\"feature-state\"] can only be used with paint properties that support data-driven styling.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.46.0"}}},"geometry-type":{doc:"Returns the feature's geometry type: `Point`, `MultiPoint`, `LineString`, `MultiLineString`, `Polygon`, `MultiPolygon`. `Multi*` feature types are only returned in GeoJSON sources. When working with vector tile sources, use the singular forms.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},id:{doc:"Returns the feature's id, if it has one.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},zoom:{doc:'Returns the current zoom level.  Note that in style layout and paint properties, ["zoom"] may only appear as the input to a top-level "step" or "interpolate" expression.',group:"Camera","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},pitch:{doc:'Returns the current pitch in degrees. `["pitch"]` may only be used in the `filter` expression for a `symbol` layer.',group:"Camera","sdk-support":{"basic functionality":{js:"2.6.0"}}},"distance-from-center":{doc:'Returns the distance of a `symbol` instance from the center of the map. The distance is measured in pixels divided by the height of the map container. It measures 0 at the center, decreases towards the camera and increase away from the camera. For example, if the height of the map is 1000px, a value of -1 means 1000px away from the center towards the camera, and a value of 1 means a distance of 1000px away from the camera from the center. `["distance-from-center"]` may only be used in the `filter` expression for a `symbol` layer.',group:"Camera","sdk-support":{"basic functionality":{js:"2.6.0"}}},"heatmap-density":{doc:"Returns the kernel density estimation of a pixel in a heatmap layer, which is a relative measure of how many data points are crowded around a particular pixel. Can only be used in the `heatmap-color` property.",group:"Heatmap","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"line-progress":{doc:"Returns the progress along a gradient line. Can only be used in the `line-gradient` property.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.6.0",macos:"0.12.0"}}},"sky-radial-progress":{doc:"Returns the distance of a point on the sky from the sun position. Returns 0 at sun position and 1 when the distance reaches `sky-gradient-radius`. Can only be used in the `sky-gradient` property.",group:"sky","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}},accumulated:{doc:"Returns the value of a cluster property accumulated so far. Can only be used in the `clusterProperties` option of a clustered GeoJSON source.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.53.0",android:"8.4.0",ios:"5.5.0",macos:"0.15.0"}}},"+":{doc:"Returns the sum of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"*":{doc:"Returns the product of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"-":{doc:"For two inputs, returns the result of subtracting the second input from the first. For a single input, returns the result of subtracting it from 0.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"/":{doc:"Returns the result of floating point division of the first input by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"%":{doc:"Returns the remainder after integer division of the first input by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"^":{doc:"Returns the result of raising the first input to the power specified by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},sqrt:{doc:"Returns the square root of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},log10:{doc:"Returns the base-ten logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},ln:{doc:"Returns the natural logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},log2:{doc:"Returns the base-two logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},sin:{doc:"Returns the sine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},cos:{doc:"Returns the cosine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},tan:{doc:"Returns the tangent of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},asin:{doc:"Returns the arcsine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},acos:{doc:"Returns the arccosine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},atan:{doc:"Returns the arctangent of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},min:{doc:"Returns the minimum value of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},max:{doc:"Returns the maximum value of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},round:{doc:'Rounds the input to the nearest integer. Halfway values are rounded away from zero. For example, `["round", -1.5]` evaluates to -2.',group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},abs:{doc:"Returns the absolute value of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},ceil:{doc:"Returns the smallest integer that is greater than or equal to the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},floor:{doc:"Returns the largest integer that is less than or equal to the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},distance:{doc:"Returns the shortest distance in meters between the evaluated feature and the input geometry. The input value can be a valid GeoJSON of type `Point`, `MultiPoint`, `LineString`, `MultiLineString`, `Polygon`, `MultiPolygon`, `Feature`, or `FeatureCollection`. Distance values returned may vary in precision due to loss in precision from encoding geometries, particularly below zoom level 13.",group:"Math","sdk-support":{"basic functionality":{android:"9.2.0",ios:"5.9.0",macos:"0.16.0"}}},"==":{doc:"Returns `true` if the input values are equal, `false` otherwise. The comparison is strictly typed: values of different runtime types are always considered unequal. Cases where the types are known to be different at parse time are considered invalid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"!=":{doc:"Returns `true` if the input values are not equal, `false` otherwise. The comparison is strictly typed: values of different runtime types are always considered unequal. Cases where the types are known to be different at parse time are considered invalid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},">":{doc:"Returns `true` if the first input is strictly greater than the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"<":{doc:"Returns `true` if the first input is strictly less than the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},">=":{doc:"Returns `true` if the first input is greater than or equal to the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"<=":{doc:"Returns `true` if the first input is less than or equal to the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},all:{doc:"Returns `true` if all the inputs are `true`, `false` otherwise. The inputs are evaluated in order, and evaluation is short-circuiting: once an input expression evaluates to `false`, the result is `false` and no further input expressions are evaluated.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},any:{doc:"Returns `true` if any of the inputs are `true`, `false` otherwise. The inputs are evaluated in order, and evaluation is short-circuiting: once an input expression evaluates to `true`, the result is `true` and no further input expressions are evaluated.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"!":{doc:"Logical negation. Returns `true` if the input is `false`, and `false` if the input is `true`.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},within:{doc:"Returns `true` if the evaluated feature is fully contained inside a boundary of the input geometry, `false` otherwise. The input value can be a valid GeoJSON of type `Polygon`, `MultiPolygon`, `Feature`, or `FeatureCollection`. Supported features for evaluation:\n- `Point`: Returns `false` if a point is on the boundary or falls outside the boundary.\n- `LineString`: Returns `false` if any part of a line falls outside the boundary, the line intersects the boundary, or a line's endpoint is on the boundary.",group:"Decision","sdk-support":{"basic functionality":{js:"1.9.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}}},"is-supported-script":{doc:"Returns `true` if the input string is expected to render legibly. Returns `false` if the input string contains sections that cannot be rendered without potential loss of meaning (e.g. Indic scripts that require complex text shaping, or right-to-left scripts if the the `mapbox-gl-rtl-text` plugin is not in use in Mapbox GL JS).",group:"String","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.6.0"}}},upcase:{doc:"Returns the input string converted to uppercase. Follows the Unicode Default Case Conversion algorithm and the locale-insensitive case mappings in the Unicode Character Database.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},downcase:{doc:"Returns the input string converted to lowercase. Follows the Unicode Default Case Conversion algorithm and the locale-insensitive case mappings in the Unicode Character Database.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},concat:{doc:"Returns a `string` consisting of the concatenation of the inputs. Each input is converted to a string as if by `to-string`.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"resolved-locale":{doc:"Returns the IETF language tag of the locale being used by the provided `collator`. This can be used to determine the default system locale, or to determine if a requested locale was successfully loaded.",group:"String","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}}}},vw={range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},doc:"The start and end distance range in which fog fades from fully transparent to fully opaque. The distance to the point at the center of the map is defined as zero, so that negative range values are closer to the camera, and positive values are farther away.",example:[.5,10],"sdk-support":{"basic functionality":{js:"2.3.0"}}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"The color of the fog. Using opacity is recommended only for smoothly transitioning fog on/off as anything less than 100% opacity results in more tiles loaded and drawn.","sdk-support":{"basic functionality":{js:"2.3.0"}}},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Horizon blend applies a smooth fade from the color of the fog to the color of the sky. A value of zero leaves a sharp transition from fog to sky. Increasing the value blends the color of fog into increasingly high angles of the sky.","sdk-support":{"basic functionality":{js:"2.3.0"}}}},xw={anchor:{type:"enum",default:"viewport",values:{map:{doc:"The position of the light source is aligned to the rotation of the map."},viewport:{doc:"The position of the light source is aligned to the rotation of the viewport."}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]},doc:"Whether extruded geometries are lit relative to the map or viewport.",example:"map","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},doc:"Position of the light source relative to lit (extruded) geometries, in [r radial coordinate, a azimuthal angle, p polar angle] where r indicates the distance from the center of the base of an object to its light, a indicates the position of the light relative to 0\xB0 (0\xB0 when `light.anchor` is set to `viewport` corresponds to the top of the viewport, or 0\xB0 when `light.anchor` is set to `map` corresponds to due north, and degrees proceed clockwise), and p indicates the height of the light (from 0\xB0, directly above, to 180\xB0, directly below).",example:[1.5,90,80],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Color tint for lighting extruded geometries.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Intensity of lighting (on a scale from 0 to 1). Higher numbers will present as more extreme contrast.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}}},bw={name:{type:"enum",values:{albers:{doc:"An Albers equal-area projection centered on the continental United States. You can configure the projection for a different region by setting `center` and `parallels` properties. You may want to set max bounds to constrain the map to the relevant region."},equalEarth:{doc:"An Equal Earth projection."},equirectangular:{doc:"An Equirectangular projection. This projection is very similar to the Plate Carr\xE9e projection."},lambertConformalConic:{doc:"A Lambert conformal conic projection. You can configure the projection for a region by setting `center` and `parallels` properties. You may want to set max bounds to constrain the map to the relevant region."},mercator:{doc:"The Mercator projection is the default projection."},naturalEarth:{doc:"A Natural Earth projection."},winkelTripel:{doc:"A Winkel Tripel projection."}},default:"mercator",doc:"The name of the projection to be used for rendering the map.",required:!0,"sdk-support":{"basic functionality":{js:"2.6.0"}}},center:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,doc:"The reference longitude and latitude of the projection. `center` takes the form of [lng, lat]. This property is only configurable for conic projections (Albers and Lambert Conformal Conic). All other projections are centered on [0, 0].",example:[-96,37.5],requires:[{name:["albers","lambertConformalConic"]}],"sdk-support":{"basic functionality":{js:"2.6.0"}}},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,doc:"The standard parallels of the projection, denoting the desired latitude range with minimal distortion. `parallels` takes the form of [lat0, lat1]. This property is only configurable for conic projections (Albers and Lambert Conformal Conic).",example:[29.5,45.5],requires:[{name:["albers","lambertConformalConic"]}],"sdk-support":{"basic functionality":{js:"2.6.0"}}}},ww={source:{type:"string",doc:"Name of a source of `raster_dem` type to be used for terrain elevation.",required:!0,"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Exaggerates the elevation of the terrain by multiplying the data from the DEM with this value.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}}},Ew=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],Iw={"fill-antialias":{type:"boolean",default:!0,doc:"Whether or not the fill should be antialiased.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire fill layer. In contrast to the `fill-color`, this value will also affect the 1px stroke around the fill, if the stroke is used.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",doc:"The color of the filled part of this layer. This color can be specified as `rgba` with an alpha component and the color's opacity will not affect the opacity of the 1px stroke, if it is used.",transition:!0,requires:[{"!":"fill-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{doc:"The fill is translated relative to the map."},viewport:{doc:"The fill is translated relative to the viewport."}},doc:"Controls the frame of reference for `fill-translate`.",default:"map",requires:["fill-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing image fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},Sw={"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",doc:"The color with which the line will be drawn.",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.23.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{doc:"The line is translated relative to the map."},viewport:{doc:"The line is translated relative to the viewport."}},doc:"Controls the frame of reference for `line-translate`.",default:"map",requires:["line-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",doc:"Stroke thickness.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.",transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,doc:"The line's offset. For linear features, a positive value offsets the line to the right, relative to the direction of the line, and a negative value to the left. For polygon features, a positive value results in an inset, and a negative value results in an outset.",transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.12.1",android:"3.0.0",ios:"3.1.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width. Note that GeoJSON sources with `lineMetrics: true` specified won't render dashed lines to the expected scale. Also note that zoom-dependent expressions will be evaluated only at integer zoom levels.",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing image lines. For seamless patterns, image width must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",doc:'Defines a gradient with which to color a line feature. Can only be used with GeoJSON sources that specify `"lineMetrics": true`.',transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],"sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.4.0",macos:"0.11.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},Tw={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",doc:"Circle radius.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",doc:"The fill color of the circle.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,doc:"Amount to blur the circle. 1 blurs the circle such that only the centerpoint is full opacity.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",doc:"The opacity at which the circle will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{doc:"The circle is translated relative to the map."},viewport:{doc:"The circle is translated relative to the viewport."}},doc:"Controls the frame of reference for `circle-translate`.",default:"map",requires:["circle-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{doc:"Circles are scaled according to their apparent distance to the camera."},viewport:{doc:"Circles are not scaled."}},default:"map",doc:"Controls the scaling behavior of the circle when the map is pitched.","sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{doc:"The circle is aligned to the plane of the map."},viewport:{doc:"The circle is aligned to the plane of the viewport."}},default:"viewport",doc:"Orientation of circle when map is pitched.","sdk-support":{"basic functionality":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"The width of the circle's stroke. Strokes are placed outside of the `circle-radius`.","sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",doc:"The stroke color of the circle.",transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",doc:"The opacity of the circle's stroke.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},Aw={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",doc:"Radius of influence of one heatmap point in pixels. Increasing the value makes the heatmap smoother, but less detailed. `queryRenderedFeatures` on heatmap layers will return points within this radius.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,doc:"A measure of how much an individual point contributes to the heatmap. A value of 10 would be equivalent to having 10 points of weight 1 in the same spot. Especially useful when combined with clustering.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,doc:"Similar to `heatmap-weight` but controls the intensity of the heatmap globally. Primarily used for adjusting the heatmap based on zoom level.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],doc:'Defines the color of each pixel based on its density value in a heatmap.  Should be an expression that uses `["heatmap-density"]` as input.',transition:!1,"sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",doc:"The global opacity at which the heatmap layer will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Cw={"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,doc:"The color of the icon. This can only be used with [SDF icons](/help/troubleshooting/using-recolorable-images-in-mapbox-maps/).",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,doc:"The color of the icon's halo. Icon halos can only be used with [SDF icons](/help/troubleshooting/using-recolorable-images-in-mapbox-maps/).",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"Distance that the icon's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{doc:"Icons are translated relative to the map."},viewport:{doc:"Icons are translated relative to the viewport."}},doc:"Controls the frame of reference for `icon-translate`.",default:"map",requires:["icon-image","icon-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",doc:"The color with which the text will be drawn.",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"Distance that the text's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{doc:"The text is translated relative to the map."},viewport:{doc:"The text is translated relative to the viewport."}},doc:"Controls the frame of reference for `text-translate`.",default:"map",requires:["text-field","text-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},kw={"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",doc:"Rotates hues around the color wheel.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.",default:0,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.",default:0,minimum:-1,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.",default:0,minimum:-1,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",doc:"The resampling/interpolation method to use for overscaling, also known as texture magnification filter",values:{linear:{doc:"(Bi)linear filtering interpolates pixel values using the weighted average of the four closest original source pixels creating a smooth but blurry look when overscaled"},nearest:{doc:"Nearest neighbor filtering interpolates pixel values using the nearest original source pixel creating a sharp but pixelated look when overscaled"}},default:"linear","sdk-support":{"basic functionality":{js:"0.47.0",android:"6.3.0",ios:"4.2.0",macos:"0.9.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",doc:"Fade duration when a new tile is added.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},zw={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,doc:"The direction of the light source used to generate the hillshading with 0 as the top of the viewport if `hillshade-illumination-anchor` is set to `viewport` and due north if `hillshade-illumination-anchor` is set to `map`.",transition:!1,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{doc:"The hillshade illumination is relative to the north direction."},viewport:{doc:"The hillshade illumination is relative to the top of the viewport."}},default:"viewport",doc:"Direction of light source when map is rotated.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",doc:"Intensity of the hillshade",default:.5,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",doc:"The shading color of areas that face away from the light source.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",doc:"The shading color of areas that faces towards the light source.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",doc:"The shading color used to accentuate rugged terrain like sharp cliffs and gorges.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Pw={"background-color":{type:"color",default:"#000000",doc:"The color with which the background will be drawn.",transition:!0,requires:[{"!":"background-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing an image background. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Mw={"sky-type":{type:"enum",values:{gradient:{doc:"Renders the sky with a gradient that can be configured with `sky-gradient-radius` and `sky-gradient`."},atmosphere:{doc:"Renders the sky with a simulated atmospheric scattering algorithm, the sun direction can be attached to the light position or explicitly set through `sky-atmosphere-sun`."}},default:"atmosphere",doc:"The type of the sky","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,doc:"Position of the sun center [a azimuthal angle, p polar angle]. The azimuthal angle indicates the position of the sun relative to 0\xB0 north, where degrees proceed clockwise. The polar angle indicates the height of the sun, where 0\xB0 is directly above, at zenith, and 90\xB0 at the horizon. When this property is ommitted, the sun center is directly inherited from the light position.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,doc:"Intensity of the sun as a light source in the atmosphere (on a scale from 0 to a 100). Setting higher values will brighten up the sky.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,doc:"Position of the gradient center [a azimuthal angle, p polar angle]. The azimuthal angle indicates the position of the gradient center relative to 0\xB0 north, where degrees proceed clockwise. The polar angle indicates the height of the gradient center, where 0\xB0 is directly above, at zenith, and 90\xB0 at the horizon.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,doc:"The angular distance (measured in degrees) from `sky-gradient-center` up to which the gradient extends. A value of 180 causes the gradient to wrap around to the opposite direction from `sky-gradient-center`.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],doc:"Defines a radial color gradient with which to color the sky. The color values can be interpolated with an expression using `sky-radial-progress`. The range [0, 1] for the interpolant covers a radial distance (in degrees) of [0, `sky-gradient-radius`] centered at the position specified by `sky-gradient-center`.",transition:!1,requires:[{"sky-type":"gradient"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",doc:"A color applied to the atmosphere sun halo. The alpha channel describes how strongly the sun halo is represented in an atmosphere sky layer.",transition:!1,requires:[{"sky-type":"atmosphere"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",doc:"A color used to tweak the main atmospheric scattering coefficients. Using white applies the default coefficients giving the natural blue color to the atmosphere. This color affects how heavily the corresponding wavelength is represented during scattering. The alpha channel describes the density of the atmosphere, with 1 maximum density and 0 no density.",transition:!1,requires:[{"sky-type":"atmosphere"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire sky layer.",transition:!0,"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Lw={duration:{type:"number",default:300,minimum:0,units:"milliseconds",doc:"Time allotted for transitions to complete."},delay:{type:"number",default:0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}},Dw={"*":{type:"string",doc:"A name of a feature property to use as ID for feature state."}},Rw={$version:jb,$root:Vb,sources:qb,source:Gb,source_vector:Zb,source_raster:Hb,source_raster_dem:Wb,source_geojson:Xb,source_video:Kb,source_image:Jb,layer:$b,layout:Yb,layout_background:Qb,layout_sky:ew,layout_fill:tw,layout_circle:iw,layout_heatmap:rw,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},"property-type":"constant"}},layout_line:nw,layout_symbol:ow,layout_raster:aw,layout_hillshade:sw,filter:lw,filter_symbol:uw,filter_fill:cw,filter_line:hw,filter_circle:pw,"filter_fill-extrusion":{type:"boolean",doc:'Expression which determines whether or not to display a Polygon. Fill-extrusion layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:dw,filter_operator:fw,geometry_type:mw,function:{expression:{type:"expression",doc:"An expression."},stops:{type:"array",doc:"An array of stops.",value:"function_stop"},base:{type:"number",default:1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."},property:{type:"string",doc:"The name of a feature property to use as the function input.",default:"$zoom"},type:{type:"enum",values:{identity:{doc:"Return the input value as the output value."},exponential:{doc:"Generate an output by interpolating between stops just less than and just greater than the function input."},interval:{doc:"Return the output value of the stop just less than the function input."},categorical:{doc:"Return the output value of the stop equal to the function input."}},doc:"The interpolation strategy to use in function evaluation.",default:"exponential"},colorSpace:{type:"enum",values:{rgb:{doc:"Use the RGB color space to interpolate color values"},lab:{doc:"Use the LAB color space to interpolate color values."},hcl:{doc:"Use the HCL color space to interpolate color values, interpolating the Hue, Chroma, and Luminance channels individually."}},doc:"The color space in which colors interpolated. Interpolating colors in perceptual color spaces like LAB and HCL tend to produce color ramps that look more consistent and produce colors that can be differentiated more easily than those interpolated in RGB space.",default:"rgb"},default:{type:"*",required:!1,doc:`A value to serve as a fallback function result when a value isn't otherwise available. It is used in the following circumstances:
* In categorical functions, when the feature value does not match any of the stop domain values.
* In property and zoom-and-property functions, when a feature does not contain a value for the specified property.
* In identity functions, when the feature value is not valid for the style property (for example, if the function is being used for a \`circle-color\` property but the feature property value is not a string or not a valid color).
* In interval or exponential property and zoom-and-property functions, when the feature value is not numeric.
If no default is provided, the style property's default is used in these circumstances.`}},function_stop:yw,expression:gw,expression_name:_w,fog:vw,light:xw,projection:bw,terrain:ww,paint:Ew,paint_fill:Iw,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire fill extrusion layer. This is rendered on a per-layer, not per-feature, basis, and data-driven styling is not available.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",doc:"The base color of the extruded fill. The extrusion's surfaces will be shaded differently based on this color in combination with the root `light` settings. If this color is specified as `rgba` with an alpha component, the alpha component will be ignored; use `fill-extrusion-opacity` to set layer opacity.",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up (on the flat plane), respectively.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{doc:"The fill extrusion is translated relative to the map."},viewport:{doc:"The fill extrusion is translated relative to the viewport."}},doc:"Controls the frame of reference for `fill-extrusion-translate`.",default:"map",requires:["fill-extrusion-translate"],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing images on extruded fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",doc:"The height with which to extrude this layer.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",doc:"The height with which to extrude the base of this layer. Must be less than or equal to `fill-extrusion-height`.",transition:!0,requires:["fill-extrusion-height"],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,doc:"Whether to apply a vertical gradient to the sides of a fill-extrusion layer. If true, sides will be shaded slightly darker farther down.",transition:!1,"sdk-support":{"basic functionality":{js:"0.50.0",android:"7.0.0",ios:"4.7.0",macos:"0.13.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:Sw,paint_circle:Tw,paint_heatmap:Aw,paint_symbol:Cw,paint_raster:kw,paint_hillshade:zw,paint_background:Pw,paint_sky:Mw,transition:Lw,"property-type":{"data-driven":{type:"property-type",doc:"Property is interpolable and can be represented using a property expression."},"cross-faded":{type:"property-type",doc:"Property is non-interpolable; rather, its values will be cross-faded to smoothly transition between integer zooms."},"cross-faded-data-driven":{type:"property-type",doc:"Property is non-interpolable; rather, its values will be cross-faded to smoothly transition between integer zooms. It can be represented using a property expression."},"color-ramp":{type:"property-type",doc:"Property should be specified using a color ramp from which the output color can be sampled based on a property calculation."},"data-constant":{type:"property-type",doc:"Property is interpolable but cannot be represented using a property expression."},constant:{type:"property-type",doc:"Property is constant across all zoom levels and property values."}},promoteId:Dw},yy=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function em(u){var r={exports:{}};return u(r,r.exports),r.exports}function Bw(u){throw new Error('Could not dynamically require "'+u+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}/*! https://mths.be/punycode v1.3.2 by @mathias */em(function(u,r){(function(s){var g=r&&!r.nodeType&&r,w=u&&!u.nodeType&&u,z=typeof yy=="object"&&yy;(z.global===z||z.window===z||z.self===z)&&(s=z);var f,h=2147483647,D=36,N=1,F=26,G=38,H=700,Pe=72,ke=128,We="-",je=/^xn--/,yt=/[^\x20-\x7E]/,Ne=/[\x2E\u3002\uFF0E\uFF61]/g,Ze={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},vt=D-N,ct=Math.floor,pt=String.fromCharCode,lt;function fi(Rt){throw RangeError(Ze[Rt])}function Et(Rt,ai){for(var yi=Rt.length,Fi=[];yi--;)Fi[yi]=ai(Rt[yi]);return Fi}function Wt(Rt,ai){var yi=Rt.split("@"),Fi="";yi.length>1&&(Fi=yi[0]+"@",Rt=yi[1]),Rt=Rt.replace(Ne,".");var jt=Rt.split("."),Xi=Et(jt,ai).join(".");return Fi+Xi}function Ei(Rt){for(var ai=[],yi=0,Fi=Rt.length,jt,Xi;yi<Fi;)jt=Rt.charCodeAt(yi++),jt>=55296&&jt<=56319&&yi<Fi?(Xi=Rt.charCodeAt(yi++),(Xi&64512)==56320?ai.push(((jt&1023)<<10)+(Xi&1023)+65536):(ai.push(jt),yi--)):ai.push(jt);return ai}function qi(Rt){return Et(Rt,function(ai){var yi="";return ai>65535&&(ai-=65536,yi+=pt(ai>>>10&1023|55296),ai=56320|ai&1023),yi+=pt(ai),yi}).join("")}function Xt(Rt){return Rt-48<10?Rt-22:Rt-65<26?Rt-65:Rt-97<26?Rt-97:D}function Qt(Rt,ai){return Rt+22+75*(Rt<26)-((ai!=0)<<5)}function Ai(Rt,ai,yi){var Fi=0;for(Rt=yi?ct(Rt/H):Rt>>1,Rt+=ct(Rt/ai);Rt>vt*F>>1;Fi+=D)Rt=ct(Rt/vt);return ct(Fi+(vt+1)*Rt/(Rt+G))}function bt(Rt){var ai=[],yi=Rt.length,Fi,jt=0,Xi=ke,Ri=Pe,Ii,rr,zi,zt,tr,Bt,rt,_i,ir;for(Ii=Rt.lastIndexOf(We),Ii<0&&(Ii=0),rr=0;rr<Ii;++rr)Rt.charCodeAt(rr)>=128&&fi("not-basic"),ai.push(Rt.charCodeAt(rr));for(zi=Ii>0?Ii+1:0;zi<yi;){for(zt=jt,tr=1,Bt=D;zi>=yi&&fi("invalid-input"),rt=Xt(Rt.charCodeAt(zi++)),(rt>=D||rt>ct((h-jt)/tr))&&fi("overflow"),jt+=rt*tr,_i=Bt<=Ri?N:Bt>=Ri+F?F:Bt-Ri,!(rt<_i);Bt+=D)ir=D-_i,tr>ct(h/ir)&&fi("overflow"),tr*=ir;Fi=ai.length+1,Ri=Ai(jt-zt,Fi,zt==0),ct(jt/Fi)>h-Xi&&fi("overflow"),Xi+=ct(jt/Fi),jt%=Fi,ai.splice(jt++,0,Xi)}return qi(ai)}function Gi(Rt){var ai,yi,Fi,jt,Xi,Ri,Ii,rr,zi,zt,tr,Bt=[],rt,_i,ir,Pr;for(Rt=Ei(Rt),rt=Rt.length,ai=ke,yi=0,Xi=Pe,Ri=0;Ri<rt;++Ri)tr=Rt[Ri],tr<128&&Bt.push(pt(tr));for(Fi=jt=Bt.length,jt&&Bt.push(We);Fi<rt;){for(Ii=h,Ri=0;Ri<rt;++Ri)tr=Rt[Ri],tr>=ai&&tr<Ii&&(Ii=tr);for(_i=Fi+1,Ii-ai>ct((h-yi)/_i)&&fi("overflow"),yi+=(Ii-ai)*_i,ai=Ii,Ri=0;Ri<rt;++Ri)if(tr=Rt[Ri],tr<ai&&++yi>h&&fi("overflow"),tr==ai){for(rr=yi,zi=D;zt=zi<=Xi?N:zi>=Xi+F?F:zi-Xi,!(rr<zt);zi+=D)Pr=rr-zt,ir=D-zt,Bt.push(pt(Qt(zt+Pr%ir,0))),rr=ct(Pr/ir);Bt.push(pt(Qt(rr,0))),Xi=Ai(yi,_i,Fi==jt),yi=0,++Fi}++yi,++ai}return Bt.join("")}function mr(Rt){return Wt(Rt,function(ai){return je.test(ai)?bt(ai.slice(4).toLowerCase()):ai})}function Ar(Rt){return Wt(Rt,function(ai){return yt.test(ai)?"xn--"+Gi(ai):ai})}if(f={version:"1.3.2",ucs2:{decode:Ei,encode:qi},decode:bt,encode:Gi,toASCII:Ar,toUnicode:mr},g&&w)if(u.exports==g)w.exports=f;else for(lt in f)f.hasOwnProperty(lt)&&(g[lt]=f[lt]);else s.punycode=f})(yy)});function Ow(u,r){return Object.prototype.hasOwnProperty.call(u,r)}var Fw=function(u,r,s,g){r=r||"&",s=s||"=";var w={};if(typeof u!="string"||u.length===0)return w;var z=/\+/g;u=u.split(r);var f=1e3;g&&typeof g.maxKeys=="number"&&(f=g.maxKeys);var h=u.length;f>0&&h>f&&(h=f);for(var D=0;D<h;++D){var N=u[D].replace(z,"%20"),F=N.indexOf(s),G,H,Pe,ke;F>=0?(G=N.substr(0,F),H=N.substr(F+1)):(G=N,H=""),Pe=decodeURIComponent(G),ke=decodeURIComponent(H),Ow(w,Pe)?Array.isArray(w[Pe])?w[Pe].push(ke):w[Pe]=[w[Pe],ke]:w[Pe]=ke}return w},zd=function(u){switch(typeof u){case"string":return u;case"boolean":return u?"true":"false";case"number":return isFinite(u)?u:"";default:return""}},Uw=function(u,r,s,g){return r=r||"&",s=s||"=",u===null&&(u=void 0),typeof u=="object"?Object.keys(u).map(function(w){var z=encodeURIComponent(zd(w))+s;return Array.isArray(u[w])?u[w].map(function(f){return z+encodeURIComponent(zd(f))}).join(r):z+encodeURIComponent(zd(u[w]))}).join(r):g?encodeURIComponent(zd(g))+s+encodeURIComponent(zd(u)):""};em(function(u,r){r.decode=r.parse=Fw,r.encode=r.stringify=Uw});function wv(u,...r){for(const s of r)for(const g in s)u[g]=s[g];return u}class Yu extends Error{constructor(r,s){super(s),this.message=s,this.key=r}}class Qy{constructor(r,s=[]){this.parent=r,this.bindings={};for(const[g,w]of s)this.bindings[g]=w}concat(r){return new Qy(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return this.bindings[r]?!0:this.parent?this.parent.has(r):!1}}const tm={kind:"null"},li={kind:"number"},Fr={kind:"string"},Sr={kind:"boolean"},Mc={kind:"color"},Dp={kind:"object"},Tr={kind:"value"},Nw={kind:"error"},im={kind:"collator"},rm={kind:"formatted"},jd={kind:"resolvedImage"};function Dl(u,r){return{kind:"array",itemType:u,N:r}}function vo(u){if(u.kind==="array"){const r=vo(u.itemType);return typeof u.N=="number"?`array<${r}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${r}>`}else return u.kind}const jw=[tm,li,Fr,Sr,Mc,rm,Dp,Dl(Tr),jd];function Rd(u,r){if(r.kind==="error")return null;if(u.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!Rd(u.itemType,r.itemType))&&(typeof u.N!="number"||u.N===r.N))return null}else{if(u.kind===r.kind)return null;if(u.kind==="value"){for(const s of jw)if(!Rd(s,r))return null}}return`Expected ${vo(u)} but found ${vo(r)} instead.`}function eg(u,r){return r.some(s=>s.kind===u.kind)}function Bd(u,r){return r.some(s=>s==="null"?u===null:s==="array"?Array.isArray(u):s==="object"?u&&!Array.isArray(u)&&typeof u=="object":s===typeof u)}var Vw=em(function(u,r){var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function g(N){return N=Math.round(N),N<0?0:N>255?255:N}function w(N){return N<0?0:N>1?1:N}function z(N){return N[N.length-1]==="%"?g(parseFloat(N)/100*255):g(parseInt(N))}function f(N){return N[N.length-1]==="%"?w(parseFloat(N)/100):w(parseFloat(N))}function h(N,F,G){return G<0?G+=1:G>1&&(G-=1),G*6<1?N+(F-N)*G*6:G*2<1?F:G*3<2?N+(F-N)*(2/3-G)*6:N}function D(N){var F=N.replace(/ /g,"").toLowerCase();if(F in s)return s[F].slice();if(F[0]==="#"){if(F.length===4){var G=parseInt(F.substr(1),16);return G>=0&&G<=4095?[(G&3840)>>4|(G&3840)>>8,G&240|(G&240)>>4,G&15|(G&15)<<4,1]:null}else if(F.length===7){var G=parseInt(F.substr(1),16);return G>=0&&G<=16777215?[(G&16711680)>>16,(G&65280)>>8,G&255,1]:null}return null}var H=F.indexOf("("),Pe=F.indexOf(")");if(H!==-1&&Pe+1===F.length){var ke=F.substr(0,H),We=F.substr(H+1,Pe-(H+1)).split(","),je=1;switch(ke){case"rgba":if(We.length!==4)return null;je=f(We.pop());case"rgb":return We.length!==3?null:[z(We[0]),z(We[1]),z(We[2]),je];case"hsla":if(We.length!==4)return null;je=f(We.pop());case"hsl":if(We.length!==3)return null;var yt=(parseFloat(We[0])%360+360)%360/360,Ne=f(We[1]),Ze=f(We[2]),vt=Ze<=.5?Ze*(Ne+1):Ze+Ne-Ze*Ne,ct=Ze*2-vt;return[g(h(ct,vt,yt+1/3)*255),g(h(ct,vt,yt)*255),g(h(ct,vt,yt-1/3)*255),je];default:return null}}return null}try{r.parseCSSColor=D}catch{}});class bn{constructor(r,s,g,w=1){this.r=r,this.g=s,this.b=g,this.a=w}static parse(r){if(!r)return;if(r instanceof bn)return r;if(typeof r!="string")return;const s=Vw.parseCSSColor(r);if(!!s)return new bn(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3])}toString(){const[r,s,g,w]=this.toArray();return`rgba(${Math.round(r)},${Math.round(s)},${Math.round(g)},${w})`}toArray(){const{r,g:s,b:g,a:w}=this;return w===0?[0,0,0,0]:[r*255/w,s*255/w,g*255/w,w]}}bn.black=new bn(0,0,0,1);bn.white=new bn(1,1,1,1);bn.transparent=new bn(0,0,0,0);bn.red=new bn(1,0,0,1);bn.blue=new bn(0,0,1,1);class tg{constructor(r,s,g){r?this.sensitivity=s?"variant":"case":this.sensitivity=s?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,s){return this.collator.compare(r,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Vy{constructor(r,s,g,w,z){this.text=r.normalize?r.normalize():r,this.image=s,this.scale=g,this.fontStack=w,this.textColor=z}}class vu{constructor(r){this.sections=r}static fromString(r){return new vu([new Vy(r,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof vu?r:vu.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}serialize(){const r=["format"];for(const s of this.sections){if(s.image){r.push(["image",s.image.name]);continue}r.push(s.text);const g={};s.fontStack&&(g["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(g["font-scale"]=s.scale),s.textColor&&(g["text-color"]=["rgba"].concat(s.textColor.toArray())),r.push(g)}return r}}class Rc{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new Rc({name:r,available:!1}):null}serialize(){return["image",this.name]}}function Ev(u,r,s,g){return typeof u=="number"&&u>=0&&u<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof s=="number"&&s>=0&&s<=255?typeof g=="undefined"||typeof g=="number"&&g>=0&&g<=1?null:`Invalid rgba value [${[u,r,s,g].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof g=="number"?[u,r,s,g]:[u,r,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Zf(u){if(u===null)return!0;if(typeof u=="string")return!0;if(typeof u=="boolean")return!0;if(typeof u=="number")return!0;if(u instanceof bn)return!0;if(u instanceof tg)return!0;if(u instanceof vu)return!0;if(u instanceof Rc)return!0;if(Array.isArray(u)){for(const r of u)if(!Zf(r))return!1;return!0}else if(typeof u=="object"){for(const r in u)if(!Zf(u[r]))return!1;return!0}else return!1}function ma(u){if(u===null)return tm;if(typeof u=="string")return Fr;if(typeof u=="boolean")return Sr;if(typeof u=="number")return li;if(u instanceof bn)return Mc;if(u instanceof tg)return im;if(u instanceof vu)return rm;if(u instanceof Rc)return jd;if(Array.isArray(u)){const r=u.length;let s;for(const g of u){const w=ma(g);if(!s)s=w;else{if(s===w)continue;s=Tr;break}}return Dl(s||Tr,r)}else return Dp}function Ld(u){const r=typeof u;return u===null?"":r==="string"||r==="number"||r==="boolean"?String(u):u instanceof bn||u instanceof vu||u instanceof Rc?u.toString():JSON.stringify(u)}class jp{constructor(r,s){this.type=r,this.value=s}static parse(r,s){if(r.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!Zf(r[1]))return s.error("invalid value");const g=r[1];let w=ma(g);const z=s.expectedType;return w.kind==="array"&&w.N===0&&z&&z.kind==="array"&&(typeof z.N!="number"||z.N===0)&&(w=z),new jp(w,g)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof bn?["rgba"].concat(this.value.toArray()):this.value instanceof vu?this.value.serialize():this.value}}class Ra{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const gy={string:Fr,number:li,boolean:Sr,object:Dp};class gu{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let g=1,w;const z=r[0];if(z==="array"){let h;if(r.length>2){const N=r[1];if(typeof N!="string"||!(N in gy)||N==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);h=gy[N],g++}else h=Tr;let D;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return s.error('The length argument to "array" must be a positive integer literal',2);D=r[2],g++}w=Dl(h,D)}else w=gy[z];const f=[];for(;g<r.length;g++){const h=s.parse(r[g],g,Tr);if(!h)return null;f.push(h)}return new gu(w,f)}evaluate(r){for(let s=0;s<this.args.length;s++){const g=this.args[s].evaluate(r);if(Rd(this.type,ma(g))){if(s===this.args.length-1)throw new Ra(`Expected value to be of type ${vo(this.type)}, but found ${vo(ma(g))} instead.`)}else return g}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=this.type,s=[r.kind];if(r.kind==="array"){const g=r.itemType;if(g.kind==="string"||g.kind==="number"||g.kind==="boolean"){s.push(g.kind);const w=r.N;(typeof w=="number"||this.args.length>1)&&s.push(w)}}return s.concat(this.args.map(g=>g.serialize()))}}class nm{constructor(r){this.type=rm,this.sections=r}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const g=r[1];if(!Array.isArray(g)&&typeof g=="object")return s.error("First argument must be an image or text section.");const w=[];let z=!1;for(let f=1;f<=r.length-1;++f){const h=r[f];if(z&&typeof h=="object"&&!Array.isArray(h)){z=!1;let D=null;if(h["font-scale"]&&(D=s.parse(h["font-scale"],1,li),!D))return null;let N=null;if(h["text-font"]&&(N=s.parse(h["text-font"],1,Dl(Fr)),!N))return null;let F=null;if(h["text-color"]&&(F=s.parse(h["text-color"],1,Mc),!F))return null;const G=w[w.length-1];G.scale=D,G.font=N,G.textColor=F}else{const D=s.parse(r[f],1,Tr);if(!D)return null;const N=D.type.kind;if(N!=="string"&&N!=="value"&&N!=="null"&&N!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");z=!0,w.push({content:D,scale:null,font:null,textColor:null})}}return new nm(w)}evaluate(r){const s=g=>{const w=g.content.evaluate(r);return ma(w)===jd?new Vy("",w,null,null,null):new Vy(Ld(w),null,g.scale?g.scale.evaluate(r):null,g.font?g.font.evaluate(r).join(","):null,g.textColor?g.textColor.evaluate(r):null)};return new vu(this.sections.map(s))}eachChild(r){for(const s of this.sections)r(s.content),s.scale&&r(s.scale),s.font&&r(s.font),s.textColor&&r(s.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const s of this.sections){r.push(s.content.serialize());const g={};s.scale&&(g["font-scale"]=s.scale.serialize()),s.font&&(g["text-font"]=s.font.serialize()),s.textColor&&(g["text-color"]=s.textColor.serialize()),r.push(g)}return r}}class om{constructor(r){this.type=jd,this.input=r}static parse(r,s){if(r.length!==2)return s.error("Expected two arguments.");const g=s.parse(r[1],1,Fr);return g?new om(g):s.error("No image name provided.")}evaluate(r){const s=this.input.evaluate(r),g=Rc.fromString(s);return g&&r.availableImages&&(g.available=r.availableImages.indexOf(s)>-1),g}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const qw={"to-boolean":Sr,"to-color":Mc,"to-number":li,"to-string":Fr};class mh{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const g=r[0];if((g==="to-boolean"||g==="to-string")&&r.length!==2)return s.error("Expected one argument.");const w=qw[g],z=[];for(let f=1;f<r.length;f++){const h=s.parse(r[f],f,Tr);if(!h)return null;z.push(h)}return new mh(w,z)}evaluate(r){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(r));if(this.type.kind==="color"){let s,g;for(const w of this.args){if(s=w.evaluate(r),g=null,s instanceof bn)return s;if(typeof s=="string"){const z=r.parseColor(s);if(z)return z}else if(Array.isArray(s)&&(s.length<3||s.length>4?g=`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:g=Ev(s[0],s[1],s[2],s[3]),!g))return new bn(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Ra(g||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}else if(this.type.kind==="number"){let s=null;for(const g of this.args){if(s=g.evaluate(r),s===null)return 0;const w=Number(s);if(!isNaN(w))return w}throw new Ra(`Could not convert ${JSON.stringify(s)} to number.`)}else return this.type.kind==="formatted"?vu.fromString(Ld(this.args[0].evaluate(r))):this.type.kind==="resolvedImage"?Rc.fromString(Ld(this.args[0].evaluate(r))):Ld(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){if(this.type.kind==="formatted")return new nm([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new om(this.args[0]).serialize();const r=[`to-${this.type.kind}`];return this.eachChild(s=>{r.push(s.serialize())}),r}}const Gw=["Unknown","Point","LineString","Polygon"];class Iv{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Gw[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:g,y:w}=this.featureTileCoord,z=g*s-r[0],f=w*s-r[1],h=this.featureDistanceData.bearing[0],D=this.featureDistanceData.bearing[1];return h*z+D*f}return 0}parseColor(r){let s=this._parseColorCache[r];return s||(s=this._parseColorCache[r]=bn.parse(r)),s}}class _u{constructor(r,s,g,w){this.name=r,this.type=s,this._evaluate=g,this.args=w}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(r=>r.serialize()))}static parse(r,s){const g=r[0],w=_u.definitions[g];if(!w)return s.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0);const z=Array.isArray(w)?w[0]:w.type,f=Array.isArray(w)?[[w[1],w[2]]]:w.overloads,h=f.filter(([N])=>!Array.isArray(N)||N.length===r.length-1);let D=null;for(const[N,F]of h){D=new lm(s.registry,s.path,null,s.scope);const G=[];let H=!1;for(let Pe=1;Pe<r.length;Pe++){const ke=r[Pe],We=Array.isArray(N)?N[Pe-1]:N.type,je=D.parse(ke,1+G.length,We);if(!je){H=!0;break}G.push(je)}if(!H){if(Array.isArray(N)&&N.length!==G.length){D.error(`Expected ${N.length} arguments, but found ${G.length} instead.`);continue}for(let Pe=0;Pe<G.length;Pe++){const ke=Array.isArray(N)?N[Pe]:N.type,We=G[Pe];D.concat(Pe+1).checkSubtype(ke,We.type)}if(D.errors.length===0)return new _u(g,z,F,G)}}if(h.length===1)s.errors.push(...D.errors);else{const F=(h.length?h:f).map(([H])=>Zw(H)).join(" | "),G=[];for(let H=1;H<r.length;H++){const Pe=s.parse(r[H],1+G.length);if(!Pe)return null;G.push(vo(Pe.type))}s.error(`Expected arguments of type ${F}, but found (${G.join(", ")}) instead.`)}return null}static register(r,s){_u.definitions=s;for(const g in s)r[g]=_u}}function Zw(u){return Array.isArray(u)?`(${u.map(vo).join(", ")})`:`(${vo(u.type)}...)`}class am{constructor(r,s,g){this.type=im,this.locale=g,this.caseSensitive=r,this.diacriticSensitive=s}static parse(r,s){if(r.length!==2)return s.error("Expected one argument.");const g=r[1];if(typeof g!="object"||Array.isArray(g))return s.error("Collator options argument must be an object.");const w=s.parse(g["case-sensitive"]===void 0?!1:g["case-sensitive"],1,Sr);if(!w)return null;const z=s.parse(g["diacritic-sensitive"]===void 0?!1:g["diacritic-sensitive"],1,Sr);if(!z)return null;let f=null;return g.locale&&(f=s.parse(g.locale,1,Fr),!f)?null:new am(w,z,f)}evaluate(r){return new tg(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}const yh=8192;function ig(u,r){u[0]=Math.min(u[0],r[0]),u[1]=Math.min(u[1],r[1]),u[2]=Math.max(u[2],r[0]),u[3]=Math.max(u[3],r[1])}function Hw(u){return(180+u)/360}function Ww(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function Hf(u,r){return!(u[0]<=r[0]||u[2]>=r[2]||u[1]<=r[1]||u[3]>=r[3])}function Xw(u,r){const s=Hw(u[0]),g=Ww(u[1]),w=Math.pow(2,r.z);return[Math.round(s*w*yh),Math.round(g*w*yh)]}function Kw(u,r,s){const g=u[0]-r[0],w=u[1]-r[1],z=u[0]-s[0],f=u[1]-s[1];return g*f-z*w===0&&g*z<=0&&w*f<=0}function Jw(u,r,s){return r[1]>u[1]!=s[1]>u[1]&&u[0]<(s[0]-r[0])*(u[1]-r[1])/(s[1]-r[1])+r[0]}function rg(u,r){let s=!1;for(let g=0,w=r.length;g<w;g++){const z=r[g];for(let f=0,h=z.length;f<h-1;f++){if(Kw(u,z[f],z[f+1]))return!1;Jw(u,z[f],z[f+1])&&(s=!s)}}return s}function $w(u,r){for(let s=0;s<r.length;s++)if(rg(u,r[s]))return!0;return!1}function Yw(u,r){return u[0]*r[1]-u[1]*r[0]}function P_(u,r,s,g){const w=u[0]-s[0],z=u[1]-s[1],f=r[0]-s[0],h=r[1]-s[1],D=g[0]-s[0],N=g[1]-s[1],F=w*N-D*z,G=f*N-D*h;return F>0&&G<0||F<0&&G>0}function Qw(u,r,s,g){const w=[r[0]-u[0],r[1]-u[1]],z=[g[0]-s[0],g[1]-s[1]];return Yw(z,w)===0?!1:!!(P_(u,r,s,g)&&P_(s,g,u,r))}function e2(u,r,s){for(const g of s)for(let w=0;w<g.length-1;++w)if(Qw(u,r,g[w],g[w+1]))return!0;return!1}function Sv(u,r){for(let s=0;s<u.length;++s)if(!rg(u[s],r))return!1;for(let s=0;s<u.length-1;++s)if(e2(u[s],u[s+1],r))return!1;return!0}function t2(u,r){for(let s=0;s<r.length;s++)if(Sv(u,r[s]))return!0;return!1}function ng(u,r,s){const g=[];for(let w=0;w<u.length;w++){const z=[];for(let f=0;f<u[w].length;f++){const h=Xw(u[w][f],s);ig(r,h),z.push(h)}g.push(z)}return g}function Tv(u,r,s){const g=[];for(let w=0;w<u.length;w++){const z=ng(u[w],r,s);g.push(z)}return g}function Av(u,r,s,g){if(u[0]<s[0]||u[0]>s[2]){const w=g*.5;let z=u[0]-s[0]>w?-g:s[0]-u[0]>w?g:0;z===0&&(z=u[0]-s[2]>w?-g:s[2]-u[0]>w?g:0),u[0]+=z}ig(r,u)}function i2(u){u[0]=u[1]=1/0,u[2]=u[3]=-1/0}function M_(u,r,s,g){const w=Math.pow(2,g.z)*yh,z=[g.x*yh,g.y*yh],f=[];if(!u)return f;for(const h of u)for(const D of h){const N=[D.x+z[0],D.y+z[1]];Av(N,r,s,w),f.push(N)}return f}function L_(u,r,s,g){const w=Math.pow(2,g.z)*yh,z=[g.x*yh,g.y*yh],f=[];if(!u)return f;for(const h of u){const D=[];for(const N of h){const F=[N.x+z[0],N.y+z[1]];ig(r,F),D.push(F)}f.push(D)}if(r[2]-r[0]<=w/2){i2(r);for(const h of f)for(const D of h)Av(D,r,s,w)}return f}function r2(u,r){const s=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(!w)return!1;if(r.type==="Polygon"){const z=ng(r.coordinates,g,w),f=M_(u.geometry(),s,g,w);if(!Hf(s,g))return!1;for(const h of f)if(!rg(h,z))return!1}if(r.type==="MultiPolygon"){const z=Tv(r.coordinates,g,w),f=M_(u.geometry(),s,g,w);if(!Hf(s,g))return!1;for(const h of f)if(!$w(h,z))return!1}return!0}function n2(u,r){const s=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(!w)return!1;if(r.type==="Polygon"){const z=ng(r.coordinates,g,w),f=L_(u.geometry(),s,g,w);if(!Hf(s,g))return!1;for(const h of f)if(!Sv(h,z))return!1}if(r.type==="MultiPolygon"){const z=Tv(r.coordinates,g,w),f=L_(u.geometry(),s,g,w);if(!Hf(s,g))return!1;for(const h of f)if(!t2(h,z))return!1}return!0}class Qh{constructor(r,s){this.type=Sr,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Zf(r[1])){const g=r[1];if(g.type==="FeatureCollection")for(let w=0;w<g.features.length;++w){const z=g.features[w].geometry.type;if(z==="Polygon"||z==="MultiPolygon")return new Qh(g,g.features[w].geometry)}else if(g.type==="Feature"){const w=g.geometry.type;if(w==="Polygon"||w==="MultiPolygon")return new Qh(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new Qh(g,g)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return r2(r,this.geometries);if(r.geometryType()==="LineString")return n2(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function og(u){if(u instanceof _u){if(u.name==="get"&&u.args.length===1)return!1;if(u.name==="feature-state")return!1;if(u.name==="has"&&u.args.length===1)return!1;if(u.name==="properties"||u.name==="geometry-type"||u.name==="id")return!1;if(/^filter-/.test(u.name))return!1}if(u instanceof Qh)return!1;let r=!0;return u.eachChild(s=>{r&&!og(s)&&(r=!1)}),r}function ag(u){if(u instanceof _u&&u.name==="feature-state")return!1;let r=!0;return u.eachChild(s=>{r&&!ag(s)&&(r=!1)}),r}function sg(u,r){if(u instanceof _u&&r.indexOf(u.name)>=0)return!1;let s=!0;return u.eachChild(g=>{s&&!sg(g,r)&&(s=!1)}),s}class sm{constructor(r,s){this.type=s.type,this.name=r,this.boundExpression=s}static parse(r,s){if(r.length!==2||typeof r[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const g=r[1];return s.scope.has(g)?new sm(g,s.scope.get(g)):s.error(`Unknown variable "${g}". Make sure "${g}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class lm{constructor(r,s=[],g,w=new Qy,z=[]){this.registry=r,this.path=s,this.key=s.map(f=>`[${f}]`).join(""),this.scope=w,this.errors=z,this.expectedType=g}parse(r,s,g,w,z={}){return s?this.concat(s,g,w)._parse(r,z):this._parse(r,z)}_parse(r,s){(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number")&&(r=["literal",r]);function g(w,z,f){return f==="assert"?new gu(z,[w]):f==="coerce"?new mh(z,[w]):w}if(Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const w=r[0];if(typeof w!="string")return this.error(`Expression name must be a string, but found ${typeof w} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const z=this.registry[w];if(z){let f=z.parse(r,this);if(!f)return null;if(this.expectedType){const h=this.expectedType,D=f.type;if((h.kind==="string"||h.kind==="number"||h.kind==="boolean"||h.kind==="object"||h.kind==="array")&&D.kind==="value")f=g(f,h,s.typeAnnotation||"assert");else if((h.kind==="color"||h.kind==="formatted"||h.kind==="resolvedImage")&&(D.kind==="value"||D.kind==="string"))f=g(f,h,s.typeAnnotation||"coerce");else if(this.checkSubtype(h,D))return null}if(!(f instanceof jp)&&f.type.kind!=="resolvedImage"&&qy(f)){const h=new Iv;try{f=new jp(f.type,f.evaluate(h))}catch(D){return this.error(D.message),null}}return f}return this.error(`Unknown expression "${w}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof r=="undefined"?this.error("'undefined' value invalid. Use null instead."):typeof r=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof r} instead.`)}concat(r,s,g){const w=typeof r=="number"?this.path.concat(r):this.path,z=g?this.scope.concat(g):this.scope;return new lm(this.registry,w,s||null,z,this.errors)}error(r,...s){const g=`${this.key}${s.map(w=>`[${w}]`).join("")}`;this.errors.push(new Yu(g,r))}checkSubtype(r,s){const g=Rd(r,s);return g&&this.error(g),g}}function qy(u){if(u instanceof sm)return qy(u.boundExpression);if(u instanceof _u&&u.name==="error")return!1;if(u instanceof am)return!1;if(u instanceof Qh)return!1;const r=u instanceof mh||u instanceof gu;let s=!0;return u.eachChild(g=>{r?s=s&&qy(g):s=s&&g instanceof jp}),s?og(u)&&sg(u,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"]):!1}function um(u,r){const s=u.length-1;let g=0,w=s,z=0,f,h;for(;g<=w;)if(z=Math.floor((g+w)/2),f=u[z],h=u[z+1],f<=r){if(z===s||r<h)return z;g=z+1}else if(f>r)w=z-1;else throw new Ra("Input is not a number.");return 0}class cm{constructor(r,s,g){this.type=r,this.input=s,this.labels=[],this.outputs=[];for(const[w,z]of g)this.labels.push(w),this.outputs.push(z)}static parse(r,s){if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!==0)return s.error("Expected an even number of arguments.");const g=s.parse(r[1],1,li);if(!g)return null;const w=[];let z=null;s.expectedType&&s.expectedType.kind!=="value"&&(z=s.expectedType);for(let f=1;f<r.length;f+=2){const h=f===1?-1/0:r[f],D=r[f+1],N=f,F=f+1;if(typeof h!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(w.length&&w[w.length-1][0]>=h)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',N);const G=s.parse(D,F,z);if(!G)return null;z=z||G.type,w.push([h,G])}return new cm(z,g,w)}evaluate(r){const s=this.labels,g=this.outputs;if(s.length===1)return g[0].evaluate(r);const w=this.input.evaluate(r);if(w<=s[0])return g[0].evaluate(r);const z=s.length;if(w>=s[z-1])return g[z-1].evaluate(r);const f=um(s,w);return g[f].evaluate(r)}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){const r=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&r.push(this.labels[s]),r.push(this.outputs[s].serialize());return r}}var o2=Zp;function Zp(u,r,s,g){this.cx=3*u,this.bx=3*(s-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(g-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=g,this.p2x=s,this.p2y=g}Zp.prototype.sampleCurveX=function(u){return((this.ax*u+this.bx)*u+this.cx)*u};Zp.prototype.sampleCurveY=function(u){return((this.ay*u+this.by)*u+this.cy)*u};Zp.prototype.sampleCurveDerivativeX=function(u){return(3*this.ax*u+2*this.bx)*u+this.cx};Zp.prototype.solveCurveX=function(u,r){typeof r=="undefined"&&(r=1e-6);var s,g,w,z,f;for(w=u,f=0;f<8;f++){if(z=this.sampleCurveX(w)-u,Math.abs(z)<r)return w;var h=this.sampleCurveDerivativeX(w);if(Math.abs(h)<1e-6)break;w=w-z/h}if(s=0,g=1,w=u,w<s)return s;if(w>g)return g;for(;s<g;){if(z=this.sampleCurveX(w),Math.abs(z-u)<r)return w;u>z?s=w:g=w,w=(g-s)*.5+s}return w};Zp.prototype.solve=function(u,r){return this.sampleCurveY(this.solveCurveX(u,r))};function cl(u,r,s){return u*(1-s)+r*s}function a2(u,r,s){return new bn(cl(u.r,r.r,s),cl(u.g,r.g,s),cl(u.b,r.b,s),cl(u.a,r.a,s))}function s2(u,r,s){return u.map((g,w)=>cl(g,r[w],s))}var Cv=Object.freeze({__proto__:null,number:cl,color:a2,array:s2});const kv=.95047,zv=1,Pv=1.08883,Mv=4/29,Rp=6/29,Lv=3*Rp*Rp,l2=Rp*Rp*Rp,u2=Math.PI/180,c2=180/Math.PI;function _y(u){return u>l2?Math.pow(u,1/3):u/Lv+Mv}function vy(u){return u>Rp?u*u*u:Lv*(u-Mv)}function xy(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function by(u){return u/=255,u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Dv(u){const r=by(u.r),s=by(u.g),g=by(u.b),w=_y((.4124564*r+.3575761*s+.1804375*g)/kv),z=_y((.2126729*r+.7151522*s+.072175*g)/zv),f=_y((.0193339*r+.119192*s+.9503041*g)/Pv);return{l:116*z-16,a:500*(w-z),b:200*(z-f),alpha:u.a}}function Rv(u){let r=(u.l+16)/116,s=isNaN(u.a)?r:r+u.a/500,g=isNaN(u.b)?r:r-u.b/200;return r=zv*vy(r),s=kv*vy(s),g=Pv*vy(g),new bn(xy(3.2404542*s-1.5371385*r-.4985314*g),xy(-.969266*s+1.8760108*r+.041556*g),xy(.0556434*s-.2040259*r+1.0572252*g),u.alpha)}function h2(u,r,s){return{l:cl(u.l,r.l,s),a:cl(u.a,r.a,s),b:cl(u.b,r.b,s),alpha:cl(u.alpha,r.alpha,s)}}function p2(u){const{l:r,a:s,b:g}=Dv(u),w=Math.atan2(g,s)*c2;return{h:w<0?w+360:w,c:Math.sqrt(s*s+g*g),l:r,alpha:u.a}}function d2(u){const r=u.h*u2,s=u.c,g=u.l;return Rv({l:g,a:Math.cos(r)*s,b:Math.sin(r)*s,alpha:u.alpha})}function f2(u,r,s){const g=r-u;return u+s*(g>180||g<-180?g-360*Math.round(g/360):g)}function m2(u,r,s){return{h:f2(u.h,r.h,s),c:cl(u.c,r.c,s),l:cl(u.l,r.l,s),alpha:cl(u.alpha,r.alpha,s)}}const Pd={forward:Dv,reverse:Rv,interpolate:h2},Md={forward:p2,reverse:d2,interpolate:m2};var Bv=Object.freeze({__proto__:null,lab:Pd,hcl:Md});class Bl{constructor(r,s,g,w,z){this.type=r,this.operator=s,this.interpolation=g,this.input=w,this.labels=[],this.outputs=[];for(const[f,h]of z)this.labels.push(f),this.outputs.push(h)}static interpolationFactor(r,s,g,w){let z=0;if(r.name==="exponential")z=wy(s,r.base,g,w);else if(r.name==="linear")z=wy(s,1,g,w);else if(r.name==="cubic-bezier"){const f=r.controlPoints;z=new o2(f[0],f[1],f[2],f[3]).solve(wy(s,1,g,w))}return z}static parse(r,s){let[g,w,z,...f]=r;if(!Array.isArray(w)||w.length===0)return s.error("Expected an interpolation type expression.",1);if(w[0]==="linear")w={name:"linear"};else if(w[0]==="exponential"){const N=w[1];if(typeof N!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);w={name:"exponential",base:N}}else if(w[0]==="cubic-bezier"){const N=w.slice(1);if(N.length!==4||N.some(F=>typeof F!="number"||F<0||F>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);w={name:"cubic-bezier",controlPoints:N}}else return s.error(`Unknown interpolation type ${String(w[0])}`,1,0);if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!==0)return s.error("Expected an even number of arguments.");if(z=s.parse(z,2,li),!z)return null;const h=[];let D=null;g==="interpolate-hcl"||g==="interpolate-lab"?D=Mc:s.expectedType&&s.expectedType.kind!=="value"&&(D=s.expectedType);for(let N=0;N<f.length;N+=2){const F=f[N],G=f[N+1],H=N+3,Pe=N+4;if(typeof F!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(h.length&&h[h.length-1][0]>=F)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',H);const ke=s.parse(G,Pe,D);if(!ke)return null;D=D||ke.type,h.push([F,ke])}return D.kind!=="number"&&D.kind!=="color"&&!(D.kind==="array"&&D.itemType.kind==="number"&&typeof D.N=="number")?s.error(`Type ${vo(D)} is not interpolatable.`):new Bl(D,g,w,z,h)}evaluate(r){const s=this.labels,g=this.outputs;if(s.length===1)return g[0].evaluate(r);const w=this.input.evaluate(r);if(w<=s[0])return g[0].evaluate(r);const z=s.length;if(w>=s[z-1])return g[z-1].evaluate(r);const f=um(s,w),h=s[f],D=s[f+1],N=Bl.interpolationFactor(this.interpolation,w,h,D),F=g[f].evaluate(r),G=g[f+1].evaluate(r);return this.operator==="interpolate"?Cv[this.type.kind.toLowerCase()](F,G,N):this.operator==="interpolate-hcl"?Md.reverse(Md.interpolate(Md.forward(F),Md.forward(G),N)):Pd.reverse(Pd.interpolate(Pd.forward(F),Pd.forward(G),N))}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){let r;this.interpolation.name==="linear"?r=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?r=["linear"]:r=["exponential",this.interpolation.base]:r=["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,r,this.input.serialize()];for(let g=0;g<this.labels.length;g++)s.push(this.labels[g],this.outputs[g].serialize());return s}}function wy(u,r,s,g){const w=g-s,z=u-s;return w===0?0:r===1?z/w:(Math.pow(r,z)-1)/(Math.pow(r,w)-1)}class Od{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expectected at least one argument.");let g=null;const w=s.expectedType;w&&w.kind!=="value"&&(g=w);const z=[];for(const h of r.slice(1)){const D=s.parse(h,1+z.length,g,void 0,{typeAnnotation:"omit"});if(!D)return null;g=g||D.type,z.push(D)}return w&&z.some(h=>Rd(w,h.type))?new Od(Tr,z):new Od(g,z)}evaluate(r){let s=null,g=0,w;for(const z of this.args){if(g++,s=z.evaluate(r),s&&s instanceof Rc&&!s.available&&(w||(w=s),s=null,g===this.args.length))return w;if(s!==null)break}return s}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=["coalesce"];return this.eachChild(s=>{r.push(s.serialize())}),r}}class hm{constructor(r,s){this.type=s.type,this.bindings=[].concat(r),this.result=s}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const s of this.bindings)r(s[1]);r(this.result)}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const g=[];for(let z=1;z<r.length-1;z+=2){const f=r[z];if(typeof f!="string")return s.error(`Expected string, but found ${typeof f} instead.`,z);if(/[^a-zA-Z0-9_]/.test(f))return s.error("Variable names must contain only alphanumeric characters or '_'.",z);const h=s.parse(r[z+1],z+1);if(!h)return null;g.push([f,h])}const w=s.parse(r[r.length-1],r.length-1,s.expectedType,g);return w?new hm(g,w):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[s,g]of this.bindings)r.push(s,g.serialize());return r.push(this.result.serialize()),r}}class lg{constructor(r,s,g){this.type=r,this.index=s,this.input=g}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const g=s.parse(r[1],1,li),w=s.parse(r[2],2,Dl(s.expectedType||Tr));if(!g||!w)return null;const z=w.type;return new lg(z.itemType,g,w)}evaluate(r){const s=this.index.evaluate(r),g=this.input.evaluate(r);if(s<0)throw new Ra(`Array index out of bounds: ${s} < 0.`);if(s>=g.length)throw new Ra(`Array index out of bounds: ${s} > ${g.length-1}.`);if(s!==Math.floor(s))throw new Ra(`Array index must be an integer, but found ${s} instead.`);return g[s]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class ug{constructor(r,s){this.type=Sr,this.needle=r,this.haystack=s}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const g=s.parse(r[1],1,Tr),w=s.parse(r[2],2,Tr);return!g||!w?null:eg(g.type,[Sr,Fr,li,tm,Tr])?new ug(g,w):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${vo(g.type)} instead`)}evaluate(r){const s=this.needle.evaluate(r),g=this.haystack.evaluate(r);if(g==null)return!1;if(!Bd(s,["boolean","string","number","null"]))throw new Ra(`Expected first argument to be of type boolean, string, number or null, but found ${vo(ma(s))} instead.`);if(!Bd(g,["string","array"]))throw new Ra(`Expected second argument to be of type array or string, but found ${vo(ma(g))} instead.`);return g.indexOf(s)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Wf{constructor(r,s,g){this.type=li,this.needle=r,this.haystack=s,this.fromIndex=g}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const g=s.parse(r[1],1,Tr),w=s.parse(r[2],2,Tr);if(!g||!w)return null;if(!eg(g.type,[Sr,Fr,li,tm,Tr]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${vo(g.type)} instead`);if(r.length===4){const z=s.parse(r[3],3,li);return z?new Wf(g,w,z):null}else return new Wf(g,w)}evaluate(r){const s=this.needle.evaluate(r),g=this.haystack.evaluate(r);if(!Bd(s,["boolean","string","number","null"]))throw new Ra(`Expected first argument to be of type boolean, string, number or null, but found ${vo(ma(s))} instead.`);if(!Bd(g,["string","array"]))throw new Ra(`Expected second argument to be of type array or string, but found ${vo(ma(g))} instead.`);if(this.fromIndex){const w=this.fromIndex.evaluate(r);return g.indexOf(s,w)}return g.indexOf(s)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class cg{constructor(r,s,g,w,z,f){this.inputType=r,this.type=s,this.input=g,this.cases=w,this.outputs=z,this.otherwise=f}static parse(r,s){if(r.length<5)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!==1)return s.error("Expected an even number of arguments.");let g,w;s.expectedType&&s.expectedType.kind!=="value"&&(w=s.expectedType);const z={},f=[];for(let N=2;N<r.length-1;N+=2){let F=r[N];const G=r[N+1];Array.isArray(F)||(F=[F]);const H=s.concat(N);if(F.length===0)return H.error("Expected at least one branch label.");for(const ke of F){if(typeof ke!="number"&&typeof ke!="string")return H.error("Branch labels must be numbers or strings.");if(typeof ke=="number"&&Math.abs(ke)>Number.MAX_SAFE_INTEGER)return H.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ke=="number"&&Math.floor(ke)!==ke)return H.error("Numeric branch labels must be integer values.");if(!g)g=ma(ke);else if(H.checkSubtype(g,ma(ke)))return null;if(typeof z[String(ke)]!="undefined")return H.error("Branch labels must be unique.");z[String(ke)]=f.length}const Pe=s.parse(G,N,w);if(!Pe)return null;w=w||Pe.type,f.push(Pe)}const h=s.parse(r[1],1,Tr);if(!h)return null;const D=s.parse(r[r.length-1],r.length-1,w);return!D||h.type.kind!=="value"&&s.concat(1).checkSubtype(g,h.type)?null:new cg(g,w,h,z,f,D)}evaluate(r){const s=this.input.evaluate(r);return(ma(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),g=[],w={};for(const f of s){const h=w[this.cases[f]];h===void 0?(w[this.cases[f]]=g.length,g.push([this.cases[f],[f]])):g[h][1].push(f)}const z=f=>this.inputType.kind==="number"?Number(f):f;for(const[f,h]of g)h.length===1?r.push(z(h[0])):r.push(h.map(z)),r.push(this.outputs[f].serialize());return r.push(this.otherwise.serialize()),r}}class hg{constructor(r,s,g){this.type=r,this.branches=s,this.otherwise=g}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!==0)return s.error("Expected an odd number of arguments.");let g;s.expectedType&&s.expectedType.kind!=="value"&&(g=s.expectedType);const w=[];for(let f=1;f<r.length-1;f+=2){const h=s.parse(r[f],f,Sr);if(!h)return null;const D=s.parse(r[f+1],f+1,g);if(!D)return null;w.push([h,D]),g=g||D.type}const z=s.parse(r[r.length-1],r.length-1,g);return z?new hg(g,w,z):null}evaluate(r){for(const[s,g]of this.branches)if(s.evaluate(r))return g.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[s,g]of this.branches)r(s),r(g);r(this.otherwise)}outputDefined(){return this.branches.every(([r,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild(s=>{r.push(s.serialize())}),r}}class Xf{constructor(r,s,g,w){this.type=r,this.input=s,this.beginIndex=g,this.endIndex=w}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const g=s.parse(r[1],1,Tr),w=s.parse(r[2],2,li);if(!g||!w)return null;if(!eg(g.type,[Dl(Tr),Fr,Tr]))return s.error(`Expected first argument to be of type array or string, but found ${vo(g.type)} instead`);if(r.length===4){const z=s.parse(r[3],3,li);return z?new Xf(g.type,g,w,z):null}else return new Xf(g.type,g,w)}evaluate(r){const s=this.input.evaluate(r),g=this.beginIndex.evaluate(r);if(!Bd(s,["string","array"]))throw new Ra(`Expected first argument to be of type array or string, but found ${vo(ma(s))} instead.`);if(this.endIndex){const w=this.endIndex.evaluate(r);return s.slice(g,w)}return s.slice(g)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function D_(u,r){return u==="=="||u==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function y2(u,r,s){return r===s}function g2(u,r,s){return r!==s}function _2(u,r,s){return r<s}function v2(u,r,s){return r>s}function x2(u,r,s){return r<=s}function b2(u,r,s){return r>=s}function Ov(u,r,s,g){return g.compare(r,s)===0}function w2(u,r,s,g){return!Ov(u,r,s,g)}function E2(u,r,s,g){return g.compare(r,s)<0}function I2(u,r,s,g){return g.compare(r,s)>0}function S2(u,r,s,g){return g.compare(r,s)<=0}function T2(u,r,s,g){return g.compare(r,s)>=0}function Hp(u,r,s){const g=u!=="=="&&u!=="!=";return class Fv{constructor(z,f,h){this.type=Sr,this.lhs=z,this.rhs=f,this.collator=h,this.hasUntypedArgument=z.type.kind==="value"||f.type.kind==="value"}static parse(z,f){if(z.length!==3&&z.length!==4)return f.error("Expected two or three arguments.");const h=z[0];let D=f.parse(z[1],1,Tr);if(!D)return null;if(!D_(h,D.type))return f.concat(1).error(`"${h}" comparisons are not supported for type '${vo(D.type)}'.`);let N=f.parse(z[2],2,Tr);if(!N)return null;if(!D_(h,N.type))return f.concat(2).error(`"${h}" comparisons are not supported for type '${vo(N.type)}'.`);if(D.type.kind!==N.type.kind&&D.type.kind!=="value"&&N.type.kind!=="value")return f.error(`Cannot compare types '${vo(D.type)}' and '${vo(N.type)}'.`);g&&(D.type.kind==="value"&&N.type.kind!=="value"?D=new gu(N.type,[D]):D.type.kind!=="value"&&N.type.kind==="value"&&(N=new gu(D.type,[N])));let F=null;if(z.length===4){if(D.type.kind!=="string"&&N.type.kind!=="string"&&D.type.kind!=="value"&&N.type.kind!=="value")return f.error("Cannot use collator to compare non-string types.");if(F=f.parse(z[3],3,im),!F)return null}return new Fv(D,N,F)}evaluate(z){const f=this.lhs.evaluate(z),h=this.rhs.evaluate(z);if(g&&this.hasUntypedArgument){const D=ma(f),N=ma(h);if(D.kind!==N.kind||!(D.kind==="string"||D.kind==="number"))throw new Ra(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${D.kind}, ${N.kind}) instead.`)}if(this.collator&&!g&&this.hasUntypedArgument){const D=ma(f),N=ma(h);if(D.kind!=="string"||N.kind!=="string")return r(z,f,h)}return this.collator?s(z,f,h,this.collator.evaluate(z)):r(z,f,h)}eachChild(z){z(this.lhs),z(this.rhs),this.collator&&z(this.collator)}outputDefined(){return!0}serialize(){const z=[u];return this.eachChild(f=>{z.push(f.serialize())}),z}}}const A2=Hp("==",y2,Ov),C2=Hp("!=",g2,w2),k2=Hp("<",_2,E2),z2=Hp(">",v2,I2),P2=Hp("<=",x2,S2),M2=Hp(">=",b2,T2);class pg{constructor(r,s,g,w,z){this.type=Fr,this.number=r,this.locale=s,this.currency=g,this.minFractionDigits=w,this.maxFractionDigits=z}static parse(r,s){if(r.length!==3)return s.error("Expected two arguments.");const g=s.parse(r[1],1,li);if(!g)return null;const w=r[2];if(typeof w!="object"||Array.isArray(w))return s.error("NumberFormat options argument must be an object.");let z=null;if(w.locale&&(z=s.parse(w.locale,1,Fr),!z))return null;let f=null;if(w.currency&&(f=s.parse(w.currency,1,Fr),!f))return null;let h=null;if(w["min-fraction-digits"]&&(h=s.parse(w["min-fraction-digits"],1,li),!h))return null;let D=null;return w["max-fraction-digits"]&&(D=s.parse(w["max-fraction-digits"],1,li),!D)?null:new pg(g,z,f,h,D)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class dg{constructor(r){this.type=li,this.input=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const g=s.parse(r[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${vo(g.type)} instead.`):new dg(g):null}evaluate(r){const s=this.input.evaluate(r);if(typeof s=="string")return s.length;if(Array.isArray(s))return s.length;throw new Ra(`Expected value to be of type string or array, but found ${vo(ma(s))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild(s=>{r.push(s.serialize())}),r}}const fg={"==":A2,"!=":C2,">":z2,"<":k2,">=":M2,"<=":P2,array:gu,at:lg,boolean:gu,case:hg,coalesce:Od,collator:am,format:nm,image:om,in:ug,"index-of":Wf,interpolate:Bl,"interpolate-hcl":Bl,"interpolate-lab":Bl,length:dg,let:hm,literal:jp,match:cg,number:gu,"number-format":pg,object:gu,slice:Xf,step:cm,string:gu,"to-boolean":mh,"to-color":mh,"to-number":mh,"to-string":mh,var:sm,within:Qh};function R_(u,[r,s,g,w]){r=r.evaluate(u),s=s.evaluate(u),g=g.evaluate(u);const z=w?w.evaluate(u):1,f=Ev(r,s,g,z);if(f)throw new Ra(f);return new bn(r/255*z,s/255*z,g/255*z,z)}function B_(u,r){return u in r}function Ey(u,r){const s=r[u];return typeof s=="undefined"?null:s}function L2(u,r,s,g){for(;s<=g;){const w=s+g>>1;if(r[w]===u)return!0;r[w]>u?g=w-1:s=w+1}return!1}function Wh(u){return{type:u}}_u.register(fg,{error:[Nw,[Fr],(u,[r])=>{throw new Ra(r.evaluate(u))}],typeof:[Fr,[Tr],(u,[r])=>vo(ma(r.evaluate(u)))],"to-rgba":[Dl(li,4),[Mc],(u,[r])=>r.evaluate(u).toArray()],rgb:[Mc,[li,li,li],R_],rgba:[Mc,[li,li,li,li],R_],has:{type:Sr,overloads:[[[Fr],(u,[r])=>B_(r.evaluate(u),u.properties())],[[Fr,Dp],(u,[r,s])=>B_(r.evaluate(u),s.evaluate(u))]]},get:{type:Tr,overloads:[[[Fr],(u,[r])=>Ey(r.evaluate(u),u.properties())],[[Fr,Dp],(u,[r,s])=>Ey(r.evaluate(u),s.evaluate(u))]]},"feature-state":[Tr,[Fr],(u,[r])=>Ey(r.evaluate(u),u.featureState||{})],properties:[Dp,[],u=>u.properties()],"geometry-type":[Fr,[],u=>u.geometryType()],id:[Tr,[],u=>u.id()],zoom:[li,[],u=>u.globals.zoom],pitch:[li,[],u=>u.globals.pitch||0],"distance-from-center":[li,[],u=>u.distanceFromCenter()],"heatmap-density":[li,[],u=>u.globals.heatmapDensity||0],"line-progress":[li,[],u=>u.globals.lineProgress||0],"sky-radial-progress":[li,[],u=>u.globals.skyRadialProgress||0],accumulated:[Tr,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[li,Wh(li),(u,r)=>{let s=0;for(const g of r)s+=g.evaluate(u);return s}],"*":[li,Wh(li),(u,r)=>{let s=1;for(const g of r)s*=g.evaluate(u);return s}],"-":{type:li,overloads:[[[li,li],(u,[r,s])=>r.evaluate(u)-s.evaluate(u)],[[li],(u,[r])=>-r.evaluate(u)]]},"/":[li,[li,li],(u,[r,s])=>r.evaluate(u)/s.evaluate(u)],"%":[li,[li,li],(u,[r,s])=>r.evaluate(u)%s.evaluate(u)],ln2:[li,[],()=>Math.LN2],pi:[li,[],()=>Math.PI],e:[li,[],()=>Math.E],"^":[li,[li,li],(u,[r,s])=>Math.pow(r.evaluate(u),s.evaluate(u))],sqrt:[li,[li],(u,[r])=>Math.sqrt(r.evaluate(u))],log10:[li,[li],(u,[r])=>Math.log(r.evaluate(u))/Math.LN10],ln:[li,[li],(u,[r])=>Math.log(r.evaluate(u))],log2:[li,[li],(u,[r])=>Math.log(r.evaluate(u))/Math.LN2],sin:[li,[li],(u,[r])=>Math.sin(r.evaluate(u))],cos:[li,[li],(u,[r])=>Math.cos(r.evaluate(u))],tan:[li,[li],(u,[r])=>Math.tan(r.evaluate(u))],asin:[li,[li],(u,[r])=>Math.asin(r.evaluate(u))],acos:[li,[li],(u,[r])=>Math.acos(r.evaluate(u))],atan:[li,[li],(u,[r])=>Math.atan(r.evaluate(u))],min:[li,Wh(li),(u,r)=>Math.min(...r.map(s=>s.evaluate(u)))],max:[li,Wh(li),(u,r)=>Math.max(...r.map(s=>s.evaluate(u)))],abs:[li,[li],(u,[r])=>Math.abs(r.evaluate(u))],round:[li,[li],(u,[r])=>{const s=r.evaluate(u);return s<0?-Math.round(-s):Math.round(s)}],floor:[li,[li],(u,[r])=>Math.floor(r.evaluate(u))],ceil:[li,[li],(u,[r])=>Math.ceil(r.evaluate(u))],"filter-==":[Sr,[Fr,Tr],(u,[r,s])=>u.properties()[r.value]===s.value],"filter-id-==":[Sr,[Tr],(u,[r])=>u.id()===r.value],"filter-type-==":[Sr,[Fr],(u,[r])=>u.geometryType()===r.value],"filter-<":[Sr,[Fr,Tr],(u,[r,s])=>{const g=u.properties()[r.value],w=s.value;return typeof g==typeof w&&g<w}],"filter-id-<":[Sr,[Tr],(u,[r])=>{const s=u.id(),g=r.value;return typeof s==typeof g&&s<g}],"filter->":[Sr,[Fr,Tr],(u,[r,s])=>{const g=u.properties()[r.value],w=s.value;return typeof g==typeof w&&g>w}],"filter-id->":[Sr,[Tr],(u,[r])=>{const s=u.id(),g=r.value;return typeof s==typeof g&&s>g}],"filter-<=":[Sr,[Fr,Tr],(u,[r,s])=>{const g=u.properties()[r.value],w=s.value;return typeof g==typeof w&&g<=w}],"filter-id-<=":[Sr,[Tr],(u,[r])=>{const s=u.id(),g=r.value;return typeof s==typeof g&&s<=g}],"filter->=":[Sr,[Fr,Tr],(u,[r,s])=>{const g=u.properties()[r.value],w=s.value;return typeof g==typeof w&&g>=w}],"filter-id->=":[Sr,[Tr],(u,[r])=>{const s=u.id(),g=r.value;return typeof s==typeof g&&s>=g}],"filter-has":[Sr,[Tr],(u,[r])=>r.value in u.properties()],"filter-has-id":[Sr,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Sr,[Dl(Fr)],(u,[r])=>r.value.indexOf(u.geometryType())>=0],"filter-id-in":[Sr,[Dl(Tr)],(u,[r])=>r.value.indexOf(u.id())>=0],"filter-in-small":[Sr,[Fr,Dl(Tr)],(u,[r,s])=>s.value.indexOf(u.properties()[r.value])>=0],"filter-in-large":[Sr,[Fr,Dl(Tr)],(u,[r,s])=>L2(u.properties()[r.value],s.value,0,s.value.length-1)],all:{type:Sr,overloads:[[[Sr,Sr],(u,[r,s])=>r.evaluate(u)&&s.evaluate(u)],[Wh(Sr),(u,r)=>{for(const s of r)if(!s.evaluate(u))return!1;return!0}]]},any:{type:Sr,overloads:[[[Sr,Sr],(u,[r,s])=>r.evaluate(u)||s.evaluate(u)],[Wh(Sr),(u,r)=>{for(const s of r)if(s.evaluate(u))return!0;return!1}]]},"!":[Sr,[Sr],(u,[r])=>!r.evaluate(u)],"is-supported-script":[Sr,[Fr],(u,[r])=>{const s=u.globals&&u.globals.isSupportedScript;return s?s(r.evaluate(u)):!0}],upcase:[Fr,[Fr],(u,[r])=>r.evaluate(u).toUpperCase()],downcase:[Fr,[Fr],(u,[r])=>r.evaluate(u).toLowerCase()],concat:[Fr,Wh(Tr),(u,r)=>r.map(s=>Ld(s.evaluate(u))).join("")],"resolved-locale":[Fr,[im],(u,[r])=>r.evaluate(u).resolvedLocale()]});function Gy(u){return{result:"success",value:u}}function Lp(u){return{result:"error",value:u}}function D2(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function R2(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function Uv(u){return!!u.expression&&u.expression.interpolated}function mg(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function yg(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function B2(u){return u}function gg(u,r){const s=r.type==="color",g=u.stops&&typeof u.stops[0][0]=="object",w=g||u.property!==void 0,z=g||!w,f=u.type||(Uv(r)?"exponential":"interval");if(s&&(u=wv({},u),u.stops&&(u.stops=u.stops.map(F=>[F[0],bn.parse(F[1])])),u.default?u.default=bn.parse(u.default):u.default=bn.parse(r.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!Bv[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let h,D,N;if(f==="exponential")h=O_;else if(f==="interval")h=F2;else if(f==="categorical"){h=O2,D=Object.create(null);for(const F of u.stops)D[F[0]]=F[1];N=typeof u.stops[0][0]}else if(f==="identity")h=U2;else throw new Error(`Unknown function type "${f}"`);if(g){const F={},G=[];for(let ke=0;ke<u.stops.length;ke++){const We=u.stops[ke],je=We[0].zoom;F[je]===void 0&&(F[je]={zoom:je,type:u.type,property:u.property,default:u.default,stops:[]},G.push(je)),F[je].stops.push([We[0].value,We[1]])}const H=[];for(const ke of G)H.push([F[ke].zoom,gg(F[ke],r)]);const Pe={name:"linear"};return{kind:"composite",interpolationType:Pe,interpolationFactor:Bl.interpolationFactor.bind(void 0,Pe),zoomStops:H.map(ke=>ke[0]),evaluate({zoom:ke},We){return O_({stops:H,base:u.base},r,ke).evaluate(ke,We)}}}else if(z){const F=f==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:Bl.interpolationFactor.bind(void 0,F),zoomStops:u.stops.map(G=>G[0]),evaluate:({zoom:G})=>h(u,r,G,D,N)}}else return{kind:"source",evaluate(F,G){const H=G&&G.properties?G.properties[u.property]:void 0;return H===void 0?Vd(u.default,r.default):h(u,r,H,D,N)}}}function Vd(u,r,s){if(u!==void 0)return u;if(r!==void 0)return r;if(s!==void 0)return s}function O2(u,r,s,g,w){const z=typeof s===w?g[s]:void 0;return Vd(z,u.default,r.default)}function F2(u,r,s){if(mg(s)!=="number")return Vd(u.default,r.default);const g=u.stops.length;if(g===1||s<=u.stops[0][0])return u.stops[0][1];if(s>=u.stops[g-1][0])return u.stops[g-1][1];const w=um(u.stops.map(z=>z[0]),s);return u.stops[w][1]}function O_(u,r,s){const g=u.base!==void 0?u.base:1;if(mg(s)!=="number")return Vd(u.default,r.default);const w=u.stops.length;if(w===1||s<=u.stops[0][0])return u.stops[0][1];if(s>=u.stops[w-1][0])return u.stops[w-1][1];const z=um(u.stops.map(F=>F[0]),s),f=N2(s,g,u.stops[z][0],u.stops[z+1][0]),h=u.stops[z][1],D=u.stops[z+1][1];let N=Cv[r.type]||B2;if(u.colorSpace&&u.colorSpace!=="rgb"){const F=Bv[u.colorSpace];N=(G,H)=>F.reverse(F.interpolate(F.forward(G),F.forward(H),f))}return typeof h.evaluate=="function"?{evaluate(...F){const G=h.evaluate.apply(void 0,F),H=D.evaluate.apply(void 0,F);if(!(G===void 0||H===void 0))return N(G,H,f)}}:N(h,D,f)}function U2(u,r,s){return r.type==="color"?s=bn.parse(s):r.type==="formatted"?s=vu.fromString(s.toString()):r.type==="resolvedImage"?s=Rc.fromString(s.toString()):mg(s)!==r.type&&(r.type!=="enum"||!r.values[s])&&(s=void 0),Vd(s,u.default,r.default)}function N2(u,r,s,g){const w=g-s,z=u-s;return w===0?0:r===1?z/w:(Math.pow(r,z)-1)/(Math.pow(r,w)-1)}class Nv{constructor(r,s){this.expression=r,this._warningHistory={},this._evaluator=new Iv,this._defaultValue=s?q2(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(r,s,g,w,z,f,h,D){return this._evaluator.globals=r,this._evaluator.feature=s,this._evaluator.featureState=g,this._evaluator.canonical=w||null,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=f,this._evaluator.featureTileCoord=h||null,this._evaluator.featureDistanceData=D||null,this.expression.evaluate(this._evaluator)}evaluate(r,s,g,w,z,f,h,D){this._evaluator.globals=r,this._evaluator.feature=s||null,this._evaluator.featureState=g||null,this._evaluator.canonical=w||null,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=f||null,this._evaluator.featureTileCoord=h||null,this._evaluator.featureDistanceData=D||null;try{const N=this.expression.evaluate(this._evaluator);if(N==null||typeof N=="number"&&N!==N)return this._defaultValue;if(this._enumValues&&!(N in this._enumValues))throw new Ra(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(N)} instead.`);return N}catch(N){return this._warningHistory[N.message]||(this._warningHistory[N.message]=!0,typeof console!="undefined"&&console.warn(N.message)),this._defaultValue}}}function jv(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in fg}function Vv(u,r){const s=new lm(fg,[],r?V2(r):void 0),g=s.parse(u,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?Gy(new Nv(g,r)):Lp(s.errors)}class Zy{constructor(r,s){this.kind=r,this._styleExpression=s,this.isStateDependent=r!=="constant"&&!ag(s.expression)}evaluateWithoutErrorHandling(r,s,g,w,z,f){return this._styleExpression.evaluateWithoutErrorHandling(r,s,g,w,z,f)}evaluate(r,s,g,w,z,f){return this._styleExpression.evaluate(r,s,g,w,z,f)}}class Hy{constructor(r,s,g,w){this.kind=r,this.zoomStops=g,this._styleExpression=s,this.isStateDependent=r!=="camera"&&!ag(s.expression),this.interpolationType=w}evaluateWithoutErrorHandling(r,s,g,w,z,f){return this._styleExpression.evaluateWithoutErrorHandling(r,s,g,w,z,f)}evaluate(r,s,g,w,z,f){return this._styleExpression.evaluate(r,s,g,w,z,f)}interpolationFactor(r,s,g){return this.interpolationType?Bl.interpolationFactor(this.interpolationType,r,s,g):0}}function qv(u,r){if(u=Vv(u,r),u.result==="error")return u;const s=u.value.expression,g=og(s);if(!g&&!D2(r))return Lp([new Yu("","data expressions not supported")]);const w=sg(s,["zoom","pitch","distance-from-center"]);if(!w&&!R2(r))return Lp([new Yu("","zoom expressions not supported")]);const z=Of(s);if(!z&&!w)return Lp([new Yu("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(z instanceof Yu)return Lp([z]);if(z instanceof Bl&&!Uv(r))return Lp([new Yu("",'"interpolate" expressions cannot be used with this property')]);if(!z)return Gy(g?new Zy("constant",u.value):new Zy("source",u.value));const f=z instanceof Bl?z.interpolation:void 0;return Gy(g?new Hy("camera",u.value,z.labels,f):new Hy("composite",u.value,z.labels,f))}class pm{constructor(r,s){this._parameters=r,this._specification=s,wv(this,gg(this._parameters,this._specification))}static deserialize(r){return new pm(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function j2(u,r){if(yg(u))return new pm(u,r);if(jv(u)){const s=qv(u,r);if(s.result==="error")throw new Error(s.value.map(g=>`${g.key}: ${g.message}`).join(", "));return s.value}else{let s=u;return typeof u=="string"&&r.type==="color"&&(s=bn.parse(u)),{kind:"constant",evaluate:()=>s}}}function Of(u){let r=null;if(u instanceof hm)r=Of(u.result);else if(u instanceof Od){for(const s of u.args)if(r=Of(s),r)break}else(u instanceof cm||u instanceof Bl)&&u.input instanceof _u&&u.input.name==="zoom"&&(r=u);return r instanceof Yu||u.eachChild(s=>{const g=Of(s);g instanceof Yu?r=g:!r&&g?r=new Yu("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&g&&r!==g&&(r=new Yu("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function V2(u){const r={color:Mc,string:Fr,number:li,enum:Fr,boolean:Sr,formatted:rm,resolvedImage:jd};return u.type==="array"?Dl(r[u.value]||Tr,u.length):r[u.type]}function q2(u){return u.type==="color"&&yg(u.default)?new bn(0,0,0,0):u.type==="color"?bn.parse(u.default)||null:u.default===void 0?null:u.default}function Fd(u){return typeof u=="object"?["literal",u]:u}function G2(u,r){let s=u.stops;if(!s)return Z2(u,r);const g=s&&typeof s[0][0]=="object",w=g||u.property!==void 0,z=g||!w;return s=s.map(f=>!w&&r.tokens&&typeof f[1]=="string"?[f[0],K2(f[1])]:[f[0],Fd(f[1])]),g?H2(u,r,s):z?X2(u,r,s):Wy(u,r,s)}function Z2(u,r){const s=["get",u.property];if(u.default===void 0)return r.type==="string"?["string",s]:s;if(r.type==="enum")return["match",s,Object.keys(r.values),s,u.default];{const g=[r.type==="color"?"to-color":r.type,s,Fd(u.default)];return r.type==="array"&&g.splice(1,0,r.value,r.length||null),g}}function _g(u){switch(u.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function H2(u,r,s){const g={},w={},z=[];for(let h=0;h<s.length;h++){const D=s[h],N=D[0].zoom;g[N]===void 0&&(g[N]={zoom:N,type:u.type,property:u.property,default:u.default},w[N]=[],z.push(N)),w[N].push([D[0].value,D[1]])}if(xg({},r)==="exponential"){const h=[_g(u),["linear"],["zoom"]];for(const D of z){const N=Wy(g[D],r,w[D]);Bp(h,D,N,!1)}return h}else{const h=["step",["zoom"]];for(const D of z){const N=Wy(g[D],r,w[D]);Bp(h,D,N,!0)}return vg(h),h}}function W2(u,r){if(u!==void 0)return u;if(r!==void 0)return r}function F_(u,r){const s=Fd(W2(u.default,r.default));return s===void 0&&r.type==="resolvedImage"?"":s}function Wy(u,r,s){const g=xg(u,r),w=["get",u.property];if(g==="categorical"&&typeof s[0][0]=="boolean"){const z=["case"];for(const f of s)z.push(["==",w,f[0]],f[1]);return z.push(F_(u,r)),z}else if(g==="categorical"){const z=["match",w];for(const f of s)Bp(z,f[0],f[1],!1);return z.push(F_(u,r)),z}else if(g==="interval"){const z=["step",["number",w]];for(const f of s)Bp(z,f[0],f[1],!0);return vg(z),u.default===void 0?z:["case",["==",["typeof",w],"number"],z,Fd(u.default)]}else if(g==="exponential"){const z=u.base!==void 0?u.base:1,f=[_g(u),z===1?["linear"]:["exponential",z],["number",w]];for(const h of s)Bp(f,h[0],h[1],!1);return u.default===void 0?f:["case",["==",["typeof",w],"number"],f,Fd(u.default)]}else throw new Error(`Unknown property function type ${g}`)}function X2(u,r,s,g=["zoom"]){const w=xg(u,r);let z,f=!1;if(w==="interval")z=["step",g],f=!0;else if(w==="exponential"){const h=u.base!==void 0?u.base:1;z=[_g(u),h===1?["linear"]:["exponential",h],g]}else throw new Error(`Unknown zoom function type "${w}"`);for(const h of s)Bp(z,h[0],h[1],f);return vg(z),z}function vg(u){u[0]==="step"&&u.length===3&&(u.push(0),u.push(u[3]))}function Bp(u,r,s,g){u.length>3&&r===u[u.length-2]||(g&&u.length===2||u.push(r),u.push(s))}function xg(u,r){return u.type?u.type:r.expression.interpolated?"exponential":"interval"}function K2(u){const r=["concat"],s=/{([^{}]+)}/g;let g=0;for(let w=s.exec(u);w!==null;w=s.exec(u)){const z=u.slice(g,s.lastIndex-w[0].length);g=s.lastIndex,z.length>0&&r.push(z),r.push(["get",w[1]])}if(r.length===1)return u;if(g<u.length)r.push(u.slice(g));else if(r.length===2)return["to-string",r[1]];return r}function Gv(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const r of u.slice(1))if(!Gv(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}em(function(u,r){var s=function(){var g=function(yt,Ne,Ze,vt){for(Ze=Ze||{},vt=yt.length;vt--;Ze[yt[vt]]=Ne);return Ze},w=[1,12],z=[1,13],f=[1,9],h=[1,10],D=[1,11],N=[1,14],F=[1,15],G=[14,18,22,24],H=[18,22],Pe=[22,24],ke={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(Ne,Ze,vt,ct,pt,lt,fi){var Et=lt.length-1;switch(pt){case 1:this.$=new String(Ne.replace(/\\(\\|")/g,"$1").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b")),this.$.__line__=this._$.first_line;break;case 2:this.$=new Number(Ne),this.$.__line__=this._$.first_line;break;case 3:this.$=null;break;case 4:this.$=new Boolean(!0),this.$.__line__=this._$.first_line;break;case 5:this.$=new Boolean(!1),this.$.__line__=this._$.first_line;break;case 6:return this.$=lt[Et-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=lt[Et-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[lt[Et-2],lt[Et]];break;case 16:this.$={},this.$[lt[Et][0]]=lt[Et][1];break;case 17:this.$=lt[Et-2],lt[Et-2][lt[Et][0]]=lt[Et][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[lt[Et]];break;case 21:this.$=lt[Et-2],lt[Et-2].push(lt[Et]);break}},table:[{3:5,4:w,5:6,6:z,7:3,8:f,9:4,10:h,11:D,12:1,13:2,15:7,16:8,17:N,23:F},{1:[3]},{14:[1,16]},g(G,[2,7]),g(G,[2,8]),g(G,[2,9]),g(G,[2,10]),g(G,[2,11]),g(G,[2,12]),g(G,[2,3]),g(G,[2,4]),g(G,[2,5]),g([14,18,21,22,24],[2,1]),g(G,[2,2]),{3:20,4:w,18:[1,17],19:18,20:19},{3:5,4:w,5:6,6:z,7:3,8:f,9:4,10:h,11:D,13:23,15:7,16:8,17:N,23:F,24:[1,21],25:22},{1:[2,6]},g(G,[2,13]),{18:[1,24],22:[1,25]},g(H,[2,16]),{21:[1,26]},g(G,[2,18]),{22:[1,28],24:[1,27]},g(Pe,[2,20]),g(G,[2,14]),{3:20,4:w,20:29},{3:5,4:w,5:6,6:z,7:3,8:f,9:4,10:h,11:D,13:30,15:7,16:8,17:N,23:F},g(G,[2,19]),{3:5,4:w,5:6,6:z,7:3,8:f,9:4,10:h,11:D,13:31,15:7,16:8,17:N,23:F},g(H,[2,17]),g(H,[2,15]),g(Pe,[2,21])],defaultActions:{16:[2,6]},parseError:function(Ne,Ze){if(Ze.recoverable)this.trace(Ne);else throw new Error(Ne)},parse:function(Ne){var Ze=this,vt=[0],ct=[null],pt=[],lt=this.table,fi="",Et=0,Wt=0,Ei=2,qi=1,Xt=pt.slice.call(arguments,1),Qt=Object.create(this.lexer),Ai={yy:{}};for(var bt in this.yy)Object.prototype.hasOwnProperty.call(this.yy,bt)&&(Ai.yy[bt]=this.yy[bt]);Qt.setInput(Ne,Ai.yy),Ai.yy.lexer=Qt,Ai.yy.parser=this,typeof Qt.yylloc=="undefined"&&(Qt.yylloc={});var Gi=Qt.yylloc;pt.push(Gi);var mr=Qt.options&&Qt.options.ranges;typeof Ai.yy.parseError=="function"?this.parseError=Ai.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function Ar(){var zt;return zt=Qt.lex()||qi,typeof zt!="number"&&(zt=Ze.symbols_[zt]||zt),zt}for(var Rt,ai,yi,Fi,jt={},Xi,Ri,Ii,rr;;){if(ai=vt[vt.length-1],this.defaultActions[ai]?yi=this.defaultActions[ai]:((Rt===null||typeof Rt=="undefined")&&(Rt=Ar()),yi=lt[ai]&&lt[ai][Rt]),typeof yi=="undefined"||!yi.length||!yi[0]){var zi="";rr=[];for(Xi in lt[ai])this.terminals_[Xi]&&Xi>Ei&&rr.push("'"+this.terminals_[Xi]+"'");Qt.showPosition?zi="Parse error on line "+(Et+1)+`:
`+Qt.showPosition()+`
Expecting `+rr.join(", ")+", got '"+(this.terminals_[Rt]||Rt)+"'":zi="Parse error on line "+(Et+1)+": Unexpected "+(Rt==qi?"end of input":"'"+(this.terminals_[Rt]||Rt)+"'"),this.parseError(zi,{text:Qt.match,token:this.terminals_[Rt]||Rt,line:Qt.yylineno,loc:Gi,expected:rr})}if(yi[0]instanceof Array&&yi.length>1)throw new Error("Parse Error: multiple actions possible at state: "+ai+", token: "+Rt);switch(yi[0]){case 1:vt.push(Rt),ct.push(Qt.yytext),pt.push(Qt.yylloc),vt.push(yi[1]),Rt=null,Wt=Qt.yyleng,fi=Qt.yytext,Et=Qt.yylineno,Gi=Qt.yylloc;break;case 2:if(Ri=this.productions_[yi[1]][1],jt.$=ct[ct.length-Ri],jt._$={first_line:pt[pt.length-(Ri||1)].first_line,last_line:pt[pt.length-1].last_line,first_column:pt[pt.length-(Ri||1)].first_column,last_column:pt[pt.length-1].last_column},mr&&(jt._$.range=[pt[pt.length-(Ri||1)].range[0],pt[pt.length-1].range[1]]),Fi=this.performAction.apply(jt,[fi,Wt,Et,Ai.yy,yi[1],ct,pt].concat(Xt)),typeof Fi!="undefined")return Fi;Ri&&(vt=vt.slice(0,-1*Ri*2),ct=ct.slice(0,-1*Ri),pt=pt.slice(0,-1*Ri)),vt.push(this.productions_[yi[1]][0]),ct.push(jt.$),pt.push(jt._$),Ii=lt[vt[vt.length-2]][vt[vt.length-1]],vt.push(Ii);break;case 3:return!0}}return!0}},We=function(){var yt={EOF:1,parseError:function(Ze,vt){if(this.yy.parser)this.yy.parser.parseError(Ze,vt);else throw new Error(Ze)},setInput:function(Ne,Ze){return this.yy=Ze||this.yy||{},this._input=Ne,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var Ne=this._input[0];this.yytext+=Ne,this.yyleng++,this.offset++,this.match+=Ne,this.matched+=Ne;var Ze=Ne.match(/(?:\r\n?|\n).*/g);return Ze?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),Ne},unput:function(Ne){var Ze=Ne.length,vt=Ne.split(/(?:\r\n?|\n)/g);this._input=Ne+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Ze),this.offset-=Ze;var ct=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),vt.length-1&&(this.yylineno-=vt.length-1);var pt=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:vt?(vt.length===ct.length?this.yylloc.first_column:0)+ct[ct.length-vt.length].length-vt[0].length:this.yylloc.first_column-Ze},this.options.ranges&&(this.yylloc.range=[pt[0],pt[0]+this.yyleng-Ze]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(Ne){this.unput(this.match.slice(Ne))},pastInput:function(){var Ne=this.matched.substr(0,this.matched.length-this.match.length);return(Ne.length>20?"...":"")+Ne.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var Ne=this.match;return Ne.length<20&&(Ne+=this._input.substr(0,20-Ne.length)),(Ne.substr(0,20)+(Ne.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var Ne=this.pastInput(),Ze=new Array(Ne.length+1).join("-");return Ne+this.upcomingInput()+`
`+Ze+"^"},test_match:function(Ne,Ze){var vt,ct,pt;if(this.options.backtrack_lexer&&(pt={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(pt.yylloc.range=this.yylloc.range.slice(0))),ct=Ne[0].match(/(?:\r\n?|\n).*/g),ct&&(this.yylineno+=ct.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:ct?ct[ct.length-1].length-ct[ct.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+Ne[0].length},this.yytext+=Ne[0],this.match+=Ne[0],this.matches=Ne,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(Ne[0].length),this.matched+=Ne[0],vt=this.performAction.call(this,this.yy,this,Ze,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),vt)return vt;if(this._backtrack){for(var lt in pt)this[lt]=pt[lt];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var Ne,Ze,vt,ct;this._more||(this.yytext="",this.match="");for(var pt=this._currentRules(),lt=0;lt<pt.length;lt++)if(vt=this._input.match(this.rules[pt[lt]]),vt&&(!Ze||vt[0].length>Ze[0].length)){if(Ze=vt,ct=lt,this.options.backtrack_lexer){if(Ne=this.test_match(vt,pt[lt]),Ne!==!1)return Ne;if(this._backtrack){Ze=!1;continue}else return!1}else if(!this.options.flex)break}return Ze?(Ne=this.test_match(Ze,pt[ct]),Ne!==!1?Ne:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var Ze=this.next();return Ze||this.lex()},begin:function(Ze){this.conditionStack.push(Ze)},popState:function(){var Ze=this.conditionStack.length-1;return Ze>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(Ze){return Ze=this.conditionStack.length-1-Math.abs(Ze||0),Ze>=0?this.conditionStack[Ze]:"INITIAL"},pushState:function(Ze){this.begin(Ze)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(Ze,vt,ct,pt){switch(ct){case 0:break;case 1:return 6;case 2:return vt.yytext=vt.yytext.substr(1,vt.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return yt}();ke.lexer=We;function je(){this.yy={}}return je.prototype=ke,ke.Parser=je,new je}();typeof Bw!="undefined"&&(r.parser=s,r.Parser=s.Parser,r.parse=function(){return s.parse.apply(s,arguments)})});const J2={StyleExpression:Nv,isExpression:jv,isExpressionFilter:Gv,createExpression:Vv,createPropertyExpression:qv,normalizePropertyExpression:j2,ZoomConstantExpression:Zy,ZoomDependentExpression:Hy,StylePropertyFunction:pm},$2={convertFunction:G2,createFunction:gg,isFunction:yg};function Y2(u){var r=u.expr,s=u.layer,g=Math.min(r(s,"paint","circle-radius"),8),w=Math.min(r(s,"paint","circle-stroke-width"),4),z=r(s,"paint","circle-color"),f=r(s,"paint","circle-opacity"),h=r(s,"paint","circle-stroke-color"),D=r(s,"paint","circle-stroke-opacity"),N=g-w/2;return{element:"svg",attributes:{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",style:{filter:"blur("+r(s,"paint","circle-blur")*N+"px)"}},children:[{element:"circle",attributes:{key:"l1",cx:10,cy:10,fill:z,opacity:f,r:N}},{element:"circle",attributes:{key:"l2",cx:10,cy:10,fill:"transparent",opacity:D,r:g,"stroke-width":w,stroke:h}}]}}function Q2(u){var r=u.expr,s=u.layer;return{element:"div",attributes:{style:{width:"100%",height:"100%",backgroundImage:"url("+(0,u.image)(r(s,"paint","fill-pattern"))+")",backgroundColor:r(s,"paint","fill-color"),opacity:r(s,"paint","fill-opacity"),backgroundSize:"66% 66%",backgroundPosition:"center"}}}}function eE(u){var r=u.layer,s=u.expr,g=(0,u.image)(s(r,"paint","line-pattern")),w={stroke:g?"url(#img1)":s(r,"paint","line-color"),strokeWidth:Math.max(2,Math.min(s(r,"paint","line-width"),8)),strokeOpacity:s(r,"paint","line-opacity")},z=w.strokeWidth;return{element:"svg",attributes:{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},children:[{element:"defs",attributes:{key:"defs"},children:[{element:"pattern",attributes:{key:"pattern",id:"img1",x:0,y:0,width:w.strokeWidth,height:w.strokeWidth,patternUnits:"userSpaceOnUse",patternTransform:"translate("+-z/2+" "+-z/2+") rotate(45)"},children:[{element:"image",attributes:{key:"img",xlinkHref:g,x:0,y:0,width:w.strokeWidth,height:w.strokeWidth}}]}]},{element:"path",attributes:{key:"path",style:w,stroke:w.stroke,d:"M0 20 L 20 0"}}]}}function tE(u){return function(h){var D=h.image,N=(0,h.expr)(h.layer,"layout","icon-image");if(!N)return null;var F=D(N);return F?{element:"div",attributes:{style:{backgroundImage:"url("+F+")",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",width:"100%",height:"100%"}}}:null}(u)||(w=(s=(r=u).expr)(g=r.layer,"paint","text-color"),z=s(g,"paint","text-opacity"),{element:"svg",attributes:{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},children:[{element:"path",attributes:{key:"l1",d:f="M 4,4 L 16,4 L 16,7 L 11.5 7 L 11.5 16 L 8.5 16 L 8.5 7 L 4 7 Z",stroke:s(g,"paint","text-halo-color"),"stroke-width":2*s(g,"paint","text-halo-width"),fill:"transparent","stroke-linejoin":"round"}},{element:"path",attributes:{key:"l2",d:f,fill:"white"}},{element:"path",attributes:{key:"l3",d:f,fill:w,opacity:z}}]});var r,s,g,w,z,f}var iE=[["background"],["circle"],["fill-extrusion"],["fill"],["heatmap"],["hillshade"],["line"],["raster"],["icon","symbol"],["text","symbol"]];function rE(u){var r,s=u.sprite,g=u.layer,w={circle:Y2,symbol:tE,line:eE,fill:Q2}[g.type],z=(r=u.zoom,function(f,h,D){var N=function(ke){var We=iE.find(function(je){return ke.startsWith(je[0])});return We?We[1]||We[0]:null}(D),F=Rw[h+"_"+N][D];if(!f[h])return F.default;var G=f[h][D];if(G===void 0)return F.default;if(typeof G=="object"){var H;if(!(H=Array.isArray(G)?J2.createExpression(G).value:$2.createFunction(G,F)).evaluate)return null;var Pe=H.evaluate({zoom:r},{});return Pe?Pe.name||Pe:null}return G});return w?w({layer:g,expr:z,image:function(f){if(s&&s.json){var h=s.json[f];if(h)return D=s.image,F=(N=h).x,G=N.y,H=N.width,Pe=N.height,(ke=document.createElement("canvas")).width=2*H,ke.height=2*Pe,ke.getContext("2d").drawImage(D,2*F,2*G,2*H,2*Pe,0,0,2*H,2*Pe),ke.toDataURL()}var D,N,F,G,H,Pe,ke;return null}}):null}class nE{constructor(r){this.spriteUrl=r}async load(){const r=await Promise.all([this.loadImage(`${this.spriteUrl}@2x.png`),this.fetchUrl(`${this.spriteUrl}@2x.json`)]);return this.sprite={image:r[0],json:r[1]},this.sprite}loadImage(r){let s=!1;const g=new Promise((w,z)=>{const f=new Image;f.crossOrigin="Anonymous",f.onload=()=>{s||w(f)},f.onerror=h=>{s||z(h)},f.src=r});return g.cancel=()=>{s=!0},g}async fetchUrl(r){return(await fetch(r)).json()}getIconDataUrl(r){let s;if(r.layout&&r.layout["icon-image"]){let g=r.layout["icon-image"];if(Array.isArray(g)&&(g=g[g.length-1]),this.sprite.json){let w;Object.keys(this.sprite.json).forEach(z=>{z===g&&(w=this.sprite.json[z])}),w&&(s=this.extractPartOfImage(this.sprite.image,w))}}return s}extractPartOfImage(r,s){const w=document.createElement("canvas");return w.width=s.width*1,w.height=s.height*1,w.getContext("2d").drawImage(r,s.x*1,s.y*1,s.width*1,s.height*1,0,0,s.width*1,s.height*1),w.toDataURL()}}function oE(u){let r,s=u[0].innerHTML+"";return{c(){r=gr("div"),this.h()},l(g){r=_r(g,"DIV",{class:!0});var w=Dr(r);w.forEach(Mt),this.h()},h(){jr(r,"class","legend svelte-1dizgfa")},m(g,w){xi(g,r,w),r.innerHTML=s},p(g,[w]){w&1&&s!==(s=g[0].innerHTML+"")&&(r.innerHTML=s)},i:vs,o:vs,d(g){g&&Mt(r)}}}function aE(u,r,s){let g,w;jf(u,Qf,D=>s(2,g=D)),jf(u,z_,D=>s(3,w=D));let{layer:z}=r,f=document.createElement("div");const h=async()=>{if(!w){const G=g.getStyle().sprite,H=new nE(G);await H.load(),z_.update(()=>H)}const D=g.getZoom(),N=rE({zoom:D,layer:z});if(s(0,f.innerText="",f),N){let G,H,Pe;switch(N.element){case"div":if(N.attributes.style.backgroundImage&&!["url(undefined)","url(null)"].includes(N.attributes.style.backgroundImage)){var F=document.createElement("img");F.src=N.attributes.style.backgroundImage.replace("url(","").replace(")",""),F.alt=z.id,F.style.cssText="height: 24px;",f.appendChild(F)}G=document.createElement("div"),G.style.height="24px",G.style.width="50px",G.style.backgroundColor=N.attributes.style.backgroundColor,G.style.backgroundPosition=N.attributes.style.backgroundPosition,G.style.backgroundSize=N.attributes.style.backgroundSize,G.style.backgroundRepeat=N.attributes.style.backgroundRepeat,G.style.opacity=N.attributes.style.opacity,f.appendChild(G);break;case"svg":if(Pe=w.getIconDataUrl(z),Pe){const ke=document.createElement("img");ke.src=Pe,ke.alt=z.id,ke.style.cssText="height: 24px;",f.appendChild(ke);break}H=document.createElementNS("http://www.w3.org/2000/svg","svg"),H.style.cssText="height: 24px;",H.setAttributeNS(null,"version","1.1"),Object.keys(N.attributes).forEach(ke=>{H.setAttribute(ke,N.attributes[ke]);let We=document.createElementNS("http://www.w3.org/2000/svg","g");N.children.forEach(je=>{var yt=document.createElementNS("http://www.w3.org/2000/svg",je.element);Object.keys(je.attributes).forEach(Ne=>{yt.setAttributeNS(null,Ne,je.attributes[Ne])}),We.appendChild(yt)}),H.appendChild(We)}),f.appendChild(H);break;default:console.log(N.element);return}}else{const G=document.createElementNS("http://www.w3.org/2000/svg","svg"),H=document.createElementNS("http://www.w3.org/2000/svg","path"),Pe=document.createElementNS("http://www.w3.org/2000/svg","path");G.setAttribute("fill","none"),G.setAttribute("viewBox","0 0 24 24"),G.setAttribute("stroke","black"),G.classList.add("post-icon"),H.setAttribute("d","M21,0H3A3,3,0,0,0,0,3V21a3,3,0,0,0,3,3H21a3,3,0,0,0,3-3V3A3,3,0,0,0,21,0ZM3,2H21a1,1,0,0,1,1,1V15.86L14.18,9.35a5.06,5.06,0,0,0-6.39-.06L2,13.92V3A1,1,0,0,1,3,2ZM21,22H3a1,1,0,0,1-1-1V16.48l7-5.63a3.06,3.06,0,0,1,3.86,0L22,18.47V21A1,1,0,0,1,21,22Z"),H.setAttribute("stroke-linecap","round"),H.setAttribute("stroke-linejoin","round"),H.setAttribute("stroke-width","2"),Pe.setAttribute("d","M18,9a3,3,0,1,0-3-3A3,3,0,0,0,18,9Zm0-4a1,1,0,1,1-1,1A1,1,0,0,1,18,5Z"),Pe.setAttribute("stroke-linecap","round"),Pe.setAttribute("stroke-linejoin","round"),Pe.setAttribute("stroke-width","2"),G.appendChild(H),G.appendChild(Pe),f.appendChild(G)}};return g.on("moveend",h),g.on("zoom",h),u.$$set=D=>{"layer"in D&&s(1,z=D.layer)},u.$$.update=()=>{u.$$.dirty&2&&h()},[f,z]}class sE extends wn{constructor(r){super(),En(this,r,aE,oE,gn,{layer:1})}}function lE(u){let r;return{c(){r=Lc("visibility")},l(s){r=Dc(s,"visibility")},m(s,g){xi(s,r,g)},d(s){s&&Mt(r)}}}function uE(u){let r;return{c(){r=Lc("visibility_off")},l(s){r=Dc(s,"visibility_off")},m(s,g){xi(s,r,g)},d(s){s&&Mt(r)}}}function cE(u){let r,s,g,w;return r=new E_({props:{class:"material-icons",on:!0,$$slots:{default:[lE]},$$scope:{ctx:u}}}),g=new E_({props:{class:"material-icons",$$slots:{default:[uE]},$$scope:{ctx:u}}}),{c(){pr(r.$$.fragment),s=qo(),pr(g.$$.fragment)},l(z){Rr(r.$$.fragment,z),s=Go(z),Rr(g.$$.fragment,z)},m(z,f){dr(r,z,f),xi(z,s,f),dr(g,z,f),w=!0},p(z,f){const h={};f&64&&(h.$$scope={dirty:f,ctx:z}),r.$set(h);const D={};f&64&&(D.$$scope={dirty:f,ctx:z}),g.$set(D)},i(z){w||(ii(r.$$.fragment,z),ii(g.$$.fragment,z),w=!0)},o(z){ui(r.$$.fragment,z),ui(g.$$.fragment,z),w=!1},d(z){fr(r,z),z&&Mt(s),fr(g,z)}}}function hE(u){let r,s,g,w,z,f;function h(N){u[2](N)}let D={toggle:!0,$$slots:{default:[cE]},$$scope:{ctx:u}};return u[1]!==void 0&&(D.pressed=u[1]),s=new Gf({props:D}),an.push(()=>Up(s,"pressed",h)),z=new sE({props:{layer:u[0]}}),{c(){r=gr("div"),pr(s.$$.fragment),w=qo(),pr(z.$$.fragment),this.h()},l(N){r=_r(N,"DIV",{style:!0});var F=Dr(r);Rr(s.$$.fragment,F),F.forEach(Mt),w=Go(N),Rr(z.$$.fragment,N),this.h()},h(){c_(r,"display","flex"),c_(r,"align-items","center")},m(N,F){xi(N,r,F),dr(s,r,null),xi(N,w,F),dr(z,N,F),f=!0},p(N,F){const G={};F&64&&(G.$$scope={dirty:F,ctx:N}),!g&&F&2&&(g=!0,G.pressed=N[1],Np(()=>g=!1)),s.$set(G);const H={};F&1&&(H.layer=N[0]),z.$set(H)},i(N){f||(ii(s.$$.fragment,N),ii(z.$$.fragment,N),f=!0)},o(N){ui(s.$$.fragment,N),ui(z.$$.fragment,N),f=!1},d(N){N&&Mt(r),fr(s),N&&Mt(w),fr(z,N)}}}function pE(u){let r,s=(Ur.legend&&Ur.legend.targets&&Ur.legend.targets[u[0].id]?Ur.legend.targets[u[0].id]:u[0].id)+"",g;return{c(){r=gr("span"),g=Lc(s),this.h()},l(w){r=_r(w,"SPAN",{slot:!0});var z=Dr(r);g=Dc(z,s),z.forEach(Mt),this.h()},h(){jr(r,"slot","label")},m(w,z){xi(w,r,z),fa(r,g)},p(w,z){z&1&&s!==(s=(Ur.legend&&Ur.legend.targets&&Ur.legend.targets[w[0].id]?Ur.legend.targets[w[0].id]:w[0].id)+"")&&hv(g,s)},d(w){w&&Mt(r)}}}function dE(u){let r,s,g;return s=new jy({props:{$$slots:{label:[pE],default:[hE]},$$scope:{ctx:u}}}),{c(){r=gr("div"),pr(s.$$.fragment)},l(w){r=_r(w,"DIV",{});var z=Dr(r);Rr(s.$$.fragment,z),z.forEach(Mt)},m(w,z){xi(w,r,z),dr(s,r,null),g=!0},p(w,[z]){const f={};z&67&&(f.$$scope={dirty:z,ctx:w}),s.$set(f)},i(w){g||(ii(s.$$.fragment,w),g=!0)},o(w){ui(s.$$.fragment,w),g=!1},d(w){w&&Mt(r),fr(s)}}}function fE(u,r,s){let g;jf(u,Qf,N=>s(4,g=N));let{layer:w}=r,z="visible";w.layout&&w.layout.visibility==="none"&&(z="none");let f=z==="visible";const h=()=>{g.setLayoutProperty(w.id,"visibility",f===!0?"visible":"none")};function D(N){f=N,s(1,f)}return u.$$set=N=>{"layer"in N&&s(0,w=N.layer)},u.$$.update=()=>{u.$$.dirty&2&&h()},[w,f,D]}class dm extends wn{constructor(r){super(),En(this,r,fE,dE,gn,{layer:0})}}function U_(u,r,s){const g=u.slice();return g[15]=r[s],g}function mE(u){let r,s,g;function w(f){u[9](f)}let z={};return u[2]!==void 0&&(z.checked=u[2]),r=new bv({props:z}),an.push(()=>Up(r,"checked",w)),{c(){pr(r.$$.fragment)},l(f){Rr(r.$$.fragment,f)},m(f,h){dr(r,f,h),g=!0},p(f,h){const D={};!s&&h&4&&(s=!0,D.checked=f[2],Np(()=>s=!1)),r.$set(D)},i(f){g||(ii(r.$$.fragment,f),g=!0)},o(f){ui(r.$$.fragment,f),g=!1},d(f){fr(r,f)}}}function yE(u){let r,s;return{c(){r=gr("span"),s=Lc("Show only rendered"),this.h()},l(g){r=_r(g,"SPAN",{slot:!0});var w=Dr(r);s=Dc(w,"Show only rendered"),w.forEach(Mt),this.h()},h(){jr(r,"slot","label")},m(g,w){xi(g,r,w),fa(r,s)},p:vs,d(g){g&&Mt(r)}}}function gE(u){let r,s,g;function w(f){u[10](f)}let z={};return u[3]!==void 0&&(z.checked=u[3]),r=new bv({props:z}),an.push(()=>Up(r,"checked",w)),{c(){pr(r.$$.fragment)},l(f){Rr(r.$$.fragment,f)},m(f,h){dr(r,f,h),g=!0},p(f,h){const D={};!s&&h&8&&(s=!0,D.checked=f[3],Np(()=>s=!1)),r.$set(D)},i(f){g||(ii(r.$$.fragment,f),g=!0)},o(f){ui(r.$$.fragment,f),g=!1},d(f){fr(r,f)}}}function _E(u){let r,s;return{c(){r=gr("span"),s=Lc("Show only water"),this.h()},l(g){r=_r(g,"SPAN",{slot:!0});var w=Dr(r);s=Dc(w,"Show only water"),w.forEach(Mt),this.h()},h(){jr(r,"slot","label")},m(g,w){xi(g,r,w),fa(r,s)},p:vs,d(g){g&&Mt(r)}}}function vE(u){let r,s,g,w,z,f;return r=new jy({props:{$$slots:{label:[yE],default:[mE]},$$scope:{ctx:u}}}),g=new jy({props:{$$slots:{label:[_E],default:[gE]},$$scope:{ctx:u}}}),{c(){pr(r.$$.fragment),s=qo(),pr(g.$$.fragment),w=qo(),z=gr("hr")},l(h){Rr(r.$$.fragment,h),s=Go(h),Rr(g.$$.fragment,h),w=Go(h),z=_r(h,"HR",{})},m(h,D){dr(r,h,D),xi(h,s,D),dr(g,h,D),xi(h,w,D),xi(h,z,D),f=!0},p(h,D){const N={};D&4100&&(N.$$scope={dirty:D,ctx:h}),r.$set(N);const F={};D&4104&&(F.$$scope={dirty:D,ctx:h}),g.$set(F)},i(h){f||(ii(r.$$.fragment,h),ii(g.$$.fragment,h),f=!0)},o(h){ui(r.$$.fragment,h),ui(g.$$.fragment,h),f=!1},d(h){fr(r,h),h&&Mt(s),fr(g,h),h&&Mt(w),h&&Mt(z)}}}function xE(u){let r,s;return r=new Yf({props:{$$slots:{default:[EE]},$$scope:{ctx:u}}}),{c(){pr(r.$$.fragment)},l(g){Rr(r.$$.fragment,g)},m(g,w){dr(r,g,w),s=!0},p(g,w){const z={};w&4112&&(z.$$scope={dirty:w,ctx:g}),r.$set(z)},i(g){s||(ii(r.$$.fragment,g),s=!0)},o(g){ui(r.$$.fragment,g),s=!1},d(g){fr(r,g)}}}function bE(u){let r,s,g=u[6][u[15].id]&&N_(u);return{c(){g&&g.c(),r=hn()},l(w){g&&g.l(w),r=hn()},m(w,z){g&&g.m(w,z),xi(w,r,z),s=!0},p(w,z){w[6][w[15].id]?g?(g.p(w,z),z&80&&ii(g,1)):(g=N_(w),g.c(),ii(g,1),g.m(r.parentNode,r)):g&&(pl(),ui(g,1,1,()=>{g=null}),hl())},i(w){s||(ii(g),s=!0)},o(w){ui(g),s=!1},d(w){g&&g.d(w),w&&Mt(r)}}}function wE(u){let r,s,g=u[5][u[15].id]&&j_(u);return{c(){g&&g.c(),r=hn()},l(w){g&&g.l(w),r=hn()},m(w,z){g&&g.m(w,z),xi(w,r,z),s=!0},p(w,z){w[5][w[15].id]?g?(g.p(w,z),z&48&&ii(g,1)):(g=j_(w),g.c(),ii(g,1),g.m(r.parentNode,r)):g&&(pl(),ui(g,1,1,()=>{g=null}),hl())},i(w){s||(ii(g),s=!0)},o(w){ui(g),s=!1},d(w){g&&g.d(w),w&&Mt(r)}}}function EE(u){let r,s;return r=new dm({props:{layer:u[15]}}),{c(){pr(r.$$.fragment)},l(g){Rr(r.$$.fragment,g)},m(g,w){dr(r,g,w),s=!0},p(g,w){const z={};w&16&&(z.layer=g[15]),r.$set(z)},i(g){s||(ii(r.$$.fragment,g),s=!0)},o(g){ui(r.$$.fragment,g),s=!1},d(g){fr(r,g)}}}function N_(u){let r,s;return r=new Yf({props:{$$slots:{default:[IE]},$$scope:{ctx:u}}}),{c(){pr(r.$$.fragment)},l(g){Rr(r.$$.fragment,g)},m(g,w){dr(r,g,w),s=!0},p(g,w){const z={};w&4112&&(z.$$scope={dirty:w,ctx:g}),r.$set(z)},i(g){s||(ii(r.$$.fragment,g),s=!0)},o(g){ui(r.$$.fragment,g),s=!1},d(g){fr(r,g)}}}function IE(u){let r,s;return r=new dm({props:{layer:u[15]}}),{c(){pr(r.$$.fragment)},l(g){Rr(r.$$.fragment,g)},m(g,w){dr(r,g,w),s=!0},p(g,w){const z={};w&16&&(z.layer=g[15]),r.$set(z)},i(g){s||(ii(r.$$.fragment,g),s=!0)},o(g){ui(r.$$.fragment,g),s=!1},d(g){fr(r,g)}}}function j_(u){let r,s,g,w;const z=[TE,SE],f=[];function h(D,N){return D[3]===!0?0:1}return r=h(u),s=f[r]=z[r](u),{c(){s.c(),g=hn()},l(D){s.l(D),g=hn()},m(D,N){f[r].m(D,N),xi(D,g,N),w=!0},p(D,N){let F=r;r=h(D),r===F?f[r].p(D,N):(pl(),ui(f[F],1,1,()=>{f[F]=null}),hl(),s=f[r],s?s.p(D,N):(s=f[r]=z[r](D),s.c()),ii(s,1),s.m(g.parentNode,g))},i(D){w||(ii(s),w=!0)},o(D){ui(s),w=!1},d(D){f[r].d(D),D&&Mt(g)}}}function SE(u){let r,s;return r=new Yf({props:{$$slots:{default:[AE]},$$scope:{ctx:u}}}),{c(){pr(r.$$.fragment)},l(g){Rr(r.$$.fragment,g)},m(g,w){dr(r,g,w),s=!0},p(g,w){const z={};w&4112&&(z.$$scope={dirty:w,ctx:g}),r.$set(z)},i(g){s||(ii(r.$$.fragment,g),s=!0)},o(g){ui(r.$$.fragment,g),s=!1},d(g){fr(r,g)}}}function TE(u){let r,s,g=u[6][u[15].id]&&V_(u);return{c(){g&&g.c(),r=hn()},l(w){g&&g.l(w),r=hn()},m(w,z){g&&g.m(w,z),xi(w,r,z),s=!0},p(w,z){w[6][w[15].id]?g?(g.p(w,z),z&80&&ii(g,1)):(g=V_(w),g.c(),ii(g,1),g.m(r.parentNode,r)):g&&(pl(),ui(g,1,1,()=>{g=null}),hl())},i(w){s||(ii(g),s=!0)},o(w){ui(g),s=!1},d(w){g&&g.d(w),w&&Mt(r)}}}function AE(u){let r,s;return r=new dm({props:{layer:u[15]}}),{c(){pr(r.$$.fragment)},l(g){Rr(r.$$.fragment,g)},m(g,w){dr(r,g,w),s=!0},p(g,w){const z={};w&16&&(z.layer=g[15]),r.$set(z)},i(g){s||(ii(r.$$.fragment,g),s=!0)},o(g){ui(r.$$.fragment,g),s=!1},d(g){fr(r,g)}}}function V_(u){let r,s;return r=new Yf({props:{$$slots:{default:[CE]},$$scope:{ctx:u}}}),{c(){pr(r.$$.fragment)},l(g){Rr(r.$$.fragment,g)},m(g,w){dr(r,g,w),s=!0},p(g,w){const z={};w&4112&&(z.$$scope={dirty:w,ctx:g}),r.$set(z)},i(g){s||(ii(r.$$.fragment,g),s=!0)},o(g){ui(r.$$.fragment,g),s=!1},d(g){fr(r,g)}}}function CE(u){let r,s;return r=new dm({props:{layer:u[15]}}),{c(){pr(r.$$.fragment)},l(g){Rr(r.$$.fragment,g)},m(g,w){dr(r,g,w),s=!0},p(g,w){const z={};w&16&&(z.layer=g[15]),r.$set(z)},i(g){s||(ii(r.$$.fragment,g),s=!0)},o(g){ui(r.$$.fragment,g),s=!1},d(g){fr(r,g)}}}function q_(u){let r,s,g,w;const z=[wE,bE,xE],f=[];function h(D,N){return D[2]===!0?0:D[3]===!0?1:2}return r=h(u),s=f[r]=z[r](u),{c(){s.c(),g=hn()},l(D){s.l(D),g=hn()},m(D,N){f[r].m(D,N),xi(D,g,N),w=!0},p(D,N){let F=r;r=h(D),r===F?f[r].p(D,N):(pl(),ui(f[F],1,1,()=>{f[F]=null}),hl(),s=f[r],s?s.p(D,N):(s=f[r]=z[r](D),s.c()),ii(s,1),s.m(g.parentNode,g))},i(D){w||(ii(s),w=!0)},o(D){ui(s),w=!1},d(D){f[r].d(D),D&&Mt(g)}}}function G_(u){let r,s,g=u[4],w=[];for(let f=0;f<g.length;f+=1)w[f]=q_(U_(u,g,f));const z=f=>ui(w[f],1,1,()=>{w[f]=null});return{c(){for(let f=0;f<w.length;f+=1)w[f].c();r=hn()},l(f){for(let h=0;h<w.length;h+=1)w[h].l(f);r=hn()},m(f,h){for(let D=0;D<w.length;D+=1)w[D].m(f,h);xi(f,r,h),s=!0},p(f,h){if(h&124){g=f[4];let D;for(D=0;D<g.length;D+=1){const N=U_(f,g,D);w[D]?(w[D].p(N,h),ii(w[D],1)):(w[D]=q_(N),w[D].c(),ii(w[D],1),w[D].m(r.parentNode,r))}for(pl(),D=g.length;D<w.length;D+=1)z(D);hl()}},i(f){if(!s){for(let h=0;h<g.length;h+=1)ii(w[h]);s=!0}},o(f){w=w.filter(Boolean);for(let h=0;h<w.length;h+=1)ui(w[h]);s=!1},d(f){px(w,f),f&&Mt(r)}}}function kE(u){let r=u[1],s,g,w=G_(u);return{c(){w.c(),s=hn()},l(z){w.l(z),s=hn()},m(z,f){w.m(z,f),xi(z,s,f),g=!0},p(z,f){f&2&&gn(r,r=z[1])?(pl(),ui(w,1,1,vs),hl(),w=G_(z),w.c(),ii(w),w.m(s.parentNode,s)):w.p(z,f)},i(z){g||(ii(w),g=!0)},o(z){ui(w),g=!1},d(z){z&&Mt(s),w.d(z)}}}function zE(u){let r,s;return r=new Sb({props:{$$slots:{default:[kE]},$$scope:{ctx:u}}}),{c(){pr(r.$$.fragment)},l(g){Rr(r.$$.fragment,g)},m(g,w){dr(r,g,w),s=!0},p(g,w){const z={};w&4222&&(z.$$scope={dirty:w,ctx:g}),r.$set(z)},i(g){s||(ii(r.$$.fragment,g),s=!0)},o(g){ui(r.$$.fragment,g),s=!1},d(g){fr(r,g)}}}function PE(u){let r,s,g,w,z;return s=new bb({props:{$$slots:{default:[vE]},$$scope:{ctx:u}}}),w=new xb({props:{$$slots:{default:[zE]},$$scope:{ctx:u}}}),{c(){r=gr("div"),pr(s.$$.fragment),g=qo(),pr(w.$$.fragment),this.h()},l(f){r=_r(f,"DIV",{class:!0});var h=Dr(r);Rr(s.$$.fragment,h),g=Go(h),Rr(w.$$.fragment,h),h.forEach(Mt),this.h()},h(){jr(r,"class","drawer-content svelte-kw9kwo")},m(f,h){xi(f,r,h),dr(s,r,null),fa(r,g),dr(w,r,null),z=!0},p(f,h){const D={};h&4108&&(D.$$scope={dirty:h,ctx:f}),s.$set(D);const N={};h&4222&&(N.$$scope={dirty:h,ctx:f}),w.$set(N)},i(f){z||(ii(s.$$.fragment,f),ii(w.$$.fragment,f),z=!0)},o(f){ui(s.$$.fragment,f),ui(w.$$.fragment,f),z=!1},d(f){f&&Mt(r),fr(s),fr(w)}}}function ME(u){let r,s;const g=u[8].default,w=ao(g,u,u[12],null);return{c(){r=gr("main"),w&&w.c(),this.h()},l(z){r=_r(z,"MAIN",{class:!0});var f=Dr(r);w&&w.l(f),f.forEach(Mt),this.h()},h(){jr(r,"class","main-content svelte-kw9kwo")},m(z,f){xi(z,r,f),w&&w.m(r,null),s=!0},p(z,f){w&&w.p&&(!s||f&4096)&&so(w,g,z,z[12],s?uo(g,z[12],f,null):lo(z[12]),null)},i(z){s||(ii(w,z),s=!0)},o(z){ui(w,z),s=!1},d(z){z&&Mt(r),w&&w.d(z)}}}function LE(u){let r,s,g,w,z,f;function h(N){u[11](N)}let D={variant:"dismissible",$$slots:{default:[PE]},$$scope:{ctx:u}};return u[0]!==void 0&&(D.open=u[0]),s=new _b({props:D}),an.push(()=>Up(s,"open",h)),z=new vb({props:{class:"app-content",$$slots:{default:[ME]},$$scope:{ctx:u}}}),{c(){r=gr("div"),pr(s.$$.fragment),w=qo(),pr(z.$$.fragment),this.h()},l(N){r=_r(N,"DIV",{class:!0});var F=Dr(r);Rr(s.$$.fragment,F),w=Go(F),Rr(z.$$.fragment,F),F.forEach(Mt),this.h()},h(){jr(r,"class","drawer-container svelte-kw9kwo")},m(N,F){xi(N,r,F),dr(s,r,null),fa(r,w),dr(z,r,null),f=!0},p(N,[F]){const G={};F&4222&&(G.$$scope={dirty:F,ctx:N}),!g&&F&1&&(g=!0,G.open=N[0],Np(()=>g=!1)),s.$set(G);const H={};F&4096&&(H.$$scope={dirty:F,ctx:N}),z.$set(H)},i(N){f||(ii(s.$$.fragment,N),ii(z.$$.fragment,N),f=!0)},o(N){ui(s.$$.fragment,N),ui(z.$$.fragment,N),f=!1},d(N){N&&Mt(r),fr(s),fr(z)}}}function DE(u,r,s){let g;jf(u,Qf,Ne=>s(7,g=Ne));let{$$slots:w={},$$scope:z}=r,{open:f=!1}=r,h,D=!0,N=!0,F=[],G={},H={};Ur.legend&&Ur.legend.targets&&(H=Ur.legend.targets);const Pe=()=>{!g||(g.isStyleLoaded()?(s(1,h=g.getStyle()),s(4,F=h.layers),ke()):g.on("load",Pe))},ke=()=>{if(s(5,G={}),g&&g.queryRenderedFeatures){const Ne=g.queryRenderedFeatures();for(let Ze of Ne)s(5,G[Ze.layer.id]=Ze.layer,G)}};function We(Ne){D=Ne,s(2,D)}function je(Ne){N=Ne,s(3,N)}function yt(Ne){f=Ne,s(0,f)}return u.$$set=Ne=>{"open"in Ne&&s(0,f=Ne.open),"$$scope"in Ne&&s(12,z=Ne.$$scope)},u.$$.update=()=>{u.$$.dirty&128&&g&&(g.on("moveend",Pe),g.on("styledata",Pe)),u.$$.dirty&1&&Pe(),u.$$.dirty&2&&Pe(),u.$$.dirty&4&&Pe(),u.$$.dirty&8&&Pe()},[f,h,D,N,F,G,H,g,w,We,je,yt,z]}class RE extends wn{constructor(r){super(),En(this,r,DE,LE,gn,{open:0})}}var Rl=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function HA(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}function BE(u){if(u.__esModule)return u;var r=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(u).forEach(function(s){var g=Object.getOwnPropertyDescriptor(u,s);Object.defineProperty(r,s,g.get?g:{enumerable:!0,get:function(){return u[s]}})}),r}var $h={exports:{}};(function(u,r){(function(s,g){u.exports=g()})(Rl,function(){var s,g,w;function z(h,D){if(!s)s=D;else if(!g)g=D;else{var N="var sharedChunk = {}; ("+s+")(sharedChunk); ("+g+")(sharedChunk);",F={};s(F),w=D(F),typeof window!="undefined"&&(w.workerUrl=window.URL.createObjectURL(new Blob([N],{type:"text/javascript"})))}}z(["exports"],function(h){var D=N;function N(i,t,a,p){this.cx=3*i,this.bx=3*(a-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(p-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=t,this.p2x=a,this.p2y=p}function F(i,t,a,p){const _=new D(i,t,a,p);return function(b){return _.solve(b)}}N.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,t){if(t===void 0&&(t=1e-6),i<0)return 0;if(i>1)return 1;for(var a=i,p=0;p<8;p++){var _=this.sampleCurveX(a)-i;if(Math.abs(_)<t)return a;var b=this.sampleCurveDerivativeX(a);if(Math.abs(b)<1e-6)break;a-=_/b}var I=0,P=1;for(a=i,p=0;p<20&&(_=this.sampleCurveX(a),!(Math.abs(_-i)<t));p++)i>_?I=a:P=a,a=.5*(P-I)+I;return a},solve:function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))}};const G=F(.25,.1,.25,1);function H(i,t,a){return Math.min(a,Math.max(t,i))}function Pe(i,t,a){const p=a-t,_=((i-t)%p+p)%p+t;return _===t?a:_}function ke(i,...t){for(const a of t)for(const p in a)i[p]=a[p];return i}let We=1;function je(i,t){i.forEach(a=>{t[a]&&(t[a]=t[a].bind(t))})}function yt(i,t,a){const p={};for(const _ in i)p[_]=t.call(a||this,i[_],_,i);return p}function Ne(i,t,a){const p={};for(const _ in i)t.call(a||this,i[_],_,i)&&(p[_]=i[_]);return p}function Ze(i){return Array.isArray(i)?i.map(Ze):typeof i=="object"&&i?yt(i,Ze):i}const vt={};function ct(i){vt[i]||(typeof console!="undefined"&&console.warn(i),vt[i]=!0)}function pt(i,t,a){return(a.y-i.y)*(t.x-i.x)>(t.y-i.y)*(a.x-i.x)}function lt(i){let t=0;for(let a,p,_=0,b=i.length,I=b-1;_<b;I=_++)a=i[_],p=i[I],t+=(p.x-a.x)*(a.y+p.y);return t}function fi(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Et(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,p,_,b)=>{const I=_||b;return t[p]=!I||I.toLowerCase(),""}),t["max-age"]){const a=parseInt(t["max-age"],10);isNaN(a)?delete t["max-age"]:t["max-age"]=a}return t}let Wt,Ei,qi=null;function Xt(i){if(qi==null){const t=i.navigator?i.navigator.userAgent:null;qi=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return qi}function Qt(i){return typeof ImageBitmap!="undefined"&&i instanceof ImageBitmap}const Ai={now:typeof performance!="undefined"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(i){const t=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(i,t=0){const a=window.document.createElement("canvas"),p=a.getContext("2d");if(!p)throw new Error("failed to create canvas 2d context");return a.width=i.width,a.height=i.height,p.drawImage(i,0,0,i.width,i.height),p.getImageData(-t,-t,i.width+2*t,i.height+2*t)},resolveURL:i=>(Wt||(Wt=document.createElement("a")),Wt.href=i,Wt.href),hardwareConcurrency:typeof navigator!="undefined"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ei==null&&(Ei=matchMedia("(prefers-reduced-motion: reduce)")),Ei.matches)}};var bt=Gi;function Gi(i,t){this.x=i,this.y=t}Gi.prototype={clone:function(){return new Gi(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,t){return this.clone()._rotateAround(i,t)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var t=i.x-this.x,a=i.y-this.y;return t*t+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult:function(i){var t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var t=Math.cos(i),a=Math.sin(i),p=a*this.x+t*this.y;return this.x=t*this.x-a*this.y,this.y=p,this},_rotateAround:function(i,t){var a=Math.cos(i),p=Math.sin(i),_=t.y+p*(this.x-t.x)+a*(this.y-t.y);return this.x=t.x+a*(this.x-t.x)-p*(this.y-t.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Gi.convert=function(i){return i instanceof Gi?i:Array.isArray(i)?new Gi(i[0],i[1]):i};const mr={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Ar="mapbox-tiles";let Rt,ai,yi=500,Fi=50;function jt(){typeof caches=="undefined"||Rt||(Rt=caches.open(Ar))}let Xi=1/0;const Ri={supported:!1,testSupport:function(i){!zi&&rr&&(zt?tr(i):Ii=i)}};let Ii,rr,zi=!1,zt=!1;function tr(i){const t=i.createTexture();i.bindTexture(i.TEXTURE_2D,t);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,rr),i.isContextLost())return;Ri.supported=!0}catch{}i.deleteTexture(t),zi=!0}typeof document!="undefined"&&(rr=document.createElement("img"),rr.onload=function(){Ii&&tr(Ii),Ii=null,zt=!0},rr.onerror=function(){zi=!0,Ii=null},rr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Bt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Bt);class rt extends Error{constructor(t,a,p,_){super(`AJAXError: ${a} (${t}): ${p}`),this.status=t,this.statusText=a,this.url=p,this.body=_}}const _i=fi()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function ir(i,t){const a=new AbortController,p=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,referrer:_i(),signal:a.signal});let _=!1,b=!1;return i.type==="json"&&p.headers.set("Accept","application/json"),((I,P,R)=>{if(b)return;const O=Date.now();fetch(p).then(V=>V.ok?((j,K,Y)=>{(i.type==="arrayBuffer"?j.arrayBuffer():i.type==="json"?j.json():j.text()).then(Q=>{b||(K&&Y&&function(se,pe,Ae){if(jt(),!Rt)return;const Be={status:pe.status,statusText:pe.statusText,headers:new Headers};pe.headers.forEach((Ge,it)=>Be.headers.set(it,Ge));const qe=Et(pe.headers.get("Cache-Control")||"");qe["no-store"]||(qe["max-age"]&&Be.headers.set("Expires",new Date(Ae+1e3*qe["max-age"]).toUTCString()),new Date(Be.headers.get("Expires")).getTime()-Ae<42e4||function(Ge,it){if(ai===void 0)try{new Response(new ReadableStream),ai=!0}catch{ai=!1}ai?it(Ge.body):Ge.blob().then(it)}(pe,Ge=>{const it=new Response(Ge,Be);jt(),Rt&&Rt.then(He=>He.put(function(Ct){const Tt=Ct.indexOf("?");return Tt<0?Ct:Ct.slice(0,Tt)}(se.url),it)).catch(He=>ct(He.message))}))}(p,K,Y),_=!0,t(null,Q,j.headers.get("Cache-Control"),j.headers.get("Expires")))}).catch(Q=>{b||t(new Error(Q.message))})})(V,null,O):V.blob().then(j=>t(new rt(V.status,V.statusText,i.url,j)))).catch(V=>{V.code!==20&&t(new Error(V.message))})})(),{cancel:()=>{b=!0,_||a.abort()}}}const Pr=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){if(fi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t);if(!fi()){const p=i.url.substring(0,i.url.indexOf("://"));return(mr.REGISTERED_PROTOCOLS[p]||ir)(i,t)}}if(!(/^file:/.test(a=i.url)||/^file:/.test(_i())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return ir(i,t);if(fi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t,void 0,!0)}var a;return function(p,_){const b=new XMLHttpRequest;b.open(p.method||"GET",p.url,!0),p.type==="arrayBuffer"&&(b.responseType="arraybuffer");for(const I in p.headers)b.setRequestHeader(I,p.headers[I]);return p.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=p.credentials==="include",b.onerror=()=>{_(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let I=b.response;if(p.type==="json")try{I=JSON.parse(b.response)}catch(P){return _(P)}_(null,I,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else{const I=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});_(new rt(b.status,b.statusText,p.url,I))}},b.send(p.body),{cancel:()=>b.abort()}}(i,t)},co=function(i,t){return Pr(ke(i,{type:"arrayBuffer"}),t)};function Zn(i){const t=window.document.createElement("a");return t.href=i,t.protocol===window.document.location.protocol&&t.host===window.document.location.host}const Bo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let _n,ho;_n=[],ho=0;const Hn=function(i,t){if(Ri.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),ho>=mr.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:i,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return _n.push(b),b}ho++;let a=!1;const p=()=>{if(!a)for(a=!0,ho--;_n.length&&ho<mr.MAX_PARALLEL_IMAGE_REQUESTS;){const b=_n.shift(),{requestParameters:I,callback:P,cancelled:R}=b;R||(b.cancel=Hn(I,P).cancel)}},_=co(i,(b,I,P,R)=>{p(),b?t(b):I&&function(O,V){typeof createImageBitmap=="function"?function(j,K){const Y=new Blob([new Uint8Array(j)],{type:"image/png"});createImageBitmap(Y).then(Q=>{K(null,Q)}).catch(Q=>{K(new Error(`Could not load image because of ${Q.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(O,V):function(j,K){const Y=new Image;Y.onload=()=>{K(null,Y),URL.revokeObjectURL(Y.src),Y.onload=null,window.requestAnimationFrame(()=>{Y.src=Bo})},Y.onerror=()=>K(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Q=new Blob([new Uint8Array(j)],{type:"image/png"});Y.src=j.byteLength?URL.createObjectURL(Q):Bo}(O,V)}(I,(O,V)=>{O!=null?t(O):V!=null&&t(null,V,{cacheControl:P,expires:R})})});return{cancel:()=>{_.cancel(),p()}}};function Zi(i,t,a){a[i]&&a[i].indexOf(t)!==-1||(a[i]=a[i]||[],a[i].push(t))}function Un(i,t,a){if(a&&a[i]){const p=a[i].indexOf(t);p!==-1&&a[i].splice(p,1)}}class Ao{constructor(t,a={}){ke(this,a),this.type=t}}class Wn extends Ao{constructor(t,a={}){super("error",ke({error:t},a))}}class Ba{on(t,a){return this._listeners=this._listeners||{},Zi(t,a,this._listeners),this}off(t,a){return Un(t,a,this._listeners),Un(t,a,this._oneTimeListeners),this}once(t,a){return this._oneTimeListeners=this._oneTimeListeners||{},Zi(t,a,this._oneTimeListeners),this}fire(t,a){typeof t=="string"&&(t=new Ao(t,a||{}));const p=t.type;if(this.listens(p)){t.target=this;const _=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const P of _)P.call(this,t);const b=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const P of b)Un(p,P,this._oneTimeListeners),P.call(this,t);const I=this._eventedParent;I&&(ke(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),I.fire(t))}else t instanceof Wn&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,a){return this._eventedParent=t,this._eventedParentData=a,this}}var Ue={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class gt{constructor(t,a,p,_){this.message=(t?`${t}: `:"")+p,_&&(this.identifier=_),a!=null&&a.__line__&&(this.line=a.__line__)}}function Si(i){const t=i.value;return t?[new gt(i.key,t,"constants have been deprecated as of v8")]:[]}function yr(i,...t){for(const a of t)for(const p in a)i[p]=a[p];return i}function br(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Xn(i){if(Array.isArray(i))return i.map(Xn);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const a in i)t[a]=Xn(i[a]);return t}return br(i)}class Kn extends Error{constructor(t,a){super(a),this.message=a,this.key=t}}class na{constructor(t,a=[]){this.parent=t,this.bindings={};for(const[p,_]of a)this.bindings[p]=_}concat(t){return new na(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Yr={kind:"null"},Ht={kind:"number"},nr={kind:"string"},Ki={kind:"boolean"},Dn={kind:"color"},Jn={kind:"object"},Ni={kind:"value"},ya={kind:"collator"},Oo={kind:"formatted"},Xr={kind:"resolvedImage"};function te(i,t){return{kind:"array",itemType:i,N:t}}function oe(i){if(i.kind==="array"){const t=oe(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const le=[Yr,Ht,nr,Ki,Dn,Oo,Jn,te(Ni),Xr];function ge(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!ge(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const a of le)if(!ge(a,t))return null}}return`Expected ${oe(i)} but found ${oe(t)} instead.`}function Se(i,t){return t.some(a=>a.kind===i.kind)}function Oe(i,t){return t.some(a=>a==="null"?i===null:a==="array"?Array.isArray(i):a==="object"?i&&!Array.isArray(i)&&typeof i=="object":a===typeof i)}var Ve,ye={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Me(i){return(i=Math.round(i))<0?0:i>255?255:i}function Qe(i){return Me(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function ae(i){return(t=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:t>1?1:t;var t}function W(i,t,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?i+(t-i)*a*6:2*a<1?t:3*a<2?i+(t-i)*(2/3-a)*6:i}try{Ve={}.parseCSSColor=function(i){var t,a=i.replace(/ /g,"").toLowerCase();if(a in ye)return ye[a].slice();if(a[0]==="#")return a.length===4?(t=parseInt(a.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:a.length===7&&(t=parseInt(a.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var p=a.indexOf("("),_=a.indexOf(")");if(p!==-1&&_+1===a.length){var b=a.substr(0,p),I=a.substr(p+1,_-(p+1)).split(","),P=1;switch(b){case"rgba":if(I.length!==4)return null;P=ae(I.pop());case"rgb":return I.length!==3?null:[Qe(I[0]),Qe(I[1]),Qe(I[2]),P];case"hsla":if(I.length!==4)return null;P=ae(I.pop());case"hsl":if(I.length!==3)return null;var R=(parseFloat(I[0])%360+360)%360/360,O=ae(I[1]),V=ae(I[2]),j=V<=.5?V*(O+1):V+O-V*O,K=2*V-j;return[Me(255*W(K,j,R+1/3)),Me(255*W(K,j,R)),Me(255*W(K,j,R-1/3)),P];default:return null}}return null}}catch{}class X{constructor(t,a,p,_=1){this.r=t,this.g=a,this.b=p,this.a=_}static parse(t){if(!t)return;if(t instanceof X)return t;if(typeof t!="string")return;const a=Ve(t);return a?new X(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[t,a,p,_]=this.toArray();return`rgba(${Math.round(t)},${Math.round(a)},${Math.round(p)},${_})`}toArray(){const{r:t,g:a,b:p,a:_}=this;return _===0?[0,0,0,0]:[255*t/_,255*a/_,255*p/_,_]}}X.black=new X(0,0,0,1),X.white=new X(1,1,1,1),X.transparent=new X(0,0,0,0),X.red=new X(1,0,0,1);class ne{constructor(t,a,p){this.sensitivity=t?a?"variant":"case":a?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,a){return this.collator.compare(t,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ce{constructor(t,a,p,_,b){this.text=t,this.image=a,this.scale=p,this.fontStack=_,this.textColor=b}}class _e{constructor(t){this.sections=t}static fromString(t){return new _e([new ce(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof _e?t:_e.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const a of this.sections){if(a.image){t.push(["image",a.image.name]);continue}t.push(a.text);const p={};a.fontStack&&(p["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(p["font-scale"]=a.scale),a.textColor&&(p["text-color"]=["rgba"].concat(a.textColor.toArray())),t.push(p)}return t}}class fe{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new fe({name:t,available:!1}):null}serialize(){return["image",this.name]}}function Ee(i,t,a,p){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof a=="number"&&a>=0&&a<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[i,t,a,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[i,t,a,p]:[i,t,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function we(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof X||i instanceof ne||i instanceof _e||i instanceof fe)return!0;if(Array.isArray(i)){for(const t of i)if(!we(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!we(i[t]))return!1;return!0}return!1}function Ie(i){if(i===null)return Yr;if(typeof i=="string")return nr;if(typeof i=="boolean")return Ki;if(typeof i=="number")return Ht;if(i instanceof X)return Dn;if(i instanceof ne)return ya;if(i instanceof _e)return Oo;if(i instanceof fe)return Xr;if(Array.isArray(i)){const t=i.length;let a;for(const p of i){const _=Ie(p);if(a){if(a===_)continue;a=Ni;break}a=_}return te(a||Ni,t)}return Jn}function et(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof X||i instanceof _e||i instanceof fe?i.toString():JSON.stringify(i)}class Ke{constructor(t,a){this.type=t,this.value=a}static parse(t,a){if(t.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!we(t[1]))return a.error("invalid value");const p=t[1];let _=Ie(p);const b=a.expectedType;return _.kind!=="array"||_.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(_=b),new Ke(_,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof X?["rgba"].concat(this.value.toArray()):this.value instanceof _e?this.value.serialize():this.value}}class tt{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Ut={string:nr,number:Ht,boolean:Ki,object:Jn};class At{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let p,_=1;const b=t[0];if(b==="array"){let P,R;if(t.length>2){const O=t[1];if(typeof O!="string"||!(O in Ut)||O==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);P=Ut[O],_++}else P=Ni;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return a.error('The length argument to "array" must be a positive integer literal',2);R=t[2],_++}p=te(P,R)}else p=Ut[b];const I=[];for(;_<t.length;_++){const P=a.parse(t[_],_,Ni);if(!P)return null;I.push(P)}return new At(p,I)}evaluate(t){for(let a=0;a<this.args.length;a++){const p=this.args[a].evaluate(t);if(!ge(this.type,Ie(p)))return p;if(a===this.args.length-1)throw new tt(`Expected value to be of type ${oe(this.type)}, but found ${oe(Ie(p))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,a=[t.kind];if(t.kind==="array"){const p=t.itemType;if(p.kind==="string"||p.kind==="number"||p.kind==="boolean"){a.push(p.kind);const _=t.N;(typeof _=="number"||this.args.length>1)&&a.push(_)}}return a.concat(this.args.map(p=>p.serialize()))}}class Ot{constructor(t){this.type=Oo,this.sections=t}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const p=t[1];if(!Array.isArray(p)&&typeof p=="object")return a.error("First argument must be an image or text section.");const _=[];let b=!1;for(let I=1;I<=t.length-1;++I){const P=t[I];if(b&&typeof P=="object"&&!Array.isArray(P)){b=!1;let R=null;if(P["font-scale"]&&(R=a.parse(P["font-scale"],1,Ht),!R))return null;let O=null;if(P["text-font"]&&(O=a.parse(P["text-font"],1,te(nr)),!O))return null;let V=null;if(P["text-color"]&&(V=a.parse(P["text-color"],1,Dn),!V))return null;const j=_[_.length-1];j.scale=R,j.font=O,j.textColor=V}else{const R=a.parse(t[I],1,Ni);if(!R)return null;const O=R.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,_.push({content:R,scale:null,font:null,textColor:null})}}return new Ot(_)}evaluate(t){return new _e(this.sections.map(a=>{const p=a.content.evaluate(t);return Ie(p)===Xr?new ce("",p,null,null,null):new ce(et(p),null,a.scale?a.scale.evaluate(t):null,a.font?a.font.evaluate(t).join(","):null,a.textColor?a.textColor.evaluate(t):null)}))}eachChild(t){for(const a of this.sections)t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const a of this.sections){t.push(a.content.serialize());const p={};a.scale&&(p["font-scale"]=a.scale.serialize()),a.font&&(p["text-font"]=a.font.serialize()),a.textColor&&(p["text-color"]=a.textColor.serialize()),t.push(p)}return t}}class Vt{constructor(t){this.type=Xr,this.input=t}static parse(t,a){if(t.length!==2)return a.error("Expected two arguments.");const p=a.parse(t[1],1,nr);return p?new Vt(p):a.error("No image name provided.")}evaluate(t){const a=this.input.evaluate(t),p=fe.fromString(a);return p&&t.availableImages&&(p.available=t.availableImages.indexOf(a)>-1),p}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Hi={"to-boolean":Ki,"to-color":Dn,"to-number":Ht,"to-string":nr};class gi{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const p=t[0];if((p==="to-boolean"||p==="to-string")&&t.length!==2)return a.error("Expected one argument.");const _=Hi[p],b=[];for(let I=1;I<t.length;I++){const P=a.parse(t[I],I,Ni);if(!P)return null;b.push(P)}return new gi(_,b)}evaluate(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){let a,p;for(const _ of this.args){if(a=_.evaluate(t),p=null,a instanceof X)return a;if(typeof a=="string"){const b=t.parseColor(a);if(b)return b}else if(Array.isArray(a)&&(p=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Ee(a[0],a[1],a[2],a[3]),!p))return new X(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new tt(p||`Could not parse color from value '${typeof a=="string"?a:String(JSON.stringify(a))}'`)}if(this.type.kind==="number"){let a=null;for(const p of this.args){if(a=p.evaluate(t),a===null)return 0;const _=Number(a);if(!isNaN(_))return _}throw new tt(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?_e.fromString(et(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?fe.fromString(et(this.args[0].evaluate(t))):et(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ot([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Vt(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(a=>{t.push(a.serialize())}),t}}const Ci=["Unknown","Point","LineString","Polygon"];class ci{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ci[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let a=this._parseColorCache[t];return a||(a=this._parseColorCache[t]=X.parse(t)),a}}class Kt{constructor(t,a,p,_){this.name=t,this.type=a,this._evaluate=p,this.args=_}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,a){const p=t[0],_=Kt.definitions[p];if(!_)return a.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(_)?_[0]:_.type,I=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,P=I.filter(([O])=>!Array.isArray(O)||O.length===t.length-1);let R=null;for(const[O,V]of P){R=new Oa(a.registry,a.path,null,a.scope);const j=[];let K=!1;for(let Y=1;Y<t.length;Y++){const Q=t[Y],se=Array.isArray(O)?O[Y-1]:O.type,pe=R.parse(Q,1+j.length,se);if(!pe){K=!0;break}j.push(pe)}if(!K)if(Array.isArray(O)&&O.length!==j.length)R.error(`Expected ${O.length} arguments, but found ${j.length} instead.`);else{for(let Y=0;Y<j.length;Y++){const Q=Array.isArray(O)?O[Y]:O.type,se=j[Y];R.concat(Y+1).checkSubtype(Q,se.type)}if(R.errors.length===0)return new Kt(p,b,V,j)}}if(P.length===1)a.errors.push(...R.errors);else{const O=(P.length?P:I).map(([j])=>{return K=j,Array.isArray(K)?`(${K.map(oe).join(", ")})`:`(${oe(K.type)}...)`;var K}).join(" | "),V=[];for(let j=1;j<t.length;j++){const K=a.parse(t[j],1+V.length);if(!K)return null;V.push(oe(K.type))}a.error(`Expected arguments of type ${O}, but found (${V.join(", ")}) instead.`)}return null}static register(t,a){Kt.definitions=a;for(const p in a)t[p]=Kt}}class Di{constructor(t,a,p){this.type=ya,this.locale=p,this.caseSensitive=t,this.diacriticSensitive=a}static parse(t,a){if(t.length!==2)return a.error("Expected one argument.");const p=t[1];if(typeof p!="object"||Array.isArray(p))return a.error("Collator options argument must be an object.");const _=a.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Ki);if(!_)return null;const b=a.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Ki);if(!b)return null;let I=null;return p.locale&&(I=a.parse(p.locale,1,nr),!I)?null:new Di(_,b,I)}evaluate(t){return new ne(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const Ir=8192;function kn(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function Cr(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function Eo(i,t){const a=(180+i[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,_=Math.pow(2,t.z);return[Math.round(a*_*Ir),Math.round(p*_*Ir)]}function Ol(i,t,a){const p=i[0]-t[0],_=i[1]-t[1],b=i[0]-a[0],I=i[1]-a[1];return p*I-b*_==0&&p*b<=0&&_*I<=0}function qr(i,t){let a=!1;for(let I=0,P=t.length;I<P;I++){const R=t[I];for(let O=0,V=R.length;O<V-1;O++){if(Ol(i,R[O],R[O+1]))return!1;(_=R[O])[1]>(p=i)[1]!=(b=R[O+1])[1]>p[1]&&p[0]<(b[0]-_[0])*(p[1]-_[1])/(b[1]-_[1])+_[0]&&(a=!a)}}var p,_,b;return a}function In(i,t){for(let a=0;a<t.length;a++)if(qr(i,t[a]))return!0;return!1}function qs(i,t,a,p){const _=p[0]-a[0],b=p[1]-a[1],I=(i[0]-a[0])*b-_*(i[1]-a[1]),P=(t[0]-a[0])*b-_*(t[1]-a[1]);return I>0&&P<0||I<0&&P>0}function Co(i,t,a){for(const O of a)for(let V=0;V<O.length-1;++V)if((P=[(I=O[V+1])[0]-(b=O[V])[0],I[1]-b[1]])[0]*(R=[(_=t)[0]-(p=i)[0],_[1]-p[1]])[1]-P[1]*R[0]!=0&&qs(p,_,b,I)&&qs(b,I,p,_))return!0;var p,_,b,I,P,R;return!1}function Rn(i,t){for(let a=0;a<i.length;++a)if(!qr(i[a],t))return!1;for(let a=0;a<i.length-1;++a)if(Co(i[a],i[a+1],t))return!1;return!0}function oa(i,t){for(let a=0;a<t.length;a++)if(Rn(i,t[a]))return!0;return!1}function Qr(i,t,a){const p=[];for(let _=0;_<i.length;_++){const b=[];for(let I=0;I<i[_].length;I++){const P=Eo(i[_][I],a);kn(t,P),b.push(P)}p.push(b)}return p}function aa(i,t,a){const p=[];for(let _=0;_<i.length;_++){const b=Qr(i[_],t,a);p.push(b)}return p}function Fo(i,t,a,p){if(i[0]<a[0]||i[0]>a[2]){const _=.5*p;let b=i[0]-a[0]>_?-p:a[0]-i[0]>_?p:0;b===0&&(b=i[0]-a[2]>_?-p:a[2]-i[0]>_?p:0),i[0]+=b}kn(t,i)}function Qu(i,t,a,p){const _=Math.pow(2,p.z)*Ir,b=[p.x*Ir,p.y*Ir],I=[];for(const P of i)for(const R of P){const O=[R.x+b[0],R.y+b[1]];Fo(O,t,a,_),I.push(O)}return I}function sa(i,t,a,p){const _=Math.pow(2,p.z)*Ir,b=[p.x*Ir,p.y*Ir],I=[];for(const R of i){const O=[];for(const V of R){const j=[V.x+b[0],V.y+b[1]];kn(t,j),O.push(j)}I.push(O)}if(t[2]-t[0]<=_/2){(P=t)[0]=P[1]=1/0,P[2]=P[3]=-1/0;for(const R of I)for(const O of R)Fo(O,t,a,_)}var P;return I}class Gs{constructor(t,a){this.type=Ki,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(we(t[1])){const p=t[1];if(p.type==="FeatureCollection")for(let _=0;_<p.features.length;++_){const b=p.features[_].geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new Gs(p,p.features[_].geometry)}else if(p.type==="Feature"){const _=p.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Gs(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Gs(p,p)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,p){const _=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],I=a.canonicalID();if(p.type==="Polygon"){const P=Qr(p.coordinates,b,I),R=Qu(a.geometry(),_,b,I);if(!Cr(_,b))return!1;for(const O of R)if(!qr(O,P))return!1}if(p.type==="MultiPolygon"){const P=aa(p.coordinates,b,I),R=Qu(a.geometry(),_,b,I);if(!Cr(_,b))return!1;for(const O of R)if(!In(O,P))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,p){const _=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],I=a.canonicalID();if(p.type==="Polygon"){const P=Qr(p.coordinates,b,I),R=sa(a.geometry(),_,b,I);if(!Cr(_,b))return!1;for(const O of R)if(!Rn(O,P))return!1}if(p.type==="MultiPolygon"){const P=aa(p.coordinates,b,I),R=sa(a.geometry(),_,b,I);if(!Cr(_,b))return!1;for(const O of R)if(!oa(O,P))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function ga(i){if(i instanceof Kt&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Gs)return!1;let t=!0;return i.eachChild(a=>{t&&!ga(a)&&(t=!1)}),t}function Sn(i){if(i instanceof Kt&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(a=>{t&&!Sn(a)&&(t=!1)}),t}function Zo(i,t){if(i instanceof Kt&&t.indexOf(i.name)>=0)return!1;let a=!0;return i.eachChild(p=>{a&&!Zo(p,t)&&(a=!1)}),a}class $n{constructor(t,a){this.type=a.type,this.name=t,this.boundExpression=a}static parse(t,a){if(t.length!==2||typeof t[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const p=t[1];return a.scope.has(p)?new $n(p,a.scope.get(p)):a.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Oa{constructor(t,a=[],p,_=new na,b=[]){this.registry=t,this.path=a,this.key=a.map(I=>`[${I}]`).join(""),this.scope=_,this.errors=b,this.expectedType=p}parse(t,a,p,_,b={}){return a?this.concat(a,p,_)._parse(t,b):this._parse(t,b)}_parse(t,a){function p(_,b,I){return I==="assert"?new At(b,[_]):I==="coerce"?new gi(b,[_]):_}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=t[0];if(typeof _!="string")return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[_];if(b){let I=b.parse(t,this);if(!I)return null;if(this.expectedType){const P=this.expectedType,R=I.type;if(P.kind!=="string"&&P.kind!=="number"&&P.kind!=="boolean"&&P.kind!=="object"&&P.kind!=="array"||R.kind!=="value")if(P.kind!=="color"&&P.kind!=="formatted"&&P.kind!=="resolvedImage"||R.kind!=="value"&&R.kind!=="string"){if(this.checkSubtype(P,R))return null}else I=p(I,P,a.typeAnnotation||"coerce");else I=p(I,P,a.typeAnnotation||"assert")}if(!(I instanceof Ke)&&I.type.kind!=="resolvedImage"&&Fl(I)){const P=new ci;try{I=new Ke(I.type,I.evaluate(P))}catch(R){return this.error(R.message),null}}return I}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,a,p){const _=typeof t=="number"?this.path.concat(t):this.path,b=p?this.scope.concat(p):this.scope;return new Oa(this.registry,_,a||null,b,this.errors)}error(t,...a){const p=`${this.key}${a.map(_=>`[${_}]`).join("")}`;this.errors.push(new Kn(p,t))}checkSubtype(t,a){const p=ge(t,a);return p&&this.error(p),p}}function Fl(i){if(i instanceof $n)return Fl(i.boundExpression);if(i instanceof Kt&&i.name==="error"||i instanceof Di||i instanceof Gs)return!1;const t=i instanceof gi||i instanceof At;let a=!0;return i.eachChild(p=>{a=t?a&&Fl(p):a&&p instanceof Ke}),!!a&&ga(i)&&Zo(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function wu(i,t){const a=i.length-1;let p,_,b=0,I=a,P=0;for(;b<=I;)if(P=Math.floor((b+I)/2),p=i[P],_=i[P+1],p<=t){if(P===a||t<_)return P;b=P+1}else{if(!(p>t))throw new tt("Input is not a number.");I=P-1}return 0}class Zs{constructor(t,a,p){this.type=t,this.input=a,this.labels=[],this.outputs=[];for(const[_,b]of p)this.labels.push(_),this.outputs.push(b)}static parse(t,a){if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");const p=a.parse(t[1],1,Ht);if(!p)return null;const _=[];let b=null;a.expectedType&&a.expectedType.kind!=="value"&&(b=a.expectedType);for(let I=1;I<t.length;I+=2){const P=I===1?-1/0:t[I],R=t[I+1],O=I,V=I+1;if(typeof P!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(_.length&&_[_.length-1][0]>=P)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const j=a.parse(R,V,b);if(!j)return null;b=b||j.type,_.push([P,j])}return new Zs(b,p,_)}evaluate(t){const a=this.labels,p=this.outputs;if(a.length===1)return p[0].evaluate(t);const _=this.input.evaluate(t);if(_<=a[0])return p[0].evaluate(t);const b=a.length;return _>=a[b-1]?p[b-1].evaluate(t):p[wu(a,_)].evaluate(t)}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&t.push(this.labels[a]),t.push(this.outputs[a].serialize());return t}}function Nn(i,t,a){return i*(1-a)+t*a}var ml=Object.freeze({__proto__:null,number:Nn,color:function(i,t,a){return new X(Nn(i.r,t.r,a),Nn(i.g,t.g,a),Nn(i.b,t.b,a),Nn(i.a,t.a,a))},array:function(i,t,a){return i.map((p,_)=>Nn(p,t[_],a))}});const ec=.95047,tc=1.08883,ic=4/29,ts=6/29,Ul=3*ts*ts,Nl=Math.PI/180,Bc=180/Math.PI;function yl(i){return i>.008856451679035631?Math.pow(i,1/3):i/Ul+ic}function Ho(i){return i>ts?i*i*i:Ul*(i-ic)}function Fa(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function Ua(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function ws(i){const t=Ua(i.r),a=Ua(i.g),p=Ua(i.b),_=yl((.4124564*t+.3575761*a+.1804375*p)/ec),b=yl((.2126729*t+.7151522*a+.072175*p)/1);return{l:116*b-16,a:500*(_-b),b:200*(b-yl((.0193339*t+.119192*a+.9503041*p)/tc)),alpha:i.a}}function cr(i){let t=(i.l+16)/116,a=isNaN(i.a)?t:t+i.a/500,p=isNaN(i.b)?t:t-i.b/200;return t=1*Ho(t),a=ec*Ho(a),p=tc*Ho(p),new X(Fa(3.2404542*a-1.5371385*t-.4985314*p),Fa(-.969266*a+1.8760108*t+.041556*p),Fa(.0556434*a-.2040259*t+1.0572252*p),i.alpha)}function Es(i,t,a){const p=t-i;return i+a*(p>180||p<-180?p-360*Math.round(p/360):p)}const Is={forward:ws,reverse:cr,interpolate:function(i,t,a){return{l:Nn(i.l,t.l,a),a:Nn(i.a,t.a,a),b:Nn(i.b,t.b,a),alpha:Nn(i.alpha,t.alpha,a)}}},po={forward:function(i){const{l:t,a,b:p}=ws(i),_=Math.atan2(p,a)*Bc;return{h:_<0?_+360:_,c:Math.sqrt(a*a+p*p),l:t,alpha:i.a}},reverse:function(i){const t=i.h*Nl,a=i.c;return cr({l:i.l,a:Math.cos(t)*a,b:Math.sin(t)*a,alpha:i.alpha})},interpolate:function(i,t,a){return{h:Es(i.h,t.h,a),c:Nn(i.c,t.c,a),l:Nn(i.l,t.l,a),alpha:Nn(i.alpha,t.alpha,a)}}};var Tn=Object.freeze({__proto__:null,lab:Is,hcl:po});class fo{constructor(t,a,p,_,b){this.type=t,this.operator=a,this.interpolation=p,this.input=_,this.labels=[],this.outputs=[];for(const[I,P]of b)this.labels.push(I),this.outputs.push(P)}static interpolationFactor(t,a,p,_){let b=0;if(t.name==="exponential")b=Eu(a,t.base,p,_);else if(t.name==="linear")b=Eu(a,1,p,_);else if(t.name==="cubic-bezier"){const I=t.controlPoints;b=new D(I[0],I[1],I[2],I[3]).solve(Eu(a,1,p,_))}return b}static parse(t,a){let[p,_,b,...I]=t;if(!Array.isArray(_)||_.length===0)return a.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const O=_[1];if(typeof O!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:O}}else{if(_[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const O=_.slice(1);if(O.length!==4||O.some(V=>typeof V!="number"||V<0||V>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:O}}}if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(b=a.parse(b,2,Ht),!b)return null;const P=[];let R=null;p==="interpolate-hcl"||p==="interpolate-lab"?R=Dn:a.expectedType&&a.expectedType.kind!=="value"&&(R=a.expectedType);for(let O=0;O<I.length;O+=2){const V=I[O],j=I[O+1],K=O+3,Y=O+4;if(typeof V!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',K);if(P.length&&P[P.length-1][0]>=V)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',K);const Q=a.parse(j,Y,R);if(!Q)return null;R=R||Q.type,P.push([V,Q])}return R.kind==="number"||R.kind==="color"||R.kind==="array"&&R.itemType.kind==="number"&&typeof R.N=="number"?new fo(R,p,_,b,P):a.error(`Type ${oe(R)} is not interpolatable.`)}evaluate(t){const a=this.labels,p=this.outputs;if(a.length===1)return p[0].evaluate(t);const _=this.input.evaluate(t);if(_<=a[0])return p[0].evaluate(t);const b=a.length;if(_>=a[b-1])return p[b-1].evaluate(t);const I=wu(a,_),P=fo.interpolationFactor(this.interpolation,_,a[I],a[I+1]),R=p[I].evaluate(t),O=p[I+1].evaluate(t);return this.operator==="interpolate"?ml[this.type.kind.toLowerCase()](R,O,P):this.operator==="interpolate-hcl"?po.reverse(po.interpolate(po.forward(R),po.forward(O),P)):Is.reverse(Is.interpolate(Is.forward(R),Is.forward(O),P))}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,t,this.input.serialize()];for(let p=0;p<this.labels.length;p++)a.push(this.labels[p],this.outputs[p].serialize());return a}}function Eu(i,t,a,p){const _=p-a,b=i-a;return _===0?0:t===1?b/_:(Math.pow(t,b)-1)/(Math.pow(t,_)-1)}class Iu{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expectected at least one argument.");let p=null;const _=a.expectedType;_&&_.kind!=="value"&&(p=_);const b=[];for(const P of t.slice(1)){const R=a.parse(P,1+b.length,p,void 0,{typeAnnotation:"omit"});if(!R)return null;p=p||R.type,b.push(R)}const I=_&&b.some(P=>ge(_,P.type));return new Iu(I?Ni:p,b)}evaluate(t){let a,p=null,_=0;for(const b of this.args)if(_++,p=b.evaluate(t),p&&p instanceof fe&&!p.available&&(a||(a=p.name),p=null,_===this.args.length&&(p=a)),p!==null)break;return p}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(a=>{t.push(a.serialize())}),t}}class Su{constructor(t,a){this.type=a.type,this.bindings=[].concat(t),this.result=a}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const a of this.bindings)t(a[1]);t(this.result)}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const p=[];for(let b=1;b<t.length-1;b+=2){const I=t[b];if(typeof I!="string")return a.error(`Expected string, but found ${typeof I} instead.`,b);if(/[^a-zA-Z0-9_]/.test(I))return a.error("Variable names must contain only alphanumeric characters or '_'.",b);const P=a.parse(t[b+1],b+1);if(!P)return null;p.push([I,P])}const _=a.parse(t[t.length-1],t.length-1,a.expectedType,p);return _?new Su(p,_):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[a,p]of this.bindings)t.push(a,p.serialize());return t.push(this.result.serialize()),t}}class jl{constructor(t,a,p){this.type=t,this.index=a,this.input=p}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const p=a.parse(t[1],1,Ht),_=a.parse(t[2],2,te(a.expectedType||Ni));return p&&_?new jl(_.type.itemType,p,_):null}evaluate(t){const a=this.index.evaluate(t),p=this.input.evaluate(t);if(a<0)throw new tt(`Array index out of bounds: ${a} < 0.`);if(a>=p.length)throw new tt(`Array index out of bounds: ${a} > ${p.length-1}.`);if(a!==Math.floor(a))throw new tt(`Array index must be an integer, but found ${a} instead.`);return p[a]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Vl{constructor(t,a){this.type=Ki,this.needle=t,this.haystack=a}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const p=a.parse(t[1],1,Ni),_=a.parse(t[2],2,Ni);return p&&_?Se(p.type,[Ki,nr,Ht,Yr,Ni])?new Vl(p,_):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${oe(p.type)} instead`):null}evaluate(t){const a=this.needle.evaluate(t),p=this.haystack.evaluate(t);if(!p)return!1;if(!Oe(a,["boolean","string","number","null"]))throw new tt(`Expected first argument to be of type boolean, string, number or null, but found ${oe(Ie(a))} instead.`);if(!Oe(p,["string","array"]))throw new tt(`Expected second argument to be of type array or string, but found ${oe(Ie(p))} instead.`);return p.indexOf(a)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class gl{constructor(t,a,p){this.type=Ht,this.needle=t,this.haystack=a,this.fromIndex=p}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const p=a.parse(t[1],1,Ni),_=a.parse(t[2],2,Ni);if(!p||!_)return null;if(!Se(p.type,[Ki,nr,Ht,Yr,Ni]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${oe(p.type)} instead`);if(t.length===4){const b=a.parse(t[3],3,Ht);return b?new gl(p,_,b):null}return new gl(p,_)}evaluate(t){const a=this.needle.evaluate(t),p=this.haystack.evaluate(t);if(!Oe(a,["boolean","string","number","null"]))throw new tt(`Expected first argument to be of type boolean, string, number or null, but found ${oe(Ie(a))} instead.`);if(!Oe(p,["string","array"]))throw new tt(`Expected second argument to be of type array or string, but found ${oe(Ie(p))} instead.`);if(this.fromIndex){const _=this.fromIndex.evaluate(t);return p.indexOf(a,_)}return p.indexOf(a)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class ql{constructor(t,a,p,_,b,I){this.inputType=t,this.type=a,this.input=p,this.cases=_,this.outputs=b,this.otherwise=I}static parse(t,a){if(t.length<5)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return a.error("Expected an even number of arguments.");let p,_;a.expectedType&&a.expectedType.kind!=="value"&&(_=a.expectedType);const b={},I=[];for(let O=2;O<t.length-1;O+=2){let V=t[O];const j=t[O+1];Array.isArray(V)||(V=[V]);const K=a.concat(O);if(V.length===0)return K.error("Expected at least one branch label.");for(const Q of V){if(typeof Q!="number"&&typeof Q!="string")return K.error("Branch labels must be numbers or strings.");if(typeof Q=="number"&&Math.abs(Q)>Number.MAX_SAFE_INTEGER)return K.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Q=="number"&&Math.floor(Q)!==Q)return K.error("Numeric branch labels must be integer values.");if(p){if(K.checkSubtype(p,Ie(Q)))return null}else p=Ie(Q);if(b[String(Q)]!==void 0)return K.error("Branch labels must be unique.");b[String(Q)]=I.length}const Y=a.parse(j,O,_);if(!Y)return null;_=_||Y.type,I.push(Y)}const P=a.parse(t[1],1,Ni);if(!P)return null;const R=a.parse(t[t.length-1],t.length-1,_);return R?P.type.kind!=="value"&&a.concat(1).checkSubtype(p,P.type)?null:new ql(p,_,P,b,I,R):null}evaluate(t){const a=this.input.evaluate(t);return(Ie(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),p=[],_={};for(const I of a){const P=_[this.cases[I]];P===void 0?(_[this.cases[I]]=p.length,p.push([this.cases[I],[I]])):p[P][1].push(I)}const b=I=>this.inputType.kind==="number"?Number(I):I;for(const[I,P]of p)t.push(P.length===1?b(P[0]):P.map(b)),t.push(this.outputs[I].serialize());return t.push(this.otherwise.serialize()),t}}class Tu{constructor(t,a,p){this.type=t,this.branches=a,this.otherwise=p}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return a.error("Expected an odd number of arguments.");let p;a.expectedType&&a.expectedType.kind!=="value"&&(p=a.expectedType);const _=[];for(let I=1;I<t.length-1;I+=2){const P=a.parse(t[I],I,Ki);if(!P)return null;const R=a.parse(t[I+1],I+1,p);if(!R)return null;_.push([P,R]),p=p||R.type}const b=a.parse(t[t.length-1],t.length-1,p);return b?new Tu(p,_,b):null}evaluate(t){for(const[a,p]of this.branches)if(a.evaluate(t))return p.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[a,p]of this.branches)t(a),t(p);t(this.otherwise)}outputDefined(){return this.branches.every(([t,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(a=>{t.push(a.serialize())}),t}}class Gl{constructor(t,a,p,_){this.type=t,this.input=a,this.beginIndex=p,this.endIndex=_}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const p=a.parse(t[1],1,Ni),_=a.parse(t[2],2,Ht);if(!p||!_)return null;if(!Se(p.type,[te(Ni),nr,Ni]))return a.error(`Expected first argument to be of type array or string, but found ${oe(p.type)} instead`);if(t.length===4){const b=a.parse(t[3],3,Ht);return b?new Gl(p.type,p,_,b):null}return new Gl(p.type,p,_)}evaluate(t){const a=this.input.evaluate(t),p=this.beginIndex.evaluate(t);if(!Oe(a,["string","array"]))throw new tt(`Expected first argument to be of type array or string, but found ${oe(Ie(a))} instead.`);if(this.endIndex){const _=this.endIndex.evaluate(t);return a.slice(p,_)}return a.slice(p)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Oc(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function _l(i,t,a,p){return p.compare(t,a)===0}function Na(i,t,a){const p=i!=="=="&&i!=="!=";return class Zv{constructor(b,I,P){this.type=Ki,this.lhs=b,this.rhs=I,this.collator=P,this.hasUntypedArgument=b.type.kind==="value"||I.type.kind==="value"}static parse(b,I){if(b.length!==3&&b.length!==4)return I.error("Expected two or three arguments.");const P=b[0];let R=I.parse(b[1],1,Ni);if(!R)return null;if(!Oc(P,R.type))return I.concat(1).error(`"${P}" comparisons are not supported for type '${oe(R.type)}'.`);let O=I.parse(b[2],2,Ni);if(!O)return null;if(!Oc(P,O.type))return I.concat(2).error(`"${P}" comparisons are not supported for type '${oe(O.type)}'.`);if(R.type.kind!==O.type.kind&&R.type.kind!=="value"&&O.type.kind!=="value")return I.error(`Cannot compare types '${oe(R.type)}' and '${oe(O.type)}'.`);p&&(R.type.kind==="value"&&O.type.kind!=="value"?R=new At(O.type,[R]):R.type.kind!=="value"&&O.type.kind==="value"&&(O=new At(R.type,[O])));let V=null;if(b.length===4){if(R.type.kind!=="string"&&O.type.kind!=="string"&&R.type.kind!=="value"&&O.type.kind!=="value")return I.error("Cannot use collator to compare non-string types.");if(V=I.parse(b[3],3,ya),!V)return null}return new Zv(R,O,V)}evaluate(b){const I=this.lhs.evaluate(b),P=this.rhs.evaluate(b);if(p&&this.hasUntypedArgument){const R=Ie(I),O=Ie(P);if(R.kind!==O.kind||R.kind!=="string"&&R.kind!=="number")throw new tt(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${R.kind}, ${O.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const R=Ie(I),O=Ie(P);if(R.kind!=="string"||O.kind!=="string")return t(b,I,P)}return this.collator?a(b,I,P,this.collator.evaluate(b)):t(b,I,P)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}serialize(){const b=[i];return this.eachChild(I=>{b.push(I.serialize())}),b}}}const Fc=Na("==",function(i,t,a){return t===a},_l),mo=Na("!=",function(i,t,a){return t!==a},function(i,t,a,p){return!_l(0,t,a,p)}),rc=Na("<",function(i,t,a){return t<a},function(i,t,a,p){return p.compare(t,a)<0}),Ss=Na(">",function(i,t,a){return t>a},function(i,t,a,p){return p.compare(t,a)>0}),Ts=Na("<=",function(i,t,a){return t<=a},function(i,t,a,p){return p.compare(t,a)<=0}),Hs=Na(">=",function(i,t,a){return t>=a},function(i,t,a,p){return p.compare(t,a)>=0});class is{constructor(t,a,p,_,b){this.type=nr,this.number=t,this.locale=a,this.currency=p,this.minFractionDigits=_,this.maxFractionDigits=b}static parse(t,a){if(t.length!==3)return a.error("Expected two arguments.");const p=a.parse(t[1],1,Ht);if(!p)return null;const _=t[2];if(typeof _!="object"||Array.isArray(_))return a.error("NumberFormat options argument must be an object.");let b=null;if(_.locale&&(b=a.parse(_.locale,1,nr),!b))return null;let I=null;if(_.currency&&(I=a.parse(_.currency,1,nr),!I))return null;let P=null;if(_["min-fraction-digits"]&&(P=a.parse(_["min-fraction-digits"],1,Ht),!P))return null;let R=null;return _["max-fraction-digits"]&&(R=a.parse(_["max-fraction-digits"],1,Ht),!R)?null:new is(p,b,I,P,R)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class ja{constructor(t){this.type=Ht,this.input=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const p=a.parse(t[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${oe(p.type)} instead.`):new ja(p):null}evaluate(t){const a=this.input.evaluate(t);if(typeof a=="string"||Array.isArray(a))return a.length;throw new tt(`Expected value to be of type string or array, but found ${oe(Ie(a))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(a=>{t.push(a.serialize())}),t}}const _a={"==":Fc,"!=":mo,">":Ss,"<":rc,">=":Hs,"<=":Ts,array:At,at:jl,boolean:At,case:Tu,coalesce:Iu,collator:Di,format:Ot,image:Vt,in:Vl,"index-of":gl,interpolate:fo,"interpolate-hcl":fo,"interpolate-lab":fo,length:ja,let:Su,literal:Ke,match:ql,number:At,"number-format":is,object:At,slice:Gl,step:Zs,string:At,"to-boolean":gi,"to-color":gi,"to-number":gi,"to-string":gi,var:$n,within:Gs};function As(i,[t,a,p,_]){t=t.evaluate(i),a=a.evaluate(i),p=p.evaluate(i);const b=_?_.evaluate(i):1,I=Ee(t,a,p,b);if(I)throw new tt(I);return new X(t/255*b,a/255*b,p/255*b,b)}function rs(i,t){return i in t}function Au(i,t){const a=t[i];return a===void 0?null:a}function Cs(i){return{type:i}}function Gr(i){return{result:"success",value:i}}function Ws(i){return{result:"error",value:i}}function ns(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function nc(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Cu(i){return!!i.expression&&i.expression.interpolated}function Ji(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Zl(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function wr(i){return i}function Ta(i,t){const a=t.type==="color",p=i.stops&&typeof i.stops[0][0]=="object",_=p||!(p||i.property!==void 0),b=i.type||(Cu(t)?"exponential":"interval");if(a&&((i=yr({},i)).stops&&(i.stops=i.stops.map(O=>[O[0],X.parse(O[1])])),i.default=X.parse(i.default?i.default:t.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!Tn[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let I,P,R;if(b==="exponential")I=Wl;else if(b==="interval")I=Hl;else if(b==="categorical"){I=An,P=Object.create(null);for(const O of i.stops)P[O[0]]=O[1];R=typeof i.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);I=Xs}if(p){const O={},V=[];for(let Y=0;Y<i.stops.length;Y++){const Q=i.stops[Y],se=Q[0].zoom;O[se]===void 0&&(O[se]={zoom:se,type:i.type,property:i.property,default:i.default,stops:[]},V.push(se)),O[se].stops.push([Q[0].value,Q[1]])}const j=[];for(const Y of V)j.push([O[Y].zoom,Ta(O[Y],t)]);const K={name:"linear"};return{kind:"composite",interpolationType:K,interpolationFactor:fo.interpolationFactor.bind(void 0,K),zoomStops:j.map(Y=>Y[0]),evaluate:({zoom:Y},Q)=>Wl({stops:j,base:i.base},t,Y).evaluate(Y,Q)}}if(_){const O=b==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:fo.interpolationFactor.bind(void 0,O),zoomStops:i.stops.map(V=>V[0]),evaluate:({zoom:V})=>I(i,t,V,P,R)}}return{kind:"source",evaluate(O,V){const j=V&&V.properties?V.properties[i.property]:void 0;return j===void 0?Kr(i.default,t.default):I(i,t,j,P,R)}}}function Kr(i,t,a){return i!==void 0?i:t!==void 0?t:a!==void 0?a:void 0}function An(i,t,a,p,_){return Kr(typeof a===_?p[a]:void 0,i.default,t.default)}function Hl(i,t,a){if(Ji(a)!=="number")return Kr(i.default,t.default);const p=i.stops.length;if(p===1||a<=i.stops[0][0])return i.stops[0][1];if(a>=i.stops[p-1][0])return i.stops[p-1][1];const _=wu(i.stops.map(b=>b[0]),a);return i.stops[_][1]}function Wl(i,t,a){const p=i.base!==void 0?i.base:1;if(Ji(a)!=="number")return Kr(i.default,t.default);const _=i.stops.length;if(_===1||a<=i.stops[0][0])return i.stops[0][1];if(a>=i.stops[_-1][0])return i.stops[_-1][1];const b=wu(i.stops.map(V=>V[0]),a),I=function(V,j,K,Y){const Q=Y-K,se=V-K;return Q===0?0:j===1?se/Q:(Math.pow(j,se)-1)/(Math.pow(j,Q)-1)}(a,p,i.stops[b][0],i.stops[b+1][0]),P=i.stops[b][1],R=i.stops[b+1][1];let O=ml[t.type]||wr;if(i.colorSpace&&i.colorSpace!=="rgb"){const V=Tn[i.colorSpace];O=(j,K)=>V.reverse(V.interpolate(V.forward(j),V.forward(K),I))}return typeof P.evaluate=="function"?{evaluate(...V){const j=P.evaluate.apply(void 0,V),K=R.evaluate.apply(void 0,V);if(j!==void 0&&K!==void 0)return O(j,K,I)}}:O(P,R,I)}function Xs(i,t,a){return t.type==="color"?a=X.parse(a):t.type==="formatted"?a=_e.fromString(a.toString()):t.type==="resolvedImage"?a=fe.fromString(a.toString()):Ji(a)===t.type||t.type==="enum"&&t.values[a]||(a=void 0),Kr(a,i.default,t.default)}Kt.register(_a,{error:[{kind:"error"},[nr],(i,[t])=>{throw new tt(t.evaluate(i))}],typeof:[nr,[Ni],(i,[t])=>oe(Ie(t.evaluate(i)))],"to-rgba":[te(Ht,4),[Dn],(i,[t])=>t.evaluate(i).toArray()],rgb:[Dn,[Ht,Ht,Ht],As],rgba:[Dn,[Ht,Ht,Ht,Ht],As],has:{type:Ki,overloads:[[[nr],(i,[t])=>rs(t.evaluate(i),i.properties())],[[nr,Jn],(i,[t,a])=>rs(t.evaluate(i),a.evaluate(i))]]},get:{type:Ni,overloads:[[[nr],(i,[t])=>Au(t.evaluate(i),i.properties())],[[nr,Jn],(i,[t,a])=>Au(t.evaluate(i),a.evaluate(i))]]},"feature-state":[Ni,[nr],(i,[t])=>Au(t.evaluate(i),i.featureState||{})],properties:[Jn,[],i=>i.properties()],"geometry-type":[nr,[],i=>i.geometryType()],id:[Ni,[],i=>i.id()],zoom:[Ht,[],i=>i.globals.zoom],"heatmap-density":[Ht,[],i=>i.globals.heatmapDensity||0],"line-progress":[Ht,[],i=>i.globals.lineProgress||0],accumulated:[Ni,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Ht,Cs(Ht),(i,t)=>{let a=0;for(const p of t)a+=p.evaluate(i);return a}],"*":[Ht,Cs(Ht),(i,t)=>{let a=1;for(const p of t)a*=p.evaluate(i);return a}],"-":{type:Ht,overloads:[[[Ht,Ht],(i,[t,a])=>t.evaluate(i)-a.evaluate(i)],[[Ht],(i,[t])=>-t.evaluate(i)]]},"/":[Ht,[Ht,Ht],(i,[t,a])=>t.evaluate(i)/a.evaluate(i)],"%":[Ht,[Ht,Ht],(i,[t,a])=>t.evaluate(i)%a.evaluate(i)],ln2:[Ht,[],()=>Math.LN2],pi:[Ht,[],()=>Math.PI],e:[Ht,[],()=>Math.E],"^":[Ht,[Ht,Ht],(i,[t,a])=>Math.pow(t.evaluate(i),a.evaluate(i))],sqrt:[Ht,[Ht],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[Ht,[Ht],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[Ht,[Ht],(i,[t])=>Math.log(t.evaluate(i))],log2:[Ht,[Ht],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[Ht,[Ht],(i,[t])=>Math.sin(t.evaluate(i))],cos:[Ht,[Ht],(i,[t])=>Math.cos(t.evaluate(i))],tan:[Ht,[Ht],(i,[t])=>Math.tan(t.evaluate(i))],asin:[Ht,[Ht],(i,[t])=>Math.asin(t.evaluate(i))],acos:[Ht,[Ht],(i,[t])=>Math.acos(t.evaluate(i))],atan:[Ht,[Ht],(i,[t])=>Math.atan(t.evaluate(i))],min:[Ht,Cs(Ht),(i,t)=>Math.min(...t.map(a=>a.evaluate(i)))],max:[Ht,Cs(Ht),(i,t)=>Math.max(...t.map(a=>a.evaluate(i)))],abs:[Ht,[Ht],(i,[t])=>Math.abs(t.evaluate(i))],round:[Ht,[Ht],(i,[t])=>{const a=t.evaluate(i);return a<0?-Math.round(-a):Math.round(a)}],floor:[Ht,[Ht],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[Ht,[Ht],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[Ki,[nr,Ni],(i,[t,a])=>i.properties()[t.value]===a.value],"filter-id-==":[Ki,[Ni],(i,[t])=>i.id()===t.value],"filter-type-==":[Ki,[nr],(i,[t])=>i.geometryType()===t.value],"filter-<":[Ki,[nr,Ni],(i,[t,a])=>{const p=i.properties()[t.value],_=a.value;return typeof p==typeof _&&p<_}],"filter-id-<":[Ki,[Ni],(i,[t])=>{const a=i.id(),p=t.value;return typeof a==typeof p&&a<p}],"filter->":[Ki,[nr,Ni],(i,[t,a])=>{const p=i.properties()[t.value],_=a.value;return typeof p==typeof _&&p>_}],"filter-id->":[Ki,[Ni],(i,[t])=>{const a=i.id(),p=t.value;return typeof a==typeof p&&a>p}],"filter-<=":[Ki,[nr,Ni],(i,[t,a])=>{const p=i.properties()[t.value],_=a.value;return typeof p==typeof _&&p<=_}],"filter-id-<=":[Ki,[Ni],(i,[t])=>{const a=i.id(),p=t.value;return typeof a==typeof p&&a<=p}],"filter->=":[Ki,[nr,Ni],(i,[t,a])=>{const p=i.properties()[t.value],_=a.value;return typeof p==typeof _&&p>=_}],"filter-id->=":[Ki,[Ni],(i,[t])=>{const a=i.id(),p=t.value;return typeof a==typeof p&&a>=p}],"filter-has":[Ki,[Ni],(i,[t])=>t.value in i.properties()],"filter-has-id":[Ki,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Ki,[te(nr)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[Ki,[te(Ni)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[Ki,[nr,te(Ni)],(i,[t,a])=>a.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[Ki,[nr,te(Ni)],(i,[t,a])=>function(p,_,b,I){for(;b<=I;){const P=b+I>>1;if(_[P]===p)return!0;_[P]>p?I=P-1:b=P+1}return!1}(i.properties()[t.value],a.value,0,a.value.length-1)],all:{type:Ki,overloads:[[[Ki,Ki],(i,[t,a])=>t.evaluate(i)&&a.evaluate(i)],[Cs(Ki),(i,t)=>{for(const a of t)if(!a.evaluate(i))return!1;return!0}]]},any:{type:Ki,overloads:[[[Ki,Ki],(i,[t,a])=>t.evaluate(i)||a.evaluate(i)],[Cs(Ki),(i,t)=>{for(const a of t)if(a.evaluate(i))return!0;return!1}]]},"!":[Ki,[Ki],(i,[t])=>!t.evaluate(i)],"is-supported-script":[Ki,[nr],(i,[t])=>{const a=i.globals&&i.globals.isSupportedScript;return!a||a(t.evaluate(i))}],upcase:[nr,[nr],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[nr,[nr],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[nr,Cs(Ni),(i,t)=>t.map(a=>et(a.evaluate(i))).join("")],"resolved-locale":[nr,[ya],(i,[t])=>t.evaluate(i).resolvedLocale()]});class ku{constructor(t,a){this.expression=t,this._warningHistory={},this._evaluator=new ci,this._defaultValue=a?function(p){return p.type==="color"&&Zl(p.default)?new X(0,0,0,0):p.type==="color"?X.parse(p.default)||null:p.default===void 0?null:p.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(t,a,p,_,b,I){return this._evaluator.globals=t,this._evaluator.feature=a,this._evaluator.featureState=p,this._evaluator.canonical=_,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=I,this.expression.evaluate(this._evaluator)}evaluate(t,a,p,_,b,I){this._evaluator.globals=t,this._evaluator.feature=a||null,this._evaluator.featureState=p||null,this._evaluator.canonical=_,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=I||null;try{const P=this.expression.evaluate(this._evaluator);if(P==null||typeof P=="number"&&P!=P)return this._defaultValue;if(this._enumValues&&!(P in this._enumValues))throw new tt(`Expected value to be one of ${Object.keys(this._enumValues).map(R=>JSON.stringify(R)).join(", ")}, but found ${JSON.stringify(P)} instead.`);return P}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console!="undefined"&&console.warn(P.message)),this._defaultValue}}}function Va(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in _a}function qa(i,t){const a=new Oa(_a,[],t?function(_){const b={color:Dn,string:nr,number:Ht,enum:nr,boolean:Ki,formatted:Oo,resolvedImage:Xr};return _.type==="array"?te(b[_.value]||Ni,_.length):b[_.type]}(t):void 0),p=a.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Gr(new ku(p,t)):Ws(a.errors)}class Xl{constructor(t,a){this.kind=t,this._styleExpression=a,this.isStateDependent=t!=="constant"&&!Sn(a.expression)}evaluateWithoutErrorHandling(t,a,p,_,b,I){return this._styleExpression.evaluateWithoutErrorHandling(t,a,p,_,b,I)}evaluate(t,a,p,_,b,I){return this._styleExpression.evaluate(t,a,p,_,b,I)}}class ks{constructor(t,a,p,_){this.kind=t,this.zoomStops=p,this._styleExpression=a,this.isStateDependent=t!=="camera"&&!Sn(a.expression),this.interpolationType=_}evaluateWithoutErrorHandling(t,a,p,_,b,I){return this._styleExpression.evaluateWithoutErrorHandling(t,a,p,_,b,I)}evaluate(t,a,p,_,b,I){return this._styleExpression.evaluate(t,a,p,_,b,I)}interpolationFactor(t,a,p){return this.interpolationType?fo.interpolationFactor(this.interpolationType,t,a,p):0}}function Jr(i,t){const a=qa(i,t);if(a.result==="error")return a;const p=a.value.expression,_=ga(p);if(!_&&!ns(t))return Ws([new Kn("","data expressions not supported")]);const b=Zo(p,["zoom"]);if(!b&&!nc(t))return Ws([new Kn("","zoom expressions not supported")]);const I=zu(p);return I||b?I instanceof Kn?Ws([I]):I instanceof fo&&!Cu(t)?Ws([new Kn("",'"interpolate" expressions cannot be used with this property')]):Gr(I?new ks(_?"camera":"composite",a.value,I.labels,I instanceof fo?I.interpolation:void 0):new Xl(_?"constant":"source",a.value)):Ws([new Kn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class os{constructor(t,a){this._parameters=t,this._specification=a,yr(this,Ta(this._parameters,this._specification))}static deserialize(t){return new os(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function zu(i){let t=null;if(i instanceof Su)t=zu(i.result);else if(i instanceof Iu){for(const a of i.args)if(t=zu(a),t)break}else(i instanceof Zs||i instanceof fo)&&i.input instanceof Kt&&i.input.name==="zoom"&&(t=i);return t instanceof Kn||i.eachChild(a=>{const p=zu(a);p instanceof Kn?t=p:!t&&p?t=new Kn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&p&&t!==p&&(t=new Kn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function ko(i){const t=i.key,a=i.value,p=i.valueSpec||{},_=i.objectElementValidators||{},b=i.style,I=i.styleSpec;let P=[];const R=Ji(a);if(R!=="object")return[new gt(t,a,`object expected, ${R} found`)];for(const O in a){const V=O.split(".")[0],j=p[V]||p["*"];let K;if(_[V])K=_[V];else if(p[V])K=Po;else if(_["*"])K=_["*"];else{if(!p["*"]){P.push(new gt(t,a[O],`unknown property "${O}"`));continue}K=Po}P=P.concat(K({key:(t&&`${t}.`)+O,value:a[O],valueSpec:j,style:b,styleSpec:I,object:a,objectKey:O},a))}for(const O in p)_[O]||p[O].required&&p[O].default===void 0&&a[O]===void 0&&P.push(new gt(t,a,`missing required property "${O}"`));return P}function oc(i){const t=i.value,a=i.valueSpec,p=i.style,_=i.styleSpec,b=i.key,I=i.arrayElementValidator||Po;if(Ji(t)!=="array")return[new gt(b,t,`array expected, ${Ji(t)} found`)];if(a.length&&t.length!==a.length)return[new gt(b,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new gt(b,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let P={type:a.value,values:a.values};_.$version<7&&(P.function=a.function),Ji(a.value)==="object"&&(P=a.value);let R=[];for(let O=0;O<t.length;O++)R=R.concat(I({array:t,arrayIndex:O,value:t[O],valueSpec:P,style:p,styleSpec:_,key:`${b}[${O}]`}));return R}function Uc(i){const t=i.key,a=i.value,p=i.valueSpec;let _=Ji(a);return _==="number"&&a!=a&&(_="NaN"),_!=="number"?[new gt(t,a,`number expected, ${_} found`)]:"minimum"in p&&a<p.minimum?[new gt(t,a,`${a} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&a>p.maximum?[new gt(t,a,`${a} is greater than the maximum value ${p.maximum}`)]:[]}function ac(i){const t=i.valueSpec,a=br(i.value.type);let p,_,b,I={};const P=a!=="categorical"&&i.value.property===void 0,R=!P,O=Ji(i.value.stops)==="array"&&Ji(i.value.stops[0])==="array"&&Ji(i.value.stops[0][0])==="object",V=ko({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(Y){if(a==="identity")return[new gt(Y.key,Y.value,'identity function may not have a "stops" property')];let Q=[];const se=Y.value;return Q=Q.concat(oc({key:Y.key,value:se,valueSpec:Y.valueSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:j})),Ji(se)==="array"&&se.length===0&&Q.push(new gt(Y.key,se,"array must have at least one stop")),Q},default:function(Y){return Po({key:Y.key,value:Y.value,valueSpec:t,style:Y.style,styleSpec:Y.styleSpec})}}});return a==="identity"&&P&&V.push(new gt(i.key,i.value,'missing required property "property"')),a==="identity"||i.value.stops||V.push(new gt(i.key,i.value,'missing required property "stops"')),a==="exponential"&&i.valueSpec.expression&&!Cu(i.valueSpec)&&V.push(new gt(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(R&&!ns(i.valueSpec)?V.push(new gt(i.key,i.value,"property functions not supported")):P&&!nc(i.valueSpec)&&V.push(new gt(i.key,i.value,"zoom functions not supported"))),a!=="categorical"&&!O||i.value.property!==void 0||V.push(new gt(i.key,i.value,'"property" property is required')),V;function j(Y){let Q=[];const se=Y.value,pe=Y.key;if(Ji(se)!=="array")return[new gt(pe,se,`array expected, ${Ji(se)} found`)];if(se.length!==2)return[new gt(pe,se,`array length 2 expected, length ${se.length} found`)];if(O){if(Ji(se[0])!=="object")return[new gt(pe,se,`object expected, ${Ji(se[0])} found`)];if(se[0].zoom===void 0)return[new gt(pe,se,"object stop key must have zoom")];if(se[0].value===void 0)return[new gt(pe,se,"object stop key must have value")];if(b&&b>br(se[0].zoom))return[new gt(pe,se[0].zoom,"stop zoom values must appear in ascending order")];br(se[0].zoom)!==b&&(b=br(se[0].zoom),_=void 0,I={}),Q=Q.concat(ko({key:`${pe}[0]`,value:se[0],valueSpec:{zoom:{}},style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:Uc,value:K}}))}else Q=Q.concat(K({key:`${pe}[0]`,value:se[0],valueSpec:{},style:Y.style,styleSpec:Y.styleSpec},se));return Va(Xn(se[1]))?Q.concat([new gt(`${pe}[1]`,se[1],"expressions are not allowed in function stops.")]):Q.concat(Po({key:`${pe}[1]`,value:se[1],valueSpec:t,style:Y.style,styleSpec:Y.styleSpec}))}function K(Y,Q){const se=Ji(Y.value),pe=br(Y.value),Ae=Y.value!==null?Y.value:Q;if(p){if(se!==p)return[new gt(Y.key,Ae,`${se} stop domain type must match previous stop domain type ${p}`)]}else p=se;if(se!=="number"&&se!=="string"&&se!=="boolean")return[new gt(Y.key,Ae,"stop domain value must be a number, string, or boolean")];if(se!=="number"&&a!=="categorical"){let Be=`number expected, ${se} found`;return ns(t)&&a===void 0&&(Be+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new gt(Y.key,Ae,Be)]}return a!=="categorical"||se!=="number"||isFinite(pe)&&Math.floor(pe)===pe?a!=="categorical"&&se==="number"&&_!==void 0&&pe<_?[new gt(Y.key,Ae,"stop domain values must appear in ascending order")]:(_=pe,a==="categorical"&&pe in I?[new gt(Y.key,Ae,"stop domain values must be unique")]:(I[pe]=!0,[])):[new gt(Y.key,Ae,`integer expected, found ${pe}`)]}}function as(i){const t=(i.expressionContext==="property"?Jr:qa)(Xn(i.value),i.valueSpec);if(t.result==="error")return t.value.map(p=>new gt(`${i.key}${p.key}`,i.value,p.message));const a=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!a.outputDefined())return[new gt(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Sn(a))return[new gt(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Sn(a))return[new gt(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Zo(a,["zoom","feature-state"]))return[new gt(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!ga(a))return[new gt(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ss(i){const t=i.key,a=i.value,p=i.valueSpec,_=[];return Array.isArray(p.values)?p.values.indexOf(br(a))===-1&&_.push(new gt(t,a,`expected one of [${p.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(p.values).indexOf(br(a))===-1&&_.push(new gt(t,a,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(a)} found`)),_}function Ks(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!Ks(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Kl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function zs(i){if(i==null)return{filter:()=>!0,needGeometry:!1};Ks(i)||(i=Ga(i));const t=qa(i,Kl);if(t.result==="error")throw new Error(t.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,p,_)=>t.value.evaluate(a,p,{},_),needGeometry:sc(i)}}function ls(i,t){return i<t?-1:i>t?1:0}function sc(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let t=1;t<i.length;t++)if(sc(i[t]))return!0;return!1}function Ga(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?la(i[1],i[2],"=="):t==="!="?Js(la(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?la(i[1],i[2],t):t==="any"?(a=i.slice(1),["any"].concat(a.map(Ga))):t==="all"?["all"].concat(i.slice(1).map(Ga)):t==="none"?["all"].concat(i.slice(1).map(Ga).map(Js)):t==="in"?Jl(i[1],i.slice(2)):t==="!in"?Js(Jl(i[1],i.slice(2))):t==="has"?$l(i[1]):t==="!has"?Js($l(i[1])):t!=="within"||i;var a}function la(i,t,a){switch(i){case"$type":return[`filter-type-${a}`,t];case"$id":return[`filter-id-${a}`,t];default:return[`filter-${a}`,i,t]}}function Jl(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(a=>typeof a!=typeof t[0])?["filter-in-large",i,["literal",t.sort(ls)]]:["filter-in-small",i,["literal",t]]}}function $l(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Js(i){return["!",i]}function Aa(i){return Ks(Xn(i.value))?as(yr({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):vl(i)}function vl(i){const t=i.value,a=i.key;if(Ji(t)!=="array")return[new gt(a,t,`array expected, ${Ji(t)} found`)];const p=i.styleSpec;let _,b=[];if(t.length<1)return[new gt(a,t,"filter array must have at least 1 element")];switch(b=b.concat(ss({key:`${a}[0]`,value:t[0],valueSpec:p.filter_operator,style:i.style,styleSpec:i.styleSpec})),br(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&br(t[1])==="$type"&&b.push(new gt(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&b.push(new gt(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(_=Ji(t[1]),_!=="string"&&b.push(new gt(`${a}[1]`,t[1],`string expected, ${_} found`)));for(let I=2;I<t.length;I++)_=Ji(t[I]),br(t[1])==="$type"?b=b.concat(ss({key:`${a}[${I}]`,value:t[I],valueSpec:p.geometry_type,style:i.style,styleSpec:i.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&b.push(new gt(`${a}[${I}]`,t[I],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let I=1;I<t.length;I++)b=b.concat(vl({key:`${a}[${I}]`,value:t[I],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":_=Ji(t[1]),t.length!==2?b.push(new gt(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):_!=="string"&&b.push(new gt(`${a}[1]`,t[1],`string expected, ${_} found`));break;case"within":_=Ji(t[1]),t.length!==2?b.push(new gt(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):_!=="object"&&b.push(new gt(`${a}[1]`,t[1],`object expected, ${_} found`))}return b}function Ps(i,t){const a=i.key,p=i.style,_=i.styleSpec,b=i.value,I=i.objectKey,P=_[`${t}_${i.layerType}`];if(!P)return[];const R=I.match(/^(.*)-transition$/);if(t==="paint"&&R&&P[R[1]]&&P[R[1]].transition)return Po({key:a,value:b,valueSpec:_.transition,style:p,styleSpec:_});const O=i.valueSpec||P[I];if(!O)return[new gt(a,b,`unknown property "${I}"`)];let V;if(Ji(b)==="string"&&ns(O)&&!O.tokens&&(V=/^{([^}]+)}$/.exec(b)))return[new gt(a,b,`"${I}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(V[1])} }\`.`)];const j=[];return i.layerType==="symbol"&&(I==="text-field"&&p&&!p.glyphs&&j.push(new gt(a,b,'use of "text-field" requires a style "glyphs" property')),I==="text-font"&&Zl(Xn(b))&&br(b.type)==="identity"&&j.push(new gt(a,b,'"text-font" does not support identity functions'))),j.concat(Po({key:i.key,value:b,valueSpec:O,style:p,styleSpec:_,expressionContext:"property",propertyType:t,propertyKey:I}))}function Pu(i){return Ps(i,"paint")}function Yl(i){return Ps(i,"layout")}function Nc(i){let t=[];const a=i.value,p=i.key,_=i.style,b=i.styleSpec;a.type||a.ref||t.push(new gt(p,a,'either "type" or "ref" is required'));let I=br(a.type);const P=br(a.ref);if(a.id){const R=br(a.id);for(let O=0;O<i.arrayIndex;O++){const V=_.layers[O];br(V.id)===R&&t.push(new gt(p,a.id,`duplicate layer id "${a.id}", previously used at line ${V.id.__line__}`))}}if("ref"in a){let R;["type","source","source-layer","filter","layout"].forEach(O=>{O in a&&t.push(new gt(p,a[O],`"${O}" is prohibited for ref layers`))}),_.layers.forEach(O=>{br(O.id)===P&&(R=O)}),R?R.ref?t.push(new gt(p,a.ref,"ref cannot reference another ref layer")):I=br(R.type):t.push(new gt(p,a.ref,`ref layer "${P}" not found`))}else if(I!=="background")if(a.source){const R=_.sources&&_.sources[a.source],O=R&&br(R.type);R?O==="vector"&&I==="raster"?t.push(new gt(p,a.source,`layer "${a.id}" requires a raster source`)):O==="raster"&&I!=="raster"?t.push(new gt(p,a.source,`layer "${a.id}" requires a vector source`)):O!=="vector"||a["source-layer"]?O==="raster-dem"&&I!=="hillshade"?t.push(new gt(p,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):I!=="line"||!a.paint||!a.paint["line-gradient"]||O==="geojson"&&R.lineMetrics||t.push(new gt(p,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new gt(p,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new gt(p,a.source,`source "${a.source}" not found`))}else t.push(new gt(p,a,'missing required property "source"'));return t=t.concat(ko({key:p,value:a,valueSpec:b.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Po({key:`${p}.type`,value:a.type,valueSpec:b.layer.type,style:i.style,styleSpec:i.styleSpec,object:a,objectKey:"type"}),filter:Aa,layout:R=>ko({layer:a,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":O=>Yl(yr({layerType:I},O))}}),paint:R=>ko({layer:a,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":O=>Pu(yr({layerType:I},O))}})}})),t}function us(i){const t=i.value,a=i.key,p=Ji(t);return p!=="string"?[new gt(a,t,`string expected, ${p} found`)]:[]}const Mu={promoteId:function({key:i,value:t}){if(Ji(t)==="string")return us({key:i,value:t});{const a=[];for(const p in t)a.push(...us({key:`${i}.${p}`,value:t[p]}));return a}}};function xl(i){const t=i.value,a=i.key,p=i.styleSpec,_=i.style;if(!t.type)return[new gt(a,t,'"type" is required')];const b=br(t.type);let I;switch(b){case"vector":case"raster":case"raster-dem":return I=ko({key:a,value:t,valueSpec:p[`source_${b.replace("-","_")}`],style:i.style,styleSpec:p,objectElementValidators:Mu}),I;case"geojson":if(I=ko({key:a,value:t,valueSpec:p.source_geojson,style:_,styleSpec:p,objectElementValidators:Mu}),t.cluster)for(const P in t.clusterProperties){const[R,O]=t.clusterProperties[P],V=typeof R=="string"?[R,["accumulated"],["get",P]]:R;I.push(...as({key:`${a}.${P}.map`,value:O,expressionContext:"cluster-map"})),I.push(...as({key:`${a}.${P}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return I;case"video":return ko({key:a,value:t,valueSpec:p.source_video,style:_,styleSpec:p});case"image":return ko({key:a,value:t,valueSpec:p.source_image,style:_,styleSpec:p});case"canvas":return[new gt(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ss({key:`${a}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:_,styleSpec:p})}}function bl(i){const t=i.value,a=i.styleSpec,p=a.light,_=i.style;let b=[];const I=Ji(t);if(t===void 0)return b;if(I!=="object")return b=b.concat([new gt("light",t,`object expected, ${I} found`)]),b;for(const P in t){const R=P.match(/^(.*)-transition$/);b=b.concat(R&&p[R[1]]&&p[R[1]].transition?Po({key:P,value:t[P],valueSpec:a.transition,style:_,styleSpec:a}):p[P]?Po({key:P,value:t[P],valueSpec:p[P],style:_,styleSpec:a}):[new gt(P,t[P],`unknown property "${P}"`)])}return b}const zo={"*":()=>[],array:oc,boolean:function(i){const t=i.value,a=i.key,p=Ji(t);return p!=="boolean"?[new gt(a,t,`boolean expected, ${p} found`)]:[]},number:Uc,color:function(i){const t=i.key,a=i.value,p=Ji(a);return p!=="string"?[new gt(t,a,`color expected, ${p} found`)]:Ve(a)===null?[new gt(t,a,`color expected, "${a}" found`)]:[]},constants:Si,enum:ss,filter:Aa,function:ac,layer:Nc,object:ko,source:xl,light:bl,string:us,formatted:function(i){return us(i).length===0?[]:as(i)},resolvedImage:function(i){return us(i).length===0?[]:as(i)}};function Po(i){const t=i.value,a=i.valueSpec,p=i.styleSpec;return a.expression&&Zl(br(t))?ac(i):a.expression&&Va(Xn(t))?as(i):a.type&&zo[a.type]?zo[a.type](i):ko(yr({},i,{valueSpec:a.type?p[a.type]:a}))}function lc(i){const t=i.value,a=i.key,p=us(i);return p.length||(t.indexOf("{fontstack}")===-1&&p.push(new gt(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&p.push(new gt(a,t,'"glyphs" url must include a "{range}" token'))),p}function cs(i,t=Ue){let a=[];return a=a.concat(Po({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,objectElementValidators:{glyphs:lc,"*":()=>[]}})),i.constants&&(a=a.concat(Si({key:"constants",value:i.constants,style:i,styleSpec:t}))),wl(a)}function wl(i){return[].concat(i).sort((t,a)=>t.line-a.line)}function $s(i){return function(...t){return wl(i.apply(this,t))}}cs.source=$s(xl),cs.light=$s(bl),cs.layer=$s(Nc),cs.filter=$s(Aa),cs.paintProperty=$s(Pu),cs.layoutProperty=$s(Yl);const ua=cs,sn=ua.light,El=ua.paintProperty,Ys=ua.layoutProperty;function hs(i,t){let a=!1;if(t&&t.length)for(const p of t)i.fire(new Wn(new Error(p.message))),a=!0;return a}class Qi{constructor(t,a,p){const _=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const I=new Int32Array(this.arrayBuffer);t=I[0],this.d=(a=I[1])+2*(p=I[2]);for(let R=0;R<this.d*this.d;R++){const O=I[3+R],V=I[3+R+1];_.push(O===V?null:I.subarray(O,V))}const P=I[3+_.length+1];this.keys=I.subarray(I[3+_.length],P),this.bboxes=I.subarray(P),this.insert=this._insertReadonly}else{this.d=a+2*p;for(let I=0;I<this.d*this.d;I++)_.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=t,this.padding=p,this.scale=a/t,this.uid=0;const b=p/a*t;this.min=-b,this.max=t+b}insert(t,a,p,_,b){this._forEachCell(a,p,_,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(a),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,a,p,_,b,I){this.cells[b].push(I)}query(t,a,p,_,b){const I=this.min,P=this.max;if(t<=I&&a<=I&&P<=p&&P<=_&&!b)return Array.prototype.slice.call(this.keys);{const R=[];return this._forEachCell(t,a,p,_,this._queryCell,R,{},b),R}}_queryCell(t,a,p,_,b,I,P,R){const O=this.cells[b];if(O!==null){const V=this.keys,j=this.bboxes;for(let K=0;K<O.length;K++){const Y=O[K];if(P[Y]===void 0){const Q=4*Y;(R?R(j[Q+0],j[Q+1],j[Q+2],j[Q+3]):t<=j[Q+2]&&a<=j[Q+3]&&p>=j[Q+0]&&_>=j[Q+1])?(P[Y]=!0,I.push(V[Y])):P[Y]=!1}}}}_forEachCell(t,a,p,_,b,I,P,R){const O=this._convertToCellCoord(t),V=this._convertToCellCoord(a),j=this._convertToCellCoord(p),K=this._convertToCellCoord(_);for(let Y=O;Y<=j;Y++)for(let Q=V;Q<=K;Q++){const se=this.d*Q+Y;if((!R||R(this._convertFromCellCoord(Y),this._convertFromCellCoord(Q),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(Q+1)))&&b.call(this,t,a,p,_,se,I,P,R))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,a=3+this.cells.length+1+1;let p=0;for(let I=0;I<this.cells.length;I++)p+=this.cells[I].length;const _=new Int32Array(a+p+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;let b=a;for(let I=0;I<t.length;I++){const P=t[I];_[3+I]=b,_.set(P,b),b+=P.length}return _[3+t.length]=b,_.set(this.keys,b),b+=this.keys.length,_[3+t.length+1]=b,_.set(this.bboxes,b),b+=this.bboxes.length,_.buffer}static serialize(t,a){const p=t.toArrayBuffer();return a&&a.push(p),{buffer:p}}static deserialize(t){return new Qi(t.buffer)}}const Mr={};function Jt(i,t,a={}){Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),Mr[i]={klass:t,omit:a.omit||[],shallow:a.shallow||[]}}Jt("Object",Object),Jt("TransferableGridIndex",Qi),Jt("Color",X),Jt("Error",Error),Jt("AJAXError",rt),Jt("ResolvedImage",fe),Jt("StylePropertyFunction",os),Jt("StyleExpression",ku,{omit:["_evaluator"]}),Jt("ZoomDependentExpression",ks),Jt("ZoomConstantExpression",Xl),Jt("CompoundExpression",Kt,{omit:["_evaluate"]});for(const i in _a)_a[i]._classRegistryKey||Jt(`Expression_${i}`,_a[i]);function Qs(i){return i&&typeof ArrayBuffer!="undefined"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Za(i,t){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob)return i;if(Qs(i)||Qt(i))return t&&t.push(i),i;if(ArrayBuffer.isView(i)){const a=i;return t&&t.push(a.buffer),a}if(i instanceof ImageData)return t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const a=[];for(const p of i)a.push(Za(p,t));return a}if(typeof i=="object"){const a=i.constructor,p=a._classRegistryKey;if(!p)throw new Error("can't serialize object of unregistered class");const _=a.serialize?a.serialize(i,t):{};if(!a.serialize){for(const b in i){if(!i.hasOwnProperty(b)||Mr[p].omit.indexOf(b)>=0)continue;const I=i[b];_[b]=Mr[p].shallow.indexOf(b)>=0?I:Za(I,t)}i instanceof Error&&(_.message=i.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(_.$name=p),_}throw new Error("can't serialize object of type "+typeof i)}function Ca(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||Qs(i)||Qt(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(Ca);if(typeof i=="object"){const t=i.$name||"Object";if(!Mr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:a}=Mr[t];if(!a)throw new Error(`can't deserialize unregistered class ${t}`);if(a.deserialize)return a.deserialize(i);const p=Object.create(a.prototype);for(const _ of Object.keys(i)){if(_==="$name")continue;const b=i[_];p[_]=Mr[t].shallow.indexOf(_)>=0?b:Ca(b)}return p}throw new Error("can't deserialize object of type "+typeof i)}class Ql{constructor(){this.first=!0}update(t,a){const p=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=a),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=p,!0))}}const ri={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function el(i){for(const t of i)if(pn(t.charCodeAt(0)))return!0;return!1}function Il(i){for(const t of i)if(!ps(t.charCodeAt(0)))return!1;return!0}function ps(i){return!(ri.Arabic(i)||ri["Arabic Supplement"](i)||ri["Arabic Extended-A"](i)||ri["Arabic Presentation Forms-A"](i)||ri["Arabic Presentation Forms-B"](i))}function pn(i){return!(i!==746&&i!==747&&(i<4352||!(ri["Bopomofo Extended"](i)||ri.Bopomofo(i)||ri["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||ri["CJK Compatibility Ideographs"](i)||ri["CJK Compatibility"](i)||ri["CJK Radicals Supplement"](i)||ri["CJK Strokes"](i)||!(!ri["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||ri["CJK Unified Ideographs Extension A"](i)||ri["CJK Unified Ideographs"](i)||ri["Enclosed CJK Letters and Months"](i)||ri["Hangul Compatibility Jamo"](i)||ri["Hangul Jamo Extended-A"](i)||ri["Hangul Jamo Extended-B"](i)||ri["Hangul Jamo"](i)||ri["Hangul Syllables"](i)||ri.Hiragana(i)||ri["Ideographic Description Characters"](i)||ri.Kanbun(i)||ri["Kangxi Radicals"](i)||ri["Katakana Phonetic Extensions"](i)||ri.Katakana(i)&&i!==12540||!(!ri["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!ri["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||ri["Unified Canadian Aboriginal Syllabics"](i)||ri["Unified Canadian Aboriginal Syllabics Extended"](i)||ri["Vertical Forms"](i)||ri["Yijing Hexagram Symbols"](i)||ri["Yi Syllables"](i)||ri["Yi Radicals"](i))))}function Sl(i){return!(pn(i)||function(t){return!!(ri["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||ri["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||ri["Letterlike Symbols"](t)||ri["Number Forms"](t)||ri["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||ri["Control Pictures"](t)&&t!==9251||ri["Optical Character Recognition"](t)||ri["Enclosed Alphanumerics"](t)||ri["Geometric Shapes"](t)||ri["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||ri["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||ri["CJK Symbols and Punctuation"](t)||ri.Katakana(t)||ri["Private Use Area"](t)||ri["CJK Compatibility Forms"](t)||ri["Small Form Variants"](t)||ri["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}function uc(i){return i>=1424&&i<=2303||ri["Arabic Presentation Forms-A"](i)||ri["Arabic Presentation Forms-B"](i)}function zn(i,t){return!(!t&&uc(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||ri.Khmer(i))}function oi(i){for(const t of i)if(uc(t.charCodeAt(0)))return!0;return!1}const Io="deferred",Tl="loading",Ms="loaded";let ca=null,ln="unavailable",Ha=null;const qt=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(ln="error"),ca&&ca(i)};function eu(){ds.fire(new Ao("pluginStateChange",{pluginStatus:ln,pluginURL:Ha}))}const ds=new Ba,tu=function(){return ln},Uo=function(){if(ln!==Io||!Ha)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ln=Tl,eu(),Ha&&co({url:Ha},i=>{i?qt(i):(ln=Ms,eu())})},dn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ln===Ms||dn.applyArabicShaping!=null,isLoading:()=>ln===Tl,setState(i){ln=i.pluginStatus,Ha=i.pluginURL},isParsed:()=>dn.applyArabicShaping!=null&&dn.processBidirectionalText!=null&&dn.processStyledBidirectionalText!=null,getPluginURL:()=>Ha};class rn{constructor(t,a){this.zoom=t,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ql,this.transition={})}isSupportedScript(t){return function(a,p){for(const _ of a)if(!zn(_.charCodeAt(0),p))return!1;return!0}(t,dn.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,a=t-Math.floor(t),p=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*a}}}class tl{constructor(t,a){this.property=t,this.value=a,this.expression=function(p,_){if(Zl(p))return new os(p,_);if(Va(p)){const b=Jr(p,_);if(b.result==="error")throw new Error(b.value.map(I=>`${I.key}: ${I.message}`).join(", "));return b.value}{let b=p;return typeof p=="string"&&_.type==="color"&&(b=X.parse(p)),{kind:"constant",evaluate:()=>b}}}(a===void 0?t.specification.default:a,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,a,p){return this.property.possiblyEvaluate(this,t,a,p)}}class So{constructor(t){this.property=t,this.value=new tl(t,void 0)}transitioned(t,a){return new cc(this.property,this.value,a,ke({},t.transition,this.transition),t.now)}untransitioned(){return new cc(this.property,this.value,null,{},0)}}class ka{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Ze(this._values[t].value.value)}setValue(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new So(this._values[t].property)),this._values[t].value=new tl(this._values[t].property,a===null?void 0:Ze(a))}getTransition(t){return Ze(this._values[t].transition)}setTransition(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new So(this._values[t].property)),this._values[t].transition=Ze(a)||void 0}serialize(){const t={};for(const a of Object.keys(this._values)){const p=this.getValue(a);p!==void 0&&(t[a]=p);const _=this.getTransition(a);_!==void 0&&(t[`${a}-transition`]=_)}return t}transitioned(t,a){const p=new Al(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].transitioned(t,a._values[_]);return p}untransitioned(){const t=new Al(this._properties);for(const a of Object.keys(this._values))t._values[a]=this._values[a].untransitioned();return t}}class cc{constructor(t,a,p,_,b){this.property=t,this.value=a,this.begin=b+_.delay||0,this.end=this.begin+_.duration||0,t.specification.transition&&(_.delay||_.duration)&&(this.prior=p)}possiblyEvaluate(t,a,p){const _=t.now||0,b=this.value.possiblyEvaluate(t,a,p),I=this.prior;if(I){if(_>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(_<this.begin)return I.possiblyEvaluate(t,a,p);{const P=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(I.possiblyEvaluate(t,a,p),b,function(R){if(R<=0)return 0;if(R>=1)return 1;const O=R*R,V=O*R;return 4*(R<.5?V:3*(R-O)+V-.75)}(P))}}return b}}class Al{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,a,p){const _=new Wo(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(t,a,p);return _}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class hc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return Ze(this._values[t].value)}setValue(t,a){this._values[t]=new tl(this._values[t].property,a===null?void 0:Ze(a))}serialize(){const t={};for(const a of Object.keys(this._values)){const p=this.getValue(a);p!==void 0&&(t[a]=p)}return t}possiblyEvaluate(t,a,p){const _=new Wo(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(t,a,p);return _}}class va{constructor(t,a,p){this.property=t,this.value=a,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,a,p,_){return this.property.evaluate(this.value,this.parameters,t,a,p,_)}}class Wo{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class si{constructor(t){this.specification=t}possiblyEvaluate(t,a){return t.expression.evaluate(a)}interpolate(t,a,p){const _=ml[this.specification.type];return _?_(t,a,p):t}}class Nt{constructor(t,a){this.specification=t,this.overrides=a}possiblyEvaluate(t,a,p,_){return new va(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(a,null,{},p,_)}:t.expression,a)}interpolate(t,a,p){if(t.value.kind!=="constant"||a.value.kind!=="constant")return t;if(t.value.value===void 0||a.value.value===void 0)return new va(this,{kind:"constant",value:void 0},t.parameters);const _=ml[this.specification.type];return _?new va(this,{kind:"constant",value:_(t.value.value,a.value.value,p)},t.parameters):t}evaluate(t,a,p,_,b,I){return t.kind==="constant"?t.value:t.evaluate(a,p,_,b,I)}}class Xo extends Nt{possiblyEvaluate(t,a,p,_){if(t.value===void 0)return new va(this,{kind:"constant",value:void 0},a);if(t.expression.kind==="constant"){const b=t.expression.evaluate(a,null,{},p,_),I=t.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,P=this._calculate(I,I,I,a);return new va(this,{kind:"constant",value:P},a)}if(t.expression.kind==="camera"){const b=this._calculate(t.expression.evaluate({zoom:a.zoom-1}),t.expression.evaluate({zoom:a.zoom}),t.expression.evaluate({zoom:a.zoom+1}),a);return new va(this,{kind:"constant",value:b},a)}return new va(this,t.expression,a)}evaluate(t,a,p,_,b,I){if(t.kind==="source"){const P=t.evaluate(a,p,_,b,I);return this._calculate(P,P,P,a)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(a.zoom)-1},p,_),t.evaluate({zoom:Math.floor(a.zoom)},p,_),t.evaluate({zoom:Math.floor(a.zoom)+1},p,_),a):t.value}_calculate(t,a,p,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:p,to:a}}interpolate(t){return t}}class Mo{constructor(t){this.specification=t}possiblyEvaluate(t,a,p,_){if(t.value!==void 0){if(t.expression.kind==="constant"){const b=t.expression.evaluate(a,null,{},p,_);return this._calculate(b,b,b,a)}return this._calculate(t.expression.evaluate(new rn(Math.floor(a.zoom-1),a)),t.expression.evaluate(new rn(Math.floor(a.zoom),a)),t.expression.evaluate(new rn(Math.floor(a.zoom+1),a)),a)}}_calculate(t,a,p,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:p,to:a}}interpolate(t){return t}}class jn{constructor(t){this.specification=t}possiblyEvaluate(t,a,p,_){return!!t.expression.evaluate(a,null,{},p,_)}interpolate(){return!1}}class fn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in t){const p=t[a];p.specification.overridable&&this.overridableProperties.push(a);const _=this.defaultPropertyValues[a]=new tl(p,void 0),b=this.defaultTransitionablePropertyValues[a]=new So(p);this.defaultTransitioningPropertyValues[a]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=_.possiblyEvaluate({})}}}Jt("DataDrivenProperty",Nt),Jt("DataConstantProperty",si),Jt("CrossFadedDataDrivenProperty",Xo),Jt("CrossFadedProperty",Mo),Jt("ColorRampProperty",jn);const Ko="-transition";class vn extends Ba{constructor(t,a){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),a.layout&&(this._unevaluatedLayout=new hc(a.layout)),a.paint)){this._transitionablePaint=new ka(a.paint);for(const p in t.paint)this.setPaintProperty(p,t.paint[p],{validate:!1});for(const p in t.layout)this.setLayoutProperty(p,t.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wo(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,a,p={}){a!=null&&this._validate(Ys,`layers.${this.id}.layout.${t}`,t,a,p)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,a):this.visibility=a)}getPaintProperty(t){return t.endsWith(Ko)?this._transitionablePaint.getTransition(t.slice(0,-Ko.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,a,p={}){if(a!=null&&this._validate(El,`layers.${this.id}.paint.${t}`,t,a,p))return!1;if(t.endsWith(Ko))return this._transitionablePaint.setTransition(t.slice(0,-Ko.length),a||void 0),!1;{const _=this._transitionablePaint._values[t],b=_.property.specification["property-type"]==="cross-faded-data-driven",I=_.value.isDataDriven(),P=_.value;this._transitionablePaint.setValue(t,a),this._handleSpecialPaintPropertyUpdate(t);const R=this._transitionablePaint._values[t].value;return R.isDataDriven()||I||b||this._handleOverridablePaintPropertyUpdate(t,P,R)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,a,p){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,a){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,a)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Ne(t,(a,p)=>!(a===void 0||p==="layout"&&!Object.keys(a).length||p==="paint"&&!Object.keys(a).length))}_validate(t,a,p,_,b={}){return(!b||b.validate!==!1)&&hs(this,t.call(ua,{key:a,layerType:this.type,objectKey:p,value:_,styleSpec:Ue,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const a=this.paint.get(t);if(a instanceof va&&ns(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const Lo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class fs{constructor(t,a){this._structArray=t,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Zt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,a){return t._trim(),a&&(t.isTransferred=!0,a.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const a=Object.create(this.prototype);return a.arrayBuffer=t.arrayBuffer,a.length=t.length,a.capacity=t.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Gt(i,t=1){let a=0,p=0;return{members:i.map(_=>{const b=Lo[_.type].BYTES_PER_ELEMENT,I=a=iu(a,Math.max(t,b)),P=_.components||1;return p=Math.max(p,b),a+=b*P,{name:_.name,type:_.type,components:P,offset:I}}),size:iu(a,Math.max(p,t)),alignment:t}}function iu(i,t){return Math.ceil(i/t)*t}class Bn extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a){const p=this.length;return this.resize(p+1),this.emplace(p,t,a)}emplace(t,a,p){const _=2*t;return this.int16[_+0]=a,this.int16[_+1]=p,t}}Bn.prototype.bytesPerElement=4,Jt("StructArrayLayout2i4",Bn);class No extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,a,p,_)}emplace(t,a,p,_,b){const I=4*t;return this.int16[I+0]=a,this.int16[I+1]=p,this.int16[I+2]=_,this.int16[I+3]=b,t}}No.prototype.bytesPerElement=8,Jt("StructArrayLayout4i8",No);class T extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,p,_,b,I){const P=this.length;return this.resize(P+1),this.emplace(P,t,a,p,_,b,I)}emplace(t,a,p,_,b,I,P){const R=6*t;return this.int16[R+0]=a,this.int16[R+1]=p,this.int16[R+2]=_,this.int16[R+3]=b,this.int16[R+4]=I,this.int16[R+5]=P,t}}T.prototype.bytesPerElement=12,Jt("StructArrayLayout2i4i12",T);class o extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,p,_,b,I){const P=this.length;return this.resize(P+1),this.emplace(P,t,a,p,_,b,I)}emplace(t,a,p,_,b,I,P){const R=4*t,O=8*t;return this.int16[R+0]=a,this.int16[R+1]=p,this.uint8[O+4]=_,this.uint8[O+5]=b,this.uint8[O+6]=I,this.uint8[O+7]=P,t}}o.prototype.bytesPerElement=8,Jt("StructArrayLayout2i4ub8",o);class y extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a){const p=this.length;return this.resize(p+1),this.emplace(p,t,a)}emplace(t,a,p){const _=2*t;return this.float32[_+0]=a,this.float32[_+1]=p,t}}y.prototype.bytesPerElement=8,Jt("StructArrayLayout2f8",y);class S extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,p,_,b,I,P,R,O,V){const j=this.length;return this.resize(j+1),this.emplace(j,t,a,p,_,b,I,P,R,O,V)}emplace(t,a,p,_,b,I,P,R,O,V,j){const K=10*t;return this.uint16[K+0]=a,this.uint16[K+1]=p,this.uint16[K+2]=_,this.uint16[K+3]=b,this.uint16[K+4]=I,this.uint16[K+5]=P,this.uint16[K+6]=R,this.uint16[K+7]=O,this.uint16[K+8]=V,this.uint16[K+9]=j,t}}S.prototype.bytesPerElement=20,Jt("StructArrayLayout10ui20",S);class A extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,p,_,b,I,P,R,O,V,j,K){const Y=this.length;return this.resize(Y+1),this.emplace(Y,t,a,p,_,b,I,P,R,O,V,j,K)}emplace(t,a,p,_,b,I,P,R,O,V,j,K,Y){const Q=12*t;return this.int16[Q+0]=a,this.int16[Q+1]=p,this.int16[Q+2]=_,this.int16[Q+3]=b,this.uint16[Q+4]=I,this.uint16[Q+5]=P,this.uint16[Q+6]=R,this.uint16[Q+7]=O,this.int16[Q+8]=V,this.int16[Q+9]=j,this.int16[Q+10]=K,this.int16[Q+11]=Y,t}}A.prototype.bytesPerElement=24,Jt("StructArrayLayout4i4ui4i24",A);class M extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,p){const _=this.length;return this.resize(_+1),this.emplace(_,t,a,p)}emplace(t,a,p,_){const b=3*t;return this.float32[b+0]=a,this.float32[b+1]=p,this.float32[b+2]=_,t}}M.prototype.bytesPerElement=12,Jt("StructArrayLayout3f12",M);class U extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint32[1*t+0]=a,t}}U.prototype.bytesPerElement=4,Jt("StructArrayLayout1ul4",U);class Z extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,p,_,b,I,P,R,O){const V=this.length;return this.resize(V+1),this.emplace(V,t,a,p,_,b,I,P,R,O)}emplace(t,a,p,_,b,I,P,R,O,V){const j=10*t,K=5*t;return this.int16[j+0]=a,this.int16[j+1]=p,this.int16[j+2]=_,this.int16[j+3]=b,this.int16[j+4]=I,this.int16[j+5]=P,this.uint32[K+3]=R,this.uint16[j+8]=O,this.uint16[j+9]=V,t}}Z.prototype.bytesPerElement=20,Jt("StructArrayLayout6i1ul2ui20",Z);class J extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,p,_,b,I){const P=this.length;return this.resize(P+1),this.emplace(P,t,a,p,_,b,I)}emplace(t,a,p,_,b,I,P){const R=6*t;return this.int16[R+0]=a,this.int16[R+1]=p,this.int16[R+2]=_,this.int16[R+3]=b,this.int16[R+4]=I,this.int16[R+5]=P,t}}J.prototype.bytesPerElement=12,Jt("StructArrayLayout2i2i2i12",J);class ee extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,p,_,b){const I=this.length;return this.resize(I+1),this.emplace(I,t,a,p,_,b)}emplace(t,a,p,_,b,I){const P=4*t,R=8*t;return this.float32[P+0]=a,this.float32[P+1]=p,this.float32[P+2]=_,this.int16[R+6]=b,this.int16[R+7]=I,t}}ee.prototype.bytesPerElement=16,Jt("StructArrayLayout2f1f2i16",ee);class re extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,a,p,_)}emplace(t,a,p,_,b){const I=12*t,P=3*t;return this.uint8[I+0]=a,this.uint8[I+1]=p,this.float32[P+1]=_,this.float32[P+2]=b,t}}re.prototype.bytesPerElement=12,Jt("StructArrayLayout2ub2f12",re);class ue extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,p){const _=this.length;return this.resize(_+1),this.emplace(_,t,a,p)}emplace(t,a,p,_){const b=3*t;return this.uint16[b+0]=a,this.uint16[b+1]=p,this.uint16[b+2]=_,t}}ue.prototype.bytesPerElement=6,Jt("StructArrayLayout3ui6",ue);class ve extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,p,_,b,I,P,R,O,V,j,K,Y,Q,se,pe,Ae){const Be=this.length;return this.resize(Be+1),this.emplace(Be,t,a,p,_,b,I,P,R,O,V,j,K,Y,Q,se,pe,Ae)}emplace(t,a,p,_,b,I,P,R,O,V,j,K,Y,Q,se,pe,Ae,Be){const qe=24*t,Ge=12*t,it=48*t;return this.int16[qe+0]=a,this.int16[qe+1]=p,this.uint16[qe+2]=_,this.uint16[qe+3]=b,this.uint32[Ge+2]=I,this.uint32[Ge+3]=P,this.uint32[Ge+4]=R,this.uint16[qe+10]=O,this.uint16[qe+11]=V,this.uint16[qe+12]=j,this.float32[Ge+7]=K,this.float32[Ge+8]=Y,this.uint8[it+36]=Q,this.uint8[it+37]=se,this.uint8[it+38]=pe,this.uint32[Ge+10]=Ae,this.int16[qe+22]=Be,t}}ve.prototype.bytesPerElement=48,Jt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ve);class Re extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,p,_,b,I,P,R,O,V,j,K,Y,Q,se,pe,Ae,Be,qe,Ge,it,He,Ct,Tt,ut,St,mt,kt){const dt=this.length;return this.resize(dt+1),this.emplace(dt,t,a,p,_,b,I,P,R,O,V,j,K,Y,Q,se,pe,Ae,Be,qe,Ge,it,He,Ct,Tt,ut,St,mt,kt)}emplace(t,a,p,_,b,I,P,R,O,V,j,K,Y,Q,se,pe,Ae,Be,qe,Ge,it,He,Ct,Tt,ut,St,mt,kt,dt){const _t=34*t,ti=17*t;return this.int16[_t+0]=a,this.int16[_t+1]=p,this.int16[_t+2]=_,this.int16[_t+3]=b,this.int16[_t+4]=I,this.int16[_t+5]=P,this.int16[_t+6]=R,this.int16[_t+7]=O,this.uint16[_t+8]=V,this.uint16[_t+9]=j,this.uint16[_t+10]=K,this.uint16[_t+11]=Y,this.uint16[_t+12]=Q,this.uint16[_t+13]=se,this.uint16[_t+14]=pe,this.uint16[_t+15]=Ae,this.uint16[_t+16]=Be,this.uint16[_t+17]=qe,this.uint16[_t+18]=Ge,this.uint16[_t+19]=it,this.uint16[_t+20]=He,this.uint16[_t+21]=Ct,this.uint16[_t+22]=Tt,this.uint32[ti+12]=ut,this.float32[ti+13]=St,this.float32[ti+14]=mt,this.float32[ti+15]=kt,this.float32[ti+16]=dt,t}}Re.prototype.bytesPerElement=68,Jt("StructArrayLayout8i15ui1ul4f68",Re);class be extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.float32[1*t+0]=a,t}}be.prototype.bytesPerElement=4,Jt("StructArrayLayout1f4",be);class De extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,p){const _=this.length;return this.resize(_+1),this.emplace(_,t,a,p)}emplace(t,a,p,_){const b=3*t;return this.int16[b+0]=a,this.int16[b+1]=p,this.int16[b+2]=_,t}}De.prototype.bytesPerElement=6,Jt("StructArrayLayout3i6",De);class Je extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,p){const _=this.length;return this.resize(_+1),this.emplace(_,t,a,p)}emplace(t,a,p,_){const b=4*t;return this.uint32[2*t+0]=a,this.uint16[b+2]=p,this.uint16[b+3]=_,t}}Je.prototype.bytesPerElement=8,Jt("StructArrayLayout1ul2ui8",Je);class Xe extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a){const p=this.length;return this.resize(p+1),this.emplace(p,t,a)}emplace(t,a,p){const _=2*t;return this.uint16[_+0]=a,this.uint16[_+1]=p,t}}Xe.prototype.bytesPerElement=4,Jt("StructArrayLayout2ui4",Xe);class nt extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint16[1*t+0]=a,t}}nt.prototype.bytesPerElement=2,Jt("StructArrayLayout1ui2",nt);class Ye extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,a,p,_)}emplace(t,a,p,_,b){const I=4*t;return this.float32[I+0]=a,this.float32[I+1]=p,this.float32[I+2]=_,this.float32[I+3]=b,t}}Ye.prototype.bytesPerElement=16,Jt("StructArrayLayout4f16",Ye);class xt extends fs{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new bt(this.anchorPointX,this.anchorPointY)}}xt.prototype.size=20;class ht extends Z{get(t){return new xt(this,t)}}Jt("CollisionBoxArray",ht);class ft extends fs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ft.prototype.size=48;class Pt extends ve{get(t){return new ft(this,t)}}Jt("PlacedSymbolArray",Pt);class Ft extends fs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Ft.prototype.size=68;class wt extends Re{get(t){return new Ft(this,t)}}Jt("SymbolInstanceArray",wt);class pi extends be{getoffsetX(t){return this.float32[1*t+0]}}Jt("GlyphOffsetArray",pi);class ei extends De{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Jt("SymbolLineVertexArray",ei);class Ui extends fs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ui.prototype.size=8;class c extends Je{get(t){return new Ui(this,t)}}Jt("FeatureIndexArray",c);class m extends Bn{}class d extends Bn{}class x extends T{}class k extends o{}class L extends y{}class B extends S{}class q extends A{}class $ extends M{}class ie extends U{}class he extends J{}class de extends re{}class me extends ue{}class Ce extends Xe{}const Te=Gt([{name:"a_pos",components:2,type:"Int16"}],4),{members:Le}=Te;class xe{constructor(t=[]){this.segments=t}prepareSegment(t,a,p,_){let b=this.segments[this.segments.length-1];return t>xe.MAX_VERTEX_ARRAY_LENGTH&&ct(`Max vertices per segment is ${xe.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!b||b.vertexLength+t>xe.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==_)&&(b={vertexOffset:a.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},_!==void 0&&(b.sortKey=_),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const t of this.segments)for(const a in t.vaos)t.vaos[a].destroy()}static simpleSegment(t,a,p,_){return new xe([{vertexOffset:t,primitiveOffset:a,vertexLength:p,primitiveLength:_,vaos:{},sortKey:0}])}}function ze(i,t){return 256*(i=H(Math.floor(i),0,255))+H(Math.floor(t),0,255)}xe.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Jt("SegmentVector",xe);const Fe=Gt([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var $e={exports:{}},ot={exports:{}};ot.exports=function(i,t){var a,p,_,b,I,P,R,O;for(p=i.length-(a=3&i.length),_=t,I=3432918353,P=461845907,O=0;O<p;)R=255&i.charCodeAt(O)|(255&i.charCodeAt(++O))<<8|(255&i.charCodeAt(++O))<<16|(255&i.charCodeAt(++O))<<24,++O,_=27492+(65535&(b=5*(65535&(_=(_^=R=(65535&(R=(R=(65535&R)*I+(((R>>>16)*I&65535)<<16)&4294967295)<<15|R>>>17))*P+(((R>>>16)*P&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(R=0,a){case 3:R^=(255&i.charCodeAt(O+2))<<16;case 2:R^=(255&i.charCodeAt(O+1))<<8;case 1:_^=R=(65535&(R=(R=(65535&(R^=255&i.charCodeAt(O)))*I+(((R>>>16)*I&65535)<<16)&4294967295)<<15|R>>>17))*P+(((R>>>16)*P&65535)<<16)&4294967295}return _^=i.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0};var at={exports:{}};at.exports=function(i,t){for(var a,p=i.length,_=t^p,b=0;p>=4;)a=1540483477*(65535&(a=255&i.charCodeAt(b)|(255&i.charCodeAt(++b))<<8|(255&i.charCodeAt(++b))<<16|(255&i.charCodeAt(++b))<<24))+((1540483477*(a>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),p-=4,++b;switch(p){case 3:_^=(255&i.charCodeAt(b+2))<<16;case 2:_^=(255&i.charCodeAt(b+1))<<8;case 1:_=1540483477*(65535&(_^=255&i.charCodeAt(b)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0};var st=ot.exports,It=at.exports;$e.exports=st,$e.exports.murmur3=st,$e.exports.murmur2=It;var Dt=$e.exports;class Lt{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,a,p,_){this.ids.push($t(t)),this.positions.push(a,p,_)}getPositions(t){const a=$t(t);let p=0,_=this.ids.length-1;for(;p<_;){const I=p+_>>1;this.ids[I]>=a?_=I:p=I+1}const b=[];for(;this.ids[p]===a;)b.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return b}static serialize(t,a){const p=new Float64Array(t.ids),_=new Uint32Array(t.positions);return mi(p,_,0,p.length-1),a&&a.push(p.buffer,_.buffer),{ids:p,positions:_}}static deserialize(t){const a=new Lt;return a.ids=t.ids,a.positions=t.positions,a.indexed=!0,a}}function $t(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Dt(String(i))}function mi(i,t,a,p){for(;a<p;){const _=i[a+p>>1];let b=a-1,I=p+1;for(;;){do b++;while(i[b]<_);do I--;while(i[I]>_);if(b>=I)break;bi(i,b,I),bi(t,3*b,3*I),bi(t,3*b+1,3*I+1),bi(t,3*b+2,3*I+2)}I-a<p-I?(mi(i,t,a,I),a=I+1):(mi(i,t,I+1,p),p=I)}}function bi(i,t,a){const p=i[t];i[t]=i[a],i[a]=p}Jt("FeaturePositionMap",Lt);class di{constructor(t,a){this.gl=t.gl,this.location=a}}class ar extends di{constructor(t,a){super(t,a),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class ni extends di{constructor(t,a){super(t,a),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Bi extends di{constructor(t,a){super(t,a),this.current=X.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const er=new Float32Array(16);function Li(i){return[ze(255*i.r,255*i.g),ze(255*i.b,255*i.a)]}class Pi{constructor(t,a,p){this.value=t,this.uniformNames=a.map(_=>`u_${_}`),this.type=p}setUniform(t,a,p){t.set(p.constantOr(this.value))}getBinding(t,a,p){return this.type==="color"?new Bi(t,a):new ar(t,a)}}class ji{constructor(t,a){this.uniformNames=a.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=t.tlbr}setUniform(t,a,p,_){const b=_==="u_pattern_to"?this.patternTo:_==="u_pattern_from"?this.patternFrom:_==="u_pixel_ratio_to"?this.pixelRatioTo:_==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&t.set(b)}getBinding(t,a,p){return p.substr(0,9)==="u_pattern"?new ni(t,a):new ar(t,a)}}class Ti{constructor(t,a,p,_){this.expression=t,this.type=p,this.maxValue=0,this.paintVertexAttributes=a.map(b=>({name:`a_${b}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,a,p,_,b){const I=this.paintVertexArray.length,P=this.expression.evaluate(new rn(0),a,{},_,[],b);this.paintVertexArray.resize(t),this._setPaintValue(I,t,P)}updatePaintArray(t,a,p,_){const b=this.expression.evaluate({zoom:0},p,_);this._setPaintValue(t,a,b)}_setPaintValue(t,a,p){if(this.type==="color"){const _=Li(p);for(let b=t;b<a;b++)this.paintVertexArray.emplace(b,_[0],_[1])}else{for(let _=t;_<a;_++)this.paintVertexArray.emplace(_,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class vi{constructor(t,a,p,_,b,I){this.expression=t,this.uniformNames=a.map(P=>`u_${P}_t`),this.type=p,this.useIntegerZoom=_,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=a.map(P=>({name:`a_${P}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new I}populatePaintArray(t,a,p,_,b){const I=this.expression.evaluate(new rn(this.zoom),a,{},_,[],b),P=this.expression.evaluate(new rn(this.zoom+1),a,{},_,[],b),R=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(R,t,I,P)}updatePaintArray(t,a,p,_){const b=this.expression.evaluate({zoom:this.zoom},p,_),I=this.expression.evaluate({zoom:this.zoom+1},p,_);this._setPaintValue(t,a,b,I)}_setPaintValue(t,a,p,_){if(this.type==="color"){const b=Li(p),I=Li(_);for(let P=t;P<a;P++)this.paintVertexArray.emplace(P,b[0],b[1],I[0],I[1])}else{for(let b=t;b<a;b++)this.paintVertexArray.emplace(b,p,_);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(_))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,a){const p=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,_=H(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);t.set(_)}getBinding(t,a,p){return new ar(t,a)}}class mn{constructor(t,a,p,_,b,I){this.expression=t,this.type=a,this.useIntegerZoom=p,this.zoom=_,this.layerId=I,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(t,a,p){const _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(_,t,a.patterns&&a.patterns[this.layerId],p)}updatePaintArray(t,a,p,_,b){this._setPaintValues(t,a,p.patterns&&p.patterns[this.layerId],b)}_setPaintValues(t,a,p,_){if(!_||!p)return;const{min:b,mid:I,max:P}=p,R=_[b],O=_[I],V=_[P];if(R&&O&&V)for(let j=t;j<a;j++)this.zoomInPaintVertexArray.emplace(j,O.tl[0],O.tl[1],O.br[0],O.br[1],R.tl[0],R.tl[1],R.br[0],R.br[1],O.pixelRatio,R.pixelRatio),this.zoomOutPaintVertexArray.emplace(j,O.tl[0],O.tl[1],O.br[0],O.br[1],V.tl[0],V.tl[1],V.br[0],V.br[1],O.pixelRatio,V.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Fe.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Fe.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Cn{constructor(t,a,p){this.binders={},this._buffers=[];const _=[];for(const b in t.paint._values){if(!p(b))continue;const I=t.paint.get(b);if(!(I instanceof va&&ns(I.property.specification)))continue;const P=To(b,t.type),R=I.value,O=I.property.specification.type,V=I.property.useIntegerZoom,j=I.property.specification["property-type"],K=j==="cross-faded"||j==="cross-faded-data-driven";if(R.kind==="constant")this.binders[b]=K?new ji(R.value,P):new Pi(R.value,P,O),_.push(`/u_${b}`);else if(R.kind==="source"||K){const Y=xn(b,O,"source");this.binders[b]=K?new mn(R,O,V,a,Y,t.id):new Ti(R,P,O,Y),_.push(`/a_${b}`)}else{const Y=xn(b,O,"composite");this.binders[b]=new vi(R,P,O,V,a,Y),_.push(`/z_${b}`)}}this.cacheKey=_.sort().join("")}getMaxValue(t){const a=this.binders[t];return a instanceof Ti||a instanceof vi?a.maxValue:0}populatePaintArrays(t,a,p,_,b){for(const I in this.binders){const P=this.binders[I];(P instanceof Ti||P instanceof vi||P instanceof mn)&&P.populatePaintArray(t,a,p,_,b)}}setConstantPatternPositions(t,a){for(const p in this.binders){const _=this.binders[p];_ instanceof ji&&_.setConstantPatternPositions(t,a)}}updatePaintArrays(t,a,p,_,b){let I=!1;for(const P in t){const R=a.getPositions(P);for(const O of R){const V=p.feature(O.index);for(const j in this.binders){const K=this.binders[j];if((K instanceof Ti||K instanceof vi||K instanceof mn)&&K.expression.isStateDependent===!0){const Y=_.paint.get(j);K.expression=Y.value,K.updatePaintArray(O.start,O.end,V,t[P],b),I=!0}}}}return I}defines(){const t=[];for(const a in this.binders){const p=this.binders[a];(p instanceof Pi||p instanceof ji)&&t.push(...p.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return t}getBinderAttributes(){const t=[];for(const a in this.binders){const p=this.binders[a];if(p instanceof Ti||p instanceof vi)for(let _=0;_<p.paintVertexAttributes.length;_++)t.push(p.paintVertexAttributes[_].name);else if(p instanceof mn)for(let _=0;_<Fe.members.length;_++)t.push(Fe.members[_].name)}return t}getBinderUniforms(){const t=[];for(const a in this.binders){const p=this.binders[a];if(p instanceof Pi||p instanceof ji||p instanceof vi)for(const _ of p.uniformNames)t.push(_)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,a){const p=[];for(const _ in this.binders){const b=this.binders[_];if(b instanceof Pi||b instanceof ji||b instanceof vi){for(const I of b.uniformNames)if(a[I]){const P=b.getBinding(t,a[I],I);p.push({name:I,property:_,binding:P})}}}return p}setUniforms(t,a,p,_){for(const{name:b,property:I,binding:P}of a)this.binders[I].setUniform(P,_,p.get(I),b)}updatePaintBuffers(t){this._buffers=[];for(const a in this.binders){const p=this.binders[a];if(t&&p instanceof mn){const _=t.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(p instanceof Ti||p instanceof vi)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(t){for(const a in this.binders){const p=this.binders[a];(p instanceof Ti||p instanceof vi||p instanceof mn)&&p.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const a=this.binders[t];(a instanceof Ti||a instanceof vi||a instanceof mn)&&a.destroy()}}}class On{constructor(t,a,p=()=>!0){this.programConfigurations={};for(const _ of t)this.programConfigurations[_.id]=new Cn(_,a,p);this.needsUpload=!1,this._featureMap=new Lt,this._bufferOffset=0}populatePaintArrays(t,a,p,_,b,I){for(const P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(t,a,_,b,I);a.id!==void 0&&this._featureMap.add(a.id,p,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,a,p,_){for(const b of p)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(t,this._featureMap,a,b,_)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function To(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function xn(i,t,a){const p={color:{source:y,composite:Ye},number:{source:be,composite:y}},_=function(b){return{"line-pattern":{source:B,composite:B},"fill-pattern":{source:B,composite:B},"fill-extrusion-pattern":{source:B,composite:B}}[b]}(i);return _&&_[a]||p[t][a]}Jt("ConstantBinder",Pi),Jt("CrossFadedConstantBinder",ji),Jt("SourceExpressionBinder",Ti),Jt("CrossFadedCompositeBinder",mn),Jt("CompositeExpressionBinder",vi),Jt("ProgramConfiguration",Cn,{omit:["_buffers"]}),Jt("ProgramConfigurationSet",On);var ur=8192;const Jo=Math.pow(2,14)-1,jo=-Jo-1;function xa(i){const t=ur/i.extent,a=i.loadGeometry();for(let p=0;p<a.length;p++){const _=a[p];for(let b=0;b<_.length;b++){const I=_[b],P=Math.round(I.x*t),R=Math.round(I.y*t);I.x=H(P,jo,Jo),I.y=H(R,jo,Jo),(P<I.x||P>I.x+1||R<I.y||R>I.y+1)&&ct("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function Yn(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?xa(i):[]}}function ba(i,t,a,p,_){i.emplaceBack(2*t+(p+1)/2,2*a+(_+1)/2)}class wa{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new m,this.indexArray=new me,this.segments=new xe,this.programConfigurations=new On(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,p){const _=this.layers[0],b=[];let I=null,P=!1;_.type==="circle"&&(I=_.layout.get("circle-sort-key"),P=!I.isConstant());for(const{feature:R,id:O,index:V,sourceLayerIndex:j}of t){const K=this.layers[0]._featureFilter.needGeometry,Y=Yn(R,K);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),Y,p))continue;const Q=P?I.evaluate(Y,{},p):void 0,se={id:O,properties:R.properties,type:R.type,sourceLayerIndex:j,index:V,geometry:K?Y.geometry:xa(R),patterns:{},sortKey:Q};b.push(se)}P&&b.sort((R,O)=>R.sortKey-O.sortKey);for(const R of b){const{geometry:O,index:V,sourceLayerIndex:j}=R,K=t[V].feature;this.addFeature(R,O,V,p),a.featureIndex.insert(K,O,V,j,this.index)}}update(t,a,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Le),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,p,_){for(const b of a)for(const I of b){const P=I.x,R=I.y;if(P<0||P>=ur||R<0||R>=ur)continue;const O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),V=O.vertexLength;ba(this.layoutVertexArray,P,R,-1,-1),ba(this.layoutVertexArray,P,R,1,-1),ba(this.layoutVertexArray,P,R,1,1),ba(this.layoutVertexArray,P,R,-1,1),this.indexArray.emplaceBack(V,V+1,V+2),this.indexArray.emplaceBack(V,V+3,V+2),O.vertexLength+=4,O.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,p,{},_)}}function Lu(i,t){for(let a=0;a<i.length;a++)if(Ea(t,i[a]))return!0;for(let a=0;a<t.length;a++)if(Ea(i,t[a]))return!0;return!!ru(i,t)}function Du(i,t,a){return!!Ea(i,t)||!!nu(t,i,a)}function il(i,t){if(i.length===1)return Qn(t,i[0]);for(let a=0;a<t.length;a++){const p=t[a];for(let _=0;_<p.length;_++)if(Ea(i,p[_]))return!0}for(let a=0;a<i.length;a++)if(Qn(t,i[a]))return!0;for(let a=0;a<t.length;a++)if(ru(i,t[a]))return!0;return!1}function Ru(i,t,a){if(i.length>1){if(ru(i,t))return!0;for(let p=0;p<t.length;p++)if(nu(t[p],i,a))return!0}for(let p=0;p<i.length;p++)if(nu(i[p],t,a))return!0;return!1}function ru(i,t){if(i.length===0||t.length===0)return!1;for(let a=0;a<i.length-1;a++){const p=i[a],_=i[a+1];for(let b=0;b<t.length-1;b++)if(Ls(p,_,t[b],t[b+1]))return!0}return!1}function Ls(i,t,a,p){return pt(i,a,p)!==pt(t,a,p)&&pt(i,t,a)!==pt(i,t,p)}function nu(i,t,a){const p=a*a;if(t.length===1)return i.distSqr(t[0])<p;for(let _=1;_<t.length;_++)if(ms(i,t[_-1],t[_])<p)return!0;return!1}function ms(i,t,a){const p=t.distSqr(a);if(p===0)return i.distSqr(t);const _=((i.x-t.x)*(a.x-t.x)+(i.y-t.y)*(a.y-t.y))/p;return i.distSqr(_<0?t:_>1?a:a.sub(t)._mult(_)._add(t))}function Qn(i,t){let a,p,_,b=!1;for(let I=0;I<i.length;I++){a=i[I];for(let P=0,R=a.length-1;P<a.length;R=P++)p=a[P],_=a[R],p.y>t.y!=_.y>t.y&&t.x<(_.x-p.x)*(t.y-p.y)/(_.y-p.y)+p.x&&(b=!b)}return b}function Ea(i,t){let a=!1;for(let p=0,_=i.length-1;p<i.length;_=p++){const b=i[p],I=i[_];b.y>t.y!=I.y>t.y&&t.x<(I.x-b.x)*(t.y-b.y)/(I.y-b.y)+b.x&&(a=!a)}return a}function Cl(i,t,a){const p=a[0],_=a[2];if(i.x<p.x&&t.x<p.x||i.x>_.x&&t.x>_.x||i.y<p.y&&t.y<p.y||i.y>_.y&&t.y>_.y)return!1;const b=pt(i,t,a[0]);return b!==pt(i,t,a[1])||b!==pt(i,t,a[2])||b!==pt(i,t,a[3])}function ys(i,t,a){const p=t.paint.get(i).value;return p.kind==="constant"?p.value:a.programConfigurations.get(t.id).getMaxValue(i)}function Er(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function $o(i,t,a,p,_){if(!t[0]&&!t[1])return i;const b=bt.convert(t)._mult(_);a==="viewport"&&b._rotate(-p);const I=[];for(let P=0;P<i.length;P++)I.push(i[P].sub(b));return I}Jt("CircleBucket",wa,{omit:["layers"]});const ha=new fn({"circle-sort-key":new Nt(Ue.layout_circle["circle-sort-key"])});var ou={paint:new fn({"circle-radius":new Nt(Ue.paint_circle["circle-radius"]),"circle-color":new Nt(Ue.paint_circle["circle-color"]),"circle-blur":new Nt(Ue.paint_circle["circle-blur"]),"circle-opacity":new Nt(Ue.paint_circle["circle-opacity"]),"circle-translate":new si(Ue.paint_circle["circle-translate"]),"circle-translate-anchor":new si(Ue.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new si(Ue.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new si(Ue.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Nt(Ue.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Nt(Ue.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Nt(Ue.paint_circle["circle-stroke-opacity"])}),layout:ha},Bu=typeof Float32Array!="undefined"?Float32Array:Array;function Ou(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function rp(i,t,a){var p=t[0],_=t[1],b=t[2],I=t[3],P=t[4],R=t[5],O=t[6],V=t[7],j=t[8],K=t[9],Y=t[10],Q=t[11],se=t[12],pe=t[13],Ae=t[14],Be=t[15],qe=a[0],Ge=a[1],it=a[2],He=a[3];return i[0]=qe*p+Ge*P+it*j+He*se,i[1]=qe*_+Ge*R+it*K+He*pe,i[2]=qe*b+Ge*O+it*Y+He*Ae,i[3]=qe*I+Ge*V+it*Q+He*Be,i[4]=(qe=a[4])*p+(Ge=a[5])*P+(it=a[6])*j+(He=a[7])*se,i[5]=qe*_+Ge*R+it*K+He*pe,i[6]=qe*b+Ge*O+it*Y+He*Ae,i[7]=qe*I+Ge*V+it*Q+He*Be,i[8]=(qe=a[8])*p+(Ge=a[9])*P+(it=a[10])*j+(He=a[11])*se,i[9]=qe*_+Ge*R+it*K+He*pe,i[10]=qe*b+Ge*O+it*Y+He*Ae,i[11]=qe*I+Ge*V+it*Q+He*Be,i[12]=(qe=a[12])*p+(Ge=a[13])*P+(it=a[14])*j+(He=a[15])*se,i[13]=qe*_+Ge*R+it*K+He*pe,i[14]=qe*b+Ge*O+it*Y+He*Ae,i[15]=qe*I+Ge*V+it*Q+He*Be,i}Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});var rl,np=rp;function nl(i,t,a){var p=t[0],_=t[1],b=t[2],I=t[3];return i[0]=a[0]*p+a[4]*_+a[8]*b+a[12]*I,i[1]=a[1]*p+a[5]*_+a[9]*b+a[13]*I,i[2]=a[2]*p+a[6]*_+a[10]*b+a[14]*I,i[3]=a[3]*p+a[7]*_+a[11]*b+a[15]*I,i}function pc(i,t){const a=nl([],[i.x,i.y,0,1],t);return new bt(a[0]/a[3],a[1]/a[3])}rl=new Bu(4),Bu!=Float32Array&&(rl[0]=0,rl[1]=0,rl[2]=0,rl[3]=0);class op extends wa{}Jt("HeatmapBucket",op,{omit:["layers"]});var dc={paint:new fn({"heatmap-radius":new Nt(Ue.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Nt(Ue.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new si(Ue.paint_heatmap["heatmap-intensity"]),"heatmap-color":new jn(Ue.paint_heatmap["heatmap-color"]),"heatmap-opacity":new si(Ue.paint_heatmap["heatmap-opacity"])})};function Yo(i,{width:t,height:a},p,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==t*a*p)throw new RangeError(`mismatched image size. expected: ${_.length} but got: ${t*a*p}`)}else _=new Uint8Array(t*a*p);return i.width=t,i.height=a,i.data=_,i}function Gd(i,{width:t,height:a},p){if(t===i.width&&a===i.height)return;const _=Yo({},{width:t,height:a},p);ap(i,_,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,a)},p),i.width=t,i.height=a,i.data=_.data}function ap(i,t,a,p,_,b){if(_.width===0||_.height===0)return t;if(_.width>i.width||_.height>i.height||a.x>i.width-_.width||a.y>i.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>t.width||_.height>t.height||p.x>t.width-_.width||p.y>t.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const I=i.data,P=t.data;for(let R=0;R<_.height;R++){const O=((a.y+R)*i.width+a.x)*b,V=((p.y+R)*t.width+p.x)*b;for(let j=0;j<_.width*b;j++)P[V+j]=I[O+j]}return t}class wh{constructor(t,a){Yo(this,t,1,a)}resize(t){Gd(this,t,1)}clone(){return new wh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,p,_,b){ap(t,a,p,_,b,1)}}class gs{constructor(t,a){Yo(this,t,4,a)}resize(t){Gd(this,t,4)}replace(t,a){a?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new gs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,p,_,b){ap(t,a,p,_,b,4)}}function Zd(i){const t={},a=i.resolution||256,p=i.clips?i.clips.length:1,_=i.image||new gs({width:a,height:p}),b=(I,P,R)=>{t[i.evaluationKey]=R;const O=i.expression.evaluate(t);_.data[I+P+0]=Math.floor(255*O.r/O.a),_.data[I+P+1]=Math.floor(255*O.g/O.a),_.data[I+P+2]=Math.floor(255*O.b/O.a),_.data[I+P+3]=Math.floor(255*O.a)};if(i.clips)for(let I=0,P=0;I<p;++I,P+=4*a)for(let R=0,O=0;R<a;R++,O+=4){const V=R/(a-1),{start:j,end:K}=i.clips[I];b(P,O,j*(1-V)+K*V)}else for(let I=0,P=0;I<a;I++,P+=4)b(0,P,I/(a-1));return _}Jt("AlphaImage",wh),Jt("RGBAImage",gs);var bm={paint:new fn({"hillshade-illumination-direction":new si(Ue.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new si(Ue.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new si(Ue.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new si(Ue.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new si(Ue.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new si(Ue.paint_hillshade["hillshade-accent-color"])})};const Xp=Gt([{name:"a_pos",components:2,type:"Int16"}],4),{members:wm}=Xp;var jc={exports:{}};function Eh(i,t,a){a=a||2;var p,_,b,I,P,R,O,V=t&&t.length,j=V?t[0]*a:i.length,K=au(i,0,j,a,!0),Y=[];if(!K||K.next===K.prev)return Y;if(V&&(K=function(se,pe,Ae,Be){var qe,Ge,it,He=[];for(qe=0,Ge=pe.length;qe<Ge;qe++)(it=au(se,pe[qe]*Be,qe<Ge-1?pe[qe+1]*Be:se.length,Be,!1))===it.next&&(it.steiner=!0),He.push(Vc(it));for(He.sort(Am),qe=0;qe<He.length;qe++)Ae=Ds(Ae=Cm(He[qe],Ae),Ae.next);return Ae}(i,t,K,a)),i.length>80*a){p=b=i[0],_=I=i[1];for(var Q=a;Q<j;Q+=a)(P=i[Q])<p&&(p=P),(R=i[Q+1])<_&&(_=R),P>b&&(b=P),R>I&&(I=R);O=(O=Math.max(b-p,I-_))!==0?1/O:0}return Ih(K,Y,a,p,_,O),Y}function au(i,t,a,p,_){var b,I;if(_===Yp(i,t,a,p)>0)for(b=t;b<a;b+=p)I=Zc(b,i[b],i[b+1],I);else for(b=a-p;b>=t;b-=p)I=Zc(b,i[b],i[b+1],I);return I&&Sh(I,I.next)&&(mc(I),I=I.next),I}function Ds(i,t){if(!i)return i;t||(t=i);var a,p=i;do if(a=!1,p.steiner||!Sh(p,p.next)&&Pn(p.prev,p,p.next)!==0)p=p.next;else{if(mc(p),(p=t=p.prev)===p.next)break;a=!0}while(a||p!==t);return t}function Ih(i,t,a,p,_,b,I){if(i){!I&&b&&function(V,j,K,Y){var Q=V;do Q.z===null&&(Q.z=Jp(Q.x,Q.y,j,K,Y)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==V);Q.prevZ.nextZ=null,Q.prevZ=null,function(se){var pe,Ae,Be,qe,Ge,it,He,Ct,Tt=1;do{for(Ae=se,se=null,Ge=null,it=0;Ae;){for(it++,Be=Ae,He=0,pe=0;pe<Tt&&(He++,Be=Be.nextZ);pe++);for(Ct=Tt;He>0||Ct>0&&Be;)He!==0&&(Ct===0||!Be||Ae.z<=Be.z)?(qe=Ae,Ae=Ae.nextZ,He--):(qe=Be,Be=Be.nextZ,Ct--),Ge?Ge.nextZ=qe:se=qe,qe.prevZ=Ge,Ge=qe;Ae=Be}Ge.nextZ=null,Tt*=2}while(it>1)}(Q)}(i,p,_,b);for(var P,R,O=i;i.prev!==i.next;)if(P=i.prev,R=i.next,b?Im(i,p,_,b):Em(i))t.push(P.i/a),t.push(i.i/a),t.push(R.i/a),mc(i),i=R.next,O=R.next;else if((i=R)===O){I?I===1?Ih(i=Sm(Ds(i),t,a),t,a,p,_,b,2):I===2&&Tm(i,t,a,p,_,b):Ih(Ds(i),t,a,p,_,b,1);break}}}function Em(i){var t=i.prev,a=i,p=i.next;if(Pn(t,a,p)>=0)return!1;for(var _=i.next.next;_!==i.prev;){if(qc(t.x,t.y,a.x,a.y,p.x,p.y,_.x,_.y)&&Pn(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function Im(i,t,a,p){var _=i.prev,b=i,I=i.next;if(Pn(_,b,I)>=0)return!1;for(var P=_.x>b.x?_.x>I.x?_.x:I.x:b.x>I.x?b.x:I.x,R=_.y>b.y?_.y>I.y?_.y:I.y:b.y>I.y?b.y:I.y,O=Jp(_.x<b.x?_.x<I.x?_.x:I.x:b.x<I.x?b.x:I.x,_.y<b.y?_.y<I.y?_.y:I.y:b.y<I.y?b.y:I.y,t,a,p),V=Jp(P,R,t,a,p),j=i.prevZ,K=i.nextZ;j&&j.z>=O&&K&&K.z<=V;){if(j!==i.prev&&j!==i.next&&qc(_.x,_.y,b.x,b.y,I.x,I.y,j.x,j.y)&&Pn(j.prev,j,j.next)>=0||(j=j.prevZ,K!==i.prev&&K!==i.next&&qc(_.x,_.y,b.x,b.y,I.x,I.y,K.x,K.y)&&Pn(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;j&&j.z>=O;){if(j!==i.prev&&j!==i.next&&qc(_.x,_.y,b.x,b.y,I.x,I.y,j.x,j.y)&&Pn(j.prev,j,j.next)>=0)return!1;j=j.prevZ}for(;K&&K.z<=V;){if(K!==i.prev&&K!==i.next&&qc(_.x,_.y,b.x,b.y,I.x,I.y,K.x,K.y)&&Pn(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function Sm(i,t,a){var p=i;do{var _=p.prev,b=p.next.next;!Sh(_,b)&&Th(_,p,p.next,b)&&Gc(_,b)&&Gc(b,_)&&(t.push(_.i/a),t.push(p.i/a),t.push(b.i/a),mc(p),mc(p.next),p=i=b),p=p.next}while(p!==i);return Ds(p)}function Tm(i,t,a,p,_,b){var I=i;do{for(var P=I.next.next;P!==I.prev;){if(I.i!==P.i&&eo(I,P)){var R=$p(I,P);return I=Ds(I,I.next),R=Ds(R,R.next),Ih(I,t,a,p,_,b),void Ih(R,t,a,p,_,b)}P=P.next}I=I.next}while(I!==i)}function Am(i,t){return i.x-t.x}function Cm(i,t){var a=function(b,I){var P,R=I,O=b.x,V=b.y,j=-1/0;do{if(V<=R.y&&V>=R.next.y&&R.next.y!==R.y){var K=R.x+(V-R.y)*(R.next.x-R.x)/(R.next.y-R.y);if(K<=O&&K>j){if(j=K,K===O){if(V===R.y)return R;if(V===R.next.y)return R.next}P=R.x<R.next.x?R:R.next}}R=R.next}while(R!==I);if(!P)return null;if(O===j)return P;var Y,Q=P,se=P.x,pe=P.y,Ae=1/0;R=P;do O>=R.x&&R.x>=se&&O!==R.x&&qc(V<pe?O:j,V,se,pe,V<pe?j:O,V,R.x,R.y)&&(Y=Math.abs(V-R.y)/(O-R.x),Gc(R,b)&&(Y<Ae||Y===Ae&&(R.x>P.x||R.x===P.x&&Kp(P,R)))&&(P=R,Ae=Y)),R=R.next;while(R!==Q);return P}(i,t);if(!a)return t;var p=$p(a,i),_=Ds(a,a.next);return Ds(p,p.next),t===a?_:t}function Kp(i,t){return Pn(i.prev,i,t.prev)<0&&Pn(t.next,i,i.next)<0}function Jp(i,t,a,p,_){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-a)*_)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-p)*_)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Vc(i){var t=i,a=i;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==i);return a}function qc(i,t,a,p,_,b,I,P){return(_-I)*(t-P)-(i-I)*(b-P)>=0&&(i-I)*(p-P)-(a-I)*(t-P)>=0&&(a-I)*(b-P)-(_-I)*(p-P)>=0}function eo(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(a,p){var _=a;do{if(_.i!==a.i&&_.next.i!==a.i&&_.i!==p.i&&_.next.i!==p.i&&Th(_,_.next,a,p))return!0;_=_.next}while(_!==a);return!1}(i,t)&&(Gc(i,t)&&Gc(t,i)&&function(a,p){var _=a,b=!1,I=(a.x+p.x)/2,P=(a.y+p.y)/2;do _.y>P!=_.next.y>P&&_.next.y!==_.y&&I<(_.next.x-_.x)*(P-_.y)/(_.next.y-_.y)+_.x&&(b=!b),_=_.next;while(_!==a);return b}(i,t)&&(Pn(i.prev,i,t.prev)||Pn(i,t.prev,t))||Sh(i,t)&&Pn(i.prev,i,i.next)>0&&Pn(t.prev,t,t.next)>0)}function Pn(i,t,a){return(t.y-i.y)*(a.x-t.x)-(t.x-i.x)*(a.y-t.y)}function Sh(i,t){return i.x===t.x&&i.y===t.y}function Th(i,t,a,p){var _=Fu(Pn(i,t,a)),b=Fu(Pn(i,t,p)),I=Fu(Pn(a,p,i)),P=Fu(Pn(a,p,t));return _!==b&&I!==P||!(_!==0||!fc(i,a,t))||!(b!==0||!fc(i,p,t))||!(I!==0||!fc(a,i,p))||!(P!==0||!fc(a,t,p))}function fc(i,t,a){return t.x<=Math.max(i.x,a.x)&&t.x>=Math.min(i.x,a.x)&&t.y<=Math.max(i.y,a.y)&&t.y>=Math.min(i.y,a.y)}function Fu(i){return i>0?1:i<0?-1:0}function Gc(i,t){return Pn(i.prev,i,i.next)<0?Pn(i,t,i.next)>=0&&Pn(i,i.prev,t)>=0:Pn(i,t,i.prev)<0||Pn(i,i.next,t)<0}function $p(i,t){var a=new Ah(i.i,i.x,i.y),p=new Ah(t.i,t.x,t.y),_=i.next,b=t.prev;return i.next=t,t.prev=i,a.next=_,_.prev=a,p.next=a,a.prev=p,b.next=p,p.prev=b,p}function Zc(i,t,a,p){var _=new Ah(i,t,a);return p?(_.next=p.next,_.prev=p,p.next.prev=_,p.next=_):(_.prev=_,_.next=_),_}function mc(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Ah(i,t,a){this.i=i,this.x=t,this.y=a,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Yp(i,t,a,p){for(var _=0,b=t,I=a-p;b<a;b+=p)_+=(i[I]-i[b])*(i[b+1]+i[I+1]),I=b;return _}jc.exports=Eh,jc.exports.default=Eh,Eh.deviation=function(i,t,a,p){var _=t&&t.length,b=Math.abs(Yp(i,0,_?t[0]*a:i.length,a));if(_)for(var I=0,P=t.length;I<P;I++)b-=Math.abs(Yp(i,t[I]*a,I<P-1?t[I+1]*a:i.length,a));var R=0;for(I=0;I<p.length;I+=3){var O=p[I]*a,V=p[I+1]*a,j=p[I+2]*a;R+=Math.abs((i[O]-i[j])*(i[V+1]-i[O+1])-(i[O]-i[V])*(i[j+1]-i[O+1]))}return b===0&&R===0?0:Math.abs((R-b)/b)},Eh.flatten=function(i){for(var t=i[0][0].length,a={vertices:[],holes:[],dimensions:t},p=0,_=0;_<i.length;_++){for(var b=0;b<i[_].length;b++)for(var I=0;I<t;I++)a.vertices.push(i[_][b][I]);_>0&&a.holes.push(p+=i[_-1].length)}return a};var Hc=jc.exports;function km(i,t,a,p,_){sp(i,t,a||0,p||i.length-1,_||Qp)}function sp(i,t,a,p,_){for(;p>a;){if(p-a>600){var b=p-a+1,I=t-a+1,P=Math.log(b),R=.5*Math.exp(2*P/3),O=.5*Math.sqrt(P*R*(b-R)/b)*(I-b/2<0?-1:1);sp(i,t,Math.max(a,Math.floor(t-I*R/b+O)),Math.min(p,Math.floor(t+(b-I)*R/b+O)),_)}var V=i[t],j=a,K=p;for(Ch(i,a,t),_(i[p],V)>0&&Ch(i,a,p);j<K;){for(Ch(i,j,K),j++,K--;_(i[j],V)<0;)j++;for(;_(i[K],V)>0;)K--}_(i[a],V)===0?Ch(i,a,K):Ch(i,++K,p),K<=t&&(a=K+1),t<=K&&(p=K-1)}}function Ch(i,t,a){var p=i[t];i[t]=i[a],i[a]=p}function Qp(i,t){return i<t?-1:i>t?1:0}function kh(i,t){const a=i.length;if(a<=1)return[i];const p=[];let _,b;for(let I=0;I<a;I++){const P=lt(i[I]);P!==0&&(i[I].area=Math.abs(P),b===void 0&&(b=P<0),b===P<0?(_&&p.push(_),_=[i[I]]):_.push(i[I]))}if(_&&p.push(_),t>1)for(let I=0;I<p.length;I++)p[I].length<=t||(km(p[I],t,1,p[I].length-1,ol),p[I]=p[I].slice(0,t));return p}function ol(i,t){return t.area-i.area}function ed(i,t,a){const p=a.patternDependencies;let _=!1;for(const b of t){const I=b.paint.get(`${i}-pattern`);I.isConstant()||(_=!0);const P=I.constantOr(null);P&&(_=!0,p[P.to]=!0,p[P.from]=!0)}return _}function td(i,t,a,p,_){const b=_.patternDependencies;for(const I of t){const P=I.paint.get(`${i}-pattern`).value;if(P.kind!=="constant"){let R=P.evaluate({zoom:p-1},a,{},_.availableImages),O=P.evaluate({zoom:p},a,{},_.availableImages),V=P.evaluate({zoom:p+1},a,{},_.availableImages);R=R&&R.name?R.name:R,O=O&&O.name?O.name:O,V=V&&V.name?V.name:V,b[R]=!0,b[O]=!0,b[V]=!0,a.patterns[I.id]={min:R,mid:O,max:V}}}return a}class id{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new d,this.indexArray=new me,this.indexArray2=new Ce,this.programConfigurations=new On(t.layers,t.zoom),this.segments=new xe,this.segments2=new xe,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,p){this.hasPattern=ed("fill",this.layers,a);const _=this.layers[0].layout.get("fill-sort-key"),b=!_.isConstant(),I=[];for(const{feature:P,id:R,index:O,sourceLayerIndex:V}of t){const j=this.layers[0]._featureFilter.needGeometry,K=Yn(P,j);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),K,p))continue;const Y=b?_.evaluate(K,{},p,a.availableImages):void 0,Q={id:R,properties:P.properties,type:P.type,sourceLayerIndex:V,index:O,geometry:j?K.geometry:xa(P),patterns:{},sortKey:Y};I.push(Q)}b&&I.sort((P,R)=>P.sortKey-R.sortKey);for(const P of I){const{geometry:R,index:O,sourceLayerIndex:V}=P;if(this.hasPattern){const j=td("fill",this.layers,P,this.zoom,a);this.patternFeatures.push(j)}else this.addFeature(P,R,O,p,{});a.featureIndex.insert(t[O].feature,R,O,V,this.index)}}update(t,a,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,p)}addFeatures(t,a,p){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,a,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wm),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,a,p,_,b){for(const I of kh(a,500)){let P=0;for(const Y of I)P+=Y.length;const R=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray),O=R.vertexLength,V=[],j=[];for(const Y of I){if(Y.length===0)continue;Y!==I[0]&&j.push(V.length/2);const Q=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),se=Q.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(se+Y.length-1,se),V.push(Y[0].x),V.push(Y[0].y);for(let pe=1;pe<Y.length;pe++)this.layoutVertexArray.emplaceBack(Y[pe].x,Y[pe].y),this.indexArray2.emplaceBack(se+pe-1,se+pe),V.push(Y[pe].x),V.push(Y[pe].y);Q.vertexLength+=Y.length,Q.primitiveLength+=Y.length}const K=Hc(V,j);for(let Y=0;Y<K.length;Y+=3)this.indexArray.emplaceBack(O+K[Y],O+K[Y+1],O+K[Y+2]);R.vertexLength+=P,R.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,p,b,_)}}Jt("FillBucket",id,{omit:["layers","patternFeatures"]});const zm=new fn({"fill-sort-key":new Nt(Ue.layout_fill["fill-sort-key"])});var Hd={paint:new fn({"fill-antialias":new si(Ue.paint_fill["fill-antialias"]),"fill-opacity":new Nt(Ue.paint_fill["fill-opacity"]),"fill-color":new Nt(Ue.paint_fill["fill-color"]),"fill-outline-color":new Nt(Ue.paint_fill["fill-outline-color"]),"fill-translate":new si(Ue.paint_fill["fill-translate"]),"fill-translate-anchor":new si(Ue.paint_fill["fill-translate-anchor"]),"fill-pattern":new Xo(Ue.paint_fill["fill-pattern"])}),layout:zm};const Wc=Gt([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),{members:Pm}=Wc;var Uu={},Wd=bt,rd=Xc;function Xc(i,t,a,p,_){this.properties={},this.extent=a,this.type=0,this._pbf=i,this._geometry=-1,this._keys=p,this._values=_,i.readFields(Mm,this,t)}function Mm(i,t,a){i==1?t.id=a.readVarint():i==2?function(p,_){for(var b=p.readVarint()+p.pos;p.pos<b;){var I=_._keys[p.readVarint()],P=_._values[p.readVarint()];_.properties[I]=P}}(a,t):i==3?t.type=a.readVarint():i==4&&(t._geometry=a.pos)}function Kc(i){for(var t,a,p=0,_=0,b=i.length,I=b-1;_<b;I=_++)p+=((a=i[I]).x-(t=i[_]).x)*(t.y+a.y);return p}Xc.types=["Unknown","Point","LineString","Polygon"],Xc.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t,a=i.readVarint()+i.pos,p=1,_=0,b=0,I=0,P=[];i.pos<a;){if(_<=0){var R=i.readVarint();p=7&R,_=R>>3}if(_--,p===1||p===2)b+=i.readSVarint(),I+=i.readSVarint(),p===1&&(t&&P.push(t),t=[]),t.push(new Wd(b,I));else{if(p!==7)throw new Error("unknown command "+p);t&&t.push(t[0].clone())}}return t&&P.push(t),P},Xc.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,a=1,p=0,_=0,b=0,I=1/0,P=-1/0,R=1/0,O=-1/0;i.pos<t;){if(p<=0){var V=i.readVarint();a=7&V,p=V>>3}if(p--,a===1||a===2)(_+=i.readSVarint())<I&&(I=_),_>P&&(P=_),(b+=i.readSVarint())<R&&(R=b),b>O&&(O=b);else if(a!==7)throw new Error("unknown command "+a)}return[I,R,P,O]},Xc.prototype.toGeoJSON=function(i,t,a){var p,_,b=this.extent*Math.pow(2,a),I=this.extent*i,P=this.extent*t,R=this.loadGeometry(),O=Xc.types[this.type];function V(Y){for(var Q=0;Q<Y.length;Q++){var se=Y[Q];Y[Q]=[360*(se.x+I)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(se.y+P)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var j=[];for(p=0;p<R.length;p++)j[p]=R[p][0];V(R=j);break;case 2:for(p=0;p<R.length;p++)V(R[p]);break;case 3:for(R=function(Y){var Q=Y.length;if(Q<=1)return[Y];for(var se,pe,Ae=[],Be=0;Be<Q;Be++){var qe=Kc(Y[Be]);qe!==0&&(pe===void 0&&(pe=qe<0),pe===qe<0?(se&&Ae.push(se),se=[Y[Be]]):se.push(Y[Be]))}return se&&Ae.push(se),Ae}(R),p=0;p<R.length;p++)for(_=0;_<R[p].length;_++)V(R[p][_])}R.length===1?R=R[0]:O="Multi"+O;var K={type:"Feature",geometry:{type:O,coordinates:R},properties:this.properties};return"id"in this&&(K.id=this.id),K};var Lm=rd,lp=Jc;function Jc(i,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(al,this,t),this.length=this._features.length}function al(i,t,a){i===15?t.version=a.readVarint():i===1?t.name=a.readString():i===5?t.extent=a.readVarint():i===2?t._features.push(a.pos):i===3?t._keys.push(a.readString()):i===4&&t._values.push(function(p){for(var _=null,b=p.readVarint()+p.pos;p.pos<b;){var I=p.readVarint()>>3;_=I===1?p.readString():I===2?p.readFloat():I===3?p.readDouble():I===4?p.readVarint64():I===5?p.readVarint():I===6?p.readSVarint():I===7?p.readBoolean():null}return _}(a))}Jc.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var t=this._pbf.readVarint()+this._pbf.pos;return new Lm(this._pbf,t,this.extent,this._keys,this._values)};var Dm=lp;function Rm(i,t,a){if(i===3){var p=new Dm(a,a.readVarint()+a.pos);p.length&&(t[p.name]=p)}}Uu.VectorTile=function(i,t){this.layers=i.readFields(Rm,{},t)},Uu.VectorTileFeature=rd,Uu.VectorTileLayer=lp;const Bm=Uu.VectorTileFeature.types,yc=Math.pow(2,13);function $c(i,t,a,p,_,b,I,P){i.emplaceBack(t,a,2*Math.floor(p*yc)+I,_*yc*2,b*yc*2,Math.round(P))}class nd{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new x,this.indexArray=new me,this.programConfigurations=new On(t.layers,t.zoom),this.segments=new xe,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,p){this.features=[],this.hasPattern=ed("fill-extrusion",this.layers,a);for(const{feature:_,id:b,index:I,sourceLayerIndex:P}of t){const R=this.layers[0]._featureFilter.needGeometry,O=Yn(_,R);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),O,p))continue;const V={id:b,sourceLayerIndex:P,index:I,geometry:R?O.geometry:xa(_),properties:_.properties,type:_.type,patterns:{}};this.hasPattern?this.features.push(td("fill-extrusion",this.layers,V,this.zoom,a)):this.addFeature(V,V.geometry,I,p,{}),a.featureIndex.insert(_,V.geometry,I,P,this.index,!0)}}addFeatures(t,a,p){for(const _ of this.features){const{geometry:b}=_;this.addFeature(_,b,_.index,a,p)}}update(t,a,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Pm),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,p,_,b){for(const I of kh(a,500)){let P=0;for(const Y of I)P+=Y.length;let R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Y of I){if(Y.length===0||Fm(Y))continue;let Q=0;for(let se=0;se<Y.length;se++){const pe=Y[se];if(se>=1){const Ae=Y[se-1];if(!Om(pe,Ae)){R.vertexLength+4>xe.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Be=pe.sub(Ae)._perp()._unit(),qe=Ae.dist(pe);Q+qe>32768&&(Q=0),$c(this.layoutVertexArray,pe.x,pe.y,Be.x,Be.y,0,0,Q),$c(this.layoutVertexArray,pe.x,pe.y,Be.x,Be.y,0,1,Q),Q+=qe,$c(this.layoutVertexArray,Ae.x,Ae.y,Be.x,Be.y,0,0,Q),$c(this.layoutVertexArray,Ae.x,Ae.y,Be.x,Be.y,0,1,Q);const Ge=R.vertexLength;this.indexArray.emplaceBack(Ge,Ge+2,Ge+1),this.indexArray.emplaceBack(Ge+1,Ge+2,Ge+3),R.vertexLength+=4,R.primitiveLength+=2}}}}if(R.vertexLength+P>xe.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray)),Bm[t.type]!=="Polygon")continue;const O=[],V=[],j=R.vertexLength;for(const Y of I)if(Y.length!==0){Y!==I[0]&&V.push(O.length/2);for(let Q=0;Q<Y.length;Q++){const se=Y[Q];$c(this.layoutVertexArray,se.x,se.y,0,0,1,1,0),O.push(se.x),O.push(se.y)}}const K=Hc(O,V);for(let Y=0;Y<K.length;Y+=3)this.indexArray.emplaceBack(j+K[Y],j+K[Y+2],j+K[Y+1]);R.primitiveLength+=K.length/3,R.vertexLength+=P}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,p,b,_)}}function Om(i,t){return i.x===t.x&&(i.x<0||i.x>ur)||i.y===t.y&&(i.y<0||i.y>ur)}function Fm(i){return i.every(t=>t.x<0)||i.every(t=>t.x>ur)||i.every(t=>t.y<0)||i.every(t=>t.y>ur)}Jt("FillExtrusionBucket",nd,{omit:["layers","features"]});var Um={paint:new fn({"fill-extrusion-opacity":new si(Ue["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Nt(Ue["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new si(Ue["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new si(Ue["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Xo(Ue["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Nt(Ue["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Nt(Ue["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new si(Ue["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Yc(i,t){return i.x*t.x+i.y*t.y}function Qo(i,t){if(i.length===1){let a=0;const p=t[a++];let _;for(;!_||p.equals(_);)if(_=t[a++],!_)return 1/0;for(;a<t.length;a++){const b=t[a],I=i[0],P=_.sub(p),R=b.sub(p),O=I.sub(p),V=Yc(P,P),j=Yc(P,R),K=Yc(R,R),Y=Yc(O,P),Q=Yc(O,R),se=V*K-j*j,pe=(K*Y-j*Q)/se,Ae=(V*Q-j*Y)/se,Be=p.z*(1-pe-Ae)+_.z*pe+b.z*Ae;if(isFinite(Be))return Be}return 1/0}{let a=1/0;for(const p of t)a=Math.min(a,p.z);return a}}const Nm=Gt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Xd}=Nm,Kd=Gt([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:jm}=Kd,Jd=Uu.VectorTileFeature.types,Vm=Math.cos(Math.PI/180*37.5),$d=Math.pow(2,14)/.5;class od{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new k,this.layoutVertexArray2=new L,this.indexArray=new me,this.programConfigurations=new On(t.layers,t.zoom),this.segments=new xe,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,p){this.hasPattern=ed("line",this.layers,a);const _=this.layers[0].layout.get("line-sort-key"),b=!_.isConstant(),I=[];for(const{feature:P,id:R,index:O,sourceLayerIndex:V}of t){const j=this.layers[0]._featureFilter.needGeometry,K=Yn(P,j);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),K,p))continue;const Y=b?_.evaluate(K,{},p):void 0,Q={id:R,properties:P.properties,type:P.type,sourceLayerIndex:V,index:O,geometry:j?K.geometry:xa(P),patterns:{},sortKey:Y};I.push(Q)}b&&I.sort((P,R)=>P.sortKey-R.sortKey);for(const P of I){const{geometry:R,index:O,sourceLayerIndex:V}=P;if(this.hasPattern){const j=td("line",this.layers,P,this.zoom,a);this.patternFeatures.push(j)}else this.addFeature(P,R,O,p,{});a.featureIndex.insert(t[O].feature,R,O,V,this.index)}}update(t,a,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,p)}addFeatures(t,a,p){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,a,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,jm)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xd),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,a,p,_,b){const I=this.layers[0].layout,P=I.get("line-join").evaluate(t,{}),R=I.get("line-cap"),O=I.get("line-miter-limit"),V=I.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const j of a)this.addLine(j,t,P,R,O,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,p,b,_)}addLine(t,a,p,_,b,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ae=0;Ae<t.length-1;Ae++)this.totalDistance+=t[Ae].dist(t[Ae+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=Jd[a.type]==="Polygon";let R=t.length;for(;R>=2&&t[R-1].equals(t[R-2]);)R--;let O=0;for(;O<R-1&&t[O].equals(t[O+1]);)O++;if(R<(P?3:2))return;p==="bevel"&&(b=1.05);const V=this.overscaling<=16?122880/(512*this.overscaling):0,j=this.segments.prepareSegment(10*R,this.layoutVertexArray,this.indexArray);let K,Y,Q,se,pe;this.e1=this.e2=-1,P&&(K=t[R-2],pe=t[O].sub(K)._unit()._perp());for(let Ae=O;Ae<R;Ae++){if(Q=Ae===R-1?P?t[O+1]:void 0:t[Ae+1],Q&&t[Ae].equals(Q))continue;pe&&(se=pe),K&&(Y=K),K=t[Ae],pe=Q?Q.sub(K)._unit()._perp():se,se=se||pe;let Be=se.add(pe);Be.x===0&&Be.y===0||Be._unit();const qe=se.x*pe.x+se.y*pe.y,Ge=Be.x*pe.x+Be.y*pe.y,it=Ge!==0?1/Ge:1/0,He=2*Math.sqrt(2-2*Ge),Ct=Ge<Vm&&Y&&Q,Tt=se.x*pe.y-se.y*pe.x>0;if(Ct&&Ae>O){const mt=K.dist(Y);if(mt>2*V){const kt=K.sub(K.sub(Y)._mult(V/mt)._round());this.updateDistance(Y,kt),this.addCurrentVertex(kt,se,0,0,j),Y=kt}}const ut=Y&&Q;let St=ut?p:P?"butt":_;if(ut&&St==="round"&&(it<I?St="miter":it<=2&&(St="fakeround")),St==="miter"&&it>b&&(St="bevel"),St==="bevel"&&(it>2&&(St="flipbevel"),it<b&&(St="miter")),Y&&this.updateDistance(Y,K),St==="miter")Be._mult(it),this.addCurrentVertex(K,Be,0,0,j);else if(St==="flipbevel"){if(it>100)Be=pe.mult(-1);else{const mt=it*se.add(pe).mag()/se.sub(pe).mag();Be._perp()._mult(mt*(Tt?-1:1))}this.addCurrentVertex(K,Be,0,0,j),this.addCurrentVertex(K,Be.mult(-1),0,0,j)}else if(St==="bevel"||St==="fakeround"){const mt=-Math.sqrt(it*it-1),kt=Tt?mt:0,dt=Tt?0:mt;if(Y&&this.addCurrentVertex(K,se,kt,dt,j),St==="fakeround"){const _t=Math.round(180*He/Math.PI/20);for(let ti=1;ti<_t;ti++){let Yt=ti/_t;if(Yt!==.5){const Mi=Yt-.5;Yt+=Yt*Mi*(Yt-1)*((1.0904+qe*(qe*(3.55645-1.43519*qe)-3.2452))*Mi*Mi+(.848013+qe*(.215638*qe-1.06021)))}const ki=pe.sub(se)._mult(Yt)._add(se)._unit()._mult(Tt?-1:1);this.addHalfVertex(K,ki.x,ki.y,!1,Tt,0,j)}}Q&&this.addCurrentVertex(K,pe,-kt,-dt,j)}else if(St==="butt")this.addCurrentVertex(K,Be,0,0,j);else if(St==="square"){const mt=Y?1:-1;this.addCurrentVertex(K,Be,mt,mt,j)}else St==="round"&&(Y&&(this.addCurrentVertex(K,se,0,0,j),this.addCurrentVertex(K,se,1,1,j,!0)),Q&&(this.addCurrentVertex(K,pe,-1,-1,j,!0),this.addCurrentVertex(K,pe,0,0,j)));if(Ct&&Ae<R-1){const mt=K.dist(Q);if(mt>2*V){const kt=K.add(Q.sub(K)._mult(V/mt)._round());this.updateDistance(K,kt),this.addCurrentVertex(kt,pe,0,0,j),K=kt}}}}addCurrentVertex(t,a,p,_,b,I=!1){const P=a.y*_-a.x,R=-a.y-a.x*_;this.addHalfVertex(t,a.x+a.y*p,a.y-a.x*p,I,!1,p,b),this.addHalfVertex(t,P,R,I,!0,-_,b),this.distance>$d/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(t,a,p,_,b,I))}addHalfVertex({x:t,y:a},p,_,b,I,P,R){const O=.5*(this.lineClips?this.scaledDistance*($d-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(b?1:0),(a<<1)+(I?1:0),Math.round(63*p)+128,Math.round(63*_)+128,1+(P===0?0:P<0?-1:1)|(63&O)<<2,O>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const V=R.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,V),R.primitiveLength++),I?this.e2=V:this.e1=V}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,a){this.distance+=t.dist(a),this.updateScaledDistance()}}Jt("LineBucket",od,{omit:["layers","patternFeatures"]});const Yd=new fn({"line-cap":new si(Ue.layout_line["line-cap"]),"line-join":new Nt(Ue.layout_line["line-join"]),"line-miter-limit":new si(Ue.layout_line["line-miter-limit"]),"line-round-limit":new si(Ue.layout_line["line-round-limit"]),"line-sort-key":new Nt(Ue.layout_line["line-sort-key"])});var Qd={paint:new fn({"line-opacity":new Nt(Ue.paint_line["line-opacity"]),"line-color":new Nt(Ue.paint_line["line-color"]),"line-translate":new si(Ue.paint_line["line-translate"]),"line-translate-anchor":new si(Ue.paint_line["line-translate-anchor"]),"line-width":new Nt(Ue.paint_line["line-width"]),"line-gap-width":new Nt(Ue.paint_line["line-gap-width"]),"line-offset":new Nt(Ue.paint_line["line-offset"]),"line-blur":new Nt(Ue.paint_line["line-blur"]),"line-dasharray":new Mo(Ue.paint_line["line-dasharray"]),"line-pattern":new Xo(Ue.paint_line["line-pattern"]),"line-gradient":new jn(Ue.paint_line["line-gradient"])}),layout:Yd};const ef=new class extends Nt{possiblyEvaluate(i,t){return t=new rn(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(i,t)}evaluate(i,t,a,p){return t=ke({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(i,t,a,p)}}(Qd.paint.properties["line-width"].specification);function Qc(i,t){return t>0?t+2*i:i}ef.useIntegerZoom=!0;const tf=Gt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),rf=Gt([{name:"a_projected_pos",components:3,type:"Float32"}],4);Gt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const up=Gt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Gt([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const nn=Gt([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),nf=Gt([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function su(i,t,a){return i.sections.forEach(p=>{p.text=function(_,b,I){const P=b.layout.get("text-transform").evaluate(I,{});return P==="uppercase"?_=_.toLocaleUpperCase():P==="lowercase"&&(_=_.toLocaleLowerCase()),dn.applyArabicShaping&&(_=dn.applyArabicShaping(_)),_}(p.text,t,a)}),i}Gt([{name:"triangle",components:3,type:"Uint16"}]),Gt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Gt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Gt([{type:"Float32",name:"offsetX"}]),Gt([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const kl={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var Do=24,ad=un,of=function(i,t,a,p,_){var b,I,P=8*_-p-1,R=(1<<P)-1,O=R>>1,V=-7,j=a?_-1:0,K=a?-1:1,Y=i[t+j];for(j+=K,b=Y&(1<<-V)-1,Y>>=-V,V+=P;V>0;b=256*b+i[t+j],j+=K,V-=8);for(I=b&(1<<-V)-1,b>>=-V,V+=p;V>0;I=256*I+i[t+j],j+=K,V-=8);if(b===0)b=1-O;else{if(b===R)return I?NaN:1/0*(Y?-1:1);I+=Math.pow(2,p),b-=O}return(Y?-1:1)*I*Math.pow(2,b-p)},af=function(i,t,a,p,_,b){var I,P,R,O=8*b-_-1,V=(1<<O)-1,j=V>>1,K=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=p?0:b-1,Q=p?1:-1,se=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(P=isNaN(t)?1:0,I=V):(I=Math.floor(Math.log(t)/Math.LN2),t*(R=Math.pow(2,-I))<1&&(I--,R*=2),(t+=I+j>=1?K/R:K*Math.pow(2,1-j))*R>=2&&(I++,R/=2),I+j>=V?(P=0,I=V):I+j>=1?(P=(t*R-1)*Math.pow(2,_),I+=j):(P=t*Math.pow(2,j-1)*Math.pow(2,_),I=0));_>=8;i[a+Y]=255&P,Y+=Q,P/=256,_-=8);for(I=I<<_|P,O+=_;O>0;i[a+Y]=255&I,Y+=Q,I/=256,O-=8);i[a+Y-Q]|=128*se};function un(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}un.Varint=0,un.Fixed64=1,un.Bytes=2,un.Fixed32=5;var Nu,sd=4294967296,sf=1/sd,lf=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function lu(i){return i.type===un.Bytes?i.readVarint()+i.pos:i.pos+1}function uu(i,t,a){return a?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function gc(i,t,a){var p=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));a.realloc(p);for(var _=a.pos-1;_>=i;_--)a.buf[_+p]=a.buf[_]}function uf(i,t){for(var a=0;a<i.length;a++)t.writeVarint(i[a])}function qm(i,t){for(var a=0;a<i.length;a++)t.writeSVarint(i[a])}function Gm(i,t){for(var a=0;a<i.length;a++)t.writeFloat(i[a])}function Zm(i,t){for(var a=0;a<i.length;a++)t.writeDouble(i[a])}function cf(i,t){for(var a=0;a<i.length;a++)t.writeBoolean(i[a])}function cp(i,t){for(var a=0;a<i.length;a++)t.writeFixed32(i[a])}function zh(i,t){for(var a=0;a<i.length;a++)t.writeSFixed32(i[a])}function Ph(i,t){for(var a=0;a<i.length;a++)t.writeFixed64(i[a])}function Wa(i,t){for(var a=0;a<i.length;a++)t.writeSFixed64(i[a])}function cu(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+16777216*i[t+3]}function to(i,t,a){i[a]=t,i[a+1]=t>>>8,i[a+2]=t>>>16,i[a+3]=t>>>24}function Mh(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+(i[t+3]<<24)}function hp(i,t,a){i===1&&a.readMessage(za,t)}function za(i,t,a){if(i===3){const{id:p,bitmap:_,width:b,height:I,left:P,top:R,advance:O}=a.readMessage(hf,{});t.push({id:p,bitmap:new wh({width:b+6,height:I+6},_),metrics:{width:b,height:I,left:P,top:R,advance:O}})}}function hf(i,t,a){i===1?t.id=a.readVarint():i===2?t.bitmap=a.readBytes():i===3?t.width=a.readVarint():i===4?t.height=a.readVarint():i===5?t.left=a.readSVarint():i===6?t.top=a.readSVarint():i===7&&(t.advance=a.readVarint())}function ld(i){let t=0,a=0;for(const I of i)t+=I.w*I.h,a=Math.max(a,I.w);i.sort((I,P)=>P.h-I.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),a),h:1/0}];let _=0,b=0;for(const I of i)for(let P=p.length-1;P>=0;P--){const R=p[P];if(!(I.w>R.w||I.h>R.h)){if(I.x=R.x,I.y=R.y,b=Math.max(b,I.y+I.h),_=Math.max(_,I.x+I.w),I.w===R.w&&I.h===R.h){const O=p.pop();P<p.length&&(p[P]=O)}else I.h===R.h?(R.x+=I.w,R.w-=I.w):I.w===R.w?(R.y+=I.h,R.h-=I.h):(p.push({x:R.x+I.w,y:R.y,w:R.w-I.w,h:I.h}),R.y+=I.h,R.h-=I.h);break}}return{w:_,h:b,fill:t/(_*b)||0}}un.prototype={destroy:function(){this.buf=null},readFields:function(i,t,a){for(a=a||this.length;this.pos<a;){var p=this.readVarint(),_=p>>3,b=this.pos;this.type=7&p,i(_,t,this),this.pos===b&&this.skip(p)}return t},readMessage:function(i,t){return this.readFields(i,t,this.readVarint()+this.pos)},readFixed32:function(){var i=cu(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Mh(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=cu(this.buf,this.pos)+cu(this.buf,this.pos+4)*sd;return this.pos+=8,i},readSFixed64:function(){var i=cu(this.buf,this.pos)+Mh(this.buf,this.pos+4)*sd;return this.pos+=8,i},readFloat:function(){var i=of(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=of(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var t,a,p=this.buf;return t=127&(a=p[this.pos++]),a<128?t:(t|=(127&(a=p[this.pos++]))<<7,a<128?t:(t|=(127&(a=p[this.pos++]))<<14,a<128?t:(t|=(127&(a=p[this.pos++]))<<21,a<128?t:function(_,b,I){var P,R,O=I.buf;if(P=(112&(R=O[I.pos++]))>>4,R<128||(P|=(127&(R=O[I.pos++]))<<3,R<128)||(P|=(127&(R=O[I.pos++]))<<10,R<128)||(P|=(127&(R=O[I.pos++]))<<17,R<128)||(P|=(127&(R=O[I.pos++]))<<24,R<128)||(P|=(1&(R=O[I.pos++]))<<31,R<128))return uu(_,P,b);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(a=p[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var i=this.readVarint()+this.pos,t=this.pos;return this.pos=i,i-t>=12&&lf?function(a,p,_){return lf.decode(a.subarray(p,_))}(this.buf,t,i):function(a,p,_){for(var b="",I=p;I<_;){var P,R,O,V=a[I],j=null,K=V>239?4:V>223?3:V>191?2:1;if(I+K>_)break;K===1?V<128&&(j=V):K===2?(192&(P=a[I+1]))==128&&(j=(31&V)<<6|63&P)<=127&&(j=null):K===3?(R=a[I+2],(192&(P=a[I+1]))==128&&(192&R)==128&&((j=(15&V)<<12|(63&P)<<6|63&R)<=2047||j>=55296&&j<=57343)&&(j=null)):K===4&&(R=a[I+2],O=a[I+3],(192&(P=a[I+1]))==128&&(192&R)==128&&(192&O)==128&&((j=(15&V)<<18|(63&P)<<12|(63&R)<<6|63&O)<=65535||j>=1114112)&&(j=null)),j===null?(j=65533,K=1):j>65535&&(j-=65536,b+=String.fromCharCode(j>>>10&1023|55296),j=56320|1023&j),b+=String.fromCharCode(j),I+=K}return b}(this.buf,t,i)},readBytes:function(){var i=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,i);return this.pos=i,t},readPackedVarint:function(i,t){if(this.type!==un.Bytes)return i.push(this.readVarint(t));var a=lu(this);for(i=i||[];this.pos<a;)i.push(this.readVarint(t));return i},readPackedSVarint:function(i){if(this.type!==un.Bytes)return i.push(this.readSVarint());var t=lu(this);for(i=i||[];this.pos<t;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==un.Bytes)return i.push(this.readBoolean());var t=lu(this);for(i=i||[];this.pos<t;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==un.Bytes)return i.push(this.readFloat());var t=lu(this);for(i=i||[];this.pos<t;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==un.Bytes)return i.push(this.readDouble());var t=lu(this);for(i=i||[];this.pos<t;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==un.Bytes)return i.push(this.readFixed32());var t=lu(this);for(i=i||[];this.pos<t;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==un.Bytes)return i.push(this.readSFixed32());var t=lu(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==un.Bytes)return i.push(this.readFixed64());var t=lu(this);for(i=i||[];this.pos<t;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==un.Bytes)return i.push(this.readSFixed64());var t=lu(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed64());return i},skip:function(i){var t=7&i;if(t===un.Varint)for(;this.buf[this.pos++]>127;);else if(t===un.Bytes)this.pos=this.readVarint()+this.pos;else if(t===un.Fixed32)this.pos+=4;else{if(t!==un.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(i,t){this.writeVarint(i<<3|t)},realloc:function(i){for(var t=this.length||16;t<this.pos+i;)t*=2;if(t!==this.length){var a=new Uint8Array(t);a.set(this.buf),this.buf=a,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),to(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),to(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),to(this.buf,-1&i,this.pos),to(this.buf,Math.floor(i*sf),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),to(this.buf,-1&i,this.pos),to(this.buf,Math.floor(i*sf),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(t,a){var p,_;if(t>=0?(p=t%4294967296|0,_=t/4294967296|0):(_=~(-t/4294967296),4294967295^(p=~(-t%4294967296))?p=p+1|0:(p=0,_=_+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),function(b,I,P){P.buf[P.pos++]=127&b|128,b>>>=7,P.buf[P.pos++]=127&b|128,b>>>=7,P.buf[P.pos++]=127&b|128,b>>>=7,P.buf[P.pos++]=127&b|128,P.buf[P.pos]=127&(b>>>=7)}(p,0,a),function(b,I){var P=(7&b)<<4;I.buf[I.pos++]|=P|((b>>>=3)?128:0),b&&(I.buf[I.pos++]=127&b|((b>>>=7)?128:0),b&&(I.buf[I.pos++]=127&b|((b>>>=7)?128:0),b&&(I.buf[I.pos++]=127&b|((b>>>=7)?128:0),b&&(I.buf[I.pos++]=127&b|((b>>>=7)?128:0),b&&(I.buf[I.pos++]=127&b)))))}(_,a)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(Boolean(i))},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var t=this.pos;this.pos=function(p,_,b){for(var I,P,R=0;R<_.length;R++){if((I=_.charCodeAt(R))>55295&&I<57344){if(!P){I>56319||R+1===_.length?(p[b++]=239,p[b++]=191,p[b++]=189):P=I;continue}if(I<56320){p[b++]=239,p[b++]=191,p[b++]=189,P=I;continue}I=P-55296<<10|I-56320|65536,P=null}else P&&(p[b++]=239,p[b++]=191,p[b++]=189,P=null);I<128?p[b++]=I:(I<2048?p[b++]=I>>6|192:(I<65536?p[b++]=I>>12|224:(p[b++]=I>>18|240,p[b++]=I>>12&63|128),p[b++]=I>>6&63|128),p[b++]=63&I|128)}return b}(this.buf,i,this.pos);var a=this.pos-t;a>=128&&gc(t,a,this),this.pos=t-1,this.writeVarint(a),this.pos+=a},writeFloat:function(i){this.realloc(4),af(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),af(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var t=i.length;this.writeVarint(t),this.realloc(t);for(var a=0;a<t;a++)this.buf[this.pos++]=i[a]},writeRawMessage:function(i,t){this.pos++;var a=this.pos;i(t,this);var p=this.pos-a;p>=128&&gc(a,p,this),this.pos=a-1,this.writeVarint(p),this.pos+=p},writeMessage:function(i,t,a){this.writeTag(i,un.Bytes),this.writeRawMessage(t,a)},writePackedVarint:function(i,t){t.length&&this.writeMessage(i,uf,t)},writePackedSVarint:function(i,t){t.length&&this.writeMessage(i,qm,t)},writePackedBoolean:function(i,t){t.length&&this.writeMessage(i,cf,t)},writePackedFloat:function(i,t){t.length&&this.writeMessage(i,Gm,t)},writePackedDouble:function(i,t){t.length&&this.writeMessage(i,Zm,t)},writePackedFixed32:function(i,t){t.length&&this.writeMessage(i,cp,t)},writePackedSFixed32:function(i,t){t.length&&this.writeMessage(i,zh,t)},writePackedFixed64:function(i,t){t.length&&this.writeMessage(i,Ph,t)},writePackedSFixed64:function(i,t){t.length&&this.writeMessage(i,Wa,t)},writeBytesField:function(i,t){this.writeTag(i,un.Bytes),this.writeBytes(t)},writeFixed32Field:function(i,t){this.writeTag(i,un.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(i,t){this.writeTag(i,un.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(i,t){this.writeTag(i,un.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(i,t){this.writeTag(i,un.Fixed64),this.writeSFixed64(t)},writeVarintField:function(i,t){this.writeTag(i,un.Varint),this.writeVarint(t)},writeSVarintField:function(i,t){this.writeTag(i,un.Varint),this.writeSVarint(t)},writeStringField:function(i,t){this.writeTag(i,un.Bytes),this.writeString(t)},writeFloatField:function(i,t){this.writeTag(i,un.Fixed32),this.writeFloat(t)},writeDoubleField:function(i,t){this.writeTag(i,un.Fixed64),this.writeDouble(t)},writeBooleanField:function(i,t){this.writeVarintField(i,Boolean(t))}};class ud{constructor(t,{pixelRatio:a,version:p,stretchX:_,stretchY:b,content:I}){this.paddedRect=t,this.pixelRatio=a,this.stretchX=_,this.stretchY=b,this.content=I,this.version=p}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class cd{constructor(t,a){const p={},_={};this.haveRenderCallbacks=[];const b=[];this.addImages(t,p,b),this.addImages(a,_,b);const{w:I,h:P}=ld(b),R=new gs({width:I||1,height:P||1});for(const O in t){const V=t[O],j=p[O].paddedRect;gs.copy(V.data,R,{x:0,y:0},{x:j.x+1,y:j.y+1},V.data)}for(const O in a){const V=a[O],j=_[O].paddedRect,K=j.x+1,Y=j.y+1,Q=V.data.width,se=V.data.height;gs.copy(V.data,R,{x:0,y:0},{x:K,y:Y},V.data),gs.copy(V.data,R,{x:0,y:se-1},{x:K,y:Y-1},{width:Q,height:1}),gs.copy(V.data,R,{x:0,y:0},{x:K,y:Y+se},{width:Q,height:1}),gs.copy(V.data,R,{x:Q-1,y:0},{x:K-1,y:Y},{width:1,height:se}),gs.copy(V.data,R,{x:0,y:0},{x:K+Q,y:Y},{width:1,height:se})}this.image=R,this.iconPositions=p,this.patternPositions=_}addImages(t,a,p){for(const _ in t){const b=t[_],I={x:0,y:0,w:b.data.width+2,h:b.data.height+2};p.push(I),a[_]=new ud(I,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(t,a){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in t.updatedImages)this.patchUpdatedImage(this.iconPositions[p],t.getImage(p),a),this.patchUpdatedImage(this.patternPositions[p],t.getImage(p),a)}patchUpdatedImage(t,a,p){if(!t||!a||t.version===a.version)return;t.version=a.version;const[_,b]=t.tl;p.update(a.data,void 0,{x:_,y:b})}}Jt("ImagePosition",ud),Jt("ImageAtlas",cd),h.WritingMode=void 0,(Nu=h.WritingMode||(h.WritingMode={}))[Nu.none=0]="none",Nu[Nu.horizontal=1]="horizontal",Nu[Nu.vertical=2]="vertical",Nu[Nu.horizontalOnly=3]="horizontalOnly";const eh=-17;class _c{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,a){const p=new _c;return p.scale=t||1,p.fontStack=a,p}static forImage(t){const a=new _c;return a.imageName=t,a}}class th{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,a){const p=new th;for(let _=0;_<t.sections.length;_++){const b=t.sections[_];b.image?p.addImageSection(b):p.addTextSection(b,a)}return p}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let a="";for(let p=0;p<t.length;p++){const _=t.charCodeAt(p+1)||null,b=t.charCodeAt(p-1)||null;a+=_&&Sl(_)&&!kl[t[p+1]]||b&&Sl(b)&&!kl[t[p-1]]||!kl[t[p]]?t[p]:kl[t[p]]}return a}(this.text)}trim(){let t=0;for(let p=0;p<this.text.length&&hu[this.text.charCodeAt(p)];p++)t++;let a=this.text.length;for(let p=this.text.length-1;p>=0&&p>=t&&hu[this.text.charCodeAt(p)];p--)a--;this.text=this.text.substring(t,a),this.sectionIndex=this.sectionIndex.slice(t,a)}substring(t,a){const p=new th;return p.text=this.text.substring(t,a),p.sectionIndex=this.sectionIndex.slice(t,a),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,a)=>Math.max(t,this.sections[a].scale),0)}addTextSection(t,a){this.text+=t.text,this.sections.push(_c.forText(t.scale,t.fontStack||a));const p=this.sections.length-1;for(let _=0;_<t.text.length;++_)this.sectionIndex.push(p)}addImageSection(t){const a=t.image?t.image.name:"";if(a.length===0)return void ct("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(_c.forImage(a)),this.sectionIndex.push(this.sections.length-1)):ct("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Lh(i,t,a,p,_,b,I,P,R,O,V,j,K,Y,Q,se){const pe=th.fromFeature(i,_);let Ae;j===h.WritingMode.vertical&&pe.verticalizePunctuation();const{processBidirectionalText:Be,processStyledBidirectionalText:qe}=dn;if(Be&&pe.sections.length===1){Ae=[];const He=Be(pe.toString(),pp(pe,O,b,t,p,Y,Q));for(const Ct of He){const Tt=new th;Tt.text=Ct,Tt.sections=pe.sections;for(let ut=0;ut<Ct.length;ut++)Tt.sectionIndex.push(0);Ae.push(Tt)}}else if(qe){Ae=[];const He=qe(pe.text,pe.sectionIndex,pp(pe,O,b,t,p,Y,Q));for(const Ct of He){const Tt=new th;Tt.text=Ct[0],Tt.sectionIndex=Ct[1],Tt.sections=pe.sections,Ae.push(Tt)}}else Ae=function(He,Ct){const Tt=[],ut=He.text;let St=0;for(const mt of Ct)Tt.push(He.substring(St,mt)),St=mt;return St<ut.length&&Tt.push(He.substring(St,ut.length)),Tt}(pe,pp(pe,O,b,t,p,Y,Q));const Ge=[],it={positionedLines:Ge,text:pe.toString(),top:V[1],bottom:V[1],left:V[0],right:V[0],writingMode:j,iconsInText:!1,verticalizable:!1};return function(He,Ct,Tt,ut,St,mt,kt,dt,_t,ti,Yt,ki){let Mi=0,$i=eh,sr=0,kr=0;const zr=dt==="right"?1:dt==="left"?0:.5;let vr=0;for(const Wi of St){Wi.trim();const Yi=Wi.getMaxScale(),Vi=(Yi-1)*Do,on={positionedGlyphs:[],lineOffset:0};He.positionedLines[vr]=on;const en=on.positionedGlyphs;let hr=0;if(!Wi.length()){$i+=mt,++vr;continue}for(let Lr=0;Lr<Wi.length();Lr++){const hi=Wi.getSection(Lr),ro=Wi.getSectionIndex(Lr),cn=Wi.getCharCode(Lr);let Mn=0,Hr=null,Ro=null,go=null,Xa=Do;const ea=!(_t===h.WritingMode.horizontal||!Yt&&!pn(cn)||Yt&&(hu[cn]||(Br=cn,ri.Arabic(Br)||ri["Arabic Supplement"](Br)||ri["Arabic Extended-A"](Br)||ri["Arabic Presentation Forms-A"](Br)||ri["Arabic Presentation Forms-B"](Br))));if(hi.imageName){const ta=ut[hi.imageName];if(!ta)continue;go=hi.imageName,He.iconsInText=He.iconsInText||!0,Ro=ta.paddedRect;const no=ta.displaySize;hi.scale=hi.scale*Do/ki,Hr={width:no[0],height:no[1],left:1,top:-3,advance:ea?no[1]:no[0]},Mn=Vi+(Do-no[1]*hi.scale),Xa=Hr.advance;const Ka=ea?no[0]*hi.scale-Do*Yi:no[1]*hi.scale-Do*Yi;Ka>0&&Ka>hr&&(hr=Ka)}else{const ta=Tt[hi.fontStack],no=ta&&ta[cn];if(no&&no.rect)Ro=no.rect,Hr=no.metrics;else{const Ka=Ct[hi.fontStack],Wu=Ka&&Ka[cn];if(!Wu)continue;Hr=Wu.metrics}Mn=(Yi-hi.scale)*Do}ea?(He.verticalizable=!0,en.push({glyph:cn,imageName:go,x:Mi,y:$i+Mn,vertical:ea,scale:hi.scale,fontStack:hi.fontStack,sectionIndex:ro,metrics:Hr,rect:Ro}),Mi+=Xa*hi.scale+ti):(en.push({glyph:cn,imageName:go,x:Mi,y:$i+Mn,vertical:ea,scale:hi.scale,fontStack:hi.fontStack,sectionIndex:ro,metrics:Hr,rect:Ro}),Mi+=Hr.advance*hi.scale+ti)}en.length!==0&&(sr=Math.max(Mi-ti,sr),Wm(en,0,en.length-1,zr,hr)),Mi=0;const or=mt*Yi+hr;on.lineOffset=Math.max(hr,Vi),$i+=or,kr=Math.max(or,kr),++vr}var Br;const xr=$i-eh,{horizontalAlign:Or,verticalAlign:Oi}=dp(kt);(function(Wi,Yi,Vi,on,en,hr,or,Lr,hi){const ro=(Yi-Vi)*en;let cn=0;cn=hr!==or?-Lr*on-eh:(-on*hi+.5)*or;for(const Mn of Wi)for(const Hr of Mn.positionedGlyphs)Hr.x+=ro,Hr.y+=cn})(He.positionedLines,zr,Or,Oi,sr,kr,mt,xr,St.length),He.top+=-Oi*xr,He.bottom=He.top+xr,He.left+=-Or*sr,He.right=He.left+sr}(it,t,a,p,Ae,I,P,R,j,O,K,se),!function(He){for(const Ct of He)if(Ct.positionedGlyphs.length!==0)return!1;return!0}(Ge)&&it}const hu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},hd={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function pd(i,t,a,p,_,b){if(t.imageName){const I=p[t.imageName];return I?I.displaySize[0]*t.scale*Do/b+_:0}{const I=a[t.fontStack],P=I&&I[i];return P?P.metrics.advance*t.scale+_:0}}function dd(i,t,a,p){const _=Math.pow(i-t,2);return p?i<t?_/2:2*_:_+Math.abs(a)*a}function Hm(i,t,a){let p=0;return i===10&&(p-=1e4),a&&(p+=150),i!==40&&i!==65288||(p+=50),t!==41&&t!==65289||(p+=50),p}function fd(i,t,a,p,_,b){let I=null,P=dd(t,a,_,b);for(const R of p){const O=dd(t-R.x,a,_,b)+R.badness;O<=P&&(I=R,P=O)}return{index:i,x:t,priorBreak:I,badness:P}}function md(i){return i?md(i.priorBreak).concat(i.index):[]}function pp(i,t,a,p,_,b,I){if(b!=="point")return[];if(!i)return[];const P=[],R=function(K,Y,Q,se,pe,Ae){let Be=0;for(let qe=0;qe<K.length();qe++){const Ge=K.getSection(qe);Be+=pd(K.getCharCode(qe),Ge,se,pe,Y,Ae)}return Be/Math.max(1,Math.ceil(Be/Q))}(i,t,a,p,_,I),O=i.text.indexOf("\u200B")>=0;let V=0;for(let K=0;K<i.length();K++){const Y=i.getSection(K),Q=i.getCharCode(K);if(hu[Q]||(V+=pd(Q,Y,p,_,t,I)),K<i.length()-1){const se=!((j=Q)<11904||!(ri["Bopomofo Extended"](j)||ri.Bopomofo(j)||ri["CJK Compatibility Forms"](j)||ri["CJK Compatibility Ideographs"](j)||ri["CJK Compatibility"](j)||ri["CJK Radicals Supplement"](j)||ri["CJK Strokes"](j)||ri["CJK Symbols and Punctuation"](j)||ri["CJK Unified Ideographs Extension A"](j)||ri["CJK Unified Ideographs"](j)||ri["Enclosed CJK Letters and Months"](j)||ri["Halfwidth and Fullwidth Forms"](j)||ri.Hiragana(j)||ri["Ideographic Description Characters"](j)||ri["Kangxi Radicals"](j)||ri["Katakana Phonetic Extensions"](j)||ri.Katakana(j)||ri["Vertical Forms"](j)||ri["Yi Radicals"](j)||ri["Yi Syllables"](j)));(hd[Q]||se||Y.imageName)&&P.push(fd(K+1,V,R,P,Hm(Q,i.getCharCode(K+1),se&&O),!1))}}var j;return md(fd(i.length(),V,R,P,0,!0))}function dp(i){let t=.5,a=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function Wm(i,t,a,p,_){if(!p&&!_)return;const b=i[a],I=(i[a].x+b.metrics.advance*b.scale)*p;for(let P=t;P<=a;P++)i[P].x-=I,i[P].y+=_}function Xm(i,t,a){const{horizontalAlign:p,verticalAlign:_}=dp(a),b=t[0]-i.displaySize[0]*p,I=t[1]-i.displaySize[1]*_;return{image:i,top:I,bottom:I+i.displaySize[1],left:b,right:b+i.displaySize[0]}}function yd(i,t,a,p,_,b){const I=i.image;let P;if(I.content){const pe=I.content,Ae=I.pixelRatio||1;P=[pe[0]/Ae,pe[1]/Ae,I.displaySize[0]-pe[2]/Ae,I.displaySize[1]-pe[3]/Ae]}const R=t.left*b,O=t.right*b;let V,j,K,Y;a==="width"||a==="both"?(Y=_[0]+R-p[3],j=_[0]+O+p[1]):(Y=_[0]+(R+O-I.displaySize[0])/2,j=Y+I.displaySize[0]);const Q=t.top*b,se=t.bottom*b;return a==="height"||a==="both"?(V=_[1]+Q-p[0],K=_[1]+se+p[2]):(V=_[1]+(Q+se-I.displaySize[1])/2,K=V+I.displaySize[1]),{image:I,top:V,right:j,bottom:K,left:Y,collisionPadding:P}}const zl=128;function Dh(i,t){const{expression:a}=t;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new rn(i+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:_}=a;let b=0;for(;b<p.length&&p[b]<=i;)b++;b=Math.max(0,b-1);let I=b;for(;I<p.length&&p[I]<i+1;)I++;I=Math.min(p.length-1,I);const P=p[b],R=p[I];return a.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:R,interpolationType:_}:{kind:"camera",minZoom:P,maxZoom:R,minSize:a.evaluate(new rn(P)),maxSize:a.evaluate(new rn(R)),interpolationType:_}}}class pu extends bt{constructor(t,a,p,_){super(t,a),this.angle=p,_!==void 0&&(this.segment=_)}clone(){return new pu(this.x,this.y,this.angle,this.segment)}}function Rh(i,t,a,p,_){if(t.segment===void 0)return!0;let b=t,I=t.segment+1,P=0;for(;P>-a/2;){if(I--,I<0)return!1;P-=i[I].dist(b),b=i[I]}P+=i[I].dist(i[I+1]),I++;const R=[];let O=0;for(;P<a/2;){const V=i[I],j=i[I+1];if(!j)return!1;let K=i[I-1].angleTo(V)-V.angleTo(j);for(K=Math.abs((K+3*Math.PI)%(2*Math.PI)-Math.PI),R.push({distance:P,angleDelta:K}),O+=K;P-R[0].distance>p;)O-=R.shift().angleDelta;if(O>_)return!1;I++,P+=V.dist(j)}return!0}function Bh(i){let t=0;for(let a=0;a<i.length-1;a++)t+=i[a].dist(i[a+1]);return t}function Oh(i,t,a){return i?.6*t*a:0}function vc(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function Km(i,t,a,p,_,b){const I=Oh(a,_,b),P=vc(a,p)*b;let R=0;const O=Bh(i)/2;for(let V=0;V<i.length-1;V++){const j=i[V],K=i[V+1],Y=j.dist(K);if(R+Y>O){const Q=(O-R)/Y,se=Nn(j.x,K.x,Q),pe=Nn(j.y,K.y,Q),Ae=new pu(se,pe,K.angleTo(j),V);return Ae._round(),!I||Rh(i,Ae,P,I,t)?Ae:void 0}R+=Y}}function Jm(i,t,a,p,_,b,I,P,R){const O=Oh(p,b,I),V=vc(p,_),j=V*I,K=i[0].x===0||i[0].x===R||i[0].y===0||i[0].y===R;return t-j<t/4&&(t=j+t/4),pf(i,K?t/2*P%t:(V/2+2*b)*I*P%t,t,O,a,j,K,!1,R)}function pf(i,t,a,p,_,b,I,P,R){const O=b/2,V=Bh(i);let j=0,K=t-a,Y=[];for(let Q=0;Q<i.length-1;Q++){const se=i[Q],pe=i[Q+1],Ae=se.dist(pe),Be=pe.angleTo(se);for(;K+a<j+Ae;){K+=a;const qe=(K-j)/Ae,Ge=Nn(se.x,pe.x,qe),it=Nn(se.y,pe.y,qe);if(Ge>=0&&Ge<R&&it>=0&&it<R&&K-O>=0&&K+O<=V){const He=new pu(Ge,it,Be,Q);He._round(),p&&!Rh(i,He,b,p,_)||Y.push(He)}}j+=Ae}return P||Y.length||I||(Y=pf(i,j/2,a,p,_,b,I,!0,R)),Y}function xc(i,t,a,p,_){const b=[];for(let I=0;I<i.length;I++){const P=i[I];let R;for(let O=0;O<P.length-1;O++){let V=P[O],j=P[O+1];V.x<t&&j.x<t||(V.x<t?V=new bt(t,V.y+(t-V.x)/(j.x-V.x)*(j.y-V.y))._round():j.x<t&&(j=new bt(t,V.y+(t-V.x)/(j.x-V.x)*(j.y-V.y))._round()),V.y<a&&j.y<a||(V.y<a?V=new bt(V.x+(a-V.y)/(j.y-V.y)*(j.x-V.x),a)._round():j.y<a&&(j=new bt(V.x+(a-V.y)/(j.y-V.y)*(j.x-V.x),a)._round()),V.x>=p&&j.x>=p||(V.x>=p?V=new bt(p,V.y+(p-V.x)/(j.x-V.x)*(j.y-V.y))._round():j.x>=p&&(j=new bt(p,V.y+(p-V.x)/(j.x-V.x)*(j.y-V.y))._round()),V.y>=_&&j.y>=_||(V.y>=_?V=new bt(V.x+(_-V.y)/(j.y-V.y)*(j.x-V.x),_)._round():j.y>=_&&(j=new bt(V.x+(_-V.y)/(j.y-V.y)*(j.x-V.x),_)._round()),R&&V.equals(R[R.length-1])||(R=[V],b.push(R)),R.push(j)))))}}return b}function fp(i,t,a,p){const _=[],b=i.image,I=b.pixelRatio,P=b.paddedRect.w-2,R=b.paddedRect.h-2,O=i.right-i.left,V=i.bottom-i.top,j=b.stretchX||[[0,P]],K=b.stretchY||[[0,R]],Y=(mt,kt)=>mt+kt[1]-kt[0],Q=j.reduce(Y,0),se=K.reduce(Y,0),pe=P-Q,Ae=R-se;let Be=0,qe=Q,Ge=0,it=se,He=0,Ct=pe,Tt=0,ut=Ae;if(b.content&&p){const mt=b.content;Be=Fh(j,0,mt[0]),Ge=Fh(K,0,mt[1]),qe=Fh(j,mt[0],mt[2]),it=Fh(K,mt[1],mt[3]),He=mt[0]-Be,Tt=mt[1]-Ge,Ct=mt[2]-mt[0]-qe,ut=mt[3]-mt[1]-it}const St=(mt,kt,dt,_t)=>{const ti=Uh(mt.stretch-Be,qe,O,i.left),Yt=Nh(mt.fixed-He,Ct,mt.stretch,Q),ki=Uh(kt.stretch-Ge,it,V,i.top),Mi=Nh(kt.fixed-Tt,ut,kt.stretch,se),$i=Uh(dt.stretch-Be,qe,O,i.left),sr=Nh(dt.fixed-He,Ct,dt.stretch,Q),kr=Uh(_t.stretch-Ge,it,V,i.top),zr=Nh(_t.fixed-Tt,ut,_t.stretch,se),vr=new bt(ti,ki),Br=new bt($i,ki),xr=new bt($i,kr),Or=new bt(ti,kr),Oi=new bt(Yt/I,Mi/I),Wi=new bt(sr/I,zr/I),Yi=t*Math.PI/180;if(Yi){const en=Math.sin(Yi),hr=Math.cos(Yi),or=[hr,-en,en,hr];vr._matMult(or),Br._matMult(or),Or._matMult(or),xr._matMult(or)}const Vi=mt.stretch+mt.fixed,on=kt.stretch+kt.fixed;return{tl:vr,tr:Br,bl:Or,br:xr,tex:{x:b.paddedRect.x+1+Vi,y:b.paddedRect.y+1+on,w:dt.stretch+dt.fixed-Vi,h:_t.stretch+_t.fixed-on},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Oi,pixelOffsetBR:Wi,minFontScaleX:Ct/I/O,minFontScaleY:ut/I/V,isSDF:a}};if(p&&(b.stretchX||b.stretchY)){const mt=mp(j,pe,Q),kt=mp(K,Ae,se);for(let dt=0;dt<mt.length-1;dt++){const _t=mt[dt],ti=mt[dt+1];for(let Yt=0;Yt<kt.length-1;Yt++)_.push(St(_t,kt[Yt],ti,kt[Yt+1]))}}else _.push(St({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:R+1}));return _}function Fh(i,t,a){let p=0;for(const _ of i)p+=Math.max(t,Math.min(a,_[1]))-Math.max(t,Math.min(a,_[0]));return p}function mp(i,t,a){const p=[{fixed:-1,stretch:0}];for(const[_,b]of i){const I=p[p.length-1];p.push({fixed:_-I.stretch,stretch:I.stretch}),p.push({fixed:_-I.stretch,stretch:I.stretch+(b-_)})}return p.push({fixed:t+1,stretch:a}),p}function Uh(i,t,a,p){return i/t*a+p}function Nh(i,t,a,p){return i-t*a/p}Jt("Anchor",pu);class yp{constructor(t,a,p,_,b,I,P,R,O,V){if(this.boxStartIndex=t.length,O){let j=I.top,K=I.bottom;const Y=I.collisionPadding;Y&&(j-=Y[1],K+=Y[3]);let Q=K-j;Q>0&&(Q=Math.max(10,Q),this.circleDiameter=Q)}else{let j=I.top*P-R,K=I.bottom*P+R,Y=I.left*P-R,Q=I.right*P+R;const se=I.collisionPadding;if(se&&(Y-=se[0]*P,j-=se[1]*P,Q+=se[2]*P,K+=se[3]*P),V){const pe=new bt(Y,j),Ae=new bt(Q,j),Be=new bt(Y,K),qe=new bt(Q,K),Ge=V*Math.PI/180;pe._rotate(Ge),Ae._rotate(Ge),Be._rotate(Ge),qe._rotate(Ge),Y=Math.min(pe.x,Ae.x,Be.x,qe.x),Q=Math.max(pe.x,Ae.x,Be.x,qe.x),j=Math.min(pe.y,Ae.y,Be.y,qe.y),K=Math.max(pe.y,Ae.y,Be.y,qe.y)}t.emplaceBack(a.x,a.y,Y,j,Q,K,p,_,b)}this.boxEndIndex=t.length}}class $m{constructor(t=[],a=Ym){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:a,compare:p}=this,_=a[t];for(;t>0;){const b=t-1>>1,I=a[b];if(p(_,I)>=0)break;a[t]=I,t=b}a[t]=_}_down(t){const{data:a,compare:p}=this,_=this.length>>1,b=a[t];for(;t<_;){let I=1+(t<<1),P=a[I];const R=I+1;if(R<this.length&&p(a[R],P)<0&&(I=R,P=a[R]),p(P,b)>=0)break;a[t]=P,t=I}a[t]=b}}function Ym(i,t){return i<t?-1:i>t?1:0}function gp(i,t=1,a=!1){let p=1/0,_=1/0,b=-1/0,I=-1/0;const P=i[0];for(let Y=0;Y<P.length;Y++){const Q=P[Y];(!Y||Q.x<p)&&(p=Q.x),(!Y||Q.y<_)&&(_=Q.y),(!Y||Q.x>b)&&(b=Q.x),(!Y||Q.y>I)&&(I=Q.y)}const R=Math.min(b-p,I-_);let O=R/2;const V=new $m([],gd);if(R===0)return new bt(p,_);for(let Y=p;Y<b;Y+=R)for(let Q=_;Q<I;Q+=R)V.push(new ih(Y+O,Q+O,O,i));let j=function(Y){let Q=0,se=0,pe=0;const Ae=Y[0];for(let Be=0,qe=Ae.length,Ge=qe-1;Be<qe;Ge=Be++){const it=Ae[Be],He=Ae[Ge],Ct=it.x*He.y-He.x*it.y;se+=(it.x+He.x)*Ct,pe+=(it.y+He.y)*Ct,Q+=3*Ct}return new ih(se/Q,pe/Q,0,Y)}(i),K=V.length;for(;V.length;){const Y=V.pop();(Y.d>j.d||!j.d)&&(j=Y,a&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,K)),Y.max-j.d<=t||(O=Y.h/2,V.push(new ih(Y.p.x-O,Y.p.y-O,O,i)),V.push(new ih(Y.p.x+O,Y.p.y-O,O,i)),V.push(new ih(Y.p.x-O,Y.p.y+O,O,i)),V.push(new ih(Y.p.x+O,Y.p.y+O,O,i)),K+=4)}return a&&(console.log(`num probes: ${K}`),console.log(`best distance: ${j.d}`)),j.p}function gd(i,t){return t.max-i.max}function ih(i,t,a,p){this.p=new bt(i,t),this.h=a,this.d=function(_,b){let I=!1,P=1/0;for(let R=0;R<b.length;R++){const O=b[R];for(let V=0,j=O.length,K=j-1;V<j;K=V++){const Y=O[V],Q=O[K];Y.y>_.y!=Q.y>_.y&&_.x<(Q.x-Y.x)*(_.y-Y.y)/(Q.y-Y.y)+Y.x&&(I=!I),P=Math.min(P,ms(_,Y,Q))}}return(I?1:-1)*Math.sqrt(P)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}const ju=Number.POSITIVE_INFINITY;function rh(i,t){return t[1]!==ju?function(a,p,_){let b=0,I=0;switch(p=Math.abs(p),_=Math.abs(_),a){case"top-right":case"top-left":case"top":I=_-7;break;case"bottom-right":case"bottom-left":case"bottom":I=7-_}switch(a){case"top-right":case"bottom-right":case"right":b=-p;break;case"top-left":case"bottom-left":case"left":b=p}return[b,I]}(i,t[0],t[1]):function(a,p){let _=0,b=0;p<0&&(p=0);const I=p/Math.sqrt(2);switch(a){case"top-right":case"top-left":b=I-7;break;case"bottom-right":case"bottom-left":b=7-I;break;case"bottom":b=7-p;break;case"top":b=p-7}switch(a){case"top-right":case"bottom-right":_=-I;break;case"top-left":case"bottom-left":_=I;break;case"left":_=p;break;case"right":_=-p}return[_,b]}(i,t[0])}function Zr(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Qm(i,t,a,p,_,b,I,P,R,O,V){let j=b.textMaxSize.evaluate(t,{});j===void 0&&(j=I);const K=i.layers[0].layout,Y=K.get("icon-offset").evaluate(t,{},V),Q=df(a.horizontal),se=I/24,pe=i.tilePixelRatio*se,Ae=i.tilePixelRatio*j/24,Be=i.tilePixelRatio*P,qe=i.tilePixelRatio*K.get("symbol-spacing"),Ge=K.get("text-padding")*i.tilePixelRatio,it=K.get("icon-padding")*i.tilePixelRatio,He=K.get("text-max-angle")/180*Math.PI,Ct=K.get("text-rotation-alignment")!=="viewport"&&K.get("symbol-placement")!=="point",Tt=K.get("icon-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",ut=K.get("symbol-placement"),St=qe/2,mt=K.get("icon-text-fit");let kt;p&&mt!=="none"&&(i.allowVerticalPlacement&&a.vertical&&(kt=yd(p,a.vertical,mt,K.get("icon-text-fit-padding"),Y,se)),Q&&(p=yd(p,Q,mt,K.get("icon-text-fit-padding"),Y,se)));const dt=(_t,ti)=>{ti.x<0||ti.x>=ur||ti.y<0||ti.y>=ur||function(Yt,ki,Mi,$i,sr,kr,zr,vr,Br,xr,Or,Oi,Wi,Yi,Vi,on,en,hr,or,Lr,hi,ro,cn,Mn,Hr){const Ro=Yt.addToLineVertexArray(ki,Mi);let go,Xa,ea,ta,no=0,Ka=0,Wu=0,Ic=0,Sc=-1,sh=-1;const Bs={};let Ml=Dt(""),Tc=0,Xu=0;if(vr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Tc,Xu]=vr.layout.get("text-offset").evaluate(hi,{},Mn).map(ia=>ia*Do):(Tc=vr.layout.get("text-radial-offset").evaluate(hi,{},Mn)*Do,Xu=ju),Yt.allowVerticalPlacement&&$i.vertical){const ia=vr.layout.get("text-rotate").evaluate(hi,{},Mn)+90;ea=new yp(Br,ki,xr,Or,Oi,$i.vertical,Wi,Yi,Vi,ia),zr&&(ta=new yp(Br,ki,xr,Or,Oi,zr,en,hr,Vi,ia))}if(sr){const ia=vr.layout.get("icon-rotate").evaluate(hi,{}),Ma=vr.layout.get("icon-text-fit")!=="none",mu=fp(sr,ia,cn,Ma),sl=zr?fp(zr,ia,cn,Ma):void 0;Xa=new yp(Br,ki,xr,Or,Oi,sr,en,hr,!1,ia),no=4*mu.length;const uh=Yt.iconSizeData;let Os=null;uh.kind==="source"?(Os=[zl*vr.layout.get("icon-size").evaluate(hi,{})],Os[0]>Pl&&ct(`${Yt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):uh.kind==="composite"&&(Os=[zl*ro.compositeIconSizes[0].evaluate(hi,{},Mn),zl*ro.compositeIconSizes[1].evaluate(hi,{},Mn)],(Os[0]>Pl||Os[1]>Pl)&&ct(`${Yt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Yt.addSymbols(Yt.icon,mu,Os,Lr,or,hi,h.WritingMode.none,ki,Ro.lineStartIndex,Ro.lineLength,-1,Mn),Sc=Yt.icon.placedSymbolArray.length-1,sl&&(Ka=4*sl.length,Yt.addSymbols(Yt.icon,sl,Os,Lr,or,hi,h.WritingMode.vertical,ki,Ro.lineStartIndex,Ro.lineLength,-1,Mn),sh=Yt.icon.placedSymbolArray.length-1)}const fu=Object.keys($i.horizontal);for(const ia of fu){const Ma=$i.horizontal[ia];if(!go){Ml=Dt(Ma.text);const sl=vr.layout.get("text-rotate").evaluate(hi,{},Mn);go=new yp(Br,ki,xr,Or,Oi,Ma,Wi,Yi,Vi,sl)}const mu=Ma.positionedLines.length===1;if(Wu+=bc(Yt,ki,Ma,kr,vr,Vi,hi,on,Ro,$i.vertical?h.WritingMode.horizontal:h.WritingMode.horizontalOnly,mu?fu:[ia],Bs,Sc,ro,Mn),mu)break}$i.vertical&&(Ic+=bc(Yt,ki,$i.vertical,kr,vr,Vi,hi,on,Ro,h.WritingMode.vertical,["vertical"],Bs,sh,ro,Mn));const lh=go?go.boxStartIndex:Yt.collisionBoxArray.length,Ep=go?go.boxEndIndex:Yt.collisionBoxArray.length,Ip=ea?ea.boxStartIndex:Yt.collisionBoxArray.length,Vh=ea?ea.boxEndIndex:Yt.collisionBoxArray.length,qh=Xa?Xa.boxStartIndex:Yt.collisionBoxArray.length,Sp=Xa?Xa.boxEndIndex:Yt.collisionBoxArray.length,Gh=ta?ta.boxStartIndex:Yt.collisionBoxArray.length,Zh=ta?ta.boxEndIndex:Yt.collisionBoxArray.length;let Pa=-1;const Ac=(ia,Ma)=>ia&&ia.circleDiameter?Math.max(ia.circleDiameter,Ma):Ma;Pa=Ac(go,Pa),Pa=Ac(ea,Pa),Pa=Ac(Xa,Pa),Pa=Ac(ta,Pa);const Cc=Pa>-1?1:0;Cc&&(Pa*=Hr/Do),Yt.glyphOffsetArray.length>=wc.MAX_GLYPHS&&ct("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),hi.sortKey!==void 0&&Yt.addToSortKeyRanges(Yt.symbolInstances.length,hi.sortKey),Yt.symbolInstances.emplaceBack(ki.x,ki.y,Bs.right>=0?Bs.right:-1,Bs.center>=0?Bs.center:-1,Bs.left>=0?Bs.left:-1,Bs.vertical||-1,Sc,sh,Ml,lh,Ep,Ip,Vh,qh,Sp,Gh,Zh,xr,Wu,Ic,no,Ka,Cc,0,Wi,Tc,Xu,Pa)}(i,ti,_t,a,p,_,kt,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,pe,Ge,Ct,R,Be,it,Tt,Y,t,b,O,V,I)};if(ut==="line")for(const _t of xc(t.geometry,0,0,ur,ur)){const ti=Jm(_t,qe,He,a.vertical||Q,p,24,Ae,i.overscaling,ur);for(const Yt of ti){const ki=Q;ki&&ey(i,ki.text,St,Yt)||dt(_t,Yt)}}else if(ut==="line-center"){for(const _t of t.geometry)if(_t.length>1){const ti=Km(_t,He,a.vertical||Q,p,24,Ae);ti&&dt(_t,ti)}}else if(t.type==="Polygon")for(const _t of kh(t.geometry,0)){const ti=gp(_t,16);dt(_t[0],new pu(ti.x,ti.y,0))}else if(t.type==="LineString")for(const _t of t.geometry)dt(_t,new pu(_t[0].x,_t[0].y,0));else if(t.type==="Point")for(const _t of t.geometry)for(const ti of _t)dt([ti],new pu(ti.x,ti.y,0))}const Pl=32640;function bc(i,t,a,p,_,b,I,P,R,O,V,j,K,Y,Q){const se=function(Be,qe,Ge,it,He,Ct,Tt,ut){const St=it.layout.get("text-rotate").evaluate(Ct,{})*Math.PI/180,mt=[];for(const kt of qe.positionedLines)for(const dt of kt.positionedGlyphs){if(!dt.rect)continue;const _t=dt.rect||{};let ti=4,Yt=!0,ki=1,Mi=0;const $i=(He||ut)&&dt.vertical,sr=dt.metrics.advance*dt.scale/2;if(ut&&qe.verticalizable){const or=(dt.scale-1)*Do,Lr=(Do-dt.metrics.width*dt.scale)/2;Mi=kt.lineOffset/2-(dt.imageName?-Lr:or)}if(dt.imageName){const or=Tt[dt.imageName];Yt=or.sdf,ki=or.pixelRatio,ti=1/ki}const kr=He?[dt.x+sr,dt.y]:[0,0];let zr=He?[0,0]:[dt.x+sr+Ge[0],dt.y+Ge[1]-Mi],vr=[0,0];$i&&(vr=zr,zr=[0,0]);const Br=(dt.metrics.left-ti)*dt.scale-sr+zr[0],xr=(-dt.metrics.top-ti)*dt.scale+zr[1],Or=Br+_t.w*dt.scale/ki,Oi=xr+_t.h*dt.scale/ki,Wi=new bt(Br,xr),Yi=new bt(Or,xr),Vi=new bt(Br,Oi),on=new bt(Or,Oi);if($i){const or=new bt(-sr,sr-eh),Lr=-Math.PI/2,hi=12-sr,ro=new bt(22-hi,-(dt.imageName?hi:0)),cn=new bt(...vr);Wi._rotateAround(Lr,or)._add(ro)._add(cn),Yi._rotateAround(Lr,or)._add(ro)._add(cn),Vi._rotateAround(Lr,or)._add(ro)._add(cn),on._rotateAround(Lr,or)._add(ro)._add(cn)}if(St){const or=Math.sin(St),Lr=Math.cos(St),hi=[Lr,-or,or,Lr];Wi._matMult(hi),Yi._matMult(hi),Vi._matMult(hi),on._matMult(hi)}const en=new bt(0,0),hr=new bt(0,0);mt.push({tl:Wi,tr:Yi,bl:Vi,br:on,tex:_t,writingMode:qe.writingMode,glyphOffset:kr,sectionIndex:dt.sectionIndex,isSDF:Yt,pixelOffsetTL:en,pixelOffsetBR:hr,minFontScaleX:0,minFontScaleY:0})}return mt}(0,a,P,_,b,I,p,i.allowVerticalPlacement),pe=i.textSizeData;let Ae=null;pe.kind==="source"?(Ae=[zl*_.layout.get("text-size").evaluate(I,{})],Ae[0]>Pl&&ct(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):pe.kind==="composite"&&(Ae=[zl*Y.compositeTextSizes[0].evaluate(I,{},Q),zl*Y.compositeTextSizes[1].evaluate(I,{},Q)],(Ae[0]>Pl||Ae[1]>Pl)&&ct(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,se,Ae,P,b,I,O,t,R.lineStartIndex,R.lineLength,K,Q);for(const Be of V)j[Be]=i.text.placedSymbolArray.length-1;return 4*se.length}function df(i){for(const t in i)return i[t];return null}function ey(i,t,a,p){const _=i.compareText;if(t in _){const b=_[t];for(let I=b.length-1;I>=0;I--)if(p.dist(b[I])<a)return!0}else _[t]=[];return _[t].push(p),!1}const ty=Uu.VectorTileFeature.types,iy=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function _p(i,t,a,p,_,b,I,P,R,O,V,j,K){const Y=P?Math.min(Pl,Math.round(P[0])):0,Q=P?Math.min(Pl,Math.round(P[1])):0;i.emplaceBack(t,a,Math.round(32*p),Math.round(32*_),b,I,(Y<<1)+(R?1:0),Q,16*O,16*V,256*j,256*K)}function _d(i,t,a){i.emplaceBack(t.x,t.y,a),i.emplaceBack(t.x,t.y,a),i.emplaceBack(t.x,t.y,a),i.emplaceBack(t.x,t.y,a)}function ry(i){for(const t of i.sections)if(oi(t.text))return!0;return!1}class vp{constructor(t){this.layoutVertexArray=new q,this.indexArray=new me,this.programConfigurations=t,this.segments=new xe,this.dynamicLayoutVertexArray=new $,this.opacityVertexArray=new ie,this.placedSymbolArray=new Pt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,a,p,_){this.isEmpty()||(p&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,tf.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,rf.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,iy,!0),this.opacityVertexBuffer.itemSize=1),(p||_)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Jt("SymbolBuffers",vp);class xp{constructor(t,a,p){this.layoutVertexArray=new t,this.layoutAttributes=a,this.indexArray=new p,this.segments=new xe,this.collisionVertexArray=new de}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,up.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Jt("CollisionBuffers",xp);class wc{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(I=>I.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ou([]),this.placementViewportMatrix=Ou([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Dh(this.zoom,a["text-size"]),this.iconSizeData=Dh(this.zoom,a["icon-size"]);const p=this.layers[0].layout,_=p.get("symbol-sort-key"),b=p.get("symbol-z-order");this.canOverlap=qu(p,"text-overlap","text-allow-overlap")!=="never"||qu(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!_.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(I=>h.WritingMode[I])),this.stateDependentLayerIds=this.layers.filter(I=>I.isStateDependent()).map(I=>I.id),this.sourceID=t.sourceID}createArrays(){this.text=new vp(new On(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new vp(new On(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new pi,this.lineVertexArray=new ei,this.symbolInstances=new wt}calculateGlyphDependencies(t,a,p,_,b){for(let I=0;I<t.length;I++)if(a[t.charCodeAt(I)]=!0,(p||_)&&b){const P=kl[t.charAt(I)];P&&(a[P.charCodeAt(0)]=!0)}}populate(t,a,p){const _=this.layers[0],b=_.layout,I=b.get("text-font"),P=b.get("text-field"),R=b.get("icon-image"),O=(P.value.kind!=="constant"||P.value.value instanceof _e&&!P.value.value.isEmpty()||P.value.value.toString().length>0)&&(I.value.kind!=="constant"||I.value.value.length>0),V=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,j=b.get("symbol-sort-key");if(this.features=[],!O&&!V)return;const K=a.iconDependencies,Y=a.glyphDependencies,Q=a.availableImages,se=new rn(this.zoom);for(const{feature:pe,id:Ae,index:Be,sourceLayerIndex:qe}of t){const Ge=_._featureFilter.needGeometry,it=Yn(pe,Ge);if(!_._featureFilter.filter(se,it,p))continue;let He,Ct;if(Ge||(it.geometry=xa(pe)),O){const ut=_.getValueAndResolveTokens("text-field",it,p,Q),St=_e.factory(ut);ry(St)&&(this.hasRTLText=!0),(!this.hasRTLText||tu()==="unavailable"||this.hasRTLText&&dn.isParsed())&&(He=su(St,_,it))}if(V){const ut=_.getValueAndResolveTokens("icon-image",it,p,Q);Ct=ut instanceof fe?ut:fe.fromString(ut)}if(!He&&!Ct)continue;const Tt=this.sortFeaturesByKey?j.evaluate(it,{},p):void 0;if(this.features.push({id:Ae,text:He,icon:Ct,index:Be,sourceLayerIndex:qe,geometry:it.geometry,properties:pe.properties,type:ty[pe.type],sortKey:Tt}),Ct&&(K[Ct.name]=!0),He){const ut=I.evaluate(it,{},p).join(","),St=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(h.WritingMode.vertical)>=0;for(const mt of He.sections)if(mt.image)K[mt.image.name]=!0;else{const kt=el(He.toString()),dt=mt.fontStack||ut,_t=Y[dt]=Y[dt]||{};this.calculateGlyphDependencies(mt.text,_t,St,this.allowVerticalPlacement,kt)}}}b.get("symbol-placement")==="line"&&(this.features=function(pe){const Ae={},Be={},qe=[];let Ge=0;function it(ut){qe.push(pe[ut]),Ge++}function He(ut,St,mt){const kt=Be[ut];return delete Be[ut],Be[St]=kt,qe[kt].geometry[0].pop(),qe[kt].geometry[0]=qe[kt].geometry[0].concat(mt[0]),kt}function Ct(ut,St,mt){const kt=Ae[St];return delete Ae[St],Ae[ut]=kt,qe[kt].geometry[0].shift(),qe[kt].geometry[0]=mt[0].concat(qe[kt].geometry[0]),kt}function Tt(ut,St,mt){const kt=mt?St[0][St[0].length-1]:St[0][0];return`${ut}:${kt.x}:${kt.y}`}for(let ut=0;ut<pe.length;ut++){const St=pe[ut],mt=St.geometry,kt=St.text?St.text.toString():null;if(!kt){it(ut);continue}const dt=Tt(kt,mt),_t=Tt(kt,mt,!0);if(dt in Be&&_t in Ae&&Be[dt]!==Ae[_t]){const ti=Ct(dt,_t,mt),Yt=He(dt,_t,qe[ti].geometry);delete Ae[dt],delete Be[_t],Be[Tt(kt,qe[Yt].geometry,!0)]=Yt,qe[ti].geometry=null}else dt in Be?He(dt,_t,mt):_t in Ae?Ct(dt,_t,mt):(it(ut),Ae[dt]=Ge-1,Be[_t]=Ge-1)}return qe.filter(ut=>ut.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((pe,Ae)=>pe.sortKey-Ae.sortKey)}update(t,a,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,a,this.layers,p),this.icon.programConfigurations.updatePaintArrays(t,a,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,a){const p=this.lineVertexArray.length;if(t.segment!==void 0){let _=t.dist(a[t.segment+1]),b=t.dist(a[t.segment]);const I={};for(let P=t.segment+1;P<a.length;P++)I[P]={x:a[P].x,y:a[P].y,tileUnitDistanceFromAnchor:_},P<a.length-1&&(_+=a[P+1].dist(a[P]));for(let P=t.segment||0;P>=0;P--)I[P]={x:a[P].x,y:a[P].y,tileUnitDistanceFromAnchor:b},P>0&&(b+=a[P-1].dist(a[P]));for(let P=0;P<a.length;P++){const R=I[P];this.lineVertexArray.emplaceBack(R.x,R.y,R.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(t,a,p,_,b,I,P,R,O,V,j,K){const Y=t.indexArray,Q=t.layoutVertexArray,se=t.segments.prepareSegment(4*a.length,Q,Y,this.canOverlap?I.sortKey:void 0),pe=this.glyphOffsetArray.length,Ae=se.vertexLength,Be=this.allowVerticalPlacement&&P===h.WritingMode.vertical?Math.PI/2:0,qe=I.text&&I.text.sections;for(let Ge=0;Ge<a.length;Ge++){const{tl:it,tr:He,bl:Ct,br:Tt,tex:ut,pixelOffsetTL:St,pixelOffsetBR:mt,minFontScaleX:kt,minFontScaleY:dt,glyphOffset:_t,isSDF:ti,sectionIndex:Yt}=a[Ge],ki=se.vertexLength,Mi=_t[1];_p(Q,R.x,R.y,it.x,Mi+it.y,ut.x,ut.y,p,ti,St.x,St.y,kt,dt),_p(Q,R.x,R.y,He.x,Mi+He.y,ut.x+ut.w,ut.y,p,ti,mt.x,St.y,kt,dt),_p(Q,R.x,R.y,Ct.x,Mi+Ct.y,ut.x,ut.y+ut.h,p,ti,St.x,mt.y,kt,dt),_p(Q,R.x,R.y,Tt.x,Mi+Tt.y,ut.x+ut.w,ut.y+ut.h,p,ti,mt.x,mt.y,kt,dt),_d(t.dynamicLayoutVertexArray,R,Be),Y.emplaceBack(ki,ki+1,ki+2),Y.emplaceBack(ki+1,ki+2,ki+3),se.vertexLength+=4,se.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(_t[0]),Ge!==a.length-1&&Yt===a[Ge+1].sectionIndex||t.programConfigurations.populatePaintArrays(Q.length,I,I.index,{},K,qe&&qe[Yt])}t.placedSymbolArray.emplaceBack(R.x,R.y,pe,this.glyphOffsetArray.length-pe,Ae,O,V,R.segment,p?p[0]:0,p?p[1]:0,_[0],_[1],P,0,!1,0,j)}_addCollisionDebugVertex(t,a,p,_,b,I){return a.emplaceBack(0,0),t.emplaceBack(p.x,p.y,_,b,Math.round(I.x),Math.round(I.y))}addCollisionDebugVertices(t,a,p,_,b,I,P){const R=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),O=R.vertexLength,V=b.layoutVertexArray,j=b.collisionVertexArray,K=P.anchorX,Y=P.anchorY;this._addCollisionDebugVertex(V,j,I,K,Y,new bt(t,a)),this._addCollisionDebugVertex(V,j,I,K,Y,new bt(p,a)),this._addCollisionDebugVertex(V,j,I,K,Y,new bt(p,_)),this._addCollisionDebugVertex(V,j,I,K,Y,new bt(t,_)),R.vertexLength+=4;const Q=b.indexArray;Q.emplaceBack(O,O+1),Q.emplaceBack(O+1,O+2),Q.emplaceBack(O+2,O+3),Q.emplaceBack(O+3,O),R.primitiveLength+=4}addDebugCollisionBoxes(t,a,p,_){for(let b=t;b<a;b++){const I=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(I.x1,I.y1,I.x2,I.y2,_?this.textCollisionBox:this.iconCollisionBox,I.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new xp(he,nn.members,Ce),this.iconCollisionBox=new xp(he,nn.members,Ce);for(let t=0;t<this.symbolInstances.length;t++){const a=this.symbolInstances.get(t);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(t,a,p,_,b,I,P,R,O){const V={};for(let j=a;j<p;j++){const K=t.get(j);V.textBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},V.textFeatureIndex=K.featureIndex;break}for(let j=_;j<b;j++){const K=t.get(j);V.verticalTextBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},V.verticalTextFeatureIndex=K.featureIndex;break}for(let j=I;j<P;j++){const K=t.get(j);V.iconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},V.iconFeatureIndex=K.featureIndex;break}for(let j=R;j<O;j++){const K=t.get(j);V.verticalIconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},V.verticalIconFeatureIndex=K.featureIndex;break}return V}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const p=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,a){const p=t.placedSymbolArray.get(a),_=p.vertexStartIndex+4*p.numGlyphs;for(let b=p.vertexStartIndex;b<_;b+=4)t.indexArray.emplaceBack(b,b+1,b+2),t.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(t),p=Math.cos(t),_=[],b=[],I=[];for(let P=0;P<this.symbolInstances.length;++P){I.push(P);const R=this.symbolInstances.get(P);_.push(0|Math.round(a*R.anchorX+p*R.anchorY)),b.push(R.featureIndex)}return I.sort((P,R)=>_[P]-_[R]||b[R]-b[P]),I}addToSortKeyRanges(t,a){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===a?p.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const p=this.symbolInstances.get(a);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((_,b,I)=>{_>=0&&I.indexOf(_)===b&&this.addIndicesForPlacedSymbol(this.text,_)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Jt("SymbolBucket",wc,{omit:["layers","collisionBoxArray","features","compareText"]}),wc.MAX_GLYPHS=65535,wc.addDynamicAttributes=_d;const ff=new fn({"symbol-placement":new si(Ue.layout_symbol["symbol-placement"]),"symbol-spacing":new si(Ue.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new si(Ue.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Nt(Ue.layout_symbol["symbol-sort-key"]),"symbol-z-order":new si(Ue.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new si(Ue.layout_symbol["icon-allow-overlap"]),"icon-overlap":new si(Ue.layout_symbol["icon-overlap"]),"icon-ignore-placement":new si(Ue.layout_symbol["icon-ignore-placement"]),"icon-optional":new si(Ue.layout_symbol["icon-optional"]),"icon-rotation-alignment":new si(Ue.layout_symbol["icon-rotation-alignment"]),"icon-size":new Nt(Ue.layout_symbol["icon-size"]),"icon-text-fit":new si(Ue.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new si(Ue.layout_symbol["icon-text-fit-padding"]),"icon-image":new Nt(Ue.layout_symbol["icon-image"]),"icon-rotate":new Nt(Ue.layout_symbol["icon-rotate"]),"icon-padding":new si(Ue.layout_symbol["icon-padding"]),"icon-keep-upright":new si(Ue.layout_symbol["icon-keep-upright"]),"icon-offset":new Nt(Ue.layout_symbol["icon-offset"]),"icon-anchor":new Nt(Ue.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new si(Ue.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new si(Ue.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new si(Ue.layout_symbol["text-rotation-alignment"]),"text-field":new Nt(Ue.layout_symbol["text-field"]),"text-font":new Nt(Ue.layout_symbol["text-font"]),"text-size":new Nt(Ue.layout_symbol["text-size"]),"text-max-width":new Nt(Ue.layout_symbol["text-max-width"]),"text-line-height":new si(Ue.layout_symbol["text-line-height"]),"text-letter-spacing":new Nt(Ue.layout_symbol["text-letter-spacing"]),"text-justify":new Nt(Ue.layout_symbol["text-justify"]),"text-radial-offset":new Nt(Ue.layout_symbol["text-radial-offset"]),"text-variable-anchor":new si(Ue.layout_symbol["text-variable-anchor"]),"text-anchor":new Nt(Ue.layout_symbol["text-anchor"]),"text-max-angle":new si(Ue.layout_symbol["text-max-angle"]),"text-writing-mode":new si(Ue.layout_symbol["text-writing-mode"]),"text-rotate":new Nt(Ue.layout_symbol["text-rotate"]),"text-padding":new si(Ue.layout_symbol["text-padding"]),"text-keep-upright":new si(Ue.layout_symbol["text-keep-upright"]),"text-transform":new Nt(Ue.layout_symbol["text-transform"]),"text-offset":new Nt(Ue.layout_symbol["text-offset"]),"text-allow-overlap":new si(Ue.layout_symbol["text-allow-overlap"]),"text-overlap":new si(Ue.layout_symbol["text-overlap"]),"text-ignore-placement":new si(Ue.layout_symbol["text-ignore-placement"]),"text-optional":new si(Ue.layout_symbol["text-optional"])});var nh={paint:new fn({"icon-opacity":new Nt(Ue.paint_symbol["icon-opacity"]),"icon-color":new Nt(Ue.paint_symbol["icon-color"]),"icon-halo-color":new Nt(Ue.paint_symbol["icon-halo-color"]),"icon-halo-width":new Nt(Ue.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Nt(Ue.paint_symbol["icon-halo-blur"]),"icon-translate":new si(Ue.paint_symbol["icon-translate"]),"icon-translate-anchor":new si(Ue.paint_symbol["icon-translate-anchor"]),"text-opacity":new Nt(Ue.paint_symbol["text-opacity"]),"text-color":new Nt(Ue.paint_symbol["text-color"],{runtimeType:Dn,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Nt(Ue.paint_symbol["text-halo-color"]),"text-halo-width":new Nt(Ue.paint_symbol["text-halo-width"]),"text-halo-blur":new Nt(Ue.paint_symbol["text-halo-blur"]),"text-translate":new si(Ue.paint_symbol["text-translate"]),"text-translate-anchor":new si(Ue.paint_symbol["text-translate-anchor"])}),layout:ff};class Vu{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Yr,this.defaultValue=t}evaluate(t){if(t.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(t.formattedSection))return a.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Jt("FormatSectionOverride",Vu,{omit:["defaultValue"]});class oh extends vn{constructor(t){super(t,nh)}recalculate(t,a){if(super.recalculate(t,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const _=[];for(const b of p)_.indexOf(b)<0&&_.push(b);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,a,p,_){const b=this.layout.get(t).evaluate(a,{},p,_),I=this._unevaluatedLayout._values[t];return I.isDataDriven()||Va(I.value)||!b?b:function(P,R){return R.replace(/{([^{}]+)}/g,(O,V)=>V in P?String(P[V]):"")}(a.properties,b)}createBucket(t){return new wc(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of nh.paint.overridableProperties){if(!oh.hasPaintOverride(this.layout,t))continue;const a=this.paint.get(t),p=new Vu(a),_=new ku(p,a.property.specification);let b=null;b=a.value.kind==="constant"||a.value.kind==="source"?new Xl("source",_):new ks("composite",_,a.value.zoomStops,a.value._interpolationType),this.paint._values[t]=new va(a.property,b,a.parameters)}}_handleOverridablePaintPropertyUpdate(t,a,p){return!(!this.layout||a.isDataDriven()||p.isDataDriven())&&oh.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,a){const p=t.get("text-field"),_=nh.paint.properties[a];let b=!1;const I=P=>{for(const R of P)if(_.overrides&&_.overrides.hasOverride(R))return void(b=!0)};if(p.value.kind==="constant"&&p.value.value instanceof _e)I(p.value.value.sections);else if(p.value.kind==="source"){const P=O=>{b||(O instanceof Ke&&Ie(O.value)===Oo?I(O.value.sections):O instanceof Ot?I(O.sections):O.eachChild(P))},R=p.value;R._styleExpression&&P(R._styleExpression.expression)}return b}}function qu(i,t,a){let p="never";const _=i.get(t);return _?p=_:i.get(a)&&(p="always"),p}var mf={paint:new fn({"background-color":new si(Ue.paint_background["background-color"]),"background-pattern":new Mo(Ue.paint_background["background-pattern"]),"background-opacity":new si(Ue.paint_background["background-opacity"])})},io={paint:new fn({"raster-opacity":new si(Ue.paint_raster["raster-opacity"]),"raster-hue-rotate":new si(Ue.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new si(Ue.paint_raster["raster-brightness-min"]),"raster-brightness-max":new si(Ue.paint_raster["raster-brightness-max"]),"raster-saturation":new si(Ue.paint_raster["raster-saturation"]),"raster-contrast":new si(Ue.paint_raster["raster-contrast"]),"raster-resampling":new si(Ue.paint_raster["raster-resampling"]),"raster-fade-duration":new si(Ue.paint_raster["raster-fade-duration"])})};class yn extends vn{constructor(t){super(t,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}}const yf={circle:class extends vn{constructor(i){super(i,ou)}createBucket(i){return new wa(i)}queryRadius(i){const t=i;return ys("circle-radius",this,t)+ys("circle-stroke-width",this,t)+Er(this.paint.get("circle-translate"))}queryIntersectsFeature(i,t,a,p,_,b,I,P){const R=$o(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,I),O=this.paint.get("circle-radius").evaluate(t,a)+this.paint.get("circle-stroke-width").evaluate(t,a),V=this.paint.get("circle-pitch-alignment")==="map",j=V?R:function(Y,Q){return Y.map(se=>pc(se,Q))}(R,P),K=V?O*I:O;for(const Y of p)for(const Q of Y){const se=V?Q:pc(Q,P);let pe=K;const Ae=nl([],[Q.x,Q.y,0,1],P);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?pe*=Ae[3]/b.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(pe*=b.cameraToCenterDistance/Ae[3]),Du(j,se,pe))return!0}return!1}},heatmap:class extends vn{constructor(i){super(i,dc),this._updateColorRamp()}createBucket(i){return new op(i)}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Zd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends vn{constructor(i){super(i,bm)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends vn{constructor(i){super(i,Hd)}recalculate(i,t){super.recalculate(i,t);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new id(i)}queryRadius(){return Er(this.paint.get("fill-translate"))}queryIntersectsFeature(i,t,a,p,_,b,I){return il($o(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,I),p)}isTileClipped(){return!0}},"fill-extrusion":class extends vn{constructor(i){super(i,Um)}createBucket(i){return new nd(i)}queryRadius(){return Er(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(i,t,a,p,_,b,I,P){const R=$o(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,I),O=this.paint.get("fill-extrusion-height").evaluate(t,a),V=this.paint.get("fill-extrusion-base").evaluate(t,a),j=function(Y,Q,se,pe){const Ae=[];for(const Be of Y){const qe=[Be.x,Be.y,0,1];nl(qe,qe,Q),Ae.push(new bt(qe[0]/qe[3],qe[1]/qe[3]))}return Ae}(R,P),K=function(Y,Q,se,pe){const Ae=[],Be=[],qe=pe[8]*Q,Ge=pe[9]*Q,it=pe[10]*Q,He=pe[11]*Q,Ct=pe[8]*se,Tt=pe[9]*se,ut=pe[10]*se,St=pe[11]*se;for(const mt of Y){const kt=[],dt=[];for(const _t of mt){const ti=_t.x,Yt=_t.y,ki=pe[0]*ti+pe[4]*Yt+pe[12],Mi=pe[1]*ti+pe[5]*Yt+pe[13],$i=pe[2]*ti+pe[6]*Yt+pe[14],sr=pe[3]*ti+pe[7]*Yt+pe[15],kr=$i+it,zr=sr+He,vr=ki+Ct,Br=Mi+Tt,xr=$i+ut,Or=sr+St,Oi=new bt((ki+qe)/zr,(Mi+Ge)/zr);Oi.z=kr/zr,kt.push(Oi);const Wi=new bt(vr/Or,Br/Or);Wi.z=xr/Or,dt.push(Wi)}Ae.push(kt),Be.push(dt)}return[Ae,Be]}(p,V,O,P);return function(Y,Q,se){let pe=1/0;il(se,Q)&&(pe=Qo(se,Q[0]));for(let Ae=0;Ae<Q.length;Ae++){const Be=Q[Ae],qe=Y[Ae];for(let Ge=0;Ge<Be.length-1;Ge++){const it=Be[Ge],He=[it,Be[Ge+1],qe[Ge+1],qe[Ge],it];Lu(se,He)&&(pe=Math.min(pe,Qo(se,He)))}}return pe!==1/0&&pe}(K[0],K[1],j)}},line:class extends vn{constructor(i){super(i,Qd),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Zs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,t){super.recalculate(i,t),this.paint._values["line-floorwidth"]=ef.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new od(i)}queryRadius(i){const t=i,a=Qc(ys("line-width",this,t),ys("line-gap-width",this,t)),p=ys("line-offset",this,t);return a/2+Math.abs(p)+Er(this.paint.get("line-translate"))}queryIntersectsFeature(i,t,a,p,_,b,I){const P=$o(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,I),R=I/2*Qc(this.paint.get("line-width").evaluate(t,a),this.paint.get("line-gap-width").evaluate(t,a)),O=this.paint.get("line-offset").evaluate(t,a);return O&&(p=function(V,j){const K=[];for(let Y=0;Y<V.length;Y++){const Q=V[Y],se=[];for(let pe=0;pe<Q.length;pe++){const Ae=Q[pe-1],Be=Q[pe],qe=Q[pe+1],Ge=pe===0?new bt(0,0):Be.sub(Ae)._unit()._perp(),it=pe===Q.length-1?new bt(0,0):qe.sub(Be)._unit()._perp(),He=Ge._add(it)._unit(),Ct=He.x*it.x+He.y*it.y;Ct!==0&&He._mult(1/Ct),se.push(He._mult(j)._add(Be))}K.push(se)}return K}(p,O*I)),function(V,j,K){for(let Y=0;Y<j.length;Y++){const Q=j[Y];if(V.length>=3){for(let se=0;se<Q.length;se++)if(Ea(V,Q[se]))return!0}if(Ru(V,Q,K))return!0}return!1}(P,p,R)}isTileClipped(){return!0}},symbol:oh,background:class extends vn{constructor(i){super(i,mf)}},raster:class extends vn{constructor(i){super(i,io)}}};class gf{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const vd=63710088e-1;class Fn{constructor(t,a){if(isNaN(t)||isNaN(a))throw new Error(`Invalid LngLat object: (${t}, ${a})`);if(this.lng=+t,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Fn(Pe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const a=Math.PI/180,p=this.lat*a,_=t.lat*a,b=Math.sin(p)*Math.sin(_)+Math.cos(p)*Math.cos(_)*Math.cos((t.lng-this.lng)*a);return vd*Math.acos(Math.min(b,1))}toBounds(t=0){const a=360*t/40075017,p=a/Math.cos(Math.PI/180*this.lat);return new Gu(new Fn(this.lng-p,this.lat-a),new Fn(this.lng+p,this.lat+a))}static convert(t){if(t instanceof Fn)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Fn(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Fn(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Gu{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Fn?new Fn(t.lng,t.lat):Fn.convert(t),this}setSouthWest(t){return this._sw=t instanceof Fn?new Fn(t.lng,t.lat):Fn.convert(t),this}extend(t){const a=this._sw,p=this._ne;let _,b;if(t instanceof Fn)_=t,b=t;else{if(!(t instanceof Gu))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Gu.convert(t)):this.extend(Fn.convert(t)):this;if(_=t._sw,b=t._ne,!_||!b)return this}return a||p?(a.lng=Math.min(_.lng,a.lng),a.lat=Math.min(_.lat,a.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new Fn(_.lng,_.lat),this._ne=new Fn(b.lng,b.lat)),this}getCenter(){return new Fn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Fn(this.getWest(),this.getNorth())}getSouthEast(){return new Fn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:p}=Fn.convert(t);let _=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&_}static convert(t){return t instanceof Gu?t:t&&new Gu(t)}}const bp=2*Math.PI*vd;function Zu(i){return bp*Math.cos(i*Math.PI/180)}function Hu(i){return(180+i)/360}function xd(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Vn(i,t){return i/Zu(t)}function Ec(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class Rs{constructor(t,a,p=0){this.x=+t,this.y=+a,this.z=+p}static fromLngLat(t,a=0){const p=Fn.convert(t);return new Rs(Hu(p.lng),xd(p.lat),Vn(a,p.lat))}toLngLat(){return new Fn(360*this.x-180,Ec(this.y))}toAltitude(){return this.z*Zu(Ec(this.y))}meterInMercatorCoordinateUnits(){return 1/bp*(t=Ec(this.y),1/Math.cos(t*Math.PI/180));var t}}function jh(i,t,a){var p=2*Math.PI*6378137/256/Math.pow(2,a);return[i*p-2*Math.PI*6378137/2,t*p-2*Math.PI*6378137/2]}class ah{constructor(t,a,p){this.z=t,this.x=a,this.y=p,this.key=_s(0,t,t,a,p)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,a,p){const _=(I=this.y,P=this.z,R=jh(256*(b=this.x),256*(I=Math.pow(2,P)-I-1),P),O=jh(256*(b+1),256*(I+1),P),R[0]+","+R[1]+","+O[0]+","+O[1]);var b,I,P,R,O;const V=function(j,K,Y){let Q,se="";for(let pe=j;pe>0;pe--)Q=1<<pe-1,se+=(K&Q?1:0)+(Y&Q?2:0);return se}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,V).replace(/{bbox-epsg-3857}/g,_)}getTilePoint(t){const a=Math.pow(2,this.z);return new bt((t.x*a-this.x)*ur,(t.y*a-this.y)*ur)}toString(){return`${this.z}/${this.x}/${this.y}`}}class wp{constructor(t,a){this.wrap=t,this.canonical=a,this.key=_s(t,a.z,a.z,a.x,a.y)}}class pa{constructor(t,a,p,_,b){this.overscaledZ=t,this.wrap=a,this.canonical=new ah(p,+_,+b),this.key=_s(a,t,p,_,b)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const a=this.canonical.z-t;return t>this.canonical.z?new pa(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new pa(t,this.wrap,t,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(t,a){const p=this.canonical.z-t;return t>this.canonical.z?_s(this.wrap*+a,t,this.canonical.z,this.canonical.x,this.canonical.y):_s(this.wrap*+a,t,t,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const a=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>a&&t.canonical.y===this.canonical.y>>a}children(t){if(this.overscaledZ>=t)return[new pa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,p=2*this.canonical.x,_=2*this.canonical.y;return[new pa(a,this.wrap,a,p,_),new pa(a,this.wrap,a,p+1,_),new pa(a,this.wrap,a,p,_+1),new pa(a,this.wrap,a,p+1,_+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new pa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new pa(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new wp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Rs(t.x-this.wrap,t.y))}}function _s(i,t,a,p,_){(i*=2)<0&&(i=-1*i-1);const b=1<<a;return(b*b*i+b*_+p).toString(36)+a.toString(36)+t.toString(36)}Jt("CanonicalTileID",ah),Jt("OverscaledTileID",pa,{omit:["posMatrix"]});class bd{constructor(t,a,p){if(this.uid=t,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(p&&p!=="mapbox"&&p!=="terrarium")return void ct(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const _=this.dim=a.height-2;this.data=new Uint32Array(a.data.buffer),this.encoding=p||"mapbox";for(let b=0;b<_;b++)this.data[this._idx(-1,b)]=this.data[this._idx(0,b)],this.data[this._idx(_,b)]=this.data[this._idx(_-1,b)],this.data[this._idx(b,-1)]=this.data[this._idx(b,0)],this.data[this._idx(b,_)]=this.data[this._idx(b,_-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(_,-1)]=this.data[this._idx(_-1,0)],this.data[this._idx(-1,_)]=this.data[this._idx(0,_-1)],this.data[this._idx(_,_)]=this.data[this._idx(_-1,_-1)]}get(t,a){const p=new Uint8Array(this.data.buffer),_=4*this._idx(t,a);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(p[_],p[_+1],p[_+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(t,a){if(t<-1||t>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(t+1)}_unpackMapbox(t,a,p){return(256*t*256+256*a+p)/10-1e4}_unpackTerrarium(t,a,p){return 256*t+a+p/256-32768}getPixels(){return new gs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,a,p){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let _=a*this.dim,b=a*this.dim+this.dim,I=p*this.dim,P=p*this.dim+this.dim;switch(a){case-1:_=b-1;break;case 1:b=_+1}switch(p){case-1:I=P-1;break;case 1:P=I+1}const R=-a*this.dim,O=-p*this.dim;for(let V=I;V<P;V++)for(let j=_;j<b;j++)this.data[this._idx(j,V)]=t.data[this._idx(j+R,V+O)]}}Jt("DEMData",bd);class wd{constructor(t){this._stringToNumber={},this._numberToString=[];for(let a=0;a<t.length;a++){const p=t[a];this._stringToNumber[p]=a,this._numberToString[a]=p}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}class _f{constructor(t,a,p,_,b){this.type="Feature",this._vectorTileFeature=t,t._z=a,t._x=p,t._y=_,this.properties=t.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(t[a]=this[a]);return t}}class yo{constructor(t,a){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Qi(ur,16,0),this.grid3D=new Qi(ur,16,0),this.featureIndexArray=new c,this.promoteId=a}insert(t,a,p,_,b,I){const P=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,_,b);const R=I?this.grid3D:this.grid;for(let O=0;O<a.length;O++){const V=a[O],j=[1/0,1/0,-1/0,-1/0];for(let K=0;K<V.length;K++){const Y=V[K];j[0]=Math.min(j[0],Y.x),j[1]=Math.min(j[1],Y.y),j[2]=Math.max(j[2],Y.x),j[3]=Math.max(j[3],Y.y)}j[0]<ur&&j[1]<ur&&j[2]>=0&&j[3]>=0&&R.insert(P,j[0],j[1],j[2],j[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Uu.VectorTile(new ad(this.rawTileData)).layers,this.sourceLayerCoder=new wd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,a,p,_){this.loadVTLayers();const b=t.params||{},I=ur/t.tileSize/t.scale,P=zs(b.filter),R=t.queryGeometry,O=t.queryPadding*I,V=Ed(R),j=this.grid.query(V.minX-O,V.minY-O,V.maxX+O,V.maxY+O),K=Ed(t.cameraQueryGeometry),Y=this.grid3D.query(K.minX-O,K.minY-O,K.maxX+O,K.maxY+O,(pe,Ae,Be,qe)=>function(Ge,it,He,Ct,Tt){for(const St of Ge)if(it<=St.x&&He<=St.y&&Ct>=St.x&&Tt>=St.y)return!0;const ut=[new bt(it,He),new bt(it,Tt),new bt(Ct,Tt),new bt(Ct,He)];if(Ge.length>2){for(const St of ut)if(Ea(Ge,St))return!0}for(let St=0;St<Ge.length-1;St++)if(Cl(Ge[St],Ge[St+1],ut))return!0;return!1}(t.cameraQueryGeometry,pe-O,Ae-O,Be+O,qe+O));for(const pe of Y)j.push(pe);j.sort(e);const Q={};let se;for(let pe=0;pe<j.length;pe++){const Ae=j[pe];if(Ae===se)continue;se=Ae;const Be=this.featureIndexArray.get(Ae);let qe=null;this.loadMatchingFeature(Q,Be.bucketIndex,Be.sourceLayerIndex,Be.featureIndex,P,b.layers,b.availableImages,a,p,_,(Ge,it,He)=>(qe||(qe=xa(Ge)),it.queryIntersectsFeature(R,Ge,He,qe,this.z,t.transform,I,t.pixelPosMatrix)))}return Q}loadMatchingFeature(t,a,p,_,b,I,P,R,O,V,j){const K=this.bucketLayerIDs[a];if(I&&!function(pe,Ae){for(let Be=0;Be<pe.length;Be++)if(Ae.indexOf(pe[Be])>=0)return!0;return!1}(I,K))return;const Y=this.sourceLayerCoder.decode(p),Q=this.vtLayers[Y].feature(_);if(b.needGeometry){const pe=Yn(Q,!0);if(!b.filter(new rn(this.tileID.overscaledZ),pe,this.tileID.canonical))return}else if(!b.filter(new rn(this.tileID.overscaledZ),Q))return;const se=this.getId(Q,Y);for(let pe=0;pe<K.length;pe++){const Ae=K[pe];if(I&&I.indexOf(Ae)<0)continue;const Be=R[Ae];if(!Be)continue;let qe={};se&&V&&(qe=V.getState(Be.sourceLayer||"_geojsonTileLayer",se));const Ge=ke({},O[Ae]);Ge.paint=du(Ge.paint,Be.paint,Q,qe,P),Ge.layout=du(Ge.layout,Be.layout,Q,qe,P);const it=!j||j(Q,Be,qe);if(!it)continue;const He=new _f(Q,this.z,this.x,this.y,se);He.layer=Ge;let Ct=t[Ae];Ct===void 0&&(Ct=t[Ae]=[]),Ct.push({featureIndex:_,feature:He,intersectionZ:it})}}lookupSymbolFeatures(t,a,p,_,b,I,P,R){const O={};this.loadVTLayers();const V=zs(b);for(const j of t)this.loadMatchingFeature(O,p,_,j,V,I,P,R,a);return O}hasLayer(t){for(const a of this.bucketLayerIDs)for(const p of a)if(t===p)return!0;return!1}getId(t,a){let p=t.id;return this.promoteId&&(p=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof p=="boolean"&&(p=Number(p))),p}}function du(i,t,a,p,_){return yt(i,(b,I)=>{const P=t instanceof Wo?t.get(I):null;return P&&P.evaluate?P.evaluate(a,p,_):P})}function Ed(i){let t=1/0,a=1/0,p=-1/0,_=-1/0;for(const b of i)t=Math.min(t,b.x),a=Math.min(a,b.y),p=Math.max(p,b.x),_=Math.max(_,b.y);return{minX:t,minY:a,maxX:p,maxY:_}}function e(i,t){return t-i}var n;Jt("FeatureIndex",yo,{omit:["rawTileData","sourceLayerCoder"]}),h.PerformanceMarkers=void 0,(n=h.PerformanceMarkers||(h.PerformanceMarkers={})).create="create",n.load="load",n.fullLoad="fullLoad";let l=null,v=[];const E=1e3/30,C={mark(i){performance.mark(i)},frame(i){const t=i;l!=null&&v.push(t-l),l=t},clearMetrics(){l=null,v=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const i in h.PerformanceMarkers)performance.clearMarks(h.PerformanceMarkers[i])},getPerformanceMetrics(){performance.measure("loadTime",h.PerformanceMarkers.create,h.PerformanceMarkers.load),performance.measure("fullLoadTime",h.PerformanceMarkers.create,h.PerformanceMarkers.fullLoad);const i=performance.getEntriesByName("loadTime")[0].duration,t=performance.getEntriesByName("fullLoadTime")[0].duration,a=v.length,p=1/(v.reduce((b,I)=>b+I,0)/a/1e3),_=v.filter(b=>b>E).reduce((b,I)=>b+(I-E)/E,0);return{loadTime:i,fullLoadTime:t,fps:p,percentDroppedFrames:_/(a+_)*100}}};h.AJAXError=rt,h.ARRAY_TYPE=Bu,h.Actor=class{constructor(i,t,a){this.target=i,this.parent=t,this.mapId=a,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},je(["receive","process"],this),this.invoker=new gf(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=fi()?i:window}send(i,t,a,p,_=!1){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(this.callbacks[b]=a);const I=Xt(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:i,hasCallback:!!a,targetMapId:p,mustQueue:_,sourceMapId:this.mapId,data:Za(t,I)},I),{cancel:()=>{a&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(i){const t=i.data,a=t.id;if(a&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[a];const p=this.cancelCallbacks[a];delete this.cancelCallbacks[a],p&&p()}else fi()||t.mustQueue?(this.tasks[a]=t,this.taskQueue.push(a),this.invoker.trigger()):this.processTask(a,t)}process(){if(!this.taskQueue.length)return;const i=this.taskQueue.shift(),t=this.tasks[i];delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(i,t)}processTask(i,t){if(t.type==="<response>"){const a=this.callbacks[i];delete this.callbacks[i],a&&(t.error?a(Ca(t.error)):a(null,Ca(t.data)))}else{let a=!1;const p=Xt(this.globalScope)?void 0:[],_=t.hasCallback?(P,R)=>{a=!0,delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:P?Za(P):null,data:Za(R,p)},p)}:P=>{a=!0};let b=null;const I=Ca(t.data);if(this.parent[t.type])b=this.parent[t.type](t.sourceMapId,I,_);else if(this.parent.getWorkerSource){const P=t.type.split(".");b=this.parent.getWorkerSource(t.sourceMapId,P[0],I.source)[P[1]](I,_)}else _(new Error(`Could not find function ${t.type}`));!a&&b&&b.cancel&&(this.cancelCallbacks[i]=b.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},h.AlphaImage=wh,h.CanonicalTileID=ah,h.CollisionBoxArray=ht,h.CollisionCircleLayoutArray=class extends ee{},h.Color=X,h.DEMData=bd,h.DataConstantProperty=si,h.DictionaryCoder=wd,h.EXTENT=ur,h.ErrorEvent=Wn,h.EvaluationParameters=rn,h.Event=Ao,h.Evented=Ba,h.FeatureIndex=yo,h.FillBucket=id,h.FillExtrusionBucket=nd,h.GeoJSONFeature=_f,h.ImageAtlas=cd,h.ImagePosition=ud,h.LineBucket=od,h.LineStripIndexArray=class extends nt{},h.LngLat=Fn,h.LngLatBounds=Gu,h.MercatorCoordinate=Rs,h.ONE_EM=Do,h.OverscaledTileID=pa,h.PerformanceUtils=C,h.PosArray=class extends Bn{},h.Properties=fn,h.QuadTriangleArray=class extends ue{},h.RGBAImage=gs,h.RasterBoundsArray=class extends No{},h.RequestPerformance=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},h.ResourceType=Bt,h.SegmentVector=xe,h.SymbolBucket=wc,h.Transitionable=ka,h.TriangleIndexArray=me,h.Uniform1f=ar,h.Uniform1i=class extends di{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},h.Uniform2f=class extends di{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},h.Uniform3f=class extends di{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},h.Uniform4f=ni,h.UniformColor=Bi,h.UniformMatrix4f=class extends di{constructor(i,t){super(i,t),this.current=er}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},h.UnwrappedTileID=wp,h.ValidationError=gt,h.ZoomHistory=Ql,h.addDynamicAttributes=_d,h.asyncAll=function(i,t,a){if(!i.length)return a(null,[]);let p=i.length;const _=new Array(i.length);let b=null;i.forEach((I,P)=>{t(I,(R,O)=>{R&&(b=R),_[P]=O,--p==0&&a(b,_)})})},h.bezier=F,h.bindAll=je,h.cacheEntryPossiblyAdded=function(i){Xi++,Xi>Fi&&(i.getActor().send("enforceCacheSizeLimit",yi),Xi=0)},h.clamp=H,h.clearTileCache=function(i){const t=caches.delete(Ar);i&&t.catch(i).then(()=>i())},h.clipLine=xc,h.clone=function(i){var t=new Bu(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},h.clone$1=Ze,h.collisionCircleLayout=nf,h.config=mr,h.create=function(){var i=new Bu(16);return Bu!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},h.createExpression=qa,h.createFilter=zs,h.createLayout=Gt,h.createStyleLayer=function(i){return i.type==="custom"?new yn(i):new yf[i.type](i)},h.dot=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]*t[3]},h.ease=G,h.emitValidationErrors=hs,h.enforceCacheSizeLimit=function(i){jt(),Rt&&Rt.then(t=>{t.keys().then(a=>{for(let p=0;p<a.length-i;p++)t.delete(a[p])})})},h.evaluateSizeForFeature=function(i,{uSize:t,uSizeT:a},{lowerSize:p,upperSize:_}){return i.kind==="source"?p/zl:i.kind==="composite"?Nn(p/zl,_/zl,a):t},h.evaluateSizeForZoom=function(i,t){let a=0,p=0;if(i.kind==="constant")p=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:_,minZoom:b,maxZoom:I}=i,P=_?H(fo.interpolationFactor(_,t,b,I),0,1):0;i.kind==="camera"?p=Nn(i.minSize,i.maxSize,P):a=P}return{uSizeT:a,uSize:p}},h.evaluateVariableOffset=rh,h.evented=ds,h.exported=Ai,h.exported$1=Ri,h.extend=ke,h.filterObject=Ne,h.getAnchorAlignment=dp,h.getAnchorJustification=Zr,h.getArrayBuffer=co,h.getImage=Hn,h.getJSON=function(i,t){return Pr(ke(i,{type:"json"}),t)},h.getOverlapMode=qu,h.getRTLTextPluginStatus=tu,h.getReferrer=_i,h.getVideo=function(i,t){const a=window.document.createElement("video");a.muted=!0,a.onloadstart=function(){t(null,a)};for(let p=0;p<i.length;p++){const _=window.document.createElement("source");Zn(i[p])||(a.crossOrigin="Anonymous"),_.src=i[p],a.appendChild(_)}return{cancel:()=>{}}},h.identity=Ou,h.invert=function(i,t){var a=t[0],p=t[1],_=t[2],b=t[3],I=t[4],P=t[5],R=t[6],O=t[7],V=t[8],j=t[9],K=t[10],Y=t[11],Q=t[12],se=t[13],pe=t[14],Ae=t[15],Be=a*P-p*I,qe=a*R-_*I,Ge=a*O-b*I,it=p*R-_*P,He=p*O-b*P,Ct=_*O-b*R,Tt=V*se-j*Q,ut=V*pe-K*Q,St=V*Ae-Y*Q,mt=j*pe-K*se,kt=j*Ae-Y*se,dt=K*Ae-Y*pe,_t=Be*dt-qe*kt+Ge*mt+it*St-He*ut+Ct*Tt;return _t?(i[0]=(P*dt-R*kt+O*mt)*(_t=1/_t),i[1]=(_*kt-p*dt-b*mt)*_t,i[2]=(se*Ct-pe*He+Ae*it)*_t,i[3]=(K*He-j*Ct-Y*it)*_t,i[4]=(R*St-I*dt-O*ut)*_t,i[5]=(a*dt-_*St+b*ut)*_t,i[6]=(pe*Ge-Q*Ct-Ae*qe)*_t,i[7]=(V*Ct-K*Ge+Y*qe)*_t,i[8]=(I*kt-P*St+O*Tt)*_t,i[9]=(p*St-a*kt-b*Tt)*_t,i[10]=(Q*He-se*Ge+Ae*Be)*_t,i[11]=(j*Ge-V*He-Y*Be)*_t,i[12]=(P*ut-I*mt-R*Tt)*_t,i[13]=(a*mt-p*ut+_*Tt)*_t,i[14]=(se*qe-Q*it-pe*Be)*_t,i[15]=(V*it-j*qe+K*Be)*_t,i):null},h.isImageBitmap=Qt,h.isSafari=Xt,h.keysDifference=function(i,t){const a=[];for(const p in i)p in t||a.push(p);return a},h.lazyLoadRTLTextPlugin=function(){dn.isLoading()||dn.isLoaded()||tu()!=="deferred"||Uo()},h.makeRequest=Pr,h.mapObject=yt,h.mercatorXfromLng=Hu,h.mercatorYfromLat=xd,h.mercatorZfromAltitude=Vn,h.mul=np,h.multiply=rp,h.nextPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},h.number=Nn,h.ortho=function(i,t,a,p,_,b,I){var P=1/(t-a),R=1/(p-_),O=1/(b-I);return i[0]=-2*P,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*R,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*O,i[11]=0,i[12]=(t+a)*P,i[13]=(_+p)*R,i[14]=(I+b)*O,i[15]=1,i},h.parseCacheControl=Et,h.parseGlyphPBF=function(i){return new ad(i).readFields(hp,[])},h.pbf=ad,h.performSymbolLayout=function(i,t,a,p,_,b,I){i.createArrays(),i.tilePixelRatio=ur/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const P=i.layers[0].layout,R=i.layers[0]._unevaluatedLayout._values,O={layoutIconSize:R["icon-size"].possiblyEvaluate(new rn(i.zoom+1),I),layoutTextSize:R["text-size"].possiblyEvaluate(new rn(i.zoom+1),I),textMaxSize:R["text-size"].possiblyEvaluate(new rn(18))};if(i.textSizeData.kind==="composite"){const{minZoom:Q,maxZoom:se}=i.textSizeData;O.compositeTextSizes=[R["text-size"].possiblyEvaluate(new rn(Q),I),R["text-size"].possiblyEvaluate(new rn(se),I)]}if(i.iconSizeData.kind==="composite"){const{minZoom:Q,maxZoom:se}=i.iconSizeData;O.compositeIconSizes=[R["icon-size"].possiblyEvaluate(new rn(Q),I),R["icon-size"].possiblyEvaluate(new rn(se),I)]}const V=P.get("text-line-height")*Do,j=P.get("text-rotation-alignment")!=="viewport"&&P.get("symbol-placement")!=="point",K=P.get("text-keep-upright"),Y=P.get("text-size");for(const Q of i.features){const se=P.get("text-font").evaluate(Q,{},I).join(","),pe=Y.evaluate(Q,{},I),Ae=O.layoutTextSize.evaluate(Q,{},I),Be=O.layoutIconSize.evaluate(Q,{},I),qe={horizontal:{},vertical:void 0},Ge=Q.text;let it,He=[0,0];if(Ge){const ut=Ge.toString(),St=P.get("text-letter-spacing").evaluate(Q,{},I)*Do,mt=Il(ut)?St:0,kt=P.get("text-anchor").evaluate(Q,{},I),dt=P.get("text-variable-anchor");if(!dt){const Mi=P.get("text-radial-offset").evaluate(Q,{},I);He=Mi?rh(kt,[Mi*Do,ju]):P.get("text-offset").evaluate(Q,{},I).map($i=>$i*Do)}let _t=j?"center":P.get("text-justify").evaluate(Q,{},I);const ti=P.get("symbol-placement"),Yt=ti==="point"?P.get("text-max-width").evaluate(Q,{},I)*Do:0,ki=()=>{i.allowVerticalPlacement&&el(ut)&&(qe.vertical=Lh(Ge,t,a,_,se,Yt,V,kt,"left",mt,He,h.WritingMode.vertical,!0,ti,Ae,pe))};if(!j&&dt){const Mi=_t==="auto"?dt.map(sr=>Zr(sr)):[_t];let $i=!1;for(let sr=0;sr<Mi.length;sr++){const kr=Mi[sr];if(!qe.horizontal[kr])if($i)qe.horizontal[kr]=qe.horizontal[0];else{const zr=Lh(Ge,t,a,_,se,Yt,V,"center",kr,mt,He,h.WritingMode.horizontal,!1,ti,Ae,pe);zr&&(qe.horizontal[kr]=zr,$i=zr.positionedLines.length===1)}}ki()}else{_t==="auto"&&(_t=Zr(kt));const Mi=Lh(Ge,t,a,_,se,Yt,V,kt,_t,mt,He,h.WritingMode.horizontal,!1,ti,Ae,pe);Mi&&(qe.horizontal[_t]=Mi),ki(),el(ut)&&j&&K&&(qe.vertical=Lh(Ge,t,a,_,se,Yt,V,kt,_t,mt,He,h.WritingMode.vertical,!1,ti,Ae,pe))}}let Ct=!1;if(Q.icon&&Q.icon.name){const ut=p[Q.icon.name];ut&&(it=Xm(_[Q.icon.name],P.get("icon-offset").evaluate(Q,{},I),P.get("icon-anchor").evaluate(Q,{},I)),Ct=!!ut.sdf,i.sdfIcons===void 0?i.sdfIcons=Ct:i.sdfIcons!==Ct&&ct("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ut.pixelRatio!==i.pixelRatio||P.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const Tt=df(qe.horizontal)||qe.vertical;i.iconsInText=!!Tt&&Tt.iconsInText,(Tt||it)&&Qm(i,Q,qe,it,p,O,Ae,Be,He,Ct,I)}b&&i.generateCollisionDebugBuffers()},h.perspective=function(i,t,a,p,_){var b,I=1/Math.tan(t/2);return i[0]=I/a,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=I,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,_!=null&&_!==1/0?(i[10]=(_+p)*(b=1/(p-_)),i[14]=2*_*p*b):(i[10]=-1,i[14]=-2*p),i},h.pick=function(i,t){const a={};for(let p=0;p<t.length;p++){const _=t[p];_ in i&&(a[_]=i[_])}return a},h.plugin=dn,h.pointGeometry=bt,h.polygonIntersectsPolygon=Lu,h.potpack=ld,h.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],h.register=Jt,h.registerForPluginStateChange=function(i){return i({pluginStatus:ln,pluginURL:Ha}),ds.on("pluginStateChange",i),i},h.renderColorRamp=Zd,h.rotateX=function(i,t,a){var p=Math.sin(a),_=Math.cos(a),b=t[4],I=t[5],P=t[6],R=t[7],O=t[8],V=t[9],j=t[10],K=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=b*_+O*p,i[5]=I*_+V*p,i[6]=P*_+j*p,i[7]=R*_+K*p,i[8]=O*_-b*p,i[9]=V*_-I*p,i[10]=j*_-P*p,i[11]=K*_-R*p,i},h.rotateZ=function(i,t,a){var p=Math.sin(a),_=Math.cos(a),b=t[0],I=t[1],P=t[2],R=t[3],O=t[4],V=t[5],j=t[6],K=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=b*_+O*p,i[1]=I*_+V*p,i[2]=P*_+j*p,i[3]=R*_+K*p,i[4]=O*_-b*p,i[5]=V*_-I*p,i[6]=j*_-P*p,i[7]=K*_-R*p,i},h.scale=function(i,t,a){var p=a[0],_=a[1],b=a[2];return i[0]=t[0]*p,i[1]=t[1]*p,i[2]=t[2]*p,i[3]=t[3]*p,i[4]=t[4]*_,i[5]=t[5]*_,i[6]=t[6]*_,i[7]=t[7]*_,i[8]=t[8]*b,i[9]=t[9]*b,i[10]=t[10]*b,i[11]=t[11]*b,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},h.scale$1=function(i,t,a){return i[0]=t[0]*a,i[1]=t[1]*a,i[2]=t[2]*a,i[3]=t[3]*a,i},h.setCacheLimits=function(i,t){yi=i,Fi=t},h.setRTLTextPlugin=function(i,t,a=!1){if(ln===Io||ln===Tl||ln===Ms)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ha=Ai.resolveURL(i),ln=Io,ca=t,eu(),a||Uo()},h.spec=Ue,h.sphericalToCartesian=function([i,t,a]){return t+=90,t*=Math.PI/180,a*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(a),y:i*Math.sin(t)*Math.sin(a),z:i*Math.cos(a)}},h.toEvaluationFeature=Yn,h.transformMat4=nl,h.translate=function(i,t,a){var p,_,b,I,P,R,O,V,j,K,Y,Q,se=a[0],pe=a[1],Ae=a[2];return t===i?(i[12]=t[0]*se+t[4]*pe+t[8]*Ae+t[12],i[13]=t[1]*se+t[5]*pe+t[9]*Ae+t[13],i[14]=t[2]*se+t[6]*pe+t[10]*Ae+t[14],i[15]=t[3]*se+t[7]*pe+t[11]*Ae+t[15]):(_=t[1],b=t[2],I=t[3],P=t[4],R=t[5],O=t[6],V=t[7],j=t[8],K=t[9],Y=t[10],Q=t[11],i[0]=p=t[0],i[1]=_,i[2]=b,i[3]=I,i[4]=P,i[5]=R,i[6]=O,i[7]=V,i[8]=j,i[9]=K,i[10]=Y,i[11]=Q,i[12]=p*se+P*pe+j*Ae+t[12],i[13]=_*se+R*pe+K*Ae+t[13],i[14]=b*se+O*pe+Y*Ae+t[14],i[15]=I*se+V*pe+Q*Ae+t[15]),i},h.triggerPluginCompletionEvent=qt,h.unicodeBlockLookup=ri,h.uniqueId=function(){return We++},h.validateCustomStyleLayer=function(i){const t=[],a=i.id;return a===void 0&&t.push({message:`layers.${a}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${a}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),t},h.validateLight=sn,h.validateStyle=ua,h.vectorTile=Uu,h.warnOnce=ct,h.wrap=Pe}),z(["./shared"],function(h){function D(ae){const W=typeof ae;if(W==="number"||W==="boolean"||W==="string"||ae==null)return JSON.stringify(ae);if(Array.isArray(ae)){let ce="[";for(const _e of ae)ce+=`${D(_e)},`;return`${ce}]`}const X=Object.keys(ae).sort();let ne="{";for(let ce=0;ce<X.length;ce++)ne+=`${JSON.stringify(X[ce])}:${D(ae[X[ce]])},`;return`${ne}}`}function N(ae){let W="";for(const X of h.refProperties)W+=`/${D(ae[X])}`;return W}class F{constructor(W){this.keyCache={},W&&this.replace(W)}replace(W){this._layerConfigs={},this._layers={},this.update(W,[])}update(W,X){for(const ce of W){this._layerConfigs[ce.id]=ce;const _e=this._layers[ce.id]=h.createStyleLayer(ce);_e._featureFilter=h.createFilter(_e.filter),this.keyCache[ce.id]&&delete this.keyCache[ce.id]}for(const ce of X)delete this.keyCache[ce],delete this._layerConfigs[ce],delete this._layers[ce];this.familiesBySource={};const ne=function(ce,_e){const fe={};for(let we=0;we<ce.length;we++){const Ie=_e&&_e[ce[we].id]||N(ce[we]);_e&&(_e[ce[we].id]=Ie);let et=fe[Ie];et||(et=fe[Ie]=[]),et.push(ce[we])}const Ee=[];for(const we in fe)Ee.push(fe[we]);return Ee}(Object.values(this._layerConfigs),this.keyCache);for(const ce of ne){const _e=ce.map(Ke=>this._layers[Ke.id]),fe=_e[0];if(fe.visibility==="none")continue;const Ee=fe.source||"";let we=this.familiesBySource[Ee];we||(we=this.familiesBySource[Ee]={});const Ie=fe.sourceLayer||"_geojsonTileLayer";let et=we[Ie];et||(et=we[Ie]=[]),et.push(_e)}}}class G{constructor(W){const X={},ne=[];for(const Ee in W){const we=W[Ee],Ie=X[Ee]={};for(const et in we){const Ke=we[+et];if(!Ke||Ke.bitmap.width===0||Ke.bitmap.height===0)continue;const tt={x:0,y:0,w:Ke.bitmap.width+2,h:Ke.bitmap.height+2};ne.push(tt),Ie[et]={rect:tt,metrics:Ke.metrics}}}const{w:ce,h:_e}=h.potpack(ne),fe=new h.AlphaImage({width:ce||1,height:_e||1});for(const Ee in W){const we=W[Ee];for(const Ie in we){const et=we[+Ie];if(!et||et.bitmap.width===0||et.bitmap.height===0)continue;const Ke=X[Ee][Ie].rect;h.AlphaImage.copy(et.bitmap,fe,{x:0,y:0},{x:Ke.x+1,y:Ke.y+1},et.bitmap)}}this.image=fe,this.positions=X}}h.register("GlyphAtlas",G);class H{constructor(W){this.tileID=new h.OverscaledTileID(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId}parse(W,X,ne,ce,_e){this.status="parsing",this.data=W,this.collisionBoxArray=new h.CollisionBoxArray;const fe=new h.DictionaryCoder(Object.keys(W.layers).sort()),Ee=new h.FeatureIndex(this.tileID,this.promoteId);Ee.bucketLayerIDs=[];const we={},Ie={featureIndex:Ee,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ne},et=X.familiesBySource[this.source];for(const Ci in et){const ci=W.layers[Ci];if(!ci)continue;ci.version===1&&h.warnOnce(`Vector tile source "${this.source}" layer "${Ci}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Kt=fe.encode(Ci),Di=[];for(let Ir=0;Ir<ci.length;Ir++){const kn=ci.feature(Ir),Cr=Ee.getId(kn,Ci);Di.push({feature:kn,id:Cr,index:Ir,sourceLayerIndex:Kt})}for(const Ir of et[Ci]){const kn=Ir[0];kn.minzoom&&this.zoom<Math.floor(kn.minzoom)||kn.maxzoom&&this.zoom>=kn.maxzoom||kn.visibility!=="none"&&(Pe(Ir,this.zoom,ne),(we[kn.id]=kn.createBucket({index:Ee.bucketLayerIDs.length,layers:Ir,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Kt,sourceID:this.source})).populate(Di,Ie,this.tileID.canonical),Ee.bucketLayerIDs.push(Ir.map(Cr=>Cr.id)))}}let Ke,tt,Ut,At;const Ot=h.mapObject(Ie.glyphDependencies,Ci=>Object.keys(Ci).map(Number));Object.keys(Ot).length?ce.send("getGlyphs",{uid:this.uid,stacks:Ot},(Ci,ci)=>{Ke||(Ke=Ci,tt=ci,gi.call(this))}):tt={};const Vt=Object.keys(Ie.iconDependencies);Vt.length?ce.send("getImages",{icons:Vt,source:this.source,tileID:this.tileID,type:"icons"},(Ci,ci)=>{Ke||(Ke=Ci,Ut=ci,gi.call(this))}):Ut={};const Hi=Object.keys(Ie.patternDependencies);function gi(){if(Ke)return _e(Ke);if(tt&&Ut&&At){const Ci=new G(tt),ci=new h.ImageAtlas(Ut,At);for(const Kt in we){const Di=we[Kt];Di instanceof h.SymbolBucket?(Pe(Di.layers,this.zoom,ne),h.performSymbolLayout(Di,tt,Ci.positions,Ut,ci.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Di.hasPattern&&(Di instanceof h.LineBucket||Di instanceof h.FillBucket||Di instanceof h.FillExtrusionBucket)&&(Pe(Di.layers,this.zoom,ne),Di.addFeatures(Ie,this.tileID.canonical,ci.patternPositions))}this.status="done",_e(null,{buckets:Object.values(we).filter(Kt=>!Kt.isEmpty()),featureIndex:Ee,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ci.image,imageAtlas:ci,glyphMap:this.returnDependencies?tt:null,iconMap:this.returnDependencies?Ut:null,glyphPositions:this.returnDependencies?Ci.positions:null})}}Hi.length?ce.send("getImages",{icons:Hi,source:this.source,tileID:this.tileID,type:"patterns"},(Ci,ci)=>{Ke||(Ke=Ci,At=ci,gi.call(this))}):At={},gi.call(this)}}function Pe(ae,W,X){const ne=new h.EvaluationParameters(W);for(const ce of ae)ce.recalculate(ne,X)}function ke(ae,W){const X=h.getArrayBuffer(ae.request,(ne,ce,_e,fe)=>{ne?W(ne):ce&&W(null,{vectorTile:new h.vectorTile.VectorTile(new h.pbf(ce)),rawData:ce,cacheControl:_e,expires:fe})});return()=>{X.cancel(),W()}}class We{constructor(W,X,ne,ce){this.actor=W,this.layerIndex=X,this.availableImages=ne,this.loadVectorData=ce||ke,this.loading={},this.loaded={}}loadTile(W,X){const ne=W.uid;this.loading||(this.loading={});const ce=!!(W&&W.request&&W.request.collectResourceTiming)&&new h.RequestPerformance(W.request),_e=this.loading[ne]=new H(W);_e.abort=this.loadVectorData(W,(fe,Ee)=>{if(delete this.loading[ne],fe||!Ee)return _e.status="done",this.loaded[ne]=_e,X(fe);const we=Ee.rawData,Ie={};Ee.expires&&(Ie.expires=Ee.expires),Ee.cacheControl&&(Ie.cacheControl=Ee.cacheControl);const et={};if(ce){const Ke=ce.finish();Ke&&(et.resourceTiming=JSON.parse(JSON.stringify(Ke)))}_e.vectorTile=Ee.vectorTile,_e.parse(Ee.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ke,tt)=>{if(Ke||!tt)return X(Ke);X(null,h.extend({rawTileData:we.slice(0)},tt,Ie,et))}),this.loaded=this.loaded||{},this.loaded[ne]=_e})}reloadTile(W,X){const ne=this.loaded,ce=W.uid,_e=this;if(ne&&ne[ce]){const fe=ne[ce];fe.showCollisionBoxes=W.showCollisionBoxes;const Ee=(we,Ie)=>{const et=fe.reloadCallback;et&&(delete fe.reloadCallback,fe.parse(fe.vectorTile,_e.layerIndex,this.availableImages,_e.actor,et)),X(we,Ie)};fe.status==="parsing"?fe.reloadCallback=Ee:fe.status==="done"&&(fe.vectorTile?fe.parse(fe.vectorTile,this.layerIndex,this.availableImages,this.actor,Ee):Ee())}}abortTile(W,X){const ne=this.loading,ce=W.uid;ne&&ne[ce]&&ne[ce].abort&&(ne[ce].abort(),delete ne[ce]),X()}removeTile(W,X){const ne=this.loaded,ce=W.uid;ne&&ne[ce]&&delete ne[ce],X()}}class je{constructor(){this.loaded={}}loadTile(W,X){const{uid:ne,encoding:ce,rawImageData:_e}=W,fe=h.isImageBitmap(_e)?this.getImageData(_e):_e,Ee=new h.DEMData(ne,fe,ce);this.loaded=this.loaded||{},this.loaded[ne]=Ee,X(null,Ee)}getImageData(W){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(W.width,W.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=W.width,this.offscreenCanvas.height=W.height,this.offscreenCanvasContext.drawImage(W,0,0,W.width,W.height);const X=this.offscreenCanvasContext.getImageData(-1,-1,W.width+2,W.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new h.RGBAImage({width:X.width,height:X.height},X.data)}removeTile(W){const X=this.loaded,ne=W.uid;X&&X[ne]&&delete X[ne]}}var yt=function ae(W,X){var ne,ce=W&&W.type;if(ce==="FeatureCollection")for(ne=0;ne<W.features.length;ne++)ae(W.features[ne],X);else if(ce==="GeometryCollection")for(ne=0;ne<W.geometries.length;ne++)ae(W.geometries[ne],X);else if(ce==="Feature")ae(W.geometry,X);else if(ce==="Polygon")Ne(W.coordinates,X);else if(ce==="MultiPolygon")for(ne=0;ne<W.coordinates.length;ne++)Ne(W.coordinates[ne],X);return W};function Ne(ae,W){if(ae.length!==0){Ze(ae[0],W);for(var X=1;X<ae.length;X++)Ze(ae[X],!W)}}function Ze(ae,W){for(var X=0,ne=0,ce=0,_e=ae.length,fe=_e-1;ce<_e;fe=ce++){var Ee=(ae[ce][0]-ae[fe][0])*(ae[fe][1]+ae[ce][1]),we=X+Ee;ne+=Math.abs(X)>=Math.abs(Ee)?X-we+Ee:Ee-we+X,X=we}X+ne>=0!=!!W&&ae.reverse()}const vt=h.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ct{constructor(W){this._feature=W,this.extent=h.EXTENT,this.type=W.type,this.properties=W.tags,"id"in W&&!isNaN(W.id)&&(this.id=parseInt(W.id,10))}loadGeometry(){if(this._feature.type===1){const W=[];for(const X of this._feature.geometry)W.push([new h.pointGeometry(X[0],X[1])]);return W}{const W=[];for(const X of this._feature.geometry){const ne=[];for(const ce of X)ne.push(new h.pointGeometry(ce[0],ce[1]));W.push(ne)}return W}}toGeoJSON(W,X,ne){return vt.call(this,W,X,ne)}}class pt{constructor(W){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.EXTENT,this.length=W.length,this._features=W}feature(W){return new ct(this._features[W])}}var lt={exports:{}},fi=h.pointGeometry,Et=h.vectorTile.VectorTileFeature,Wt=Ei;function Ei(ae,W){this.options=W||{},this.features=ae,this.length=ae.length}function qi(ae,W){this.id=typeof ae.id=="number"?ae.id:void 0,this.type=ae.type,this.rawGeometry=ae.type===1?[ae.geometry]:ae.geometry,this.properties=ae.tags,this.extent=W||4096}Ei.prototype.feature=function(ae){return new qi(this.features[ae],this.options.extent)},qi.prototype.loadGeometry=function(){var ae=this.rawGeometry;this.geometry=[];for(var W=0;W<ae.length;W++){for(var X=ae[W],ne=[],ce=0;ce<X.length;ce++)ne.push(new fi(X[ce][0],X[ce][1]));this.geometry.push(ne)}return this.geometry},qi.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ae=this.geometry,W=1/0,X=-1/0,ne=1/0,ce=-1/0,_e=0;_e<ae.length;_e++)for(var fe=ae[_e],Ee=0;Ee<fe.length;Ee++){var we=fe[Ee];W=Math.min(W,we.x),X=Math.max(X,we.x),ne=Math.min(ne,we.y),ce=Math.max(ce,we.y)}return[W,ne,X,ce]},qi.prototype.toGeoJSON=Et.prototype.toGeoJSON;var Xt=h.pbf,Qt=Wt;function Ai(ae){var W=new Xt;return function(X,ne){for(var ce in X.layers)ne.writeMessage(3,bt,X.layers[ce])}(ae,W),W.finish()}function bt(ae,W){var X;W.writeVarintField(15,ae.version||1),W.writeStringField(1,ae.name||""),W.writeVarintField(5,ae.extent||4096);var ne={keys:[],values:[],keycache:{},valuecache:{}};for(X=0;X<ae.length;X++)ne.feature=ae.feature(X),W.writeMessage(2,Gi,ne);var ce=ne.keys;for(X=0;X<ce.length;X++)W.writeStringField(3,ce[X]);var _e=ne.values;for(X=0;X<_e.length;X++)W.writeMessage(4,yi,_e[X])}function Gi(ae,W){var X=ae.feature;X.id!==void 0&&W.writeVarintField(1,X.id),W.writeMessage(2,mr,ae),W.writeVarintField(3,X.type),W.writeMessage(4,ai,X)}function mr(ae,W){var X=ae.feature,ne=ae.keys,ce=ae.values,_e=ae.keycache,fe=ae.valuecache;for(var Ee in X.properties){var we=X.properties[Ee],Ie=_e[Ee];if(we!==null){Ie===void 0&&(ne.push(Ee),_e[Ee]=Ie=ne.length-1),W.writeVarint(Ie);var et=typeof we;et!=="string"&&et!=="boolean"&&et!=="number"&&(we=JSON.stringify(we));var Ke=et+":"+we,tt=fe[Ke];tt===void 0&&(ce.push(we),fe[Ke]=tt=ce.length-1),W.writeVarint(tt)}}}function Ar(ae,W){return(W<<3)+(7&ae)}function Rt(ae){return ae<<1^ae>>31}function ai(ae,W){for(var X=ae.loadGeometry(),ne=ae.type,ce=0,_e=0,fe=X.length,Ee=0;Ee<fe;Ee++){var we=X[Ee],Ie=1;ne===1&&(Ie=we.length),W.writeVarint(Ar(1,Ie));for(var et=ne===3?we.length-1:we.length,Ke=0;Ke<et;Ke++){Ke===1&&ne!==1&&W.writeVarint(Ar(2,et-1));var tt=we[Ke].x-ce,Ut=we[Ke].y-_e;W.writeVarint(Rt(tt)),W.writeVarint(Rt(Ut)),ce+=tt,_e+=Ut}ne===3&&W.writeVarint(Ar(7,1))}}function yi(ae,W){var X=typeof ae;X==="string"?W.writeStringField(1,ae):X==="boolean"?W.writeBooleanField(7,ae):X==="number"&&(ae%1!=0?W.writeDoubleField(3,ae):ae<0?W.writeSVarintField(6,ae):W.writeVarintField(5,ae))}lt.exports=Ai,lt.exports.fromVectorTileJs=Ai,lt.exports.fromGeojsonVt=function(ae,W){W=W||{};var X={};for(var ne in ae)X[ne]=new Qt(ae[ne].features,W),X[ne].name=ne,X[ne].version=W.version,X[ne].extent=W.extent;return Ai({layers:X})},lt.exports.GeoJSONWrapper=Qt;var Fi=lt.exports;function jt(ae,W,X,ne,ce,_e){if(ce-ne<=X)return;const fe=ne+ce>>1;Xi(ae,W,fe,ne,ce,_e%2),jt(ae,W,X,ne,fe-1,_e+1),jt(ae,W,X,fe+1,ce,_e+1)}function Xi(ae,W,X,ne,ce,_e){for(;ce>ne;){if(ce-ne>600){const Ie=ce-ne+1,et=X-ne+1,Ke=Math.log(Ie),tt=.5*Math.exp(2*Ke/3),Ut=.5*Math.sqrt(Ke*tt*(Ie-tt)/Ie)*(et-Ie/2<0?-1:1);Xi(ae,W,X,Math.max(ne,Math.floor(X-et*tt/Ie+Ut)),Math.min(ce,Math.floor(X+(Ie-et)*tt/Ie+Ut)),_e)}const fe=W[2*X+_e];let Ee=ne,we=ce;for(Ri(ae,W,ne,X),W[2*ce+_e]>fe&&Ri(ae,W,ne,ce);Ee<we;){for(Ri(ae,W,Ee,we),Ee++,we--;W[2*Ee+_e]<fe;)Ee++;for(;W[2*we+_e]>fe;)we--}W[2*ne+_e]===fe?Ri(ae,W,ne,we):(we++,Ri(ae,W,we,ce)),we<=X&&(ne=we+1),X<=we&&(ce=we-1)}}function Ri(ae,W,X,ne){Ii(ae,X,ne),Ii(W,2*X,2*ne),Ii(W,2*X+1,2*ne+1)}function Ii(ae,W,X){const ne=ae[W];ae[W]=ae[X],ae[X]=ne}function rr(ae,W,X,ne){const ce=ae-X,_e=W-ne;return ce*ce+_e*_e}const zi=ae=>ae[0],zt=ae=>ae[1];class tr{constructor(W,X=zi,ne=zt,ce=64,_e=Float64Array){this.nodeSize=ce,this.points=W;const fe=W.length<65536?Uint16Array:Uint32Array,Ee=this.ids=new fe(W.length),we=this.coords=new _e(2*W.length);for(let Ie=0;Ie<W.length;Ie++)Ee[Ie]=Ie,we[2*Ie]=X(W[Ie]),we[2*Ie+1]=ne(W[Ie]);jt(Ee,we,ce,0,Ee.length-1,0)}range(W,X,ne,ce){return function(_e,fe,Ee,we,Ie,et,Ke){const tt=[0,_e.length-1,0],Ut=[];let At,Ot;for(;tt.length;){const Vt=tt.pop(),Hi=tt.pop(),gi=tt.pop();if(Hi-gi<=Ke){for(let Kt=gi;Kt<=Hi;Kt++)At=fe[2*Kt],Ot=fe[2*Kt+1],At>=Ee&&At<=Ie&&Ot>=we&&Ot<=et&&Ut.push(_e[Kt]);continue}const Ci=Math.floor((gi+Hi)/2);At=fe[2*Ci],Ot=fe[2*Ci+1],At>=Ee&&At<=Ie&&Ot>=we&&Ot<=et&&Ut.push(_e[Ci]);const ci=(Vt+1)%2;(Vt===0?Ee<=At:we<=Ot)&&(tt.push(gi),tt.push(Ci-1),tt.push(ci)),(Vt===0?Ie>=At:et>=Ot)&&(tt.push(Ci+1),tt.push(Hi),tt.push(ci))}return Ut}(this.ids,this.coords,W,X,ne,ce,this.nodeSize)}within(W,X,ne){return function(ce,_e,fe,Ee,we,Ie){const et=[0,ce.length-1,0],Ke=[],tt=we*we;for(;et.length;){const Ut=et.pop(),At=et.pop(),Ot=et.pop();if(At-Ot<=Ie){for(let ci=Ot;ci<=At;ci++)rr(_e[2*ci],_e[2*ci+1],fe,Ee)<=tt&&Ke.push(ce[ci]);continue}const Vt=Math.floor((Ot+At)/2),Hi=_e[2*Vt],gi=_e[2*Vt+1];rr(Hi,gi,fe,Ee)<=tt&&Ke.push(ce[Vt]);const Ci=(Ut+1)%2;(Ut===0?fe-we<=Hi:Ee-we<=gi)&&(et.push(Ot),et.push(Vt-1),et.push(Ci)),(Ut===0?fe+we>=Hi:Ee+we>=gi)&&(et.push(Vt+1),et.push(At),et.push(Ci))}return Ke}(this.ids,this.coords,W,X,ne,this.nodeSize)}}const Bt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ae=>ae},rt=Math.fround||(_i=new Float32Array(1),ae=>(_i[0]=+ae,_i[0]));var _i;class ir{constructor(W){this.options=Zi(Object.create(Bt),W),this.trees=new Array(this.options.maxZoom+1)}load(W){const{log:X,minZoom:ne,maxZoom:ce,nodeSize:_e}=this.options;X&&console.time("total time");const fe=`prepare ${W.length} points`;X&&console.time(fe),this.points=W;let Ee=[];for(let we=0;we<W.length;we++)W[we].geometry&&Ee.push(co(W[we],we));this.trees[ce+1]=new tr(Ee,Un,Ao,_e,Float32Array),X&&console.timeEnd(fe);for(let we=ce;we>=ne;we--){const Ie=+Date.now();Ee=this._cluster(Ee,we),this.trees[we]=new tr(Ee,Un,Ao,_e,Float32Array),X&&console.log("z%d: %d clusters in %dms",we,Ee.length,+Date.now()-Ie)}return X&&console.timeEnd("total time"),this}getClusters(W,X){let ne=((W[0]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,W[1]));let _e=W[2]===180?180:((W[2]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,W[3]));if(W[2]-W[0]>=360)ne=-180,_e=180;else if(ne>_e){const et=this.getClusters([ne,ce,180,fe],X),Ke=this.getClusters([-180,ce,_e,fe],X);return et.concat(Ke)}const Ee=this.trees[this._limitZoom(X)],we=Ee.range(_n(ne),ho(fe),_n(_e),ho(ce)),Ie=[];for(const et of we){const Ke=Ee.points[et];Ie.push(Ke.numPoints?Zn(Ke):this.points[Ke.index])}return Ie}getChildren(W){const X=this._getOriginId(W),ne=this._getOriginZoom(W),ce="No cluster with the specified id.",_e=this.trees[ne];if(!_e)throw new Error(ce);const fe=_e.points[X];if(!fe)throw new Error(ce);const Ee=this.options.radius/(this.options.extent*Math.pow(2,ne-1)),we=_e.within(fe.x,fe.y,Ee),Ie=[];for(const et of we){const Ke=_e.points[et];Ke.parentId===W&&Ie.push(Ke.numPoints?Zn(Ke):this.points[Ke.index])}if(Ie.length===0)throw new Error(ce);return Ie}getLeaves(W,X,ne){const ce=[];return this._appendLeaves(ce,W,X=X||10,ne=ne||0,0),ce}getTile(W,X,ne){const ce=this.trees[this._limitZoom(W)],_e=Math.pow(2,W),{extent:fe,radius:Ee}=this.options,we=Ee/fe,Ie=(ne-we)/_e,et=(ne+1+we)/_e,Ke={features:[]};return this._addTileFeatures(ce.range((X-we)/_e,Ie,(X+1+we)/_e,et),ce.points,X,ne,_e,Ke),X===0&&this._addTileFeatures(ce.range(1-we/_e,Ie,1,et),ce.points,_e,ne,_e,Ke),X===_e-1&&this._addTileFeatures(ce.range(0,Ie,we/_e,et),ce.points,-1,ne,_e,Ke),Ke.features.length?Ke:null}getClusterExpansionZoom(W){let X=this._getOriginZoom(W)-1;for(;X<=this.options.maxZoom;){const ne=this.getChildren(W);if(X++,ne.length!==1)break;W=ne[0].properties.cluster_id}return X}_appendLeaves(W,X,ne,ce,_e){const fe=this.getChildren(X);for(const Ee of fe){const we=Ee.properties;if(we&&we.cluster?_e+we.point_count<=ce?_e+=we.point_count:_e=this._appendLeaves(W,we.cluster_id,ne,ce,_e):_e<ce?_e++:W.push(Ee),W.length===ne)break}return _e}_addTileFeatures(W,X,ne,ce,_e,fe){for(const Ee of W){const we=X[Ee],Ie=we.numPoints;let et,Ke,tt;if(Ie)et=Bo(we),Ke=we.x,tt=we.y;else{const Ot=this.points[we.index];et=Ot.properties,Ke=_n(Ot.geometry.coordinates[0]),tt=ho(Ot.geometry.coordinates[1])}const Ut={type:1,geometry:[[Math.round(this.options.extent*(Ke*_e-ne)),Math.round(this.options.extent*(tt*_e-ce))]],tags:et};let At;Ie?At=we.id:this.options.generateId?At=we.index:this.points[we.index].id&&(At=this.points[we.index].id),At!==void 0&&(Ut.id=At),fe.features.push(Ut)}}_limitZoom(W){return Math.max(this.options.minZoom,Math.min(+W,this.options.maxZoom+1))}_cluster(W,X){const ne=[],{radius:ce,extent:_e,reduce:fe,minPoints:Ee}=this.options,we=ce/(_e*Math.pow(2,X));for(let Ie=0;Ie<W.length;Ie++){const et=W[Ie];if(et.zoom<=X)continue;et.zoom=X;const Ke=this.trees[X+1],tt=Ke.within(et.x,et.y,we),Ut=et.numPoints||1;let At=Ut;for(const Ot of tt){const Vt=Ke.points[Ot];Vt.zoom>X&&(At+=Vt.numPoints||1)}if(At>Ut&&At>=Ee){let Ot=et.x*Ut,Vt=et.y*Ut,Hi=fe&&Ut>1?this._map(et,!0):null;const gi=(Ie<<5)+(X+1)+this.points.length;for(const Ci of tt){const ci=Ke.points[Ci];if(ci.zoom<=X)continue;ci.zoom=X;const Kt=ci.numPoints||1;Ot+=ci.x*Kt,Vt+=ci.y*Kt,ci.parentId=gi,fe&&(Hi||(Hi=this._map(et,!0)),fe(Hi,this._map(ci)))}et.parentId=gi,ne.push(Pr(Ot/At,Vt/At,gi,At,Hi))}else if(ne.push(et),At>1)for(const Ot of tt){const Vt=Ke.points[Ot];Vt.zoom<=X||(Vt.zoom=X,ne.push(Vt))}}return ne}_getOriginId(W){return W-this.points.length>>5}_getOriginZoom(W){return(W-this.points.length)%32}_map(W,X){if(W.numPoints)return X?Zi({},W.properties):W.properties;const ne=this.points[W.index].properties,ce=this.options.map(ne);return X&&ce===ne?Zi({},ce):ce}}function Pr(ae,W,X,ne,ce){return{x:rt(ae),y:rt(W),zoom:1/0,id:X,parentId:-1,numPoints:ne,properties:ce}}function co(ae,W){const[X,ne]=ae.geometry.coordinates;return{x:rt(_n(X)),y:rt(ho(ne)),zoom:1/0,index:W,parentId:-1}}function Zn(ae){return{type:"Feature",id:ae.id,properties:Bo(ae),geometry:{type:"Point",coordinates:[(W=ae.x,360*(W-.5)),Hn(ae.y)]}};var W}function Bo(ae){const W=ae.numPoints,X=W>=1e4?`${Math.round(W/1e3)}k`:W>=1e3?Math.round(W/100)/10+"k":W;return Zi(Zi({},ae.properties),{cluster:!0,cluster_id:ae.id,point_count:W,point_count_abbreviated:X})}function _n(ae){return ae/360+.5}function ho(ae){const W=Math.sin(ae*Math.PI/180),X=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return X<0?0:X>1?1:X}function Hn(ae){const W=(180-360*ae)*Math.PI/180;return 360*Math.atan(Math.exp(W))/Math.PI-90}function Zi(ae,W){for(const X in W)ae[X]=W[X];return ae}function Un(ae){return ae.x}function Ao(ae){return ae.y}function Wn(ae,W,X,ne){for(var ce,_e=ne,fe=X-W>>1,Ee=X-W,we=ae[W],Ie=ae[W+1],et=ae[X],Ke=ae[X+1],tt=W+3;tt<X;tt+=3){var Ut=Ba(ae[tt],ae[tt+1],we,Ie,et,Ke);if(Ut>_e)ce=tt,_e=Ut;else if(Ut===_e){var At=Math.abs(tt-fe);At<Ee&&(ce=tt,Ee=At)}}_e>ne&&(ce-W>3&&Wn(ae,W,ce,ne),ae[ce+2]=_e,X-ce>3&&Wn(ae,ce,X,ne))}function Ba(ae,W,X,ne,ce,_e){var fe=ce-X,Ee=_e-ne;if(fe!==0||Ee!==0){var we=((ae-X)*fe+(W-ne)*Ee)/(fe*fe+Ee*Ee);we>1?(X=ce,ne=_e):we>0&&(X+=fe*we,ne+=Ee*we)}return(fe=ae-X)*fe+(Ee=W-ne)*Ee}function Ue(ae,W,X,ne){var ce={id:ae===void 0?null:ae,type:W,geometry:X,tags:ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(_e){var fe=_e.geometry,Ee=_e.type;if(Ee==="Point"||Ee==="MultiPoint"||Ee==="LineString")gt(_e,fe);else if(Ee==="Polygon"||Ee==="MultiLineString")for(var we=0;we<fe.length;we++)gt(_e,fe[we]);else if(Ee==="MultiPolygon")for(we=0;we<fe.length;we++)for(var Ie=0;Ie<fe[we].length;Ie++)gt(_e,fe[we][Ie])}(ce),ce}function gt(ae,W){for(var X=0;X<W.length;X+=3)ae.minX=Math.min(ae.minX,W[X]),ae.minY=Math.min(ae.minY,W[X+1]),ae.maxX=Math.max(ae.maxX,W[X]),ae.maxY=Math.max(ae.maxY,W[X+1])}function Si(ae,W,X,ne){if(W.geometry){var ce=W.geometry.coordinates,_e=W.geometry.type,fe=Math.pow(X.tolerance/((1<<X.maxZoom)*X.extent),2),Ee=[],we=W.id;if(X.promoteId?we=W.properties[X.promoteId]:X.generateId&&(we=ne||0),_e==="Point")yr(ce,Ee);else if(_e==="MultiPoint")for(var Ie=0;Ie<ce.length;Ie++)yr(ce[Ie],Ee);else if(_e==="LineString")br(ce,Ee,fe,!1);else if(_e==="MultiLineString"){if(X.lineMetrics){for(Ie=0;Ie<ce.length;Ie++)br(ce[Ie],Ee=[],fe,!1),ae.push(Ue(we,"LineString",Ee,W.properties));return}Xn(ce,Ee,fe,!1)}else if(_e==="Polygon")Xn(ce,Ee,fe,!0);else{if(_e!=="MultiPolygon"){if(_e==="GeometryCollection"){for(Ie=0;Ie<W.geometry.geometries.length;Ie++)Si(ae,{id:we,geometry:W.geometry.geometries[Ie],properties:W.properties},X,ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ie=0;Ie<ce.length;Ie++){var et=[];Xn(ce[Ie],et,fe,!0),Ee.push(et)}}ae.push(Ue(we,_e,Ee,W.properties))}}function yr(ae,W){W.push(Kn(ae[0])),W.push(na(ae[1])),W.push(0)}function br(ae,W,X,ne){for(var ce,_e,fe=0,Ee=0;Ee<ae.length;Ee++){var we=Kn(ae[Ee][0]),Ie=na(ae[Ee][1]);W.push(we),W.push(Ie),W.push(0),Ee>0&&(fe+=ne?(ce*Ie-we*_e)/2:Math.sqrt(Math.pow(we-ce,2)+Math.pow(Ie-_e,2))),ce=we,_e=Ie}var et=W.length-3;W[2]=1,Wn(W,0,et,X),W[et+2]=1,W.size=Math.abs(fe),W.start=0,W.end=W.size}function Xn(ae,W,X,ne){for(var ce=0;ce<ae.length;ce++){var _e=[];br(ae[ce],_e,X,ne),W.push(_e)}}function Kn(ae){return ae/360+.5}function na(ae){var W=Math.sin(ae*Math.PI/180),X=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return X<0?0:X>1?1:X}function Yr(ae,W,X,ne,ce,_e,fe,Ee){if(ne/=W,_e>=(X/=W)&&fe<ne)return ae;if(fe<X||_e>=ne)return null;for(var we=[],Ie=0;Ie<ae.length;Ie++){var et=ae[Ie],Ke=et.geometry,tt=et.type,Ut=ce===0?et.minX:et.minY,At=ce===0?et.maxX:et.maxY;if(Ut>=X&&At<ne)we.push(et);else if(!(At<X||Ut>=ne)){var Ot=[];if(tt==="Point"||tt==="MultiPoint")Ht(Ke,Ot,X,ne,ce);else if(tt==="LineString")nr(Ke,Ot,X,ne,ce,!1,Ee.lineMetrics);else if(tt==="MultiLineString")Dn(Ke,Ot,X,ne,ce,!1);else if(tt==="Polygon")Dn(Ke,Ot,X,ne,ce,!0);else if(tt==="MultiPolygon")for(var Vt=0;Vt<Ke.length;Vt++){var Hi=[];Dn(Ke[Vt],Hi,X,ne,ce,!0),Hi.length&&Ot.push(Hi)}if(Ot.length){if(Ee.lineMetrics&&tt==="LineString"){for(Vt=0;Vt<Ot.length;Vt++)we.push(Ue(et.id,tt,Ot[Vt],et.tags));continue}tt!=="LineString"&&tt!=="MultiLineString"||(Ot.length===1?(tt="LineString",Ot=Ot[0]):tt="MultiLineString"),tt!=="Point"&&tt!=="MultiPoint"||(tt=Ot.length===3?"Point":"MultiPoint"),we.push(Ue(et.id,tt,Ot,et.tags))}}}return we.length?we:null}function Ht(ae,W,X,ne,ce){for(var _e=0;_e<ae.length;_e+=3){var fe=ae[_e+ce];fe>=X&&fe<=ne&&(W.push(ae[_e]),W.push(ae[_e+1]),W.push(ae[_e+2]))}}function nr(ae,W,X,ne,ce,_e,fe){for(var Ee,we,Ie=Ki(ae),et=ce===0?Ni:ya,Ke=ae.start,tt=0;tt<ae.length-3;tt+=3){var Ut=ae[tt],At=ae[tt+1],Ot=ae[tt+2],Vt=ae[tt+3],Hi=ae[tt+4],gi=ce===0?Ut:At,Ci=ce===0?Vt:Hi,ci=!1;fe&&(Ee=Math.sqrt(Math.pow(Ut-Vt,2)+Math.pow(At-Hi,2))),gi<X?Ci>X&&(we=et(Ie,Ut,At,Vt,Hi,X),fe&&(Ie.start=Ke+Ee*we)):gi>ne?Ci<ne&&(we=et(Ie,Ut,At,Vt,Hi,ne),fe&&(Ie.start=Ke+Ee*we)):Jn(Ie,Ut,At,Ot),Ci<X&&gi>=X&&(we=et(Ie,Ut,At,Vt,Hi,X),ci=!0),Ci>ne&&gi<=ne&&(we=et(Ie,Ut,At,Vt,Hi,ne),ci=!0),!_e&&ci&&(fe&&(Ie.end=Ke+Ee*we),W.push(Ie),Ie=Ki(ae)),fe&&(Ke+=Ee)}var Kt=ae.length-3;Ut=ae[Kt],At=ae[Kt+1],Ot=ae[Kt+2],(gi=ce===0?Ut:At)>=X&&gi<=ne&&Jn(Ie,Ut,At,Ot),Kt=Ie.length-3,_e&&Kt>=3&&(Ie[Kt]!==Ie[0]||Ie[Kt+1]!==Ie[1])&&Jn(Ie,Ie[0],Ie[1],Ie[2]),Ie.length&&W.push(Ie)}function Ki(ae){var W=[];return W.size=ae.size,W.start=ae.start,W.end=ae.end,W}function Dn(ae,W,X,ne,ce,_e){for(var fe=0;fe<ae.length;fe++)nr(ae[fe],W,X,ne,ce,_e,!1)}function Jn(ae,W,X,ne){ae.push(W),ae.push(X),ae.push(ne)}function Ni(ae,W,X,ne,ce,_e){var fe=(_e-W)/(ne-W);return ae.push(_e),ae.push(X+(ce-X)*fe),ae.push(1),fe}function ya(ae,W,X,ne,ce,_e){var fe=(_e-X)/(ce-X);return ae.push(W+(ne-W)*fe),ae.push(_e),ae.push(1),fe}function Oo(ae,W){for(var X=[],ne=0;ne<ae.length;ne++){var ce,_e=ae[ne],fe=_e.type;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")ce=Xr(_e.geometry,W);else if(fe==="MultiLineString"||fe==="Polygon"){ce=[];for(var Ee=0;Ee<_e.geometry.length;Ee++)ce.push(Xr(_e.geometry[Ee],W))}else if(fe==="MultiPolygon")for(ce=[],Ee=0;Ee<_e.geometry.length;Ee++){for(var we=[],Ie=0;Ie<_e.geometry[Ee].length;Ie++)we.push(Xr(_e.geometry[Ee][Ie],W));ce.push(we)}X.push(Ue(_e.id,fe,ce,_e.tags))}return X}function Xr(ae,W){var X=[];X.size=ae.size,ae.start!==void 0&&(X.start=ae.start,X.end=ae.end);for(var ne=0;ne<ae.length;ne+=3)X.push(ae[ne]+W,ae[ne+1],ae[ne+2]);return X}function te(ae,W){if(ae.transformed)return ae;var X,ne,ce,_e=1<<ae.z,fe=ae.x,Ee=ae.y;for(X=0;X<ae.features.length;X++){var we=ae.features[X],Ie=we.geometry,et=we.type;if(we.geometry=[],et===1)for(ne=0;ne<Ie.length;ne+=2)we.geometry.push(oe(Ie[ne],Ie[ne+1],W,_e,fe,Ee));else for(ne=0;ne<Ie.length;ne++){var Ke=[];for(ce=0;ce<Ie[ne].length;ce+=2)Ke.push(oe(Ie[ne][ce],Ie[ne][ce+1],W,_e,fe,Ee));we.geometry.push(Ke)}}return ae.transformed=!0,ae}function oe(ae,W,X,ne,ce,_e){return[Math.round(X*(ae*ne-ce)),Math.round(X*(W*ne-_e))]}function le(ae,W,X,ne,ce){for(var _e=W===ce.maxZoom?0:ce.tolerance/((1<<W)*ce.extent),fe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:X,y:ne,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ee=0;Ee<ae.length;Ee++){fe.numFeatures++,ge(fe,ae[Ee],_e,ce);var we=ae[Ee].minX,Ie=ae[Ee].minY,et=ae[Ee].maxX,Ke=ae[Ee].maxY;we<fe.minX&&(fe.minX=we),Ie<fe.minY&&(fe.minY=Ie),et>fe.maxX&&(fe.maxX=et),Ke>fe.maxY&&(fe.maxY=Ke)}return fe}function ge(ae,W,X,ne){var ce=W.geometry,_e=W.type,fe=[];if(_e==="Point"||_e==="MultiPoint")for(var Ee=0;Ee<ce.length;Ee+=3)fe.push(ce[Ee]),fe.push(ce[Ee+1]),ae.numPoints++,ae.numSimplified++;else if(_e==="LineString")Se(fe,ce,ae,X,!1,!1);else if(_e==="MultiLineString"||_e==="Polygon")for(Ee=0;Ee<ce.length;Ee++)Se(fe,ce[Ee],ae,X,_e==="Polygon",Ee===0);else if(_e==="MultiPolygon")for(var we=0;we<ce.length;we++){var Ie=ce[we];for(Ee=0;Ee<Ie.length;Ee++)Se(fe,Ie[Ee],ae,X,!0,Ee===0)}if(fe.length){var et=W.tags||null;if(_e==="LineString"&&ne.lineMetrics){for(var Ke in et={},W.tags)et[Ke]=W.tags[Ke];et.mapbox_clip_start=ce.start/ce.size,et.mapbox_clip_end=ce.end/ce.size}var tt={geometry:fe,type:_e==="Polygon"||_e==="MultiPolygon"?3:_e==="LineString"||_e==="MultiLineString"?2:1,tags:et};W.id!==null&&(tt.id=W.id),ae.features.push(tt)}}function Se(ae,W,X,ne,ce,_e){var fe=ne*ne;if(ne>0&&W.size<(ce?fe:ne))X.numPoints+=W.length/3;else{for(var Ee=[],we=0;we<W.length;we+=3)(ne===0||W[we+2]>fe)&&(X.numSimplified++,Ee.push(W[we]),Ee.push(W[we+1])),X.numPoints++;ce&&function(Ie,et){for(var Ke=0,tt=0,Ut=Ie.length,At=Ut-2;tt<Ut;At=tt,tt+=2)Ke+=(Ie[tt]-Ie[At])*(Ie[tt+1]+Ie[At+1]);if(Ke>0===et)for(tt=0,Ut=Ie.length;tt<Ut/2;tt+=2){var Ot=Ie[tt],Vt=Ie[tt+1];Ie[tt]=Ie[Ut-2-tt],Ie[tt+1]=Ie[Ut-1-tt],Ie[Ut-2-tt]=Ot,Ie[Ut-1-tt]=Vt}}(Ee,_e),ae.push(Ee)}}function Oe(ae,W){var X=(W=this.options=function(ce,_e){for(var fe in _e)ce[fe]=_e[fe];return ce}(Object.create(this.options),W)).debug;if(X&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");var ne=function(ce,_e){var fe=[];if(ce.type==="FeatureCollection")for(var Ee=0;Ee<ce.features.length;Ee++)Si(fe,ce.features[Ee],_e,Ee);else Si(fe,ce.type==="Feature"?ce:{geometry:ce},_e);return fe}(ae,W);this.tiles={},this.tileCoords=[],X&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ne=function(ce,_e){var fe=_e.buffer/_e.extent,Ee=ce,we=Yr(ce,1,-1-fe,fe,0,-1,2,_e),Ie=Yr(ce,1,1-fe,2+fe,0,-1,2,_e);return(we||Ie)&&(Ee=Yr(ce,1,-fe,1+fe,0,-1,2,_e)||[],we&&(Ee=Oo(we,1).concat(Ee)),Ie&&(Ee=Ee.concat(Oo(Ie,-1)))),Ee}(ne,W),ne.length&&this.splitTile(ne,0,0,0),X&&(ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ve(ae,W,X){return 32*((1<<ae)*X+W)+ae}function ye(ae,W){const X=ae.tileID.canonical;if(!this._geoJSONIndex)return W(null,null);const ne=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!ne)return W(null,null);const ce=new pt(ne.features);let _e=Fi(ce);_e.byteOffset===0&&_e.byteLength===_e.buffer.byteLength||(_e=new Uint8Array(_e)),W(null,{vectorTile:ce,rawData:_e.buffer})}Oe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Oe.prototype.splitTile=function(ae,W,X,ne,ce,_e,fe){for(var Ee=[ae,W,X,ne],we=this.options,Ie=we.debug;Ee.length;){ne=Ee.pop(),X=Ee.pop(),W=Ee.pop(),ae=Ee.pop();var et=1<<W,Ke=Ve(W,X,ne),tt=this.tiles[Ke];if(!tt&&(Ie>1&&console.time("creation"),tt=this.tiles[Ke]=le(ae,W,X,ne,we),this.tileCoords.push({z:W,x:X,y:ne}),Ie)){Ie>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,X,ne,tt.numFeatures,tt.numPoints,tt.numSimplified),console.timeEnd("creation"));var Ut="z"+W;this.stats[Ut]=(this.stats[Ut]||0)+1,this.total++}if(tt.source=ae,ce){if(W===we.maxZoom||W===ce)continue;var At=1<<ce-W;if(X!==Math.floor(_e/At)||ne!==Math.floor(fe/At))continue}else if(W===we.indexMaxZoom||tt.numPoints<=we.indexMaxPoints)continue;if(tt.source=null,ae.length!==0){Ie>1&&console.time("clipping");var Ot,Vt,Hi,gi,Ci,ci,Kt=.5*we.buffer/we.extent,Di=.5-Kt,Ir=.5+Kt,kn=1+Kt;Ot=Vt=Hi=gi=null,Ci=Yr(ae,et,X-Kt,X+Ir,0,tt.minX,tt.maxX,we),ci=Yr(ae,et,X+Di,X+kn,0,tt.minX,tt.maxX,we),ae=null,Ci&&(Ot=Yr(Ci,et,ne-Kt,ne+Ir,1,tt.minY,tt.maxY,we),Vt=Yr(Ci,et,ne+Di,ne+kn,1,tt.minY,tt.maxY,we),Ci=null),ci&&(Hi=Yr(ci,et,ne-Kt,ne+Ir,1,tt.minY,tt.maxY,we),gi=Yr(ci,et,ne+Di,ne+kn,1,tt.minY,tt.maxY,we),ci=null),Ie>1&&console.timeEnd("clipping"),Ee.push(Ot||[],W+1,2*X,2*ne),Ee.push(Vt||[],W+1,2*X,2*ne+1),Ee.push(Hi||[],W+1,2*X+1,2*ne),Ee.push(gi||[],W+1,2*X+1,2*ne+1)}}},Oe.prototype.getTile=function(ae,W,X){var ne=this.options,ce=ne.extent,_e=ne.debug;if(ae<0||ae>24)return null;var fe=1<<ae,Ee=Ve(ae,W=(W%fe+fe)%fe,X);if(this.tiles[Ee])return te(this.tiles[Ee],ce);_e>1&&console.log("drilling down to z%d-%d-%d",ae,W,X);for(var we,Ie=ae,et=W,Ke=X;!we&&Ie>0;)Ie--,et=Math.floor(et/2),Ke=Math.floor(Ke/2),we=this.tiles[Ve(Ie,et,Ke)];return we&&we.source?(_e>1&&console.log("found parent tile z%d-%d-%d",Ie,et,Ke),_e>1&&console.time("drilling down"),this.splitTile(we.source,Ie,et,Ke,ae,W,X),_e>1&&console.timeEnd("drilling down"),this.tiles[Ee]?te(this.tiles[Ee],ce):null):null};class Me extends We{constructor(W,X,ne,ce){super(W,X,ne,ye),ce&&(this.loadGeoJSON=ce)}loadData(W,X){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=X,this._pendingLoadDataParams=W,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())}_loadData(){if(!this._pendingCallback||!this._pendingLoadDataParams)return;const W=this._pendingCallback,X=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;const ne=!!(X&&X.request&&X.request.collectResourceTiming)&&new h.RequestPerformance(X.request);this.loadGeoJSON(X,(ce,_e)=>{if(ce||!_e)return W(ce);if(typeof _e!="object")return W(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`));{yt(_e,!0);try{if(X.filter){const Ee=h.createExpression(X.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ee.result==="error")throw new Error(Ee.value.map(Ie=>`${Ie.key}: ${Ie.message}`).join(", "));const we=_e.features.filter(Ie=>Ee.value.evaluate({zoom:0},Ie));_e={type:"FeatureCollection",features:we}}this._geoJSONIndex=X.cluster?new ir(function({superclusterOptions:Ee,clusterProperties:we}){if(!we||!Ee)return Ee;const Ie={},et={},Ke={accumulated:null,zoom:0},tt={properties:null},Ut=Object.keys(we);for(const At of Ut){const[Ot,Vt]=we[At],Hi=h.createExpression(Vt),gi=h.createExpression(typeof Ot=="string"?[Ot,["accumulated"],["get",At]]:Ot);Ie[At]=Hi.value,et[At]=gi.value}return Ee.map=At=>{tt.properties=At;const Ot={};for(const Vt of Ut)Ot[Vt]=Ie[Vt].evaluate(Ke,tt);return Ot},Ee.reduce=(At,Ot)=>{tt.properties=Ot;for(const Vt of Ut)Ke.accumulated=At[Vt],At[Vt]=et[Vt].evaluate(Ke,tt)},Ee}(X)).load(_e.features):function(Ee,we){return new Oe(Ee,we)}(_e,X.geojsonVtOptions)}catch(Ee){return W(Ee)}this.loaded={};const fe={};if(ne){const Ee=ne.finish();Ee&&(fe.resourceTiming={},fe.resourceTiming[X.source]=JSON.parse(JSON.stringify(Ee)))}W(null,fe)}})}coalesce(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())}reloadTile(W,X){const ne=this.loaded;return ne&&ne[W.uid]?super.reloadTile(W,X):this.loadTile(W,X)}loadGeoJSON(W,X){if(W.request)h.getJSON(W.request,X);else{if(typeof W.data!="string")return X(new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`));try{return X(null,JSON.parse(W.data))}catch{return X(new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`))}}}removeSource(W,X){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),X()}getClusterExpansionZoom(W,X){try{X(null,this._geoJSONIndex.getClusterExpansionZoom(W.clusterId))}catch(ne){X(ne)}}getClusterChildren(W,X){try{X(null,this._geoJSONIndex.getChildren(W.clusterId))}catch(ne){X(ne)}}getClusterLeaves(W,X){try{X(null,this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset))}catch(ne){X(ne)}}}class Qe{constructor(W){this.self=W,this.actor=new h.Actor(W,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:We,geojson:Me},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(X,ne)=>{if(this.workerSourceTypes[X])throw new Error(`Worker source with name "${X}" already registered.`);this.workerSourceTypes[X]=ne},this.self.registerRTLTextPlugin=X=>{if(h.plugin.isParsed())throw new Error("RTL text plugin already registered.");h.plugin.applyArabicShaping=X.applyArabicShaping,h.plugin.processBidirectionalText=X.processBidirectionalText,h.plugin.processStyledBidirectionalText=X.processStyledBidirectionalText}}setReferrer(W,X){this.referrer=X}setImages(W,X,ne){this.availableImages[W]=X;for(const ce in this.workerSources[W]){const _e=this.workerSources[W][ce];for(const fe in _e)_e[fe].availableImages=X}ne()}setLayers(W,X,ne){this.getLayerIndex(W).replace(X),ne()}updateLayers(W,X,ne){this.getLayerIndex(W).update(X.layers,X.removedIds),ne()}loadTile(W,X,ne){this.getWorkerSource(W,X.type,X.source).loadTile(X,ne)}loadDEMTile(W,X,ne){this.getDEMWorkerSource(W,X.source).loadTile(X,ne)}reloadTile(W,X,ne){this.getWorkerSource(W,X.type,X.source).reloadTile(X,ne)}abortTile(W,X,ne){this.getWorkerSource(W,X.type,X.source).abortTile(X,ne)}removeTile(W,X,ne){this.getWorkerSource(W,X.type,X.source).removeTile(X,ne)}removeDEMTile(W,X){this.getDEMWorkerSource(W,X.source).removeTile(X)}removeSource(W,X,ne){if(!this.workerSources[W]||!this.workerSources[W][X.type]||!this.workerSources[W][X.type][X.source])return;const ce=this.workerSources[W][X.type][X.source];delete this.workerSources[W][X.type][X.source],ce.removeSource!==void 0?ce.removeSource(X,ne):ne()}loadWorkerSource(W,X,ne){try{this.self.importScripts(X.url),ne()}catch(ce){ne(ce.toString())}}syncRTLPluginState(W,X,ne){try{h.plugin.setState(X);const ce=h.plugin.getPluginURL();if(h.plugin.isLoaded()&&!h.plugin.isParsed()&&ce!=null){this.self.importScripts(ce);const _e=h.plugin.isParsed();ne(_e?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ce}`),_e)}}catch(ce){ne(ce.toString())}}getAvailableImages(W){let X=this.availableImages[W];return X||(X=[]),X}getLayerIndex(W){let X=this.layerIndexes[W];return X||(X=this.layerIndexes[W]=new F),X}getWorkerSource(W,X,ne){if(this.workerSources[W]||(this.workerSources[W]={}),this.workerSources[W][X]||(this.workerSources[W][X]={}),!this.workerSources[W][X][ne]){const ce={send:(_e,fe,Ee)=>{this.actor.send(_e,fe,Ee,W)}};this.workerSources[W][X][ne]=new this.workerSourceTypes[X](ce,this.getLayerIndex(W),this.getAvailableImages(W))}return this.workerSources[W][X][ne]}getDEMWorkerSource(W,X){return this.demWorkerSources[W]||(this.demWorkerSources[W]={}),this.demWorkerSources[W][X]||(this.demWorkerSources[W][X]=new je),this.demWorkerSources[W][X]}enforceCacheSizeLimit(W,X){h.enforceCacheSizeLimit(X)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Qe(self)),Qe}),z(["./shared"],function(h){var D=N;function N(T){return!function(o){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,A,M=new Blob([""],{type:"text/javascript"}),U=URL.createObjectURL(M);try{A=new Worker(U),S=!0}catch{S=!1}return A&&A.terminate(),URL.revokeObjectURL(U),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var A=S.getContext("2d");if(!A)return!1;var M=A.getImageData(0,0,1,1);return M&&M.width===S.width}()?(F[y=o&&o.failIfMajorPerformanceCaveat]===void 0&&(F[y]=function(S){var A,M=function(U){var Z=document.createElement("canvas"),J=Object.create(N.webGLContextAttributes);return J.failIfMajorPerformanceCaveat=U,Z.getContext("webgl",J)||Z.getContext("experimental-webgl",J)}(S);if(!M)return!1;try{A=M.createShader(M.VERTEX_SHADER)}catch{return!1}return!(!A||M.isContextLost())&&(M.shaderSource(A,"void main() {}"),M.compileShader(A),M.getShaderParameter(A,M.COMPILE_STATUS)===!0)}(y)),F[y]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var y}(T)}var F={};function G(T,o){if(Array.isArray(T)){if(!Array.isArray(o)||T.length!==o.length)return!1;for(let y=0;y<T.length;y++)if(!G(T[y],o[y]))return!1;return!0}if(typeof T=="object"&&T!==null&&o!==null){if(typeof o!="object"||Object.keys(T).length!==Object.keys(o).length)return!1;for(const y in T)if(!G(T[y],o[y]))return!1;return!0}return T===o}N.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class H{static testProp(o){if(!H.docStyle)return o[0];for(let y=0;y<o.length;y++)if(o[y]in H.docStyle)return o[y];return o[0]}static create(o,y,S){const A=window.document.createElement(o);return y!==void 0&&(A.className=y),S&&S.appendChild(A),A}static createNS(o,y){return window.document.createElementNS(o,y)}static disableDrag(){H.docStyle&&H.selectProp&&(H.userSelect=H.docStyle[H.selectProp],H.docStyle[H.selectProp]="none")}static enableDrag(){H.docStyle&&H.selectProp&&(H.docStyle[H.selectProp]=H.userSelect)}static setTransform(o,y){o.style[H.transformProp]=y}static addEventListener(o,y,S,A={}){o.addEventListener(y,S,"passive"in A?A:A.capture)}static removeEventListener(o,y,S,A={}){o.removeEventListener(y,S,"passive"in A?A:A.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",H.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",H.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",H.suppressClickInternal,!0)},0)}static mousePos(o,y){const S=o.getBoundingClientRect();return new h.pointGeometry(y.clientX-S.left-o.clientLeft,y.clientY-S.top-o.clientTop)}static touchPos(o,y){const S=o.getBoundingClientRect(),A=[];for(let M=0;M<y.length;M++)A.push(new h.pointGeometry(y[M].clientX-S.left-o.clientLeft,y[M].clientY-S.top-o.clientTop));return A}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}H.docStyle=typeof window!="undefined"&&window.document&&window.document.documentElement.style,H.selectProp=H.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),H.transformProp=H.testProp(["transform","WebkitTransform"]);class Pe{constructor(o){this._transformRequestFn=o}transformRequest(o,y){return this._transformRequestFn&&this._transformRequestFn(o,y)||{url:o}}normalizeSpriteURL(o,y,S){const A=function(M){const U=M.match(ke);if(!U)throw new Error(`Unable to parse URL "${M}"`);return{protocol:U[1],authority:U[2],path:U[3]||"/",params:U[4]?U[4].split("&"):[]}}(o);return A.path+=`${y}${S}`,function(M){const U=M.params.length?`?${M.params.join("&")}`:"";return`${M.protocol}://${M.authority}${M.path}${U}`}(A)}setTransformRequest(o){this._transformRequestFn=o}}const ke=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function We(T){var o=new h.ARRAY_TYPE(3);return o[0]=T[0],o[1]=T[1],o[2]=T[2],o}var je,yt=function(T,o,y){return T[0]=o[0]-y[0],T[1]=o[1]-y[1],T[2]=o[2]-y[2],T};je=new h.ARRAY_TYPE(3),h.ARRAY_TYPE!=Float32Array&&(je[0]=0,je[1]=0,je[2]=0);var Ne=function(T){var o=T[0],y=T[1];return o*o+y*y};(function(){var T=new h.ARRAY_TYPE(2);h.ARRAY_TYPE!=Float32Array&&(T[0]=0,T[1]=0)})();class Ze{constructor(o,y,S,A){this.context=o,this.format=S,this.texture=o.gl.createTexture(),this.update(y,A)}update(o,y,S){const{width:A,height:M}=o,U=!(this.size&&this.size[0]===A&&this.size[1]===M||S),{context:Z}=this,{gl:J}=Z;if(this.useMipmap=Boolean(y&&y.useMipmap),J.bindTexture(J.TEXTURE_2D,this.texture),Z.pixelStoreUnpackFlipY.set(!1),Z.pixelStoreUnpack.set(1),Z.pixelStoreUnpackPremultiplyAlpha.set(this.format===J.RGBA&&(!y||y.premultiply!==!1)),U)this.size=[A,M],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||h.isImageBitmap(o)?J.texImage2D(J.TEXTURE_2D,0,this.format,this.format,J.UNSIGNED_BYTE,o):J.texImage2D(J.TEXTURE_2D,0,this.format,A,M,0,this.format,J.UNSIGNED_BYTE,o.data);else{const{x:ee,y:re}=S||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||h.isImageBitmap(o)?J.texSubImage2D(J.TEXTURE_2D,0,ee,re,J.RGBA,J.UNSIGNED_BYTE,o):J.texSubImage2D(J.TEXTURE_2D,0,ee,re,A,M,J.RGBA,J.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&J.generateMipmap(J.TEXTURE_2D)}bind(o,y,S){const{context:A}=this,{gl:M}=A;M.bindTexture(M.TEXTURE_2D,this.texture),S!==M.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(S=M.LINEAR),o!==this.filter&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,o),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,S||o),this.filter=o),y!==this.wrap&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,y),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,y),this.wrap=y)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function vt(T){const{userImage:o}=T;return!!(o&&o.render&&o.render())&&(T.data.replace(new Uint8Array(o.data.buffer)),!0)}class ct extends h.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:y,callback:S}of this.requestors)this._notify(y,S);this.requestors=[]}}getImage(o){return this.images[o]}addImage(o,y){this._validate(o,y)&&(this.images[o]=y)}_validate(o,y){let S=!0;return this._validateStretch(y.stretchX,y.data&&y.data.width)||(this.fire(new h.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),S=!1),this._validateStretch(y.stretchY,y.data&&y.data.height)||(this.fire(new h.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),S=!1),this._validateContent(y.content,y)||(this.fire(new h.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),S=!1),S}_validateStretch(o,y){if(!o)return!0;let S=0;for(const A of o){if(A[0]<S||A[1]<A[0]||y<A[1])return!1;S=A[1]}return!0}_validateContent(o,y){return!(o&&(o.length!==4||o[0]<0||y.data.width<o[0]||o[1]<0||y.data.height<o[1]||o[2]<0||y.data.width<o[2]||o[3]<0||y.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,y){y.version=this.images[o].version+1,this.images[o]=y,this.updatedImages[o]=!0}removeImage(o){const y=this.images[o];delete this.images[o],delete this.patterns[o],y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,y){let S=!0;if(!this.isLoaded())for(const A of o)this.images[A]||(S=!1);this.isLoaded()||S?this._notify(o,y):this.requestors.push({ids:o,callback:y})}_notify(o,y){const S={};for(const A of o){this.images[A]||this.fire(new h.Event("styleimagemissing",{id:A}));const M=this.images[A];M?S[A]={data:M.data.clone(),pixelRatio:M.pixelRatio,sdf:M.sdf,version:M.version,stretchX:M.stretchX,stretchY:M.stretchY,content:M.content,hasRenderCallback:Boolean(M.userImage&&M.userImage.render)}:h.warnOnce(`Image "${A}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}y(null,S)}getPixelSize(){const{width:o,height:y}=this.atlasImage;return{width:o,height:y}}getPattern(o){const y=this.patterns[o],S=this.getImage(o);if(!S)return null;if(y&&y.position.version===S.version)return y.position;if(y)y.position.version=S.version;else{const A={w:S.data.width+2,h:S.data.height+2,x:0,y:0},M=new h.ImagePosition(A,S);this.patterns[o]={bin:A,position:M}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const y=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ze(o,this.atlasImage,y.RGBA),this.atlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const M in this.patterns)o.push(this.patterns[M].bin);const{w:y,h:S}=h.potpack(o),A=this.atlasImage;A.resize({width:y||1,height:S||1});for(const M in this.patterns){const{bin:U}=this.patterns[M],Z=U.x+1,J=U.y+1,ee=this.images[M].data,re=ee.width,ue=ee.height;h.RGBAImage.copy(ee,A,{x:0,y:0},{x:Z,y:J},{width:re,height:ue}),h.RGBAImage.copy(ee,A,{x:0,y:ue-1},{x:Z,y:J-1},{width:re,height:1}),h.RGBAImage.copy(ee,A,{x:0,y:0},{x:Z,y:J+ue},{width:re,height:1}),h.RGBAImage.copy(ee,A,{x:re-1,y:0},{x:Z-1,y:J},{width:1,height:ue}),h.RGBAImage.copy(ee,A,{x:0,y:0},{x:Z+re,y:J},{width:1,height:ue})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const y of o){if(this.callbackDispatchedThisFrame[y])continue;this.callbackDispatchedThisFrame[y]=!0;const S=this.images[y];vt(S)&&this.updateImage(y,S)}}}const pt=1e20;function lt(T,o,y,S,A,M,U,Z,J){for(let ee=o;ee<o+S;ee++)fi(T,y*M+ee,M,A,U,Z,J);for(let ee=y;ee<y+A;ee++)fi(T,ee*M+o,1,S,U,Z,J)}function fi(T,o,y,S,A,M,U){M[0]=0,U[0]=-pt,U[1]=pt,A[0]=T[o];for(let Z=1,J=0,ee=0;Z<S;Z++){A[Z]=T[o+Z*y];const re=Z*Z;do{const ue=M[J];ee=(A[Z]-A[ue]+re-ue*ue)/(Z-ue)/2}while(ee<=U[J]&&--J>-1);J++,M[J]=Z,U[J]=ee,U[J+1]=pt}for(let Z=0,J=0;Z<S;Z++){for(;U[J+1]<Z;)J++;const ee=M[J],re=Z-ee;T[o+Z*y]=A[ee]+re*re}}class Et{constructor(o,y){this.requestManager=o,this.localIdeographFontFamily=y,this.entries={}}setURL(o){this.url=o}getGlyphs(o,y){const S=[];for(const A in o)for(const M of o[A])S.push({stack:A,id:M});h.asyncAll(S,({stack:A,id:M},U)=>{let Z=this.entries[A];Z||(Z=this.entries[A]={glyphs:{},requests:{},ranges:{}});let J=Z.glyphs[M];if(J!==void 0)return void U(null,{stack:A,id:M,glyph:J});if(J=this._tinySDF(Z,A,M),J)return Z.glyphs[M]=J,void U(null,{stack:A,id:M,glyph:J});const ee=Math.floor(M/256);if(256*ee>65535)return void U(new Error("glyphs > 65535 not supported"));if(Z.ranges[ee])return void U(null,{stack:A,id:M,glyph:J});let re=Z.requests[ee];re||(re=Z.requests[ee]=[],Et.loadGlyphRange(A,ee,this.url,this.requestManager,(ue,ve)=>{if(ve){for(const Re in ve)this._doesCharSupportLocalGlyph(+Re)||(Z.glyphs[+Re]=ve[+Re]);Z.ranges[ee]=!0}for(const Re of re)Re(ue,ve);delete Z.requests[ee]})),re.push((ue,ve)=>{ue?U(ue):ve&&U(null,{stack:A,id:M,glyph:ve[M]||null})})},(A,M)=>{if(A)y(A);else if(M){const U={};for(const{stack:Z,id:J,glyph:ee}of M)(U[Z]||(U[Z]={}))[J]=ee&&{id:ee.id,bitmap:ee.bitmap.clone(),metrics:ee.metrics};y(null,U)}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(h.unicodeBlockLookup["CJK Unified Ideographs"](o)||h.unicodeBlockLookup["Hangul Syllables"](o)||h.unicodeBlockLookup.Hiragana(o)||h.unicodeBlockLookup.Katakana(o))}_tinySDF(o,y,S){const A=this.localIdeographFontFamily;if(!A||!this._doesCharSupportLocalGlyph(S))return;let M=o.tinySDF;if(!M){let Z="400";/bold/i.test(y)?Z="900":/medium/i.test(y)?Z="500":/light/i.test(y)&&(Z="200"),M=o.tinySDF=new Et.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:A,fontWeight:Z})}const U=M.draw(String.fromCharCode(S));return{id:S,bitmap:new h.AlphaImage({width:U.width||30,height:U.height||30},U.data),metrics:{width:U.glyphWidth||24,height:U.glyphHeight||24,left:U.glyphLeft||0,top:U.glyphTop-27||-8,advance:U.glyphAdvance||24}}}}Et.loadGlyphRange=function(T,o,y,S,A){const M=256*o,U=M+255,Z=S.transformRequest(y.replace("{fontstack}",T).replace("{range}",`${M}-${U}`),h.ResourceType.Glyphs);h.getArrayBuffer(Z,(J,ee)=>{if(J)A(J);else if(ee){const re={};for(const ue of h.parseGlyphPBF(ee))re[ue.id]=ue;A(null,re)}})},Et.TinySDF=class{constructor({fontSize:T=24,buffer:o=3,radius:y=8,cutoff:S=.25,fontFamily:A="sans-serif",fontWeight:M="normal",fontStyle:U="normal"}={}){this.buffer=o,this.cutoff=S,this.radius=y;const Z=this.size=T+4*o,J=this._createCanvas(Z),ee=this.ctx=J.getContext("2d",{willReadFrequently:!0});ee.font=`${U} ${M} ${T}px ${A}`,ee.textBaseline="alphabetic",ee.textAlign="left",ee.fillStyle="black",this.gridOuter=new Float64Array(Z*Z),this.gridInner=new Float64Array(Z*Z),this.f=new Float64Array(Z),this.z=new Float64Array(Z+1),this.v=new Uint16Array(Z)}_createCanvas(T){const o=document.createElement("canvas");return o.width=o.height=T,o}draw(T){const{width:o,actualBoundingBoxAscent:y,actualBoundingBoxDescent:S,actualBoundingBoxLeft:A,actualBoundingBoxRight:M}=this.ctx.measureText(T),U=Math.ceil(y),Z=Math.min(this.size-this.buffer,Math.ceil(M-A)),J=Math.min(this.size-this.buffer,U+Math.ceil(S)),ee=Z+2*this.buffer,re=J+2*this.buffer,ue=Math.max(ee*re,0),ve=new Uint8ClampedArray(ue),Re={data:ve,width:ee,height:re,glyphWidth:Z,glyphHeight:J,glyphTop:U,glyphLeft:0,glyphAdvance:o};if(Z===0||J===0)return Re;const{ctx:be,buffer:De,gridInner:Je,gridOuter:Xe}=this;be.clearRect(De,De,Z,J),be.fillText(T,De,De+U);const nt=be.getImageData(De,De,Z,J);Xe.fill(pt,0,ue),Je.fill(0,0,ue);for(let Ye=0;Ye<J;Ye++)for(let xt=0;xt<Z;xt++){const ht=nt.data[4*(Ye*Z+xt)+3]/255;if(ht===0)continue;const ft=(Ye+De)*ee+xt+De;if(ht===1)Xe[ft]=0,Je[ft]=pt;else{const Pt=.5-ht;Xe[ft]=Pt>0?Pt*Pt:0,Je[ft]=Pt<0?Pt*Pt:0}}lt(Xe,0,0,ee,re,ee,this.f,this.v,this.z),lt(Je,De,De,Z,J,ee,this.f,this.v,this.z);for(let Ye=0;Ye<ue;Ye++){const xt=Math.sqrt(Xe[Ye])-Math.sqrt(Je[Ye]);ve[Ye]=Math.round(255-255*(xt/this.radius+this.cutoff))}return Re}};const Wt=new h.Properties({anchor:new h.DataConstantProperty(h.spec.light.anchor),position:new class{constructor(){this.specification=h.spec.light.position}possiblyEvaluate(T,o){return h.sphericalToCartesian(T.expression.evaluate(o))}interpolate(T,o,y){return{x:h.number(T.x,o.x,y),y:h.number(T.y,o.y,y),z:h.number(T.z,o.z,y)}}},color:new h.DataConstantProperty(h.spec.light.color),intensity:new h.DataConstantProperty(h.spec.light.intensity)}),Ei="-transition";class qi extends h.Evented{constructor(o){super(),this._transitionable=new h.Transitionable(Wt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,y={}){if(!this._validate(h.validateLight,o,y))for(const S in o){const A=o[S];S.endsWith(Ei)?this._transitionable.setTransition(S.slice(0,-Ei.length),A):this._transitionable.setValue(S,A)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,y,S){return(!S||S.validate!==!1)&&h.emitValidationErrors(this,o.call(h.validateStyle,h.extend({value:y,style:{glyphs:!0,sprite:!0},styleSpec:h.spec})))}}class Xt{constructor(o,y){this.width=o,this.height=y,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,y){const S=o.join(",")+String(y);return this.dashEntry[S]||(this.dashEntry[S]=this.addDash(o,y)),this.dashEntry[S]}getDashRanges(o,y,S){const A=[];let M=o.length%2==1?-o[o.length-1]*S:0,U=o[0]*S,Z=!0;A.push({left:M,right:U,isDash:Z,zeroLength:o[0]===0});let J=o[0];for(let ee=1;ee<o.length;ee++){Z=!Z;const re=o[ee];M=J*S,J+=re,U=J*S,A.push({left:M,right:U,isDash:Z,zeroLength:re===0})}return A}addRoundDash(o,y,S){const A=y/2;for(let M=-S;M<=S;M++){const U=this.width*(this.nextRow+S+M);let Z=0,J=o[Z];for(let ee=0;ee<this.width;ee++){ee/J.right>1&&(J=o[++Z]);const re=Math.abs(ee-J.left),ue=Math.abs(ee-J.right),ve=Math.min(re,ue);let Re;const be=M/S*(A+1);if(J.isDash){const De=A-Math.abs(be);Re=Math.sqrt(ve*ve+De*De)}else Re=A-Math.sqrt(ve*ve+be*be);this.data[U+ee]=Math.max(0,Math.min(255,Re+128))}}}addRegularDash(o){for(let Z=o.length-1;Z>=0;--Z){const J=o[Z],ee=o[Z+1];J.zeroLength?o.splice(Z,1):ee&&ee.isDash===J.isDash&&(ee.left=J.left,o.splice(Z,1))}const y=o[0],S=o[o.length-1];y.isDash===S.isDash&&(y.left=S.left-this.width,S.right=y.right+this.width);const A=this.width*this.nextRow;let M=0,U=o[M];for(let Z=0;Z<this.width;Z++){Z/U.right>1&&(U=o[++M]);const J=Math.abs(Z-U.left),ee=Math.abs(Z-U.right),re=Math.min(J,ee);this.data[A+Z]=Math.max(0,Math.min(255,(U.isDash?re:-re)+128))}}addDash(o,y){const S=y?7:0,A=2*S+1;if(this.nextRow+A>this.height)return h.warnOnce("LineAtlas out of space"),null;let M=0;for(let Z=0;Z<o.length;Z++)M+=o[Z];if(M!==0){const Z=this.width/M,J=this.getDashRanges(o,this.width,Z);y?this.addRoundDash(J,Z,S):this.addRegularDash(J)}const U={y:(this.nextRow+S+.5)/this.height,height:2*S/this.height,width:M};return this.nextRow+=A,this.dirty=!0,U}bind(o){const y=o.gl;this.texture?(y.bindTexture(y.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,y.texSubImage2D(y.TEXTURE_2D,0,0,0,this.width,this.height,y.ALPHA,y.UNSIGNED_BYTE,this.data))):(this.texture=y.createTexture(),y.bindTexture(y.TEXTURE_2D,this.texture),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.REPEAT),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.REPEAT),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR),y.texImage2D(y.TEXTURE_2D,0,y.ALPHA,this.width,this.height,0,y.ALPHA,y.UNSIGNED_BYTE,this.data))}}class Qt{constructor(o,y){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=h.uniqueId();const S=this.workerPool.acquire(this.id);for(let A=0;A<S.length;A++){const M=new Qt.Actor(S[A],y,this.id);M.name=`Worker ${A}`,this.actors.push(M)}}broadcast(o,y,S){h.asyncAll(this.actors,(A,M)=>{A.send(o,y,M)},S=S||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ai(T,o,y){const S=function(A,M){if(A)return y(A);if(M){const U=h.pick(h.extend(M,T),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(U.vectorLayers=M.vector_layers,U.vectorLayerIds=U.vectorLayers.map(Z=>Z.id)),y(null,U)}};return T.url?h.getJSON(o.transformRequest(T.url,h.ResourceType.Source),S):h.exported.frame(()=>S(null,T))}Qt.Actor=h.Actor;class bt{constructor(o,y,S){this.bounds=h.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=y||0,this.maxzoom=S||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const y=Math.pow(2,o.z),S=Math.floor(h.mercatorXfromLng(this.bounds.getWest())*y),A=Math.floor(h.mercatorYfromLat(this.bounds.getNorth())*y),M=Math.ceil(h.mercatorXfromLng(this.bounds.getEast())*y),U=Math.ceil(h.mercatorYfromLat(this.bounds.getSouth())*y);return o.x>=S&&o.x<M&&o.y>=A&&o.y<U}}class Gi extends h.Evented{constructor(o,y,S,A){if(super(),this.id=o,this.dispatcher=S,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.extend(this,h.pick(y,["url","scheme","tileSize","promoteId"])),this._options=h.extend({type:"vector"},y),this._collectResourceTiming=y.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(A)}load(){this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ai(this._options,this.map._requestManager,(o,y)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),o?this.fire(new h.ErrorEvent(o)):y&&(h.extend(this,y),y.bounds&&(this.tileBounds=new bt(y.bounds,this.minzoom,this.maxzoom)),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return h.extend({},this._options)}loadTile(o,y){const S=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),A={request:this.map._requestManager.transformRequest(S,h.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function M(U,Z){return delete o.request,o.aborted?y(null):U&&U.status!==404?y(U):(Z&&Z.resourceTiming&&(o.resourceTiming=Z.resourceTiming),this.map._refreshExpiredTiles&&Z&&o.setExpiryData(Z),o.loadVectorData(Z,this.map.painter),h.cacheEntryPossiblyAdded(this.dispatcher),y(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}A.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=y:o.request=o.actor.send("reloadTile",A,M.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",A,M.bind(this)))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class mr extends h.Evented{constructor(o,y,S,A){super(),this.id=o,this.dispatcher=S,this.setEventedParent(A),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.extend({type:"raster"},y),h.extend(this,h.pick(y,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ai(this._options,this.map._requestManager,(o,y)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new h.ErrorEvent(o)):y&&(h.extend(this,y),y.bounds&&(this.tileBounds=new bt(y.bounds,this.minzoom,this.maxzoom)),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return h.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,y){const S=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.request=h.getImage(this.map._requestManager.transformRequest(S,h.ResourceType.Tile),(A,M,U)=>{if(delete o.request,o.aborted)o.state="unloaded",y(null);else if(A)o.state="errored",y(A);else if(M){this.map._refreshExpiredTiles&&o.setExpiryData(U);const Z=this.map.painter.context,J=Z.gl;o.texture=this.map.painter.getTileTexture(M.width),o.texture?o.texture.update(M,{useMipmap:!0}):(o.texture=new Ze(Z,M,J.RGBA,{useMipmap:!0}),o.texture.bind(J.LINEAR,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST),Z.extTextureFilterAnisotropic&&J.texParameterf(J.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax)),o.state="loaded",h.cacheEntryPossiblyAdded(this.dispatcher),y(null)}})}abortTile(o,y){o.request&&(o.request.cancel(),delete o.request),y()}unloadTile(o,y){o.texture&&this.map.painter.saveTileTexture(o.texture),y()}hasTransition(){return!1}}let Ar;class Rt extends mr{constructor(o,y,S,A){super(o,y,S,A),this.type="raster-dem",this.maxzoom=22,this._options=h.extend({type:"raster-dem"},y),this.encoding=y.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(o,y){const S=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function A(M,U){M&&(o.state="errored",y(M)),U&&(o.dem=U,o.needsHillshadePrepare=!0,o.state="loaded",y(null))}o.request=h.getImage(this.map._requestManager.transformRequest(S,h.ResourceType.Tile),function(M,U){if(delete o.request,o.aborted)o.state="unloaded",y(null);else if(M)o.state="errored",y(M);else if(U){this.map._refreshExpiredTiles&&o.setExpiryData(U),delete U.cacheControl,delete U.expires;const Z=h.isImageBitmap(U)&&(Ar==null&&(Ar=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ar)?U:h.exported.getImageData(U,1),J={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:Z,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",J,A.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)}_getNeighboringTiles(o){const y=o.canonical,S=Math.pow(2,y.z),A=(y.x-1+S)%S,M=y.x===0?o.wrap-1:o.wrap,U=(y.x+1+S)%S,Z=y.x+1===S?o.wrap+1:o.wrap,J={};return J[new h.OverscaledTileID(o.overscaledZ,M,y.z,A,y.y).key]={backfilled:!1},J[new h.OverscaledTileID(o.overscaledZ,Z,y.z,U,y.y).key]={backfilled:!1},y.y>0&&(J[new h.OverscaledTileID(o.overscaledZ,M,y.z,A,y.y-1).key]={backfilled:!1},J[new h.OverscaledTileID(o.overscaledZ,o.wrap,y.z,y.x,y.y-1).key]={backfilled:!1},J[new h.OverscaledTileID(o.overscaledZ,Z,y.z,U,y.y-1).key]={backfilled:!1}),y.y+1<S&&(J[new h.OverscaledTileID(o.overscaledZ,M,y.z,A,y.y+1).key]={backfilled:!1},J[new h.OverscaledTileID(o.overscaledZ,o.wrap,y.z,y.x,y.y+1).key]={backfilled:!1},J[new h.OverscaledTileID(o.overscaledZ,Z,y.z,U,y.y+1).key]={backfilled:!1}),J}unloadTile(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})}}class ai extends h.Evented{constructor(o,y,S,A){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=S.getActor(),this.setEventedParent(A),this._data=y.data,this._options=h.extend({},y),this._collectResourceTiming=y.collectResourceTiming,y.maxzoom!==void 0&&(this.maxzoom=y.maxzoom),y.type&&(this.type=y.type),y.attribution&&(this.attribution=y.attribution),this.promoteId=y.promoteId;const M=h.EXTENT/this.tileSize;this.workerOptions=h.extend({source:this.id,cluster:y.cluster||!1,geojsonVtOptions:{buffer:(y.buffer!==void 0?y.buffer:128)*M,tolerance:(y.tolerance!==void 0?y.tolerance:.375)*M,extent:h.EXTENT,maxZoom:this.maxzoom,lineMetrics:y.lineMetrics||!1,generateId:y.generateId||!1},superclusterOptions:{maxZoom:y.clusterMaxZoom!==void 0?y.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,y.clusterMinPoints||2),extent:h.EXTENT,radius:(y.clusterRadius||50)*M,log:!1,generateId:y.generateId||!1},clusterProperties:y.clusterProperties,filter:y.filter},y.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData("content"),this}getClusterExpansionZoom(o,y){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},y),this}getClusterChildren(o,y){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},y),this}getClusterLeaves(o,y,S,A){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:y,offset:S},A),this}_updateWorkerData(o){const y=h.extend({},this.workerOptions),S=this._data;typeof S=="string"?(y.request=this.map._requestManager.transformRequest(h.exported.resolveURL(S),h.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(S),this._pendingLoads++,this.fire(new h.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,y,(A,M)=>{if(this._pendingLoads--,this._removed||M&&M.abandoned)return;let U=null;if(M&&M.resourceTiming&&M.resourceTiming[this.id]&&(U=M.resourceTiming[this.id].slice(0)),this.actor.send(`${this.type}.coalesce`,{source:y.source},null),A)return void this.fire(new h.ErrorEvent(A));const Z={dataType:"source",sourceDataType:o};this._collectResourceTiming&&U&&U.length>0&&h.extend(Z,{resourceTiming:U}),this.fire(new h.Event("data",Z))})}loaded(){return this._pendingLoads===0}loadTile(o,y){const S=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const A={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request=this.actor.send(S,A,(M,U)=>(delete o.request,o.unloadVectorData(),o.aborted?y(null):M?y(M):(o.loadVectorData(U,this.map.painter,S==="reloadTile"),y(null))))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return h.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var yi=h.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Fi extends h.Evented{constructor(o,y,S,A){super(),this.id=o,this.dispatcher=S,this.coordinates=y.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(A),this.options=y}load(o,y){this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this.url=this.options.url,h.getImage(this.map._requestManager.transformRequest(this.url,h.ResourceType.Image),(S,A)=>{this._loaded=!0,S?this.fire(new h.ErrorEvent(S)):A&&(this.image=A,o&&(this.coordinates=o),y&&y(),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}setCoordinates(o){this.coordinates=o;const y=o.map(h.MercatorCoordinate.fromLngLat);this.tileID=function(A){let M=1/0,U=1/0,Z=-1/0,J=-1/0;for(const ve of A)M=Math.min(M,ve.x),U=Math.min(U,ve.y),Z=Math.max(Z,ve.x),J=Math.max(J,ve.y);const ee=Math.max(Z-M,J-U),re=Math.max(0,Math.floor(-Math.log(ee)/Math.LN2)),ue=Math.pow(2,re);return new h.CanonicalTileID(re,Math.floor((M+Z)/2*ue),Math.floor((U+J)/2*ue))}(y),this.minzoom=this.maxzoom=this.tileID.z;const S=y.map(A=>this.tileID.getTilePoint(A)._round());return this._boundsArray=new h.RasterBoundsArray,this._boundsArray.emplaceBack(S[0].x,S[0].y,0,0),this._boundsArray.emplaceBack(S[1].x,S[1].y,h.EXTENT,0),this._boundsArray.emplaceBack(S[3].x,S[3].y,0,h.EXTENT),this._boundsArray.emplaceBack(S[2].x,S[2].y,h.EXTENT,h.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,y=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,yi.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ze(o,this.image,y.RGBA),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE));for(const S in this.tiles){const A=this.tiles[S];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture)}}loadTile(o,y){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},y(null)):(o.state="errored",y(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class jt extends Fi{constructor(o,y,S,A){super(o,y,S,A),this.roundZoom=!0,this.type="video",this.options=y}load(){this._loaded=!1;const o=this.options;this.urls=[];for(const y of o.urls)this.urls.push(this.map._requestManager.transformRequest(y,h.ResourceType.Source).url);h.getVideo(this.urls,(y,S)=>{this._loaded=!0,y?this.fire(new h.ErrorEvent(y)):S&&(this.video=S,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const y=this.video.seekable;o<y.start(0)||o>y.end(0)?this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${y.start(0)} and ${y.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const o=this.map.painter.context,y=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,yi.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE),y.texSubImage2D(y.TEXTURE_2D,0,0,0,y.RGBA,y.UNSIGNED_BYTE,this.video)):(this.texture=new Ze(o,this.video,y.RGBA),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE));for(const S in this.tiles){const A=this.tiles[S];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Xi extends Fi{constructor(o,y,S,A){super(o,y,S,A),y.coordinates?Array.isArray(y.coordinates)&&y.coordinates.length===4&&!y.coordinates.some(M=>!Array.isArray(M)||M.length!==2||M.some(U=>typeof U!="number"))||this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${o}`,null,'missing required property "coordinates"'))),y.animate&&typeof y.animate!="boolean"&&this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),y.canvas?typeof y.canvas=="string"||y.canvas instanceof HTMLCanvasElement||this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${o}`,null,'missing required property "canvas"'))),this.options=y,this.animate=y.animate===void 0||y.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const y=this.map.painter.context,S=y.gl;this.boundsBuffer||(this.boundsBuffer=y.createVertexBuffer(this._boundsArray,yi.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ze(y,this.canvas,S.RGBA,{premultiply:!0});for(const A in this.tiles){const M=this.tiles[A];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Ri={vector:Gi,raster:mr,"raster-dem":Rt,geojson:ai,video:jt,image:Fi,canvas:Xi};function Ii(T,o){const y=h.create();return h.translate(y,y,[1,1,0]),h.scale(y,y,[.5*T.width,.5*T.height,1]),h.multiply(y,y,T.calculatePosMatrix(o.toUnwrapped()))}function rr(T,o,y,S,A,M){const U=function(ue,ve,Re){if(ue)for(const be of ue){const De=ve[be];if(De&&De.source===Re&&De.type==="fill-extrusion")return!0}else for(const be in ve){const De=ve[be];if(De.source===Re&&De.type==="fill-extrusion")return!0}return!1}(A&&A.layers,o,T.id),Z=M.maxPitchScaleFactor(),J=T.tilesIn(S,Z,U);J.sort(zi);const ee=[];for(const ue of J)ee.push({wrappedTileID:ue.tileID.wrapped().key,queryResults:ue.tile.queryRenderedFeatures(o,y,T._state,ue.queryGeometry,ue.cameraQueryGeometry,ue.scale,A,M,Z,Ii(T.transform,ue.tileID))});const re=function(ue){const ve={},Re={};for(const be of ue){const De=be.queryResults,Je=be.wrappedTileID,Xe=Re[Je]=Re[Je]||{};for(const nt in De){const Ye=De[nt],xt=Xe[nt]=Xe[nt]||{},ht=ve[nt]=ve[nt]||[];for(const ft of Ye)xt[ft.featureIndex]||(xt[ft.featureIndex]=!0,ht.push(ft))}}return ve}(ee);for(const ue in re)re[ue].forEach(ve=>{const Re=ve.feature,be=T.getFeatureState(Re.layer["source-layer"],Re.id);Re.source=Re.layer.source,Re.layer["source-layer"]&&(Re.sourceLayer=Re.layer["source-layer"]),Re.state=be});return re}function zi(T,o){const y=T.tileID,S=o.tileID;return y.overscaledZ-S.overscaledZ||y.canonical.y-S.canonical.y||y.wrap-S.wrap||y.canonical.x-S.canonical.x}class zt{constructor(o,y){this.tileID=o,this.uid=h.uniqueId(),this.uses=0,this.tileSize=y,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const y=o+this.timeAdded;y<h.exported.now()||this.fadeEndTime&&y<this.fadeEndTime||(this.fadeEndTime=y)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}loadVectorData(o,y,S){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(A,M){const U={};if(!M)return U;for(const Z of A){const J=Z.layerIds.map(ee=>M.getLayer(ee)).filter(Boolean);if(J.length!==0){Z.layers=J,Z.stateDependentLayerIds&&(Z.stateDependentLayers=Z.stateDependentLayerIds.map(ee=>J.filter(re=>re.id===ee)[0]));for(const ee of J)U[ee.id]=Z}}return U}(o.buckets,y.style),this.hasSymbolBuckets=!1;for(const A in this.buckets){const M=this.buckets[A];if(M instanceof h.SymbolBucket){if(this.hasSymbolBuckets=!0,!S)break;M.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const A in this.buckets){const M=this.buckets[A];if(M instanceof h.SymbolBucket&&M.hasRTLText){this.hasRTLText=!0,h.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const A in this.buckets){const M=this.buckets[A];this.queryPadding=Math.max(this.queryPadding,y.style.getLayer(A).queryRadius(M))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new h.CollisionBoxArray}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const S in this.buckets){const A=this.buckets[S];A.uploadPending()&&A.upload(o)}const y=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ze(o,this.imageAtlas.image,y.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ze(o,this.glyphAtlasImage,y.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,y,S,A,M,U,Z,J,ee,re){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:A,cameraQueryGeometry:M,scale:U,tileSize:this.tileSize,pixelPosMatrix:re,transform:J,params:Z,queryPadding:this.queryPadding*ee},o,y,S):{}}querySourceFeatures(o,y){const S=this.latestFeatureIndex;if(!S||!S.rawTileData)return;const A=S.loadVTLayers(),M=y?y.sourceLayer:"",U=A._geojsonTileLayer||A[M];if(!U)return;const Z=h.createFilter(y&&y.filter),{z:J,x:ee,y:re}=this.tileID.canonical,ue={z:J,x:ee,y:re};for(let ve=0;ve<U.length;ve++){const Re=U.feature(ve);if(Z.needGeometry){const Je=h.toEvaluationFeature(Re,!0);if(!Z.filter(new h.EvaluationParameters(this.tileID.overscaledZ),Je,this.tileID.canonical))continue}else if(!Z.filter(new h.EvaluationParameters(this.tileID.overscaledZ),Re))continue;const be=S.getId(Re,M),De=new h.GeoJSONFeature(Re,J,ee,re,be);De.tile=ue,o.push(De)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const y=this.expirationTime;if(o.cacheControl){const S=h.parseCacheControl(o.cacheControl);S["max-age"]&&(this.expirationTime=Date.now()+1e3*S["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const S=Date.now();let A=!1;if(this.expirationTime>S)A=!1;else if(y)if(this.expirationTime<y)A=!0;else{const M=this.expirationTime-y;M?this.expirationTime=S+Math.max(M,3e4):A=!0}else A=!0;A?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,y){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const S=this.latestFeatureIndex.loadVTLayers();for(const A in this.buckets){if(!y.style.hasLayer(A))continue;const M=this.buckets[A],U=M.layers[0].sourceLayer||"_geojsonTileLayer",Z=S[U],J=o[U];if(!Z||!J||Object.keys(J).length===0)continue;M.update(J,Z,this.imageAtlas&&this.imageAtlas.patternPositions||{});const ee=y&&y.style&&y.style.getLayer(A);ee&&(this.queryPadding=Math.max(this.queryPadding,ee.queryRadius(M)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<h.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=h.exported.now()+o}setDependencies(o,y){const S={};for(const A of y)S[A]=!0;this.dependencies[o]=S}hasDependency(o,y){for(const S of o){const A=this.dependencies[S];if(A){for(const M of y)if(A[M])return!0}}return!1}}class tr{constructor(o,y){this.max=o,this.onRemove=y,this.reset()}reset(){for(const o in this.data)for(const y of this.data[o])y.timeout&&clearTimeout(y.timeout),this.onRemove(y.value);return this.data={},this.order=[],this}add(o,y,S){const A=o.wrapped().key;this.data[A]===void 0&&(this.data[A]=[]);const M={value:y,timeout:void 0};if(S!==void 0&&(M.timeout=setTimeout(()=>{this.remove(o,M)},S)),this.data[A].push(M),this.order.push(A),this.order.length>this.max){const U=this._getAndRemoveByKey(this.order[0]);U&&this.onRemove(U)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const y=this.data[o].shift();return y.timeout&&clearTimeout(y.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),y.value}getByKey(o){const y=this.data[o];return y?y[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,y){if(!this.has(o))return this;const S=o.wrapped().key,A=y===void 0?0:this.data[S].indexOf(y),M=this.data[S][A];return this.data[S].splice(A,1),M.timeout&&clearTimeout(M.timeout),this.data[S].length===0&&delete this.data[S],this.onRemove(M.value),this.order.splice(this.order.indexOf(S),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}filter(o){const y=[];for(const S in this.data)for(const A of this.data[S])o(A.value)||y.push(A);for(const S of y)this.remove(S.value.tileID,S)}}class Bt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,y,S){const A=String(y);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][A]=this.stateChanges[o][A]||{},h.extend(this.stateChanges[o][A],S),this.deletedStates[o]===null){this.deletedStates[o]={};for(const M in this.state[o])M!==A&&(this.deletedStates[o][M]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][A]===null){this.deletedStates[o][A]={};for(const M in this.state[o][A])S[M]||(this.deletedStates[o][A][M]=null)}else for(const M in S)this.deletedStates[o]&&this.deletedStates[o][A]&&this.deletedStates[o][A][M]===null&&delete this.deletedStates[o][A][M]}removeFeatureState(o,y,S){if(this.deletedStates[o]===null)return;const A=String(y);if(this.deletedStates[o]=this.deletedStates[o]||{},S&&y!==void 0)this.deletedStates[o][A]!==null&&(this.deletedStates[o][A]=this.deletedStates[o][A]||{},this.deletedStates[o][A][S]=null);else if(y!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][A])for(S in this.deletedStates[o][A]={},this.stateChanges[o][A])this.deletedStates[o][A][S]=null;else this.deletedStates[o][A]=null;else this.deletedStates[o]=null}getState(o,y){const S=String(y),A=h.extend({},(this.state[o]||{})[S],(this.stateChanges[o]||{})[S]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const M=this.deletedStates[o][y];if(M===null)return{};for(const U in M)delete A[U]}return A}initializeTileState(o,y){o.setFeatureState(this.state,y)}coalesceChanges(o,y){const S={};for(const A in this.stateChanges){this.state[A]=this.state[A]||{};const M={};for(const U in this.stateChanges[A])this.state[A][U]||(this.state[A][U]={}),h.extend(this.state[A][U],this.stateChanges[A][U]),M[U]=this.state[A][U];S[A]=M}for(const A in this.deletedStates){this.state[A]=this.state[A]||{};const M={};if(this.deletedStates[A]===null)for(const U in this.state[A])M[U]={},this.state[A][U]={};else for(const U in this.deletedStates[A]){if(this.deletedStates[A][U]===null)this.state[A][U]={};else for(const Z of Object.keys(this.deletedStates[A][U]))delete this.state[A][U][Z];M[U]=this.state[A][U]}S[A]=S[A]||{},h.extend(S[A],M)}if(this.stateChanges={},this.deletedStates={},Object.keys(S).length!==0)for(const A in o)o[A].setFeatureState(S,y)}}class rt extends h.Evented{constructor(o,y,S){super(),this.id=o,this.dispatcher=S,this.on("data",A=>{A.dataType==="source"&&A.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&A.dataType==="source"&&A.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(A,M,U,Z){const J=new Ri[M.type](A,M,U,Z);if(J.id!==A)throw new Error(`Expected Source id to be ${A} instead of ${J.id}`);return h.bindAll(["load","abort","unload","serialize","prepare"],J),J}(o,y,S,this),this._tiles={},this._cache=new tr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Bt}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const y=this._tiles[o];if(y.state!=="loaded"&&y.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,y){return this._source.loadTile(o,y)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){this._source.abortTile&&this._source.abortTile(o,()=>{}),this._source.fire(new h.Event("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const y in this._tiles){const S=this._tiles[y];S.upload(o),S.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(_i).map(o=>o.key)}getRenderableIds(o){const y=[];for(const S in this._tiles)this._isIdRenderable(S,o)&&y.push(this._tiles[S]);return o?y.sort((S,A)=>{const M=S.tileID,U=A.tileID,Z=new h.pointGeometry(M.canonical.x,M.canonical.y)._rotate(this.transform.angle),J=new h.pointGeometry(U.canonical.x,U.canonical.y)._rotate(this.transform.angle);return M.overscaledZ-U.overscaledZ||J.y-Z.y||J.x-Z.x}).map(S=>S.tileID.key):y.map(S=>S.tileID).sort(_i).map(S=>S.key)}hasRenderableParent(o){const y=this.findLoadedParent(o,0);return!!y&&this._isIdRenderable(y.tileID.key)}_isIdRenderable(o,y){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(y||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(o,y){const S=this._tiles[o];S&&(S.state!=="loading"&&(S.state=y),this._loadTile(S,this._tileLoaded.bind(this,S,o,y)))}_tileLoaded(o,y,S,A){if(A)return o.state="errored",void(A.status!==404?this._source.fire(new h.ErrorEvent(A,{tile:o})):this.update(this.transform));o.timeAdded=h.exported.now(),S==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(y,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new h.Event("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const y=this.getRenderableIds();for(let A=0;A<y.length;A++){const M=y[A];if(o.neighboringTiles&&o.neighboringTiles[M]){const U=this.getTileByID(M);S(o,U),S(U,o)}}function S(A,M){A.needsHillshadePrepare=!0;let U=M.tileID.canonical.x-A.tileID.canonical.x;const Z=M.tileID.canonical.y-A.tileID.canonical.y,J=Math.pow(2,A.tileID.canonical.z),ee=M.tileID.key;U===0&&Z===0||Math.abs(Z)>1||(Math.abs(U)>1&&(Math.abs(U+J)===1?U+=J:Math.abs(U-J)===1&&(U-=J)),M.dem&&A.dem&&(A.dem.backfillBorder(M.dem,U,Z),A.neighboringTiles&&A.neighboringTiles[ee]&&(A.neighboringTiles[ee].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,y,S,A){for(const M in this._tiles){let U=this._tiles[M];if(A[M]||!U.hasData()||U.tileID.overscaledZ<=y||U.tileID.overscaledZ>S)continue;let Z=U.tileID;for(;U&&U.tileID.overscaledZ>y+1;){const ee=U.tileID.scaledTo(U.tileID.overscaledZ-1);U=this._tiles[ee.key],U&&U.hasData()&&(Z=ee)}let J=Z;for(;J.overscaledZ>y;)if(J=J.scaledTo(J.overscaledZ-1),o[J.key]){A[Z.key]=Z;break}}}findLoadedParent(o,y){if(o.key in this._loadedParentTiles){const S=this._loadedParentTiles[o.key];return S&&S.tileID.overscaledZ>=y?S:null}for(let S=o.overscaledZ-1;S>=y;S--){const A=o.scaledTo(S),M=this._getLoadedTile(A);if(M)return M}}_getLoadedTile(o){const y=this._tiles[o.key];return y&&y.hasData()?y:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const y=Math.ceil(o.width/this._source.tileSize)+1,S=Math.ceil(o.height/this._source.tileSize)+1,A=Math.floor(y*S*5),M=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,A):A;this._cache.setMaxSize(M)}handleWrapJump(o){const y=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,y){const S={};for(const A in this._tiles){const M=this._tiles[A];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+y),S[M.tileID.key]=M}this._tiles=S;for(const A in this._timers)clearTimeout(this._timers[A]),delete this._timers[A];for(const A in this._tiles)this._setTileReloadTimer(A,this._tiles[A])}}update(o){if(this.transform=o,!this._sourceLoaded||this._paused)return;let y;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?y=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(J=>new h.OverscaledTileID(J.canonical.z,J.wrap,J.canonical.z,J.canonical.x,J.canonical.y)):(y=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(y=y.filter(J=>this._source.hasTile(J)))):y=[];const S=o.coveringZoomLevel(this._source),A=Math.max(S-rt.maxOverzooming,this._source.minzoom),M=Math.max(S+rt.maxUnderzooming,this._source.minzoom),U=this._updateRetainedTiles(y,S);if(ir(this._source.type)){const J={},ee={},re=Object.keys(U);for(const ue of re){const ve=U[ue],Re=this._tiles[ue];if(!Re||Re.fadeEndTime&&Re.fadeEndTime<=h.exported.now())continue;const be=this.findLoadedParent(ve,A);be&&(this._addTile(be.tileID),J[be.tileID.key]=be.tileID),ee[ue]=ve}this._retainLoadedChildren(ee,S,M,U);for(const ue in J)U[ue]||(this._coveredTiles[ue]=!0,U[ue]=J[ue])}for(const J in U)this._tiles[J].clearFadeHold();const Z=h.keysDifference(this._tiles,U);for(const J of Z){const ee=this._tiles[J];ee.hasSymbolBuckets&&!ee.holdingForFade()?ee.setHoldDuration(this.map._fadeDuration):ee.hasSymbolBuckets&&!ee.symbolFadeFinished()||this._removeTile(J)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,y){const S={},A={},M=Math.max(y-rt.maxOverzooming,this._source.minzoom),U=Math.max(y+rt.maxUnderzooming,this._source.minzoom),Z={};for(const J of o){const ee=this._addTile(J);S[J.key]=J,ee.hasData()||y<this._source.maxzoom&&(Z[J.key]=J)}this._retainLoadedChildren(Z,y,U,S);for(const J of o){let ee=this._tiles[J.key];if(ee.hasData())continue;if(y+1>this._source.maxzoom){const ue=J.children(this._source.maxzoom)[0],ve=this.getTile(ue);if(ve&&ve.hasData()){S[ue.key]=ue;continue}}else{const ue=J.children(this._source.maxzoom);if(S[ue[0].key]&&S[ue[1].key]&&S[ue[2].key]&&S[ue[3].key])continue}let re=ee.wasRequested();for(let ue=J.overscaledZ-1;ue>=M;--ue){const ve=J.scaledTo(ue);if(A[ve.key]||(A[ve.key]=!0,ee=this.getTile(ve),!ee&&re&&(ee=this._addTile(ve)),ee&&(S[ve.key]=ve,re=ee.wasRequested(),ee.hasData())))break}}return S}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const y=[];let S,A=this._tiles[o].tileID;for(;A.overscaledZ>0;){if(A.key in this._loadedParentTiles){S=this._loadedParentTiles[A.key];break}y.push(A.key);const M=A.scaledTo(A.overscaledZ-1);if(S=this._getLoadedTile(M),S)break;A=M}for(const M of y)this._loadedParentTiles[M]=S}}_addTile(o){let y=this._tiles[o.key];if(y)return y;y=this._cache.getAndRemove(o),y&&(this._setTileReloadTimer(o.key,y),y.tileID=o,this._state.initializeTileState(y,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,y)));const S=y;return y||(y=new zt(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(y,this._tileLoaded.bind(this,y,o.key,y.state))),y.uses++,this._tiles[o.key]=y,S||this._source.fire(new h.Event("dataloading",{tile:y,coord:y.tileID,dataType:"source"})),y}_setTileReloadTimer(o,y){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const S=y.getExpiryTimeout();S&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},S))}_removeTile(o){const y=this._tiles[o];y&&(y.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),y.uses>0||(y.hasData()&&y.state!=="reloading"?this._cache.add(y.tileID,y,y.getExpiryTimeout()):(y.aborted=!0,this._abortTile(y),this._unloadTile(y))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,y,S){const A=[],M=this.transform;if(!M)return A;const U=S?M.getCameraQueryGeometry(o):o,Z=o.map(be=>M.pointCoordinate(be)),J=U.map(be=>M.pointCoordinate(be)),ee=this.getIds();let re=1/0,ue=1/0,ve=-1/0,Re=-1/0;for(const be of J)re=Math.min(re,be.x),ue=Math.min(ue,be.y),ve=Math.max(ve,be.x),Re=Math.max(Re,be.y);for(let be=0;be<ee.length;be++){const De=this._tiles[ee[be]];if(De.holdingForFade())continue;const Je=De.tileID,Xe=Math.pow(2,M.zoom-De.tileID.overscaledZ),nt=y*De.queryPadding*h.EXTENT/De.tileSize/Xe,Ye=[Je.getTilePoint(new h.MercatorCoordinate(re,ue)),Je.getTilePoint(new h.MercatorCoordinate(ve,Re))];if(Ye[0].x-nt<h.EXTENT&&Ye[0].y-nt<h.EXTENT&&Ye[1].x+nt>=0&&Ye[1].y+nt>=0){const xt=Z.map(ft=>Je.getTilePoint(ft)),ht=J.map(ft=>Je.getTilePoint(ft));A.push({tile:De,tileID:Je,queryGeometry:xt,cameraQueryGeometry:ht,scale:Xe})}}return A}getVisibleCoordinates(o){const y=this.getRenderableIds(o).map(S=>this._tiles[S].tileID);for(const S of y)S.posMatrix=this.transform.calculatePosMatrix(S.toUnwrapped());return y}hasTransition(){if(this._source.hasTransition())return!0;if(ir(this._source.type))for(const o in this._tiles){const y=this._tiles[o];if(y.fadeEndTime!==void 0&&y.fadeEndTime>=h.exported.now())return!0}return!1}setFeatureState(o,y,S){this._state.updateState(o=o||"_geojsonTileLayer",y,S)}removeFeatureState(o,y,S){this._state.removeFeatureState(o=o||"_geojsonTileLayer",y,S)}getFeatureState(o,y){return this._state.getState(o=o||"_geojsonTileLayer",y)}setDependencies(o,y,S){const A=this._tiles[o];A&&A.setDependencies(y,S)}reloadTilesForDependencies(o,y){for(const S in this._tiles)this._tiles[S].hasDependency(o,y)&&this._reloadTile(S,"reloading");this._cache.filter(S=>!S.hasDependency(o,y))}}function _i(T,o){const y=Math.abs(2*T.wrap)-+(T.wrap<0),S=Math.abs(2*o.wrap)-+(o.wrap<0);return T.overscaledZ-o.overscaledZ||S-y||o.canonical.y-T.canonical.y||o.canonical.x-T.canonical.x}function ir(T){return T==="raster"||T==="image"||T==="video"}rt.maxOverzooming=10,rt.maxUnderzooming=3;const Pr="mapboxgl_preloaded_worker_pool";class co{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<co.workerCount;)this.workers.push(new Worker(No.workerUrl));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(y=>{y.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Pr]}numActive(){return Object.keys(this.active).length}}const Zn=Math.floor(h.exported.hardwareConcurrency/2);let Bo;function _n(){return Bo||(Bo=new co),Bo}function ho(T,o){const y={};for(const S in T)S!=="ref"&&(y[S]=T[S]);return h.refProperties.forEach(S=>{S in o&&(y[S]=o[S])}),y}function Hn(T){T=T.slice();const o=Object.create(null);for(let y=0;y<T.length;y++)o[T[y].id]=T[y];for(let y=0;y<T.length;y++)"ref"in T[y]&&(T[y]=ho(T[y],o[T[y].ref]));return T}co.workerCount=Math.max(Math.min(Zn,6),1);const Zi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Un(T,o,y){y.push({command:Zi.addSource,args:[T,o[T]]})}function Ao(T,o,y){o.push({command:Zi.removeSource,args:[T]}),y[T]=!0}function Wn(T,o,y,S){Ao(T,y,S),Un(T,o,y)}function Ba(T,o,y){let S;for(S in T[y])if(Object.prototype.hasOwnProperty.call(T[y],S)&&S!=="data"&&!G(T[y][S],o[y][S]))return!1;for(S in o[y])if(Object.prototype.hasOwnProperty.call(o[y],S)&&S!=="data"&&!G(T[y][S],o[y][S]))return!1;return!0}function Ue(T,o,y,S,A,M){let U;for(U in o=o||{},T=T||{})Object.prototype.hasOwnProperty.call(T,U)&&(G(T[U],o[U])||y.push({command:M,args:[S,U,o[U],A]}));for(U in o)Object.prototype.hasOwnProperty.call(o,U)&&!Object.prototype.hasOwnProperty.call(T,U)&&(G(T[U],o[U])||y.push({command:M,args:[S,U,o[U],A]}))}function gt(T){return T.id}function Si(T,o){return T[o.id]=o,T}class yr{constructor(o,y){this.reset(o,y)}reset(o,y){this.points=o||[],this._distances=[0];for(let S=1;S<this.points.length;S++)this._distances[S]=this._distances[S-1]+this.points[S].dist(this.points[S-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(y||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=h.clamp(o,0,1);let y=1,S=this._distances[y];const A=o*this.paddedLength+this.padding;for(;S<A&&y<this._distances.length;)S=this._distances[++y];const M=y-1,U=this._distances[M],Z=S-U,J=Z>0?(A-U)/Z:0;return this.points[M].mult(1-J).add(this.points[y].mult(J))}}function br(T,o){let y=!0;return T==="always"||T!=="never"&&o!=="never"||(y=!1),y}class Xn{constructor(o,y,S){const A=this.boxCells=[],M=this.circleCells=[];this.xCellCount=Math.ceil(o/S),this.yCellCount=Math.ceil(y/S);for(let U=0;U<this.xCellCount*this.yCellCount;U++)A.push([]),M.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=y,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/y,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,y,S,A,M){this._forEachCell(y,S,A,M,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(y),this.bboxes.push(S),this.bboxes.push(A),this.bboxes.push(M)}insertCircle(o,y,S,A){this._forEachCell(y-A,S-A,y+A,S+A,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(y),this.circles.push(S),this.circles.push(A)}_insertBoxCell(o,y,S,A,M,U){this.boxCells[M].push(U)}_insertCircleCell(o,y,S,A,M,U){this.circleCells[M].push(U)}_query(o,y,S,A,M,U,Z){if(S<0||o>this.width||A<0||y>this.height)return[];const J=[];if(o<=0&&y<=0&&this.width<=S&&this.height<=A){if(M)return[{key:null,x1:o,y1:y,x2:S,y2:A}];for(let ee=0;ee<this.boxKeys.length;ee++)J.push({key:this.boxKeys[ee],x1:this.bboxes[4*ee],y1:this.bboxes[4*ee+1],x2:this.bboxes[4*ee+2],y2:this.bboxes[4*ee+3]});for(let ee=0;ee<this.circleKeys.length;ee++){const re=this.circles[3*ee],ue=this.circles[3*ee+1],ve=this.circles[3*ee+2];J.push({key:this.circleKeys[ee],x1:re-ve,y1:ue-ve,x2:re+ve,y2:ue+ve})}}else this._forEachCell(o,y,S,A,this._queryCell,J,{hitTest:M,overlapMode:U,seenUids:{box:{},circle:{}}},Z);return J}query(o,y,S,A){return this._query(o,y,S,A,!1,null)}hitTest(o,y,S,A,M,U){return this._query(o,y,S,A,!0,M,U).length>0}hitTestCircle(o,y,S,A,M){const U=o-S,Z=o+S,J=y-S,ee=y+S;if(Z<0||U>this.width||ee<0||J>this.height)return!1;const re=[];return this._forEachCell(U,J,Z,ee,this._queryCellCircle,re,{hitTest:!0,overlapMode:A,circle:{x:o,y,radius:S},seenUids:{box:{},circle:{}}},M),re.length>0}_queryCell(o,y,S,A,M,U,Z,J){const{seenUids:ee,hitTest:re,overlapMode:ue}=Z,ve=this.boxCells[M];if(ve!==null){const be=this.bboxes;for(const De of ve)if(!ee.box[De]){ee.box[De]=!0;const Je=4*De,Xe=this.boxKeys[De];if(o<=be[Je+2]&&y<=be[Je+3]&&S>=be[Je+0]&&A>=be[Je+1]&&(!J||J(Xe))&&(!re||!br(ue,Xe.overlapMode))&&(U.push({key:Xe,x1:be[Je],y1:be[Je+1],x2:be[Je+2],y2:be[Je+3]}),re))return!0}}const Re=this.circleCells[M];if(Re!==null){const be=this.circles;for(const De of Re)if(!ee.circle[De]){ee.circle[De]=!0;const Je=3*De,Xe=this.circleKeys[De];if(this._circleAndRectCollide(be[Je],be[Je+1],be[Je+2],o,y,S,A)&&(!J||J(Xe))&&(!re||!br(ue,Xe.overlapMode))){const nt=be[Je],Ye=be[Je+1],xt=be[Je+2];if(U.push({key:Xe,x1:nt-xt,y1:Ye-xt,x2:nt+xt,y2:Ye+xt}),re)return!0}}}return!1}_queryCellCircle(o,y,S,A,M,U,Z,J){const{circle:ee,seenUids:re,overlapMode:ue}=Z,ve=this.boxCells[M];if(ve!==null){const be=this.bboxes;for(const De of ve)if(!re.box[De]){re.box[De]=!0;const Je=4*De,Xe=this.boxKeys[De];if(this._circleAndRectCollide(ee.x,ee.y,ee.radius,be[Je+0],be[Je+1],be[Je+2],be[Je+3])&&(!J||J(Xe))&&!br(ue,Xe.overlapMode))return U.push(!0),!0}}const Re=this.circleCells[M];if(Re!==null){const be=this.circles;for(const De of Re)if(!re.circle[De]){re.circle[De]=!0;const Je=3*De,Xe=this.circleKeys[De];if(this._circlesCollide(be[Je],be[Je+1],be[Je+2],ee.x,ee.y,ee.radius)&&(!J||J(Xe))&&!br(ue,Xe.overlapMode))return U.push(!0),!0}}}_forEachCell(o,y,S,A,M,U,Z,J){const ee=this._convertToXCellCoord(o),re=this._convertToYCellCoord(y),ue=this._convertToXCellCoord(S),ve=this._convertToYCellCoord(A);for(let Re=ee;Re<=ue;Re++)for(let be=re;be<=ve;be++)if(M.call(this,o,y,S,A,this.xCellCount*be+Re,U,Z,J))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,y,S,A,M,U){const Z=A-o,J=M-y,ee=S+U;return ee*ee>Z*Z+J*J}_circleAndRectCollide(o,y,S,A,M,U,Z){const J=(U-A)/2,ee=Math.abs(o-(A+J));if(ee>J+S)return!1;const re=(Z-M)/2,ue=Math.abs(y-(M+re));if(ue>re+S)return!1;if(ee<=J||ue<=re)return!0;const ve=ee-J,Re=ue-re;return ve*ve+Re*Re<=S*S}}function Kn(T,o,y,S,A){const M=h.create();return o?(h.scale(M,M,[1/A,1/A,1]),y||h.rotateZ(M,M,S.angle)):h.multiply(M,S.labelPlaneMatrix,T),M}function na(T,o,y,S,A){if(o){const M=h.clone(T);return h.scale(M,M,[A,A,1]),y||h.rotateZ(M,M,-S.angle),M}return S.glCoordMatrix}function Yr(T,o){const y=[T.x,T.y,0,1];oe(y,y,o);const S=y[3];return{point:new h.pointGeometry(y[0]/S,y[1]/S),signedDistanceFromCamera:S}}function Ht(T,o){return .5+T/o*.5}function nr(T,o){const y=T[0]/T[3],S=T[1]/T[3];return y>=-o[0]&&y<=o[0]&&S>=-o[1]&&S<=o[1]}function Ki(T,o,y,S,A,M,U,Z,J){const ee=S?T.textSizeData:T.iconSizeData,re=h.evaluateSizeForZoom(ee,y.transform.zoom),ue=[256/y.width*2+1,256/y.height*2+1],ve=S?T.text.dynamicLayoutVertexArray:T.icon.dynamicLayoutVertexArray;ve.clear();const Re=T.lineVertexArray,be=S?T.text.placedSymbolArray:T.icon.placedSymbolArray,De=y.transform.width/y.transform.height;let Je=!1;for(let Xe=0;Xe<be.length;Xe++){const nt=be.get(Xe);if(nt.hidden||nt.writingMode===h.WritingMode.vertical&&!Je){te(nt.numGlyphs,ve);continue}Je=!1;const Ye=[nt.anchorX,nt.anchorY,0,1];if(h.transformMat4(Ye,Ye,o),!nr(Ye,ue)){te(nt.numGlyphs,ve);continue}const xt=Ht(y.transform.cameraToCenterDistance,Ye[3]),ht=h.evaluateSizeForFeature(ee,re,nt),ft=U?ht/xt:ht*xt,Pt=new h.pointGeometry(nt.anchorX,nt.anchorY),Ft=Yr(Pt,A).point,wt={},pi=Ni(nt,ft,!1,Z,o,A,M,T.glyphOffsetArray,Re,ve,Ft,Pt,wt,De,J);Je=pi.useVertical,(pi.notEnoughRoom||Je||pi.needsFlipping&&Ni(nt,ft,!0,Z,o,A,M,T.glyphOffsetArray,Re,ve,Ft,Pt,wt,De,J).notEnoughRoom)&&te(nt.numGlyphs,ve)}S?T.text.dynamicLayoutVertexBuffer.updateData(ve):T.icon.dynamicLayoutVertexBuffer.updateData(ve)}function Dn(T,o,y,S,A,M,U,Z,J,ee,re,ue){const ve=Z.glyphStartIndex+Z.numGlyphs,Re=Z.lineStartIndex,be=Z.lineStartIndex+Z.lineLength,De=o.getoffsetX(Z.glyphStartIndex),Je=o.getoffsetX(ve-1),Xe=Oo(T*De,y,S,A,M,U,Z.segment,Re,be,J,ee,re,ue);if(!Xe)return null;const nt=Oo(T*Je,y,S,A,M,U,Z.segment,Re,be,J,ee,re,ue);return nt?{first:Xe,last:nt}:null}function Jn(T,o,y,S){return T===h.WritingMode.horizontal&&Math.abs(y.y-o.y)>Math.abs(y.x-o.x)*S?{useVertical:!0}:(T===h.WritingMode.vertical?o.y<y.y:o.x>y.x)?{needsFlipping:!0}:null}function Ni(T,o,y,S,A,M,U,Z,J,ee,re,ue,ve,Re,be){const De=o/24,Je=T.lineOffsetX*De,Xe=T.lineOffsetY*De;let nt;if(T.numGlyphs>1){const Ye=T.glyphStartIndex+T.numGlyphs,xt=T.lineStartIndex,ht=T.lineStartIndex+T.lineLength,ft=Dn(De,Z,Je,Xe,y,re,ue,T,J,M,ve,be);if(!ft)return{notEnoughRoom:!0};const Pt=Yr(ft.first.point,U).point,Ft=Yr(ft.last.point,U).point;if(S&&!y){const wt=Jn(T.writingMode,Pt,Ft,Re);if(wt)return wt}nt=[ft.first];for(let wt=T.glyphStartIndex+1;wt<Ye-1;wt++)nt.push(Oo(De*Z.getoffsetX(wt),Je,Xe,y,re,ue,T.segment,xt,ht,J,M,ve,be));nt.push(ft.last)}else{if(S&&!y){const xt=Yr(ue,A).point,ht=T.lineStartIndex+T.segment+1,ft=new h.pointGeometry(J.getx(ht),J.gety(ht)),Pt=Yr(ft,A),Ft=Pt.signedDistanceFromCamera>0?Pt.point:ya(ue,ft,xt,1,A),wt=Jn(T.writingMode,xt,Ft,Re);if(wt)return wt}const Ye=Oo(De*Z.getoffsetX(T.glyphStartIndex),Je,Xe,y,re,ue,T.segment,T.lineStartIndex,T.lineStartIndex+T.lineLength,J,M,ve,be);if(!Ye)return{notEnoughRoom:!0};nt=[Ye]}for(const Ye of nt)h.addDynamicAttributes(ee,Ye.point,Ye.angle);return{}}function ya(T,o,y,S,A){const M=Yr(T.add(T.sub(o)._unit()),A).point,U=y.sub(M);return y.add(U._mult(S/U.mag()))}function Oo(T,o,y,S,A,M,U,Z,J,ee,re,ue,ve){const Re=S?T-o:T+o;let be=Re>0?1:-1,De=0;S&&(be*=-1,De=Math.PI),be<0&&(De+=Math.PI);let Je=be>0?Z+U:Z+U+1,Xe=A,nt=A,Ye=0,xt=0;const ht=Math.abs(Re),ft=[];for(;Ye+xt<=ht;){if(Je+=be,Je<Z||Je>=J)return null;if(nt=Xe,ft.push(Xe),Xe=ue[Je],Xe===void 0){const ei=new h.pointGeometry(ee.getx(Je),ee.gety(Je)),Ui=Yr(ei,re);if(Ui.signedDistanceFromCamera>0)Xe=ue[Je]=Ui.point;else{const c=Je-be;Xe=ya(Ye===0?M:new h.pointGeometry(ee.getx(c),ee.gety(c)),ei,nt,ht-Ye+1,re)}}Ye+=xt,xt=nt.dist(Xe)}const Pt=(ht-Ye)/xt,Ft=Xe.sub(nt),wt=Ft.mult(Pt)._add(nt);wt._add(Ft._unit()._perp()._mult(y*be));const pi=De+Math.atan2(Xe.y-nt.y,Xe.x-nt.x);return ft.push(wt),{point:wt,angle:ve?pi:0,path:ft}}const Xr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function te(T,o){for(let y=0;y<T;y++){const S=o.length;o.resize(S+4),o.float32.set(Xr,3*S)}}function oe(T,o,y){const S=o[0],A=o[1];return T[0]=y[0]*S+y[4]*A+y[12],T[1]=y[1]*S+y[5]*A+y[13],T[3]=y[3]*S+y[7]*A+y[15],T}const le=100;class ge{constructor(o,y=new Xn(o.width+200,o.height+200,25),S=new Xn(o.width+200,o.height+200,25)){this.transform=o,this.grid=y,this.ignoredGrid=S,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+le,this.screenBottomBoundary=o.height+le,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200}placeCollisionBox(o,y,S,A,M){const U=this.projectAndGetPerspectiveRatio(A,o.anchorPointX,o.anchorPointY),Z=S*U.perspectiveRatio,J=o.x1*Z+U.point.x,ee=o.y1*Z+U.point.y,re=o.x2*Z+U.point.x,ue=o.y2*Z+U.point.y;return!this.isInsideGrid(J,ee,re,ue)||y!=="always"&&this.grid.hitTest(J,ee,re,ue,y,M)?{box:[],offscreen:!1}:{box:[J,ee,re,ue],offscreen:this.isOffscreen(J,ee,re,ue)}}placeCollisionCircles(o,y,S,A,M,U,Z,J,ee,re,ue,ve,Re){const be=[],De=new h.pointGeometry(y.anchorX,y.anchorY),Je=Yr(De,U),Xe=Ht(this.transform.cameraToCenterDistance,Je.signedDistanceFromCamera),nt=(re?M/Xe:M*Xe)/h.ONE_EM,Ye=Yr(De,Z).point,xt=Dn(nt,A,y.lineOffsetX*nt,y.lineOffsetY*nt,!1,Ye,De,y,S,Z,{},!1);let ht=!1,ft=!1,Pt=!0;if(xt){const Ft=.5*ve*Xe+Re,wt=new h.pointGeometry(-100,-100),pi=new h.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),ei=new yr,Ui=xt.first,c=xt.last;let m=[];for(let k=Ui.path.length-1;k>=1;k--)m.push(Ui.path[k]);for(let k=1;k<c.path.length;k++)m.push(c.path[k]);const d=2.5*Ft;if(J){const k=m.map(L=>Yr(L,J));m=k.some(L=>L.signedDistanceFromCamera<=0)?[]:k.map(L=>L.point)}let x=[];if(m.length>0){const k=m[0].clone(),L=m[0].clone();for(let B=1;B<m.length;B++)k.x=Math.min(k.x,m[B].x),k.y=Math.min(k.y,m[B].y),L.x=Math.max(L.x,m[B].x),L.y=Math.max(L.y,m[B].y);x=k.x>=wt.x&&L.x<=pi.x&&k.y>=wt.y&&L.y<=pi.y?[m]:L.x<wt.x||k.x>pi.x||L.y<wt.y||k.y>pi.y?[]:h.clipLine([m],wt.x,wt.y,pi.x,pi.y)}for(const k of x){ei.reset(k,.25*Ft);let L=0;L=ei.length<=.5*Ft?1:Math.ceil(ei.paddedLength/d)+1;for(let B=0;B<L;B++){const q=B/Math.max(L-1,1),$=ei.lerp(q),ie=$.x+le,he=$.y+le;be.push(ie,he,Ft,0);const de=ie-Ft,me=he-Ft,Ce=ie+Ft,Te=he+Ft;if(Pt=Pt&&this.isOffscreen(de,me,Ce,Te),ft=ft||this.isInsideGrid(de,me,Ce,Te),o!=="always"&&this.grid.hitTestCircle(ie,he,Ft,o,ue)&&(ht=!0,!ee))return{circles:[],offscreen:!1,collisionDetected:ht}}}}return{circles:!ee&&ht||!ft?[]:be,offscreen:Pt,collisionDetected:ht}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const y=[];let S=1/0,A=1/0,M=-1/0,U=-1/0;for(const re of o){const ue=new h.pointGeometry(re.x+le,re.y+le);S=Math.min(S,ue.x),A=Math.min(A,ue.y),M=Math.max(M,ue.x),U=Math.max(U,ue.y),y.push(ue)}const Z=this.grid.query(S,A,M,U).concat(this.ignoredGrid.query(S,A,M,U)),J={},ee={};for(const re of Z){const ue=re.key;if(J[ue.bucketInstanceId]===void 0&&(J[ue.bucketInstanceId]={}),J[ue.bucketInstanceId][ue.featureIndex])continue;const ve=[new h.pointGeometry(re.x1,re.y1),new h.pointGeometry(re.x2,re.y1),new h.pointGeometry(re.x2,re.y2),new h.pointGeometry(re.x1,re.y2)];h.polygonIntersectsPolygon(y,ve)&&(J[ue.bucketInstanceId][ue.featureIndex]=!0,ee[ue.bucketInstanceId]===void 0&&(ee[ue.bucketInstanceId]=[]),ee[ue.bucketInstanceId].push(ue.featureIndex))}return ee}insertCollisionBox(o,y,S,A,M,U){(S?this.ignoredGrid:this.grid).insert({bucketInstanceId:A,featureIndex:M,collisionGroupID:U,overlapMode:y},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,y,S,A,M,U){const Z=S?this.ignoredGrid:this.grid,J={bucketInstanceId:A,featureIndex:M,collisionGroupID:U,overlapMode:y};for(let ee=0;ee<o.length;ee+=4)Z.insertCircle(J,o[ee],o[ee+1],o[ee+2])}projectAndGetPerspectiveRatio(o,y,S){const A=[y,S,0,1];return oe(A,A,o),{point:new h.pointGeometry((A[0]/A[3]+1)/2*this.transform.width+le,(-A[1]/A[3]+1)/2*this.transform.height+le),perspectiveRatio:.5+this.transform.cameraToCenterDistance/A[3]*.5}}isOffscreen(o,y,S,A){return S<le||o>=this.screenRightBoundary||A<le||y>this.screenBottomBoundary}isInsideGrid(o,y,S,A){return S>=0&&o<this.gridRightBoundary&&A>=0&&y<this.gridBottomBoundary}getViewportMatrix(){const o=h.identity([]);return h.translate(o,o,[-100,-100,0]),o}}function Se(T,o,y){return o*(h.EXTENT/(T.tileSize*Math.pow(2,y-T.tileID.overscaledZ)))}class Oe{constructor(o,y,S,A){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?y:-y))):A&&S?1:0,this.placed=S}isHidden(){return this.opacity===0&&!this.placed}}class Ve{constructor(o,y,S,A,M){this.text=new Oe(o?o.text:null,y,S,M),this.icon=new Oe(o?o.icon:null,y,A,M)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ye{constructor(o,y,S){this.text=o,this.icon=y,this.skipFade=S}}class Me{constructor(){this.invProjMatrix=h.create(),this.viewportMatrix=h.create(),this.circles=[]}}class Qe{constructor(o,y,S,A,M){this.bucketInstanceId=o,this.featureIndex=y,this.sourceLayerIndex=S,this.bucketIndex=A,this.tileID=M}}class ae{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const y=++this.maxGroupID;this.collisionGroups[o]={ID:y,predicate:S=>S.collisionGroupID===y}}return this.collisionGroups[o]}}function W(T,o,y,S,A){const{horizontalAlign:M,verticalAlign:U}=h.getAnchorAlignment(T),Z=-(M-.5)*o,J=-(U-.5)*y,ee=h.evaluateVariableOffset(T,S);return new h.pointGeometry(Z+ee[0]*A,J+ee[1]*A)}function X(T,o,y,S,A,M){const{x1:U,x2:Z,y1:J,y2:ee,anchorPointX:re,anchorPointY:ue}=T,ve=new h.pointGeometry(o,y);return S&&ve._rotate(A?M:-M),{x1:U+ve.x,y1:J+ve.y,x2:Z+ve.x,y2:ee+ve.y,anchorPointX:re,anchorPointY:ue}}class ne{constructor(o,y,S,A){this.transform=o.clone(),this.collisionIndex=new ge(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=y,this.retainedQueryData={},this.collisionGroups=new ae(S),this.collisionCircleArrays={},this.prevPlacement=A,A&&(A.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,y,S,A){const M=S.getBucket(y),U=S.latestFeatureIndex;if(!M||!U||y.id!==M.layerIds[0])return;const Z=S.collisionBoxArray,J=M.layers[0].layout,ee=Math.pow(2,this.transform.zoom-S.tileID.overscaledZ),re=S.tileSize/h.EXTENT,ue=this.transform.calculatePosMatrix(S.tileID.toUnwrapped()),ve=J.get("text-pitch-alignment")==="map",Re=J.get("text-rotation-alignment")==="map",be=Se(S,1,this.transform.zoom),De=Kn(ue,ve,Re,this.transform,be);let Je=null;if(ve){const nt=na(ue,ve,Re,this.transform,be);Je=h.multiply([],this.transform.labelPlaneMatrix,nt)}this.retainedQueryData[M.bucketInstanceId]=new Qe(M.bucketInstanceId,U,M.sourceLayerIndex,M.index,S.tileID);const Xe={bucket:M,layout:J,posMatrix:ue,textLabelPlaneMatrix:De,labelToScreenMatrix:Je,scale:ee,textPixelRatio:re,holdingForFade:S.holdingForFade(),collisionBoxArray:Z,partiallyEvaluatedTextSize:h.evaluateSizeForZoom(M.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(M.sourceID)};if(A)for(const nt of M.sortKeyRanges){const{sortKey:Ye,symbolInstanceStart:xt,symbolInstanceEnd:ht}=nt;o.push({sortKey:Ye,symbolInstanceStart:xt,symbolInstanceEnd:ht,parameters:Xe})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:M.symbolInstances.length,parameters:Xe})}attemptAnchorPlacement(o,y,S,A,M,U,Z,J,ee,re,ue,ve,Re,be,De){const Je=[ve.textOffset0,ve.textOffset1],Xe=W(o,S,A,Je,M),nt=this.collisionIndex.placeCollisionBox(X(y,Xe.x,Xe.y,U,Z,this.transform.angle),ue,J,ee,re.predicate);if((!De||this.collisionIndex.placeCollisionBox(X(De,Xe.x,Xe.y,U,Z,this.transform.angle),ue,J,ee,re.predicate).box.length!==0)&&nt.box.length>0){let Ye;return this.prevPlacement&&this.prevPlacement.variableOffsets[ve.crossTileID]&&this.prevPlacement.placements[ve.crossTileID]&&this.prevPlacement.placements[ve.crossTileID].text&&(Ye=this.prevPlacement.variableOffsets[ve.crossTileID].anchor),this.variableOffsets[ve.crossTileID]={textOffset:Je,width:S,height:A,anchor:o,textBoxScale:M,prevAnchor:Ye},this.markUsedJustification(Re,o,ve,be),Re.allowVerticalPlacement&&(this.markUsedOrientation(Re,be,ve),this.placedOrientations[ve.crossTileID]=be),{shift:Xe,placedGlyphBoxes:nt}}}placeLayerBucketPart(o,y,S){const{bucket:A,layout:M,posMatrix:U,textLabelPlaneMatrix:Z,labelToScreenMatrix:J,textPixelRatio:ee,holdingForFade:re,collisionBoxArray:ue,partiallyEvaluatedTextSize:ve,collisionGroup:Re}=o.parameters,be=M.get("text-optional"),De=M.get("icon-optional"),Je=h.getOverlapMode(M,"text-overlap","text-allow-overlap"),Xe=Je==="always",nt=h.getOverlapMode(M,"icon-overlap","icon-allow-overlap"),Ye=nt==="always",xt=M.get("text-rotation-alignment")==="map",ht=M.get("text-pitch-alignment")==="map",ft=M.get("icon-text-fit")!=="none",Pt=M.get("symbol-z-order")==="viewport-y",Ft=Xe&&(Ye||!A.hasIconData()||De),wt=Ye&&(Xe||!A.hasTextData()||be);!A.collisionArrays&&ue&&A.deserializeCollisionBoxes(ue);const pi=(ei,Ui)=>{if(y[ei.crossTileID])return;if(re)return void(this.placements[ei.crossTileID]=new ye(!1,!1,!1));let c=!1,m=!1,d=!0,x=null,k={box:null,offscreen:null},L={box:null,offscreen:null},B=null,q=null,$=null,ie=0,he=0,de=0;Ui.textFeatureIndex?ie=Ui.textFeatureIndex:ei.useRuntimeCollisionCircles&&(ie=ei.featureIndex),Ui.verticalTextFeatureIndex&&(he=Ui.verticalTextFeatureIndex);const me=Ui.textBox;if(me){const Le=ze=>{let Fe=h.WritingMode.horizontal;if(A.allowVerticalPlacement&&!ze&&this.prevPlacement){const $e=this.prevPlacement.placedOrientations[ei.crossTileID];$e&&(this.placedOrientations[ei.crossTileID]=$e,Fe=$e,this.markUsedOrientation(A,Fe,ei))}return Fe},xe=(ze,Fe)=>{if(A.allowVerticalPlacement&&ei.numVerticalGlyphVertices>0&&Ui.verticalTextBox){for(const $e of A.writingModes)if($e===h.WritingMode.vertical?(k=Fe(),L=k):k=ze(),k&&k.box&&k.box.length)break}else k=ze()};if(M.get("text-variable-anchor")){let ze=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ei.crossTileID]){const ot=this.prevPlacement.variableOffsets[ei.crossTileID];ze.indexOf(ot.anchor)>0&&(ze=ze.filter(at=>at!==ot.anchor),ze.unshift(ot.anchor))}const Fe=(ot,at,st)=>{const It=ot.x2-ot.x1,Dt=ot.y2-ot.y1,Lt=ei.textBoxScale,$t=ft&&nt==="never"?at:null;let mi={box:[],offscreen:!1};const bi=Je!=="never"?2*ze.length:ze.length;for(let di=0;di<bi;++di){const ar=this.attemptAnchorPlacement(ze[di%ze.length],ot,It,Dt,Lt,xt,ht,ee,U,Re,di>=ze.length?Je:"never",ei,A,st,$t);if(ar&&(mi=ar.placedGlyphBoxes,mi&&mi.box&&mi.box.length)){c=!0,x=ar.shift;break}}return mi};xe(()=>Fe(me,Ui.iconBox,h.WritingMode.horizontal),()=>{const ot=Ui.verticalTextBox;return A.allowVerticalPlacement&&!(k&&k.box&&k.box.length)&&ei.numVerticalGlyphVertices>0&&ot?Fe(ot,Ui.verticalIconBox,h.WritingMode.vertical):{box:null,offscreen:null}}),k&&(c=k.box,d=k.offscreen);const $e=Le(k&&k.box);if(!c&&this.prevPlacement){const ot=this.prevPlacement.variableOffsets[ei.crossTileID];ot&&(this.variableOffsets[ei.crossTileID]=ot,this.markUsedJustification(A,ot.anchor,ei,$e))}}else{const ze=(Fe,$e)=>{const ot=this.collisionIndex.placeCollisionBox(Fe,Je,ee,U,Re.predicate);return ot&&ot.box&&ot.box.length&&(this.markUsedOrientation(A,$e,ei),this.placedOrientations[ei.crossTileID]=$e),ot};xe(()=>ze(me,h.WritingMode.horizontal),()=>{const Fe=Ui.verticalTextBox;return A.allowVerticalPlacement&&ei.numVerticalGlyphVertices>0&&Fe?ze(Fe,h.WritingMode.vertical):{box:null,offscreen:null}}),Le(k&&k.box&&k.box.length)}}if(B=k,c=B&&B.box&&B.box.length>0,d=B&&B.offscreen,ei.useRuntimeCollisionCircles){const Le=A.text.placedSymbolArray.get(ei.centerJustifiedTextSymbolIndex),xe=h.evaluateSizeForFeature(A.textSizeData,ve,Le),ze=M.get("text-padding");q=this.collisionIndex.placeCollisionCircles(Je,Le,A.lineVertexArray,A.glyphOffsetArray,xe,U,Z,J,S,ht,Re.predicate,ei.collisionCircleDiameter,ze),c=Xe||q.circles.length>0&&!q.collisionDetected,d=d&&q.offscreen}if(Ui.iconFeatureIndex&&(de=Ui.iconFeatureIndex),Ui.iconBox){const Le=xe=>{const ze=ft&&x?X(xe,x.x,x.y,xt,ht,this.transform.angle):xe;return this.collisionIndex.placeCollisionBox(ze,nt,ee,U,Re.predicate)};L&&L.box&&L.box.length&&Ui.verticalIconBox?($=Le(Ui.verticalIconBox),m=$.box.length>0):($=Le(Ui.iconBox),m=$.box.length>0),d=d&&$.offscreen}const Ce=be||ei.numHorizontalGlyphVertices===0&&ei.numVerticalGlyphVertices===0,Te=De||ei.numIconVertices===0;if(Ce||Te?Te?Ce||(m=m&&c):c=m&&c:m=c=m&&c,c&&B&&B.box&&this.collisionIndex.insertCollisionBox(B.box,Je,M.get("text-ignore-placement"),A.bucketInstanceId,L&&L.box&&he?he:ie,Re.ID),m&&$&&this.collisionIndex.insertCollisionBox($.box,nt,M.get("icon-ignore-placement"),A.bucketInstanceId,de,Re.ID),q&&(c&&this.collisionIndex.insertCollisionCircles(q.circles,Je,M.get("text-ignore-placement"),A.bucketInstanceId,ie,Re.ID),S)){const Le=A.bucketInstanceId;let xe=this.collisionCircleArrays[Le];xe===void 0&&(xe=this.collisionCircleArrays[Le]=new Me);for(let ze=0;ze<q.circles.length;ze+=4)xe.circles.push(q.circles[ze+0]),xe.circles.push(q.circles[ze+1]),xe.circles.push(q.circles[ze+2]),xe.circles.push(q.collisionDetected?1:0)}this.placements[ei.crossTileID]=new ye(c||Ft,m||wt,d||A.justReloaded),y[ei.crossTileID]=!0};if(Pt){const ei=A.getSortedSymbolIndexes(this.transform.angle);for(let Ui=ei.length-1;Ui>=0;--Ui){const c=ei[Ui];pi(A.symbolInstances.get(c),A.collisionArrays[c])}}else for(let ei=o.symbolInstanceStart;ei<o.symbolInstanceEnd;ei++)pi(A.symbolInstances.get(ei),A.collisionArrays[ei]);if(S&&A.bucketInstanceId in this.collisionCircleArrays){const ei=this.collisionCircleArrays[A.bucketInstanceId];h.invert(ei.invProjMatrix,U),ei.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(o,y,S,A){let M;M=A===h.WritingMode.vertical?S.verticalPlacedTextSymbolIndex:{left:S.leftJustifiedTextSymbolIndex,center:S.centerJustifiedTextSymbolIndex,right:S.rightJustifiedTextSymbolIndex}[h.getAnchorJustification(y)];const U=[S.leftJustifiedTextSymbolIndex,S.centerJustifiedTextSymbolIndex,S.rightJustifiedTextSymbolIndex,S.verticalPlacedTextSymbolIndex];for(const Z of U)Z>=0&&(o.text.placedSymbolArray.get(Z).crossTileID=M>=0&&Z!==M?0:S.crossTileID)}markUsedOrientation(o,y,S){const A=y===h.WritingMode.horizontal||y===h.WritingMode.horizontalOnly?y:0,M=y===h.WritingMode.vertical?y:0,U=[S.leftJustifiedTextSymbolIndex,S.centerJustifiedTextSymbolIndex,S.rightJustifiedTextSymbolIndex];for(const Z of U)o.text.placedSymbolArray.get(Z).placedOrientation=A;S.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(S.verticalPlacedTextSymbolIndex).placedOrientation=M)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const y=this.prevPlacement;let S=!1;this.prevZoomAdjustment=y?y.zoomAdjustment(this.transform.zoom):0;const A=y?y.symbolFadeChange(o):1,M=y?y.opacities:{},U=y?y.variableOffsets:{},Z=y?y.placedOrientations:{};for(const J in this.placements){const ee=this.placements[J],re=M[J];re?(this.opacities[J]=new Ve(re,A,ee.text,ee.icon),S=S||ee.text!==re.text.placed||ee.icon!==re.icon.placed):(this.opacities[J]=new Ve(null,A,ee.text,ee.icon,ee.skipFade),S=S||ee.text||ee.icon)}for(const J in M){const ee=M[J];if(!this.opacities[J]){const re=new Ve(ee,A,!1,!1);re.isHidden()||(this.opacities[J]=re,S=S||ee.text.placed||ee.icon.placed)}}for(const J in U)this.variableOffsets[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.variableOffsets[J]=U[J]);for(const J in Z)this.placedOrientations[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.placedOrientations[J]=Z[J]);S?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=y?y.lastPlacementChangeTime:o)}updateLayerOpacities(o,y){const S={};for(const A of y){const M=A.getBucket(o);M&&A.latestFeatureIndex&&o.id===M.layerIds[0]&&this.updateBucketOpacities(M,S,A.collisionBoxArray)}}updateBucketOpacities(o,y,S){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const A=o.layers[0].layout,M=new Ve(null,0,!1,!1,!0),U=A.get("text-allow-overlap"),Z=A.get("icon-allow-overlap"),J=A.get("text-variable-anchor"),ee=A.get("text-rotation-alignment")==="map",re=A.get("text-pitch-alignment")==="map",ue=A.get("icon-text-fit")!=="none",ve=new Ve(null,0,U&&(Z||!o.hasIconData()||A.get("icon-optional")),Z&&(U||!o.hasTextData()||A.get("text-optional")),!0);!o.collisionArrays&&S&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(S);const Re=(be,De,Je)=>{for(let Xe=0;Xe<De/4;Xe++)be.opacityVertexArray.emplaceBack(Je)};for(let be=0;be<o.symbolInstances.length;be++){const De=o.symbolInstances.get(be),{numHorizontalGlyphVertices:Je,numVerticalGlyphVertices:Xe,crossTileID:nt}=De;let Ye=this.opacities[nt];y[nt]?Ye=M:Ye||(Ye=ve,this.opacities[nt]=Ye),y[nt]=!0;const xt=De.numIconVertices>0,ht=this.placedOrientations[De.crossTileID],ft=ht===h.WritingMode.vertical,Pt=ht===h.WritingMode.horizontal||ht===h.WritingMode.horizontalOnly;if(Je>0||Xe>0){const Ft=tt(Ye.text);Re(o.text,Je,ft?Ut:Ft),Re(o.text,Xe,Pt?Ut:Ft);const wt=Ye.text.isHidden();[De.rightJustifiedTextSymbolIndex,De.centerJustifiedTextSymbolIndex,De.leftJustifiedTextSymbolIndex].forEach(Ui=>{Ui>=0&&(o.text.placedSymbolArray.get(Ui).hidden=wt||ft?1:0)}),De.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(De.verticalPlacedTextSymbolIndex).hidden=wt||Pt?1:0);const pi=this.variableOffsets[De.crossTileID];pi&&this.markUsedJustification(o,pi.anchor,De,ht);const ei=this.placedOrientations[De.crossTileID];ei&&(this.markUsedJustification(o,"left",De,ei),this.markUsedOrientation(o,ei,De))}if(xt){const Ft=tt(Ye.icon),wt=!(ue&&De.verticalPlacedIconSymbolIndex&&ft);De.placedIconSymbolIndex>=0&&(Re(o.icon,De.numIconVertices,wt?Ft:Ut),o.icon.placedSymbolArray.get(De.placedIconSymbolIndex).hidden=Ye.icon.isHidden()),De.verticalPlacedIconSymbolIndex>=0&&(Re(o.icon,De.numVerticalIconVertices,wt?Ut:Ft),o.icon.placedSymbolArray.get(De.verticalPlacedIconSymbolIndex).hidden=Ye.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Ft=o.collisionArrays[be];if(Ft){let wt=new h.pointGeometry(0,0);if(Ft.textBox||Ft.verticalTextBox){let ei=!0;if(J){const Ui=this.variableOffsets[nt];Ui?(wt=W(Ui.anchor,Ui.width,Ui.height,Ui.textOffset,Ui.textBoxScale),ee&&wt._rotate(re?this.transform.angle:-this.transform.angle)):ei=!1}Ft.textBox&&ce(o.textCollisionBox.collisionVertexArray,Ye.text.placed,!ei||ft,wt.x,wt.y),Ft.verticalTextBox&&ce(o.textCollisionBox.collisionVertexArray,Ye.text.placed,!ei||Pt,wt.x,wt.y)}const pi=Boolean(!Pt&&Ft.verticalIconBox);Ft.iconBox&&ce(o.iconCollisionBox.collisionVertexArray,Ye.icon.placed,pi,ue?wt.x:0,ue?wt.y:0),Ft.verticalIconBox&&ce(o.iconCollisionBox.collisionVertexArray,Ye.icon.placed,!pi,ue?wt.x:0,ue?wt.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const be=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=be.invProjMatrix,o.placementViewportMatrix=be.viewportMatrix,o.collisionCircleArray=be.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,y){const S=this.zoomAtLastRecencyCheck===y?1-this.zoomAdjustment(y):1;return this.zoomAtLastRecencyCheck=y,this.commitTime+this.fadeDuration*S>o}setStale(){this.stale=!0}}function ce(T,o,y,S,A){T.emplaceBack(o?1:0,y?1:0,S||0,A||0),T.emplaceBack(o?1:0,y?1:0,S||0,A||0),T.emplaceBack(o?1:0,y?1:0,S||0,A||0),T.emplaceBack(o?1:0,y?1:0,S||0,A||0)}const _e=Math.pow(2,25),fe=Math.pow(2,24),Ee=Math.pow(2,17),we=Math.pow(2,16),Ie=Math.pow(2,9),et=Math.pow(2,8),Ke=Math.pow(2,1);function tt(T){if(T.opacity===0&&!T.placed)return 0;if(T.opacity===1&&T.placed)return 4294967295;const o=T.placed?1:0,y=Math.floor(127*T.opacity);return y*_e+o*fe+y*Ee+o*we+y*Ie+o*et+y*Ke+o}const Ut=0;class At{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,y,S,A,M){const U=this._bucketParts;for(;this._currentTileIndex<o.length;)if(y.getBucketParts(U,A,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,M())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,U.sort((Z,J)=>Z.sortKey-J.sortKey));this._currentPartIndex<U.length;)if(y.placeLayerBucketPart(U[this._currentPartIndex],this._seenCrossTileIDs,S),this._currentPartIndex++,M())return!0;return!1}}class Ot{constructor(o,y,S,A,M,U,Z){this.placement=new ne(o,M,U,Z),this._currentPlacementIndex=y.length-1,this._forceFullPlacement=S,this._showCollisionBoxes=A,this._done=!1}isDone(){return this._done}continuePlacement(o,y,S){const A=h.exported.now(),M=()=>{const U=h.exported.now()-A;return!this._forceFullPlacement&&U>2};for(;this._currentPlacementIndex>=0;){const U=y[o[this._currentPlacementIndex]],Z=this.placement.collisionIndex.transform.zoom;if(U.type==="symbol"&&(!U.minzoom||U.minzoom<=Z)&&(!U.maxzoom||U.maxzoom>Z)){if(this._inProgressLayer||(this._inProgressLayer=new At(U)),this._inProgressLayer.continuePlacement(S[U.source],this.placement,this._showCollisionBoxes,U,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Vt=512/h.EXTENT/2;class Hi{constructor(o,y,S){this.tileID=o,this.indexedSymbolInstances={},this.bucketInstanceId=S;for(let A=0;A<y.length;A++){const M=y.get(A),U=M.key;this.indexedSymbolInstances[U]||(this.indexedSymbolInstances[U]=[]),this.indexedSymbolInstances[U].push({crossTileID:M.crossTileID,coord:this.getScaledCoordinates(M,o)})}}getScaledCoordinates(o,y){const S=Vt/Math.pow(2,y.canonical.z-this.tileID.canonical.z);return{x:Math.floor((y.canonical.x*h.EXTENT+o.anchorX)*S),y:Math.floor((y.canonical.y*h.EXTENT+o.anchorY)*S)}}findMatches(o,y,S){const A=this.tileID.canonical.z<y.canonical.z?1:Math.pow(2,this.tileID.canonical.z-y.canonical.z);for(let M=0;M<o.length;M++){const U=o.get(M);if(U.crossTileID)continue;const Z=this.indexedSymbolInstances[U.key];if(!Z)continue;const J=this.getScaledCoordinates(U,y);for(const ee of Z)if(Math.abs(ee.coord.x-J.x)<=A&&Math.abs(ee.coord.y-J.y)<=A&&!S[ee.crossTileID]){S[ee.crossTileID]=!0,U.crossTileID=ee.crossTileID;break}}}}class gi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ci{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const y=Math.round((o-this.lng)/360);if(y!==0)for(const S in this.indexes){const A=this.indexes[S],M={};for(const U in A){const Z=A[U];Z.tileID=Z.tileID.unwrapTo(Z.tileID.wrap+y),M[Z.tileID.key]=Z}this.indexes[S]=M}this.lng=o}addBucket(o,y,S){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===y.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let M=0;M<y.symbolInstances.length;M++)y.symbolInstances.get(M).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const A=this.usedCrossTileIDs[o.overscaledZ];for(const M in this.indexes){const U=this.indexes[M];if(Number(M)>o.overscaledZ)for(const Z in U){const J=U[Z];J.tileID.isChildOf(o)&&J.findMatches(y.symbolInstances,o,A)}else{const Z=U[o.scaledTo(Number(M)).key];Z&&Z.findMatches(y.symbolInstances,o,A)}}for(let M=0;M<y.symbolInstances.length;M++){const U=y.symbolInstances.get(M);U.crossTileID||(U.crossTileID=S.generate(),A[U.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Hi(o,y.symbolInstances,y.bucketInstanceId),!0}removeBucketCrossTileIDs(o,y){for(const S in y.indexedSymbolInstances)for(const A of y.indexedSymbolInstances[S])delete this.usedCrossTileIDs[o][A.crossTileID]}removeStaleBuckets(o){let y=!1;for(const S in this.indexes){const A=this.indexes[S];for(const M in A)o[A[M].bucketInstanceId]||(this.removeBucketCrossTileIDs(S,A[M]),delete A[M],y=!0)}return y}}class ci{constructor(){this.layerIndexes={},this.crossTileIDs=new gi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,y,S){let A=this.layerIndexes[o.id];A===void 0&&(A=this.layerIndexes[o.id]=new Ci);let M=!1;const U={};A.handleWrapJump(S);for(const Z of y){const J=Z.getBucket(o);J&&o.id===J.layerIds[0]&&(J.bucketInstanceId||(J.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(Z.tileID,J,this.crossTileIDs)&&(M=!0),U[J.bucketInstanceId]=!0)}return A.removeStaleBuckets(U)&&(M=!0),M}pruneUnusedLayers(o){const y={};o.forEach(S=>{y[S]=!0});for(const S in this.layerIndexes)y[S]||delete this.layerIndexes[S]}}const Kt=(T,o)=>h.emitValidationErrors(T,o&&o.filter(y=>y.identifier!=="source.canvas")),Di=h.pick(Zi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ir=h.pick(Zi,["setCenter","setZoom","setBearing","setPitch"]),kn=function(){const T={},o=h.spec.$version;for(const y in h.spec.$root){const S=h.spec.$root[y];if(S.required){let A=null;A=y==="version"?o:S.type==="array"?[]:{},A!=null&&(T[y]=A)}}return T}();class Cr extends h.Evented{constructor(o,y={}){super(),this.map=o,this.dispatcher=new Qt(_n(),this),this.imageManager=new ct,this.imageManager.setEventedParent(this),this.glyphManager=new Et(o._requestManager,y.localIdeographFontFamily),this.lineAtlas=new Xt(256,512),this.crossTileSymbolIndex=new ci,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",h.getReferrer());const S=this;this._rtlTextPluginCallback=Cr.registerForPluginStateChange(A=>{S.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:A.pluginStatus,pluginURL:A.pluginURL},(M,U)=>{if(h.triggerPluginCompletionEvent(M),U&&U.every(Z=>Z))for(const Z in S.sourceCaches)S.sourceCaches[Z].reload()})}),this.on("data",A=>{if(A.dataType!=="source"||A.sourceDataType!=="metadata")return;const M=this.sourceCaches[A.sourceId];if(!M)return;const U=M.getSource();if(U&&U.vectorLayerIds)for(const Z in this._layers){const J=this._layers[Z];J.source===U.id&&this._validateLayer(J)}})}loadURL(o,y={}){this.fire(new h.Event("dataloading",{dataType:"style"}));const S=typeof y.validate!="boolean"||y.validate,A=this.map._requestManager.transformRequest(o,h.ResourceType.Style);this._request=h.getJSON(A,(M,U)=>{this._request=null,M?this.fire(new h.ErrorEvent(M)):U&&this._load(U,S)})}loadJSON(o,y={}){this.fire(new h.Event("dataloading",{dataType:"style"})),this._request=h.exported.frame(()=>{this._request=null,this._load(o,y.validate!==!1)})}loadEmpty(){this.fire(new h.Event("dataloading",{dataType:"style"})),this._load(kn,!1)}_load(o,y){if(y&&Kt(this,h.validateStyle(o)))return;this._loaded=!0,this.stylesheet=o;for(const A in o.sources)this.addSource(A,o.sources[A],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);const S=Hn(this.stylesheet.layers);this._order=S.map(A=>A.id),this._layers={},this._serializedLayers={};for(let A of S)A=h.createStyleLayer(A),A.setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=A,this._serializedLayers[A.id]=A.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new qi(this.stylesheet.light),this.fire(new h.Event("data",{dataType:"style"})),this.fire(new h.Event("style.load"))}_loadSprite(o){this._spriteRequest=function(y,S,A,M){let U,Z,J;const ee=A>1?"@2x":"";let re=h.getJSON(S.transformRequest(S.normalizeSpriteURL(y,ee,".json"),h.ResourceType.SpriteJSON),(Re,be)=>{re=null,J||(J=Re,U=be,ve())}),ue=h.getImage(S.transformRequest(S.normalizeSpriteURL(y,ee,".png"),h.ResourceType.SpriteImage),(Re,be)=>{ue=null,J||(J=Re,Z=be,ve())});function ve(){if(J)M(J);else if(U&&Z){const Re=h.exported.getImageData(Z),be={};for(const De in U){const{width:Je,height:Xe,x:nt,y:Ye,sdf:xt,pixelRatio:ht,stretchX:ft,stretchY:Pt,content:Ft}=U[De],wt=new h.RGBAImage({width:Je,height:Xe});h.RGBAImage.copy(Re,wt,{x:nt,y:Ye},{x:0,y:0},{width:Je,height:Xe}),be[De]={data:wt,pixelRatio:ht,sdf:xt,stretchX:ft,stretchY:Pt,content:Ft}}M(null,be)}}return{cancel(){re&&(re.cancel(),re=null),ue&&(ue.cancel(),ue=null)}}}(o,this.map._requestManager,this.map.getPixelRatio(),(y,S)=>{if(this._spriteRequest=null,y)this.fire(new h.ErrorEvent(y));else if(S)for(const A in S)this.imageManager.addImage(A,S[A]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))})}_validateLayer(o){const y=this.sourceCaches[o.source];if(!y)return;const S=o.sourceLayer;if(!S)return;const A=y.getSource();(A.type==="geojson"||A.vectorLayerIds&&A.vectorLayerIds.indexOf(S)===-1)&&this.fire(new h.ErrorEvent(new Error(`Source layer "${S}" does not exist on source "${A.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const y=[];for(const S of o){const A=this._layers[S];A.type!=="custom"&&y.push(A.serialize())}return y}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const y=this._changed;if(this._changed){const A=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);(A.length||M.length)&&this._updateWorkerLayers(A,M);for(const U in this._updatedSources){const Z=this._updatedSources[U];Z==="reload"?this._reloadSource(U):Z==="clear"&&this._clearSource(U)}this._updateTilesForChangedImages();for(const U in this._updatedPaintProps)this._layers[U].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}const S={};for(const A in this.sourceCaches){const M=this.sourceCaches[A];S[A]=M.used,M.used=!1}for(const A of this._order){const M=this._layers[A];M.recalculate(o,this._availableImages),!M.isHidden(o.zoom)&&M.source&&(this.sourceCaches[M.source].used=!0)}for(const A in S){const M=this.sourceCaches[A];S[A]!==M.used&&M.fire(new h.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:A}))}this.light.recalculate(o),this.z=o.zoom,y&&this.fire(new h.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const y in this.sourceCaches)this.sourceCaches[y].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,y){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:y})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),Kt(this,h.validateStyle(o)))return!1;(o=h.clone$1(o)).layers=Hn(o.layers);const y=function(A,M){if(!A)return[{command:Zi.setStyle,args:[M]}];let U=[];try{if(!G(A.version,M.version))return[{command:Zi.setStyle,args:[M]}];G(A.center,M.center)||U.push({command:Zi.setCenter,args:[M.center]}),G(A.zoom,M.zoom)||U.push({command:Zi.setZoom,args:[M.zoom]}),G(A.bearing,M.bearing)||U.push({command:Zi.setBearing,args:[M.bearing]}),G(A.pitch,M.pitch)||U.push({command:Zi.setPitch,args:[M.pitch]}),G(A.sprite,M.sprite)||U.push({command:Zi.setSprite,args:[M.sprite]}),G(A.glyphs,M.glyphs)||U.push({command:Zi.setGlyphs,args:[M.glyphs]}),G(A.transition,M.transition)||U.push({command:Zi.setTransition,args:[M.transition]}),G(A.light,M.light)||U.push({command:Zi.setLight,args:[M.light]});const Z={},J=[];(function(re,ue,ve,Re){let be;for(be in ue=ue||{},re=re||{})Object.prototype.hasOwnProperty.call(re,be)&&(Object.prototype.hasOwnProperty.call(ue,be)||Ao(be,ve,Re));for(be in ue)Object.prototype.hasOwnProperty.call(ue,be)&&(Object.prototype.hasOwnProperty.call(re,be)?G(re[be],ue[be])||(re[be].type==="geojson"&&ue[be].type==="geojson"&&Ba(re,ue,be)?ve.push({command:Zi.setGeoJSONSourceData,args:[be,ue[be].data]}):Wn(be,ue,ve,Re)):Un(be,ue,ve))})(A.sources,M.sources,J,Z);const ee=[];A.layers&&A.layers.forEach(re=>{Z[re.source]?U.push({command:Zi.removeLayer,args:[re.id]}):ee.push(re)}),U=U.concat(J),function(re,ue,ve){ue=ue||[];const Re=(re=re||[]).map(gt),be=ue.map(gt),De=re.reduce(Si,{}),Je=ue.reduce(Si,{}),Xe=Re.slice(),nt=Object.create(null);let Ye,xt,ht,ft,Pt,Ft,wt;for(Ye=0,xt=0;Ye<Re.length;Ye++)ht=Re[Ye],Object.prototype.hasOwnProperty.call(Je,ht)?xt++:(ve.push({command:Zi.removeLayer,args:[ht]}),Xe.splice(Xe.indexOf(ht,xt),1));for(Ye=0,xt=0;Ye<be.length;Ye++)ht=be[be.length-1-Ye],Xe[Xe.length-1-Ye]!==ht&&(Object.prototype.hasOwnProperty.call(De,ht)?(ve.push({command:Zi.removeLayer,args:[ht]}),Xe.splice(Xe.lastIndexOf(ht,Xe.length-xt),1)):xt++,Ft=Xe[Xe.length-Ye],ve.push({command:Zi.addLayer,args:[Je[ht],Ft]}),Xe.splice(Xe.length-Ye,0,ht),nt[ht]=!0);for(Ye=0;Ye<be.length;Ye++)if(ht=be[Ye],ft=De[ht],Pt=Je[ht],!nt[ht]&&!G(ft,Pt))if(G(ft.source,Pt.source)&&G(ft["source-layer"],Pt["source-layer"])&&G(ft.type,Pt.type)){for(wt in Ue(ft.layout,Pt.layout,ve,ht,null,Zi.setLayoutProperty),Ue(ft.paint,Pt.paint,ve,ht,null,Zi.setPaintProperty),G(ft.filter,Pt.filter)||ve.push({command:Zi.setFilter,args:[ht,Pt.filter]}),G(ft.minzoom,Pt.minzoom)&&G(ft.maxzoom,Pt.maxzoom)||ve.push({command:Zi.setLayerZoomRange,args:[ht,Pt.minzoom,Pt.maxzoom]}),ft)Object.prototype.hasOwnProperty.call(ft,wt)&&wt!=="layout"&&wt!=="paint"&&wt!=="filter"&&wt!=="metadata"&&wt!=="minzoom"&&wt!=="maxzoom"&&(wt.indexOf("paint.")===0?Ue(ft[wt],Pt[wt],ve,ht,wt.slice(6),Zi.setPaintProperty):G(ft[wt],Pt[wt])||ve.push({command:Zi.setLayerProperty,args:[ht,wt,Pt[wt]]}));for(wt in Pt)Object.prototype.hasOwnProperty.call(Pt,wt)&&!Object.prototype.hasOwnProperty.call(ft,wt)&&wt!=="layout"&&wt!=="paint"&&wt!=="filter"&&wt!=="metadata"&&wt!=="minzoom"&&wt!=="maxzoom"&&(wt.indexOf("paint.")===0?Ue(ft[wt],Pt[wt],ve,ht,wt.slice(6),Zi.setPaintProperty):G(ft[wt],Pt[wt])||ve.push({command:Zi.setLayerProperty,args:[ht,wt,Pt[wt]]}))}else ve.push({command:Zi.removeLayer,args:[ht]}),Ft=Xe[Xe.lastIndexOf(ht)+1],ve.push({command:Zi.addLayer,args:[Pt,Ft]})}(ee,M.layers,U)}catch(Z){console.warn("Unable to compute style diff:",Z),U=[{command:Zi.setStyle,args:[M]}]}return U}(this.serialize(),o).filter(A=>!(A.command in Ir));if(y.length===0)return!1;const S=y.filter(A=>!(A.command in Di));if(S.length>0)throw new Error(`Unimplemented: ${S.map(A=>A.command).join(", ")}.`);return y.forEach(A=>{A.command!=="setTransition"&&this[A.command].apply(this,A.args)}),this.stylesheet=o,!0}addImage(o,y){if(this.getImage(o))return this.fire(new h.ErrorEvent(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,y),this._afterImageUpdated(o)}updateImage(o,y){this.imageManager.updateImage(o,y)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new h.ErrorEvent(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,y,S={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!y.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(y).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(y.type)>=0&&this._validate(h.validateStyle.source,`sources.${o}`,y,null,S))return;this.map&&this.map._collectResourceTiming&&(y.collectResourceTiming=!0);const A=this.sourceCaches[o]=new rt(o,y,this.dispatcher);A.style=this,A.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:A.serialize(),sourceId:o})),A.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===o)return this.fire(new h.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${S}" is using it.`)));const y=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],y.fire(new h.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),y.setEventedParent(null),y.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,y){this._checkLoaded(),this.sourceCaches[o].getSource().setData(y),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,y,S={}){this._checkLoaded();const A=o.id;if(this.getLayer(A))return void this.fire(new h.ErrorEvent(new Error(`Layer "${A}" already exists on this map.`)));let M;if(o.type==="custom"){if(Kt(this,h.validateCustomStyleLayer(o)))return;M=h.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(A,o.source),o=h.clone$1(o),o=h.extend(o,{source:A})),this._validate(h.validateStyle.layer,`layers.${A}`,o,{arrayIndex:-1},S))return;M=h.createStyleLayer(o),this._validateLayer(M),M.setEventedParent(this,{layer:{id:A}}),this._serializedLayers[M.id]=M.serialize()}const U=y?this._order.indexOf(y):this._order.length;if(y&&U===-1)this.fire(new h.ErrorEvent(new Error(`Cannot add layer "${A}" before non-existing layer "${y}".`)));else{if(this._order.splice(U,0,A),this._layerOrderChanged=!0,this._layers[A]=M,this._removedLayers[A]&&M.source&&M.type!=="custom"){const Z=this._removedLayers[A];delete this._removedLayers[A],Z.type!==M.type?this._updatedSources[M.source]="clear":(this._updatedSources[M.source]="reload",this.sourceCaches[M.source].pause())}this._updateLayer(M),M.onAdd&&M.onAdd(this.map)}}moveLayer(o,y){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new h.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===y)return;const S=this._order.indexOf(o);this._order.splice(S,1);const A=y?this._order.indexOf(y):this._order.length;y&&A===-1?this.fire(new h.ErrorEvent(new Error(`Cannot move layer "${o}" before non-existing layer "${y}".`))):(this._order.splice(A,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const y=this._layers[o];if(!y)return void this.fire(new h.ErrorEvent(new Error(`Cannot remove non-existing layer "${o}".`)));y.setEventedParent(null);const S=this._order.indexOf(o);this._order.splice(S,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=y,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],y.onRemove&&y.onRemove(this.map)}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,y,S){this._checkLoaded();const A=this.getLayer(o);A?A.minzoom===y&&A.maxzoom===S||(y!=null&&(A.minzoom=y),S!=null&&(A.maxzoom=S),this._updateLayer(A)):this.fire(new h.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,y,S={}){this._checkLoaded();const A=this.getLayer(o);if(A){if(!G(A.filter,y))return y==null?(A.filter=void 0,void this._updateLayer(A)):void(this._validate(h.validateStyle.filter,`layers.${A.id}.filter`,y,null,S)||(A.filter=h.clone$1(y),this._updateLayer(A)))}else this.fire(new h.ErrorEvent(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return h.clone$1(this.getLayer(o).filter)}setLayoutProperty(o,y,S,A={}){this._checkLoaded();const M=this.getLayer(o);M?G(M.getLayoutProperty(y),S)||(M.setLayoutProperty(y,S,A),this._updateLayer(M)):this.fire(new h.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,y){const S=this.getLayer(o);if(S)return S.getLayoutProperty(y);this.fire(new h.ErrorEvent(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,y,S,A={}){this._checkLoaded();const M=this.getLayer(o);M?G(M.getPaintProperty(y),S)||(M.setPaintProperty(y,S,A)&&this._updateLayer(M),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new h.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,y){return this.getLayer(o).getPaintProperty(y)}setFeatureState(o,y){this._checkLoaded();const S=o.source,A=o.sourceLayer,M=this.sourceCaches[S];if(M===void 0)return void this.fire(new h.ErrorEvent(new Error(`The source '${S}' does not exist in the map's style.`)));const U=M.getSource().type;U==="geojson"&&A?this.fire(new h.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):U!=="vector"||A?(o.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),M.setFeatureState(A,o.id,y)):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,y){this._checkLoaded();const S=o.source,A=this.sourceCaches[S];if(A===void 0)return void this.fire(new h.ErrorEvent(new Error(`The source '${S}' does not exist in the map's style.`)));const M=A.getSource().type,U=M==="vector"?o.sourceLayer:void 0;M!=="vector"||U?y&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new h.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):A.removeFeatureState(U,o.id,y):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const y=o.source,S=o.sourceLayer,A=this.sourceCaches[y];if(A!==void 0)return A.getSource().type!=="vector"||S?(o.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),A.getFeatureState(S,o.id)):void this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new h.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)))}getTransition(){return h.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:h.mapObject(this.sourceCaches,o=>o.serialize()),layers:this._serializeLayers(this._order)},o=>o!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(o){const y=U=>this._layers[U].type==="fill-extrusion",S={},A=[];for(let U=this._order.length-1;U>=0;U--){const Z=this._order[U];if(y(Z)){S[Z]=U;for(const J of o){const ee=J[Z];if(ee)for(const re of ee)A.push(re)}}}A.sort((U,Z)=>Z.intersectionZ-U.intersectionZ);const M=[];for(let U=this._order.length-1;U>=0;U--){const Z=this._order[U];if(y(Z))for(let J=A.length-1;J>=0;J--){const ee=A[J].feature;if(S[ee.layer.id]<U)break;M.push(ee),A.pop()}else for(const J of o){const ee=J[Z];if(ee)for(const re of ee)M.push(re.feature)}}return M}queryRenderedFeatures(o,y,S){y&&y.filter&&this._validate(h.validateStyle.filter,"queryRenderedFeatures.filter",y.filter,null,y);const A={};if(y&&y.layers){if(!Array.isArray(y.layers))return this.fire(new h.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const U of y.layers){const Z=this._layers[U];if(!Z)return this.fire(new h.ErrorEvent(new Error(`The layer '${U}' does not exist in the map's style and cannot be queried for features.`))),[];A[Z.source]=!0}}const M=[];y.availableImages=this._availableImages;for(const U in this.sourceCaches)y.layers&&!A[U]||M.push(rr(this.sourceCaches[U],this._layers,this._serializedLayers,o,y,S));return this.placement&&M.push(function(U,Z,J,ee,re,ue,ve){const Re={},be=ue.queryRenderedSymbols(ee),De=[];for(const Je of Object.keys(be).map(Number))De.push(ve[Je]);De.sort(zi);for(const Je of De){const Xe=Je.featureIndex.lookupSymbolFeatures(be[Je.bucketInstanceId],Z,Je.bucketIndex,Je.sourceLayerIndex,re.filter,re.layers,re.availableImages,U);for(const nt in Xe){const Ye=Re[nt]=Re[nt]||[],xt=Xe[nt];xt.sort((ht,ft)=>{const Pt=Je.featureSortOrder;if(Pt){const Ft=Pt.indexOf(ht.featureIndex);return Pt.indexOf(ft.featureIndex)-Ft}return ft.featureIndex-ht.featureIndex});for(const ht of xt)Ye.push(ht)}}for(const Je in Re)Re[Je].forEach(Xe=>{const nt=Xe.feature,Ye=J[U[Je].source].getFeatureState(nt.layer["source-layer"],nt.id);nt.source=nt.layer.source,nt.layer["source-layer"]&&(nt.sourceLayer=nt.layer["source-layer"]),nt.state=Ye});return Re}(this._layers,this._serializedLayers,this.sourceCaches,o,y,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(M)}querySourceFeatures(o,y){y&&y.filter&&this._validate(h.validateStyle.filter,"querySourceFeatures.filter",y.filter,null,y);const S=this.sourceCaches[o];return S?function(A,M){const U=A.getRenderableIds().map(ee=>A.getTileByID(ee)),Z=[],J={};for(let ee=0;ee<U.length;ee++){const re=U[ee],ue=re.tileID.canonical.key;J[ue]||(J[ue]=!0,re.querySourceFeatures(Z,M))}return Z}(S,y):[]}addSourceType(o,y,S){return Cr.getSourceType(o)?S(new Error(`A source type called "${o}" already exists.`)):(Cr.setSourceType(o,y),y.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:y.workerSourceURL},S):S(null,null))}getLight(){return this.light.getLight()}setLight(o,y={}){this._checkLoaded();const S=this.light.getLight();let A=!1;for(const U in o)if(!G(o[U],S[U])){A=!0;break}if(!A)return;const M={now:h.exported.now(),transition:h.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,y),this.light.updateTransitions(M)}_validate(o,y,S,A,M={}){return(!M||M.validate!==!1)&&Kt(this,o.call(h.validateStyle,h.extend({key:y,style:this.serialize(),value:S,styleSpec:h.spec},A)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),h.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const y=this.sourceCaches[o];y.setEventedParent(null),y.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const y in this.sourceCaches)this.sourceCaches[y].update(o)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,y,S,A,M=!1){let U=!1,Z=!1;const J={};for(const ee of this._order){const re=this._layers[ee];if(re.type!=="symbol")continue;if(!J[re.source]){const ve=this.sourceCaches[re.source];J[re.source]=ve.getRenderableIds(!0).map(Re=>ve.getTileByID(Re)).sort((Re,be)=>be.tileID.overscaledZ-Re.tileID.overscaledZ||(Re.tileID.isLessThan(be.tileID)?-1:1))}const ue=this.crossTileSymbolIndex.addLayer(re,J[re.source],o.center.lng);U=U||ue}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((M=M||this._layerOrderChanged||S===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(h.exported.now(),o.zoom))&&(this.pauseablePlacement=new Ot(o,this._order,M,y,S,A,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,J),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(h.exported.now()),Z=!0),U&&this.pauseablePlacement.placement.setStale()),Z||U)for(const ee of this._order){const re=this._layers[ee];re.type==="symbol"&&this.placement.updateLayerOpacities(re,J[re.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(h.exported.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,y,S){this.imageManager.getImages(y.icons,S),this._updateTilesForChangedImages();const A=this.sourceCaches[y.source];A&&A.setDependencies(y.tileID.key,y.type,y.icons)}getGlyphs(o,y,S){this.glyphManager.getGlyphs(y.stacks,S)}getResource(o,y,S){return h.makeRequest(y,S)}}Cr.getSourceType=function(T){return Ri[T]},Cr.setSourceType=function(T,o){Ri[T]=o},Cr.registerForPluginStateChange=h.registerForPluginStateChange;var Eo=h.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ol={prelude:qr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),background:qr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:qr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:qr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:qr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:qr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:qr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:qr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:qr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:qr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),fill:qr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:qr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:qr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:qr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:qr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:qr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:qr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:qr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:qr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),lineGradient:qr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),linePattern:qr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:qr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:qr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:qr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),symbolSDF:qr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:qr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`)};function qr(T,o){const y=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,S=o.match(/attribute ([\w]+) ([\w]+)/g),A=T.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),U=M?M.concat(A):A,Z={};return{fragmentSource:T=T.replace(y,(J,ee,re,ue,ve)=>(Z[ve]=!0,ee==="define"?`
#ifndef HAS_UNIFORM_u_${ve}
varying ${re} ${ue} ${ve};
#else
uniform ${re} ${ue} u_${ve};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ve}
    ${re} ${ue} ${ve} = u_${ve};
#endif
`)),vertexSource:o=o.replace(y,(J,ee,re,ue,ve)=>{const Re=ue==="float"?"vec2":"vec4",be=ve.match(/color/)?"color":Re;return Z[ve]?ee==="define"?`
#ifndef HAS_UNIFORM_u_${ve}
uniform lowp float u_${ve}_t;
attribute ${re} ${Re} a_${ve};
varying ${re} ${ue} ${ve};
#else
uniform ${re} ${ue} u_${ve};
#endif
`:be==="vec4"?`
#ifndef HAS_UNIFORM_u_${ve}
    ${ve} = a_${ve};
#else
    ${re} ${ue} ${ve} = u_${ve};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ve}
    ${ve} = unpack_mix_${be}(a_${ve}, u_${ve}_t);
#else
    ${re} ${ue} ${ve} = u_${ve};
#endif
`:ee==="define"?`
#ifndef HAS_UNIFORM_u_${ve}
uniform lowp float u_${ve}_t;
attribute ${re} ${Re} a_${ve};
#else
uniform ${re} ${ue} u_${ve};
#endif
`:be==="vec4"?`
#ifndef HAS_UNIFORM_u_${ve}
    ${re} ${ue} ${ve} = a_${ve};
#else
    ${re} ${ue} ${ve} = u_${ve};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ve}
    ${re} ${ue} ${ve} = unpack_mix_${be}(a_${ve}, u_${ve}_t);
#else
    ${re} ${ue} ${ve} = u_${ve};
#endif
`}),staticAttributes:S,staticUniforms:U}}class In{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,y,S,A,M,U,Z,J){this.context=o;let ee=this.boundPaintVertexBuffers.length!==A.length;for(let re=0;!ee&&re<A.length;re++)this.boundPaintVertexBuffers[re]!==A[re]&&(ee=!0);o.extVertexArrayObject&&this.vao&&this.boundProgram===y&&this.boundLayoutVertexBuffer===S&&!ee&&this.boundIndexBuffer===M&&this.boundVertexOffset===U&&this.boundDynamicVertexBuffer===Z&&this.boundDynamicVertexBuffer2===J?(o.bindVertexArrayOES.set(this.vao),Z&&Z.bind(),M&&M.dynamicDraw&&M.bind(),J&&J.bind()):this.freshBind(y,S,A,M,U,Z,J)}freshBind(o,y,S,A,M,U,Z){let J;const ee=o.numAttributes,re=this.context,ue=re.gl;if(re.extVertexArrayObject)this.vao&&this.destroy(),this.vao=re.extVertexArrayObject.createVertexArrayOES(),re.bindVertexArrayOES.set(this.vao),J=0,this.boundProgram=o,this.boundLayoutVertexBuffer=y,this.boundPaintVertexBuffers=S,this.boundIndexBuffer=A,this.boundVertexOffset=M,this.boundDynamicVertexBuffer=U,this.boundDynamicVertexBuffer2=Z;else{J=re.currentNumAttributes||0;for(let ve=ee;ve<J;ve++)ue.disableVertexAttribArray(ve)}y.enableAttributes(ue,o);for(const ve of S)ve.enableAttributes(ue,o);U&&U.enableAttributes(ue,o),Z&&Z.enableAttributes(ue,o),y.bind(),y.setVertexAttribPointers(ue,o,M);for(const ve of S)ve.bind(),ve.setVertexAttribPointers(ue,o,M);U&&(U.bind(),U.setVertexAttribPointers(ue,o,M)),A&&A.bind(),Z&&(Z.bind(),Z.setVertexAttribPointers(ue,o,M)),re.currentNumAttributes=ee}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function qs(T){const o=[];for(let y=0;y<T.length;y++){if(T[y]===null)continue;const S=T[y].split(" ");o.push(S.pop())}return o}class Co{constructor(o,y,S,A,M,U){const Z=o.gl;this.program=Z.createProgram();const J=qs(S.staticAttributes),ee=A?A.getBinderAttributes():[],re=J.concat(ee),ue=S.staticUniforms?qs(S.staticUniforms):[],ve=A?A.getBinderUniforms():[],Re=ue.concat(ve),be=[];for(const ht of Re)be.indexOf(ht)<0&&be.push(ht);const De=A?A.defines():[];U&&De.push("#define OVERDRAW_INSPECTOR;");const Je=De.concat(Ol.prelude.fragmentSource,S.fragmentSource).join(`
`),Xe=De.concat(Ol.prelude.vertexSource,S.vertexSource).join(`
`),nt=Z.createShader(Z.FRAGMENT_SHADER);if(Z.isContextLost())return void(this.failedToCreate=!0);Z.shaderSource(nt,Je),Z.compileShader(nt),Z.attachShader(this.program,nt);const Ye=Z.createShader(Z.VERTEX_SHADER);if(Z.isContextLost())return void(this.failedToCreate=!0);Z.shaderSource(Ye,Xe),Z.compileShader(Ye),Z.attachShader(this.program,Ye),this.attributes={};const xt={};this.numAttributes=re.length;for(let ht=0;ht<this.numAttributes;ht++)re[ht]&&(Z.bindAttribLocation(this.program,ht,re[ht]),this.attributes[re[ht]]=ht);Z.linkProgram(this.program),Z.deleteShader(Ye),Z.deleteShader(nt);for(let ht=0;ht<be.length;ht++){const ft=be[ht];if(ft&&!xt[ft]){const Pt=Z.getUniformLocation(this.program,ft);Pt&&(xt[ft]=Pt)}}this.fixedUniforms=M(o,xt),this.binderUniforms=A?A.getUniforms(o,xt):[]}draw(o,y,S,A,M,U,Z,J,ee,re,ue,ve,Re,be,De,Je){const Xe=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(S),o.setStencilMode(A),o.setColorMode(M),o.setCullFace(U);for(const Ye in this.fixedUniforms)this.fixedUniforms[Ye].set(Z[Ye]);be&&be.setUniforms(o,this.binderUniforms,ve,{zoom:Re});const nt={[Xe.LINES]:2,[Xe.TRIANGLES]:3,[Xe.LINE_STRIP]:1}[y];for(const Ye of ue.get()){const xt=Ye.vaos||(Ye.vaos={});(xt[J]||(xt[J]=new In)).bind(o,this,ee,be?be.getPaintVertexBuffers():[],re,Ye.vertexOffset,De,Je),Xe.drawElements(y,Ye.primitiveLength*nt,Xe.UNSIGNED_SHORT,Ye.primitiveOffset*nt*2)}}}function Rn(T,o,y){const S=1/Se(y,1,o.transform.tileZoom),A=Math.pow(2,y.tileID.overscaledZ),M=y.tileSize*Math.pow(2,o.transform.tileZoom)/A,U=M*(y.tileID.canonical.x+y.tileID.wrap*A),Z=M*y.tileID.canonical.y;return{u_image:0,u_texsize:y.imageAtlasTexture.size,u_scale:[S,T.fromScale,T.toScale],u_fade:T.t,u_pixel_coord_upper:[U>>16,Z>>16],u_pixel_coord_lower:[65535&U,65535&Z]}}const oa=(T,o,y,S)=>{const A=o.style.light,M=A.properties.get("position"),U=[M.x,M.y,M.z],Z=function(){var ee=new h.ARRAY_TYPE(9);return h.ARRAY_TYPE!=Float32Array&&(ee[1]=0,ee[2]=0,ee[3]=0,ee[5]=0,ee[6]=0,ee[7]=0),ee[0]=1,ee[4]=1,ee[8]=1,ee}();A.properties.get("anchor")==="viewport"&&function(ee,re){var ue=Math.sin(re),ve=Math.cos(re);ee[0]=ve,ee[1]=ue,ee[2]=0,ee[3]=-ue,ee[4]=ve,ee[5]=0,ee[6]=0,ee[7]=0,ee[8]=1}(Z,-o.transform.angle),function(ee,re,ue){var ve=re[0],Re=re[1],be=re[2];ee[0]=ve*ue[0]+Re*ue[3]+be*ue[6],ee[1]=ve*ue[1]+Re*ue[4]+be*ue[7],ee[2]=ve*ue[2]+Re*ue[5]+be*ue[8]}(U,U,Z);const J=A.properties.get("color");return{u_matrix:T,u_lightpos:U,u_lightintensity:A.properties.get("intensity"),u_lightcolor:[J.r,J.g,J.b],u_vertical_gradient:+y,u_opacity:S}},Qr=(T,o,y,S,A,M,U)=>h.extend(oa(T,o,y,S),Rn(M,o,U),{u_height_factor:-Math.pow(2,A.overscaledZ)/U.tileSize/8}),aa=T=>({u_matrix:T}),Fo=(T,o,y,S)=>h.extend(aa(T),Rn(y,o,S)),Qu=(T,o)=>({u_matrix:T,u_world:o}),sa=(T,o,y,S,A)=>h.extend(Fo(T,o,y,S),{u_world:A}),Gs=(T,o,y,S)=>{const A=T.transform;let M,U;if(S.paint.get("circle-pitch-alignment")==="map"){const Z=Se(y,1,A.zoom);M=!0,U=[Z,Z]}else M=!1,U=A.pixelsToGLUnits;return{u_camera_to_center_distance:A.cameraToCenterDistance,u_scale_with_map:+(S.paint.get("circle-pitch-scale")==="map"),u_matrix:T.translatePosMatrix(o.posMatrix,y,S.paint.get("circle-translate"),S.paint.get("circle-translate-anchor")),u_pitch_with_map:+M,u_device_pixel_ratio:T.pixelRatio,u_extrude_scale:U}},ga=(T,o,y)=>{const S=Se(y,1,o.zoom),A=Math.pow(2,o.zoom-y.tileID.overscaledZ),M=y.tileID.overscaleFactor();return{u_matrix:T,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:S,u_extrude_scale:[o.pixelsToGLUnits[0]/(S*A),o.pixelsToGLUnits[1]/(S*A)],u_overscale_factor:M}},Sn=(T,o,y=1)=>({u_matrix:T,u_color:o,u_overlay:0,u_overlay_scale:y}),Zo=T=>({u_matrix:T}),$n=(T,o,y,S)=>({u_matrix:T,u_extrude_scale:Se(o,1,y),u_intensity:S});function Oa(T,o){const y=Math.pow(2,o.canonical.z),S=o.canonical.y;return[new h.MercatorCoordinate(0,S/y).toLngLat().lat,new h.MercatorCoordinate(0,(S+1)/y).toLngLat().lat]}const Fl=(T,o,y)=>{const S=T.transform;return{u_matrix:ec(T,o,y),u_ratio:1/Se(o,1,S.zoom),u_device_pixel_ratio:T.pixelRatio,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},wu=(T,o,y,S)=>h.extend(Fl(T,o,y),{u_image:0,u_image_height:S}),Zs=(T,o,y,S)=>{const A=T.transform,M=ml(o,A);return{u_matrix:ec(T,o,y),u_texsize:o.imageAtlasTexture.size,u_ratio:1/Se(o,1,A.zoom),u_device_pixel_ratio:T.pixelRatio,u_image:0,u_scale:[M,S.fromScale,S.toScale],u_fade:S.t,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]]}},Nn=(T,o,y,S,A)=>{const M=T.lineAtlas,U=ml(o,T.transform),Z=y.layout.get("line-cap")==="round",J=M.getDash(S.from,Z),ee=M.getDash(S.to,Z),re=J.width*A.fromScale,ue=ee.width*A.toScale;return h.extend(Fl(T,o,y),{u_patternscale_a:[U/re,-J.height/2],u_patternscale_b:[U/ue,-ee.height/2],u_sdfgamma:M.width/(256*Math.min(re,ue)*T.pixelRatio)/2,u_image:0,u_tex_y_a:J.y,u_tex_y_b:ee.y,u_mix:A.t})};function ml(T,o){return 1/Se(T,1,o.tileZoom)}function ec(T,o,y){return T.translatePosMatrix(o.tileID.posMatrix,o,y.paint.get("line-translate"),y.paint.get("line-translate-anchor"))}const tc=(T,o,y,S,A)=>{return{u_matrix:T,u_tl_parent:o,u_scale_parent:y,u_buffer_scale:1,u_fade_t:S.mix,u_opacity:S.opacity*A.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:A.paint.get("raster-brightness-min"),u_brightness_high:A.paint.get("raster-brightness-max"),u_saturation_factor:(U=A.paint.get("raster-saturation"),U>0?1-1/(1.001-U):-U),u_contrast_factor:(M=A.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:ic(A.paint.get("raster-hue-rotate"))};var M,U};function ic(T){T*=Math.PI/180;const o=Math.sin(T),y=Math.cos(T);return[(2*y+1)/3,(-Math.sqrt(3)*o-y+1)/3,(Math.sqrt(3)*o-y+1)/3]}const ts=(T,o,y,S,A,M,U,Z,J,ee)=>{const re=A.transform;return{u_is_size_zoom_constant:+(T==="constant"||T==="source"),u_is_size_feature_constant:+(T==="constant"||T==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:re.cameraToCenterDistance,u_pitch:re.pitch/360*2*Math.PI,u_rotate_symbol:+y,u_aspect_ratio:re.width/re.height,u_fade_change:A.options.fadeDuration?A.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:U,u_coord_matrix:Z,u_is_text:+J,u_pitch_with_map:+S,u_texsize:ee,u_texture:0}},Ul=(T,o,y,S,A,M,U,Z,J,ee,re)=>{const ue=A.transform;return h.extend(ts(T,o,y,S,A,M,U,Z,J,ee),{u_gamma_scale:S?Math.cos(ue._pitch)*ue.cameraToCenterDistance:1,u_device_pixel_ratio:A.pixelRatio,u_is_halo:+re})},Nl=(T,o,y,S,A,M,U,Z,J,ee)=>h.extend(Ul(T,o,y,S,A,M,U,Z,!0,J,!0),{u_texsize_icon:ee,u_texture_icon:1}),Bc=(T,o,y)=>({u_matrix:T,u_opacity:o,u_color:y}),yl=(T,o,y,S,A,M)=>h.extend(function(U,Z,J,ee){const re=J.imageManager.getPattern(U.from.toString()),ue=J.imageManager.getPattern(U.to.toString()),{width:ve,height:Re}=J.imageManager.getPixelSize(),be=Math.pow(2,ee.tileID.overscaledZ),De=ee.tileSize*Math.pow(2,J.transform.tileZoom)/be,Je=De*(ee.tileID.canonical.x+ee.tileID.wrap*be),Xe=De*ee.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:re.tl,u_pattern_br_a:re.br,u_pattern_tl_b:ue.tl,u_pattern_br_b:ue.br,u_texsize:[ve,Re],u_mix:Z.t,u_pattern_size_a:re.displaySize,u_pattern_size_b:ue.displaySize,u_scale_a:Z.fromScale,u_scale_b:Z.toScale,u_tile_units_to_pixels:1/Se(ee,1,J.transform.tileZoom),u_pixel_coord_upper:[Je>>16,Xe>>16],u_pixel_coord_lower:[65535&Je,65535&Xe]}}(S,M,y,A),{u_matrix:T,u_opacity:o}),Ho={fillExtrusion:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_lightpos:new h.Uniform3f(T,o.u_lightpos),u_lightintensity:new h.Uniform1f(T,o.u_lightintensity),u_lightcolor:new h.Uniform3f(T,o.u_lightcolor),u_vertical_gradient:new h.Uniform1f(T,o.u_vertical_gradient),u_opacity:new h.Uniform1f(T,o.u_opacity)}),fillExtrusionPattern:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_lightpos:new h.Uniform3f(T,o.u_lightpos),u_lightintensity:new h.Uniform1f(T,o.u_lightintensity),u_lightcolor:new h.Uniform3f(T,o.u_lightcolor),u_vertical_gradient:new h.Uniform1f(T,o.u_vertical_gradient),u_height_factor:new h.Uniform1f(T,o.u_height_factor),u_image:new h.Uniform1i(T,o.u_image),u_texsize:new h.Uniform2f(T,o.u_texsize),u_pixel_coord_upper:new h.Uniform2f(T,o.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(T,o.u_pixel_coord_lower),u_scale:new h.Uniform3f(T,o.u_scale),u_fade:new h.Uniform1f(T,o.u_fade),u_opacity:new h.Uniform1f(T,o.u_opacity)}),fill:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix)}),fillPattern:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_image:new h.Uniform1i(T,o.u_image),u_texsize:new h.Uniform2f(T,o.u_texsize),u_pixel_coord_upper:new h.Uniform2f(T,o.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(T,o.u_pixel_coord_lower),u_scale:new h.Uniform3f(T,o.u_scale),u_fade:new h.Uniform1f(T,o.u_fade)}),fillOutline:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_world:new h.Uniform2f(T,o.u_world)}),fillOutlinePattern:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_world:new h.Uniform2f(T,o.u_world),u_image:new h.Uniform1i(T,o.u_image),u_texsize:new h.Uniform2f(T,o.u_texsize),u_pixel_coord_upper:new h.Uniform2f(T,o.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(T,o.u_pixel_coord_lower),u_scale:new h.Uniform3f(T,o.u_scale),u_fade:new h.Uniform1f(T,o.u_fade)}),circle:(T,o)=>({u_camera_to_center_distance:new h.Uniform1f(T,o.u_camera_to_center_distance),u_scale_with_map:new h.Uniform1i(T,o.u_scale_with_map),u_pitch_with_map:new h.Uniform1i(T,o.u_pitch_with_map),u_extrude_scale:new h.Uniform2f(T,o.u_extrude_scale),u_device_pixel_ratio:new h.Uniform1f(T,o.u_device_pixel_ratio),u_matrix:new h.UniformMatrix4f(T,o.u_matrix)}),collisionBox:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_camera_to_center_distance:new h.Uniform1f(T,o.u_camera_to_center_distance),u_pixels_to_tile_units:new h.Uniform1f(T,o.u_pixels_to_tile_units),u_extrude_scale:new h.Uniform2f(T,o.u_extrude_scale),u_overscale_factor:new h.Uniform1f(T,o.u_overscale_factor)}),collisionCircle:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_inv_matrix:new h.UniformMatrix4f(T,o.u_inv_matrix),u_camera_to_center_distance:new h.Uniform1f(T,o.u_camera_to_center_distance),u_viewport_size:new h.Uniform2f(T,o.u_viewport_size)}),debug:(T,o)=>({u_color:new h.UniformColor(T,o.u_color),u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_overlay:new h.Uniform1i(T,o.u_overlay),u_overlay_scale:new h.Uniform1f(T,o.u_overlay_scale)}),clippingMask:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix)}),heatmap:(T,o)=>({u_extrude_scale:new h.Uniform1f(T,o.u_extrude_scale),u_intensity:new h.Uniform1f(T,o.u_intensity),u_matrix:new h.UniformMatrix4f(T,o.u_matrix)}),heatmapTexture:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_world:new h.Uniform2f(T,o.u_world),u_image:new h.Uniform1i(T,o.u_image),u_color_ramp:new h.Uniform1i(T,o.u_color_ramp),u_opacity:new h.Uniform1f(T,o.u_opacity)}),hillshade:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_image:new h.Uniform1i(T,o.u_image),u_latrange:new h.Uniform2f(T,o.u_latrange),u_light:new h.Uniform2f(T,o.u_light),u_shadow:new h.UniformColor(T,o.u_shadow),u_highlight:new h.UniformColor(T,o.u_highlight),u_accent:new h.UniformColor(T,o.u_accent)}),hillshadePrepare:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_image:new h.Uniform1i(T,o.u_image),u_dimension:new h.Uniform2f(T,o.u_dimension),u_zoom:new h.Uniform1f(T,o.u_zoom),u_unpack:new h.Uniform4f(T,o.u_unpack)}),line:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_ratio:new h.Uniform1f(T,o.u_ratio),u_device_pixel_ratio:new h.Uniform1f(T,o.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(T,o.u_units_to_pixels)}),lineGradient:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_ratio:new h.Uniform1f(T,o.u_ratio),u_device_pixel_ratio:new h.Uniform1f(T,o.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(T,o.u_units_to_pixels),u_image:new h.Uniform1i(T,o.u_image),u_image_height:new h.Uniform1f(T,o.u_image_height)}),linePattern:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_texsize:new h.Uniform2f(T,o.u_texsize),u_ratio:new h.Uniform1f(T,o.u_ratio),u_device_pixel_ratio:new h.Uniform1f(T,o.u_device_pixel_ratio),u_image:new h.Uniform1i(T,o.u_image),u_units_to_pixels:new h.Uniform2f(T,o.u_units_to_pixels),u_scale:new h.Uniform3f(T,o.u_scale),u_fade:new h.Uniform1f(T,o.u_fade)}),lineSDF:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_ratio:new h.Uniform1f(T,o.u_ratio),u_device_pixel_ratio:new h.Uniform1f(T,o.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(T,o.u_units_to_pixels),u_patternscale_a:new h.Uniform2f(T,o.u_patternscale_a),u_patternscale_b:new h.Uniform2f(T,o.u_patternscale_b),u_sdfgamma:new h.Uniform1f(T,o.u_sdfgamma),u_image:new h.Uniform1i(T,o.u_image),u_tex_y_a:new h.Uniform1f(T,o.u_tex_y_a),u_tex_y_b:new h.Uniform1f(T,o.u_tex_y_b),u_mix:new h.Uniform1f(T,o.u_mix)}),raster:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_tl_parent:new h.Uniform2f(T,o.u_tl_parent),u_scale_parent:new h.Uniform1f(T,o.u_scale_parent),u_buffer_scale:new h.Uniform1f(T,o.u_buffer_scale),u_fade_t:new h.Uniform1f(T,o.u_fade_t),u_opacity:new h.Uniform1f(T,o.u_opacity),u_image0:new h.Uniform1i(T,o.u_image0),u_image1:new h.Uniform1i(T,o.u_image1),u_brightness_low:new h.Uniform1f(T,o.u_brightness_low),u_brightness_high:new h.Uniform1f(T,o.u_brightness_high),u_saturation_factor:new h.Uniform1f(T,o.u_saturation_factor),u_contrast_factor:new h.Uniform1f(T,o.u_contrast_factor),u_spin_weights:new h.Uniform3f(T,o.u_spin_weights)}),symbolIcon:(T,o)=>({u_is_size_zoom_constant:new h.Uniform1i(T,o.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(T,o.u_is_size_feature_constant),u_size_t:new h.Uniform1f(T,o.u_size_t),u_size:new h.Uniform1f(T,o.u_size),u_camera_to_center_distance:new h.Uniform1f(T,o.u_camera_to_center_distance),u_pitch:new h.Uniform1f(T,o.u_pitch),u_rotate_symbol:new h.Uniform1i(T,o.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(T,o.u_aspect_ratio),u_fade_change:new h.Uniform1f(T,o.u_fade_change),u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(T,o.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(T,o.u_coord_matrix),u_is_text:new h.Uniform1i(T,o.u_is_text),u_pitch_with_map:new h.Uniform1i(T,o.u_pitch_with_map),u_texsize:new h.Uniform2f(T,o.u_texsize),u_texture:new h.Uniform1i(T,o.u_texture)}),symbolSDF:(T,o)=>({u_is_size_zoom_constant:new h.Uniform1i(T,o.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(T,o.u_is_size_feature_constant),u_size_t:new h.Uniform1f(T,o.u_size_t),u_size:new h.Uniform1f(T,o.u_size),u_camera_to_center_distance:new h.Uniform1f(T,o.u_camera_to_center_distance),u_pitch:new h.Uniform1f(T,o.u_pitch),u_rotate_symbol:new h.Uniform1i(T,o.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(T,o.u_aspect_ratio),u_fade_change:new h.Uniform1f(T,o.u_fade_change),u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(T,o.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(T,o.u_coord_matrix),u_is_text:new h.Uniform1i(T,o.u_is_text),u_pitch_with_map:new h.Uniform1i(T,o.u_pitch_with_map),u_texsize:new h.Uniform2f(T,o.u_texsize),u_texture:new h.Uniform1i(T,o.u_texture),u_gamma_scale:new h.Uniform1f(T,o.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(T,o.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(T,o.u_is_halo)}),symbolTextAndIcon:(T,o)=>({u_is_size_zoom_constant:new h.Uniform1i(T,o.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(T,o.u_is_size_feature_constant),u_size_t:new h.Uniform1f(T,o.u_size_t),u_size:new h.Uniform1f(T,o.u_size),u_camera_to_center_distance:new h.Uniform1f(T,o.u_camera_to_center_distance),u_pitch:new h.Uniform1f(T,o.u_pitch),u_rotate_symbol:new h.Uniform1i(T,o.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(T,o.u_aspect_ratio),u_fade_change:new h.Uniform1f(T,o.u_fade_change),u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(T,o.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(T,o.u_coord_matrix),u_is_text:new h.Uniform1i(T,o.u_is_text),u_pitch_with_map:new h.Uniform1i(T,o.u_pitch_with_map),u_texsize:new h.Uniform2f(T,o.u_texsize),u_texsize_icon:new h.Uniform2f(T,o.u_texsize_icon),u_texture:new h.Uniform1i(T,o.u_texture),u_texture_icon:new h.Uniform1i(T,o.u_texture_icon),u_gamma_scale:new h.Uniform1f(T,o.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(T,o.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(T,o.u_is_halo)}),background:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_opacity:new h.Uniform1f(T,o.u_opacity),u_color:new h.UniformColor(T,o.u_color)}),backgroundPattern:(T,o)=>({u_matrix:new h.UniformMatrix4f(T,o.u_matrix),u_opacity:new h.Uniform1f(T,o.u_opacity),u_image:new h.Uniform1i(T,o.u_image),u_pattern_tl_a:new h.Uniform2f(T,o.u_pattern_tl_a),u_pattern_br_a:new h.Uniform2f(T,o.u_pattern_br_a),u_pattern_tl_b:new h.Uniform2f(T,o.u_pattern_tl_b),u_pattern_br_b:new h.Uniform2f(T,o.u_pattern_br_b),u_texsize:new h.Uniform2f(T,o.u_texsize),u_mix:new h.Uniform1f(T,o.u_mix),u_pattern_size_a:new h.Uniform2f(T,o.u_pattern_size_a),u_pattern_size_b:new h.Uniform2f(T,o.u_pattern_size_b),u_scale_a:new h.Uniform1f(T,o.u_scale_a),u_scale_b:new h.Uniform1f(T,o.u_scale_b),u_pixel_coord_upper:new h.Uniform2f(T,o.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(T,o.u_pixel_coord_lower),u_tile_units_to_pixels:new h.Uniform1f(T,o.u_tile_units_to_pixels)})};class Fa{constructor(o,y,S){this.context=o;const A=o.gl;this.buffer=A.createBuffer(),this.dynamicDraw=Boolean(S),this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,y.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||delete y.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const y=this.context.gl;this.context.unbindVAO(),this.bind(),y.bufferSubData(y.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ua={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ws{constructor(o,y,S,A){this.length=y.length,this.attributes=S,this.itemSize=y.bytesPerElement,this.dynamicDraw=A,this.context=o;const M=o.gl;this.buffer=M.createBuffer(),o.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,y.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||delete y.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const y=this.context.gl;this.bind(),y.bufferSubData(y.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,y){for(let S=0;S<this.attributes.length;S++){const A=y.attributes[this.attributes[S].name];A!==void 0&&o.enableVertexAttribArray(A)}}setVertexAttribPointers(o,y,S){for(let A=0;A<this.attributes.length;A++){const M=this.attributes[A],U=y.attributes[M.name];U!==void 0&&o.vertexAttribPointer(U,M.components,o[Ua[M.type]],!1,this.itemSize,M.offset+this.itemSize*(S||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class cr{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Es extends cr{getDefault(){return h.Color.transparent}set(o){const y=this.current;(o.r!==y.r||o.g!==y.g||o.b!==y.b||o.a!==y.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Is extends cr{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class po extends cr{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Tn extends cr{getDefault(){return[!0,!0,!0,!0]}set(o){const y=this.current;(o[0]!==y[0]||o[1]!==y[1]||o[2]!==y[2]||o[3]!==y[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class fo extends cr{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Eu extends cr{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Iu extends cr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const y=this.current;(o.func!==y.func||o.ref!==y.ref||o.mask!==y.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Su extends cr{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const y=this.current;(o[0]!==y[0]||o[1]!==y[1]||o[2]!==y[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class jl extends cr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const y=this.gl;o?y.enable(y.STENCIL_TEST):y.disable(y.STENCIL_TEST),this.current=o,this.dirty=!1}}class Vl extends cr{getDefault(){return[0,1]}set(o){const y=this.current;(o[0]!==y[0]||o[1]!==y[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class gl extends cr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const y=this.gl;o?y.enable(y.DEPTH_TEST):y.disable(y.DEPTH_TEST),this.current=o,this.dirty=!1}}class ql extends cr{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Tu extends cr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const y=this.gl;o?y.enable(y.BLEND):y.disable(y.BLEND),this.current=o,this.dirty=!1}}class Gl extends cr{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const y=this.current;(o[0]!==y[0]||o[1]!==y[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Oc extends cr{getDefault(){return h.Color.transparent}set(o){const y=this.current;(o.r!==y.r||o.g!==y.g||o.b!==y.b||o.a!==y.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class _l extends cr{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Na extends cr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const y=this.gl;o?y.enable(y.CULL_FACE):y.disable(y.CULL_FACE),this.current=o,this.dirty=!1}}class Fc extends cr{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class mo extends cr{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class rc extends cr{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Ss extends cr{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Ts extends cr{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const y=this.current;(o[0]!==y[0]||o[1]!==y[1]||o[2]!==y[2]||o[3]!==y[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Hs extends cr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const y=this.gl;y.bindFramebuffer(y.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class is extends cr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const y=this.gl;y.bindRenderbuffer(y.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class ja extends cr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const y=this.gl;y.bindTexture(y.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class _a extends cr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const y=this.gl;y.bindBuffer(y.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class As extends cr{getDefault(){return null}set(o){const y=this.gl;y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class rs extends cr{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class Au extends cr{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const y=this.gl;y.pixelStorei(y.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Cs extends cr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const y=this.gl;y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Gr extends cr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const y=this.gl;y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Ws extends cr{constructor(o,y){super(o),this.context=o,this.parent=y}getDefault(){return null}}class ns extends Ws{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const y=this.gl;y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class nc extends Ws{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const y=this.gl;y.framebufferRenderbuffer(y.FRAMEBUFFER,y.DEPTH_ATTACHMENT,y.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Cu{constructor(o,y,S,A){this.context=o,this.width=y,this.height=S;const M=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new ns(o,M),A&&(this.depthAttachment=new nc(o,M))}destroy(){const o=this.context.gl,y=this.colorAttachment.get();if(y&&o.deleteTexture(y),this.depthAttachment){const S=this.depthAttachment.get();S&&o.deleteRenderbuffer(S)}o.deleteFramebuffer(this.framebuffer)}}class Ji{constructor(o,y,S){this.blendFunction=o,this.blendColor=y,this.mask=S}}Ji.Replace=[1,0],Ji.disabled=new Ji(Ji.Replace,h.Color.transparent,[!1,!1,!1,!1]),Ji.unblended=new Ji(Ji.Replace,h.Color.transparent,[!0,!0,!0,!0]),Ji.alphaBlended=new Ji([1,771],h.Color.transparent,[!0,!0,!0,!0]);class Zl{constructor(o){this.gl=o,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Es(this),this.clearDepth=new Is(this),this.clearStencil=new po(this),this.colorMask=new Tn(this),this.depthMask=new fo(this),this.stencilMask=new Eu(this),this.stencilFunc=new Iu(this),this.stencilOp=new Su(this),this.stencilTest=new jl(this),this.depthRange=new Vl(this),this.depthTest=new gl(this),this.depthFunc=new ql(this),this.blend=new Tu(this),this.blendFunc=new Gl(this),this.blendColor=new Oc(this),this.blendEquation=new _l(this),this.cullFace=new Na(this),this.cullFaceSide=new Fc(this),this.frontFace=new mo(this),this.program=new rc(this),this.activeTexture=new Ss(this),this.viewport=new Ts(this),this.bindFramebuffer=new Hs(this),this.bindRenderbuffer=new is(this),this.bindTexture=new ja(this),this.bindVertexBuffer=new _a(this),this.bindElementBuffer=new As(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new rs(this),this.pixelStoreUnpack=new Au(this),this.pixelStoreUnpackPremultiplyAlpha=new Cs(this),this.pixelStoreUnpackFlipY=new Gr(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=o.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(o.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,y){return new Fa(this,o,y)}createVertexBuffer(o,y,S){return new ws(this,o,y,S)}createRenderbuffer(o,y,S){const A=this.gl,M=A.createRenderbuffer();return this.bindRenderbuffer.set(M),A.renderbufferStorage(A.RENDERBUFFER,o,y,S),this.bindRenderbuffer.set(null),M}createFramebuffer(o,y,S){return new Cu(this,o,y,S)}clear({color:o,depth:y}){const S=this.gl;let A=0;o&&(A|=S.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),y!==void 0&&(A|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(y),this.depthMask.set(!0)),S.clear(A)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){G(o.blendFunction,Ji.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class wr{constructor(o,y,S){this.func=o,this.mask=y,this.range=S}}wr.ReadOnly=!1,wr.ReadWrite=!0,wr.disabled=new wr(519,wr.ReadOnly,[0,1]);const Ta=7680;class Kr{constructor(o,y,S,A,M,U){this.test=o,this.ref=y,this.mask=S,this.fail=A,this.depthFail=M,this.pass=U}}Kr.disabled=new Kr({func:519,mask:0},0,0,Ta,Ta,Ta);class An{constructor(o,y,S){this.enable=o,this.mode=y,this.frontFace=S}}let Hl;function Wl(T,o,y,S,A,M,U){const Z=T.context,J=Z.gl,ee=T.useProgram("collisionBox"),re=[];let ue=0,ve=0;for(let Ye=0;Ye<S.length;Ye++){const xt=S[Ye],ht=o.getTile(xt),ft=ht.getBucket(y);if(!ft)continue;let Pt=xt.posMatrix;A[0]===0&&A[1]===0||(Pt=T.translatePosMatrix(xt.posMatrix,ht,A,M));const Ft=U?ft.textCollisionBox:ft.iconCollisionBox,wt=ft.collisionCircleArray;if(wt.length>0){const pi=h.create(),ei=Pt;h.mul(pi,ft.placementInvProjMatrix,T.transform.glCoordMatrix),h.mul(pi,pi,ft.placementViewportMatrix),re.push({circleArray:wt,circleOffset:ve,transform:ei,invTransform:pi}),ue+=wt.length/4,ve=ue}Ft&&ee.draw(Z,J.LINES,wr.disabled,Kr.disabled,T.colorModeForRenderPass(),An.disabled,ga(Pt,T.transform,ht),y.id,Ft.layoutVertexBuffer,Ft.indexBuffer,Ft.segments,null,T.transform.zoom,null,null,Ft.collisionVertexBuffer)}if(!U||!re.length)return;const Re=T.useProgram("collisionCircle"),be=new h.CollisionCircleLayoutArray;be.resize(4*ue),be._trim();let De=0;for(const Ye of re)for(let xt=0;xt<Ye.circleArray.length/4;xt++){const ht=4*xt,ft=Ye.circleArray[ht+0],Pt=Ye.circleArray[ht+1],Ft=Ye.circleArray[ht+2],wt=Ye.circleArray[ht+3];be.emplace(De++,ft,Pt,Ft,wt,0),be.emplace(De++,ft,Pt,Ft,wt,1),be.emplace(De++,ft,Pt,Ft,wt,2),be.emplace(De++,ft,Pt,Ft,wt,3)}(!Hl||Hl.length<2*ue)&&(Hl=function(Ye){const xt=2*Ye,ht=new h.QuadTriangleArray;ht.resize(xt),ht._trim();for(let ft=0;ft<xt;ft++){const Pt=6*ft;ht.uint16[Pt+0]=4*ft+0,ht.uint16[Pt+1]=4*ft+1,ht.uint16[Pt+2]=4*ft+2,ht.uint16[Pt+3]=4*ft+2,ht.uint16[Pt+4]=4*ft+3,ht.uint16[Pt+5]=4*ft+0}return ht}(ue));const Je=Z.createIndexBuffer(Hl,!0),Xe=Z.createVertexBuffer(be,h.collisionCircleLayout.members,!0);for(const Ye of re){const xt={u_matrix:Ye.transform,u_inv_matrix:Ye.invTransform,u_camera_to_center_distance:(nt=T.transform).cameraToCenterDistance,u_viewport_size:[nt.width,nt.height]};Re.draw(Z,J.TRIANGLES,wr.disabled,Kr.disabled,T.colorModeForRenderPass(),An.disabled,xt,y.id,Xe,Je,h.SegmentVector.simpleSegment(0,2*Ye.circleOffset,Ye.circleArray.length,Ye.circleArray.length/2),null,T.transform.zoom,null,null,null)}var nt;Xe.destroy(),Je.destroy()}An.disabled=new An(!1,1029,2305),An.backCCW=new An(!0,1029,2305);const Xs=h.identity(new Float32Array(16));function ku(T,o,y,S,A,M){const{horizontalAlign:U,verticalAlign:Z}=h.getAnchorAlignment(T),J=-(U-.5)*o,ee=-(Z-.5)*y,re=h.evaluateVariableOffset(T,S);return new h.pointGeometry((J/A+re[0])*M,(ee/A+re[1])*M)}function Va(T,o,y,S,A,M,U,Z,J,ee){const re=T.text.placedSymbolArray,ue=T.text.dynamicLayoutVertexArray,ve=T.icon.dynamicLayoutVertexArray,Re={};ue.clear();for(let be=0;be<re.length;be++){const De=re.get(be),Je=T.allowVerticalPlacement&&!De.placedOrientation,Xe=De.hidden||!De.crossTileID||Je?null:S[De.crossTileID];if(Xe){const nt=new h.pointGeometry(De.anchorX,De.anchorY),Ye=Yr(nt,y?U:M),xt=Ht(A.cameraToCenterDistance,Ye.signedDistanceFromCamera);let ht=h.evaluateSizeForFeature(T.textSizeData,J,De)*xt/h.ONE_EM;y&&(ht*=T.tilePixelRatio/Z);const{width:ft,height:Pt,anchor:Ft,textOffset:wt,textBoxScale:pi}=Xe,ei=ku(Ft,ft,Pt,wt,pi,ht),Ui=y?Yr(nt.add(ei),M).point:Ye.point.add(o?ei.rotate(-A.angle):ei),c=T.allowVerticalPlacement&&De.placedOrientation===h.WritingMode.vertical?Math.PI/2:0;for(let m=0;m<De.numGlyphs;m++)h.addDynamicAttributes(ue,Ui,c);ee&&De.associatedIconIndex>=0&&(Re[De.associatedIconIndex]={shiftedAnchor:Ui,angle:c})}else te(De.numGlyphs,ue)}if(ee){ve.clear();const be=T.icon.placedSymbolArray;for(let De=0;De<be.length;De++){const Je=be.get(De);if(Je.hidden)te(Je.numGlyphs,ve);else{const Xe=Re[De];if(Xe)for(let nt=0;nt<Je.numGlyphs;nt++)h.addDynamicAttributes(ve,Xe.shiftedAnchor,Xe.angle);else te(Je.numGlyphs,ve)}}T.icon.dynamicLayoutVertexBuffer.updateData(ve)}T.text.dynamicLayoutVertexBuffer.updateData(ue)}function qa(T,o,y){return y.iconsInText&&o?"symbolTextAndIcon":T?"symbolSDF":"symbolIcon"}function Xl(T,o,y,S,A,M,U,Z,J,ee,re,ue){const ve=T.context,Re=ve.gl,be=T.transform,De=Z==="map",Je=J==="map",Xe=Z!=="viewport"&&y.layout.get("symbol-placement")!=="point",nt=De&&!Je&&!Xe,Ye=!y.layout.get("symbol-sort-key").isConstant();let xt=!1;const ht=T.depthModeForSublayer(0,wr.ReadOnly),ft=y.layout.get("text-variable-anchor"),Pt=[];for(const Ft of S){const wt=o.getTile(Ft),pi=wt.getBucket(y);if(!pi)continue;const ei=A?pi.text:pi.icon;if(!ei||!ei.segments.get().length)continue;const Ui=ei.programConfigurations.get(y.id),c=A||pi.sdfIcons,m=A?pi.textSizeData:pi.iconSizeData,d=Je||be.pitch!==0,x=T.useProgram(qa(c,A,pi),Ui),k=h.evaluateSizeForZoom(m,be.zoom);let L,B,q,$,ie=[0,0],he=null;if(A){if(B=wt.glyphAtlasTexture,q=Re.LINEAR,L=wt.glyphAtlasTexture.size,pi.iconsInText){ie=wt.imageAtlasTexture.size,he=wt.imageAtlasTexture;const st=m.kind==="composite"||m.kind==="camera";$=d||T.options.rotating||T.options.zooming||st?Re.LINEAR:Re.NEAREST}}else{const st=y.layout.get("icon-size").constantOr(0)!==1||pi.iconsNeedLinear;B=wt.imageAtlasTexture,q=c||T.options.rotating||T.options.zooming||st||d?Re.LINEAR:Re.NEAREST,L=wt.imageAtlasTexture.size}const de=Se(wt,1,T.transform.zoom),me=Kn(Ft.posMatrix,Je,De,T.transform,de),Ce=na(Ft.posMatrix,Je,De,T.transform,de),Te=ft&&pi.hasTextData(),Le=y.layout.get("icon-text-fit")!=="none"&&Te&&pi.hasIconData();if(Xe){const st=y.layout.get("text-rotation-alignment")==="map";Ki(pi,Ft.posMatrix,T,A,me,Ce,Je,ee,st)}const xe=T.translatePosMatrix(Ft.posMatrix,wt,M,U),ze=Xe||A&&ft||Le?Xs:me,Fe=T.translatePosMatrix(Ce,wt,M,U,!0),$e=c&&y.paint.get(A?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ot;ot=c?pi.iconsInText?Nl(m.kind,k,nt,Je,T,xe,ze,Fe,L,ie):Ul(m.kind,k,nt,Je,T,xe,ze,Fe,A,L,!0):ts(m.kind,k,nt,Je,T,xe,ze,Fe,A,L);const at={program:x,buffers:ei,uniformValues:ot,atlasTexture:B,atlasTextureIcon:he,atlasInterpolation:q,atlasInterpolationIcon:$,isSDF:c,hasHalo:$e};if(Ye&&pi.canOverlap){xt=!0;const st=ei.segments.get();for(const It of st)Pt.push({segments:new h.SegmentVector([It]),sortKey:It.sortKey,state:at})}else Pt.push({segments:ei.segments,sortKey:0,state:at})}xt&&Pt.sort((Ft,wt)=>Ft.sortKey-wt.sortKey);for(const Ft of Pt){const wt=Ft.state;if(ve.activeTexture.set(Re.TEXTURE0),wt.atlasTexture.bind(wt.atlasInterpolation,Re.CLAMP_TO_EDGE),wt.atlasTextureIcon&&(ve.activeTexture.set(Re.TEXTURE1),wt.atlasTextureIcon&&wt.atlasTextureIcon.bind(wt.atlasInterpolationIcon,Re.CLAMP_TO_EDGE)),wt.isSDF){const pi=wt.uniformValues;wt.hasHalo&&(pi.u_is_halo=1,ks(wt.buffers,Ft.segments,y,T,wt.program,ht,re,ue,pi)),pi.u_is_halo=0}ks(wt.buffers,Ft.segments,y,T,wt.program,ht,re,ue,wt.uniformValues)}}function ks(T,o,y,S,A,M,U,Z,J){const ee=S.context;A.draw(ee,ee.gl.TRIANGLES,M,U,Z,An.disabled,J,y.id,T.layoutVertexBuffer,T.indexBuffer,o,y.paint,S.transform.zoom,T.programConfigurations.get(y.id),T.dynamicLayoutVertexBuffer,T.opacityVertexBuffer)}function Jr(T,o,y,S,A,M,U){const Z=T.context.gl,J=y.paint.get("fill-pattern"),ee=J&&J.constantOr(1),re=y.getCrossfadeParameters();let ue,ve,Re,be,De;U?(ve=ee&&!y.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ue=Z.LINES):(ve=ee?"fillPattern":"fill",ue=Z.TRIANGLES);for(const Je of S){const Xe=o.getTile(Je);if(ee&&!Xe.patternsLoaded())continue;const nt=Xe.getBucket(y);if(!nt)continue;const Ye=nt.programConfigurations.get(y.id),xt=T.useProgram(ve,Ye);ee&&(T.context.activeTexture.set(Z.TEXTURE0),Xe.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Ye.updatePaintBuffers(re));const ht=J.constantOr(null);if(ht&&Xe.imageAtlas){const Pt=Xe.imageAtlas,Ft=Pt.patternPositions[ht.to.toString()],wt=Pt.patternPositions[ht.from.toString()];Ft&&wt&&Ye.setConstantPatternPositions(Ft,wt)}const ft=T.translatePosMatrix(Je.posMatrix,Xe,y.paint.get("fill-translate"),y.paint.get("fill-translate-anchor"));if(U){be=nt.indexBuffer2,De=nt.segments2;const Pt=[Z.drawingBufferWidth,Z.drawingBufferHeight];Re=ve==="fillOutlinePattern"&&ee?sa(ft,T,re,Xe,Pt):Qu(ft,Pt)}else be=nt.indexBuffer,De=nt.segments,Re=ee?Fo(ft,T,re,Xe):aa(ft);xt.draw(T.context,ue,A,T.stencilModeForClipping(Je),M,An.disabled,Re,y.id,nt.layoutVertexBuffer,be,De,y.paint,T.transform.zoom,Ye)}}function os(T,o,y,S,A,M,U){const Z=T.context,J=Z.gl,ee=y.paint.get("fill-extrusion-pattern"),re=ee.constantOr(1),ue=y.getCrossfadeParameters(),ve=y.paint.get("fill-extrusion-opacity");for(const Re of S){const be=o.getTile(Re),De=be.getBucket(y);if(!De)continue;const Je=De.programConfigurations.get(y.id),Xe=T.useProgram(re?"fillExtrusionPattern":"fillExtrusion",Je);re&&(T.context.activeTexture.set(J.TEXTURE0),be.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),Je.updatePaintBuffers(ue));const nt=ee.constantOr(null);if(nt&&be.imageAtlas){const ft=be.imageAtlas,Pt=ft.patternPositions[nt.to.toString()],Ft=ft.patternPositions[nt.from.toString()];Pt&&Ft&&Je.setConstantPatternPositions(Pt,Ft)}const Ye=T.translatePosMatrix(Re.posMatrix,be,y.paint.get("fill-extrusion-translate"),y.paint.get("fill-extrusion-translate-anchor")),xt=y.paint.get("fill-extrusion-vertical-gradient"),ht=re?Qr(Ye,T,xt,ve,Re,ue,be):oa(Ye,T,xt,ve);Xe.draw(Z,Z.gl.TRIANGLES,A,M,U,An.backCCW,ht,y.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,y.paint,T.transform.zoom,Je)}}function zu(T,o,y,S,A,M){const U=T.context,Z=U.gl,J=o.fbo;if(!J)return;const ee=T.useProgram("hillshade");U.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,J.colorAttachment.get());const re=((ue,ve,Re)=>{const be=Re.paint.get("hillshade-shadow-color"),De=Re.paint.get("hillshade-highlight-color"),Je=Re.paint.get("hillshade-accent-color");let Xe=Re.paint.get("hillshade-illumination-direction")*(Math.PI/180);Re.paint.get("hillshade-illumination-anchor")==="viewport"&&(Xe-=ue.transform.angle);const nt=!ue.options.moving;return{u_matrix:ue.transform.calculatePosMatrix(ve.tileID.toUnwrapped(),nt),u_image:0,u_latrange:Oa(0,ve.tileID),u_light:[Re.paint.get("hillshade-exaggeration"),Xe],u_shadow:be,u_highlight:De,u_accent:Je}})(T,o,y);ee.draw(U,Z.TRIANGLES,S,A,M,An.disabled,re,y.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments)}function ko(T,o,y,S,A,M){const U=T.context,Z=U.gl,J=o.dem;if(J&&J.data){const ee=J.dim,re=J.stride,ue=J.getPixels();if(U.activeTexture.set(Z.TEXTURE1),U.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||T.getTileTexture(re),o.demTexture){const Re=o.demTexture;Re.update(ue,{premultiply:!1}),Re.bind(Z.NEAREST,Z.CLAMP_TO_EDGE)}else o.demTexture=new Ze(U,ue,Z.RGBA,{premultiply:!1}),o.demTexture.bind(Z.NEAREST,Z.CLAMP_TO_EDGE);U.activeTexture.set(Z.TEXTURE0);let ve=o.fbo;if(!ve){const Re=new Ze(U,{width:ee,height:ee,data:null},Z.RGBA);Re.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),ve=o.fbo=U.createFramebuffer(ee,ee,!0),ve.colorAttachment.set(Re.texture)}U.bindFramebuffer.set(ve.framebuffer),U.viewport.set([0,0,ee,ee]),T.useProgram("hillshadePrepare").draw(U,Z.TRIANGLES,S,A,M,An.disabled,((Re,be)=>{const De=be.stride,Je=h.create();return h.ortho(Je,0,h.EXTENT,-h.EXTENT,0,0,1),h.translate(Je,Je,[0,-h.EXTENT,0]),{u_matrix:Je,u_image:1,u_dimension:[De,De],u_zoom:Re.overscaledZ,u_unpack:be.getUnpackVector()}})(o.tileID,J),y.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function oc(T,o,y,S,A){const M=S.paint.get("raster-fade-duration");if(M>0){const U=h.exported.now(),Z=(U-T.timeAdded)/M,J=o?(U-o.timeAdded)/M:-1,ee=y.getSource(),re=A.coveringZoomLevel({tileSize:ee.tileSize,roundZoom:ee.roundZoom}),ue=!o||Math.abs(o.tileID.overscaledZ-re)>Math.abs(T.tileID.overscaledZ-re),ve=ue&&T.refreshedUponExpiration?1:h.clamp(ue?Z:1-J,0,1);return T.refreshedUponExpiration&&Z>=1&&(T.refreshedUponExpiration=!1),o?{opacity:1,mix:1-ve}:{opacity:ve,mix:0}}return{opacity:1,mix:0}}const Uc=new h.Color(1,0,0,1),ac=new h.Color(0,1,0,1),as=new h.Color(0,0,1,1),ss=new h.Color(1,0,1,1),Ks=new h.Color(0,1,1,1);function Kl(T,o,y,S){ls(T,0,o+y/2,T.transform.width,y,S)}function zs(T,o,y,S){ls(T,o-y/2,0,y,T.transform.height,S)}function ls(T,o,y,S,A,M){const U=T.context,Z=U.gl;Z.enable(Z.SCISSOR_TEST),Z.scissor(o*T.pixelRatio,y*T.pixelRatio,S*T.pixelRatio,A*T.pixelRatio),U.clear({color:M}),Z.disable(Z.SCISSOR_TEST)}function sc(T,o,y){const S=T.context,A=S.gl,M=y.posMatrix,U=T.useProgram("debug"),Z=wr.disabled,J=Kr.disabled,ee=T.colorModeForRenderPass(),re="$debug";S.activeTexture.set(A.TEXTURE0),T.emptyTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),U.draw(S,A.LINE_STRIP,Z,J,ee,An.disabled,Sn(M,h.Color.red),re,T.debugBuffer,T.tileBorderIndexBuffer,T.debugSegments);const ue=o.getTileByID(y.key).latestRawTileData,ve=Math.floor((ue&&ue.byteLength||0)/1024),Re=o.getTile(y).tileSize,be=512/Math.min(Re,512)*(y.overscaledZ/T.transform.zoom)*.5;let De=y.canonical.toString();y.overscaledZ!==y.canonical.z&&(De+=` => ${y.overscaledZ}`),function(Je,Xe){Je.initDebugOverlayCanvas();const nt=Je.debugOverlayCanvas,Ye=Je.context.gl,xt=Je.debugOverlayCanvas.getContext("2d");xt.clearRect(0,0,nt.width,nt.height),xt.shadowColor="white",xt.shadowBlur=2,xt.lineWidth=1.5,xt.strokeStyle="white",xt.textBaseline="top",xt.font="bold 36px Open Sans, sans-serif",xt.fillText(Xe,5,5),xt.strokeText(Xe,5,5),Je.debugOverlayTexture.update(nt),Je.debugOverlayTexture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE)}(T,`${De} ${ve}kb`),U.draw(S,A.TRIANGLES,Z,J,Ji.alphaBlended,An.disabled,Sn(M,h.Color.transparent,be),re,T.debugBuffer,T.quadTriangleIndexBuffer,T.debugSegments)}const Ga={symbol:function(T,o,y,S,A){if(T.renderPass!=="translucent")return;const M=Kr.disabled,U=T.colorModeForRenderPass();y.layout.get("text-variable-anchor")&&function(Z,J,ee,re,ue,ve,Re){const be=J.transform,De=ue==="map",Je=ve==="map";for(const Xe of Z){const nt=re.getTile(Xe),Ye=nt.getBucket(ee);if(!Ye||!Ye.text||!Ye.text.segments.get().length)continue;const xt=h.evaluateSizeForZoom(Ye.textSizeData,be.zoom),ht=Se(nt,1,J.transform.zoom),ft=Kn(Xe.posMatrix,Je,De,J.transform,ht),Pt=ee.layout.get("icon-text-fit")!=="none"&&Ye.hasIconData();if(xt){const Ft=Math.pow(2,be.zoom-nt.tileID.overscaledZ);Va(Ye,De,Je,Re,be,ft,Xe.posMatrix,Ft,xt,Pt)}}}(S,T,y,o,y.layout.get("text-rotation-alignment"),y.layout.get("text-pitch-alignment"),A),y.paint.get("icon-opacity").constantOr(1)!==0&&Xl(T,o,y,S,!1,y.paint.get("icon-translate"),y.paint.get("icon-translate-anchor"),y.layout.get("icon-rotation-alignment"),y.layout.get("icon-pitch-alignment"),y.layout.get("icon-keep-upright"),M,U),y.paint.get("text-opacity").constantOr(1)!==0&&Xl(T,o,y,S,!0,y.paint.get("text-translate"),y.paint.get("text-translate-anchor"),y.layout.get("text-rotation-alignment"),y.layout.get("text-pitch-alignment"),y.layout.get("text-keep-upright"),M,U),o.map.showCollisionBoxes&&(Wl(T,o,y,S,y.paint.get("text-translate"),y.paint.get("text-translate-anchor"),!0),Wl(T,o,y,S,y.paint.get("icon-translate"),y.paint.get("icon-translate-anchor"),!1))},circle:function(T,o,y,S){if(T.renderPass!=="translucent")return;const A=y.paint.get("circle-opacity"),M=y.paint.get("circle-stroke-width"),U=y.paint.get("circle-stroke-opacity"),Z=!y.layout.get("circle-sort-key").isConstant();if(A.constantOr(1)===0&&(M.constantOr(1)===0||U.constantOr(1)===0))return;const J=T.context,ee=J.gl,re=T.depthModeForSublayer(0,wr.ReadOnly),ue=Kr.disabled,ve=T.colorModeForRenderPass(),Re=[];for(let be=0;be<S.length;be++){const De=S[be],Je=o.getTile(De),Xe=Je.getBucket(y);if(!Xe)continue;const nt=Xe.programConfigurations.get(y.id),Ye={programConfiguration:nt,program:T.useProgram("circle",nt),layoutVertexBuffer:Xe.layoutVertexBuffer,indexBuffer:Xe.indexBuffer,uniformValues:Gs(T,De,Je,y)};if(Z){const xt=Xe.segments.get();for(const ht of xt)Re.push({segments:new h.SegmentVector([ht]),sortKey:ht.sortKey,state:Ye})}else Re.push({segments:Xe.segments,sortKey:0,state:Ye})}Z&&Re.sort((be,De)=>be.sortKey-De.sortKey);for(const be of Re){const{programConfiguration:De,program:Je,layoutVertexBuffer:Xe,indexBuffer:nt,uniformValues:Ye}=be.state;Je.draw(J,ee.TRIANGLES,re,ue,ve,An.disabled,Ye,y.id,Xe,nt,be.segments,y.paint,T.transform.zoom,De)}},heatmap:function(T,o,y,S){if(y.paint.get("heatmap-opacity")!==0)if(T.renderPass==="offscreen"){const A=T.context,M=A.gl,U=Kr.disabled,Z=new Ji([M.ONE,M.ONE],h.Color.transparent,[!0,!0,!0,!0]);(function(J,ee,re){const ue=J.gl;J.activeTexture.set(ue.TEXTURE1),J.viewport.set([0,0,ee.width/4,ee.height/4]);let ve=re.heatmapFbo;if(ve)ue.bindTexture(ue.TEXTURE_2D,ve.colorAttachment.get()),J.bindFramebuffer.set(ve.framebuffer);else{const Re=ue.createTexture();ue.bindTexture(ue.TEXTURE_2D,Re),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MAG_FILTER,ue.LINEAR),ve=re.heatmapFbo=J.createFramebuffer(ee.width/4,ee.height/4,!1),function(be,De,Je,Xe){const nt=be.gl;nt.texImage2D(nt.TEXTURE_2D,0,nt.RGBA,De.width/4,De.height/4,0,nt.RGBA,be.extRenderToTextureHalfFloat?be.extTextureHalfFloat.HALF_FLOAT_OES:nt.UNSIGNED_BYTE,null),Xe.colorAttachment.set(Je)}(J,ee,Re,ve)}})(A,T,y),A.clear({color:h.Color.transparent});for(let J=0;J<S.length;J++){const ee=S[J];if(o.hasRenderableParent(ee))continue;const re=o.getTile(ee),ue=re.getBucket(y);if(!ue)continue;const ve=ue.programConfigurations.get(y.id),Re=T.useProgram("heatmap",ve),{zoom:be}=T.transform;Re.draw(A,M.TRIANGLES,wr.disabled,U,Z,An.disabled,$n(ee.posMatrix,re,be,y.paint.get("heatmap-intensity")),y.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,y.paint,T.transform.zoom,ve)}A.viewport.set([0,0,T.width,T.height])}else T.renderPass==="translucent"&&(T.context.setColorMode(T.colorModeForRenderPass()),function(A,M){const U=A.context,Z=U.gl,J=M.heatmapFbo;if(!J)return;U.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,J.colorAttachment.get()),U.activeTexture.set(Z.TEXTURE1);let ee=M.colorRampTexture;ee||(ee=M.colorRampTexture=new Ze(U,M.colorRamp,Z.RGBA)),ee.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),A.useProgram("heatmapTexture").draw(U,Z.TRIANGLES,wr.disabled,Kr.disabled,A.colorModeForRenderPass(),An.disabled,((re,ue,ve,Re)=>{const be=h.create();h.ortho(be,0,re.width,re.height,0,0,1);const De=re.context.gl;return{u_matrix:be,u_world:[De.drawingBufferWidth,De.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ue.paint.get("heatmap-opacity")}})(A,M),M.id,A.viewportBuffer,A.quadTriangleIndexBuffer,A.viewportSegments,M.paint,A.transform.zoom)}(T,y))},line:function(T,o,y,S){if(T.renderPass!=="translucent")return;const A=y.paint.get("line-opacity"),M=y.paint.get("line-width");if(A.constantOr(1)===0||M.constantOr(1)===0)return;const U=T.depthModeForSublayer(0,wr.ReadOnly),Z=T.colorModeForRenderPass(),J=y.paint.get("line-dasharray"),ee=y.paint.get("line-pattern"),re=ee.constantOr(1),ue=y.paint.get("line-gradient"),ve=y.getCrossfadeParameters(),Re=re?"linePattern":J?"lineSDF":ue?"lineGradient":"line",be=T.context,De=be.gl;let Je=!0;for(const Xe of S){const nt=o.getTile(Xe);if(re&&!nt.patternsLoaded())continue;const Ye=nt.getBucket(y);if(!Ye)continue;const xt=Ye.programConfigurations.get(y.id),ht=T.context.program.get(),ft=T.useProgram(Re,xt),Pt=Je||ft.program!==ht,Ft=ee.constantOr(null);if(Ft&&nt.imageAtlas){const pi=nt.imageAtlas,ei=pi.patternPositions[Ft.to.toString()],Ui=pi.patternPositions[Ft.from.toString()];ei&&Ui&&xt.setConstantPatternPositions(ei,Ui)}const wt=re?Zs(T,nt,y,ve):J?Nn(T,nt,y,J,ve):ue?wu(T,nt,y,Ye.lineClipsArray.length):Fl(T,nt,y);if(re)be.activeTexture.set(De.TEXTURE0),nt.imageAtlasTexture.bind(De.LINEAR,De.CLAMP_TO_EDGE),xt.updatePaintBuffers(ve);else if(J&&(Pt||T.lineAtlas.dirty))be.activeTexture.set(De.TEXTURE0),T.lineAtlas.bind(be);else if(ue){const pi=Ye.gradients[y.id];let ei=pi.texture;if(y.gradientVersion!==pi.version){let Ui=256;if(y.stepInterpolant){const c=o.getSource().maxzoom,m=Xe.canonical.z===c?Math.ceil(1<<T.transform.maxZoom-Xe.canonical.z):1;Ui=h.clamp(h.nextPowerOfTwo(Ye.maxLineLength/h.EXTENT*1024*m),256,be.maxTextureSize)}pi.gradient=h.renderColorRamp({expression:y.gradientExpression(),evaluationKey:"lineProgress",resolution:Ui,image:pi.gradient||void 0,clips:Ye.lineClipsArray}),pi.texture?pi.texture.update(pi.gradient):pi.texture=new Ze(be,pi.gradient,De.RGBA),pi.version=y.gradientVersion,ei=pi.texture}be.activeTexture.set(De.TEXTURE0),ei.bind(y.stepInterpolant?De.NEAREST:De.LINEAR,De.CLAMP_TO_EDGE)}ft.draw(be,De.TRIANGLES,U,T.stencilModeForClipping(Xe),Z,An.disabled,wt,y.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,y.paint,T.transform.zoom,xt,Ye.layoutVertexBuffer2),Je=!1}},fill:function(T,o,y,S){const A=y.paint.get("fill-color"),M=y.paint.get("fill-opacity");if(M.constantOr(1)===0)return;const U=T.colorModeForRenderPass(),Z=y.paint.get("fill-pattern"),J=T.opaquePassEnabledForLayer()&&!Z.constantOr(1)&&A.constantOr(h.Color.transparent).a===1&&M.constantOr(0)===1?"opaque":"translucent";if(T.renderPass===J){const ee=T.depthModeForSublayer(1,T.renderPass==="opaque"?wr.ReadWrite:wr.ReadOnly);Jr(T,o,y,S,ee,U,!1)}if(T.renderPass==="translucent"&&y.paint.get("fill-antialias")){const ee=T.depthModeForSublayer(y.getPaintProperty("fill-outline-color")?2:0,wr.ReadOnly);Jr(T,o,y,S,ee,U,!0)}},"fill-extrusion":function(T,o,y,S){const A=y.paint.get("fill-extrusion-opacity");if(A!==0&&T.renderPass==="translucent"){const M=new wr(T.context.gl.LEQUAL,wr.ReadWrite,T.depthRangeFor3D);if(A!==1||y.paint.get("fill-extrusion-pattern").constantOr(1))os(T,o,y,S,M,Kr.disabled,Ji.disabled),os(T,o,y,S,M,T.stencilModeFor3D(),T.colorModeForRenderPass());else{const U=T.colorModeForRenderPass();os(T,o,y,S,M,Kr.disabled,U)}}},hillshade:function(T,o,y,S){if(T.renderPass!=="offscreen"&&T.renderPass!=="translucent")return;const A=T.context,M=T.depthModeForSublayer(0,wr.ReadOnly),U=T.colorModeForRenderPass(),[Z,J]=T.renderPass==="translucent"?T.stencilConfigForOverlap(S):[{},S];for(const ee of J){const re=o.getTile(ee);re.needsHillshadePrepare&&T.renderPass==="offscreen"?ko(T,re,y,M,Kr.disabled,U):T.renderPass==="translucent"&&zu(T,re,y,M,Z[ee.overscaledZ],U)}A.viewport.set([0,0,T.width,T.height])},raster:function(T,o,y,S){if(T.renderPass!=="translucent"||y.paint.get("raster-opacity")===0||!S.length)return;const A=T.context,M=A.gl,U=o.getSource(),Z=T.useProgram("raster"),J=T.colorModeForRenderPass(),[ee,re]=U instanceof Fi?[{},S]:T.stencilConfigForOverlap(S),ue=re[re.length-1].overscaledZ,ve=!T.options.moving;for(const Re of re){const be=T.depthModeForSublayer(Re.overscaledZ-ue,y.paint.get("raster-opacity")===1?wr.ReadWrite:wr.ReadOnly,M.LESS),De=o.getTile(Re),Je=T.transform.calculatePosMatrix(Re.toUnwrapped(),ve);De.registerFadeDuration(y.paint.get("raster-fade-duration"));const Xe=o.findLoadedParent(Re,0),nt=oc(De,Xe,o,y,T.transform);let Ye,xt;const ht=y.paint.get("raster-resampling")==="nearest"?M.NEAREST:M.LINEAR;A.activeTexture.set(M.TEXTURE0),De.texture.bind(ht,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),A.activeTexture.set(M.TEXTURE1),Xe?(Xe.texture.bind(ht,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),Ye=Math.pow(2,Xe.tileID.overscaledZ-De.tileID.overscaledZ),xt=[De.tileID.canonical.x*Ye%1,De.tileID.canonical.y*Ye%1]):De.texture.bind(ht,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST);const ft=tc(Je,xt||[0,0],Ye||1,nt,y);U instanceof Fi?Z.draw(A,M.TRIANGLES,be,Kr.disabled,J,An.disabled,ft,y.id,U.boundsBuffer,T.quadTriangleIndexBuffer,U.boundsSegments):Z.draw(A,M.TRIANGLES,be,ee[Re.overscaledZ],J,An.disabled,ft,y.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments)}},background:function(T,o,y){const S=y.paint.get("background-color"),A=y.paint.get("background-opacity");if(A===0)return;const M=T.context,U=M.gl,Z=T.transform,J=Z.tileSize,ee=y.paint.get("background-pattern");if(T.isPatternMissing(ee))return;const re=!ee&&S.a===1&&A===1&&T.opaquePassEnabledForLayer()?"opaque":"translucent";if(T.renderPass!==re)return;const ue=Kr.disabled,ve=T.depthModeForSublayer(0,re==="opaque"?wr.ReadWrite:wr.ReadOnly),Re=T.colorModeForRenderPass(),be=T.useProgram(ee?"backgroundPattern":"background"),De=Z.coveringTiles({tileSize:J});ee&&(M.activeTexture.set(U.TEXTURE0),T.imageManager.bind(T.context));const Je=y.getCrossfadeParameters();for(const Xe of De){const nt=T.transform.calculatePosMatrix(Xe.toUnwrapped()),Ye=ee?yl(nt,A,T,ee,{tileID:Xe,tileSize:J},Je):Bc(nt,A,S);be.draw(M,U.TRIANGLES,ve,ue,Re,An.disabled,Ye,y.id,T.tileExtentBuffer,T.quadTriangleIndexBuffer,T.tileExtentSegments)}},debug:function(T,o,y){for(let S=0;S<y.length;S++)sc(T,o,y[S])},custom:function(T,o,y){const S=T.context,A=y.implementation;if(T.renderPass==="offscreen"){const M=A.prerender;M&&(T.setCustomLayerDefaults(),S.setColorMode(T.colorModeForRenderPass()),M.call(A,S.gl,T.transform.customLayerMatrix()),S.setDirty(),T.setBaseState())}else if(T.renderPass==="translucent"){T.setCustomLayerDefaults(),S.setColorMode(T.colorModeForRenderPass()),S.setStencilMode(Kr.disabled);const M=A.renderingMode==="3d"?new wr(T.context.gl.LEQUAL,wr.ReadWrite,T.depthRangeFor3D):T.depthModeForSublayer(0,wr.ReadOnly);S.setDepthMode(M),A.render(S.gl,T.transform.customLayerMatrix()),S.setDirty(),T.setBaseState(),S.bindFramebuffer.set(null)}}};class la{constructor(o,y){this.context=new Zl(o),this.transform=y,this._tileTextures={},this.setup(),this.numSublayers=rt.maxUnderzooming+rt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ci,this.gpuTimers={}}resize(o,y,S){if(this.width=o*S,this.height=y*S,this.pixelRatio=S,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const A of this.style._order)this.style._layers[A].resize()}setup(){const o=this.context,y=new h.PosArray;y.emplaceBack(0,0),y.emplaceBack(h.EXTENT,0),y.emplaceBack(0,h.EXTENT),y.emplaceBack(h.EXTENT,h.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(y,Eo.members),this.tileExtentSegments=h.SegmentVector.simpleSegment(0,0,4,2);const S=new h.PosArray;S.emplaceBack(0,0),S.emplaceBack(h.EXTENT,0),S.emplaceBack(0,h.EXTENT),S.emplaceBack(h.EXTENT,h.EXTENT),this.debugBuffer=o.createVertexBuffer(S,Eo.members),this.debugSegments=h.SegmentVector.simpleSegment(0,0,4,5);const A=new h.RasterBoundsArray;A.emplaceBack(0,0,0,0),A.emplaceBack(h.EXTENT,0,h.EXTENT,0),A.emplaceBack(0,h.EXTENT,0,h.EXTENT),A.emplaceBack(h.EXTENT,h.EXTENT,h.EXTENT,h.EXTENT),this.rasterBoundsBuffer=o.createVertexBuffer(A,yi.members),this.rasterBoundsSegments=h.SegmentVector.simpleSegment(0,0,4,2);const M=new h.PosArray;M.emplaceBack(0,0),M.emplaceBack(1,0),M.emplaceBack(0,1),M.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(M,Eo.members),this.viewportSegments=h.SegmentVector.simpleSegment(0,0,4,2);const U=new h.LineStripIndexArray;U.emplaceBack(0),U.emplaceBack(1),U.emplaceBack(3),U.emplaceBack(2),U.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(U);const Z=new h.TriangleIndexArray;Z.emplaceBack(0,1,2),Z.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(Z),this.emptyTexture=new Ze(o,{width:1,height:1,data:new Uint8Array([0,0,0,0])},o.gl.RGBA);const J=this.context.gl;this.stencilClearMode=new Kr({func:J.ALWAYS,mask:0},0,255,J.ZERO,J.ZERO,J.ZERO)}clearStencil(){const o=this.context,y=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const S=h.create();h.ortho(S,0,this.width,this.height,0,0,1),h.scale(S,S,[y.drawingBufferWidth,y.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,y.TRIANGLES,wr.disabled,this.stencilClearMode,Ji.disabled,An.disabled,Zo(S),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,y){if(this.currentStencilSource===o.source||!o.isTileClipped()||!y||!y.length)return;this.currentStencilSource=o.source;const S=this.context,A=S.gl;this.nextStencilID+y.length>256&&this.clearStencil(),S.setColorMode(Ji.disabled),S.setDepthMode(wr.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const U of y){const Z=this._tileClippingMaskIDs[U.key]=this.nextStencilID++;M.draw(S,A.TRIANGLES,wr.disabled,new Kr({func:A.ALWAYS,mask:0},Z,255,A.KEEP,A.KEEP,A.REPLACE),Ji.disabled,An.disabled,Zo(U.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,y=this.context.gl;return new Kr({func:y.NOTEQUAL,mask:255},o,255,y.KEEP,y.KEEP,y.REPLACE)}stencilModeForClipping(o){const y=this.context.gl;return new Kr({func:y.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,y.KEEP,y.KEEP,y.REPLACE)}stencilConfigForOverlap(o){const y=this.context.gl,S=o.sort((U,Z)=>Z.overscaledZ-U.overscaledZ),A=S[S.length-1].overscaledZ,M=S[0].overscaledZ-A+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();const U={};for(let Z=0;Z<M;Z++)U[Z+A]=new Kr({func:y.GEQUAL,mask:255},Z+this.nextStencilID,255,y.KEEP,y.KEEP,y.REPLACE);return this.nextStencilID+=M,[U,S]}return[{[A]:Kr.disabled},S]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new Ji([o.CONSTANT_COLOR,o.ONE],new h.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ji.unblended:Ji.alphaBlended}depthModeForSublayer(o,y,S){if(!this.opaquePassEnabledForLayer())return wr.disabled;const A=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new wr(S||this.context.gl.LEQUAL,y,[A,A])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,y){this.style=o,this.options=y,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(h.exported.now()),this.imageManager.beginFrame();const S=this.style._order,A=this.style.sourceCaches;for(const J in A){const ee=A[J];ee.used&&ee.prepare(this.context)}const M={},U={},Z={};for(const J in A){const ee=A[J];M[J]=ee.getVisibleCoordinates(),U[J]=M[J].slice().reverse(),Z[J]=ee.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let J=0;J<S.length;J++)if(this.style._layers[S[J]].is3D()){this.opaquePassCutoff=J;break}this.renderPass="offscreen";for(const J of S){const ee=this.style._layers[J];if(!ee.hasOffscreenPass()||ee.isHidden(this.transform.zoom))continue;const re=U[ee.source];(ee.type==="custom"||re.length)&&this.renderLayer(this,A[ee.source],ee,re)}for(this.context.bindFramebuffer.set(null),this.context.clear({color:y.showOverdrawInspector?h.Color.black:h.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=y.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){const J=this.style._layers[S[this.currentLayer]],ee=A[J.source],re=M[J.source];this._renderTileClippingMasks(J,re),this.renderLayer(this,ee,J,re)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){const J=this.style._layers[S[this.currentLayer]],ee=A[J.source],re=(J.type==="symbol"?Z:U)[J.source];this._renderTileClippingMasks(J,M[J.source]),this.renderLayer(this,ee,J,re)}if(this.options.showTileBoundaries){let J,ee;Object.values(this.style._layers).forEach(re=>{re.source&&!re.isHidden(this.transform.zoom)&&(re.source!==(ee&&ee.id)&&(ee=this.style.sourceCaches[re.source]),(!J||J.getSource().maxzoom<ee.getSource().maxzoom)&&(J=ee))}),J&&Ga.debug(this,J,J.getVisibleCoordinates())}this.options.showPadding&&function(J){const ee=J.transform.padding;Kl(J,J.transform.height-(ee.top||0),3,Uc),Kl(J,ee.bottom||0,3,ac),zs(J,ee.left||0,3,as),zs(J,J.transform.width-(ee.right||0),3,ss);const re=J.transform.centerPoint;(function(ue,ve,Re,be){ls(ue,ve-1,Re-10,2,20,be),ls(ue,ve-10,Re-1,20,2,be)})(J,re.x,J.transform.height-re.y,Ks)}(this),this.context.setDefault()}renderLayer(o,y,S,A){S.isHidden(this.transform.zoom)||(S.type==="background"||S.type==="custom"||A.length)&&(this.id=S.id,this.gpuTimingStart(S),Ga[S.type](o,y,S,A,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const y=this.context.extTimerQuery;let S=this.gpuTimers[o.id];S||(S=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:y.createQueryEXT()}),S.calls++,y.beginQueryEXT(y.TIME_ELAPSED_EXT,S.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}queryGpuTimers(o){const y={};for(const S in o){const A=o[S],M=this.context.extTimerQuery,U=M.getQueryObjectEXT(A.query,M.QUERY_RESULT_EXT)/1e6;M.deleteQueryEXT(A.query),y[S]=U}return y}translatePosMatrix(o,y,S,A,M){if(!S[0]&&!S[1])return o;const U=M?A==="map"?this.transform.angle:0:A==="viewport"?-this.transform.angle:0;if(U){const ee=Math.sin(U),re=Math.cos(U);S=[S[0]*re-S[1]*ee,S[0]*ee+S[1]*re]}const Z=[M?S[0]:Se(y,S[0],this.transform.zoom),M?S[1]:Se(y,S[1],this.transform.zoom),0],J=new Float32Array(16);return h.translate(J,o,Z),J}saveTileTexture(o){const y=this._tileTextures[o.size[0]];y?y.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const y=this._tileTextures[o];return y&&y.length>0?y.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const y=this.imageManager.getPattern(o.from.toString()),S=this.imageManager.getPattern(o.to.toString());return!y||!S}useProgram(o,y){this.cache=this.cache||{};const S=`${o}${y?y.cacheKey:""}${this._showOverdrawInspector?"/overdraw":""}`;return this.cache[S]||(this.cache[S]=new Co(this.context,o,Ol[o],y,Ho[o],this._showOverdrawInspector)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ze(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Jl{constructor(o,y){this.points=o,this.planes=y}static fromInvProjectionMatrix(o,y,S){const A=Math.pow(2,S),M=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(Z=>h.transformMat4([],Z,o)).map(Z=>h.scale$1([],Z,1/Z[3]/y*A)),U=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(Z=>{const J=function(ve,Re){var be=Re[0],De=Re[1],Je=Re[2],Xe=be*be+De*De+Je*Je;return Xe>0&&(Xe=1/Math.sqrt(Xe)),ve[0]=Re[0]*Xe,ve[1]=Re[1]*Xe,ve[2]=Re[2]*Xe,ve}([],function(ve,Re,be){var De=Re[0],Je=Re[1],Xe=Re[2],nt=be[0],Ye=be[1],xt=be[2];return ve[0]=Je*xt-Xe*Ye,ve[1]=Xe*nt-De*xt,ve[2]=De*Ye-Je*nt,ve}([],yt([],M[Z[0]],M[Z[1]]),yt([],M[Z[2]],M[Z[1]]))),ee=-((re=J)[0]*(ue=M[Z[1]])[0]+re[1]*ue[1]+re[2]*ue[2]);var re,ue;return J.concat(ee)});return new Jl(M,U)}}class $l{constructor(o,y){this.min=o,this.max=y,this.center=function(S,A,M){return S[0]=.5*A[0],S[1]=.5*A[1],S[2]=.5*A[2],S}([],function(S,A,M){return S[0]=A[0]+M[0],S[1]=A[1]+M[1],S[2]=A[2]+M[2],S}([],this.min,this.max))}quadrant(o){const y=[o%2==0,o<2],S=We(this.min),A=We(this.max);for(let M=0;M<y.length;M++)S[M]=y[M]?this.min[M]:this.center[M],A[M]=y[M]?this.center[M]:this.max[M];return A[2]=this.max[2],new $l(S,A)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const y=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]];let S=!0;for(let A=0;A<o.planes.length;A++){const M=o.planes[A];let U=0;for(let Z=0;Z<y.length;Z++)h.dot(M,y[Z])>=0&&U++;if(U===0)return 0;U!==y.length&&(S=!1)}if(S)return 2;for(let A=0;A<3;A++){let M=Number.MAX_VALUE,U=-Number.MAX_VALUE;for(let Z=0;Z<o.points.length;Z++){const J=o.points[Z][A]-this.min[A];M=Math.min(M,J),U=Math.max(U,J)}if(U<0||M>this.max[A]-this.min[A])return 0}return 1}}class Js{constructor(o=0,y=0,S=0,A=0){if(isNaN(o)||o<0||isNaN(y)||y<0||isNaN(S)||S<0||isNaN(A)||A<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=y,this.left=S,this.right=A}interpolate(o,y,S){return y.top!=null&&o.top!=null&&(this.top=h.number(o.top,y.top,S)),y.bottom!=null&&o.bottom!=null&&(this.bottom=h.number(o.bottom,y.bottom,S)),y.left!=null&&o.left!=null&&(this.left=h.number(o.left,y.left,S)),y.right!=null&&o.right!=null&&(this.right=h.number(o.right,y.right,S)),this}getCenter(o,y){const S=h.clamp((this.left+o-this.right)/2,0,o),A=h.clamp((this.top+y-this.bottom)/2,0,y);return new h.pointGeometry(S,A)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Js(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Aa{constructor(o,y,S,A,M){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=M===void 0||!!M,this._minZoom=o||0,this._maxZoom=y||22,this._minPitch=S==null?0:S,this._maxPitch=A==null?60:A,this.setMaxBounds(),this.width=0,this.height=0,this._center=new h.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Js,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const o=new Aa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.tileSize=this.tileSize,o.latRange=this.latRange,o.width=this.width,o.height=this.height,o._center=this._center,o.zoom=this.zoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._calcMatrices(),o}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const y=-h.wrap(o,-180,180)*Math.PI/180;this.angle!==y&&(this._unmodified=!1,this.angle=y,this._calcMatrices(),this.rotationMatrix=function(){var S=new h.ARRAY_TYPE(4);return h.ARRAY_TYPE!=Float32Array&&(S[1]=0,S[2]=0),S[0]=1,S[3]=1,S}(),function(S,A,M){var U=A[0],Z=A[1],J=A[2],ee=A[3],re=Math.sin(M),ue=Math.cos(M);S[0]=U*ue+J*re,S[1]=Z*ue+ee*re,S[2]=U*-re+J*ue,S[3]=Z*-re+ee*ue}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const y=h.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==y&&(this._unmodified=!1,this._pitch=y,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const y=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==y&&(this._unmodified=!1,this._zoom=y,this.scale=this.zoomScale(y),this.tileZoom=Math.floor(y),this.zoomFraction=y-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,y,S){this._unmodified=!1,this._edgeInsets.interpolate(o,y,S),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const y=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,y)}getVisibleUnwrappedCoordinates(o){const y=[new h.UnwrappedTileID(0,o)];if(this._renderWorldCopies){const S=this.pointCoordinate(new h.pointGeometry(0,0)),A=this.pointCoordinate(new h.pointGeometry(this.width,0)),M=this.pointCoordinate(new h.pointGeometry(this.width,this.height)),U=this.pointCoordinate(new h.pointGeometry(0,this.height)),Z=Math.floor(Math.min(S.x,A.x,M.x,U.x)),J=Math.floor(Math.max(S.x,A.x,M.x,U.x)),ee=1;for(let re=Z-ee;re<=J+ee;re++)re!==0&&y.push(new h.UnwrappedTileID(re,o))}return y}coveringTiles(o){let y=this.coveringZoomLevel(o);const S=y;if(o.minzoom!==void 0&&y<o.minzoom)return[];o.maxzoom!==void 0&&y>o.maxzoom&&(y=o.maxzoom);const A=h.MercatorCoordinate.fromLngLat(this.center),M=Math.pow(2,y),U=[M*A.x,M*A.y,0],Z=Jl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,y);let J=o.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(J=y);const ee=be=>({aabb:new $l([be*M,0,0],[(be+1)*M,M,0]),zoom:0,x:0,y:0,wrap:be,fullyVisible:!1}),re=[],ue=[],ve=y,Re=o.reparseOverscaled?S:y;if(this._renderWorldCopies)for(let be=1;be<=3;be++)re.push(ee(-be)),re.push(ee(be));for(re.push(ee(0));re.length>0;){const be=re.pop(),De=be.x,Je=be.y;let Xe=be.fullyVisible;if(!Xe){const ft=be.aabb.intersects(Z);if(ft===0)continue;Xe=ft===2}const nt=be.aabb.distanceX(U),Ye=be.aabb.distanceY(U),xt=Math.max(Math.abs(nt),Math.abs(Ye)),ht=3+(1<<ve-be.zoom)-2;if(be.zoom===ve||xt>ht&&be.zoom>=J)ue.push({tileID:new h.OverscaledTileID(be.zoom===ve?Re:be.zoom,be.wrap,be.zoom,De,Je),distanceSq:Ne([U[0]-.5-De,U[1]-.5-Je])});else for(let ft=0;ft<4;ft++){const Pt=(De<<1)+ft%2,Ft=(Je<<1)+(ft>>1);re.push({aabb:be.aabb.quadrant(ft),zoom:be.zoom+1,x:Pt,y:Ft,wrap:be.wrap,fullyVisible:Xe})}}return ue.sort((be,De)=>be.distanceSq-De.distanceSq).map(be=>be.tileID)}resize(o,y){this.width=o,this.height=y,this.pixelsToGLUnits=[2/o,-2/y],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const y=h.clamp(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new h.pointGeometry(h.mercatorXfromLng(o.lng)*this.worldSize,h.mercatorYfromLat(y)*this.worldSize)}unproject(o){return new h.MercatorCoordinate(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(o,y){const S=this.pointCoordinate(y),A=this.pointCoordinate(this.centerPoint),M=this.locationCoordinate(o),U=new h.MercatorCoordinate(M.x-(S.x-A.x),M.y-(S.y-A.y));this.center=this.coordinateLocation(U),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o){return this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}locationCoordinate(o){return h.MercatorCoordinate.fromLngLat(o)}coordinateLocation(o){return o.toLngLat()}pointCoordinate(o){const y=[o.x,o.y,0,1],S=[o.x,o.y,1,1];h.transformMat4(y,y,this.pixelMatrixInverse),h.transformMat4(S,S,this.pixelMatrixInverse);const A=y[3],M=S[3],U=y[1]/A,Z=S[1]/M,J=y[2]/A,ee=S[2]/M,re=J===ee?0:(0-J)/(ee-J);return new h.MercatorCoordinate(h.number(y[0]/A,S[0]/M,re)/this.worldSize,h.number(U,Z,re)/this.worldSize)}coordinatePoint(o){const y=[o.x*this.worldSize,o.y*this.worldSize,0,1];return h.transformMat4(y,y,this.pixelMatrix),new h.pointGeometry(y[0]/y[3],y[1]/y[3])}getBounds(){return new h.LngLatBounds().extend(this.pointLocation(new h.pointGeometry(0,0))).extend(this.pointLocation(new h.pointGeometry(this.width,0))).extend(this.pointLocation(new h.pointGeometry(this.width,this.height))).extend(this.pointLocation(new h.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new h.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(o,y=!1){const S=o.key,A=y?this._alignedPosMatrixCache:this._posMatrixCache;if(A[S])return A[S];const M=o.canonical,U=this.worldSize/this.zoomScale(M.z),Z=M.x+Math.pow(2,M.z)*o.wrap,J=h.identity(new Float64Array(16));return h.translate(J,J,[Z*U,M.y*U,0]),h.scale(J,J,[U/h.EXTENT,U/h.EXTENT,1]),h.multiply(J,y?this.alignedProjMatrix:this.projMatrix,J),A[S]=new Float32Array(J),A[S]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,y,S,A,M=-90,U=90,Z=-180,J=180;const ee=this.size,re=this._unmodified;if(this.latRange){const Re=this.latRange;M=h.mercatorYfromLat(Re[1])*this.worldSize,U=h.mercatorYfromLat(Re[0])*this.worldSize,o=U-M<ee.y?ee.y/(U-M):0}if(this.lngRange){const Re=this.lngRange;Z=h.mercatorXfromLng(Re[0])*this.worldSize,J=h.mercatorXfromLng(Re[1])*this.worldSize,y=J-Z<ee.x?ee.x/(J-Z):0}const ue=this.point,ve=Math.max(y||0,o||0);if(ve)return this.center=this.unproject(new h.pointGeometry(y?(J+Z)/2:ue.x,o?(U+M)/2:ue.y)),this.zoom+=this.scaleZoom(ve),this._unmodified=re,void(this._constraining=!1);if(this.latRange){const Re=ue.y,be=ee.y/2;Re-be<M&&(A=M+be),Re+be>U&&(A=U-be)}if(this.lngRange){const Re=ue.x,be=ee.x/2;Re-be<Z&&(S=Z+be),Re+be>J&&(S=J-be)}S===void 0&&A===void 0||(this.center=this.unproject(new h.pointGeometry(S!==void 0?S:ue.x,A!==void 0?A:ue.y))),this._unmodified=re,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const y=Math.PI/2+this._pitch,S=this._fov*(.5+o.y/this.height),A=Math.sin(S)*this.cameraToCenterDistance/Math.sin(h.clamp(Math.PI-y-S,.01,Math.PI-.01)),M=this.point,U=M.x,Z=M.y,J=1.01*(Math.cos(Math.PI/2-this._pitch)*A+this.cameraToCenterDistance),ee=this.height/50;let re=new Float64Array(16);h.perspective(re,this._fov,this.width/this.height,ee,J),re[8]=2*-o.x/this.width,re[9]=2*o.y/this.height,h.scale(re,re,[1,-1,1]),h.translate(re,re,[0,0,-this.cameraToCenterDistance]),h.rotateX(re,re,this._pitch),h.rotateZ(re,re,this.angle),h.translate(re,re,[-U,-Z,0]),this.mercatorMatrix=h.scale([],re,[this.worldSize,this.worldSize,this.worldSize]),h.scale(re,re,[1,1,h.mercatorZfromAltitude(1,this.center.lat)*this.worldSize]),this.projMatrix=re,this.invProjMatrix=h.invert([],this.projMatrix);const ue=this.width%2/2,ve=this.height%2/2,Re=Math.cos(this.angle),be=Math.sin(this.angle),De=U-Math.round(U)+Re*ue+be*ve,Je=Z-Math.round(Z)+Re*ve+be*ue,Xe=new Float64Array(re);if(h.translate(Xe,Xe,[De>.5?De-1:De,Je>.5?Je-1:Je,0]),this.alignedProjMatrix=Xe,re=h.create(),h.scale(re,re,[this.width/2,-this.height/2,1]),h.translate(re,re,[1,-1,0]),this.labelPlaneMatrix=re,re=h.create(),h.scale(re,re,[1,-1,1]),h.translate(re,re,[-1,-1,0]),h.scale(re,re,[2/this.width,2/this.height,1]),this.glCoordMatrix=re,this.pixelMatrix=h.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),re=h.invert(new Float64Array(16),this.pixelMatrix),!re)throw new Error("failed to invert matrix");this.pixelMatrixInverse=re,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new h.pointGeometry(0,0)),y=[o.x*this.worldSize,o.y*this.worldSize,0,1];return h.transformMat4(y,y,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.pointGeometry(0,o))}getCameraQueryGeometry(o){const y=this.getCameraPoint();if(o.length===1)return[o[0],y];{let S=y.x,A=y.y,M=y.x,U=y.y;for(const Z of o)S=Math.min(S,Z.x),A=Math.min(A,Z.y),M=Math.max(M,Z.x),U=Math.max(U,Z.y);return[new h.pointGeometry(S,A),new h.pointGeometry(M,A),new h.pointGeometry(M,U),new h.pointGeometry(S,U),new h.pointGeometry(S,A)]}}}class vl{constructor(o){this._hashName=o&&encodeURIComponent(o),h.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(y,S){let A=!1,M=null;const U=()=>{M=null,A&&(y(),M=setTimeout(U,300),A=!1)};return()=>(A=!0,M||U(),M)}(this._updateHashUnthrottled.bind(this))}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const y=this._map.getCenter(),S=Math.round(100*this._map.getZoom())/100,A=Math.ceil((S*Math.LN2+Math.log(512/360/.5))/Math.LN10),M=Math.pow(10,A),U=Math.round(y.lng*M)/M,Z=Math.round(y.lat*M)/M,J=this._map.getBearing(),ee=this._map.getPitch();let re="";if(re+=o?`/${U}/${Z}/${S}`:`${S}/${Z}/${U}`,(J||ee)&&(re+="/"+Math.round(10*J)/10),ee&&(re+=`/${Math.round(ee)}`),this._hashName){const ue=this._hashName;let ve=!1;const Re=window.location.hash.slice(1).split("&").map(be=>{const De=be.split("=")[0];return De===ue?(ve=!0,`${De}=${re}`):be}).filter(be=>be);return ve||Re.push(`${ue}=${re}`),`#${Re.join("&")}`}return`#${re}`}_getCurrentHash(){const o=window.location.hash.replace("#","");if(this._hashName){let y;return o.split("&").map(S=>S.split("=")).forEach(S=>{S[0]===this._hashName&&(y=S)}),(y&&y[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._getCurrentHash();if(o.length>=3&&!o.some(y=>isNaN(y))){const y=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:y,pitch:+(o[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,o)}catch{}}}const Ps={linearity:.3,easing:h.bezier(0,0,.3,1)},Pu=h.extend({deceleration:2500,maxSpeed:1400},Ps),Yl=h.extend({deceleration:20,maxSpeed:1400},Ps),Nc=h.extend({deceleration:1e3,maxSpeed:360},Ps),us=h.extend({deceleration:1e3,maxSpeed:90},Ps);class Mu{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:h.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,y=h.exported.now();for(;o.length>0&&y-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const y={zoom:0,bearing:0,pitch:0,pan:new h.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:M}of this._inertiaBuffer)y.zoom+=M.zoomDelta||0,y.bearing+=M.bearingDelta||0,y.pitch+=M.pitchDelta||0,M.panDelta&&y.pan._add(M.panDelta),M.around&&(y.around=M.around),M.pinchAround&&(y.pinchAround=M.pinchAround);const S=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,A={};if(y.pan.mag()){const M=bl(y.pan.mag(),S,h.extend({},Pu,o||{}));A.offset=y.pan.mult(M.amount/y.pan.mag()),A.center=this._map.transform.center,xl(A,M)}if(y.zoom){const M=bl(y.zoom,S,Yl);A.zoom=this._map.transform.zoom+M.amount,xl(A,M)}if(y.bearing){const M=bl(y.bearing,S,Nc);A.bearing=this._map.transform.bearing+h.clamp(M.amount,-179,179),xl(A,M)}if(y.pitch){const M=bl(y.pitch,S,us);A.pitch=this._map.transform.pitch+M.amount,xl(A,M)}if(A.zoom||A.bearing){const M=y.pinchAround===void 0?y.around:y.pinchAround;A.around=M?this._map.unproject(M):this._map.getCenter()}return this.clear(),h.extend(A,{noMoveStart:!0})}}function xl(T,o){(!T.duration||T.duration<o.duration)&&(T.duration=o.duration,T.easing=o.easing)}function bl(T,o,y){const{maxSpeed:S,linearity:A,deceleration:M}=y,U=h.clamp(T*A/(o/1e3),-S,S),Z=Math.abs(U)/(M*A);return{easing:y.easing,duration:1e3*Z,amount:U*(Z/2)}}class zo extends h.Event{constructor(o,y,S,A={}){const M=H.mousePos(y.getCanvasContainer(),S),U=y.unproject(M);super(o,h.extend({point:M,lngLat:U,originalEvent:S},A)),this._defaultPrevented=!1,this.target=y}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Po extends h.Event{constructor(o,y,S){const A=o==="touchend"?S.changedTouches:S.touches,M=H.touchPos(y.getCanvasContainer(),A),U=M.map(J=>y.unproject(J)),Z=M.reduce((J,ee,re,ue)=>J.add(ee.div(ue.length)),new h.pointGeometry(0,0));super(o,{points:M,point:Z,lngLats:U,lngLat:y.unproject(Z),originalEvent:S}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class lc extends h.Event{constructor(o,y,S){super(o,{originalEvent:S}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class cs{constructor(o,y){this._map=o,this._clickTolerance=y.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new lc(o.type,this._map,o))}mousedown(o,y){return this._mousedownPos=y,this._firePreventable(new zo(o.type,this._map,o))}mouseup(o){this._map.fire(new zo(o.type,this._map,o))}click(o,y){this._mousedownPos&&this._mousedownPos.dist(y)>=this._clickTolerance||this._map.fire(new zo(o.type,this._map,o))}dblclick(o){return this._firePreventable(new zo(o.type,this._map,o))}mouseover(o){this._map.fire(new zo(o.type,this._map,o))}mouseout(o){this._map.fire(new zo(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Po(o.type,this._map,o))}touchmove(o){this._map.fire(new Po(o.type,this._map,o))}touchend(o){this._map.fire(new Po(o.type,this._map,o))}touchcancel(o){this._map.fire(new Po(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wl{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(o){this._map.fire(new zo(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new zo(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class $s{constructor(o,y){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=y.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,y){this.isEnabled()&&o.shiftKey&&o.button===0&&(H.disableDrag(),this._startPos=this._lastPos=y,this._active=!0)}mousemoveWindow(o,y){if(!this._active)return;const S=y;if(this._lastPos.equals(S)||!this._box&&S.dist(this._startPos)<this._clickTolerance)return;const A=this._startPos;this._lastPos=S,this._box||(this._box=H.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const M=Math.min(A.x,S.x),U=Math.max(A.x,S.x),Z=Math.min(A.y,S.y),J=Math.max(A.y,S.y);H.setTransform(this._box,`translate(${M}px,${Z}px)`),this._box.style.width=U-M+"px",this._box.style.height=J-Z+"px"}mouseupWindow(o,y){if(!this._active||o.button!==0)return;const S=this._startPos,A=y;if(this.reset(),H.suppressClick(),S.x!==A.x||S.y!==A.y)return this._map.fire(new h.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:M=>M.fitScreenCoordinates(S,A,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(H.remove(this._box),this._box=null),H.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,y){return this._map.fire(new h.Event(o,{originalEvent:y}))}}function ua(T,o){const y={};for(let S=0;S<T.length;S++)y[T[S].identifier]=o[S];return y}class sn{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,y,S){(this.centroid||S.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),S.length===this.numTouches&&(this.centroid=function(A){const M=new h.pointGeometry(0,0);for(const U of A)M._add(U);return M.div(A.length)}(y),this.touches=ua(S,y)))}touchmove(o,y,S){if(this.aborted||!this.centroid)return;const A=ua(S,y);for(const M in this.touches){const U=this.touches[M],Z=A[M];(!Z||Z.dist(U)>30)&&(this.aborted=!0)}}touchend(o,y,S){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),S.length===0){const A=!this.aborted&&this.centroid;if(this.reset(),A)return A}}}class El{constructor(o){this.singleTap=new sn(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,y,S){this.singleTap.touchstart(o,y,S)}touchmove(o,y,S){this.singleTap.touchmove(o,y,S)}touchend(o,y,S){const A=this.singleTap.touchend(o,y,S);if(A){const M=o.timeStamp-this.lastTime<500,U=!this.lastTap||this.lastTap.dist(A)<30;if(M&&U||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=A,this.count===this.numTaps)return this.reset(),A}}}class Ys{constructor(){this._zoomIn=new El({numTouches:1,numTaps:2}),this._zoomOut=new El({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,y,S){this._zoomIn.touchstart(o,y,S),this._zoomOut.touchstart(o,y,S)}touchmove(o,y,S){this._zoomIn.touchmove(o,y,S),this._zoomOut.touchmove(o,y,S)}touchend(o,y,S){const A=this._zoomIn.touchend(o,y,S),M=this._zoomOut.touchend(o,y,S);return A?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:U=>U.easeTo({duration:300,zoom:U.getZoom()+1,around:U.unproject(A)},{originalEvent:o})}):M?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:U=>U.easeTo({duration:300,zoom:U.getZoom()-1,around:U.unproject(M)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const hs={0:1,2:2};class Qi{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(o,y){return!1}_move(o,y){return{}}mousedown(o,y){if(this._lastPoint)return;const S=H.mouseButton(o);this._correctButton(o,S)&&(this._lastPoint=y,this._eventButton=S)}mousemoveWindow(o,y){const S=this._lastPoint;if(S){if(o.preventDefault(),function(A,M){const U=hs[M];return A.buttons===void 0||(A.buttons&U)!==U}(o,this._eventButton))this.reset();else if(this._moved||!(y.dist(S)<this._clickTolerance))return this._moved=!0,this._lastPoint=y,this._move(S,y)}}mouseupWindow(o){this._lastPoint&&H.mouseButton(o)===this._eventButton&&(this._moved&&H.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Mr extends Qi{mousedown(o,y){super.mousedown(o,y),this._lastPoint&&(this._active=!0)}_correctButton(o,y){return y===0&&!o.ctrlKey}_move(o,y){return{around:y,panDelta:y.sub(o)}}}class Jt extends Qi{_correctButton(o,y){return y===0&&o.ctrlKey||y===2}_move(o,y){const S=.8*(y.x-o.x);if(S)return this._active=!0,{bearingDelta:S}}contextmenu(o){o.preventDefault()}}class Qs extends Qi{_correctButton(o,y){return y===0&&o.ctrlKey||y===2}_move(o,y){const S=-.5*(y.y-o.y);if(S)return this._active=!0,{pitchDelta:S}}contextmenu(o){o.preventDefault()}}class Za{constructor(o){this._minTouches=1,this._clickTolerance=o.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new h.pointGeometry(0,0)}touchstart(o,y,S){return this._calculateTransform(o,y,S)}touchmove(o,y,S){if(this._active&&!(S.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,y,S)}touchend(o,y,S){this._calculateTransform(o,y,S),this._active&&S.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,y,S){S.length>0&&(this._active=!0);const A=ua(S,y),M=new h.pointGeometry(0,0),U=new h.pointGeometry(0,0);let Z=0;for(const ee in A){const re=A[ee],ue=this._touches[ee];ue&&(M._add(re),U._add(re.sub(ue)),Z++,A[ee]=re)}if(this._touches=A,Z<this._minTouches||!U.mag())return;const J=U.div(Z);return this._sum._add(J),this._sum.mag()<this._clickTolerance?void 0:{around:M.div(Z),panDelta:J}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ca{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(o){}_move(o,y,S){return{}}touchstart(o,y,S){this._firstTwoTouches||S.length<2||(this._firstTwoTouches=[S[0].identifier,S[1].identifier],this._start([y[0],y[1]]))}touchmove(o,y,S){if(!this._firstTwoTouches)return;o.preventDefault();const[A,M]=this._firstTwoTouches,U=Ql(S,y,A),Z=Ql(S,y,M);if(!U||!Z)return;const J=this._aroundCenter?null:U.add(Z).div(2);return this._move([U,Z],J,o)}touchend(o,y,S){if(!this._firstTwoTouches)return;const[A,M]=this._firstTwoTouches,U=Ql(S,y,A),Z=Ql(S,y,M);U&&Z||(this._active&&H.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ql(T,o,y){for(let S=0;S<T.length;S++)if(T[S].identifier===y)return o[S]}function ri(T,o){return Math.log(T/o)/Math.LN2}class el extends Ca{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,y){const S=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(ri(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ri(this._distance,S),pinchAround:y}}}function Il(T,o){return 180*T.angleWith(o)/Math.PI}class ps extends Ca{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,y){const S=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Il(this._vector,S),pinchAround:y}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const y=25/(Math.PI*this._minDiameter)*360,S=Il(o,this._startVector);return Math.abs(S)<y}}function pn(T){return Math.abs(T.y)>Math.abs(T.x)}class Sl extends Ca{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(o){this._lastPoints=o,pn(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,y,S){const A=o[0].sub(this._lastPoints[0]),M=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(A,M,S.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(A.y+M.y)/2*-.5}}gestureBeginsVertically(o,y,S){if(this._valid!==void 0)return this._valid;const A=o.mag()>=2,M=y.mag()>=2;if(!A&&!M)return;if(!A||!M)return this._firstMove===void 0&&(this._firstMove=S),S-this._firstMove<100&&void 0;const U=o.y>0==y.y>0;return pn(o)&&pn(y)&&U}}const uc={panStep:100,bearingStep:15,pitchStep:10};class zn{constructor(){const o=uc;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let y=0,S=0,A=0,M=0,U=0;switch(o.keyCode){case 61:case 107:case 171:case 187:y=1;break;case 189:case 109:case 173:y=-1;break;case 37:o.shiftKey?S=-1:(o.preventDefault(),M=-1);break;case 39:o.shiftKey?S=1:(o.preventDefault(),M=1);break;case 38:o.shiftKey?A=1:(o.preventDefault(),U=-1);break;case 40:o.shiftKey?A=-1:(o.preventDefault(),U=1);break;default:return}return this._rotationDisabled&&(S=0,A=0),{cameraAnimation:Z=>{const J=Z.getZoom();Z.easeTo({duration:300,easeId:"keyboardHandler",easing:oi,zoom:y?Math.round(J)+y*(o.shiftKey?2:1):J,bearing:Z.getBearing()+S*this._bearingStep,pitch:Z.getPitch()+A*this._pitchStep,offset:[-M*this._panStep,-U*this._panStep],center:Z.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function oi(T){return T*(2-T)}const Io=4.000244140625;class Tl{constructor(o,y){this._map=o,this._el=o.getCanvasContainer(),this._handler=y,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,h.bindAll(["_onTimeout"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;let y=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const S=h.exported.now(),A=S-(this._lastWheelEventTime||0);this._lastWheelEventTime=S,y!==0&&y%Io==0?this._type="wheel":y!==0&&Math.abs(y)<4?this._type="trackpad":A>400?(this._type=null,this._lastValue=y,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(A*y)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,y+=this._lastValue)),o.shiftKey&&y&&(y/=4),this._type&&(this._lastWheelEvent=o,this._delta-=y,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const y=H.mousePos(this._el,o);this._around=h.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(y)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;if(this._delta!==0){const Z=this._type==="wheel"&&Math.abs(this._delta)>Io?this._wheelZoomRate:this._defaultZoomRate;let J=2/(1+Math.exp(-Math.abs(this._delta*Z)));this._delta<0&&J!==0&&(J=1/J);const ee=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(ee*J))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,S=this._startZoom,A=this._easing;let M,U=!1;if(this._type==="wheel"&&S&&A){const Z=Math.min((h.exported.now()-this._lastWheelEventTime)/200,1),J=A(Z);M=h.number(S,y,J),Z<1?this._frameId||(this._frameId=!0):U=!0}else M=y,U=!0;return this._active=!0,U&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!U,zoomDelta:M-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let y=h.ease;if(this._prevEase){const S=this._prevEase,A=(h.exported.now()-S.start)/S.duration,M=S.easing(A+.01)-S.easing(A),U=.27/Math.sqrt(M*M+1e-4)*.01,Z=Math.sqrt(.0729-U*U);y=h.bezier(U,Z,.25,1)}return this._prevEase={start:h.exported.now(),duration:o,easing:y},y}reset(){this._active=!1}}class Ms{constructor(o,y){this._clickZoom=o,this._tapZoom=y}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ca{constructor(){this.reset()}reset(){this._active=!1}dblclick(o,y){return o.preventDefault(),{cameraAnimation:S=>{S.easeTo({duration:300,zoom:S.getZoom()+(o.shiftKey?-1:1),around:S.unproject(y)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ln{constructor(){this._tap=new El({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(o,y,S){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?S.length>0&&(this._swipePoint=y[0],this._swipeTouch=S[0].identifier):this._tap.touchstart(o,y,S))}touchmove(o,y,S){if(this._tapTime){if(this._swipePoint){if(S[0].identifier!==this._swipeTouch)return;const A=y[0],M=A.y-this._swipePoint.y;return this._swipePoint=A,o.preventDefault(),this._active=!0,{zoomDelta:M/128}}}else this._tap.touchmove(o,y,S)}touchend(o,y,S){this._tapTime?this._swipePoint&&S.length===0&&this.reset():this._tap.touchend(o,y,S)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ha{constructor(o,y,S){this._el=o,this._mousePan=y,this._touchPan=S}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qt{constructor(o,y,S){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=y,this._mousePitch=S}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class eu{constructor(o,y,S,A){this._el=o,this._touchZoom=y,this._touchRotate=S,this._tapDragZoom=A,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ds=T=>T.zoom||T.drag||T.pitch||T.rotate;class tu extends h.Event{}function Uo(T){return T.panDelta&&T.panDelta.mag()||T.zoomDelta||T.bearingDelta||T.pitchDelta}class dn{constructor(o,y){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Mu(o),this._bearingSnap=y.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(y),h.bindAll(["handleEvent","handleWindowEvent"],this);const S=this._el;this._listeners=[[S,"touchstart",{passive:!0}],[S,"touchmove",{passive:!1}],[S,"touchend",void 0],[S,"touchcancel",void 0],[S,"mousedown",void 0],[S,"mousemove",void 0],[S,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[S,"mouseover",void 0],[S,"mouseout",void 0],[S,"dblclick",void 0],[S,"click",void 0],[S,"keydown",{capture:!1}],[S,"keyup",void 0],[S,"wheel",{passive:!1}],[S,"contextmenu",void 0],[window,"blur",void 0]];for(const[A,M,U]of this._listeners)H.addEventListener(A,M,A===document?this.handleWindowEvent:this.handleEvent,U)}destroy(){for(const[o,y,S]of this._listeners)H.removeEventListener(o,y,o===document?this.handleWindowEvent:this.handleEvent,S)}_addDefaultHandlers(o){const y=this._map,S=y.getCanvasContainer();this._add("mapEvent",new cs(y,o));const A=y.boxZoom=new $s(y,o);this._add("boxZoom",A);const M=new Ys,U=new ca;y.doubleClickZoom=new Ms(U,M),this._add("tapZoom",M),this._add("clickZoom",U);const Z=new ln;this._add("tapDragZoom",Z);const J=y.touchPitch=new Sl;this._add("touchPitch",J);const ee=new Jt(o),re=new Qs(o);y.dragRotate=new qt(o,ee,re),this._add("mouseRotate",ee,["mousePitch"]),this._add("mousePitch",re,["mouseRotate"]);const ue=new Mr(o),ve=new Za(o);y.dragPan=new Ha(S,ue,ve),this._add("mousePan",ue),this._add("touchPan",ve,["touchZoom","touchRotate"]);const Re=new ps,be=new el;y.touchZoomRotate=new eu(S,be,Re,Z),this._add("touchRotate",Re,["touchPan","touchZoom"]),this._add("touchZoom",be,["touchPan","touchRotate"]);const De=y.scrollZoom=new Tl(y,this);this._add("scrollZoom",De,["mousePan"]);const Je=y.keyboard=new zn;this._add("keyboard",Je),this._add("blockableMapEvent",new wl(y));for(const Xe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[Xe]&&y[Xe].enable(o[Xe])}_add(o,y,S){this._handlers.push({handlerName:o,handler:y,allowed:S}),this._handlersById[o]=y}stop(o){if(!this._updatingCamera){for(const{handler:y}of this._handlers)y.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(ds(this._eventsInProgress))||this.isZooming()}_blockedByActive(o,y,S){for(const A in o)if(A!==S&&(!y||y.indexOf(A)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const y=[];for(const S of o)this._el.contains(S.target)&&y.push(S);return y}handleEvent(o,y){if(o.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=o.type==="renderFrame"?void 0:o,A={needsRenderFrame:!1},M={},U={},Z=o.touches,J=Z?this._getMapTouches(Z):void 0,ee=J?H.touchPos(this._el,J):H.mousePos(this._el,o);for(const{handlerName:ve,handler:Re,allowed:be}of this._handlers){if(!Re.isEnabled())continue;let De;this._blockedByActive(U,be,ve)?Re.reset():Re[y||o.type]&&(De=Re[y||o.type](o,ee,J),this.mergeHandlerResult(A,M,De,ve,S),De&&De.needsRenderFrame&&this._triggerRenderFrame()),(De||Re.isActive())&&(U[ve]=Re)}const re={};for(const ve in this._previousActiveHandlers)U[ve]||(re[ve]=S);this._previousActiveHandlers=U,(Object.keys(re).length||Uo(A))&&(this._changes.push([A,M,re]),this._triggerRenderFrame()),(Object.keys(U).length||Uo(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ue}=A;ue&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ue(this._map))}mergeHandlerResult(o,y,S,A,M){if(!S)return;h.extend(o,S);const U={handlerName:A,originalEvent:S.originalEvent||M};S.zoomDelta!==void 0&&(y.zoom=U),S.panDelta!==void 0&&(y.drag=U),S.pitchDelta!==void 0&&(y.pitch=U),S.bearingDelta!==void 0&&(y.rotate=U)}_applyChanges(){const o={},y={},S={};for(const[A,M,U]of this._changes)A.panDelta&&(o.panDelta=(o.panDelta||new h.pointGeometry(0,0))._add(A.panDelta)),A.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+A.zoomDelta),A.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+A.bearingDelta),A.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+A.pitchDelta),A.around!==void 0&&(o.around=A.around),A.pinchAround!==void 0&&(o.pinchAround=A.pinchAround),A.noInertia&&(o.noInertia=A.noInertia),h.extend(y,M),h.extend(S,U);this._updateMapTransform(o,y,S),this._changes=[]}_updateMapTransform(o,y,S){const A=this._map,M=A.transform;if(!Uo(o))return this._fireEvents(y,S,!0);let{panDelta:U,zoomDelta:Z,bearingDelta:J,pitchDelta:ee,around:re,pinchAround:ue}=o;ue!==void 0&&(re=ue),A._stop(!0),re=re||A.transform.centerPoint;const ve=M.pointLocation(U?re.sub(U):re);J&&(M.bearing+=J),ee&&(M.pitch+=ee),Z&&(M.zoom+=Z),M.setLocationAtPoint(ve,re),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(y,S,!0)}_fireEvents(o,y,S){const A=ds(this._eventsInProgress),M=ds(o),U={};for(const re in o){const{originalEvent:ue}=o[re];this._eventsInProgress[re]||(U[`${re}start`]=ue),this._eventsInProgress[re]=o[re]}!A&&M&&this._fireEvent("movestart",M.originalEvent);for(const re in U)this._fireEvent(re,U[re]);M&&this._fireEvent("move",M.originalEvent);for(const re in o){const{originalEvent:ue}=o[re];this._fireEvent(re,ue)}const Z={};let J;for(const re in this._eventsInProgress){const{handlerName:ue,originalEvent:ve}=this._eventsInProgress[re];this._handlersById[ue].isActive()||(delete this._eventsInProgress[re],J=y[ue]||ve,Z[`${re}end`]=J)}for(const re in Z)this._fireEvent(re,Z[re]);const ee=ds(this._eventsInProgress);if(S&&(A||M)&&!ee){this._updatingCamera=!0;const re=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ue=ve=>ve!==0&&-this._bearingSnap<ve&&ve<this._bearingSnap;re?(ue(re.bearing||this._map.getBearing())&&(re.bearing=0),this._map.easeTo(re,{originalEvent:J})):(this._map.fire(new h.Event("moveend",{originalEvent:J})),ue(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,y){this._map.fire(new h.Event(o,y?{originalEvent:y}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new tu("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const rn={extend:(T,...o)=>h.extend(T,...o),run(T){T()},logToElement(T,o=!1,y="log"){const S=window.document.getElementById(y);S&&(o&&(S.innerHTML=""),S.innerHTML+=`<br>${T}`)}};class tl extends h.Evented{constructor(o,y){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=y.bearingSnap,h.bindAll(["_renderFrameCallback"],this)}getCenter(){return new h.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,y){return this.jumpTo({center:o},y)}panBy(o,y,S){return o=h.pointGeometry.convert(o).mult(-1),this.panTo(this.transform.center,h.extend({offset:o},y),S)}panTo(o,y,S){return this.easeTo(h.extend({center:o},y),S)}getZoom(){return this.transform.zoom}setZoom(o,y){return this.jumpTo({zoom:o},y),this}zoomTo(o,y,S){return this.easeTo(h.extend({zoom:o},y),S)}zoomIn(o,y){return this.zoomTo(this.getZoom()+1,o,y),this}zoomOut(o,y){return this.zoomTo(this.getZoom()-1,o,y),this}getBearing(){return this.transform.bearing}setBearing(o,y){return this.jumpTo({bearing:o},y),this}getPadding(){return this.transform.padding}setPadding(o,y){return this.jumpTo({padding:o},y),this}rotateTo(o,y,S){return this.easeTo(h.extend({bearing:o},y),S)}resetNorth(o,y){return this.rotateTo(0,h.extend({duration:1e3},o),y),this}resetNorthPitch(o,y){return this.easeTo(h.extend({bearing:0,pitch:0,duration:1e3},o),y),this}snapToNorth(o,y){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,y):this}getPitch(){return this.transform.pitch}setPitch(o,y){return this.jumpTo({pitch:o},y),this}cameraForBounds(o,y){o=h.LngLatBounds.convert(o);const S=y&&y.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),S,y)}_cameraForBoxAndBearing(o,y,S,A){const M={top:0,bottom:0,right:0,left:0};if(typeof(A=h.extend({padding:M,offset:[0,0],maxZoom:this.transform.maxZoom},A)).padding=="number"){const ht=A.padding;A.padding={top:ht,bottom:ht,right:ht,left:ht}}A.padding=h.extend(M,A.padding);const U=this.transform,Z=U.padding,J=U.project(h.LngLat.convert(o)),ee=U.project(h.LngLat.convert(y)),re=J.rotate(-S*Math.PI/180),ue=ee.rotate(-S*Math.PI/180),ve=new h.pointGeometry(Math.max(re.x,ue.x),Math.max(re.y,ue.y)),Re=new h.pointGeometry(Math.min(re.x,ue.x),Math.min(re.y,ue.y)),be=ve.sub(Re),De=(U.width-(Z.left+Z.right+A.padding.left+A.padding.right))/be.x,Je=(U.height-(Z.top+Z.bottom+A.padding.top+A.padding.bottom))/be.y;if(Je<0||De<0)return void h.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Xe=Math.min(U.scaleZoom(U.scale*Math.min(De,Je)),A.maxZoom),nt=h.pointGeometry.convert(A.offset),Ye=new h.pointGeometry((A.padding.left-A.padding.right)/2,(A.padding.top-A.padding.bottom)/2).rotate(S*Math.PI/180),xt=nt.add(Ye).mult(U.scale/U.zoomScale(Xe));return{center:U.unproject(J.add(ee).div(2).sub(xt)),zoom:Xe,bearing:S}}fitBounds(o,y,S){return this._fitInternal(this.cameraForBounds(o,y),y,S)}fitScreenCoordinates(o,y,S,A,M){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(h.pointGeometry.convert(o)),this.transform.pointLocation(h.pointGeometry.convert(y)),S,A),A,M)}_fitInternal(o,y,S){return o?(delete(y=h.extend(o,y)).padding,y.linear?this.easeTo(y,S):this.flyTo(y,S)):this}jumpTo(o,y){this.stop();const S=this.transform;let A=!1,M=!1,U=!1;return"zoom"in o&&S.zoom!==+o.zoom&&(A=!0,S.zoom=+o.zoom),o.center!==void 0&&(S.center=h.LngLat.convert(o.center)),"bearing"in o&&S.bearing!==+o.bearing&&(M=!0,S.bearing=+o.bearing),"pitch"in o&&S.pitch!==+o.pitch&&(U=!0,S.pitch=+o.pitch),o.padding==null||S.isPaddingEqual(o.padding)||(S.padding=o.padding),this.fire(new h.Event("movestart",y)).fire(new h.Event("move",y)),A&&this.fire(new h.Event("zoomstart",y)).fire(new h.Event("zoom",y)).fire(new h.Event("zoomend",y)),M&&this.fire(new h.Event("rotatestart",y)).fire(new h.Event("rotate",y)).fire(new h.Event("rotateend",y)),U&&this.fire(new h.Event("pitchstart",y)).fire(new h.Event("pitch",y)).fire(new h.Event("pitchend",y)),this.fire(new h.Event("moveend",y))}easeTo(o,y){this._stop(!1,o.easeId),((o=h.extend({offset:[0,0],duration:500,easing:h.ease},o)).animate===!1||!o.essential&&h.exported.prefersReducedMotion)&&(o.duration=0);const S=this.transform,A=this.getZoom(),M=this.getBearing(),U=this.getPitch(),Z=this.getPadding(),J="zoom"in o?+o.zoom:A,ee="bearing"in o?this._normalizeBearing(o.bearing,M):M,re="pitch"in o?+o.pitch:U,ue="padding"in o?o.padding:S.padding,ve=h.pointGeometry.convert(o.offset);let Re=S.centerPoint.add(ve);const be=S.pointLocation(Re),De=h.LngLat.convert(o.center||be);this._normalizeCenter(De);const Je=S.project(be),Xe=S.project(De).sub(Je),nt=S.zoomScale(J-A);let Ye,xt;o.around&&(Ye=h.LngLat.convert(o.around),xt=S.locationPoint(Ye));const ht={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||J!==A,this._rotating=this._rotating||M!==ee,this._pitching=this._pitching||re!==U,this._padding=!S.isPaddingEqual(ue),this._easeId=o.easeId,this._prepareEase(y,o.noMoveStart,ht),this._ease(ft=>{if(this._zooming&&(S.zoom=h.number(A,J,ft)),this._rotating&&(S.bearing=h.number(M,ee,ft)),this._pitching&&(S.pitch=h.number(U,re,ft)),this._padding&&(S.interpolatePadding(Z,ue,ft),Re=S.centerPoint.add(ve)),Ye)S.setLocationAtPoint(Ye,xt);else{const Pt=S.zoomScale(S.zoom-A),Ft=J>A?Math.min(2,nt):Math.max(.5,nt),wt=Math.pow(Ft,1-ft),pi=S.unproject(Je.add(Xe.mult(ft*wt)).mult(Pt));S.setLocationAtPoint(S.renderWorldCopies?pi.wrap():pi,Re)}this._fireMoveEvents(y)},ft=>{this._afterEase(y,ft)},o),this}_prepareEase(o,y,S={}){this._moving=!0,y||S.moving||this.fire(new h.Event("movestart",o)),this._zooming&&!S.zooming&&this.fire(new h.Event("zoomstart",o)),this._rotating&&!S.rotating&&this.fire(new h.Event("rotatestart",o)),this._pitching&&!S.pitching&&this.fire(new h.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new h.Event("move",o)),this._zooming&&this.fire(new h.Event("zoom",o)),this._rotating&&this.fire(new h.Event("rotate",o)),this._pitching&&this.fire(new h.Event("pitch",o))}_afterEase(o,y){if(this._easeId&&y&&this._easeId===y)return;delete this._easeId;const S=this._zooming,A=this._rotating,M=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,S&&this.fire(new h.Event("zoomend",o)),A&&this.fire(new h.Event("rotateend",o)),M&&this.fire(new h.Event("pitchend",o)),this.fire(new h.Event("moveend",o))}flyTo(o,y){if(!o.essential&&h.exported.prefersReducedMotion){const d=h.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(d,y)}this.stop(),o=h.extend({offset:[0,0],speed:1.2,curve:1.42,easing:h.ease},o);const S=this.transform,A=this.getZoom(),M=this.getBearing(),U=this.getPitch(),Z=this.getPadding(),J="zoom"in o?h.clamp(+o.zoom,S.minZoom,S.maxZoom):A,ee="bearing"in o?this._normalizeBearing(o.bearing,M):M,re="pitch"in o?+o.pitch:U,ue="padding"in o?o.padding:S.padding,ve=S.zoomScale(J-A),Re=h.pointGeometry.convert(o.offset);let be=S.centerPoint.add(Re);const De=S.pointLocation(be),Je=h.LngLat.convert(o.center||De);this._normalizeCenter(Je);const Xe=S.project(De),nt=S.project(Je).sub(Xe);let Ye=o.curve;const xt=Math.max(S.width,S.height),ht=xt/ve,ft=nt.mag();if("minZoom"in o){const d=h.clamp(Math.min(o.minZoom,A,J),S.minZoom,S.maxZoom),x=xt/S.zoomScale(d-A);Ye=Math.sqrt(x/ft*2)}const Pt=Ye*Ye;function Ft(d){const x=(ht*ht-xt*xt+(d?-1:1)*Pt*Pt*ft*ft)/(2*(d?ht:xt)*Pt*ft);return Math.log(Math.sqrt(x*x+1)-x)}function wt(d){return(Math.exp(d)-Math.exp(-d))/2}function pi(d){return(Math.exp(d)+Math.exp(-d))/2}const ei=Ft(0);let Ui=function(d){return pi(ei)/pi(ei+Ye*d)},c=function(d){return xt*((pi(ei)*(wt(x=ei+Ye*d)/pi(x))-wt(ei))/Pt)/ft;var x},m=(Ft(1)-ei)/Ye;if(Math.abs(ft)<1e-6||!isFinite(m)){if(Math.abs(xt-ht)<1e-6)return this.easeTo(o,y);const d=ht<xt?-1:1;m=Math.abs(Math.log(ht/xt))/Ye,c=function(){return 0},Ui=function(x){return Math.exp(d*Ye*x)}}return o.duration="duration"in o?+o.duration:1e3*m/("screenSpeed"in o?+o.screenSpeed/Ye:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=M!==ee,this._pitching=re!==U,this._padding=!S.isPaddingEqual(ue),this._prepareEase(y,!1),this._ease(d=>{const x=d*m,k=1/Ui(x);S.zoom=d===1?J:A+S.scaleZoom(k),this._rotating&&(S.bearing=h.number(M,ee,d)),this._pitching&&(S.pitch=h.number(U,re,d)),this._padding&&(S.interpolatePadding(Z,ue,d),be=S.centerPoint.add(Re));const L=d===1?Je:S.unproject(Xe.add(nt.mult(c(x))).mult(k));S.setLocationAtPoint(S.renderWorldCopies?L.wrap():L,be),this._fireMoveEvents(y)},()=>this._afterEase(y),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,y){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const S=this._onEaseEnd;delete this._onEaseEnd,S.call(this,y)}if(!o){const S=this.handlers;S&&S.stop(!1)}return this}_ease(o,y,S){S.animate===!1||S.duration===0?(o(1),y()):(this._easeStart=h.exported.now(),this._easeOptions=S,this._onEaseFrame=o,this._onEaseEnd=y,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((h.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,y){o=h.wrap(o,-180,180);const S=Math.abs(o-y);return Math.abs(o-360-y)<S&&(o-=360),Math.abs(o+360-y)<S&&(o+=360),o}_normalizeCenter(o){const y=this.transform;if(!y.renderWorldCopies||y.lngRange)return;const S=o.lng-y.center.lng;o.lng+=S>180?-360:S<-180?360:0}}class So{constructor(o={}){this.options=o,h.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options&&this.options.compact,this._container=H.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=H.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=H.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){H.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,y){const S=this._map._getUIString(`AttributionControl.${y}`);o.title=S,o.setAttribute("aria-label",S)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(A=>typeof A!="string"?"":A)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const A=this._map.style.stylesheet;this.styleOwner=A.owner,this.styleId=A.id}const y=this._map.style.sourceCaches;for(const A in y){const M=y[A];if(M.used){const U=M.getSource();U.attribution&&o.indexOf(U.attribution)<0&&o.push(U.attribution)}}o=o.filter(A=>String(A).trim()),o.sort((A,M)=>A.length-M.length),o=o.filter((A,M)=>{for(let U=M+1;U<o.length;U++)if(o[U].indexOf(A)>=0)return!1;return!0});const S=o.join(" | ");S!==this._attribHTML&&(this._attribHTML=S,o.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class ka{constructor(o={}){this.options=o,h.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=H.create("div","maplibregl-ctrl mapboxgl-ctrl");const y=H.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return y.target="_blank",y.rel="noopener nofollow",y.href="https://maplibre.org/",y.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),y.setAttribute("rel","noopener nofollow"),this._container.appendChild(y),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){H.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const o=this._container.children;if(o.length){const y=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&y.classList.add("maplibregl-compact","mapboxgl-compact"):y.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class cc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const y=++this._id;return this._queue.push({callback:o,id:y,cancelled:!1}),y}remove(o){const y=this._currentlyRunning,S=y?this._queue.concat(y):this._queue;for(const A of S)if(A.id===o)return void(A.cancelled=!0)}run(o=0){const y=this._currentlyRunning=this._queue;this._queue=[];for(const S of y)if(!S.cancelled&&(S.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Al={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},hc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},va={showCompass:!0,showZoom:!0,visualizePitch:!1};class Wo{constructor(o,y,S=!1){this._clickTolerance=10,this.element=y,this.mouseRotate=new Jt({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,S&&(this.mousePitch=new Qs({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),h.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),H.addEventListener(y,"mousedown",this.mousedown),H.addEventListener(y,"touchstart",this.touchstart,{passive:!1}),H.addEventListener(y,"touchmove",this.touchmove),H.addEventListener(y,"touchend",this.touchend),H.addEventListener(y,"touchcancel",this.reset)}down(o,y){this.mouseRotate.mousedown(o,y),this.mousePitch&&this.mousePitch.mousedown(o,y),H.disableDrag()}move(o,y){const S=this.map,A=this.mouseRotate.mousemoveWindow(o,y);if(A&&A.bearingDelta&&S.setBearing(S.getBearing()+A.bearingDelta),this.mousePitch){const M=this.mousePitch.mousemoveWindow(o,y);M&&M.pitchDelta&&S.setPitch(S.getPitch()+M.pitchDelta)}}off(){const o=this.element;H.removeEventListener(o,"mousedown",this.mousedown),H.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),H.removeEventListener(o,"touchmove",this.touchmove),H.removeEventListener(o,"touchend",this.touchend),H.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){H.enableDrag(),H.removeEventListener(window,"mousemove",this.mousemove),H.removeEventListener(window,"mouseup",this.mouseup)}mousedown(o){this.down(h.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),H.mousePos(this.element,o)),H.addEventListener(window,"mousemove",this.mousemove),H.addEventListener(window,"mouseup",this.mouseup)}mousemove(o){this.move(o,H.mousePos(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=H.touchPos(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=H.touchPos(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function si(T,o,y){if(T=new h.LngLat(T.lng,T.lat),o){const S=new h.LngLat(T.lng-360,T.lat),A=new h.LngLat(T.lng+360,T.lat),M=y.locationPoint(T).distSqr(o);y.locationPoint(S).distSqr(o)<M?T=S:y.locationPoint(A).distSqr(o)<M&&(T=A)}for(;Math.abs(T.lng-y.center.lng)>180;){const S=y.locationPoint(T);if(S.x>=0&&S.y>=0&&S.x<=y.width&&S.y<=y.height)break;T.lng>y.center.lng?T.lng-=360:T.lng+=360}return T}const Nt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Xo(T,o,y){const S=T.classList;for(const A in Nt)S.remove(`maplibregl-${y}-anchor-${A}`,`mapboxgl-${y}-anchor-${A}`);S.add(`maplibregl-${y}-anchor-${o}`,`mapboxgl-${y}-anchor-${o}`)}class Mo extends h.Evented{constructor(o,y){if(super(),(o instanceof HTMLElement||y)&&(o=h.extend({element:o},y)),h.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=h.pointGeometry.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=H.create("div"),this._element.setAttribute("aria-label","Map marker");const S=H.createNS("http://www.w3.org/2000/svg","svg"),A=41,M=27;S.setAttributeNS(null,"display","block"),S.setAttributeNS(null,"height",`${A}px`),S.setAttributeNS(null,"width",`${M}px`),S.setAttributeNS(null,"viewBox",`0 0 ${M} ${A}`);const U=H.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"stroke","none"),U.setAttributeNS(null,"stroke-width","1"),U.setAttributeNS(null,"fill","none"),U.setAttributeNS(null,"fill-rule","evenodd");const Z=H.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"fill-rule","nonzero");const J=H.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(3.0, 29.0)"),J.setAttributeNS(null,"fill","#000000");const ee=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const nt of ee){const Ye=H.createNS("http://www.w3.org/2000/svg","ellipse");Ye.setAttributeNS(null,"opacity","0.04"),Ye.setAttributeNS(null,"cx","10.5"),Ye.setAttributeNS(null,"cy","5.80029008"),Ye.setAttributeNS(null,"rx",nt.rx),Ye.setAttributeNS(null,"ry",nt.ry),J.appendChild(Ye)}const re=H.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"fill",this._color);const ue=H.createNS("http://www.w3.org/2000/svg","path");ue.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),re.appendChild(ue);const ve=H.createNS("http://www.w3.org/2000/svg","g");ve.setAttributeNS(null,"opacity","0.25"),ve.setAttributeNS(null,"fill","#000000");const Re=H.createNS("http://www.w3.org/2000/svg","path");Re.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ve.appendChild(Re);const be=H.createNS("http://www.w3.org/2000/svg","g");be.setAttributeNS(null,"transform","translate(6.0, 7.0)"),be.setAttributeNS(null,"fill","#FFFFFF");const De=H.createNS("http://www.w3.org/2000/svg","g");De.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Je=H.createNS("http://www.w3.org/2000/svg","circle");Je.setAttributeNS(null,"fill","#000000"),Je.setAttributeNS(null,"opacity","0.25"),Je.setAttributeNS(null,"cx","5.5"),Je.setAttributeNS(null,"cy","5.5"),Je.setAttributeNS(null,"r","5.4999962");const Xe=H.createNS("http://www.w3.org/2000/svg","circle");Xe.setAttributeNS(null,"fill","#FFFFFF"),Xe.setAttributeNS(null,"cx","5.5"),Xe.setAttributeNS(null,"cy","5.5"),Xe.setAttributeNS(null,"r","5.4999962"),De.appendChild(Je),De.appendChild(Xe),Z.appendChild(J),Z.appendChild(re),Z.appendChild(ve),Z.appendChild(be),Z.appendChild(De),S.appendChild(Z),S.setAttributeNS(null,"height",A*this._scale+"px"),S.setAttributeNS(null,"width",M*this._scale+"px"),this._element.appendChild(S),this._offset=h.pointGeometry.convert(o&&o.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",S=>{S.preventDefault()}),this._element.addEventListener("mousedown",S=>{S.preventDefault()}),Xo(this._element,this._anchor,"marker"),this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),H.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=h.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const A=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[A,-1*(38.1-13.5+A)],"bottom-right":[-A,-1*(38.1-13.5+A)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(o){const y=o.code,S=o.charCode||o.keyCode;y!=="Space"&&y!=="Enter"&&S!==32&&S!==13||this.togglePopup()}_onMapClick(o){const y=o.originalEvent.target,S=this._element;this._popup&&(y===S||S.contains(y))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}_update(o){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=si(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),o&&o.type!=="moveend"||(this._pos=this._pos.round()),H.setTransform(this._element,`${Nt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${y}`)}getOffset(){return this._offset}setOffset(o){return this._offset=h.pointGeometry.convert(o),this._update(),this}_onMove(o){if(!this._isDragging){const y=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=y}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.Event("dragstart"))),this.fire(new h.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.Event("dragend")),this._state="inactive"}_addDragHandler(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const jn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let fn,Ko=0,vn=!1;const Lo={maxWidth:100,unit:"metric"};function fs(T,o,y){const S=y&&y.maxWidth||100,A=T._container.clientHeight/2,M=T.unproject([0,A]),U=T.unproject([S,A]),Z=M.distanceTo(U);if(y&&y.unit==="imperial"){const J=3.2808*Z;J>5280?Zt(o,S,J/5280,T._getUIString("ScaleControl.Miles")):Zt(o,S,J,T._getUIString("ScaleControl.Feet"))}else y&&y.unit==="nautical"?Zt(o,S,Z/1852,T._getUIString("ScaleControl.NauticalMiles")):Z>=1e3?Zt(o,S,Z/1e3,T._getUIString("ScaleControl.Kilometers")):Zt(o,S,Z,T._getUIString("ScaleControl.Meters"))}function Zt(T,o,y,S){const A=function(M){const U=Math.pow(10,`${Math.floor(M)}`.length-1);let Z=M/U;return Z=Z>=10?10:Z>=5?5:Z>=3?3:Z>=2?2:Z>=1?1:function(J){const ee=Math.pow(10,Math.ceil(-Math.log(J)/Math.LN10));return Math.round(J*ee)/ee}(Z),U*Z}(y);T.style.width=o*(A/y)+"px",T.innerHTML=`${A}&nbsp;${S}`}const Gt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},iu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Bn(T){if(T){if(typeof T=="number"){const o=Math.round(Math.sqrt(.5*Math.pow(T,2)));return{center:new h.pointGeometry(0,0),top:new h.pointGeometry(0,T),"top-left":new h.pointGeometry(o,o),"top-right":new h.pointGeometry(-o,o),bottom:new h.pointGeometry(0,-T),"bottom-left":new h.pointGeometry(o,-o),"bottom-right":new h.pointGeometry(-o,-o),left:new h.pointGeometry(T,0),right:new h.pointGeometry(-T,0)}}if(T instanceof h.pointGeometry||Array.isArray(T)){const o=h.pointGeometry.convert(T);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:h.pointGeometry.convert(T.center||[0,0]),top:h.pointGeometry.convert(T.top||[0,0]),"top-left":h.pointGeometry.convert(T["top-left"]||[0,0]),"top-right":h.pointGeometry.convert(T["top-right"]||[0,0]),bottom:h.pointGeometry.convert(T.bottom||[0,0]),"bottom-left":h.pointGeometry.convert(T["bottom-left"]||[0,0]),"bottom-right":h.pointGeometry.convert(T["bottom-right"]||[0,0]),left:h.pointGeometry.convert(T.left||[0,0]),right:h.pointGeometry.convert(T.right||[0,0])}}return Bn(new h.pointGeometry(0,0))}const No={supported:D,setRTLTextPlugin:h.setRTLTextPlugin,getRTLTextPluginStatus:h.getRTLTextPluginStatus,Map:class extends tl{constructor(T){var o;if(h.PerformanceUtils.mark(h.PerformanceMarkers.create),(T=h.extend({},hc,T)).minZoom!=null&&T.maxZoom!=null&&T.minZoom>T.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(T.minPitch!=null&&T.maxPitch!=null&&T.minPitch>T.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(T.minPitch!=null&&T.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(T.maxPitch!=null&&T.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Aa(T.minZoom,T.maxZoom,T.minPitch,T.maxPitch,T.renderWorldCopies),{bearingSnap:T.bearingSnap}),this._interactive=T.interactive,this._maxTileCacheSize=T.maxTileCacheSize,this._failIfMajorPerformanceCaveat=T.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=T.preserveDrawingBuffer,this._antialias=T.antialias,this._trackResize=T.trackResize,this._bearingSnap=T.bearingSnap,this._refreshExpiredTiles=T.refreshExpiredTiles,this._fadeDuration=T.fadeDuration,this._crossSourceCollisions=T.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=T.collectResourceTiming,this._renderTaskQueue=new cc,this._controls=[],this._mapId=h.uniqueId(),this._locale=h.extend({},Al,T.locale),this._clickTolerance=T.clickTolerance,this._pixelRatio=(o=T.pixelRatio)!==null&&o!==void 0?o:devicePixelRatio,this._requestManager=new Pe(T.transformRequest),typeof T.container=="string"){if(this._container=document.getElementById(T.container),!this._container)throw new Error(`Container '${T.container}' not found.`)}else{if(!(T.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=T.container}if(T.maxBounds&&this.setMaxBounds(T.maxBounds),h.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),typeof window!="undefined"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new dn(this,T),this._hash=T.hash&&new vl(typeof T.hash=="string"&&T.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:T.center,zoom:T.zoom,bearing:T.bearing,pitch:T.pitch}),T.bounds&&(this.resize(),this.fitBounds(T.bounds,h.extend({},T.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=T.localIdeographFontFamily,T.style&&this.setStyle(T.style,{localIdeographFontFamily:T.localIdeographFontFamily}),T.attributionControl&&this.addControl(new So({customAttribution:T.customAttribution})),T.maplibreLogo&&this.addControl(new ka,T.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",y=>{this._update(y.dataType==="style"),this.fire(new h.Event(`${y.dataType}data`,y))}),this.on("dataloading",y=>{this.fire(new h.Event(`${y.dataType}dataloading`,y))}),this.on("dataabort",y=>{this.fire(new h.Event("sourcedataabort",y))})}_getMapId(){return this._mapId}addControl(T,o){if(o===void 0&&(o=T.getDefaultPosition?T.getDefaultPosition():"top-right"),!T||!T.onAdd)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const y=T.onAdd(this);this._controls.push(T);const S=this._controlPositions[o];return o.indexOf("bottom")!==-1?S.insertBefore(y,S.firstChild):S.appendChild(y),this}removeControl(T){if(!T||!T.onRemove)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(T);return o>-1&&this._controls.splice(o,1),T.onRemove(this),this}hasControl(T){return this._controls.indexOf(T)>-1}resize(T){const o=this._containerDimensions(),y=o[0],S=o[1];this._resizeCanvas(y,S,this.getPixelRatio()),this.transform.resize(y,S),this.painter.resize(y,S,this.getPixelRatio());const A=!this._moving;return A&&(this.stop(),this.fire(new h.Event("movestart",T)).fire(new h.Event("move",T))),this.fire(new h.Event("resize",T)),A&&this.fire(new h.Event("moveend",T)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(T){const[o,y]=this._containerDimensions();this._pixelRatio=T,this._resizeCanvas(o,y,T),this.painter.resize(o,y,T)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(T){return this.transform.setMaxBounds(h.LngLatBounds.convert(T)),this._update()}setMinZoom(T){if((T=T==null?-2:T)>=-2&&T<=this.transform.maxZoom)return this.transform.minZoom=T,this._update(),this.getZoom()<T&&this.setZoom(T),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(T){if((T=T==null?22:T)>=this.transform.minZoom)return this.transform.maxZoom=T,this._update(),this.getZoom()>T&&this.setZoom(T),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(T){if((T=T==null?0:T)<0)throw new Error("minPitch must be greater than or equal to 0");if(T>=0&&T<=this.transform.maxPitch)return this.transform.minPitch=T,this._update(),this.getPitch()<T&&this.setPitch(T),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(T){if((T=T==null?60:T)>85)throw new Error("maxPitch must be less than or equal to 85");if(T>=this.transform.minPitch)return this.transform.maxPitch=T,this._update(),this.getPitch()>T&&this.setPitch(T),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(T){return this.transform.renderWorldCopies=T,this._update()}project(T){return this.transform.locationPoint(h.LngLat.convert(T))}unproject(T){return this.transform.pointLocation(h.pointGeometry.convert(T))}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(T,o,y){if(T==="mouseenter"||T==="mouseover"){let S=!1;return{layer:o,listener:y,delegates:{mousemove:M=>{const U=this.getLayer(o)?this.queryRenderedFeatures(M.point,{layers:[o]}):[];U.length?S||(S=!0,y.call(this,new zo(T,this,M.originalEvent,{features:U}))):S=!1},mouseout:()=>{S=!1}}}}if(T==="mouseleave"||T==="mouseout"){let S=!1;return{layer:o,listener:y,delegates:{mousemove:U=>{(this.getLayer(o)?this.queryRenderedFeatures(U.point,{layers:[o]}):[]).length?S=!0:S&&(S=!1,y.call(this,new zo(T,this,U.originalEvent)))},mouseout:U=>{S&&(S=!1,y.call(this,new zo(T,this,U.originalEvent)))}}}}{const S=A=>{const M=this.getLayer(o)?this.queryRenderedFeatures(A.point,{layers:[o]}):[];M.length&&(A.features=M,y.call(this,A),delete A.features)};return{layer:o,listener:y,delegates:{[T]:S}}}}on(T,o,y){if(y===void 0)return super.on(T,o);const S=this._createDelegatedListener(T,o,y);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[T]=this._delegatedListeners[T]||[],this._delegatedListeners[T].push(S);for(const A in S.delegates)this.on(A,S.delegates[A]);return this}once(T,o,y){if(y===void 0)return super.once(T,o);const S=this._createDelegatedListener(T,o,y);for(const A in S.delegates)this.once(A,S.delegates[A]);return this}off(T,o,y){return y===void 0?super.off(T,o):(this._delegatedListeners&&this._delegatedListeners[T]&&(S=>{const A=this._delegatedListeners[T];for(let M=0;M<A.length;M++){const U=A[M];if(U.layer===o&&U.listener===y){for(const Z in U.delegates)this.off(Z,U.delegates[Z]);return A.splice(M,1),this}}})(),this)}queryRenderedFeatures(T,o){if(!this.style)return[];let y;if(o!==void 0||T===void 0||T instanceof h.pointGeometry||Array.isArray(T)||(o=T,T=void 0),o=o||{},(T=T||[[0,0],[this.transform.width,this.transform.height]])instanceof h.pointGeometry||typeof T[0]=="number")y=[h.pointGeometry.convert(T)];else{const S=h.pointGeometry.convert(T[0]),A=h.pointGeometry.convert(T[1]);y=[S,new h.pointGeometry(A.x,S.y),A,new h.pointGeometry(S.x,A.y),S]}return this.style.queryRenderedFeatures(y,o,this.transform)}querySourceFeatures(T,o){return this.style.querySourceFeatures(T,o)}setStyle(T,o){return(o=h.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&T?(this._diffStyle(T,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(T,o))}setTransformRequest(T){return this._requestManager.setTransformRequest(T),this}_getUIString(T){const o=this._locale[T];if(o==null)throw new Error(`Missing UI string '${T}'`);return o}_updateStyle(T,o){return this.style&&(this.style.setEventedParent(null),this.style._remove()),T?(this.style=new Cr(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof T=="string"?this.style.loadURL(T):this.style.loadJSON(T),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Cr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(T,o){if(typeof T=="string"){const y=this._requestManager.transformRequest(T,h.ResourceType.Style);h.getJSON(y,(S,A)=>{S?this.fire(new h.ErrorEvent(S)):A&&this._updateDiff(A,o)})}else typeof T=="object"&&this._updateDiff(T,o)}_updateDiff(T,o){try{this.style.setState(T)&&this._update(!0)}catch(y){h.warnOnce(`Unable to perform style diff: ${y.message||y.error||y}.  Rebuilding the style from scratch.`),this._updateStyle(T,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():h.warnOnce("There is no style added to the map.")}addSource(T,o){return this._lazyInitEmptyStyle(),this.style.addSource(T,o),this._update(!0)}isSourceLoaded(T){const o=this.style&&this.style.sourceCaches[T];if(o!==void 0)return o.loaded();this.fire(new h.ErrorEvent(new Error(`There is no source with ID '${T}'`)))}areTilesLoaded(){const T=this.style&&this.style.sourceCaches;for(const o in T){const y=T[o]._tiles;for(const S in y){const A=y[S];if(A.state!=="loaded"&&A.state!=="errored")return!1}}return!0}addSourceType(T,o,y){return this._lazyInitEmptyStyle(),this.style.addSourceType(T,o,y)}removeSource(T){return this.style.removeSource(T),this._update(!0)}getSource(T){return this.style.getSource(T)}addImage(T,o,{pixelRatio:y=1,sdf:S=!1,stretchX:A,stretchY:M,content:U}={}){if(this._lazyInitEmptyStyle(),o instanceof HTMLImageElement||h.isImageBitmap(o)){const{width:Z,height:J,data:ee}=h.exported.getImageData(o);this.style.addImage(T,{data:new h.RGBAImage({width:Z,height:J},ee),pixelRatio:y,stretchX:A,stretchY:M,content:U,sdf:S,version:0})}else{if(o.width===void 0||o.height===void 0)return this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Z,height:J,data:ee}=o,re=o;this.style.addImage(T,{data:new h.RGBAImage({width:Z,height:J},new Uint8Array(ee)),pixelRatio:y,stretchX:A,stretchY:M,content:U,sdf:S,version:0,userImage:re}),re.onAdd&&re.onAdd(this,T)}}}updateImage(T,o){const y=this.style.getImage(T);if(!y)return this.fire(new h.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const S=o instanceof HTMLImageElement||h.isImageBitmap(o)?h.exported.getImageData(o):o,{width:A,height:M,data:U}=S;if(A===void 0||M===void 0)return this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(A!==y.data.width||M!==y.data.height)return this.fire(new h.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const Z=!(o instanceof HTMLImageElement||h.isImageBitmap(o));y.data.replace(U,Z),this.style.updateImage(T,y)}hasImage(T){return T?!!this.style.getImage(T):(this.fire(new h.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(T){this.style.removeImage(T)}loadImage(T,o){h.getImage(this._requestManager.transformRequest(T,h.ResourceType.Image),o)}listImages(){return this.style.listImages()}addLayer(T,o){return this._lazyInitEmptyStyle(),this.style.addLayer(T,o),this._update(!0)}moveLayer(T,o){return this.style.moveLayer(T,o),this._update(!0)}removeLayer(T){return this.style.removeLayer(T),this._update(!0)}getLayer(T){return this.style.getLayer(T)}setLayerZoomRange(T,o,y){return this.style.setLayerZoomRange(T,o,y),this._update(!0)}setFilter(T,o,y={}){return this.style.setFilter(T,o,y),this._update(!0)}getFilter(T){return this.style.getFilter(T)}setPaintProperty(T,o,y,S={}){return this.style.setPaintProperty(T,o,y,S),this._update(!0)}getPaintProperty(T,o){return this.style.getPaintProperty(T,o)}setLayoutProperty(T,o,y,S={}){return this.style.setLayoutProperty(T,o,y,S),this._update(!0)}getLayoutProperty(T,o){return this.style.getLayoutProperty(T,o)}setLight(T,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(T,o),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(T,o){return this.style.setFeatureState(T,o),this._update()}removeFeatureState(T,o){return this.style.removeFeatureState(T,o),this._update()}getFeatureState(T){return this.style.getFeatureState(T)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let T=0,o=0;return this._container&&(T=this._container.clientWidth||400,o=this._container.clientHeight||300),[T,o]}_setupContainer(){const T=this._container;T.classList.add("maplibregl-map","mapboxgl-map");const o=this._canvasContainer=H.create("div","maplibregl-canvas-container mapboxgl-canvas-container",T);this._interactive&&o.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=H.create("canvas","maplibregl-canvas mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const y=this._containerDimensions();this._resizeCanvas(y[0],y[1],this.getPixelRatio());const S=this._controlContainer=H.create("div","maplibregl-control-container mapboxgl-control-container",T),A=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(M=>{A[M]=H.create("div",`maplibregl-ctrl-${M} mapboxgl-ctrl-${M}`,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(T,o,y){this._canvas.width=y*T,this._canvas.height=y*o,this._canvas.style.width=`${T}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const T=h.extend({},D.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl",T)||this._canvas.getContext("experimental-webgl",T);o?(this.painter=new la(o,this.transform),h.exported$1.testSupport(o)):this.fire(new h.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(T){T.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new h.Event("webglcontextlost",{originalEvent:T}))}_contextRestored(T){this._setupPainter(),this.resize(),this._update(),this.fire(new h.Event("webglcontextrestored",{originalEvent:T}))}_onMapScroll(T){if(T.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(T){return this.style?(this._styleDirty=this._styleDirty||T,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(T){return this._update(),this._renderTaskQueue.add(T)}_cancelRenderFrame(T){this._renderTaskQueue.remove(T)}_render(T){let o,y=0;const S=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(o=S.createQueryEXT(),S.beginQueryEXT(S.TIME_ELAPSED_EXT,o),y=h.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(T),this._removed)return;let A=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,Z=h.exported.now();this.style.zoomHistory.update(U,Z);const J=new h.EvaluationParameters(U,{now:Z,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ee=J.crossFadingFactor();ee===1&&ee===this._crossFadingFactor||(A=!0,this._crossFadingFactor=ee),this.style.update(J)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new h.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,h.PerformanceUtils.mark(h.PerformanceMarkers.load),this.fire(new h.Event("load"))),this.style&&(this.style.hasTransitions()||A)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const U=h.exported.now()-y;S.endQueryEXT(S.TIME_ELAPSED_EXT,o),setTimeout(()=>{const Z=S.getQueryObjectEXT(o,S.QUERY_RESULT_EXT)/1e6;S.deleteQueryEXT(o),this.fire(new h.Event("gpu-timing-frame",{cpuTime:U,gpuTime:Z}))},50)}if(this.listens("gpu-timing-layer")){const U=this.painter.collectGpuTimers();setTimeout(()=>{const Z=this.painter.queryGpuTimers(U);this.fire(new h.Event("gpu-timing-layer",{layerTimes:Z}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty;return M||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.Event("idle")),!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,h.PerformanceUtils.mark(h.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window!="undefined"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const T=this.painter.context.gl.getExtension("WEBGL_lose_context");T&&T.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),H.remove(this._canvasContainer),H.remove(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),h.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new h.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=h.exported.frame(T=>{h.PerformanceUtils.frame(T),this._frame=null,this._render(T)}))}_onWindowOnline(){this._update()}_onWindowResize(T){this._trackResize&&this.resize({originalEvent:T})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(T){this._showTileBoundaries!==T&&(this._showTileBoundaries=T,this._update())}get showPadding(){return!!this._showPadding}set showPadding(T){this._showPadding!==T&&(this._showPadding=T,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(T){this._showCollisionBoxes!==T&&(this._showCollisionBoxes=T,T?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(T){this._showOverdrawInspector!==T&&(this._showOverdrawInspector=T,this._update())}get repaint(){return!!this._repaint}set repaint(T){this._repaint!==T&&(this._repaint=T,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(T){this._vertices=T,this._update()}_setCacheLimits(T,o){h.setCacheLimits(T,o)}},NavigationControl:class{constructor(T){this.options=h.extend({},va,T),this._container=H.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(h.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),H.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),H.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(h.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=H.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const T=this._map.getZoom(),o=T===this._map.getMaxZoom(),y=T===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const T=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=T}onAdd(T){return this._map=T,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Wo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){H.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(T,o){const y=H.create("button",T,this._container);return y.type="button",y.addEventListener("click",o),y}_setButtonTitle(T,o){const y=this._map._getUIString(`NavigationControl.${o}`);T.title=y,T.setAttribute("aria-label",y)}},GeolocateControl:class extends h.Evented{constructor(T){super(),this.options=h.extend({},jn,T),h.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(T){var o;return this._map=T,this._container=H.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),o=this._setupUI,fn!==void 0?o(fn):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(y=>{fn=y.state!=="denied",o(fn)}):(fn=!!window.navigator.geolocation,o(fn)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),H.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ko=0,vn=!1}_isOutOfMapMaxBounds(T){const o=this._map.getMaxBounds(),y=T.coords;return o&&(y.longitude<o.getWest()||y.longitude>o.getEast()||y.latitude<o.getSouth()||y.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(T){if(this._map){if(this._isOutOfMapMaxBounds(T))return this._setErrorState(),this.fire(new h.Event("outofmaxbounds",T)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=T,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(T),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(T),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new h.Event("geolocate",T)),this._finish()}}_updateCamera(T){const o=new h.LngLat(T.coords.longitude,T.coords.latitude),y=T.coords.accuracy,S=this._map.getBearing(),A=h.extend({bearing:S},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(y),A,{geolocateSource:!0})}_updateMarker(T){if(T){const o=new h.LngLat(T.coords.longitude,T.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=T.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const T=this._map._container.clientHeight/2,o=this._map.unproject([0,T]),y=this._map.unproject([1,T]),S=o.distanceTo(y),A=Math.ceil(2*this._accuracy/S);this._circleElement.style.width=`${A}px`,this._circleElement.style.height=`${A}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(T){if(this._map){if(this.options.trackUserLocation)if(T.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(T.code===3&&vn)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new h.Event("error",T)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(T){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=H.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),H.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",T===!1){h.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=H.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Mo(this._dotElement),this._circleElement=H.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Mo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new h.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return h.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ko--,vn=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new h.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let T;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ko++,Ko>1?(T={maximumAge:6e5,timeout:0},vn=!0):(T=this.options.positionOptions,vn=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,T)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:So,LogoControl:ka,ScaleControl:class{constructor(T){this.options=h.extend({},Lo,T),h.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){fs(this._map,this._container,this.options)}onAdd(T){return this._map=T,this._container=H.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",T.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){H.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(T){this.options.unit=T,fs(this._map,this._container,this.options)}},FullscreenControl:class{constructor(T){this._fullscreen=!1,T&&T.container&&(T.container instanceof HTMLElement?this._container=T.container:h.warnOnce("Full screen control 'container' must be a DOM element.")),h.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(T){return this._map=T,this._container||(this._container=this._map.getContainer()),this._controlContainer=H.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",h.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){H.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const T=this._fullscreenButton=H.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);H.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",T).setAttribute("aria-hidden","true"),T.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const T=this._getTitle();this._fullscreenButton.setAttribute("aria-label",T),this._fullscreenButton.title=T}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends h.Evented{constructor(T){super(),this.options=h.extend(Object.create(Gt),T),h.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(T){return this._map&&this.remove(),this._map=T,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new h.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&H.remove(this._content),this._container&&(H.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new h.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(T){return this._lngLat=h.LngLat.convert(T),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(T){return this.setDOMContent(document.createTextNode(T))}setHTML(T){const o=document.createDocumentFragment(),y=document.createElement("body");let S;for(y.innerHTML=T;S=y.firstChild,S;)o.appendChild(S);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(T){return this.options.maxWidth=T,this._update(),this}setDOMContent(T){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=H.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(T),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(T){this._container&&this._container.classList.add(T)}removeClassName(T){this._container&&this._container.classList.remove(T)}setOffset(T){return this.options.offset=T,this._update(),this}toggleClassName(T){if(this._container)return this._container.classList.toggle(T)}_createCloseButton(){this.options.closeButton&&(this._closeButton=H.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(T){this._update(T.point)}_onMouseMove(T){this._update(T.point)}_onDrag(T){this._update(T.point)}_update(T){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=H.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=H.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(M=>this._container.classList.add(M)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=si(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!T))return;const o=this._pos=this._trackPointer&&T?T:this._map.project(this._lngLat);let y=this.options.anchor;const S=Bn(this.options.offset);if(!y){const M=this._container.offsetWidth,U=this._container.offsetHeight;let Z;Z=o.y+S.bottom.y<U?["top"]:o.y>this._map.transform.height-U?["bottom"]:[],o.x<M/2?Z.push("left"):o.x>this._map.transform.width-M/2&&Z.push("right"),y=Z.length===0?"bottom":Z.join("-")}const A=o.add(S[y]).round();H.setTransform(this._container,`${Nt[y]} translate(${A.x}px,${A.y}px)`),Xo(this._container,y,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const T=this._container.querySelector(iu);T&&T.focus()}_onClose(){this.remove()}},Marker:Mo,Style:Cr,LngLat:h.LngLat,LngLatBounds:h.LngLatBounds,Point:h.pointGeometry,MercatorCoordinate:h.MercatorCoordinate,Evented:h.Evented,AJAXError:h.AJAXError,config:h.config,CanvasSource:Xi,GeoJSONSource:ai,ImageSource:Fi,RasterDEMTileSource:Rt,RasterTileSource:mr,VectorTileSource:Gi,VideoSource:jt,prewarm:function(){_n().acquire(Pr)},clearPrewarmedResources:function(){const T=Bo;T&&(T.isPreloaded()&&T.numActive()===1?(T.release(Pr),Bo=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get workerCount(){return co.workerCount},set workerCount(T){co.workerCount=T},get maxParallelImageRequests(){return h.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(T){h.config.MAX_PARALLEL_IMAGE_REQUESTS=T},clearStorage(T){h.clearTileCache(T)},workerUrl:"",addProtocol(T,o){h.config.REGISTERED_PROTOCOLS[T]=o},removeProtocol(T){delete h.config.REGISTERED_PROTOCOLS[T]}};return rn.extend(No,{isSafari:h.isSafari,getPerformanceMetrics:h.PerformanceUtils.getPerformanceMetrics}),No});var f=w;return f})})($h);var OE=$h.exports,Wp=UE,FE=Object.prototype.hasOwnProperty;function UE(){for(var u={},r=0;r<arguments.length;r++){var s=arguments[r];for(var g in s)FE.call(s,g)&&(u[g]=s[g])}return u}var Hv={exports:{}};(function(u,r){(function(){var s={};u.exports=s,s.simpleFilter=function(g,w){return w.filter(function(z){return s.test(g,z)})},s.test=function(g,w){return s.match(g,w)!==null},s.match=function(g,w,z){z=z||{};var f=0,h=[],D=w.length,N=0,F=0,G=z.pre||"",H=z.post||"",Pe=z.caseSensitive&&w||w.toLowerCase(),ke;g=z.caseSensitive&&g||g.toLowerCase();for(var We=0;We<D;We++)ke=w[We],Pe[We]===g[f]?(ke=G+ke+H,f+=1,F+=1+F):F=0,N+=F,h[h.length]=ke;return f===g.length?(N=Pe===g?1/0:N,{rendered:h.join(""),score:N}):null},s.filter=function(g,w,z){return!w||w.length===0?[]:typeof g!="string"?w:(z=z||{},w.reduce(function(f,h,D,N){var F=h;z.extract&&(F=z.extract(h));var G=s.match(g,F,z);return G!=null&&(f[f.length]={string:G.rendered,score:G.score,index:D,original:h}),f},[]).sort(function(f,h){var D=h.score-f.score;return D||f.index-h.index}))}})()})(Hv);var Vs=function(u){return this.component=u,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,u.el.parentNode.insertBefore(this.wrapper,u.el.nextSibling),this};Vs.prototype.show=function(){this.element.style.display="block"};Vs.prototype.hide=function(){this.element.style.display="none"};Vs.prototype.add=function(u){this.items.push(u)};Vs.prototype.clear=function(){this.items=[],this.active=0};Vs.prototype.isEmpty=function(){return!this.items.length};Vs.prototype.isVisible=function(){return this.element.style.display==="block"};Vs.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var u=0;u<this.items.length;u++)this.drawItem(this.items[u],this.active===u);this.show()};Vs.prototype.drawItem=function(u,r){var s=document.createElement("li"),g=document.createElement("a");r&&(s.className+=" active"),g.innerHTML=u.string,s.appendChild(g),this.element.appendChild(s),s.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),s.addEventListener("mouseup",function(){this.handleMouseUp.call(this,u)}.bind(this))};Vs.prototype.handleMouseUp=function(u){this.selectingListItem=!1,this.component.value(u.original),this.clear(),this.draw()};Vs.prototype.move=function(u){this.active=u,this.draw()};Vs.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)};Vs.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)};Vs.prototype.drawError=function(u){var r=document.createElement("li");r.innerHTML=u,this.element.appendChild(r),this.show()};var NE=Vs,jE=Wp,VE=Hv.exports,qE=NE,es=function(u,r,s){return s=s||{},this.options=jE({minLength:2,limit:5,filter:!0,hideOnBlur:!0},s),this.el=u,this.data=r||[],this.list=new qE(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(g){this.handleKeyUp(g.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(g){this.handleKeyDown(g)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(g){this.handlePaste(g)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};es.prototype.handleKeyUp=function(u){u===40||u===38||u===27||u===13||u===9||this.handleInputChange(this.el.value)};es.prototype.handleKeyDown=function(u){switch(u.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&u.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};es.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};es.prototype.handlePaste=function(u){if(u.clipboardData)this.handleInputChange(u.clipboardData.getData("Text"));else{var r=this;setTimeout(function(){r.handleInputChange(u.target.value)},100)}};es.prototype.handleInputChange=function(u){if(this.query=this.normalize(u),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates(function(r){for(var s=0;s<r.length&&(this.list.add(r[s]),s!==this.options.limit-1);s++);this.list.draw()}.bind(this))};es.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};es.prototype.update=function(u){this.data=u,this.handleKeyUp()};es.prototype.clear=function(){this.data=[],this.list.clear()};es.prototype.normalize=function(u){return u=u.toLowerCase(),u};es.prototype.match=function(u,r){return u.indexOf(r)>-1};es.prototype.value=function(u){if(this.selected=u,this.el.value=this.getItemValue(u),document.createEvent){var r=document.createEvent("HTMLEvents");r.initEvent("change",!0,!1),this.el.dispatchEvent(r)}else this.el.fireEvent("onchange")};es.prototype.getCandidates=function(u){var r={pre:"<strong>",post:"</strong>",extract:function(g){return this.getItemValue(g)}.bind(this)},s;this.options.filter?(s=VE.filter(this.query,this.data,r),s=s.map(function(g){return{original:g.original,string:this.render(g.original,g.string)}}.bind(this))):s=this.data.map(function(g){var w=this.render(g);return{original:g,string:w}}.bind(this)),u(s)};es.prototype.getItemValue=function(u){return u};es.prototype.render=function(u,r){if(r)return r;for(var s=u.original?this.getItemValue(u.original):this.getItemValue(u),g=this.normalize(s),w=g.lastIndexOf(this.query);w>-1;){var z=w+this.query.length;s=s.slice(0,w)+"<strong>"+s.slice(w,z)+"</strong>"+s.slice(z),w=g.slice(0,w).lastIndexOf(this.query)}return s};es.prototype.renderError=function(u){this.list.drawError(u)};var GE=es,Wv=GE,ZE=Wv;typeof window!="undefined"&&(window.Suggestions=Wv);var HE="Expected a function",Z_=0/0,WE="[object Symbol]",XE=/^\s+|\s+$/g,KE=/^[-+]0x[0-9a-f]+$/i,JE=/^0b[01]+$/i,$E=/^0o[0-7]+$/i,YE=parseInt,QE=typeof Rl=="object"&&Rl&&Rl.Object===Object&&Rl,eI=typeof self=="object"&&self&&self.Object===Object&&self,tI=QE||eI||Function("return this")(),iI=Object.prototype,rI=iI.toString,nI=Math.max,oI=Math.min,Iy=function(){return tI.Date.now()};function aI(u,r,s){var g,w,z,f,h,D,N=0,F=!1,G=!1,H=!0;if(typeof u!="function")throw new TypeError(HE);r=H_(r)||0,Xy(s)&&(F=!!s.leading,G="maxWait"in s,z=G?nI(H_(s.maxWait)||0,r):z,H="trailing"in s?!!s.trailing:H);function Pe(pt){var lt=g,fi=w;return g=w=void 0,N=pt,f=u.apply(fi,lt),f}function ke(pt){return N=pt,h=setTimeout(yt,r),F?Pe(pt):f}function We(pt){var lt=pt-D,fi=pt-N,Et=r-lt;return G?oI(Et,z-fi):Et}function je(pt){var lt=pt-D,fi=pt-N;return D===void 0||lt>=r||lt<0||G&&fi>=z}function yt(){var pt=Iy();if(je(pt))return Ne(pt);h=setTimeout(yt,We(pt))}function Ne(pt){return h=void 0,H&&g?Pe(pt):(g=w=void 0,f)}function Ze(){h!==void 0&&clearTimeout(h),N=0,g=D=w=h=void 0}function vt(){return h===void 0?f:Ne(Iy())}function ct(){var pt=Iy(),lt=je(pt);if(g=arguments,w=this,D=pt,lt){if(h===void 0)return ke(D);if(G)return h=setTimeout(yt,r),Pe(D)}return h===void 0&&(h=setTimeout(yt,r)),f}return ct.cancel=Ze,ct.flush=vt,ct}function Xy(u){var r=typeof u;return!!u&&(r=="object"||r=="function")}function sI(u){return!!u&&typeof u=="object"}function lI(u){return typeof u=="symbol"||sI(u)&&rI.call(u)==WE}function H_(u){if(typeof u=="number")return u;if(lI(u))return Z_;if(Xy(u)){var r=typeof u.valueOf=="function"?u.valueOf():u;u=Xy(r)?r+"":r}if(typeof u!="string")return u===0?u:+u;u=u.replace(XE,"");var s=JE.test(u);return s||$E.test(u)?YE(u.slice(2),s?2:8):KE.test(u)?Z_:+u}var uI=aI,bg={exports:{}},Op=typeof Reflect=="object"?Reflect:null,W_=Op&&typeof Op.apply=="function"?Op.apply:function(r,s,g){return Function.prototype.apply.call(r,s,g)},Ff;Op&&typeof Op.ownKeys=="function"?Ff=Op.ownKeys:Object.getOwnPropertySymbols?Ff=function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:Ff=function(r){return Object.getOwnPropertyNames(r)};function cI(u){console&&console.warn&&console.warn(u)}var Xv=Number.isNaN||function(r){return r!==r};function Ln(){Ln.init.call(this)}bg.exports=Ln;bg.exports.once=fI;Ln.EventEmitter=Ln;Ln.prototype._events=void 0;Ln.prototype._eventsCount=0;Ln.prototype._maxListeners=void 0;var X_=10;function fm(u){if(typeof u!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof u)}Object.defineProperty(Ln,"defaultMaxListeners",{enumerable:!0,get:function(){return X_},set:function(u){if(typeof u!="number"||u<0||Xv(u))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+u+".");X_=u}});Ln.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ln.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||Xv(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this};function Kv(u){return u._maxListeners===void 0?Ln.defaultMaxListeners:u._maxListeners}Ln.prototype.getMaxListeners=function(){return Kv(this)};Ln.prototype.emit=function(r){for(var s=[],g=1;g<arguments.length;g++)s.push(arguments[g]);var w=r==="error",z=this._events;if(z!==void 0)w=w&&z.error===void 0;else if(!w)return!1;if(w){var f;if(s.length>0&&(f=s[0]),f instanceof Error)throw f;var h=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw h.context=f,h}var D=z[r];if(D===void 0)return!1;if(typeof D=="function")W_(D,this,s);else for(var N=D.length,F=e0(D,N),g=0;g<N;++g)W_(F[g],this,s);return!0};function Jv(u,r,s,g){var w,z,f;if(fm(s),z=u._events,z===void 0?(z=u._events=Object.create(null),u._eventsCount=0):(z.newListener!==void 0&&(u.emit("newListener",r,s.listener?s.listener:s),z=u._events),f=z[r]),f===void 0)f=z[r]=s,++u._eventsCount;else if(typeof f=="function"?f=z[r]=g?[s,f]:[f,s]:g?f.unshift(s):f.push(s),w=Kv(u),w>0&&f.length>w&&!f.warned){f.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=u,h.type=r,h.count=f.length,cI(h)}return u}Ln.prototype.addListener=function(r,s){return Jv(this,r,s,!1)};Ln.prototype.on=Ln.prototype.addListener;Ln.prototype.prependListener=function(r,s){return Jv(this,r,s,!0)};function hI(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function $v(u,r,s){var g={fired:!1,wrapFn:void 0,target:u,type:r,listener:s},w=hI.bind(g);return w.listener=s,g.wrapFn=w,w}Ln.prototype.once=function(r,s){return fm(s),this.on(r,$v(this,r,s)),this};Ln.prototype.prependOnceListener=function(r,s){return fm(s),this.prependListener(r,$v(this,r,s)),this};Ln.prototype.removeListener=function(r,s){var g,w,z,f,h;if(fm(s),w=this._events,w===void 0)return this;if(g=w[r],g===void 0)return this;if(g===s||g.listener===s)--this._eventsCount===0?this._events=Object.create(null):(delete w[r],w.removeListener&&this.emit("removeListener",r,g.listener||s));else if(typeof g!="function"){for(z=-1,f=g.length-1;f>=0;f--)if(g[f]===s||g[f].listener===s){h=g[f].listener,z=f;break}if(z<0)return this;z===0?g.shift():pI(g,z),g.length===1&&(w[r]=g[0]),w.removeListener!==void 0&&this.emit("removeListener",r,h||s)}return this};Ln.prototype.off=Ln.prototype.removeListener;Ln.prototype.removeAllListeners=function(r){var s,g,w;if(g=this._events,g===void 0)return this;if(g.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):g[r]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete g[r]),this;if(arguments.length===0){var z=Object.keys(g),f;for(w=0;w<z.length;++w)f=z[w],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(s=g[r],typeof s=="function")this.removeListener(r,s);else if(s!==void 0)for(w=s.length-1;w>=0;w--)this.removeListener(r,s[w]);return this};function Yv(u,r,s){var g=u._events;if(g===void 0)return[];var w=g[r];return w===void 0?[]:typeof w=="function"?s?[w.listener||w]:[w]:s?dI(w):e0(w,w.length)}Ln.prototype.listeners=function(r){return Yv(this,r,!0)};Ln.prototype.rawListeners=function(r){return Yv(this,r,!1)};Ln.listenerCount=function(u,r){return typeof u.listenerCount=="function"?u.listenerCount(r):Qv.call(u,r)};Ln.prototype.listenerCount=Qv;function Qv(u){var r=this._events;if(r!==void 0){var s=r[u];if(typeof s=="function")return 1;if(s!==void 0)return s.length}return 0}Ln.prototype.eventNames=function(){return this._eventsCount>0?Ff(this._events):[]};function e0(u,r){for(var s=new Array(r),g=0;g<r;++g)s[g]=u[g];return s}function pI(u,r){for(;r+1<u.length;r++)u[r]=u[r+1];u.pop()}function dI(u){for(var r=new Array(u.length),s=0;s<r.length;++s)r[s]=u[s].listener||u[s];return r}function fI(u,r){return new Promise(function(s,g){function w(f){u.removeListener(r,z),g(f)}function z(){typeof u.removeListener=="function"&&u.removeListener("error",w),s([].slice.call(arguments))}t0(u,r,z,{once:!0}),r!=="error"&&mI(u,w,{once:!0})})}function mI(u,r,s){typeof u.on=="function"&&t0(u,"error",r,s)}function t0(u,r,s,g){if(typeof u.on=="function")g.once?u.once(r,s):u.on(r,s);else if(typeof u.addEventListener=="function")u.addEventListener(r,function w(z){g.once&&u.removeEventListener(r,w),s(z)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof u)}var yI={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};function gI(u){var r=u.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return r?{key:r[1],value:r[2]}:null}function _I(u){var r=u.match(/<?([^>]*)>(.*)/);if(!r)return null;var s=r[1],g=r[2].split(";"),w=null,z=g.reduce(function(f,h){var D=gI(h);return D?D.key==="rel"?(w||(w=D.value),f):(f[D.key]=D.value,f):f},{});return w?{url:s,rel:w,params:z}:null}function vI(u){return u?u.split(/,\s*</).reduce(function(r,s){var g=_I(s);if(!g)return r;var w=g.rel.split(/\s+/);return w.forEach(function(z){r[z]||(r[z]={url:g.url,params:g.params})}),r},{}):{}}var xI=vI,bI=xI;function wg(u,r){this.request=u,this.headers=r.headers,this.rawBody=r.body,this.statusCode=r.statusCode;try{this.body=JSON.parse(r.body||"{}")}catch{this.body=r.body}this.links=bI(this.headers.link)}wg.prototype.hasNextPage=function(){return!!this.links.next};wg.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null};var wI=wg,mm={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"},K_=mm;function EI(u){var r=u.type||K_.ERROR_HTTP,s;if(u.body)try{s=JSON.parse(u.body)}catch{s=u.body}else s=null;var g=u.message||null;g||(typeof s=="string"?g=s:s&&typeof s.message=="string"?g=s.message:r===K_.ERROR_REQUEST_ABORTED&&(g="Request aborted")),this.message=g,this.type=r,this.statusCode=u.statusCode||null,this.request=u.request,this.body=s}var II=EI;function SI(u){var r=u.indexOf(":"),s=u.substring(0,r).trim().toLowerCase(),g=u.substring(r+1).trim();return{name:s,value:g}}function TI(u){var r={};return u&&u.trim().split(/[\r|\n]+/).forEach(function(s){var g=SI(s);r[g.name]=g.value}),r}var AI=TI,CI=wI,J_=II,Sy=mm,kI=AI,Kf={};function zI(u){var r=Kf[u.id];!r||(r.abort(),delete Kf[u.id])}function PI(u,r){return new CI(u,{body:r.response,headers:kI(r.getAllResponseHeaders()),statusCode:r.status})}function $_(u){var r=u.total,s=u.loaded,g=100*s/r;return{total:r,transferred:s,percent:g}}function i0(u,r){return new Promise(function(s,g){r.onprogress=function(f){u.emitter.emit(Sy.EVENT_PROGRESS_DOWNLOAD,$_(f))};var w=u.file;w&&(r.upload.onprogress=function(f){u.emitter.emit(Sy.EVENT_PROGRESS_UPLOAD,$_(f))}),r.onerror=function(f){g(f)},r.onabort=function(){var f=new J_({request:u,type:Sy.ERROR_REQUEST_ABORTED});g(f)},r.onload=function(){if(delete Kf[u.id],r.status<200||r.status>=400){var f=new J_({request:u,body:r.response,statusCode:r.status});g(f);return}s(r)};var z=u.body;typeof z=="string"?r.send(z):z?r.send(JSON.stringify(z)):w?r.send(w):r.send(),Kf[u.id]=r}).then(function(s){return PI(u,s)})}function r0(u,r){var s=u.url(r),g=new window.XMLHttpRequest;return g.open(u.method,s),Object.keys(u.headers).forEach(function(w){g.setRequestHeader(w,u.headers[w])}),g}function MI(u){return Promise.resolve().then(function(){var r=r0(u,u.client.accessToken);return i0(u,r)})}var LI={browserAbort:zI,sendRequestXhr:i0,browserSend:MI,createRequestXhr:r0},Ky={exports:{}};/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */(function(u,r){(function(s){var g=r,w=u&&u.exports==g&&u,z=typeof Rl=="object"&&Rl;(z.global===z||z.window===z)&&(s=z);var f=function(ke){this.message=ke};f.prototype=new Error,f.prototype.name="InvalidCharacterError";var h=function(ke){throw new f(ke)},D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N=/[\t\n\f\r ]/g,F=function(ke){ke=String(ke).replace(N,"");var We=ke.length;We%4==0&&(ke=ke.replace(/==?$/,""),We=ke.length),(We%4==1||/[^+a-zA-Z0-9/]/.test(ke))&&h("Invalid character: the string to be decoded is not correctly encoded.");for(var je=0,yt,Ne,Ze="",vt=-1;++vt<We;)Ne=D.indexOf(ke.charAt(vt)),yt=je%4?yt*64+Ne:Ne,je++%4&&(Ze+=String.fromCharCode(255&yt>>(-2*je&6)));return Ze},G=function(ke){ke=String(ke),/[^\0-\xFF]/.test(ke)&&h("The string to be encoded contains characters outside of the Latin1 range.");for(var We=ke.length%3,je="",yt=-1,Ne,Ze,vt,ct,pt=ke.length-We;++yt<pt;)Ne=ke.charCodeAt(yt)<<16,Ze=ke.charCodeAt(++yt)<<8,vt=ke.charCodeAt(++yt),ct=Ne+Ze+vt,je+=D.charAt(ct>>18&63)+D.charAt(ct>>12&63)+D.charAt(ct>>6&63)+D.charAt(ct&63);return We==2?(Ne=ke.charCodeAt(yt)<<8,Ze=ke.charCodeAt(++yt),ct=Ne+Ze,je+=D.charAt(ct>>10)+D.charAt(ct>>4&63)+D.charAt(ct<<2&63)+"="):We==1&&(ct=ke.charCodeAt(yt),je+=D.charAt(ct>>2)+D.charAt(ct<<4&63)+"=="),je},H={encode:G,decode:F,version:"0.1.0"};if(g&&!g.nodeType)if(w)w.exports=H;else for(var Pe in H)H.hasOwnProperty(Pe)&&(g[Pe]=H[Pe]);else s.base64=H})(Rl)})(Ky,Ky.exports);var DI=Ky.exports,Ty={};function RI(u){if(Ty[u])return Ty[u];var r=u.split("."),s=r[0],g=r[1];if(!g)throw new Error("Invalid token");var w=BI(g),z={usage:s,user:w.u};return Xh(w,"a")&&(z.authorization=w.a),Xh(w,"exp")&&(z.expires=w.exp*1e3),Xh(w,"iat")&&(z.created=w.iat*1e3),Xh(w,"scopes")&&(z.scopes=w.scopes),Xh(w,"client")&&(z.client=w.client),Xh(w,"ll")&&(z.lastLogin=w.ll),Xh(w,"iu")&&(z.impersonator=w.iu),Ty[u]=z,z}function BI(u){try{return JSON.parse(DI.decode(u))}catch{throw new Error("Invalid token")}}function Xh(u,r){return Object.prototype.hasOwnProperty.call(u,r)}var n0=RI,o0={exports:{}};(function(u){var r=Object.prototype.hasOwnProperty,s="~";function g(){}Object.create&&(g.prototype=Object.create(null),new g().__proto__||(s=!1));function w(D,N,F){this.fn=D,this.context=N,this.once=F||!1}function z(D,N,F,G,H){if(typeof F!="function")throw new TypeError("The listener must be a function");var Pe=new w(F,G||D,H),ke=s?s+N:N;return D._events[ke]?D._events[ke].fn?D._events[ke]=[D._events[ke],Pe]:D._events[ke].push(Pe):(D._events[ke]=Pe,D._eventsCount++),D}function f(D,N){--D._eventsCount===0?D._events=new g:delete D._events[N]}function h(){this._events=new g,this._eventsCount=0}h.prototype.eventNames=function(){var N=[],F,G;if(this._eventsCount===0)return N;for(G in F=this._events)r.call(F,G)&&N.push(s?G.slice(1):G);return Object.getOwnPropertySymbols?N.concat(Object.getOwnPropertySymbols(F)):N},h.prototype.listeners=function(N){var F=s?s+N:N,G=this._events[F];if(!G)return[];if(G.fn)return[G.fn];for(var H=0,Pe=G.length,ke=new Array(Pe);H<Pe;H++)ke[H]=G[H].fn;return ke},h.prototype.listenerCount=function(N){var F=s?s+N:N,G=this._events[F];return G?G.fn?1:G.length:0},h.prototype.emit=function(N,F,G,H,Pe,ke){var We=s?s+N:N;if(!this._events[We])return!1;var je=this._events[We],yt=arguments.length,Ne,Ze;if(je.fn){switch(je.once&&this.removeListener(N,je.fn,void 0,!0),yt){case 1:return je.fn.call(je.context),!0;case 2:return je.fn.call(je.context,F),!0;case 3:return je.fn.call(je.context,F,G),!0;case 4:return je.fn.call(je.context,F,G,H),!0;case 5:return je.fn.call(je.context,F,G,H,Pe),!0;case 6:return je.fn.call(je.context,F,G,H,Pe,ke),!0}for(Ze=1,Ne=new Array(yt-1);Ze<yt;Ze++)Ne[Ze-1]=arguments[Ze];je.fn.apply(je.context,Ne)}else{var vt=je.length,ct;for(Ze=0;Ze<vt;Ze++)switch(je[Ze].once&&this.removeListener(N,je[Ze].fn,void 0,!0),yt){case 1:je[Ze].fn.call(je[Ze].context);break;case 2:je[Ze].fn.call(je[Ze].context,F);break;case 3:je[Ze].fn.call(je[Ze].context,F,G);break;case 4:je[Ze].fn.call(je[Ze].context,F,G,H);break;default:if(!Ne)for(ct=1,Ne=new Array(yt-1);ct<yt;ct++)Ne[ct-1]=arguments[ct];je[Ze].fn.apply(je[Ze].context,Ne)}}return!0},h.prototype.on=function(N,F,G){return z(this,N,F,G,!1)},h.prototype.once=function(N,F,G){return z(this,N,F,G,!0)},h.prototype.removeListener=function(N,F,G,H){var Pe=s?s+N:N;if(!this._events[Pe])return this;if(!F)return f(this,Pe),this;var ke=this._events[Pe];if(ke.fn)ke.fn===F&&(!H||ke.once)&&(!G||ke.context===G)&&f(this,Pe);else{for(var We=0,je=[],yt=ke.length;We<yt;We++)(ke[We].fn!==F||H&&!ke[We].once||G&&ke[We].context!==G)&&je.push(ke[We]);je.length?this._events[Pe]=je.length===1?je[0]:je:f(this,Pe)}return this},h.prototype.removeAllListeners=function(N){var F;return N?(F=s?s+N:N,this._events[F]&&f(this,F)):(this._events=new g,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=s,h.EventEmitter=h,u.exports=h})(o0);function OI(u){return u.map(encodeURIComponent).join(",")}function a0(u){return Array.isArray(u)?OI(u):encodeURIComponent(String(u))}function s0(u,r,s){if(s===!1||s===null)return u;var g=/\?/.test(u)?"&":"?",w=encodeURIComponent(r);return s!==void 0&&s!==""&&s!==!0&&(w+="="+a0(s)),""+u+g+w}function FI(u,r){if(!r)return u;var s=u;return Object.keys(r).forEach(function(g){var w=r[g];w!==void 0&&(Array.isArray(w)&&(w=w.filter(function(z){return z!=null}).join(",")),s=s0(s,g,w))}),s}function UI(u,r){if(!r||u.slice(0,4)==="http")return u;var s=u[0]==="/"?"":"/";return""+r.replace(/\/$/,"")+s+u}function NI(u,r){return r?u.replace(/\/:([a-zA-Z0-9]+)/g,function(s,g){var w=r[g];if(w===void 0)throw new Error("Unspecified route parameter "+g);var z=a0(w);return"/"+z}):u}var jI={appendQueryObject:FI,appendQueryParam:s0,prependOrigin:UI,interpolateRouteParams:NI},VI=n0,Eg=Wp,qI=o0.exports,Mf=jI,Y_=mm,GI=1;function _h(u,r){if(!u)throw new Error("MapiRequest requires a client");if(!r||!r.path||!r.method)throw new Error("MapiRequest requires an options object with path and method properties");var s={};r.body&&(s["content-type"]="application/json");var g=Eg(s,r.headers),w=Object.keys(g).reduce(function(z,f){return z[f.toLowerCase()]=g[f],z},{});this.id=GI++,this._options=r,this.emitter=new qI,this.client=u,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=r.path,this.method=r.method,this.origin=r.origin||u.origin,this.query=r.query||{},this.params=r.params||{},this.body=r.body||null,this.file=r.file||null,this.encoding=r.encoding||"utf8",this.sendFileAs=r.sendFileAs||null,this.headers=w}_h.prototype.url=function(r){var s=Mf.prependOrigin(this.path,this.origin);s=Mf.appendQueryObject(s,this.query);var g=this.params,w=r==null?this.client.accessToken:r;if(w){s=Mf.appendQueryParam(s,"access_token",w);var z=VI(w).user;g=Eg({ownerId:z},g)}return s=Mf.interpolateRouteParams(s,g),s};_h.prototype.send=function(){var r=this;if(r.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return r.sent=!0,r.client.sendRequest(r).then(function(s){return r.response=s,r.emitter.emit(Y_.EVENT_RESPONSE,s),s},function(s){throw r.error=s,r.emitter.emit(Y_.EVENT_ERROR,s),s})};_h.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))};_h.prototype.eachPage=function(r){var s=this;function g(f){function h(){delete s._nextPageRequest;var D=f.nextPage();D&&(s._nextPageRequest=D,z(D))}r(null,f,h)}function w(f){r(f,null,function(){})}function z(f){f.send().then(g,w)}z(this)};_h.prototype.clone=function(){return this._extend()};_h.prototype._extend=function(r){var s=Eg(this._options,r);return new _h(this.client,s)};var ZI=_h,HI=n0,WI=ZI,XI=mm;function l0(u){if(!u||!u.accessToken)throw new Error("Cannot create a client without an access token");HI(u.accessToken),this.accessToken=u.accessToken,this.origin=u.origin||XI.API_ORIGIN}l0.prototype.createRequest=function(r){return new WI(this,r)};var u0=l0,c0=LI,h0=u0;function Vp(u){h0.call(this,u)}Vp.prototype=Object.create(h0.prototype);Vp.prototype.constructor=Vp;Vp.prototype.sendRequest=c0.browserSend;Vp.prototype.abortRequest=c0.browserAbort;function KI(u){return new Vp(u)}var p0=KI,JI=p0,$I=JI,YI=Object.prototype.toString,QI=function(u){var r;return YI.call(u)==="[object Object]"&&(r=Object.getPrototypeOf(u),r===null||r===Object.getPrototypeOf({}))},eS=QI,tS=Wp,d0="value",Ay=`
  `,qn={};qn.assert=function(u,r){return r=r||{},function(s){var g=vh(u,s);if(!!g){var w=Ig(g,r);throw r.apiName&&(w=r.apiName+": "+w),new Error(w)}}};qn.shape=function(r){var s=oS(r);return function(w){var z=vh(qn.plainObject,w);if(z)return z;for(var f,h,D=[],N=0;N<s.length;N++)f=s[N].key,h=s[N].value,z=vh(h,w[f]),z&&D.push([f].concat(z));return D.length<2?D[0]:function(F){D=D.map(function(Pe){var ke=Pe[0],We=Ig(Pe,F).split(`
`).join(Ay);return"- "+ke+": "+We});var G=F.path.join("."),H=G===d0?"":" of "+G;return"The following properties"+H+" have invalid values:"+Ay+D.join(Ay)}}};qn.strictShape=function(r){var s=qn.shape(r);return function(w){var z=s(w);if(z)return z;var f=Object.keys(w).reduce(function(h,D){return r[D]===void 0&&h.push(D),h},[]);if(f.length!==0)return function(){return"The following keys are invalid: "+f.join(", ")}}};qn.arrayOf=function(r){return f0(r)};qn.tuple=function(){var r=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return f0(r)};function f0(u){var r=Array.isArray(u),s=function(g){return r?u[g]:u};return function(w){var z=vh(qn.plainArray,w);if(z)return z;if(r&&w.length!==u.length)return"an array with "+u.length+" items";for(var f=0;f<w.length;f++)if(z=vh(s(f),w[f]),z)return[f].concat(z)}}qn.required=function(r){function s(g){return g==null?function(w){return m0(w,y0(w.path)?"cannot be undefined/null.":"is required.")}:r.apply(this,arguments)}return s.__required=!0,s};qn.oneOfType=function(){var r=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(g){var w=r.map(function(z){return vh(z,g)}).filter(Boolean);if(w.length===r.length)return w.every(function(z){return z.length===1&&typeof z[0]=="string"})?iS(w.map(function(z){return z[0]})):w.reduce(function(z,f){return f.length>z.length?f:z})}};qn.equal=function(r){return function(g){if(g!==r)return JSON.stringify(r)}};qn.oneOf=function(){var r=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),s=r.map(function(g){return qn.equal(g)});return qn.oneOfType.apply(this,s)};qn.range=function(r){var s=r[0],g=r[1];return function(z){var f=vh(qn.number,z);if(f||z<s||z>g)return"number between "+s+" & "+g+" (inclusive)"}};qn.any=function(){};qn.boolean=function(r){if(typeof r!="boolean")return"boolean"};qn.number=function(r){if(typeof r!="number")return"number"};qn.plainArray=function(r){if(!Array.isArray(r))return"array"};qn.plainObject=function(r){if(!eS(r))return"object"};qn.string=function(r){if(typeof r!="string")return"string"};qn.func=function(r){if(typeof r!="function")return"function"};function vh(u,r){if(!(r==null&&!u.hasOwnProperty("__required"))){var s=u(r);if(s)return Array.isArray(s)?s:[s]}}function Ig(u,r){var s=u.length,g=u[s-1],w=u.slice(0,s-1);return w.length===0&&(w=[d0]),r=tS(r,{path:w}),typeof g=="function"?g(r):m0(r,rS(g))}function iS(u){return u.length<2?u[0]:u.length===2?u.join(" or "):u.slice(0,-1).join(", ")+", or "+u.slice(-1)}function rS(u){return"must be "+nS(u)+"."}function nS(u){return/^an? /.test(u)?u:/^[aeiou]/i.test(u)?"an "+u:/^[a-z]/i.test(u)?"a "+u:u}function m0(u,r){var s=y0(u.path),g=u.path.join(".")+" "+r,w=s?"Item at position ":"";return w+g}function y0(u){return typeof u[u.length-1]=="number"||typeof u[0]=="number"}function oS(u){return Object.keys(u||{}).map(function(r){return{key:r,value:u[r]}})}qn.validate=vh;qn.processMessage=Ig;var aS=qn,sS=Wp,Fp=aS;function lS(u){if(typeof window!="undefined")return u instanceof Rl.Blob||u instanceof Rl.ArrayBuffer?void 0:"Blob or ArrayBuffer";if(!(typeof u=="string"||u.pipe!==void 0))return"Filename or Readable stream"}function uS(u,r){return Fp.assert(Fp.strictShape(u),r)}function cS(u){var r="date";if(typeof u=="boolean")return r;try{var s=new Date(u);if(s.getTime&&isNaN(s.getTime()))return r}catch{return r}}function hS(u){return Fp.tuple(Fp.number,Fp.number)(u)}var pS=sS(Fp,{file:lS,date:cS,coordinates:hS,assertShape:uS});function dS(u,r){var s=function(g,w){return r.indexOf(g)!==-1&&w!==void 0};return typeof r=="function"&&(s=r),Object.keys(u).filter(function(g){return s(g,u[g])}).reduce(function(g,w){return g[w]=u[w],g},{})}var fS=dS;function mS(u,r){return Object.keys(u).reduce(function(s,g){return s[g]=r(g,u[g]),s},{})}var yS=mS,gS=yS;function _S(u){return gS(u,function(r,s){return typeof s=="boolean"?JSON.stringify(s):s})}var vS=_S,xS=u0,bS=p0;function wS(u){return function(r){var s;xS.prototype.isPrototypeOf(r)?s=r:s=bS(r);var g=Object.create(u);return g.client=s,g}}var ES=wS,g0=Wp,tn=pS,Jf=fS,_0=vS,IS=ES,Sg={},v0=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];Sg.forwardGeocode=function(u){tn.assertShape({query:tn.required(tn.string),mode:tn.oneOf("mapbox.places","mapbox.places-permanent"),countries:tn.arrayOf(tn.string),proximity:tn.oneOf(tn.coordinates,"ip"),types:tn.arrayOf(tn.oneOf(v0)),autocomplete:tn.boolean,bbox:tn.arrayOf(tn.number),limit:tn.number,language:tn.arrayOf(tn.string),routing:tn.boolean,fuzzyMatch:tn.boolean,worldview:tn.string})(u),u.mode=u.mode||"mapbox.places";var r=_0(g0({country:u.countries},Jf(u,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Jf(u,["mode","query"]),query:r})};Sg.reverseGeocode=function(u){tn.assertShape({query:tn.required(tn.coordinates),mode:tn.oneOf("mapbox.places","mapbox.places-permanent"),countries:tn.arrayOf(tn.string),types:tn.arrayOf(tn.oneOf(v0)),bbox:tn.arrayOf(tn.number),limit:tn.number,language:tn.arrayOf(tn.string),reverseMode:tn.oneOf("distance","score"),routing:tn.boolean,worldview:tn.string})(u),u.mode=u.mode||"mapbox.places";var r=_0(g0({country:u.countries},Jf(u,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Jf(u,["mode","query"]),query:r})};var SS=IS(Sg);let TS="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",x0=u=>crypto.getRandomValues(new Uint8Array(u)),b0=(u,r,s)=>{let g=(2<<Math.log(u.length-1)/Math.LN2)-1,w=-~(1.6*g*r/u.length);return(z=r)=>{let f="";for(;;){let h=s(w),D=w;for(;D--;)if(f+=u[h[D]&g]||"",f.length===z)return f}}},AS=(u,r=21)=>b0(u,r,x0),CS=(u=21)=>{let r="",s=crypto.getRandomValues(new Uint8Array(u));for(;u--;){let g=s[u]&63;g<36?r+=g.toString(36):g<62?r+=(g-26).toString(36).toUpperCase():g<63?r+="_":r+="-"}return r};var kS=Object.freeze(Object.defineProperty({__proto__:null,nanoid:CS,customAlphabet:AS,customRandom:b0,urlAlphabet:TS,random:x0},Symbol.toStringTag,{value:"Module"})),zS=BE(kS),PS=zS.nanoid;function w0(u){this.origin=u.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=u.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=u,this.send=this.send.bind(this),this.countries=u.countries?u.countries.split(","):null,this.types=u.types?u.types.split(","):null,this.bbox=u.bbox?u.bbox:null,this.language=u.language?u.language.split(","):null,this.limit=u.limit?+u.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(u),this.eventQueue=new Array,this.flushInterval=u.flushInterval||1e3,this.maxQueueSize=u.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}w0.prototype={select:function(u,r){var s=this.getSelectedIndex(u,r),g=this.getEventPayload("search.select",r);if(g.resultIndex=s,g.resultPlaceName=u.place_name,g.resultId=u.id,!(s===this.lastSentIndex&&g.queryString===this.lastSentInput||s==-1)&&(this.lastSentIndex=s,this.lastSentInput=g.queryString,!!g.queryString))return this.push(g)},start:function(u){var r=this.getEventPayload("search.start",u);if(!!r.queryString)return this.push(r)},keyevent:function(u,r){if(!!u.key&&!(u.metaKey||[9,27,37,39,13,38,40].indexOf(u.keyCode)!==-1)){var s=this.getEventPayload("search.keystroke",r);if(s.lastAction=u.key,!!s.queryString)return this.push(s)}},send:function(u,r){if(!this.enableEventLogging)return r?r():void 0;var s=this.getRequestOptions(u);this.request(s,function(g){if(g)return this.handleError(g,r);if(r)return r()}.bind(this))},getRequestOptions:function(u){Array.isArray(u)||(u=[u]);var r={method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(u)};return r},getEventPayload:function(u,r){var s;r.options.proximity?typeof r.options.proximity=="object"?s=[r.options.proximity.longitude,r.options.proximity.latitude]:r.options.proximity==="ip"?s=[999,999]:s=r.options.proximity:s=null;var g=r._map?r._map.getZoom():void 0,w={event:u,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:r.options.autocomplete,fuzzyMatch:r.options.fuzzyMatch,proximity:s,limit:r.options.limit,routing:r.options.routing,worldview:r.options.worldview,mapZoom:g,keyboardLocale:this.locale};return u==="search.select"?w.queryString=r.inputString:u!="search.select"&&r._inputEl?w.queryString=r._inputEl.value:w.queryString=r.inputString,w},request:function(u,r){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(this.readyState==4)return this.status==204?r(null):r(this.statusText)},s.open(u.method,u.host+"/"+u.path,!0);for(var g in u.headers){var w=u.headers[g];s.setRequestHeader(g,w)}s.send(u.body)},handleError:function(u,r){if(r)return r(u)},generateSessionID:function(){return PS()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(u,r){if(!!r._typeahead){var s=r._typeahead.data,g=u.id,w=s.map(function(f){return f.id}),z=w.indexOf(g);return z}},shouldEnableLogging:function(u){return!(u.enableEventLogging===!1||u.origin&&u.origin.indexOf("api.mapbox.com")==-1||u.localGeocoder||u.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(u,r){this.eventQueue.push(u),(this.eventQueue.length>=this.maxQueueSize||r)&&this.flush()},remove:function(){this.flush()}};var MS=w0,LS={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05DC\u05D7\u05E4\u05E9",ja:"\u30B5\u30FC\u30C1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041F\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641C\u7D22",cs:"Vyhled\xE1v\xE1n\xED",hu:"Keres\xE9s",ka:"\u10EB\u10D8\u10D4\u10D1\u10D0",nb:"S\xF8ke",sk:"Vyh\u013Ead\xE1vanie",th:"\u0E04\u0E49\u0E19\u0E2B\u0E32",fi:"Hae",is:"Leita",ko:"\uC218\uC0C9",pl:"Szukaj",sl:"Iskanje",fa:"\u062C\u0633\u062A\u062C\u0648",ru:"\u041F\u043E\u0438\u0441\u043A"},DS={placeholder:LS},E0={exports:{}};(function(u){(function(r,s,g){u.exports?u.exports=g():r[s]=g()})(Rl,"subtag",function(){var r="",s=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function g(D){return D.match(s)||[]}function w(D){return g(D).filter(function(N,F){return N&&F})}function z(D){return D=g(D),{language:D[1]||r,extlang:D[2]||r,script:D[3]||r,region:D[4]||r}}function f(D,N,F){Object.defineProperty(D,N,{value:F,enumerable:!0})}function h(D,N,F){function G(H){return g(H)[D]||r}f(G,"pattern",N),f(z,F,G)}return h(1,/^[a-zA-Z]{2,3}$/,"language"),h(2,/^[a-zA-Z]{3}$/,"extlang"),h(3,/^[a-zA-Z]{4}$/,"script"),h(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),f(z,"split",w),z})})(E0);function I0(){}I0.prototype={isSupport:function(){return Boolean(window.navigator.geolocation)},getCurrentPosition:function(){const u={enableHighAccuracy:!0};return new Promise(function(r,s){window.navigator.geolocation.getCurrentPosition(r,s,u)})}};var RS=I0;function BS(u,r){const s=S0(u),g=["address","street","place","country"];var w;if(typeof r=="function")return r(s);const z=g.indexOf(r);return z===-1?w=g:w=g.slice(z),w.reduce(function(f,h){return s[h]?(f!==""&&(f=f+", "),f+s[h]):f},"")}function S0(u){const r=u.address||"",s=u.text||"",g=u.place_name||"",z={address:g.split(",")[0],houseNumber:r,street:s,placeName:g};return u.context.forEach(function(f){const h=f.id.split(".")[0];z[h]=f.text}),z}var OS={transformFeatureToGeolocationText:BS,getAddressInfo:S0},FS=ZE,US=uI,Kh=Wp,NS=bg.exports.EventEmitter,Q_=yI,Cy=$I,ky=SS,jS=MS,VS=DS,qS=E0.exports,GS=RS,ZS=OS;const dh={FORWARD:0,LOCAL:1,REVERSE:2};function HS(){var u=document.createElement("div");return u.className="mapboxgl-ctrl-geocoder--powered-by",u.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',u}function T0(u){this._eventEmitter=new NS,this.options=Kh({},this.options,u),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new GS}T0.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(u){return u.place_name},render:function(u){var r=u.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+r[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+r.splice(1,r.length).join(",")+"</div></div>"}},addTo:function(u){function r(s,g){if(!document.body.contains(g))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const w=s.onAdd();g.appendChild(w)}if(u._controlContainer)u.addControl(this);else if(u instanceof HTMLElement)r(this,u);else if(typeof u=="string"){const s=document.querySelectorAll(u);if(s.length===0)throw new Error("Element ",u,"not found.");if(s.length>1)throw new Error("Geocoder can only be added to a single html element");r(this,s[0])}else throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(u){if(u&&typeof u!="string"&&(this._map=u),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=ky(Cy({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new jS(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var r=this.container=document.createElement("div");r.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var s=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",US(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",function(N){this.eventManager.keyevent(N,this)}.bind(this));var g=document.createElement("div");g.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var w=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(w),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),g.appendChild(this._clearEl),g.appendChild(this._loadingEl),r.appendChild(s),r.appendChild(this._inputEl),r.appendChild(g),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var z=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(z),g.appendChild(this._geolocateEl),this._showGeolocateButton()}var f=this._typeahead=new FS(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),f.getItemValue=this.options.getItemValue;var h=f.list.draw,D=this._footerNode=HS();return f.list.draw=function(){h.call(this),D.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),D.addEventListener("mouseup",function(){this.selectingListItem=!1}.bind(this)),this.element.appendChild(D)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),r},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then(function(u){this._hideLoadingIcon();const r={geometry:{type:"Point",coordinates:[u.coords.longitude,u.coords.latitude]}};this._handleMarker(r),this._fly(r),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(r),this._showClearButton(),this.fresh=!1;const s={limit:1,language:[this.options.language],query:r.geometry.coordinates,types:["address"]};if(this.options.localGeocoderOnly){const g=r.geometry.coordinates[0]+","+r.geometry.coordinates[1];this._setInputValue(g),this._eventEmitter.emit("result",{result:r})}else this.geocoderService.reverseGeocode(s).send().then(function(g){const w=g.body.features[0];if(w){const z=ZS.transformFeatureToGeolocationText(w,this.options.addressAccuracy);this._setInputValue(z),w.user_coordinates=r.geometry.coordinates,this._eventEmitter.emit("result",{result:w})}else this._eventEmitter.emit("result",{result:{user_coordinates:r.geometry.coordinates}})}.bind(this))}.bind(this)).catch(function(u){u.code===1?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}.bind(this))},createIcon:function(u,r){var s=document.createElementNS("http://www.w3.org/2000/svg","svg");return s.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+u),s.setAttribute("viewBox","0 0 18 18"),s.setAttribute("xml:space","preserve"),s.setAttribute("width",18),s.setAttribute("height",18),s.innerHTML=r,s},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(u){this._inputEl.value=u,setTimeout(function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}.bind(this),1)},_onPaste:function(u){var r=(u.clipboardData||window.clipboardData).getData("text");r.length>=this.options.minLength&&this._geocode(r)},_onKeyDown:function(u){var r=27,s=9;if(u.keyCode===r&&this.options.clearAndBlurOnEsc)return this._clear(u),this._inputEl.blur();var g=u.target&&u.target.shadowRoot?u.target.shadowRoot.activeElement:u.target,w=g?g.value:"";if(!w)return this.fresh=!0,u.keyCode!==s&&this.clear(u),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!(u.metaKey||[s,r,37,39,13,38,40].indexOf(u.keyCode)!==-1)&&g.value.length>=this.options.minLength&&this._geocode(g.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(u){this.options.clearOnBlur&&this._clearOnBlur(u),this.options.collapsed&&this._collapse()},_onChange:function(){var u=this._typeahead.selected;u&&JSON.stringify(u)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(u),this.options.marker&&this._mapboxgl&&this._handleMarker(u),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(u),this._eventEmitter.emit("result",{result:u}),this.eventManager.select(u,this))},_fly:function(u){var r;if(u.properties&&Q_[u.properties.short_code])r=Kh({},this.options.flyTo),this._map&&this._map.fitBounds(Q_[u.properties.short_code].bbox,r);else if(u.bbox){var s=u.bbox;r=Kh({},this.options.flyTo),this._map&&this._map.fitBounds([[s[0],s[1]],[s[2],s[3]]],r)}else{var g={zoom:this.options.zoom};r=Kh({},g,this.options.flyTo),u.center?r.center=u.center:u.geometry&&u.geometry.type&&u.geometry.type==="Point"&&u.geometry.coordinates&&(r.center=u.geometry.coordinates),this._map&&this._map.flyTo(r)}},_requestType:function(u,r){var s;const g=/^[ ]*(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/;return u.localGeocoderOnly?s=dh.LOCAL:u.reverseGeocode&&g.test(r)?s=dh.REVERSE:s=dh.FORWARD,s},_setupConfig:function(u,r){const s=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"],g=/[\s,]+/;var w=this,z=s.reduce(function(h,D){if(w.options[D]===void 0||w.options[D]===null)return h;["countries","types","language"].indexOf(D)>-1?h[D]=w.options[D].split(g):h[D]=w.options[D];const N=typeof w.options[D].longitude=="number"&&typeof w.options[D].latitude=="number";if(D==="proximity"&&N){const F=w.options[D].longitude,G=w.options[D].latitude;h[D]=[F,G]}return h},{});switch(u){case dh.REVERSE:{var f=r.split(g).map(function(h){return parseFloat(h,10)});w.options.flipCoordinates||f.reverse(),z.types&&z.types[0],z=Kh(z,{query:f,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(h){h in z&&delete z[h]})}break;case dh.FORWARD:/^[ ]*(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)*[ ]*$/.test(r)&&(r=r.replace(/,/g," ")),z=Kh(z,{query:r});break}return z},_geocode:function(u){this.inputString=u,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:u});const r=this._requestType(this.options,u),s=this._setupConfig(r,u);var g;switch(r){case dh.LOCAL:g=Promise.resolve();break;case dh.FORWARD:g=this.geocoderService.forwardGeocode(s).send();break;case dh.REVERSE:g=this.geocoderService.reverseGeocode(s).send();break}var w=this.options.localGeocoder?this.options.localGeocoder(u)||[]:[],z=[],f=null;return g.catch(function(h){f=h}.bind(this)).then(function(h){this._hideLoadingIcon();var D={};return h?h.statusCode=="200"&&(D=h.body,D.request=h.request,D.headers=h.headers):D={type:"FeatureCollection",features:[]},D.config=s,this.fresh&&(this.eventManager.start(this),this.fresh=!1),D.features=D.features?w.concat(D.features):w,this.options.externalGeocoder?(z=this.options.externalGeocoder(u,D.features)||Promise.resolve([]),z.then(function(N){return D.features=D.features?N.concat(D.features):N,D},function(){return D})):D}.bind(this)).then(function(h){if(f)throw f;this.options.filter&&h.features.length&&(h.features=h.features.filter(this.options.filter)),h.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",h),this._typeahead.update(h.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",h))}.bind(this)).catch(function(h){this._hideLoadingIcon(),this._hideAttribution(),w.length&&this.options.localGeocoder||z.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(w)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:w}),this._eventEmitter.emit("error",{error:h})}.bind(this)),g},_clear:function(u){u&&u.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(u){this._clear(u),this._inputEl.focus()},_clearOnBlur:function(u){var r=this;u.relatedTarget&&r._clear(u)},_onQueryResult:function(u){var r=u.body;if(!!r.features.length){var s=r.features[0];this._typeahead.selected=s,this._inputEl.value=s.place_name,this._onChange()}},_updateProximity:function(){if(!(!this._map||!this.options.trackProximity))if(this._map.getZoom()>9){var u=this._map.getCenter().wrap();this.setProximity({longitude:u.lng,latitude:u.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(u){return this._geocode(u).then(this._onQueryResult),this},_renderError:function(){var u="<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(u)},_renderLocationError:function(){var u="<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>";this._renderMessage(u)},_renderNoResults:function(){var u="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>";this._renderMessage(u)},_renderUserDeniedGeolocationError:function(){var u="<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>";this._renderMessage(u)},_renderMessage:function(u){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(u)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var u=this.options.language.split(",")[0],r=qS.language(u),s=VS.placeholder[r];if(s)return s}return"Search"},setInput:function(u){return this._inputEl.value=u,this._typeahead.selected=null,this._typeahead.clear(),u.length>=this.options.minLength&&this._geocode(u),this},setProximity:function(u,r=!0){return this.options.proximity=u,r&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(u){return u&&typeof u=="function"&&(this._typeahead.render=u),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(u){var r=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=u||this.options.language||r,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(u){return this.options.zoom=u,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(u){return this.options.flyTo=u,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(u){return this.placeholder=u||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(u){return this.options.bbox=u,this},getCountries:function(){return this.options.countries},setCountries:function(u){return this.options.countries=u,this},getTypes:function(){return this.options.types},setTypes:function(u){return this.options.types=u,this},getMinLength:function(){return this.options.minLength},setMinLength:function(u){return this.options.minLength=u,this._typeahead&&(this._typeahead.options.minLength=u),this},getLimit:function(){return this.options.limit},setLimit:function(u){return this.options.limit=u,this._typeahead&&(this._typeahead.options.limit=u),this},getFilter:function(){return this.options.filter},setFilter:function(u){return this.options.filter=u,this},setOrigin:function(u){return this.options.origin=u,this.geocoderService=ky(Cy({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(u){return this.options.accessToken=u,this.geocoderService=ky(Cy({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(u){return this.options.autocomplete=u,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(u){return this.options.fuzzyMatch=u,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(u){return this.options.routing=u,this},getRouting:function(){return this.options.routing},setWorldview:function(u){return this.options.worldview=u,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(u){if(!!this._map){this._removeMarker();var r={color:"#4668F2"},s=Kh({},r,this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(s),u.center?this.mapMarker.setLngLat(u.center).addTo(this._map):u.geometry&&u.geometry.type&&u.geometry.type==="Point"&&u.geometry.coordinates&&this.mapMarker.setLngLat(u.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(u,r){return this._eventEmitter.on(u,r),this},off:function(u,r){return this._eventEmitter.removeListener(u,r),this.eventManager.remove(),this}};var WS=T0,A0={};Object.defineProperty(A0,"__esModule",{value:!0});class gh{constructor(r,s){this.areas=r||gh.DEFAULT_AREAS,this.limit_no_areas=s||gh.DEFAULT_NO_AREAS,this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}onAdd(r){this.map=r;const s=this;if(this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.areas.length<=this.limit_no_areas){this.mapAreaContainer=document.createElement("div"),this.areaButton=document.createElement("button"),this.mapAreaContainer.classList.add("mapboxgl-area-list");for(const g of this.areas){const w=document.createElement("button");w.innerText=g.title,w.classList.add(g.title.replace(/[^a-z0-9-]/gi,"_")),w.value=JSON.stringify({center:g.latlng,zoom:g.zoom}),w.addEventListener("click",z=>{const f=z.srcElement;this.map.jumpTo(JSON.parse(f.value)),this.mapAreaContainer.style.display="none",this.areaButton.style.display="block";const h=this.mapAreaContainer.getElementsByClassName("active");for(;h[0];)h[0].classList.remove("active");f.classList.add("active")}),g.title===gh.DEFAULT_AREA&&w.classList.add("active"),this.mapAreaContainer.appendChild(w)}this.areaButton.classList.add("mapboxgl-ctrl-icon"),this.areaButton.classList.add("mapboxgl-area-switcher"),this.areaButton.addEventListener("click",()=>{this.areaButton.style.display="none",this.mapAreaContainer.style.display="block"}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.areaButton),this.controlContainer.appendChild(this.mapAreaContainer)}else this.controlContainer.classList.add("mapboxgl-ctrl-area-switch"),this.select=document.createElement("select"),this.select.setAttribute("type","select"),this.select.addEventListener("change",function(g){!g.target||s.map.flyTo(JSON.parse(g.target[this.selectedIndex].value))}),this.controlContainer.appendChild(this.select),this.areas.forEach(function(g){var w=document.createElement("option");w.setAttribute("type","option"),w.text=g.title,w.value=JSON.stringify({center:g.latlng,zoom:g.zoom}),s.select.appendChild(w)});return this.controlContainer}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.areaButton||(this.areaButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.map=void 0)}onDocumentClick(r){this.controlContainer&&!this.controlContainer.contains(r.target)&&this.mapAreaContainer&&this.areaButton&&(this.mapAreaContainer.style.display="none",this.areaButton.style.display="block")}}var XS=A0.default=gh;gh.DEFAULT_AREA="Narok";gh.DEFAULT_AREAS=[{title:"Narok",latlng:[35.86974,-1.08707],zoom:13},{title:"Nairobi",latlng:[36.8034,-1.2809],zoom:11},{title:"Mombasa",latlng:[39.65449,-4.05099],zoom:12}];gh.DEFAULT_NO_AREAS=5;var C0={},Tg={exports:{}};(function(u,r){(function(s,g){u.exports=g()})(Rl,function(){var s,g,w;function z(f,h){if(!s)s=h;else if(!g)g=h;else{var D="var sharedChunk = {}; ("+s+")(sharedChunk); ("+g+")(sharedChunk);",N={};s(N),w=h(N),typeof window!="undefined"&&(w.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}return z(["exports"],function(f){function h(e,n){return e(n={exports:{}},n.exports),n.exports}var D=N;function N(e,n,l,v){this.cx=3*e,this.bx=3*(l-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(v-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=v,this.p2x=l,this.p2y=v}N.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},N.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},N.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},N.prototype.solveCurveX=function(e,n){var l,v,E,C,i;for(n===void 0&&(n=1e-6),E=e,i=0;i<8;i++){if(C=this.sampleCurveX(E)-e,Math.abs(C)<n)return E;var t=this.sampleCurveDerivativeX(E);if(Math.abs(t)<1e-6)break;E-=C/t}if((E=e)<(l=0))return l;if(E>(v=1))return v;for(;l<v;){if(C=this.sampleCurveX(E),Math.abs(C-e)<n)return E;e>C?l=E:v=E,E=.5*(v-l)+l}return E},N.prototype.solve=function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))};var F=G;function G(e,n){this.x=e,this.y=n}G.prototype={clone:function(){return new G(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,n){return this.clone()._rotateAround(e,n)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var n=e.x-this.x,l=e.y-this.y;return n*n+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,n){return Math.atan2(this.x*n-this.y*e,this.x*e+this.y*n)},_matMult:function(e){var n=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=n,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var n=Math.cos(e),l=Math.sin(e),v=l*this.x+n*this.y;return this.x=n*this.x-l*this.y,this.y=v,this},_rotateAround:function(e,n){var l=Math.cos(e),v=Math.sin(e),E=n.y+v*(this.x-n.x)+l*(this.y-n.y);return this.x=n.x+l*(this.x-n.x)-v*(this.y-n.y),this.y=E,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},G.convert=function(e){return e instanceof G?e:Array.isArray(e)?new G(e[0],e[1]):e};var H=typeof self!="undefined"?self:{},Pe=Math.pow(2,53)-1;function ke(e,n,l,v){var E=new D(e,n,l,v);return function(C){return E.solve(C)}}var We=ke(.25,.1,.25,1);function je(e,n,l){return Math.min(l,Math.max(n,e))}function yt(e,n,l){var v=l-n,E=((e-n)%v+v)%v+n;return E===n?l:E}function Ne(e){for(var n=[],l=arguments.length-1;l-- >0;)n[l]=arguments[l+1];for(var v=0,E=n;v<E.length;v+=1){var C=E[v];for(var i in C)e[i]=C[i]}return e}var Ze=1;function vt(){return Ze++}function ct(){return function e(n){return n?(n^16*Math.random()>>n/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function pt(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function lt(e,n){e.forEach(function(l){n[l]&&(n[l]=n[l].bind(n))})}function fi(e,n){return e.indexOf(n,e.length-n.length)!==-1}function Et(e,n,l){var v={};for(var E in e)v[E]=n.call(l||this,e[E],E,e);return v}function Wt(e,n,l){var v={};for(var E in e)n.call(l||this,e[E],E,e)&&(v[E]=e[E]);return v}function Ei(e){return Array.isArray(e)?e.map(Ei):typeof e=="object"&&e?Et(e,Ei):e}var qi={};function Xt(e){qi[e]||(typeof console!="undefined"&&console.warn(e),qi[e]=!0)}function Qt(e,n,l){return(l.y-e.y)*(n.x-e.x)>(n.y-e.y)*(l.x-e.x)}function Ai(e){for(var n=0,l=0,v=e.length,E=v-1,C=void 0,i=void 0;l<v;E=l++)n+=((i=e[E]).x-(C=e[l]).x)*(C.y+i.y);return n}function bt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Gi(e){var n={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(v,E,C,i){var t=C||i;return n[E]=!t||t.toLowerCase(),""}),n["max-age"]){var l=parseInt(n["max-age"],10);isNaN(l)?delete n["max-age"]:n["max-age"]=l}return n}var mr=null;function Ar(e){if(mr==null){var n=e.navigator?e.navigator.userAgent:null;mr=!!e.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return mr}function Rt(e){try{var n=H[e];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}}var ai,yi,Fi,jt,Xi=H.performance&&H.performance.now?H.performance.now.bind(H.performance):Date.now.bind(Date),Ri=H.requestAnimationFrame||H.mozRequestAnimationFrame||H.webkitRequestAnimationFrame||H.msRequestAnimationFrame,Ii=H.cancelAnimationFrame||H.mozCancelAnimationFrame||H.webkitCancelAnimationFrame||H.msCancelAnimationFrame,rr={now:Xi,frame:function(e){var n=Ri(e);return{cancel:function(){return Ii(n)}}},getImageData:function(e,n){n===void 0&&(n=0);var l=H.document.createElement("canvas"),v=l.getContext("2d");if(!v)throw new Error("failed to create canvas 2d context");return l.width=e.width,l.height=e.height,v.drawImage(e,0,0,e.width,e.height),v.getImageData(-n,-n,e.width+2*n,e.height+2*n)},resolveURL:function(e){return ai||(ai=H.document.createElement("a")),ai.href=e,ai.href},hardwareConcurrency:H.navigator&&H.navigator.hardwareConcurrency||4,get devicePixelRatio(){return H.devicePixelRatio},get prefersReducedMotion(){return!!H.matchMedia&&(yi==null&&(yi=H.matchMedia("(prefers-reduced-motion: reduce)")),yi.matches)}},zi={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},zt={supported:!1,testSupport:function(e){!tr&&jt&&(Bt?rt(e):Fi=e)}},tr=!1,Bt=!1;function rt(e){var n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,jt),e.isContextLost())return;zt.supported=!0}catch{}e.deleteTexture(n),tr=!0}H.document&&((jt=H.document.createElement("img")).onload=function(){Fi&&rt(Fi),Fi=null,Bt=!0},jt.onerror=function(){tr=!0,Fi=null},jt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var _i="01",ir=function(e,n){this._transformRequestFn=e,this._customAccessToken=n,this._createSkuToken()};function Pr(e){return e.indexOf("mapbox:")===0}ir.prototype._createSkuToken=function(){var e=function(){for(var n="",l=0;l<10;l++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",_i,n].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},ir.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ir.prototype.transformRequest=function(e,n){return this._transformRequestFn&&this._transformRequestFn(e,n)||{url:e}},ir.prototype.normalizeStyleURL=function(e,n){if(!Pr(e))return e;var l=_n(e);return l.path="/styles/v1"+l.path,this._makeAPIURL(l,this._customAccessToken||n)},ir.prototype.normalizeGlyphsURL=function(e,n){if(!Pr(e))return e;var l=_n(e);return l.path="/fonts/v1"+l.path,this._makeAPIURL(l,this._customAccessToken||n)},ir.prototype.normalizeSourceURL=function(e,n){if(!Pr(e))return e;var l=_n(e);return l.path="/v4/"+l.authority+".json",l.params.push("secure"),this._makeAPIURL(l,this._customAccessToken||n)},ir.prototype.normalizeSpriteURL=function(e,n,l,v){var E=_n(e);return Pr(e)?(E.path="/styles/v1"+E.path+"/sprite"+n+l,this._makeAPIURL(E,this._customAccessToken||v)):(E.path+=""+n+l,ho(E))},ir.prototype.normalizeTileURL=function(e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Pr(e))return e;var l=_n(e);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,(rr.devicePixelRatio>=2||n===512?"@2x":"")+(zt.supported?".webp":"$1")),l.path=l.path.replace(/^.+\/v4\//,"/"),l.path="/v4"+l.path;var v=this._customAccessToken||function(E){for(var C=0,i=E;C<i.length;C+=1){var t=i[C].match(/^access_token=(.*)$/);if(t)return t[1]}return null}(l.params)||zi.ACCESS_TOKEN;return zi.REQUIRE_ACCESS_TOKEN&&v&&this._skuToken&&l.params.push("sku="+this._skuToken),this._makeAPIURL(l,v)},ir.prototype.canonicalizeTileURL=function(e,n){var l=_n(e);if(!l.path.match(/(^\/v4\/)/)||!l.path.match(/\.[\w]+$/))return e;var v="mapbox://tiles/";v+=l.path.replace("/v4/","");var E=l.params;return n&&(E=E.filter(function(C){return!C.match(/^access_token=/)})),E.length&&(v+="?"+E.join("&")),v},ir.prototype.canonicalizeTileset=function(e,n){for(var l=!!n&&Pr(n),v=[],E=0,C=e.tiles||[];E<C.length;E+=1){var i=C[E];Zn(i)?v.push(this.canonicalizeTileURL(i,l)):v.push(i)}return v},ir.prototype._makeAPIURL=function(e,n){var l="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",v=_n(zi.API_URL);if(e.protocol=v.protocol,e.authority=v.authority,e.protocol==="http"){var E=e.params.indexOf("secure");E>=0&&e.params.splice(E,1)}if(v.path!=="/"&&(e.path=""+v.path+e.path),!zi.REQUIRE_ACCESS_TOKEN)return ho(e);if(!(n=n||zi.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+l);if(n[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+l);return e.params=e.params.filter(function(C){return C.indexOf("access_token")===-1}),e.params.push("access_token="+n),ho(e)};var co=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Zn(e){return co.test(e)}var Bo=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function _n(e){var n=e.match(Bo);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function ho(e){var n=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+n}function Hn(e){if(!e)return null;var n=e.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(decodeURIComponent(H.atob(n[1]).split("").map(function(l){return"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Zi=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Zi.prototype.getStorageKey=function(e){var n,l=Hn(zi.ACCESS_TOKEN);return n=l&&l.u?H.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,function(v,E){return String.fromCharCode(Number("0x"+E))})):zi.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+n:"mapbox.eventData:"+n},Zi.prototype.fetchEventData=function(){var e=Rt("localStorage"),n=this.getStorageKey(),l=this.getStorageKey("uuid");if(e)try{var v=H.localStorage.getItem(n);v&&(this.eventData=JSON.parse(v));var E=H.localStorage.getItem(l);E&&(this.anonId=E)}catch{Xt("Unable to read from LocalStorage")}},Zi.prototype.saveEventData=function(){var e=Rt("localStorage"),n=this.getStorageKey(),l=this.getStorageKey("uuid");if(e)try{H.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&H.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{Xt("Unable to write to LocalStorage")}},Zi.prototype.processRequests=function(e){},Zi.prototype.postEvent=function(e,n,l,v){var E=this;if(zi.EVENTS_URL){var C=_n(zi.EVENTS_URL);C.params.push("access_token="+(v||zi.ACCESS_TOKEN||""));var i={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:_i,userId:this.anonId},t=n?Ne(i,n):i,a={url:ho(C),headers:{"Content-Type":"text/plain"},body:JSON.stringify([t])};this.pendingRequest=Xr(a,function(p){E.pendingRequest=null,l(p),E.saveEventData(),E.processRequests(v)})}},Zi.prototype.queueRequest=function(e,n){this.queue.push(e),this.processRequests(n)};var Un,Ao,Wn=function(e){function n(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.postMapLoadEvent=function(l,v,E,C){this.skuToken=E,(zi.EVENTS_URL&&C||zi.ACCESS_TOKEN&&Array.isArray(l)&&l.some(function(i){return Pr(i)||Zn(i)}))&&this.queueRequest({id:v,timestamp:Date.now()},C)},n.prototype.processRequests=function(l){var v=this;if(!this.pendingRequest&&this.queue.length!==0){var E=this.queue.shift(),C=E.id,i=E.timestamp;C&&this.success[C]||(this.anonId||this.fetchEventData(),pt(this.anonId)||(this.anonId=ct()),this.postEvent(i,{skuToken:this.skuToken},function(t){t||C&&(v.success[C]=!0)},l))}},n}(Zi),Ba=new(function(e){function n(l){e.call(this,"appUserTurnstile"),this._customAccessToken=l}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.postTurnstileEvent=function(l,v){zi.EVENTS_URL&&zi.ACCESS_TOKEN&&Array.isArray(l)&&l.some(function(E){return Pr(E)||Zn(E)})&&this.queueRequest(Date.now(),v)},n.prototype.processRequests=function(l){var v=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var E=Hn(zi.ACCESS_TOKEN),C=E?E.u:zi.ACCESS_TOKEN,i=C!==this.eventData.tokenU;pt(this.anonId)||(this.anonId=ct(),i=!0);var t=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),p=new Date(t),_=(t-this.eventData.lastSuccess)/864e5;i=i||_>=1||_<-1||a.getDate()!==p.getDate()}else i=!0;if(!i)return this.processRequests();this.postEvent(t,{"enabled.telemetry":!1},function(b){b||(v.eventData.lastSuccess=t,v.eventData.tokenU=C)},l)}},n}(Zi)),Ue=Ba.postTurnstileEvent.bind(Ba),gt=new Wn,Si=gt.postMapLoadEvent.bind(gt),yr=500,br=50;function Xn(){H.caches&&!Un&&(Un=H.caches.open("mapbox-tiles"))}function Kn(e){var n=e.indexOf("?");return n<0?e:e.slice(0,n)}var na,Yr=1/0;function Ht(){return na==null&&(na=H.OffscreenCanvas&&new H.OffscreenCanvas(1,1).getContext("2d")&&typeof H.createImageBitmap=="function"),na}var nr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(nr);var Ki=function(e){function n(l,v,E){v===401&&Zn(E)&&(l+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,l),this.status=v,this.url=E,this.name=this.constructor.name,this.message=l}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},n}(Error),Dn=bt()?function(){return self.worker&&self.worker.referrer}:function(){return(H.location.protocol==="blob:"?H.parent:H).location.href},Jn,Ni,ya=function(e,n){if(!(/^file:/.test(l=e.url)||/^file:/.test(Dn())&&!/^\w+:/.test(l))){if(H.fetch&&H.Request&&H.AbortController&&H.Request.prototype.hasOwnProperty("signal"))return function(v,E){var C,i=new H.AbortController,t=new H.Request(v.url,{method:v.method||"GET",body:v.body,credentials:v.credentials,headers:v.headers,referrer:Dn(),signal:i.signal}),a=!1,p=!1,_=(C=t.url).indexOf("sku=")>0&&Zn(C);v.type==="json"&&t.headers.set("Accept","application/json");var b=function(P,R,O){if(!p){if(P&&P.message!=="SecurityError"&&Xt(P),R&&O)return I(R);var V=Date.now();H.fetch(t).then(function(j){if(j.ok){var K=_?j.clone():null;return I(j,K,V)}return E(new Ki(j.statusText,j.status,v.url))}).catch(function(j){j.code!==20&&E(new Error(j.message))})}},I=function(P,R,O){(v.type==="arrayBuffer"?P.arrayBuffer():v.type==="json"?P.json():P.text()).then(function(V){p||(R&&O&&function(j,K,Y){if(Xn(),Un){var Q={status:K.status,statusText:K.statusText,headers:new H.Headers};K.headers.forEach(function(pe,Ae){return Q.headers.set(Ae,pe)});var se=Gi(K.headers.get("Cache-Control")||"");se["no-store"]||(se["max-age"]&&Q.headers.set("Expires",new Date(Y+1e3*se["max-age"]).toUTCString()),new Date(Q.headers.get("Expires")).getTime()-Y<42e4||function(pe,Ae){if(Ao===void 0)try{new Response(new ReadableStream),Ao=!0}catch{Ao=!1}Ao?Ae(pe.body):pe.blob().then(Ae)}(K,function(pe){var Ae=new H.Response(pe,Q);Xn(),Un&&Un.then(function(Be){return Be.put(Kn(j.url),Ae)}).catch(function(Be){return Xt(Be.message)})}))}}(t,R,O),a=!0,E(null,V,P.headers.get("Cache-Control"),P.headers.get("Expires")))}).catch(function(V){p||E(new Error(V.message))})};return _?function(P,R){if(Xn(),!Un)return R(null);var O=Kn(P.url);Un.then(function(V){V.match(O).then(function(j){var K=function(Y){if(!Y)return!1;var Q=new Date(Y.headers.get("Expires")||0),se=Gi(Y.headers.get("Cache-Control")||"");return Q>Date.now()&&!se["no-cache"]}(j);V.delete(O),K&&V.put(O,j.clone()),R(null,j,K)}).catch(R)}).catch(R)}(t,b):b(null,null),{cancel:function(){p=!0,a||i.abort()}}}(e,n);if(bt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,n,void 0,!0)}var l;return function(v,E){var C=new H.XMLHttpRequest;for(var i in C.open(v.method||"GET",v.url,!0),v.type==="arrayBuffer"&&(C.responseType="arraybuffer"),v.headers)C.setRequestHeader(i,v.headers[i]);return v.type==="json"&&(C.responseType="text",C.setRequestHeader("Accept","application/json")),C.withCredentials=v.credentials==="include",C.onerror=function(){E(new Error(C.statusText))},C.onload=function(){if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){var t=C.response;if(v.type==="json")try{t=JSON.parse(C.response)}catch(a){return E(a)}E(null,t,C.getResponseHeader("Cache-Control"),C.getResponseHeader("Expires"))}else E(new Ki(C.statusText,C.status,v.url))},C.send(v.body),{cancel:function(){return C.abort()}}}(e,n)},Oo=function(e,n){return ya(Ne(e,{type:"arrayBuffer"}),n)},Xr=function(e,n){return ya(Ne(e,{method:"POST"}),n)},te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Jn=[],Ni=0;var oe=function(e,n){if(zt.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),Ni>=zi.MAX_PARALLEL_IMAGE_REQUESTS){var l={requestParameters:e,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return Jn.push(l),l}Ni++;var v=!1,E=function(){if(!v)for(v=!0,Ni--;Jn.length&&Ni<zi.MAX_PARALLEL_IMAGE_REQUESTS;){var i=Jn.shift();i.cancelled||(i.cancel=oe(i.requestParameters,i.callback).cancel)}},C=Oo(e,function(i,t,a,p){E(),i?n(i):t&&(Ht()?function(_,b){var I=new H.Blob([new Uint8Array(_)],{type:"image/png"});H.createImageBitmap(I).then(function(P){b(null,P)}).catch(function(P){b(new Error("Could not load image because of "+P.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(t,n):function(_,b,I,P){var R=new H.Image,O=H.URL;R.onload=function(){b(null,R),O.revokeObjectURL(R.src),R.onload=null,H.requestAnimationFrame(function(){R.src=te})},R.onerror=function(){return b(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var V=new H.Blob([new Uint8Array(_)],{type:"image/png"});R.cacheControl=I,R.expires=P,R.src=_.byteLength?O.createObjectURL(V):te}(t,n,a,p))});return{cancel:function(){C.cancel(),E()}}};function le(e,n,l){l[e]&&l[e].indexOf(n)!==-1||(l[e]=l[e]||[],l[e].push(n))}function ge(e,n,l){if(l&&l[e]){var v=l[e].indexOf(n);v!==-1&&l[e].splice(v,1)}}var Se=function(e,n){n===void 0&&(n={}),Ne(this,n),this.type=e},Oe=function(e){function n(l,v){v===void 0&&(v={}),e.call(this,"error",Ne({error:l},v))}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(Se),Ve=function(){};Ve.prototype.on=function(e,n){return this._listeners=this._listeners||{},le(e,n,this._listeners),this},Ve.prototype.off=function(e,n){return ge(e,n,this._listeners),ge(e,n,this._oneTimeListeners),this},Ve.prototype.once=function(e,n){return this._oneTimeListeners=this._oneTimeListeners||{},le(e,n,this._oneTimeListeners),this},Ve.prototype.fire=function(e,n){typeof e=="string"&&(e=new Se(e,n||{}));var l=e.type;if(this.listens(l)){e.target=this;for(var v=0,E=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];v<E.length;v+=1)E[v].call(this,e);for(var C=0,i=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];C<i.length;C+=1){var t=i[C];ge(l,t,this._oneTimeListeners),t.call(this,e)}var a=this._eventedParent;a&&(Ne(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),a.fire(e))}else e instanceof Oe&&console.error(e.error);return this},Ve.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Ve.prototype.setEventedParent=function(e,n){return this._eventedParent=e,this._eventedParentData=n,this};var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Me=function(e,n,l,v){this.message=(e?e+": ":"")+l,v&&(this.identifier=v),n!=null&&n.__line__&&(this.line=n.__line__)};function Qe(e){var n=e.value;return n?[new Me(e.key,n,"constants have been deprecated as of v8")]:[]}function ae(e){for(var n=[],l=arguments.length-1;l-- >0;)n[l]=arguments[l+1];for(var v=0,E=n;v<E.length;v+=1){var C=E[v];for(var i in C)e[i]=C[i]}return e}function W(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function X(e){if(Array.isArray(e))return e.map(X);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var n={};for(var l in e)n[l]=X(e[l]);return n}return W(e)}var ne=function(e){function n(l,v){e.call(this,v),this.message=v,this.key=l}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(Error),ce=function(e,n){n===void 0&&(n=[]),this.parent=e,this.bindings={};for(var l=0,v=n;l<v.length;l+=1){var E=v[l];this.bindings[E[0]]=E[1]}};ce.prototype.concat=function(e){return new ce(this,e)},ce.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},ce.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var _e={kind:"null"},fe={kind:"number"},Ee={kind:"string"},we={kind:"boolean"},Ie={kind:"color"},et={kind:"object"},Ke={kind:"value"},tt={kind:"collator"},Ut={kind:"formatted"},At={kind:"resolvedImage"};function Ot(e,n){return{kind:"array",itemType:e,N:n}}function Vt(e){if(e.kind==="array"){var n=Vt(e.itemType);return typeof e.N=="number"?"array<"+n+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+n+">"}return e.kind}var Hi=[_e,fe,Ee,we,Ie,Ut,et,Ot(Ke),At];function gi(e,n){if(n.kind==="error")return null;if(e.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!gi(e.itemType,n.itemType))&&(typeof e.N!="number"||e.N===n.N))return null}else{if(e.kind===n.kind)return null;if(e.kind==="value"){for(var l=0,v=Hi;l<v.length;l+=1)if(!gi(v[l],n))return null}}return"Expected "+Vt(e)+" but found "+Vt(n)+" instead."}function Ci(e,n){return n.some(function(l){return l.kind===e.kind})}function ci(e,n){return n.some(function(l){return l==="null"?e===null:l==="array"?Array.isArray(e):l==="object"?e&&!Array.isArray(e)&&typeof e=="object":l===typeof e})}var Kt=h(function(e,n){var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function v(t){return(t=Math.round(t))<0?0:t>255?255:t}function E(t){return v(t[t.length-1]==="%"?parseFloat(t)/100*255:parseInt(t))}function C(t){return(a=t[t.length-1]==="%"?parseFloat(t)/100:parseFloat(t))<0?0:a>1?1:a;var a}function i(t,a,p){return p<0?p+=1:p>1&&(p-=1),6*p<1?t+(a-t)*p*6:2*p<1?a:3*p<2?t+(a-t)*(2/3-p)*6:t}try{n.parseCSSColor=function(t){var a,p=t.replace(/ /g,"").toLowerCase();if(p in l)return l[p].slice();if(p[0]==="#")return p.length===4?(a=parseInt(p.substr(1),16))>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null:p.length===7&&(a=parseInt(p.substr(1),16))>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null;var _=p.indexOf("("),b=p.indexOf(")");if(_!==-1&&b+1===p.length){var I=p.substr(0,_),P=p.substr(_+1,b-(_+1)).split(","),R=1;switch(I){case"rgba":if(P.length!==4)return null;R=C(P.pop());case"rgb":return P.length!==3?null:[E(P[0]),E(P[1]),E(P[2]),R];case"hsla":if(P.length!==4)return null;R=C(P.pop());case"hsl":if(P.length!==3)return null;var O=(parseFloat(P[0])%360+360)%360/360,V=C(P[1]),j=C(P[2]),K=j<=.5?j*(V+1):j+V-j*V,Y=2*j-K;return[v(255*i(Y,K,O+1/3)),v(255*i(Y,K,O)),v(255*i(Y,K,O-1/3)),R];default:return null}}return null}}catch{}}).parseCSSColor,Di=function(e,n,l,v){v===void 0&&(v=1),this.r=e,this.g=n,this.b=l,this.a=v};Di.parse=function(e){if(e){if(e instanceof Di)return e;if(typeof e=="string"){var n=Kt(e);if(n)return new Di(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3])}}},Di.prototype.toString=function(){var e=this.toArray(),n=e[1],l=e[2],v=e[3];return"rgba("+Math.round(e[0])+","+Math.round(n)+","+Math.round(l)+","+v+")"},Di.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Di.black=new Di(0,0,0,1),Di.white=new Di(1,1,1,1),Di.transparent=new Di(0,0,0,0),Di.red=new Di(1,0,0,1);var Ir=function(e,n,l){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ir.prototype.compare=function(e,n){return this.collator.compare(e,n)},Ir.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var kn=function(e,n,l,v,E){this.text=e,this.image=n,this.scale=l,this.fontStack=v,this.textColor=E},Cr=function(e){this.sections=e};Cr.fromString=function(e){return new Cr([new kn(e,null,null,null,null)])},Cr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Cr.factory=function(e){return e instanceof Cr?e:Cr.fromString(e)},Cr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Cr.prototype.serialize=function(){for(var e=["format"],n=0,l=this.sections;n<l.length;n+=1){var v=l[n];if(v.image)e.push(["image",v.image.name]);else{e.push(v.text);var E={};v.fontStack&&(E["text-font"]=["literal",v.fontStack.split(",")]),v.scale&&(E["font-scale"]=v.scale),v.textColor&&(E["text-color"]=["rgba"].concat(v.textColor.toArray())),e.push(E)}}return e};var Eo=function(e){this.name=e.name,this.available=e.available};function Ol(e,n,l,v){return typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof l=="number"&&l>=0&&l<=255?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:"Invalid rgba value ["+[e,n,l,v].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof v=="number"?[e,n,l,v]:[e,n,l]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function qr(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof Di||e instanceof Ir||e instanceof Cr||e instanceof Eo)return!0;if(Array.isArray(e)){for(var n=0,l=e;n<l.length;n+=1)if(!qr(l[n]))return!1;return!0}if(typeof e=="object"){for(var v in e)if(!qr(e[v]))return!1;return!0}return!1}function In(e){if(e===null)return _e;if(typeof e=="string")return Ee;if(typeof e=="boolean")return we;if(typeof e=="number")return fe;if(e instanceof Di)return Ie;if(e instanceof Ir)return tt;if(e instanceof Cr)return Ut;if(e instanceof Eo)return At;if(Array.isArray(e)){for(var n,l=e.length,v=0,E=e;v<E.length;v+=1){var C=In(E[v]);if(n){if(n===C)continue;n=Ke;break}n=C}return Ot(n||Ke,l)}return et}function qs(e){var n=typeof e;return e===null?"":n==="string"||n==="number"||n==="boolean"?String(e):e instanceof Di||e instanceof Cr||e instanceof Eo?e.toString():JSON.stringify(e)}Eo.prototype.toString=function(){return this.name},Eo.fromString=function(e){return e?new Eo({name:e,available:!1}):null},Eo.prototype.serialize=function(){return["image",this.name]};var Co=function(e,n){this.type=e,this.value=n};Co.parse=function(e,n){if(e.length!==2)return n.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!qr(e[1]))return n.error("invalid value");var l=e[1],v=In(l),E=n.expectedType;return v.kind!=="array"||v.N!==0||!E||E.kind!=="array"||typeof E.N=="number"&&E.N!==0||(v=E),new Co(v,l)},Co.prototype.evaluate=function(){return this.value},Co.prototype.eachChild=function(){},Co.prototype.outputDefined=function(){return!0},Co.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Di?["rgba"].concat(this.value.toArray()):this.value instanceof Cr?this.value.serialize():this.value};var Rn=function(e){this.name="ExpressionEvaluationError",this.message=e};Rn.prototype.toJSON=function(){return this.message};var oa={string:Ee,number:fe,boolean:we,object:et},Qr=function(e,n){this.type=e,this.args=n};Qr.parse=function(e,n){if(e.length<2)return n.error("Expected at least one argument.");var l,v=1,E=e[0];if(E==="array"){var C,i;if(e.length>2){var t=e[1];if(typeof t!="string"||!(t in oa)||t==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);C=oa[t],v++}else C=Ke;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);i=e[2],v++}l=Ot(C,i)}else l=oa[E];for(var a=[];v<e.length;v++){var p=n.parse(e[v],v,Ke);if(!p)return null;a.push(p)}return new Qr(l,a)},Qr.prototype.evaluate=function(e){for(var n=0;n<this.args.length;n++){var l=this.args[n].evaluate(e);if(!gi(this.type,In(l)))return l;if(n===this.args.length-1)throw new Rn("Expected value to be of type "+Vt(this.type)+", but found "+Vt(In(l))+" instead.")}return null},Qr.prototype.eachChild=function(e){this.args.forEach(e)},Qr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Qr.prototype.serialize=function(){var e=this.type,n=[e.kind];if(e.kind==="array"){var l=e.itemType;if(l.kind==="string"||l.kind==="number"||l.kind==="boolean"){n.push(l.kind);var v=e.N;(typeof v=="number"||this.args.length>1)&&n.push(v)}}return n.concat(this.args.map(function(E){return E.serialize()}))};var aa=function(e){this.type=Ut,this.sections=e};aa.parse=function(e,n){if(e.length<2)return n.error("Expected at least one argument.");var l=e[1];if(!Array.isArray(l)&&typeof l=="object")return n.error("First argument must be an image or text section.");for(var v=[],E=!1,C=1;C<=e.length-1;++C){var i=e[C];if(E&&typeof i=="object"&&!Array.isArray(i)){E=!1;var t=null;if(i["font-scale"]&&!(t=n.parse(i["font-scale"],1,fe)))return null;var a=null;if(i["text-font"]&&!(a=n.parse(i["text-font"],1,Ot(Ee))))return null;var p=null;if(i["text-color"]&&!(p=n.parse(i["text-color"],1,Ie)))return null;var _=v[v.length-1];_.scale=t,_.font=a,_.textColor=p}else{var b=n.parse(e[C],1,Ke);if(!b)return null;var I=b.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");E=!0,v.push({content:b,scale:null,font:null,textColor:null})}}return new aa(v)},aa.prototype.evaluate=function(e){return new Cr(this.sections.map(function(n){var l=n.content.evaluate(e);return In(l)===At?new kn("",l,null,null,null):new kn(qs(l),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))},aa.prototype.eachChild=function(e){for(var n=0,l=this.sections;n<l.length;n+=1){var v=l[n];e(v.content),v.scale&&e(v.scale),v.font&&e(v.font),v.textColor&&e(v.textColor)}},aa.prototype.outputDefined=function(){return!1},aa.prototype.serialize=function(){for(var e=["format"],n=0,l=this.sections;n<l.length;n+=1){var v=l[n];e.push(v.content.serialize());var E={};v.scale&&(E["font-scale"]=v.scale.serialize()),v.font&&(E["text-font"]=v.font.serialize()),v.textColor&&(E["text-color"]=v.textColor.serialize()),e.push(E)}return e};var Fo=function(e){this.type=At,this.input=e};Fo.parse=function(e,n){if(e.length!==2)return n.error("Expected two arguments.");var l=n.parse(e[1],1,Ee);return l?new Fo(l):n.error("No image name provided.")},Fo.prototype.evaluate=function(e){var n=this.input.evaluate(e),l=Eo.fromString(n);return l&&e.availableImages&&(l.available=e.availableImages.indexOf(n)>-1),l},Fo.prototype.eachChild=function(e){e(this.input)},Fo.prototype.outputDefined=function(){return!1},Fo.prototype.serialize=function(){return["image",this.input.serialize()]};var Qu={"to-boolean":we,"to-color":Ie,"to-number":fe,"to-string":Ee},sa=function(e,n){this.type=e,this.args=n};sa.parse=function(e,n){if(e.length<2)return n.error("Expected at least one argument.");var l=e[0];if((l==="to-boolean"||l==="to-string")&&e.length!==2)return n.error("Expected one argument.");for(var v=Qu[l],E=[],C=1;C<e.length;C++){var i=n.parse(e[C],C,Ke);if(!i)return null;E.push(i)}return new sa(v,E)},sa.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var n,l,v=0,E=this.args;v<E.length;v+=1){if(l=null,(n=E[v].evaluate(e))instanceof Di)return n;if(typeof n=="string"){var C=e.parseColor(n);if(C)return C}else if(Array.isArray(n)&&!(l=n.length<3||n.length>4?"Invalid rbga value "+JSON.stringify(n)+": expected an array containing either three or four numeric values.":Ol(n[0],n[1],n[2],n[3])))return new Di(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Rn(l||"Could not parse color from value '"+(typeof n=="string"?n:String(JSON.stringify(n)))+"'")}if(this.type.kind==="number"){for(var i=null,t=0,a=this.args;t<a.length;t+=1){if((i=a[t].evaluate(e))===null)return 0;var p=Number(i);if(!isNaN(p))return p}throw new Rn("Could not convert "+JSON.stringify(i)+" to number.")}return this.type.kind==="formatted"?Cr.fromString(qs(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Eo.fromString(qs(this.args[0].evaluate(e))):qs(this.args[0].evaluate(e))},sa.prototype.eachChild=function(e){this.args.forEach(e)},sa.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},sa.prototype.serialize=function(){if(this.type.kind==="formatted")return new aa([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Fo(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(n){e.push(n.serialize())}),e};var Gs=["Unknown","Point","LineString","Polygon"],ga=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ga.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ga.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Gs[this.feature.type]:this.feature.type:null},ga.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ga.prototype.canonicalID=function(){return this.canonical},ga.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ga.prototype.parseColor=function(e){var n=this._parseColorCache[e];return n||(n=this._parseColorCache[e]=Di.parse(e)),n};var Sn=function(e,n,l,v){this.name=e,this.type=n,this._evaluate=l,this.args=v};Sn.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Sn.prototype.eachChild=function(e){this.args.forEach(e)},Sn.prototype.outputDefined=function(){return!1},Sn.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Sn.parse=function(e,n){var l,v=e[0],E=Sn.definitions[v];if(!E)return n.error('Unknown expression "'+v+'". If you wanted a literal array, use ["literal", [...]].',0);for(var C=Array.isArray(E)?E[0]:E.type,i=Array.isArray(E)?[[E[1],E[2]]]:E.overloads,t=i.filter(function(it){var He=it[0];return!Array.isArray(He)||He.length===e.length-1}),a=null,p=0,_=t;p<_.length;p+=1){var b=_[p],I=b[0],P=b[1];a=new Es(n.registry,n.path,null,n.scope);for(var R=[],O=!1,V=1;V<e.length;V++){var j=e[V],K=Array.isArray(I)?I[V-1]:I.type,Y=a.parse(j,1+R.length,K);if(!Y){O=!0;break}R.push(Y)}if(!O)if(Array.isArray(I)&&I.length!==R.length)a.error("Expected "+I.length+" arguments, but found "+R.length+" instead.");else{for(var Q=0;Q<R.length;Q++){var se=Array.isArray(I)?I[Q]:I.type,pe=R[Q];a.concat(Q+1).checkSubtype(se,pe.type)}if(a.errors.length===0)return new Sn(v,C,P,R)}}if(t.length===1)(l=n.errors).push.apply(l,a.errors);else{for(var Ae=(t.length?t:i).map(function(it){var He;return He=it[0],Array.isArray(He)?"("+He.map(Vt).join(", ")+")":"("+Vt(He.type)+"...)"}).join(" | "),Be=[],qe=1;qe<e.length;qe++){var Ge=n.parse(e[qe],1+Be.length);if(!Ge)return null;Be.push(Vt(Ge.type))}n.error("Expected arguments of type "+Ae+", but found ("+Be.join(", ")+") instead.")}return null},Sn.register=function(e,n){for(var l in Sn.definitions=n,n)e[l]=Sn};var Zo=function(e,n,l){this.type=tt,this.locale=l,this.caseSensitive=e,this.diacriticSensitive=n};function $n(e,n){e[0]=Math.min(e[0],n[0]),e[1]=Math.min(e[1],n[1]),e[2]=Math.max(e[2],n[0]),e[3]=Math.max(e[3],n[1])}function Oa(e,n){return!(e[0]<=n[0]||e[2]>=n[2]||e[1]<=n[1]||e[3]>=n[3])}function Fl(e,n){var l=(180+e[0])/360,v=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,E=Math.pow(2,n.z);return[Math.round(l*E*8192),Math.round(v*E*8192)]}function wu(e,n,l){return n[1]>e[1]!=l[1]>e[1]&&e[0]<(l[0]-n[0])*(e[1]-n[1])/(l[1]-n[1])+n[0]}function Zs(e,n){for(var l,v,E,C,i,t,a,p=!1,_=0,b=n.length;_<b;_++)for(var I=n[_],P=0,R=I.length;P<R-1;P++){if((C=(l=e)[0]-(v=I[P])[0])*(a=l[1]-(E=I[P+1])[1])-(t=l[0]-E[0])*(i=l[1]-v[1])==0&&C*t<=0&&i*a<=0)return!1;wu(e,I[P],I[P+1])&&(p=!p)}return p}function Nn(e,n){for(var l=0;l<n.length;l++)if(Zs(e,n[l]))return!0;return!1}function ml(e,n,l,v){var E=v[0]-l[0],C=v[1]-l[1],i=(e[0]-l[0])*C-E*(e[1]-l[1]),t=(n[0]-l[0])*C-E*(n[1]-l[1]);return i>0&&t<0||i<0&&t>0}function ec(e,n,l){for(var v=0,E=l;v<E.length;v+=1)for(var C=E[v],i=0;i<C.length-1;++i)if((b=[(_=C[i+1])[0]-(p=C[i])[0],_[1]-p[1]])[0]*(I=[(a=n)[0]-(t=e)[0],a[1]-t[1]])[1]-b[1]*I[0]!=0&&ml(t,a,p,_)&&ml(p,_,t,a))return!0;var t,a,p,_,b,I;return!1}function tc(e,n){for(var l=0;l<e.length;++l)if(!Zs(e[l],n))return!1;for(var v=0;v<e.length-1;++v)if(ec(e[v],e[v+1],n))return!1;return!0}function ic(e,n){for(var l=0;l<n.length;l++)if(tc(e,n[l]))return!0;return!1}function ts(e,n,l){for(var v=[],E=0;E<e.length;E++){for(var C=[],i=0;i<e[E].length;i++){var t=Fl(e[E][i],l);$n(n,t),C.push(t)}v.push(C)}return v}function Ul(e,n,l){for(var v=[],E=0;E<e.length;E++){var C=ts(e[E],n,l);v.push(C)}return v}function Nl(e,n,l,v){if(e[0]<l[0]||e[0]>l[2]){var E=.5*v,C=e[0]-l[0]>E?-v:l[0]-e[0]>E?v:0;C===0&&(C=e[0]-l[2]>E?-v:l[2]-e[0]>E?v:0),e[0]+=C}$n(n,e)}function Bc(e,n,l,v){for(var E=8192*Math.pow(2,v.z),C=[8192*v.x,8192*v.y],i=[],t=0,a=e;t<a.length;t+=1)for(var p=0,_=a[t];p<_.length;p+=1){var b=_[p],I=[b.x+C[0],b.y+C[1]];Nl(I,n,l,E),i.push(I)}return i}function yl(e,n,l,v){for(var E,C=8192*Math.pow(2,v.z),i=[8192*v.x,8192*v.y],t=[],a=0,p=e;a<p.length;a+=1){for(var _=[],b=0,I=p[a];b<I.length;b+=1){var P=I[b],R=[P.x+i[0],P.y+i[1]];$n(n,R),_.push(R)}t.push(_)}if(n[2]-n[0]<=C/2){(E=n)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(var O=0,V=t;O<V.length;O+=1)for(var j=0,K=V[O];j<K.length;j+=1)Nl(K[j],n,l,C)}return t}Zo.parse=function(e,n){if(e.length!==2)return n.error("Expected one argument.");var l=e[1];if(typeof l!="object"||Array.isArray(l))return n.error("Collator options argument must be an object.");var v=n.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,we);if(!v)return null;var E=n.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,we);if(!E)return null;var C=null;return l.locale&&!(C=n.parse(l.locale,1,Ee))?null:new Zo(v,E,C)},Zo.prototype.evaluate=function(e){return new Ir(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Zo.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Zo.prototype.outputDefined=function(){return!1},Zo.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Ho=function(e,n){this.type=we,this.geojson=e,this.geometries=n};function Fa(e){if(e instanceof Sn&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Ho)return!1;var n=!0;return e.eachChild(function(l){n&&!Fa(l)&&(n=!1)}),n}function Ua(e){if(e instanceof Sn&&e.name==="feature-state")return!1;var n=!0;return e.eachChild(function(l){n&&!Ua(l)&&(n=!1)}),n}function ws(e,n){if(e instanceof Sn&&n.indexOf(e.name)>=0)return!1;var l=!0;return e.eachChild(function(v){l&&!ws(v,n)&&(l=!1)}),l}Ho.parse=function(e,n){if(e.length!==2)return n.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(qr(e[1])){var l=e[1];if(l.type==="FeatureCollection")for(var v=0;v<l.features.length;++v){var E=l.features[v].geometry.type;if(E==="Polygon"||E==="MultiPolygon")return new Ho(l,l.features[v].geometry)}else if(l.type==="Feature"){var C=l.geometry.type;if(C==="Polygon"||C==="MultiPolygon")return new Ho(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Ho(l,l)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Ho.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,l){var v=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],C=n.canonicalID();if(l.type==="Polygon"){var i=ts(l.coordinates,E,C),t=Bc(n.geometry(),v,E,C);if(!Oa(v,E))return!1;for(var a=0,p=t;a<p.length;a+=1)if(!Zs(p[a],i))return!1}if(l.type==="MultiPolygon"){var _=Ul(l.coordinates,E,C),b=Bc(n.geometry(),v,E,C);if(!Oa(v,E))return!1;for(var I=0,P=b;I<P.length;I+=1)if(!Nn(P[I],_))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,l){var v=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],C=n.canonicalID();if(l.type==="Polygon"){var i=ts(l.coordinates,E,C),t=yl(n.geometry(),v,E,C);if(!Oa(v,E))return!1;for(var a=0,p=t;a<p.length;a+=1)if(!tc(p[a],i))return!1}if(l.type==="MultiPolygon"){var _=Ul(l.coordinates,E,C),b=yl(n.geometry(),v,E,C);if(!Oa(v,E))return!1;for(var I=0,P=b;I<P.length;I+=1)if(!ic(P[I],_))return!1}return!0}(e,this.geometries)}return!1},Ho.prototype.eachChild=function(){},Ho.prototype.outputDefined=function(){return!0},Ho.prototype.serialize=function(){return["within",this.geojson]};var cr=function(e,n){this.type=n.type,this.name=e,this.boundExpression=n};cr.parse=function(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");var l=e[1];return n.scope.has(l)?new cr(l,n.scope.get(l)):n.error('Unknown variable "'+l+'". Make sure "'+l+'" has been bound in an enclosing "let" expression before using it.',1)},cr.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},cr.prototype.eachChild=function(){},cr.prototype.outputDefined=function(){return!1},cr.prototype.serialize=function(){return["var",this.name]};var Es=function(e,n,l,v,E){n===void 0&&(n=[]),v===void 0&&(v=new ce),E===void 0&&(E=[]),this.registry=e,this.path=n,this.key=n.map(function(C){return"["+C+"]"}).join(""),this.scope=v,this.errors=E,this.expectedType=l};function Is(e,n){for(var l,v=e.length-1,E=0,C=v,i=0;E<=C;)if((l=e[i=Math.floor((E+C)/2)])<=n){if(i===v||n<e[i+1])return i;E=i+1}else{if(!(l>n))throw new Rn("Input is not a number.");C=i-1}return 0}Es.prototype.parse=function(e,n,l,v,E){return E===void 0&&(E={}),n?this.concat(n,l,v)._parse(e,E):this._parse(e,E)},Es.prototype._parse=function(e,n){function l(p,_,b){return b==="assert"?new Qr(_,[p]):b==="coerce"?new sa(_,[p]):p}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var v=e[0];if(typeof v!="string")return this.error("Expression name must be a string, but found "+typeof v+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var E=this.registry[v];if(E){var C=E.parse(e,this);if(!C)return null;if(this.expectedType){var i=this.expectedType,t=C.type;if(i.kind!=="string"&&i.kind!=="number"&&i.kind!=="boolean"&&i.kind!=="object"&&i.kind!=="array"||t.kind!=="value")if(i.kind!=="color"&&i.kind!=="formatted"&&i.kind!=="resolvedImage"||t.kind!=="value"&&t.kind!=="string"){if(this.checkSubtype(i,t))return null}else C=l(C,i,n.typeAnnotation||"coerce");else C=l(C,i,n.typeAnnotation||"assert")}if(!(C instanceof Co)&&C.type.kind!=="resolvedImage"&&function p(_){if(_ instanceof cr)return p(_.boundExpression);if(_ instanceof Sn&&_.name==="error"||_ instanceof Zo||_ instanceof Ho)return!1;var b=_ instanceof sa||_ instanceof Qr,I=!0;return _.eachChild(function(P){I=b?I&&p(P):I&&P instanceof Co}),!!I&&Fa(_)&&ws(_,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(C)){var a=new ga;try{C=new Co(C.type,C.evaluate(a))}catch(p){return this.error(p.message),null}}return C}return this.error('Unknown expression "'+v+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Es.prototype.concat=function(e,n,l){var v=typeof e=="number"?this.path.concat(e):this.path,E=l?this.scope.concat(l):this.scope;return new Es(this.registry,v,n||null,E,this.errors)},Es.prototype.error=function(e){for(var n=[],l=arguments.length-1;l-- >0;)n[l]=arguments[l+1];var v=""+this.key+n.map(function(E){return"["+E+"]"}).join("");this.errors.push(new ne(v,e))},Es.prototype.checkSubtype=function(e,n){var l=gi(e,n);return l&&this.error(l),l};var po=function(e,n,l){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(var v=0,E=l;v<E.length;v+=1){var C=E[v],i=C[1];this.labels.push(C[0]),this.outputs.push(i)}};function Tn(e,n,l){return e*(1-l)+n*l}po.parse=function(e,n){if(e.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");var l=n.parse(e[1],1,fe);if(!l)return null;var v=[],E=null;n.expectedType&&n.expectedType.kind!=="value"&&(E=n.expectedType);for(var C=1;C<e.length;C+=2){var i=C===1?-1/0:e[C],t=e[C+1],a=C,p=C+1;if(typeof i!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(v.length&&v[v.length-1][0]>=i)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);var _=n.parse(t,p,E);if(!_)return null;E=E||_.type,v.push([i,_])}return new po(E,l,v)},po.prototype.evaluate=function(e){var n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(e);var v=this.input.evaluate(e);if(v<=n[0])return l[0].evaluate(e);var E=n.length;return v>=n[E-1]?l[E-1].evaluate(e):l[Is(n,v)].evaluate(e)},po.prototype.eachChild=function(e){e(this.input);for(var n=0,l=this.outputs;n<l.length;n+=1)e(l[n])},po.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},po.prototype.serialize=function(){for(var e=["step",this.input.serialize()],n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e};var fo=Object.freeze({__proto__:null,number:Tn,color:function(e,n,l){return new Di(Tn(e.r,n.r,l),Tn(e.g,n.g,l),Tn(e.b,n.b,l),Tn(e.a,n.a,l))},array:function(e,n,l){return e.map(function(v,E){return Tn(v,n[E],l)})}}),Eu=6/29*3*(6/29),Iu=Math.PI/180,Su=180/Math.PI;function jl(e){return e>.008856451679035631?Math.pow(e,1/3):e/Eu+4/29}function Vl(e){return e>6/29?e*e*e:Eu*(e-4/29)}function gl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function ql(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Tu(e){var n=ql(e.r),l=ql(e.g),v=ql(e.b),E=jl((.4124564*n+.3575761*l+.1804375*v)/.95047),C=jl((.2126729*n+.7151522*l+.072175*v)/1);return{l:116*C-16,a:500*(E-C),b:200*(C-jl((.0193339*n+.119192*l+.9503041*v)/1.08883)),alpha:e.a}}function Gl(e){var n=(e.l+16)/116,l=isNaN(e.a)?n:n+e.a/500,v=isNaN(e.b)?n:n-e.b/200;return n=1*Vl(n),l=.95047*Vl(l),v=1.08883*Vl(v),new Di(gl(3.2404542*l-1.5371385*n-.4985314*v),gl(-.969266*l+1.8760108*n+.041556*v),gl(.0556434*l-.2040259*n+1.0572252*v),e.alpha)}function Oc(e,n,l){var v=n-e;return e+l*(v>180||v<-180?v-360*Math.round(v/360):v)}var _l={forward:Tu,reverse:Gl,interpolate:function(e,n,l){return{l:Tn(e.l,n.l,l),a:Tn(e.a,n.a,l),b:Tn(e.b,n.b,l),alpha:Tn(e.alpha,n.alpha,l)}}},Na={forward:function(e){var n=Tu(e),l=n.l,v=n.a,E=n.b,C=Math.atan2(E,v)*Su;return{h:C<0?C+360:C,c:Math.sqrt(v*v+E*E),l,alpha:e.a}},reverse:function(e){var n=e.h*Iu,l=e.c;return Gl({l:e.l,a:Math.cos(n)*l,b:Math.sin(n)*l,alpha:e.alpha})},interpolate:function(e,n,l){return{h:Oc(e.h,n.h,l),c:Tn(e.c,n.c,l),l:Tn(e.l,n.l,l),alpha:Tn(e.alpha,n.alpha,l)}}},Fc=Object.freeze({__proto__:null,lab:_l,hcl:Na}),mo=function(e,n,l,v,E){this.type=e,this.operator=n,this.interpolation=l,this.input=v,this.labels=[],this.outputs=[];for(var C=0,i=E;C<i.length;C+=1){var t=i[C],a=t[1];this.labels.push(t[0]),this.outputs.push(a)}};function rc(e,n,l,v){var E=v-l,C=e-l;return E===0?0:n===1?C/E:(Math.pow(n,C)-1)/(Math.pow(n,E)-1)}mo.interpolationFactor=function(e,n,l,v){var E=0;if(e.name==="exponential")E=rc(n,e.base,l,v);else if(e.name==="linear")E=rc(n,1,l,v);else if(e.name==="cubic-bezier"){var C=e.controlPoints;E=new D(C[0],C[1],C[2],C[3]).solve(rc(n,1,l,v))}return E},mo.parse=function(e,n){var l=e[0],v=e[1],E=e[2],C=e.slice(3);if(!Array.isArray(v)||v.length===0)return n.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){var i=v[1];if(typeof i!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:i}}else{if(v[0]!=="cubic-bezier")return n.error("Unknown interpolation type "+String(v[0]),1,0);var t=v.slice(1);if(t.length!==4||t.some(function(V){return typeof V!="number"||V<0||V>1}))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:t}}if(e.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(!(E=n.parse(E,2,fe)))return null;var a=[],p=null;l==="interpolate-hcl"||l==="interpolate-lab"?p=Ie:n.expectedType&&n.expectedType.kind!=="value"&&(p=n.expectedType);for(var _=0;_<C.length;_+=2){var b=C[_],I=C[_+1],P=_+3,R=_+4;if(typeof b!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(a.length&&a[a.length-1][0]>=b)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',P);var O=n.parse(I,R,p);if(!O)return null;p=p||O.type,a.push([b,O])}return p.kind==="number"||p.kind==="color"||p.kind==="array"&&p.itemType.kind==="number"&&typeof p.N=="number"?new mo(p,l,v,E,a):n.error("Type "+Vt(p)+" is not interpolatable.")},mo.prototype.evaluate=function(e){var n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(e);var v=this.input.evaluate(e);if(v<=n[0])return l[0].evaluate(e);var E=n.length;if(v>=n[E-1])return l[E-1].evaluate(e);var C=Is(n,v),i=mo.interpolationFactor(this.interpolation,v,n[C],n[C+1]),t=l[C].evaluate(e),a=l[C+1].evaluate(e);return this.operator==="interpolate"?fo[this.type.kind.toLowerCase()](t,a,i):this.operator==="interpolate-hcl"?Na.reverse(Na.interpolate(Na.forward(t),Na.forward(a),i)):_l.reverse(_l.interpolate(_l.forward(t),_l.forward(a),i))},mo.prototype.eachChild=function(e){e(this.input);for(var n=0,l=this.outputs;n<l.length;n+=1)e(l[n])},mo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},mo.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var n=[this.operator,e,this.input.serialize()],l=0;l<this.labels.length;l++)n.push(this.labels[l],this.outputs[l].serialize());return n};var Ss=function(e,n){this.type=e,this.args=n};Ss.parse=function(e,n){if(e.length<2)return n.error("Expectected at least one argument.");var l=null,v=n.expectedType;v&&v.kind!=="value"&&(l=v);for(var E=[],C=0,i=e.slice(1);C<i.length;C+=1){var t=n.parse(i[C],1+E.length,l,void 0,{typeAnnotation:"omit"});if(!t)return null;l=l||t.type,E.push(t)}var a=v&&E.some(function(p){return gi(v,p.type)});return new Ss(a?Ke:l,E)},Ss.prototype.evaluate=function(e){for(var n,l=null,v=0,E=0,C=this.args;E<C.length&&(v++,(l=C[E].evaluate(e))&&l instanceof Eo&&!l.available&&(n||(n=l.name),l=null,v===this.args.length&&(l=n)),l===null);E+=1);return l},Ss.prototype.eachChild=function(e){this.args.forEach(e)},Ss.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ss.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(n){e.push(n.serialize())}),e};var Ts=function(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n};Ts.prototype.evaluate=function(e){return this.result.evaluate(e)},Ts.prototype.eachChild=function(e){for(var n=0,l=this.bindings;n<l.length;n+=1)e(l[n][1]);e(this.result)},Ts.parse=function(e,n){if(e.length<4)return n.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var l=[],v=1;v<e.length-1;v+=2){var E=e[v];if(typeof E!="string")return n.error("Expected string, but found "+typeof E+" instead.",v);if(/[^a-zA-Z0-9_]/.test(E))return n.error("Variable names must contain only alphanumeric characters or '_'.",v);var C=n.parse(e[v+1],v+1);if(!C)return null;l.push([E,C])}var i=n.parse(e[e.length-1],e.length-1,n.expectedType,l);return i?new Ts(l,i):null},Ts.prototype.outputDefined=function(){return this.result.outputDefined()},Ts.prototype.serialize=function(){for(var e=["let"],n=0,l=this.bindings;n<l.length;n+=1){var v=l[n];e.push(v[0],v[1].serialize())}return e.push(this.result.serialize()),e};var Hs=function(e,n,l){this.type=e,this.index=n,this.input=l};Hs.parse=function(e,n){if(e.length!==3)return n.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var l=n.parse(e[1],1,fe),v=n.parse(e[2],2,Ot(n.expectedType||Ke));return l&&v?new Hs(v.type.itemType,l,v):null},Hs.prototype.evaluate=function(e){var n=this.index.evaluate(e),l=this.input.evaluate(e);if(n<0)throw new Rn("Array index out of bounds: "+n+" < 0.");if(n>=l.length)throw new Rn("Array index out of bounds: "+n+" > "+(l.length-1)+".");if(n!==Math.floor(n))throw new Rn("Array index must be an integer, but found "+n+" instead.");return l[n]},Hs.prototype.eachChild=function(e){e(this.index),e(this.input)},Hs.prototype.outputDefined=function(){return!1},Hs.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var is=function(e,n){this.type=we,this.needle=e,this.haystack=n};is.parse=function(e,n){if(e.length!==3)return n.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var l=n.parse(e[1],1,Ke),v=n.parse(e[2],2,Ke);return l&&v?Ci(l.type,[we,Ee,fe,_e,Ke])?new is(l,v):n.error("Expected first argument to be of type boolean, string, number or null, but found "+Vt(l.type)+" instead"):null},is.prototype.evaluate=function(e){var n=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!l)return!1;if(!ci(n,["boolean","string","number","null"]))throw new Rn("Expected first argument to be of type boolean, string, number or null, but found "+Vt(In(n))+" instead.");if(!ci(l,["string","array"]))throw new Rn("Expected second argument to be of type array or string, but found "+Vt(In(l))+" instead.");return l.indexOf(n)>=0},is.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},is.prototype.outputDefined=function(){return!0},is.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var ja=function(e,n,l){this.type=fe,this.needle=e,this.haystack=n,this.fromIndex=l};ja.parse=function(e,n){if(e.length<=2||e.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var l=n.parse(e[1],1,Ke),v=n.parse(e[2],2,Ke);if(!l||!v)return null;if(!Ci(l.type,[we,Ee,fe,_e,Ke]))return n.error("Expected first argument to be of type boolean, string, number or null, but found "+Vt(l.type)+" instead");if(e.length===4){var E=n.parse(e[3],3,fe);return E?new ja(l,v,E):null}return new ja(l,v)},ja.prototype.evaluate=function(e){var n=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!ci(n,["boolean","string","number","null"]))throw new Rn("Expected first argument to be of type boolean, string, number or null, but found "+Vt(In(n))+" instead.");if(!ci(l,["string","array"]))throw new Rn("Expected second argument to be of type array or string, but found "+Vt(In(l))+" instead.");if(this.fromIndex){var v=this.fromIndex.evaluate(e);return l.indexOf(n,v)}return l.indexOf(n)},ja.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},ja.prototype.outputDefined=function(){return!1},ja.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var _a=function(e,n,l,v,E,C){this.inputType=e,this.type=n,this.input=l,this.cases=v,this.outputs=E,this.otherwise=C};_a.parse=function(e,n){if(e.length<5)return n.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return n.error("Expected an even number of arguments.");var l,v;n.expectedType&&n.expectedType.kind!=="value"&&(v=n.expectedType);for(var E={},C=[],i=2;i<e.length-1;i+=2){var t=e[i],a=e[i+1];Array.isArray(t)||(t=[t]);var p=n.concat(i);if(t.length===0)return p.error("Expected at least one branch label.");for(var _=0,b=t;_<b.length;_+=1){var I=b[_];if(typeof I!="number"&&typeof I!="string")return p.error("Branch labels must be numbers or strings.");if(typeof I=="number"&&Math.abs(I)>Number.MAX_SAFE_INTEGER)return p.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof I=="number"&&Math.floor(I)!==I)return p.error("Numeric branch labels must be integer values.");if(l){if(p.checkSubtype(l,In(I)))return null}else l=In(I);if(E[String(I)]!==void 0)return p.error("Branch labels must be unique.");E[String(I)]=C.length}var P=n.parse(a,i,v);if(!P)return null;v=v||P.type,C.push(P)}var R=n.parse(e[1],1,Ke);if(!R)return null;var O=n.parse(e[e.length-1],e.length-1,v);return O?R.type.kind!=="value"&&n.concat(1).checkSubtype(l,R.type)?null:new _a(l,v,R,E,C,O):null},_a.prototype.evaluate=function(e){var n=this.input.evaluate(e);return(In(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)},_a.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},_a.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},_a.prototype.serialize=function(){for(var e=this,n=["match",this.input.serialize()],l=[],v={},E=0,C=Object.keys(this.cases).sort();E<C.length;E+=1){var i=C[E];(b=v[this.cases[i]])===void 0?(v[this.cases[i]]=l.length,l.push([this.cases[i],[i]])):l[b][1].push(i)}for(var t=function(P){return e.inputType.kind==="number"?Number(P):P},a=0,p=l;a<p.length;a+=1){var _=p[a],b=_[0],I=_[1];n.push(I.length===1?t(I[0]):I.map(t)),n.push(this.outputs[outputIndex$1].serialize())}return n.push(this.otherwise.serialize()),n};var As=function(e,n,l){this.type=e,this.branches=n,this.otherwise=l};As.parse=function(e,n){if(e.length<4)return n.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return n.error("Expected an odd number of arguments.");var l;n.expectedType&&n.expectedType.kind!=="value"&&(l=n.expectedType);for(var v=[],E=1;E<e.length-1;E+=2){var C=n.parse(e[E],E,we);if(!C)return null;var i=n.parse(e[E+1],E+1,l);if(!i)return null;v.push([C,i]),l=l||i.type}var t=n.parse(e[e.length-1],e.length-1,l);return t?new As(l,v,t):null},As.prototype.evaluate=function(e){for(var n=0,l=this.branches;n<l.length;n+=1){var v=l[n],E=v[1];if(v[0].evaluate(e))return E.evaluate(e)}return this.otherwise.evaluate(e)},As.prototype.eachChild=function(e){for(var n=0,l=this.branches;n<l.length;n+=1){var v=l[n],E=v[1];e(v[0]),e(E)}e(this.otherwise)},As.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},As.prototype.serialize=function(){var e=["case"];return this.eachChild(function(n){e.push(n.serialize())}),e};var rs=function(e,n,l,v){this.type=e,this.input=n,this.beginIndex=l,this.endIndex=v};function Au(e,n){return e==="=="||e==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Cs(e,n,l,v){return v.compare(n,l)===0}function Gr(e,n,l){var v=e!=="=="&&e!=="!=";return function(){function E(C,i,t){this.type=we,this.lhs=C,this.rhs=i,this.collator=t,this.hasUntypedArgument=C.type.kind==="value"||i.type.kind==="value"}return E.parse=function(C,i){if(C.length!==3&&C.length!==4)return i.error("Expected two or three arguments.");var t=C[0],a=i.parse(C[1],1,Ke);if(!a)return null;if(!Au(t,a.type))return i.concat(1).error('"'+t+`" comparisons are not supported for type '`+Vt(a.type)+"'.");var p=i.parse(C[2],2,Ke);if(!p)return null;if(!Au(t,p.type))return i.concat(2).error('"'+t+`" comparisons are not supported for type '`+Vt(p.type)+"'.");if(a.type.kind!==p.type.kind&&a.type.kind!=="value"&&p.type.kind!=="value")return i.error("Cannot compare types '"+Vt(a.type)+"' and '"+Vt(p.type)+"'.");v&&(a.type.kind==="value"&&p.type.kind!=="value"?a=new Qr(p.type,[a]):a.type.kind!=="value"&&p.type.kind==="value"&&(p=new Qr(a.type,[p])));var _=null;if(C.length===4){if(a.type.kind!=="string"&&p.type.kind!=="string"&&a.type.kind!=="value"&&p.type.kind!=="value")return i.error("Cannot use collator to compare non-string types.");if(!(_=i.parse(C[3],3,tt)))return null}return new E(a,p,_)},E.prototype.evaluate=function(C){var i=this.lhs.evaluate(C),t=this.rhs.evaluate(C);if(v&&this.hasUntypedArgument){var a=In(i),p=In(t);if(a.kind!==p.kind||a.kind!=="string"&&a.kind!=="number")throw new Rn('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+a.kind+", "+p.kind+") instead.")}if(this.collator&&!v&&this.hasUntypedArgument){var _=In(i),b=In(t);if(_.kind!=="string"||b.kind!=="string")return n(C,i,t)}return this.collator?l(C,i,t,this.collator.evaluate(C)):n(C,i,t)},E.prototype.eachChild=function(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)},E.prototype.outputDefined=function(){return!0},E.prototype.serialize=function(){var C=[e];return this.eachChild(function(i){C.push(i.serialize())}),C},E}()}rs.parse=function(e,n){if(e.length<=2||e.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var l=n.parse(e[1],1,Ke),v=n.parse(e[2],2,fe);if(!l||!v)return null;if(!Ci(l.type,[Ot(Ke),Ee,Ke]))return n.error("Expected first argument to be of type array or string, but found "+Vt(l.type)+" instead");if(e.length===4){var E=n.parse(e[3],3,fe);return E?new rs(l.type,l,v,E):null}return new rs(l.type,l,v)},rs.prototype.evaluate=function(e){var n=this.input.evaluate(e),l=this.beginIndex.evaluate(e);if(!ci(n,["string","array"]))throw new Rn("Expected first argument to be of type array or string, but found "+Vt(In(n))+" instead.");if(this.endIndex){var v=this.endIndex.evaluate(e);return n.slice(l,v)}return n.slice(l)},rs.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},rs.prototype.outputDefined=function(){return!1},rs.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Ws=Gr("==",function(e,n,l){return n===l},Cs),ns=Gr("!=",function(e,n,l){return n!==l},function(e,n,l,v){return!Cs(0,n,l,v)}),nc=Gr("<",function(e,n,l){return n<l},function(e,n,l,v){return v.compare(n,l)<0}),Cu=Gr(">",function(e,n,l){return n>l},function(e,n,l,v){return v.compare(n,l)>0}),Ji=Gr("<=",function(e,n,l){return n<=l},function(e,n,l,v){return v.compare(n,l)<=0}),Zl=Gr(">=",function(e,n,l){return n>=l},function(e,n,l,v){return v.compare(n,l)>=0}),wr=function(e,n,l,v,E){this.type=Ee,this.number=e,this.locale=n,this.currency=l,this.minFractionDigits=v,this.maxFractionDigits=E};wr.parse=function(e,n){if(e.length!==3)return n.error("Expected two arguments.");var l=n.parse(e[1],1,fe);if(!l)return null;var v=e[2];if(typeof v!="object"||Array.isArray(v))return n.error("NumberFormat options argument must be an object.");var E=null;if(v.locale&&!(E=n.parse(v.locale,1,Ee)))return null;var C=null;if(v.currency&&!(C=n.parse(v.currency,1,Ee)))return null;var i=null;if(v["min-fraction-digits"]&&!(i=n.parse(v["min-fraction-digits"],1,fe)))return null;var t=null;return v["max-fraction-digits"]&&!(t=n.parse(v["max-fraction-digits"],1,fe))?null:new wr(l,E,C,i,t)},wr.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},wr.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},wr.prototype.outputDefined=function(){return!1},wr.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var Ta=function(e){this.type=fe,this.input=e};Ta.parse=function(e,n){if(e.length!==2)return n.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var l=n.parse(e[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?n.error("Expected argument of type string or array, but found "+Vt(l.type)+" instead."):new Ta(l):null},Ta.prototype.evaluate=function(e){var n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new Rn("Expected value to be of type string or array, but found "+Vt(In(n))+" instead.")},Ta.prototype.eachChild=function(e){e(this.input)},Ta.prototype.outputDefined=function(){return!1},Ta.prototype.serialize=function(){var e=["length"];return this.eachChild(function(n){e.push(n.serialize())}),e};var Kr={"==":Ws,"!=":ns,">":Cu,"<":nc,">=":Zl,"<=":Ji,array:Qr,at:Hs,boolean:Qr,case:As,coalesce:Ss,collator:Zo,format:aa,image:Fo,in:is,"index-of":ja,interpolate:mo,"interpolate-hcl":mo,"interpolate-lab":mo,length:Ta,let:Ts,literal:Co,match:_a,number:Qr,"number-format":wr,object:Qr,slice:rs,step:po,string:Qr,"to-boolean":sa,"to-color":sa,"to-number":sa,"to-string":sa,var:cr,within:Ho};function An(e,n){var l=n[0],v=n[1],E=n[2],C=n[3];l=l.evaluate(e),v=v.evaluate(e),E=E.evaluate(e);var i=C?C.evaluate(e):1,t=Ol(l,v,E,i);if(t)throw new Rn(t);return new Di(l/255*i,v/255*i,E/255*i,i)}function Hl(e,n){return e in n}function Wl(e,n){var l=n[e];return l===void 0?null:l}function Xs(e){return{type:e}}function ku(e){return{result:"success",value:e}}function Va(e){return{result:"error",value:e}}function qa(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Xl(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function ks(e){return!!e.expression&&e.expression.interpolated}function Jr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function os(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function zu(e){return e}function ko(e,n,l){return e!==void 0?e:n!==void 0?n:l!==void 0?l:void 0}function oc(e,n,l,v,E){return ko(typeof l===E?v[l]:void 0,e.default,n.default)}function Uc(e,n,l){if(Jr(l)!=="number")return ko(e.default,n.default);var v=e.stops.length;if(v===1||l<=e.stops[0][0])return e.stops[0][1];if(l>=e.stops[v-1][0])return e.stops[v-1][1];var E=Is(e.stops.map(function(C){return C[0]}),l);return e.stops[E][1]}function ac(e,n,l){var v=e.base!==void 0?e.base:1;if(Jr(l)!=="number")return ko(e.default,n.default);var E=e.stops.length;if(E===1||l<=e.stops[0][0])return e.stops[0][1];if(l>=e.stops[E-1][0])return e.stops[E-1][1];var C=Is(e.stops.map(function(b){return b[0]}),l),i=function(b,I,P,R){var O=R-P,V=b-P;return O===0?0:I===1?V/O:(Math.pow(I,V)-1)/(Math.pow(I,O)-1)}(l,v,e.stops[C][0],e.stops[C+1][0]),t=e.stops[C][1],a=e.stops[C+1][1],p=fo[n.type]||zu;if(e.colorSpace&&e.colorSpace!=="rgb"){var _=Fc[e.colorSpace];p=function(b,I){return _.reverse(_.interpolate(_.forward(b),_.forward(I),i))}}return typeof t.evaluate=="function"?{evaluate:function(){for(var b=[],I=arguments.length;I--;)b[I]=arguments[I];var P=t.evaluate.apply(void 0,b),R=a.evaluate.apply(void 0,b);if(P!==void 0&&R!==void 0)return p(P,R,i)}}:p(t,a,i)}function as(e,n,l){return n.type==="color"?l=Di.parse(l):n.type==="formatted"?l=Cr.fromString(l.toString()):n.type==="resolvedImage"?l=Eo.fromString(l.toString()):Jr(l)===n.type||n.type==="enum"&&n.values[l]||(l=void 0),ko(l,e.default,n.default)}Sn.register(Kr,{error:[{kind:"error"},[Ee],function(e,n){throw new Rn(n[0].evaluate(e))}],typeof:[Ee,[Ke],function(e,n){return Vt(In(n[0].evaluate(e)))}],"to-rgba":[Ot(fe,4),[Ie],function(e,n){return n[0].evaluate(e).toArray()}],rgb:[Ie,[fe,fe,fe],An],rgba:[Ie,[fe,fe,fe,fe],An],has:{type:we,overloads:[[[Ee],function(e,n){return Hl(n[0].evaluate(e),e.properties())}],[[Ee,et],function(e,n){var l=n[1];return Hl(n[0].evaluate(e),l.evaluate(e))}]]},get:{type:Ke,overloads:[[[Ee],function(e,n){return Wl(n[0].evaluate(e),e.properties())}],[[Ee,et],function(e,n){var l=n[1];return Wl(n[0].evaluate(e),l.evaluate(e))}]]},"feature-state":[Ke,[Ee],function(e,n){return Wl(n[0].evaluate(e),e.featureState||{})}],properties:[et,[],function(e){return e.properties()}],"geometry-type":[Ee,[],function(e){return e.geometryType()}],id:[Ke,[],function(e){return e.id()}],zoom:[fe,[],function(e){return e.globals.zoom}],"heatmap-density":[fe,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[fe,[],function(e){return e.globals.lineProgress||0}],accumulated:[Ke,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[fe,Xs(fe),function(e,n){for(var l=0,v=0,E=n;v<E.length;v+=1)l+=E[v].evaluate(e);return l}],"*":[fe,Xs(fe),function(e,n){for(var l=1,v=0,E=n;v<E.length;v+=1)l*=E[v].evaluate(e);return l}],"-":{type:fe,overloads:[[[fe,fe],function(e,n){var l=n[1];return n[0].evaluate(e)-l.evaluate(e)}],[[fe],function(e,n){return-n[0].evaluate(e)}]]},"/":[fe,[fe,fe],function(e,n){var l=n[1];return n[0].evaluate(e)/l.evaluate(e)}],"%":[fe,[fe,fe],function(e,n){var l=n[1];return n[0].evaluate(e)%l.evaluate(e)}],ln2:[fe,[],function(){return Math.LN2}],pi:[fe,[],function(){return Math.PI}],e:[fe,[],function(){return Math.E}],"^":[fe,[fe,fe],function(e,n){var l=n[1];return Math.pow(n[0].evaluate(e),l.evaluate(e))}],sqrt:[fe,[fe],function(e,n){return Math.sqrt(n[0].evaluate(e))}],log10:[fe,[fe],function(e,n){return Math.log(n[0].evaluate(e))/Math.LN10}],ln:[fe,[fe],function(e,n){return Math.log(n[0].evaluate(e))}],log2:[fe,[fe],function(e,n){return Math.log(n[0].evaluate(e))/Math.LN2}],sin:[fe,[fe],function(e,n){return Math.sin(n[0].evaluate(e))}],cos:[fe,[fe],function(e,n){return Math.cos(n[0].evaluate(e))}],tan:[fe,[fe],function(e,n){return Math.tan(n[0].evaluate(e))}],asin:[fe,[fe],function(e,n){return Math.asin(n[0].evaluate(e))}],acos:[fe,[fe],function(e,n){return Math.acos(n[0].evaluate(e))}],atan:[fe,[fe],function(e,n){return Math.atan(n[0].evaluate(e))}],min:[fe,Xs(fe),function(e,n){return Math.min.apply(Math,n.map(function(l){return l.evaluate(e)}))}],max:[fe,Xs(fe),function(e,n){return Math.max.apply(Math,n.map(function(l){return l.evaluate(e)}))}],abs:[fe,[fe],function(e,n){return Math.abs(n[0].evaluate(e))}],round:[fe,[fe],function(e,n){var l=n[0].evaluate(e);return l<0?-Math.round(-l):Math.round(l)}],floor:[fe,[fe],function(e,n){return Math.floor(n[0].evaluate(e))}],ceil:[fe,[fe],function(e,n){return Math.ceil(n[0].evaluate(e))}],"filter-==":[we,[Ee,Ke],function(e,n){var l=n[0],v=n[1];return e.properties()[l.value]===v.value}],"filter-id-==":[we,[Ke],function(e,n){var l=n[0];return e.id()===l.value}],"filter-type-==":[we,[Ee],function(e,n){var l=n[0];return e.geometryType()===l.value}],"filter-<":[we,[Ee,Ke],function(e,n){var l=n[0],v=n[1],E=e.properties()[l.value],C=v.value;return typeof E==typeof C&&E<C}],"filter-id-<":[we,[Ke],function(e,n){var l=n[0],v=e.id(),E=l.value;return typeof v==typeof E&&v<E}],"filter->":[we,[Ee,Ke],function(e,n){var l=n[0],v=n[1],E=e.properties()[l.value],C=v.value;return typeof E==typeof C&&E>C}],"filter-id->":[we,[Ke],function(e,n){var l=n[0],v=e.id(),E=l.value;return typeof v==typeof E&&v>E}],"filter-<=":[we,[Ee,Ke],function(e,n){var l=n[0],v=n[1],E=e.properties()[l.value],C=v.value;return typeof E==typeof C&&E<=C}],"filter-id-<=":[we,[Ke],function(e,n){var l=n[0],v=e.id(),E=l.value;return typeof v==typeof E&&v<=E}],"filter->=":[we,[Ee,Ke],function(e,n){var l=n[0],v=n[1],E=e.properties()[l.value],C=v.value;return typeof E==typeof C&&E>=C}],"filter-id->=":[we,[Ke],function(e,n){var l=n[0],v=e.id(),E=l.value;return typeof v==typeof E&&v>=E}],"filter-has":[we,[Ke],function(e,n){return n[0].value in e.properties()}],"filter-has-id":[we,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[we,[Ot(Ee)],function(e,n){return n[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[we,[Ot(Ke)],function(e,n){return n[0].value.indexOf(e.id())>=0}],"filter-in-small":[we,[Ee,Ot(Ke)],function(e,n){var l=n[0];return n[1].value.indexOf(e.properties()[l.value])>=0}],"filter-in-large":[we,[Ee,Ot(Ke)],function(e,n){var l=n[0],v=n[1];return function(E,C,i,t){for(;i<=t;){var a=i+t>>1;if(C[a]===E)return!0;C[a]>E?t=a-1:i=a+1}return!1}(e.properties()[l.value],v.value,0,v.value.length-1)}],all:{type:we,overloads:[[[we,we],function(e,n){var l=n[1];return n[0].evaluate(e)&&l.evaluate(e)}],[Xs(we),function(e,n){for(var l=0,v=n;l<v.length;l+=1)if(!v[l].evaluate(e))return!1;return!0}]]},any:{type:we,overloads:[[[we,we],function(e,n){var l=n[1];return n[0].evaluate(e)||l.evaluate(e)}],[Xs(we),function(e,n){for(var l=0,v=n;l<v.length;l+=1)if(v[l].evaluate(e))return!0;return!1}]]},"!":[we,[we],function(e,n){return!n[0].evaluate(e)}],"is-supported-script":[we,[Ee],function(e,n){var l=e.globals&&e.globals.isSupportedScript;return!l||l(n[0].evaluate(e))}],upcase:[Ee,[Ee],function(e,n){return n[0].evaluate(e).toUpperCase()}],downcase:[Ee,[Ee],function(e,n){return n[0].evaluate(e).toLowerCase()}],concat:[Ee,Xs(Ke),function(e,n){return n.map(function(l){return qs(l.evaluate(e))}).join("")}],"resolved-locale":[Ee,[tt],function(e,n){return n[0].evaluate(e).resolvedLocale()}]});var ss=function(e,n){this.expression=e,this._warningHistory={},this._evaluator=new ga,this._defaultValue=n?function(l){return l.type==="color"&&os(l.default)?new Di(0,0,0,0):l.type==="color"?Di.parse(l.default)||null:l.default===void 0?null:l.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null};function Ks(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Kr}function Kl(e,n){var l=new Es(Kr,[],n?function(E){var C={color:Ie,string:Ee,number:fe,enum:Ee,boolean:we,formatted:Ut,resolvedImage:At};return E.type==="array"?Ot(C[E.value]||Ke,E.length):C[E.type]}(n):void 0),v=l.parse(e,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return v?ku(new ss(v,n)):Va(l.errors)}ss.prototype.evaluateWithoutErrorHandling=function(e,n,l,v,E,C){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=l,this._evaluator.canonical=v,this._evaluator.availableImages=E||null,this._evaluator.formattedSection=C,this.expression.evaluate(this._evaluator)},ss.prototype.evaluate=function(e,n,l,v,E,C){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=l||null,this._evaluator.canonical=v,this._evaluator.availableImages=E||null,this._evaluator.formattedSection=C||null;try{var i=this.expression.evaluate(this._evaluator);if(i==null||typeof i=="number"&&i!=i)return this._defaultValue;if(this._enumValues&&!(i in this._enumValues))throw new Rn("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(i)+" instead.");return i}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,typeof console!="undefined"&&console.warn(t.message)),this._defaultValue}};var zs=function(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!Ua(n.expression)};zs.prototype.evaluateWithoutErrorHandling=function(e,n,l,v,E,C){return this._styleExpression.evaluateWithoutErrorHandling(e,n,l,v,E,C)},zs.prototype.evaluate=function(e,n,l,v,E,C){return this._styleExpression.evaluate(e,n,l,v,E,C)};var ls=function(e,n,l,v){this.kind=e,this.zoomStops=l,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!Ua(n.expression),this.interpolationType=v};function sc(e,n){if((e=Kl(e,n)).result==="error")return e;var l=e.value.expression,v=Fa(l);if(!v&&!qa(n))return Va([new ne("","data expressions not supported")]);var E=ws(l,["zoom"]);if(!E&&!Xl(n))return Va([new ne("","zoom expressions not supported")]);var C=function i(t){var a=null;if(t instanceof Ts)a=i(t.result);else if(t instanceof Ss)for(var p=0,_=t.args;p<_.length&&!(a=i(_[p]));p+=1);else(t instanceof po||t instanceof mo)&&t.input instanceof Sn&&t.input.name==="zoom"&&(a=t);return a instanceof ne||t.eachChild(function(b){var I=i(b);I instanceof ne?a=I:!a&&I?a=new ne("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&I&&a!==I&&(a=new ne("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}(l);return C||E?C instanceof ne?Va([C]):C instanceof mo&&!ks(n)?Va([new ne("",'"interpolate" expressions cannot be used with this property')]):ku(C?new ls(v?"camera":"composite",e.value,C.labels,C instanceof mo?C.interpolation:void 0):new zs(v?"constant":"source",e.value)):Va([new ne("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}ls.prototype.evaluateWithoutErrorHandling=function(e,n,l,v,E,C){return this._styleExpression.evaluateWithoutErrorHandling(e,n,l,v,E,C)},ls.prototype.evaluate=function(e,n,l,v,E,C){return this._styleExpression.evaluate(e,n,l,v,E,C)},ls.prototype.interpolationFactor=function(e,n,l){return this.interpolationType?mo.interpolationFactor(this.interpolationType,e,n,l):0};var Ga=function(e,n){this._parameters=e,this._specification=n,ae(this,function l(v,E){var C,i,t,a=E.type==="color",p=v.stops&&typeof v.stops[0][0]=="object",_=p||!(p||v.property!==void 0),b=v.type||(ks(E)?"exponential":"interval");if(a&&((v=ae({},v)).stops&&(v.stops=v.stops.map(function(Ge){return[Ge[0],Di.parse(Ge[1])]})),v.default=Di.parse(v.default?v.default:E.default)),v.colorSpace&&v.colorSpace!=="rgb"&&!Fc[v.colorSpace])throw new Error("Unknown color space: "+v.colorSpace);if(b==="exponential")C=ac;else if(b==="interval")C=Uc;else if(b==="categorical"){C=oc,i=Object.create(null);for(var I=0,P=v.stops;I<P.length;I+=1){var R=P[I];i[R[0]]=R[1]}t=typeof v.stops[0][0]}else{if(b!=="identity")throw new Error('Unknown function type "'+b+'"');C=as}if(p){for(var O={},V=[],j=0;j<v.stops.length;j++){var K=v.stops[j],Y=K[0].zoom;O[Y]===void 0&&(O[Y]={zoom:Y,type:v.type,property:v.property,default:v.default,stops:[]},V.push(Y)),O[Y].stops.push([K[0].value,K[1]])}for(var Q=[],se=0,pe=V;se<pe.length;se+=1){var Ae=pe[se];Q.push([O[Ae].zoom,l(O[Ae],E)])}var Be={name:"linear"};return{kind:"composite",interpolationType:Be,interpolationFactor:mo.interpolationFactor.bind(void 0,Be),zoomStops:Q.map(function(Ge){return Ge[0]}),evaluate:function(Ge,it){var He=Ge.zoom;return ac({stops:Q,base:v.base},E,He).evaluate(He,it)}}}if(_){var qe=b==="exponential"?{name:"exponential",base:v.base!==void 0?v.base:1}:null;return{kind:"camera",interpolationType:qe,interpolationFactor:mo.interpolationFactor.bind(void 0,qe),zoomStops:v.stops.map(function(Ge){return Ge[0]}),evaluate:function(Ge){return C(v,E,Ge.zoom,i,t)}}}return{kind:"source",evaluate:function(Ge,it){var He=it&&it.properties?it.properties[v.property]:void 0;return He===void 0?ko(v.default,E.default):C(v,E,He,i,t)}}}(this._parameters,this._specification))};function la(e){var n=e.key,l=e.value,v=e.valueSpec||{},E=e.objectElementValidators||{},C=e.style,i=e.styleSpec,t=[],a=Jr(l);if(a!=="object")return[new Me(n,l,"object expected, "+a+" found")];for(var p in l){var _=p.split(".")[0],b=v[_]||v["*"],I=void 0;if(E[_])I=E[_];else if(v[_])I=Qi;else if(E["*"])I=E["*"];else{if(!v["*"]){t.push(new Me(n,l[p],'unknown property "'+p+'"'));continue}I=Qi}t=t.concat(I({key:(n&&n+".")+p,value:l[p],valueSpec:b,style:C,styleSpec:i,object:l,objectKey:p},l))}for(var P in v)E[P]||v[P].required&&v[P].default===void 0&&l[P]===void 0&&t.push(new Me(n,l,'missing required property "'+P+'"'));return t}function Jl(e){var n=e.value,l=e.valueSpec,v=e.style,E=e.styleSpec,C=e.key,i=e.arrayElementValidator||Qi;if(Jr(n)!=="array")return[new Me(C,n,"array expected, "+Jr(n)+" found")];if(l.length&&n.length!==l.length)return[new Me(C,n,"array length "+l.length+" expected, length "+n.length+" found")];if(l["min-length"]&&n.length<l["min-length"])return[new Me(C,n,"array length at least "+l["min-length"]+" expected, length "+n.length+" found")];var t={type:l.value,values:l.values};E.$version<7&&(t.function=l.function),Jr(l.value)==="object"&&(t=l.value);for(var a=[],p=0;p<n.length;p++)a=a.concat(i({array:n,arrayIndex:p,value:n[p],valueSpec:t,style:v,styleSpec:E,key:C+"["+p+"]"}));return a}function $l(e){var n=e.key,l=e.value,v=e.valueSpec,E=Jr(l);return E==="number"&&l!=l&&(E="NaN"),E!=="number"?[new Me(n,l,"number expected, "+E+" found")]:"minimum"in v&&l<v.minimum?[new Me(n,l,l+" is less than the minimum value "+v.minimum)]:"maximum"in v&&l>v.maximum?[new Me(n,l,l+" is greater than the maximum value "+v.maximum)]:[]}function Js(e){var n,l,v,E=e.valueSpec,C=W(e.value.type),i={},t=C!=="categorical"&&e.value.property===void 0,a=!t,p=Jr(e.value.stops)==="array"&&Jr(e.value.stops[0])==="array"&&Jr(e.value.stops[0][0])==="object",_=la({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(P){if(C==="identity")return[new Me(P.key,P.value,'identity function may not have a "stops" property')];var R=[],O=P.value;return R=R.concat(Jl({key:P.key,value:O,valueSpec:P.valueSpec,style:P.style,styleSpec:P.styleSpec,arrayElementValidator:b})),Jr(O)==="array"&&O.length===0&&R.push(new Me(P.key,O,"array must have at least one stop")),R},default:function(P){return Qi({key:P.key,value:P.value,valueSpec:E,style:P.style,styleSpec:P.styleSpec})}}});return C==="identity"&&t&&_.push(new Me(e.key,e.value,'missing required property "property"')),C==="identity"||e.value.stops||_.push(new Me(e.key,e.value,'missing required property "stops"')),C==="exponential"&&e.valueSpec.expression&&!ks(e.valueSpec)&&_.push(new Me(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(a&&!qa(e.valueSpec)?_.push(new Me(e.key,e.value,"property functions not supported")):t&&!Xl(e.valueSpec)&&_.push(new Me(e.key,e.value,"zoom functions not supported"))),C!=="categorical"&&!p||e.value.property!==void 0||_.push(new Me(e.key,e.value,'"property" property is required')),_;function b(P){var R=[],O=P.value,V=P.key;if(Jr(O)!=="array")return[new Me(V,O,"array expected, "+Jr(O)+" found")];if(O.length!==2)return[new Me(V,O,"array length 2 expected, length "+O.length+" found")];if(p){if(Jr(O[0])!=="object")return[new Me(V,O,"object expected, "+Jr(O[0])+" found")];if(O[0].zoom===void 0)return[new Me(V,O,"object stop key must have zoom")];if(O[0].value===void 0)return[new Me(V,O,"object stop key must have value")];if(v&&v>W(O[0].zoom))return[new Me(V,O[0].zoom,"stop zoom values must appear in ascending order")];W(O[0].zoom)!==v&&(v=W(O[0].zoom),l=void 0,i={}),R=R.concat(la({key:V+"[0]",value:O[0],valueSpec:{zoom:{}},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{zoom:$l,value:I}}))}else R=R.concat(I({key:V+"[0]",value:O[0],valueSpec:{},style:P.style,styleSpec:P.styleSpec},O));return Ks(X(O[1]))?R.concat([new Me(V+"[1]",O[1],"expressions are not allowed in function stops.")]):R.concat(Qi({key:V+"[1]",value:O[1],valueSpec:E,style:P.style,styleSpec:P.styleSpec}))}function I(P,R){var O=Jr(P.value),V=W(P.value),j=P.value!==null?P.value:R;if(n){if(O!==n)return[new Me(P.key,j,O+" stop domain type must match previous stop domain type "+n)]}else n=O;if(O!=="number"&&O!=="string"&&O!=="boolean")return[new Me(P.key,j,"stop domain value must be a number, string, or boolean")];if(O!=="number"&&C!=="categorical"){var K="number expected, "+O+" found";return qa(E)&&C===void 0&&(K+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Me(P.key,j,K)]}return C!=="categorical"||O!=="number"||isFinite(V)&&Math.floor(V)===V?C!=="categorical"&&O==="number"&&l!==void 0&&V<l?[new Me(P.key,j,"stop domain values must appear in ascending order")]:(l=V,C==="categorical"&&V in i?[new Me(P.key,j,"stop domain values must be unique")]:(i[V]=!0,[])):[new Me(P.key,j,"integer expected, found "+V)]}}function Aa(e){var n=(e.expressionContext==="property"?sc:Kl)(X(e.value),e.valueSpec);if(n.result==="error")return n.value.map(function(v){return new Me(""+e.key+v.key,e.value,v.message)});var l=n.value.expression||n.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!l.outputDefined())return[new Me(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!Ua(l))return[new Me(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!Ua(l))return[new Me(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!ws(l,["zoom","feature-state"]))return[new Me(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Fa(l))return[new Me(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function vl(e){var n=e.key,l=e.value,v=e.valueSpec,E=[];return Array.isArray(v.values)?v.values.indexOf(W(l))===-1&&E.push(new Me(n,l,"expected one of ["+v.values.join(", ")+"], "+JSON.stringify(l)+" found")):Object.keys(v.values).indexOf(W(l))===-1&&E.push(new Me(n,l,"expected one of ["+Object.keys(v.values).join(", ")+"], "+JSON.stringify(l)+" found")),E}function Ps(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var n=0,l=e.slice(1);n<l.length;n+=1){var v=l[n];if(!Ps(v)&&typeof v!="boolean")return!1}return!0;default:return!0}}Ga.deserialize=function(e){return new Ga(e._parameters,e._specification)},Ga.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Pu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Yl(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Ps(e)||(e=us(e));var n=Kl(e,Pu);if(n.result==="error")throw new Error(n.value.map(function(l){return l.key+": "+l.message}).join(", "));return{filter:function(l,v,E){return n.value.evaluate(l,v,{},E)},needGeometry:function l(v){if(!Array.isArray(v))return!1;if(v[0]==="within")return!0;for(var E=1;E<v.length;E++)if(l(v[E]))return!0;return!1}(e)}}function Nc(e,n){return e<n?-1:e>n?1:0}function us(e){if(!e)return!0;var n,l=e[0];return e.length<=1?l!=="any":l==="=="?Mu(e[1],e[2],"=="):l==="!="?zo(Mu(e[1],e[2],"==")):l==="<"||l===">"||l==="<="||l===">="?Mu(e[1],e[2],l):l==="any"?(n=e.slice(1),["any"].concat(n.map(us))):l==="all"?["all"].concat(e.slice(1).map(us)):l==="none"?["all"].concat(e.slice(1).map(us).map(zo)):l==="in"?xl(e[1],e.slice(2)):l==="!in"?zo(xl(e[1],e.slice(2))):l==="has"?bl(e[1]):l==="!has"?zo(bl(e[1])):l!=="within"||e}function Mu(e,n,l){switch(e){case"$type":return["filter-type-"+l,n];case"$id":return["filter-id-"+l,n];default:return["filter-"+l,e,n]}}function xl(e,n){if(n.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(function(l){return typeof l!=typeof n[0]})?["filter-in-large",e,["literal",n.sort(Nc)]]:["filter-in-small",e,["literal",n]]}}function bl(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function zo(e){return["!",e]}function Po(e){return Ps(X(e.value))?Aa(ae({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function n(l){var v=l.value,E=l.key;if(Jr(v)!=="array")return[new Me(E,v,"array expected, "+Jr(v)+" found")];var C,i=l.styleSpec,t=[];if(v.length<1)return[new Me(E,v,"filter array must have at least 1 element")];switch(t=t.concat(vl({key:E+"[0]",value:v[0],valueSpec:i.filter_operator,style:l.style,styleSpec:l.styleSpec})),W(v[0])){case"<":case"<=":case">":case">=":v.length>=2&&W(v[1])==="$type"&&t.push(new Me(E,v,'"$type" cannot be use with operator "'+v[0]+'"'));case"==":case"!=":v.length!==3&&t.push(new Me(E,v,'filter array for operator "'+v[0]+'" must have 3 elements'));case"in":case"!in":v.length>=2&&(C=Jr(v[1]))!=="string"&&t.push(new Me(E+"[1]",v[1],"string expected, "+C+" found"));for(var a=2;a<v.length;a++)C=Jr(v[a]),W(v[1])==="$type"?t=t.concat(vl({key:E+"["+a+"]",value:v[a],valueSpec:i.geometry_type,style:l.style,styleSpec:l.styleSpec})):C!=="string"&&C!=="number"&&C!=="boolean"&&t.push(new Me(E+"["+a+"]",v[a],"string, number, or boolean expected, "+C+" found"));break;case"any":case"all":case"none":for(var p=1;p<v.length;p++)t=t.concat(n({key:E+"["+p+"]",value:v[p],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":C=Jr(v[1]),v.length!==2?t.push(new Me(E,v,'filter array for "'+v[0]+'" operator must have 2 elements')):C!=="string"&&t.push(new Me(E+"[1]",v[1],"string expected, "+C+" found"));break;case"within":C=Jr(v[1]),v.length!==2?t.push(new Me(E,v,'filter array for "'+v[0]+'" operator must have 2 elements')):C!=="object"&&t.push(new Me(E+"[1]",v[1],"object expected, "+C+" found"))}return t}(e)}function lc(e,n){var l=e.key,v=e.style,E=e.styleSpec,C=e.value,i=e.objectKey,t=E[n+"_"+e.layerType];if(!t)return[];var a=i.match(/^(.*)-transition$/);if(n==="paint"&&a&&t[a[1]]&&t[a[1]].transition)return Qi({key:l,value:C,valueSpec:E.transition,style:v,styleSpec:E});var p,_=e.valueSpec||t[i];if(!_)return[new Me(l,C,'unknown property "'+i+'"')];if(Jr(C)==="string"&&qa(_)&&!_.tokens&&(p=/^{([^}]+)}$/.exec(C)))return[new Me(l,C,'"'+i+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(p[1])+" }`.")];var b=[];return e.layerType==="symbol"&&(i==="text-field"&&v&&!v.glyphs&&b.push(new Me(l,C,'use of "text-field" requires a style "glyphs" property')),i==="text-font"&&os(X(C))&&W(C.type)==="identity"&&b.push(new Me(l,C,'"text-font" does not support identity functions'))),b.concat(Qi({key:e.key,value:C,valueSpec:_,style:v,styleSpec:E,expressionContext:"property",propertyType:n,propertyKey:i}))}function cs(e){return lc(e,"paint")}function wl(e){return lc(e,"layout")}function $s(e){var n=[],l=e.value,v=e.key,E=e.style,C=e.styleSpec;l.type||l.ref||n.push(new Me(v,l,'either "type" or "ref" is required'));var i,t=W(l.type),a=W(l.ref);if(l.id)for(var p=W(l.id),_=0;_<e.arrayIndex;_++){var b=E.layers[_];W(b.id)===p&&n.push(new Me(v,l.id,'duplicate layer id "'+l.id+'", previously used at line '+b.id.__line__))}if("ref"in l)["type","source","source-layer","filter","layout"].forEach(function(R){R in l&&n.push(new Me(v,l[R],'"'+R+'" is prohibited for ref layers'))}),E.layers.forEach(function(R){W(R.id)===a&&(i=R)}),i?i.ref?n.push(new Me(v,l.ref,"ref cannot reference another ref layer")):t=W(i.type):n.push(new Me(v,l.ref,'ref layer "'+a+'" not found'));else if(t!=="background")if(l.source){var I=E.sources&&E.sources[l.source],P=I&&W(I.type);I?P==="vector"&&t==="raster"?n.push(new Me(v,l.source,'layer "'+l.id+'" requires a raster source')):P==="raster"&&t!=="raster"?n.push(new Me(v,l.source,'layer "'+l.id+'" requires a vector source')):P!=="vector"||l["source-layer"]?P==="raster-dem"&&t!=="hillshade"?n.push(new Me(v,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):t!=="line"||!l.paint||!l.paint["line-gradient"]||P==="geojson"&&I.lineMetrics||n.push(new Me(v,l,'layer "'+l.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):n.push(new Me(v,l,'layer "'+l.id+'" must specify a "source-layer"')):n.push(new Me(v,l.source,'source "'+l.source+'" not found'))}else n.push(new Me(v,l,'missing required property "source"'));return n=n.concat(la({key:v,value:l,valueSpec:C.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Qi({key:v+".type",value:l.type,valueSpec:C.layer.type,style:e.style,styleSpec:e.styleSpec,object:l,objectKey:"type"})},filter:Po,layout:function(R){return la({layer:l,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":function(O){return wl(ae({layerType:t},O))}}})},paint:function(R){return la({layer:l,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":function(O){return cs(ae({layerType:t},O))}}})}}}))}function ua(e){var n=e.value,l=e.key,v=Jr(n);return v!=="string"?[new Me(l,n,"string expected, "+v+" found")]:[]}var sn={promoteId:function(e){var n=e.key,l=e.value;if(Jr(l)==="string")return ua({key:n,value:l});var v=[];for(var E in l)v.push.apply(v,ua({key:n+"."+E,value:l[E]}));return v}};function El(e){var n=e.value,l=e.key,v=e.styleSpec,E=e.style;if(!n.type)return[new Me(l,n,'"type" is required')];var C,i=W(n.type);switch(i){case"vector":case"raster":case"raster-dem":return la({key:l,value:n,valueSpec:v["source_"+i.replace("-","_")],style:e.style,styleSpec:v,objectElementValidators:sn});case"geojson":if(C=la({key:l,value:n,valueSpec:v.source_geojson,style:E,styleSpec:v,objectElementValidators:sn}),n.cluster)for(var t in n.clusterProperties){var a=n.clusterProperties[t],p=a[0],_=typeof p=="string"?[p,["accumulated"],["get",t]]:p;C.push.apply(C,Aa({key:l+"."+t+".map",value:a[1],expressionContext:"cluster-map"})),C.push.apply(C,Aa({key:l+"."+t+".reduce",value:_,expressionContext:"cluster-reduce"}))}return C;case"video":return la({key:l,value:n,valueSpec:v.source_video,style:E,styleSpec:v});case"image":return la({key:l,value:n,valueSpec:v.source_image,style:E,styleSpec:v});case"canvas":return[new Me(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vl({key:l+".type",value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:E,styleSpec:v})}}function Ys(e){var n=e.value,l=e.styleSpec,v=l.light,E=e.style,C=[],i=Jr(n);if(n===void 0)return C;if(i!=="object")return C.concat([new Me("light",n,"object expected, "+i+" found")]);for(var t in n){var a=t.match(/^(.*)-transition$/);C=C.concat(a&&v[a[1]]&&v[a[1]].transition?Qi({key:t,value:n[t],valueSpec:l.transition,style:E,styleSpec:l}):v[t]?Qi({key:t,value:n[t],valueSpec:v[t],style:E,styleSpec:l}):[new Me(t,n[t],'unknown property "'+t+'"')])}return C}var hs={"*":function(){return[]},array:Jl,boolean:function(e){var n=e.value,l=e.key,v=Jr(n);return v!=="boolean"?[new Me(l,n,"boolean expected, "+v+" found")]:[]},number:$l,color:function(e){var n=e.key,l=e.value,v=Jr(l);return v!=="string"?[new Me(n,l,"color expected, "+v+" found")]:Kt(l)===null?[new Me(n,l,'color expected, "'+l+'" found')]:[]},constants:Qe,enum:vl,filter:Po,function:Js,layer:$s,object:la,source:El,light:Ys,string:ua,formatted:function(e){return ua(e).length===0?[]:Aa(e)},resolvedImage:function(e){return ua(e).length===0?[]:Aa(e)}};function Qi(e){var n=e.value,l=e.valueSpec,v=e.styleSpec;return l.expression&&os(W(n))?Js(e):l.expression&&Ks(X(n))?Aa(e):l.type&&hs[l.type]?hs[l.type](e):la(ae({},e,{valueSpec:l.type?v[l.type]:l}))}function Mr(e){var n=e.value,l=e.key,v=ua(e);return v.length||(n.indexOf("{fontstack}")===-1&&v.push(new Me(l,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&v.push(new Me(l,n,'"glyphs" url must include a "{range}" token'))),v}function Jt(e,n){n===void 0&&(n=ye);var l=[];return l=l.concat(Qi({key:"",value:e,valueSpec:n.$root,styleSpec:n,style:e,objectElementValidators:{glyphs:Mr,"*":function(){return[]}}})),e.constants&&(l=l.concat(Qe({key:"constants",value:e.constants,style:e,styleSpec:n}))),Qs(l)}function Qs(e){return[].concat(e).sort(function(n,l){return n.line-l.line})}function Za(e){return function(){for(var n=[],l=arguments.length;l--;)n[l]=arguments[l];return Qs(e.apply(this,n))}}Jt.source=Za(El),Jt.light=Za(Ys),Jt.layer=Za($s),Jt.filter=Za(Po),Jt.paintProperty=Za(cs),Jt.layoutProperty=Za(wl);var Ca=Jt,Ql=Ca.light,ri=Ca.paintProperty,el=Ca.layoutProperty;function Il(e,n){var l=!1;if(n&&n.length)for(var v=0,E=n;v<E.length;v+=1)e.fire(new Oe(new Error(E[v].message))),l=!0;return l}var ps=pn;function pn(e,n,l){var v=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var E=new Int32Array(this.arrayBuffer);e=E[0],this.d=(n=E[1])+2*(l=E[2]);for(var C=0;C<this.d*this.d;C++){var i=E[3+C],t=E[3+C+1];v.push(i===t?null:E.subarray(i,t))}var a=E[3+v.length+1];this.keys=E.subarray(E[3+v.length],a),this.bboxes=E.subarray(a),this.insert=this._insertReadonly}else{this.d=n+2*l;for(var p=0;p<this.d*this.d;p++)v.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=e,this.padding=l,this.scale=n/e,this.uid=0;var _=l/n*e;this.min=-_,this.max=e+_}pn.prototype.insert=function(e,n,l,v,E){this._forEachCell(n,l,v,E,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(v),this.bboxes.push(E)},pn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},pn.prototype._insertCell=function(e,n,l,v,E,C){this.cells[E].push(C)},pn.prototype.query=function(e,n,l,v,E){var C=this.min,i=this.max;if(e<=C&&n<=C&&i<=l&&i<=v&&!E)return Array.prototype.slice.call(this.keys);var t=[];return this._forEachCell(e,n,l,v,this._queryCell,t,{},E),t},pn.prototype._queryCell=function(e,n,l,v,E,C,i,t){var a=this.cells[E];if(a!==null)for(var p=this.keys,_=this.bboxes,b=0;b<a.length;b++){var I=a[b];if(i[I]===void 0){var P=4*I;(t?t(_[P+0],_[P+1],_[P+2],_[P+3]):e<=_[P+2]&&n<=_[P+3]&&l>=_[P+0]&&v>=_[P+1])?(i[I]=!0,C.push(p[I])):i[I]=!1}}},pn.prototype._forEachCell=function(e,n,l,v,E,C,i,t){for(var a=this._convertToCellCoord(e),p=this._convertToCellCoord(n),_=this._convertToCellCoord(l),b=this._convertToCellCoord(v),I=a;I<=_;I++)for(var P=p;P<=b;P++){var R=this.d*P+I;if((!t||t(this._convertFromCellCoord(I),this._convertFromCellCoord(P),this._convertFromCellCoord(I+1),this._convertFromCellCoord(P+1)))&&E.call(this,e,n,l,v,R,C,i,t))return}},pn.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},pn.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},pn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,n=3+this.cells.length+1+1,l=0,v=0;v<this.cells.length;v++)l+=this.cells[v].length;var E=new Int32Array(n+l+this.keys.length+this.bboxes.length);E[0]=this.extent,E[1]=this.n,E[2]=this.padding;for(var C=n,i=0;i<e.length;i++){var t=e[i];E[3+i]=C,E.set(t,C),C+=t.length}return E[3+e.length]=C,E.set(this.keys,C),E[3+e.length+1]=C+=this.keys.length,E.set(this.bboxes,C),C+=this.bboxes.length,E.buffer};var Sl=H.ImageData,uc=H.ImageBitmap,zn={};function oi(e,n,l){l===void 0&&(l={}),Object.defineProperty(n,"_classRegistryKey",{value:e,writeable:!1}),zn[e]={klass:n,omit:l.omit||[],shallow:l.shallow||[]}}for(var Io in oi("Object",Object),ps.serialize=function(e,n){var l=e.toArrayBuffer();return n&&n.push(l),{buffer:l}},ps.deserialize=function(e){return new ps(e.buffer)},oi("Grid",ps),oi("Color",Di),oi("Error",Error),oi("ResolvedImage",Eo),oi("StylePropertyFunction",Ga),oi("StyleExpression",ss,{omit:["_evaluator"]}),oi("ZoomDependentExpression",ls),oi("ZoomConstantExpression",zs),oi("CompoundExpression",Sn,{omit:["_evaluate"]}),Kr)Kr[Io]._classRegistryKey||oi("Expression_"+Io,Kr[Io]);function Tl(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Ms(e){return uc&&e instanceof uc}function ca(e,n){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Tl(e)||Ms(e))return n&&n.push(e),e;if(ArrayBuffer.isView(e)){var l=e;return n&&n.push(l.buffer),l}if(e instanceof Sl)return n&&n.push(e.data.buffer),e;if(Array.isArray(e)){for(var v=[],E=0,C=e;E<C.length;E+=1)v.push(ca(C[E],n));return v}if(typeof e=="object"){var i=e.constructor,t=i._classRegistryKey;if(!t)throw new Error("can't serialize object of unregistered class");var a=i.serialize?i.serialize(e,n):{};if(!i.serialize){for(var p in e)if(e.hasOwnProperty(p)&&!(zn[t].omit.indexOf(p)>=0)){var _=e[p];a[p]=zn[t].shallow.indexOf(p)>=0?_:ca(_,n)}e instanceof Error&&(a.message=e.message)}if(a.$name)throw new Error("$name property is reserved for worker serialization logic.");return t!=="Object"&&(a.$name=t),a}throw new Error("can't serialize object of type "+typeof e)}function ln(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Tl(e)||Ms(e)||ArrayBuffer.isView(e)||e instanceof Sl)return e;if(Array.isArray(e))return e.map(ln);if(typeof e=="object"){var n=e.$name||"Object",l=zn[n].klass;if(!l)throw new Error("can't deserialize unregistered class "+n);if(l.deserialize)return l.deserialize(e);for(var v=Object.create(l.prototype),E=0,C=Object.keys(e);E<C.length;E+=1){var i=C[E];if(i!=="$name"){var t=e[i];v[i]=zn[n].shallow.indexOf(i)>=0?t:ln(t)}}return v}throw new Error("can't deserialize object of type "+typeof e)}var Ha=function(){this.first=!0};Ha.prototype.update=function(e,n){var l=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=l,!0))};var qt={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function eu(e){for(var n=0,l=e;n<l.length;n+=1)if(ds(l[n].charCodeAt(0)))return!0;return!1}function ds(e){return!(e!==746&&e!==747&&(e<4352||!(qt["Bopomofo Extended"](e)||qt.Bopomofo(e)||qt["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||qt["CJK Compatibility Ideographs"](e)||qt["CJK Compatibility"](e)||qt["CJK Radicals Supplement"](e)||qt["CJK Strokes"](e)||!(!qt["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||qt["CJK Unified Ideographs Extension A"](e)||qt["CJK Unified Ideographs"](e)||qt["Enclosed CJK Letters and Months"](e)||qt["Hangul Compatibility Jamo"](e)||qt["Hangul Jamo Extended-A"](e)||qt["Hangul Jamo Extended-B"](e)||qt["Hangul Jamo"](e)||qt["Hangul Syllables"](e)||qt.Hiragana(e)||qt["Ideographic Description Characters"](e)||qt.Kanbun(e)||qt["Kangxi Radicals"](e)||qt["Katakana Phonetic Extensions"](e)||qt.Katakana(e)&&e!==12540||!(!qt["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!qt["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||qt["Unified Canadian Aboriginal Syllabics"](e)||qt["Unified Canadian Aboriginal Syllabics Extended"](e)||qt["Vertical Forms"](e)||qt["Yijing Hexagram Symbols"](e)||qt["Yi Syllables"](e)||qt["Yi Radicals"](e))))}function tu(e){return!(ds(e)||function(n){return!!(qt["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||qt["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||qt["Letterlike Symbols"](n)||qt["Number Forms"](n)||qt["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||qt["Control Pictures"](n)&&n!==9251||qt["Optical Character Recognition"](n)||qt["Enclosed Alphanumerics"](n)||qt["Geometric Shapes"](n)||qt["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||qt["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||qt["CJK Symbols and Punctuation"](n)||qt.Katakana(n)||qt["Private Use Area"](n)||qt["CJK Compatibility Forms"](n)||qt["Small Form Variants"](n)||qt["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(e))}function Uo(e){return e>=1424&&e<=2303||qt["Arabic Presentation Forms-A"](e)||qt["Arabic Presentation Forms-B"](e)}function dn(e,n){return!(!n&&Uo(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||qt.Khmer(e))}function rn(e){for(var n=0,l=e;n<l.length;n+=1)if(Uo(l[n].charCodeAt(0)))return!0;return!1}var tl=null,So="unavailable",ka=null,cc=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(So="error"),tl&&tl(e)};function Al(){hc.fire(new Se("pluginStateChange",{pluginStatus:So,pluginURL:ka}))}var hc=new Ve,va=function(){return So},Wo=function(){if(So!=="deferred"||!ka)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");So="loading",Al(),ka&&Oo({url:ka},function(e){e?cc(e):(So="loaded",Al())})},si={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return So==="loaded"||si.applyArabicShaping!=null},isLoading:function(){return So==="loading"},setState:function(e){So=e.pluginStatus,ka=e.pluginURL},isParsed:function(){return si.applyArabicShaping!=null&&si.processBidirectionalText!=null&&si.processStyledBidirectionalText!=null},getPluginURL:function(){return ka}},Nt=function(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ha,this.transition={})};Nt.prototype.isSupportedScript=function(e){return function(n,l){for(var v=0,E=n;v<E.length;v+=1)if(!dn(E[v].charCodeAt(0),l))return!1;return!0}(e,si.isLoaded())},Nt.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Nt.prototype.getCrossfadeParameters=function(){var e=this.zoom,n=e-Math.floor(e),l=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*n}};var Xo=function(e,n){this.property=e,this.value=n,this.expression=function(l,v){if(os(l))return new Ga(l,v);if(Ks(l)){var E=sc(l,v);if(E.result==="error")throw new Error(E.value.map(function(i){return i.key+": "+i.message}).join(", "));return E.value}var C=l;return typeof l=="string"&&v.type==="color"&&(C=Di.parse(l)),{kind:"constant",evaluate:function(){return C}}}(n===void 0?e.specification.default:n,e.specification)};Xo.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Xo.prototype.possiblyEvaluate=function(e,n,l){return this.property.possiblyEvaluate(this,e,n,l)};var Mo=function(e){this.property=e,this.value=new Xo(e,void 0)};Mo.prototype.transitioned=function(e,n){return new fn(this.property,this.value,n,Ne({},e.transition,this.transition),e.now)},Mo.prototype.untransitioned=function(){return new fn(this.property,this.value,null,{},0)};var jn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};jn.prototype.getValue=function(e){return Ei(this._values[e].value.value)},jn.prototype.setValue=function(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Mo(this._values[e].property)),this._values[e].value=new Xo(this._values[e].property,n===null?void 0:Ei(n))},jn.prototype.getTransition=function(e){return Ei(this._values[e].transition)},jn.prototype.setTransition=function(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Mo(this._values[e].property)),this._values[e].transition=Ei(n)||void 0},jn.prototype.serialize=function(){for(var e={},n=0,l=Object.keys(this._values);n<l.length;n+=1){var v=l[n],E=this.getValue(v);E!==void 0&&(e[v]=E);var C=this.getTransition(v);C!==void 0&&(e[v+"-transition"]=C)}return e},jn.prototype.transitioned=function(e,n){for(var l=new Ko(this._properties),v=0,E=Object.keys(this._values);v<E.length;v+=1){var C=E[v];l._values[C]=this._values[C].transitioned(e,n._values[C])}return l},jn.prototype.untransitioned=function(){for(var e=new Ko(this._properties),n=0,l=Object.keys(this._values);n<l.length;n+=1){var v=l[n];e._values[v]=this._values[v].untransitioned()}return e};var fn=function(e,n,l,v,E){this.property=e,this.value=n,this.begin=E+v.delay||0,this.end=this.begin+v.duration||0,e.specification.transition&&(v.delay||v.duration)&&(this.prior=l)};fn.prototype.possiblyEvaluate=function(e,n,l){var v=e.now||0,E=this.value.possiblyEvaluate(e,n,l),C=this.prior;if(C){if(v>this.end)return this.prior=null,E;if(this.value.isDataDriven())return this.prior=null,E;if(v<this.begin)return C.possiblyEvaluate(e,n,l);var i=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(C.possiblyEvaluate(e,n,l),E,function(t){if(t<=0)return 0;if(t>=1)return 1;var a=t*t,p=a*t;return 4*(t<.5?p:3*(t-a)+p-.75)}(i))}return E};var Ko=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Ko.prototype.possiblyEvaluate=function(e,n,l){for(var v=new fs(this._properties),E=0,C=Object.keys(this._values);E<C.length;E+=1){var i=C[E];v._values[i]=this._values[i].possiblyEvaluate(e,n,l)}return v},Ko.prototype.hasTransition=function(){for(var e=0,n=Object.keys(this._values);e<n.length;e+=1)if(this._values[n[e]].prior)return!0;return!1};var vn=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};vn.prototype.getValue=function(e){return Ei(this._values[e].value)},vn.prototype.setValue=function(e,n){this._values[e]=new Xo(this._values[e].property,n===null?void 0:Ei(n))},vn.prototype.serialize=function(){for(var e={},n=0,l=Object.keys(this._values);n<l.length;n+=1){var v=l[n],E=this.getValue(v);E!==void 0&&(e[v]=E)}return e},vn.prototype.possiblyEvaluate=function(e,n,l){for(var v=new fs(this._properties),E=0,C=Object.keys(this._values);E<C.length;E+=1){var i=C[E];v._values[i]=this._values[i].possiblyEvaluate(e,n,l)}return v};var Lo=function(e,n,l){this.property=e,this.value=n,this.parameters=l};Lo.prototype.isConstant=function(){return this.value.kind==="constant"},Lo.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Lo.prototype.evaluate=function(e,n,l,v){return this.property.evaluate(this.value,this.parameters,e,n,l,v)};var fs=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};fs.prototype.get=function(e){return this._values[e]};var Zt=function(e){this.specification=e};Zt.prototype.possiblyEvaluate=function(e,n){return e.expression.evaluate(n)},Zt.prototype.interpolate=function(e,n,l){var v=fo[this.specification.type];return v?v(e,n,l):e};var Gt=function(e,n){this.specification=e,this.overrides=n};Gt.prototype.possiblyEvaluate=function(e,n,l,v){return new Lo(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},l,v)}:e.expression,n)},Gt.prototype.interpolate=function(e,n,l){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new Lo(this,{kind:"constant",value:void 0},e.parameters);var v=fo[this.specification.type];return v?new Lo(this,{kind:"constant",value:v(e.value.value,n.value.value,l)},e.parameters):e},Gt.prototype.evaluate=function(e,n,l,v,E,C){return e.kind==="constant"?e.value:e.evaluate(n,l,v,E,C)};var iu=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.possiblyEvaluate=function(l,v,E,C){if(l.value===void 0)return new Lo(this,{kind:"constant",value:void 0},v);if(l.expression.kind==="constant"){var i=l.expression.evaluate(v,null,{},E,C),t=l.property.specification.type==="resolvedImage"&&typeof i!="string"?i.name:i,a=this._calculate(t,t,t,v);return new Lo(this,{kind:"constant",value:a},v)}if(l.expression.kind==="camera"){var p=this._calculate(l.expression.evaluate({zoom:v.zoom-1}),l.expression.evaluate({zoom:v.zoom}),l.expression.evaluate({zoom:v.zoom+1}),v);return new Lo(this,{kind:"constant",value:p},v)}return new Lo(this,l.expression,v)},n.prototype.evaluate=function(l,v,E,C,i,t){if(l.kind==="source"){var a=l.evaluate(v,E,C,i,t);return this._calculate(a,a,a,v)}return l.kind==="composite"?this._calculate(l.evaluate({zoom:Math.floor(v.zoom)-1},E,C),l.evaluate({zoom:Math.floor(v.zoom)},E,C),l.evaluate({zoom:Math.floor(v.zoom)+1},E,C),v):l.value},n.prototype._calculate=function(l,v,E,C){return C.zoom>C.zoomHistory.lastIntegerZoom?{from:l,to:v}:{from:E,to:v}},n.prototype.interpolate=function(l){return l},n}(Gt),Bn=function(e){this.specification=e};Bn.prototype.possiblyEvaluate=function(e,n,l,v){if(e.value!==void 0){if(e.expression.kind==="constant"){var E=e.expression.evaluate(n,null,{},l,v);return this._calculate(E,E,E,n)}return this._calculate(e.expression.evaluate(new Nt(Math.floor(n.zoom-1),n)),e.expression.evaluate(new Nt(Math.floor(n.zoom),n)),e.expression.evaluate(new Nt(Math.floor(n.zoom+1),n)),n)}},Bn.prototype._calculate=function(e,n,l,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:l,to:n}},Bn.prototype.interpolate=function(e){return e};var No=function(e){this.specification=e};No.prototype.possiblyEvaluate=function(e,n,l,v){return!!e.expression.evaluate(n,null,{},l,v)},No.prototype.interpolate=function(){return!1};var T=function(e){for(var n in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var l=e[n];l.specification.overridable&&this.overridableProperties.push(n);var v=this.defaultPropertyValues[n]=new Xo(l,void 0),E=this.defaultTransitionablePropertyValues[n]=new Mo(l);this.defaultTransitioningPropertyValues[n]=E.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=v.possiblyEvaluate({})}};oi("DataDrivenProperty",Gt),oi("DataConstantProperty",Zt),oi("CrossFadedDataDrivenProperty",iu),oi("CrossFadedProperty",Bn),oi("ColorRampProperty",No);var o=function(e){function n(l,v){if(e.call(this),this.id=l.id,this.type=l.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},l.type!=="custom"&&(this.metadata=(l=l).metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter),v.layout&&(this._unevaluatedLayout=new vn(v.layout)),v.paint)){for(var E in this._transitionablePaint=new jn(v.paint),l.paint)this.setPaintProperty(E,l.paint[E],{validate:!1});for(var C in l.layout)this.setLayoutProperty(C,l.layout[C],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new fs(v.paint)}}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},n.prototype.getLayoutProperty=function(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)},n.prototype.setLayoutProperty=function(l,v,E){E===void 0&&(E={}),v!=null&&this._validate(el,"layers."+this.id+".layout."+l,l,v,E)||(l!=="visibility"?this._unevaluatedLayout.setValue(l,v):this.visibility=v)},n.prototype.getPaintProperty=function(l){return fi(l,"-transition")?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)},n.prototype.setPaintProperty=function(l,v,E){if(E===void 0&&(E={}),v!=null&&this._validate(ri,"layers."+this.id+".paint."+l,l,v,E))return!1;if(fi(l,"-transition"))return this._transitionablePaint.setTransition(l.slice(0,-11),v||void 0),!1;var C=this._transitionablePaint._values[l],i=C.property.specification["property-type"]==="cross-faded-data-driven",t=C.value.isDataDriven(),a=C.value;this._transitionablePaint.setValue(l,v),this._handleSpecialPaintPropertyUpdate(l);var p=this._transitionablePaint._values[l].value;return p.isDataDriven()||t||i||this._handleOverridablePaintPropertyUpdate(l,a,p)},n.prototype._handleSpecialPaintPropertyUpdate=function(l){},n.prototype._handleOverridablePaintPropertyUpdate=function(l,v,E){return!1},n.prototype.isHidden=function(l){return!!(this.minzoom&&l<this.minzoom)||!!(this.maxzoom&&l>=this.maxzoom)||this.visibility==="none"},n.prototype.updateTransitions=function(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)},n.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},n.prototype.recalculate=function(l,v){l.getCrossfadeParameters&&(this._crossfadeParameters=l.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,v)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,v)},n.prototype.serialize=function(){var l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),Wt(l,function(v,E){return!(v===void 0||E==="layout"&&!Object.keys(v).length||E==="paint"&&!Object.keys(v).length)})},n.prototype._validate=function(l,v,E,C,i){return i===void 0&&(i={}),(!i||i.validate!==!1)&&Il(this,l.call(Ca,{key:v,layerType:this.type,objectKey:E,value:C,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))},n.prototype.is3D=function(){return!1},n.prototype.isTileClipped=function(){return!1},n.prototype.hasOffscreenPass=function(){return!1},n.prototype.resize=function(){},n.prototype.isStateDependent=function(){for(var l in this.paint._values){var v=this.paint.get(l);if(v instanceof Lo&&qa(v.property.specification)&&(v.value.kind==="source"||v.value.kind==="composite")&&v.value.isStateDependent)return!0}return!1},n}(Ve),y={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},S=function(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},A=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function M(e,n){n===void 0&&(n=1);var l=0,v=0;return{members:e.map(function(E){var C=y[E.type].BYTES_PER_ELEMENT,i=l=U(l,Math.max(n,C)),t=E.components||1;return v=Math.max(v,C),l+=C*t,{name:E.name,type:E.type,components:t,offset:i}}),size:U(l,Math.max(v,n)),alignment:n}}function U(e,n){return Math.ceil(e/n)*n}A.serialize=function(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},A.deserialize=function(e){var n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n},A.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},A.prototype.clear=function(){this.length=0},A.prototype.resize=function(e){this.reserve(e),this.length=e},A.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}},A.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Z=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v){var E=this.length;return this.resize(E+1),this.emplace(E,l,v)},n.prototype.emplace=function(l,v,E){var C=2*l;return this.int16[C+0]=v,this.int16[C+1]=E,l},n}(A);Z.prototype.bytesPerElement=4,oi("StructArrayLayout2i4",Z);var J=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C){var i=this.length;return this.resize(i+1),this.emplace(i,l,v,E,C)},n.prototype.emplace=function(l,v,E,C,i){var t=4*l;return this.int16[t+0]=v,this.int16[t+1]=E,this.int16[t+2]=C,this.int16[t+3]=i,l},n}(A);J.prototype.bytesPerElement=8,oi("StructArrayLayout4i8",J);var ee=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t){var a=this.length;return this.resize(a+1),this.emplace(a,l,v,E,C,i,t)},n.prototype.emplace=function(l,v,E,C,i,t,a){var p=6*l;return this.int16[p+0]=v,this.int16[p+1]=E,this.int16[p+2]=C,this.int16[p+3]=i,this.int16[p+4]=t,this.int16[p+5]=a,l},n}(A);ee.prototype.bytesPerElement=12,oi("StructArrayLayout2i4i12",ee);var re=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t){var a=this.length;return this.resize(a+1),this.emplace(a,l,v,E,C,i,t)},n.prototype.emplace=function(l,v,E,C,i,t,a){var p=4*l,_=8*l;return this.int16[p+0]=v,this.int16[p+1]=E,this.uint8[_+4]=C,this.uint8[_+5]=i,this.uint8[_+6]=t,this.uint8[_+7]=a,l},n}(A);re.prototype.bytesPerElement=8,oi("StructArrayLayout2i4ub8",re);var ue=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v){var E=this.length;return this.resize(E+1),this.emplace(E,l,v)},n.prototype.emplace=function(l,v,E){var C=2*l;return this.float32[C+0]=v,this.float32[C+1]=E,l},n}(A);ue.prototype.bytesPerElement=8,oi("StructArrayLayout2f8",ue);var ve=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t,a,p,_,b){var I=this.length;return this.resize(I+1),this.emplace(I,l,v,E,C,i,t,a,p,_,b)},n.prototype.emplace=function(l,v,E,C,i,t,a,p,_,b,I){var P=10*l;return this.uint16[P+0]=v,this.uint16[P+1]=E,this.uint16[P+2]=C,this.uint16[P+3]=i,this.uint16[P+4]=t,this.uint16[P+5]=a,this.uint16[P+6]=p,this.uint16[P+7]=_,this.uint16[P+8]=b,this.uint16[P+9]=I,l},n}(A);ve.prototype.bytesPerElement=20,oi("StructArrayLayout10ui20",ve);var Re=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t,a,p,_,b,I,P){var R=this.length;return this.resize(R+1),this.emplace(R,l,v,E,C,i,t,a,p,_,b,I,P)},n.prototype.emplace=function(l,v,E,C,i,t,a,p,_,b,I,P,R){var O=12*l;return this.int16[O+0]=v,this.int16[O+1]=E,this.int16[O+2]=C,this.int16[O+3]=i,this.uint16[O+4]=t,this.uint16[O+5]=a,this.uint16[O+6]=p,this.uint16[O+7]=_,this.int16[O+8]=b,this.int16[O+9]=I,this.int16[O+10]=P,this.int16[O+11]=R,l},n}(A);Re.prototype.bytesPerElement=24,oi("StructArrayLayout4i4ui4i24",Re);var be=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E){var C=this.length;return this.resize(C+1),this.emplace(C,l,v,E)},n.prototype.emplace=function(l,v,E,C){var i=3*l;return this.float32[i+0]=v,this.float32[i+1]=E,this.float32[i+2]=C,l},n}(A);be.prototype.bytesPerElement=12,oi("StructArrayLayout3f12",be);var De=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l){var v=this.length;return this.resize(v+1),this.emplace(v,l)},n.prototype.emplace=function(l,v){return this.uint32[1*l+0]=v,l},n}(A);De.prototype.bytesPerElement=4,oi("StructArrayLayout1ul4",De);var Je=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t,a,p,_){var b=this.length;return this.resize(b+1),this.emplace(b,l,v,E,C,i,t,a,p,_)},n.prototype.emplace=function(l,v,E,C,i,t,a,p,_,b){var I=10*l,P=5*l;return this.int16[I+0]=v,this.int16[I+1]=E,this.int16[I+2]=C,this.int16[I+3]=i,this.int16[I+4]=t,this.int16[I+5]=a,this.uint32[P+3]=p,this.uint16[I+8]=_,this.uint16[I+9]=b,l},n}(A);Je.prototype.bytesPerElement=20,oi("StructArrayLayout6i1ul2ui20",Je);var Xe=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t){var a=this.length;return this.resize(a+1),this.emplace(a,l,v,E,C,i,t)},n.prototype.emplace=function(l,v,E,C,i,t,a){var p=6*l;return this.int16[p+0]=v,this.int16[p+1]=E,this.int16[p+2]=C,this.int16[p+3]=i,this.int16[p+4]=t,this.int16[p+5]=a,l},n}(A);Xe.prototype.bytesPerElement=12,oi("StructArrayLayout2i2i2i12",Xe);var nt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i){var t=this.length;return this.resize(t+1),this.emplace(t,l,v,E,C,i)},n.prototype.emplace=function(l,v,E,C,i,t){var a=4*l,p=8*l;return this.float32[a+0]=v,this.float32[a+1]=E,this.float32[a+2]=C,this.int16[p+6]=i,this.int16[p+7]=t,l},n}(A);nt.prototype.bytesPerElement=16,oi("StructArrayLayout2f1f2i16",nt);var Ye=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C){var i=this.length;return this.resize(i+1),this.emplace(i,l,v,E,C)},n.prototype.emplace=function(l,v,E,C,i){var t=12*l,a=3*l;return this.uint8[t+0]=v,this.uint8[t+1]=E,this.float32[a+1]=C,this.float32[a+2]=i,l},n}(A);Ye.prototype.bytesPerElement=12,oi("StructArrayLayout2ub2f12",Ye);var xt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E){var C=this.length;return this.resize(C+1),this.emplace(C,l,v,E)},n.prototype.emplace=function(l,v,E,C){var i=3*l;return this.uint16[i+0]=v,this.uint16[i+1]=E,this.uint16[i+2]=C,l},n}(A);xt.prototype.bytesPerElement=6,oi("StructArrayLayout3ui6",xt);var ht=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t,a,p,_,b,I,P,R,O,V,j,K){var Y=this.length;return this.resize(Y+1),this.emplace(Y,l,v,E,C,i,t,a,p,_,b,I,P,R,O,V,j,K)},n.prototype.emplace=function(l,v,E,C,i,t,a,p,_,b,I,P,R,O,V,j,K,Y){var Q=24*l,se=12*l,pe=48*l;return this.int16[Q+0]=v,this.int16[Q+1]=E,this.uint16[Q+2]=C,this.uint16[Q+3]=i,this.uint32[se+2]=t,this.uint32[se+3]=a,this.uint32[se+4]=p,this.uint16[Q+10]=_,this.uint16[Q+11]=b,this.uint16[Q+12]=I,this.float32[se+7]=P,this.float32[se+8]=R,this.uint8[pe+36]=O,this.uint8[pe+37]=V,this.uint8[pe+38]=j,this.uint32[se+10]=K,this.int16[Q+22]=Y,l},n}(A);ht.prototype.bytesPerElement=48,oi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ht);var ft=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t,a,p,_,b,I,P,R,O,V,j,K,Y,Q,se,pe,Ae,Be,qe,Ge,it,He,Ct){var Tt=this.length;return this.resize(Tt+1),this.emplace(Tt,l,v,E,C,i,t,a,p,_,b,I,P,R,O,V,j,K,Y,Q,se,pe,Ae,Be,qe,Ge,it,He,Ct)},n.prototype.emplace=function(l,v,E,C,i,t,a,p,_,b,I,P,R,O,V,j,K,Y,Q,se,pe,Ae,Be,qe,Ge,it,He,Ct,Tt){var ut=34*l,St=17*l;return this.int16[ut+0]=v,this.int16[ut+1]=E,this.int16[ut+2]=C,this.int16[ut+3]=i,this.int16[ut+4]=t,this.int16[ut+5]=a,this.int16[ut+6]=p,this.int16[ut+7]=_,this.uint16[ut+8]=b,this.uint16[ut+9]=I,this.uint16[ut+10]=P,this.uint16[ut+11]=R,this.uint16[ut+12]=O,this.uint16[ut+13]=V,this.uint16[ut+14]=j,this.uint16[ut+15]=K,this.uint16[ut+16]=Y,this.uint16[ut+17]=Q,this.uint16[ut+18]=se,this.uint16[ut+19]=pe,this.uint16[ut+20]=Ae,this.uint16[ut+21]=Be,this.uint16[ut+22]=qe,this.uint32[St+12]=Ge,this.float32[St+13]=it,this.float32[St+14]=He,this.float32[St+15]=Ct,this.float32[St+16]=Tt,l},n}(A);ft.prototype.bytesPerElement=68,oi("StructArrayLayout8i15ui1ul4f68",ft);var Pt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l){var v=this.length;return this.resize(v+1),this.emplace(v,l)},n.prototype.emplace=function(l,v){return this.float32[1*l+0]=v,l},n}(A);Pt.prototype.bytesPerElement=4,oi("StructArrayLayout1f4",Pt);var Ft=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E){var C=this.length;return this.resize(C+1),this.emplace(C,l,v,E)},n.prototype.emplace=function(l,v,E,C){var i=3*l;return this.int16[i+0]=v,this.int16[i+1]=E,this.int16[i+2]=C,l},n}(A);Ft.prototype.bytesPerElement=6,oi("StructArrayLayout3i6",Ft);var wt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E){var C=this.length;return this.resize(C+1),this.emplace(C,l,v,E)},n.prototype.emplace=function(l,v,E,C){var i=4*l;return this.uint32[2*l+0]=v,this.uint16[i+2]=E,this.uint16[i+3]=C,l},n}(A);wt.prototype.bytesPerElement=8,oi("StructArrayLayout1ul2ui8",wt);var pi=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v){var E=this.length;return this.resize(E+1),this.emplace(E,l,v)},n.prototype.emplace=function(l,v,E){var C=2*l;return this.uint16[C+0]=v,this.uint16[C+1]=E,l},n}(A);pi.prototype.bytesPerElement=4,oi("StructArrayLayout2ui4",pi);var ei=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l){var v=this.length;return this.resize(v+1),this.emplace(v,l)},n.prototype.emplace=function(l,v){return this.uint16[1*l+0]=v,l},n}(A);ei.prototype.bytesPerElement=2,oi("StructArrayLayout1ui2",ei);var Ui=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C){var i=this.length;return this.resize(i+1),this.emplace(i,l,v,E,C)},n.prototype.emplace=function(l,v,E,C,i){var t=4*l;return this.float32[t+0]=v,this.float32[t+1]=E,this.float32[t+2]=C,this.float32[t+3]=i,l},n}(A);Ui.prototype.bytesPerElement=16,oi("StructArrayLayout4f16",Ui);var c=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var l={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return l.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},l.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},l.x1.get=function(){return this._structArray.int16[this._pos2+2]},l.y1.get=function(){return this._structArray.int16[this._pos2+3]},l.x2.get=function(){return this._structArray.int16[this._pos2+4]},l.y2.get=function(){return this._structArray.int16[this._pos2+5]},l.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},l.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},l.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},l.anchorPoint.get=function(){return new F(this.anchorPointX,this.anchorPointY)},Object.defineProperties(n.prototype,l),n}(S);c.prototype.size=20;var m=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(l){return new c(this,l)},n}(Je);oi("CollisionBoxArray",m);var d=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var l={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return l.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},l.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},l.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},l.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},l.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},l.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},l.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},l.segment.get=function(){return this._structArray.uint16[this._pos2+10]},l.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},l.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},l.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},l.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},l.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},l.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},l.placedOrientation.set=function(v){this._structArray.uint8[this._pos1+37]=v},l.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},l.hidden.set=function(v){this._structArray.uint8[this._pos1+38]=v},l.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},l.crossTileID.set=function(v){this._structArray.uint32[this._pos4+10]=v},l.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(n.prototype,l),n}(S);d.prototype.size=48;var x=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(l){return new d(this,l)},n}(ht);oi("PlacedSymbolArray",x);var k=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var l={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return l.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},l.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},l.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},l.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},l.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},l.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},l.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},l.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},l.key.get=function(){return this._structArray.uint16[this._pos2+8]},l.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},l.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},l.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},l.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},l.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},l.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},l.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},l.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},l.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},l.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},l.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},l.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},l.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},l.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},l.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},l.crossTileID.set=function(v){this._structArray.uint32[this._pos4+12]=v},l.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},l.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},l.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},l.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(n.prototype,l),n}(S);k.prototype.size=68;var L=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(l){return new k(this,l)},n}(ft);oi("SymbolInstanceArray",L);var B=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getoffsetX=function(l){return this.float32[1*l+0]},n}(Pt);oi("GlyphOffsetArray",B);var q=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getx=function(l){return this.int16[3*l+0]},n.prototype.gety=function(l){return this.int16[3*l+1]},n.prototype.gettileUnitDistanceFromAnchor=function(l){return this.int16[3*l+2]},n}(Ft);oi("SymbolLineVertexArray",q);var $=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var l={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return l.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},l.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},l.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(n.prototype,l),n}(S);$.prototype.size=8;var ie=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(l){return new $(this,l)},n}(wt);oi("FeatureIndexArray",ie);var he=M([{name:"a_pos",components:2,type:"Int16"}],4).members,de=function(e){e===void 0&&(e=[]),this.segments=e};function me(e,n){return 256*(e=je(Math.floor(e),0,255))+je(Math.floor(n),0,255)}de.prototype.prepareSegment=function(e,n,l,v){var E=this.segments[this.segments.length-1];return e>de.MAX_VERTEX_ARRAY_LENGTH&&Xt("Max vertices per segment is "+de.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!E||E.vertexLength+e>de.MAX_VERTEX_ARRAY_LENGTH||E.sortKey!==v)&&(E={vertexOffset:n.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},v!==void 0&&(E.sortKey=v),this.segments.push(E)),E},de.prototype.get=function(){return this.segments},de.prototype.destroy=function(){for(var e=0,n=this.segments;e<n.length;e+=1){var l=n[e];for(var v in l.vaos)l.vaos[v].destroy()}},de.simpleSegment=function(e,n,l,v){return new de([{vertexOffset:e,primitiveOffset:n,vertexLength:l,primitiveLength:v,vaos:{},sortKey:0}])},de.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,oi("SegmentVector",de);var Ce=M([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Te=h(function(e){e.exports=function(n,l){var v,E,C,i,t,a,p,_;for(E=n.length-(v=3&n.length),C=l,t=3432918353,a=461845907,_=0;_<E;)p=255&n.charCodeAt(_)|(255&n.charCodeAt(++_))<<8|(255&n.charCodeAt(++_))<<16|(255&n.charCodeAt(++_))<<24,++_,C=27492+(65535&(i=5*(65535&(C=(C^=p=(65535&(p=(p=(65535&p)*t+(((p>>>16)*t&65535)<<16)&4294967295)<<15|p>>>17))*a+(((p>>>16)*a&65535)<<16)&4294967295)<<13|C>>>19))+((5*(C>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(p=0,v){case 3:p^=(255&n.charCodeAt(_+2))<<16;case 2:p^=(255&n.charCodeAt(_+1))<<8;case 1:C^=p=(65535&(p=(p=(65535&(p^=255&n.charCodeAt(_)))*t+(((p>>>16)*t&65535)<<16)&4294967295)<<15|p>>>17))*a+(((p>>>16)*a&65535)<<16)&4294967295}return C^=n.length,C=2246822507*(65535&(C^=C>>>16))+((2246822507*(C>>>16)&65535)<<16)&4294967295,C=3266489909*(65535&(C^=C>>>13))+((3266489909*(C>>>16)&65535)<<16)&4294967295,(C^=C>>>16)>>>0}}),Le=h(function(e){e.exports=function(n,l){for(var v,E=n.length,C=l^E,i=0;E>=4;)v=1540483477*(65535&(v=255&n.charCodeAt(i)|(255&n.charCodeAt(++i))<<8|(255&n.charCodeAt(++i))<<16|(255&n.charCodeAt(++i))<<24))+((1540483477*(v>>>16)&65535)<<16),C=1540483477*(65535&C)+((1540483477*(C>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),E-=4,++i;switch(E){case 3:C^=(255&n.charCodeAt(i+2))<<16;case 2:C^=(255&n.charCodeAt(i+1))<<8;case 1:C=1540483477*(65535&(C^=255&n.charCodeAt(i)))+((1540483477*(C>>>16)&65535)<<16)}return C=1540483477*(65535&(C^=C>>>13))+((1540483477*(C>>>16)&65535)<<16),(C^=C>>>15)>>>0}}),xe=Te,ze=Le;xe.murmur3=Te,xe.murmur2=ze;var Fe=function(){this.ids=[],this.positions=[],this.indexed=!1};Fe.prototype.add=function(e,n,l,v){this.ids.push(ot(e)),this.positions.push(n,l,v)},Fe.prototype.getPositions=function(e){for(var n=ot(e),l=0,v=this.ids.length-1;l<v;){var E=l+v>>1;this.ids[E]>=n?v=E:l=E+1}for(var C=[];this.ids[l]===n;)C.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return C},Fe.serialize=function(e,n){var l=new Float64Array(e.ids),v=new Uint32Array(e.positions);return function E(C,i,t,a){for(;t<a;){for(var p=C[t+a>>1],_=t-1,b=a+1;;){do _++;while(C[_]<p);do b--;while(C[b]>p);if(_>=b)break;at(C,_,b),at(i,3*_,3*b),at(i,3*_+1,3*b+1),at(i,3*_+2,3*b+2)}b-t<a-b?(E(C,i,t,b),t=b+1):(E(C,i,b+1,a),a=b)}}(l,v,0,l.length-1),n&&n.push(l.buffer,v.buffer),{ids:l,positions:v}},Fe.deserialize=function(e){var n=new Fe;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n};var $e=Math.pow(2,53)-1;function ot(e){var n=+e;return!isNaN(n)&&n<=$e?n:xe(String(e))}function at(e,n,l){var v=e[n];e[n]=e[l],e[l]=v}oi("FeaturePositionMap",Fe);var st=function(e,n){this.gl=e.gl,this.location=n},It=function(e){function n(l,v){e.call(this,l,v),this.current=0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))},n}(st),Dt=function(e){function n(l,v){e.call(this,l,v),this.current=0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))},n}(st),Lt=function(e){function n(l,v){e.call(this,l,v),this.current=[0,0]}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))},n}(st),$t=function(e){function n(l,v){e.call(this,l,v),this.current=[0,0,0]}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))},n}(st),mi=function(e){function n(l,v){e.call(this,l,v),this.current=[0,0,0,0]}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3]))},n}(st),bi=function(e){function n(l,v){e.call(this,l,v),this.current=Di.transparent}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a))},n}(st),di=new Float32Array(16),ar=function(e){function n(l,v){e.call(this,l,v),this.current=di}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(var v=1;v<16;v++)if(l[v]!==this.current[v]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}},n}(st);function ni(e){return[me(255*e.r,255*e.g),me(255*e.b,255*e.a)]}var Bi=function(e,n,l){this.value=e,this.uniformNames=n.map(function(v){return"u_"+v}),this.type=l};Bi.prototype.setUniform=function(e,n,l){e.set(l.constantOr(this.value))},Bi.prototype.getBinding=function(e,n,l){return this.type==="color"?new bi(e,n):new Dt(e,n)};var er=function(e,n){this.uniformNames=n.map(function(l){return"u_"+l}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};er.prototype.setConstantPatternPositions=function(e,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=e.tlbr},er.prototype.setUniform=function(e,n,l,v){var E=v==="u_pattern_to"?this.patternTo:v==="u_pattern_from"?this.patternFrom:v==="u_pixel_ratio_to"?this.pixelRatioTo:v==="u_pixel_ratio_from"?this.pixelRatioFrom:null;E&&e.set(E)},er.prototype.getBinding=function(e,n,l){return l.substr(0,9)==="u_pattern"?new mi(e,n):new Dt(e,n)};var Li=function(e,n,l,v){this.expression=e,this.type=l,this.maxValue=0,this.paintVertexAttributes=n.map(function(E){return{name:"a_"+E,type:"Float32",components:l==="color"?2:1,offset:0}}),this.paintVertexArray=new v};Li.prototype.populatePaintArray=function(e,n,l,v,E){var C=this.paintVertexArray.length,i=this.expression.evaluate(new Nt(0),n,{},v,[],E);this.paintVertexArray.resize(e),this._setPaintValue(C,e,i)},Li.prototype.updatePaintArray=function(e,n,l,v){var E=this.expression.evaluate({zoom:0},l,v);this._setPaintValue(e,n,E)},Li.prototype._setPaintValue=function(e,n,l){if(this.type==="color")for(var v=ni(l),E=e;E<n;E++)this.paintVertexArray.emplace(E,v[0],v[1]);else{for(var C=e;C<n;C++)this.paintVertexArray.emplace(C,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}},Li.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Li.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Pi=function(e,n,l,v,E,C){this.expression=e,this.uniformNames=n.map(function(i){return"u_"+i+"_t"}),this.type=l,this.useIntegerZoom=v,this.zoom=E,this.maxValue=0,this.paintVertexAttributes=n.map(function(i){return{name:"a_"+i,type:"Float32",components:l==="color"?4:2,offset:0}}),this.paintVertexArray=new C};Pi.prototype.populatePaintArray=function(e,n,l,v,E){var C=this.expression.evaluate(new Nt(this.zoom),n,{},v,[],E),i=this.expression.evaluate(new Nt(this.zoom+1),n,{},v,[],E),t=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(t,e,C,i)},Pi.prototype.updatePaintArray=function(e,n,l,v){var E=this.expression.evaluate({zoom:this.zoom},l,v),C=this.expression.evaluate({zoom:this.zoom+1},l,v);this._setPaintValue(e,n,E,C)},Pi.prototype._setPaintValue=function(e,n,l,v){if(this.type==="color")for(var E=ni(l),C=ni(v),i=e;i<n;i++)this.paintVertexArray.emplace(i,E[0],E[1],C[0],C[1]);else{for(var t=e;t<n;t++)this.paintVertexArray.emplace(t,l,v);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(v))}},Pi.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Pi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Pi.prototype.setUniform=function(e,n){var l=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,v=je(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);e.set(v)},Pi.prototype.getBinding=function(e,n,l){return new Dt(e,n)};var ji=function(e,n,l,v,E,C){this.expression=e,this.type=n,this.useIntegerZoom=l,this.zoom=v,this.layerId=C,this.zoomInPaintVertexArray=new E,this.zoomOutPaintVertexArray=new E};ji.prototype.populatePaintArray=function(e,n,l){var v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(v,e,n.patterns&&n.patterns[this.layerId],l)},ji.prototype.updatePaintArray=function(e,n,l,v,E){this._setPaintValues(e,n,l.patterns&&l.patterns[this.layerId],E)},ji.prototype._setPaintValues=function(e,n,l,v){if(v&&l){var E=v[l.min],C=v[l.mid],i=v[l.max];if(E&&C&&i)for(var t=e;t<n;t++)this.zoomInPaintVertexArray.emplace(t,C.tl[0],C.tl[1],C.br[0],C.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],C.pixelRatio,E.pixelRatio),this.zoomOutPaintVertexArray.emplace(t,C.tl[0],C.tl[1],C.br[0],C.br[1],i.tl[0],i.tl[1],i.br[0],i.br[1],C.pixelRatio,i.pixelRatio)}},ji.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Ce.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Ce.members,this.expression.isStateDependent))},ji.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ti=function(e,n,l){this.binders={},this._buffers=[];var v=[];for(var E in e.paint._values)if(l(E)){var C=e.paint.get(E);if(C instanceof Lo&&qa(C.property.specification)){var i=mn(E,e.type),t=C.value,a=C.property.specification.type,p=C.property.useIntegerZoom,_=C.property.specification["property-type"],b=_==="cross-faded"||_==="cross-faded-data-driven";if(t.kind==="constant")this.binders[E]=b?new er(t.value,i):new Bi(t.value,i,a),v.push("/u_"+E);else if(t.kind==="source"||b){var I=Cn(E,a,"source");this.binders[E]=b?new ji(t,a,p,n,I,e.id):new Li(t,i,a,I),v.push("/a_"+E)}else{var P=Cn(E,a,"composite");this.binders[E]=new Pi(t,i,a,p,n,P),v.push("/z_"+E)}}}this.cacheKey=v.sort().join("")};Ti.prototype.getMaxValue=function(e){var n=this.binders[e];return n instanceof Li||n instanceof Pi?n.maxValue:0},Ti.prototype.populatePaintArrays=function(e,n,l,v,E){for(var C in this.binders){var i=this.binders[C];(i instanceof Li||i instanceof Pi||i instanceof ji)&&i.populatePaintArray(e,n,l,v,E)}},Ti.prototype.setConstantPatternPositions=function(e,n){for(var l in this.binders){var v=this.binders[l];v instanceof er&&v.setConstantPatternPositions(e,n)}},Ti.prototype.updatePaintArrays=function(e,n,l,v,E){var C=!1;for(var i in e)for(var t=0,a=n.getPositions(i);t<a.length;t+=1){var p=a[t],_=l.feature(p.index);for(var b in this.binders){var I=this.binders[b];if((I instanceof Li||I instanceof Pi||I instanceof ji)&&I.expression.isStateDependent===!0){var P=v.paint.get(b);I.expression=P.value,I.updatePaintArray(p.start,p.end,_,e[i],E),C=!0}}}return C},Ti.prototype.defines=function(){var e=[];for(var n in this.binders){var l=this.binders[n];(l instanceof Bi||l instanceof er)&&e.push.apply(e,l.uniformNames.map(function(v){return"#define HAS_UNIFORM_"+v}))}return e},Ti.prototype.getBinderAttributes=function(){var e=[];for(var n in this.binders){var l=this.binders[n];if(l instanceof Li||l instanceof Pi)for(var v=0;v<l.paintVertexAttributes.length;v++)e.push(l.paintVertexAttributes[v].name);else if(l instanceof ji)for(var E=0;E<Ce.members.length;E++)e.push(Ce.members[E].name)}return e},Ti.prototype.getBinderUniforms=function(){var e=[];for(var n in this.binders){var l=this.binders[n];if(l instanceof Bi||l instanceof er||l instanceof Pi)for(var v=0,E=l.uniformNames;v<E.length;v+=1)e.push(E[v])}return e},Ti.prototype.getPaintVertexBuffers=function(){return this._buffers},Ti.prototype.getUniforms=function(e,n){var l=[];for(var v in this.binders){var E=this.binders[v];if(E instanceof Bi||E instanceof er||E instanceof Pi)for(var C=0,i=E.uniformNames;C<i.length;C+=1){var t=i[C];if(n[t]){var a=E.getBinding(e,n[t],t);l.push({name:t,property:v,binding:a})}}}return l},Ti.prototype.setUniforms=function(e,n,l,v){for(var E=0,C=n;E<C.length;E+=1){var i=C[E],t=i.name,a=i.property;this.binders[a].setUniform(i.binding,v,l.get(a),t)}},Ti.prototype.updatePaintBuffers=function(e){for(var n in this._buffers=[],this.binders){var l=this.binders[n];if(e&&l instanceof ji){var v=e.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(l instanceof Li||l instanceof Pi)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}},Ti.prototype.upload=function(e){for(var n in this.binders){var l=this.binders[n];(l instanceof Li||l instanceof Pi||l instanceof ji)&&l.upload(e)}this.updatePaintBuffers()},Ti.prototype.destroy=function(){for(var e in this.binders){var n=this.binders[e];(n instanceof Li||n instanceof Pi||n instanceof ji)&&n.destroy()}};var vi=function(e,n,l){l===void 0&&(l=function(){return!0}),this.programConfigurations={};for(var v=0,E=e;v<E.length;v+=1){var C=E[v];this.programConfigurations[C.id]=new Ti(C,n,l)}this.needsUpload=!1,this._featureMap=new Fe,this._bufferOffset=0};function mn(e,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(n+"-","").replace(/-/g,"_")]}function Cn(e,n,l){var v={color:{source:ue,composite:Ui},number:{source:Pt,composite:ue}},E=function(C){return{"line-pattern":{source:ve,composite:ve},"fill-pattern":{source:ve,composite:ve},"fill-extrusion-pattern":{source:ve,composite:ve}}[C]}(e);return E&&E[l]||v[n][l]}vi.prototype.populatePaintArrays=function(e,n,l,v,E,C){for(var i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(e,n,v,E,C);n.id!==void 0&&this._featureMap.add(n.id,l,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},vi.prototype.updatePaintArrays=function(e,n,l,v){for(var E=0,C=l;E<C.length;E+=1){var i=C[E];this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(e,this._featureMap,n,i,v)||this.needsUpload}},vi.prototype.get=function(e){return this.programConfigurations[e]},vi.prototype.upload=function(e){if(this.needsUpload){for(var n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}},vi.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},oi("ConstantBinder",Bi),oi("CrossFadedConstantBinder",er),oi("SourceExpressionBinder",Li),oi("CrossFadedCompositeBinder",ji),oi("CompositeExpressionBinder",Pi),oi("ProgramConfiguration",Ti,{omit:["_buffers"]}),oi("ProgramConfigurationSet",vi);var On=Math.pow(2,14)-1,To=-On-1;function xn(e){for(var n=8192/e.extent,l=e.loadGeometry(),v=0;v<l.length;v++)for(var E=l[v],C=0;C<E.length;C++){var i=E[C],t=Math.round(i.x*n),a=Math.round(i.y*n);i.x=je(t,To,On),i.y=je(a,To,On),(t<i.x||t>i.x+1||a<i.y||a>i.y+1)&&Xt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return l}function ur(e,n){return{type:e.type,id:e.id,properties:e.properties,geometry:n?xn(e):[]}}function Jo(e,n,l,v,E){e.emplaceBack(2*n+(v+1)/2,2*l+(E+1)/2)}var jo=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Z,this.indexArray=new xt,this.segments=new de,this.programConfigurations=new vi(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};function xa(e,n){for(var l=0;l<e.length;l++)if(Ls(n,e[l]))return!0;for(var v=0;v<n.length;v++)if(Ls(e,n[v]))return!0;return!!Lu(e,n)}function Yn(e,n,l){return!!Ls(e,n)||!!il(n,e,l)}function ba(e,n){if(e.length===1)return ru(n,e[0]);for(var l=0;l<n.length;l++)for(var v=n[l],E=0;E<v.length;E++)if(Ls(e,v[E]))return!0;for(var C=0;C<e.length;C++)if(ru(n,e[C]))return!0;for(var i=0;i<n.length;i++)if(Lu(e,n[i]))return!0;return!1}function wa(e,n,l){if(e.length>1){if(Lu(e,n))return!0;for(var v=0;v<n.length;v++)if(il(n[v],e,l))return!0}for(var E=0;E<e.length;E++)if(il(e[E],n,l))return!0;return!1}function Lu(e,n){if(e.length===0||n.length===0)return!1;for(var l=0;l<e.length-1;l++)for(var v=e[l],E=e[l+1],C=0;C<n.length-1;C++)if(Du(v,E,n[C],n[C+1]))return!0;return!1}function Du(e,n,l,v){return Qt(e,l,v)!==Qt(n,l,v)&&Qt(e,n,l)!==Qt(e,n,v)}function il(e,n,l){var v=l*l;if(n.length===1)return e.distSqr(n[0])<v;for(var E=1;E<n.length;E++)if(Ru(e,n[E-1],n[E])<v)return!0;return!1}function Ru(e,n,l){var v=n.distSqr(l);if(v===0)return e.distSqr(n);var E=((e.x-n.x)*(l.x-n.x)+(e.y-n.y)*(l.y-n.y))/v;return e.distSqr(E<0?n:E>1?l:l.sub(n)._mult(E)._add(n))}function ru(e,n){for(var l,v,E,C=!1,i=0;i<e.length;i++)for(var t=0,a=(l=e[i]).length-1;t<l.length;a=t++)(v=l[t]).y>n.y!=(E=l[a]).y>n.y&&n.x<(E.x-v.x)*(n.y-v.y)/(E.y-v.y)+v.x&&(C=!C);return C}function Ls(e,n){for(var l=!1,v=0,E=e.length-1;v<e.length;E=v++){var C=e[v],i=e[E];C.y>n.y!=i.y>n.y&&n.x<(i.x-C.x)*(n.y-C.y)/(i.y-C.y)+C.x&&(l=!l)}return l}function nu(e,n,l){var v=l[0],E=l[2];if(e.x<v.x&&n.x<v.x||e.x>E.x&&n.x>E.x||e.y<v.y&&n.y<v.y||e.y>E.y&&n.y>E.y)return!1;var C=Qt(e,n,l[0]);return C!==Qt(e,n,l[1])||C!==Qt(e,n,l[2])||C!==Qt(e,n,l[3])}function ms(e,n,l){var v=n.paint.get(e).value;return v.kind==="constant"?v.value:l.programConfigurations.get(n.id).getMaxValue(e)}function Qn(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Ea(e,n,l,v,E){if(!n[0]&&!n[1])return e;var C=F.convert(n)._mult(E);l==="viewport"&&C._rotate(-v);for(var i=[],t=0;t<e.length;t++)i.push(e[t].sub(C));return i}jo.prototype.populate=function(e,n,l){var v=this.layers[0],E=[],C=null;v.type==="circle"&&(C=v.layout.get("circle-sort-key"));for(var i=0,t=e;i<t.length;i+=1){var a=t[i],p=a.feature,_=a.id,b=a.index,I=a.sourceLayerIndex,P=this.layers[0]._featureFilter.needGeometry,R=ur(p,P);if(this.layers[0]._featureFilter.filter(new Nt(this.zoom),R,l)){var O=C?C.evaluate(R,{},l):void 0,V={id:_,properties:p.properties,type:p.type,sourceLayerIndex:I,index:b,geometry:P?R.geometry:xn(p),patterns:{},sortKey:O};E.push(V)}}C&&E.sort(function(Be,qe){return Be.sortKey-qe.sortKey});for(var j=0,K=E;j<K.length;j+=1){var Y=K[j],Q=Y.geometry,se=Y.index,pe=Y.sourceLayerIndex,Ae=e[se].feature;this.addFeature(Y,Q,se,l),n.featureIndex.insert(Ae,Q,se,pe,this.index)}},jo.prototype.update=function(e,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,l)},jo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},jo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},jo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,he),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},jo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},jo.prototype.addFeature=function(e,n,l,v){for(var E=0,C=n;E<C.length;E+=1)for(var i=0,t=C[E];i<t.length;i+=1){var a=t[i],p=a.x,_=a.y;if(!(p<0||p>=8192||_<0||_>=8192)){var b=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),I=b.vertexLength;Jo(this.layoutVertexArray,p,_,-1,-1),Jo(this.layoutVertexArray,p,_,1,-1),Jo(this.layoutVertexArray,p,_,1,1),Jo(this.layoutVertexArray,p,_,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+3,I+2),b.vertexLength+=4,b.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,{},v)},oi("CircleBucket",jo,{omit:["layers"]});var Cl=new T({"circle-sort-key":new Gt(ye.layout_circle["circle-sort-key"])}),ys={paint:new T({"circle-radius":new Gt(ye.paint_circle["circle-radius"]),"circle-color":new Gt(ye.paint_circle["circle-color"]),"circle-blur":new Gt(ye.paint_circle["circle-blur"]),"circle-opacity":new Gt(ye.paint_circle["circle-opacity"]),"circle-translate":new Zt(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new Zt(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Zt(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Zt(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Gt(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Gt(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Gt(ye.paint_circle["circle-stroke-opacity"])}),layout:Cl},Er=typeof Float32Array!="undefined"?Float32Array:Array;function $o(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ha(e,n,l){var v=n[0],E=n[1],C=n[2],i=n[3],t=n[4],a=n[5],p=n[6],_=n[7],b=n[8],I=n[9],P=n[10],R=n[11],O=n[12],V=n[13],j=n[14],K=n[15],Y=l[0],Q=l[1],se=l[2],pe=l[3];return e[0]=Y*v+Q*t+se*b+pe*O,e[1]=Y*E+Q*a+se*I+pe*V,e[2]=Y*C+Q*p+se*P+pe*j,e[3]=Y*i+Q*_+se*R+pe*K,e[4]=(Y=l[4])*v+(Q=l[5])*t+(se=l[6])*b+(pe=l[7])*O,e[5]=Y*E+Q*a+se*I+pe*V,e[6]=Y*C+Q*p+se*P+pe*j,e[7]=Y*i+Q*_+se*R+pe*K,e[8]=(Y=l[8])*v+(Q=l[9])*t+(se=l[10])*b+(pe=l[11])*O,e[9]=Y*E+Q*a+se*I+pe*V,e[10]=Y*C+Q*p+se*P+pe*j,e[11]=Y*i+Q*_+se*R+pe*K,e[12]=(Y=l[12])*v+(Q=l[13])*t+(se=l[14])*b+(pe=l[15])*O,e[13]=Y*E+Q*a+se*I+pe*V,e[14]=Y*C+Q*p+se*P+pe*j,e[15]=Y*i+Q*_+se*R+pe*K,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,n=0,l=arguments.length;l--;)n+=e[l]*e[l];return Math.sqrt(n)});var ou,Bu=ha;function Ou(e,n,l){var v=n[0],E=n[1],C=n[2],i=n[3];return e[0]=l[0]*v+l[4]*E+l[8]*C+l[12]*i,e[1]=l[1]*v+l[5]*E+l[9]*C+l[13]*i,e[2]=l[2]*v+l[6]*E+l[10]*C+l[14]*i,e[3]=l[3]*v+l[7]*E+l[11]*C+l[15]*i,e}ou=new Er(3),Er!=Float32Array&&(ou[0]=0,ou[1]=0,ou[2]=0),function(){var e=new Er(4);Er!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var rp=(function(){var e=new Er(2);Er!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function n(l){e.call(this,l,ys)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.createBucket=function(l){return new jo(l)},n.prototype.queryRadius=function(l){var v=l;return ms("circle-radius",this,v)+ms("circle-stroke-width",this,v)+Qn(this.paint.get("circle-translate"))},n.prototype.queryIntersectsFeature=function(l,v,E,C,i,t,a,p){for(var _=Ea(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),t.angle,a),b=this.paint.get("circle-radius").evaluate(v,E)+this.paint.get("circle-stroke-width").evaluate(v,E),I=this.paint.get("circle-pitch-alignment")==="map",P=I?_:function(Ae,Be){return Ae.map(function(qe){return rl(qe,Be)})}(_,p),R=I?b*a:b,O=0,V=C;O<V.length;O+=1)for(var j=0,K=V[O];j<K.length;j+=1){var Y=K[j],Q=I?Y:rl(Y,p),se=R,pe=Ou([],[Y.x,Y.y,0,1],p);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?se*=pe[3]/t.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(se*=t.cameraToCenterDistance/pe[3]),Yn(P,Q,se))return!0}return!1},n}(o));function rl(e,n){var l=Ou([],[e.x,e.y,0,1],n);return new F(l[0]/l[3],l[1]/l[3])}var np=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(jo);function nl(e,n,l,v){var E=n.width,C=n.height;if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==E*C*l)throw new RangeError("mismatched image size")}else v=new Uint8Array(E*C*l);return e.width=E,e.height=C,e.data=v,e}function pc(e,n,l){var v=n.width,E=n.height;if(v!==e.width||E!==e.height){var C=nl({},{width:v,height:E},l);op(e,C,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,v),height:Math.min(e.height,E)},l),e.width=v,e.height=E,e.data=C.data}}function op(e,n,l,v,E,C){if(E.width===0||E.height===0)return n;if(E.width>e.width||E.height>e.height||l.x>e.width-E.width||l.y>e.height-E.height)throw new RangeError("out of range source coordinates for image copy");if(E.width>n.width||E.height>n.height||v.x>n.width-E.width||v.y>n.height-E.height)throw new RangeError("out of range destination coordinates for image copy");for(var i=e.data,t=n.data,a=0;a<E.height;a++)for(var p=((l.y+a)*e.width+l.x)*C,_=((v.y+a)*n.width+v.x)*C,b=0;b<E.width*C;b++)t[_+b]=i[p+b];return n}oi("HeatmapBucket",np,{omit:["layers"]});var dc=function(e,n){nl(this,e,1,n)};dc.prototype.resize=function(e){pc(this,e,1)},dc.prototype.clone=function(){return new dc({width:this.width,height:this.height},new Uint8Array(this.data))},dc.copy=function(e,n,l,v,E){op(e,n,l,v,E,1)};var Yo=function(e,n){nl(this,e,4,n)};Yo.prototype.resize=function(e){pc(this,e,4)},Yo.prototype.replace=function(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Yo.prototype.clone=function(){return new Yo({width:this.width,height:this.height},new Uint8Array(this.data))},Yo.copy=function(e,n,l,v,E){op(e,n,l,v,E,4)},oi("AlphaImage",dc),oi("RGBAImage",Yo);var Gd={paint:new T({"heatmap-radius":new Gt(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Gt(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Zt(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new No(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Zt(ye.paint_heatmap["heatmap-opacity"])})};function ap(e){var n={},l=e.resolution||256,v=e.clips?e.clips.length:1,E=e.image||new Yo({width:l,height:v}),C=function(R,O,V){n[e.evaluationKey]=V;var j=e.expression.evaluate(n);E.data[R+O+0]=Math.floor(255*j.r/j.a),E.data[R+O+1]=Math.floor(255*j.g/j.a),E.data[R+O+2]=Math.floor(255*j.b/j.a),E.data[R+O+3]=Math.floor(255*j.a)};if(e.clips)for(var i=0,t=0;i<v;++i,t+=4*l)for(var a=0,p=0;a<l;a++,p+=4){var _=a/(l-1),b=e.clips[i];C(t,p,b.start*(1-_)+b.end*_)}else for(var I=0,P=0;I<l;I++,P+=4)C(0,P,I/(l-1));return E}var wh=function(e){function n(l){e.call(this,l,Gd),this._updateColorRamp()}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.createBucket=function(l){return new np(l)},n.prototype._handleSpecialPaintPropertyUpdate=function(l){l==="heatmap-color"&&this._updateColorRamp()},n.prototype._updateColorRamp=function(){this.colorRamp=ap({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},n.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},n}(o),gs={paint:new T({"hillshade-illumination-direction":new Zt(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Zt(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Zt(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Zt(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Zt(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Zt(ye.paint_hillshade["hillshade-accent-color"])})},Zd=function(e){function n(l){e.call(this,l,gs)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},n}(o),bm=M([{name:"a_pos",components:2,type:"Int16"}],4).members,Xp=jc,wm=jc;function jc(e,n,l){l=l||2;var v,E,C,i,t,a,p,_=n&&n.length,b=_?n[0]*l:e.length,I=Eh(e,0,b,l,!0),P=[];if(!I||I.next===I.prev)return P;if(_&&(I=function(O,V,j,K){var Y,Q,se,pe=[];for(Y=0,Q=V.length;Y<Q;Y++)(se=Eh(O,V[Y]*K,Y<Q-1?V[Y+1]*K:O.length,K,!1))===se.next&&(se.steiner=!0),pe.push(Jp(se));for(pe.sort(Tm),Y=0;Y<pe.length;Y++)Am(pe[Y],j),j=au(j,j.next);return j}(e,n,I,l)),e.length>80*l){v=C=e[0],E=i=e[1];for(var R=l;R<b;R+=l)(t=e[R])<v&&(v=t),(a=e[R+1])<E&&(E=a),t>C&&(C=t),a>i&&(i=a);p=(p=Math.max(C-v,i-E))!==0?1/p:0}return Ds(I,P,l,v,E,p),P}function Eh(e,n,l,v,E){var C,i;if(E===Ah(e,n,l,v)>0)for(C=n;C<l;C+=v)i=$p(C,e[C],e[C+1],i);else for(C=l-v;C>=n;C-=v)i=$p(C,e[C],e[C+1],i);return i&&Pn(i,i.next)&&(Zc(i),i=i.next),i}function au(e,n){if(!e)return e;n||(n=e);var l,v=e;do if(l=!1,v.steiner||!Pn(v,v.next)&&eo(v.prev,v,v.next)!==0)v=v.next;else{if(Zc(v),(v=n=v.prev)===v.next)break;l=!0}while(l||v!==n);return n}function Ds(e,n,l,v,E,C,i){if(e){!i&&C&&function(_,b,I,P){var R=_;do R.z===null&&(R.z=Kp(R.x,R.y,b,I,P)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==_);R.prevZ.nextZ=null,R.prevZ=null,function(O){var V,j,K,Y,Q,se,pe,Ae,Be=1;do{for(j=O,O=null,Q=null,se=0;j;){for(se++,K=j,pe=0,V=0;V<Be&&(pe++,K=K.nextZ);V++);for(Ae=Be;pe>0||Ae>0&&K;)pe!==0&&(Ae===0||!K||j.z<=K.z)?(Y=j,j=j.nextZ,pe--):(Y=K,K=K.nextZ,Ae--),Q?Q.nextZ=Y:O=Y,Y.prevZ=Q,Q=Y;j=K}Q.nextZ=null,Be*=2}while(se>1)}(R)}(e,v,E,C);for(var t,a,p=e;e.prev!==e.next;)if(t=e.prev,a=e.next,C?Em(e,v,E,C):Ih(e))n.push(t.i/l),n.push(e.i/l),n.push(a.i/l),Zc(e),e=a.next,p=a.next;else if((e=a)===p){i?i===1?Ds(e=Im(au(e),n,l),n,l,v,E,C,2):i===2&&Sm(e,n,l,v,E,C):Ds(au(e),n,l,v,E,C,1);break}}}function Ih(e){var n=e.prev,l=e,v=e.next;if(eo(n,l,v)>=0)return!1;for(var E=e.next.next;E!==e.prev;){if(Vc(n.x,n.y,l.x,l.y,v.x,v.y,E.x,E.y)&&eo(E.prev,E,E.next)>=0)return!1;E=E.next}return!0}function Em(e,n,l,v){var E=e.prev,C=e,i=e.next;if(eo(E,C,i)>=0)return!1;for(var t=E.x>C.x?E.x>i.x?E.x:i.x:C.x>i.x?C.x:i.x,a=E.y>C.y?E.y>i.y?E.y:i.y:C.y>i.y?C.y:i.y,p=Kp(E.x<C.x?E.x<i.x?E.x:i.x:C.x<i.x?C.x:i.x,E.y<C.y?E.y<i.y?E.y:i.y:C.y<i.y?C.y:i.y,n,l,v),_=Kp(t,a,n,l,v),b=e.prevZ,I=e.nextZ;b&&b.z>=p&&I&&I.z<=_;){if(b!==e.prev&&b!==e.next&&Vc(E.x,E.y,C.x,C.y,i.x,i.y,b.x,b.y)&&eo(b.prev,b,b.next)>=0||(b=b.prevZ,I!==e.prev&&I!==e.next&&Vc(E.x,E.y,C.x,C.y,i.x,i.y,I.x,I.y)&&eo(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;b&&b.z>=p;){if(b!==e.prev&&b!==e.next&&Vc(E.x,E.y,C.x,C.y,i.x,i.y,b.x,b.y)&&eo(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;I&&I.z<=_;){if(I!==e.prev&&I!==e.next&&Vc(E.x,E.y,C.x,C.y,i.x,i.y,I.x,I.y)&&eo(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function Im(e,n,l){var v=e;do{var E=v.prev,C=v.next.next;!Pn(E,C)&&Sh(E,v,v.next,C)&&Fu(E,C)&&Fu(C,E)&&(n.push(E.i/l),n.push(v.i/l),n.push(C.i/l),Zc(v),Zc(v.next),v=e=C),v=v.next}while(v!==e);return au(v)}function Sm(e,n,l,v,E,C){var i=e;do{for(var t=i.next.next;t!==i.prev;){if(i.i!==t.i&&qc(i,t)){var a=Gc(i,t);return i=au(i,i.next),a=au(a,a.next),Ds(i,n,l,v,E,C),void Ds(a,n,l,v,E,C)}t=t.next}i=i.next}while(i!==e)}function Tm(e,n){return e.x-n.x}function Am(e,n){if(n=function(v,E){var C,i=E,t=v.x,a=v.y,p=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var _=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(_<=t&&_>p){if(p=_,_===t){if(a===i.y)return i;if(a===i.next.y)return i.next}C=i.x<i.next.x?i:i.next}}i=i.next}while(i!==E);if(!C)return null;if(t===p)return C;var b,I=C,P=C.x,R=C.y,O=1/0;i=C;do t>=i.x&&i.x>=P&&t!==i.x&&Vc(a<R?t:p,a,P,R,a<R?p:t,a,i.x,i.y)&&(b=Math.abs(a-i.y)/(t-i.x),Fu(i,v)&&(b<O||b===O&&(i.x>C.x||i.x===C.x&&Cm(C,i)))&&(C=i,O=b)),i=i.next;while(i!==I);return C}(e,n)){var l=Gc(n,e);au(n,n.next),au(l,l.next)}}function Cm(e,n){return eo(e.prev,e,n.prev)<0&&eo(n.next,e,e.next)<0}function Kp(e,n,l,v,E){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-l)*E)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-v)*E)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Jp(e){var n=e,l=e;do(n.x<l.x||n.x===l.x&&n.y<l.y)&&(l=n),n=n.next;while(n!==e);return l}function Vc(e,n,l,v,E,C,i,t){return(E-i)*(n-t)-(e-i)*(C-t)>=0&&(e-i)*(v-t)-(l-i)*(n-t)>=0&&(l-i)*(C-t)-(E-i)*(v-t)>=0}function qc(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!function(l,v){var E=l;do{if(E.i!==l.i&&E.next.i!==l.i&&E.i!==v.i&&E.next.i!==v.i&&Sh(E,E.next,l,v))return!0;E=E.next}while(E!==l);return!1}(e,n)&&(Fu(e,n)&&Fu(n,e)&&function(l,v){var E=l,C=!1,i=(l.x+v.x)/2,t=(l.y+v.y)/2;do E.y>t!=E.next.y>t&&E.next.y!==E.y&&i<(E.next.x-E.x)*(t-E.y)/(E.next.y-E.y)+E.x&&(C=!C),E=E.next;while(E!==l);return C}(e,n)&&(eo(e.prev,e,n.prev)||eo(e,n.prev,n))||Pn(e,n)&&eo(e.prev,e,e.next)>0&&eo(n.prev,n,n.next)>0)}function eo(e,n,l){return(n.y-e.y)*(l.x-n.x)-(n.x-e.x)*(l.y-n.y)}function Pn(e,n){return e.x===n.x&&e.y===n.y}function Sh(e,n,l,v){var E=fc(eo(e,n,l)),C=fc(eo(e,n,v)),i=fc(eo(l,v,e)),t=fc(eo(l,v,n));return E!==C&&i!==t||!(E!==0||!Th(e,l,n))||!(C!==0||!Th(e,v,n))||!(i!==0||!Th(l,e,v))||!(t!==0||!Th(l,n,v))}function Th(e,n,l){return n.x<=Math.max(e.x,l.x)&&n.x>=Math.min(e.x,l.x)&&n.y<=Math.max(e.y,l.y)&&n.y>=Math.min(e.y,l.y)}function fc(e){return e>0?1:e<0?-1:0}function Fu(e,n){return eo(e.prev,e,e.next)<0?eo(e,n,e.next)>=0&&eo(e,e.prev,n)>=0:eo(e,n,e.prev)<0||eo(e,e.next,n)<0}function Gc(e,n){var l=new mc(e.i,e.x,e.y),v=new mc(n.i,n.x,n.y),E=e.next,C=n.prev;return e.next=n,n.prev=e,l.next=E,E.prev=l,v.next=l,l.prev=v,C.next=v,v.prev=C,v}function $p(e,n,l,v){var E=new mc(e,n,l);return v?(E.next=v.next,E.prev=v,v.next.prev=E,v.next=E):(E.prev=E,E.next=E),E}function Zc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function mc(e,n,l){this.i=e,this.x=n,this.y=l,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ah(e,n,l,v){for(var E=0,C=n,i=l-v;C<l;C+=v)E+=(e[i]-e[C])*(e[C+1]+e[i+1]),i=C;return E}function Yp(e,n,l,v,E){(function C(i,t,a,p,_){for(;p>a;){if(p-a>600){var b=p-a+1,I=t-a+1,P=Math.log(b),R=.5*Math.exp(2*P/3),O=.5*Math.sqrt(P*R*(b-R)/b)*(I-b/2<0?-1:1);C(i,t,Math.max(a,Math.floor(t-I*R/b+O)),Math.min(p,Math.floor(t+(b-I)*R/b+O)),_)}var V=i[t],j=a,K=p;for(Hc(i,a,t),_(i[p],V)>0&&Hc(i,a,p);j<K;){for(Hc(i,j,K),j++,K--;_(i[j],V)<0;)j++;for(;_(i[K],V)>0;)K--}_(i[a],V)===0?Hc(i,a,K):Hc(i,++K,p),K<=t&&(a=K+1),t<=K&&(p=K-1)}})(e,n,l||0,v||e.length-1,E||km)}function Hc(e,n,l){var v=e[n];e[n]=e[l],e[l]=v}function km(e,n){return e<n?-1:e>n?1:0}function sp(e,n){var l=e.length;if(l<=1)return[e];for(var v,E,C=[],i=0;i<l;i++){var t=Ai(e[i]);t!==0&&(e[i].area=Math.abs(t),E===void 0&&(E=t<0),E===t<0?(v&&C.push(v),v=[e[i]]):v.push(e[i]))}if(v&&C.push(v),n>1)for(var a=0;a<C.length;a++)C[a].length<=n||(Yp(C[a],n,1,C[a].length-1,Ch),C[a]=C[a].slice(0,n));return C}function Ch(e,n){return n.area-e.area}function Qp(e,n,l){for(var v=l.patternDependencies,E=!1,C=0,i=n;C<i.length;C+=1){var t=i[C].paint.get(e+"-pattern");t.isConstant()||(E=!0);var a=t.constantOr(null);a&&(E=!0,v[a.to]=!0,v[a.from]=!0)}return E}function kh(e,n,l,v,E){for(var C=E.patternDependencies,i=0,t=n;i<t.length;i+=1){var a=t[i],p=a.paint.get(e+"-pattern").value;if(p.kind!=="constant"){var _=p.evaluate({zoom:v-1},l,{},E.availableImages),b=p.evaluate({zoom:v},l,{},E.availableImages),I=p.evaluate({zoom:v+1},l,{},E.availableImages);b=b&&b.name?b.name:b,I=I&&I.name?I.name:I,C[_=_&&_.name?_.name:_]=!0,C[b]=!0,C[I]=!0,l.patterns[a.id]={min:_,mid:b,max:I}}}return l}jc.deviation=function(e,n,l,v){var E=n&&n.length,C=Math.abs(Ah(e,0,E?n[0]*l:e.length,l));if(E)for(var i=0,t=n.length;i<t;i++)C-=Math.abs(Ah(e,n[i]*l,i<t-1?n[i+1]*l:e.length,l));var a=0;for(i=0;i<v.length;i+=3){var p=v[i]*l,_=v[i+1]*l,b=v[i+2]*l;a+=Math.abs((e[p]-e[b])*(e[_+1]-e[p+1])-(e[p]-e[_])*(e[b+1]-e[p+1]))}return C===0&&a===0?0:Math.abs((a-C)/C)},jc.flatten=function(e){for(var n=e[0][0].length,l={vertices:[],holes:[],dimensions:n},v=0,E=0;E<e.length;E++){for(var C=0;C<e[E].length;C++)for(var i=0;i<n;i++)l.vertices.push(e[E][C][i]);E>0&&l.holes.push(v+=e[E-1].length)}return l},Xp.default=wm;var ol=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Z,this.indexArray=new xt,this.indexArray2=new pi,this.programConfigurations=new vi(e.layers,e.zoom),this.segments=new de,this.segments2=new de,this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};ol.prototype.populate=function(e,n,l){this.hasPattern=Qp("fill",this.layers,n);for(var v=this.layers[0].layout.get("fill-sort-key"),E=[],C=0,i=e;C<i.length;C+=1){var t=i[C],a=t.feature,p=t.id,_=t.index,b=t.sourceLayerIndex,I=this.layers[0]._featureFilter.needGeometry,P=ur(a,I);if(this.layers[0]._featureFilter.filter(new Nt(this.zoom),P,l)){var R=v?v.evaluate(P,{},l,n.availableImages):void 0,O={id:p,properties:a.properties,type:a.type,sourceLayerIndex:b,index:_,geometry:I?P.geometry:xn(a),patterns:{},sortKey:R};E.push(O)}}v&&E.sort(function(Ae,Be){return Ae.sortKey-Be.sortKey});for(var V=0,j=E;V<j.length;V+=1){var K=j[V],Y=K.geometry,Q=K.index,se=K.sourceLayerIndex;if(this.hasPattern){var pe=kh("fill",this.layers,K,this.zoom,n);this.patternFeatures.push(pe)}else this.addFeature(K,Y,Q,l,{});n.featureIndex.insert(e[Q].feature,Y,Q,se,this.index)}},ol.prototype.update=function(e,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,l)},ol.prototype.addFeatures=function(e,n,l){for(var v=0,E=this.patternFeatures;v<E.length;v+=1){var C=E[v];this.addFeature(C,C.geometry,C.index,n,l)}},ol.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ol.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ol.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,bm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},ol.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},ol.prototype.addFeature=function(e,n,l,v,E){for(var C=0,i=sp(n,500);C<i.length;C+=1){for(var t=i[C],a=0,p=0,_=t;p<_.length;p+=1)a+=_[p].length;for(var b=this.segments.prepareSegment(a,this.layoutVertexArray,this.indexArray),I=b.vertexLength,P=[],R=[],O=0,V=t;O<V.length;O+=1){var j=V[O];if(j.length!==0){j!==t[0]&&R.push(P.length/2);var K=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),Y=K.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(Y+j.length-1,Y),P.push(j[0].x),P.push(j[0].y);for(var Q=1;Q<j.length;Q++)this.layoutVertexArray.emplaceBack(j[Q].x,j[Q].y),this.indexArray2.emplaceBack(Y+Q-1,Y+Q),P.push(j[Q].x),P.push(j[Q].y);K.vertexLength+=j.length,K.primitiveLength+=j.length}}for(var se=Xp(P,R),pe=0;pe<se.length;pe+=3)this.indexArray.emplaceBack(I+se[pe],I+se[pe+1],I+se[pe+2]);b.vertexLength+=a,b.primitiveLength+=se.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,E,v)},oi("FillBucket",ol,{omit:["layers","patternFeatures"]});var ed=new T({"fill-sort-key":new Gt(ye.layout_fill["fill-sort-key"])}),td={paint:new T({"fill-antialias":new Zt(ye.paint_fill["fill-antialias"]),"fill-opacity":new Gt(ye.paint_fill["fill-opacity"]),"fill-color":new Gt(ye.paint_fill["fill-color"]),"fill-outline-color":new Gt(ye.paint_fill["fill-outline-color"]),"fill-translate":new Zt(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new Zt(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new iu(ye.paint_fill["fill-pattern"])}),layout:ed},id=function(e){function n(l){e.call(this,l,td)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.recalculate=function(l,v){e.prototype.recalculate.call(this,l,v);var E=this.paint._values["fill-outline-color"];E.value.kind==="constant"&&E.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},n.prototype.createBucket=function(l){return new ol(l)},n.prototype.queryRadius=function(){return Qn(this.paint.get("fill-translate"))},n.prototype.queryIntersectsFeature=function(l,v,E,C,i,t,a){return ba(Ea(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),t.angle,a),C)},n.prototype.isTileClipped=function(){return!0},n}(o),zm=M([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Hd=Wc;function Wc(e,n,l,v,E){this.properties={},this.extent=l,this.type=0,this._pbf=e,this._geometry=-1,this._keys=v,this._values=E,e.readFields(Pm,this,n)}function Pm(e,n,l){e==1?n.id=l.readVarint():e==2?function(v,E){for(var C=v.readVarint()+v.pos;v.pos<C;){var i=E._keys[v.readVarint()],t=E._values[v.readVarint()];E.properties[i]=t}}(l,n):e==3?n.type=l.readVarint():e==4&&(n._geometry=l.pos)}function Uu(e){for(var n,l,v=0,E=0,C=e.length,i=C-1;E<C;i=E++)v+=((l=e[i]).x-(n=e[E]).x)*(n.y+l.y);return v}Wc.types=["Unknown","Point","LineString","Polygon"],Wc.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var n,l=e.readVarint()+e.pos,v=1,E=0,C=0,i=0,t=[];e.pos<l;){if(E<=0){var a=e.readVarint();v=7&a,E=a>>3}if(E--,v===1||v===2)C+=e.readSVarint(),i+=e.readSVarint(),v===1&&(n&&t.push(n),n=[]),n.push(new F(C,i));else{if(v!==7)throw new Error("unknown command "+v);n&&n.push(n[0].clone())}}return n&&t.push(n),t},Wc.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var n=e.readVarint()+e.pos,l=1,v=0,E=0,C=0,i=1/0,t=-1/0,a=1/0,p=-1/0;e.pos<n;){if(v<=0){var _=e.readVarint();l=7&_,v=_>>3}if(v--,l===1||l===2)(E+=e.readSVarint())<i&&(i=E),E>t&&(t=E),(C+=e.readSVarint())<a&&(a=C),C>p&&(p=C);else if(l!==7)throw new Error("unknown command "+l)}return[i,a,t,p]},Wc.prototype.toGeoJSON=function(e,n,l){var v,E,C=this.extent*Math.pow(2,l),i=this.extent*e,t=this.extent*n,a=this.loadGeometry(),p=Wc.types[this.type];function _(P){for(var R=0;R<P.length;R++){var O=P[R];P[R]=[360*(O.x+i)/C-180,360/Math.PI*Math.atan(Math.exp((180-360*(O.y+t)/C)*Math.PI/180))-90]}}switch(this.type){case 1:var b=[];for(v=0;v<a.length;v++)b[v]=a[v][0];_(a=b);break;case 2:for(v=0;v<a.length;v++)_(a[v]);break;case 3:for(a=function(P){var R=P.length;if(R<=1)return[P];for(var O,V,j=[],K=0;K<R;K++){var Y=Uu(P[K]);Y!==0&&(V===void 0&&(V=Y<0),V===Y<0?(O&&j.push(O),O=[P[K]]):O.push(P[K]))}return O&&j.push(O),j}(a),v=0;v<a.length;v++)for(E=0;E<a[v].length;E++)_(a[v][E])}a.length===1?a=a[0]:p="Multi"+p;var I={type:"Feature",geometry:{type:p,coordinates:a},properties:this.properties};return"id"in this&&(I.id=this.id),I};var Wd=rd;function rd(e,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Xc,this,n),this.length=this._features.length}function Xc(e,n,l){e===15?n.version=l.readVarint():e===1?n.name=l.readString():e===5?n.extent=l.readVarint():e===2?n._features.push(l.pos):e===3?n._keys.push(l.readString()):e===4&&n._values.push(function(v){for(var E=null,C=v.readVarint()+v.pos;v.pos<C;){var i=v.readVarint()>>3;E=i===1?v.readString():i===2?v.readFloat():i===3?v.readDouble():i===4?v.readVarint64():i===5?v.readVarint():i===6?v.readSVarint():i===7?v.readBoolean():null}return E}(l))}function Mm(e,n,l){if(e===3){var v=new Wd(l,l.readVarint()+l.pos);v.length&&(n[v.name]=v)}}rd.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var n=this._pbf.readVarint()+this._pbf.pos;return new Hd(this._pbf,n,this.extent,this._keys,this._values)};var Kc={VectorTile:function(e,n){this.layers=e.readFields(Mm,{},n)},VectorTileFeature:Hd,VectorTileLayer:Wd},Lm=Kc.VectorTileFeature.types,lp=Math.pow(2,13);function Jc(e,n,l,v,E,C,i,t){e.emplaceBack(n,l,2*Math.floor(v*lp)+i,E*lp*2,C*lp*2,Math.round(t))}var al=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ee,this.indexArray=new xt,this.programConfigurations=new vi(e.layers,e.zoom),this.segments=new de,this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};function Dm(e,n){return e.x===n.x&&(e.x<0||e.x>8192)||e.y===n.y&&(e.y<0||e.y>8192)}al.prototype.populate=function(e,n,l){this.features=[],this.hasPattern=Qp("fill-extrusion",this.layers,n);for(var v=0,E=e;v<E.length;v+=1){var C=E[v],i=C.feature,t=C.id,a=C.index,p=C.sourceLayerIndex,_=this.layers[0]._featureFilter.needGeometry,b=ur(i,_);if(this.layers[0]._featureFilter.filter(new Nt(this.zoom),b,l)){var I={id:t,sourceLayerIndex:p,index:a,geometry:_?b.geometry:xn(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(kh("fill-extrusion",this.layers,I,this.zoom,n)):this.addFeature(I,I.geometry,a,l,{}),n.featureIndex.insert(i,I.geometry,a,p,this.index,!0)}}},al.prototype.addFeatures=function(e,n,l){for(var v=0,E=this.features;v<E.length;v+=1){var C=E[v];this.addFeature(C,C.geometry,C.index,n,l)}},al.prototype.update=function(e,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,l)},al.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},al.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},al.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,zm),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},al.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},al.prototype.addFeature=function(e,n,l,v,E){for(var C=0,i=sp(n,500);C<i.length;C+=1){for(var t=i[C],a=0,p=0,_=t;p<_.length;p+=1)a+=_[p].length;for(var b=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),I=0,P=t;I<P.length;I+=1){var R=P[I];if(R.length!==0&&!((St=R).every(function(mt){return mt.x<0})||St.every(function(mt){return mt.x>8192})||St.every(function(mt){return mt.y<0})||St.every(function(mt){return mt.y>8192})))for(var O=0,V=0;V<R.length;V++){var j=R[V];if(V>=1){var K=R[V-1];if(!Dm(j,K)){b.vertexLength+4>de.MAX_VERTEX_ARRAY_LENGTH&&(b=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Y=j.sub(K)._perp()._unit(),Q=K.dist(j);O+Q>32768&&(O=0),Jc(this.layoutVertexArray,j.x,j.y,Y.x,Y.y,0,0,O),Jc(this.layoutVertexArray,j.x,j.y,Y.x,Y.y,0,1,O),Jc(this.layoutVertexArray,K.x,K.y,Y.x,Y.y,0,0,O+=Q),Jc(this.layoutVertexArray,K.x,K.y,Y.x,Y.y,0,1,O);var se=b.vertexLength;this.indexArray.emplaceBack(se,se+2,se+1),this.indexArray.emplaceBack(se+1,se+2,se+3),b.vertexLength+=4,b.primitiveLength+=2}}}}if(b.vertexLength+a>de.MAX_VERTEX_ARRAY_LENGTH&&(b=this.segments.prepareSegment(a,this.layoutVertexArray,this.indexArray)),Lm[e.type]==="Polygon"){for(var pe=[],Ae=[],Be=b.vertexLength,qe=0,Ge=t;qe<Ge.length;qe+=1){var it=Ge[qe];if(it.length!==0){it!==t[0]&&Ae.push(pe.length/2);for(var He=0;He<it.length;He++){var Ct=it[He];Jc(this.layoutVertexArray,Ct.x,Ct.y,0,0,1,1,0),pe.push(Ct.x),pe.push(Ct.y)}}}for(var Tt=Xp(pe,Ae),ut=0;ut<Tt.length;ut+=3)this.indexArray.emplaceBack(Be+Tt[ut],Be+Tt[ut+2],Be+Tt[ut+1]);b.primitiveLength+=Tt.length/3,b.vertexLength+=a}}var St;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,E,v)},oi("FillExtrusionBucket",al,{omit:["layers","features"]});var Rm={paint:new T({"fill-extrusion-opacity":new Zt(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Gt(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Zt(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Zt(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new iu(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Gt(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Gt(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Zt(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Bm=function(e){function n(l){e.call(this,l,Rm)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.createBucket=function(l){return new al(l)},n.prototype.queryRadius=function(){return Qn(this.paint.get("fill-extrusion-translate"))},n.prototype.is3D=function(){return!0},n.prototype.queryIntersectsFeature=function(l,v,E,C,i,t,a,p){var _=Ea(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),t.angle,a),b=this.paint.get("fill-extrusion-height").evaluate(v,E),I=this.paint.get("fill-extrusion-base").evaluate(v,E),P=function(O,V,j,K){for(var Y=[],Q=0,se=O;Q<se.length;Q+=1){var pe=se[Q],Ae=[pe.x,pe.y,0,1];Ou(Ae,Ae,V),Y.push(new F(Ae[0]/Ae[3],Ae[1]/Ae[3]))}return Y}(_,p),R=function(O,V,j,K){for(var Y=[],Q=[],se=K[8]*V,pe=K[9]*V,Ae=K[10]*V,Be=K[11]*V,qe=K[8]*j,Ge=K[9]*j,it=K[10]*j,He=K[11]*j,Ct=0,Tt=O;Ct<Tt.length;Ct+=1){for(var ut=[],St=[],mt=0,kt=Tt[Ct];mt<kt.length;mt+=1){var dt=kt[mt],_t=dt.x,ti=dt.y,Yt=K[0]*_t+K[4]*ti+K[12],ki=K[1]*_t+K[5]*ti+K[13],Mi=K[2]*_t+K[6]*ti+K[14],$i=K[3]*_t+K[7]*ti+K[15],sr=Mi+Ae,kr=$i+Be,zr=Yt+qe,vr=ki+Ge,Br=Mi+it,xr=$i+He,Or=new F((Yt+se)/kr,(ki+pe)/kr);Or.z=sr/kr,ut.push(Or);var Oi=new F(zr/xr,vr/xr);Oi.z=Br/xr,St.push(Oi)}Y.push(ut),Q.push(St)}return[Y,Q]}(C,I,b,p);return function(O,V,j){var K=1/0;ba(j,V)&&(K=$c(j,V[0]));for(var Y=0;Y<V.length;Y++)for(var Q=V[Y],se=O[Y],pe=0;pe<Q.length-1;pe++){var Ae=Q[pe],Be=[Ae,Q[pe+1],se[pe+1],se[pe],Ae];xa(j,Be)&&(K=Math.min(K,$c(j,Be)))}return K!==1/0&&K}(R[0],R[1],P)},n}(o);function yc(e,n){return e.x*n.x+e.y*n.y}function $c(e,n){if(e.length===1){for(var l,v=0,E=n[v++];!l||E.equals(l);)if(!(l=n[v++]))return 1/0;for(;v<n.length;v++){var C=n[v],i=e[0],t=l.sub(E),a=C.sub(E),p=i.sub(E),_=yc(t,t),b=yc(t,a),I=yc(a,a),P=yc(p,t),R=yc(p,a),O=_*I-b*b,V=(I*P-b*R)/O,j=(_*R-b*P)/O,K=E.z*(1-V-j)+l.z*V+C.z*j;if(isFinite(K))return K}return 1/0}for(var Y=1/0,Q=0,se=n;Q<se.length;Q+=1)Y=Math.min(Y,se[Q].z);return Y}var nd=M([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Om=M([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Fm=Kc.VectorTileFeature.types,Um=Math.cos(Math.PI/180*37.5),Yc=Math.pow(2,14)/.5,Qo=function(e){var n=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(l){n.gradients[l.id]={}}),this.layoutVertexArray=new re,this.layoutVertexArray2=new ue,this.indexArray=new xt,this.programConfigurations=new vi(e.layers,e.zoom),this.segments=new de,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};Qo.prototype.populate=function(e,n,l){this.hasPattern=Qp("line",this.layers,n);for(var v=this.layers[0].layout.get("line-sort-key"),E=[],C=0,i=e;C<i.length;C+=1){var t=i[C],a=t.feature,p=t.id,_=t.index,b=t.sourceLayerIndex,I=this.layers[0]._featureFilter.needGeometry,P=ur(a,I);if(this.layers[0]._featureFilter.filter(new Nt(this.zoom),P,l)){var R=v?v.evaluate(P,{},l):void 0,O={id:p,properties:a.properties,type:a.type,sourceLayerIndex:b,index:_,geometry:I?P.geometry:xn(a),patterns:{},sortKey:R};E.push(O)}}v&&E.sort(function(Ae,Be){return Ae.sortKey-Be.sortKey});for(var V=0,j=E;V<j.length;V+=1){var K=j[V],Y=K.geometry,Q=K.index,se=K.sourceLayerIndex;if(this.hasPattern){var pe=kh("line",this.layers,K,this.zoom,n);this.patternFeatures.push(pe)}else this.addFeature(K,Y,Q,l,{});n.featureIndex.insert(e[Q].feature,Y,Q,se,this.index)}},Qo.prototype.update=function(e,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,l)},Qo.prototype.addFeatures=function(e,n,l){for(var v=0,E=this.patternFeatures;v<E.length;v+=1){var C=E[v];this.addFeature(C,C.geometry,C.index,n,l)}},Qo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Qo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Qo.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Om)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,nd),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Qo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Qo.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Qo.prototype.addFeature=function(e,n,l,v,E){var C=this.layers[0].layout,i=C.get("line-join").evaluate(e,{}),t=C.get("line-cap"),a=C.get("line-miter-limit"),p=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var _=0,b=n;_<b.length;_+=1)this.addLine(b[_],e,i,t,a,p);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,E,v)},Qo.prototype.addLine=function(e,n,l,v,E,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var i=0;i<e.length-1;i++)this.totalDistance+=e[i].dist(e[i+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var t=Fm[n.type]==="Polygon",a=e.length;a>=2&&e[a-1].equals(e[a-2]);)a--;for(var p=0;p<a-1&&e[p].equals(e[p+1]);)p++;if(!(a<(t?3:2))){l==="bevel"&&(E=1.05);var _,b=this.overscaling<=16?122880/(512*this.overscaling):0,I=this.segments.prepareSegment(10*a,this.layoutVertexArray,this.indexArray),P=void 0,R=void 0,O=void 0,V=void 0;this.e1=this.e2=-1,t&&(V=e[p].sub(_=e[a-2])._unit()._perp());for(var j=p;j<a;j++)if(!(R=j===a-1?t?e[p+1]:void 0:e[j+1])||!e[j].equals(R)){V&&(O=V),_&&(P=_),_=e[j],V=R?R.sub(_)._unit()._perp():O;var K=(O=O||V).add(V);K.x===0&&K.y===0||K._unit();var Y=O.x*V.x+O.y*V.y,Q=K.x*V.x+K.y*V.y,se=Q!==0?1/Q:1/0,pe=2*Math.sqrt(2-2*Q),Ae=Q<Um&&P&&R,Be=O.x*V.y-O.y*V.x>0;if(Ae&&j>p){var qe=_.dist(P);if(qe>2*b){var Ge=_.sub(_.sub(P)._mult(b/qe)._round());this.updateDistance(P,Ge),this.addCurrentVertex(Ge,O,0,0,I),P=Ge}}var it=P&&R,He=it?l:t?"butt":v;if(it&&He==="round"&&(se<C?He="miter":se<=2&&(He="fakeround")),He==="miter"&&se>E&&(He="bevel"),He==="bevel"&&(se>2&&(He="flipbevel"),se<E&&(He="miter")),P&&this.updateDistance(P,_),He==="miter")K._mult(se),this.addCurrentVertex(_,K,0,0,I);else if(He==="flipbevel"){if(se>100)K=V.mult(-1);else{var Ct=se*O.add(V).mag()/O.sub(V).mag();K._perp()._mult(Ct*(Be?-1:1))}this.addCurrentVertex(_,K,0,0,I),this.addCurrentVertex(_,K.mult(-1),0,0,I)}else if(He==="bevel"||He==="fakeround"){var Tt=-Math.sqrt(se*se-1),ut=Be?Tt:0,St=Be?0:Tt;if(P&&this.addCurrentVertex(_,O,ut,St,I),He==="fakeround")for(var mt=Math.round(180*pe/Math.PI/20),kt=1;kt<mt;kt++){var dt=kt/mt;if(dt!==.5){var _t=dt-.5;dt+=dt*_t*(dt-1)*((1.0904+Y*(Y*(3.55645-1.43519*Y)-3.2452))*_t*_t+(.848013+Y*(.215638*Y-1.06021)))}var ti=V.sub(O)._mult(dt)._add(O)._unit()._mult(Be?-1:1);this.addHalfVertex(_,ti.x,ti.y,!1,Be,0,I)}R&&this.addCurrentVertex(_,V,-ut,-St,I)}else if(He==="butt")this.addCurrentVertex(_,K,0,0,I);else if(He==="square"){var Yt=P?1:-1;this.addCurrentVertex(_,K,Yt,Yt,I)}else He==="round"&&(P&&(this.addCurrentVertex(_,O,0,0,I),this.addCurrentVertex(_,O,1,1,I,!0)),R&&(this.addCurrentVertex(_,V,-1,-1,I,!0),this.addCurrentVertex(_,V,0,0,I)));if(Ae&&j<a-1){var ki=_.dist(R);if(ki>2*b){var Mi=_.add(R.sub(_)._mult(b/ki)._round());this.updateDistance(_,Mi),this.addCurrentVertex(Mi,V,0,0,I),_=Mi}}}}},Qo.prototype.addCurrentVertex=function(e,n,l,v,E,C){C===void 0&&(C=!1);var i=n.y*v-n.x,t=-n.y-n.x*v;this.addHalfVertex(e,n.x+n.y*l,n.y-n.x*l,C,!1,l,E),this.addHalfVertex(e,i,t,C,!0,-v,E),this.distance>Yc/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,n,l,v,E,C))},Qo.prototype.addHalfVertex=function(e,n,l,v,E,C,i){var t=.5*(this.lineClips?this.scaledDistance*(Yc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(v?1:0),(e.y<<1)+(E?1:0),Math.round(63*n)+128,Math.round(63*l)+128,1+(C===0?0:C<0?-1:1)|(63&t)<<2,t>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var a=i.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,a),i.primitiveLength++),E?this.e2=a:this.e1=a},Qo.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Qo.prototype.updateDistance=function(e,n){this.distance+=e.dist(n),this.updateScaledDistance()},oi("LineBucket",Qo,{omit:["layers","patternFeatures"]});var Nm=new T({"line-cap":new Zt(ye.layout_line["line-cap"]),"line-join":new Gt(ye.layout_line["line-join"]),"line-miter-limit":new Zt(ye.layout_line["line-miter-limit"]),"line-round-limit":new Zt(ye.layout_line["line-round-limit"]),"line-sort-key":new Gt(ye.layout_line["line-sort-key"])}),Xd={paint:new T({"line-opacity":new Gt(ye.paint_line["line-opacity"]),"line-color":new Gt(ye.paint_line["line-color"]),"line-translate":new Zt(ye.paint_line["line-translate"]),"line-translate-anchor":new Zt(ye.paint_line["line-translate-anchor"]),"line-width":new Gt(ye.paint_line["line-width"]),"line-gap-width":new Gt(ye.paint_line["line-gap-width"]),"line-offset":new Gt(ye.paint_line["line-offset"]),"line-blur":new Gt(ye.paint_line["line-blur"]),"line-dasharray":new Bn(ye.paint_line["line-dasharray"]),"line-pattern":new iu(ye.paint_line["line-pattern"]),"line-gradient":new No(ye.paint_line["line-gradient"])}),layout:Nm},Kd=new(function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.possiblyEvaluate=function(l,v){return v=new Nt(Math.floor(v.zoom),{now:v.now,fadeDuration:v.fadeDuration,zoomHistory:v.zoomHistory,transition:v.transition}),e.prototype.possiblyEvaluate.call(this,l,v)},n.prototype.evaluate=function(l,v,E,C){return v=Ne({},v,{zoom:Math.floor(v.zoom)}),e.prototype.evaluate.call(this,l,v,E,C)},n}(Gt))(Xd.paint.properties["line-width"].specification);Kd.useIntegerZoom=!0;var jm=function(e){function n(l){e.call(this,l,Xd),this.gradientVersion=0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._handleSpecialPaintPropertyUpdate=function(l){l==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof po,this.gradientVersion=(this.gradientVersion+1)%Pe)},n.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},n.prototype.recalculate=function(l,v){e.prototype.recalculate.call(this,l,v),this.paint._values["line-floorwidth"]=Kd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)},n.prototype.createBucket=function(l){return new Qo(l)},n.prototype.queryRadius=function(l){var v=l,E=Jd(ms("line-width",this,v),ms("line-gap-width",this,v)),C=ms("line-offset",this,v);return E/2+Math.abs(C)+Qn(this.paint.get("line-translate"))},n.prototype.queryIntersectsFeature=function(l,v,E,C,i,t,a){var p=Ea(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),t.angle,a),_=a/2*Jd(this.paint.get("line-width").evaluate(v,E),this.paint.get("line-gap-width").evaluate(v,E)),b=this.paint.get("line-offset").evaluate(v,E);return b&&(C=function(I,P){for(var R=[],O=new F(0,0),V=0;V<I.length;V++){for(var j=I[V],K=[],Y=0;Y<j.length;Y++){var Q=j[Y],se=j[Y+1],pe=Y===0?O:Q.sub(j[Y-1])._unit()._perp(),Ae=Y===j.length-1?O:se.sub(Q)._unit()._perp(),Be=pe._add(Ae)._unit();Be._mult(1/(Be.x*Ae.x+Be.y*Ae.y)),K.push(Be._mult(P)._add(Q))}R.push(K)}return R}(C,b*a)),function(I,P,R){for(var O=0;O<P.length;O++){var V=P[O];if(I.length>=3){for(var j=0;j<V.length;j++)if(Ls(I,V[j]))return!0}if(wa(I,V,R))return!0}return!1}(p,C,_)},n.prototype.isTileClipped=function(){return!0},n}(o);function Jd(e,n){return n>0?n+2*e:e}var Vm=M([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),$d=M([{name:"a_projected_pos",components:3,type:"Float32"}],4),od=(M([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),M([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Yd=(M([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),M([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Qd=M([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ef(e,n,l){return e.sections.forEach(function(v){v.text=function(E,C,i){var t=C.layout.get("text-transform").evaluate(i,{});return t==="uppercase"?E=E.toLocaleUpperCase():t==="lowercase"&&(E=E.toLocaleLowerCase()),si.applyArabicShaping&&(E=si.applyArabicShaping(E)),E}(v.text,n,l)}),e}M([{name:"triangle",components:3,type:"Uint16"}]),M([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),M([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),M([{type:"Float32",name:"offsetX"}]),M([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Qc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},tf=function(e,n,l,v,E){var C,i,t=8*E-v-1,a=(1<<t)-1,p=a>>1,_=-7,b=l?E-1:0,I=l?-1:1,P=e[n+b];for(b+=I,C=P&(1<<-_)-1,P>>=-_,_+=t;_>0;C=256*C+e[n+b],b+=I,_-=8);for(i=C&(1<<-_)-1,C>>=-_,_+=v;_>0;i=256*i+e[n+b],b+=I,_-=8);if(C===0)C=1-p;else{if(C===a)return i?NaN:1/0*(P?-1:1);i+=Math.pow(2,v),C-=p}return(P?-1:1)*i*Math.pow(2,C-v)},rf=function(e,n,l,v,E,C){var i,t,a,p=8*C-E-1,_=(1<<p)-1,b=_>>1,I=E===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=v?0:C-1,R=v?1:-1,O=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(t=isNaN(n)?1:0,i=_):(i=Math.floor(Math.log(n)/Math.LN2),n*(a=Math.pow(2,-i))<1&&(i--,a*=2),(n+=i+b>=1?I/a:I*Math.pow(2,1-b))*a>=2&&(i++,a/=2),i+b>=_?(t=0,i=_):i+b>=1?(t=(n*a-1)*Math.pow(2,E),i+=b):(t=n*Math.pow(2,b-1)*Math.pow(2,E),i=0));E>=8;e[l+P]=255&t,P+=R,t/=256,E-=8);for(i=i<<E|t,p+=E;p>0;e[l+P]=255&i,P+=R,i/=256,p-=8);e[l+P-R]|=128*O},up=nn;function nn(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}nn.Varint=0,nn.Fixed64=1,nn.Bytes=2,nn.Fixed32=5;var nf=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function su(e){return e.type===nn.Bytes?e.readVarint()+e.pos:e.pos+1}function kl(e,n,l){return l?4294967296*n+(e>>>0):4294967296*(n>>>0)+(e>>>0)}function Do(e,n,l){var v=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));l.realloc(v);for(var E=l.pos-1;E>=e;E--)l.buf[E+v]=l.buf[E]}function ad(e,n){for(var l=0;l<e.length;l++)n.writeVarint(e[l])}function of(e,n){for(var l=0;l<e.length;l++)n.writeSVarint(e[l])}function af(e,n){for(var l=0;l<e.length;l++)n.writeFloat(e[l])}function un(e,n){for(var l=0;l<e.length;l++)n.writeDouble(e[l])}function Nu(e,n){for(var l=0;l<e.length;l++)n.writeBoolean(e[l])}function sd(e,n){for(var l=0;l<e.length;l++)n.writeFixed32(e[l])}function sf(e,n){for(var l=0;l<e.length;l++)n.writeSFixed32(e[l])}function lf(e,n){for(var l=0;l<e.length;l++)n.writeFixed64(e[l])}function lu(e,n){for(var l=0;l<e.length;l++)n.writeSFixed64(e[l])}function uu(e,n){return(e[n]|e[n+1]<<8|e[n+2]<<16)+16777216*e[n+3]}function gc(e,n,l){e[l]=n,e[l+1]=n>>>8,e[l+2]=n>>>16,e[l+3]=n>>>24}function uf(e,n){return(e[n]|e[n+1]<<8|e[n+2]<<16)+(e[n+3]<<24)}function qm(e,n,l){e===1&&l.readMessage(Gm,n)}function Gm(e,n,l){if(e===3){var v=l.readMessage(Zm,{}),E=v.width,C=v.height,i=v.left,t=v.top,a=v.advance;n.push({id:v.id,bitmap:new dc({width:E+6,height:C+6},v.bitmap),metrics:{width:E,height:C,left:i,top:t,advance:a}})}}function Zm(e,n,l){e===1?n.id=l.readVarint():e===2?n.bitmap=l.readBytes():e===3?n.width=l.readVarint():e===4?n.height=l.readVarint():e===5?n.left=l.readSVarint():e===6?n.top=l.readSVarint():e===7&&(n.advance=l.readVarint())}function cf(e){for(var n=0,l=0,v=0,E=e;v<E.length;v+=1){var C=E[v];n+=C.w*C.h,l=Math.max(l,C.w)}e.sort(function(O,V){return V.h-O.h});for(var i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),l),h:1/0}],t=0,a=0,p=0,_=e;p<_.length;p+=1)for(var b=_[p],I=i.length-1;I>=0;I--){var P=i[I];if(!(b.w>P.w||b.h>P.h)){if(b.x=P.x,b.y=P.y,a=Math.max(a,b.y+b.h),t=Math.max(t,b.x+b.w),b.w===P.w&&b.h===P.h){var R=i.pop();I<i.length&&(i[I]=R)}else b.h===P.h?(P.x+=b.w,P.w-=b.w):b.w===P.w?(P.y+=b.h,P.h-=b.h):(i.push({x:P.x+b.w,y:P.y,w:P.w-b.w,h:b.h}),P.y+=b.h,P.h-=b.h);break}}return{w:t,h:a,fill:n/(t*a)||0}}nn.prototype={destroy:function(){this.buf=null},readFields:function(e,n,l){for(l=l||this.length;this.pos<l;){var v=this.readVarint(),E=v>>3,C=this.pos;this.type=7&v,e(E,n,this),this.pos===C&&this.skip(v)}return n},readMessage:function(e,n){return this.readFields(e,n,this.readVarint()+this.pos)},readFixed32:function(){var e=uu(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=uf(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=uu(this.buf,this.pos)+4294967296*uu(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=uu(this.buf,this.pos)+4294967296*uf(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=tf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=tf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var n,l,v=this.buf;return n=127&(l=v[this.pos++]),l<128?n:(n|=(127&(l=v[this.pos++]))<<7,l<128?n:(n|=(127&(l=v[this.pos++]))<<14,l<128?n:(n|=(127&(l=v[this.pos++]))<<21,l<128?n:function(E,C,i){var t,a,p=i.buf;if(t=(112&(a=p[i.pos++]))>>4,a<128||(t|=(127&(a=p[i.pos++]))<<3,a<128)||(t|=(127&(a=p[i.pos++]))<<10,a<128)||(t|=(127&(a=p[i.pos++]))<<17,a<128)||(t|=(127&(a=p[i.pos++]))<<24,a<128)||(t|=(1&(a=p[i.pos++]))<<31,a<128))return kl(E,t,C);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(l=v[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,n=this.pos;return this.pos=e,e-n>=12&&nf?function(l,v,E){return nf.decode(l.subarray(v,E))}(this.buf,n,e):function(l,v,E){for(var C="",i=v;i<E;){var t,a,p,_=l[i],b=null,I=_>239?4:_>223?3:_>191?2:1;if(i+I>E)break;I===1?_<128&&(b=_):I===2?(192&(t=l[i+1]))==128&&(b=(31&_)<<6|63&t)<=127&&(b=null):I===3?(a=l[i+2],(192&(t=l[i+1]))==128&&(192&a)==128&&((b=(15&_)<<12|(63&t)<<6|63&a)<=2047||b>=55296&&b<=57343)&&(b=null)):I===4&&(a=l[i+2],p=l[i+3],(192&(t=l[i+1]))==128&&(192&a)==128&&(192&p)==128&&((b=(15&_)<<18|(63&t)<<12|(63&a)<<6|63&p)<=65535||b>=1114112)&&(b=null)),b===null?(b=65533,I=1):b>65535&&(b-=65536,C+=String.fromCharCode(b>>>10&1023|55296),b=56320|1023&b),C+=String.fromCharCode(b),i+=I}return C}(this.buf,n,e)},readBytes:function(){var e=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,e);return this.pos=e,n},readPackedVarint:function(e,n){if(this.type!==nn.Bytes)return e.push(this.readVarint(n));var l=su(this);for(e=e||[];this.pos<l;)e.push(this.readVarint(n));return e},readPackedSVarint:function(e){if(this.type!==nn.Bytes)return e.push(this.readSVarint());var n=su(this);for(e=e||[];this.pos<n;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==nn.Bytes)return e.push(this.readBoolean());var n=su(this);for(e=e||[];this.pos<n;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==nn.Bytes)return e.push(this.readFloat());var n=su(this);for(e=e||[];this.pos<n;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==nn.Bytes)return e.push(this.readDouble());var n=su(this);for(e=e||[];this.pos<n;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==nn.Bytes)return e.push(this.readFixed32());var n=su(this);for(e=e||[];this.pos<n;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==nn.Bytes)return e.push(this.readSFixed32());var n=su(this);for(e=e||[];this.pos<n;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==nn.Bytes)return e.push(this.readFixed64());var n=su(this);for(e=e||[];this.pos<n;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==nn.Bytes)return e.push(this.readSFixed64());var n=su(this);for(e=e||[];this.pos<n;)e.push(this.readSFixed64());return e},skip:function(e){var n=7&e;if(n===nn.Varint)for(;this.buf[this.pos++]>127;);else if(n===nn.Bytes)this.pos=this.readVarint()+this.pos;else if(n===nn.Fixed32)this.pos+=4;else{if(n!==nn.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(e,n){this.writeVarint(e<<3|n)},realloc:function(e){for(var n=this.length||16;n<this.pos+e;)n*=2;if(n!==this.length){var l=new Uint8Array(n);l.set(this.buf),this.buf=l,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),gc(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),gc(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),gc(this.buf,-1&e,this.pos),gc(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),gc(this.buf,-1&e,this.pos),gc(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(n,l){var v,E;if(n>=0?(v=n%4294967296|0,E=n/4294967296|0):(E=~(-n/4294967296),4294967295^(v=~(-n%4294967296))?v=v+1|0:(v=0,E=E+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(C,i,t){t.buf[t.pos++]=127&C|128,C>>>=7,t.buf[t.pos++]=127&C|128,C>>>=7,t.buf[t.pos++]=127&C|128,C>>>=7,t.buf[t.pos++]=127&C|128,t.buf[t.pos]=127&(C>>>=7)}(v,0,l),function(C,i){var t=(7&C)<<4;i.buf[i.pos++]|=t|((C>>>=3)?128:0),C&&(i.buf[i.pos++]=127&C|((C>>>=7)?128:0),C&&(i.buf[i.pos++]=127&C|((C>>>=7)?128:0),C&&(i.buf[i.pos++]=127&C|((C>>>=7)?128:0),C&&(i.buf[i.pos++]=127&C|((C>>>=7)?128:0),C&&(i.buf[i.pos++]=127&C)))))}(E,l)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var n=this.pos;this.pos=function(v,E,C){for(var i,t,a=0;a<E.length;a++){if((i=E.charCodeAt(a))>55295&&i<57344){if(!t){i>56319||a+1===E.length?(v[C++]=239,v[C++]=191,v[C++]=189):t=i;continue}if(i<56320){v[C++]=239,v[C++]=191,v[C++]=189,t=i;continue}i=t-55296<<10|i-56320|65536,t=null}else t&&(v[C++]=239,v[C++]=191,v[C++]=189,t=null);i<128?v[C++]=i:(i<2048?v[C++]=i>>6|192:(i<65536?v[C++]=i>>12|224:(v[C++]=i>>18|240,v[C++]=i>>12&63|128),v[C++]=i>>6&63|128),v[C++]=63&i|128)}return C}(this.buf,e,this.pos);var l=this.pos-n;l>=128&&Do(n,l,this),this.pos=n-1,this.writeVarint(l),this.pos+=l},writeFloat:function(e){this.realloc(4),rf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),rf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var n=e.length;this.writeVarint(n),this.realloc(n);for(var l=0;l<n;l++)this.buf[this.pos++]=e[l]},writeRawMessage:function(e,n){this.pos++;var l=this.pos;e(n,this);var v=this.pos-l;v>=128&&Do(l,v,this),this.pos=l-1,this.writeVarint(v),this.pos+=v},writeMessage:function(e,n,l){this.writeTag(e,nn.Bytes),this.writeRawMessage(n,l)},writePackedVarint:function(e,n){n.length&&this.writeMessage(e,ad,n)},writePackedSVarint:function(e,n){n.length&&this.writeMessage(e,of,n)},writePackedBoolean:function(e,n){n.length&&this.writeMessage(e,Nu,n)},writePackedFloat:function(e,n){n.length&&this.writeMessage(e,af,n)},writePackedDouble:function(e,n){n.length&&this.writeMessage(e,un,n)},writePackedFixed32:function(e,n){n.length&&this.writeMessage(e,sd,n)},writePackedSFixed32:function(e,n){n.length&&this.writeMessage(e,sf,n)},writePackedFixed64:function(e,n){n.length&&this.writeMessage(e,lf,n)},writePackedSFixed64:function(e,n){n.length&&this.writeMessage(e,lu,n)},writeBytesField:function(e,n){this.writeTag(e,nn.Bytes),this.writeBytes(n)},writeFixed32Field:function(e,n){this.writeTag(e,nn.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(e,n){this.writeTag(e,nn.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(e,n){this.writeTag(e,nn.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(e,n){this.writeTag(e,nn.Fixed64),this.writeSFixed64(n)},writeVarintField:function(e,n){this.writeTag(e,nn.Varint),this.writeVarint(n)},writeSVarintField:function(e,n){this.writeTag(e,nn.Varint),this.writeSVarint(n)},writeStringField:function(e,n){this.writeTag(e,nn.Bytes),this.writeString(n)},writeFloatField:function(e,n){this.writeTag(e,nn.Fixed32),this.writeFloat(n)},writeDoubleField:function(e,n){this.writeTag(e,nn.Fixed64),this.writeDouble(n)},writeBooleanField:function(e,n){this.writeVarintField(e,Boolean(n))}};var cp=function(e,n){var l=n.pixelRatio,v=n.version,E=n.stretchX,C=n.stretchY,i=n.content;this.paddedRect=e,this.pixelRatio=l,this.stretchX=E,this.stretchY=C,this.content=i,this.version=v},zh={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};zh.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},zh.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},zh.tlbr.get=function(){return this.tl.concat(this.br)},zh.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(cp.prototype,zh);var Ph=function(e,n){var l={},v={};this.haveRenderCallbacks=[];var E=[];this.addImages(e,l,E),this.addImages(n,v,E);var C=cf(E),i=new Yo({width:C.w||1,height:C.h||1});for(var t in e){var a=e[t],p=l[t].paddedRect;Yo.copy(a.data,i,{x:0,y:0},{x:p.x+1,y:p.y+1},a.data)}for(var _ in n){var b=n[_],I=v[_].paddedRect,P=I.x+1,R=I.y+1,O=b.data.width,V=b.data.height;Yo.copy(b.data,i,{x:0,y:0},{x:P,y:R},b.data),Yo.copy(b.data,i,{x:0,y:V-1},{x:P,y:R-1},{width:O,height:1}),Yo.copy(b.data,i,{x:0,y:0},{x:P,y:R+V},{width:O,height:1}),Yo.copy(b.data,i,{x:O-1,y:0},{x:P-1,y:R},{width:1,height:V}),Yo.copy(b.data,i,{x:0,y:0},{x:P+O,y:R},{width:1,height:V})}this.image=i,this.iconPositions=l,this.patternPositions=v};Ph.prototype.addImages=function(e,n,l){for(var v in e){var E=e[v],C={x:0,y:0,w:E.data.width+2,h:E.data.height+2};l.push(C),n[v]=new cp(C,E),E.hasRenderCallback&&this.haveRenderCallbacks.push(v)}},Ph.prototype.patchUpdatedImages=function(e,n){for(var l in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[l],e.getImage(l),n),this.patchUpdatedImage(this.patternPositions[l],e.getImage(l),n)},Ph.prototype.patchUpdatedImage=function(e,n,l){if(e&&n&&e.version!==n.version){e.version=n.version;var v=e.tl;l.update(n.data,void 0,{x:v[0],y:v[1]})}},oi("ImagePosition",cp),oi("ImageAtlas",Ph);var Wa={horizontal:1,vertical:2,horizontalOnly:3},cu=function(){this.scale=1,this.fontStack="",this.imageName=null};cu.forText=function(e,n){var l=new cu;return l.scale=e||1,l.fontStack=n,l},cu.forImage=function(e){var n=new cu;return n.imageName=e,n};var to=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Mh(e,n,l,v,E,C,i,t,a,p,_,b,I,P,R,O){var V,j=to.fromFeature(e,E);b===Wa.vertical&&j.verticalizePunctuation();var K=si.processBidirectionalText,Y=si.processStyledBidirectionalText;if(K&&j.sections.length===1){V=[];for(var Q=0,se=K(j.toString(),eh(j,p,C,n,v,P,R));Q<se.length;Q+=1){var pe=se[Q],Ae=new to;Ae.text=pe,Ae.sections=j.sections;for(var Be=0;Be<pe.length;Be++)Ae.sectionIndex.push(0);V.push(Ae)}}else if(Y){V=[];for(var qe=0,Ge=Y(j.text,j.sectionIndex,eh(j,p,C,n,v,P,R));qe<Ge.length;qe+=1){var it=Ge[qe],He=new to;He.text=it[0],He.sectionIndex=it[1],He.sections=j.sections,V.push(He)}}else V=function(ut,St){for(var mt=[],kt=ut.text,dt=0,_t=0,ti=St;_t<ti.length;_t+=1){var Yt=ti[_t];mt.push(ut.substring(dt,Yt)),dt=Yt}return dt<kt.length&&mt.push(ut.substring(dt,kt.length)),mt}(j,eh(j,p,C,n,v,P,R));var Ct=[],Tt={positionedLines:Ct,text:j.toString(),top:_[1],bottom:_[1],left:_[0],right:_[0],writingMode:b,iconsInText:!1,verticalizable:!1};return function(ut,St,mt,kt,dt,_t,ti,Yt,ki,Mi,$i,sr){for(var kr=0,zr=-17,vr=0,Br=0,xr=Yt==="right"?1:Yt==="left"?0:.5,Or=0,Oi=0,Wi=dt;Oi<Wi.length;Oi+=1){var Yi=Wi[Oi];Yi.trim();var Vi=Yi.getMaxScale(),on=24*(Vi-1),en={positionedGlyphs:[],lineOffset:0};ut.positionedLines[Or]=en;var hr=en.positionedGlyphs,or=0;if(Yi.length()){for(var Lr=0;Lr<Yi.length();Lr++){var hi=Yi.getSection(Lr),ro=Yi.getSectionIndex(Lr),cn=Yi.getCharCode(Lr),Mn=0,Hr=null,Ro=null,go=null,Xa=24,ea=!(ki===Wa.horizontal||!$i&&!ds(cn)||$i&&(hp[cn]||(Ml=cn,qt.Arabic(Ml)||qt["Arabic Supplement"](Ml)||qt["Arabic Extended-A"](Ml)||qt["Arabic Presentation Forms-A"](Ml)||qt["Arabic Presentation Forms-B"](Ml))));if(hi.imageName){var ta=kt[hi.imageName];if(!ta)continue;go=hi.imageName,ut.iconsInText=ut.iconsInText||!0,Ro=ta.paddedRect;var no=ta.displaySize;hi.scale=24*hi.scale/sr,Mn=on+(24-no[1]*hi.scale),Xa=(Hr={width:no[0],height:no[1],left:1,top:-3,advance:ea?no[1]:no[0]}).advance;var Ka=ea?no[0]*hi.scale-24*Vi:no[1]*hi.scale-24*Vi;Ka>0&&Ka>or&&(or=Ka)}else{var Wu=mt[hi.fontStack],Ic=Wu&&Wu[cn];if(Ic&&Ic.rect)Ro=Ic.rect,Hr=Ic.metrics;else{var Sc=St[hi.fontStack],sh=Sc&&Sc[cn];if(!sh)continue;Hr=sh.metrics}Mn=24*(Vi-hi.scale)}ea?(ut.verticalizable=!0,hr.push({glyph:cn,imageName:go,x:kr,y:zr+Mn,vertical:ea,scale:hi.scale,fontStack:hi.fontStack,sectionIndex:ro,metrics:Hr,rect:Ro}),kr+=Xa*hi.scale+Mi):(hr.push({glyph:cn,imageName:go,x:kr,y:zr+Mn,vertical:ea,scale:hi.scale,fontStack:hi.fontStack,sectionIndex:ro,metrics:Hr,rect:Ro}),kr+=Hr.advance*hi.scale+Mi)}hr.length!==0&&(vr=Math.max(kr-Mi,vr),th(hr,0,hr.length-1,xr,or)),kr=0;var Bs=_t*Vi+or;en.lineOffset=Math.max(or,on),zr+=Bs,Br=Math.max(Bs,Br),++Or}else zr+=_t,++Or}var Ml,Tc=zr- -17,Xu=_c(ti),fu=Xu.horizontalAlign,lh=Xu.verticalAlign;(function(Ep,Ip,Vh,qh,Sp,Gh,Zh,Pa,Ac){var Cc,ia=(Ip-Vh)*Sp;Cc=Gh!==Zh?-Pa*qh- -17:(-qh*Ac+.5)*Zh;for(var Ma=0,mu=Ep;Ma<mu.length;Ma+=1)for(var sl=0,uh=mu[Ma].positionedGlyphs;sl<uh.length;sl+=1){var Os=uh[sl];Os.x+=ia,Os.y+=Cc}})(ut.positionedLines,xr,fu,lh,vr,Br,_t,Tc,dt.length),ut.top+=-lh*Tc,ut.bottom=ut.top+Tc,ut.left+=-fu*vr,ut.right=ut.left+vr}(Tt,n,l,v,V,i,t,a,b,p,I,O),!function(ut){for(var St=0,mt=ut;St<mt.length;St+=1)if(mt[St].positionedGlyphs.length!==0)return!1;return!0}(Ct)&&Tt}to.fromFeature=function(e,n){for(var l=new to,v=0;v<e.sections.length;v++){var E=e.sections[v];E.image?l.addImageSection(E):l.addTextSection(E,n)}return l},to.prototype.length=function(){return this.text.length},to.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},to.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},to.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},to.prototype.verticalizePunctuation=function(){this.text=function(e){for(var n="",l=0;l<e.length;l++){var v=e.charCodeAt(l+1)||null,E=e.charCodeAt(l-1)||null;n+=v&&tu(v)&&!Qc[e[l+1]]||E&&tu(E)&&!Qc[e[l-1]]||!Qc[e[l]]?e[l]:Qc[e[l]]}return n}(this.text)},to.prototype.trim=function(){for(var e=0,n=0;n<this.text.length&&hp[this.text.charCodeAt(n)];n++)e++;for(var l=this.text.length,v=this.text.length-1;v>=0&&v>=e&&hp[this.text.charCodeAt(v)];v--)l--;this.text=this.text.substring(e,l),this.sectionIndex=this.sectionIndex.slice(e,l)},to.prototype.substring=function(e,n){var l=new to;return l.text=this.text.substring(e,n),l.sectionIndex=this.sectionIndex.slice(e,n),l.sections=this.sections,l},to.prototype.toString=function(){return this.text},to.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(n,l){return Math.max(n,e.sections[l].scale)},0)},to.prototype.addTextSection=function(e,n){this.text+=e.text,this.sections.push(cu.forText(e.scale,e.fontStack||n));for(var l=this.sections.length-1,v=0;v<e.text.length;++v)this.sectionIndex.push(l)},to.prototype.addImageSection=function(e){var n=e.image?e.image.name:"";if(n.length!==0){var l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(cu.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Xt("Reached maximum number of images 6401")}else Xt("Can't add FormattedSection with an empty image.")},to.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var hp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},za={};function hf(e,n,l,v,E,C){if(n.imageName){var i=v[n.imageName];return i?i.displaySize[0]*n.scale*24/C+E:0}var t=l[n.fontStack],a=t&&t[e];return a?a.metrics.advance*n.scale+E:0}function ld(e,n,l,v){var E=Math.pow(e-n,2);return v?e<n?E/2:2*E:E+Math.abs(l)*l}function ud(e,n,l){var v=0;return e===10&&(v-=1e4),l&&(v+=150),e!==40&&e!==65288||(v+=50),n!==41&&n!==65289||(v+=50),v}function cd(e,n,l,v,E,C){for(var i=null,t=ld(n,l,E,C),a=0,p=v;a<p.length;a+=1){var _=p[a],b=ld(n-_.x,l,E,C)+_.badness;b<=t&&(i=_,t=b)}return{index:e,x:n,priorBreak:i,badness:t}}function eh(e,n,l,v,E,C,i){if(C!=="point")return[];if(!e)return[];for(var t,a=[],p=function(V,j,K,Y,Q,se){for(var pe=0,Ae=0;Ae<V.length();Ae++){var Be=V.getSection(Ae);pe+=hf(V.getCharCode(Ae),Be,Y,Q,j,se)}return pe/Math.max(1,Math.ceil(pe/K))}(e,n,l,v,E,i),_=e.text.indexOf("\u200B")>=0,b=0,I=0;I<e.length();I++){var P=e.getSection(I),R=e.getCharCode(I);if(hp[R]||(b+=hf(R,P,v,E,n,i)),I<e.length()-1){var O=!((t=R)<11904||!(qt["Bopomofo Extended"](t)||qt.Bopomofo(t)||qt["CJK Compatibility Forms"](t)||qt["CJK Compatibility Ideographs"](t)||qt["CJK Compatibility"](t)||qt["CJK Radicals Supplement"](t)||qt["CJK Strokes"](t)||qt["CJK Symbols and Punctuation"](t)||qt["CJK Unified Ideographs Extension A"](t)||qt["CJK Unified Ideographs"](t)||qt["Enclosed CJK Letters and Months"](t)||qt["Halfwidth and Fullwidth Forms"](t)||qt.Hiragana(t)||qt["Ideographic Description Characters"](t)||qt["Kangxi Radicals"](t)||qt["Katakana Phonetic Extensions"](t)||qt.Katakana(t)||qt["Vertical Forms"](t)||qt["Yi Radicals"](t)||qt["Yi Syllables"](t)));(za[R]||O||P.imageName)&&a.push(cd(I+1,b,p,a,ud(R,e.getCharCode(I+1),O&&_),!1))}}return function V(j){return j?V(j.priorBreak).concat(j.index):[]}(cd(e.length(),b,p,a,0,!0))}function _c(e){var n=.5,l=.5;switch(e){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:n,verticalAlign:l}}function th(e,n,l,v,E){if(v||E)for(var C=e[l],i=(e[l].x+C.metrics.advance*C.scale)*v,t=n;t<=l;t++)e[t].x-=i,e[t].y+=E}function Lh(e,n,l,v,E,C){var i,t=e.image;if(t.content){var a=t.content,p=t.pixelRatio||1;i=[a[0]/p,a[1]/p,t.displaySize[0]-a[2]/p,t.displaySize[1]-a[3]/p]}var _,b,I,P,R=n.left*C,O=n.right*C;l==="width"||l==="both"?(P=E[0]+R-v[3],b=E[0]+O+v[1]):b=(P=E[0]+(R+O-t.displaySize[0])/2)+t.displaySize[0];var V=n.top*C,j=n.bottom*C;return l==="height"||l==="both"?(_=E[1]+V-v[0],I=E[1]+j+v[2]):I=(_=E[1]+(V+j-t.displaySize[1])/2)+t.displaySize[1],{image:t,top:_,right:b,bottom:I,left:P,collisionPadding:i}}za[10]=!0,za[32]=!0,za[38]=!0,za[40]=!0,za[41]=!0,za[43]=!0,za[45]=!0,za[47]=!0,za[173]=!0,za[183]=!0,za[8203]=!0,za[8208]=!0,za[8211]=!0,za[8231]=!0;var hu=function(e){function n(l,v,E,C){e.call(this,l,v),this.angle=E,C!==void 0&&(this.segment=C)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.clone=function(){return new n(this.x,this.y,this.angle,this.segment)},n}(F);function hd(e,n){var l=n.expression;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new Nt(e+1))};if(l.kind==="source")return{kind:"source"};for(var v=l.zoomStops,E=l.interpolationType,C=0;C<v.length&&v[C]<=e;)C++;for(var i=C=Math.max(0,C-1);i<v.length&&v[i]<e+1;)i++;i=Math.min(v.length-1,i);var t=v[C],a=v[i];return l.kind==="composite"?{kind:"composite",minZoom:t,maxZoom:a,interpolationType:E}:{kind:"camera",minZoom:t,maxZoom:a,minSize:l.evaluate(new Nt(t)),maxSize:l.evaluate(new Nt(a)),interpolationType:E}}function pd(e,n,l){var v=n.uSize,E=l.lowerSize;return e.kind==="source"?E/128:e.kind==="composite"?Tn(E/128,l.upperSize/128,n.uSizeT):v}function dd(e,n){var l=0,v=0;if(e.kind==="constant")v=e.layoutSize;else if(e.kind!=="source"){var E=e.interpolationType,C=E?je(mo.interpolationFactor(E,n,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?v=Tn(e.minSize,e.maxSize,C):l=C}return{uSizeT:l,uSize:v}}oi("Anchor",hu);var Hm=Object.freeze({__proto__:null,getSizeData:hd,evaluateSizeForFeature:pd,evaluateSizeForZoom:dd,SIZE_PACK_FACTOR:128});function fd(e,n,l,v,E){if(n.segment===void 0)return!0;for(var C=n,i=n.segment+1,t=0;t>-l/2;){if(--i<0)return!1;t-=e[i].dist(C),C=e[i]}t+=e[i].dist(e[i+1]),i++;for(var a=[],p=0;t<l/2;){var _=e[i],b=e[i+1];if(!b)return!1;var I=e[i-1].angleTo(_)-_.angleTo(b);for(I=Math.abs((I+3*Math.PI)%(2*Math.PI)-Math.PI),a.push({distance:t,angleDelta:I}),p+=I;t-a[0].distance>v;)p-=a.shift().angleDelta;if(p>E)return!1;i++,t+=_.dist(b)}return!0}function md(e){for(var n=0,l=0;l<e.length-1;l++)n+=e[l].dist(e[l+1]);return n}function pp(e,n,l){return e?.6*n*l:0}function dp(e,n){return Math.max(e?e.right-e.left:0,n?n.right-n.left:0)}function Wm(e,n,l,v,E,C){for(var i=pp(l,E,C),t=dp(l,v)*C,a=0,p=md(e)/2,_=0;_<e.length-1;_++){var b=e[_],I=e[_+1],P=b.dist(I);if(a+P>p){var R=(p-a)/P,O=Tn(b.x,I.x,R),V=Tn(b.y,I.y,R),j=new hu(O,V,I.angleTo(b),_);return j._round(),!i||fd(e,j,t,i,n)?j:void 0}a+=P}}function Xm(e,n,l,v,E,C,i,t,a){var p=pp(v,C,i),_=dp(v,E),b=_*i,I=e[0].x===0||e[0].x===a||e[0].y===0||e[0].y===a;return n-b<n/4&&(n=b+n/4),function P(R,O,V,j,K,Y,Q,se,pe){for(var Ae=Y/2,Be=md(R),qe=0,Ge=O-V,it=[],He=0;He<R.length-1;He++){for(var Ct=R[He],Tt=R[He+1],ut=Ct.dist(Tt),St=Tt.angleTo(Ct);Ge+V<qe+ut;){var mt=((Ge+=V)-qe)/ut,kt=Tn(Ct.x,Tt.x,mt),dt=Tn(Ct.y,Tt.y,mt);if(kt>=0&&kt<pe&&dt>=0&&dt<pe&&Ge-Ae>=0&&Ge+Ae<=Be){var _t=new hu(kt,dt,St,He);_t._round(),j&&!fd(R,_t,Y,j,K)||it.push(_t)}}qe+=ut}return se||it.length||Q||(it=P(R,qe/2,V,j,K,Y,Q,!0,pe)),it}(e,I?n/2*t%n:(_/2+2*C)*i*t%n,n,p,l,b,I,!1,a)}function yd(e,n,l,v,E){for(var C=[],i=0;i<e.length;i++)for(var t=e[i],a=void 0,p=0;p<t.length-1;p++){var _=t[p],b=t[p+1];_.x<n&&b.x<n||(_.x<n?_=new F(n,_.y+(n-_.x)/(b.x-_.x)*(b.y-_.y))._round():b.x<n&&(b=new F(n,_.y+(n-_.x)/(b.x-_.x)*(b.y-_.y))._round()),_.y<l&&b.y<l||(_.y<l?_=new F(_.x+(l-_.y)/(b.y-_.y)*(b.x-_.x),l)._round():b.y<l&&(b=new F(_.x+(l-_.y)/(b.y-_.y)*(b.x-_.x),l)._round()),_.x>=v&&b.x>=v||(_.x>=v?_=new F(v,_.y+(v-_.x)/(b.x-_.x)*(b.y-_.y))._round():b.x>=v&&(b=new F(v,_.y+(v-_.x)/(b.x-_.x)*(b.y-_.y))._round()),_.y>=E&&b.y>=E||(_.y>=E?_=new F(_.x+(E-_.y)/(b.y-_.y)*(b.x-_.x),E)._round():b.y>=E&&(b=new F(_.x+(E-_.y)/(b.y-_.y)*(b.x-_.x),E)._round()),a&&_.equals(a[a.length-1])||C.push(a=[_]),a.push(b)))))}return C}function zl(e,n,l,v){var E=[],C=e.image,i=C.pixelRatio,t=C.paddedRect.w-2,a=C.paddedRect.h-2,p=e.right-e.left,_=e.bottom-e.top,b=C.stretchX||[[0,t]],I=C.stretchY||[[0,a]],P=function(kt,dt){return kt+dt[1]-dt[0]},R=b.reduce(P,0),O=I.reduce(P,0),V=t-R,j=a-O,K=0,Y=R,Q=0,se=O,pe=0,Ae=V,Be=0,qe=j;if(C.content&&v){var Ge=C.content;K=Dh(b,0,Ge[0]),Q=Dh(I,0,Ge[1]),Y=Dh(b,Ge[0],Ge[2]),se=Dh(I,Ge[1],Ge[3]),pe=Ge[0]-K,Be=Ge[1]-Q,Ae=Ge[2]-Ge[0]-Y,qe=Ge[3]-Ge[1]-se}var it=function(kt,dt,_t,ti){var Yt=Rh(kt.stretch-K,Y,p,e.left),ki=Bh(kt.fixed-pe,Ae,kt.stretch,R),Mi=Rh(dt.stretch-Q,se,_,e.top),$i=Bh(dt.fixed-Be,qe,dt.stretch,O),sr=Rh(_t.stretch-K,Y,p,e.left),kr=Bh(_t.fixed-pe,Ae,_t.stretch,R),zr=Rh(ti.stretch-Q,se,_,e.top),vr=Bh(ti.fixed-Be,qe,ti.stretch,O),Br=new F(Yt,Mi),xr=new F(sr,Mi),Or=new F(sr,zr),Oi=new F(Yt,zr),Wi=new F(ki/i,$i/i),Yi=new F(kr/i,vr/i),Vi=n*Math.PI/180;if(Vi){var on=Math.sin(Vi),en=Math.cos(Vi),hr=[en,-on,on,en];Br._matMult(hr),xr._matMult(hr),Oi._matMult(hr),Or._matMult(hr)}var or=kt.stretch+kt.fixed,Lr=dt.stretch+dt.fixed;return{tl:Br,tr:xr,bl:Oi,br:Or,tex:{x:C.paddedRect.x+1+or,y:C.paddedRect.y+1+Lr,w:_t.stretch+_t.fixed-or,h:ti.stretch+ti.fixed-Lr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Wi,pixelOffsetBR:Yi,minFontScaleX:Ae/i/p,minFontScaleY:qe/i/_,isSDF:l}};if(v&&(C.stretchX||C.stretchY))for(var He=pu(b,V,R),Ct=pu(I,j,O),Tt=0;Tt<He.length-1;Tt++)for(var ut=He[Tt],St=He[Tt+1],mt=0;mt<Ct.length-1;mt++)E.push(it(ut,Ct[mt],St,Ct[mt+1]));else E.push(it({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:t+1},{fixed:0,stretch:a+1}));return E}function Dh(e,n,l){for(var v=0,E=0,C=e;E<C.length;E+=1){var i=C[E];v+=Math.max(n,Math.min(l,i[1]))-Math.max(n,Math.min(l,i[0]))}return v}function pu(e,n,l){for(var v=[{fixed:-1,stretch:0}],E=0,C=e;E<C.length;E+=1){var i=C[E],t=i[0],a=i[1],p=v[v.length-1];v.push({fixed:t-p.stretch,stretch:p.stretch}),v.push({fixed:t-p.stretch,stretch:p.stretch+(a-t)})}return v.push({fixed:n+1,stretch:l}),v}function Rh(e,n,l,v){return e/n*l+v}function Bh(e,n,l,v){return e-n*l/v}var Oh=function(e,n,l,v,E,C,i,t,a,p){if(this.boxStartIndex=e.length,a){var _=C.top,b=C.bottom,I=C.collisionPadding;I&&(_-=I[1],b+=I[3]);var P=b-_;P>0&&(P=Math.max(10,P),this.circleDiameter=P)}else{var R=C.top*i-t,O=C.bottom*i+t,V=C.left*i-t,j=C.right*i+t,K=C.collisionPadding;if(K&&(V-=K[0]*i,R-=K[1]*i,j+=K[2]*i,O+=K[3]*i),p){var Y=new F(V,R),Q=new F(j,R),se=new F(V,O),pe=new F(j,O),Ae=p*Math.PI/180;Y._rotate(Ae),Q._rotate(Ae),se._rotate(Ae),pe._rotate(Ae),V=Math.min(Y.x,Q.x,se.x,pe.x),j=Math.max(Y.x,Q.x,se.x,pe.x),R=Math.min(Y.y,Q.y,se.y,pe.y),O=Math.max(Y.y,Q.y,se.y,pe.y)}e.emplaceBack(n.x,n.y,V,R,j,O,l,v,E)}this.boxEndIndex=e.length},vc=function(e,n){if(e===void 0&&(e=[]),n===void 0&&(n=Km),this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(var l=(this.length>>1)-1;l>=0;l--)this._down(l)};function Km(e,n){return e<n?-1:e>n?1:0}function Jm(e,n,l){n===void 0&&(n=1),l===void 0&&(l=!1);for(var v=1/0,E=1/0,C=-1/0,i=-1/0,t=e[0],a=0;a<t.length;a++){var p=t[a];(!a||p.x<v)&&(v=p.x),(!a||p.y<E)&&(E=p.y),(!a||p.x>C)&&(C=p.x),(!a||p.y>i)&&(i=p.y)}var _=Math.min(C-v,i-E),b=_/2,I=new vc([],pf);if(_===0)return new F(v,E);for(var P=v;P<C;P+=_)for(var R=E;R<i;R+=_)I.push(new xc(P+b,R+b,b,e));for(var O=function(K){for(var Y=0,Q=0,se=0,pe=K[0],Ae=0,Be=pe.length,qe=Be-1;Ae<Be;qe=Ae++){var Ge=pe[Ae],it=pe[qe],He=Ge.x*it.y-it.x*Ge.y;Q+=(Ge.x+it.x)*He,se+=(Ge.y+it.y)*He,Y+=3*He}return new xc(Q/Y,se/Y,0,K)}(e),V=I.length;I.length;){var j=I.pop();(j.d>O.d||!O.d)&&(O=j,l&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,V)),j.max-O.d<=n||(I.push(new xc(j.p.x-(b=j.h/2),j.p.y-b,b,e)),I.push(new xc(j.p.x+b,j.p.y-b,b,e)),I.push(new xc(j.p.x-b,j.p.y+b,b,e)),I.push(new xc(j.p.x+b,j.p.y+b,b,e)),V+=4)}return l&&(console.log("num probes: "+V),console.log("best distance: "+O.d)),O.p}function pf(e,n){return n.max-e.max}function xc(e,n,l,v){this.p=new F(e,n),this.h=l,this.d=function(E,C){for(var i=!1,t=1/0,a=0;a<C.length;a++)for(var p=C[a],_=0,b=p.length,I=b-1;_<b;I=_++){var P=p[_],R=p[I];P.y>E.y!=R.y>E.y&&E.x<(R.x-P.x)*(E.y-P.y)/(R.y-P.y)+P.x&&(i=!i),t=Math.min(t,Ru(E,P,R))}return(i?1:-1)*Math.sqrt(t)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}vc.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},vc.prototype.pop=function(){if(this.length!==0){var e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}},vc.prototype.peek=function(){return this.data[0]},vc.prototype._up=function(e){for(var n=this.data,l=this.compare,v=n[e];e>0;){var E=e-1>>1,C=n[E];if(l(v,C)>=0)break;n[e]=C,e=E}n[e]=v},vc.prototype._down=function(e){for(var n=this.data,l=this.compare,v=this.length>>1,E=n[e];e<v;){var C=1+(e<<1),i=n[C],t=C+1;if(t<this.length&&l(n[t],i)<0&&(C=t,i=n[t]),l(i,E)>=0)break;n[e]=i,e=C}n[e]=E};var fp=Number.POSITIVE_INFINITY;function Fh(e,n){return n[1]!==fp?function(l,v,E){var C=0,i=0;switch(v=Math.abs(v),E=Math.abs(E),l){case"top-right":case"top-left":case"top":i=E-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-E}switch(l){case"top-right":case"bottom-right":case"right":C=-v;break;case"top-left":case"bottom-left":case"left":C=v}return[C,i]}(e,n[0],n[1]):function(l,v){var E=0,C=0;v<0&&(v=0);var i=v/Math.sqrt(2);switch(l){case"top-right":case"top-left":C=i-7;break;case"bottom-right":case"bottom-left":C=7-i;break;case"bottom":C=7-v;break;case"top":C=v-7}switch(l){case"top-right":case"bottom-right":E=-i;break;case"top-left":case"bottom-left":E=i;break;case"left":E=v;break;case"right":E=-v}return[E,C]}(e,n[0])}function mp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Uh(e,n,l,v,E,C,i,t,a,p,_,b,I,P,R){var O=function(Q,se,pe,Ae,Be,qe,Ge,it){for(var He=Ae.layout.get("text-rotate").evaluate(qe,{})*Math.PI/180,Ct=[],Tt=0,ut=se.positionedLines;Tt<ut.length;Tt+=1)for(var St=ut[Tt],mt=0,kt=St.positionedGlyphs;mt<kt.length;mt+=1){var dt=kt[mt];if(dt.rect){var _t=dt.rect||{},ti=4,Yt=!0,ki=1,Mi=0,$i=(Be||it)&&dt.vertical,sr=dt.metrics.advance*dt.scale/2;if(it&&se.verticalizable&&(Mi=St.lineOffset/2-(dt.imageName?-(24-dt.metrics.width*dt.scale)/2:24*(dt.scale-1))),dt.imageName){var kr=Ge[dt.imageName];Yt=kr.sdf,ti=1/(ki=kr.pixelRatio)}var zr=Be?[dt.x+sr,dt.y]:[0,0],vr=Be?[0,0]:[dt.x+sr+pe[0],dt.y+pe[1]-Mi],Br=[0,0];$i&&(Br=vr,vr=[0,0]);var xr=(dt.metrics.left-ti)*dt.scale-sr+vr[0],Or=(-dt.metrics.top-ti)*dt.scale+vr[1],Oi=xr+_t.w*dt.scale/ki,Wi=Or+_t.h*dt.scale/ki,Yi=new F(xr,Or),Vi=new F(Oi,Or),on=new F(xr,Wi),en=new F(Oi,Wi);if($i){var hr=new F(-sr,sr- -17),or=-Math.PI/2,Lr=12-sr,hi=new F(22-Lr,-(dt.imageName?Lr:0)),ro=new(Function.prototype.bind.apply(F,[null].concat(Br)));Yi._rotateAround(or,hr)._add(hi)._add(ro),Vi._rotateAround(or,hr)._add(hi)._add(ro),on._rotateAround(or,hr)._add(hi)._add(ro),en._rotateAround(or,hr)._add(hi)._add(ro)}if(He){var cn=Math.sin(He),Mn=Math.cos(He),Hr=[Mn,-cn,cn,Mn];Yi._matMult(Hr),Vi._matMult(Hr),on._matMult(Hr),en._matMult(Hr)}var Ro=new F(0,0),go=new F(0,0);Ct.push({tl:Yi,tr:Vi,bl:on,br:en,tex:_t,writingMode:se.writingMode,glyphOffset:zr,sectionIndex:dt.sectionIndex,isSDF:Yt,pixelOffsetTL:Ro,pixelOffsetBR:go,minFontScaleX:0,minFontScaleY:0})}}return Ct}(0,l,t,E,C,i,v,e.allowVerticalPlacement),V=e.textSizeData,j=null;V.kind==="source"?(j=[128*E.layout.get("text-size").evaluate(i,{})])[0]>32640&&Xt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):V.kind==="composite"&&((j=[128*P.compositeTextSizes[0].evaluate(i,{},R),128*P.compositeTextSizes[1].evaluate(i,{},R)])[0]>32640||j[1]>32640)&&Xt(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,O,j,t,C,i,p,n,a.lineStartIndex,a.lineLength,I,R);for(var K=0,Y=_;K<Y.length;K+=1)b[Y[K]]=e.text.placedSymbolArray.length-1;return 4*O.length}function Nh(e){for(var n in e)return e[n];return null}function yp(e,n,l,v){var E=e.compareText;if(n in E){for(var C=E[n],i=C.length-1;i>=0;i--)if(v.dist(C[i])<l)return!0}else E[n]=[];return E[n].push(v),!1}var $m=Kc.VectorTileFeature.types,Ym=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function gp(e,n,l,v,E,C,i,t,a,p,_,b,I){var P=t?Math.min(32640,Math.round(t[0])):0,R=t?Math.min(32640,Math.round(t[1])):0;e.emplaceBack(n,l,Math.round(32*v),Math.round(32*E),C,i,(P<<1)+(a?1:0),R,16*p,16*_,256*b,256*I)}function gd(e,n,l){e.emplaceBack(n.x,n.y,l),e.emplaceBack(n.x,n.y,l),e.emplaceBack(n.x,n.y,l),e.emplaceBack(n.x,n.y,l)}function ih(e){for(var n=0,l=e.sections;n<l.length;n+=1)if(rn(l[n].text))return!0;return!1}var ju=function(e){this.layoutVertexArray=new Re,this.indexArray=new xt,this.programConfigurations=e,this.segments=new de,this.dynamicLayoutVertexArray=new be,this.opacityVertexArray=new De,this.placedSymbolArray=new x};ju.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},ju.prototype.upload=function(e,n,l,v){this.isEmpty()||(l&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Vm.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,$d.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Ym,!0),this.opacityVertexBuffer.itemSize=1),(l||v)&&this.programConfigurations.upload(e))},ju.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},oi("SymbolBuffers",ju);var rh=function(e,n,l){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new l,this.segments=new de,this.collisionVertexArray=new Ye};rh.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,od.members,!0)},rh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},oi("CollisionBuffers",rh);var Zr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(C){return C.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=$o([]),this.placementViewportMatrix=$o([]);var n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=hd(this.zoom,n["text-size"]),this.iconSizeData=hd(this.zoom,n["icon-size"]);var l=this.layers[0].layout,v=l.get("symbol-sort-key"),E=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=E!=="viewport-y"&&v.constantOr(1)!==void 0,this.sortFeaturesByY=(E==="viewport-y"||E==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(function(C){return Wa[C]})),this.stateDependentLayerIds=this.layers.filter(function(C){return C.isStateDependent()}).map(function(C){return C.id}),this.sourceID=e.sourceID};Zr.prototype.createArrays=function(){this.text=new ju(new vi(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new ju(new vi(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new B,this.lineVertexArray=new q,this.symbolInstances=new L},Zr.prototype.calculateGlyphDependencies=function(e,n,l,v,E){for(var C=0;C<e.length;C++)if(n[e.charCodeAt(C)]=!0,(l||v)&&E){var i=Qc[e.charAt(C)];i&&(n[i.charCodeAt(0)]=!0)}},Zr.prototype.populate=function(e,n,l){var v=this.layers[0],E=v.layout,C=E.get("text-font"),i=E.get("text-field"),t=E.get("icon-image"),a=(i.value.kind!=="constant"||i.value.value instanceof Cr&&!i.value.value.isEmpty()||i.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),p=t.value.kind!=="constant"||!!t.value.value||Object.keys(t.parameters).length>0,_=E.get("symbol-sort-key");if(this.features=[],a||p){for(var b=n.iconDependencies,I=n.glyphDependencies,P=n.availableImages,R=new Nt(this.zoom),O=0,V=e;O<V.length;O+=1){var j=V[O],K=j.feature,Y=j.id,Q=j.index,se=j.sourceLayerIndex,pe=v._featureFilter.needGeometry,Ae=ur(K,pe);if(v._featureFilter.filter(R,Ae,l)){pe||(Ae.geometry=xn(K));var Be=void 0;if(a){var qe=v.getValueAndResolveTokens("text-field",Ae,l,P),Ge=Cr.factory(qe);ih(Ge)&&(this.hasRTLText=!0),(!this.hasRTLText||va()==="unavailable"||this.hasRTLText&&si.isParsed())&&(Be=ef(Ge,v,Ae))}var it=void 0;if(p){var He=v.getValueAndResolveTokens("icon-image",Ae,l,P);it=He instanceof Eo?He:Eo.fromString(He)}if(Be||it){var Ct=this.sortFeaturesByKey?_.evaluate(Ae,{},l):void 0;if(this.features.push({id:Y,text:Be,icon:it,index:Q,sourceLayerIndex:se,geometry:Ae.geometry,properties:K.properties,type:$m[K.type],sortKey:Ct}),it&&(b[it.name]=!0),Be){var Tt=C.evaluate(Ae,{},l).join(","),ut=E.get("text-rotation-alignment")==="map"&&E.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Wa.vertical)>=0;for(var St=0,mt=Be.sections;St<mt.length;St+=1){var kt=mt[St];if(kt.image)b[kt.image.name]=!0;else{var dt=eu(Be.toString()),_t=kt.fontStack||Tt,ti=I[_t]=I[_t]||{};this.calculateGlyphDependencies(kt.text,ti,ut,this.allowVerticalPlacement,dt)}}}}}}E.get("symbol-placement")==="line"&&(this.features=function(Yt){var ki={},Mi={},$i=[],sr=0;function kr(hr){$i.push(Yt[hr]),sr++}function zr(hr,or,Lr){var hi=Mi[hr];return delete Mi[hr],Mi[or]=hi,$i[hi].geometry[0].pop(),$i[hi].geometry[0]=$i[hi].geometry[0].concat(Lr[0]),hi}function vr(hr,or,Lr){var hi=ki[or];return delete ki[or],ki[hr]=hi,$i[hi].geometry[0].shift(),$i[hi].geometry[0]=Lr[0].concat($i[hi].geometry[0]),hi}function Br(hr,or,Lr){var hi=Lr?or[0][or[0].length-1]:or[0][0];return hr+":"+hi.x+":"+hi.y}for(var xr=0;xr<Yt.length;xr++){var Or=Yt[xr],Oi=Or.geometry,Wi=Or.text?Or.text.toString():null;if(Wi){var Yi=Br(Wi,Oi),Vi=Br(Wi,Oi,!0);if(Yi in Mi&&Vi in ki&&Mi[Yi]!==ki[Vi]){var on=vr(Yi,Vi,Oi),en=zr(Yi,Vi,$i[on].geometry);delete ki[Yi],delete Mi[Vi],Mi[Br(Wi,$i[en].geometry,!0)]=en,$i[on].geometry=null}else Yi in Mi?zr(Yi,Vi,Oi):Vi in ki?vr(Yi,Vi,Oi):(kr(xr),ki[Yi]=sr-1,Mi[Vi]=sr-1)}else kr(xr)}return $i.filter(function(hr){return hr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Yt,ki){return Yt.sortKey-ki.sortKey})}},Zr.prototype.update=function(e,n,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,l),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,l))},Zr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Zr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Zr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Zr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Zr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Zr.prototype.addToLineVertexArray=function(e,n){var l=this.lineVertexArray.length;if(e.segment!==void 0){for(var v=e.dist(n[e.segment+1]),E=e.dist(n[e.segment]),C={},i=e.segment+1;i<n.length;i++)C[i]={x:n[i].x,y:n[i].y,tileUnitDistanceFromAnchor:v},i<n.length-1&&(v+=n[i+1].dist(n[i]));for(var t=e.segment||0;t>=0;t--)C[t]={x:n[t].x,y:n[t].y,tileUnitDistanceFromAnchor:E},t>0&&(E+=n[t-1].dist(n[t]));for(var a=0;a<n.length;a++){var p=C[a];this.lineVertexArray.emplaceBack(p.x,p.y,p.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}},Zr.prototype.addSymbols=function(e,n,l,v,E,C,i,t,a,p,_,b){for(var I=e.indexArray,P=e.layoutVertexArray,R=e.segments.prepareSegment(4*n.length,P,I,this.canOverlap?C.sortKey:void 0),O=this.glyphOffsetArray.length,V=R.vertexLength,j=this.allowVerticalPlacement&&i===Wa.vertical?Math.PI/2:0,K=C.text&&C.text.sections,Y=0;Y<n.length;Y++){var Q=n[Y],se=Q.tl,pe=Q.tr,Ae=Q.bl,Be=Q.br,qe=Q.tex,Ge=Q.pixelOffsetTL,it=Q.pixelOffsetBR,He=Q.minFontScaleX,Ct=Q.minFontScaleY,Tt=Q.glyphOffset,ut=Q.isSDF,St=Q.sectionIndex,mt=R.vertexLength,kt=Tt[1];gp(P,t.x,t.y,se.x,kt+se.y,qe.x,qe.y,l,ut,Ge.x,Ge.y,He,Ct),gp(P,t.x,t.y,pe.x,kt+pe.y,qe.x+qe.w,qe.y,l,ut,it.x,Ge.y,He,Ct),gp(P,t.x,t.y,Ae.x,kt+Ae.y,qe.x,qe.y+qe.h,l,ut,Ge.x,it.y,He,Ct),gp(P,t.x,t.y,Be.x,kt+Be.y,qe.x+qe.w,qe.y+qe.h,l,ut,it.x,it.y,He,Ct),gd(e.dynamicLayoutVertexArray,t,j),I.emplaceBack(mt,mt+1,mt+2),I.emplaceBack(mt+1,mt+2,mt+3),R.vertexLength+=4,R.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Tt[0]),Y!==n.length-1&&St===n[Y+1].sectionIndex||e.programConfigurations.populatePaintArrays(P.length,C,C.index,{},b,K&&K[St])}e.placedSymbolArray.emplaceBack(t.x,t.y,O,this.glyphOffsetArray.length-O,V,a,p,t.segment,l?l[0]:0,l?l[1]:0,v[0],v[1],i,0,!1,0,_)},Zr.prototype._addCollisionDebugVertex=function(e,n,l,v,E,C){return n.emplaceBack(0,0),e.emplaceBack(l.x,l.y,v,E,Math.round(C.x),Math.round(C.y))},Zr.prototype.addCollisionDebugVertices=function(e,n,l,v,E,C,i){var t=E.segments.prepareSegment(4,E.layoutVertexArray,E.indexArray),a=t.vertexLength,p=E.layoutVertexArray,_=E.collisionVertexArray,b=i.anchorX,I=i.anchorY;this._addCollisionDebugVertex(p,_,C,b,I,new F(e,n)),this._addCollisionDebugVertex(p,_,C,b,I,new F(l,n)),this._addCollisionDebugVertex(p,_,C,b,I,new F(l,v)),this._addCollisionDebugVertex(p,_,C,b,I,new F(e,v)),t.vertexLength+=4;var P=E.indexArray;P.emplaceBack(a,a+1),P.emplaceBack(a+1,a+2),P.emplaceBack(a+2,a+3),P.emplaceBack(a+3,a),t.primitiveLength+=4},Zr.prototype.addDebugCollisionBoxes=function(e,n,l,v){for(var E=e;E<n;E++){var C=this.collisionBoxArray.get(E);this.addCollisionDebugVertices(C.x1,C.y1,C.x2,C.y2,v?this.textCollisionBox:this.iconCollisionBox,C.anchorPoint,l)}},Zr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new rh(Xe,Yd.members,pi),this.iconCollisionBox=new rh(Xe,Yd.members,pi);for(var e=0;e<this.symbolInstances.length;e++){var n=this.symbolInstances.get(e);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}},Zr.prototype._deserializeCollisionBoxesForSymbol=function(e,n,l,v,E,C,i,t,a){for(var p={},_=n;_<l;_++){var b=e.get(_);p.textBox={x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2,anchorPointX:b.anchorPointX,anchorPointY:b.anchorPointY},p.textFeatureIndex=b.featureIndex;break}for(var I=v;I<E;I++){var P=e.get(I);p.verticalTextBox={x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,anchorPointX:P.anchorPointX,anchorPointY:P.anchorPointY},p.verticalTextFeatureIndex=P.featureIndex;break}for(var R=C;R<i;R++){var O=e.get(R);p.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},p.iconFeatureIndex=O.featureIndex;break}for(var V=t;V<a;V++){var j=e.get(V);p.verticalIconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},p.verticalIconFeatureIndex=j.featureIndex;break}return p},Zr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var n=0;n<this.symbolInstances.length;n++){var l=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}},Zr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Zr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Zr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Zr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Zr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Zr.prototype.addIndicesForPlacedSymbol=function(e,n){for(var l=e.placedSymbolArray.get(n),v=l.vertexStartIndex+4*l.numGlyphs,E=l.vertexStartIndex;E<v;E+=4)e.indexArray.emplaceBack(E,E+1,E+2),e.indexArray.emplaceBack(E+1,E+2,E+3)},Zr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var n=Math.sin(e),l=Math.cos(e),v=[],E=[],C=[],i=0;i<this.symbolInstances.length;++i){C.push(i);var t=this.symbolInstances.get(i);v.push(0|Math.round(n*t.anchorX+l*t.anchorY)),E.push(t.featureIndex)}return C.sort(function(a,p){return v[a]-v[p]||E[p]-E[a]}),C},Zr.prototype.addToSortKeyRanges=function(e,n){var l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===n?l.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Zr.prototype.sortFeatures=function(e){var n=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var l=0,v=this.symbolInstanceIndexes;l<v.length;l+=1){var E=this.symbolInstances.get(v[l]);this.featureSortOrder.push(E.featureIndex),[E.rightJustifiedTextSymbolIndex,E.centerJustifiedTextSymbolIndex,E.leftJustifiedTextSymbolIndex].forEach(function(C,i,t){C>=0&&t.indexOf(C)===i&&n.addIndicesForPlacedSymbol(n.text,C)}),E.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,E.verticalPlacedTextSymbolIndex),E.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,E.placedIconSymbolIndex),E.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,E.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},oi("SymbolBucket",Zr,{omit:["layers","collisionBoxArray","features","compareText"]}),Zr.MAX_GLYPHS=65535,Zr.addDynamicAttributes=gd;var Qm=new T({"symbol-placement":new Zt(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new Zt(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Zt(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Gt(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Zt(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Zt(ye.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Zt(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new Zt(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Zt(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new Gt(ye.layout_symbol["icon-size"]),"icon-text-fit":new Zt(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Zt(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new Gt(ye.layout_symbol["icon-image"]),"icon-rotate":new Gt(ye.layout_symbol["icon-rotate"]),"icon-padding":new Zt(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new Zt(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new Gt(ye.layout_symbol["icon-offset"]),"icon-anchor":new Gt(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Zt(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Zt(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Zt(ye.layout_symbol["text-rotation-alignment"]),"text-field":new Gt(ye.layout_symbol["text-field"]),"text-font":new Gt(ye.layout_symbol["text-font"]),"text-size":new Gt(ye.layout_symbol["text-size"]),"text-max-width":new Gt(ye.layout_symbol["text-max-width"]),"text-line-height":new Zt(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new Gt(ye.layout_symbol["text-letter-spacing"]),"text-justify":new Gt(ye.layout_symbol["text-justify"]),"text-radial-offset":new Gt(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Zt(ye.layout_symbol["text-variable-anchor"]),"text-anchor":new Gt(ye.layout_symbol["text-anchor"]),"text-max-angle":new Zt(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new Zt(ye.layout_symbol["text-writing-mode"]),"text-rotate":new Gt(ye.layout_symbol["text-rotate"]),"text-padding":new Zt(ye.layout_symbol["text-padding"]),"text-keep-upright":new Zt(ye.layout_symbol["text-keep-upright"]),"text-transform":new Gt(ye.layout_symbol["text-transform"]),"text-offset":new Gt(ye.layout_symbol["text-offset"]),"text-allow-overlap":new Zt(ye.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Zt(ye.layout_symbol["text-ignore-placement"]),"text-optional":new Zt(ye.layout_symbol["text-optional"])}),Pl={paint:new T({"icon-opacity":new Gt(ye.paint_symbol["icon-opacity"]),"icon-color":new Gt(ye.paint_symbol["icon-color"]),"icon-halo-color":new Gt(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new Gt(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Gt(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new Zt(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new Zt(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new Gt(ye.paint_symbol["text-opacity"]),"text-color":new Gt(ye.paint_symbol["text-color"],{runtimeType:Ie,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new Gt(ye.paint_symbol["text-halo-color"]),"text-halo-width":new Gt(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new Gt(ye.paint_symbol["text-halo-blur"]),"text-translate":new Zt(ye.paint_symbol["text-translate"]),"text-translate-anchor":new Zt(ye.paint_symbol["text-translate-anchor"])}),layout:Qm},bc=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:_e,this.defaultValue=e};bc.prototype.evaluate=function(e){if(e.formattedSection){var n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},bc.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},bc.prototype.outputDefined=function(){return!1},bc.prototype.serialize=function(){return null},oi("FormatSectionOverride",bc,{omit:["defaultValue"]});var df=function(e){function n(l){e.call(this,l,Pl)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.recalculate=function(l,v){if(e.prototype.recalculate.call(this,l,v),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var E=this.layout.get("text-writing-mode");if(E){for(var C=[],i=0,t=E;i<t.length;i+=1){var a=t[i];C.indexOf(a)<0&&C.push(a)}this.layout._values["text-writing-mode"]=C}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},n.prototype.getValueAndResolveTokens=function(l,v,E,C){var i=this.layout.get(l).evaluate(v,{},E,C),t=this._unevaluatedLayout._values[l];return t.isDataDriven()||Ks(t.value)||!i?i:function(a,p){return p.replace(/{([^{}]+)}/g,function(_,b){return b in a?String(a[b]):""})}(v.properties,i)},n.prototype.createBucket=function(l){return new Zr(l)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype._setPaintOverrides=function(){for(var l=0,v=Pl.paint.overridableProperties;l<v.length;l+=1){var E=v[l];if(n.hasPaintOverride(this.layout,E)){var C,i=this.paint.get(E),t=new bc(i),a=new ss(t,i.property.specification);C=i.value.kind==="constant"||i.value.kind==="source"?new zs("source",a):new ls("composite",a,i.value.zoomStops,i.value._interpolationType),this.paint._values[E]=new Lo(i.property,C,i.parameters)}}},n.prototype._handleOverridablePaintPropertyUpdate=function(l,v,E){return!(!this.layout||v.isDataDriven()||E.isDataDriven())&&n.hasPaintOverride(this.layout,l)},n.hasPaintOverride=function(l,v){var E=l.get("text-field"),C=Pl.paint.properties[v],i=!1,t=function(_){for(var b=0,I=_;b<I.length;b+=1)if(C.overrides&&C.overrides.hasOverride(I[b]))return void(i=!0)};if(E.value.kind==="constant"&&E.value.value instanceof Cr)t(E.value.value.sections);else if(E.value.kind==="source"){var a=function(_){i||(_ instanceof Co&&In(_.value)===Ut?t(_.value.sections):_ instanceof aa?t(_.sections):_.eachChild(a))},p=E.value;p._styleExpression&&a(p._styleExpression.expression)}return i},n}(o),ey={paint:new T({"background-color":new Zt(ye.paint_background["background-color"]),"background-pattern":new Bn(ye.paint_background["background-pattern"]),"background-opacity":new Zt(ye.paint_background["background-opacity"])})},ty=function(e){function n(l){e.call(this,l,ey)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(o),iy={paint:new T({"raster-opacity":new Zt(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new Zt(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Zt(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Zt(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new Zt(ye.paint_raster["raster-saturation"]),"raster-contrast":new Zt(ye.paint_raster["raster-contrast"]),"raster-resampling":new Zt(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new Zt(ye.paint_raster["raster-fade-duration"])})},_p=function(e){function n(l){e.call(this,l,iy)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(o),_d=function(e){function n(l){e.call(this,l,{}),this.implementation=l}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},n.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},n.prototype.recalculate=function(){},n.prototype.updateTransitions=function(){},n.prototype.hasTransition=function(){},n.prototype.serialize=function(){},n.prototype.onAdd=function(l){this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},n.prototype.onRemove=function(l){this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},n}(o),ry={circle:rp,heatmap:wh,hillshade:Zd,fill:id,"fill-extrusion":Bm,line:jm,symbol:df,background:ty,raster:_p},vp=H.HTMLImageElement,xp=H.HTMLCanvasElement,wc=H.HTMLVideoElement,ff=H.ImageData,nh=H.ImageBitmap,Vu=function(e,n,l,v){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(n,v)};Vu.prototype.update=function(e,n,l){var v=e.width,E=e.height,C=!(this.size&&this.size[0]===v&&this.size[1]===E||l),i=this.context,t=i.gl;if(this.useMipmap=Boolean(n&&n.useMipmap),t.bindTexture(t.TEXTURE_2D,this.texture),i.pixelStoreUnpackFlipY.set(!1),i.pixelStoreUnpack.set(1),i.pixelStoreUnpackPremultiplyAlpha.set(this.format===t.RGBA&&(!n||n.premultiply!==!1)),C)this.size=[v,E],e instanceof vp||e instanceof xp||e instanceof wc||e instanceof ff||nh&&e instanceof nh?t.texImage2D(t.TEXTURE_2D,0,this.format,this.format,t.UNSIGNED_BYTE,e):t.texImage2D(t.TEXTURE_2D,0,this.format,v,E,0,this.format,t.UNSIGNED_BYTE,e.data);else{var a=l||{x:0,y:0},p=a.x,_=a.y;e instanceof vp||e instanceof xp||e instanceof wc||e instanceof ff||nh&&e instanceof nh?t.texSubImage2D(t.TEXTURE_2D,0,p,_,t.RGBA,t.UNSIGNED_BYTE,e):t.texSubImage2D(t.TEXTURE_2D,0,p,_,v,E,t.RGBA,t.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&t.generateMipmap(t.TEXTURE_2D)},Vu.prototype.bind=function(e,n,l){var v=this.context.gl;v.bindTexture(v.TEXTURE_2D,this.texture),l!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=v.LINEAR),e!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,e),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,l||e),this.filter=e),n!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,n),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,n),this.wrap=n)},Vu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Vu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var oh=function(e){var n=this;this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){n._triggered=!1,n._callback()})};oh.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},oh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var qu=function(e,n,l){this.target=e,this.parent=n,this.mapId=l,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},lt(["receive","process"],this),this.invoker=new oh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=bt()?e:H};function mf(e,n,l){var v=2*Math.PI*6378137/256/Math.pow(2,l);return[e*v-2*Math.PI*6378137/2,n*v-2*Math.PI*6378137/2]}qu.prototype.send=function(e,n,l,v,E){var C=this;E===void 0&&(E=!1);var i=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(this.callbacks[i]=l);var t=Ar(this.globalScope)?void 0:[];return this.target.postMessage({id:i,type:e,hasCallback:!!l,targetMapId:v,mustQueue:E,sourceMapId:this.mapId,data:ca(n,t)},t),{cancel:function(){l&&delete C.callbacks[i],C.target.postMessage({id:i,type:"<cancel>",targetMapId:v,sourceMapId:C.mapId})}}},qu.prototype.receive=function(e){var n=e.data,l=n.id;if(l&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){delete this.tasks[l];var v=this.cancelCallbacks[l];delete this.cancelCallbacks[l],v&&v()}else bt()||n.mustQueue?(this.tasks[l]=n,this.taskQueue.push(l),this.invoker.trigger()):this.processTask(l,n)},qu.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),n=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),n&&this.processTask(e,n)}},qu.prototype.processTask=function(e,n){var l=this;if(n.type==="<response>"){var v=this.callbacks[e];delete this.callbacks[e],v&&(n.error?v(ln(n.error)):v(null,ln(n.data)))}else{var E=!1,C=Ar(this.globalScope)?void 0:[],i=n.hasCallback?function(_,b){E=!0,delete l.cancelCallbacks[e],l.target.postMessage({id:e,type:"<response>",sourceMapId:l.mapId,error:_?ca(_):null,data:ca(b,C)},C)}:function(_){E=!0},t=null,a=ln(n.data);if(this.parent[n.type])t=this.parent[n.type](n.sourceMapId,a,i);else if(this.parent.getWorkerSource){var p=n.type.split(".");t=this.parent.getWorkerSource(n.sourceMapId,p[0],a.source)[p[1]](a,i)}else i(new Error("Could not find function "+n.type));!E&&t&&t.cancel&&(this.cancelCallbacks[e]=t.cancel)}},qu.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var io=function(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};io.prototype.setNorthEast=function(e){return this._ne=e instanceof yn?new yn(e.lng,e.lat):yn.convert(e),this},io.prototype.setSouthWest=function(e){return this._sw=e instanceof yn?new yn(e.lng,e.lat):yn.convert(e),this},io.prototype.extend=function(e){var n,l,v=this._sw,E=this._ne;if(e instanceof yn)n=e,l=e;else{if(!(e instanceof io))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(io.convert(e)):this.extend(yn.convert(e)):this;if(l=e._ne,!(n=e._sw)||!l)return this}return v||E?(v.lng=Math.min(n.lng,v.lng),v.lat=Math.min(n.lat,v.lat),E.lng=Math.max(l.lng,E.lng),E.lat=Math.max(l.lat,E.lat)):(this._sw=new yn(n.lng,n.lat),this._ne=new yn(l.lng,l.lat)),this},io.prototype.getCenter=function(){return new yn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},io.prototype.getSouthWest=function(){return this._sw},io.prototype.getNorthEast=function(){return this._ne},io.prototype.getNorthWest=function(){return new yn(this.getWest(),this.getNorth())},io.prototype.getSouthEast=function(){return new yn(this.getEast(),this.getSouth())},io.prototype.getWest=function(){return this._sw.lng},io.prototype.getSouth=function(){return this._sw.lat},io.prototype.getEast=function(){return this._ne.lng},io.prototype.getNorth=function(){return this._ne.lat},io.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},io.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},io.prototype.isEmpty=function(){return!(this._sw&&this._ne)},io.prototype.contains=function(e){var n=yn.convert(e),l=n.lng,v=n.lat,E=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(E=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=v&&v<=this._ne.lat&&E},io.convert=function(e){return!e||e instanceof io?e:new io(e)};var yn=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid LngLat object: ("+e+", "+n+")");if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};yn.prototype.wrap=function(){return new yn(yt(this.lng,-180,180),this.lat)},yn.prototype.toArray=function(){return[this.lng,this.lat]},yn.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},yn.prototype.distanceTo=function(e){var n=Math.PI/180,l=this.lat*n,v=e.lat*n,E=Math.sin(l)*Math.sin(v)+Math.cos(l)*Math.cos(v)*Math.cos((e.lng-this.lng)*n);return 63710088e-1*Math.acos(Math.min(E,1))},yn.prototype.toBounds=function(e){e===void 0&&(e=0);var n=360*e/40075017,l=n/Math.cos(Math.PI/180*this.lat);return new io(new yn(this.lng-l,this.lat-n),new yn(this.lng+l,this.lat+n))},yn.convert=function(e){if(e instanceof yn)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new yn(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new yn(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var yf=2*Math.PI*63710088e-1;function gf(e){return yf*Math.cos(e*Math.PI/180)}function vd(e){return(180+e)/360}function Fn(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Gu(e,n){return e/gf(n)}function bp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Zu=function(e,n,l){l===void 0&&(l=0),this.x=+e,this.y=+n,this.z=+l};Zu.fromLngLat=function(e,n){n===void 0&&(n=0);var l=yn.convert(e);return new Zu(vd(l.lng),Fn(l.lat),Gu(n,l.lat))},Zu.prototype.toLngLat=function(){return new yn(360*this.x-180,bp(this.y))},Zu.prototype.toAltitude=function(){return this.z*gf(bp(this.y))},Zu.prototype.meterInMercatorCoordinateUnits=function(){return 1/yf*(e=bp(this.y),1/Math.cos(e*Math.PI/180));var e};var Hu=function(e,n,l){this.z=e,this.x=n,this.y=l,this.key=Ec(0,e,e,n,l)};Hu.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Hu.prototype.url=function(e,n){var l,v,E,C,i,t=(v=this.y,E=this.z,C=mf(256*(l=this.x),256*(v=Math.pow(2,E)-v-1),E),i=mf(256*(l+1),256*(v+1),E),C[0]+","+C[1]+","+i[0]+","+i[1]),a=function(p,_,b){for(var I,P="",R=p;R>0;R--)P+=(_&(I=1<<R-1)?1:0)+(b&I?2:0);return P}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",a).replace("{bbox-epsg-3857}",t)},Hu.prototype.getTilePoint=function(e){var n=Math.pow(2,this.z);return new F(8192*(e.x*n-this.x),8192*(e.y*n-this.y))},Hu.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var xd=function(e,n){this.wrap=e,this.canonical=n,this.key=Ec(e,n.z,n.z,n.x,n.y)},Vn=function(e,n,l,v,E){this.overscaledZ=e,this.wrap=n,this.canonical=new Hu(l,+v,+E),this.key=Ec(n,e,l,v,E)};function Ec(e,n,l,v,E){(e*=2)<0&&(e=-1*e-1);var C=1<<l;return(C*C*e+C*E+v).toString(36)+l.toString(36)+n.toString(36)}Vn.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Vn.prototype.scaledTo=function(e){var n=this.canonical.z-e;return e>this.canonical.z?new Vn(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Vn(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)},Vn.prototype.calculateScaledKey=function(e,n){var l=this.canonical.z-e;return e>this.canonical.z?Ec(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y):Ec(this.wrap*+n,e,e,this.canonical.x>>l,this.canonical.y>>l)},Vn.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n},Vn.prototype.children=function(e){if(this.overscaledZ>=e)return[new Vn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var n=this.canonical.z+1,l=2*this.canonical.x,v=2*this.canonical.y;return[new Vn(n,this.wrap,n,l,v),new Vn(n,this.wrap,n,l+1,v),new Vn(n,this.wrap,n,l,v+1),new Vn(n,this.wrap,n,l+1,v+1)]},Vn.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Vn.prototype.wrapped=function(){return new Vn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Vn.prototype.unwrapTo=function(e){return new Vn(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Vn.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Vn.prototype.toUnwrapped=function(){return new xd(this.wrap,this.canonical)},Vn.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Vn.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Zu(e.x-this.wrap,e.y))},oi("CanonicalTileID",Hu),oi("OverscaledTileID",Vn,{omit:["posMatrix"]});var Rs=function(e,n,l){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return Xt('"'+l+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=n.height;var v=this.dim=n.height-2;this.data=new Uint32Array(n.data.buffer),this.encoding=l||"mapbox";for(var E=0;E<v;E++)this.data[this._idx(-1,E)]=this.data[this._idx(0,E)],this.data[this._idx(v,E)]=this.data[this._idx(v-1,E)],this.data[this._idx(E,-1)]=this.data[this._idx(E,0)],this.data[this._idx(E,v)]=this.data[this._idx(E,v-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(v,-1)]=this.data[this._idx(v-1,0)],this.data[this._idx(-1,v)]=this.data[this._idx(0,v-1)],this.data[this._idx(v,v)]=this.data[this._idx(v-1,v-1)]};Rs.prototype.get=function(e,n){var l=new Uint8Array(this.data.buffer),v=4*this._idx(e,n);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(l[v],l[v+1],l[v+2])},Rs.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Rs.prototype._idx=function(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)},Rs.prototype._unpackMapbox=function(e,n,l){return(256*e*256+256*n+l)/10-1e4},Rs.prototype._unpackTerrarium=function(e,n,l){return 256*e+n+l/256-32768},Rs.prototype.getPixels=function(){return new Yo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Rs.prototype.backfillBorder=function(e,n,l){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var v=n*this.dim,E=n*this.dim+this.dim,C=l*this.dim,i=l*this.dim+this.dim;switch(n){case-1:v=E-1;break;case 1:E=v+1}switch(l){case-1:C=i-1;break;case 1:i=C+1}for(var t=-n*this.dim,a=-l*this.dim,p=C;p<i;p++)for(var _=v;_<E;_++)this.data[this._idx(_,p)]=e.data[this._idx(_+t,p+a)]},oi("DEMData",Rs);var jh=function(e){this._stringToNumber={},this._numberToString=[];for(var n=0;n<e.length;n++){var l=e[n];this._stringToNumber[l]=n,this._numberToString[n]=l}};jh.prototype.encode=function(e){return this._stringToNumber[e]},jh.prototype.decode=function(e){return this._numberToString[e]};var ah=function(e,n,l,v,E){this.type="Feature",this._vectorTileFeature=e,e._z=n,e._x=l,e._y=v,this.properties=e.properties,this.id=E},wp={geometry:{configurable:!0}};wp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},wp.geometry.set=function(e){this._geometry=e},ah.prototype.toJSON=function(){var e={geometry:this.geometry};for(var n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(e[n]=this[n]);return e},Object.defineProperties(ah.prototype,wp);var pa=function(){this.state={},this.stateChanges={},this.deletedStates={}};pa.prototype.updateState=function(e,n,l){var v=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][v]=this.stateChanges[e][v]||{},Ne(this.stateChanges[e][v],l),this.deletedStates[e]===null)for(var E in this.deletedStates[e]={},this.state[e])E!==v&&(this.deletedStates[e][E]=null);else if(this.deletedStates[e]&&this.deletedStates[e][v]===null)for(var C in this.deletedStates[e][v]={},this.state[e][v])l[C]||(this.deletedStates[e][v][C]=null);else for(var i in l)this.deletedStates[e]&&this.deletedStates[e][v]&&this.deletedStates[e][v][i]===null&&delete this.deletedStates[e][v][i]},pa.prototype.removeFeatureState=function(e,n,l){if(this.deletedStates[e]!==null){var v=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&n!==void 0)this.deletedStates[e][v]!==null&&(this.deletedStates[e][v]=this.deletedStates[e][v]||{},this.deletedStates[e][v][l]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][v])for(l in this.deletedStates[e][v]={},this.stateChanges[e][v])this.deletedStates[e][v][l]=null;else this.deletedStates[e][v]=null;else this.deletedStates[e]=null}},pa.prototype.getState=function(e,n){var l=String(n),v=Ne({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var E=this.deletedStates[e][n];if(E===null)return{};for(var C in E)delete v[C]}return v},pa.prototype.initializeTileState=function(e,n){e.setFeatureState(this.state,n)},pa.prototype.coalesceChanges=function(e,n){var l={};for(var v in this.stateChanges){this.state[v]=this.state[v]||{};var E={};for(var C in this.stateChanges[v])this.state[v][C]||(this.state[v][C]={}),Ne(this.state[v][C],this.stateChanges[v][C]),E[C]=this.state[v][C];l[v]=E}for(var i in this.deletedStates){this.state[i]=this.state[i]||{};var t={};if(this.deletedStates[i]===null)for(var a in this.state[i])t[a]={},this.state[i][a]={};else for(var p in this.deletedStates[i]){if(this.deletedStates[i][p]===null)this.state[i][p]={};else for(var _=0,b=Object.keys(this.deletedStates[i][p]);_<b.length;_+=1)delete this.state[i][p][b[_]];t[p]=this.state[i][p]}l[i]=l[i]||{},Ne(l[i],t)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(var I in e)e[I].setFeatureState(l,n)};var _s=function(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new ps(8192,16,0),this.grid3D=new ps(8192,16,0),this.featureIndexArray=new ie,this.promoteId=n};function bd(e,n,l,v,E){return Et(e,function(C,i){var t=n instanceof fs?n.get(i):null;return t&&t.evaluate?t.evaluate(l,v,E):t})}function wd(e){for(var n=1/0,l=1/0,v=-1/0,E=-1/0,C=0,i=e;C<i.length;C+=1){var t=i[C];n=Math.min(n,t.x),l=Math.min(l,t.y),v=Math.max(v,t.x),E=Math.max(E,t.y)}return{minX:n,minY:l,maxX:v,maxY:E}}function _f(e,n){return n-e}_s.prototype.insert=function(e,n,l,v,E,C){var i=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,v,E);for(var t=C?this.grid3D:this.grid,a=0;a<n.length;a++){for(var p=n[a],_=[1/0,1/0,-1/0,-1/0],b=0;b<p.length;b++){var I=p[b];_[0]=Math.min(_[0],I.x),_[1]=Math.min(_[1],I.y),_[2]=Math.max(_[2],I.x),_[3]=Math.max(_[3],I.y)}_[0]<8192&&_[1]<8192&&_[2]>=0&&_[3]>=0&&t.insert(i,_[0],_[1],_[2],_[3])}},_s.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Kc.VectorTile(new up(this.rawTileData)).layers,this.sourceLayerCoder=new jh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},_s.prototype.query=function(e,n,l,v){var E=this;this.loadVTLayers();for(var C=e.params||{},i=8192/e.tileSize/e.scale,t=Yl(C.filter),a=e.queryGeometry,p=e.queryPadding*i,_=wd(a),b=this.grid.query(_.minX-p,_.minY-p,_.maxX+p,_.maxY+p),I=wd(e.cameraQueryGeometry),P=this.grid3D.query(I.minX-p,I.minY-p,I.maxX+p,I.maxY+p,function(Q,se,pe,Ae){return function(Be,qe,Ge,it,He){for(var Ct=0,Tt=Be;Ct<Tt.length;Ct+=1){var ut=Tt[Ct];if(qe<=ut.x&&Ge<=ut.y&&it>=ut.x&&He>=ut.y)return!0}var St=[new F(qe,Ge),new F(qe,He),new F(it,He),new F(it,Ge)];if(Be.length>2){for(var mt=0,kt=St;mt<kt.length;mt+=1)if(Ls(Be,kt[mt]))return!0}for(var dt=0;dt<Be.length-1;dt++)if(nu(Be[dt],Be[dt+1],St))return!0;return!1}(e.cameraQueryGeometry,Q-p,se-p,pe+p,Ae+p)}),R=0,O=P;R<O.length;R+=1)b.push(O[R]);b.sort(_f);for(var V,j={},K=function(Q){var se=b[Q];if(se!==V){V=se;var pe=E.featureIndexArray.get(se),Ae=null;E.loadMatchingFeature(j,pe.bucketIndex,pe.sourceLayerIndex,pe.featureIndex,t,C.layers,C.availableImages,n,l,v,function(Be,qe,Ge){return Ae||(Ae=xn(Be)),qe.queryIntersectsFeature(a,Be,Ge,Ae,E.z,e.transform,i,e.pixelPosMatrix)})}},Y=0;Y<b.length;Y++)K(Y);return j},_s.prototype.loadMatchingFeature=function(e,n,l,v,E,C,i,t,a,p,_){var b=this.bucketLayerIDs[n];if(!C||function(Be,qe){for(var Ge=0;Ge<Be.length;Ge++)if(qe.indexOf(Be[Ge])>=0)return!0;return!1}(C,b)){var I=this.sourceLayerCoder.decode(l),P=this.vtLayers[I].feature(v);if(E.needGeometry){var R=ur(P,!0);if(!E.filter(new Nt(this.tileID.overscaledZ),R,this.tileID.canonical))return}else if(!E.filter(new Nt(this.tileID.overscaledZ),P))return;for(var O=this.getId(P,I),V=0;V<b.length;V++){var j=b[V];if(!(C&&C.indexOf(j)<0)){var K=t[j];if(K){var Y={};O!==void 0&&p&&(Y=p.getState(K.sourceLayer||"_geojsonTileLayer",O));var Q=Ne({},a[j]);Q.paint=bd(Q.paint,K.paint,P,Y,i),Q.layout=bd(Q.layout,K.layout,P,Y,i);var se=!_||_(P,K,Y);if(se){var pe=new ah(P,this.z,this.x,this.y,O);pe.layer=Q;var Ae=e[j];Ae===void 0&&(Ae=e[j]=[]),Ae.push({featureIndex:v,feature:pe,intersectionZ:se})}}}}}},_s.prototype.lookupSymbolFeatures=function(e,n,l,v,E,C,i,t){var a={};this.loadVTLayers();for(var p=Yl(E),_=0,b=e;_<b.length;_+=1)this.loadMatchingFeature(a,l,v,b[_],p,C,i,t,n);return a},_s.prototype.hasLayer=function(e){for(var n=0,l=this.bucketLayerIDs;n<l.length;n+=1)for(var v=0,E=l[n];v<E.length;v+=1)if(e===E[v])return!0;return!1},_s.prototype.getId=function(e,n){var l=e.id;return this.promoteId&&typeof(l=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]])=="boolean"&&(l=Number(l)),l},oi("FeatureIndex",_s,{omit:["rawTileData","sourceLayerCoder"]});var yo=function(e,n){this.tileID=e,this.uid=vt(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};yo.prototype.registerFadeDuration=function(e){var n=e+this.timeAdded;n<rr.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)},yo.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},yo.prototype.loadVectorData=function(e,n,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var v in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(p,_){var b={};if(!_)return b;for(var I=function(){var O=R[P],V=O.layerIds.map(function(Y){return _.getLayer(Y)}).filter(Boolean);if(V.length!==0){O.layers=V,O.stateDependentLayerIds&&(O.stateDependentLayers=O.stateDependentLayerIds.map(function(Y){return V.filter(function(Q){return Q.id===Y})[0]}));for(var j=0,K=V;j<K.length;j+=1)b[K[j].id]=O}},P=0,R=p;P<R.length;P+=1)I();return b}(e.buckets,n.style),this.hasSymbolBuckets=!1,this.buckets){var E=this.buckets[v];if(E instanceof Zr){if(this.hasSymbolBuckets=!0,!l)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var C in this.buckets){var i=this.buckets[C];if(i instanceof Zr&&i.hasRTLText){this.hasRTLText=!0,si.isLoading()||si.isLoaded()||va()!=="deferred"||Wo();break}}for(var t in this.queryPadding=0,this.buckets){var a=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(t).queryRadius(a))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new m},yo.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},yo.prototype.getBucket=function(e){return this.buckets[e.id]},yo.prototype.upload=function(e){for(var n in this.buckets){var l=this.buckets[n];l.uploadPending()&&l.upload(e)}var v=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Vu(e,this.imageAtlas.image,v.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Vu(e,this.glyphAtlasImage,v.ALPHA),this.glyphAtlasImage=null)},yo.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},yo.prototype.queryRenderedFeatures=function(e,n,l,v,E,C,i,t,a,p){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:E,scale:C,tileSize:this.tileSize,pixelPosMatrix:p,transform:t,params:i,queryPadding:this.queryPadding*a},e,n,l):{}},yo.prototype.querySourceFeatures=function(e,n){var l=this.latestFeatureIndex;if(l&&l.rawTileData){var v=l.loadVTLayers(),E=n?n.sourceLayer:"",C=v._geojsonTileLayer||v[E];if(C)for(var i=Yl(n&&n.filter),t=this.tileID.canonical,a=t.z,p=t.x,_=t.y,b={z:a,x:p,y:_},I=0;I<C.length;I++){var P=C.feature(I);if(i.needGeometry){var R=ur(P,!0);if(!i.filter(new Nt(this.tileID.overscaledZ),R,this.tileID.canonical))continue}else if(!i.filter(new Nt(this.tileID.overscaledZ),P))continue;var O=l.getId(P,E),V=new ah(P,a,p,_,O);V.tile=b,e.push(V)}}},yo.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},yo.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},yo.prototype.setExpiryData=function(e){var n=this.expirationTime;if(e.cacheControl){var l=Gi(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var v=Date.now(),E=!1;if(this.expirationTime>v)E=!1;else if(n)if(this.expirationTime<n)E=!0;else{var C=this.expirationTime-n;C?this.expirationTime=v+Math.max(C,3e4):E=!0}else E=!0;E?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},yo.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},yo.prototype.setFeatureState=function(e,n){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var l=this.latestFeatureIndex.loadVTLayers();for(var v in this.buckets)if(n.style.hasLayer(v)){var E=this.buckets[v],C=E.layers[0].sourceLayer||"_geojsonTileLayer",i=l[C],t=e[C];if(i&&t&&Object.keys(t).length!==0){E.update(t,i,this.imageAtlas&&this.imageAtlas.patternPositions||{});var a=n&&n.style&&n.style.getLayer(v);a&&(this.queryPadding=Math.max(this.queryPadding,a.queryRadius(E)))}}}},yo.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},yo.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<rr.now()},yo.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},yo.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=rr.now()+e},yo.prototype.setDependencies=function(e,n){for(var l={},v=0,E=n;v<E.length;v+=1)l[E[v]]=!0;this.dependencies[e]=l},yo.prototype.hasDependency=function(e,n){for(var l=0,v=e;l<v.length;l+=1){var E=this.dependencies[v[l]];if(E){for(var C=0,i=n;C<i.length;C+=1)if(E[i[C]])return!0}}return!1};var du=H.performance,Ed=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},du.mark(this._marks.start)};Ed.prototype.finish=function(){du.mark(this._marks.end);var e=du.getEntriesByName(this._marks.measure);return e.length===0&&(du.measure(this._marks.measure,this._marks.start,this._marks.end),e=du.getEntriesByName(this._marks.measure),du.clearMarks(this._marks.start),du.clearMarks(this._marks.end),du.clearMeasures(this._marks.measure)),e},f.Actor=qu,f.AlphaImage=dc,f.CanonicalTileID=Hu,f.CollisionBoxArray=m,f.Color=Di,f.DEMData=Rs,f.DataConstantProperty=Zt,f.DictionaryCoder=jh,f.EXTENT=8192,f.ErrorEvent=Oe,f.EvaluationParameters=Nt,f.Event=Se,f.Evented=Ve,f.FeatureIndex=_s,f.FillBucket=ol,f.FillExtrusionBucket=al,f.ImageAtlas=Ph,f.ImagePosition=cp,f.LineBucket=Qo,f.LngLat=yn,f.LngLatBounds=io,f.MercatorCoordinate=Zu,f.ONE_EM=24,f.OverscaledTileID=Vn,f.Point=F,f.Point$1=F,f.Properties=T,f.Protobuf=up,f.RGBAImage=Yo,f.RequestManager=ir,f.RequestPerformance=Ed,f.ResourceType=nr,f.SegmentVector=de,f.SourceFeatureState=pa,f.StructArrayLayout1ui2=ei,f.StructArrayLayout2f1f2i16=nt,f.StructArrayLayout2i4=Z,f.StructArrayLayout3ui6=xt,f.StructArrayLayout4i8=J,f.SymbolBucket=Zr,f.Texture=Vu,f.Tile=yo,f.Transitionable=jn,f.Uniform1f=Dt,f.Uniform1i=It,f.Uniform2f=Lt,f.Uniform3f=$t,f.Uniform4f=mi,f.UniformColor=bi,f.UniformMatrix4f=ar,f.UnwrappedTileID=xd,f.ValidationError=Me,f.WritingMode=Wa,f.ZoomHistory=Ha,f.add=function(e,n,l){return e[0]=n[0]+l[0],e[1]=n[1]+l[1],e[2]=n[2]+l[2],e},f.addDynamicAttributes=gd,f.asyncAll=function(e,n,l){if(!e.length)return l(null,[]);var v=e.length,E=new Array(e.length),C=null;e.forEach(function(i,t){n(i,function(a,p){a&&(C=a),E[t]=p,--v==0&&l(C,E)})})},f.bezier=ke,f.bindAll=lt,f.browser=rr,f.cacheEntryPossiblyAdded=function(e){++Yr>br&&(e.getActor().send("enforceCacheSizeLimit",yr),Yr=0)},f.clamp=je,f.clearTileCache=function(e){var n=H.caches.delete("mapbox-tiles");e&&n.catch(e).then(function(){return e()})},f.clipLine=yd,f.clone=function(e){var n=new Er(16);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},f.clone$1=Ei,f.clone$2=function(e){var n=new Er(3);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n},f.collisionCircleLayout=Qd,f.config=zi,f.create=function(){var e=new Er(16);return Er!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},f.create$1=function(){var e=new Er(9);return Er!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},f.create$2=function(){var e=new Er(4);return Er!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},f.createCommonjsModule=h,f.createExpression=Kl,f.createLayout=M,f.createStyleLayer=function(e){return e.type==="custom"?new _d(e):new ry[e.type](e)},f.cross=function(e,n,l){var v=n[0],E=n[1],C=n[2],i=l[0],t=l[1],a=l[2];return e[0]=E*a-C*t,e[1]=C*i-v*a,e[2]=v*t-E*i,e},f.deepEqual=function e(n,l){if(Array.isArray(n)){if(!Array.isArray(l)||n.length!==l.length)return!1;for(var v=0;v<n.length;v++)if(!e(n[v],l[v]))return!1;return!0}if(typeof n=="object"&&n!==null&&l!==null){if(typeof l!="object"||Object.keys(n).length!==Object.keys(l).length)return!1;for(var E in n)if(!e(n[E],l[E]))return!1;return!0}return n===l},f.dot=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]},f.dot$1=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3]},f.ease=We,f.emitValidationErrors=Il,f.endsWith=fi,f.enforceCacheSizeLimit=function(e){Xn(),Un&&Un.then(function(n){n.keys().then(function(l){for(var v=0;v<l.length-e;v++)n.delete(l[v])})})},f.evaluateSizeForFeature=pd,f.evaluateSizeForZoom=dd,f.evaluateVariableOffset=Fh,f.evented=hc,f.extend=Ne,f.featureFilter=Yl,f.filterObject=Wt,f.fromRotation=function(e,n){var l=Math.sin(n),v=Math.cos(n);return e[0]=v,e[1]=l,e[2]=0,e[3]=-l,e[4]=v,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},f.getAnchorAlignment=_c,f.getAnchorJustification=mp,f.getArrayBuffer=Oo,f.getImage=oe,f.getJSON=function(e,n){return ya(Ne(e,{type:"json"}),n)},f.getRTLTextPluginStatus=va,f.getReferrer=Dn,f.getVideo=function(e,n){var l,v,E=H.document.createElement("video");E.muted=!0,E.onloadstart=function(){n(null,E)};for(var C=0;C<e.length;C++){var i=H.document.createElement("source");l=e[C],v=void 0,(v=H.document.createElement("a")).href=l,(v.protocol!==H.document.location.protocol||v.host!==H.document.location.host)&&(E.crossOrigin="Anonymous"),i.src=e[C],E.appendChild(i)}return{cancel:function(){}}},f.identity=$o,f.invert=function(e,n){var l=n[0],v=n[1],E=n[2],C=n[3],i=n[4],t=n[5],a=n[6],p=n[7],_=n[8],b=n[9],I=n[10],P=n[11],R=n[12],O=n[13],V=n[14],j=n[15],K=l*t-v*i,Y=l*a-E*i,Q=l*p-C*i,se=v*a-E*t,pe=v*p-C*t,Ae=E*p-C*a,Be=_*O-b*R,qe=_*V-I*R,Ge=_*j-P*R,it=b*V-I*O,He=b*j-P*O,Ct=I*j-P*V,Tt=K*Ct-Y*He+Q*it+se*Ge-pe*qe+Ae*Be;return Tt?(e[0]=(t*Ct-a*He+p*it)*(Tt=1/Tt),e[1]=(E*He-v*Ct-C*it)*Tt,e[2]=(O*Ae-V*pe+j*se)*Tt,e[3]=(I*pe-b*Ae-P*se)*Tt,e[4]=(a*Ge-i*Ct-p*qe)*Tt,e[5]=(l*Ct-E*Ge+C*qe)*Tt,e[6]=(V*Q-R*Ae-j*Y)*Tt,e[7]=(_*Ae-I*Q+P*Y)*Tt,e[8]=(i*He-t*Ge+p*Be)*Tt,e[9]=(v*Ge-l*He-C*Be)*Tt,e[10]=(R*pe-O*Q+j*K)*Tt,e[11]=(b*Q-_*pe-P*K)*Tt,e[12]=(t*qe-i*it-a*Be)*Tt,e[13]=(l*it-v*qe+E*Be)*Tt,e[14]=(O*Y-R*se-V*K)*Tt,e[15]=(_*se-b*Y+I*K)*Tt,e):null},f.isChar=qt,f.isMapboxURL=Pr,f.keysDifference=function(e,n){var l=[];for(var v in e)v in n||l.push(v);return l},f.makeRequest=ya,f.mapObject=Et,f.mercatorXfromLng=vd,f.mercatorYfromLat=Fn,f.mercatorZfromAltitude=Gu,f.mul=Bu,f.multiply=ha,f.mvt=Kc,f.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},f.normalize=function(e,n){var l=n[0],v=n[1],E=n[2],C=l*l+v*v+E*E;return C>0&&(C=1/Math.sqrt(C)),e[0]=n[0]*C,e[1]=n[1]*C,e[2]=n[2]*C,e},f.number=Tn,f.offscreenCanvasSupported=Ht,f.ortho=function(e,n,l,v,E,C,i){var t=1/(n-l),a=1/(v-E),p=1/(C-i);return e[0]=-2*t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*p,e[11]=0,e[12]=(n+l)*t,e[13]=(E+v)*a,e[14]=(i+C)*p,e[15]=1,e},f.parseGlyphPBF=function(e){return new up(e).readFields(qm,[])},f.pbf=up,f.performSymbolLayout=function(e,n,l,v,E,C,i){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var t=e.layers[0].layout,a=e.layers[0]._unevaluatedLayout._values,p={};if(e.textSizeData.kind==="composite"){var _=e.textSizeData,b=_.maxZoom;p.compositeTextSizes=[a["text-size"].possiblyEvaluate(new Nt(_.minZoom),i),a["text-size"].possiblyEvaluate(new Nt(b),i)]}if(e.iconSizeData.kind==="composite"){var I=e.iconSizeData,P=I.maxZoom;p.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new Nt(I.minZoom),i),a["icon-size"].possiblyEvaluate(new Nt(P),i)]}p.layoutTextSize=a["text-size"].possiblyEvaluate(new Nt(e.zoom+1),i),p.layoutIconSize=a["icon-size"].possiblyEvaluate(new Nt(e.zoom+1),i),p.textMaxSize=a["text-size"].possiblyEvaluate(new Nt(18));for(var R=24*t.get("text-line-height"),O=t.get("text-rotation-alignment")==="map"&&t.get("symbol-placement")!=="point",V=t.get("text-keep-upright"),j=t.get("text-size"),K=function(){var se=Q[Y],pe=t.get("text-font").evaluate(se,{},i).join(","),Ae=j.evaluate(se,{},i),Be=p.layoutTextSize.evaluate(se,{},i),qe=p.layoutIconSize.evaluate(se,{},i),Ge={horizontal:{},vertical:void 0},it=se.text,He=[0,0];if(it){var Ct=it.toString(),Tt=24*t.get("text-letter-spacing").evaluate(se,{},i),ut=function(Oi){for(var Wi=0,Yi=Oi;Wi<Yi.length;Wi+=1)if(Vi=Yi[Wi].charCodeAt(0),qt.Arabic(Vi)||qt["Arabic Supplement"](Vi)||qt["Arabic Extended-A"](Vi)||qt["Arabic Presentation Forms-A"](Vi)||qt["Arabic Presentation Forms-B"](Vi))return!1;var Vi;return!0}(Ct)?Tt:0,St=t.get("text-anchor").evaluate(se,{},i),mt=t.get("text-variable-anchor");if(!mt){var kt=t.get("text-radial-offset").evaluate(se,{},i);He=kt?Fh(St,[24*kt,fp]):t.get("text-offset").evaluate(se,{},i).map(function(Oi){return 24*Oi})}var dt=O?"center":t.get("text-justify").evaluate(se,{},i),_t=t.get("symbol-placement"),ti=_t==="point"?24*t.get("text-max-width").evaluate(se,{},i):0,Yt=function(){e.allowVerticalPlacement&&eu(Ct)&&(Ge.vertical=Mh(it,n,l,E,pe,ti,R,St,"left",ut,He,Wa.vertical,!0,_t,Be,Ae))};if(!O&&mt){for(var ki=dt==="auto"?mt.map(function(Oi){return mp(Oi)}):[dt],Mi=!1,$i=0;$i<ki.length;$i++){var sr=ki[$i];if(!Ge.horizontal[sr])if(Mi)Ge.horizontal[sr]=Ge.horizontal[0];else{var kr=Mh(it,n,l,E,pe,ti,R,"center",sr,ut,He,Wa.horizontal,!1,_t,Be,Ae);kr&&(Ge.horizontal[sr]=kr,Mi=kr.positionedLines.length===1)}}Yt()}else{dt==="auto"&&(dt=mp(St));var zr=Mh(it,n,l,E,pe,ti,R,St,dt,ut,He,Wa.horizontal,!1,_t,Be,Ae);zr&&(Ge.horizontal[dt]=zr),Yt(),eu(Ct)&&O&&V&&(Ge.vertical=Mh(it,n,l,E,pe,ti,R,St,dt,ut,He,Wa.vertical,!1,_t,Be,Ae))}}var vr=void 0,Br=!1;if(se.icon&&se.icon.name){var xr=v[se.icon.name];xr&&(vr=function(Oi,Wi,Yi){var Vi=_c(Yi),on=Wi[0]-Oi.displaySize[0]*Vi.horizontalAlign,en=Wi[1]-Oi.displaySize[1]*Vi.verticalAlign;return{image:Oi,top:en,bottom:en+Oi.displaySize[1],left:on,right:on+Oi.displaySize[0]}}(E[se.icon.name],t.get("icon-offset").evaluate(se,{},i),t.get("icon-anchor").evaluate(se,{},i)),Br=xr.sdf,e.sdfIcons===void 0?e.sdfIcons=xr.sdf:e.sdfIcons!==xr.sdf&&Xt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(xr.pixelRatio!==e.pixelRatio||t.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Or=Nh(Ge.horizontal)||Ge.vertical;e.iconsInText=!!Or&&Or.iconsInText,(Or||vr)&&function(Oi,Wi,Yi,Vi,on,en,hr,or,Lr,hi,ro){var cn=en.textMaxSize.evaluate(Wi,{});cn===void 0&&(cn=hr);var Mn,Hr=Oi.layers[0].layout,Ro=Hr.get("icon-offset").evaluate(Wi,{},ro),go=Nh(Yi.horizontal),Xa=hr/24,ea=Oi.tilePixelRatio*Xa,ta=Oi.tilePixelRatio*cn/24,no=Oi.tilePixelRatio*or,Ka=Oi.tilePixelRatio*Hr.get("symbol-spacing"),Wu=Hr.get("text-padding")*Oi.tilePixelRatio,Ic=Hr.get("icon-padding")*Oi.tilePixelRatio,Sc=Hr.get("text-max-angle")/180*Math.PI,sh=Hr.get("text-rotation-alignment")==="map"&&Hr.get("symbol-placement")!=="point",Bs=Hr.get("icon-rotation-alignment")==="map"&&Hr.get("symbol-placement")!=="point",Ml=Hr.get("symbol-placement"),Tc=Ka/2,Xu=Hr.get("icon-text-fit");Vi&&Xu!=="none"&&(Oi.allowVerticalPlacement&&Yi.vertical&&(Mn=Lh(Vi,Yi.vertical,Xu,Hr.get("icon-text-fit-padding"),Ro,Xa)),go&&(Vi=Lh(Vi,go,Xu,Hr.get("icon-text-fit-padding"),Ro,Xa)));var fu=function(Z0,Id){Id.x<0||Id.x>=8192||Id.y<0||Id.y>=8192||function(oo,yu,H0,ch,sy,Ug,vf,Ku,xf,Sd,bf,wf,ly,Ng,Td,jg,Vg,qg,Gg,Zg,Fs,Ef,Hg,Ju,W0){var Wg,Hh,Tp,Ap,Cp,kp=oo.addToLineVertexArray(yu,H0),Xg=0,Kg=0,Jg=0,$g=0,uy=-1,cy=-1,kc={},Yg=xe(""),hy=0,py=0;if(Ku._unevaluatedLayout.getValue("text-radial-offset")===void 0?(hy=(Wg=Ku.layout.get("text-offset").evaluate(Fs,{},Ju).map(function(Cd){return 24*Cd}))[0],py=Wg[1]):(hy=24*Ku.layout.get("text-radial-offset").evaluate(Fs,{},Ju),py=fp),oo.allowVerticalPlacement&&ch.vertical){var Qg=Ku.layout.get("text-rotate").evaluate(Fs,{},Ju)+90;Ap=new Oh(xf,yu,Sd,bf,wf,ch.vertical,ly,Ng,Td,Qg),vf&&(Cp=new Oh(xf,yu,Sd,bf,wf,vf,Vg,qg,Td,Qg))}if(sy){var dy=Ku.layout.get("icon-rotate").evaluate(Fs,{}),e_=Ku.layout.get("icon-text-fit")!=="none",t_=zl(sy,dy,Hg,e_),fy=vf?zl(vf,dy,Hg,e_):void 0;Tp=new Oh(xf,yu,Sd,bf,wf,sy,Vg,qg,!1,dy),Xg=4*t_.length;var i_=oo.iconSizeData,Ad=null;i_.kind==="source"?(Ad=[128*Ku.layout.get("icon-size").evaluate(Fs,{})])[0]>32640&&Xt(oo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):i_.kind==="composite"&&((Ad=[128*Ef.compositeIconSizes[0].evaluate(Fs,{},Ju),128*Ef.compositeIconSizes[1].evaluate(Fs,{},Ju)])[0]>32640||Ad[1]>32640)&&Xt(oo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),oo.addSymbols(oo.icon,t_,Ad,Zg,Gg,Fs,!1,yu,kp.lineStartIndex,kp.lineLength,-1,Ju),uy=oo.icon.placedSymbolArray.length-1,fy&&(Kg=4*fy.length,oo.addSymbols(oo.icon,fy,Ad,Zg,Gg,Fs,Wa.vertical,yu,kp.lineStartIndex,kp.lineLength,-1,Ju),cy=oo.icon.placedSymbolArray.length-1)}for(var r_ in ch.horizontal){var If=ch.horizontal[r_];if(!Hh){Yg=xe(If.text);var X0=Ku.layout.get("text-rotate").evaluate(Fs,{},Ju);Hh=new Oh(xf,yu,Sd,bf,wf,If,ly,Ng,Td,X0)}var n_=If.positionedLines.length===1;if(Jg+=Uh(oo,yu,If,Ug,Ku,Td,Fs,jg,kp,ch.vertical?Wa.horizontal:Wa.horizontalOnly,n_?Object.keys(ch.horizontal):[r_],kc,uy,Ef,Ju),n_)break}ch.vertical&&($g+=Uh(oo,yu,ch.vertical,Ug,Ku,Td,Fs,jg,kp,Wa.vertical,["vertical"],kc,cy,Ef,Ju));var K0=Hh?Hh.boxStartIndex:oo.collisionBoxArray.length,J0=Hh?Hh.boxEndIndex:oo.collisionBoxArray.length,$0=Ap?Ap.boxStartIndex:oo.collisionBoxArray.length,Y0=Ap?Ap.boxEndIndex:oo.collisionBoxArray.length,Q0=Tp?Tp.boxStartIndex:oo.collisionBoxArray.length,ex=Tp?Tp.boxEndIndex:oo.collisionBoxArray.length,tx=Cp?Cp.boxStartIndex:oo.collisionBoxArray.length,ix=Cp?Cp.boxEndIndex:oo.collisionBoxArray.length,$u=-1,Sf=function(Cd,a_){return Cd&&Cd.circleDiameter?Math.max(Cd.circleDiameter,a_):a_};$u=Sf(Hh,$u),$u=Sf(Ap,$u),$u=Sf(Tp,$u);var o_=($u=Sf(Cp,$u))>-1?1:0;o_&&($u*=W0/24),oo.glyphOffsetArray.length>=Zr.MAX_GLYPHS&&Xt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Fs.sortKey!==void 0&&oo.addToSortKeyRanges(oo.symbolInstances.length,Fs.sortKey),oo.symbolInstances.emplaceBack(yu.x,yu.y,kc.right>=0?kc.right:-1,kc.center>=0?kc.center:-1,kc.left>=0?kc.left:-1,kc.vertical||-1,uy,cy,Yg,K0,J0,$0,Y0,Q0,ex,tx,ix,Sd,Jg,$g,Xg,Kg,o_,0,ly,hy,py,$u)}(Oi,Id,Z0,Yi,Vi,on,Mn,Oi.layers[0],Oi.collisionBoxArray,Wi.index,Wi.sourceLayerIndex,Oi.index,ea,Wu,sh,Lr,no,Ic,Bs,Ro,Wi,en,hi,ro,hr)};if(Ml==="line")for(var lh=0,Ep=yd(Wi.geometry,0,0,8192,8192);lh<Ep.length;lh+=1)for(var Ip=Ep[lh],Vh=0,qh=Xm(Ip,Ka,Sc,Yi.vertical||go,Vi,24,ta,Oi.overscaling,8192);Vh<qh.length;Vh+=1){var Sp=qh[Vh];go&&yp(Oi,go.text,Tc,Sp)||fu(Ip,Sp)}else if(Ml==="line-center")for(var Gh=0,Zh=Wi.geometry;Gh<Zh.length;Gh+=1){var Pa=Zh[Gh];if(Pa.length>1){var Ac=Wm(Pa,Sc,Yi.vertical||go,Vi,24,ta);Ac&&fu(Pa,Ac)}}else if(Wi.type==="Polygon")for(var Cc=0,ia=sp(Wi.geometry,0);Cc<ia.length;Cc+=1){var Ma=ia[Cc],mu=Jm(Ma,16);fu(Ma[0],new hu(mu.x,mu.y,0))}else if(Wi.type==="LineString")for(var sl=0,uh=Wi.geometry;sl<uh.length;sl+=1){var Os=uh[sl];fu(Os,new hu(Os[0].x,Os[0].y,0))}else if(Wi.type==="Point")for(var ny=0,Og=Wi.geometry;ny<Og.length;ny+=1)for(var oy=0,Fg=Og[ny];oy<Fg.length;oy+=1){var ay=Fg[oy];fu([ay],new hu(ay.x,ay.y,0))}}(e,se,Ge,vr,v,p,Be,qe,He,Br,i)},Y=0,Q=e.features;Y<Q.length;Y+=1)K();C&&e.generateCollisionDebugBuffers()},f.perspective=function(e,n,l,v,E){var C,i=1/Math.tan(n/2);return e[0]=i/l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,E!=null&&E!==1/0?(e[10]=(E+v)*(C=1/(v-E)),e[14]=2*E*v*C):(e[10]=-1,e[14]=-2*v),e},f.pick=function(e,n){for(var l={},v=0;v<n.length;v++){var E=n[v];E in e&&(l[E]=e[E])}return l},f.plugin=si,f.polygonIntersectsPolygon=xa,f.postMapLoadEvent=Si,f.postTurnstileEvent=Ue,f.potpack=cf,f.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],f.register=oi,f.registerForPluginStateChange=function(e){return e({pluginStatus:So,pluginURL:ka}),hc.on("pluginStateChange",e),e},f.renderColorRamp=ap,f.rotate=function(e,n,l){var v=n[0],E=n[1],C=n[2],i=n[3],t=Math.sin(l),a=Math.cos(l);return e[0]=v*a+C*t,e[1]=E*a+i*t,e[2]=v*-t+C*a,e[3]=E*-t+i*a,e},f.rotateX=function(e,n,l){var v=Math.sin(l),E=Math.cos(l),C=n[4],i=n[5],t=n[6],a=n[7],p=n[8],_=n[9],b=n[10],I=n[11];return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=C*E+p*v,e[5]=i*E+_*v,e[6]=t*E+b*v,e[7]=a*E+I*v,e[8]=p*E-C*v,e[9]=_*E-i*v,e[10]=b*E-t*v,e[11]=I*E-a*v,e},f.rotateZ=function(e,n,l){var v=Math.sin(l),E=Math.cos(l),C=n[0],i=n[1],t=n[2],a=n[3],p=n[4],_=n[5],b=n[6],I=n[7];return n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=C*E+p*v,e[1]=i*E+_*v,e[2]=t*E+b*v,e[3]=a*E+I*v,e[4]=p*E-C*v,e[5]=_*E-i*v,e[6]=b*E-t*v,e[7]=I*E-a*v,e},f.scale=function(e,n,l){var v=l[0],E=l[1],C=l[2];return e[0]=n[0]*v,e[1]=n[1]*v,e[2]=n[2]*v,e[3]=n[3]*v,e[4]=n[4]*E,e[5]=n[5]*E,e[6]=n[6]*E,e[7]=n[7]*E,e[8]=n[8]*C,e[9]=n[9]*C,e[10]=n[10]*C,e[11]=n[11]*C,e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},f.scale$1=function(e,n,l){return e[0]=n[0]*l,e[1]=n[1]*l,e[2]=n[2]*l,e[3]=n[3]*l,e},f.scale$2=function(e,n,l){return e[0]=n[0]*l,e[1]=n[1]*l,e[2]=n[2]*l,e},f.setCacheLimits=function(e,n){yr=e,br=n},f.setRTLTextPlugin=function(e,n,l){if(l===void 0&&(l=!1),So==="deferred"||So==="loading"||So==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");ka=rr.resolveURL(e),So="deferred",tl=n,Al(),l||Wo()},f.sphericalToCartesian=function(e){var n=e[0],l=e[1],v=e[2];return l+=90,l*=Math.PI/180,v*=Math.PI/180,{x:n*Math.cos(l)*Math.sin(v),y:n*Math.sin(l)*Math.sin(v),z:n*Math.cos(v)}},f.sqrLen=function(e){var n=e[0],l=e[1];return n*n+l*l},f.styleSpec=ye,f.sub=function(e,n,l){return e[0]=n[0]-l[0],e[1]=n[1]-l[1],e[2]=n[2]-l[2],e},f.symbolSize=Hm,f.transformMat3=function(e,n,l){var v=n[0],E=n[1],C=n[2];return e[0]=v*l[0]+E*l[3]+C*l[6],e[1]=v*l[1]+E*l[4]+C*l[7],e[2]=v*l[2]+E*l[5]+C*l[8],e},f.transformMat4=Ou,f.translate=function(e,n,l){var v,E,C,i,t,a,p,_,b,I,P,R,O=l[0],V=l[1],j=l[2];return n===e?(e[12]=n[0]*O+n[4]*V+n[8]*j+n[12],e[13]=n[1]*O+n[5]*V+n[9]*j+n[13],e[14]=n[2]*O+n[6]*V+n[10]*j+n[14],e[15]=n[3]*O+n[7]*V+n[11]*j+n[15]):(E=n[1],C=n[2],i=n[3],t=n[4],a=n[5],p=n[6],_=n[7],b=n[8],I=n[9],P=n[10],R=n[11],e[0]=v=n[0],e[1]=E,e[2]=C,e[3]=i,e[4]=t,e[5]=a,e[6]=p,e[7]=_,e[8]=b,e[9]=I,e[10]=P,e[11]=R,e[12]=v*O+t*V+b*j+n[12],e[13]=E*O+a*V+I*j+n[13],e[14]=C*O+p*V+P*j+n[14],e[15]=i*O+_*V+R*j+n[15]),e},f.triggerPluginCompletionEvent=cc,f.uniqueId=vt,f.validateCustomStyleLayer=function(e){var n=[],l=e.id;return l===void 0&&n.push({message:"layers."+l+': missing required property "id"'}),e.render===void 0&&n.push({message:"layers."+l+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&n.push({message:"layers."+l+': property "renderingMode" must be either "2d" or "3d"'}),n},f.validateLight=Ql,f.validateStyle=Ca,f.values=function(e){var n=[];for(var l in e)n.push(e[l]);return n},f.vectorTile=Kc,f.version="1.13.2",f.warnOnce=Xt,f.webpSupported=zt,f.window=H,f.wrap=yt}),z(["./shared"],function(f){function h(te){var oe=typeof te;if(oe==="number"||oe==="boolean"||oe==="string"||te==null)return JSON.stringify(te);if(Array.isArray(te)){for(var le="[",ge=0,Se=te;ge<Se.length;ge+=1)le+=h(Se[ge])+",";return le+"]"}for(var Oe=Object.keys(te).sort(),Ve="{",ye=0;ye<Oe.length;ye++)Ve+=JSON.stringify(Oe[ye])+":"+h(te[Oe[ye]])+",";return Ve+"}"}function D(te){for(var oe="",le=0,ge=f.refProperties;le<ge.length;le+=1)oe+="/"+h(te[ge[le]]);return oe}var N=function(te){this.keyCache={},te&&this.replace(te)};N.prototype.replace=function(te){this._layerConfigs={},this._layers={},this.update(te,[])},N.prototype.update=function(te,oe){for(var le=this,ge=0,Se=te;ge<Se.length;ge+=1){var Oe=Se[ge];this._layerConfigs[Oe.id]=Oe;var Ve=this._layers[Oe.id]=f.createStyleLayer(Oe);Ve._featureFilter=f.featureFilter(Ve.filter),this.keyCache[Oe.id]&&delete this.keyCache[Oe.id]}for(var ye=0,Me=oe;ye<Me.length;ye+=1){var Qe=Me[ye];delete this.keyCache[Qe],delete this._layerConfigs[Qe],delete this._layers[Qe]}this.familiesBySource={};for(var ae=0,W=function(we,Ie){for(var et={},Ke=0;Ke<we.length;Ke++){var tt=Ie&&Ie[we[Ke].id]||D(we[Ke]);Ie&&(Ie[we[Ke].id]=tt);var Ut=et[tt];Ut||(Ut=et[tt]=[]),Ut.push(we[Ke])}var At=[];for(var Ot in et)At.push(et[Ot]);return At}(f.values(this._layerConfigs),this.keyCache);ae<W.length;ae+=1){var X=W[ae].map(function(we){return le._layers[we.id]}),ne=X[0];if(ne.visibility!=="none"){var ce=ne.source||"",_e=this.familiesBySource[ce];_e||(_e=this.familiesBySource[ce]={});var fe=ne.sourceLayer||"_geojsonTileLayer",Ee=_e[fe];Ee||(Ee=_e[fe]=[]),Ee.push(X)}}};var F=function(te){var oe={},le=[];for(var ge in te){var Se=te[ge],Oe=oe[ge]={};for(var Ve in Se){var ye=Se[+Ve];if(ye&&ye.bitmap.width!==0&&ye.bitmap.height!==0){var Me={x:0,y:0,w:ye.bitmap.width+2,h:ye.bitmap.height+2};le.push(Me),Oe[Ve]={rect:Me,metrics:ye.metrics}}}}var Qe=f.potpack(le),ae=new f.AlphaImage({width:Qe.w||1,height:Qe.h||1});for(var W in te){var X=te[W];for(var ne in X){var ce=X[+ne];if(ce&&ce.bitmap.width!==0&&ce.bitmap.height!==0){var _e=oe[W][ne].rect;f.AlphaImage.copy(ce.bitmap,ae,{x:0,y:0},{x:_e.x+1,y:_e.y+1},ce.bitmap)}}}this.image=ae,this.positions=oe};f.register("GlyphAtlas",F);var G=function(te){this.tileID=new f.OverscaledTileID(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.uid=te.uid,this.zoom=te.zoom,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.collectResourceTiming,this.returnDependencies=!!te.returnDependencies,this.promoteId=te.promoteId};function H(te,oe,le){for(var ge=new f.EvaluationParameters(oe),Se=0,Oe=te;Se<Oe.length;Se+=1)Oe[Se].recalculate(ge,le)}function Pe(te,oe){var le=f.getArrayBuffer(te.request,function(ge,Se,Oe,Ve){ge?oe(ge):Se&&oe(null,{vectorTile:new f.vectorTile.VectorTile(new f.pbf(Se)),rawData:Se,cacheControl:Oe,expires:Ve})});return function(){le.cancel(),oe()}}G.prototype.parse=function(te,oe,le,ge,Se){var Oe=this;this.status="parsing",this.data=te,this.collisionBoxArray=new f.CollisionBoxArray;var Ve=new f.DictionaryCoder(Object.keys(te.layers).sort()),ye=new f.FeatureIndex(this.tileID,this.promoteId);ye.bucketLayerIDs=[];var Me,Qe,ae,W,X={},ne={featureIndex:ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le},ce=oe.familiesBySource[this.source];for(var _e in ce){var fe=te.layers[_e];if(fe){fe.version===1&&f.warnOnce('Vector tile source "'+this.source+'" layer "'+_e+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ee=Ve.encode(_e),we=[],Ie=0;Ie<fe.length;Ie++){var et=fe.feature(Ie),Ke=ye.getId(et,_e);we.push({feature:et,id:Ke,index:Ie,sourceLayerIndex:Ee})}for(var tt=0,Ut=ce[_e];tt<Ut.length;tt+=1){var At=Ut[tt],Ot=At[0];Ot.minzoom&&this.zoom<Math.floor(Ot.minzoom)||Ot.maxzoom&&this.zoom>=Ot.maxzoom||Ot.visibility!=="none"&&(H(At,this.zoom,le),(X[Ot.id]=Ot.createBucket({index:ye.bucketLayerIDs.length,layers:At,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ee,sourceID:this.source})).populate(we,ne,this.tileID.canonical),ye.bucketLayerIDs.push(At.map(function(ci){return ci.id})))}}}var Vt=f.mapObject(ne.glyphDependencies,function(ci){return Object.keys(ci).map(Number)});Object.keys(Vt).length?ge.send("getGlyphs",{uid:this.uid,stacks:Vt},function(ci,Kt){Me||(Me=ci,Qe=Kt,Ci.call(Oe))}):Qe={};var Hi=Object.keys(ne.iconDependencies);Hi.length?ge.send("getImages",{icons:Hi,source:this.source,tileID:this.tileID,type:"icons"},function(ci,Kt){Me||(Me=ci,ae=Kt,Ci.call(Oe))}):ae={};var gi=Object.keys(ne.patternDependencies);function Ci(){if(Me)return Se(Me);if(Qe&&ae&&W){var ci=new F(Qe),Kt=new f.ImageAtlas(ae,W);for(var Di in X){var Ir=X[Di];Ir instanceof f.SymbolBucket?(H(Ir.layers,this.zoom,le),f.performSymbolLayout(Ir,Qe,ci.positions,ae,Kt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Ir.hasPattern&&(Ir instanceof f.LineBucket||Ir instanceof f.FillBucket||Ir instanceof f.FillExtrusionBucket)&&(H(Ir.layers,this.zoom,le),Ir.addFeatures(ne,this.tileID.canonical,Kt.patternPositions))}this.status="done",Se(null,{buckets:f.values(X).filter(function(kn){return!kn.isEmpty()}),featureIndex:ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ci.image,imageAtlas:Kt,glyphMap:this.returnDependencies?Qe:null,iconMap:this.returnDependencies?ae:null,glyphPositions:this.returnDependencies?ci.positions:null})}}gi.length?ge.send("getImages",{icons:gi,source:this.source,tileID:this.tileID,type:"patterns"},function(ci,Kt){Me||(Me=ci,W=Kt,Ci.call(Oe))}):W={},Ci.call(this)};var ke=function(te,oe,le,ge){this.actor=te,this.layerIndex=oe,this.availableImages=le,this.loadVectorData=ge||Pe,this.loading={},this.loaded={}};ke.prototype.loadTile=function(te,oe){var le=this,ge=te.uid;this.loading||(this.loading={});var Se=!!(te&&te.request&&te.request.collectResourceTiming)&&new f.RequestPerformance(te.request),Oe=this.loading[ge]=new G(te);Oe.abort=this.loadVectorData(te,function(Ve,ye){if(delete le.loading[ge],Ve||!ye)return Oe.status="done",le.loaded[ge]=Oe,oe(Ve);var Me=ye.rawData,Qe={};ye.expires&&(Qe.expires=ye.expires),ye.cacheControl&&(Qe.cacheControl=ye.cacheControl);var ae={};if(Se){var W=Se.finish();W&&(ae.resourceTiming=JSON.parse(JSON.stringify(W)))}Oe.vectorTile=ye.vectorTile,Oe.parse(ye.vectorTile,le.layerIndex,le.availableImages,le.actor,function(X,ne){if(X||!ne)return oe(X);oe(null,f.extend({rawTileData:Me.slice(0)},ne,Qe,ae))}),le.loaded=le.loaded||{},le.loaded[ge]=Oe})},ke.prototype.reloadTile=function(te,oe){var le=this,ge=this.loaded,Se=te.uid,Oe=this;if(ge&&ge[Se]){var Ve=ge[Se];Ve.showCollisionBoxes=te.showCollisionBoxes;var ye=function(Me,Qe){var ae=Ve.reloadCallback;ae&&(delete Ve.reloadCallback,Ve.parse(Ve.vectorTile,Oe.layerIndex,le.availableImages,Oe.actor,ae)),oe(Me,Qe)};Ve.status==="parsing"?Ve.reloadCallback=ye:Ve.status==="done"&&(Ve.vectorTile?Ve.parse(Ve.vectorTile,this.layerIndex,this.availableImages,this.actor,ye):ye())}},ke.prototype.abortTile=function(te,oe){var le=this.loading,ge=te.uid;le&&le[ge]&&le[ge].abort&&(le[ge].abort(),delete le[ge]),oe()},ke.prototype.removeTile=function(te,oe){var le=this.loaded,ge=te.uid;le&&le[ge]&&delete le[ge],oe()};var We=f.window.ImageBitmap,je=function(){this.loaded={}};function yt(te,oe){if(te.length!==0){Ne(te[0],oe);for(var le=1;le<te.length;le++)Ne(te[le],!oe)}}function Ne(te,oe){for(var le=0,ge=0,Se=te.length,Oe=Se-1;ge<Se;Oe=ge++)le+=(te[ge][0]-te[Oe][0])*(te[Oe][1]+te[ge][1]);le>=0!=!!oe&&te.reverse()}je.prototype.loadTile=function(te,oe){var le=te.uid,ge=te.encoding,Se=te.rawImageData,Oe=We&&Se instanceof We?this.getImageData(Se):Se,Ve=new f.DEMData(le,Oe,ge);this.loaded=this.loaded||{},this.loaded[le]=Ve,oe(null,Ve)},je.prototype.getImageData=function(te){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(te.width,te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=te.width,this.offscreenCanvas.height=te.height,this.offscreenCanvasContext.drawImage(te,0,0,te.width,te.height);var oe=this.offscreenCanvasContext.getImageData(-1,-1,te.width+2,te.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new f.RGBAImage({width:oe.width,height:oe.height},oe.data)},je.prototype.removeTile=function(te){var oe=this.loaded,le=te.uid;oe&&oe[le]&&delete oe[le]};var Ze=f.vectorTile.VectorTileFeature.prototype.toGeoJSON,vt=function(te){this._feature=te,this.extent=f.EXTENT,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))};vt.prototype.loadGeometry=function(){if(this._feature.type===1){for(var te=[],oe=0,le=this._feature.geometry;oe<le.length;oe+=1){var ge=le[oe];te.push([new f.Point$1(ge[0],ge[1])])}return te}for(var Se=[],Oe=0,Ve=this._feature.geometry;Oe<Ve.length;Oe+=1){for(var ye=[],Me=0,Qe=Ve[Oe];Me<Qe.length;Me+=1){var ae=Qe[Me];ye.push(new f.Point$1(ae[0],ae[1]))}Se.push(ye)}return Se},vt.prototype.toGeoJSON=function(te,oe,le){return Ze.call(this,te,oe,le)};var ct=function(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.EXTENT,this.length=te.length,this._features=te};ct.prototype.feature=function(te){return new vt(this._features[te])};var pt=f.vectorTile.VectorTileFeature,lt=fi;function fi(te,oe){this.options=oe||{},this.features=te,this.length=te.length}function Et(te,oe){this.id=typeof te.id=="number"?te.id:void 0,this.type=te.type,this.rawGeometry=te.type===1?[te.geometry]:te.geometry,this.properties=te.tags,this.extent=oe||4096}fi.prototype.feature=function(te){return new Et(this.features[te],this.options.extent)},Et.prototype.loadGeometry=function(){var te=this.rawGeometry;this.geometry=[];for(var oe=0;oe<te.length;oe++){for(var le=te[oe],ge=[],Se=0;Se<le.length;Se++)ge.push(new f.Point$1(le[Se][0],le[Se][1]));this.geometry.push(ge)}return this.geometry},Et.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var te=this.geometry,oe=1/0,le=-1/0,ge=1/0,Se=-1/0,Oe=0;Oe<te.length;Oe++)for(var Ve=te[Oe],ye=0;ye<Ve.length;ye++){var Me=Ve[ye];oe=Math.min(oe,Me.x),le=Math.max(le,Me.x),ge=Math.min(ge,Me.y),Se=Math.max(Se,Me.y)}return[oe,ge,le,Se]},Et.prototype.toGeoJSON=pt.prototype.toGeoJSON;var Wt=qi,Ei=lt;function qi(te){var oe=new f.pbf;return function(le,ge){for(var Se in le.layers)ge.writeMessage(3,Xt,le.layers[Se])}(te,oe),oe.finish()}function Xt(te,oe){var le;oe.writeVarintField(15,te.version||1),oe.writeStringField(1,te.name||""),oe.writeVarintField(5,te.extent||4096);var ge={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<te.length;le++)ge.feature=te.feature(le),oe.writeMessage(2,Qt,ge);var Se=ge.keys;for(le=0;le<Se.length;le++)oe.writeStringField(3,Se[le]);var Oe=ge.values;for(le=0;le<Oe.length;le++)oe.writeMessage(4,Ar,Oe[le])}function Qt(te,oe){var le=te.feature;le.id!==void 0&&oe.writeVarintField(1,le.id),oe.writeMessage(2,Ai,te),oe.writeVarintField(3,le.type),oe.writeMessage(4,mr,le)}function Ai(te,oe){var le=te.feature,ge=te.keys,Se=te.values,Oe=te.keycache,Ve=te.valuecache;for(var ye in le.properties){var Me=Oe[ye];Me===void 0&&(ge.push(ye),Oe[ye]=Me=ge.length-1),oe.writeVarint(Me);var Qe=le.properties[ye],ae=typeof Qe;ae!=="string"&&ae!=="boolean"&&ae!=="number"&&(Qe=JSON.stringify(Qe));var W=ae+":"+Qe,X=Ve[W];X===void 0&&(Se.push(Qe),Ve[W]=X=Se.length-1),oe.writeVarint(X)}}function bt(te,oe){return(oe<<3)+(7&te)}function Gi(te){return te<<1^te>>31}function mr(te,oe){for(var le=te.loadGeometry(),ge=te.type,Se=0,Oe=0,Ve=le.length,ye=0;ye<Ve;ye++){var Me=le[ye],Qe=1;ge===1&&(Qe=Me.length),oe.writeVarint(bt(1,Qe));for(var ae=ge===3?Me.length-1:Me.length,W=0;W<ae;W++){W===1&&ge!==1&&oe.writeVarint(bt(2,ae-1));var X=Me[W].x-Se,ne=Me[W].y-Oe;oe.writeVarint(Gi(X)),oe.writeVarint(Gi(ne)),Se+=X,Oe+=ne}ge===3&&oe.writeVarint(bt(7,1))}}function Ar(te,oe){var le=typeof te;le==="string"?oe.writeStringField(1,te):le==="boolean"?oe.writeBooleanField(7,te):le==="number"&&(te%1!=0?oe.writeDoubleField(3,te):te<0?oe.writeSVarintField(6,te):oe.writeVarintField(5,te))}function Rt(te,oe,le,ge){ai(te,le,ge),ai(oe,2*le,2*ge),ai(oe,2*le+1,2*ge+1)}function ai(te,oe,le){var ge=te[oe];te[oe]=te[le],te[le]=ge}function yi(te,oe,le,ge){var Se=te-le,Oe=oe-ge;return Se*Se+Oe*Oe}Wt.fromVectorTileJs=qi,Wt.fromGeojsonVt=function(te,oe){oe=oe||{};var le={};for(var ge in te)le[ge]=new lt(te[ge].features,oe),le[ge].name=ge,le[ge].version=oe.version,le[ge].extent=oe.extent;return qi({layers:le})},Wt.GeoJSONWrapper=Ei;var Fi=function(te){return te[0]},jt=function(te){return te[1]},Xi=function(te,oe,le,ge,Se){oe===void 0&&(oe=Fi),le===void 0&&(le=jt),ge===void 0&&(ge=64),Se===void 0&&(Se=Float64Array),this.nodeSize=ge,this.points=te;for(var Oe=te.length<65536?Uint16Array:Uint32Array,Ve=this.ids=new Oe(te.length),ye=this.coords=new Se(2*te.length),Me=0;Me<te.length;Me++)Ve[Me]=Me,ye[2*Me]=oe(te[Me]),ye[2*Me+1]=le(te[Me]);(function Qe(ae,W,X,ne,ce,_e){if(!(ce-ne<=X)){var fe=ne+ce>>1;(function Ee(we,Ie,et,Ke,tt,Ut){for(;tt>Ke;){if(tt-Ke>600){var At=tt-Ke+1,Ot=et-Ke+1,Vt=Math.log(At),Hi=.5*Math.exp(2*Vt/3),gi=.5*Math.sqrt(Vt*Hi*(At-Hi)/At)*(Ot-At/2<0?-1:1);Ee(we,Ie,et,Math.max(Ke,Math.floor(et-Ot*Hi/At+gi)),Math.min(tt,Math.floor(et+(At-Ot)*Hi/At+gi)),Ut)}var Ci=Ie[2*et+Ut],ci=Ke,Kt=tt;for(Rt(we,Ie,Ke,et),Ie[2*tt+Ut]>Ci&&Rt(we,Ie,Ke,tt);ci<Kt;){for(Rt(we,Ie,ci,Kt),ci++,Kt--;Ie[2*ci+Ut]<Ci;)ci++;for(;Ie[2*Kt+Ut]>Ci;)Kt--}Ie[2*Ke+Ut]===Ci?Rt(we,Ie,Ke,Kt):Rt(we,Ie,++Kt,tt),Kt<=et&&(Ke=Kt+1),et<=Kt&&(tt=Kt-1)}})(ae,W,fe,ne,ce,_e%2),Qe(ae,W,X,ne,fe-1,_e+1),Qe(ae,W,X,fe+1,ce,_e+1)}})(Ve,ye,ge,0,Ve.length-1,0)};Xi.prototype.range=function(te,oe,le,ge){return function(Se,Oe,Ve,ye,Me,Qe,ae){for(var W,X,ne=[0,Se.length-1,0],ce=[];ne.length;){var _e=ne.pop(),fe=ne.pop(),Ee=ne.pop();if(fe-Ee<=ae)for(var we=Ee;we<=fe;we++)X=Oe[2*we+1],(W=Oe[2*we])>=Ve&&W<=Me&&X>=ye&&X<=Qe&&ce.push(Se[we]);else{var Ie=Math.floor((Ee+fe)/2);X=Oe[2*Ie+1],(W=Oe[2*Ie])>=Ve&&W<=Me&&X>=ye&&X<=Qe&&ce.push(Se[Ie]);var et=(_e+1)%2;(_e===0?Ve<=W:ye<=X)&&(ne.push(Ee),ne.push(Ie-1),ne.push(et)),(_e===0?Me>=W:Qe>=X)&&(ne.push(Ie+1),ne.push(fe),ne.push(et))}}return ce}(this.ids,this.coords,te,oe,le,ge,this.nodeSize)},Xi.prototype.within=function(te,oe,le){return function(ge,Se,Oe,Ve,ye,Me){for(var Qe=[0,ge.length-1,0],ae=[],W=ye*ye;Qe.length;){var X=Qe.pop(),ne=Qe.pop(),ce=Qe.pop();if(ne-ce<=Me)for(var _e=ce;_e<=ne;_e++)yi(Se[2*_e],Se[2*_e+1],Oe,Ve)<=W&&ae.push(ge[_e]);else{var fe=Math.floor((ce+ne)/2),Ee=Se[2*fe],we=Se[2*fe+1];yi(Ee,we,Oe,Ve)<=W&&ae.push(ge[fe]);var Ie=(X+1)%2;(X===0?Oe-ye<=Ee:Ve-ye<=we)&&(Qe.push(ce),Qe.push(fe-1),Qe.push(Ie)),(X===0?Oe+ye>=Ee:Ve+ye>=we)&&(Qe.push(fe+1),Qe.push(ne),Qe.push(Ie))}}return ae}(this.ids,this.coords,te,oe,le,this.nodeSize)};var Ri={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(te){return te}},Ii=function(te){this.options=_i(Object.create(Ri),te),this.trees=new Array(this.options.maxZoom+1)};function rr(te,oe,le,ge,Se){return{x:te,y:oe,zoom:1/0,id:le,parentId:-1,numPoints:ge,properties:Se}}function zi(te,oe){var le=te.geometry.coordinates,ge=le[1];return{x:Bt(le[0]),y:rt(ge),zoom:1/0,index:oe,parentId:-1}}function zt(te){return{type:"Feature",id:te.id,properties:tr(te),geometry:{type:"Point",coordinates:[(ge=te.x,360*(ge-.5)),(oe=te.y,le=(180-360*oe)*Math.PI/180,360*Math.atan(Math.exp(le))/Math.PI-90)]}};var oe,le,ge}function tr(te){var oe=te.numPoints,le=oe>=1e4?Math.round(oe/1e3)+"k":oe>=1e3?Math.round(oe/100)/10+"k":oe;return _i(_i({},te.properties),{cluster:!0,cluster_id:te.id,point_count:oe,point_count_abbreviated:le})}function Bt(te){return te/360+.5}function rt(te){var oe=Math.sin(te*Math.PI/180),le=.5-.25*Math.log((1+oe)/(1-oe))/Math.PI;return le<0?0:le>1?1:le}function _i(te,oe){for(var le in oe)te[le]=oe[le];return te}function ir(te){return te.x}function Pr(te){return te.y}function co(te,oe,le,ge,Se,Oe){var Ve=Se-le,ye=Oe-ge;if(Ve!==0||ye!==0){var Me=((te-le)*Ve+(oe-ge)*ye)/(Ve*Ve+ye*ye);Me>1?(le=Se,ge=Oe):Me>0&&(le+=Ve*Me,ge+=ye*Me)}return(Ve=te-le)*Ve+(ye=oe-ge)*ye}function Zn(te,oe,le,ge){var Se={id:te===void 0?null:te,type:oe,geometry:le,tags:ge,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Oe){var Ve=Oe.geometry,ye=Oe.type;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")Bo(Oe,Ve);else if(ye==="Polygon"||ye==="MultiLineString")for(var Me=0;Me<Ve.length;Me++)Bo(Oe,Ve[Me]);else if(ye==="MultiPolygon")for(Me=0;Me<Ve.length;Me++)for(var Qe=0;Qe<Ve[Me].length;Qe++)Bo(Oe,Ve[Me][Qe])}(Se),Se}function Bo(te,oe){for(var le=0;le<oe.length;le+=3)te.minX=Math.min(te.minX,oe[le]),te.minY=Math.min(te.minY,oe[le+1]),te.maxX=Math.max(te.maxX,oe[le]),te.maxY=Math.max(te.maxY,oe[le+1])}function _n(te,oe,le,ge){if(oe.geometry){var Se=oe.geometry.coordinates,Oe=oe.geometry.type,Ve=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),ye=[],Me=oe.id;if(le.promoteId?Me=oe.properties[le.promoteId]:le.generateId&&(Me=ge||0),Oe==="Point")ho(Se,ye);else if(Oe==="MultiPoint")for(var Qe=0;Qe<Se.length;Qe++)ho(Se[Qe],ye);else if(Oe==="LineString")Hn(Se,ye,Ve,!1);else if(Oe==="MultiLineString"){if(le.lineMetrics){for(Qe=0;Qe<Se.length;Qe++)Hn(Se[Qe],ye=[],Ve,!1),te.push(Zn(Me,"LineString",ye,oe.properties));return}Zi(Se,ye,Ve,!1)}else if(Oe==="Polygon")Zi(Se,ye,Ve,!0);else{if(Oe!=="MultiPolygon"){if(Oe==="GeometryCollection"){for(Qe=0;Qe<oe.geometry.geometries.length;Qe++)_n(te,{id:Me,geometry:oe.geometry.geometries[Qe],properties:oe.properties},le,ge);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Qe=0;Qe<Se.length;Qe++){var ae=[];Zi(Se[Qe],ae,Ve,!0),ye.push(ae)}}te.push(Zn(Me,Oe,ye,oe.properties))}}function ho(te,oe){oe.push(Un(te[0])),oe.push(Ao(te[1])),oe.push(0)}function Hn(te,oe,le,ge){for(var Se,Oe,Ve=0,ye=0;ye<te.length;ye++){var Me=Un(te[ye][0]),Qe=Ao(te[ye][1]);oe.push(Me),oe.push(Qe),oe.push(0),ye>0&&(Ve+=ge?(Se*Qe-Me*Oe)/2:Math.sqrt(Math.pow(Me-Se,2)+Math.pow(Qe-Oe,2))),Se=Me,Oe=Qe}var ae=oe.length-3;oe[2]=1,function W(X,ne,ce,_e){for(var fe,Ee=_e,we=ce-ne>>1,Ie=ce-ne,et=X[ne],Ke=X[ne+1],tt=X[ce],Ut=X[ce+1],At=ne+3;At<ce;At+=3){var Ot=co(X[At],X[At+1],et,Ke,tt,Ut);if(Ot>Ee)fe=At,Ee=Ot;else if(Ot===Ee){var Vt=Math.abs(At-we);Vt<Ie&&(fe=At,Ie=Vt)}}Ee>_e&&(fe-ne>3&&W(X,ne,fe,_e),X[fe+2]=Ee,ce-fe>3&&W(X,fe,ce,_e))}(oe,0,ae,le),oe[ae+2]=1,oe.size=Math.abs(Ve),oe.start=0,oe.end=oe.size}function Zi(te,oe,le,ge){for(var Se=0;Se<te.length;Se++){var Oe=[];Hn(te[Se],Oe,le,ge),oe.push(Oe)}}function Un(te){return te/360+.5}function Ao(te){var oe=Math.sin(te*Math.PI/180),le=.5-.25*Math.log((1+oe)/(1-oe))/Math.PI;return le<0?0:le>1?1:le}function Wn(te,oe,le,ge,Se,Oe,Ve,ye){if(ge/=oe,Oe>=(le/=oe)&&Ve<ge)return te;if(Ve<le||Oe>=ge)return null;for(var Me=[],Qe=0;Qe<te.length;Qe++){var ae=te[Qe],W=ae.geometry,X=ae.type,ne=Se===0?ae.minX:ae.minY,ce=Se===0?ae.maxX:ae.maxY;if(ne>=le&&ce<ge)Me.push(ae);else if(!(ce<le||ne>=ge)){var _e=[];if(X==="Point"||X==="MultiPoint")Ba(W,_e,le,ge,Se);else if(X==="LineString")Ue(W,_e,le,ge,Se,!1,ye.lineMetrics);else if(X==="MultiLineString")Si(W,_e,le,ge,Se,!1);else if(X==="Polygon")Si(W,_e,le,ge,Se,!0);else if(X==="MultiPolygon")for(var fe=0;fe<W.length;fe++){var Ee=[];Si(W[fe],Ee,le,ge,Se,!0),Ee.length&&_e.push(Ee)}if(_e.length){if(ye.lineMetrics&&X==="LineString"){for(fe=0;fe<_e.length;fe++)Me.push(Zn(ae.id,X,_e[fe],ae.tags));continue}X!=="LineString"&&X!=="MultiLineString"||(_e.length===1?(X="LineString",_e=_e[0]):X="MultiLineString"),X!=="Point"&&X!=="MultiPoint"||(X=_e.length===3?"Point":"MultiPoint"),Me.push(Zn(ae.id,X,_e,ae.tags))}}}return Me.length?Me:null}function Ba(te,oe,le,ge,Se){for(var Oe=0;Oe<te.length;Oe+=3){var Ve=te[Oe+Se];Ve>=le&&Ve<=ge&&(oe.push(te[Oe]),oe.push(te[Oe+1]),oe.push(te[Oe+2]))}}function Ue(te,oe,le,ge,Se,Oe,Ve){for(var ye,Me,Qe=gt(te),ae=Se===0?br:Xn,W=te.start,X=0;X<te.length-3;X+=3){var ne=te[X],ce=te[X+1],_e=te[X+2],fe=te[X+3],Ee=te[X+4],we=Se===0?ne:ce,Ie=Se===0?fe:Ee,et=!1;Ve&&(ye=Math.sqrt(Math.pow(ne-fe,2)+Math.pow(ce-Ee,2))),we<le?Ie>le&&(Me=ae(Qe,ne,ce,fe,Ee,le),Ve&&(Qe.start=W+ye*Me)):we>ge?Ie<ge&&(Me=ae(Qe,ne,ce,fe,Ee,ge),Ve&&(Qe.start=W+ye*Me)):yr(Qe,ne,ce,_e),Ie<le&&we>=le&&(Me=ae(Qe,ne,ce,fe,Ee,le),et=!0),Ie>ge&&we<=ge&&(Me=ae(Qe,ne,ce,fe,Ee,ge),et=!0),!Oe&&et&&(Ve&&(Qe.end=W+ye*Me),oe.push(Qe),Qe=gt(te)),Ve&&(W+=ye)}var Ke=te.length-3;ne=te[Ke],ce=te[Ke+1],_e=te[Ke+2],(we=Se===0?ne:ce)>=le&&we<=ge&&yr(Qe,ne,ce,_e),Ke=Qe.length-3,Oe&&Ke>=3&&(Qe[Ke]!==Qe[0]||Qe[Ke+1]!==Qe[1])&&yr(Qe,Qe[0],Qe[1],Qe[2]),Qe.length&&oe.push(Qe)}function gt(te){var oe=[];return oe.size=te.size,oe.start=te.start,oe.end=te.end,oe}function Si(te,oe,le,ge,Se,Oe){for(var Ve=0;Ve<te.length;Ve++)Ue(te[Ve],oe,le,ge,Se,Oe,!1)}function yr(te,oe,le,ge){te.push(oe),te.push(le),te.push(ge)}function br(te,oe,le,ge,Se,Oe){var Ve=(Oe-oe)/(ge-oe);return te.push(Oe),te.push(le+(Se-le)*Ve),te.push(1),Ve}function Xn(te,oe,le,ge,Se,Oe){var Ve=(Oe-le)/(Se-le);return te.push(oe+(ge-oe)*Ve),te.push(Oe),te.push(1),Ve}function Kn(te,oe){for(var le=[],ge=0;ge<te.length;ge++){var Se,Oe=te[ge],Ve=Oe.type;if(Ve==="Point"||Ve==="MultiPoint"||Ve==="LineString")Se=na(Oe.geometry,oe);else if(Ve==="MultiLineString"||Ve==="Polygon"){Se=[];for(var ye=0;ye<Oe.geometry.length;ye++)Se.push(na(Oe.geometry[ye],oe))}else if(Ve==="MultiPolygon")for(Se=[],ye=0;ye<Oe.geometry.length;ye++){for(var Me=[],Qe=0;Qe<Oe.geometry[ye].length;Qe++)Me.push(na(Oe.geometry[ye][Qe],oe));Se.push(Me)}le.push(Zn(Oe.id,Ve,Se,Oe.tags))}return le}function na(te,oe){var le=[];le.size=te.size,te.start!==void 0&&(le.start=te.start,le.end=te.end);for(var ge=0;ge<te.length;ge+=3)le.push(te[ge]+oe,te[ge+1],te[ge+2]);return le}function Yr(te,oe){if(te.transformed)return te;var le,ge,Se,Oe=1<<te.z,Ve=te.x,ye=te.y;for(le=0;le<te.features.length;le++){var Me=te.features[le],Qe=Me.geometry,ae=Me.type;if(Me.geometry=[],ae===1)for(ge=0;ge<Qe.length;ge+=2)Me.geometry.push(Ht(Qe[ge],Qe[ge+1],oe,Oe,Ve,ye));else for(ge=0;ge<Qe.length;ge++){var W=[];for(Se=0;Se<Qe[ge].length;Se+=2)W.push(Ht(Qe[ge][Se],Qe[ge][Se+1],oe,Oe,Ve,ye));Me.geometry.push(W)}}return te.transformed=!0,te}function Ht(te,oe,le,ge,Se,Oe){return[Math.round(le*(te*ge-Se)),Math.round(le*(oe*ge-Oe))]}function nr(te,oe,le,ge,Se){for(var Oe=oe===Se.maxZoom?0:Se.tolerance/((1<<oe)*Se.extent),Ve={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:ge,z:oe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ye=0;ye<te.length;ye++){Ve.numFeatures++,Ki(Ve,te[ye],Oe,Se);var Me=te[ye].minX,Qe=te[ye].minY,ae=te[ye].maxX,W=te[ye].maxY;Me<Ve.minX&&(Ve.minX=Me),Qe<Ve.minY&&(Ve.minY=Qe),ae>Ve.maxX&&(Ve.maxX=ae),W>Ve.maxY&&(Ve.maxY=W)}return Ve}function Ki(te,oe,le,ge){var Se=oe.geometry,Oe=oe.type,Ve=[];if(Oe==="Point"||Oe==="MultiPoint")for(var ye=0;ye<Se.length;ye+=3)Ve.push(Se[ye]),Ve.push(Se[ye+1]),te.numPoints++,te.numSimplified++;else if(Oe==="LineString")Dn(Ve,Se,te,le,!1,!1);else if(Oe==="MultiLineString"||Oe==="Polygon")for(ye=0;ye<Se.length;ye++)Dn(Ve,Se[ye],te,le,Oe==="Polygon",ye===0);else if(Oe==="MultiPolygon")for(var Me=0;Me<Se.length;Me++){var Qe=Se[Me];for(ye=0;ye<Qe.length;ye++)Dn(Ve,Qe[ye],te,le,!0,ye===0)}if(Ve.length){var ae=oe.tags||null;if(Oe==="LineString"&&ge.lineMetrics){for(var W in ae={},oe.tags)ae[W]=oe.tags[W];ae.mapbox_clip_start=Se.start/Se.size,ae.mapbox_clip_end=Se.end/Se.size}var X={geometry:Ve,type:Oe==="Polygon"||Oe==="MultiPolygon"?3:Oe==="LineString"||Oe==="MultiLineString"?2:1,tags:ae};oe.id!==null&&(X.id=oe.id),te.features.push(X)}}function Dn(te,oe,le,ge,Se,Oe){var Ve=ge*ge;if(ge>0&&oe.size<(Se?Ve:ge))le.numPoints+=oe.length/3;else{for(var ye=[],Me=0;Me<oe.length;Me+=3)(ge===0||oe[Me+2]>Ve)&&(le.numSimplified++,ye.push(oe[Me]),ye.push(oe[Me+1])),le.numPoints++;Se&&function(Qe,ae){for(var W=0,X=0,ne=Qe.length,ce=ne-2;X<ne;ce=X,X+=2)W+=(Qe[X]-Qe[ce])*(Qe[X+1]+Qe[ce+1]);if(W>0===ae)for(X=0,ne=Qe.length;X<ne/2;X+=2){var _e=Qe[X],fe=Qe[X+1];Qe[X]=Qe[ne-2-X],Qe[X+1]=Qe[ne-1-X],Qe[ne-2-X]=_e,Qe[ne-1-X]=fe}}(ye,Oe),te.push(ye)}}function Jn(te,oe){var le=(oe=this.options=function(Se,Oe){for(var Ve in Oe)Se[Ve]=Oe[Ve];return Se}(Object.create(this.options),oe)).debug;if(le&&console.time("preprocess data"),oe.maxZoom<0||oe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(oe.promoteId&&oe.generateId)throw new Error("promoteId and generateId cannot be used together.");var ge=function(Se,Oe){var Ve=[];if(Se.type==="FeatureCollection")for(var ye=0;ye<Se.features.length;ye++)_n(Ve,Se.features[ye],Oe,ye);else _n(Ve,Se.type==="Feature"?Se:{geometry:Se},Oe);return Ve}(te,oe);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",oe.indexMaxZoom,oe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ge=function(Se,Oe){var Ve=Oe.buffer/Oe.extent,ye=Se,Me=Wn(Se,1,-1-Ve,Ve,0,-1,2,Oe),Qe=Wn(Se,1,1-Ve,2+Ve,0,-1,2,Oe);return(Me||Qe)&&(ye=Wn(Se,1,-Ve,1+Ve,0,-1,2,Oe)||[],Me&&(ye=Kn(Me,1).concat(ye)),Qe&&(ye=ye.concat(Kn(Qe,-1)))),ye}(ge,oe)).length&&this.splitTile(ge,0,0,0),le&&(ge.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ni(te,oe,le){return 32*((1<<te)*le+oe)+te}function ya(te,oe){var le=te.tileID.canonical;if(!this._geoJSONIndex)return oe(null,null);var ge=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!ge)return oe(null,null);var Se=new ct(ge.features),Oe=Wt(Se);Oe.byteOffset===0&&Oe.byteLength===Oe.buffer.byteLength||(Oe=new Uint8Array(Oe)),oe(null,{vectorTile:Se,rawData:Oe.buffer})}Ii.prototype.load=function(te){var oe=this.options,le=oe.log,ge=oe.minZoom,Se=oe.maxZoom,Oe=oe.nodeSize;le&&console.time("total time");var Ve="prepare "+te.length+" points";le&&console.time(Ve),this.points=te;for(var ye=[],Me=0;Me<te.length;Me++)te[Me].geometry&&ye.push(zi(te[Me],Me));this.trees[Se+1]=new Xi(ye,ir,Pr,Oe,Float32Array),le&&console.timeEnd(Ve);for(var Qe=Se;Qe>=ge;Qe--){var ae=+Date.now();ye=this._cluster(ye,Qe),this.trees[Qe]=new Xi(ye,ir,Pr,Oe,Float32Array),le&&console.log("z%d: %d clusters in %dms",Qe,ye.length,+Date.now()-ae)}return le&&console.timeEnd("total time"),this},Ii.prototype.getClusters=function(te,oe){var le=((te[0]+180)%360+360)%360-180,ge=Math.max(-90,Math.min(90,te[1])),Se=te[2]===180?180:((te[2]+180)%360+360)%360-180,Oe=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)le=-180,Se=180;else if(le>Se){var Ve=this.getClusters([le,ge,180,Oe],oe),ye=this.getClusters([-180,ge,Se,Oe],oe);return Ve.concat(ye)}for(var Me=this.trees[this._limitZoom(oe)],Qe=[],ae=0,W=Me.range(Bt(le),rt(Oe),Bt(Se),rt(ge));ae<W.length;ae+=1){var X=Me.points[W[ae]];Qe.push(X.numPoints?zt(X):this.points[X.index])}return Qe},Ii.prototype.getChildren=function(te){var oe=this._getOriginId(te),le=this._getOriginZoom(te),ge="No cluster with the specified id.",Se=this.trees[le];if(!Se)throw new Error(ge);var Oe=Se.points[oe];if(!Oe)throw new Error(ge);for(var Ve=this.options.radius/(this.options.extent*Math.pow(2,le-1)),ye=[],Me=0,Qe=Se.within(Oe.x,Oe.y,Ve);Me<Qe.length;Me+=1){var ae=Se.points[Qe[Me]];ae.parentId===te&&ye.push(ae.numPoints?zt(ae):this.points[ae.index])}if(ye.length===0)throw new Error(ge);return ye},Ii.prototype.getLeaves=function(te,oe,le){var ge=[];return this._appendLeaves(ge,te,oe=oe||10,le=le||0,0),ge},Ii.prototype.getTile=function(te,oe,le){var ge=this.trees[this._limitZoom(te)],Se=Math.pow(2,te),Oe=this.options,Ve=Oe.radius/Oe.extent,ye=(le-Ve)/Se,Me=(le+1+Ve)/Se,Qe={features:[]};return this._addTileFeatures(ge.range((oe-Ve)/Se,ye,(oe+1+Ve)/Se,Me),ge.points,oe,le,Se,Qe),oe===0&&this._addTileFeatures(ge.range(1-Ve/Se,ye,1,Me),ge.points,Se,le,Se,Qe),oe===Se-1&&this._addTileFeatures(ge.range(0,ye,Ve/Se,Me),ge.points,-1,le,Se,Qe),Qe.features.length?Qe:null},Ii.prototype.getClusterExpansionZoom=function(te){for(var oe=this._getOriginZoom(te)-1;oe<=this.options.maxZoom;){var le=this.getChildren(te);if(oe++,le.length!==1)break;te=le[0].properties.cluster_id}return oe},Ii.prototype._appendLeaves=function(te,oe,le,ge,Se){for(var Oe=0,Ve=this.getChildren(oe);Oe<Ve.length;Oe+=1){var ye=Ve[Oe],Me=ye.properties;if(Me&&Me.cluster?Se+Me.point_count<=ge?Se+=Me.point_count:Se=this._appendLeaves(te,Me.cluster_id,le,ge,Se):Se<ge?Se++:te.push(ye),te.length===le)break}return Se},Ii.prototype._addTileFeatures=function(te,oe,le,ge,Se,Oe){for(var Ve=0,ye=te;Ve<ye.length;Ve+=1){var Me=oe[ye[Ve]],Qe=Me.numPoints,ae={type:1,geometry:[[Math.round(this.options.extent*(Me.x*Se-le)),Math.round(this.options.extent*(Me.y*Se-ge))]],tags:Qe?tr(Me):this.points[Me.index].properties},W=void 0;Qe?W=Me.id:this.options.generateId?W=Me.index:this.points[Me.index].id&&(W=this.points[Me.index].id),W!==void 0&&(ae.id=W),Oe.features.push(ae)}},Ii.prototype._limitZoom=function(te){return Math.max(this.options.minZoom,Math.min(+te,this.options.maxZoom+1))},Ii.prototype._cluster=function(te,oe){for(var le=[],ge=this.options,Se=ge.reduce,Oe=ge.minPoints,Ve=ge.radius/(ge.extent*Math.pow(2,oe)),ye=0;ye<te.length;ye++){var Me=te[ye];if(!(Me.zoom<=oe)){Me.zoom=oe;for(var Qe=this.trees[oe+1],ae=Qe.within(Me.x,Me.y,Ve),W=Me.numPoints||1,X=W,ne=0,ce=ae;ne<ce.length;ne+=1){var _e=Qe.points[ce[ne]];_e.zoom>oe&&(X+=_e.numPoints||1)}if(X>=Oe){for(var fe=Me.x*W,Ee=Me.y*W,we=Se&&W>1?this._map(Me,!0):null,Ie=(ye<<5)+(oe+1)+this.points.length,et=0,Ke=ae;et<Ke.length;et+=1){var tt=Qe.points[Ke[et]];if(!(tt.zoom<=oe)){tt.zoom=oe;var Ut=tt.numPoints||1;fe+=tt.x*Ut,Ee+=tt.y*Ut,tt.parentId=Ie,Se&&(we||(we=this._map(Me,!0)),Se(we,this._map(tt)))}}Me.parentId=Ie,le.push(rr(fe/X,Ee/X,Ie,X,we))}else if(le.push(Me),X>1)for(var At=0,Ot=ae;At<Ot.length;At+=1){var Vt=Qe.points[Ot[At]];Vt.zoom<=oe||(Vt.zoom=oe,le.push(Vt))}}}return le},Ii.prototype._getOriginId=function(te){return te-this.points.length>>5},Ii.prototype._getOriginZoom=function(te){return(te-this.points.length)%32},Ii.prototype._map=function(te,oe){if(te.numPoints)return oe?_i({},te.properties):te.properties;var le=this.points[te.index].properties,ge=this.options.map(le);return oe&&ge===le?_i({},ge):ge},Jn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Jn.prototype.splitTile=function(te,oe,le,ge,Se,Oe,Ve){for(var ye=[te,oe,le,ge],Me=this.options,Qe=Me.debug;ye.length;){ge=ye.pop(),le=ye.pop(),oe=ye.pop(),te=ye.pop();var ae=1<<oe,W=Ni(oe,le,ge),X=this.tiles[W];if(!X&&(Qe>1&&console.time("creation"),X=this.tiles[W]=nr(te,oe,le,ge,Me),this.tileCoords.push({z:oe,x:le,y:ge}),Qe)){Qe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",oe,le,ge,X.numFeatures,X.numPoints,X.numSimplified),console.timeEnd("creation"));var ne="z"+oe;this.stats[ne]=(this.stats[ne]||0)+1,this.total++}if(X.source=te,Se){if(oe===Me.maxZoom||oe===Se)continue;var ce=1<<Se-oe;if(le!==Math.floor(Oe/ce)||ge!==Math.floor(Ve/ce))continue}else if(oe===Me.indexMaxZoom||X.numPoints<=Me.indexMaxPoints)continue;if(X.source=null,te.length!==0){Qe>1&&console.time("clipping");var _e,fe,Ee,we,Ie,et,Ke=.5*Me.buffer/Me.extent,tt=.5-Ke,Ut=.5+Ke,At=1+Ke;_e=fe=Ee=we=null,Ie=Wn(te,ae,le-Ke,le+Ut,0,X.minX,X.maxX,Me),et=Wn(te,ae,le+tt,le+At,0,X.minX,X.maxX,Me),te=null,Ie&&(_e=Wn(Ie,ae,ge-Ke,ge+Ut,1,X.minY,X.maxY,Me),fe=Wn(Ie,ae,ge+tt,ge+At,1,X.minY,X.maxY,Me),Ie=null),et&&(Ee=Wn(et,ae,ge-Ke,ge+Ut,1,X.minY,X.maxY,Me),we=Wn(et,ae,ge+tt,ge+At,1,X.minY,X.maxY,Me),et=null),Qe>1&&console.timeEnd("clipping"),ye.push(_e||[],oe+1,2*le,2*ge),ye.push(fe||[],oe+1,2*le,2*ge+1),ye.push(Ee||[],oe+1,2*le+1,2*ge),ye.push(we||[],oe+1,2*le+1,2*ge+1)}}},Jn.prototype.getTile=function(te,oe,le){var ge=this.options,Se=ge.extent,Oe=ge.debug;if(te<0||te>24)return null;var Ve=1<<te,ye=Ni(te,oe=(oe%Ve+Ve)%Ve,le);if(this.tiles[ye])return Yr(this.tiles[ye],Se);Oe>1&&console.log("drilling down to z%d-%d-%d",te,oe,le);for(var Me,Qe=te,ae=oe,W=le;!Me&&Qe>0;)Qe--,ae=Math.floor(ae/2),W=Math.floor(W/2),Me=this.tiles[Ni(Qe,ae,W)];return Me&&Me.source?(Oe>1&&console.log("found parent tile z%d-%d-%d",Qe,ae,W),Oe>1&&console.time("drilling down"),this.splitTile(Me.source,Qe,ae,W,te,oe,le),Oe>1&&console.timeEnd("drilling down"),this.tiles[ye]?Yr(this.tiles[ye],Se):null):null};var Oo=function(te){function oe(le,ge,Se,Oe){te.call(this,le,ge,Se,ya),Oe&&(this.loadGeoJSON=Oe)}return te&&(oe.__proto__=te),(oe.prototype=Object.create(te&&te.prototype)).constructor=oe,oe.prototype.loadData=function(le,ge){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=ge,this._pendingLoadDataParams=le,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},oe.prototype._loadData=function(){var le=this;if(this._pendingCallback&&this._pendingLoadDataParams){var ge=this._pendingCallback,Se=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Oe=!!(Se&&Se.request&&Se.request.collectResourceTiming)&&new f.RequestPerformance(Se.request);this.loadGeoJSON(Se,function(Ve,ye){if(Ve||!ye)return ge(Ve);if(typeof ye!="object")return ge(new Error("Input data given to '"+Se.source+"' is not a valid GeoJSON object."));(function X(ne,ce){var _e,fe=ne&&ne.type;if(fe==="FeatureCollection")for(_e=0;_e<ne.features.length;_e++)X(ne.features[_e],ce);else if(fe==="GeometryCollection")for(_e=0;_e<ne.geometries.length;_e++)X(ne.geometries[_e],ce);else if(fe==="Feature")X(ne.geometry,ce);else if(fe==="Polygon")yt(ne.coordinates,ce);else if(fe==="MultiPolygon")for(_e=0;_e<ne.coordinates.length;_e++)yt(ne.coordinates[_e],ce);return ne})(ye,!0);try{if(Se.filter){var Me=f.createExpression(Se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Me.result==="error")throw new Error(Me.value.map(function(X){return X.key+": "+X.message}).join(", "));var Qe=ye.features.filter(function(X){return Me.value.evaluate({zoom:0},X)});ye={type:"FeatureCollection",features:Qe}}le._geoJSONIndex=Se.cluster?new Ii(function(X){var ne=X.superclusterOptions,ce=X.clusterProperties;if(!ce||!ne)return ne;for(var _e={},fe={},Ee={accumulated:null,zoom:0},we={properties:null},Ie=Object.keys(ce),et=0,Ke=Ie;et<Ke.length;et+=1){var tt=Ke[et],Ut=ce[tt],At=Ut[0],Ot=f.createExpression(Ut[1]),Vt=f.createExpression(typeof At=="string"?[At,["accumulated"],["get",tt]]:At);_e[tt]=Ot.value,fe[tt]=Vt.value}return ne.map=function(Hi){we.properties=Hi;for(var gi={},Ci=0,ci=Ie;Ci<ci.length;Ci+=1){var Kt=ci[Ci];gi[Kt]=_e[Kt].evaluate(Ee,we)}return gi},ne.reduce=function(Hi,gi){we.properties=gi;for(var Ci=0,ci=Ie;Ci<ci.length;Ci+=1){var Kt=ci[Ci];Ee.accumulated=Hi[Kt],Hi[Kt]=fe[Kt].evaluate(Ee,we)}},ne}(Se)).load(ye.features):function(X,ne){return new Jn(X,ne)}(ye,Se.geojsonVtOptions)}catch(X){return ge(X)}le.loaded={};var ae={};if(Oe){var W=Oe.finish();W&&(ae.resourceTiming={},ae.resourceTiming[Se.source]=JSON.parse(JSON.stringify(W)))}ge(null,ae)})}},oe.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},oe.prototype.reloadTile=function(le,ge){var Se=this.loaded;return Se&&Se[le.uid]?te.prototype.reloadTile.call(this,le,ge):this.loadTile(le,ge)},oe.prototype.loadGeoJSON=function(le,ge){if(le.request)f.getJSON(le.request,ge);else{if(typeof le.data!="string")return ge(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."));try{return ge(null,JSON.parse(le.data))}catch{return ge(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."))}}},oe.prototype.removeSource=function(le,ge){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ge()},oe.prototype.getClusterExpansionZoom=function(le,ge){try{ge(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(Se){ge(Se)}},oe.prototype.getClusterChildren=function(le,ge){try{ge(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(Se){ge(Se)}},oe.prototype.getClusterLeaves=function(le,ge){try{ge(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(Se){ge(Se)}},oe}(ke),Xr=function(te){var oe=this;this.self=te,this.actor=new f.Actor(te,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ke,geojson:Oo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(le,ge){if(oe.workerSourceTypes[le])throw new Error('Worker source with name "'+le+'" already registered.');oe.workerSourceTypes[le]=ge},this.self.registerRTLTextPlugin=function(le){if(f.plugin.isParsed())throw new Error("RTL text plugin already registered.");f.plugin.applyArabicShaping=le.applyArabicShaping,f.plugin.processBidirectionalText=le.processBidirectionalText,f.plugin.processStyledBidirectionalText=le.processStyledBidirectionalText}};return Xr.prototype.setReferrer=function(te,oe){this.referrer=oe},Xr.prototype.setImages=function(te,oe,le){for(var ge in this.availableImages[te]=oe,this.workerSources[te]){var Se=this.workerSources[te][ge];for(var Oe in Se)Se[Oe].availableImages=oe}le()},Xr.prototype.setLayers=function(te,oe,le){this.getLayerIndex(te).replace(oe),le()},Xr.prototype.updateLayers=function(te,oe,le){this.getLayerIndex(te).update(oe.layers,oe.removedIds),le()},Xr.prototype.loadTile=function(te,oe,le){this.getWorkerSource(te,oe.type,oe.source).loadTile(oe,le)},Xr.prototype.loadDEMTile=function(te,oe,le){this.getDEMWorkerSource(te,oe.source).loadTile(oe,le)},Xr.prototype.reloadTile=function(te,oe,le){this.getWorkerSource(te,oe.type,oe.source).reloadTile(oe,le)},Xr.prototype.abortTile=function(te,oe,le){this.getWorkerSource(te,oe.type,oe.source).abortTile(oe,le)},Xr.prototype.removeTile=function(te,oe,le){this.getWorkerSource(te,oe.type,oe.source).removeTile(oe,le)},Xr.prototype.removeDEMTile=function(te,oe){this.getDEMWorkerSource(te,oe.source).removeTile(oe)},Xr.prototype.removeSource=function(te,oe,le){if(this.workerSources[te]&&this.workerSources[te][oe.type]&&this.workerSources[te][oe.type][oe.source]){var ge=this.workerSources[te][oe.type][oe.source];delete this.workerSources[te][oe.type][oe.source],ge.removeSource!==void 0?ge.removeSource(oe,le):le()}},Xr.prototype.loadWorkerSource=function(te,oe,le){try{this.self.importScripts(oe.url),le()}catch(ge){le(ge.toString())}},Xr.prototype.syncRTLPluginState=function(te,oe,le){try{f.plugin.setState(oe);var ge=f.plugin.getPluginURL();if(f.plugin.isLoaded()&&!f.plugin.isParsed()&&ge!=null){this.self.importScripts(ge);var Se=f.plugin.isParsed();le(Se?void 0:new Error("RTL Text Plugin failed to import scripts from "+ge),Se)}}catch(Oe){le(Oe.toString())}},Xr.prototype.getAvailableImages=function(te){var oe=this.availableImages[te];return oe||(oe=[]),oe},Xr.prototype.getLayerIndex=function(te){var oe=this.layerIndexes[te];return oe||(oe=this.layerIndexes[te]=new N),oe},Xr.prototype.getWorkerSource=function(te,oe,le){var ge=this;return this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][oe]||(this.workerSources[te][oe]={}),this.workerSources[te][oe][le]||(this.workerSources[te][oe][le]=new this.workerSourceTypes[oe]({send:function(Se,Oe,Ve){ge.actor.send(Se,Oe,Ve,te)}},this.getLayerIndex(te),this.getAvailableImages(te))),this.workerSources[te][oe][le]},Xr.prototype.getDEMWorkerSource=function(te,oe){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][oe]||(this.demWorkerSources[te][oe]=new je),this.demWorkerSources[te][oe]},Xr.prototype.enforceCacheSizeLimit=function(te,oe){f.enforceCacheSizeLimit(oe)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Xr(self)),Xr}),z(["./shared"],function(f){var h=f.createCommonjsModule(function(c){function m(k){return!d(k)}function d(k){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var B,q,$=new Blob([""],{type:"text/javascript"}),ie=URL.createObjectURL($);try{q=new Worker(ie),B=!0}catch{B=!1}return q&&q.terminate(),URL.revokeObjectURL(ie),B}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var B=document.createElement("canvas");B.width=B.height=1;var q=B.getContext("2d");if(!q)return!1;var $=q.getImageData(0,0,1,1);return $&&$.width===B.width}()?(x[L=k&&k.failIfMajorPerformanceCaveat]===void 0&&(x[L]=function(B){var q=function(ie){var he=document.createElement("canvas"),de=Object.create(m.webGLContextAttributes);return de.failIfMajorPerformanceCaveat=ie,he.probablySupportsContext?he.probablySupportsContext("webgl",de)||he.probablySupportsContext("experimental-webgl",de):he.supportsContext?he.supportsContext("webgl",de)||he.supportsContext("experimental-webgl",de):he.getContext("webgl",de)||he.getContext("experimental-webgl",de)}(B);if(!q)return!1;var $=q.createShader(q.VERTEX_SHADER);return!(!$||q.isContextLost())&&(q.shaderSource($,"void main() {}"),q.compileShader($),q.getShaderParameter($,q.COMPILE_STATUS)===!0)}(L)),x[L]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var L}c.exports?c.exports=m:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=m,window.mapboxgl.notSupportedReason=d);var x={};m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),D={create:function(c,m,d){var x=f.window.document.createElement(c);return m!==void 0&&(x.className=m),d&&d.appendChild(x),x},createNS:function(c,m){return f.window.document.createElementNS(c,m)}},N=f.window.document&&f.window.document.documentElement.style;function F(c){if(!N)return c[0];for(var m=0;m<c.length;m++)if(c[m]in N)return c[m];return c[0]}var G,H=F(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);D.disableDrag=function(){N&&H&&(G=N[H],N[H]="none")},D.enableDrag=function(){N&&H&&(N[H]=G)};var Pe=F(["transform","WebkitTransform"]);D.setTransform=function(c,m){c.style[Pe]=m};var ke=!1;try{var We=Object.defineProperty({},"passive",{get:function(){ke=!0}});f.window.addEventListener("test",We,We),f.window.removeEventListener("test",We,We)}catch{ke=!1}D.addEventListener=function(c,m,d,x){x===void 0&&(x={}),c.addEventListener(m,d,"passive"in x&&ke?x:x.capture)},D.removeEventListener=function(c,m,d,x){x===void 0&&(x={}),c.removeEventListener(m,d,"passive"in x&&ke?x:x.capture)};var je=function(c){c.preventDefault(),c.stopPropagation(),f.window.removeEventListener("click",je,!0)};function yt(c){var m=c.userImage;return!!(m&&m.render&&m.render())&&(c.data.replace(new Uint8Array(m.data.buffer)),!0)}D.suppressClick=function(){f.window.addEventListener("click",je,!0),f.window.setTimeout(function(){f.window.removeEventListener("click",je,!0)},0)},D.mousePos=function(c,m){var d=c.getBoundingClientRect();return new f.Point(m.clientX-d.left-c.clientLeft,m.clientY-d.top-c.clientTop)},D.touchPos=function(c,m){for(var d=c.getBoundingClientRect(),x=[],k=0;k<m.length;k++)x.push(new f.Point(m[k].clientX-d.left-c.clientLeft,m[k].clientY-d.top-c.clientTop));return x},D.mouseButton=function(c){return f.window.InstallTrigger!==void 0&&c.button===2&&c.ctrlKey&&f.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:c.button},D.remove=function(c){c.parentNode&&c.parentNode.removeChild(c)};var Ne=function(c){function m(){c.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new f.RGBAImage({width:1,height:1}),this.dirty=!0}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.isLoaded=function(){return this.loaded},m.prototype.setLoaded=function(d){if(this.loaded!==d&&(this.loaded=d,d)){for(var x=0,k=this.requestors;x<k.length;x+=1){var L=k[x];this._notify(L.ids,L.callback)}this.requestors=[]}},m.prototype.getImage=function(d){return this.images[d]},m.prototype.addImage=function(d,x){this._validate(d,x)&&(this.images[d]=x)},m.prototype._validate=function(d,x){var k=!0;return this._validateStretch(x.stretchX,x.data&&x.data.width)||(this.fire(new f.ErrorEvent(new Error('Image "'+d+'" has invalid "stretchX" value'))),k=!1),this._validateStretch(x.stretchY,x.data&&x.data.height)||(this.fire(new f.ErrorEvent(new Error('Image "'+d+'" has invalid "stretchY" value'))),k=!1),this._validateContent(x.content,x)||(this.fire(new f.ErrorEvent(new Error('Image "'+d+'" has invalid "content" value'))),k=!1),k},m.prototype._validateStretch=function(d,x){if(!d)return!0;for(var k=0,L=0,B=d;L<B.length;L+=1){var q=B[L];if(q[0]<k||q[1]<q[0]||x<q[1])return!1;k=q[1]}return!0},m.prototype._validateContent=function(d,x){return!(d&&(d.length!==4||d[0]<0||x.data.width<d[0]||d[1]<0||x.data.height<d[1]||d[2]<0||x.data.width<d[2]||d[3]<0||x.data.height<d[3]||d[2]<d[0]||d[3]<d[1]))},m.prototype.updateImage=function(d,x){x.version=this.images[d].version+1,this.images[d]=x,this.updatedImages[d]=!0},m.prototype.removeImage=function(d){var x=this.images[d];delete this.images[d],delete this.patterns[d],x.userImage&&x.userImage.onRemove&&x.userImage.onRemove()},m.prototype.listImages=function(){return Object.keys(this.images)},m.prototype.getImages=function(d,x){var k=!0;if(!this.isLoaded())for(var L=0,B=d;L<B.length;L+=1)this.images[B[L]]||(k=!1);this.isLoaded()||k?this._notify(d,x):this.requestors.push({ids:d,callback:x})},m.prototype._notify=function(d,x){for(var k={},L=0,B=d;L<B.length;L+=1){var q=B[L];this.images[q]||this.fire(new f.Event("styleimagemissing",{id:q}));var $=this.images[q];$?k[q]={data:$.data.clone(),pixelRatio:$.pixelRatio,sdf:$.sdf,version:$.version,stretchX:$.stretchX,stretchY:$.stretchY,content:$.content,hasRenderCallback:Boolean($.userImage&&$.userImage.render)}:f.warnOnce('Image "'+q+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}x(null,k)},m.prototype.getPixelSize=function(){var d=this.atlasImage;return{width:d.width,height:d.height}},m.prototype.getPattern=function(d){var x=this.patterns[d],k=this.getImage(d);if(!k)return null;if(x&&x.position.version===k.version)return x.position;if(x)x.position.version=k.version;else{var L={w:k.data.width+2,h:k.data.height+2,x:0,y:0},B=new f.ImagePosition(L,k);this.patterns[d]={bin:L,position:B}}return this._updatePatternAtlas(),this.patterns[d].position},m.prototype.bind=function(d){var x=d.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new f.Texture(d,this.atlasImage,x.RGBA),this.atlasTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE)},m.prototype._updatePatternAtlas=function(){var d=[];for(var x in this.patterns)d.push(this.patterns[x].bin);var k=f.potpack(d),L=k.w,B=k.h,q=this.atlasImage;for(var $ in q.resize({width:L||1,height:B||1}),this.patterns){var ie=this.patterns[$].bin,he=ie.x+1,de=ie.y+1,me=this.images[$].data,Ce=me.width,Te=me.height;f.RGBAImage.copy(me,q,{x:0,y:0},{x:he,y:de},{width:Ce,height:Te}),f.RGBAImage.copy(me,q,{x:0,y:Te-1},{x:he,y:de-1},{width:Ce,height:1}),f.RGBAImage.copy(me,q,{x:0,y:0},{x:he,y:de+Te},{width:Ce,height:1}),f.RGBAImage.copy(me,q,{x:Ce-1,y:0},{x:he-1,y:de},{width:1,height:Te}),f.RGBAImage.copy(me,q,{x:0,y:0},{x:he+Ce,y:de},{width:1,height:Te})}this.dirty=!0},m.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},m.prototype.dispatchRenderCallbacks=function(d){for(var x=0,k=d;x<k.length;x+=1){var L=k[x];if(!this.callbackDispatchedThisFrame[L]){this.callbackDispatchedThisFrame[L]=!0;var B=this.images[L];yt(B)&&this.updateImage(L,B)}}},m}(f.Evented),Ze=pt,vt=pt,ct=1e20;function pt(c,m,d,x,k,L){this.fontSize=c||24,this.buffer=m===void 0?3:m,this.cutoff=x||.25,this.fontFamily=k||"sans-serif",this.fontWeight=L||"normal",this.radius=d||8;var B=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=B,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(B*B),this.gridInner=new Float64Array(B*B),this.f=new Float64Array(B),this.d=new Float64Array(B),this.z=new Float64Array(B+1),this.v=new Int16Array(B),this.middle=Math.round(B/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function lt(c,m,d,x,k,L,B){for(var q=0;q<m;q++){for(var $=0;$<d;$++)x[$]=c[$*m+q];for(fi(x,k,L,B,d),$=0;$<d;$++)c[$*m+q]=k[$]}for($=0;$<d;$++){for(q=0;q<m;q++)x[q]=c[$*m+q];for(fi(x,k,L,B,m),q=0;q<m;q++)c[$*m+q]=Math.sqrt(k[q])}}function fi(c,m,d,x,k){d[0]=0,x[0]=-ct,x[1]=+ct;for(var L=1,B=0;L<k;L++){for(var q=(c[L]+L*L-(c[d[B]]+d[B]*d[B]))/(2*L-2*d[B]);q<=x[B];)B--,q=(c[L]+L*L-(c[d[B]]+d[B]*d[B]))/(2*L-2*d[B]);d[++B]=L,x[B]=q,x[B+1]=+ct}for(L=0,B=0;L<k;L++){for(;x[B+1]<L;)B++;m[L]=(L-d[B])*(L-d[B])+c[d[B]]}}pt.prototype.draw=function(c){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(c,this.buffer,this.middle);for(var m=this.ctx.getImageData(0,0,this.size,this.size),d=new Uint8ClampedArray(this.size*this.size),x=0;x<this.size*this.size;x++){var k=m.data[4*x+3]/255;this.gridOuter[x]=k===1?0:k===0?ct:Math.pow(Math.max(0,.5-k),2),this.gridInner[x]=k===1?ct:k===0?0:Math.pow(Math.max(0,k-.5),2)}for(lt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),lt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),x=0;x<this.size*this.size;x++)d[x]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[x]-this.gridInner[x])/this.radius+this.cutoff))));return d},Ze.default=vt;var Et=function(c,m){this.requestManager=c,this.localIdeographFontFamily=m,this.entries={}};Et.prototype.setURL=function(c){this.url=c},Et.prototype.getGlyphs=function(c,m){var d=this,x=[];for(var k in c)for(var L=0,B=c[k];L<B.length;L+=1)x.push({stack:k,id:B[L]});f.asyncAll(x,function(q,$){var ie=q.stack,he=q.id,de=d.entries[ie];de||(de=d.entries[ie]={glyphs:{},requests:{},ranges:{}});var me=de.glyphs[he];if(me===void 0){if(me=d._tinySDF(de,ie,he))return de.glyphs[he]=me,void $(null,{stack:ie,id:he,glyph:me});var Ce=Math.floor(he/256);if(256*Ce>65535)$(new Error("glyphs > 65535 not supported"));else if(de.ranges[Ce])$(null,{stack:ie,id:he,glyph:me});else{var Te=de.requests[Ce];Te||(Te=de.requests[Ce]=[],Et.loadGlyphRange(ie,Ce,d.url,d.requestManager,function(Le,xe){if(xe){for(var ze in xe)d._doesCharSupportLocalGlyph(+ze)||(de.glyphs[+ze]=xe[+ze]);de.ranges[Ce]=!0}for(var Fe=0,$e=Te;Fe<$e.length;Fe+=1)(0,$e[Fe])(Le,xe);delete de.requests[Ce]})),Te.push(function(Le,xe){Le?$(Le):xe&&$(null,{stack:ie,id:he,glyph:xe[he]||null})})}}else $(null,{stack:ie,id:he,glyph:me})},function(q,$){if(q)m(q);else if($){for(var ie={},he=0,de=$;he<de.length;he+=1){var me=de[he],Ce=me.stack,Te=me.id,Le=me.glyph;(ie[Ce]||(ie[Ce]={}))[Te]=Le&&{id:Le.id,bitmap:Le.bitmap.clone(),metrics:Le.metrics}}m(null,ie)}})},Et.prototype._doesCharSupportLocalGlyph=function(c){return!!this.localIdeographFontFamily&&(f.isChar["CJK Unified Ideographs"](c)||f.isChar["Hangul Syllables"](c)||f.isChar.Hiragana(c)||f.isChar.Katakana(c))},Et.prototype._tinySDF=function(c,m,d){var x=this.localIdeographFontFamily;if(x&&this._doesCharSupportLocalGlyph(d)){var k=c.tinySDF;if(!k){var L="400";/bold/i.test(m)?L="900":/medium/i.test(m)?L="500":/light/i.test(m)&&(L="200"),k=c.tinySDF=new Et.TinySDF(24,3,8,.25,x,L)}return{id:d,bitmap:new f.AlphaImage({width:30,height:30},k.draw(String.fromCharCode(d))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Et.loadGlyphRange=function(c,m,d,x,k){var L=256*m,B=L+255,q=x.transformRequest(x.normalizeGlyphsURL(d).replace("{fontstack}",c).replace("{range}",L+"-"+B),f.ResourceType.Glyphs);f.getArrayBuffer(q,function($,ie){if($)k($);else if(ie){for(var he={},de=0,me=f.parseGlyphPBF(ie);de<me.length;de+=1){var Ce=me[de];he[Ce.id]=Ce}k(null,he)}})},Et.TinySDF=Ze;var Wt=function(){this.specification=f.styleSpec.light.position};Wt.prototype.possiblyEvaluate=function(c,m){return f.sphericalToCartesian(c.expression.evaluate(m))},Wt.prototype.interpolate=function(c,m,d){return{x:f.number(c.x,m.x,d),y:f.number(c.y,m.y,d),z:f.number(c.z,m.z,d)}};var Ei=new f.Properties({anchor:new f.DataConstantProperty(f.styleSpec.light.anchor),position:new Wt,color:new f.DataConstantProperty(f.styleSpec.light.color),intensity:new f.DataConstantProperty(f.styleSpec.light.intensity)}),qi=function(c){function m(d){c.call(this),this._transitionable=new f.Transitionable(Ei),this.setLight(d),this._transitioning=this._transitionable.untransitioned()}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getLight=function(){return this._transitionable.serialize()},m.prototype.setLight=function(d,x){if(x===void 0&&(x={}),!this._validate(f.validateLight,d,x))for(var k in d){var L=d[k];f.endsWith(k,"-transition")?this._transitionable.setTransition(k.slice(0,-11),L):this._transitionable.setValue(k,L)}},m.prototype.updateTransitions=function(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)},m.prototype.hasTransition=function(){return this._transitioning.hasTransition()},m.prototype.recalculate=function(d){this.properties=this._transitioning.possiblyEvaluate(d)},m.prototype._validate=function(d,x,k){return(!k||k.validate!==!1)&&f.emitValidationErrors(this,d.call(f.validateStyle,f.extend({value:x,style:{glyphs:!0,sprite:!0},styleSpec:f.styleSpec})))},m}(f.Evented),Xt=function(c,m){this.width=c,this.height=m,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Xt.prototype.getDash=function(c,m){var d=c.join(",")+String(m);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(c,m)),this.dashEntry[d]},Xt.prototype.getDashRanges=function(c,m,d){var x=[],k=c.length%2==1?-c[c.length-1]*d:0,L=c[0]*d,B=!0;x.push({left:k,right:L,isDash:B,zeroLength:c[0]===0});for(var q=c[0],$=1;$<c.length;$++){var ie=c[$];x.push({left:k=q*d,right:L=(q+=ie)*d,isDash:B=!B,zeroLength:ie===0})}return x},Xt.prototype.addRoundDash=function(c,m,d){for(var x=m/2,k=-d;k<=d;k++)for(var L=this.width*(this.nextRow+d+k),B=0,q=c[B],$=0;$<this.width;$++){$/q.right>1&&(q=c[++B]);var ie=Math.abs($-q.left),he=Math.abs($-q.right),de=Math.min(ie,he),me=void 0,Ce=k/d*(x+1);if(q.isDash){var Te=x-Math.abs(Ce);me=Math.sqrt(de*de+Te*Te)}else me=x-Math.sqrt(de*de+Ce*Ce);this.data[L+$]=Math.max(0,Math.min(255,me+128))}},Xt.prototype.addRegularDash=function(c){for(var m=c.length-1;m>=0;--m){var d=c[m],x=c[m+1];d.zeroLength?c.splice(m,1):x&&x.isDash===d.isDash&&(x.left=d.left,c.splice(m,1))}var k=c[0],L=c[c.length-1];k.isDash===L.isDash&&(k.left=L.left-this.width,L.right=k.right+this.width);for(var B=this.width*this.nextRow,q=0,$=c[q],ie=0;ie<this.width;ie++){ie/$.right>1&&($=c[++q]);var he=Math.abs(ie-$.left),de=Math.abs(ie-$.right),me=Math.min(he,de);this.data[B+ie]=Math.max(0,Math.min(255,($.isDash?me:-me)+128))}},Xt.prototype.addDash=function(c,m){var d=m?7:0,x=2*d+1;if(this.nextRow+x>this.height)return f.warnOnce("LineAtlas out of space"),null;for(var k=0,L=0;L<c.length;L++)k+=c[L];if(k!==0){var B=this.width/k,q=this.getDashRanges(c,this.width,B);m?this.addRoundDash(q,B,d):this.addRegularDash(q)}var $={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:k};return this.nextRow+=x,this.dirty=!0,$},Xt.prototype.bind=function(c){var m=c.gl;this.texture?(m.bindTexture(m.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,m.texSubImage2D(m.TEXTURE_2D,0,0,0,this.width,this.height,m.ALPHA,m.UNSIGNED_BYTE,this.data))):(this.texture=m.createTexture(),m.bindTexture(m.TEXTURE_2D,this.texture),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),m.texImage2D(m.TEXTURE_2D,0,m.ALPHA,this.width,this.height,0,m.ALPHA,m.UNSIGNED_BYTE,this.data))};var Qt=function c(m,d){this.workerPool=m,this.actors=[],this.currentActor=0,this.id=f.uniqueId();for(var x=this.workerPool.acquire(this.id),k=0;k<x.length;k++){var L=new c.Actor(x[k],d,this.id);L.name="Worker "+k,this.actors.push(L)}};function Ai(c,m,d){var x=function(k,L){if(k)return d(k);if(L){var B=f.pick(f.extend(L,c),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);L.vector_layers&&(B.vectorLayers=L.vector_layers,B.vectorLayerIds=B.vectorLayers.map(function(q){return q.id})),B.tiles=m.canonicalizeTileset(B,c.url),d(null,B)}};return c.url?f.getJSON(m.transformRequest(m.normalizeSourceURL(c.url),f.ResourceType.Source),x):f.browser.frame(function(){return x(null,c)})}Qt.prototype.broadcast=function(c,m,d){f.asyncAll(this.actors,function(x,k){x.send(c,m,k)},d=d||function(){})},Qt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Qt.prototype.remove=function(){this.actors.forEach(function(c){c.remove()}),this.actors=[],this.workerPool.release(this.id)},Qt.Actor=f.Actor;var bt=function(c,m,d){this.bounds=f.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=m||0,this.maxzoom=d||24};bt.prototype.validateBounds=function(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]},bt.prototype.contains=function(c){var m=Math.pow(2,c.z),d=Math.floor(f.mercatorXfromLng(this.bounds.getWest())*m),x=Math.floor(f.mercatorYfromLat(this.bounds.getNorth())*m),k=Math.ceil(f.mercatorXfromLng(this.bounds.getEast())*m),L=Math.ceil(f.mercatorYfromLat(this.bounds.getSouth())*m);return c.x>=d&&c.x<k&&c.y>=x&&c.y<L};var Gi=function(c){function m(d,x,k,L){if(c.call(this),this.id=d,this.dispatcher=k,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,f.extend(this,f.pick(x,["url","scheme","tileSize","promoteId"])),this._options=f.extend({type:"vector"},x),this._collectResourceTiming=x.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(L)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.load=function(){var d=this;this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ai(this._options,this.map._requestManager,function(x,k){d._tileJSONRequest=null,d._loaded=!0,x?d.fire(new f.ErrorEvent(x)):k&&(f.extend(d,k),k.bounds&&(d.tileBounds=new bt(k.bounds,d.minzoom,d.maxzoom)),f.postTurnstileEvent(k.tiles,d.map._requestManager._customAccessToken),f.postMapLoadEvent(k.tiles,d.map._getMapId(),d.map._requestManager._skuToken,d.map._requestManager._customAccessToken),d.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),d.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"})))})},m.prototype.loaded=function(){return this._loaded},m.prototype.hasTile=function(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)},m.prototype.onAdd=function(d){this.map=d,this.load()},m.prototype.setSourceProperty=function(d){this._tileJSONRequest&&this._tileJSONRequest.cancel(),d(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},m.prototype.setTiles=function(d){var x=this;return this.setSourceProperty(function(){x._options.tiles=d}),this},m.prototype.setUrl=function(d){var x=this;return this.setSourceProperty(function(){x.url=d,x._options.url=d}),this},m.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},m.prototype.serialize=function(){return f.extend({},this._options)},m.prototype.loadTile=function(d,x){var k=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),L={request:this.map._requestManager.transformRequest(k,f.ResourceType.Tile),uid:d.uid,tileID:d.tileID,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:f.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function B(q,$){return delete d.request,d.aborted?x(null):q&&q.status!==404?x(q):($&&$.resourceTiming&&(d.resourceTiming=$.resourceTiming),this.map._refreshExpiredTiles&&$&&d.setExpiryData($),d.loadVectorData($,this.map.painter),f.cacheEntryPossiblyAdded(this.dispatcher),x(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}L.request.collectResourceTiming=this._collectResourceTiming,d.actor&&d.state!=="expired"?d.state==="loading"?d.reloadCallback=x:d.request=d.actor.send("reloadTile",L,B.bind(this)):(d.actor=this.dispatcher.getActor(),d.request=d.actor.send("loadTile",L,B.bind(this)))},m.prototype.abortTile=function(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id},void 0)},m.prototype.unloadTile=function(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id},void 0)},m.prototype.hasTransition=function(){return!1},m}(f.Evented),mr=function(c){function m(d,x,k,L){c.call(this),this.id=d,this.dispatcher=k,this.setEventedParent(L),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=f.extend({type:"raster"},x),f.extend(this,f.pick(x,["url","scheme","tileSize"]))}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.load=function(){var d=this;this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ai(this._options,this.map._requestManager,function(x,k){d._tileJSONRequest=null,d._loaded=!0,x?d.fire(new f.ErrorEvent(x)):k&&(f.extend(d,k),k.bounds&&(d.tileBounds=new bt(k.bounds,d.minzoom,d.maxzoom)),f.postTurnstileEvent(k.tiles),f.postMapLoadEvent(k.tiles,d.map._getMapId(),d.map._requestManager._skuToken),d.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),d.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"})))})},m.prototype.loaded=function(){return this._loaded},m.prototype.onAdd=function(d){this.map=d,this.load()},m.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},m.prototype.serialize=function(){return f.extend({},this._options)},m.prototype.hasTile=function(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)},m.prototype.loadTile=function(d,x){var k=this,L=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);d.request=f.getImage(this.map._requestManager.transformRequest(L,f.ResourceType.Tile),function(B,q){if(delete d.request,d.aborted)d.state="unloaded",x(null);else if(B)d.state="errored",x(B);else if(q){k.map._refreshExpiredTiles&&d.setExpiryData(q),delete q.cacheControl,delete q.expires;var $=k.map.painter.context,ie=$.gl;d.texture=k.map.painter.getTileTexture(q.width),d.texture?d.texture.update(q,{useMipmap:!0}):(d.texture=new f.Texture($,q,ie.RGBA,{useMipmap:!0}),d.texture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE,ie.LINEAR_MIPMAP_NEAREST),$.extTextureFilterAnisotropic&&ie.texParameterf(ie.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax)),d.state="loaded",f.cacheEntryPossiblyAdded(k.dispatcher),x(null)}})},m.prototype.abortTile=function(d,x){d.request&&(d.request.cancel(),delete d.request),x()},m.prototype.unloadTile=function(d,x){d.texture&&this.map.painter.saveTileTexture(d.texture),x()},m.prototype.hasTransition=function(){return!1},m}(f.Evented),Ar=function(c){function m(d,x,k,L){c.call(this,d,x,k,L),this.type="raster-dem",this.maxzoom=22,this._options=f.extend({type:"raster-dem"},x),this.encoding=x.encoding||"mapbox"}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},m.prototype.loadTile=function(d,x){var k=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function L(B,q){B&&(d.state="errored",x(B)),q&&(d.dem=q,d.needsHillshadePrepare=!0,d.state="loaded",x(null))}d.request=f.getImage(this.map._requestManager.transformRequest(k,f.ResourceType.Tile),function(B,q){if(delete d.request,d.aborted)d.state="unloaded",x(null);else if(B)d.state="errored",x(B);else if(q){this.map._refreshExpiredTiles&&d.setExpiryData(q),delete q.cacheControl,delete q.expires;var $=f.window.ImageBitmap&&q instanceof f.window.ImageBitmap&&f.offscreenCanvasSupported()?q:f.browser.getImageData(q,1),ie={uid:d.uid,coord:d.tileID,source:this.id,rawImageData:$,encoding:this.encoding};d.actor&&d.state!=="expired"||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",ie,L.bind(this)))}}.bind(this)),d.neighboringTiles=this._getNeighboringTiles(d.tileID)},m.prototype._getNeighboringTiles=function(d){var x=d.canonical,k=Math.pow(2,x.z),L=(x.x-1+k)%k,B=x.x===0?d.wrap-1:d.wrap,q=(x.x+1+k)%k,$=x.x+1===k?d.wrap+1:d.wrap,ie={};return ie[new f.OverscaledTileID(d.overscaledZ,B,x.z,L,x.y).key]={backfilled:!1},ie[new f.OverscaledTileID(d.overscaledZ,$,x.z,q,x.y).key]={backfilled:!1},x.y>0&&(ie[new f.OverscaledTileID(d.overscaledZ,B,x.z,L,x.y-1).key]={backfilled:!1},ie[new f.OverscaledTileID(d.overscaledZ,d.wrap,x.z,x.x,x.y-1).key]={backfilled:!1},ie[new f.OverscaledTileID(d.overscaledZ,$,x.z,q,x.y-1).key]={backfilled:!1}),x.y+1<k&&(ie[new f.OverscaledTileID(d.overscaledZ,B,x.z,L,x.y+1).key]={backfilled:!1},ie[new f.OverscaledTileID(d.overscaledZ,d.wrap,x.z,x.x,x.y+1).key]={backfilled:!1},ie[new f.OverscaledTileID(d.overscaledZ,$,x.z,q,x.y+1).key]={backfilled:!1}),ie},m.prototype.unloadTile=function(d){d.demTexture&&this.map.painter.saveTileTexture(d.demTexture),d.fbo&&(d.fbo.destroy(),delete d.fbo),d.dem&&delete d.dem,delete d.neighboringTiles,d.state="unloaded",d.actor&&d.actor.send("removeDEMTile",{uid:d.uid,source:this.id})},m}(mr),Rt=function(c){function m(d,x,k,L){c.call(this),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=k.getActor(),this.setEventedParent(L),this._data=x.data,this._options=f.extend({},x),this._collectResourceTiming=x.collectResourceTiming,this._resourceTiming=[],x.maxzoom!==void 0&&(this.maxzoom=x.maxzoom),x.type&&(this.type=x.type),x.attribution&&(this.attribution=x.attribution),this.promoteId=x.promoteId;var B=f.EXTENT/this.tileSize;this.workerOptions=f.extend({source:this.id,cluster:x.cluster||!1,geojsonVtOptions:{buffer:(x.buffer!==void 0?x.buffer:128)*B,tolerance:(x.tolerance!==void 0?x.tolerance:.375)*B,extent:f.EXTENT,maxZoom:this.maxzoom,lineMetrics:x.lineMetrics||!1,generateId:x.generateId||!1},superclusterOptions:{maxZoom:x.clusterMaxZoom!==void 0?Math.min(x.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,x.clusterMinPoints||2),extent:f.EXTENT,radius:(x.clusterRadius||50)*B,log:!1,generateId:x.generateId||!1},clusterProperties:x.clusterProperties,filter:x.filter},x.workerOptions)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.load=function(){var d=this;this.fire(new f.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(x){if(x)d.fire(new f.ErrorEvent(x));else{var k={dataType:"source",sourceDataType:"metadata"};d._collectResourceTiming&&d._resourceTiming&&d._resourceTiming.length>0&&(k.resourceTiming=d._resourceTiming,d._resourceTiming=[]),d.fire(new f.Event("data",k))}})},m.prototype.onAdd=function(d){this.map=d,this.load()},m.prototype.setData=function(d){var x=this;return this._data=d,this.fire(new f.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(k){if(k)x.fire(new f.ErrorEvent(k));else{var L={dataType:"source",sourceDataType:"content"};x._collectResourceTiming&&x._resourceTiming&&x._resourceTiming.length>0&&(L.resourceTiming=x._resourceTiming,x._resourceTiming=[]),x.fire(new f.Event("data",L))}}),this},m.prototype.getClusterExpansionZoom=function(d,x){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id},x),this},m.prototype.getClusterChildren=function(d,x){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id},x),this},m.prototype.getClusterLeaves=function(d,x,k,L){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:d,limit:x,offset:k},L),this},m.prototype._updateWorkerData=function(d){var x=this;this._loaded=!1;var k=f.extend({},this.workerOptions),L=this._data;typeof L=="string"?(k.request=this.map._requestManager.transformRequest(f.browser.resolveURL(L),f.ResourceType.Source),k.request.collectResourceTiming=this._collectResourceTiming):k.data=JSON.stringify(L),this.actor.send(this.type+".loadData",k,function(B,q){x._removed||q&&q.abandoned||(x._loaded=!0,q&&q.resourceTiming&&q.resourceTiming[x.id]&&(x._resourceTiming=q.resourceTiming[x.id].slice(0)),x.actor.send(x.type+".coalesce",{source:k.source},null),d(B))})},m.prototype.loaded=function(){return this._loaded},m.prototype.loadTile=function(d,x){var k=this,L=d.actor?"reloadTile":"loadTile";d.actor=this.actor,d.request=this.actor.send(L,{type:this.type,uid:d.uid,tileID:d.tileID,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:f.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(B,q){return delete d.request,d.unloadVectorData(),d.aborted?x(null):B?x(B):(d.loadVectorData(q,k.map.painter,L==="reloadTile"),x(null))})},m.prototype.abortTile=function(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0},m.prototype.unloadTile=function(d){d.unloadVectorData(),this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})},m.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},m.prototype.serialize=function(){return f.extend({},this._options,{type:this.type,data:this._data})},m.prototype.hasTransition=function(){return!1},m}(f.Evented),ai=f.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),yi=function(c){function m(d,x,k,L){c.call(this),this.id=d,this.dispatcher=k,this.coordinates=x.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(L),this.options=x}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.load=function(d,x){var k=this;this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this.url=this.options.url,f.getImage(this.map._requestManager.transformRequest(this.url,f.ResourceType.Image),function(L,B){k._loaded=!0,L?k.fire(new f.ErrorEvent(L)):B&&(k.image=B,d&&(k.coordinates=d),x&&x(),k._finishLoading())})},m.prototype.loaded=function(){return this._loaded},m.prototype.updateImage=function(d){var x=this;return this.image&&d.url?(this.options.url=d.url,this.load(d.coordinates,function(){x.texture=null}),this):this},m.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})))},m.prototype.onAdd=function(d){this.map=d,this.load()},m.prototype.setCoordinates=function(d){var x=this;this.coordinates=d;var k=d.map(f.MercatorCoordinate.fromLngLat);this.tileID=function(B){for(var q=1/0,$=1/0,ie=-1/0,he=-1/0,de=0,me=B;de<me.length;de+=1){var Ce=me[de];q=Math.min(q,Ce.x),$=Math.min($,Ce.y),ie=Math.max(ie,Ce.x),he=Math.max(he,Ce.y)}var Te=Math.max(ie-q,he-$),Le=Math.max(0,Math.floor(-Math.log(Te)/Math.LN2)),xe=Math.pow(2,Le);return new f.CanonicalTileID(Le,Math.floor((q+ie)/2*xe),Math.floor(($+he)/2*xe))}(k),this.minzoom=this.maxzoom=this.tileID.z;var L=k.map(function(B){return x.tileID.getTilePoint(B)._round()});return this._boundsArray=new f.StructArrayLayout4i8,this._boundsArray.emplaceBack(L[0].x,L[0].y,0,0),this._boundsArray.emplaceBack(L[1].x,L[1].y,f.EXTENT,0),this._boundsArray.emplaceBack(L[3].x,L[3].y,0,f.EXTENT),this._boundsArray.emplaceBack(L[2].x,L[2].y,f.EXTENT,f.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"})),this},m.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var d=this.map.painter.context,x=d.gl;for(var k in this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,ai.members)),this.boundsSegments||(this.boundsSegments=f.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new f.Texture(d,this.image,x.RGBA),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE)),this.tiles){var L=this.tiles[k];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture)}}},m.prototype.loadTile=function(d,x){this.tileID&&this.tileID.equals(d.tileID.canonical)?(this.tiles[String(d.tileID.wrap)]=d,d.buckets={},x(null)):(d.state="errored",x(null))},m.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},m.prototype.hasTransition=function(){return!1},m}(f.Evented),Fi=function(c){function m(d,x,k,L){c.call(this,d,x,k,L),this.roundZoom=!0,this.type="video",this.options=x}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.load=function(){var d=this;this._loaded=!1;var x=this.options;this.urls=[];for(var k=0,L=x.urls;k<L.length;k+=1)this.urls.push(this.map._requestManager.transformRequest(L[k],f.ResourceType.Source).url);f.getVideo(this.urls,function(B,q){d._loaded=!0,B?d.fire(new f.ErrorEvent(B)):q&&(d.video=q,d.video.loop=!0,d.video.addEventListener("playing",function(){d.map.triggerRepaint()}),d.map&&d.video.play(),d._finishLoading())})},m.prototype.pause=function(){this.video&&this.video.pause()},m.prototype.play=function(){this.video&&this.video.play()},m.prototype.seek=function(d){if(this.video){var x=this.video.seekable;d<x.start(0)||d>x.end(0)?this.fire(new f.ErrorEvent(new f.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+x.start(0)+" and "+x.end(0)+"-second mark."))):this.video.currentTime=d}},m.prototype.getVideo=function(){return this.video},m.prototype.onAdd=function(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},m.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var d=this.map.painter.context,x=d.gl;for(var k in this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,ai.members)),this.boundsSegments||(this.boundsSegments=f.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE),x.texSubImage2D(x.TEXTURE_2D,0,0,0,x.RGBA,x.UNSIGNED_BYTE,this.video)):(this.texture=new f.Texture(d,this.video,x.RGBA),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE)),this.tiles){var L=this.tiles[k];L.state!=="loaded"&&(L.state="loaded",L.texture=this.texture)}}},m.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},m.prototype.hasTransition=function(){return this.video&&!this.video.paused},m}(yi),jt=function(c){function m(d,x,k,L){c.call(this,d,x,k,L),x.coordinates?Array.isArray(x.coordinates)&&x.coordinates.length===4&&!x.coordinates.some(function(B){return!Array.isArray(B)||B.length!==2||B.some(function(q){return typeof q!="number"})})||this.fire(new f.ErrorEvent(new f.ValidationError("sources."+d,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new f.ErrorEvent(new f.ValidationError("sources."+d,null,'missing required property "coordinates"'))),x.animate&&typeof x.animate!="boolean"&&this.fire(new f.ErrorEvent(new f.ValidationError("sources."+d,null,'optional "animate" property must be a boolean value'))),x.canvas?typeof x.canvas=="string"||x.canvas instanceof f.window.HTMLCanvasElement||this.fire(new f.ErrorEvent(new f.ValidationError("sources."+d,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new f.ErrorEvent(new f.ValidationError("sources."+d,null,'missing required property "canvas"'))),this.options=x,this.animate=x.animate===void 0||x.animate}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof f.window.HTMLCanvasElement?this.options.canvas:f.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new f.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},m.prototype.getCanvas=function(){return this.canvas},m.prototype.onAdd=function(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()},m.prototype.onRemove=function(){this.pause()},m.prototype.prepare=function(){var d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var x=this.map.painter.context,k=x.gl;for(var L in this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,ai.members)),this.boundsSegments||(this.boundsSegments=f.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(d||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new f.Texture(x,this.canvas,k.RGBA,{premultiply:!0}),this.tiles){var B=this.tiles[L];B.state!=="loaded"&&(B.state="loaded",B.texture=this.texture)}}},m.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},m.prototype.hasTransition=function(){return this._playing},m.prototype._hasInvalidDimensions=function(){for(var d=0,x=[this.canvas.width,this.canvas.height];d<x.length;d+=1){var k=x[d];if(isNaN(k)||k<=0)return!0}return!1},m}(yi),Xi={vector:Gi,raster:mr,"raster-dem":Ar,geojson:Rt,video:Fi,image:yi,canvas:jt};function Ri(c,m){var d=f.identity([]);return f.translate(d,d,[1,1,0]),f.scale(d,d,[.5*c.width,.5*c.height,1]),f.multiply(d,d,c.calculatePosMatrix(m.toUnwrapped()))}function Ii(c,m,d,x,k,L){var B=function(Le,xe,ze){if(Le)for(var Fe=0,$e=Le;Fe<$e.length;Fe+=1){var ot=xe[$e[Fe]];if(ot&&ot.source===ze&&ot.type==="fill-extrusion")return!0}else for(var at in xe){var st=xe[at];if(st.source===ze&&st.type==="fill-extrusion")return!0}return!1}(k&&k.layers,m,c.id),q=L.maxPitchScaleFactor(),$=c.tilesIn(x,q,B);$.sort(rr);for(var ie=[],he=0,de=$;he<de.length;he+=1){var me=de[he];ie.push({wrappedTileID:me.tileID.wrapped().key,queryResults:me.tile.queryRenderedFeatures(m,d,c._state,me.queryGeometry,me.cameraQueryGeometry,me.scale,k,L,q,Ri(c.transform,me.tileID))})}var Ce=function(Le){for(var xe={},ze={},Fe=0,$e=Le;Fe<$e.length;Fe+=1){var ot=$e[Fe],at=ot.queryResults,st=ot.wrappedTileID,It=ze[st]=ze[st]||{};for(var Dt in at)for(var Lt=at[Dt],$t=It[Dt]=It[Dt]||{},mi=xe[Dt]=xe[Dt]||[],bi=0,di=Lt;bi<di.length;bi+=1){var ar=di[bi];$t[ar.featureIndex]||($t[ar.featureIndex]=!0,mi.push(ar))}}return xe}(ie);for(var Te in Ce)Ce[Te].forEach(function(Le){var xe=Le.feature,ze=c.getFeatureState(xe.layer["source-layer"],xe.id);xe.source=xe.layer.source,xe.layer["source-layer"]&&(xe.sourceLayer=xe.layer["source-layer"]),xe.state=ze});return Ce}function rr(c,m){var d=c.tileID,x=m.tileID;return d.overscaledZ-x.overscaledZ||d.canonical.y-x.canonical.y||d.wrap-x.wrap||d.canonical.x-x.canonical.x}var zi=function(c,m){this.max=c,this.onRemove=m,this.reset()};zi.prototype.reset=function(){for(var c in this.data)for(var m=0,d=this.data[c];m<d.length;m+=1){var x=d[m];x.timeout&&clearTimeout(x.timeout),this.onRemove(x.value)}return this.data={},this.order=[],this},zi.prototype.add=function(c,m,d){var x=this,k=c.wrapped().key;this.data[k]===void 0&&(this.data[k]=[]);var L={value:m,timeout:void 0};if(d!==void 0&&(L.timeout=setTimeout(function(){x.remove(c,L)},d)),this.data[k].push(L),this.order.push(k),this.order.length>this.max){var B=this._getAndRemoveByKey(this.order[0]);B&&this.onRemove(B)}return this},zi.prototype.has=function(c){return c.wrapped().key in this.data},zi.prototype.getAndRemove=function(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null},zi.prototype._getAndRemoveByKey=function(c){var m=this.data[c].shift();return m.timeout&&clearTimeout(m.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),m.value},zi.prototype.getByKey=function(c){var m=this.data[c];return m?m[0].value:null},zi.prototype.get=function(c){return this.has(c)?this.data[c.wrapped().key][0].value:null},zi.prototype.remove=function(c,m){if(!this.has(c))return this;var d=c.wrapped().key,x=m===void 0?0:this.data[d].indexOf(m),k=this.data[d][x];return this.data[d].splice(x,1),k.timeout&&clearTimeout(k.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(k.value),this.order.splice(this.order.indexOf(d),1),this},zi.prototype.setMaxSize=function(c){for(this.max=c;this.order.length>this.max;){var m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this},zi.prototype.filter=function(c){var m=[];for(var d in this.data)for(var x=0,k=this.data[d];x<k.length;x+=1){var L=k[x];c(L.value)||m.push(L)}for(var B=0,q=m;B<q.length;B+=1){var $=q[B];this.remove($.value.tileID,$)}};var zt=function(c,m,d){this.context=c;var x=c.gl;this.buffer=x.createBuffer(),this.dynamicDraw=Boolean(d),this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer};zt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},zt.prototype.updateData=function(c){var m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)},zt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var tr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Bt=function(c,m,d,x){this.length=m.length,this.attributes=d,this.itemSize=m.bytesPerElement,this.dynamicDraw=x,this.context=c;var k=c.gl;this.buffer=k.createBuffer(),c.bindVertexBuffer.set(this.buffer),k.bufferData(k.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?k.DYNAMIC_DRAW:k.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer};Bt.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Bt.prototype.updateData=function(c){var m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,c.arrayBuffer)},Bt.prototype.enableAttributes=function(c,m){for(var d=0;d<this.attributes.length;d++){var x=m.attributes[this.attributes[d].name];x!==void 0&&c.enableVertexAttribArray(x)}},Bt.prototype.setVertexAttribPointers=function(c,m,d){for(var x=0;x<this.attributes.length;x++){var k=this.attributes[x],L=m.attributes[k.name];L!==void 0&&c.vertexAttribPointer(L,k.components,c[tr[k.type]],!1,this.itemSize,k.offset+this.itemSize*(d||0))}},Bt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var rt=function(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};rt.prototype.get=function(){return this.current},rt.prototype.set=function(c){},rt.prototype.getDefault=function(){return this.default},rt.prototype.setDefault=function(){this.set(this.default)};var _i=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return f.Color.transparent},m.prototype.set=function(d){var x=this.current;(d.r!==x.r||d.g!==x.g||d.b!==x.b||d.a!==x.a||this.dirty)&&(this.gl.clearColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)},m}(rt),ir=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return 1},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.clearDepth(d),this.current=d,this.dirty=!1)},m}(rt),Pr=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return 0},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.clearStencil(d),this.current=d,this.dirty=!1)},m}(rt),co=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return[!0,!0,!0,!0]},m.prototype.set=function(d){var x=this.current;(d[0]!==x[0]||d[1]!==x[1]||d[2]!==x[2]||d[3]!==x[3]||this.dirty)&&(this.gl.colorMask(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)},m}(rt),Zn=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!0},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.depthMask(d),this.current=d,this.dirty=!1)},m}(rt),Bo=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return 255},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.stencilMask(d),this.current=d,this.dirty=!1)},m}(rt),_n=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},m.prototype.set=function(d){var x=this.current;(d.func!==x.func||d.ref!==x.ref||d.mask!==x.mask||this.dirty)&&(this.gl.stencilFunc(d.func,d.ref,d.mask),this.current=d,this.dirty=!1)},m}(rt),ho=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){var d=this.gl;return[d.KEEP,d.KEEP,d.KEEP]},m.prototype.set=function(d){var x=this.current;(d[0]!==x[0]||d[1]!==x[1]||d[2]!==x[2]||this.dirty)&&(this.gl.stencilOp(d[0],d[1],d[2]),this.current=d,this.dirty=!1)},m}(rt),Hn=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;d?x.enable(x.STENCIL_TEST):x.disable(x.STENCIL_TEST),this.current=d,this.dirty=!1}},m}(rt),Zi=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return[0,1]},m.prototype.set=function(d){var x=this.current;(d[0]!==x[0]||d[1]!==x[1]||this.dirty)&&(this.gl.depthRange(d[0],d[1]),this.current=d,this.dirty=!1)},m}(rt),Un=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;d?x.enable(x.DEPTH_TEST):x.disable(x.DEPTH_TEST),this.current=d,this.dirty=!1}},m}(rt),Ao=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.LESS},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.depthFunc(d),this.current=d,this.dirty=!1)},m}(rt),Wn=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;d?x.enable(x.BLEND):x.disable(x.BLEND),this.current=d,this.dirty=!1}},m}(rt),Ba=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){var d=this.gl;return[d.ONE,d.ZERO]},m.prototype.set=function(d){var x=this.current;(d[0]!==x[0]||d[1]!==x[1]||this.dirty)&&(this.gl.blendFunc(d[0],d[1]),this.current=d,this.dirty=!1)},m}(rt),Ue=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return f.Color.transparent},m.prototype.set=function(d){var x=this.current;(d.r!==x.r||d.g!==x.g||d.b!==x.b||d.a!==x.a||this.dirty)&&(this.gl.blendColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)},m}(rt),gt=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.FUNC_ADD},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.blendEquation(d),this.current=d,this.dirty=!1)},m}(rt),Si=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;d?x.enable(x.CULL_FACE):x.disable(x.CULL_FACE),this.current=d,this.dirty=!1}},m}(rt),yr=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.BACK},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.cullFace(d),this.current=d,this.dirty=!1)},m}(rt),br=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.CCW},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.frontFace(d),this.current=d,this.dirty=!1)},m}(rt),Xn=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.useProgram(d),this.current=d,this.dirty=!1)},m}(rt),Kn=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.TEXTURE0},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.activeTexture(d),this.current=d,this.dirty=!1)},m}(rt),na=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){var d=this.gl;return[0,0,d.drawingBufferWidth,d.drawingBufferHeight]},m.prototype.set=function(d){var x=this.current;(d[0]!==x[0]||d[1]!==x[1]||d[2]!==x[2]||d[3]!==x[3]||this.dirty)&&(this.gl.viewport(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)},m}(rt),Yr=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.bindFramebuffer(x.FRAMEBUFFER,d),this.current=d,this.dirty=!1}},m}(rt),Ht=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.bindRenderbuffer(x.RENDERBUFFER,d),this.current=d,this.dirty=!1}},m}(rt),nr=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.bindTexture(x.TEXTURE_2D,d),this.current=d,this.dirty=!1}},m}(rt),Ki=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.bindBuffer(x.ARRAY_BUFFER,d),this.current=d,this.dirty=!1}},m}(rt),Dn=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){var x=this.gl;x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,d),this.current=d,this.dirty=!1},m}(rt),Jn=function(c){function m(d){c.call(this,d),this.vao=d.extVertexArrayObject}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){this.vao&&(d!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(d),this.current=d,this.dirty=!1)},m}(rt),Ni=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return 4},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.pixelStorei(x.UNPACK_ALIGNMENT,d),this.current=d,this.dirty=!1}},m}(rt),ya=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.pixelStorei(x.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d),this.current=d,this.dirty=!1}},m}(rt),Oo=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.pixelStorei(x.UNPACK_FLIP_Y_WEBGL,d),this.current=d,this.dirty=!1}},m}(rt),Xr=function(c){function m(d,x){c.call(this,d),this.context=d,this.parent=x}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m}(rt),te=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.setDirty=function(){this.dirty=!0},m.prototype.set=function(d){if(d!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var x=this.gl;x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,x.TEXTURE_2D,d,0),this.current=d,this.dirty=!1}},m}(Xr),oe=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.set=function(d){if(d!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var x=this.gl;x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_ATTACHMENT,x.RENDERBUFFER,d),this.current=d,this.dirty=!1}},m}(Xr),le=function(c,m,d,x){this.context=c,this.width=m,this.height=d;var k=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new te(c,k),x&&(this.depthAttachment=new oe(c,k))};le.prototype.destroy=function(){var c=this.context.gl,m=this.colorAttachment.get();if(m&&c.deleteTexture(m),this.depthAttachment){var d=this.depthAttachment.get();d&&c.deleteRenderbuffer(d)}c.deleteFramebuffer(this.framebuffer)};var ge=function(c,m,d){this.func=c,this.mask=m,this.range=d};ge.ReadOnly=!1,ge.ReadWrite=!0,ge.disabled=new ge(519,ge.ReadOnly,[0,1]);var Se=function(c,m,d,x,k,L){this.test=c,this.ref=m,this.mask=d,this.fail=x,this.depthFail=k,this.pass=L};Se.disabled=new Se({func:519,mask:0},0,0,7680,7680,7680);var Oe=function(c,m,d){this.blendFunction=c,this.blendColor=m,this.mask=d};Oe.disabled=new Oe(Oe.Replace=[1,0],f.Color.transparent,[!1,!1,!1,!1]),Oe.unblended=new Oe(Oe.Replace,f.Color.transparent,[!0,!0,!0,!0]),Oe.alphaBlended=new Oe([1,771],f.Color.transparent,[!0,!0,!0,!0]);var Ve=function(c,m,d){this.enable=c,this.mode=m,this.frontFace=d};Ve.disabled=new Ve(!1,1029,2305),Ve.backCCW=new Ve(!0,1029,2305);var ye=function(c){this.gl=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new _i(this),this.clearDepth=new ir(this),this.clearStencil=new Pr(this),this.colorMask=new co(this),this.depthMask=new Zn(this),this.stencilMask=new Bo(this),this.stencilFunc=new _n(this),this.stencilOp=new ho(this),this.stencilTest=new Hn(this),this.depthRange=new Zi(this),this.depthTest=new Un(this),this.depthFunc=new Ao(this),this.blend=new Wn(this),this.blendFunc=new Ba(this),this.blendColor=new Ue(this),this.blendEquation=new gt(this),this.cullFace=new Si(this),this.cullFaceSide=new yr(this),this.frontFace=new br(this),this.program=new Xn(this),this.activeTexture=new Kn(this),this.viewport=new na(this),this.bindFramebuffer=new Yr(this),this.bindRenderbuffer=new Ht(this),this.bindTexture=new nr(this),this.bindVertexBuffer=new Ki(this),this.bindElementBuffer=new Dn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Jn(this),this.pixelStoreUnpack=new Ni(this),this.pixelStoreUnpackPremultiplyAlpha=new ya(this),this.pixelStoreUnpackFlipY=new Oo(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=c.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(c.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)};ye.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ye.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ye.prototype.createIndexBuffer=function(c,m){return new zt(this,c,m)},ye.prototype.createVertexBuffer=function(c,m,d){return new Bt(this,c,m,d)},ye.prototype.createRenderbuffer=function(c,m,d){var x=this.gl,k=x.createRenderbuffer();return this.bindRenderbuffer.set(k),x.renderbufferStorage(x.RENDERBUFFER,c,m,d),this.bindRenderbuffer.set(null),k},ye.prototype.createFramebuffer=function(c,m,d){return new le(this,c,m,d)},ye.prototype.clear=function(c){var m=c.color,d=c.depth,x=this.gl,k=0;m&&(k|=x.COLOR_BUFFER_BIT,this.clearColor.set(m),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(k|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),x.clear(k)},ye.prototype.setCullFace=function(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))},ye.prototype.setDepthMode=function(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)},ye.prototype.setStencilMode=function(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)},ye.prototype.setColorMode=function(c){f.deepEqual(c.blendFunction,Oe.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)},ye.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Me=function(c){function m(d,x,k){var L=this;c.call(this),this.id=d,this.dispatcher=k,this.on("data",function(B){B.dataType==="source"&&B.sourceDataType==="metadata"&&(L._sourceLoaded=!0),L._sourceLoaded&&!L._paused&&B.dataType==="source"&&B.sourceDataType==="content"&&(L.reload(),L.transform&&L.update(L.transform))}),this.on("error",function(){L._sourceErrored=!0}),this._source=function(B,q,$,ie){var he=new Xi[q.type](B,q,$,ie);if(he.id!==B)throw new Error("Expected Source id to be "+B+" instead of "+he.id);return f.bindAll(["load","abort","unload","serialize","prepare"],he),he}(d,x,k,this),this._tiles={},this._cache=new zi(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new f.SourceFeatureState}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.onAdd=function(d){this.map=d,this._maxTileCacheSize=d?d._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(d)},m.prototype.onRemove=function(d){this._source&&this._source.onRemove&&this._source.onRemove(d)},m.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var d in this._tiles){var x=this._tiles[d];if(x.state!=="loaded"&&x.state!=="errored")return!1}return!0},m.prototype.getSource=function(){return this._source},m.prototype.pause=function(){this._paused=!0},m.prototype.resume=function(){if(this._paused){var d=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,d&&this.reload(),this.transform&&this.update(this.transform)}},m.prototype._loadTile=function(d,x){return this._source.loadTile(d,x)},m.prototype._unloadTile=function(d){if(this._source.unloadTile)return this._source.unloadTile(d,function(){})},m.prototype._abortTile=function(d){if(this._source.abortTile)return this._source.abortTile(d,function(){})},m.prototype.serialize=function(){return this._source.serialize()},m.prototype.prepare=function(d){for(var x in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var k=this._tiles[x];k.upload(d),k.prepare(this.map.style.imageManager)}},m.prototype.getIds=function(){return f.values(this._tiles).map(function(d){return d.tileID}).sort(Qe).map(function(d){return d.key})},m.prototype.getRenderableIds=function(d){var x=this,k=[];for(var L in this._tiles)this._isIdRenderable(L,d)&&k.push(this._tiles[L]);return d?k.sort(function(B,q){var $=B.tileID,ie=q.tileID,he=new f.Point($.canonical.x,$.canonical.y)._rotate(x.transform.angle),de=new f.Point(ie.canonical.x,ie.canonical.y)._rotate(x.transform.angle);return $.overscaledZ-ie.overscaledZ||de.y-he.y||de.x-he.x}).map(function(B){return B.tileID.key}):k.map(function(B){return B.tileID}).sort(Qe).map(function(B){return B.key})},m.prototype.hasRenderableParent=function(d){var x=this.findLoadedParent(d,0);return!!x&&this._isIdRenderable(x.tileID.key)},m.prototype._isIdRenderable=function(d,x){return this._tiles[d]&&this._tiles[d].hasData()&&!this._coveredTiles[d]&&(x||!this._tiles[d].holdingForFade())},m.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var d in this._cache.reset(),this._tiles)this._tiles[d].state!=="errored"&&this._reloadTile(d,"reloading")},m.prototype._reloadTile=function(d,x){var k=this._tiles[d];k&&(k.state!=="loading"&&(k.state=x),this._loadTile(k,this._tileLoaded.bind(this,k,d,x)))},m.prototype._tileLoaded=function(d,x,k,L){if(L)return d.state="errored",void(L.status!==404?this._source.fire(new f.ErrorEvent(L,{tile:d})):this.update(this.transform));d.timeAdded=f.browser.now(),k==="expired"&&(d.refreshedUponExpiration=!0),this._setTileReloadTimer(x,d),this.getSource().type==="raster-dem"&&d.dem&&this._backfillDEM(d),this._state.initializeTileState(d,this.map?this.map.painter:null),this._source.fire(new f.Event("data",{dataType:"source",tile:d,coord:d.tileID}))},m.prototype._backfillDEM=function(d){for(var x=this.getRenderableIds(),k=0;k<x.length;k++){var L=x[k];if(d.neighboringTiles&&d.neighboringTiles[L]){var B=this.getTileByID(L);q(d,B),q(B,d)}}function q($,ie){$.needsHillshadePrepare=!0;var he=ie.tileID.canonical.x-$.tileID.canonical.x,de=ie.tileID.canonical.y-$.tileID.canonical.y,me=Math.pow(2,$.tileID.canonical.z),Ce=ie.tileID.key;he===0&&de===0||Math.abs(de)>1||(Math.abs(he)>1&&(Math.abs(he+me)===1?he+=me:Math.abs(he-me)===1&&(he-=me)),ie.dem&&$.dem&&($.dem.backfillBorder(ie.dem,he,de),$.neighboringTiles&&$.neighboringTiles[Ce]&&($.neighboringTiles[Ce].backfilled=!0)))}},m.prototype.getTile=function(d){return this.getTileByID(d.key)},m.prototype.getTileByID=function(d){return this._tiles[d]},m.prototype._retainLoadedChildren=function(d,x,k,L){for(var B in this._tiles){var q=this._tiles[B];if(!(L[B]||!q.hasData()||q.tileID.overscaledZ<=x||q.tileID.overscaledZ>k)){for(var $=q.tileID;q&&q.tileID.overscaledZ>x+1;){var ie=q.tileID.scaledTo(q.tileID.overscaledZ-1);(q=this._tiles[ie.key])&&q.hasData()&&($=ie)}for(var he=$;he.overscaledZ>x;)if(d[(he=he.scaledTo(he.overscaledZ-1)).key]){L[$.key]=$;break}}}},m.prototype.findLoadedParent=function(d,x){if(d.key in this._loadedParentTiles){var k=this._loadedParentTiles[d.key];return k&&k.tileID.overscaledZ>=x?k:null}for(var L=d.overscaledZ-1;L>=x;L--){var B=d.scaledTo(L),q=this._getLoadedTile(B);if(q)return q}},m.prototype._getLoadedTile=function(d){var x=this._tiles[d.key];return x&&x.hasData()?x:this._cache.getByKey(d.wrapped().key)},m.prototype.updateCacheSize=function(d){var x=Math.ceil(d.width/this._source.tileSize)+1,k=Math.ceil(d.height/this._source.tileSize)+1,L=Math.floor(x*k*5),B=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,L):L;this._cache.setMaxSize(B)},m.prototype.handleWrapJump=function(d){var x=Math.round((d-(this._prevLng===void 0?d:this._prevLng))/360);if(this._prevLng=d,x){var k={};for(var L in this._tiles){var B=this._tiles[L];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+x),k[B.tileID.key]=B}for(var q in this._tiles=k,this._timers)clearTimeout(this._timers[q]),delete this._timers[q];for(var $ in this._tiles)this._setTileReloadTimer($,this._tiles[$])}},m.prototype.update=function(d){var x=this;if(this.transform=d,this._sourceLoaded&&!this._paused){var k;this.updateCacheSize(d),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?k=d.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(It){return new f.OverscaledTileID(It.canonical.z,It.wrap,It.canonical.z,It.canonical.x,It.canonical.y)}):(k=d.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(k=k.filter(function(It){return x._source.hasTile(It)}))):k=[];var L=d.coveringZoomLevel(this._source),B=Math.max(L-m.maxOverzooming,this._source.minzoom),q=Math.max(L+m.maxUnderzooming,this._source.minzoom),$=this._updateRetainedTiles(k,L);if(ae(this._source.type)){for(var ie={},he={},de=0,me=Object.keys($);de<me.length;de+=1){var Ce=me[de],Te=$[Ce],Le=this._tiles[Ce];if(Le&&!(Le.fadeEndTime&&Le.fadeEndTime<=f.browser.now())){var xe=this.findLoadedParent(Te,B);xe&&(this._addTile(xe.tileID),ie[xe.tileID.key]=xe.tileID),he[Ce]=Te}}for(var ze in this._retainLoadedChildren(he,L,q,$),ie)$[ze]||(this._coveredTiles[ze]=!0,$[ze]=ie[ze])}for(var Fe in $)this._tiles[Fe].clearFadeHold();for(var $e=0,ot=f.keysDifference(this._tiles,$);$e<ot.length;$e+=1){var at=ot[$e],st=this._tiles[at];st.hasSymbolBuckets&&!st.holdingForFade()?st.setHoldDuration(this.map._fadeDuration):st.hasSymbolBuckets&&!st.symbolFadeFinished()||this._removeTile(at)}this._updateLoadedParentTileCache()}},m.prototype.releaseSymbolFadeTiles=function(){for(var d in this._tiles)this._tiles[d].holdingForFade()&&this._removeTile(d)},m.prototype._updateRetainedTiles=function(d,x){for(var k={},L={},B=Math.max(x-m.maxOverzooming,this._source.minzoom),q=Math.max(x+m.maxUnderzooming,this._source.minzoom),$={},ie=0,he=d;ie<he.length;ie+=1){var de=he[ie],me=this._addTile(de);k[de.key]=de,me.hasData()||x<this._source.maxzoom&&($[de.key]=de)}this._retainLoadedChildren($,x,q,k);for(var Ce=0,Te=d;Ce<Te.length;Ce+=1){var Le=Te[Ce],xe=this._tiles[Le.key];if(!xe.hasData()){if(x+1>this._source.maxzoom){var ze=Le.children(this._source.maxzoom)[0],Fe=this.getTile(ze);if(Fe&&Fe.hasData()){k[ze.key]=ze;continue}}else{var $e=Le.children(this._source.maxzoom);if(k[$e[0].key]&&k[$e[1].key]&&k[$e[2].key]&&k[$e[3].key])continue}for(var ot=xe.wasRequested(),at=Le.overscaledZ-1;at>=B;--at){var st=Le.scaledTo(at);if(L[st.key]||(L[st.key]=!0,!(xe=this.getTile(st))&&ot&&(xe=this._addTile(st)),xe&&(k[st.key]=st,ot=xe.wasRequested(),xe.hasData())))break}}}return k},m.prototype._updateLoadedParentTileCache=function(){for(var d in this._loadedParentTiles={},this._tiles){for(var x=[],k=void 0,L=this._tiles[d].tileID;L.overscaledZ>0;){if(L.key in this._loadedParentTiles){k=this._loadedParentTiles[L.key];break}x.push(L.key);var B=L.scaledTo(L.overscaledZ-1);if(k=this._getLoadedTile(B))break;L=B}for(var q=0,$=x;q<$.length;q+=1)this._loadedParentTiles[$[q]]=k}},m.prototype._addTile=function(d){var x=this._tiles[d.key];if(x)return x;(x=this._cache.getAndRemove(d))&&(this._setTileReloadTimer(d.key,x),x.tileID=d,this._state.initializeTileState(x,this.map?this.map.painter:null),this._cacheTimers[d.key]&&(clearTimeout(this._cacheTimers[d.key]),delete this._cacheTimers[d.key],this._setTileReloadTimer(d.key,x)));var k=Boolean(x);return k||(x=new f.Tile(d,this._source.tileSize*d.overscaleFactor()),this._loadTile(x,this._tileLoaded.bind(this,x,d.key,x.state))),x?(x.uses++,this._tiles[d.key]=x,k||this._source.fire(new f.Event("dataloading",{tile:x,coord:x.tileID,dataType:"source"})),x):null},m.prototype._setTileReloadTimer=function(d,x){var k=this;d in this._timers&&(clearTimeout(this._timers[d]),delete this._timers[d]);var L=x.getExpiryTimeout();L&&(this._timers[d]=setTimeout(function(){k._reloadTile(d,"expired"),delete k._timers[d]},L))},m.prototype._removeTile=function(d){var x=this._tiles[d];x&&(x.uses--,delete this._tiles[d],this._timers[d]&&(clearTimeout(this._timers[d]),delete this._timers[d]),x.uses>0||(x.hasData()&&x.state!=="reloading"?this._cache.add(x.tileID,x,x.getExpiryTimeout()):(x.aborted=!0,this._abortTile(x),this._unloadTile(x))))},m.prototype.clearTiles=function(){for(var d in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(d);this._cache.reset()},m.prototype.tilesIn=function(d,x,k){var L=this,B=[],q=this.transform;if(!q)return B;for(var $=k?q.getCameraQueryGeometry(d):d,ie=d.map(function(at){return q.pointCoordinate(at)}),he=$.map(function(at){return q.pointCoordinate(at)}),de=this.getIds(),me=1/0,Ce=1/0,Te=-1/0,Le=-1/0,xe=0,ze=he;xe<ze.length;xe+=1){var Fe=ze[xe];me=Math.min(me,Fe.x),Ce=Math.min(Ce,Fe.y),Te=Math.max(Te,Fe.x),Le=Math.max(Le,Fe.y)}for(var $e=function(at){var st=L._tiles[de[at]];if(!st.holdingForFade()){var It=st.tileID,Dt=Math.pow(2,q.zoom-st.tileID.overscaledZ),Lt=x*st.queryPadding*f.EXTENT/st.tileSize/Dt,$t=[It.getTilePoint(new f.MercatorCoordinate(me,Ce)),It.getTilePoint(new f.MercatorCoordinate(Te,Le))];if($t[0].x-Lt<f.EXTENT&&$t[0].y-Lt<f.EXTENT&&$t[1].x+Lt>=0&&$t[1].y+Lt>=0){var mi=ie.map(function(di){return It.getTilePoint(di)}),bi=he.map(function(di){return It.getTilePoint(di)});B.push({tile:st,tileID:It,queryGeometry:mi,cameraQueryGeometry:bi,scale:Dt})}}},ot=0;ot<de.length;ot++)$e(ot);return B},m.prototype.getVisibleCoordinates=function(d){for(var x=this,k=this.getRenderableIds(d).map(function($){return x._tiles[$].tileID}),L=0,B=k;L<B.length;L+=1){var q=B[L];q.posMatrix=this.transform.calculatePosMatrix(q.toUnwrapped())}return k},m.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(ae(this._source.type))for(var d in this._tiles){var x=this._tiles[d];if(x.fadeEndTime!==void 0&&x.fadeEndTime>=f.browser.now())return!0}return!1},m.prototype.setFeatureState=function(d,x,k){this._state.updateState(d=d||"_geojsonTileLayer",x,k)},m.prototype.removeFeatureState=function(d,x,k){this._state.removeFeatureState(d=d||"_geojsonTileLayer",x,k)},m.prototype.getFeatureState=function(d,x){return this._state.getState(d=d||"_geojsonTileLayer",x)},m.prototype.setDependencies=function(d,x,k){var L=this._tiles[d];L&&L.setDependencies(x,k)},m.prototype.reloadTilesForDependencies=function(d,x){for(var k in this._tiles)this._tiles[k].hasDependency(d,x)&&this._reloadTile(k,"reloading");this._cache.filter(function(L){return!L.hasDependency(d,x)})},m}(f.Evented);function Qe(c,m){var d=Math.abs(2*c.wrap)-+(c.wrap<0),x=Math.abs(2*m.wrap)-+(m.wrap<0);return c.overscaledZ-m.overscaledZ||x-d||m.canonical.y-c.canonical.y||m.canonical.x-c.canonical.x}function ae(c){return c==="raster"||c==="image"||c==="video"}function W(){return new f.window.Worker(Ui.workerUrl)}Me.maxOverzooming=10,Me.maxUnderzooming=3;var X="mapboxgl_preloaded_worker_pool",ne=function(){this.active={}};ne.prototype.acquire=function(c){if(!this.workers)for(this.workers=[];this.workers.length<ne.workerCount;)this.workers.push(new W);return this.active[c]=!0,this.workers.slice()},ne.prototype.release=function(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(function(m){m.terminate()}),this.workers=null)},ne.prototype.isPreloaded=function(){return!!this.active[X]},ne.prototype.numActive=function(){return Object.keys(this.active).length};var ce,_e=Math.floor(f.browser.hardwareConcurrency/2);function fe(){return ce||(ce=new ne),ce}function Ee(c,m){var d={};for(var x in c)x!=="ref"&&(d[x]=c[x]);return f.refProperties.forEach(function(k){k in m&&(d[k]=m[k])}),d}function we(c){c=c.slice();for(var m=Object.create(null),d=0;d<c.length;d++)m[c[d].id]=c[d];for(var x=0;x<c.length;x++)"ref"in c[x]&&(c[x]=Ee(c[x],m[c[x].ref]));return c}ne.workerCount=Math.max(Math.min(_e,6),1);var Ie={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function et(c,m,d){d.push({command:Ie.addSource,args:[c,m[c]]})}function Ke(c,m,d){m.push({command:Ie.removeSource,args:[c]}),d[c]=!0}function tt(c,m,d,x){Ke(c,d,x),et(c,m,d)}function Ut(c,m,d){var x;for(x in c[d])if(c[d].hasOwnProperty(x)&&x!=="data"&&!f.deepEqual(c[d][x],m[d][x]))return!1;for(x in m[d])if(m[d].hasOwnProperty(x)&&x!=="data"&&!f.deepEqual(c[d][x],m[d][x]))return!1;return!0}function At(c,m,d,x,k,L){var B;for(B in m=m||{},c=c||{})c.hasOwnProperty(B)&&(f.deepEqual(c[B],m[B])||d.push({command:L,args:[x,B,m[B],k]}));for(B in m)m.hasOwnProperty(B)&&!c.hasOwnProperty(B)&&(f.deepEqual(c[B],m[B])||d.push({command:L,args:[x,B,m[B],k]}))}function Ot(c){return c.id}function Vt(c,m){return c[m.id]=m,c}var Hi=function(c,m){this.reset(c,m)};Hi.prototype.reset=function(c,m){this.points=c||[],this._distances=[0];for(var d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Hi.prototype.lerp=function(c){if(this.points.length===1)return this.points[0];c=f.clamp(c,0,1);for(var m=1,d=this._distances[m],x=c*this.paddedLength+this.padding;d<x&&m<this._distances.length;)d=this._distances[++m];var k=m-1,L=this._distances[k],B=d-L,q=B>0?(x-L)/B:0;return this.points[k].mult(1-q).add(this.points[m].mult(q))};var gi=function(c,m,d){var x=this.boxCells=[],k=this.circleCells=[];this.xCellCount=Math.ceil(c/d),this.yCellCount=Math.ceil(m/d);for(var L=0;L<this.xCellCount*this.yCellCount;L++)x.push([]),k.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=m,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0};function Ci(c,m,d,x,k){var L=f.create();return m?(f.scale(L,L,[1/k,1/k,1]),d||f.rotateZ(L,L,x.angle)):f.multiply(L,x.labelPlaneMatrix,c),L}function ci(c,m,d,x,k){if(m){var L=f.clone(c);return f.scale(L,L,[k,k,1]),d||f.rotateZ(L,L,-x.angle),L}return x.glCoordMatrix}function Kt(c,m){var d=[c.x,c.y,0,1];Rn(d,d,m);var x=d[3];return{point:new f.Point(d[0]/x,d[1]/x),signedDistanceFromCamera:x}}function Di(c,m){return .5+c/m*.5}function Ir(c,m){var d=c[0]/c[3],x=c[1]/c[3];return d>=-m[0]&&d<=m[0]&&x>=-m[1]&&x<=m[1]}function kn(c,m,d,x,k,L,B,q){var $=x?c.textSizeData:c.iconSizeData,ie=f.evaluateSizeForZoom($,d.transform.zoom),he=[256/d.width*2+1,256/d.height*2+1],de=x?c.text.dynamicLayoutVertexArray:c.icon.dynamicLayoutVertexArray;de.clear();for(var me=c.lineVertexArray,Ce=x?c.text.placedSymbolArray:c.icon.placedSymbolArray,Te=d.transform.width/d.transform.height,Le=!1,xe=0;xe<Ce.length;xe++){var ze=Ce.get(xe);if(ze.hidden||ze.writingMode===f.WritingMode.vertical&&!Le)Co(ze.numGlyphs,de);else{Le=!1;var Fe=[ze.anchorX,ze.anchorY,0,1];if(f.transformMat4(Fe,Fe,m),Ir(Fe,he)){var $e=Di(d.transform.cameraToCenterDistance,Fe[3]),ot=f.evaluateSizeForFeature($,ie,ze),at=B?ot/$e:ot*$e,st=new f.Point(ze.anchorX,ze.anchorY),It=Kt(st,k).point,Dt={},Lt=Ol(ze,at,!1,q,m,k,L,c.glyphOffsetArray,me,de,It,st,Dt,Te);Le=Lt.useVertical,(Lt.notEnoughRoom||Le||Lt.needsFlipping&&Ol(ze,at,!0,q,m,k,L,c.glyphOffsetArray,me,de,It,st,Dt,Te).notEnoughRoom)&&Co(ze.numGlyphs,de)}else Co(ze.numGlyphs,de)}}x?c.text.dynamicLayoutVertexBuffer.updateData(de):c.icon.dynamicLayoutVertexBuffer.updateData(de)}function Cr(c,m,d,x,k,L,B,q,$,ie,he){var de=q.glyphStartIndex+q.numGlyphs,me=q.lineStartIndex,Ce=q.lineStartIndex+q.lineLength,Te=m.getoffsetX(q.glyphStartIndex),Le=m.getoffsetX(de-1),xe=In(c*Te,d,x,k,L,B,q.segment,me,Ce,$,ie,he);if(!xe)return null;var ze=In(c*Le,d,x,k,L,B,q.segment,me,Ce,$,ie,he);return ze?{first:xe,last:ze}:null}function Eo(c,m,d,x){return c===f.WritingMode.horizontal&&Math.abs(d.y-m.y)>Math.abs(d.x-m.x)*x?{useVertical:!0}:(c===f.WritingMode.vertical?m.y<d.y:m.x>d.x)?{needsFlipping:!0}:null}function Ol(c,m,d,x,k,L,B,q,$,ie,he,de,me,Ce){var Te,Le=m/24,xe=c.lineOffsetX*Le,ze=c.lineOffsetY*Le;if(c.numGlyphs>1){var Fe=c.glyphStartIndex+c.numGlyphs,$e=c.lineStartIndex,ot=c.lineStartIndex+c.lineLength,at=Cr(Le,q,xe,ze,d,he,de,c,$,L,me);if(!at)return{notEnoughRoom:!0};var st=Kt(at.first.point,B).point,It=Kt(at.last.point,B).point;if(x&&!d){var Dt=Eo(c.writingMode,st,It,Ce);if(Dt)return Dt}Te=[at.first];for(var Lt=c.glyphStartIndex+1;Lt<Fe-1;Lt++)Te.push(In(Le*q.getoffsetX(Lt),xe,ze,d,he,de,c.segment,$e,ot,$,L,me));Te.push(at.last)}else{if(x&&!d){var $t=Kt(de,k).point,mi=c.lineStartIndex+c.segment+1,bi=new f.Point($.getx(mi),$.gety(mi)),di=Kt(bi,k),ar=di.signedDistanceFromCamera>0?di.point:qr(de,bi,$t,1,k),ni=Eo(c.writingMode,$t,ar,Ce);if(ni)return ni}var Bi=In(Le*q.getoffsetX(c.glyphStartIndex),xe,ze,d,he,de,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,$,L,me);if(!Bi)return{notEnoughRoom:!0};Te=[Bi]}for(var er=0,Li=Te;er<Li.length;er+=1){var Pi=Li[er];f.addDynamicAttributes(ie,Pi.point,Pi.angle)}return{}}function qr(c,m,d,x,k){var L=Kt(c.add(c.sub(m)._unit()),k).point,B=d.sub(L);return d.add(B._mult(x/B.mag()))}function In(c,m,d,x,k,L,B,q,$,ie,he,de){var me=x?c-m:c+m,Ce=me>0?1:-1,Te=0;x&&(Ce*=-1,Te=Math.PI),Ce<0&&(Te+=Math.PI);for(var Le=Ce>0?q+B:q+B+1,xe=k,ze=k,Fe=0,$e=0,ot=Math.abs(me),at=[];Fe+$e<=ot;){if((Le+=Ce)<q||Le>=$)return null;if(ze=xe,at.push(xe),(xe=de[Le])===void 0){var st=new f.Point(ie.getx(Le),ie.gety(Le)),It=Kt(st,he);if(It.signedDistanceFromCamera>0)xe=de[Le]=It.point;else{var Dt=Le-Ce;xe=qr(Fe===0?L:new f.Point(ie.getx(Dt),ie.gety(Dt)),st,ze,ot-Fe+1,he)}}Fe+=$e,$e=ze.dist(xe)}var Lt=(ot-Fe)/$e,$t=xe.sub(ze),mi=$t.mult(Lt)._add(ze);mi._add($t._unit()._perp()._mult(d*Ce));var bi=Te+Math.atan2(xe.y-ze.y,xe.x-ze.x);return at.push(mi),{point:mi,angle:bi,path:at}}gi.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},gi.prototype.insert=function(c,m,d,x,k){this._forEachCell(m,d,x,k,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(m),this.bboxes.push(d),this.bboxes.push(x),this.bboxes.push(k)},gi.prototype.insertCircle=function(c,m,d,x){this._forEachCell(m-x,d-x,m+x,d+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(m),this.circles.push(d),this.circles.push(x)},gi.prototype._insertBoxCell=function(c,m,d,x,k,L){this.boxCells[k].push(L)},gi.prototype._insertCircleCell=function(c,m,d,x,k,L){this.circleCells[k].push(L)},gi.prototype._query=function(c,m,d,x,k,L){if(d<0||c>this.width||x<0||m>this.height)return!k&&[];var B=[];if(c<=0&&m<=0&&this.width<=d&&this.height<=x){if(k)return!0;for(var q=0;q<this.boxKeys.length;q++)B.push({key:this.boxKeys[q],x1:this.bboxes[4*q],y1:this.bboxes[4*q+1],x2:this.bboxes[4*q+2],y2:this.bboxes[4*q+3]});for(var $=0;$<this.circleKeys.length;$++){var ie=this.circles[3*$],he=this.circles[3*$+1],de=this.circles[3*$+2];B.push({key:this.circleKeys[$],x1:ie-de,y1:he-de,x2:ie+de,y2:he+de})}return L?B.filter(L):B}return this._forEachCell(c,m,d,x,this._queryCell,B,{hitTest:k,seenUids:{box:{},circle:{}}},L),k?B.length>0:B},gi.prototype._queryCircle=function(c,m,d,x,k){var L=c-d,B=c+d,q=m-d,$=m+d;if(B<0||L>this.width||$<0||q>this.height)return!x&&[];var ie=[];return this._forEachCell(L,q,B,$,this._queryCellCircle,ie,{hitTest:x,circle:{x:c,y:m,radius:d},seenUids:{box:{},circle:{}}},k),x?ie.length>0:ie},gi.prototype.query=function(c,m,d,x,k){return this._query(c,m,d,x,!1,k)},gi.prototype.hitTest=function(c,m,d,x,k){return this._query(c,m,d,x,!0,k)},gi.prototype.hitTestCircle=function(c,m,d,x){return this._queryCircle(c,m,d,!0,x)},gi.prototype._queryCell=function(c,m,d,x,k,L,B,q){var $=B.seenUids,ie=this.boxCells[k];if(ie!==null)for(var he=this.bboxes,de=0,me=ie;de<me.length;de+=1){var Ce=me[de];if(!$.box[Ce]){$.box[Ce]=!0;var Te=4*Ce;if(c<=he[Te+2]&&m<=he[Te+3]&&d>=he[Te+0]&&x>=he[Te+1]&&(!q||q(this.boxKeys[Ce]))){if(B.hitTest)return L.push(!0),!0;L.push({key:this.boxKeys[Ce],x1:he[Te],y1:he[Te+1],x2:he[Te+2],y2:he[Te+3]})}}}var Le=this.circleCells[k];if(Le!==null)for(var xe=this.circles,ze=0,Fe=Le;ze<Fe.length;ze+=1){var $e=Fe[ze];if(!$.circle[$e]){$.circle[$e]=!0;var ot=3*$e;if(this._circleAndRectCollide(xe[ot],xe[ot+1],xe[ot+2],c,m,d,x)&&(!q||q(this.circleKeys[$e]))){if(B.hitTest)return L.push(!0),!0;var at=xe[ot],st=xe[ot+1],It=xe[ot+2];L.push({key:this.circleKeys[$e],x1:at-It,y1:st-It,x2:at+It,y2:st+It})}}}},gi.prototype._queryCellCircle=function(c,m,d,x,k,L,B,q){var $=B.circle,ie=B.seenUids,he=this.boxCells[k];if(he!==null)for(var de=this.bboxes,me=0,Ce=he;me<Ce.length;me+=1){var Te=Ce[me];if(!ie.box[Te]){ie.box[Te]=!0;var Le=4*Te;if(this._circleAndRectCollide($.x,$.y,$.radius,de[Le+0],de[Le+1],de[Le+2],de[Le+3])&&(!q||q(this.boxKeys[Te])))return L.push(!0),!0}}var xe=this.circleCells[k];if(xe!==null)for(var ze=this.circles,Fe=0,$e=xe;Fe<$e.length;Fe+=1){var ot=$e[Fe];if(!ie.circle[ot]){ie.circle[ot]=!0;var at=3*ot;if(this._circlesCollide(ze[at],ze[at+1],ze[at+2],$.x,$.y,$.radius)&&(!q||q(this.circleKeys[ot])))return L.push(!0),!0}}},gi.prototype._forEachCell=function(c,m,d,x,k,L,B,q){for(var $=this._convertToXCellCoord(c),ie=this._convertToYCellCoord(m),he=this._convertToXCellCoord(d),de=this._convertToYCellCoord(x),me=$;me<=he;me++)for(var Ce=ie;Ce<=de;Ce++)if(k.call(this,c,m,d,x,this.xCellCount*Ce+me,L,B,q))return},gi.prototype._convertToXCellCoord=function(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))},gi.prototype._convertToYCellCoord=function(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))},gi.prototype._circlesCollide=function(c,m,d,x,k,L){var B=x-c,q=k-m,$=d+L;return $*$>B*B+q*q},gi.prototype._circleAndRectCollide=function(c,m,d,x,k,L,B){var q=(L-x)/2,$=Math.abs(c-(x+q));if($>q+d)return!1;var ie=(B-k)/2,he=Math.abs(m-(k+ie));if(he>ie+d)return!1;if($<=q||he<=ie)return!0;var de=$-q,me=he-ie;return de*de+me*me<=d*d};var qs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Co(c,m){for(var d=0;d<c;d++){var x=m.length;m.resize(x+4),m.float32.set(qs,3*x)}}function Rn(c,m,d){var x=m[0],k=m[1];return c[0]=d[0]*x+d[4]*k+d[12],c[1]=d[1]*x+d[5]*k+d[13],c[3]=d[3]*x+d[7]*k+d[15],c}var oa=function(c,m,d){m===void 0&&(m=new gi(c.width+200,c.height+200,25)),d===void 0&&(d=new gi(c.width+200,c.height+200,25)),this.transform=c,this.grid=m,this.ignoredGrid=d,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+100,this.screenBottomBoundary=c.height+100,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200};function Qr(c,m,d){return m*(f.EXTENT/(c.tileSize*Math.pow(2,d-c.tileID.overscaledZ)))}oa.prototype.placeCollisionBox=function(c,m,d,x,k){var L=this.projectAndGetPerspectiveRatio(x,c.anchorPointX,c.anchorPointY),B=d*L.perspectiveRatio,q=c.x1*B+L.point.x,$=c.y1*B+L.point.y,ie=c.x2*B+L.point.x,he=c.y2*B+L.point.y;return!this.isInsideGrid(q,$,ie,he)||!m&&this.grid.hitTest(q,$,ie,he,k)?{box:[],offscreen:!1}:{box:[q,$,ie,he],offscreen:this.isOffscreen(q,$,ie,he)}},oa.prototype.placeCollisionCircles=function(c,m,d,x,k,L,B,q,$,ie,he,de,me){var Ce=[],Te=new f.Point(m.anchorX,m.anchorY),Le=Kt(Te,L),xe=Di(this.transform.cameraToCenterDistance,Le.signedDistanceFromCamera),ze=(ie?k/xe:k*xe)/f.ONE_EM,Fe=Kt(Te,B).point,$e=Cr(ze,x,m.lineOffsetX*ze,m.lineOffsetY*ze,!1,Fe,Te,m,d,B,{}),ot=!1,at=!1,st=!0;if($e){for(var It=.5*de*xe+me,Dt=new f.Point(-100,-100),Lt=new f.Point(this.screenRightBoundary,this.screenBottomBoundary),$t=new Hi,mi=$e.first,bi=$e.last,di=[],ar=mi.path.length-1;ar>=1;ar--)di.push(mi.path[ar]);for(var ni=1;ni<bi.path.length;ni++)di.push(bi.path[ni]);var Bi=2.5*It;if(q){var er=di.map(function(wa){return Kt(wa,q)});di=er.some(function(wa){return wa.signedDistanceFromCamera<=0})?[]:er.map(function(wa){return wa.point})}var Li=[];if(di.length>0){for(var Pi=di[0].clone(),ji=di[0].clone(),Ti=1;Ti<di.length;Ti++)Pi.x=Math.min(Pi.x,di[Ti].x),Pi.y=Math.min(Pi.y,di[Ti].y),ji.x=Math.max(ji.x,di[Ti].x),ji.y=Math.max(ji.y,di[Ti].y);Li=Pi.x>=Dt.x&&ji.x<=Lt.x&&Pi.y>=Dt.y&&ji.y<=Lt.y?[di]:ji.x<Dt.x||Pi.x>Lt.x||ji.y<Dt.y||Pi.y>Lt.y?[]:f.clipLine([di],Dt.x,Dt.y,Lt.x,Lt.y)}for(var vi=0,mn=Li;vi<mn.length;vi+=1){var Cn;$t.reset(mn[vi],.25*It),Cn=$t.length<=.5*It?1:Math.ceil($t.paddedLength/Bi)+1;for(var On=0;On<Cn;On++){var To=On/Math.max(Cn-1,1),xn=$t.lerp(To),ur=xn.x+100,Jo=xn.y+100;Ce.push(ur,Jo,It,0);var jo=ur-It,xa=Jo-It,Yn=ur+It,ba=Jo+It;if(st=st&&this.isOffscreen(jo,xa,Yn,ba),at=at||this.isInsideGrid(jo,xa,Yn,ba),!c&&this.grid.hitTestCircle(ur,Jo,It,he)&&(ot=!0,!$))return{circles:[],offscreen:!1,collisionDetected:ot}}}}return{circles:!$&&ot||!at?[]:Ce,offscreen:st,collisionDetected:ot}},oa.prototype.queryRenderedSymbols=function(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var m=[],d=1/0,x=1/0,k=-1/0,L=-1/0,B=0,q=c;B<q.length;B+=1){var $=q[B],ie=new f.Point($.x+100,$.y+100);d=Math.min(d,ie.x),x=Math.min(x,ie.y),k=Math.max(k,ie.x),L=Math.max(L,ie.y),m.push(ie)}for(var he={},de={},me=0,Ce=this.grid.query(d,x,k,L).concat(this.ignoredGrid.query(d,x,k,L));me<Ce.length;me+=1){var Te=Ce[me],Le=Te.key;if(he[Le.bucketInstanceId]===void 0&&(he[Le.bucketInstanceId]={}),!he[Le.bucketInstanceId][Le.featureIndex]){var xe=[new f.Point(Te.x1,Te.y1),new f.Point(Te.x2,Te.y1),new f.Point(Te.x2,Te.y2),new f.Point(Te.x1,Te.y2)];f.polygonIntersectsPolygon(m,xe)&&(he[Le.bucketInstanceId][Le.featureIndex]=!0,de[Le.bucketInstanceId]===void 0&&(de[Le.bucketInstanceId]=[]),de[Le.bucketInstanceId].push(Le.featureIndex))}}return de},oa.prototype.insertCollisionBox=function(c,m,d,x,k){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:x,collisionGroupID:k},c[0],c[1],c[2],c[3])},oa.prototype.insertCollisionCircles=function(c,m,d,x,k){for(var L=m?this.ignoredGrid:this.grid,B={bucketInstanceId:d,featureIndex:x,collisionGroupID:k},q=0;q<c.length;q+=4)L.insertCircle(B,c[q],c[q+1],c[q+2])},oa.prototype.projectAndGetPerspectiveRatio=function(c,m,d){var x=[m,d,0,1];return Rn(x,x,c),{point:new f.Point((x[0]/x[3]+1)/2*this.transform.width+100,(-x[1]/x[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/x[3]*.5}},oa.prototype.isOffscreen=function(c,m,d,x){return d<100||c>=this.screenRightBoundary||x<100||m>this.screenBottomBoundary},oa.prototype.isInsideGrid=function(c,m,d,x){return d>=0&&c<this.gridRightBoundary&&x>=0&&m<this.gridBottomBoundary},oa.prototype.getViewportMatrix=function(){var c=f.identity([]);return f.translate(c,c,[-100,-100,0]),c};var aa=function(c,m,d,x){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?m:-m))):x&&d?1:0,this.placed=d};aa.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Fo=function(c,m,d,x,k){this.text=new aa(c?c.text:null,m,d,k),this.icon=new aa(c?c.icon:null,m,x,k)};Fo.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Qu=function(c,m,d){this.text=c,this.icon=m,this.skipFade=d},sa=function(){this.invProjMatrix=f.create(),this.viewportMatrix=f.create(),this.circles=[]},Gs=function(c,m,d,x,k){this.bucketInstanceId=c,this.featureIndex=m,this.sourceLayerIndex=d,this.bucketIndex=x,this.tileID=k},ga=function(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}};function Sn(c,m,d,x,k){var L=f.getAnchorAlignment(c),B=-(L.horizontalAlign-.5)*m,q=-(L.verticalAlign-.5)*d,$=f.evaluateVariableOffset(c,x);return new f.Point(B+$[0]*k,q+$[1]*k)}function Zo(c,m,d,x,k,L){var B=c.x1,q=c.x2,$=c.y1,ie=c.y2,he=c.anchorPointX,de=c.anchorPointY,me=new f.Point(m,d);return x&&me._rotate(k?L:-L),{x1:B+me.x,y1:$+me.y,x2:q+me.x,y2:ie+me.y,anchorPointX:he,anchorPointY:de}}ga.prototype.get=function(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){var m=++this.maxGroupID;this.collisionGroups[c]={ID:m,predicate:function(d){return d.collisionGroupID===m}}}return this.collisionGroups[c]};var $n=function(c,m,d,x){this.transform=c.clone(),this.collisionIndex=new oa(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new ga(d),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}};function Oa(c,m,d,x,k){c.emplaceBack(m?1:0,d?1:0,x||0,k||0),c.emplaceBack(m?1:0,d?1:0,x||0,k||0),c.emplaceBack(m?1:0,d?1:0,x||0,k||0),c.emplaceBack(m?1:0,d?1:0,x||0,k||0)}$n.prototype.getBucketParts=function(c,m,d,x){var k=d.getBucket(m),L=d.latestFeatureIndex;if(k&&L&&m.id===k.layerIds[0]){var B=d.collisionBoxArray,q=k.layers[0].layout,$=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),ie=d.tileSize/f.EXTENT,he=this.transform.calculatePosMatrix(d.tileID.toUnwrapped()),de=q.get("text-pitch-alignment")==="map",me=q.get("text-rotation-alignment")==="map",Ce=Qr(d,1,this.transform.zoom),Te=Ci(he,de,me,this.transform,Ce),Le=null;if(de){var xe=ci(he,de,me,this.transform,Ce);Le=f.multiply([],this.transform.labelPlaneMatrix,xe)}this.retainedQueryData[k.bucketInstanceId]=new Gs(k.bucketInstanceId,L,k.sourceLayerIndex,k.index,d.tileID);var ze={bucket:k,layout:q,posMatrix:he,textLabelPlaneMatrix:Te,labelToScreenMatrix:Le,scale:$,textPixelRatio:ie,holdingForFade:d.holdingForFade(),collisionBoxArray:B,partiallyEvaluatedTextSize:f.evaluateSizeForZoom(k.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(k.sourceID)};if(x)for(var Fe=0,$e=k.sortKeyRanges;Fe<$e.length;Fe+=1){var ot=$e[Fe];c.push({sortKey:ot.sortKey,symbolInstanceStart:ot.symbolInstanceStart,symbolInstanceEnd:ot.symbolInstanceEnd,parameters:ze})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:k.symbolInstances.length,parameters:ze})}},$n.prototype.attemptAnchorPlacement=function(c,m,d,x,k,L,B,q,$,ie,he,de,me,Ce,Te){var Le,xe=[de.textOffset0,de.textOffset1],ze=Sn(c,d,x,xe,k),Fe=this.collisionIndex.placeCollisionBox(Zo(m,ze.x,ze.y,L,B,this.transform.angle),he,q,$,ie.predicate);if(!Te||this.collisionIndex.placeCollisionBox(Zo(Te,ze.x,ze.y,L,B,this.transform.angle),he,q,$,ie.predicate).box.length!==0)return Fe.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[de.crossTileID]&&this.prevPlacement.placements[de.crossTileID]&&this.prevPlacement.placements[de.crossTileID].text&&(Le=this.prevPlacement.variableOffsets[de.crossTileID].anchor),this.variableOffsets[de.crossTileID]={textOffset:xe,width:d,height:x,anchor:c,textBoxScale:k,prevAnchor:Le},this.markUsedJustification(me,c,de,Ce),me.allowVerticalPlacement&&(this.markUsedOrientation(me,Ce,de),this.placedOrientations[de.crossTileID]=Ce),{shift:ze,placedGlyphBoxes:Fe}):void 0},$n.prototype.placeLayerBucketPart=function(c,m,d){var x=this,k=c.parameters,L=k.bucket,B=k.layout,q=k.posMatrix,$=k.textLabelPlaneMatrix,ie=k.labelToScreenMatrix,he=k.textPixelRatio,de=k.holdingForFade,me=k.collisionBoxArray,Ce=k.partiallyEvaluatedTextSize,Te=k.collisionGroup,Le=B.get("text-optional"),xe=B.get("icon-optional"),ze=B.get("text-allow-overlap"),Fe=B.get("icon-allow-overlap"),$e=B.get("text-rotation-alignment")==="map",ot=B.get("text-pitch-alignment")==="map",at=B.get("icon-text-fit")!=="none",st=B.get("symbol-z-order")==="viewport-y",It=ze&&(Fe||!L.hasIconData()||xe),Dt=Fe&&(ze||!L.hasTextData()||Le);!L.collisionArrays&&me&&L.deserializeCollisionBoxes(me);var Lt=function(ni,Bi){if(!m[ni.crossTileID])if(de)x.placements[ni.crossTileID]=new Qu(!1,!1,!1);else{var er,Li=!1,Pi=!1,ji=!0,Ti=null,vi={box:null,offscreen:null},mn={box:null,offscreen:null},Cn=null,On=null,To=0,xn=0,ur=0;Bi.textFeatureIndex?To=Bi.textFeatureIndex:ni.useRuntimeCollisionCircles&&(To=ni.featureIndex),Bi.verticalTextFeatureIndex&&(xn=Bi.verticalTextFeatureIndex);var Jo=Bi.textBox;if(Jo){var jo=function(Er){var $o=f.WritingMode.horizontal;if(L.allowVerticalPlacement&&!Er&&x.prevPlacement){var ha=x.prevPlacement.placedOrientations[ni.crossTileID];ha&&(x.placedOrientations[ni.crossTileID]=ha,x.markUsedOrientation(L,$o=ha,ni))}return $o},xa=function(Er,$o){if(L.allowVerticalPlacement&&ni.numVerticalGlyphVertices>0&&Bi.verticalTextBox)for(var ha=0,ou=L.writingModes;ha<ou.length&&(ou[ha]===f.WritingMode.vertical?(vi=$o(),mn=vi):vi=Er(),!(vi&&vi.box&&vi.box.length));ha+=1);else vi=Er()};if(B.get("text-variable-anchor")){var Yn=B.get("text-variable-anchor");if(x.prevPlacement&&x.prevPlacement.variableOffsets[ni.crossTileID]){var ba=x.prevPlacement.variableOffsets[ni.crossTileID];Yn.indexOf(ba.anchor)>0&&(Yn=Yn.filter(function(Er){return Er!==ba.anchor})).unshift(ba.anchor)}var wa=function(Er,$o,ha){for(var ou=Er.x2-Er.x1,Bu=Er.y2-Er.y1,Ou=ni.textBoxScale,rp=at&&!Fe?$o:null,rl={box:[],offscreen:!1},np=ze?2*Yn.length:Yn.length,nl=0;nl<np;++nl){var pc=x.attemptAnchorPlacement(Yn[nl%Yn.length],Er,ou,Bu,Ou,$e,ot,he,q,Te,nl>=Yn.length,ni,L,ha,rp);if(pc&&(rl=pc.placedGlyphBoxes)&&rl.box&&rl.box.length){Li=!0,Ti=pc.shift;break}}return rl};xa(function(){return wa(Jo,Bi.iconBox,f.WritingMode.horizontal)},function(){var Er=Bi.verticalTextBox;return L.allowVerticalPlacement&&!(vi&&vi.box&&vi.box.length)&&ni.numVerticalGlyphVertices>0&&Er?wa(Er,Bi.verticalIconBox,f.WritingMode.vertical):{box:null,offscreen:null}}),vi&&(Li=vi.box,ji=vi.offscreen);var Lu=jo(vi&&vi.box);if(!Li&&x.prevPlacement){var Du=x.prevPlacement.variableOffsets[ni.crossTileID];Du&&(x.variableOffsets[ni.crossTileID]=Du,x.markUsedJustification(L,Du.anchor,ni,Lu))}}else{var il=function(Er,$o){var ha=x.collisionIndex.placeCollisionBox(Er,ze,he,q,Te.predicate);return ha&&ha.box&&ha.box.length&&(x.markUsedOrientation(L,$o,ni),x.placedOrientations[ni.crossTileID]=$o),ha};xa(function(){return il(Jo,f.WritingMode.horizontal)},function(){var Er=Bi.verticalTextBox;return L.allowVerticalPlacement&&ni.numVerticalGlyphVertices>0&&Er?il(Er,f.WritingMode.vertical):{box:null,offscreen:null}}),jo(vi&&vi.box&&vi.box.length)}}if(Li=(er=vi)&&er.box&&er.box.length>0,ji=er&&er.offscreen,ni.useRuntimeCollisionCircles){var Ru=L.text.placedSymbolArray.get(ni.centerJustifiedTextSymbolIndex),ru=f.evaluateSizeForFeature(L.textSizeData,Ce,Ru),Ls=B.get("text-padding");Cn=x.collisionIndex.placeCollisionCircles(ze,Ru,L.lineVertexArray,L.glyphOffsetArray,ru,q,$,ie,d,ot,Te.predicate,ni.collisionCircleDiameter,Ls),Li=ze||Cn.circles.length>0&&!Cn.collisionDetected,ji=ji&&Cn.offscreen}if(Bi.iconFeatureIndex&&(ur=Bi.iconFeatureIndex),Bi.iconBox){var nu=function(Er){var $o=at&&Ti?Zo(Er,Ti.x,Ti.y,$e,ot,x.transform.angle):Er;return x.collisionIndex.placeCollisionBox($o,Fe,he,q,Te.predicate)};Pi=mn&&mn.box&&mn.box.length&&Bi.verticalIconBox?(On=nu(Bi.verticalIconBox)).box.length>0:(On=nu(Bi.iconBox)).box.length>0,ji=ji&&On.offscreen}var ms=Le||ni.numHorizontalGlyphVertices===0&&ni.numVerticalGlyphVertices===0,Qn=xe||ni.numIconVertices===0;if(ms||Qn?Qn?ms||(Pi=Pi&&Li):Li=Pi&&Li:Pi=Li=Pi&&Li,Li&&er&&er.box&&x.collisionIndex.insertCollisionBox(er.box,B.get("text-ignore-placement"),L.bucketInstanceId,mn&&mn.box&&xn?xn:To,Te.ID),Pi&&On&&x.collisionIndex.insertCollisionBox(On.box,B.get("icon-ignore-placement"),L.bucketInstanceId,ur,Te.ID),Cn&&(Li&&x.collisionIndex.insertCollisionCircles(Cn.circles,B.get("text-ignore-placement"),L.bucketInstanceId,To,Te.ID),d)){var Ea=L.bucketInstanceId,Cl=x.collisionCircleArrays[Ea];Cl===void 0&&(Cl=x.collisionCircleArrays[Ea]=new sa);for(var ys=0;ys<Cn.circles.length;ys+=4)Cl.circles.push(Cn.circles[ys+0]),Cl.circles.push(Cn.circles[ys+1]),Cl.circles.push(Cn.circles[ys+2]),Cl.circles.push(Cn.collisionDetected?1:0)}x.placements[ni.crossTileID]=new Qu(Li||It,Pi||Dt,ji||L.justReloaded),m[ni.crossTileID]=!0}};if(st)for(var $t=L.getSortedSymbolIndexes(this.transform.angle),mi=$t.length-1;mi>=0;--mi){var bi=$t[mi];Lt(L.symbolInstances.get(bi),L.collisionArrays[bi])}else for(var di=c.symbolInstanceStart;di<c.symbolInstanceEnd;di++)Lt(L.symbolInstances.get(di),L.collisionArrays[di]);if(d&&L.bucketInstanceId in this.collisionCircleArrays){var ar=this.collisionCircleArrays[L.bucketInstanceId];f.invert(ar.invProjMatrix,q),ar.viewportMatrix=this.collisionIndex.getViewportMatrix()}L.justReloaded=!1},$n.prototype.markUsedJustification=function(c,m,d,x){var k;k=x===f.WritingMode.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[f.getAnchorJustification(m)];for(var L=0,B=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];L<B.length;L+=1){var q=B[L];q>=0&&(c.text.placedSymbolArray.get(q).crossTileID=k>=0&&q!==k?0:d.crossTileID)}},$n.prototype.markUsedOrientation=function(c,m,d){for(var x=m===f.WritingMode.horizontal||m===f.WritingMode.horizontalOnly?m:0,k=m===f.WritingMode.vertical?m:0,L=0,B=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];L<B.length;L+=1)c.text.placedSymbolArray.get(B[L]).placedOrientation=x;d.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=k)},$n.prototype.commit=function(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;var m=this.prevPlacement,d=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;var x=m?m.symbolFadeChange(c):1,k=m?m.opacities:{},L=m?m.variableOffsets:{},B=m?m.placedOrientations:{};for(var q in this.placements){var $=this.placements[q],ie=k[q];ie?(this.opacities[q]=new Fo(ie,x,$.text,$.icon),d=d||$.text!==ie.text.placed||$.icon!==ie.icon.placed):(this.opacities[q]=new Fo(null,x,$.text,$.icon,$.skipFade),d=d||$.text||$.icon)}for(var he in k){var de=k[he];if(!this.opacities[he]){var me=new Fo(de,x,!1,!1);me.isHidden()||(this.opacities[he]=me,d=d||de.text.placed||de.icon.placed)}}for(var Ce in L)this.variableOffsets[Ce]||!this.opacities[Ce]||this.opacities[Ce].isHidden()||(this.variableOffsets[Ce]=L[Ce]);for(var Te in B)this.placedOrientations[Te]||!this.opacities[Te]||this.opacities[Te].isHidden()||(this.placedOrientations[Te]=B[Te]);d?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:c)},$n.prototype.updateLayerOpacities=function(c,m){for(var d={},x=0,k=m;x<k.length;x+=1){var L=k[x],B=L.getBucket(c);B&&L.latestFeatureIndex&&c.id===B.layerIds[0]&&this.updateBucketOpacities(B,d,L.collisionBoxArray)}},$n.prototype.updateBucketOpacities=function(c,m,d){var x=this;c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();var k=c.layers[0].layout,L=new Fo(null,0,!1,!1,!0),B=k.get("text-allow-overlap"),q=k.get("icon-allow-overlap"),$=k.get("text-variable-anchor"),ie=k.get("text-rotation-alignment")==="map",he=k.get("text-pitch-alignment")==="map",de=k.get("icon-text-fit")!=="none",me=new Fo(null,0,B&&(q||!c.hasIconData()||k.get("icon-optional")),q&&(B||!c.hasTextData()||k.get("text-optional")),!0);!c.collisionArrays&&d&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(d);for(var Ce=function(ze,Fe,$e){for(var ot=0;ot<Fe/4;ot++)ze.opacityVertexArray.emplaceBack($e)},Te=function(ze){var Fe=c.symbolInstances.get(ze),$e=Fe.numHorizontalGlyphVertices,ot=Fe.numVerticalGlyphVertices,at=Fe.crossTileID,st=x.opacities[at];m[at]?st=L:st||(x.opacities[at]=st=me),m[at]=!0;var It=Fe.numIconVertices>0,Dt=x.placedOrientations[Fe.crossTileID],Lt=Dt===f.WritingMode.vertical,$t=Dt===f.WritingMode.horizontal||Dt===f.WritingMode.horizontalOnly;if($e>0||ot>0){var mi=ic(st.text);Ce(c.text,$e,Lt?ts:mi),Ce(c.text,ot,$t?ts:mi);var bi=st.text.isHidden();[Fe.rightJustifiedTextSymbolIndex,Fe.centerJustifiedTextSymbolIndex,Fe.leftJustifiedTextSymbolIndex].forEach(function(vi){vi>=0&&(c.text.placedSymbolArray.get(vi).hidden=bi||Lt?1:0)}),Fe.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(Fe.verticalPlacedTextSymbolIndex).hidden=bi||$t?1:0);var di=x.variableOffsets[Fe.crossTileID];di&&x.markUsedJustification(c,di.anchor,Fe,Dt);var ar=x.placedOrientations[Fe.crossTileID];ar&&(x.markUsedJustification(c,"left",Fe,ar),x.markUsedOrientation(c,ar,Fe))}if(It){var ni=ic(st.icon),Bi=!(de&&Fe.verticalPlacedIconSymbolIndex&&Lt);Fe.placedIconSymbolIndex>=0&&(Ce(c.icon,Fe.numIconVertices,Bi?ni:ts),c.icon.placedSymbolArray.get(Fe.placedIconSymbolIndex).hidden=st.icon.isHidden()),Fe.verticalPlacedIconSymbolIndex>=0&&(Ce(c.icon,Fe.numVerticalIconVertices,Bi?ts:ni),c.icon.placedSymbolArray.get(Fe.verticalPlacedIconSymbolIndex).hidden=st.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){var er=c.collisionArrays[ze];if(er){var Li=new f.Point(0,0);if(er.textBox||er.verticalTextBox){var Pi=!0;if($){var ji=x.variableOffsets[at];ji?(Li=Sn(ji.anchor,ji.width,ji.height,ji.textOffset,ji.textBoxScale),ie&&Li._rotate(he?x.transform.angle:-x.transform.angle)):Pi=!1}er.textBox&&Oa(c.textCollisionBox.collisionVertexArray,st.text.placed,!Pi||Lt,Li.x,Li.y),er.verticalTextBox&&Oa(c.textCollisionBox.collisionVertexArray,st.text.placed,!Pi||$t,Li.x,Li.y)}var Ti=Boolean(!$t&&er.verticalIconBox);er.iconBox&&Oa(c.iconCollisionBox.collisionVertexArray,st.icon.placed,Ti,de?Li.x:0,de?Li.y:0),er.verticalIconBox&&Oa(c.iconCollisionBox.collisionVertexArray,st.icon.placed,!Ti,de?Li.x:0,de?Li.y:0)}}},Le=0;Le<c.symbolInstances.length;Le++)Te(Le);if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){var xe=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=xe.invProjMatrix,c.placementViewportMatrix=xe.viewportMatrix,c.collisionCircleArray=xe.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}},$n.prototype.symbolFadeChange=function(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},$n.prototype.zoomAdjustment=function(c){return Math.max(0,(this.transform.zoom-c)/1.5)},$n.prototype.hasTransitions=function(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration},$n.prototype.stillRecent=function(c,m){var d=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*d>c},$n.prototype.setStale=function(){this.stale=!0};var Fl=Math.pow(2,25),wu=Math.pow(2,24),Zs=Math.pow(2,17),Nn=Math.pow(2,16),ml=Math.pow(2,9),ec=Math.pow(2,8),tc=Math.pow(2,1);function ic(c){if(c.opacity===0&&!c.placed)return 0;if(c.opacity===1&&c.placed)return 4294967295;var m=c.placed?1:0,d=Math.floor(127*c.opacity);return d*Fl+m*wu+d*Zs+m*Nn+d*ml+m*ec+d*tc+m}var ts=0,Ul=function(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&c.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ul.prototype.continuePlacement=function(c,m,d,x,k){for(var L=this._bucketParts;this._currentTileIndex<c.length;)if(m.getBucketParts(L,x,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,k())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort(function(B,q){return B.sortKey-q.sortKey}));this._currentPartIndex<L.length;)if(m.placeLayerBucketPart(L[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,k())return!0;return!1};var Nl=function(c,m,d,x,k,L,B){this.placement=new $n(c,k,L,B),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=x,this._done=!1};Nl.prototype.isDone=function(){return this._done},Nl.prototype.continuePlacement=function(c,m,d){for(var x=this,k=f.browser.now(),L=function(){var $=f.browser.now()-k;return!x._forceFullPlacement&&$>2};this._currentPlacementIndex>=0;){var B=m[c[this._currentPlacementIndex]],q=this.placement.collisionIndex.transform.zoom;if(B.type==="symbol"&&(!B.minzoom||B.minzoom<=q)&&(!B.maxzoom||B.maxzoom>q)){if(this._inProgressLayer||(this._inProgressLayer=new Ul(B)),this._inProgressLayer.continuePlacement(d[B.source],this.placement,this._showCollisionBoxes,B,L))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Nl.prototype.commit=function(c){return this.placement.commit(c),this.placement};var Bc=512/f.EXTENT/2,yl=function(c,m,d){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=d;for(var x=0;x<m.length;x++){var k=m.get(x),L=k.key;this.indexedSymbolInstances[L]||(this.indexedSymbolInstances[L]=[]),this.indexedSymbolInstances[L].push({crossTileID:k.crossTileID,coord:this.getScaledCoordinates(k,c)})}};yl.prototype.getScaledCoordinates=function(c,m){var d=Bc/Math.pow(2,m.canonical.z-this.tileID.canonical.z);return{x:Math.floor((m.canonical.x*f.EXTENT+c.anchorX)*d),y:Math.floor((m.canonical.y*f.EXTENT+c.anchorY)*d)}},yl.prototype.findMatches=function(c,m,d){for(var x=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z),k=0;k<c.length;k++){var L=c.get(k);if(!L.crossTileID){var B=this.indexedSymbolInstances[L.key];if(B)for(var q=this.getScaledCoordinates(L,m),$=0,ie=B;$<ie.length;$+=1){var he=ie[$];if(Math.abs(he.coord.x-q.x)<=x&&Math.abs(he.coord.y-q.y)<=x&&!d[he.crossTileID]){d[he.crossTileID]=!0,L.crossTileID=he.crossTileID;break}}}}};var Ho=function(){this.maxCrossTileID=0};Ho.prototype.generate=function(){return++this.maxCrossTileID};var Fa=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Fa.prototype.handleWrapJump=function(c){var m=Math.round((c-this.lng)/360);if(m!==0)for(var d in this.indexes){var x=this.indexes[d],k={};for(var L in x){var B=x[L];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+m),k[B.tileID.key]=B}this.indexes[d]=k}this.lng=c},Fa.prototype.addBucket=function(c,m,d){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(var x=0;x<m.symbolInstances.length;x++)m.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});var k=this.usedCrossTileIDs[c.overscaledZ];for(var L in this.indexes){var B=this.indexes[L];if(Number(L)>c.overscaledZ)for(var q in B){var $=B[q];$.tileID.isChildOf(c)&&$.findMatches(m.symbolInstances,c,k)}else{var ie=B[c.scaledTo(Number(L)).key];ie&&ie.findMatches(m.symbolInstances,c,k)}}for(var he=0;he<m.symbolInstances.length;he++){var de=m.symbolInstances.get(he);de.crossTileID||(de.crossTileID=d.generate(),k[de.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new yl(c,m.symbolInstances,m.bucketInstanceId),!0},Fa.prototype.removeBucketCrossTileIDs=function(c,m){for(var d in m.indexedSymbolInstances)for(var x=0,k=m.indexedSymbolInstances[d];x<k.length;x+=1)delete this.usedCrossTileIDs[c][k[x].crossTileID]},Fa.prototype.removeStaleBuckets=function(c){var m=!1;for(var d in this.indexes){var x=this.indexes[d];for(var k in x)c[x[k].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,x[k]),delete x[k],m=!0)}return m};var Ua=function(){this.layerIndexes={},this.crossTileIDs=new Ho,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Ua.prototype.addLayer=function(c,m,d){var x=this.layerIndexes[c.id];x===void 0&&(x=this.layerIndexes[c.id]=new Fa);var k=!1,L={};x.handleWrapJump(d);for(var B=0,q=m;B<q.length;B+=1){var $=q[B],ie=$.getBucket(c);ie&&c.id===ie.layerIds[0]&&(ie.bucketInstanceId||(ie.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket($.tileID,ie,this.crossTileIDs)&&(k=!0),L[ie.bucketInstanceId]=!0)}return x.removeStaleBuckets(L)&&(k=!0),k},Ua.prototype.pruneUnusedLayers=function(c){var m={};for(var d in c.forEach(function(x){m[x]=!0}),this.layerIndexes)m[d]||delete this.layerIndexes[d]};var ws=function(c,m){return f.emitValidationErrors(c,m&&m.filter(function(d){return d.identifier!=="source.canvas"}))},cr=f.pick(Ie,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Es=f.pick(Ie,["setCenter","setZoom","setBearing","setPitch"]),Is=function(){var c={},m=f.styleSpec.$version;for(var d in f.styleSpec.$root){var x,k=f.styleSpec.$root[d];k.required&&(x=d==="version"?m:k.type==="array"?[]:{})!=null&&(c[d]=x)}return c}(),po=function(c){function m(d,x){var k=this;x===void 0&&(x={}),c.call(this),this.map=d,this.dispatcher=new Qt(fe(),this),this.imageManager=new Ne,this.imageManager.setEventedParent(this),this.glyphManager=new Et(d._requestManager,x.localIdeographFontFamily),this.lineAtlas=new Xt(256,512),this.crossTileSymbolIndex=new Ua,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new f.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",f.getReferrer());var L=this;this._rtlTextPluginCallback=m.registerForPluginStateChange(function(B){L.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:B.pluginStatus,pluginURL:B.pluginURL},function(q,$){if(f.triggerPluginCompletionEvent(q),$&&$.every(function(he){return he}))for(var ie in L.sourceCaches)L.sourceCaches[ie].reload()})}),this.on("data",function(B){if(B.dataType==="source"&&B.sourceDataType==="metadata"){var q=k.sourceCaches[B.sourceId];if(q){var $=q.getSource();if($&&$.vectorLayerIds)for(var ie in k._layers){var he=k._layers[ie];he.source===$.id&&k._validateLayer(he)}}}})}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.loadURL=function(d,x){var k=this;x===void 0&&(x={}),this.fire(new f.Event("dataloading",{dataType:"style"}));var L=typeof x.validate=="boolean"?x.validate:!f.isMapboxURL(d);d=this.map._requestManager.normalizeStyleURL(d,x.accessToken);var B=this.map._requestManager.transformRequest(d,f.ResourceType.Style);this._request=f.getJSON(B,function(q,$){k._request=null,q?k.fire(new f.ErrorEvent(q)):$&&k._load($,L)})},m.prototype.loadJSON=function(d,x){var k=this;x===void 0&&(x={}),this.fire(new f.Event("dataloading",{dataType:"style"})),this._request=f.browser.frame(function(){k._request=null,k._load(d,x.validate!==!1)})},m.prototype.loadEmpty=function(){this.fire(new f.Event("dataloading",{dataType:"style"})),this._load(Is,!1)},m.prototype._load=function(d,x){if(!x||!ws(this,f.validateStyle(d))){for(var k in this._loaded=!0,this.stylesheet=d,d.sources)this.addSource(k,d.sources[k],{validate:!1});d.sprite?this._loadSprite(d.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(d.glyphs);var L=we(this.stylesheet.layers);this._order=L.map(function(ie){return ie.id}),this._layers={},this._serializedLayers={};for(var B=0,q=L;B<q.length;B+=1){var $=q[B];($=f.createStyleLayer($)).setEventedParent(this,{layer:{id:$.id}}),this._layers[$.id]=$,this._serializedLayers[$.id]=$.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new qi(this.stylesheet.light),this.fire(new f.Event("data",{dataType:"style"})),this.fire(new f.Event("style.load"))}},m.prototype._loadSprite=function(d){var x=this;this._spriteRequest=function(k,L,B){var q,$,ie,he=f.browser.devicePixelRatio>1?"@2x":"",de=f.getJSON(L.transformRequest(L.normalizeSpriteURL(k,he,".json"),f.ResourceType.SpriteJSON),function(Te,Le){de=null,ie||(ie=Te,q=Le,Ce())}),me=f.getImage(L.transformRequest(L.normalizeSpriteURL(k,he,".png"),f.ResourceType.SpriteImage),function(Te,Le){me=null,ie||(ie=Te,$=Le,Ce())});function Ce(){if(ie)B(ie);else if(q&&$){var Te=f.browser.getImageData($),Le={};for(var xe in q){var ze=q[xe],Fe=ze.width,$e=ze.height,ot=ze.x,at=ze.y,st=ze.sdf,It=ze.pixelRatio,Dt=ze.stretchX,Lt=ze.stretchY,$t=ze.content,mi=new f.RGBAImage({width:Fe,height:$e});f.RGBAImage.copy(Te,mi,{x:ot,y:at},{x:0,y:0},{width:Fe,height:$e}),Le[xe]={data:mi,pixelRatio:It,sdf:st,stretchX:Dt,stretchY:Lt,content:$t}}B(null,Le)}}return{cancel:function(){de&&(de.cancel(),de=null),me&&(me.cancel(),me=null)}}}(d,this.map._requestManager,function(k,L){if(x._spriteRequest=null,k)x.fire(new f.ErrorEvent(k));else if(L)for(var B in L)x.imageManager.addImage(B,L[B]);x.imageManager.setLoaded(!0),x._availableImages=x.imageManager.listImages(),x.dispatcher.broadcast("setImages",x._availableImages),x.fire(new f.Event("data",{dataType:"style"}))})},m.prototype._validateLayer=function(d){var x=this.sourceCaches[d.source];if(x){var k=d.sourceLayer;if(k){var L=x.getSource();(L.type==="geojson"||L.vectorLayerIds&&L.vectorLayerIds.indexOf(k)===-1)&&this.fire(new f.ErrorEvent(new Error('Source layer "'+k+'" does not exist on source "'+L.id+'" as specified by style layer "'+d.id+'"')))}}},m.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var d in this.sourceCaches)if(!this.sourceCaches[d].loaded())return!1;return!!this.imageManager.isLoaded()},m.prototype._serializeLayers=function(d){for(var x=[],k=0,L=d;k<L.length;k+=1){var B=this._layers[L[k]];B.type!=="custom"&&x.push(B.serialize())}return x},m.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var d in this.sourceCaches)if(this.sourceCaches[d].hasTransition())return!0;for(var x in this._layers)if(this._layers[x].hasTransition())return!0;return!1},m.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},m.prototype.update=function(d){if(this._loaded){var x=this._changed;if(this._changed){var k=Object.keys(this._updatedLayers),L=Object.keys(this._removedLayers);for(var B in(k.length||L.length)&&this._updateWorkerLayers(k,L),this._updatedSources){var q=this._updatedSources[B];q==="reload"?this._reloadSource(B):q==="clear"&&this._clearSource(B)}for(var $ in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[$].updateTransitions(d);this.light.updateTransitions(d),this._resetUpdates()}var ie={};for(var he in this.sourceCaches){var de=this.sourceCaches[he];ie[he]=de.used,de.used=!1}for(var me=0,Ce=this._order;me<Ce.length;me+=1){var Te=this._layers[Ce[me]];Te.recalculate(d,this._availableImages),!Te.isHidden(d.zoom)&&Te.source&&(this.sourceCaches[Te.source].used=!0)}for(var Le in ie){var xe=this.sourceCaches[Le];ie[Le]!==xe.used&&xe.fire(new f.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Le}))}this.light.recalculate(d),this.z=d.zoom,x&&this.fire(new f.Event("data",{dataType:"style"}))}},m.prototype._updateTilesForChangedImages=function(){var d=Object.keys(this._changedImages);if(d.length){for(var x in this.sourceCaches)this.sourceCaches[x].reloadTilesForDependencies(["icons","patterns"],d);this._changedImages={}}},m.prototype._updateWorkerLayers=function(d,x){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(d),removedIds:x})},m.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},m.prototype.setState=function(d){var x=this;if(this._checkLoaded(),ws(this,f.validateStyle(d)))return!1;(d=f.clone$1(d)).layers=we(d.layers);var k=function(B,q){if(!B)return[{command:Ie.setStyle,args:[q]}];var $=[];try{if(!f.deepEqual(B.version,q.version))return[{command:Ie.setStyle,args:[q]}];f.deepEqual(B.center,q.center)||$.push({command:Ie.setCenter,args:[q.center]}),f.deepEqual(B.zoom,q.zoom)||$.push({command:Ie.setZoom,args:[q.zoom]}),f.deepEqual(B.bearing,q.bearing)||$.push({command:Ie.setBearing,args:[q.bearing]}),f.deepEqual(B.pitch,q.pitch)||$.push({command:Ie.setPitch,args:[q.pitch]}),f.deepEqual(B.sprite,q.sprite)||$.push({command:Ie.setSprite,args:[q.sprite]}),f.deepEqual(B.glyphs,q.glyphs)||$.push({command:Ie.setGlyphs,args:[q.glyphs]}),f.deepEqual(B.transition,q.transition)||$.push({command:Ie.setTransition,args:[q.transition]}),f.deepEqual(B.light,q.light)||$.push({command:Ie.setLight,args:[q.light]});var ie={},he=[];(function(me,Ce,Te,Le){var xe;for(xe in Ce=Ce||{},me=me||{})me.hasOwnProperty(xe)&&(Ce.hasOwnProperty(xe)||Ke(xe,Te,Le));for(xe in Ce)Ce.hasOwnProperty(xe)&&(me.hasOwnProperty(xe)?f.deepEqual(me[xe],Ce[xe])||(me[xe].type==="geojson"&&Ce[xe].type==="geojson"&&Ut(me,Ce,xe)?Te.push({command:Ie.setGeoJSONSourceData,args:[xe,Ce[xe].data]}):tt(xe,Ce,Te,Le)):et(xe,Ce,Te))})(B.sources,q.sources,he,ie);var de=[];B.layers&&B.layers.forEach(function(me){ie[me.source]?$.push({command:Ie.removeLayer,args:[me.id]}):de.push(me)}),$=$.concat(he),function(me,Ce,Te){Ce=Ce||[];var Le,xe,ze,Fe,$e,ot,at,st=(me=me||[]).map(Ot),It=Ce.map(Ot),Dt=me.reduce(Vt,{}),Lt=Ce.reduce(Vt,{}),$t=st.slice(),mi=Object.create(null);for(Le=0,xe=0;Le<st.length;Le++)Lt.hasOwnProperty(ze=st[Le])?xe++:(Te.push({command:Ie.removeLayer,args:[ze]}),$t.splice($t.indexOf(ze,xe),1));for(Le=0,xe=0;Le<It.length;Le++)$t[$t.length-1-Le]!==(ze=It[It.length-1-Le])&&(Dt.hasOwnProperty(ze)?(Te.push({command:Ie.removeLayer,args:[ze]}),$t.splice($t.lastIndexOf(ze,$t.length-xe),1)):xe++,Te.push({command:Ie.addLayer,args:[Lt[ze],ot=$t[$t.length-Le]]}),$t.splice($t.length-Le,0,ze),mi[ze]=!0);for(Le=0;Le<It.length;Le++)if(Fe=Dt[ze=It[Le]],$e=Lt[ze],!mi[ze]&&!f.deepEqual(Fe,$e))if(f.deepEqual(Fe.source,$e.source)&&f.deepEqual(Fe["source-layer"],$e["source-layer"])&&f.deepEqual(Fe.type,$e.type)){for(at in At(Fe.layout,$e.layout,Te,ze,null,Ie.setLayoutProperty),At(Fe.paint,$e.paint,Te,ze,null,Ie.setPaintProperty),f.deepEqual(Fe.filter,$e.filter)||Te.push({command:Ie.setFilter,args:[ze,$e.filter]}),f.deepEqual(Fe.minzoom,$e.minzoom)&&f.deepEqual(Fe.maxzoom,$e.maxzoom)||Te.push({command:Ie.setLayerZoomRange,args:[ze,$e.minzoom,$e.maxzoom]}),Fe)Fe.hasOwnProperty(at)&&at!=="layout"&&at!=="paint"&&at!=="filter"&&at!=="metadata"&&at!=="minzoom"&&at!=="maxzoom"&&(at.indexOf("paint.")===0?At(Fe[at],$e[at],Te,ze,at.slice(6),Ie.setPaintProperty):f.deepEqual(Fe[at],$e[at])||Te.push({command:Ie.setLayerProperty,args:[ze,at,$e[at]]}));for(at in $e)$e.hasOwnProperty(at)&&!Fe.hasOwnProperty(at)&&at!=="layout"&&at!=="paint"&&at!=="filter"&&at!=="metadata"&&at!=="minzoom"&&at!=="maxzoom"&&(at.indexOf("paint.")===0?At(Fe[at],$e[at],Te,ze,at.slice(6),Ie.setPaintProperty):f.deepEqual(Fe[at],$e[at])||Te.push({command:Ie.setLayerProperty,args:[ze,at,$e[at]]}))}else Te.push({command:Ie.removeLayer,args:[ze]}),ot=$t[$t.lastIndexOf(ze)+1],Te.push({command:Ie.addLayer,args:[$e,ot]})}(de,q.layers,$)}catch(me){console.warn("Unable to compute style diff:",me),$=[{command:Ie.setStyle,args:[q]}]}return $}(this.serialize(),d).filter(function(B){return!(B.command in Es)});if(k.length===0)return!1;var L=k.filter(function(B){return!(B.command in cr)});if(L.length>0)throw new Error("Unimplemented: "+L.map(function(B){return B.command}).join(", ")+".");return k.forEach(function(B){B.command!=="setTransition"&&x[B.command].apply(x,B.args)}),this.stylesheet=d,!0},m.prototype.addImage=function(d,x){if(this.getImage(d))return this.fire(new f.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(d,x),this._afterImageUpdated(d)},m.prototype.updateImage=function(d,x){this.imageManager.updateImage(d,x)},m.prototype.getImage=function(d){return this.imageManager.getImage(d)},m.prototype.removeImage=function(d){if(!this.getImage(d))return this.fire(new f.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(d),this._afterImageUpdated(d)},m.prototype._afterImageUpdated=function(d){this._availableImages=this.imageManager.listImages(),this._changedImages[d]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new f.Event("data",{dataType:"style"}))},m.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},m.prototype.addSource=function(d,x,k){var L=this;if(k===void 0&&(k={}),this._checkLoaded(),this.sourceCaches[d]!==void 0)throw new Error("There is already a source with this ID");if(!x.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(x).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(x.type)>=0&&this._validate(f.validateStyle.source,"sources."+d,x,null,k))){this.map&&this.map._collectResourceTiming&&(x.collectResourceTiming=!0);var B=this.sourceCaches[d]=new Me(d,x,this.dispatcher);B.style=this,B.setEventedParent(this,function(){return{isSourceLoaded:L.loaded(),source:B.serialize(),sourceId:d}}),B.onAdd(this.map),this._changed=!0}},m.prototype.removeSource=function(d){if(this._checkLoaded(),this.sourceCaches[d]===void 0)throw new Error("There is no source with this ID");for(var x in this._layers)if(this._layers[x].source===d)return this.fire(new f.ErrorEvent(new Error('Source "'+d+'" cannot be removed while layer "'+x+'" is using it.')));var k=this.sourceCaches[d];delete this.sourceCaches[d],delete this._updatedSources[d],k.fire(new f.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:d})),k.setEventedParent(null),k.clearTiles(),k.onRemove&&k.onRemove(this.map),this._changed=!0},m.prototype.setGeoJSONSourceData=function(d,x){this._checkLoaded(),this.sourceCaches[d].getSource().setData(x),this._changed=!0},m.prototype.getSource=function(d){return this.sourceCaches[d]&&this.sourceCaches[d].getSource()},m.prototype.addLayer=function(d,x,k){k===void 0&&(k={}),this._checkLoaded();var L=d.id;if(this.getLayer(L))this.fire(new f.ErrorEvent(new Error('Layer with id "'+L+'" already exists on this map')));else{var B;if(d.type==="custom"){if(ws(this,f.validateCustomStyleLayer(d)))return;B=f.createStyleLayer(d)}else{if(typeof d.source=="object"&&(this.addSource(L,d.source),d=f.clone$1(d),d=f.extend(d,{source:L})),this._validate(f.validateStyle.layer,"layers."+L,d,{arrayIndex:-1},k))return;B=f.createStyleLayer(d),this._validateLayer(B),B.setEventedParent(this,{layer:{id:L}}),this._serializedLayers[B.id]=B.serialize()}var q=x?this._order.indexOf(x):this._order.length;if(x&&q===-1)this.fire(new f.ErrorEvent(new Error('Layer with id "'+x+'" does not exist on this map.')));else{if(this._order.splice(q,0,L),this._layerOrderChanged=!0,this._layers[L]=B,this._removedLayers[L]&&B.source&&B.type!=="custom"){var $=this._removedLayers[L];delete this._removedLayers[L],$.type!==B.type?this._updatedSources[B.source]="clear":(this._updatedSources[B.source]="reload",this.sourceCaches[B.source].pause())}this._updateLayer(B),B.onAdd&&B.onAdd(this.map)}}},m.prototype.moveLayer=function(d,x){if(this._checkLoaded(),this._changed=!0,this._layers[d]){if(d!==x){var k=this._order.indexOf(d);this._order.splice(k,1);var L=x?this._order.indexOf(x):this._order.length;x&&L===-1?this.fire(new f.ErrorEvent(new Error('Layer with id "'+x+'" does not exist on this map.'))):(this._order.splice(L,0,d),this._layerOrderChanged=!0)}}else this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot be moved.")))},m.prototype.removeLayer=function(d){this._checkLoaded();var x=this._layers[d];if(x){x.setEventedParent(null);var k=this._order.indexOf(d);this._order.splice(k,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[d]=x,delete this._layers[d],delete this._serializedLayers[d],delete this._updatedLayers[d],delete this._updatedPaintProps[d],x.onRemove&&x.onRemove(this.map)}else this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot be removed.")))},m.prototype.getLayer=function(d){return this._layers[d]},m.prototype.hasLayer=function(d){return d in this._layers},m.prototype.setLayerZoomRange=function(d,x,k){this._checkLoaded();var L=this.getLayer(d);L?L.minzoom===x&&L.maxzoom===k||(x!=null&&(L.minzoom=x),k!=null&&(L.maxzoom=k),this._updateLayer(L)):this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot have zoom extent.")))},m.prototype.setFilter=function(d,x,k){k===void 0&&(k={}),this._checkLoaded();var L=this.getLayer(d);if(L){if(!f.deepEqual(L.filter,x))return x==null?(L.filter=void 0,void this._updateLayer(L)):void(this._validate(f.validateStyle.filter,"layers."+L.id+".filter",x,null,k)||(L.filter=f.clone$1(x),this._updateLayer(L)))}else this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot be filtered.")))},m.prototype.getFilter=function(d){return f.clone$1(this.getLayer(d).filter)},m.prototype.setLayoutProperty=function(d,x,k,L){L===void 0&&(L={}),this._checkLoaded();var B=this.getLayer(d);B?f.deepEqual(B.getLayoutProperty(x),k)||(B.setLayoutProperty(x,k,L),this._updateLayer(B)):this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot be styled.")))},m.prototype.getLayoutProperty=function(d,x){var k=this.getLayer(d);if(k)return k.getLayoutProperty(x);this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style.")))},m.prototype.setPaintProperty=function(d,x,k,L){L===void 0&&(L={}),this._checkLoaded();var B=this.getLayer(d);B?f.deepEqual(B.getPaintProperty(x),k)||(B.setPaintProperty(x,k,L)&&this._updateLayer(B),this._changed=!0,this._updatedPaintProps[d]=!0):this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot be styled.")))},m.prototype.getPaintProperty=function(d,x){return this.getLayer(d).getPaintProperty(x)},m.prototype.setFeatureState=function(d,x){this._checkLoaded();var k=d.source,L=d.sourceLayer,B=this.sourceCaches[k];if(B!==void 0){var q=B.getSource().type;q==="geojson"&&L?this.fire(new f.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):q!=="vector"||L?(d.id===void 0&&this.fire(new f.ErrorEvent(new Error("The feature id parameter must be provided."))),B.setFeatureState(L,d.id,x)):this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new f.ErrorEvent(new Error("The source '"+k+"' does not exist in the map's style.")))},m.prototype.removeFeatureState=function(d,x){this._checkLoaded();var k=d.source,L=this.sourceCaches[k];if(L!==void 0){var B=L.getSource().type,q=B==="vector"?d.sourceLayer:void 0;B!=="vector"||q?x&&typeof d.id!="string"&&typeof d.id!="number"?this.fire(new f.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):L.removeFeatureState(q,d.id,x):this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new f.ErrorEvent(new Error("The source '"+k+"' does not exist in the map's style.")))},m.prototype.getFeatureState=function(d){this._checkLoaded();var x=d.source,k=d.sourceLayer,L=this.sourceCaches[x];if(L!==void 0){if(L.getSource().type!=="vector"||k)return d.id===void 0&&this.fire(new f.ErrorEvent(new Error("The feature id parameter must be provided."))),L.getFeatureState(k,d.id);this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new f.ErrorEvent(new Error("The source '"+x+"' does not exist in the map's style.")))},m.prototype.getTransition=function(){return f.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},m.prototype.serialize=function(){return f.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:f.mapObject(this.sourceCaches,function(d){return d.serialize()}),layers:this._serializeLayers(this._order)},function(d){return d!==void 0})},m.prototype._updateLayer=function(d){this._updatedLayers[d.id]=!0,d.source&&!this._updatedSources[d.source]&&this.sourceCaches[d.source].getSource().type!=="raster"&&(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause()),this._changed=!0},m.prototype._flattenAndSortRenderedFeatures=function(d){for(var x=this,k=function(Dt){return x._layers[Dt].type==="fill-extrusion"},L={},B=[],q=this._order.length-1;q>=0;q--){var $=this._order[q];if(k($)){L[$]=q;for(var ie=0,he=d;ie<he.length;ie+=1){var de=he[ie][$];if(de)for(var me=0,Ce=de;me<Ce.length;me+=1)B.push(Ce[me])}}}B.sort(function(Dt,Lt){return Lt.intersectionZ-Dt.intersectionZ});for(var Te=[],Le=this._order.length-1;Le>=0;Le--){var xe=this._order[Le];if(k(xe))for(var ze=B.length-1;ze>=0;ze--){var Fe=B[ze].feature;if(L[Fe.layer.id]<Le)break;Te.push(Fe),B.pop()}else for(var $e=0,ot=d;$e<ot.length;$e+=1){var at=ot[$e][xe];if(at)for(var st=0,It=at;st<It.length;st+=1)Te.push(It[st].feature)}}return Te},m.prototype.queryRenderedFeatures=function(d,x,k){x&&x.filter&&this._validate(f.validateStyle.filter,"queryRenderedFeatures.filter",x.filter,null,x);var L={};if(x&&x.layers){if(!Array.isArray(x.layers))return this.fire(new f.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var B=0,q=x.layers;B<q.length;B+=1){var $=q[B],ie=this._layers[$];if(!ie)return this.fire(new f.ErrorEvent(new Error("The layer '"+$+"' does not exist in the map's style and cannot be queried for features."))),[];L[ie.source]=!0}}var he=[];for(var de in x.availableImages=this._availableImages,this.sourceCaches)x.layers&&!L[de]||he.push(Ii(this.sourceCaches[de],this._layers,this._serializedLayers,d,x,k));return this.placement&&he.push(function(me,Ce,Te,Le,xe,ze,Fe){for(var $e={},ot=ze.queryRenderedSymbols(Le),at=[],st=0,It=Object.keys(ot).map(Number);st<It.length;st+=1)at.push(Fe[It[st]]);at.sort(rr);for(var Dt=function(){var di=$t[Lt],ar=di.featureIndex.lookupSymbolFeatures(ot[di.bucketInstanceId],Ce,di.bucketIndex,di.sourceLayerIndex,xe.filter,xe.layers,xe.availableImages,me);for(var ni in ar){var Bi=$e[ni]=$e[ni]||[],er=ar[ni];er.sort(function(ji,Ti){var vi=di.featureSortOrder;if(vi){var mn=vi.indexOf(ji.featureIndex);return vi.indexOf(Ti.featureIndex)-mn}return Ti.featureIndex-ji.featureIndex});for(var Li=0,Pi=er;Li<Pi.length;Li+=1)Bi.push(Pi[Li])}},Lt=0,$t=at;Lt<$t.length;Lt+=1)Dt();var mi=function(di){$e[di].forEach(function(ar){var ni=ar.feature,Bi=Te[me[di].source].getFeatureState(ni.layer["source-layer"],ni.id);ni.source=ni.layer.source,ni.layer["source-layer"]&&(ni.sourceLayer=ni.layer["source-layer"]),ni.state=Bi})};for(var bi in $e)mi(bi);return $e}(this._layers,this._serializedLayers,this.sourceCaches,d,x,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(he)},m.prototype.querySourceFeatures=function(d,x){x&&x.filter&&this._validate(f.validateStyle.filter,"querySourceFeatures.filter",x.filter,null,x);var k=this.sourceCaches[d];return k?function(L,B){for(var q=L.getRenderableIds().map(function(Ce){return L.getTileByID(Ce)}),$=[],ie={},he=0;he<q.length;he++){var de=q[he],me=de.tileID.canonical.key;ie[me]||(ie[me]=!0,de.querySourceFeatures($,B))}return $}(k,x):[]},m.prototype.addSourceType=function(d,x,k){return m.getSourceType(d)?k(new Error('A source type called "'+d+'" already exists.')):(m.setSourceType(d,x),x.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:d,url:x.workerSourceURL},k):k(null,null))},m.prototype.getLight=function(){return this.light.getLight()},m.prototype.setLight=function(d,x){x===void 0&&(x={}),this._checkLoaded();var k=this.light.getLight(),L=!1;for(var B in d)if(!f.deepEqual(d[B],k[B])){L=!0;break}if(L){var q={now:f.browser.now(),transition:f.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(d,x),this.light.updateTransitions(q)}},m.prototype._validate=function(d,x,k,L,B){return B===void 0&&(B={}),(!B||B.validate!==!1)&&ws(this,d.call(f.validateStyle,f.extend({key:x,style:this.serialize(),value:k,styleSpec:f.styleSpec},L)))},m.prototype._remove=function(){for(var d in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),f.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[d].setEventedParent(null);for(var x in this.sourceCaches)this.sourceCaches[x].clearTiles(),this.sourceCaches[x].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},m.prototype._clearSource=function(d){this.sourceCaches[d].clearTiles()},m.prototype._reloadSource=function(d){this.sourceCaches[d].resume(),this.sourceCaches[d].reload()},m.prototype._updateSources=function(d){for(var x in this.sourceCaches)this.sourceCaches[x].update(d)},m.prototype._generateCollisionBoxes=function(){for(var d in this.sourceCaches)this._reloadSource(d)},m.prototype._updatePlacement=function(d,x,k,L,B){B===void 0&&(B=!1);for(var q=!1,$=!1,ie={},he=0,de=this._order;he<de.length;he+=1){var me=this._layers[de[he]];if(me.type==="symbol"){if(!ie[me.source]){var Ce=this.sourceCaches[me.source];ie[me.source]=Ce.getRenderableIds(!0).map(function(Fe){return Ce.getTileByID(Fe)}).sort(function(Fe,$e){return $e.tileID.overscaledZ-Fe.tileID.overscaledZ||(Fe.tileID.isLessThan($e.tileID)?-1:1)})}var Te=this.crossTileSymbolIndex.addLayer(me,ie[me.source],d.center.lng);q=q||Te}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((B=B||this._layerOrderChanged||k===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(f.browser.now(),d.zoom))&&(this.pauseablePlacement=new Nl(d,this._order,B,x,k,L,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,ie),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(f.browser.now()),$=!0),q&&this.pauseablePlacement.placement.setStale()),$||q)for(var Le=0,xe=this._order;Le<xe.length;Le+=1){var ze=this._layers[xe[Le]];ze.type==="symbol"&&this.placement.updateLayerOpacities(ze,ie[ze.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(f.browser.now())},m.prototype._releaseSymbolFadeTiles=function(){for(var d in this.sourceCaches)this.sourceCaches[d].releaseSymbolFadeTiles()},m.prototype.getImages=function(d,x,k){this.imageManager.getImages(x.icons,k),this._updateTilesForChangedImages();var L=this.sourceCaches[x.source];L&&L.setDependencies(x.tileID.key,x.type,x.icons)},m.prototype.getGlyphs=function(d,x,k){this.glyphManager.getGlyphs(x.stacks,k)},m.prototype.getResource=function(d,x,k){return f.makeRequest(x,k)},m}(f.Evented);po.getSourceType=function(c){return Xi[c]},po.setSourceType=function(c,m){Xi[c]=m},po.registerForPluginStateChange=f.registerForPluginStateChange;var Tn=f.createLayout([{name:"a_pos",type:"Int16",components:2}]),fo=Gr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Eu=Gr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Iu=Gr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Su=Gr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),jl=Gr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Vl=Gr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),gl=Gr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),ql=Gr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Tu=Gr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Gl=Gr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Oc=Gr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),_l=Gr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Na=Gr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Fc=Gr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),mo=Gr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),rc=Gr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Ss=Gr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ts=Gr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Hs=Gr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),is=Gr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),ja=Gr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),_a=Gr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),As=Gr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),rs=Gr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Au=Gr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Cs=Gr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Gr(c,m){var d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=m.match(/attribute ([\w]+) ([\w]+)/g),k=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),B=L?L.concat(k):k,q={};return{fragmentSource:c=c.replace(d,function($,ie,he,de,me){return q[me]=!0,ie==="define"?`
#ifndef HAS_UNIFORM_u_`+me+`
varying `+he+" "+de+" "+me+`;
#else
uniform `+he+" "+de+" u_"+me+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+me+`
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`}),vertexSource:m=m.replace(d,function($,ie,he,de,me){var Ce=de==="float"?"vec2":"vec4",Te=me.match(/color/)?"color":Ce;return q[me]?ie==="define"?`
#ifndef HAS_UNIFORM_u_`+me+`
uniform lowp float u_`+me+`_t;
attribute `+he+" "+Ce+" a_"+me+`;
varying `+he+" "+de+" "+me+`;
#else
uniform `+he+" "+de+" u_"+me+`;
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+me+`
    `+me+" = a_"+me+`;
#else
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+me+`
    `+me+" = unpack_mix_"+Te+"(a_"+me+", u_"+me+`_t);
#else
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`:ie==="define"?`
#ifndef HAS_UNIFORM_u_`+me+`
uniform lowp float u_`+me+`_t;
attribute `+he+" "+Ce+" a_"+me+`;
#else
uniform `+he+" "+de+" u_"+me+`;
#endif
`:Te==="vec4"?`
#ifndef HAS_UNIFORM_u_`+me+`
    `+he+" "+de+" "+me+" = a_"+me+`;
#else
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+me+`
    `+he+" "+de+" "+me+" = unpack_mix_"+Te+"(a_"+me+", u_"+me+`_t);
#else
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`}),staticAttributes:x,staticUniforms:B}}var Ws=Object.freeze({__proto__:null,prelude:fo,background:Eu,backgroundPattern:Iu,circle:Su,clippingMask:jl,heatmap:Vl,heatmapTexture:gl,collisionBox:ql,collisionCircle:Tu,debug:Gl,fill:Oc,fillOutline:_l,fillOutlinePattern:Na,fillPattern:Fc,fillExtrusion:mo,fillExtrusionPattern:rc,hillshadePrepare:Ss,hillshade:Ts,line:Hs,lineGradient:is,linePattern:ja,lineSDF:_a,raster:As,symbolIcon:rs,symbolSDF:Au,symbolTextAndIcon:Cs}),ns=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function nc(c){for(var m=[],d=0;d<c.length;d++)if(c[d]!==null){var x=c[d].split(" ");m.push(x.pop())}return m}ns.prototype.bind=function(c,m,d,x,k,L,B,q){this.context=c;for(var $=this.boundPaintVertexBuffers.length!==x.length,ie=0;!$&&ie<x.length;ie++)this.boundPaintVertexBuffers[ie]!==x[ie]&&($=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===m&&this.boundLayoutVertexBuffer===d&&!$&&this.boundIndexBuffer===k&&this.boundVertexOffset===L&&this.boundDynamicVertexBuffer===B&&this.boundDynamicVertexBuffer2===q?(c.bindVertexArrayOES.set(this.vao),B&&B.bind(),k&&k.dynamicDraw&&k.bind(),q&&q.bind()):this.freshBind(m,d,x,k,L,B,q)},ns.prototype.freshBind=function(c,m,d,x,k,L,B){var q,$=c.numAttributes,ie=this.context,he=ie.gl;if(ie.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ie.extVertexArrayObject.createVertexArrayOES(),ie.bindVertexArrayOES.set(this.vao),q=0,this.boundProgram=c,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=x,this.boundVertexOffset=k,this.boundDynamicVertexBuffer=L,this.boundDynamicVertexBuffer2=B;else{q=ie.currentNumAttributes||0;for(var de=$;de<q;de++)he.disableVertexAttribArray(de)}m.enableAttributes(he,c);for(var me=0,Ce=d;me<Ce.length;me+=1)Ce[me].enableAttributes(he,c);L&&L.enableAttributes(he,c),B&&B.enableAttributes(he,c),m.bind(),m.setVertexAttribPointers(he,c,k);for(var Te=0,Le=d;Te<Le.length;Te+=1){var xe=Le[Te];xe.bind(),xe.setVertexAttribPointers(he,c,k)}L&&(L.bind(),L.setVertexAttribPointers(he,c,k)),x&&x.bind(),B&&(B.bind(),B.setVertexAttribPointers(he,c,k)),ie.currentNumAttributes=$},ns.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Cu=function(c,m,d,x,k,L){var B=c.gl;this.program=B.createProgram();for(var q=nc(d.staticAttributes),$=x?x.getBinderAttributes():[],ie=q.concat($),he=d.staticUniforms?nc(d.staticUniforms):[],de=x?x.getBinderUniforms():[],me=[],Ce=0,Te=he.concat(de);Ce<Te.length;Ce+=1){var Le=Te[Ce];me.indexOf(Le)<0&&me.push(Le)}var xe=x?x.defines():[];L&&xe.push("#define OVERDRAW_INSPECTOR;");var ze=xe.concat(fo.fragmentSource,d.fragmentSource).join(`
`),Fe=xe.concat(fo.vertexSource,d.vertexSource).join(`
`),$e=B.createShader(B.FRAGMENT_SHADER);if(B.isContextLost())this.failedToCreate=!0;else{B.shaderSource($e,ze),B.compileShader($e),B.attachShader(this.program,$e);var ot=B.createShader(B.VERTEX_SHADER);if(B.isContextLost())this.failedToCreate=!0;else{B.shaderSource(ot,Fe),B.compileShader(ot),B.attachShader(this.program,ot),this.attributes={};var at={};this.numAttributes=ie.length;for(var st=0;st<this.numAttributes;st++)ie[st]&&(B.bindAttribLocation(this.program,st,ie[st]),this.attributes[ie[st]]=st);B.linkProgram(this.program),B.deleteShader(ot),B.deleteShader($e);for(var It=0;It<me.length;It++){var Dt=me[It];if(Dt&&!at[Dt]){var Lt=B.getUniformLocation(this.program,Dt);Lt&&(at[Dt]=Lt)}}this.fixedUniforms=k(c,at),this.binderUniforms=x?x.getUniforms(c,at):[]}}};function Ji(c,m,d){var x=1/Qr(d,1,m.transform.tileZoom),k=Math.pow(2,d.tileID.overscaledZ),L=d.tileSize*Math.pow(2,m.transform.tileZoom)/k,B=L*(d.tileID.canonical.x+d.tileID.wrap*k),q=L*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[x,c.fromScale,c.toScale],u_fade:c.t,u_pixel_coord_upper:[B>>16,q>>16],u_pixel_coord_lower:[65535&B,65535&q]}}Cu.prototype.draw=function(c,m,d,x,k,L,B,q,$,ie,he,de,me,Ce,Te,Le){var xe,ze=c.gl;if(!this.failedToCreate){for(var Fe in c.program.set(this.program),c.setDepthMode(d),c.setStencilMode(x),c.setColorMode(k),c.setCullFace(L),this.fixedUniforms)this.fixedUniforms[Fe].set(B[Fe]);Ce&&Ce.setUniforms(c,this.binderUniforms,de,{zoom:me});for(var $e=(xe={},xe[ze.LINES]=2,xe[ze.TRIANGLES]=3,xe[ze.LINE_STRIP]=1,xe)[m],ot=0,at=he.get();ot<at.length;ot+=1){var st=at[ot],It=st.vaos||(st.vaos={});(It[q]||(It[q]=new ns)).bind(c,this,$,Ce?Ce.getPaintVertexBuffers():[],ie,st.vertexOffset,Te,Le),ze.drawElements(m,st.primitiveLength*$e,ze.UNSIGNED_SHORT,st.primitiveOffset*$e*2)}}};var Zl=function(c,m,d,x){var k=m.style.light,L=k.properties.get("position"),B=[L.x,L.y,L.z],q=f.create$1();k.properties.get("anchor")==="viewport"&&f.fromRotation(q,-m.transform.angle),f.transformMat3(B,B,q);var $=k.properties.get("color");return{u_matrix:c,u_lightpos:B,u_lightintensity:k.properties.get("intensity"),u_lightcolor:[$.r,$.g,$.b],u_vertical_gradient:+d,u_opacity:x}},wr=function(c,m,d,x,k,L,B){return f.extend(Zl(c,m,d,x),Ji(L,m,B),{u_height_factor:-Math.pow(2,k.overscaledZ)/B.tileSize/8})},Ta=function(c){return{u_matrix:c}},Kr=function(c,m,d,x){return f.extend(Ta(c),Ji(d,m,x))},An=function(c,m){return{u_matrix:c,u_world:m}},Hl=function(c,m,d,x,k){return f.extend(Kr(c,m,d,x),{u_world:k})},Wl=function(c,m,d,x){var k,L,B=c.transform;if(x.paint.get("circle-pitch-alignment")==="map"){var q=Qr(d,1,B.zoom);k=!0,L=[q,q]}else k=!1,L=B.pixelsToGLUnits;return{u_camera_to_center_distance:B.cameraToCenterDistance,u_scale_with_map:+(x.paint.get("circle-pitch-scale")==="map"),u_matrix:c.translatePosMatrix(m.posMatrix,d,x.paint.get("circle-translate"),x.paint.get("circle-translate-anchor")),u_pitch_with_map:+k,u_device_pixel_ratio:f.browser.devicePixelRatio,u_extrude_scale:L}},Xs=function(c,m,d){var x=Qr(d,1,m.zoom),k=Math.pow(2,m.zoom-d.tileID.overscaledZ),L=d.tileID.overscaleFactor();return{u_matrix:c,u_camera_to_center_distance:m.cameraToCenterDistance,u_pixels_to_tile_units:x,u_extrude_scale:[m.pixelsToGLUnits[0]/(x*k),m.pixelsToGLUnits[1]/(x*k)],u_overscale_factor:L}},ku=function(c,m,d){return{u_matrix:c,u_inv_matrix:m,u_camera_to_center_distance:d.cameraToCenterDistance,u_viewport_size:[d.width,d.height]}},Va=function(c,m,d){return d===void 0&&(d=1),{u_matrix:c,u_color:m,u_overlay:0,u_overlay_scale:d}},qa=function(c){return{u_matrix:c}},Xl=function(c,m,d,x){return{u_matrix:c,u_extrude_scale:Qr(m,1,d),u_intensity:x}},ks=function(c,m,d){var x=c.transform;return{u_matrix:oc(c,m,d),u_ratio:1/Qr(m,1,x.zoom),u_device_pixel_ratio:f.browser.devicePixelRatio,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Jr=function(c,m,d,x){return f.extend(ks(c,m,d),{u_image:0,u_image_height:x})},os=function(c,m,d,x){var k=c.transform,L=ko(m,k);return{u_matrix:oc(c,m,d),u_texsize:m.imageAtlasTexture.size,u_ratio:1/Qr(m,1,k.zoom),u_device_pixel_ratio:f.browser.devicePixelRatio,u_image:0,u_scale:[L,x.fromScale,x.toScale],u_fade:x.t,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]]}},zu=function(c,m,d,x,k){var L=c.lineAtlas,B=ko(m,c.transform),q=d.layout.get("line-cap")==="round",$=L.getDash(x.from,q),ie=L.getDash(x.to,q),he=$.width*k.fromScale,de=ie.width*k.toScale;return f.extend(ks(c,m,d),{u_patternscale_a:[B/he,-$.height/2],u_patternscale_b:[B/de,-ie.height/2],u_sdfgamma:L.width/(256*Math.min(he,de)*f.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:$.y,u_tex_y_b:ie.y,u_mix:k.t})};function ko(c,m){return 1/Qr(c,1,m.tileZoom)}function oc(c,m,d){return c.translatePosMatrix(m.tileID.posMatrix,m,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}var Uc=function(c,m,d,x,k){return{u_matrix:c,u_tl_parent:m,u_scale_parent:d,u_buffer_scale:1,u_fade_t:x.mix,u_opacity:x.opacity*k.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:k.paint.get("raster-brightness-min"),u_brightness_high:k.paint.get("raster-brightness-max"),u_saturation_factor:(B=k.paint.get("raster-saturation"),B>0?1-1/(1.001-B):-B),u_contrast_factor:(L=k.paint.get("raster-contrast"),L>0?1/(1-L):1+L),u_spin_weights:ac(k.paint.get("raster-hue-rotate"))};var L,B};function ac(c){c*=Math.PI/180;var m=Math.sin(c),d=Math.cos(c);return[(2*d+1)/3,(-Math.sqrt(3)*m-d+1)/3,(Math.sqrt(3)*m-d+1)/3]}var as,ss=function(c,m,d,x,k,L,B,q,$,ie){var he=k.transform;return{u_is_size_zoom_constant:+(c==="constant"||c==="source"),u_is_size_feature_constant:+(c==="constant"||c==="camera"),u_size_t:m?m.uSizeT:0,u_size:m?m.uSize:0,u_camera_to_center_distance:he.cameraToCenterDistance,u_pitch:he.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:he.width/he.height,u_fade_change:k.options.fadeDuration?k.symbolFadeChange:1,u_matrix:L,u_label_plane_matrix:B,u_coord_matrix:q,u_is_text:+$,u_pitch_with_map:+x,u_texsize:ie,u_texture:0}},Ks=function(c,m,d,x,k,L,B,q,$,ie,he){var de=k.transform;return f.extend(ss(c,m,d,x,k,L,B,q,$,ie),{u_gamma_scale:x?Math.cos(de._pitch)*de.cameraToCenterDistance:1,u_device_pixel_ratio:f.browser.devicePixelRatio,u_is_halo:+he})},Kl=function(c,m,d,x,k,L,B,q,$,ie){return f.extend(Ks(c,m,d,x,k,L,B,q,!0,$,!0),{u_texsize_icon:ie,u_texture_icon:1})},zs=function(c,m,d){return{u_matrix:c,u_opacity:m,u_color:d}},ls=function(c,m,d,x,k,L){return f.extend(function(B,q,$,ie){var he=$.imageManager.getPattern(B.from.toString()),de=$.imageManager.getPattern(B.to.toString()),me=$.imageManager.getPixelSize(),Ce=me.width,Te=me.height,Le=Math.pow(2,ie.tileID.overscaledZ),xe=ie.tileSize*Math.pow(2,$.transform.tileZoom)/Le,ze=xe*(ie.tileID.canonical.x+ie.tileID.wrap*Le),Fe=xe*ie.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:he.tl,u_pattern_br_a:he.br,u_pattern_tl_b:de.tl,u_pattern_br_b:de.br,u_texsize:[Ce,Te],u_mix:q.t,u_pattern_size_a:he.displaySize,u_pattern_size_b:de.displaySize,u_scale_a:q.fromScale,u_scale_b:q.toScale,u_tile_units_to_pixels:1/Qr(ie,1,$.transform.tileZoom),u_pixel_coord_upper:[ze>>16,Fe>>16],u_pixel_coord_lower:[65535&ze,65535&Fe]}}(x,L,d,k),{u_matrix:c,u_opacity:m})},sc={fillExtrusion:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_lightpos:new f.Uniform3f(c,m.u_lightpos),u_lightintensity:new f.Uniform1f(c,m.u_lightintensity),u_lightcolor:new f.Uniform3f(c,m.u_lightcolor),u_vertical_gradient:new f.Uniform1f(c,m.u_vertical_gradient),u_opacity:new f.Uniform1f(c,m.u_opacity)}},fillExtrusionPattern:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_lightpos:new f.Uniform3f(c,m.u_lightpos),u_lightintensity:new f.Uniform1f(c,m.u_lightintensity),u_lightcolor:new f.Uniform3f(c,m.u_lightcolor),u_vertical_gradient:new f.Uniform1f(c,m.u_vertical_gradient),u_height_factor:new f.Uniform1f(c,m.u_height_factor),u_image:new f.Uniform1i(c,m.u_image),u_texsize:new f.Uniform2f(c,m.u_texsize),u_pixel_coord_upper:new f.Uniform2f(c,m.u_pixel_coord_upper),u_pixel_coord_lower:new f.Uniform2f(c,m.u_pixel_coord_lower),u_scale:new f.Uniform3f(c,m.u_scale),u_fade:new f.Uniform1f(c,m.u_fade),u_opacity:new f.Uniform1f(c,m.u_opacity)}},fill:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix)}},fillPattern:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_image:new f.Uniform1i(c,m.u_image),u_texsize:new f.Uniform2f(c,m.u_texsize),u_pixel_coord_upper:new f.Uniform2f(c,m.u_pixel_coord_upper),u_pixel_coord_lower:new f.Uniform2f(c,m.u_pixel_coord_lower),u_scale:new f.Uniform3f(c,m.u_scale),u_fade:new f.Uniform1f(c,m.u_fade)}},fillOutline:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_world:new f.Uniform2f(c,m.u_world)}},fillOutlinePattern:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_world:new f.Uniform2f(c,m.u_world),u_image:new f.Uniform1i(c,m.u_image),u_texsize:new f.Uniform2f(c,m.u_texsize),u_pixel_coord_upper:new f.Uniform2f(c,m.u_pixel_coord_upper),u_pixel_coord_lower:new f.Uniform2f(c,m.u_pixel_coord_lower),u_scale:new f.Uniform3f(c,m.u_scale),u_fade:new f.Uniform1f(c,m.u_fade)}},circle:function(c,m){return{u_camera_to_center_distance:new f.Uniform1f(c,m.u_camera_to_center_distance),u_scale_with_map:new f.Uniform1i(c,m.u_scale_with_map),u_pitch_with_map:new f.Uniform1i(c,m.u_pitch_with_map),u_extrude_scale:new f.Uniform2f(c,m.u_extrude_scale),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_matrix:new f.UniformMatrix4f(c,m.u_matrix)}},collisionBox:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_camera_to_center_distance:new f.Uniform1f(c,m.u_camera_to_center_distance),u_pixels_to_tile_units:new f.Uniform1f(c,m.u_pixels_to_tile_units),u_extrude_scale:new f.Uniform2f(c,m.u_extrude_scale),u_overscale_factor:new f.Uniform1f(c,m.u_overscale_factor)}},collisionCircle:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_inv_matrix:new f.UniformMatrix4f(c,m.u_inv_matrix),u_camera_to_center_distance:new f.Uniform1f(c,m.u_camera_to_center_distance),u_viewport_size:new f.Uniform2f(c,m.u_viewport_size)}},debug:function(c,m){return{u_color:new f.UniformColor(c,m.u_color),u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_overlay:new f.Uniform1i(c,m.u_overlay),u_overlay_scale:new f.Uniform1f(c,m.u_overlay_scale)}},clippingMask:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix)}},heatmap:function(c,m){return{u_extrude_scale:new f.Uniform1f(c,m.u_extrude_scale),u_intensity:new f.Uniform1f(c,m.u_intensity),u_matrix:new f.UniformMatrix4f(c,m.u_matrix)}},heatmapTexture:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_world:new f.Uniform2f(c,m.u_world),u_image:new f.Uniform1i(c,m.u_image),u_color_ramp:new f.Uniform1i(c,m.u_color_ramp),u_opacity:new f.Uniform1f(c,m.u_opacity)}},hillshade:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_image:new f.Uniform1i(c,m.u_image),u_latrange:new f.Uniform2f(c,m.u_latrange),u_light:new f.Uniform2f(c,m.u_light),u_shadow:new f.UniformColor(c,m.u_shadow),u_highlight:new f.UniformColor(c,m.u_highlight),u_accent:new f.UniformColor(c,m.u_accent)}},hillshadePrepare:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_image:new f.Uniform1i(c,m.u_image),u_dimension:new f.Uniform2f(c,m.u_dimension),u_zoom:new f.Uniform1f(c,m.u_zoom),u_unpack:new f.Uniform4f(c,m.u_unpack)}},line:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_ratio:new f.Uniform1f(c,m.u_ratio),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_units_to_pixels:new f.Uniform2f(c,m.u_units_to_pixels)}},lineGradient:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_ratio:new f.Uniform1f(c,m.u_ratio),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_units_to_pixels:new f.Uniform2f(c,m.u_units_to_pixels),u_image:new f.Uniform1i(c,m.u_image),u_image_height:new f.Uniform1f(c,m.u_image_height)}},linePattern:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_texsize:new f.Uniform2f(c,m.u_texsize),u_ratio:new f.Uniform1f(c,m.u_ratio),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_image:new f.Uniform1i(c,m.u_image),u_units_to_pixels:new f.Uniform2f(c,m.u_units_to_pixels),u_scale:new f.Uniform3f(c,m.u_scale),u_fade:new f.Uniform1f(c,m.u_fade)}},lineSDF:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_ratio:new f.Uniform1f(c,m.u_ratio),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_units_to_pixels:new f.Uniform2f(c,m.u_units_to_pixels),u_patternscale_a:new f.Uniform2f(c,m.u_patternscale_a),u_patternscale_b:new f.Uniform2f(c,m.u_patternscale_b),u_sdfgamma:new f.Uniform1f(c,m.u_sdfgamma),u_image:new f.Uniform1i(c,m.u_image),u_tex_y_a:new f.Uniform1f(c,m.u_tex_y_a),u_tex_y_b:new f.Uniform1f(c,m.u_tex_y_b),u_mix:new f.Uniform1f(c,m.u_mix)}},raster:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_tl_parent:new f.Uniform2f(c,m.u_tl_parent),u_scale_parent:new f.Uniform1f(c,m.u_scale_parent),u_buffer_scale:new f.Uniform1f(c,m.u_buffer_scale),u_fade_t:new f.Uniform1f(c,m.u_fade_t),u_opacity:new f.Uniform1f(c,m.u_opacity),u_image0:new f.Uniform1i(c,m.u_image0),u_image1:new f.Uniform1i(c,m.u_image1),u_brightness_low:new f.Uniform1f(c,m.u_brightness_low),u_brightness_high:new f.Uniform1f(c,m.u_brightness_high),u_saturation_factor:new f.Uniform1f(c,m.u_saturation_factor),u_contrast_factor:new f.Uniform1f(c,m.u_contrast_factor),u_spin_weights:new f.Uniform3f(c,m.u_spin_weights)}},symbolIcon:function(c,m){return{u_is_size_zoom_constant:new f.Uniform1i(c,m.u_is_size_zoom_constant),u_is_size_feature_constant:new f.Uniform1i(c,m.u_is_size_feature_constant),u_size_t:new f.Uniform1f(c,m.u_size_t),u_size:new f.Uniform1f(c,m.u_size),u_camera_to_center_distance:new f.Uniform1f(c,m.u_camera_to_center_distance),u_pitch:new f.Uniform1f(c,m.u_pitch),u_rotate_symbol:new f.Uniform1i(c,m.u_rotate_symbol),u_aspect_ratio:new f.Uniform1f(c,m.u_aspect_ratio),u_fade_change:new f.Uniform1f(c,m.u_fade_change),u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_label_plane_matrix:new f.UniformMatrix4f(c,m.u_label_plane_matrix),u_coord_matrix:new f.UniformMatrix4f(c,m.u_coord_matrix),u_is_text:new f.Uniform1i(c,m.u_is_text),u_pitch_with_map:new f.Uniform1i(c,m.u_pitch_with_map),u_texsize:new f.Uniform2f(c,m.u_texsize),u_texture:new f.Uniform1i(c,m.u_texture)}},symbolSDF:function(c,m){return{u_is_size_zoom_constant:new f.Uniform1i(c,m.u_is_size_zoom_constant),u_is_size_feature_constant:new f.Uniform1i(c,m.u_is_size_feature_constant),u_size_t:new f.Uniform1f(c,m.u_size_t),u_size:new f.Uniform1f(c,m.u_size),u_camera_to_center_distance:new f.Uniform1f(c,m.u_camera_to_center_distance),u_pitch:new f.Uniform1f(c,m.u_pitch),u_rotate_symbol:new f.Uniform1i(c,m.u_rotate_symbol),u_aspect_ratio:new f.Uniform1f(c,m.u_aspect_ratio),u_fade_change:new f.Uniform1f(c,m.u_fade_change),u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_label_plane_matrix:new f.UniformMatrix4f(c,m.u_label_plane_matrix),u_coord_matrix:new f.UniformMatrix4f(c,m.u_coord_matrix),u_is_text:new f.Uniform1i(c,m.u_is_text),u_pitch_with_map:new f.Uniform1i(c,m.u_pitch_with_map),u_texsize:new f.Uniform2f(c,m.u_texsize),u_texture:new f.Uniform1i(c,m.u_texture),u_gamma_scale:new f.Uniform1f(c,m.u_gamma_scale),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_is_halo:new f.Uniform1i(c,m.u_is_halo)}},symbolTextAndIcon:function(c,m){return{u_is_size_zoom_constant:new f.Uniform1i(c,m.u_is_size_zoom_constant),u_is_size_feature_constant:new f.Uniform1i(c,m.u_is_size_feature_constant),u_size_t:new f.Uniform1f(c,m.u_size_t),u_size:new f.Uniform1f(c,m.u_size),u_camera_to_center_distance:new f.Uniform1f(c,m.u_camera_to_center_distance),u_pitch:new f.Uniform1f(c,m.u_pitch),u_rotate_symbol:new f.Uniform1i(c,m.u_rotate_symbol),u_aspect_ratio:new f.Uniform1f(c,m.u_aspect_ratio),u_fade_change:new f.Uniform1f(c,m.u_fade_change),u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_label_plane_matrix:new f.UniformMatrix4f(c,m.u_label_plane_matrix),u_coord_matrix:new f.UniformMatrix4f(c,m.u_coord_matrix),u_is_text:new f.Uniform1i(c,m.u_is_text),u_pitch_with_map:new f.Uniform1i(c,m.u_pitch_with_map),u_texsize:new f.Uniform2f(c,m.u_texsize),u_texsize_icon:new f.Uniform2f(c,m.u_texsize_icon),u_texture:new f.Uniform1i(c,m.u_texture),u_texture_icon:new f.Uniform1i(c,m.u_texture_icon),u_gamma_scale:new f.Uniform1f(c,m.u_gamma_scale),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_is_halo:new f.Uniform1i(c,m.u_is_halo)}},background:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_opacity:new f.Uniform1f(c,m.u_opacity),u_color:new f.UniformColor(c,m.u_color)}},backgroundPattern:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_opacity:new f.Uniform1f(c,m.u_opacity),u_image:new f.Uniform1i(c,m.u_image),u_pattern_tl_a:new f.Uniform2f(c,m.u_pattern_tl_a),u_pattern_br_a:new f.Uniform2f(c,m.u_pattern_br_a),u_pattern_tl_b:new f.Uniform2f(c,m.u_pattern_tl_b),u_pattern_br_b:new f.Uniform2f(c,m.u_pattern_br_b),u_texsize:new f.Uniform2f(c,m.u_texsize),u_mix:new f.Uniform1f(c,m.u_mix),u_pattern_size_a:new f.Uniform2f(c,m.u_pattern_size_a),u_pattern_size_b:new f.Uniform2f(c,m.u_pattern_size_b),u_scale_a:new f.Uniform1f(c,m.u_scale_a),u_scale_b:new f.Uniform1f(c,m.u_scale_b),u_pixel_coord_upper:new f.Uniform2f(c,m.u_pixel_coord_upper),u_pixel_coord_lower:new f.Uniform2f(c,m.u_pixel_coord_lower),u_tile_units_to_pixels:new f.Uniform1f(c,m.u_tile_units_to_pixels)}}};function Ga(c,m,d,x,k,L,B){for(var q=c.context,$=q.gl,ie=c.useProgram("collisionBox"),he=[],de=0,me=0,Ce=0;Ce<x.length;Ce++){var Te=x[Ce],Le=m.getTile(Te),xe=Le.getBucket(d);if(xe){var ze=Te.posMatrix;k[0]===0&&k[1]===0||(ze=c.translatePosMatrix(Te.posMatrix,Le,k,L));var Fe=B?xe.textCollisionBox:xe.iconCollisionBox,$e=xe.collisionCircleArray;if($e.length>0){var ot=f.create(),at=ze;f.mul(ot,xe.placementInvProjMatrix,c.transform.glCoordMatrix),f.mul(ot,ot,xe.placementViewportMatrix),he.push({circleArray:$e,circleOffset:me,transform:at,invTransform:ot}),me=de+=$e.length/4}Fe&&ie.draw(q,$.LINES,ge.disabled,Se.disabled,c.colorModeForRenderPass(),Ve.disabled,Xs(ze,c.transform,Le),d.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,null,c.transform.zoom,null,null,Fe.collisionVertexBuffer)}}if(B&&he.length){var st=c.useProgram("collisionCircle"),It=new f.StructArrayLayout2f1f2i16;It.resize(4*de),It._trim();for(var Dt=0,Lt=0,$t=he;Lt<$t.length;Lt+=1)for(var mi=$t[Lt],bi=0;bi<mi.circleArray.length/4;bi++){var di=4*bi,ar=mi.circleArray[di+0],ni=mi.circleArray[di+1],Bi=mi.circleArray[di+2],er=mi.circleArray[di+3];It.emplace(Dt++,ar,ni,Bi,er,0),It.emplace(Dt++,ar,ni,Bi,er,1),It.emplace(Dt++,ar,ni,Bi,er,2),It.emplace(Dt++,ar,ni,Bi,er,3)}(!as||as.length<2*de)&&(as=function(Cn){var On=2*Cn,To=new f.StructArrayLayout3ui6;To.resize(On),To._trim();for(var xn=0;xn<On;xn++){var ur=6*xn;To.uint16[ur+0]=4*xn+0,To.uint16[ur+1]=4*xn+1,To.uint16[ur+2]=4*xn+2,To.uint16[ur+3]=4*xn+2,To.uint16[ur+4]=4*xn+3,To.uint16[ur+5]=4*xn+0}return To}(de));for(var Li=q.createIndexBuffer(as,!0),Pi=q.createVertexBuffer(It,f.collisionCircleLayout.members,!0),ji=0,Ti=he;ji<Ti.length;ji+=1){var vi=Ti[ji],mn=ku(vi.transform,vi.invTransform,c.transform);st.draw(q,$.TRIANGLES,ge.disabled,Se.disabled,c.colorModeForRenderPass(),Ve.disabled,mn,d.id,Pi,Li,f.SegmentVector.simpleSegment(0,2*vi.circleOffset,vi.circleArray.length,vi.circleArray.length/2),null,c.transform.zoom,null,null,null)}Pi.destroy(),Li.destroy()}}var la=f.identity(new Float32Array(16));function Jl(c,m,d,x,k,L){var B=f.getAnchorAlignment(c),q=-(B.horizontalAlign-.5)*m,$=-(B.verticalAlign-.5)*d,ie=f.evaluateVariableOffset(c,x);return new f.Point((q/k+ie[0])*L,($/k+ie[1])*L)}function $l(c,m,d,x,k,L,B,q,$,ie,he){var de=c.text.placedSymbolArray,me=c.text.dynamicLayoutVertexArray,Ce=c.icon.dynamicLayoutVertexArray,Te={};me.clear();for(var Le=0;Le<de.length;Le++){var xe=de.get(Le),ze=xe.hidden||!xe.crossTileID||c.allowVerticalPlacement&&!xe.placedOrientation?null:x[xe.crossTileID];if(ze){var Fe=new f.Point(xe.anchorX,xe.anchorY),$e=Kt(Fe,d?q:B),ot=Di(L.cameraToCenterDistance,$e.signedDistanceFromCamera),at=k.evaluateSizeForFeature(c.textSizeData,ie,xe)*ot/f.ONE_EM;d&&(at*=c.tilePixelRatio/$);for(var st=Jl(ze.anchor,ze.width,ze.height,ze.textOffset,ze.textBoxScale,at),It=d?Kt(Fe.add(st),B).point:$e.point.add(m?st.rotate(-L.angle):st),Dt=c.allowVerticalPlacement&&xe.placedOrientation===f.WritingMode.vertical?Math.PI/2:0,Lt=0;Lt<xe.numGlyphs;Lt++)f.addDynamicAttributes(me,It,Dt);he&&xe.associatedIconIndex>=0&&(Te[xe.associatedIconIndex]={shiftedAnchor:It,angle:Dt})}else Co(xe.numGlyphs,me)}if(he){Ce.clear();for(var $t=c.icon.placedSymbolArray,mi=0;mi<$t.length;mi++){var bi=$t.get(mi);if(bi.hidden)Co(bi.numGlyphs,Ce);else{var di=Te[mi];if(di)for(var ar=0;ar<bi.numGlyphs;ar++)f.addDynamicAttributes(Ce,di.shiftedAnchor,di.angle);else Co(bi.numGlyphs,Ce)}}c.icon.dynamicLayoutVertexBuffer.updateData(Ce)}c.text.dynamicLayoutVertexBuffer.updateData(me)}function Js(c,m,d){return d.iconsInText&&m?"symbolTextAndIcon":c?"symbolSDF":"symbolIcon"}function Aa(c,m,d,x,k,L,B,q,$,ie,he,de){for(var me=c.context,Ce=me.gl,Te=c.transform,Le=q==="map",xe=$==="map",ze=Le&&d.layout.get("symbol-placement")!=="point",Fe=Le&&!xe&&!ze,$e=d.layout.get("symbol-sort-key").constantOr(1)!==void 0,ot=!1,at=c.depthModeForSublayer(0,ge.ReadOnly),st=d.layout.get("text-variable-anchor"),It=[],Dt=0,Lt=x;Dt<Lt.length;Dt+=1){var $t=Lt[Dt],mi=m.getTile($t),bi=mi.getBucket(d);if(bi){var di=k?bi.text:bi.icon;if(di&&di.segments.get().length){var ar=di.programConfigurations.get(d.id),ni=k||bi.sdfIcons,Bi=k?bi.textSizeData:bi.iconSizeData,er=xe||Te.pitch!==0,Li=c.useProgram(Js(ni,k,bi),ar),Pi=f.evaluateSizeForZoom(Bi,Te.zoom),ji=void 0,Ti=[0,0],vi=void 0,mn=void 0,Cn=null,On=void 0;if(k)vi=mi.glyphAtlasTexture,mn=Ce.LINEAR,ji=mi.glyphAtlasTexture.size,bi.iconsInText&&(Ti=mi.imageAtlasTexture.size,Cn=mi.imageAtlasTexture,On=er||c.options.rotating||c.options.zooming||Bi.kind==="composite"||Bi.kind==="camera"?Ce.LINEAR:Ce.NEAREST);else{var To=d.layout.get("icon-size").constantOr(0)!==1||bi.iconsNeedLinear;vi=mi.imageAtlasTexture,mn=ni||c.options.rotating||c.options.zooming||To||er?Ce.LINEAR:Ce.NEAREST,ji=mi.imageAtlasTexture.size}var xn=Qr(mi,1,c.transform.zoom),ur=Ci($t.posMatrix,xe,Le,c.transform,xn),Jo=ci($t.posMatrix,xe,Le,c.transform,xn),jo=st&&bi.hasTextData(),xa=d.layout.get("icon-text-fit")!=="none"&&jo&&bi.hasIconData();ze&&kn(bi,$t.posMatrix,c,k,ur,Jo,xe,ie);var Yn=c.translatePosMatrix($t.posMatrix,mi,L,B),ba=ze||k&&st||xa?la:ur,wa=c.translatePosMatrix(Jo,mi,L,B,!0),Lu=ni&&d.paint.get(k?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Du={program:Li,buffers:di,uniformValues:ni?bi.iconsInText?Kl(Bi.kind,Pi,Fe,xe,c,Yn,ba,wa,ji,Ti):Ks(Bi.kind,Pi,Fe,xe,c,Yn,ba,wa,k,ji,!0):ss(Bi.kind,Pi,Fe,xe,c,Yn,ba,wa,k,ji),atlasTexture:vi,atlasTextureIcon:Cn,atlasInterpolation:mn,atlasInterpolationIcon:On,isSDF:ni,hasHalo:Lu};if($e&&bi.canOverlap){ot=!0;for(var il=0,Ru=di.segments.get();il<Ru.length;il+=1){var ru=Ru[il];It.push({segments:new f.SegmentVector([ru]),sortKey:ru.sortKey,state:Du})}}else It.push({segments:di.segments,sortKey:0,state:Du})}}}ot&&It.sort(function(Cl,ys){return Cl.sortKey-ys.sortKey});for(var Ls=0,nu=It;Ls<nu.length;Ls+=1){var ms=nu[Ls],Qn=ms.state;if(me.activeTexture.set(Ce.TEXTURE0),Qn.atlasTexture.bind(Qn.atlasInterpolation,Ce.CLAMP_TO_EDGE),Qn.atlasTextureIcon&&(me.activeTexture.set(Ce.TEXTURE1),Qn.atlasTextureIcon&&Qn.atlasTextureIcon.bind(Qn.atlasInterpolationIcon,Ce.CLAMP_TO_EDGE)),Qn.isSDF){var Ea=Qn.uniformValues;Qn.hasHalo&&(Ea.u_is_halo=1,vl(Qn.buffers,ms.segments,d,c,Qn.program,at,he,de,Ea)),Ea.u_is_halo=0}vl(Qn.buffers,ms.segments,d,c,Qn.program,at,he,de,Qn.uniformValues)}}function vl(c,m,d,x,k,L,B,q,$){var ie=x.context;k.draw(ie,ie.gl.TRIANGLES,L,B,q,Ve.disabled,$,d.id,c.layoutVertexBuffer,c.indexBuffer,m,d.paint,x.transform.zoom,c.programConfigurations.get(d.id),c.dynamicLayoutVertexBuffer,c.opacityVertexBuffer)}function Ps(c,m,d,x,k,L,B){var q,$,ie,he,de,me=c.context.gl,Ce=d.paint.get("fill-pattern"),Te=Ce&&Ce.constantOr(1),Le=d.getCrossfadeParameters();B?($=Te&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=me.LINES):($=Te?"fillPattern":"fill",q=me.TRIANGLES);for(var xe=0,ze=x;xe<ze.length;xe+=1){var Fe=ze[xe],$e=m.getTile(Fe);if(!Te||$e.patternsLoaded()){var ot=$e.getBucket(d);if(ot){var at=ot.programConfigurations.get(d.id),st=c.useProgram($,at);Te&&(c.context.activeTexture.set(me.TEXTURE0),$e.imageAtlasTexture.bind(me.LINEAR,me.CLAMP_TO_EDGE),at.updatePaintBuffers(Le));var It=Ce.constantOr(null);if(It&&$e.imageAtlas){var Dt=$e.imageAtlas,Lt=Dt.patternPositions[It.to.toString()],$t=Dt.patternPositions[It.from.toString()];Lt&&$t&&at.setConstantPatternPositions(Lt,$t)}var mi=c.translatePosMatrix(Fe.posMatrix,$e,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(B){he=ot.indexBuffer2,de=ot.segments2;var bi=[me.drawingBufferWidth,me.drawingBufferHeight];ie=$==="fillOutlinePattern"&&Te?Hl(mi,c,Le,$e,bi):An(mi,bi)}else he=ot.indexBuffer,de=ot.segments,ie=Te?Kr(mi,c,Le,$e):Ta(mi);st.draw(c.context,q,k,c.stencilModeForClipping(Fe),L,Ve.disabled,ie,d.id,ot.layoutVertexBuffer,he,de,d.paint,c.transform.zoom,at)}}}}function Pu(c,m,d,x,k,L,B){for(var q=c.context,$=q.gl,ie=d.paint.get("fill-extrusion-pattern"),he=ie.constantOr(1),de=d.getCrossfadeParameters(),me=d.paint.get("fill-extrusion-opacity"),Ce=0,Te=x;Ce<Te.length;Ce+=1){var Le=Te[Ce],xe=m.getTile(Le),ze=xe.getBucket(d);if(ze){var Fe=ze.programConfigurations.get(d.id),$e=c.useProgram(he?"fillExtrusionPattern":"fillExtrusion",Fe);he&&(c.context.activeTexture.set($.TEXTURE0),xe.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),Fe.updatePaintBuffers(de));var ot=ie.constantOr(null);if(ot&&xe.imageAtlas){var at=xe.imageAtlas,st=at.patternPositions[ot.to.toString()],It=at.patternPositions[ot.from.toString()];st&&It&&Fe.setConstantPatternPositions(st,It)}var Dt=c.translatePosMatrix(Le.posMatrix,xe,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Lt=d.paint.get("fill-extrusion-vertical-gradient"),$t=he?wr(Dt,c,Lt,me,Le,de,xe):Zl(Dt,c,Lt,me);$e.draw(q,q.gl.TRIANGLES,k,L,B,Ve.backCCW,$t,d.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,d.paint,c.transform.zoom,Fe)}}}function Yl(c,m,d,x,k,L){var B=c.context,q=B.gl,$=m.fbo;if($){var ie=c.useProgram("hillshade");B.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,$.colorAttachment.get());var he=function(de,me,Ce){var Te=Ce.paint.get("hillshade-shadow-color"),Le=Ce.paint.get("hillshade-highlight-color"),xe=Ce.paint.get("hillshade-accent-color"),ze=Ce.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ce.paint.get("hillshade-illumination-anchor")==="viewport"&&(ze-=de.transform.angle);var Fe,$e,ot,at=!de.options.moving;return{u_matrix:de.transform.calculatePosMatrix(me.tileID.toUnwrapped(),at),u_image:0,u_latrange:(Fe=me.tileID,$e=Math.pow(2,Fe.canonical.z),ot=Fe.canonical.y,[new f.MercatorCoordinate(0,ot/$e).toLngLat().lat,new f.MercatorCoordinate(0,(ot+1)/$e).toLngLat().lat]),u_light:[Ce.paint.get("hillshade-exaggeration"),ze],u_shadow:Te,u_highlight:Le,u_accent:xe}}(c,m,d);ie.draw(B,q.TRIANGLES,x,k,L,Ve.disabled,he,d.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments)}}function Nc(c,m,d,x,k,L){var B=c.context,q=B.gl,$=m.dem;if($&&$.data){var ie=$.dim,he=$.stride,de=$.getPixels();if(B.activeTexture.set(q.TEXTURE1),B.pixelStoreUnpackPremultiplyAlpha.set(!1),m.demTexture=m.demTexture||c.getTileTexture(he),m.demTexture){var me=m.demTexture;me.update(de,{premultiply:!1}),me.bind(q.NEAREST,q.CLAMP_TO_EDGE)}else m.demTexture=new f.Texture(B,de,q.RGBA,{premultiply:!1}),m.demTexture.bind(q.NEAREST,q.CLAMP_TO_EDGE);B.activeTexture.set(q.TEXTURE0);var Ce=m.fbo;if(!Ce){var Te=new f.Texture(B,{width:ie,height:ie,data:null},q.RGBA);Te.bind(q.LINEAR,q.CLAMP_TO_EDGE),(Ce=m.fbo=B.createFramebuffer(ie,ie,!0)).colorAttachment.set(Te.texture)}B.bindFramebuffer.set(Ce.framebuffer),B.viewport.set([0,0,ie,ie]),c.useProgram("hillshadePrepare").draw(B,q.TRIANGLES,x,k,L,Ve.disabled,function(Le,xe){var ze=xe.stride,Fe=f.create();return f.ortho(Fe,0,f.EXTENT,-f.EXTENT,0,0,1),f.translate(Fe,Fe,[0,-f.EXTENT,0]),{u_matrix:Fe,u_image:1,u_dimension:[ze,ze],u_zoom:Le.overscaledZ,u_unpack:xe.getUnpackVector()}}(m.tileID,$),d.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments),m.needsHillshadePrepare=!1}}function us(c,m,d,x,k){var L=x.paint.get("raster-fade-duration");if(L>0){var B=f.browser.now(),q=(B-c.timeAdded)/L,$=m?(B-m.timeAdded)/L:-1,ie=d.getSource(),he=k.coveringZoomLevel({tileSize:ie.tileSize,roundZoom:ie.roundZoom}),de=!m||Math.abs(m.tileID.overscaledZ-he)>Math.abs(c.tileID.overscaledZ-he),me=de&&c.refreshedUponExpiration?1:f.clamp(de?q:1-$,0,1);return c.refreshedUponExpiration&&q>=1&&(c.refreshedUponExpiration=!1),m?{opacity:1,mix:1-me}:{opacity:me,mix:0}}return{opacity:1,mix:0}}var Mu=new f.Color(1,0,0,1),xl=new f.Color(0,1,0,1),bl=new f.Color(0,0,1,1),zo=new f.Color(1,0,1,1),Po=new f.Color(0,1,1,1);function lc(c,m,d,x){wl(c,0,m+d/2,c.transform.width,d,x)}function cs(c,m,d,x){wl(c,m-d/2,0,d,c.transform.height,x)}function wl(c,m,d,x,k,L){var B=c.context,q=B.gl;q.enable(q.SCISSOR_TEST),q.scissor(m*f.browser.devicePixelRatio,d*f.browser.devicePixelRatio,x*f.browser.devicePixelRatio,k*f.browser.devicePixelRatio),B.clear({color:L}),q.disable(q.SCISSOR_TEST)}function $s(c,m,d){var x=c.context,k=x.gl,L=d.posMatrix,B=c.useProgram("debug"),q=ge.disabled,$=Se.disabled,ie=c.colorModeForRenderPass();x.activeTexture.set(k.TEXTURE0),c.emptyTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),B.draw(x,k.LINE_STRIP,q,$,ie,Ve.disabled,Va(L,f.Color.red),"$debug",c.debugBuffer,c.tileBorderIndexBuffer,c.debugSegments);var he=m.getTileByID(d.key).latestRawTileData,de=Math.floor((he&&he.byteLength||0)/1024),me=m.getTile(d).tileSize,Ce=512/Math.min(me,512)*(d.overscaledZ/c.transform.zoom)*.5,Te=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(Te+=" => "+d.overscaledZ),function(Le,xe){Le.initDebugOverlayCanvas();var ze=Le.debugOverlayCanvas,Fe=Le.context.gl,$e=Le.debugOverlayCanvas.getContext("2d");$e.clearRect(0,0,ze.width,ze.height),$e.shadowColor="white",$e.shadowBlur=2,$e.lineWidth=1.5,$e.strokeStyle="white",$e.textBaseline="top",$e.font="bold 36px Open Sans, sans-serif",$e.fillText(xe,5,5),$e.strokeText(xe,5,5),Le.debugOverlayTexture.update(ze),Le.debugOverlayTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE)}(c,Te+" "+de+"kb"),B.draw(x,k.TRIANGLES,q,$,Oe.alphaBlended,Ve.disabled,Va(L,f.Color.transparent,Ce),"$debug",c.debugBuffer,c.quadTriangleIndexBuffer,c.debugSegments)}var ua={symbol:function(c,m,d,x,k){if(c.renderPass==="translucent"){var L=Se.disabled,B=c.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(q,$,ie,he,de,me,Ce){for(var Te=$.transform,Le=de==="map",xe=me==="map",ze=0,Fe=q;ze<Fe.length;ze+=1){var $e=Fe[ze],ot=he.getTile($e),at=ot.getBucket(ie);if(at&&at.text&&at.text.segments.get().length){var st=f.evaluateSizeForZoom(at.textSizeData,Te.zoom),It=Qr(ot,1,$.transform.zoom),Dt=Ci($e.posMatrix,xe,Le,$.transform,It),Lt=ie.layout.get("icon-text-fit")!=="none"&&at.hasIconData();if(st){var $t=Math.pow(2,Te.zoom-ot.tileID.overscaledZ);$l(at,Le,xe,Ce,f.symbolSize,Te,Dt,$e.posMatrix,$t,st,Lt)}}}}(x,c,d,m,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),k),d.paint.get("icon-opacity").constantOr(1)!==0&&Aa(c,m,d,x,!1,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),d.layout.get("icon-rotation-alignment"),d.layout.get("icon-pitch-alignment"),d.layout.get("icon-keep-upright"),L,B),d.paint.get("text-opacity").constantOr(1)!==0&&Aa(c,m,d,x,!0,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),d.layout.get("text-keep-upright"),L,B),m.map.showCollisionBoxes&&(Ga(c,m,d,x,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),Ga(c,m,d,x,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))}},circle:function(c,m,d,x){if(c.renderPass==="translucent"){var k=d.paint.get("circle-opacity"),L=d.paint.get("circle-stroke-width"),B=d.paint.get("circle-stroke-opacity"),q=d.layout.get("circle-sort-key").constantOr(1)!==void 0;if(k.constantOr(1)!==0||L.constantOr(1)!==0&&B.constantOr(1)!==0){for(var $=c.context,ie=$.gl,he=c.depthModeForSublayer(0,ge.ReadOnly),de=Se.disabled,me=c.colorModeForRenderPass(),Ce=[],Te=0;Te<x.length;Te++){var Le=x[Te],xe=m.getTile(Le),ze=xe.getBucket(d);if(ze){var Fe=ze.programConfigurations.get(d.id),$e={programConfiguration:Fe,program:c.useProgram("circle",Fe),layoutVertexBuffer:ze.layoutVertexBuffer,indexBuffer:ze.indexBuffer,uniformValues:Wl(c,Le,xe,d)};if(q)for(var ot=0,at=ze.segments.get();ot<at.length;ot+=1){var st=at[ot];Ce.push({segments:new f.SegmentVector([st]),sortKey:st.sortKey,state:$e})}else Ce.push({segments:ze.segments,sortKey:0,state:$e})}}q&&Ce.sort(function(mi,bi){return mi.sortKey-bi.sortKey});for(var It=0,Dt=Ce;It<Dt.length;It+=1){var Lt=Dt[It],$t=Lt.state;$t.program.draw($,ie.TRIANGLES,he,de,me,Ve.disabled,$t.uniformValues,d.id,$t.layoutVertexBuffer,$t.indexBuffer,Lt.segments,d.paint,c.transform.zoom,$t.programConfiguration)}}}},heatmap:function(c,m,d,x){if(d.paint.get("heatmap-opacity")!==0)if(c.renderPass==="offscreen"){var k=c.context,L=k.gl,B=Se.disabled,q=new Oe([L.ONE,L.ONE],f.Color.transparent,[!0,!0,!0,!0]);(function(Ce,Te,Le){var xe=Ce.gl;Ce.activeTexture.set(xe.TEXTURE1),Ce.viewport.set([0,0,Te.width/4,Te.height/4]);var ze=Le.heatmapFbo;if(ze)xe.bindTexture(xe.TEXTURE_2D,ze.colorAttachment.get()),Ce.bindFramebuffer.set(ze.framebuffer);else{var Fe=xe.createTexture();xe.bindTexture(xe.TEXTURE_2D,Fe),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_S,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_T,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MIN_FILTER,xe.LINEAR),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MAG_FILTER,xe.LINEAR),ze=Le.heatmapFbo=Ce.createFramebuffer(Te.width/4,Te.height/4,!1),function($e,ot,at,st){var It=$e.gl;It.texImage2D(It.TEXTURE_2D,0,It.RGBA,ot.width/4,ot.height/4,0,It.RGBA,$e.extRenderToTextureHalfFloat?$e.extTextureHalfFloat.HALF_FLOAT_OES:It.UNSIGNED_BYTE,null),st.colorAttachment.set(at)}(Ce,Te,Fe,ze)}})(k,c,d),k.clear({color:f.Color.transparent});for(var $=0;$<x.length;$++){var ie=x[$];if(!m.hasRenderableParent(ie)){var he=m.getTile(ie),de=he.getBucket(d);if(de){var me=de.programConfigurations.get(d.id);c.useProgram("heatmap",me).draw(k,L.TRIANGLES,ge.disabled,B,q,Ve.disabled,Xl(ie.posMatrix,he,c.transform.zoom,d.paint.get("heatmap-intensity")),d.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,d.paint,c.transform.zoom,me)}}}k.viewport.set([0,0,c.width,c.height])}else c.renderPass==="translucent"&&(c.context.setColorMode(c.colorModeForRenderPass()),function(Ce,Te){var Le=Ce.context,xe=Le.gl,ze=Te.heatmapFbo;if(ze){Le.activeTexture.set(xe.TEXTURE0),xe.bindTexture(xe.TEXTURE_2D,ze.colorAttachment.get()),Le.activeTexture.set(xe.TEXTURE1);var Fe=Te.colorRampTexture;Fe||(Fe=Te.colorRampTexture=new f.Texture(Le,Te.colorRamp,xe.RGBA)),Fe.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),Ce.useProgram("heatmapTexture").draw(Le,xe.TRIANGLES,ge.disabled,Se.disabled,Ce.colorModeForRenderPass(),Ve.disabled,function($e,ot,at,st){var It=f.create();f.ortho(It,0,$e.width,$e.height,0,0,1);var Dt=$e.context.gl;return{u_matrix:It,u_world:[Dt.drawingBufferWidth,Dt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ot.paint.get("heatmap-opacity")}}(Ce,Te),Te.id,Ce.viewportBuffer,Ce.quadTriangleIndexBuffer,Ce.viewportSegments,Te.paint,Ce.transform.zoom)}}(c,d))},line:function(c,m,d,x){if(c.renderPass==="translucent"){var k=d.paint.get("line-opacity"),L=d.paint.get("line-width");if(k.constantOr(1)!==0&&L.constantOr(1)!==0)for(var B=c.depthModeForSublayer(0,ge.ReadOnly),q=c.colorModeForRenderPass(),$=d.paint.get("line-dasharray"),ie=d.paint.get("line-pattern"),he=ie.constantOr(1),de=d.paint.get("line-gradient"),me=d.getCrossfadeParameters(),Ce=he?"linePattern":$?"lineSDF":de?"lineGradient":"line",Te=c.context,Le=Te.gl,xe=!0,ze=0,Fe=x;ze<Fe.length;ze+=1){var $e=Fe[ze],ot=m.getTile($e);if(!he||ot.patternsLoaded()){var at=ot.getBucket(d);if(at){var st=at.programConfigurations.get(d.id),It=c.context.program.get(),Dt=c.useProgram(Ce,st),Lt=xe||Dt.program!==It,$t=ie.constantOr(null);if($t&&ot.imageAtlas){var mi=ot.imageAtlas,bi=mi.patternPositions[$t.to.toString()],di=mi.patternPositions[$t.from.toString()];bi&&di&&st.setConstantPatternPositions(bi,di)}var ar=he?os(c,ot,d,me):$?zu(c,ot,d,$,me):de?Jr(c,ot,d,at.lineClipsArray.length):ks(c,ot,d);if(he)Te.activeTexture.set(Le.TEXTURE0),ot.imageAtlasTexture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),st.updatePaintBuffers(me);else if($&&(Lt||c.lineAtlas.dirty))Te.activeTexture.set(Le.TEXTURE0),c.lineAtlas.bind(Te);else if(de){var ni=at.gradients[d.id],Bi=ni.texture;if(d.gradientVersion!==ni.version){var er=256;if(d.stepInterpolant){var Li=m.getSource().maxzoom,Pi=$e.canonical.z===Li?Math.ceil(1<<c.transform.maxZoom-$e.canonical.z):1;er=f.clamp(f.nextPowerOfTwo(at.maxLineLength/f.EXTENT*1024*Pi),256,Te.maxTextureSize)}ni.gradient=f.renderColorRamp({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:er,image:ni.gradient||void 0,clips:at.lineClipsArray}),ni.texture?ni.texture.update(ni.gradient):ni.texture=new f.Texture(Te,ni.gradient,Le.RGBA),ni.version=d.gradientVersion,Bi=ni.texture}Te.activeTexture.set(Le.TEXTURE0),Bi.bind(d.stepInterpolant?Le.NEAREST:Le.LINEAR,Le.CLAMP_TO_EDGE)}Dt.draw(Te,Le.TRIANGLES,B,c.stencilModeForClipping($e),q,Ve.disabled,ar,d.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,d.paint,c.transform.zoom,st,at.layoutVertexBuffer2),xe=!1}}}}},fill:function(c,m,d,x){var k=d.paint.get("fill-color"),L=d.paint.get("fill-opacity");if(L.constantOr(1)!==0){var B=c.colorModeForRenderPass(),q=d.paint.get("fill-pattern"),$=c.opaquePassEnabledForLayer()&&!q.constantOr(1)&&k.constantOr(f.Color.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(c.renderPass===$){var ie=c.depthModeForSublayer(1,c.renderPass==="opaque"?ge.ReadWrite:ge.ReadOnly);Ps(c,m,d,x,ie,B,!1)}if(c.renderPass==="translucent"&&d.paint.get("fill-antialias")){var he=c.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,ge.ReadOnly);Ps(c,m,d,x,he,B,!0)}}},"fill-extrusion":function(c,m,d,x){var k=d.paint.get("fill-extrusion-opacity");if(k!==0&&c.renderPass==="translucent"){var L=new ge(c.context.gl.LEQUAL,ge.ReadWrite,c.depthRangeFor3D);if(k!==1||d.paint.get("fill-extrusion-pattern").constantOr(1))Pu(c,m,d,x,L,Se.disabled,Oe.disabled),Pu(c,m,d,x,L,c.stencilModeFor3D(),c.colorModeForRenderPass());else{var B=c.colorModeForRenderPass();Pu(c,m,d,x,L,Se.disabled,B)}}},hillshade:function(c,m,d,x){if(c.renderPass==="offscreen"||c.renderPass==="translucent"){for(var k=c.context,L=c.depthModeForSublayer(0,ge.ReadOnly),B=c.colorModeForRenderPass(),q=c.renderPass==="translucent"?c.stencilConfigForOverlap(x):[{},x],$=q[0],ie=0,he=q[1];ie<he.length;ie+=1){var de=he[ie],me=m.getTile(de);me.needsHillshadePrepare&&c.renderPass==="offscreen"?Nc(c,me,d,L,Se.disabled,B):c.renderPass==="translucent"&&Yl(c,me,d,L,$[de.overscaledZ],B)}k.viewport.set([0,0,c.width,c.height])}},raster:function(c,m,d,x){if(c.renderPass==="translucent"&&d.paint.get("raster-opacity")!==0&&x.length)for(var k=c.context,L=k.gl,B=m.getSource(),q=c.useProgram("raster"),$=c.colorModeForRenderPass(),ie=B instanceof yi?[{},x]:c.stencilConfigForOverlap(x),he=ie[0],de=ie[1],me=de[de.length-1].overscaledZ,Ce=!c.options.moving,Te=0,Le=de;Te<Le.length;Te+=1){var xe=Le[Te],ze=c.depthModeForSublayer(xe.overscaledZ-me,d.paint.get("raster-opacity")===1?ge.ReadWrite:ge.ReadOnly,L.LESS),Fe=m.getTile(xe),$e=c.transform.calculatePosMatrix(xe.toUnwrapped(),Ce);Fe.registerFadeDuration(d.paint.get("raster-fade-duration"));var ot=m.findLoadedParent(xe,0),at=us(Fe,ot,m,d,c.transform),st=void 0,It=void 0,Dt=d.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;k.activeTexture.set(L.TEXTURE0),Fe.texture.bind(Dt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),k.activeTexture.set(L.TEXTURE1),ot?(ot.texture.bind(Dt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),st=Math.pow(2,ot.tileID.overscaledZ-Fe.tileID.overscaledZ),It=[Fe.tileID.canonical.x*st%1,Fe.tileID.canonical.y*st%1]):Fe.texture.bind(Dt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST);var Lt=Uc($e,It||[0,0],st||1,at,d);B instanceof yi?q.draw(k,L.TRIANGLES,ze,Se.disabled,$,Ve.disabled,Lt,d.id,B.boundsBuffer,c.quadTriangleIndexBuffer,B.boundsSegments):q.draw(k,L.TRIANGLES,ze,he[xe.overscaledZ],$,Ve.disabled,Lt,d.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments)}},background:function(c,m,d){var x=d.paint.get("background-color"),k=d.paint.get("background-opacity");if(k!==0){var L=c.context,B=L.gl,q=c.transform,$=q.tileSize,ie=d.paint.get("background-pattern");if(!c.isPatternMissing(ie)){var he=!ie&&x.a===1&&k===1&&c.opaquePassEnabledForLayer()?"opaque":"translucent";if(c.renderPass===he){var de=Se.disabled,me=c.depthModeForSublayer(0,he==="opaque"?ge.ReadWrite:ge.ReadOnly),Ce=c.colorModeForRenderPass(),Te=c.useProgram(ie?"backgroundPattern":"background"),Le=q.coveringTiles({tileSize:$});ie&&(L.activeTexture.set(B.TEXTURE0),c.imageManager.bind(c.context));for(var xe=d.getCrossfadeParameters(),ze=0,Fe=Le;ze<Fe.length;ze+=1){var $e=Fe[ze],ot=c.transform.calculatePosMatrix($e.toUnwrapped()),at=ie?ls(ot,k,c,ie,{tileID:$e,tileSize:$},xe):zs(ot,k,x);Te.draw(L,B.TRIANGLES,me,de,Ce,Ve.disabled,at,d.id,c.tileExtentBuffer,c.quadTriangleIndexBuffer,c.tileExtentSegments)}}}}},debug:function(c,m,d){for(var x=0;x<d.length;x++)$s(c,m,d[x])},custom:function(c,m,d){var x=c.context,k=d.implementation;if(c.renderPass==="offscreen"){var L=k.prerender;L&&(c.setCustomLayerDefaults(),x.setColorMode(c.colorModeForRenderPass()),L.call(k,x.gl,c.transform.customLayerMatrix()),x.setDirty(),c.setBaseState())}else if(c.renderPass==="translucent"){c.setCustomLayerDefaults(),x.setColorMode(c.colorModeForRenderPass()),x.setStencilMode(Se.disabled);var B=k.renderingMode==="3d"?new ge(c.context.gl.LEQUAL,ge.ReadWrite,c.depthRangeFor3D):c.depthModeForSublayer(0,ge.ReadOnly);x.setDepthMode(B),k.render(x.gl,c.transform.customLayerMatrix()),x.setDirty(),c.setBaseState(),x.bindFramebuffer.set(null)}}},sn=function(c,m){this.context=new ye(c),this.transform=m,this._tileTextures={},this.setup(),this.numSublayers=Me.maxUnderzooming+Me.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ua,this.gpuTimers={}};sn.prototype.resize=function(c,m){if(this.width=c*f.browser.devicePixelRatio,this.height=m*f.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var d=0,x=this.style._order;d<x.length;d+=1)this.style._layers[x[d]].resize()},sn.prototype.setup=function(){var c=this.context,m=new f.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(f.EXTENT,0),m.emplaceBack(0,f.EXTENT),m.emplaceBack(f.EXTENT,f.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(m,Tn.members),this.tileExtentSegments=f.SegmentVector.simpleSegment(0,0,4,2);var d=new f.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(f.EXTENT,0),d.emplaceBack(0,f.EXTENT),d.emplaceBack(f.EXTENT,f.EXTENT),this.debugBuffer=c.createVertexBuffer(d,Tn.members),this.debugSegments=f.SegmentVector.simpleSegment(0,0,4,5);var x=new f.StructArrayLayout4i8;x.emplaceBack(0,0,0,0),x.emplaceBack(f.EXTENT,0,f.EXTENT,0),x.emplaceBack(0,f.EXTENT,0,f.EXTENT),x.emplaceBack(f.EXTENT,f.EXTENT,f.EXTENT,f.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(x,ai.members),this.rasterBoundsSegments=f.SegmentVector.simpleSegment(0,0,4,2);var k=new f.StructArrayLayout2i4;k.emplaceBack(0,0),k.emplaceBack(1,0),k.emplaceBack(0,1),k.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(k,Tn.members),this.viewportSegments=f.SegmentVector.simpleSegment(0,0,4,2);var L=new f.StructArrayLayout1ui2;L.emplaceBack(0),L.emplaceBack(1),L.emplaceBack(3),L.emplaceBack(2),L.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(L);var B=new f.StructArrayLayout3ui6;B.emplaceBack(0,1,2),B.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(B),this.emptyTexture=new f.Texture(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA);var q=this.context.gl;this.stencilClearMode=new Se({func:q.ALWAYS,mask:0},0,255,q.ZERO,q.ZERO,q.ZERO)},sn.prototype.clearStencil=function(){var c=this.context,m=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var d=f.create();f.ortho(d,0,this.width,this.height,0,0,1),f.scale(d,d,[m.drawingBufferWidth,m.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,m.TRIANGLES,ge.disabled,this.stencilClearMode,Oe.disabled,Ve.disabled,qa(d),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},sn.prototype._renderTileClippingMasks=function(c,m){if(this.currentStencilSource!==c.source&&c.isTileClipped()&&m&&m.length){this.currentStencilSource=c.source;var d=this.context,x=d.gl;this.nextStencilID+m.length>256&&this.clearStencil(),d.setColorMode(Oe.disabled),d.setDepthMode(ge.disabled);var k=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var L=0,B=m;L<B.length;L+=1){var q=B[L],$=this._tileClippingMaskIDs[q.key]=this.nextStencilID++;k.draw(d,x.TRIANGLES,ge.disabled,new Se({func:x.ALWAYS,mask:0},$,255,x.KEEP,x.KEEP,x.REPLACE),Oe.disabled,Ve.disabled,qa(q.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},sn.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var c=this.nextStencilID++,m=this.context.gl;return new Se({func:m.NOTEQUAL,mask:255},c,255,m.KEEP,m.KEEP,m.REPLACE)},sn.prototype.stencilModeForClipping=function(c){var m=this.context.gl;return new Se({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,m.KEEP,m.KEEP,m.REPLACE)},sn.prototype.stencilConfigForOverlap=function(c){var m,d=this.context.gl,x=c.sort(function($,ie){return ie.overscaledZ-$.overscaledZ}),k=x[x.length-1].overscaledZ,L=x[0].overscaledZ-k+1;if(L>1){this.currentStencilSource=void 0,this.nextStencilID+L>256&&this.clearStencil();for(var B={},q=0;q<L;q++)B[q+k]=new Se({func:d.GEQUAL,mask:255},q+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=L,[B,x]}return[(m={},m[k]=Se.disabled,m),x]},sn.prototype.colorModeForRenderPass=function(){var c=this.context.gl;return this._showOverdrawInspector?new Oe([c.CONSTANT_COLOR,c.ONE],new f.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Oe.unblended:Oe.alphaBlended},sn.prototype.depthModeForSublayer=function(c,m,d){if(!this.opaquePassEnabledForLayer())return ge.disabled;var x=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new ge(d||this.context.gl.LEQUAL,m,[x,x])},sn.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},sn.prototype.render=function(c,m){var d=this;this.style=c,this.options=m,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(f.browser.now()),this.imageManager.beginFrame();var x=this.style._order,k=this.style.sourceCaches;for(var L in k){var B=k[L];B.used&&B.prepare(this.context)}var q,$,ie={},he={},de={};for(var me in k){var Ce=k[me];ie[me]=Ce.getVisibleCoordinates(),he[me]=ie[me].slice().reverse(),de[me]=Ce.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Te=0;Te<x.length;Te++)if(this.style._layers[x[Te]].is3D()){this.opaquePassCutoff=Te;break}this.renderPass="offscreen";for(var Le=0,xe=x;Le<xe.length;Le+=1){var ze=this.style._layers[xe[Le]];if(ze.hasOffscreenPass()&&!ze.isHidden(this.transform.zoom)){var Fe=he[ze.source];(ze.type==="custom"||Fe.length)&&this.renderLayer(this,k[ze.source],ze,Fe)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:m.showOverdrawInspector?f.Color.black:f.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){var $e=this.style._layers[x[this.currentLayer]],ot=k[$e.source],at=ie[$e.source];this._renderTileClippingMasks($e,at),this.renderLayer(this,ot,$e,at)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){var st=this.style._layers[x[this.currentLayer]],It=k[st.source],Dt=(st.type==="symbol"?de:he)[st.source];this._renderTileClippingMasks(st,ie[st.source]),this.renderLayer(this,It,st,Dt)}this.options.showTileBoundaries&&(f.values(this.style._layers).forEach(function(Lt){Lt.source&&!Lt.isHidden(d.transform.zoom)&&(Lt.source!==($&&$.id)&&($=d.style.sourceCaches[Lt.source]),(!q||q.getSource().maxzoom<$.getSource().maxzoom)&&(q=$))}),q&&ua.debug(this,q,q.getVisibleCoordinates())),this.options.showPadding&&function(Lt){var $t=Lt.transform.padding;lc(Lt,Lt.transform.height-($t.top||0),3,Mu),lc(Lt,$t.bottom||0,3,xl),cs(Lt,$t.left||0,3,bl),cs(Lt,Lt.transform.width-($t.right||0),3,zo);var mi=Lt.transform.centerPoint;(function(bi,di,ar,ni){wl(bi,di-1,ar-10,2,20,ni),wl(bi,di-10,ar-1,20,2,ni)})(Lt,mi.x,Lt.transform.height-mi.y,Po)}(this),this.context.setDefault()},sn.prototype.renderLayer=function(c,m,d,x){d.isHidden(this.transform.zoom)||(d.type==="background"||d.type==="custom"||x.length)&&(this.id=d.id,this.gpuTimingStart(d),ua[d.type](c,m,d,x,this.style.placement.variableOffsets),this.gpuTimingEnd())},sn.prototype.gpuTimingStart=function(c){if(this.options.gpuTiming){var m=this.context.extTimerQuery,d=this.gpuTimers[c.id];d||(d=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),d.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,d.query)}},sn.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}},sn.prototype.collectGpuTimers=function(){var c=this.gpuTimers;return this.gpuTimers={},c},sn.prototype.queryGpuTimers=function(c){var m={};for(var d in c){var x=c[d],k=this.context.extTimerQuery,L=k.getQueryObjectEXT(x.query,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(x.query),m[d]=L}return m},sn.prototype.translatePosMatrix=function(c,m,d,x,k){if(!d[0]&&!d[1])return c;var L=k?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(L){var B=Math.sin(L),q=Math.cos(L);d=[d[0]*q-d[1]*B,d[0]*B+d[1]*q]}var $=[k?d[0]:Qr(m,d[0],this.transform.zoom),k?d[1]:Qr(m,d[1],this.transform.zoom),0],ie=new Float32Array(16);return f.translate(ie,c,$),ie},sn.prototype.saveTileTexture=function(c){var m=this._tileTextures[c.size[0]];m?m.push(c):this._tileTextures[c.size[0]]=[c]},sn.prototype.getTileTexture=function(c){var m=this._tileTextures[c];return m&&m.length>0?m.pop():null},sn.prototype.isPatternMissing=function(c){if(!c)return!1;if(!c.from||!c.to)return!0;var m=this.imageManager.getPattern(c.from.toString()),d=this.imageManager.getPattern(c.to.toString());return!m||!d},sn.prototype.useProgram=function(c,m){this.cache=this.cache||{};var d=""+c+(m?m.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[d]||(this.cache[d]=new Cu(this.context,c,Ws[c],m,sc[c],this._showOverdrawInspector)),this.cache[d]},sn.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},sn.prototype.setBaseState=function(){var c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)},sn.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=f.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new f.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},sn.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var El=function(c,m){this.points=c,this.planes=m};El.fromInvProjectionMatrix=function(c,m,d){var x=Math.pow(2,d),k=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(B){return f.transformMat4([],B,c)}).map(function(B){return f.scale$1([],B,1/B[3]/m*x)}),L=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(B){var q=f.sub([],k[B[0]],k[B[1]]),$=f.sub([],k[B[2]],k[B[1]]),ie=f.normalize([],f.cross([],q,$)),he=-f.dot(ie,k[B[1]]);return ie.concat(he)});return new El(k,L)};var Ys=function(c,m){this.min=c,this.max=m,this.center=f.scale$2([],f.add([],this.min,this.max),.5)};Ys.prototype.quadrant=function(c){for(var m=[c%2==0,c<2],d=f.clone$2(this.min),x=f.clone$2(this.max),k=0;k<m.length;k++)d[k]=m[k]?this.min[k]:this.center[k],x[k]=m[k]?this.center[k]:this.max[k];return x[2]=this.max[2],new Ys(d,x)},Ys.prototype.distanceX=function(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]},Ys.prototype.distanceY=function(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]},Ys.prototype.intersects=function(c){for(var m=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],d=!0,x=0;x<c.planes.length;x++){for(var k=c.planes[x],L=0,B=0;B<m.length;B++)L+=f.dot$1(k,m[B])>=0;if(L===0)return 0;L!==m.length&&(d=!1)}if(d)return 2;for(var q=0;q<3;q++){for(var $=Number.MAX_VALUE,ie=-Number.MAX_VALUE,he=0;he<c.points.length;he++){var de=c.points[he][q]-this.min[q];$=Math.min($,de),ie=Math.max(ie,de)}if(ie<0||$>this.max[q]-this.min[q])return 0}return 1};var hs=function(c,m,d,x){if(c===void 0&&(c=0),m===void 0&&(m=0),d===void 0&&(d=0),x===void 0&&(x=0),isNaN(c)||c<0||isNaN(m)||m<0||isNaN(d)||d<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=m,this.left=d,this.right=x};hs.prototype.interpolate=function(c,m,d){return m.top!=null&&c.top!=null&&(this.top=f.number(c.top,m.top,d)),m.bottom!=null&&c.bottom!=null&&(this.bottom=f.number(c.bottom,m.bottom,d)),m.left!=null&&c.left!=null&&(this.left=f.number(c.left,m.left,d)),m.right!=null&&c.right!=null&&(this.right=f.number(c.right,m.right,d)),this},hs.prototype.getCenter=function(c,m){var d=f.clamp((this.left+c-this.right)/2,0,c),x=f.clamp((this.top+m-this.bottom)/2,0,m);return new f.Point(d,x)},hs.prototype.equals=function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right},hs.prototype.clone=function(){return new hs(this.top,this.bottom,this.left,this.right)},hs.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Qi=function(c,m,d,x,k){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=k===void 0||k,this._minZoom=c||0,this._maxZoom=m||22,this._minPitch=d==null?0:d,this._maxPitch=x==null?60:x,this.setMaxBounds(),this.width=0,this.height=0,this._center=new f.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new hs,this._posMatrixCache={},this._alignedPosMatrixCache={}},Mr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Qi.prototype.clone=function(){var c=new Qi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c._center=this._center,c.zoom=this.zoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._calcMatrices(),c},Mr.minZoom.get=function(){return this._minZoom},Mr.minZoom.set=function(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))},Mr.maxZoom.get=function(){return this._maxZoom},Mr.maxZoom.set=function(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))},Mr.minPitch.get=function(){return this._minPitch},Mr.minPitch.set=function(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))},Mr.maxPitch.get=function(){return this._maxPitch},Mr.maxPitch.set=function(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))},Mr.renderWorldCopies.get=function(){return this._renderWorldCopies},Mr.renderWorldCopies.set=function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c},Mr.worldSize.get=function(){return this.tileSize*this.scale},Mr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Mr.size.get=function(){return new f.Point(this.width,this.height)},Mr.bearing.get=function(){return-this.angle/Math.PI*180},Mr.bearing.set=function(c){var m=-f.wrap(c,-180,180)*Math.PI/180;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=f.create$2(),f.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Mr.pitch.get=function(){return this._pitch/Math.PI*180},Mr.pitch.set=function(c){var m=f.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())},Mr.fov.get=function(){return this._fov/Math.PI*180},Mr.fov.set=function(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())},Mr.zoom.get=function(){return this._zoom},Mr.zoom.set=function(c){var m=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._zoom=m,this.scale=this.zoomScale(m),this.tileZoom=Math.floor(m),this.zoomFraction=m-this.tileZoom,this._constrain(),this._calcMatrices())},Mr.center.get=function(){return this._center},Mr.center.set=function(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())},Mr.padding.get=function(){return this._edgeInsets.toJSON()},Mr.padding.set=function(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())},Mr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Qi.prototype.isPaddingEqual=function(c){return this._edgeInsets.equals(c)},Qi.prototype.interpolatePadding=function(c,m,d){this._unmodified=!1,this._edgeInsets.interpolate(c,m,d),this._constrain(),this._calcMatrices()},Qi.prototype.coveringZoomLevel=function(c){var m=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,m)},Qi.prototype.getVisibleUnwrappedCoordinates=function(c){var m=[new f.UnwrappedTileID(0,c)];if(this._renderWorldCopies)for(var d=this.pointCoordinate(new f.Point(0,0)),x=this.pointCoordinate(new f.Point(this.width,0)),k=this.pointCoordinate(new f.Point(this.width,this.height)),L=this.pointCoordinate(new f.Point(0,this.height)),B=Math.floor(Math.min(d.x,x.x,k.x,L.x)),q=Math.floor(Math.max(d.x,x.x,k.x,L.x)),$=B-1;$<=q+1;$++)$!==0&&m.push(new f.UnwrappedTileID($,c));return m},Qi.prototype.coveringTiles=function(c){var m=this.coveringZoomLevel(c),d=m;if(c.minzoom!==void 0&&m<c.minzoom)return[];c.maxzoom!==void 0&&m>c.maxzoom&&(m=c.maxzoom);var x=f.MercatorCoordinate.fromLngLat(this.center),k=Math.pow(2,m),L=[k*x.x,k*x.y,0],B=El.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m),q=c.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(q=m);var $=function(Lt){return{aabb:new Ys([Lt*k,0,0],[(Lt+1)*k,k,0]),zoom:0,x:0,y:0,wrap:Lt,fullyVisible:!1}},ie=[],he=[],de=m,me=c.reparseOverscaled?d:m;if(this._renderWorldCopies)for(var Ce=1;Ce<=3;Ce++)ie.push($(-Ce)),ie.push($(Ce));for(ie.push($(0));ie.length>0;){var Te=ie.pop(),Le=Te.x,xe=Te.y,ze=Te.fullyVisible;if(!ze){var Fe=Te.aabb.intersects(B);if(Fe===0)continue;ze=Fe===2}var $e=Te.aabb.distanceX(L),ot=Te.aabb.distanceY(L),at=Math.max(Math.abs($e),Math.abs(ot));if(Te.zoom===de||at>3+(1<<de-Te.zoom)-2&&Te.zoom>=q)he.push({tileID:new f.OverscaledTileID(Te.zoom===de?me:Te.zoom,Te.wrap,Te.zoom,Le,xe),distanceSq:f.sqrLen([L[0]-.5-Le,L[1]-.5-xe])});else for(var st=0;st<4;st++){var It=(Le<<1)+st%2,Dt=(xe<<1)+(st>>1);ie.push({aabb:Te.aabb.quadrant(st),zoom:Te.zoom+1,x:It,y:Dt,wrap:Te.wrap,fullyVisible:ze})}}return he.sort(function(Lt,$t){return Lt.distanceSq-$t.distanceSq}).map(function(Lt){return Lt.tileID})},Qi.prototype.resize=function(c,m){this.width=c,this.height=m,this.pixelsToGLUnits=[2/c,-2/m],this._constrain(),this._calcMatrices()},Mr.unmodified.get=function(){return this._unmodified},Qi.prototype.zoomScale=function(c){return Math.pow(2,c)},Qi.prototype.scaleZoom=function(c){return Math.log(c)/Math.LN2},Qi.prototype.project=function(c){var m=f.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new f.Point(f.mercatorXfromLng(c.lng)*this.worldSize,f.mercatorYfromLat(m)*this.worldSize)},Qi.prototype.unproject=function(c){return new f.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()},Mr.point.get=function(){return this.project(this.center)},Qi.prototype.setLocationAtPoint=function(c,m){var d=this.pointCoordinate(m),x=this.pointCoordinate(this.centerPoint),k=this.locationCoordinate(c),L=new f.MercatorCoordinate(k.x-(d.x-x.x),k.y-(d.y-x.y));this.center=this.coordinateLocation(L),this._renderWorldCopies&&(this.center=this.center.wrap())},Qi.prototype.locationPoint=function(c){return this.coordinatePoint(this.locationCoordinate(c))},Qi.prototype.pointLocation=function(c){return this.coordinateLocation(this.pointCoordinate(c))},Qi.prototype.locationCoordinate=function(c){return f.MercatorCoordinate.fromLngLat(c)},Qi.prototype.coordinateLocation=function(c){return c.toLngLat()},Qi.prototype.pointCoordinate=function(c){var m=[c.x,c.y,0,1],d=[c.x,c.y,1,1];f.transformMat4(m,m,this.pixelMatrixInverse),f.transformMat4(d,d,this.pixelMatrixInverse);var x=m[3],k=d[3],L=m[1]/x,B=d[1]/k,q=m[2]/x,$=d[2]/k,ie=q===$?0:(0-q)/($-q);return new f.MercatorCoordinate(f.number(m[0]/x,d[0]/k,ie)/this.worldSize,f.number(L,B,ie)/this.worldSize)},Qi.prototype.coordinatePoint=function(c){var m=[c.x*this.worldSize,c.y*this.worldSize,0,1];return f.transformMat4(m,m,this.pixelMatrix),new f.Point(m[0]/m[3],m[1]/m[3])},Qi.prototype.getBounds=function(){return new f.LngLatBounds().extend(this.pointLocation(new f.Point(0,0))).extend(this.pointLocation(new f.Point(this.width,0))).extend(this.pointLocation(new f.Point(this.width,this.height))).extend(this.pointLocation(new f.Point(0,this.height)))},Qi.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new f.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Qi.prototype.setMaxBounds=function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Qi.prototype.calculatePosMatrix=function(c,m){m===void 0&&(m=!1);var d=c.key,x=m?this._alignedPosMatrixCache:this._posMatrixCache;if(x[d])return x[d];var k=c.canonical,L=this.worldSize/this.zoomScale(k.z),B=k.x+Math.pow(2,k.z)*c.wrap,q=f.identity(new Float64Array(16));return f.translate(q,q,[B*L,k.y*L,0]),f.scale(q,q,[L/f.EXTENT,L/f.EXTENT,1]),f.multiply(q,m?this.alignedProjMatrix:this.projMatrix,q),x[d]=new Float32Array(q),x[d]},Qi.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Qi.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var c,m,d,x,k=-90,L=90,B=-180,q=180,$=this.size,ie=this._unmodified;if(this.latRange){var he=this.latRange;k=f.mercatorYfromLat(he[1])*this.worldSize,c=(L=f.mercatorYfromLat(he[0])*this.worldSize)-k<$.y?$.y/(L-k):0}if(this.lngRange){var de=this.lngRange;B=f.mercatorXfromLng(de[0])*this.worldSize,m=(q=f.mercatorXfromLng(de[1])*this.worldSize)-B<$.x?$.x/(q-B):0}var me=this.point,Ce=Math.max(m||0,c||0);if(Ce)return this.center=this.unproject(new f.Point(m?(q+B)/2:me.x,c?(L+k)/2:me.y)),this.zoom+=this.scaleZoom(Ce),this._unmodified=ie,void(this._constraining=!1);if(this.latRange){var Te=me.y,Le=$.y/2;Te-Le<k&&(x=k+Le),Te+Le>L&&(x=L-Le)}if(this.lngRange){var xe=me.x,ze=$.x/2;xe-ze<B&&(d=B+ze),xe+ze>q&&(d=q-ze)}d===void 0&&x===void 0||(this.center=this.unproject(new f.Point(d!==void 0?d:me.x,x!==void 0?x:me.y))),this._unmodified=ie,this._constraining=!1}},Qi.prototype._calcMatrices=function(){if(this.height){var c=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var m=Math.PI/2+this._pitch,d=this._fov*(.5+c.y/this.height),x=Math.sin(d)*this.cameraToCenterDistance/Math.sin(f.clamp(Math.PI-m-d,.01,Math.PI-.01)),k=this.point,L=k.x,B=k.y,q=1.01*(Math.cos(Math.PI/2-this._pitch)*x+this.cameraToCenterDistance),$=this.height/50,ie=new Float64Array(16);f.perspective(ie,this._fov,this.width/this.height,$,q),ie[8]=2*-c.x/this.width,ie[9]=2*c.y/this.height,f.scale(ie,ie,[1,-1,1]),f.translate(ie,ie,[0,0,-this.cameraToCenterDistance]),f.rotateX(ie,ie,this._pitch),f.rotateZ(ie,ie,this.angle),f.translate(ie,ie,[-L,-B,0]),this.mercatorMatrix=f.scale([],ie,[this.worldSize,this.worldSize,this.worldSize]),f.scale(ie,ie,[1,1,f.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=ie,this.invProjMatrix=f.invert([],this.projMatrix);var he=this.width%2/2,de=this.height%2/2,me=Math.cos(this.angle),Ce=Math.sin(this.angle),Te=L-Math.round(L)+me*he+Ce*de,Le=B-Math.round(B)+me*de+Ce*he,xe=new Float64Array(ie);if(f.translate(xe,xe,[Te>.5?Te-1:Te,Le>.5?Le-1:Le,0]),this.alignedProjMatrix=xe,ie=f.create(),f.scale(ie,ie,[this.width/2,-this.height/2,1]),f.translate(ie,ie,[1,-1,0]),this.labelPlaneMatrix=ie,ie=f.create(),f.scale(ie,ie,[1,-1,1]),f.translate(ie,ie,[-1,-1,0]),f.scale(ie,ie,[2/this.width,2/this.height,1]),this.glCoordMatrix=ie,this.pixelMatrix=f.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(ie=f.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=ie,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Qi.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new f.Point(0,0)),m=[c.x*this.worldSize,c.y*this.worldSize,0,1];return f.transformMat4(m,m,this.pixelMatrix)[3]/this.cameraToCenterDistance},Qi.prototype.getCameraPoint=function(){var c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new f.Point(0,c))},Qi.prototype.getCameraQueryGeometry=function(c){var m=this.getCameraPoint();if(c.length===1)return[c[0],m];for(var d=m.x,x=m.y,k=m.x,L=m.y,B=0,q=c;B<q.length;B+=1){var $=q[B];d=Math.min(d,$.x),x=Math.min(x,$.y),k=Math.max(k,$.x),L=Math.max(L,$.y)}return[new f.Point(d,x),new f.Point(k,x),new f.Point(k,L),new f.Point(d,L),new f.Point(d,x)]},Object.defineProperties(Qi.prototype,Mr);var Jt=function(c){var m,d,x,k;this._hashName=c&&encodeURIComponent(c),f.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(m=this._updateHashUnthrottled.bind(this),d=!1,x=null,k=function(){x=null,d&&(m(),x=setTimeout(k,300),d=!1)},function(){return d=!0,x||k(),x})};Jt.prototype.addTo=function(c){return this._map=c,f.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Jt.prototype.remove=function(){return f.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Jt.prototype.getHashString=function(c){var m=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,x=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),k=Math.pow(10,x),L=Math.round(m.lng*k)/k,B=Math.round(m.lat*k)/k,q=this._map.getBearing(),$=this._map.getPitch(),ie="";if(ie+=c?"/"+L+"/"+B+"/"+d:d+"/"+B+"/"+L,(q||$)&&(ie+="/"+Math.round(10*q)/10),$&&(ie+="/"+Math.round($)),this._hashName){var he=this._hashName,de=!1,me=f.window.location.hash.slice(1).split("&").map(function(Ce){var Te=Ce.split("=")[0];return Te===he?(de=!0,Te+"="+ie):Ce}).filter(function(Ce){return Ce});return de||me.push(he+"="+ie),"#"+me.join("&")}return"#"+ie},Jt.prototype._getCurrentHash=function(){var c,m=this,d=f.window.location.hash.replace("#","");return this._hashName?(d.split("&").map(function(x){return x.split("=")}).forEach(function(x){x[0]===m._hashName&&(c=x)}),(c&&c[1]||"").split("/")):d.split("/")},Jt.prototype._onHashChange=function(){var c=this._getCurrentHash();if(c.length>=3&&!c.some(function(d){return isNaN(d)})){var m=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:m,pitch:+(c[4]||0)}),!0}return!1},Jt.prototype._updateHashUnthrottled=function(){var c=f.window.location.href.replace(/(#.+)?$/,this.getHashString());try{f.window.history.replaceState(f.window.history.state,null,c)}catch{}};var Qs={linearity:.3,easing:f.bezier(0,0,.3,1)},Za=f.extend({deceleration:2500,maxSpeed:1400},Qs),Ca=f.extend({deceleration:20,maxSpeed:1400},Qs),Ql=f.extend({deceleration:1e3,maxSpeed:360},Qs),ri=f.extend({deceleration:1e3,maxSpeed:90},Qs),el=function(c){this._map=c,this.clear()};function Il(c,m){(!c.duration||c.duration<m.duration)&&(c.duration=m.duration,c.easing=m.easing)}function ps(c,m,d){var x=d.maxSpeed,k=d.linearity,L=d.deceleration,B=f.clamp(c*k/(m/1e3),-x,x),q=Math.abs(B)/(L*k);return{easing:d.easing,duration:1e3*q,amount:B*(q/2)}}el.prototype.clear=function(){this._inertiaBuffer=[]},el.prototype.record=function(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:f.browser.now(),settings:c})},el.prototype._drainInertiaBuffer=function(){for(var c=this._inertiaBuffer,m=f.browser.now();c.length>0&&m-c[0].time>160;)c.shift()},el.prototype._onMoveEnd=function(c){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var m={zoom:0,bearing:0,pitch:0,pan:new f.Point(0,0),pinchAround:void 0,around:void 0},d=0,x=this._inertiaBuffer;d<x.length;d+=1){var k=x[d].settings;m.zoom+=k.zoomDelta||0,m.bearing+=k.bearingDelta||0,m.pitch+=k.pitchDelta||0,k.panDelta&&m.pan._add(k.panDelta),k.around&&(m.around=k.around),k.pinchAround&&(m.pinchAround=k.pinchAround)}var L=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,B={};if(m.pan.mag()){var q=ps(m.pan.mag(),L,f.extend({},Za,c||{}));B.offset=m.pan.mult(q.amount/m.pan.mag()),B.center=this._map.transform.center,Il(B,q)}if(m.zoom){var $=ps(m.zoom,L,Ca);B.zoom=this._map.transform.zoom+$.amount,Il(B,$)}if(m.bearing){var ie=ps(m.bearing,L,Ql);B.bearing=this._map.transform.bearing+f.clamp(ie.amount,-179,179),Il(B,ie)}if(m.pitch){var he=ps(m.pitch,L,ri);B.pitch=this._map.transform.pitch+he.amount,Il(B,he)}if(B.zoom||B.bearing){var de=m.pinchAround===void 0?m.around:m.pinchAround;B.around=de?this._map.unproject(de):this._map.getCenter()}return this.clear(),f.extend(B,{noMoveStart:!0})}};var pn=function(c){function m(x,k,L,B){B===void 0&&(B={});var q=D.mousePos(k.getCanvasContainer(),L),$=k.unproject(q);c.call(this,x,f.extend({point:q,lngLat:$,originalEvent:L},B)),this._defaultPrevented=!1,this.target=k}c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m;var d={defaultPrevented:{configurable:!0}};return m.prototype.preventDefault=function(){this._defaultPrevented=!0},d.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(m.prototype,d),m}(f.Event),Sl=function(c){function m(x,k,L){var B=x==="touchend"?L.changedTouches:L.touches,q=D.touchPos(k.getCanvasContainer(),B),$=q.map(function(de){return k.unproject(de)}),ie=q.reduce(function(de,me,Ce,Te){return de.add(me.div(Te.length))},new f.Point(0,0)),he=k.unproject(ie);c.call(this,x,{points:q,point:ie,lngLats:$,lngLat:he,originalEvent:L}),this._defaultPrevented=!1}c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m;var d={defaultPrevented:{configurable:!0}};return m.prototype.preventDefault=function(){this._defaultPrevented=!0},d.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(m.prototype,d),m}(f.Event),uc=function(c){function m(x,k,L){c.call(this,x,{originalEvent:L}),this._defaultPrevented=!1}c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m;var d={defaultPrevented:{configurable:!0}};return m.prototype.preventDefault=function(){this._defaultPrevented=!0},d.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(m.prototype,d),m}(f.Event),zn=function(c,m){this._map=c,this._clickTolerance=m.clickTolerance};zn.prototype.reset=function(){delete this._mousedownPos},zn.prototype.wheel=function(c){return this._firePreventable(new uc(c.type,this._map,c))},zn.prototype.mousedown=function(c,m){return this._mousedownPos=m,this._firePreventable(new pn(c.type,this._map,c))},zn.prototype.mouseup=function(c){this._map.fire(new pn(c.type,this._map,c))},zn.prototype.click=function(c,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||this._map.fire(new pn(c.type,this._map,c))},zn.prototype.dblclick=function(c){return this._firePreventable(new pn(c.type,this._map,c))},zn.prototype.mouseover=function(c){this._map.fire(new pn(c.type,this._map,c))},zn.prototype.mouseout=function(c){this._map.fire(new pn(c.type,this._map,c))},zn.prototype.touchstart=function(c){return this._firePreventable(new Sl(c.type,this._map,c))},zn.prototype.touchmove=function(c){this._map.fire(new Sl(c.type,this._map,c))},zn.prototype.touchend=function(c){this._map.fire(new Sl(c.type,this._map,c))},zn.prototype.touchcancel=function(c){this._map.fire(new Sl(c.type,this._map,c))},zn.prototype._firePreventable=function(c){if(this._map.fire(c),c.defaultPrevented)return{}},zn.prototype.isEnabled=function(){return!0},zn.prototype.isActive=function(){return!1},zn.prototype.enable=function(){},zn.prototype.disable=function(){};var oi=function(c){this._map=c};oi.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},oi.prototype.mousemove=function(c){this._map.fire(new pn(c.type,this._map,c))},oi.prototype.mousedown=function(){this._delayContextMenu=!0},oi.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new pn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},oi.prototype.contextmenu=function(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new pn(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()},oi.prototype.isEnabled=function(){return!0},oi.prototype.isActive=function(){return!1},oi.prototype.enable=function(){},oi.prototype.disable=function(){};var Io=function(c,m){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=m.clickTolerance||1};function Tl(c,m){for(var d={},x=0;x<c.length;x++)d[c[x].identifier]=m[x];return d}Io.prototype.isEnabled=function(){return!!this._enabled},Io.prototype.isActive=function(){return!!this._active},Io.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Io.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Io.prototype.mousedown=function(c,m){this.isEnabled()&&c.shiftKey&&c.button===0&&(D.disableDrag(),this._startPos=this._lastPos=m,this._active=!0)},Io.prototype.mousemoveWindow=function(c,m){if(this._active){var d=m;if(!(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)){var x=this._startPos;this._lastPos=d,this._box||(this._box=D.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));var k=Math.min(x.x,d.x),L=Math.max(x.x,d.x),B=Math.min(x.y,d.y),q=Math.max(x.y,d.y);D.setTransform(this._box,"translate("+k+"px,"+B+"px)"),this._box.style.width=L-k+"px",this._box.style.height=q-B+"px"}}},Io.prototype.mouseupWindow=function(c,m){var d=this;if(this._active&&c.button===0){var x=this._startPos,k=m;if(this.reset(),D.suppressClick(),x.x!==k.x||x.y!==k.y)return this._map.fire(new f.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:function(L){return L.fitScreenCoordinates(x,k,d._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",c)}},Io.prototype.keydown=function(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))},Io.prototype.blur=function(){this.reset()},Io.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos},Io.prototype._fireEvent=function(c,m){return this._map.fire(new f.Event(c,{originalEvent:m}))};var Ms=function(c){this.reset(),this.numTouches=c.numTouches};Ms.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ms.prototype.touchstart=function(c,m,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),d.length===this.numTouches&&(this.centroid=function(x){for(var k=new f.Point(0,0),L=0,B=x;L<B.length;L+=1)k._add(B[L]);return k.div(x.length)}(m),this.touches=Tl(d,m)))},Ms.prototype.touchmove=function(c,m,d){if(!this.aborted&&this.centroid){var x=Tl(d,m);for(var k in this.touches){var L=x[k];(!L||L.dist(this.touches[k])>30)&&(this.aborted=!0)}}},Ms.prototype.touchend=function(c,m,d){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){var x=!this.aborted&&this.centroid;if(this.reset(),x)return x}};var ca=function(c){this.singleTap=new Ms(c),this.numTaps=c.numTaps,this.reset()};ca.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ca.prototype.touchstart=function(c,m,d){this.singleTap.touchstart(c,m,d)},ca.prototype.touchmove=function(c,m,d){this.singleTap.touchmove(c,m,d)},ca.prototype.touchend=function(c,m,d){var x=this.singleTap.touchend(c,m,d);if(x){var k=c.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(x)<30;if(k&&L||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}};var ln=function(){this._zoomIn=new ca({numTouches:1,numTaps:2}),this._zoomOut=new ca({numTouches:2,numTaps:1}),this.reset()};ln.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ln.prototype.touchstart=function(c,m,d){this._zoomIn.touchstart(c,m,d),this._zoomOut.touchstart(c,m,d)},ln.prototype.touchmove=function(c,m,d){this._zoomIn.touchmove(c,m,d),this._zoomOut.touchmove(c,m,d)},ln.prototype.touchend=function(c,m,d){var x=this,k=this._zoomIn.touchend(c,m,d),L=this._zoomOut.touchend(c,m,d);return k?(this._active=!0,c.preventDefault(),setTimeout(function(){return x.reset()},0),{cameraAnimation:function(B){return B.easeTo({duration:300,zoom:B.getZoom()+1,around:B.unproject(k)},{originalEvent:c})}}):L?(this._active=!0,c.preventDefault(),setTimeout(function(){return x.reset()},0),{cameraAnimation:function(B){return B.easeTo({duration:300,zoom:B.getZoom()-1,around:B.unproject(L)},{originalEvent:c})}}):void 0},ln.prototype.touchcancel=function(){this.reset()},ln.prototype.enable=function(){this._enabled=!0},ln.prototype.disable=function(){this._enabled=!1,this.reset()},ln.prototype.isEnabled=function(){return this._enabled},ln.prototype.isActive=function(){return this._active};var Ha={0:1,2:2},qt=function(c){this.reset(),this._clickTolerance=c.clickTolerance||1};qt.prototype.blur=function(){this.reset()},qt.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},qt.prototype._correctButton=function(c,m){return!1},qt.prototype._move=function(c,m){return{}},qt.prototype.mousedown=function(c,m){if(!this._lastPoint){var d=D.mouseButton(c);this._correctButton(c,d)&&(this._lastPoint=m,this._eventButton=d)}},qt.prototype.mousemoveWindow=function(c,m){var d=this._lastPoint;if(d){if(c.preventDefault(),function(x,k){var L=Ha[k];return x.buttons===void 0||(x.buttons&L)!==L}(c,this._eventButton))this.reset();else if(this._moved||!(m.dist(d)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(d,m)}},qt.prototype.mouseupWindow=function(c){this._lastPoint&&D.mouseButton(c)===this._eventButton&&(this._moved&&D.suppressClick(),this.reset())},qt.prototype.enable=function(){this._enabled=!0},qt.prototype.disable=function(){this._enabled=!1,this.reset()},qt.prototype.isEnabled=function(){return this._enabled},qt.prototype.isActive=function(){return this._active};var eu=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.mousedown=function(d,x){c.prototype.mousedown.call(this,d,x),this._lastPoint&&(this._active=!0)},m.prototype._correctButton=function(d,x){return x===0&&!d.ctrlKey},m.prototype._move=function(d,x){return{around:x,panDelta:x.sub(d)}},m}(qt),ds=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype._correctButton=function(d,x){return x===0&&d.ctrlKey||x===2},m.prototype._move=function(d,x){var k=.8*(x.x-d.x);if(k)return this._active=!0,{bearingDelta:k}},m.prototype.contextmenu=function(d){d.preventDefault()},m}(qt),tu=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype._correctButton=function(d,x){return x===0&&d.ctrlKey||x===2},m.prototype._move=function(d,x){var k=-.5*(x.y-d.y);if(k)return this._active=!0,{pitchDelta:k}},m.prototype.contextmenu=function(d){d.preventDefault()},m}(qt),Uo=function(c){this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset()};Uo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new f.Point(0,0)},Uo.prototype.touchstart=function(c,m,d){return this._calculateTransform(c,m,d)},Uo.prototype.touchmove=function(c,m,d){if(this._active&&!(d.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,m,d)},Uo.prototype.touchend=function(c,m,d){this._calculateTransform(c,m,d),this._active&&d.length<this._minTouches&&this.reset()},Uo.prototype.touchcancel=function(){this.reset()},Uo.prototype._calculateTransform=function(c,m,d){d.length>0&&(this._active=!0);var x=Tl(d,m),k=new f.Point(0,0),L=new f.Point(0,0),B=0;for(var q in x){var $=x[q],ie=this._touches[q];ie&&(k._add($),L._add($.sub(ie)),B++,x[q]=$)}if(this._touches=x,!(B<this._minTouches)&&L.mag()){var he=L.div(B);if(this._sum._add(he),!(this._sum.mag()<this._clickTolerance))return{around:k.div(B),panDelta:he}}},Uo.prototype.enable=function(){this._enabled=!0},Uo.prototype.disable=function(){this._enabled=!1,this.reset()},Uo.prototype.isEnabled=function(){return this._enabled},Uo.prototype.isActive=function(){return this._active};var dn=function(){this.reset()};function rn(c,m,d){for(var x=0;x<c.length;x++)if(c[x].identifier===d)return m[x]}function tl(c,m){return Math.log(c/m)/Math.LN2}dn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},dn.prototype._start=function(c){},dn.prototype._move=function(c,m,d){return{}},dn.prototype.touchstart=function(c,m,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([m[0],m[1]]))},dn.prototype.touchmove=function(c,m,d){if(this._firstTwoTouches){c.preventDefault();var x=this._firstTwoTouches,k=x[1],L=rn(d,m,x[0]),B=rn(d,m,k);if(L&&B){var q=this._aroundCenter?null:L.add(B).div(2);return this._move([L,B],q,c)}}},dn.prototype.touchend=function(c,m,d){if(this._firstTwoTouches){var x=this._firstTwoTouches,k=x[1],L=rn(d,m,x[0]),B=rn(d,m,k);L&&B||(this._active&&D.suppressClick(),this.reset())}},dn.prototype.touchcancel=function(){this.reset()},dn.prototype.enable=function(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"},dn.prototype.disable=function(){this._enabled=!1,this.reset()},dn.prototype.isEnabled=function(){return this._enabled},dn.prototype.isActive=function(){return this._active};var So=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.reset=function(){c.prototype.reset.call(this),delete this._distance,delete this._startDistance},m.prototype._start=function(d){this._startDistance=this._distance=d[0].dist(d[1])},m.prototype._move=function(d,x){var k=this._distance;if(this._distance=d[0].dist(d[1]),this._active||!(Math.abs(tl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:tl(this._distance,k),pinchAround:x}},m}(dn);function ka(c,m){return 180*c.angleWith(m)/Math.PI}var cc=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.reset=function(){c.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},m.prototype._start=function(d){this._startVector=this._vector=d[0].sub(d[1]),this._minDiameter=d[0].dist(d[1])},m.prototype._move=function(d,x){var k=this._vector;if(this._vector=d[0].sub(d[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ka(this._vector,k),pinchAround:x}},m.prototype._isBelowThreshold=function(d){this._minDiameter=Math.min(this._minDiameter,d.mag());var x=25/(Math.PI*this._minDiameter)*360,k=ka(d,this._startVector);return Math.abs(k)<x},m}(dn);function Al(c){return Math.abs(c.y)>Math.abs(c.x)}var hc=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.reset=function(){c.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},m.prototype._start=function(d){this._lastPoints=d,Al(d[0].sub(d[1]))&&(this._valid=!1)},m.prototype._move=function(d,x,k){var L=d[0].sub(this._lastPoints[0]),B=d[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(L,B,k.timeStamp),this._valid)return this._lastPoints=d,this._active=!0,{pitchDelta:(L.y+B.y)/2*-.5}},m.prototype.gestureBeginsVertically=function(d,x,k){if(this._valid!==void 0)return this._valid;var L=d.mag()>=2,B=x.mag()>=2;if(L||B){if(!L||!B)return this._firstMove===void 0&&(this._firstMove=k),k-this._firstMove<100&&void 0;var q=d.y>0==x.y>0;return Al(d)&&Al(x)&&q}},m}(dn),va={panStep:100,bearingStep:15,pitchStep:10},Wo=function(){var c=va;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1};function si(c){return c*(2-c)}Wo.prototype.blur=function(){this.reset()},Wo.prototype.reset=function(){this._active=!1},Wo.prototype.keydown=function(c){var m=this;if(!(c.altKey||c.ctrlKey||c.metaKey)){var d=0,x=0,k=0,L=0,B=0;switch(c.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:c.shiftKey?x=-1:(c.preventDefault(),L=-1);break;case 39:c.shiftKey?x=1:(c.preventDefault(),L=1);break;case 38:c.shiftKey?k=1:(c.preventDefault(),B=-1);break;case 40:c.shiftKey?k=-1:(c.preventDefault(),B=1);break;default:return}return this._rotationDisabled&&(x=0,k=0),{cameraAnimation:function(q){var $=q.getZoom();q.easeTo({duration:300,easeId:"keyboardHandler",easing:si,zoom:d?Math.round($)+d*(c.shiftKey?2:1):$,bearing:q.getBearing()+x*m._bearingStep,pitch:q.getPitch()+k*m._pitchStep,offset:[-L*m._panStep,-B*m._panStep],center:q.getCenter()},{originalEvent:c})}}}},Wo.prototype.enable=function(){this._enabled=!0},Wo.prototype.disable=function(){this._enabled=!1,this.reset()},Wo.prototype.isEnabled=function(){return this._enabled},Wo.prototype.isActive=function(){return this._active},Wo.prototype.disableRotation=function(){this._rotationDisabled=!0},Wo.prototype.enableRotation=function(){this._rotationDisabled=!1};var Nt=function(c,m){this._map=c,this._el=c.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,f.bindAll(["_onTimeout"],this)};Nt.prototype.setZoomRate=function(c){this._defaultZoomRate=c},Nt.prototype.setWheelZoomRate=function(c){this._wheelZoomRate=c},Nt.prototype.isEnabled=function(){return!!this._enabled},Nt.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Nt.prototype.isZooming=function(){return!!this._zooming},Nt.prototype.enable=function(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&c.around==="center")},Nt.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Nt.prototype.wheel=function(c){if(this.isEnabled()){var m=c.deltaMode===f.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY,d=f.browser.now(),x=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,m!==0&&m%4.000244140625==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(x*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),c.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=c,this._delta-=m,this._active||this._start(c)),c.preventDefault()}},Nt.prototype._onTimeout=function(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},Nt.prototype._start=function(c){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var m=D.mousePos(this._el,c);this._around=f.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(m)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Nt.prototype.renderFrame=function(){var c=this;if(this._frameId&&(this._frameId=null,this.isActive())){var m=this._map.transform;if(this._delta!==0){var d=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,x=2/(1+Math.exp(-Math.abs(this._delta*d)));this._delta<0&&x!==0&&(x=1/x);var k=typeof this._targetZoom=="number"?m.zoomScale(this._targetZoom):m.scale;this._targetZoom=Math.min(m.maxZoom,Math.max(m.minZoom,m.scaleZoom(k*x))),this._type==="wheel"&&(this._startZoom=m.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var L,B=typeof this._targetZoom=="number"?this._targetZoom:m.zoom,q=this._startZoom,$=this._easing,ie=!1;if(this._type==="wheel"&&q&&$){var he=Math.min((f.browser.now()-this._lastWheelEventTime)/200,1),de=$(he);L=f.number(q,B,de),he<1?this._frameId||(this._frameId=!0):ie=!0}else L=B,ie=!0;return this._active=!0,ie&&(this._active=!1,this._finishTimeout=setTimeout(function(){c._zooming=!1,c._handler._triggerRenderFrame(),delete c._targetZoom,delete c._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!ie,zoomDelta:L-m.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Nt.prototype._smoothOutEasing=function(c){var m=f.ease;if(this._prevEase){var d=this._prevEase,x=(f.browser.now()-d.start)/d.duration,k=d.easing(x+.01)-d.easing(x),L=.27/Math.sqrt(k*k+1e-4)*.01,B=Math.sqrt(.0729-L*L);m=f.bezier(L,B,.25,1)}return this._prevEase={start:f.browser.now(),duration:c,easing:m},m},Nt.prototype.blur=function(){this.reset()},Nt.prototype.reset=function(){this._active=!1};var Xo=function(c,m){this._clickZoom=c,this._tapZoom=m};Xo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Xo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Xo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Xo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Mo=function(){this.reset()};Mo.prototype.reset=function(){this._active=!1},Mo.prototype.blur=function(){this.reset()},Mo.prototype.dblclick=function(c,m){return c.preventDefault(),{cameraAnimation:function(d){d.easeTo({duration:300,zoom:d.getZoom()+(c.shiftKey?-1:1),around:d.unproject(m)},{originalEvent:c})}}},Mo.prototype.enable=function(){this._enabled=!0},Mo.prototype.disable=function(){this._enabled=!1,this.reset()},Mo.prototype.isEnabled=function(){return this._enabled},Mo.prototype.isActive=function(){return this._active};var jn=function(){this._tap=new ca({numTouches:1,numTaps:1}),this.reset()};jn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},jn.prototype.touchstart=function(c,m,d){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?d.length>0&&(this._swipePoint=m[0],this._swipeTouch=d[0].identifier):this._tap.touchstart(c,m,d))},jn.prototype.touchmove=function(c,m,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;var x=m[0],k=x.y-this._swipePoint.y;return this._swipePoint=x,c.preventDefault(),this._active=!0,{zoomDelta:k/128}}}else this._tap.touchmove(c,m,d)},jn.prototype.touchend=function(c,m,d){this._tapTime?this._swipePoint&&d.length===0&&this.reset():this._tap.touchend(c,m,d)&&(this._tapTime=c.timeStamp)},jn.prototype.touchcancel=function(){this.reset()},jn.prototype.enable=function(){this._enabled=!0},jn.prototype.disable=function(){this._enabled=!1,this.reset()},jn.prototype.isEnabled=function(){return this._enabled},jn.prototype.isActive=function(){return this._active};var fn=function(c,m,d){this._el=c,this._mousePan=m,this._touchPan=d};fn.prototype.enable=function(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},fn.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},fn.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},fn.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ko=function(c,m,d){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=m,this._mousePitch=d};Ko.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ko.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ko.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ko.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var vn=function(c,m,d,x){this._el=c,this._touchZoom=m,this._touchRotate=d,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0};vn.prototype.enable=function(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},vn.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},vn.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},vn.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},vn.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},vn.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Lo=function(c){return c.zoom||c.drag||c.pitch||c.rotate},fs=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m}(f.Event);function Zt(c){return c.panDelta&&c.panDelta.mag()||c.zoomDelta||c.bearingDelta||c.pitchDelta}var Gt=function(c,m){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new el(c),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(m),f.bindAll(["handleEvent","handleWindowEvent"],this);var d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[f.window.document,"mousemove",{capture:!0}],[f.window.document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[f.window,"blur",void 0]];for(var x=0,k=this._listeners;x<k.length;x+=1){var L=k[x],B=L[0];D.addEventListener(B,L[1],B===f.window.document?this.handleWindowEvent:this.handleEvent,L[2])}};Gt.prototype.destroy=function(){for(var c=0,m=this._listeners;c<m.length;c+=1){var d=m[c],x=d[0];D.removeEventListener(x,d[1],x===f.window.document?this.handleWindowEvent:this.handleEvent,d[2])}},Gt.prototype._addDefaultHandlers=function(c){var m=this._map,d=m.getCanvasContainer();this._add("mapEvent",new zn(m,c));var x=m.boxZoom=new Io(m,c);this._add("boxZoom",x);var k=new ln,L=new Mo;m.doubleClickZoom=new Xo(L,k),this._add("tapZoom",k),this._add("clickZoom",L);var B=new jn;this._add("tapDragZoom",B);var q=m.touchPitch=new hc;this._add("touchPitch",q);var $=new ds(c),ie=new tu(c);m.dragRotate=new Ko(c,$,ie),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",ie,["mouseRotate"]);var he=new eu(c),de=new Uo(c);m.dragPan=new fn(d,he,de),this._add("mousePan",he),this._add("touchPan",de,["touchZoom","touchRotate"]);var me=new cc,Ce=new So;m.touchZoomRotate=new vn(d,Ce,me,B),this._add("touchRotate",me,["touchPan","touchZoom"]),this._add("touchZoom",Ce,["touchPan","touchRotate"]);var Te=m.scrollZoom=new Nt(m,this);this._add("scrollZoom",Te,["mousePan"]);var Le=m.keyboard=new Wo;this._add("keyboard",Le),this._add("blockableMapEvent",new oi(m));for(var xe=0,ze=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];xe<ze.length;xe+=1){var Fe=ze[xe];c.interactive&&c[Fe]&&m[Fe].enable(c[Fe])}},Gt.prototype._add=function(c,m,d){this._handlers.push({handlerName:c,handler:m,allowed:d}),this._handlersById[c]=m},Gt.prototype.stop=function(c){if(!this._updatingCamera){for(var m=0,d=this._handlers;m<d.length;m+=1)d[m].handler.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}},Gt.prototype.isActive=function(){for(var c=0,m=this._handlers;c<m.length;c+=1)if(m[c].handler.isActive())return!0;return!1},Gt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Gt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Gt.prototype.isMoving=function(){return Boolean(Lo(this._eventsInProgress))||this.isZooming()},Gt.prototype._blockedByActive=function(c,m,d){for(var x in c)if(x!==d&&(!m||m.indexOf(x)<0))return!0;return!1},Gt.prototype.handleWindowEvent=function(c){this.handleEvent(c,c.type+"Window")},Gt.prototype._getMapTouches=function(c){for(var m=[],d=0,x=c;d<x.length;d+=1){var k=x[d];this._el.contains(k.target)&&m.push(k)}return m},Gt.prototype.handleEvent=function(c,m){this._updatingCamera=!0;for(var d=c.type==="renderFrame"?void 0:c,x={needsRenderFrame:!1},k={},L={},B=c.touches?this._getMapTouches(c.touches):void 0,q=B?D.touchPos(this._el,B):D.mousePos(this._el,c),$=0,ie=this._handlers;$<ie.length;$+=1){var he=ie[$],de=he.handlerName,me=he.handler,Ce=he.allowed;if(me.isEnabled()){var Te=void 0;this._blockedByActive(L,Ce,de)?me.reset():me[m||c.type]&&(Te=me[m||c.type](c,q,B),this.mergeHandlerResult(x,k,Te,de,d),Te&&Te.needsRenderFrame&&this._triggerRenderFrame()),(Te||me.isActive())&&(L[de]=me)}}var Le={};for(var xe in this._previousActiveHandlers)L[xe]||(Le[xe]=d);this._previousActiveHandlers=L,(Object.keys(Le).length||Zt(x))&&(this._changes.push([x,k,Le]),this._triggerRenderFrame()),(Object.keys(L).length||Zt(x))&&this._map._stop(!0),this._updatingCamera=!1;var ze=x.cameraAnimation;ze&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ze(this._map))},Gt.prototype.mergeHandlerResult=function(c,m,d,x,k){if(d){f.extend(c,d);var L={handlerName:x,originalEvent:d.originalEvent||k};d.zoomDelta!==void 0&&(m.zoom=L),d.panDelta!==void 0&&(m.drag=L),d.pitchDelta!==void 0&&(m.pitch=L),d.bearingDelta!==void 0&&(m.rotate=L)}},Gt.prototype._applyChanges=function(){for(var c={},m={},d={},x=0,k=this._changes;x<k.length;x+=1){var L=k[x],B=L[0],q=L[1],$=L[2];B.panDelta&&(c.panDelta=(c.panDelta||new f.Point(0,0))._add(B.panDelta)),B.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+B.zoomDelta),B.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+B.bearingDelta),B.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+B.pitchDelta),B.around!==void 0&&(c.around=B.around),B.pinchAround!==void 0&&(c.pinchAround=B.pinchAround),B.noInertia&&(c.noInertia=B.noInertia),f.extend(m,q),f.extend(d,$)}this._updateMapTransform(c,m,d),this._changes=[]},Gt.prototype._updateMapTransform=function(c,m,d){var x=this._map,k=x.transform;if(!Zt(c))return this._fireEvents(m,d,!0);var L=c.panDelta,B=c.zoomDelta,q=c.bearingDelta,$=c.pitchDelta,ie=c.around,he=c.pinchAround;he!==void 0&&(ie=he),x._stop(!0),ie=ie||x.transform.centerPoint;var de=k.pointLocation(L?ie.sub(L):ie);q&&(k.bearing+=q),$&&(k.pitch+=$),B&&(k.zoom+=B),k.setLocationAtPoint(de,ie),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(m,d,!0)},Gt.prototype._fireEvents=function(c,m,d){var x=this,k=Lo(this._eventsInProgress),L=Lo(c),B={};for(var q in c)this._eventsInProgress[q]||(B[q+"start"]=c[q].originalEvent),this._eventsInProgress[q]=c[q];for(var $ in!k&&L&&this._fireEvent("movestart",L.originalEvent),B)this._fireEvent($,B[$]);for(var ie in L&&this._fireEvent("move",L.originalEvent),c)this._fireEvent(ie,c[ie].originalEvent);var he,de={};for(var me in this._eventsInProgress){var Ce=this._eventsInProgress[me],Te=Ce.handlerName,Le=Ce.originalEvent;this._handlersById[Te].isActive()||(delete this._eventsInProgress[me],de[me+"end"]=he=m[Te]||Le)}for(var xe in de)this._fireEvent(xe,de[xe]);var ze=Lo(this._eventsInProgress);if(d&&(k||L)&&!ze){this._updatingCamera=!0;var Fe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$e=function(ot){return ot!==0&&-x._bearingSnap<ot&&ot<x._bearingSnap};Fe?($e(Fe.bearing||this._map.getBearing())&&(Fe.bearing=0),this._map.easeTo(Fe,{originalEvent:he})):(this._map.fire(new f.Event("moveend",{originalEvent:he})),$e(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Gt.prototype._fireEvent=function(c,m){this._map.fire(new f.Event(c,m?{originalEvent:m}:{}))},Gt.prototype._requestFrame=function(){var c=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(m){delete c._frameId,c.handleEvent(new fs("renderFrame",{timeStamp:m})),c._applyChanges()})},Gt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var iu=function(c){function m(d,x){c.call(this),this._moving=!1,this._zooming=!1,this.transform=d,this._bearingSnap=x.bearingSnap,f.bindAll(["_renderFrameCallback"],this)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getCenter=function(){return new f.LngLat(this.transform.center.lng,this.transform.center.lat)},m.prototype.setCenter=function(d,x){return this.jumpTo({center:d},x)},m.prototype.panBy=function(d,x,k){return d=f.Point.convert(d).mult(-1),this.panTo(this.transform.center,f.extend({offset:d},x),k)},m.prototype.panTo=function(d,x,k){return this.easeTo(f.extend({center:d},x),k)},m.prototype.getZoom=function(){return this.transform.zoom},m.prototype.setZoom=function(d,x){return this.jumpTo({zoom:d},x),this},m.prototype.zoomTo=function(d,x,k){return this.easeTo(f.extend({zoom:d},x),k)},m.prototype.zoomIn=function(d,x){return this.zoomTo(this.getZoom()+1,d,x),this},m.prototype.zoomOut=function(d,x){return this.zoomTo(this.getZoom()-1,d,x),this},m.prototype.getBearing=function(){return this.transform.bearing},m.prototype.setBearing=function(d,x){return this.jumpTo({bearing:d},x),this},m.prototype.getPadding=function(){return this.transform.padding},m.prototype.setPadding=function(d,x){return this.jumpTo({padding:d},x),this},m.prototype.rotateTo=function(d,x,k){return this.easeTo(f.extend({bearing:d},x),k)},m.prototype.resetNorth=function(d,x){return this.rotateTo(0,f.extend({duration:1e3},d),x),this},m.prototype.resetNorthPitch=function(d,x){return this.easeTo(f.extend({bearing:0,pitch:0,duration:1e3},d),x),this},m.prototype.snapToNorth=function(d,x){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(d,x):this},m.prototype.getPitch=function(){return this.transform.pitch},m.prototype.setPitch=function(d,x){return this.jumpTo({pitch:d},x),this},m.prototype.cameraForBounds=function(d,x){d=f.LngLatBounds.convert(d);var k=x&&x.bearing||0;return this._cameraForBoxAndBearing(d.getNorthWest(),d.getSouthEast(),k,x)},m.prototype._cameraForBoxAndBearing=function(d,x,k,L){var B={top:0,bottom:0,right:0,left:0};if(typeof(L=f.extend({padding:B,offset:[0,0],maxZoom:this.transform.maxZoom},L)).padding=="number"){var q=L.padding;L.padding={top:q,bottom:q,right:q,left:q}}L.padding=f.extend(B,L.padding);var $=this.transform,ie=$.padding,he=$.project(f.LngLat.convert(d)),de=$.project(f.LngLat.convert(x)),me=he.rotate(-k*Math.PI/180),Ce=de.rotate(-k*Math.PI/180),Te=new f.Point(Math.max(me.x,Ce.x),Math.max(me.y,Ce.y)),Le=new f.Point(Math.min(me.x,Ce.x),Math.min(me.y,Ce.y)),xe=Te.sub(Le),ze=($.width-(ie.left+ie.right+L.padding.left+L.padding.right))/xe.x,Fe=($.height-(ie.top+ie.bottom+L.padding.top+L.padding.bottom))/xe.y;if(!(Fe<0||ze<0)){var $e=Math.min($.scaleZoom($.scale*Math.min(ze,Fe)),L.maxZoom),ot=typeof L.offset.x=="number"?new f.Point(L.offset.x,L.offset.y):f.Point.convert(L.offset),at=new f.Point((L.padding.left-L.padding.right)/2,(L.padding.top-L.padding.bottom)/2).rotate(k*Math.PI/180),st=ot.add(at).mult($.scale/$.zoomScale($e));return{center:$.unproject(he.add(de).div(2).sub(st)),zoom:$e,bearing:k}}f.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},m.prototype.fitBounds=function(d,x,k){return this._fitInternal(this.cameraForBounds(d,x),x,k)},m.prototype.fitScreenCoordinates=function(d,x,k,L,B){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(f.Point.convert(d)),this.transform.pointLocation(f.Point.convert(x)),k,L),L,B)},m.prototype._fitInternal=function(d,x,k){return d?(delete(x=f.extend(d,x)).padding,x.linear?this.easeTo(x,k):this.flyTo(x,k)):this},m.prototype.jumpTo=function(d,x){this.stop();var k=this.transform,L=!1,B=!1,q=!1;return"zoom"in d&&k.zoom!==+d.zoom&&(L=!0,k.zoom=+d.zoom),d.center!==void 0&&(k.center=f.LngLat.convert(d.center)),"bearing"in d&&k.bearing!==+d.bearing&&(B=!0,k.bearing=+d.bearing),"pitch"in d&&k.pitch!==+d.pitch&&(q=!0,k.pitch=+d.pitch),d.padding==null||k.isPaddingEqual(d.padding)||(k.padding=d.padding),this.fire(new f.Event("movestart",x)).fire(new f.Event("move",x)),L&&this.fire(new f.Event("zoomstart",x)).fire(new f.Event("zoom",x)).fire(new f.Event("zoomend",x)),B&&this.fire(new f.Event("rotatestart",x)).fire(new f.Event("rotate",x)).fire(new f.Event("rotateend",x)),q&&this.fire(new f.Event("pitchstart",x)).fire(new f.Event("pitch",x)).fire(new f.Event("pitchend",x)),this.fire(new f.Event("moveend",x))},m.prototype.easeTo=function(d,x){var k=this;this._stop(!1,d.easeId),((d=f.extend({offset:[0,0],duration:500,easing:f.ease},d)).animate===!1||!d.essential&&f.browser.prefersReducedMotion)&&(d.duration=0);var L=this.transform,B=this.getZoom(),q=this.getBearing(),$=this.getPitch(),ie=this.getPadding(),he="zoom"in d?+d.zoom:B,de="bearing"in d?this._normalizeBearing(d.bearing,q):q,me="pitch"in d?+d.pitch:$,Ce="padding"in d?d.padding:L.padding,Te=f.Point.convert(d.offset),Le=L.centerPoint.add(Te),xe=L.pointLocation(Le),ze=f.LngLat.convert(d.center||xe);this._normalizeCenter(ze);var Fe,$e,ot=L.project(xe),at=L.project(ze).sub(ot),st=L.zoomScale(he-B);d.around&&(Fe=f.LngLat.convert(d.around),$e=L.locationPoint(Fe));var It={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||he!==B,this._rotating=this._rotating||q!==de,this._pitching=this._pitching||me!==$,this._padding=!L.isPaddingEqual(Ce),this._easeId=d.easeId,this._prepareEase(x,d.noMoveStart,It),this._ease(function(Dt){if(k._zooming&&(L.zoom=f.number(B,he,Dt)),k._rotating&&(L.bearing=f.number(q,de,Dt)),k._pitching&&(L.pitch=f.number($,me,Dt)),k._padding&&(L.interpolatePadding(ie,Ce,Dt),Le=L.centerPoint.add(Te)),Fe)L.setLocationAtPoint(Fe,$e);else{var Lt=L.zoomScale(L.zoom-B),$t=he>B?Math.min(2,st):Math.max(.5,st),mi=Math.pow($t,1-Dt),bi=L.unproject(ot.add(at.mult(Dt*mi)).mult(Lt));L.setLocationAtPoint(L.renderWorldCopies?bi.wrap():bi,Le)}k._fireMoveEvents(x)},function(Dt){k._afterEase(x,Dt)},d),this},m.prototype._prepareEase=function(d,x,k){k===void 0&&(k={}),this._moving=!0,x||k.moving||this.fire(new f.Event("movestart",d)),this._zooming&&!k.zooming&&this.fire(new f.Event("zoomstart",d)),this._rotating&&!k.rotating&&this.fire(new f.Event("rotatestart",d)),this._pitching&&!k.pitching&&this.fire(new f.Event("pitchstart",d))},m.prototype._fireMoveEvents=function(d){this.fire(new f.Event("move",d)),this._zooming&&this.fire(new f.Event("zoom",d)),this._rotating&&this.fire(new f.Event("rotate",d)),this._pitching&&this.fire(new f.Event("pitch",d))},m.prototype._afterEase=function(d,x){if(!this._easeId||!x||this._easeId!==x){delete this._easeId;var k=this._zooming,L=this._rotating,B=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,k&&this.fire(new f.Event("zoomend",d)),L&&this.fire(new f.Event("rotateend",d)),B&&this.fire(new f.Event("pitchend",d)),this.fire(new f.Event("moveend",d))}},m.prototype.flyTo=function(d,x){var k=this;if(!d.essential&&f.browser.prefersReducedMotion){var L=f.pick(d,["center","zoom","bearing","pitch","around"]);return this.jumpTo(L,x)}this.stop(),d=f.extend({offset:[0,0],speed:1.2,curve:1.42,easing:f.ease},d);var B=this.transform,q=this.getZoom(),$=this.getBearing(),ie=this.getPitch(),he=this.getPadding(),de="zoom"in d?f.clamp(+d.zoom,B.minZoom,B.maxZoom):q,me="bearing"in d?this._normalizeBearing(d.bearing,$):$,Ce="pitch"in d?+d.pitch:ie,Te="padding"in d?d.padding:B.padding,Le=B.zoomScale(de-q),xe=f.Point.convert(d.offset),ze=B.centerPoint.add(xe),Fe=B.pointLocation(ze),$e=f.LngLat.convert(d.center||Fe);this._normalizeCenter($e);var ot=B.project(Fe),at=B.project($e).sub(ot),st=d.curve,It=Math.max(B.width,B.height),Dt=It/Le,Lt=at.mag();if("minZoom"in d){var $t=f.clamp(Math.min(d.minZoom,q,de),B.minZoom,B.maxZoom),mi=It/B.zoomScale($t-q);st=Math.sqrt(mi/Lt*2)}var bi=st*st;function di(Ti){var vi=(Dt*Dt-It*It+(Ti?-1:1)*bi*bi*Lt*Lt)/(2*(Ti?Dt:It)*bi*Lt);return Math.log(Math.sqrt(vi*vi+1)-vi)}function ar(Ti){return(Math.exp(Ti)-Math.exp(-Ti))/2}function ni(Ti){return(Math.exp(Ti)+Math.exp(-Ti))/2}var Bi=di(0),er=function(Ti){return ni(Bi)/ni(Bi+st*Ti)},Li=function(Ti){return It*((ni(Bi)*(ar(vi=Bi+st*Ti)/ni(vi))-ar(Bi))/bi)/Lt;var vi},Pi=(di(1)-Bi)/st;if(Math.abs(Lt)<1e-6||!isFinite(Pi)){if(Math.abs(It-Dt)<1e-6)return this.easeTo(d,x);var ji=Dt<It?-1:1;Pi=Math.abs(Math.log(Dt/It))/st,Li=function(){return 0},er=function(Ti){return Math.exp(ji*st*Ti)}}return d.duration="duration"in d?+d.duration:1e3*Pi/("screenSpeed"in d?+d.screenSpeed/st:+d.speed),d.maxDuration&&d.duration>d.maxDuration&&(d.duration=0),this._zooming=!0,this._rotating=$!==me,this._pitching=Ce!==ie,this._padding=!B.isPaddingEqual(Te),this._prepareEase(x,!1),this._ease(function(Ti){var vi=Ti*Pi,mn=1/er(vi);B.zoom=Ti===1?de:q+B.scaleZoom(mn),k._rotating&&(B.bearing=f.number($,me,Ti)),k._pitching&&(B.pitch=f.number(ie,Ce,Ti)),k._padding&&(B.interpolatePadding(he,Te,Ti),ze=B.centerPoint.add(xe));var Cn=Ti===1?$e:B.unproject(ot.add(at.mult(Li(vi))).mult(mn));B.setLocationAtPoint(B.renderWorldCopies?Cn.wrap():Cn,ze),k._fireMoveEvents(x)},function(){return k._afterEase(x)},d),this},m.prototype.isEasing=function(){return!!this._easeFrameId},m.prototype.stop=function(){return this._stop()},m.prototype._stop=function(d,x){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var k=this._onEaseEnd;delete this._onEaseEnd,k.call(this,x)}if(!d){var L=this.handlers;L&&L.stop(!1)}return this},m.prototype._ease=function(d,x,k){k.animate===!1||k.duration===0?(d(1),x()):(this._easeStart=f.browser.now(),this._easeOptions=k,this._onEaseFrame=d,this._onEaseEnd=x,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},m.prototype._renderFrameCallback=function(){var d=Math.min((f.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},m.prototype._normalizeBearing=function(d,x){d=f.wrap(d,-180,180);var k=Math.abs(d-x);return Math.abs(d-360-x)<k&&(d-=360),Math.abs(d+360-x)<k&&(d+=360),d},m.prototype._normalizeCenter=function(d){var x=this.transform;if(x.renderWorldCopies&&!x.lngRange){var k=d.lng-x.center.lng;d.lng+=k>180?-360:k<-180?360:0}},m}(f.Evented),Bn=function(c){c===void 0&&(c={}),this.options=c,f.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Bn.prototype.getDefaultPosition=function(){return"bottom-right"},Bn.prototype.onAdd=function(c){var m=this.options&&this.options.compact;return this._map=c,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),m===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Bn.prototype.onRemove=function(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Bn.prototype._setElementTitle=function(c,m){var d=this._map._getUIString("AttributionControl."+m);c.title=d,c.setAttribute("aria-label",d)},Bn.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Bn.prototype._updateEditLink=function(){var c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));var m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||f.config.ACCESS_TOKEN}];if(c){var d=m.reduce(function(x,k,L){return k.value&&(x+=k.key+"="+k.value+(L<m.length-1?"&":"")),x},"?");c.href=f.config.FEEDBACK_URL+"/"+d+(this._map._hash?this._map._hash.getHashString(!0):""),c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}},Bn.prototype._updateData=function(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Bn.prototype._updateAttributions=function(){if(this._map.style){var c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(function(q){return typeof q!="string"?"":q})):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){var m=this._map.style.stylesheet;this.styleOwner=m.owner,this.styleId=m.id}var d=this._map.style.sourceCaches;for(var x in d){var k=d[x];if(k.used){var L=k.getSource();L.attribution&&c.indexOf(L.attribution)<0&&c.push(L.attribution)}}c.sort(function(q,$){return q.length-$.length});var B=(c=c.filter(function(q,$){for(var ie=$+1;ie<c.length;ie++)if(c[ie].indexOf(q)>=0)return!1;return!0})).join(" | ");B!==this._attribHTML&&(this._attribHTML=B,c.length?(this._innerContainer.innerHTML=B,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Bn.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var No=function(){f.bindAll(["_updateLogo"],this),f.bindAll(["_updateCompact"],this)};No.prototype.onAdd=function(c){this._map=c,this._container=D.create("div","mapboxgl-ctrl");var m=D.create("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},No.prototype.onRemove=function(){D.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},No.prototype.getDefaultPosition=function(){return"bottom-left"},No.prototype._updateLogo=function(c){c&&c.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},No.prototype._logoRequired=function(){if(this._map.style){var c=this._map.style.sourceCaches;for(var m in c)if(c[m].getSource().mapbox_logo)return!0;return!1}},No.prototype._updateCompact=function(){var c=this._container.children;if(c.length){var m=c[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}};var T=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};T.prototype.add=function(c){var m=++this._id;return this._queue.push({callback:c,id:m,cancelled:!1}),m},T.prototype.remove=function(c){for(var m=this._currentlyRunning,d=0,x=m?this._queue.concat(m):this._queue;d<x.length;d+=1){var k=x[d];if(k.id===c)return void(k.cancelled=!0)}},T.prototype.run=function(c){c===void 0&&(c=0);var m=this._currentlyRunning=this._queue;this._queue=[];for(var d=0,x=m;d<x.length;d+=1){var k=x[d];if(!k.cancelled&&(k.callback(c),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},T.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var o={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},y=f.window.HTMLImageElement,S=f.window.HTMLElement,A=f.window.ImageBitmap,M={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},U=function(c){function m(x){var k=this;if((x=f.extend({},M,x)).minZoom!=null&&x.maxZoom!=null&&x.minZoom>x.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(x.minPitch!=null&&x.maxPitch!=null&&x.minPitch>x.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(x.minPitch!=null&&x.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(x.maxPitch!=null&&x.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var L=new Qi(x.minZoom,x.maxZoom,x.minPitch,x.maxPitch,x.renderWorldCopies);if(c.call(this,L,x),this._interactive=x.interactive,this._maxTileCacheSize=x.maxTileCacheSize,this._failIfMajorPerformanceCaveat=x.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=x.preserveDrawingBuffer,this._antialias=x.antialias,this._trackResize=x.trackResize,this._bearingSnap=x.bearingSnap,this._refreshExpiredTiles=x.refreshExpiredTiles,this._fadeDuration=x.fadeDuration,this._crossSourceCollisions=x.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=x.collectResourceTiming,this._renderTaskQueue=new T,this._controls=[],this._mapId=f.uniqueId(),this._locale=f.extend({},o,x.locale),this._clickTolerance=x.clickTolerance,this._requestManager=new f.RequestManager(x.transformRequest,x.accessToken),typeof x.container=="string"){if(this._container=f.window.document.getElementById(x.container),!this._container)throw new Error("Container '"+x.container+"' not found.")}else{if(!(x.container instanceof S))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=x.container}if(x.maxBounds&&this.setMaxBounds(x.maxBounds),f.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return k._update(!1)}),this.on("moveend",function(){return k._update(!1)}),this.on("zoom",function(){return k._update(!0)}),f.window!==void 0&&(f.window.addEventListener("online",this._onWindowOnline,!1),f.window.addEventListener("resize",this._onWindowResize,!1),f.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Gt(this,x),this._hash=x.hash&&new Jt(typeof x.hash=="string"&&x.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch}),x.bounds&&(this.resize(),this.fitBounds(x.bounds,f.extend({},x.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=x.localIdeographFontFamily,x.style&&this.setStyle(x.style,{localIdeographFontFamily:x.localIdeographFontFamily}),x.attributionControl&&this.addControl(new Bn({customAttribution:x.customAttribution})),this.addControl(new No,x.logoPosition),this.on("style.load",function(){k.transform.unmodified&&k.jumpTo(k.style.stylesheet)}),this.on("data",function(B){k._update(B.dataType==="style"),k.fire(new f.Event(B.dataType+"data",B))}),this.on("dataloading",function(B){k.fire(new f.Event(B.dataType+"dataloading",B))})}c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m;var d={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return m.prototype._getMapId=function(){return this._mapId},m.prototype.addControl=function(x,k){if(k===void 0&&(k=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new f.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var L=x.onAdd(this);this._controls.push(x);var B=this._controlPositions[k];return k.indexOf("bottom")!==-1?B.insertBefore(L,B.firstChild):B.appendChild(L),this},m.prototype.removeControl=function(x){if(!x||!x.onRemove)return this.fire(new f.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var k=this._controls.indexOf(x);return k>-1&&this._controls.splice(k,1),x.onRemove(this),this},m.prototype.hasControl=function(x){return this._controls.indexOf(x)>-1},m.prototype.resize=function(x){var k=this._containerDimensions(),L=k[0],B=k[1];if(L===this.transform.width&&B===this.transform.height)return this;this._resizeCanvas(L,B),this.transform.resize(L,B),this.painter.resize(L,B);var q=!this._moving;return q&&this.fire(new f.Event("movestart",x)).fire(new f.Event("move",x)),this.fire(new f.Event("resize",x)),q&&this.fire(new f.Event("moveend",x)),this},m.prototype.getBounds=function(){return this.transform.getBounds()},m.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},m.prototype.setMaxBounds=function(x){return this.transform.setMaxBounds(f.LngLatBounds.convert(x)),this._update()},m.prototype.setMinZoom=function(x){if((x=x==null?-2:x)>=-2&&x<=this.transform.maxZoom)return this.transform.minZoom=x,this._update(),this.getZoom()<x&&this.setZoom(x),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},m.prototype.getMinZoom=function(){return this.transform.minZoom},m.prototype.setMaxZoom=function(x){if((x=x==null?22:x)>=this.transform.minZoom)return this.transform.maxZoom=x,this._update(),this.getZoom()>x&&this.setZoom(x),this;throw new Error("maxZoom must be greater than the current minZoom")},m.prototype.getMaxZoom=function(){return this.transform.maxZoom},m.prototype.setMinPitch=function(x){if((x=x==null?0:x)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.minPitch=x,this._update(),this.getPitch()<x&&this.setPitch(x),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},m.prototype.getMinPitch=function(){return this.transform.minPitch},m.prototype.setMaxPitch=function(x){if((x=x==null?60:x)>60)throw new Error("maxPitch must be less than or equal to 60");if(x>=this.transform.minPitch)return this.transform.maxPitch=x,this._update(),this.getPitch()>x&&this.setPitch(x),this;throw new Error("maxPitch must be greater than the current minPitch")},m.prototype.getMaxPitch=function(){return this.transform.maxPitch},m.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},m.prototype.setRenderWorldCopies=function(x){return this.transform.renderWorldCopies=x,this._update()},m.prototype.project=function(x){return this.transform.locationPoint(f.LngLat.convert(x))},m.prototype.unproject=function(x){return this.transform.pointLocation(f.Point.convert(x))},m.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},m.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},m.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},m.prototype._createDelegatedListener=function(x,k,L){var B,q=this;if(x==="mouseenter"||x==="mouseover"){var $=!1;return{layer:k,listener:L,delegates:{mousemove:function(he){var de=q.getLayer(k)?q.queryRenderedFeatures(he.point,{layers:[k]}):[];de.length?$||($=!0,L.call(q,new pn(x,q,he.originalEvent,{features:de}))):$=!1},mouseout:function(){$=!1}}}}if(x==="mouseleave"||x==="mouseout"){var ie=!1;return{layer:k,listener:L,delegates:{mousemove:function(he){(q.getLayer(k)?q.queryRenderedFeatures(he.point,{layers:[k]}):[]).length?ie=!0:ie&&(ie=!1,L.call(q,new pn(x,q,he.originalEvent)))},mouseout:function(he){ie&&(ie=!1,L.call(q,new pn(x,q,he.originalEvent)))}}}}return{layer:k,listener:L,delegates:(B={},B[x]=function(he){var de=q.getLayer(k)?q.queryRenderedFeatures(he.point,{layers:[k]}):[];de.length&&(he.features=de,L.call(q,he),delete he.features)},B)}},m.prototype.on=function(x,k,L){if(L===void 0)return c.prototype.on.call(this,x,k);var B=this._createDelegatedListener(x,k,L);for(var q in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(B),B.delegates)this.on(q,B.delegates[q]);return this},m.prototype.once=function(x,k,L){if(L===void 0)return c.prototype.once.call(this,x,k);var B=this._createDelegatedListener(x,k,L);for(var q in B.delegates)this.once(q,B.delegates[q]);return this},m.prototype.off=function(x,k,L){var B=this;return L===void 0?c.prototype.off.call(this,x,k):(this._delegatedListeners&&this._delegatedListeners[x]&&function(q){for(var $=q[x],ie=0;ie<$.length;ie++){var he=$[ie];if(he.layer===k&&he.listener===L){for(var de in he.delegates)B.off(de,he.delegates[de]);return $.splice(ie,1),B}}}(this._delegatedListeners),this)},m.prototype.queryRenderedFeatures=function(x,k){if(!this.style)return[];var L;if(k!==void 0||x===void 0||x instanceof f.Point||Array.isArray(x)||(k=x,x=void 0),k=k||{},(x=x||[[0,0],[this.transform.width,this.transform.height]])instanceof f.Point||typeof x[0]=="number")L=[f.Point.convert(x)];else{var B=f.Point.convert(x[0]),q=f.Point.convert(x[1]);L=[B,new f.Point(q.x,B.y),q,new f.Point(B.x,q.y),B]}return this.style.queryRenderedFeatures(L,k,this.transform)},m.prototype.querySourceFeatures=function(x,k){return this.style.querySourceFeatures(x,k)},m.prototype.setStyle=function(x,k){return(k=f.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},k)).diff!==!1&&k.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&x?(this._diffStyle(x,k),this):(this._localIdeographFontFamily=k.localIdeographFontFamily,this._updateStyle(x,k))},m.prototype._getUIString=function(x){var k=this._locale[x];if(k==null)throw new Error("Missing UI string '"+x+"'");return k},m.prototype._updateStyle=function(x,k){return this.style&&(this.style.setEventedParent(null),this.style._remove()),x?(this.style=new po(this,k||{}),this.style.setEventedParent(this,{style:this.style}),typeof x=="string"?this.style.loadURL(x):this.style.loadJSON(x),this):(delete this.style,this)},m.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new po(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},m.prototype._diffStyle=function(x,k){var L=this;if(typeof x=="string"){var B=this._requestManager.normalizeStyleURL(x),q=this._requestManager.transformRequest(B,f.ResourceType.Style);f.getJSON(q,function($,ie){$?L.fire(new f.ErrorEvent($)):ie&&L._updateDiff(ie,k)})}else typeof x=="object"&&this._updateDiff(x,k)},m.prototype._updateDiff=function(x,k){try{this.style.setState(x)&&this._update(!0)}catch(L){f.warnOnce("Unable to perform style diff: "+(L.message||L.error||L)+".  Rebuilding the style from scratch."),this._updateStyle(x,k)}},m.prototype.getStyle=function(){if(this.style)return this.style.serialize()},m.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():f.warnOnce("There is no style added to the map.")},m.prototype.addSource=function(x,k){return this._lazyInitEmptyStyle(),this.style.addSource(x,k),this._update(!0)},m.prototype.isSourceLoaded=function(x){var k=this.style&&this.style.sourceCaches[x];if(k!==void 0)return k.loaded();this.fire(new f.ErrorEvent(new Error("There is no source with ID '"+x+"'")))},m.prototype.areTilesLoaded=function(){var x=this.style&&this.style.sourceCaches;for(var k in x){var L=x[k]._tiles;for(var B in L){var q=L[B];if(q.state!=="loaded"&&q.state!=="errored")return!1}}return!0},m.prototype.addSourceType=function(x,k,L){return this._lazyInitEmptyStyle(),this.style.addSourceType(x,k,L)},m.prototype.removeSource=function(x){return this.style.removeSource(x),this._update(!0)},m.prototype.getSource=function(x){return this.style.getSource(x)},m.prototype.addImage=function(x,k,L){L===void 0&&(L={});var B=L.pixelRatio;B===void 0&&(B=1);var q=L.sdf;q===void 0&&(q=!1);var $=L.stretchX,ie=L.stretchY,he=L.content;if(this._lazyInitEmptyStyle(),k instanceof y||A&&k instanceof A){var de=f.browser.getImageData(k);this.style.addImage(x,{data:new f.RGBAImage({width:de.width,height:de.height},de.data),pixelRatio:B,stretchX:$,stretchY:ie,content:he,sdf:q,version:0})}else{if(k.width===void 0||k.height===void 0)return this.fire(new f.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var me=k;this.style.addImage(x,{data:new f.RGBAImage({width:k.width,height:k.height},new Uint8Array(k.data)),pixelRatio:B,stretchX:$,stretchY:ie,content:he,sdf:q,version:0,userImage:me}),me.onAdd&&me.onAdd(this,x)}},m.prototype.updateImage=function(x,k){var L=this.style.getImage(x);if(!L)return this.fire(new f.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var B=k instanceof y||A&&k instanceof A?f.browser.getImageData(k):k,q=B.width,$=B.height,ie=B.data;return q===void 0||$===void 0?this.fire(new f.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):q!==L.data.width||$!==L.data.height?this.fire(new f.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(L.data.replace(ie,!(k instanceof y||A&&k instanceof A)),void this.style.updateImage(x,L))},m.prototype.hasImage=function(x){return x?!!this.style.getImage(x):(this.fire(new f.ErrorEvent(new Error("Missing required image id"))),!1)},m.prototype.removeImage=function(x){this.style.removeImage(x)},m.prototype.loadImage=function(x,k){f.getImage(this._requestManager.transformRequest(x,f.ResourceType.Image),k)},m.prototype.listImages=function(){return this.style.listImages()},m.prototype.addLayer=function(x,k){return this._lazyInitEmptyStyle(),this.style.addLayer(x,k),this._update(!0)},m.prototype.moveLayer=function(x,k){return this.style.moveLayer(x,k),this._update(!0)},m.prototype.removeLayer=function(x){return this.style.removeLayer(x),this._update(!0)},m.prototype.getLayer=function(x){return this.style.getLayer(x)},m.prototype.setLayerZoomRange=function(x,k,L){return this.style.setLayerZoomRange(x,k,L),this._update(!0)},m.prototype.setFilter=function(x,k,L){return L===void 0&&(L={}),this.style.setFilter(x,k,L),this._update(!0)},m.prototype.getFilter=function(x){return this.style.getFilter(x)},m.prototype.setPaintProperty=function(x,k,L,B){return B===void 0&&(B={}),this.style.setPaintProperty(x,k,L,B),this._update(!0)},m.prototype.getPaintProperty=function(x,k){return this.style.getPaintProperty(x,k)},m.prototype.setLayoutProperty=function(x,k,L,B){return B===void 0&&(B={}),this.style.setLayoutProperty(x,k,L,B),this._update(!0)},m.prototype.getLayoutProperty=function(x,k){return this.style.getLayoutProperty(x,k)},m.prototype.setLight=function(x,k){return k===void 0&&(k={}),this._lazyInitEmptyStyle(),this.style.setLight(x,k),this._update(!0)},m.prototype.getLight=function(){return this.style.getLight()},m.prototype.setFeatureState=function(x,k){return this.style.setFeatureState(x,k),this._update()},m.prototype.removeFeatureState=function(x,k){return this.style.removeFeatureState(x,k),this._update()},m.prototype.getFeatureState=function(x){return this.style.getFeatureState(x)},m.prototype.getContainer=function(){return this._container},m.prototype.getCanvasContainer=function(){return this._canvasContainer},m.prototype.getCanvas=function(){return this._canvas},m.prototype._containerDimensions=function(){var x=0,k=0;return this._container&&(x=this._container.clientWidth||400,k=this._container.clientHeight||300),[x,k]},m.prototype._detectMissingCSS=function(){f.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&f.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},m.prototype._setupContainer=function(){var x=this._container;x.classList.add("mapboxgl-map"),(this._missingCSSCanary=D.create("div","mapboxgl-canary",x)).style.visibility="hidden",this._detectMissingCSS();var k=this._canvasContainer=D.create("div","mapboxgl-canvas-container",x);this._interactive&&k.classList.add("mapboxgl-interactive"),this._canvas=D.create("canvas","mapboxgl-canvas",k),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var L=this._containerDimensions();this._resizeCanvas(L[0],L[1]);var B=this._controlContainer=D.create("div","mapboxgl-control-container",x),q=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function($){q[$]=D.create("div","mapboxgl-ctrl-"+$,B)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},m.prototype._resizeCanvas=function(x,k){var L=f.browser.devicePixelRatio||1;this._canvas.width=L*x,this._canvas.height=L*k,this._canvas.style.width=x+"px",this._canvas.style.height=k+"px"},m.prototype._setupPainter=function(){var x=f.extend({},h.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),k=this._canvas.getContext("webgl",x)||this._canvas.getContext("experimental-webgl",x);k?(this.painter=new sn(k,this.transform),f.webpSupported.testSupport(k)):this.fire(new f.ErrorEvent(new Error("Failed to initialize WebGL")))},m.prototype._contextLost=function(x){x.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new f.Event("webglcontextlost",{originalEvent:x}))},m.prototype._contextRestored=function(x){this._setupPainter(),this.resize(),this._update(),this.fire(new f.Event("webglcontextrestored",{originalEvent:x}))},m.prototype._onMapScroll=function(x){if(x.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},m.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},m.prototype._update=function(x){return this.style?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this},m.prototype._requestRenderFrame=function(x){return this._update(),this._renderTaskQueue.add(x)},m.prototype._cancelRenderFrame=function(x){this._renderTaskQueue.remove(x)},m.prototype._render=function(x){var k,L=this,B=0,q=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(k=q.createQueryEXT(),q.beginQueryEXT(q.TIME_ELAPSED_EXT,k),B=f.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(x),!this._removed){var $=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var ie=this.transform.zoom,he=f.browser.now();this.style.zoomHistory.update(ie,he);var de=new f.EvaluationParameters(ie,{now:he,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),me=de.crossFadingFactor();me===1&&me===this._crossFadingFactor||($=!0,this._crossFadingFactor=me),this.style.update(de)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new f.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new f.Event("load"))),this.style&&(this.style.hasTransitions()||$)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ce=f.browser.now()-B;q.endQueryEXT(q.TIME_ELAPSED_EXT,k),setTimeout(function(){var xe=q.getQueryObjectEXT(k,q.QUERY_RESULT_EXT)/1e6;q.deleteQueryEXT(k),L.fire(new f.Event("gpu-timing-frame",{cpuTime:Ce,gpuTime:xe}))},50)}if(this.listens("gpu-timing-layer")){var Te=this.painter.collectGpuTimers();setTimeout(function(){var xe=L.painter.queryGpuTimers(Te);L.fire(new f.Event("gpu-timing-layer",{layerTimes:xe}))},50)}var Le=this._sourcesDirty||this._styleDirty||this._placementDirty;return Le||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new f.Event("idle")),!this._loaded||this._fullyLoaded||Le||(this._fullyLoaded=!0),this}},m.prototype.remove=function(){this._hash&&this._hash.remove();for(var x=0,k=this._controls;x<k.length;x+=1)k[x].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),f.window!==void 0&&(f.window.removeEventListener("resize",this._onWindowResize,!1),f.window.removeEventListener("orientationchange",this._onWindowResize,!1),f.window.removeEventListener("online",this._onWindowOnline,!1));var L=this.painter.context.gl.getExtension("WEBGL_lose_context");L&&L.loseContext(),Z(this._canvasContainer),Z(this._controlContainer),Z(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new f.Event("remove"))},m.prototype.triggerRepaint=function(){var x=this;this.style&&!this._frame&&(this._frame=f.browser.frame(function(k){x._frame=null,x._render(k)}))},m.prototype._onWindowOnline=function(){this._update()},m.prototype._onWindowResize=function(x){this._trackResize&&this.resize({originalEvent:x})._update()},d.showTileBoundaries.get=function(){return!!this._showTileBoundaries},d.showTileBoundaries.set=function(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._update())},d.showPadding.get=function(){return!!this._showPadding},d.showPadding.set=function(x){this._showPadding!==x&&(this._showPadding=x,this._update())},d.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},d.showCollisionBoxes.set=function(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,x?this.style._generateCollisionBoxes():this._update())},d.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},d.showOverdrawInspector.set=function(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._update())},d.repaint.get=function(){return!!this._repaint},d.repaint.set=function(x){this._repaint!==x&&(this._repaint=x,this.triggerRepaint())},d.vertices.get=function(){return!!this._vertices},d.vertices.set=function(x){this._vertices=x,this._update()},m.prototype._setCacheLimits=function(x,k){f.setCacheLimits(x,k)},d.version.get=function(){return f.version},Object.defineProperties(m.prototype,d),m}(iu);function Z(c){c.parentNode&&c.parentNode.removeChild(c)}var J={showCompass:!0,showZoom:!0,visualizePitch:!1},ee=function(c){var m=this;this.options=f.extend({},J,c),this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(d){return d.preventDefault()}),this.options.showZoom&&(f.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(d){return m._map.zoomIn({},{originalEvent:d})}),D.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(d){return m._map.zoomOut({},{originalEvent:d})}),D.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(f.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(d){m.options.visualizePitch?m._map.resetNorthPitch({},{originalEvent:d}):m._map.resetNorth({},{originalEvent:d})}),this._compassIcon=D.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ee.prototype._updateZoomButtons=function(){var c=this._map.getZoom(),m=c===this._map.getMaxZoom(),d=c===this._map.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},ee.prototype._rotateCompassArrow=function(){var c=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=c},ee.prototype.onAdd=function(c){return this._map=c,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new re(this._map,this._compass,this.options.visualizePitch)),this._container},ee.prototype.onRemove=function(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ee.prototype._createButton=function(c,m){var d=D.create("button",c,this._container);return d.type="button",d.addEventListener("click",m),d},ee.prototype._setButtonTitle=function(c,m){var d=this._map._getUIString("NavigationControl."+m);c.title=d,c.setAttribute("aria-label",d)};var re=function(c,m,d){d===void 0&&(d=!1),this._clickTolerance=10,this.element=m,this.mouseRotate=new ds({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,d&&(this.mousePitch=new tu({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),f.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(m,"mousedown",this.mousedown),D.addEventListener(m,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(m,"touchmove",this.touchmove),D.addEventListener(m,"touchend",this.touchend),D.addEventListener(m,"touchcancel",this.reset)};function ue(c,m,d){if(c=new f.LngLat(c.lng,c.lat),m){var x=new f.LngLat(c.lng-360,c.lat),k=new f.LngLat(c.lng+360,c.lat),L=d.locationPoint(c).distSqr(m);d.locationPoint(x).distSqr(m)<L?c=x:d.locationPoint(k).distSqr(m)<L&&(c=k)}for(;Math.abs(c.lng-d.center.lng)>180;){var B=d.locationPoint(c);if(B.x>=0&&B.y>=0&&B.x<=d.width&&B.y<=d.height)break;c.lng>d.center.lng?c.lng-=360:c.lng+=360}return c}re.prototype.down=function(c,m){this.mouseRotate.mousedown(c,m),this.mousePitch&&this.mousePitch.mousedown(c,m),D.disableDrag()},re.prototype.move=function(c,m){var d=this.map,x=this.mouseRotate.mousemoveWindow(c,m);if(x&&x.bearingDelta&&d.setBearing(d.getBearing()+x.bearingDelta),this.mousePitch){var k=this.mousePitch.mousemoveWindow(c,m);k&&k.pitchDelta&&d.setPitch(d.getPitch()+k.pitchDelta)}},re.prototype.off=function(){var c=this.element;D.removeEventListener(c,"mousedown",this.mousedown),D.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(c,"touchmove",this.touchmove),D.removeEventListener(c,"touchend",this.touchend),D.removeEventListener(c,"touchcancel",this.reset),this.offTemp()},re.prototype.offTemp=function(){D.enableDrag(),D.removeEventListener(f.window,"mousemove",this.mousemove),D.removeEventListener(f.window,"mouseup",this.mouseup)},re.prototype.mousedown=function(c){this.down(f.extend({},c,{ctrlKey:!0,preventDefault:function(){return c.preventDefault()}}),D.mousePos(this.element,c)),D.addEventListener(f.window,"mousemove",this.mousemove),D.addEventListener(f.window,"mouseup",this.mouseup)},re.prototype.mousemove=function(c){this.move(c,D.mousePos(this.element,c))},re.prototype.mouseup=function(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()},re.prototype.touchstart=function(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return c.preventDefault()}},this._startPos))},re.prototype.touchmove=function(c){c.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:function(){return c.preventDefault()}},this._lastPos))},re.prototype.touchend=function(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},re.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ve={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Re(c,m,d){var x=c.classList;for(var k in ve)x.remove("mapboxgl-"+d+"-anchor-"+k);x.add("mapboxgl-"+d+"-anchor-"+m)}var be,De=function(c){function m(d,x){if(c.call(this),(d instanceof f.window.HTMLElement||x)&&(d=f.extend({element:d},x)),f.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=d&&d.anchor||"center",this._color=d&&d.color||"#3FB1CE",this._scale=d&&d.scale||1,this._draggable=d&&d.draggable||!1,this._clickTolerance=d&&d.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=d&&d.rotation||0,this._rotationAlignment=d&&d.rotationAlignment||"auto",this._pitchAlignment=d&&d.pitchAlignment&&d.pitchAlignment!=="auto"?d.pitchAlignment:this._rotationAlignment,d&&d.element)this._element=d.element,this._offset=f.Point.convert(d&&d.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");var k=D.createNS("http://www.w3.org/2000/svg","svg");k.setAttributeNS(null,"display","block"),k.setAttributeNS(null,"height","41px"),k.setAttributeNS(null,"width","27px"),k.setAttributeNS(null,"viewBox","0 0 27 41");var L=D.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"stroke","none"),L.setAttributeNS(null,"stroke-width","1"),L.setAttributeNS(null,"fill","none"),L.setAttributeNS(null,"fill-rule","evenodd");var B=D.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill-rule","nonzero");var q=D.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(3.0, 29.0)"),q.setAttributeNS(null,"fill","#000000");for(var $=0,ie=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];$<ie.length;$+=1){var he=ie[$],de=D.createNS("http://www.w3.org/2000/svg","ellipse");de.setAttributeNS(null,"opacity","0.04"),de.setAttributeNS(null,"cx","10.5"),de.setAttributeNS(null,"cy","5.80029008"),de.setAttributeNS(null,"rx",he.rx),de.setAttributeNS(null,"ry",he.ry),q.appendChild(de)}var me=D.createNS("http://www.w3.org/2000/svg","g");me.setAttributeNS(null,"fill",this._color);var Ce=D.createNS("http://www.w3.org/2000/svg","path");Ce.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),me.appendChild(Ce);var Te=D.createNS("http://www.w3.org/2000/svg","g");Te.setAttributeNS(null,"opacity","0.25"),Te.setAttributeNS(null,"fill","#000000");var Le=D.createNS("http://www.w3.org/2000/svg","path");Le.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Te.appendChild(Le);var xe=D.createNS("http://www.w3.org/2000/svg","g");xe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),xe.setAttributeNS(null,"fill","#FFFFFF");var ze=D.createNS("http://www.w3.org/2000/svg","g");ze.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Fe=D.createNS("http://www.w3.org/2000/svg","circle");Fe.setAttributeNS(null,"fill","#000000"),Fe.setAttributeNS(null,"opacity","0.25"),Fe.setAttributeNS(null,"cx","5.5"),Fe.setAttributeNS(null,"cy","5.5"),Fe.setAttributeNS(null,"r","5.4999962");var $e=D.createNS("http://www.w3.org/2000/svg","circle");$e.setAttributeNS(null,"fill","#FFFFFF"),$e.setAttributeNS(null,"cx","5.5"),$e.setAttributeNS(null,"cy","5.5"),$e.setAttributeNS(null,"r","5.4999962"),ze.appendChild(Fe),ze.appendChild($e),B.appendChild(q),B.appendChild(me),B.appendChild(Te),B.appendChild(xe),B.appendChild(ze),k.appendChild(B),k.setAttributeNS(null,"height",41*this._scale+"px"),k.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(k),this._offset=f.Point.convert(d&&d.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(ot){ot.preventDefault()}),this._element.addEventListener("mousedown",function(ot){ot.preventDefault()}),Re(this._element,this._anchor,"marker"),this._popup=null}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.addTo=function(d){return this.remove(),this._map=d,d.getCanvasContainer().appendChild(this._element),d.on("move",this._update),d.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},m.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this},m.prototype.getLngLat=function(){return this._lngLat},m.prototype.setLngLat=function(d){return this._lngLat=f.LngLat.convert(d),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},m.prototype.getElement=function(){return this._element},m.prototype.setPopup=function(d){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),d){if(!("offset"in d.options)){var x=Math.sqrt(Math.pow(13.5,2)/2);d.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(24.6+x)],"bottom-right":[-x,-1*(24.6+x)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=d,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},m.prototype._onKeyPress=function(d){var x=d.code,k=d.charCode||d.keyCode;x!=="Space"&&x!=="Enter"&&k!==32&&k!==13||this.togglePopup()},m.prototype._onMapClick=function(d){var x=d.originalEvent.target,k=this._element;this._popup&&(x===k||k.contains(x))&&this.togglePopup()},m.prototype.getPopup=function(){return this._popup},m.prototype.togglePopup=function(){var d=this._popup;return d?(d.isOpen()?d.remove():d.addTo(this._map),this):this},m.prototype._update=function(d){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ue(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(x="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var k="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?k="rotateX(0deg)":this._pitchAlignment==="map"&&(k="rotateX("+this._map.getPitch()+"deg)"),d&&d.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,ve[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+k+" "+x)}},m.prototype.getOffset=function(){return this._offset},m.prototype.setOffset=function(d){return this._offset=f.Point.convert(d),this._update(),this},m.prototype._onMove=function(d){if(!this._isDragging){var x=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=x}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new f.Event("dragstart"))),this.fire(new f.Event("drag")))},m.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new f.Event("dragend")),this._state="inactive"},m.prototype._addDragHandler=function(d){this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},m.prototype.setDraggable=function(d){return this._draggable=!!d,this._map&&(d?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},m.prototype.isDraggable=function(){return this._draggable},m.prototype.setRotation=function(d){return this._rotation=d||0,this._update(),this},m.prototype.getRotation=function(){return this._rotation},m.prototype.setRotationAlignment=function(d){return this._rotationAlignment=d||"auto",this._update(),this},m.prototype.getRotationAlignment=function(){return this._rotationAlignment},m.prototype.setPitchAlignment=function(d){return this._pitchAlignment=d&&d!=="auto"?d:this._rotationAlignment,this._update(),this},m.prototype.getPitchAlignment=function(){return this._pitchAlignment},m}(f.Evented),Je={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Xe=0,nt=!1,Ye=function(c){function m(d){c.call(this),this.options=f.extend({},Je,d),f.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.onAdd=function(d){var x;return this._map=d,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),x=this._setupUI,be!==void 0?x(be):f.window.navigator.permissions!==void 0?f.window.navigator.permissions.query({name:"geolocation"}).then(function(k){x(be=k.state!=="denied")}):x(be=!!f.window.navigator.geolocation),this._container},m.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(f.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Xe=0,nt=!1},m.prototype._isOutOfMapMaxBounds=function(d){var x=this._map.getMaxBounds(),k=d.coords;return x&&(k.longitude<x.getWest()||k.longitude>x.getEast()||k.latitude<x.getSouth()||k.latitude>x.getNorth())},m.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},m.prototype._onSuccess=function(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new f.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new f.Event("geolocate",d)),this._finish()}},m.prototype._updateCamera=function(d){var x=new f.LngLat(d.coords.longitude,d.coords.latitude),k=d.coords.accuracy,L=this._map.getBearing(),B=f.extend({bearing:L},this.options.fitBoundsOptions);this._map.fitBounds(x.toBounds(k),B,{geolocateSource:!0})},m.prototype._updateMarker=function(d){if(d){var x=new f.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(x).addTo(this._map),this._userLocationDotMarker.setLngLat(x).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},m.prototype._updateCircleRadius=function(){var d=this._map._container.clientHeight/2,x=this._map.unproject([0,d]),k=this._map.unproject([1,d]),L=x.distanceTo(k),B=Math.ceil(2*this._accuracy/L);this._circleElement.style.width=B+"px",this._circleElement.style.height=B+"px"},m.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},m.prototype._onError=function(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var x=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=x,this._geolocateButton.setAttribute("aria-label",x),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&nt)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new f.Event("error",d)),this._finish()}},m.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},m.prototype._setupUI=function(d){var x=this;if(this._container.addEventListener("contextmenu",function(B){return B.preventDefault()}),this._geolocateButton=D.create("button","mapboxgl-ctrl-geolocate",this._container),D.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",d===!1){f.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var k=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=k,this._geolocateButton.setAttribute("aria-label",k)}else{var L=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=L,this._geolocateButton.setAttribute("aria-label",L)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new De(this._dotElement),this._circleElement=D.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new De({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(B){B.geolocateSource||x._watchState!=="ACTIVE_LOCK"||B.originalEvent&&B.originalEvent.type==="resize"||(x._watchState="BACKGROUND",x._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),x._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),x.fire(new f.Event("trackuserlocationend")))})},m.prototype.trigger=function(){if(!this._setup)return f.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new f.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Xe--,nt=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new f.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new f.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Xe>1?(d={maximumAge:6e5,timeout:0},nt=!0):(d=this.options.positionOptions,nt=!1),this._geolocationWatchID=f.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,d)}}else f.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},m.prototype._clearWatch=function(){f.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},m}(f.Evented),xt={maxWidth:100,unit:"metric"},ht=function(c){this.options=f.extend({},xt,c),f.bindAll(["_onMove","setUnit"],this)};function ft(c,m,d){var x=d&&d.maxWidth||100,k=c._container.clientHeight/2,L=c.unproject([0,k]),B=c.unproject([x,k]),q=L.distanceTo(B);if(d&&d.unit==="imperial"){var $=3.2808*q;$>5280?Pt(m,x,$/5280,c._getUIString("ScaleControl.Miles")):Pt(m,x,$,c._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?Pt(m,x,q/1852,c._getUIString("ScaleControl.NauticalMiles")):q>=1e3?Pt(m,x,q/1e3,c._getUIString("ScaleControl.Kilometers")):Pt(m,x,q,c._getUIString("ScaleControl.Meters"))}function Pt(c,m,d,x){var k,L,B,q=(k=d,(L=Math.pow(10,(""+Math.floor(k)).length-1))*(B=(B=k/L)>=10?10:B>=5?5:B>=3?3:B>=2?2:B>=1?1:function($){var ie=Math.pow(10,Math.ceil(-Math.log($)/Math.LN10));return Math.round($*ie)/ie}(B)));c.style.width=m*(q/d)+"px",c.innerHTML=q+"&nbsp;"+x}ht.prototype.getDefaultPosition=function(){return"bottom-left"},ht.prototype._onMove=function(){ft(this._map,this._container,this.options)},ht.prototype.onAdd=function(c){return this._map=c,this._container=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",c.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ht.prototype.onRemove=function(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ht.prototype.setUnit=function(c){this.options.unit=c,ft(this._map,this._container,this.options)};var Ft=function(c){this._fullscreen=!1,c&&c.container&&(c.container instanceof f.window.HTMLElement?this._container=c.container:f.warnOnce("Full screen control 'container' must be a DOM element.")),f.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in f.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in f.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in f.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in f.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ft.prototype.onAdd=function(c){return this._map=c,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",f.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ft.prototype.onRemove=function(){D.remove(this._controlContainer),this._map=null,f.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ft.prototype._checkFullscreenSupport=function(){return!!(f.window.document.fullscreenEnabled||f.window.document.mozFullScreenEnabled||f.window.document.msFullscreenEnabled||f.window.document.webkitFullscreenEnabled)},Ft.prototype._setupUI=function(){var c=this._fullscreenButton=D.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D.create("span","mapboxgl-ctrl-icon",c).setAttribute("aria-hidden",!0),c.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),f.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ft.prototype._updateTitle=function(){var c=this._getTitle();this._fullscreenButton.setAttribute("aria-label",c),this._fullscreenButton.title=c},Ft.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ft.prototype._isFullscreen=function(){return this._fullscreen},Ft.prototype._changeIcon=function(){(f.window.document.fullscreenElement||f.window.document.mozFullScreenElement||f.window.document.webkitFullscreenElement||f.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ft.prototype._onClickFullscreen=function(){this._isFullscreen()?f.window.document.exitFullscreen?f.window.document.exitFullscreen():f.window.document.mozCancelFullScreen?f.window.document.mozCancelFullScreen():f.window.document.msExitFullscreen?f.window.document.msExitFullscreen():f.window.document.webkitCancelFullScreen&&f.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var wt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},pi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),ei=function(c){function m(d){c.call(this),this.options=f.extend(Object.create(wt),d),f.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.addTo=function(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new f.Event("open")),this},m.prototype.isOpen=function(){return!!this._map},m.prototype.remove=function(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new f.Event("close")),this},m.prototype.getLngLat=function(){return this._lngLat},m.prototype.setLngLat=function(d){return this._lngLat=f.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},m.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},m.prototype.getElement=function(){return this._container},m.prototype.setText=function(d){return this.setDOMContent(f.window.document.createTextNode(d))},m.prototype.setHTML=function(d){var x,k=f.window.document.createDocumentFragment(),L=f.window.document.createElement("body");for(L.innerHTML=d;x=L.firstChild;)k.appendChild(x);return this.setDOMContent(k)},m.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},m.prototype.setMaxWidth=function(d){return this.options.maxWidth=d,this._update(),this},m.prototype.setDOMContent=function(d){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(d),this._createCloseButton(),this._update(),this._focusFirstElement(),this},m.prototype.addClassName=function(d){this._container&&this._container.classList.add(d)},m.prototype.removeClassName=function(d){this._container&&this._container.classList.remove(d)},m.prototype.setOffset=function(d){return this.options.offset=d,this._update(),this},m.prototype.toggleClassName=function(d){if(this._container)return this._container.classList.toggle(d)},m.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=D.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},m.prototype._onMouseUp=function(d){this._update(d.point)},m.prototype._onMouseMove=function(d){this._update(d.point)},m.prototype._onDrag=function(d){this._update(d.point)},m.prototype._update=function(d){var x=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=D.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=D.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(de){return x._container.classList.add(de)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ue(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||d)){var k=this._pos=this._trackPointer&&d?d:this._map.project(this._lngLat),L=this.options.anchor,B=function de(me){if(me){if(typeof me=="number"){var Ce=Math.round(Math.sqrt(.5*Math.pow(me,2)));return{center:new f.Point(0,0),top:new f.Point(0,me),"top-left":new f.Point(Ce,Ce),"top-right":new f.Point(-Ce,Ce),bottom:new f.Point(0,-me),"bottom-left":new f.Point(Ce,-Ce),"bottom-right":new f.Point(-Ce,-Ce),left:new f.Point(me,0),right:new f.Point(-me,0)}}if(me instanceof f.Point||Array.isArray(me)){var Te=f.Point.convert(me);return{center:Te,top:Te,"top-left":Te,"top-right":Te,bottom:Te,"bottom-left":Te,"bottom-right":Te,left:Te,right:Te}}return{center:f.Point.convert(me.center||[0,0]),top:f.Point.convert(me.top||[0,0]),"top-left":f.Point.convert(me["top-left"]||[0,0]),"top-right":f.Point.convert(me["top-right"]||[0,0]),bottom:f.Point.convert(me.bottom||[0,0]),"bottom-left":f.Point.convert(me["bottom-left"]||[0,0]),"bottom-right":f.Point.convert(me["bottom-right"]||[0,0]),left:f.Point.convert(me.left||[0,0]),right:f.Point.convert(me.right||[0,0])}}return de(new f.Point(0,0))}(this.options.offset);if(!L){var q,$=this._container.offsetWidth,ie=this._container.offsetHeight;q=k.y+B.bottom.y<ie?["top"]:k.y>this._map.transform.height-ie?["bottom"]:[],k.x<$/2?q.push("left"):k.x>this._map.transform.width-$/2&&q.push("right"),L=q.length===0?"bottom":q.join("-")}var he=k.add(B[L]).round();D.setTransform(this._container,ve[L]+" translate("+he.x+"px,"+he.y+"px)"),Re(this._container,L,"popup")}},m.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var d=this._container.querySelector(pi);d&&d.focus()}},m.prototype._onClose=function(){this.remove()},m}(f.Evented),Ui={version:f.version,supported:h,setRTLTextPlugin:f.setRTLTextPlugin,getRTLTextPluginStatus:f.getRTLTextPluginStatus,Map:U,NavigationControl:ee,GeolocateControl:Ye,AttributionControl:Bn,ScaleControl:ht,FullscreenControl:Ft,Popup:ei,Marker:De,Style:po,LngLat:f.LngLat,LngLatBounds:f.LngLatBounds,Point:f.Point,MercatorCoordinate:f.MercatorCoordinate,Evented:f.Evented,config:f.config,prewarm:function(){fe().acquire(X)},clearPrewarmedResources:function(){var c=ce;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(X),ce=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return f.config.ACCESS_TOKEN},set accessToken(c){f.config.ACCESS_TOKEN=c},get baseApiUrl(){return f.config.API_URL},set baseApiUrl(c){f.config.API_URL=c},get workerCount(){return ne.workerCount},set workerCount(c){ne.workerCount=c},get maxParallelImageRequests(){return f.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(c){f.config.MAX_PARALLEL_IMAGE_REQUESTS=c},clearStorage:function(c){f.clearTileCache(c)},workerUrl:""};return Ui}),w})})(Tg);Object.defineProperty(C0,"__esModule",{value:!0});const KS=Tg.exports;class JS{constructor(r){this.map=r,this.contents=[]}add(r,s,g){var w;let z=`
    <div class="mapboxgl-popup-layer-name">${g}</div>
    <div class="mapboxgl-popup-panel_area"><table class="mapboxgl-popup-table">
    ${Object.keys(s.properties).map(D=>`<tr><th class="mapboxgl-popup-th">${D.replace(/_/g," ").replace(/-/g," ")}</th><td class="mapboxgl-popup-td">${s.properties[D]}</td></tr>`).join("")}
    </table></div>`;this.contents.push(z);let f;if(this.contents.length===1?f=this.contents[0]:f=`
      <div class="mapboxgl-popup-tab_wrap">
      ${this.contents.map(D=>{let N=this.contents.indexOf(D)+1;return`<input id="mapboxgl-popup-tab${N}" type="radio" name="tab_btn" ${N===0?"checked":""}>`}).join("")}
      <div class="mapboxgl-popup-tab_area">
      ${this.contents.map(D=>{let N=this.contents.indexOf(D)+1;return`<label class="mapboxgl-popup-tab${N}_label" for="mapboxgl-popup-tab${N}">${N}</label>`}).join("")}
      </div>
      <div class="mapboxgl-popup-panel_area">
      ${this.contents.map(D=>`<div id="mapboxgl-popup-panel${this.contents.indexOf(D)+1}" class="mapboxgl-popup-tab_panel">${D}</div>`).join("")}
      </div>
     </div>`,this.popup?this.popup.setHTML(f):this.popup=new KS.Popup().setLngLat(r).setHTML(f).setMaxWidth("400px").addTo(this.map),this.contents.length>1){const D=document.getElementById("mapboxgl-popup-tab1");D.checked=!0}var h=this;(w=h.popup)===null||w===void 0||w.on("close",function(){h.popup=null,h.contents=[]})}}class $S{constructor(r=[]){this.targets=r}createPopup(r,s){var g;let w=r.lngLat;const z=r.features[0];for(z.geometry.type==="Point"&&(w=z.geometry.coordinates.slice());Math.abs(r.lngLat.lng-w[0])>180;)w[0]+=r.lngLat.lng>w[0]?360:-360;!this.map||(g=this.popupManager)===null||g===void 0||g.add(w,z,s)}onAdd(r){if(this.map=r,this.popupManager=new JS(this.map),this.targets.length>0){const s=this;this.targets.forEach(g=>{r.on("click",g,function(w){s.createPopup(w,g)})})}return this.controlContainer=document.createElement("div"),this.controlContainer.className="mapboxgl-ctrl mapboxgl-ctrl-group",Object.assign(this.controlContainer,{style:"display:none"}),this.popupButton=document.createElement("button"),this.popupButton.className="mapboxgl-ctrl-icon",this.popupButton.type="button",this.controlContainer.appendChild(this.popupButton),this.controlContainer}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.popupButton||(this.controlContainer.parentNode.removeChild(this.controlContainer),this.map=void 0)}}var YS=C0.default=$S,Ag={};Object.defineProperty(Ag,"__esModule",{value:!0});var k0=Ag.MapboxStyleSwitcherControl=void 0;class qp{constructor(r,s){this.styles=r||qp.DEFAULT_STYLES,this.defaultStyle=s||qp.DEFAULT_STYLE,this.styleUrl=new QS,this.defaultStyleFromUrl=this.styleUrl.get();let g=!1;for(const w of this.styles)w.title===this.defaultStyleFromUrl&&(g=!0);g||(this.styleUrl.delete(),this.defaultStyleFromUrl=null),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}onAdd(r){this.map=r,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.mapStyleContainer=document.createElement("div"),this.styleButton=document.createElement("button"),this.styleButton.type="button",this.mapStyleContainer.classList.add("mapboxgl-style-list");for(const s of this.styles){const g=document.createElement("button");g.type="button",g.innerText=s.title,g.classList.add(s.title.replace(/[^a-z0-9-]/gi,"_")),g.dataset.uri=JSON.stringify(s.uri),g.dataset.title=s.title,g.addEventListener("click",w=>{const z=w.srcElement;if(z.classList.contains("active"))return;this.map.setStyle(JSON.parse(z.dataset.uri)),this.styleUrl.set(z.dataset.title),this.mapStyleContainer.style.display="none",this.styleButton.style.display="block";const f=this.mapStyleContainer.getElementsByClassName("active");for(;f[0];)f[0].classList.remove("active");z.classList.add("active")}),s.title===this.defaultStyleFromUrl&&this.mapStyleContainer.getElementsByClassName("active").length===0&&(g.classList.add("active"),this.map.setStyle(s.uri)),!this.defaultStyleFromUrl&&s.title===this.defaultStyle&&this.mapStyleContainer.getElementsByClassName("active").length===0&&(g.classList.add("active"),this.map.setStyle(s.uri)),this.mapStyleContainer.appendChild(g)}return this.styleButton.classList.add("mapboxgl-ctrl-icon"),this.styleButton.classList.add("mapboxgl-style-switcher"),this.styleButton.addEventListener("click",()=>{this.styleButton.style.display="none",this.mapStyleContainer.style.display="block"}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.styleButton),this.controlContainer.appendChild(this.mapStyleContainer),this.controlContainer}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.styleButton||(this.styleButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.map=void 0)}onDocumentClick(r){this.controlContainer&&!this.controlContainer.contains(r.target)&&this.mapStyleContainer&&this.styleButton&&(this.mapStyleContainer.style.display="none",this.styleButton.style.display="block")}}k0=Ag.MapboxStyleSwitcherControl=qp;qp.DEFAULT_STYLE="Streets";qp.DEFAULT_STYLES=[{title:"Dark",uri:"mapbox://styles/mapbox/dark-v10"},{title:"Light",uri:"mapbox://styles/mapbox/light-v10"},{title:"Outdoors",uri:"mapbox://styles/mapbox/outdoors-v11"},{title:"Satellite",uri:"mapbox://styles/mapbox/satellite-streets-v11"},{title:"Streets",uri:"mapbox://styles/mapbox/streets-v11"}];class QS{constructor(){this.STYLE_PATHNAME="style"}getUrl(){const r=window.location,s=new URL(r.href);return s.hash=r.hash,s}updateUrl(r){history.replaceState("","",r.toString())}get(){return this.getUrl().searchParams.get(this.STYLE_PATHNAME)}set(r){const s=this.getUrl();s.searchParams.set(this.STYLE_PATHNAME,r),this.updateUrl(s)}delete(){const r=this.getUrl();r.searchParams.delete(this.STYLE_PATHNAME),this.updateUrl(r)}}var z0={},Cg={},kg={},ym={},zg={exports:{}},P0=function(r,s){return function(){for(var w=new Array(arguments.length),z=0;z<w.length;z++)w[z]=arguments[z];return r.apply(s,w)}},eT=P0,ip=Object.prototype.toString;function Pg(u){return ip.call(u)==="[object Array]"}function Jy(u){return typeof u=="undefined"}function tT(u){return u!==null&&!Jy(u)&&u.constructor!==null&&!Jy(u.constructor)&&typeof u.constructor.isBuffer=="function"&&u.constructor.isBuffer(u)}function iT(u){return ip.call(u)==="[object ArrayBuffer]"}function rT(u){return typeof FormData!="undefined"&&u instanceof FormData}function nT(u){var r;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?r=ArrayBuffer.isView(u):r=u&&u.buffer&&u.buffer instanceof ArrayBuffer,r}function oT(u){return typeof u=="string"}function aT(u){return typeof u=="number"}function M0(u){return u!==null&&typeof u=="object"}function Uf(u){if(ip.call(u)!=="[object Object]")return!1;var r=Object.getPrototypeOf(u);return r===null||r===Object.prototype}function sT(u){return ip.call(u)==="[object Date]"}function lT(u){return ip.call(u)==="[object File]"}function uT(u){return ip.call(u)==="[object Blob]"}function L0(u){return ip.call(u)==="[object Function]"}function cT(u){return M0(u)&&L0(u.pipe)}function hT(u){return typeof URLSearchParams!="undefined"&&u instanceof URLSearchParams}function pT(u){return u.trim?u.trim():u.replace(/^\s+|\s+$/g,"")}function dT(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function Mg(u,r){if(!(u===null||typeof u=="undefined"))if(typeof u!="object"&&(u=[u]),Pg(u))for(var s=0,g=u.length;s<g;s++)r.call(null,u[s],s,u);else for(var w in u)Object.prototype.hasOwnProperty.call(u,w)&&r.call(null,u[w],w,u)}function $y(){var u={};function r(w,z){Uf(u[z])&&Uf(w)?u[z]=$y(u[z],w):Uf(w)?u[z]=$y({},w):Pg(w)?u[z]=w.slice():u[z]=w}for(var s=0,g=arguments.length;s<g;s++)Mg(arguments[s],r);return u}function fT(u,r,s){return Mg(r,function(w,z){s&&typeof w=="function"?u[z]=eT(w,s):u[z]=w}),u}function mT(u){return u.charCodeAt(0)===65279&&(u=u.slice(1)),u}var fl={isArray:Pg,isArrayBuffer:iT,isBuffer:tT,isFormData:rT,isArrayBufferView:nT,isString:oT,isNumber:aT,isObject:M0,isPlainObject:Uf,isUndefined:Jy,isDate:sT,isFile:lT,isBlob:uT,isFunction:L0,isStream:cT,isURLSearchParams:hT,isStandardBrowserEnv:dT,forEach:Mg,merge:$y,extend:fT,trim:pT,stripBOM:mT},Pp=fl;function ev(u){return encodeURIComponent(u).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var D0=function(r,s,g){if(!s)return r;var w;if(g)w=g(s);else if(Pp.isURLSearchParams(s))w=s.toString();else{var z=[];Pp.forEach(s,function(D,N){D===null||typeof D=="undefined"||(Pp.isArray(D)?N=N+"[]":D=[D],Pp.forEach(D,function(G){Pp.isDate(G)?G=G.toISOString():Pp.isObject(G)&&(G=JSON.stringify(G)),z.push(ev(N)+"="+ev(G))}))}),w=z.join("&")}if(w){var f=r.indexOf("#");f!==-1&&(r=r.slice(0,f)),r+=(r.indexOf("?")===-1?"?":"&")+w}return r},yT=fl;function gm(){this.handlers=[]}gm.prototype.use=function(r,s,g){return this.handlers.push({fulfilled:r,rejected:s,synchronous:g?g.synchronous:!1,runWhen:g?g.runWhen:null}),this.handlers.length-1};gm.prototype.eject=function(r){this.handlers[r]&&(this.handlers[r]=null)};gm.prototype.forEach=function(r){yT.forEach(this.handlers,function(g){g!==null&&r(g)})};var gT=gm,_T=fl,vT=function(r,s){_T.forEach(r,function(w,z){z!==s&&z.toUpperCase()===s.toUpperCase()&&(r[s]=w,delete r[z])})},R0=function(r,s,g,w,z){return r.config=s,g&&(r.code=g),r.request=w,r.response=z,r.isAxiosError=!0,r.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},r},xT=R0,B0=function(r,s,g,w,z){var f=new Error(r);return xT(f,s,g,w,z)},bT=B0,wT=function(r,s,g){var w=g.config.validateStatus;!g.status||!w||w(g.status)?r(g):s(bT("Request failed with status code "+g.status,g.config,null,g.request,g))},Lf=fl,ET=Lf.isStandardBrowserEnv()?function(){return{write:function(s,g,w,z,f,h){var D=[];D.push(s+"="+encodeURIComponent(g)),Lf.isNumber(w)&&D.push("expires="+new Date(w).toGMTString()),Lf.isString(z)&&D.push("path="+z),Lf.isString(f)&&D.push("domain="+f),h===!0&&D.push("secure"),document.cookie=D.join("; ")},read:function(s){var g=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return g?decodeURIComponent(g[3]):null},remove:function(s){this.write(s,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),IT=function(r){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(r)},ST=function(r,s){return s?r.replace(/\/+$/,"")+"/"+s.replace(/^\/+/,""):r},TT=IT,AT=ST,CT=function(r,s){return r&&!TT(s)?AT(r,s):s},zy=fl,kT=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],zT=function(r){var s={},g,w,z;return r&&zy.forEach(r.split(`
`),function(h){if(z=h.indexOf(":"),g=zy.trim(h.substr(0,z)).toLowerCase(),w=zy.trim(h.substr(z+1)),g){if(s[g]&&kT.indexOf(g)>=0)return;g==="set-cookie"?s[g]=(s[g]?s[g]:[]).concat([w]):s[g]=s[g]?s[g]+", "+w:w}}),s},tv=fl,PT=tv.isStandardBrowserEnv()?function(){var r=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a"),g;function w(z){var f=z;return r&&(s.setAttribute("href",f),f=s.href),s.setAttribute("href",f),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return g=w(window.location.href),function(f){var h=tv.isString(f)?w(f):f;return h.protocol===g.protocol&&h.host===g.host}}():function(){return function(){return!0}}(),Df=fl,MT=wT,LT=ET,DT=D0,RT=CT,BT=zT,OT=PT,Py=B0,iv=function(r){return new Promise(function(g,w){var z=r.data,f=r.headers,h=r.responseType;Df.isFormData(z)&&delete f["Content-Type"];var D=new XMLHttpRequest;if(r.auth){var N=r.auth.username||"",F=r.auth.password?unescape(encodeURIComponent(r.auth.password)):"";f.Authorization="Basic "+btoa(N+":"+F)}var G=RT(r.baseURL,r.url);D.open(r.method.toUpperCase(),DT(G,r.params,r.paramsSerializer),!0),D.timeout=r.timeout;function H(){if(!!D){var ke="getAllResponseHeaders"in D?BT(D.getAllResponseHeaders()):null,We=!h||h==="text"||h==="json"?D.responseText:D.response,je={data:We,status:D.status,statusText:D.statusText,headers:ke,config:r,request:D};MT(g,w,je),D=null}}if("onloadend"in D?D.onloadend=H:D.onreadystatechange=function(){!D||D.readyState!==4||D.status===0&&!(D.responseURL&&D.responseURL.indexOf("file:")===0)||setTimeout(H)},D.onabort=function(){!D||(w(Py("Request aborted",r,"ECONNABORTED",D)),D=null)},D.onerror=function(){w(Py("Network Error",r,null,D)),D=null},D.ontimeout=function(){var We="timeout of "+r.timeout+"ms exceeded";r.timeoutErrorMessage&&(We=r.timeoutErrorMessage),w(Py(We,r,r.transitional&&r.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",D)),D=null},Df.isStandardBrowserEnv()){var Pe=(r.withCredentials||OT(G))&&r.xsrfCookieName?LT.read(r.xsrfCookieName):void 0;Pe&&(f[r.xsrfHeaderName]=Pe)}"setRequestHeader"in D&&Df.forEach(f,function(We,je){typeof z=="undefined"&&je.toLowerCase()==="content-type"?delete f[je]:D.setRequestHeader(je,We)}),Df.isUndefined(r.withCredentials)||(D.withCredentials=!!r.withCredentials),h&&h!=="json"&&(D.responseType=r.responseType),typeof r.onDownloadProgress=="function"&&D.addEventListener("progress",r.onDownloadProgress),typeof r.onUploadProgress=="function"&&D.upload&&D.upload.addEventListener("progress",r.onUploadProgress),r.cancelToken&&r.cancelToken.promise.then(function(We){!D||(D.abort(),w(We),D=null)}),z||(z=null),D.send(z)})},La=fl,rv=vT,FT=R0,UT={"Content-Type":"application/x-www-form-urlencoded"};function nv(u,r){!La.isUndefined(u)&&La.isUndefined(u["Content-Type"])&&(u["Content-Type"]=r)}function NT(){var u;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(u=iv),u}function jT(u,r,s){if(La.isString(u))try{return(r||JSON.parse)(u),La.trim(u)}catch(g){if(g.name!=="SyntaxError")throw g}return(s||JSON.stringify)(u)}var _m={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:NT(),transformRequest:[function(r,s){return rv(s,"Accept"),rv(s,"Content-Type"),La.isFormData(r)||La.isArrayBuffer(r)||La.isBuffer(r)||La.isStream(r)||La.isFile(r)||La.isBlob(r)?r:La.isArrayBufferView(r)?r.buffer:La.isURLSearchParams(r)?(nv(s,"application/x-www-form-urlencoded;charset=utf-8"),r.toString()):La.isObject(r)||s&&s["Content-Type"]==="application/json"?(nv(s,"application/json"),jT(r)):r}],transformResponse:[function(r){var s=this.transitional,g=s&&s.silentJSONParsing,w=s&&s.forcedJSONParsing,z=!g&&this.responseType==="json";if(z||w&&La.isString(r)&&r.length)try{return JSON.parse(r)}catch(f){if(z)throw f.name==="SyntaxError"?FT(f,this,"E_JSON_PARSE"):f}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(r){return r>=200&&r<300}};_m.headers={common:{Accept:"application/json, text/plain, */*"}};La.forEach(["delete","get","head"],function(r){_m.headers[r]={}});La.forEach(["post","put","patch"],function(r){_m.headers[r]=La.merge(UT)});var Lg=_m,VT=fl,qT=Lg,GT=function(r,s,g){var w=this||qT;return VT.forEach(g,function(f){r=f.call(w,r,s)}),r},O0=function(r){return!!(r&&r.__CANCEL__)},ov=fl,My=GT,ZT=O0,HT=Lg;function Ly(u){u.cancelToken&&u.cancelToken.throwIfRequested()}var WT=function(r){Ly(r),r.headers=r.headers||{},r.data=My.call(r,r.data,r.headers,r.transformRequest),r.headers=ov.merge(r.headers.common||{},r.headers[r.method]||{},r.headers),ov.forEach(["delete","get","head","post","put","patch","common"],function(w){delete r.headers[w]});var s=r.adapter||HT.adapter;return s(r).then(function(w){return Ly(r),w.data=My.call(r,w.data,w.headers,r.transformResponse),w},function(w){return ZT(w)||(Ly(r),w&&w.response&&(w.response.data=My.call(r,w.response.data,w.response.headers,r.transformResponse))),Promise.reject(w)})},Ja=fl,F0=function(r,s){s=s||{};var g={},w=["url","method","data"],z=["headers","auth","proxy","params"],f=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],h=["validateStatus"];function D(H,Pe){return Ja.isPlainObject(H)&&Ja.isPlainObject(Pe)?Ja.merge(H,Pe):Ja.isPlainObject(Pe)?Ja.merge({},Pe):Ja.isArray(Pe)?Pe.slice():Pe}function N(H){Ja.isUndefined(s[H])?Ja.isUndefined(r[H])||(g[H]=D(void 0,r[H])):g[H]=D(r[H],s[H])}Ja.forEach(w,function(Pe){Ja.isUndefined(s[Pe])||(g[Pe]=D(void 0,s[Pe]))}),Ja.forEach(z,N),Ja.forEach(f,function(Pe){Ja.isUndefined(s[Pe])?Ja.isUndefined(r[Pe])||(g[Pe]=D(void 0,r[Pe])):g[Pe]=D(void 0,s[Pe])}),Ja.forEach(h,function(Pe){Pe in s?g[Pe]=D(r[Pe],s[Pe]):Pe in r&&(g[Pe]=D(void 0,r[Pe]))});var F=w.concat(z).concat(f).concat(h),G=Object.keys(r).concat(Object.keys(s)).filter(function(Pe){return F.indexOf(Pe)===-1});return Ja.forEach(G,N),g};const XT="axios",KT="0.21.4",JT="Promise based HTTP client for the browser and node.js",$T="index.js",YT={test:"grunt test",start:"node ./sandbox/server.js",build:"NODE_ENV=production grunt build",preversion:"npm test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json",postversion:"git push && git push --tags",examples:"node ./examples/server.js",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",fix:"eslint --fix lib/**/*.js"},QT={type:"git",url:"https://github.com/axios/axios.git"},eA=["xhr","http","ajax","promise","node"],tA="Matt Zabriskie",iA="MIT",rA={url:"https://github.com/axios/axios/issues"},nA="https://axios-http.com",oA={coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",mocha:"^8.2.1",sinon:"^4.5.0","terser-webpack-plugin":"^4.2.3",typescript:"^4.0.5","url-search-params":"^0.10.0",webpack:"^4.44.2","webpack-dev-server":"^3.11.0"},aA={"./lib/adapters/http.js":"./lib/adapters/xhr.js"},sA="dist/axios.min.js",lA="dist/axios.min.js",uA="./index.d.ts",cA={"follow-redirects":"^1.14.0"},hA=[{path:"./dist/axios.min.js",threshold:"5kB"}];var pA={name:XT,version:KT,description:JT,main:$T,scripts:YT,repository:QT,keywords:eA,author:tA,license:iA,bugs:rA,homepage:nA,devDependencies:oA,browser:aA,jsdelivr:sA,unpkg:lA,typings:uA,dependencies:cA,bundlesize:hA},U0=pA,Dg={};["object","boolean","number","function","string","symbol"].forEach(function(u,r){Dg[u]=function(g){return typeof g===u||"a"+(r<1?"n ":" ")+u}});var av={},dA=U0.version.split(".");function N0(u,r){for(var s=r?r.split("."):dA,g=u.split("."),w=0;w<3;w++){if(s[w]>g[w])return!0;if(s[w]<g[w])return!1}return!1}Dg.transitional=function(r,s,g){var w=s&&N0(s);function z(f,h){return"[Axios v"+U0.version+"] Transitional option '"+f+"'"+h+(g?". "+g:"")}return function(f,h,D){if(r===!1)throw new Error(z(h," has been removed in "+s));return w&&!av[h]&&(av[h]=!0,console.warn(z(h," has been deprecated since v"+s+" and will be removed in the near future"))),r?r(f,h,D):!0}};function fA(u,r,s){if(typeof u!="object")throw new TypeError("options must be an object");for(var g=Object.keys(u),w=g.length;w-- >0;){var z=g[w],f=r[z];if(f){var h=u[z],D=h===void 0||f(h,z,u);if(D!==!0)throw new TypeError("option "+z+" must be "+D);continue}if(s!==!0)throw Error("Unknown option "+z)}}var mA={isOlderVersion:N0,assertOptions:fA,validators:Dg},j0=fl,yA=D0,sv=gT,lv=WT,vm=F0,V0=mA,Mp=V0.validators;function qd(u){this.defaults=u,this.interceptors={request:new sv,response:new sv}}qd.prototype.request=function(r){typeof r=="string"?(r=arguments[1]||{},r.url=arguments[0]):r=r||{},r=vm(this.defaults,r),r.method?r.method=r.method.toLowerCase():this.defaults.method?r.method=this.defaults.method.toLowerCase():r.method="get";var s=r.transitional;s!==void 0&&V0.assertOptions(s,{silentJSONParsing:Mp.transitional(Mp.boolean,"1.0.0"),forcedJSONParsing:Mp.transitional(Mp.boolean,"1.0.0"),clarifyTimeoutError:Mp.transitional(Mp.boolean,"1.0.0")},!1);var g=[],w=!0;this.interceptors.request.forEach(function(H){typeof H.runWhen=="function"&&H.runWhen(r)===!1||(w=w&&H.synchronous,g.unshift(H.fulfilled,H.rejected))});var z=[];this.interceptors.response.forEach(function(H){z.push(H.fulfilled,H.rejected)});var f;if(!w){var h=[lv,void 0];for(Array.prototype.unshift.apply(h,g),h=h.concat(z),f=Promise.resolve(r);h.length;)f=f.then(h.shift(),h.shift());return f}for(var D=r;g.length;){var N=g.shift(),F=g.shift();try{D=N(D)}catch(G){F(G);break}}try{f=lv(D)}catch(G){return Promise.reject(G)}for(;z.length;)f=f.then(z.shift(),z.shift());return f};qd.prototype.getUri=function(r){return r=vm(this.defaults,r),yA(r.url,r.params,r.paramsSerializer).replace(/^\?/,"")};j0.forEach(["delete","get","head","options"],function(r){qd.prototype[r]=function(s,g){return this.request(vm(g||{},{method:r,url:s,data:(g||{}).data}))}});j0.forEach(["post","put","patch"],function(r){qd.prototype[r]=function(s,g,w){return this.request(vm(w||{},{method:r,url:s,data:g}))}});var gA=qd;function Rg(u){this.message=u}Rg.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};Rg.prototype.__CANCEL__=!0;var q0=Rg,_A=q0;function $f(u){if(typeof u!="function")throw new TypeError("executor must be a function.");var r;this.promise=new Promise(function(w){r=w});var s=this;u(function(w){s.reason||(s.reason=new _A(w),r(s.reason))})}$f.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};$f.source=function(){var r,s=new $f(function(w){r=w});return{token:s,cancel:r}};var vA=$f,xA=function(r){return function(g){return r.apply(null,g)}},bA=function(r){return typeof r=="object"&&r.isAxiosError===!0},uv=fl,wA=P0,Nf=gA,EA=F0,IA=Lg;function G0(u){var r=new Nf(u),s=wA(Nf.prototype.request,r);return uv.extend(s,Nf.prototype,r),uv.extend(s,r),s}var xu=G0(IA);xu.Axios=Nf;xu.create=function(r){return G0(EA(xu.defaults,r))};xu.Cancel=q0;xu.CancelToken=vA;xu.isCancel=O0;xu.all=function(r){return Promise.all(r)};xu.spread=xA;xu.isAxiosError=bA;zg.exports=xu;zg.exports.default=xu;var SA=zg.exports;(function(u){Object.defineProperty(u,"__esModule",{value:!0}),u.ContourType=u.Costing=void 0;const r=SA,s=Tg.exports;u.Costing={Walking:"pedestrian",Bicycle:"bicycle",Car:"auto"},u.ContourType={Time:"time",Distance:"distance"};class g{constructor(z,f,h){this.contourSources=[],this.contourLayers=[],this.contourMaker=void 0,this.contours=[{time:5,distance:1,color:"ff0000"},{time:10,distance:3,color:"ffff00"},{time:15,distance:5,color:"0000ff"}],this.map=z,this.url=f,h&&(this.contours=h)}clearFeatures(){this.contourLayers&&this.contourLayers.length>0&&(this.contourLayers.forEach(z=>{var f;(f=this.map)===null||f===void 0||f.removeLayer(z)}),this.contourLayers=[]),this.contourSources&&this.contourSources.length>0&&(this.contourSources.forEach(z=>{var f;(f=this.map)===null||f===void 0||f.removeSource(z)}),this.contourSources=[]),this.contourMaker&&(this.contourMaker.remove(),this.contourMaker=void 0)}getIsochrone(z,f,h,D,N){this.clearFeatures();let F=JSON.parse(JSON.stringify(this.contours));N&&(F=N),F.forEach(H=>{h===u.ContourType.Time?delete H.distance:delete H.time});let G="km";return h===u.ContourType.Time&&(G="min"),new Promise((H,Pe)=>{const ke={locations:[{lat:f,lon:z}],costing:D,contours:F,polygons:!0},We=`${this.url}/isochrone?json=${JSON.stringify(ke)}`;r.default.get(We).then(je=>{je.data.features.forEach(Ne=>{var Ze,vt,ct,pt;const lt=`isochrone-${Ne.properties.contour}`;(Ze=this.map)===null||Ze===void 0||Ze.addSource(lt,{type:"geojson",data:Ne}),this.contourSources.push(lt),(vt=this.map)===null||vt===void 0||vt.addLayer({id:`pg-${lt}`,type:"fill",source:lt,layout:{},paint:{"fill-color":Ne.properties.fillColor,"fill-opacity":.1}}),this.contourLayers.push(`pg-${lt}`),(ct=this.map)===null||ct===void 0||ct.addLayer({id:`ls-${lt}`,type:"line",source:lt,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":Ne.properties.fillColor,"line-width":3}}),this.contourLayers.push(`ls-${lt}`),(pt=this.map)===null||pt===void 0||pt.addLayer({id:`symbol-${lt}`,type:"symbol",source:lt,layout:{"symbol-placement":"line","text-pitch-alignment":"viewport","text-font":["Roboto Bold"],"text-field":["concat",["get","contour"],` ${G}`],"text-size":16},paint:{"text-color":"#000000","text-halo-width":1,"text-halo-color":"#FFFFFF"}}),this.contourLayers.push(`symbol-${lt}`)}),this.map&&(this.contourMaker=new s.Marker().setLngLat([z,f]).addTo(this.map)),H()}).catch(je=>Pe(je))})}getContoursOption(){return this.contours}}u.default=g})(ym);var xm={};Object.defineProperty(xm,"__esModule",{value:!0});class TA{constructor(r){this.color="#535353",this.map=r}create(){this.updateValues(),this.map!==void 0?(this.map.on("resize",this.mapResize.bind(this)),this.createCanvas(this.map.getCanvasContainer())):console.error("map object is null")}updateValues(){var r,s;this.width=(r=this.map)===null||r===void 0?void 0:r.getCanvas().clientWidth,this.height=(s=this.map)===null||s===void 0?void 0:s.getCanvas().clientHeight}mapResize(){this.updateValues(),this.updateCanvas()}updateCanvas(){if(this.svgCanvas!==void 0&&this.yLine!==void 0&&this.xLine!==void 0&&this.width!==void 0&&this.height!==void 0){this.svgCanvas.setAttribute("width",`${this.width}px`),this.svgCanvas.setAttribute("height",`${this.height}px`);const r=this.width/2,s=this.height/2;this.yLine.setAttribute("x1",`${r}px`),this.yLine.setAttribute("y1","0px"),this.yLine.setAttribute("x2",`${r}px`),this.yLine.setAttribute("y2",`${this.height}px`),this.xLine.setAttribute("x1",`${0}px`),this.xLine.setAttribute("y1",`${s}px`),this.xLine.setAttribute("x2",`${this.width}px`),this.xLine.setAttribute("y2",`${s}px`)}}createCanvas(r){if(this.width!==void 0&&this.height!==void 0){const s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.style.position="relative",s.setAttribute("width",`${this.width}px`),s.setAttribute("height",`${this.height}px`);const g=this.width/2,w=this.height/2;this.yLine=s.appendChild(this.createLine(g,0,g,this.height,this.color,"2px")),this.xLine=s.appendChild(this.createLine(0,w,this.width,w,this.color,"2px")),r==null||r.appendChild(s),this.svgCanvas=s}}createLine(r,s,g,w,z,f){const h=document.createElementNS("http://www.w3.org/2000/svg","line");return h.setAttribute("x1",r),h.setAttribute("y1",s),h.setAttribute("x2",g),h.setAttribute("y2",w),h.setAttribute("stroke-dasharray","5,5"),h.setAttribute("stroke",z),h.setAttribute("stroke-width",f),h}destroy(){this.xLine!==void 0&&(this.xLine.remove(),this.xLine=void 0),this.yLine!==void 0&&(this.yLine.remove(),this.yLine=void 0),this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map.off("resize",this.mapResize),this.map=void 0)}}xm.default=TA;var ep={};Object.defineProperty(ep,"__esModule",{value:!0});ep.createTextbox=ep.createSelection=void 0;const AA=(u,r,s,g,w)=>{const z=document.createElement("label");z.textContent=r;const f=document.createElement("select");f.setAttribute("id",`mapbox-gl-valhalla-${s}`),f.style.width="100%",Object.keys(u).forEach(F=>{const G=document.createElement("option");G.setAttribute("value",w(u,F)),G.appendChild(document.createTextNode(F)),G.setAttribute("name",s),g===u[F]&&(G.selected=!0),f.appendChild(G)});const h=document.createElement("TR"),D=document.createElement("TD"),N=document.createElement("TD");return D.appendChild(z),N.appendChild(f),h.appendChild(D),h.appendChild(N),h};ep.createSelection=AA;const CA=(u,r,s,g,w)=>{const z=document.createElement("label");z.textContent=u,w||(w="text");const f=document.createElement("input");f.setAttribute("id",`mapbox-gl-valhalla-${r}`),f.setAttribute("type",w),f.setAttribute("value",s),f.readOnly=g;const h=document.createElement("TR"),D=document.createElement("TD"),N=document.createElement("TD");return D.appendChild(z),N.appendChild(f),h.appendChild(D),h.appendChild(N),h};ep.createTextbox=CA;Object.defineProperty(kg,"__esModule",{value:!0});const Dy=ym,kA=xm,Rf=ep;class zA{constructor(r,s){this.map=r,this.valhalla=s,this.onDocumentClick=this.onDocumentClick.bind(this)}addTo(r){var s,g;this.map||console.error("map object is null"),this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.mainContainer=document.createElement("div"),this.mainContainer.classList.add("mapboxgl-valhalla-list"),this.mainButton=document.createElement("button"),this.mainButton.classList.add("mapboxgl-ctrl-icon"),this.mainButton.classList.add("mapboxgl-valhalla-time-isochrone-control"),this.mainButton.addEventListener("click",()=>{this.mainButton.style.display="none",this.mainContainer.style.display="block",this.toggleCrosshair(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.mainButton),this.controlContainer.appendChild(this.mainContainer);const w=document.createElement("TABLE");w.className="valhalla-table",this.mainContainer.appendChild(w);const z=Rf.createSelection(Dy.Costing,"Means of transport","costing",Dy.Costing.Walking,(F,G)=>F[G]);w.appendChild(z);const f=(s=this.map)===null||s===void 0?void 0:s.getCenter();if(f){const F=Rf.createTextbox("Longitude","lon-time",f.lng,!0);w.appendChild(F);const G=Rf.createTextbox("Latitude","lat-time",f.lat,!0);w.appendChild(G)}const h=this.valhalla.getContoursOption();for(let F=0;F<h.length;F+=1){const G=h[F],H=Rf.createTextbox(`Contour ${F+1} (min)`,`contour-time-${F}`,G.time,!1,"number");w.appendChild(H)}const D=document.createElement("button");D.textContent="Clear",D.classList.add("mapbox-valhalla-control-button"),D.addEventListener("click",()=>{this.valhalla.clearFeatures()}),this.mainContainer.appendChild(D);const N=document.createElement("button");return N.textContent="Calculate",N.classList.add("mapbox-valhalla-control-button"),N.addEventListener("click",()=>{const F=document.getElementById("mapbox-gl-valhalla-lon-time"),G=document.getElementById("mapbox-gl-valhalla-lat-time"),H=document.getElementById("mapbox-gl-valhalla-costing"),Pe=this.valhalla.getContoursOption();for(let ke=0;ke<Pe.length;ke+=1){const We=Pe[ke],je=document.getElementById(`mapbox-gl-valhalla-contour-time-${ke}`);We.time=Number(je.value)}this.valhalla.getIsochrone(Number(F.value),Number(G.value),Dy.ContourType.Time,H.value,Pe)}),this.mainContainer.appendChild(N),(g=this.map)===null||g===void 0||g.on("moveend",()=>{var F;const G=(F=this.map)===null||F===void 0?void 0:F.getCenter(),H=document.getElementById("mapbox-gl-valhalla-lon-time"),Pe=document.getElementById("mapbox-gl-valhalla-lat-time");G||(H.setAttribute("value",""),Pe.setAttribute("value",""));const ke=G,We=ke!=null&&ke.lng?ke.lng.toString():"";H.setAttribute("value",We);const je=ke!=null&&ke.lat?ke.lat.toString():"";Pe.setAttribute("value",je)}),r.appendChild(this.controlContainer),r}onDocumentClick(r){this.controlContainer&&!this.controlContainer.contains(r.target)&&this.hide()}hide(){this.mainContainer&&this.mainButton&&(this.mainContainer.style.display="none",this.mainButton.style.display="block",this.toggleCrosshair(!1))}destroy(){!this.mainContainer||!this.mainContainer.parentNode||!this.map||!this.mainButton||(this.mainButton.removeEventListener("click",this.onDocumentClick),this.mainContainer.parentNode.removeChild(this.mainContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.map=void 0)}toggleCrosshair(r){r===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new kA.default(this.map),this.crosshair.create())}}kg.default=zA;var Bg={};Object.defineProperty(Bg,"__esModule",{value:!0});const cv=ym,PA=xm,Ry=ep;class MA{constructor(r,s){this.map=r,this.valhalla=s,this.onDocumentClick=this.onDocumentClick.bind(this)}addTo(r){var s,g;this.map||console.error("map object is null"),this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.mainContainer=document.createElement("div"),this.mainContainer.classList.add("mapboxgl-valhalla-list"),this.mainButton=document.createElement("button"),this.mainButton.classList.add("mapboxgl-ctrl-icon"),this.mainButton.classList.add("mapboxgl-valhalla-distance-isochrone-control"),this.mainButton.addEventListener("click",()=>{this.mainButton.style.display="none",this.mainContainer.style.display="block",this.toggleCrosshair(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.mainButton),this.controlContainer.appendChild(this.mainContainer);const w=document.createElement("TABLE");w.className="valhalla-table",this.mainContainer.appendChild(w);const z=(s=this.map)===null||s===void 0?void 0:s.getCenter();if(z){const N=Ry.createTextbox("Longitude","lon-distance",z.lng,!0);w.appendChild(N);const F=Ry.createTextbox("Latitude","lat-distance",z.lat,!0);w.appendChild(F)}const f=this.valhalla.getContoursOption();for(let N=0;N<f.length;N+=1){const F=f[N],G=Ry.createTextbox(`Contour ${N+1} (km)`,`contour-distance-${N}`,F.distance,!1,"number");w.appendChild(G)}const h=document.createElement("button");h.textContent="Clear",h.classList.add("mapbox-valhalla-control-button"),h.addEventListener("click",()=>{this.valhalla.clearFeatures()}),this.mainContainer.appendChild(h);const D=document.createElement("button");return D.textContent="Calculate",D.classList.add("mapbox-valhalla-control-button"),D.addEventListener("click",()=>{const N=document.getElementById("mapbox-gl-valhalla-lon-distance"),F=document.getElementById("mapbox-gl-valhalla-lat-distance"),G=this.valhalla.getContoursOption();for(let H=0;H<G.length;H+=1){const Pe=G[H],ke=document.getElementById(`mapbox-gl-valhalla-contour-distance-${H}`);Pe.distance=Number(ke.value)}this.valhalla.getIsochrone(Number(N.value),Number(F.value),cv.ContourType.Distance,cv.Costing.Walking,G)}),this.mainContainer.appendChild(D),(g=this.map)===null||g===void 0||g.on("moveend",()=>{var N;const F=(N=this.map)===null||N===void 0?void 0:N.getCenter(),G=document.getElementById("mapbox-gl-valhalla-lon-distance"),H=document.getElementById("mapbox-gl-valhalla-lat-distance");F||(G.setAttribute("value",""),H.setAttribute("value",""));const Pe=F,ke=Pe!=null&&Pe.lng?Pe.lng.toString():"";G.setAttribute("value",ke);const We=Pe!=null&&Pe.lat?Pe.lat.toString():"";H.setAttribute("value",We)}),r.appendChild(this.controlContainer),r}onDocumentClick(r){this.controlContainer&&!this.controlContainer.contains(r.target)&&this.hide()}hide(){this.mainContainer&&this.mainButton&&(this.mainContainer.style.display="none",this.mainButton.style.display="block",this.toggleCrosshair(!1))}destroy(){!this.mainContainer||!this.mainContainer.parentNode||!this.map||!this.mainButton||(this.mainButton.removeEventListener("click",this.onDocumentClick),this.mainContainer.parentNode.removeChild(this.mainContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.map=void 0)}toggleCrosshair(r){r===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new PA.default(this.map),this.crosshair.create())}}Bg.default=MA;Object.defineProperty(Cg,"__esModule",{value:!0});const LA=kg,DA=Bg,RA=ym;class BA{constructor(r,s){this.options={Contours:[{time:5,distance:1,color:"ff0000"},{time:10,distance:3,color:"ffff00"},{time:15,distance:5,color:"0000ff"}]},this.url=r,s&&(this.options=Object.assign(this.options,s)),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}onAdd(r){return this.map=r,this.map&&(this.valhalla=new RA.default(this.map,this.url,this.options.Contours)),this.controlContainer=document.createElement("div"),this.timeIsochroneControl=new LA.default(this.map,this.valhalla),this.controlContainer=this.timeIsochroneControl.addTo(this.controlContainer),this.distanceIsochroneControl=new DA.default(this.map,this.valhalla),this.controlContainer=this.distanceIsochroneControl.addTo(this.controlContainer),document.addEventListener("click",this.onDocumentClick),this.controlContainer}onDocumentClick(r){this.controlContainer&&!this.controlContainer.contains(r.target)&&this.timeIsochroneControl&&this.distanceIsochroneControl&&(this.timeIsochroneControl.hide(),this.distanceIsochroneControl.hide())}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.timeIsochroneControl||!this.distanceIsochroneControl||(this.timeIsochroneControl.destroy(),this.distanceIsochroneControl.destroy(),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.map=void 0)}}Cg.default=BA;(function(u){Object.defineProperty(u,"__esModule",{value:!0}),u.MapboxValhallaControl=void 0;var r=Cg;Object.defineProperty(u,"MapboxValhallaControl",{enumerable:!0,get:function(){return r.default}})})(z0);function OA(u){let r,s;return{c(){r=gr("div"),s=gr("div"),this.h()},l(g){r=_r(g,"DIV",{class:!0});var w=Dr(r);s=_r(w,"DIV",{class:!0,id:!0}),Dr(s).forEach(Mt),w.forEach(Mt),this.h()},h(){jr(s,"class","map svelte-7ujfu6"),jr(s,"id","map"),jr(r,"class","map-wrap svelte-7ujfu6")},m(g,w){xi(g,r,w),fa(r,s),u[1](s)},p:vs,i:vs,o:vs,d(g){g&&Mt(r),u[1](null)}}}function FA(u,r,s){let g;xh(async()=>{const z=new $h.exports.Map({container:g,style:Ur.styles[0].uri,center:Ur.center,zoom:Ur.zoom,hash:!0,attributionControl:!1});if(z.addControl(new $h.exports.NavigationControl({}),"top-right"),z.addControl(new $h.exports.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"top-right"),z.addControl(new $h.exports.ScaleControl({maxWidth:80,unit:"metric"}),"bottom-left"),z.addControl(new $h.exports.AttributionControl({compact:!0}),"bottom-right"),z.addControl(new k0(Ur.styles),"top-right"),z.addControl(new XS(Ur.areaSwitcher.areas),"top-right"),Ur.elevation){const Pe=await(await h_(()=>import("./index-a03a1ef1.js").then(function(ke){return ke.i}),[])).default;z.addControl(new Pe(Ur.elevation.url,Ur.elevation.options),"top-right")}const{MaplibreExportControl:f,Size:h,PageOrientation:D,Format:N,DPI:F}=await h_(()=>import("./index-3133bc0e.js").then(function(Pe){return Pe.i}),[]);if(z.addControl(new f({PageSize:h.A4,PageOrientation:D.Landscape,Format:N.PNG,DPI:F[96],Crosshair:!0,PrintableArea:!0}),"top-right"),Ur.valhalla&&z.addControl(new z0.MapboxValhallaControl(Ur.valhalla.url,Ur.valhalla.options),"top-right"),Ur.popup&&z.addControl(new YS(Ur.popup.target)),!Ur.search)return;const G=await fetch(Ur.search.url).then(Pe=>Pe.json());function H(Pe){for(var ke=[],We=0;We<G.features.length;We++){var je=G.features[We];Ur.search.target.forEach(yt=>{var Ne=je.properties[yt];!Ne||Ne.toString().toLowerCase().search(Pe.toString().toLowerCase())!==-1&&(je.place_name=Ur.search.format(je.properties),je.center=je.geometry.coordinates,je.place_type=Ur.search.place_type,ke.push(je))})}return ke}z.addControl(new WS({localGeocoder:H,localGeocoderOnly:!0,zoom:Ur.search.zoom,placeholder:Ur.search.placeholder,mapboxgl:OE}),"top-left"),Qf.update(()=>z)});function w(z){an[z?"unshift":"push"](()=>{g=z,s(0,g)})}return[g,w]}class UA extends wn{constructor(r){super(),En(this,r,FA,OA,gn,{})}}function NA(u){let r,s;return r=new UA({}),{c(){pr(r.$$.fragment)},l(g){Rr(r.$$.fragment,g)},m(g,w){dr(r,g,w),s=!0},i(g){s||(ii(r.$$.fragment,g),s=!0)},o(g){ui(r.$$.fragment,g),s=!1},d(g){fr(r,g)}}}function jA(u){let r,s,g,w,z,f;function h(G){u[1](G)}let D={};u[0]!==void 0&&(D.drawerOpen=u[0]),r=new ab({props:D}),an.push(()=>Up(r,"drawerOpen",h));function N(G){u[2](G)}let F={$$slots:{default:[NA]},$$scope:{ctx:u}};return u[0]!==void 0&&(F.open=u[0]),w=new RE({props:F}),an.push(()=>Up(w,"open",N)),{c(){pr(r.$$.fragment),g=qo(),pr(w.$$.fragment)},l(G){Rr(r.$$.fragment,G),g=Go(G),Rr(w.$$.fragment,G)},m(G,H){dr(r,G,H),xi(G,g,H),dr(w,G,H),f=!0},p(G,[H]){const Pe={};!s&&H&1&&(s=!0,Pe.drawerOpen=G[0],Np(()=>s=!1)),r.$set(Pe);const ke={};H&8&&(ke.$$scope={dirty:H,ctx:G}),!z&&H&1&&(z=!0,ke.open=G[0],Np(()=>z=!1)),w.$set(ke)},i(G){f||(ii(r.$$.fragment,G),ii(w.$$.fragment,G),f=!0)},o(G){ui(r.$$.fragment,G),ui(w.$$.fragment,G),f=!1},d(G){fr(r,G),G&&Mt(g),fr(w,G)}}}function VA(u,r,s){let g=!1;function w(f){g=f,s(0,g)}function z(f){g=f,s(0,g)}return[g,w,z]}class WA extends wn{constructor(r){super(),En(this,r,VA,jA,gn,{})}}export{WA as _,SA as a,HA as b,Rl as c,BE as g,$h as m};
