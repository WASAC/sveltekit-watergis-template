var ux=Object.defineProperty;var l_=Object.getOwnPropertySymbols;var cx=Object.prototype.hasOwnProperty,hx=Object.prototype.propertyIsEnumerable;var u_=(u,r,s)=>r in u?ux(u,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[r]=s,bs=(u,r)=>{for(var s in r||(r={}))cx.call(r,s)&&u_(u,s,r[s]);if(l_)for(var s of l_(r))hx.call(r,s)&&u_(u,s,r[s]);return u};import{F as Oa,G as Fy,H as px,I as dx,S as gn,i as _n,s as vn,J as Zn,C as Ti,e as mr,c as yr,a as Vr,d as Bt,K as Dr,g as ki,L as Rr,M as Hn,N as Wn,O as Xn,z as Kn,P as Oo,q as li,o as pi,Q as Ca,R as cr,T as xo,v as Qu,U as bo,V as fx,W as hn,w as gr,l as an,x as qr,y as _r,A as ts,p as cl,B as vr,X as ra,r as Bo,Y as Vp,n as hl,Z as mx,E as Bl,b as jr,k as na,m as oa,_ as Lc,$ as gv,a0 as yx,a1 as Ta,a2 as gx,t as qp,h as Gp,j as $y,a3 as _x,a4 as vx,a5 as c_,a6 as h_,a7 as Nf,a8 as jf,a9 as xx}from"./index-92bc834f.js";import{r as bx,w as Yf,_ as p_}from"./preload-helper-c1d96b67.js";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Uy=function(u,r){return Uy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,y){s.__proto__=y}||function(s,y){for(var w in y)Object.prototype.hasOwnProperty.call(y,w)&&(s[w]=y[w])},Uy(u,r)};function pl(u,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");Uy(u,r);function s(){this.constructor=u}u.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}var Go=function(){return Go=Object.assign||function(r){for(var s,y=1,w=arguments.length;y<w;y++){s=arguments[y];for(var z in s)Object.prototype.hasOwnProperty.call(s,z)&&(r[z]=s[z])}return r},Go.apply(this,arguments)};function Md(u){var r=typeof Symbol=="function"&&Symbol.iterator,s=r&&u[r],y=0;if(s)return s.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&y>=u.length&&(u=void 0),{value:u&&u[y++],done:!u}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Rc=function(){function u(r){r===void 0&&(r={}),this.adapter=r}return Object.defineProperty(u,"cssClasses",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(u,"strings",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(u,"numbers",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(u,"defaultAdapter",{get:function(){return{}},enumerable:!1,configurable:!0}),u.prototype.init=function(){},u.prototype.destroy=function(){},u}();/**
 * @license
 * Copyright 2019 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function wx(u){return u===void 0&&(u=window),Ex(u)?{passive:!0}:!1}function Ex(u){u===void 0&&(u=window);var r=!1;try{var s={get passive(){return r=!0,!1}},y=function(){};u.document.addEventListener("test",y,s),u.document.removeEventListener("test",y,s)}catch{r=!1}return r}var Sx=Object.freeze(Object.defineProperty({__proto__:null,applyPassive:wx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function Ix(u,r){if(u.closest)return u.closest(r);for(var s=u;s;){if(_v(s,r))return s;s=s.parentElement}return null}function _v(u,r){var s=u.matches||u.webkitMatchesSelector||u.msMatchesSelector;return s.call(u,r)}function Tx(u){var r=u;if(r.offsetParent!==null)return r.scrollWidth;var s=r.cloneNode(!0);s.style.setProperty("position","absolute"),s.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(s);var y=s.scrollWidth;return document.documentElement.removeChild(s),y}var vv=Object.freeze(Object.defineProperty({__proto__:null,closest:Ix,matches:_v,estimateScrollWidth:Tx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Ax={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},Cx={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},d_={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300},Tf;function kx(u,r){r===void 0&&(r=!1);var s=u.CSS,y=Tf;if(typeof Tf=="boolean"&&!r)return Tf;var w=s&&typeof s.supports=="function";if(!w)return!1;var z=s.supports("--css-vars","yes"),f=s.supports("(--css-vars: yes)")&&s.supports("color","#00000000");return y=z||f,r||(Tf=y),y}function zx(u,r,s){if(!u)return{x:0,y:0};var y=r.x,w=r.y,z=y+s.left,f=w+s.top,p,L;if(u.type==="touchstart"){var N=u;p=N.changedTouches[0].pageX-z,L=N.changedTouches[0].pageY-f}else{var U=u;p=U.pageX-z,L=U.pageY-f}return{x:p,y:L}}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var f_=["touchstart","pointerdown","mousedown","keydown"],m_=["touchend","pointerup","mouseup","contextmenu"],Af=[],Px=function(u){pl(r,u);function r(s){var y=u.call(this,Go(Go({},r.defaultAdapter),s))||this;return y.activationAnimationHasEnded=!1,y.activationTimer=0,y.fgDeactivationRemovalTimer=0,y.fgScale="0",y.frame={width:0,height:0},y.initialSize=0,y.layoutFrame=0,y.maxRadius=0,y.unboundedCoords={left:0,top:0},y.activationState=y.defaultActivationState(),y.activationTimerCallback=function(){y.activationAnimationHasEnded=!0,y.runDeactivationUXLogicIfReady()},y.activateHandler=function(w){y.activateImpl(w)},y.deactivateHandler=function(){y.deactivateImpl()},y.focusHandler=function(){y.handleFocus()},y.blurHandler=function(){y.handleBlur()},y.resizeHandler=function(){y.layout()},y}return Object.defineProperty(r,"cssClasses",{get:function(){return Ax},enumerable:!1,configurable:!0}),Object.defineProperty(r,"strings",{get:function(){return Cx},enumerable:!1,configurable:!0}),Object.defineProperty(r,"numbers",{get:function(){return d_},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!1,configurable:!0}),r.prototype.init=function(){var s=this,y=this.supportsPressRipple();if(this.registerRootHandlers(y),y){var w=r.cssClasses,z=w.ROOT,f=w.UNBOUNDED;requestAnimationFrame(function(){s.adapter.addClass(z),s.adapter.isUnbounded()&&(s.adapter.addClass(f),s.layoutInternal())})}},r.prototype.destroy=function(){var s=this;if(this.supportsPressRipple()){this.activationTimer&&(clearTimeout(this.activationTimer),this.activationTimer=0,this.adapter.removeClass(r.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer&&(clearTimeout(this.fgDeactivationRemovalTimer),this.fgDeactivationRemovalTimer=0,this.adapter.removeClass(r.cssClasses.FG_DEACTIVATION));var y=r.cssClasses,w=y.ROOT,z=y.UNBOUNDED;requestAnimationFrame(function(){s.adapter.removeClass(w),s.adapter.removeClass(z),s.removeCssVars()})}this.deregisterRootHandlers(),this.deregisterDeactivationHandlers()},r.prototype.activate=function(s){this.activateImpl(s)},r.prototype.deactivate=function(){this.deactivateImpl()},r.prototype.layout=function(){var s=this;this.layoutFrame&&cancelAnimationFrame(this.layoutFrame),this.layoutFrame=requestAnimationFrame(function(){s.layoutInternal(),s.layoutFrame=0})},r.prototype.setUnbounded=function(s){var y=r.cssClasses.UNBOUNDED;s?this.adapter.addClass(y):this.adapter.removeClass(y)},r.prototype.handleFocus=function(){var s=this;requestAnimationFrame(function(){return s.adapter.addClass(r.cssClasses.BG_FOCUSED)})},r.prototype.handleBlur=function(){var s=this;requestAnimationFrame(function(){return s.adapter.removeClass(r.cssClasses.BG_FOCUSED)})},r.prototype.supportsPressRipple=function(){return this.adapter.browserSupportsCssVars()},r.prototype.defaultActivationState=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},r.prototype.registerRootHandlers=function(s){var y,w;if(s){try{for(var z=Md(f_),f=z.next();!f.done;f=z.next()){var p=f.value;this.adapter.registerInteractionHandler(p,this.activateHandler)}}catch(L){y={error:L}}finally{try{f&&!f.done&&(w=z.return)&&w.call(z)}finally{if(y)throw y.error}}this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler)}this.adapter.registerInteractionHandler("focus",this.focusHandler),this.adapter.registerInteractionHandler("blur",this.blurHandler)},r.prototype.registerDeactivationHandlers=function(s){var y,w;if(s.type==="keydown")this.adapter.registerInteractionHandler("keyup",this.deactivateHandler);else try{for(var z=Md(m_),f=z.next();!f.done;f=z.next()){var p=f.value;this.adapter.registerDocumentInteractionHandler(p,this.deactivateHandler)}}catch(L){y={error:L}}finally{try{f&&!f.done&&(w=z.return)&&w.call(z)}finally{if(y)throw y.error}}},r.prototype.deregisterRootHandlers=function(){var s,y;try{for(var w=Md(f_),z=w.next();!z.done;z=w.next()){var f=z.value;this.adapter.deregisterInteractionHandler(f,this.activateHandler)}}catch(p){s={error:p}}finally{try{z&&!z.done&&(y=w.return)&&y.call(w)}finally{if(s)throw s.error}}this.adapter.deregisterInteractionHandler("focus",this.focusHandler),this.adapter.deregisterInteractionHandler("blur",this.blurHandler),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler)},r.prototype.deregisterDeactivationHandlers=function(){var s,y;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler);try{for(var w=Md(m_),z=w.next();!z.done;z=w.next()){var f=z.value;this.adapter.deregisterDocumentInteractionHandler(f,this.deactivateHandler)}}catch(p){s={error:p}}finally{try{z&&!z.done&&(y=w.return)&&y.call(w)}finally{if(s)throw s.error}}},r.prototype.removeCssVars=function(){var s=this,y=r.strings,w=Object.keys(y);w.forEach(function(z){z.indexOf("VAR_")===0&&s.adapter.updateCssVariable(y[z],null)})},r.prototype.activateImpl=function(s){var y=this;if(!this.adapter.isSurfaceDisabled()){var w=this.activationState;if(!w.isActivated){var z=this.previousActivationEvent,f=z&&s!==void 0&&z.type!==s.type;if(!f){w.isActivated=!0,w.isProgrammatic=s===void 0,w.activationEvent=s,w.wasActivatedByPointer=w.isProgrammatic?!1:s!==void 0&&(s.type==="mousedown"||s.type==="touchstart"||s.type==="pointerdown");var p=s!==void 0&&Af.length>0&&Af.some(function(L){return y.adapter.containsEventTarget(L)});if(p){this.resetActivationState();return}s!==void 0&&(Af.push(s.target),this.registerDeactivationHandlers(s)),w.wasElementMadeActive=this.checkElementMadeActive(s),w.wasElementMadeActive&&this.animateActivation(),requestAnimationFrame(function(){Af=[],!w.wasElementMadeActive&&s!==void 0&&(s.key===" "||s.keyCode===32)&&(w.wasElementMadeActive=y.checkElementMadeActive(s),w.wasElementMadeActive&&y.animateActivation()),w.wasElementMadeActive||(y.activationState=y.defaultActivationState())})}}}},r.prototype.checkElementMadeActive=function(s){return s!==void 0&&s.type==="keydown"?this.adapter.isSurfaceActive():!0},r.prototype.animateActivation=function(){var s=this,y=r.strings,w=y.VAR_FG_TRANSLATE_START,z=y.VAR_FG_TRANSLATE_END,f=r.cssClasses,p=f.FG_DEACTIVATION,L=f.FG_ACTIVATION,N=r.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal();var U="",G="";if(!this.adapter.isUnbounded()){var X=this.getFgTranslationCoordinates(),Se=X.startPoint,ge=X.endPoint;U=Se.x+"px, "+Se.y+"px",G=ge.x+"px, "+ge.y+"px"}this.adapter.updateCssVariable(w,U),this.adapter.updateCssVariable(z,G),clearTimeout(this.activationTimer),clearTimeout(this.fgDeactivationRemovalTimer),this.rmBoundedActivationClasses(),this.adapter.removeClass(p),this.adapter.computeBoundingRect(),this.adapter.addClass(L),this.activationTimer=setTimeout(function(){s.activationTimerCallback()},N)},r.prototype.getFgTranslationCoordinates=function(){var s=this.activationState,y=s.activationEvent,w=s.wasActivatedByPointer,z;w?z=zx(y,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):z={x:this.frame.width/2,y:this.frame.height/2},z={x:z.x-this.initialSize/2,y:z.y-this.initialSize/2};var f={x:this.frame.width/2-this.initialSize/2,y:this.frame.height/2-this.initialSize/2};return{startPoint:z,endPoint:f}},r.prototype.runDeactivationUXLogicIfReady=function(){var s=this,y=r.cssClasses.FG_DEACTIVATION,w=this.activationState,z=w.hasDeactivationUXRun,f=w.isActivated,p=z||!f;p&&this.activationAnimationHasEnded&&(this.rmBoundedActivationClasses(),this.adapter.addClass(y),this.fgDeactivationRemovalTimer=setTimeout(function(){s.adapter.removeClass(y)},d_.FG_DEACTIVATION_MS))},r.prototype.rmBoundedActivationClasses=function(){var s=r.cssClasses.FG_ACTIVATION;this.adapter.removeClass(s),this.activationAnimationHasEnded=!1,this.adapter.computeBoundingRect()},r.prototype.resetActivationState=function(){var s=this;this.previousActivationEvent=this.activationState.activationEvent,this.activationState=this.defaultActivationState(),setTimeout(function(){return s.previousActivationEvent=void 0},r.numbers.TAP_DELAY_MS)},r.prototype.deactivateImpl=function(){var s=this,y=this.activationState;if(!!y.isActivated){var w=Go({},y);y.isProgrammatic?(requestAnimationFrame(function(){s.animateDeactivation(w)}),this.resetActivationState()):(this.deregisterDeactivationHandlers(),requestAnimationFrame(function(){s.activationState.hasDeactivationUXRun=!0,s.animateDeactivation(w),s.resetActivationState()}))}},r.prototype.animateDeactivation=function(s){var y=s.wasActivatedByPointer,w=s.wasElementMadeActive;(y||w)&&this.runDeactivationUXLogicIfReady()},r.prototype.layoutInternal=function(){var s=this;this.frame=this.adapter.computeBoundingRect();var y=Math.max(this.frame.height,this.frame.width),w=function(){var f=Math.sqrt(Math.pow(s.frame.width,2)+Math.pow(s.frame.height,2));return f+r.numbers.PADDING};this.maxRadius=this.adapter.isUnbounded()?y:w();var z=Math.floor(y*r.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&z%2!==0?this.initialSize=z-1:this.initialSize=z,this.fgScale=""+this.maxRadius/this.initialSize,this.updateLayoutCssVars()},r.prototype.updateLayoutCssVars=function(){var s=r.strings,y=s.VAR_FG_SIZE,w=s.VAR_LEFT,z=s.VAR_TOP,f=s.VAR_FG_SCALE;this.adapter.updateCssVariable(y,this.initialSize+"px"),this.adapter.updateCssVariable(f,this.fgScale),this.adapter.isUnbounded()&&(this.unboundedCoords={left:Math.round(this.frame.width/2-this.initialSize/2),top:Math.round(this.frame.height/2-this.initialSize/2)},this.adapter.updateCssVariable(w,this.unboundedCoords.left+"px"),this.adapter.updateCssVariable(z,this.unboundedCoords.top+"px"))},r}(Rc);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var $h={FIXED_CLASS:"mdc-top-app-bar--fixed",FIXED_SCROLLED_CLASS:"mdc-top-app-bar--fixed-scrolled",SHORT_CLASS:"mdc-top-app-bar--short",SHORT_COLLAPSED_CLASS:"mdc-top-app-bar--short-collapsed",SHORT_HAS_ACTION_ITEM_CLASS:"mdc-top-app-bar--short-has-action-item"},Rf={DEBOUNCE_THROTTLE_RESIZE_TIME_MS:100,MAX_TOP_APP_BAR_HEIGHT:128},Mx={ACTION_ITEM_SELECTOR:".mdc-top-app-bar__action-item",NAVIGATION_EVENT:"MDCTopAppBar:nav",NAVIGATION_ICON_SELECTOR:".mdc-top-app-bar__navigation-icon",ROOT_SELECTOR:".mdc-top-app-bar",TITLE_SELECTOR:".mdc-top-app-bar__title"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Qy=function(u){pl(r,u);function r(s){return u.call(this,Go(Go({},r.defaultAdapter),s))||this}return Object.defineProperty(r,"strings",{get:function(){return Mx},enumerable:!1,configurable:!0}),Object.defineProperty(r,"cssClasses",{get:function(){return $h},enumerable:!1,configurable:!0}),Object.defineProperty(r,"numbers",{get:function(){return Rf},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},getTopAppBarHeight:function(){return 0},notifyNavigationIconClicked:function(){},getViewportScrollY:function(){return 0},getTotalActionItems:function(){return 0}}},enumerable:!1,configurable:!0}),r.prototype.handleTargetScroll=function(){},r.prototype.handleWindowResize=function(){},r.prototype.handleNavigationClick=function(){this.adapter.notifyNavigationIconClicked()},r}(Rc);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Cf=0,xv=function(u){pl(r,u);function r(s){var y=u.call(this,s)||this;return y.wasDocked=!0,y.isDockedShowing=!0,y.currentAppBarOffsetTop=0,y.isCurrentlyBeingResized=!1,y.resizeThrottleId=Cf,y.resizeDebounceId=Cf,y.lastScrollPosition=y.adapter.getViewportScrollY(),y.topAppBarHeight=y.adapter.getTopAppBarHeight(),y}return r.prototype.destroy=function(){u.prototype.destroy.call(this),this.adapter.setStyle("top","")},r.prototype.handleTargetScroll=function(){var s=Math.max(this.adapter.getViewportScrollY(),0),y=s-this.lastScrollPosition;this.lastScrollPosition=s,this.isCurrentlyBeingResized||(this.currentAppBarOffsetTop-=y,this.currentAppBarOffsetTop>0?this.currentAppBarOffsetTop=0:Math.abs(this.currentAppBarOffsetTop)>this.topAppBarHeight&&(this.currentAppBarOffsetTop=-this.topAppBarHeight),this.moveTopAppBar())},r.prototype.handleWindowResize=function(){var s=this;this.resizeThrottleId||(this.resizeThrottleId=setTimeout(function(){s.resizeThrottleId=Cf,s.throttledResizeHandler()},Rf.DEBOUNCE_THROTTLE_RESIZE_TIME_MS)),this.isCurrentlyBeingResized=!0,this.resizeDebounceId&&clearTimeout(this.resizeDebounceId),this.resizeDebounceId=setTimeout(function(){s.handleTargetScroll(),s.isCurrentlyBeingResized=!1,s.resizeDebounceId=Cf},Rf.DEBOUNCE_THROTTLE_RESIZE_TIME_MS)},r.prototype.checkForUpdate=function(){var s=-this.topAppBarHeight,y=this.currentAppBarOffsetTop<0,w=this.currentAppBarOffsetTop>s,z=y&&w;if(z)this.wasDocked=!1;else if(this.wasDocked){if(this.isDockedShowing!==w)return this.isDockedShowing=w,!0}else return this.wasDocked=!0,!0;return z},r.prototype.moveTopAppBar=function(){if(this.checkForUpdate()){var s=this.currentAppBarOffsetTop;Math.abs(s)>=this.topAppBarHeight&&(s=-Rf.MAX_TOP_APP_BAR_HEIGHT),this.adapter.setStyle("top",s+"px")}},r.prototype.throttledResizeHandler=function(){var s=this.adapter.getTopAppBarHeight();this.topAppBarHeight!==s&&(this.wasDocked=!1,this.currentAppBarOffsetTop-=this.topAppBarHeight-s,this.topAppBarHeight=s),this.handleTargetScroll()},r}(Qy);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Lx=function(u){pl(r,u);function r(){var s=u!==null&&u.apply(this,arguments)||this;return s.wasScrolled=!1,s}return r.prototype.handleTargetScroll=function(){var s=this.adapter.getViewportScrollY();s<=0?this.wasScrolled&&(this.adapter.removeClass($h.FIXED_SCROLLED_CLASS),this.wasScrolled=!1):this.wasScrolled||(this.adapter.addClass($h.FIXED_SCROLLED_CLASS),this.wasScrolled=!0)},r}(xv);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Dx=function(u){pl(r,u);function r(s){var y=u.call(this,s)||this;return y.collapsed=!1,y.isAlwaysCollapsed=!1,y}return Object.defineProperty(r.prototype,"isCollapsed",{get:function(){return this.collapsed},enumerable:!1,configurable:!0}),r.prototype.init=function(){u.prototype.init.call(this),this.adapter.getTotalActionItems()>0&&this.adapter.addClass($h.SHORT_HAS_ACTION_ITEM_CLASS),this.setAlwaysCollapsed(this.adapter.hasClass($h.SHORT_COLLAPSED_CLASS))},r.prototype.setAlwaysCollapsed=function(s){this.isAlwaysCollapsed=!!s,this.isAlwaysCollapsed?this.collapse():this.maybeCollapseBar()},r.prototype.getAlwaysCollapsed=function(){return this.isAlwaysCollapsed},r.prototype.handleTargetScroll=function(){this.maybeCollapseBar()},r.prototype.maybeCollapseBar=function(){if(!this.isAlwaysCollapsed){var s=this.adapter.getViewportScrollY();s<=0?this.collapsed&&this.uncollapse():this.collapsed||this.collapse()}},r.prototype.uncollapse=function(){this.adapter.removeClass($h.SHORT_COLLAPSED_CLASS),this.collapsed=!1},r.prototype.collapse=function(){this.adapter.addClass($h.SHORT_COLLAPSED_CLASS),this.collapsed=!0},r}(Qy);function Ln(u){return Object.entries(u).filter(([r,s])=>r!==""&&s).map(([r])=>r).join(" ")}function Aa(u,r,s,y={bubbles:!0},w=!1){if(typeof Event!="undefined"&&u){const z=new CustomEvent(r,Object.assign(Object.assign({},y),{detail:s}));if(u==null||u.dispatchEvent(z),w&&r.startsWith("SMUI")){const f=new CustomEvent(r.replace(/^SMUI/g,()=>"MDC"),Object.assign(Object.assign({},y),{detail:s}));u==null||u.dispatchEvent(f),f.defaultPrevented&&z.preventDefault()}return z}}function Vf(u,r){let s=Object.getOwnPropertyNames(u);const y={};for(let w=0;w<s.length;w++){const z=s[w],f=z.indexOf("$");f!==-1&&r.indexOf(z.substring(0,f+1))!==-1||r.indexOf(z)===-1&&(y[z]=u[z])}return y}const y_=/^[a-z]+(?::(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/,Rx=/^[^$]+(?:\$(?:preventDefault|stopPropagation|passive|nonpassive|capture|once|self))+$/;function wo(u){let r,s=[];u.$on=(w,z)=>{let f=w,p=()=>{};return r?p=r(f,z):s.push([f,z]),f.match(y_)&&console&&console.warn('Event modifiers in SMUI now use "$" instead of ":", so that all events can be bound with modifiers. Please update your event binding: ',f),()=>{p()}};function y(w){Fy(u,w)}return w=>{const z=[],f={};r=(p,L)=>{let N=p,U=L,G=!1;const X=N.match(y_),Se=N.match(Rx),ge=X||Se;if(N.match(/^SMUI:\w+:/)){const ft=N.split(":");let Ue="";for(let Re=0;Re<ft.length;Re++)Ue+=Re===ft.length-1?":"+ft[Re]:ft[Re].split("-").map(st=>st.slice(0,1).toUpperCase()+st.slice(1)).join("");console.warn(`The event ${N.split("$")[0]} has been renamed to ${Ue.split("$")[0]}.`),N=Ue}if(ge){const ft=N.split(X?":":"$");N=ft[0];const Ue=Object.fromEntries(ft.slice(1).map(Re=>[Re,!0]));Ue.passive&&(G=G||{},G.passive=!0),Ue.nonpassive&&(G=G||{},G.passive=!1),Ue.capture&&(G=G||{},G.capture=!0),Ue.once&&(G=G||{},G.once=!0),Ue.preventDefault&&(U=px(U)),Ue.stopPropagation&&(U=dx(U))}const De=Oa(w,N,U,G),Le=()=>{De();const ft=z.indexOf(Le);ft>-1&&z.splice(ft,1)};return z.push(Le),N in f||(f[N]=Oa(w,N,y)),Le};for(let p=0;p<s.length;p++)r(s[p][0],s[p][1]);return{destroy:()=>{for(let p=0;p<z.length;p++)z[p]();for(let p of Object.entries(f))p[1]()}}}}function qf(u,r){let s=Object.getOwnPropertyNames(u);const y={};for(let w=0;w<s.length;w++){const z=s[w];z.substring(0,r.length)===r&&(y[z.substring(r.length)]=u[z])}return y}function aa(u,r){let s=[];if(r)for(let y=0;y<r.length;y++){const w=r[y],z=Array.isArray(w)?w[0]:w;Array.isArray(w)&&w.length>1?s.push(z(u,w[1])):s.push(z(u))}return{update(y){if((y&&y.length||0)!=s.length)throw new Error("You must not change the length of an actions array.");if(y)for(let w=0;w<y.length;w++){const z=s[w];if(z&&z.update){const f=y[w];Array.isArray(f)&&f.length>1?z.update(f[1]):z.update()}}},destroy(){for(let y=0;y<s.length;y++){const w=s[y];w&&w.destroy&&w.destroy()}}}}const{window:g_}=fx;function Bx(u){let r,s,y,w,z,f,p;const L=u[22].default,N=Zn(L,u,u[21],null);let U=[{class:s=Ln(bs({[u[2]]:!0,"mdc-top-app-bar":!0,"mdc-top-app-bar--short":u[4]==="short","mdc-top-app-bar--short-collapsed":u[0],"mdc-top-app-bar--fixed":u[4]==="fixed","smui-top-app-bar--static":u[4]==="static","smui-top-app-bar--color-secondary":u[5]==="secondary","mdc-top-app-bar--prominent":u[6],"mdc-top-app-bar--dense":u[7]},u[11]))},{style:y=Object.entries(u[12]).map(__).concat([u[3]]).join(" ")},u[15]],G={};for(let X=0;X<U.length;X+=1)G=Ti(G,U[X]);return{c(){r=mr("header"),N&&N.c(),this.h()},l(X){r=yr(X,"HEADER",{class:!0,style:!0});var Se=Vr(r);N&&N.l(Se),Se.forEach(Bt),this.h()},h(){Dr(r,G)},m(X,Se){ki(X,r,Se),N&&N.m(r,null),u[25](r),z=!0,f||(p=[Oa(g_,"resize",u[23]),Oa(g_,"scroll",u[24]),Rr(w=aa.call(null,r,u[1])),Rr(u[13].call(null,r)),Oa(r,"SMUITopAppBarIconButton:nav",u[26])],f=!0)},p(X,Se){N&&N.p&&(!z||Se[0]&2097152)&&Hn(N,L,X,X[21],z?Xn(L,X[21],Se,null):Wn(X[21]),null),Dr(r,G=Kn(U,[(!z||Se[0]&2293&&s!==(s=Ln(bs({[X[2]]:!0,"mdc-top-app-bar":!0,"mdc-top-app-bar--short":X[4]==="short","mdc-top-app-bar--short-collapsed":X[0],"mdc-top-app-bar--fixed":X[4]==="fixed","smui-top-app-bar--static":X[4]==="static","smui-top-app-bar--color-secondary":X[5]==="secondary","mdc-top-app-bar--prominent":X[6],"mdc-top-app-bar--dense":X[7]},X[11]))))&&{class:s},(!z||Se[0]&4104&&y!==(y=Object.entries(X[12]).map(__).concat([X[3]]).join(" ")))&&{style:y},Se[0]&32768&&X[15]])),w&&Oo(w.update)&&Se[0]&2&&w.update.call(null,X[1])},i(X){z||(li(N,X),z=!0)},o(X){pi(N,X),z=!1},d(X){X&&Bt(r),N&&N.d(X),u[25](null),f=!1,Ca(p)}}}const __=([u,r])=>`${u}: ${r};`;function Ox(u,r,s){const y=["use","class","style","variant","color","collapsed","prominent","dense","scrollTarget","getPropStore","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r;const p=wo(xo());let L=()=>{};function N(Gt){return Gt===L}let{use:U=[]}=r,{class:G=""}=r,{style:X=""}=r,{variant:Se="standard"}=r,{color:ge="primary"}=r,{collapsed:De=L}=r;const Le=!N(De)&&!!De;N(De)&&(De=!1);let{prominent:ft=!1}=r,{dense:Ue=!1}=r,{scrollTarget:Re=void 0}=r,st,ut,ht={},at={},$t,xt=bx({variant:Se,prominent:ft,dense:Ue},Gt=>{s(18,$t=Gt)}),qt,_i=Se;Qu(()=>(s(9,ut=Ri()),ut.init(),()=>{ut.destroy()}));function Ri(){const Gt={static:Qy,short:Dx,fixed:Lx}[Se]||xv;return new Gt({hasClass:Ht,addClass:Qt,removeClass:Si,setStyle:bt,getTopAppBarHeight:()=>st.clientHeight,notifyNavigationIconClicked:()=>Aa(st,"SMUITopAppBar:nav",void 0,void 0,!0),getViewportScrollY:()=>Re==null?window.pageYOffset:Re.scrollTop,getTotalActionItems:()=>st.querySelectorAll(".mdc-top-app-bar__action-item").length})}function Ht(Gt){return Gt in ht?ht[Gt]:bi().classList.contains(Gt)}function Qt(Gt){ht[Gt]||s(11,ht[Gt]=!0,ht)}function Si(Gt){(!(Gt in ht)||ht[Gt])&&s(11,ht[Gt]=!1,ht)}function bt(Gt,Ji){at[Gt]!=Ji&&(Ji===""||Ji==null?(delete at[Gt],s(12,at),s(20,_i),s(4,Se),s(9,ut)):s(12,at[Gt]=Ji,at))}function Fi(){ut&&(ut.handleTargetScroll(),Se==="short"&&s(0,De="isCollapsed"in ut&&ut.isCollapsed))}function Dt(){return xt}function bi(){return st}const zt=()=>Se!=="short"&&Se!=="fixed"&&ut&&ut.handleWindowResize(),Yt=()=>Re==null&&Fi();function Et(Gt){hn[Gt?"unshift":"push"](()=>{st=Gt,s(10,st)})}const xi=()=>ut&&ut.handleNavigationClick();return u.$$set=Gt=>{r=Ti(Ti({},r),bo(Gt)),s(15,w=cr(r,y)),"use"in Gt&&s(1,U=Gt.use),"class"in Gt&&s(2,G=Gt.class),"style"in Gt&&s(3,X=Gt.style),"variant"in Gt&&s(4,Se=Gt.variant),"color"in Gt&&s(5,ge=Gt.color),"collapsed"in Gt&&s(0,De=Gt.collapsed),"prominent"in Gt&&s(6,ft=Gt.prominent),"dense"in Gt&&s(7,Ue=Gt.dense),"scrollTarget"in Gt&&s(8,Re=Gt.scrollTarget),"$$scope"in Gt&&s(21,f=Gt.$$scope)},u.$$.update=()=>{u.$$.dirty[0]&262352&&$t&&$t({variant:Se,prominent:ft,dense:Ue}),u.$$.dirty[0]&1049104&&_i!==Se&&ut&&(s(20,_i=Se),ut.destroy(),s(11,ht={}),s(12,at={}),s(9,ut=Ri()),ut.init()),u.$$.dirty[0]&528&&ut&&Se==="short"&&"setAlwaysCollapsed"in ut&&ut.setAlwaysCollapsed(Le),u.$$.dirty[0]&524544&&qt!==Re&&(qt&&qt.removeEventListener("scroll",Fi),Re&&Re.addEventListener("scroll",Fi),s(19,qt=Re))},[De,U,G,X,Se,ge,ft,Ue,Re,ut,st,ht,at,p,Fi,w,Dt,bi,$t,qt,_i,f,z,zt,Yt,Et,xi]}class Fx extends gn{constructor(r){super(),_n(this,r,Ox,Bx,vn,{use:1,class:2,style:3,variant:4,color:5,collapsed:0,prominent:6,dense:7,scrollTarget:8,getPropStore:16,getElement:17},null,[-1,-1])}get getPropStore(){return this.$$.ctx[16]}get getElement(){return this.$$.ctx[17]}}function Ux(u){let r,s,y,w,z;const f=u[6].default,p=Zn(f,u,u[5],null);let L=[u[3]],N={};for(let U=0;U<L.length;U+=1)N=Ti(N,L[U]);return{c(){r=mr("div"),p&&p.c(),this.h()},l(U){r=yr(U,"DIV",{});var G=Vr(r);p&&p.l(G),G.forEach(Bt),this.h()},h(){Dr(r,N)},m(U,G){ki(U,r,G),p&&p.m(r,null),u[7](r),y=!0,w||(z=[Rr(s=aa.call(null,r,u[0])),Rr(u[2].call(null,r))],w=!0)},p(U,[G]){p&&p.p&&(!y||G&32)&&Hn(p,f,U,U[5],y?Xn(f,U[5],G,null):Wn(U[5]),null),Dr(r,N=Kn(L,[G&8&&U[3]])),s&&Oo(s.update)&&G&1&&s.update.call(null,U[0])},i(U){y||(li(p,U),y=!0)},o(U){pi(p,U),y=!1},d(U){U&&Bt(r),p&&p.d(U),u[7](null),w=!1,Ca(z)}}}function Nx(u,r,s){const y=["use","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r,{use:p=[]}=r;const L=wo(xo());let N;function U(){return N}function G(X){hn[X?"unshift":"push"](()=>{N=X,s(1,N)})}return u.$$set=X=>{r=Ti(Ti({},r),bo(X)),s(3,w=cr(r,y)),"use"in X&&s(0,p=X.use),"$$scope"in X&&s(5,f=X.$$scope)},[p,N,L,w,U,f,z,G]}class bv extends gn{constructor(r){super(),_n(this,r,Nx,Ux,vn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function jx(u){let r;const s=u[10].default,y=Zn(s,u,u[12],null);return{c(){y&&y.c()},l(w){y&&y.l(w)},m(w,z){y&&y.m(w,z),r=!0},p(w,z){y&&y.p&&(!r||z&4096)&&Hn(y,s,w,w[12],r?Xn(s,w[12],z,null):Wn(w[12]),null)},i(w){r||(li(y,w),r=!0)},o(w){pi(y,w),r=!1},d(w){y&&y.d(w)}}}function Vx(u){let r,s,y;const w=[{use:[u[7],...u[0]]},{class:Ln(bs({[u[1]]:!0,[u[5]]:!0},u[4]))},u[6],u[8]];var z=u[2];function f(p){let L={$$slots:{default:[jx]},$$scope:{ctx:p}};for(let N=0;N<w.length;N+=1)L=Ti(L,w[N]);return{props:L}}return z&&(r=new z(f(u)),u[11](r)),{c(){r&&gr(r.$$.fragment),s=an()},l(p){r&&qr(r.$$.fragment,p),s=an()},m(p,L){r&&_r(r,p,L),ki(p,s,L),y=!0},p(p,[L]){const N=L&499?Kn(w,[L&129&&{use:[p[7],...p[0]]},L&50&&{class:Ln(bs({[p[1]]:!0,[p[5]]:!0},p[4]))},L&64&&ts(p[6]),L&256&&ts(p[8])]):{};if(L&4096&&(N.$$scope={dirty:L,ctx:p}),z!==(z=p[2])){if(r){hl();const U=r;pi(U.$$.fragment,1,0,()=>{vr(U,1)}),cl()}z?(r=new z(f(p)),p[11](r),gr(r.$$.fragment),li(r.$$.fragment,1),_r(r,s.parentNode,s)):r=null}else z&&r.$set(N)},i(p){y||(r&&li(r.$$.fragment,p),y=!0)},o(p){r&&pi(r.$$.fragment,p),y=!1},d(p){u[11](null),p&&Bt(s),r&&vr(r,p)}}}const mh={component:bv,class:"",classMap:{},contexts:{},props:{}};function qx(u,r,s){const y=["use","class","component","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r,{use:p=[]}=r,{class:L=""}=r,N;const U=mh.class,G={},X=[],Se=mh.contexts,ge=mh.props;let{component:De=mh.component}=r;Object.entries(mh.classMap).forEach(([Re,st])=>{const ut=ra(st);ut&&"subscribe"in ut&&X.push(ut.subscribe(ht=>{s(4,G[Re]=ht,G)}))});const Le=wo(xo());for(let Re in Se)Se.hasOwnProperty(Re)&&Bo(Re,Se[Re]);Vp(()=>{for(const Re of X)Re()});function ft(){return N.getElement()}function Ue(Re){hn[Re?"unshift":"push"](()=>{N=Re,s(3,N)})}return u.$$set=Re=>{r=Ti(Ti({},r),bo(Re)),s(8,w=cr(r,y)),"use"in Re&&s(0,p=Re.use),"class"in Re&&s(1,L=Re.class),"component"in Re&&s(2,De=Re.component),"$$scope"in Re&&s(12,f=Re.$$scope)},[p,L,De,N,G,U,ge,Le,w,ft,z,Ue,f]}class Gx extends gn{constructor(r){super(),_n(this,r,qx,Vx,vn,{use:0,class:1,component:2,getElement:9})}get getElement(){return this.$$.ctx[9]}}const v_=Object.assign({},mh);function dl(u){return new Proxy(Gx,{construct:function(r,s){return Object.assign(mh,v_,u),new r(...s)},get:function(r,s){return Object.assign(mh,v_,u),r[s]}})}function Zx(u){let r,s,y,w,z;const f=u[7].default,p=Zn(f,u,u[6],null);let L=[{href:u[1]},u[4]],N={};for(let U=0;U<L.length;U+=1)N=Ti(N,L[U]);return{c(){r=mr("a"),p&&p.c(),this.h()},l(U){r=yr(U,"A",{href:!0});var G=Vr(r);p&&p.l(G),G.forEach(Bt),this.h()},h(){Dr(r,N)},m(U,G){ki(U,r,G),p&&p.m(r,null),u[8](r),y=!0,w||(z=[Rr(s=aa.call(null,r,u[0])),Rr(u[3].call(null,r))],w=!0)},p(U,[G]){p&&p.p&&(!y||G&64)&&Hn(p,f,U,U[6],y?Xn(f,U[6],G,null):Wn(U[6]),null),Dr(r,N=Kn(L,[(!y||G&2)&&{href:U[1]},G&16&&U[4]])),s&&Oo(s.update)&&G&1&&s.update.call(null,U[0])},i(U){y||(li(p,U),y=!0)},o(U){pi(p,U),y=!1},d(U){U&&Bt(r),p&&p.d(U),u[8](null),w=!1,Ca(z)}}}function Hx(u,r,s){const y=["use","href","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r,{use:p=[]}=r,{href:L="javascript:void(0);"}=r;const N=wo(xo());let U;function G(){return U}function X(Se){hn[Se?"unshift":"push"](()=>{U=Se,s(2,U)})}return u.$$set=Se=>{r=Ti(Ti({},r),bo(Se)),s(4,w=cr(r,y)),"use"in Se&&s(0,p=Se.use),"href"in Se&&s(1,L=Se.href),"$$scope"in Se&&s(6,f=Se.$$scope)},[p,L,U,N,w,G,f,z,X]}class Wx extends gn{constructor(r){super(),_n(this,r,Hx,Zx,vn,{use:0,href:1,getElement:5})}get getElement(){return this.$$.ctx[5]}}function Xx(u){let r,s,y,w,z;const f=u[6].default,p=Zn(f,u,u[5],null);let L=[u[3]],N={};for(let U=0;U<L.length;U+=1)N=Ti(N,L[U]);return{c(){r=mr("button"),p&&p.c(),this.h()},l(U){r=yr(U,"BUTTON",{});var G=Vr(r);p&&p.l(G),G.forEach(Bt),this.h()},h(){Dr(r,N)},m(U,G){ki(U,r,G),p&&p.m(r,null),r.autofocus&&r.focus(),u[7](r),y=!0,w||(z=[Rr(s=aa.call(null,r,u[0])),Rr(u[2].call(null,r))],w=!0)},p(U,[G]){p&&p.p&&(!y||G&32)&&Hn(p,f,U,U[5],y?Xn(f,U[5],G,null):Wn(U[5]),null),Dr(r,N=Kn(L,[G&8&&U[3]])),s&&Oo(s.update)&&G&1&&s.update.call(null,U[0])},i(U){y||(li(p,U),y=!0)},o(U){pi(p,U),y=!1},d(U){U&&Bt(r),p&&p.d(U),u[7](null),w=!1,Ca(z)}}}function Kx(u,r,s){const y=["use","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r,{use:p=[]}=r;const L=wo(xo());let N;function U(){return N}function G(X){hn[X?"unshift":"push"](()=>{N=X,s(1,N)})}return u.$$set=X=>{r=Ti(Ti({},r),bo(X)),s(3,w=cr(r,y)),"use"in X&&s(0,p=X.use),"$$scope"in X&&s(5,f=X.$$scope)},[p,N,L,w,U,f,z,G]}class Jx extends gn{constructor(r){super(),_n(this,r,Kx,Xx,vn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function Yx(u){let r,s,y,w,z;const f=u[6].default,p=Zn(f,u,u[5],null);let L=[u[3]],N={};for(let U=0;U<L.length;U+=1)N=Ti(N,L[U]);return{c(){r=mr("h1"),p&&p.c(),this.h()},l(U){r=yr(U,"H1",{});var G=Vr(r);p&&p.l(G),G.forEach(Bt),this.h()},h(){Dr(r,N)},m(U,G){ki(U,r,G),p&&p.m(r,null),u[7](r),y=!0,w||(z=[Rr(s=aa.call(null,r,u[0])),Rr(u[2].call(null,r))],w=!0)},p(U,[G]){p&&p.p&&(!y||G&32)&&Hn(p,f,U,U[5],y?Xn(f,U[5],G,null):Wn(U[5]),null),Dr(r,N=Kn(L,[G&8&&U[3]])),s&&Oo(s.update)&&G&1&&s.update.call(null,U[0])},i(U){y||(li(p,U),y=!0)},o(U){pi(p,U),y=!1},d(U){U&&Bt(r),p&&p.d(U),u[7](null),w=!1,Ca(z)}}}function $x(u,r,s){const y=["use","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r,{use:p=[]}=r;const L=wo(xo());let N;function U(){return N}function G(X){hn[X?"unshift":"push"](()=>{N=X,s(1,N)})}return u.$$set=X=>{r=Ti(Ti({},r),bo(X)),s(3,w=cr(r,y)),"use"in X&&s(0,p=X.use),"$$scope"in X&&s(5,f=X.$$scope)},[p,N,L,w,U,f,z,G]}class Qx extends gn{constructor(r){super(),_n(this,r,$x,Yx,vn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function e1(u){let r,s,y,w,z;const f=u[6].default,p=Zn(f,u,u[5],null);let L=[u[3]],N={};for(let U=0;U<L.length;U+=1)N=Ti(N,L[U]);return{c(){r=mr("h2"),p&&p.c(),this.h()},l(U){r=yr(U,"H2",{});var G=Vr(r);p&&p.l(G),G.forEach(Bt),this.h()},h(){Dr(r,N)},m(U,G){ki(U,r,G),p&&p.m(r,null),u[7](r),y=!0,w||(z=[Rr(s=aa.call(null,r,u[0])),Rr(u[2].call(null,r))],w=!0)},p(U,[G]){p&&p.p&&(!y||G&32)&&Hn(p,f,U,U[5],y?Xn(f,U[5],G,null):Wn(U[5]),null),Dr(r,N=Kn(L,[G&8&&U[3]])),s&&Oo(s.update)&&G&1&&s.update.call(null,U[0])},i(U){y||(li(p,U),y=!0)},o(U){pi(p,U),y=!1},d(U){U&&Bt(r),p&&p.d(U),u[7](null),w=!1,Ca(z)}}}function t1(u,r,s){const y=["use","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r,{use:p=[]}=r;const L=wo(xo());let N;function U(){return N}function G(X){hn[X?"unshift":"push"](()=>{N=X,s(1,N)})}return u.$$set=X=>{r=Ti(Ti({},r),bo(X)),s(3,w=cr(r,y)),"use"in X&&s(0,p=X.use),"$$scope"in X&&s(5,f=X.$$scope)},[p,N,L,w,U,f,z,G]}class i1 extends gn{constructor(r){super(),_n(this,r,t1,e1,vn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function r1(u){let r,s,y,w,z;const f=u[6].default,p=Zn(f,u,u[5],null);let L=[u[3]],N={};for(let U=0;U<L.length;U+=1)N=Ti(N,L[U]);return{c(){r=mr("h3"),p&&p.c(),this.h()},l(U){r=yr(U,"H3",{});var G=Vr(r);p&&p.l(G),G.forEach(Bt),this.h()},h(){Dr(r,N)},m(U,G){ki(U,r,G),p&&p.m(r,null),u[7](r),y=!0,w||(z=[Rr(s=aa.call(null,r,u[0])),Rr(u[2].call(null,r))],w=!0)},p(U,[G]){p&&p.p&&(!y||G&32)&&Hn(p,f,U,U[5],y?Xn(f,U[5],G,null):Wn(U[5]),null),Dr(r,N=Kn(L,[G&8&&U[3]])),s&&Oo(s.update)&&G&1&&s.update.call(null,U[0])},i(U){y||(li(p,U),y=!0)},o(U){pi(p,U),y=!1},d(U){U&&Bt(r),p&&p.d(U),u[7](null),w=!1,Ca(z)}}}function n1(u,r,s){const y=["use","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r,{use:p=[]}=r;const L=wo(xo());let N;function U(){return N}function G(X){hn[X?"unshift":"push"](()=>{N=X,s(1,N)})}return u.$$set=X=>{r=Ti(Ti({},r),bo(X)),s(3,w=cr(r,y)),"use"in X&&s(0,p=X.use),"$$scope"in X&&s(5,f=X.$$scope)},[p,N,L,w,U,f,z,G]}class o1 extends gn{constructor(r){super(),_n(this,r,n1,r1,vn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function a1(u){let r,s,y,w,z;const f=u[6].default,p=Zn(f,u,u[5],null);let L=[u[3]],N={};for(let U=0;U<L.length;U+=1)N=Ti(N,L[U]);return{c(){r=mr("li"),p&&p.c(),this.h()},l(U){r=yr(U,"LI",{});var G=Vr(r);p&&p.l(G),G.forEach(Bt),this.h()},h(){Dr(r,N)},m(U,G){ki(U,r,G),p&&p.m(r,null),u[7](r),y=!0,w||(z=[Rr(s=aa.call(null,r,u[0])),Rr(u[2].call(null,r))],w=!0)},p(U,[G]){p&&p.p&&(!y||G&32)&&Hn(p,f,U,U[5],y?Xn(f,U[5],G,null):Wn(U[5]),null),Dr(r,N=Kn(L,[G&8&&U[3]])),s&&Oo(s.update)&&G&1&&s.update.call(null,U[0])},i(U){y||(li(p,U),y=!0)},o(U){pi(p,U),y=!1},d(U){U&&Bt(r),p&&p.d(U),u[7](null),w=!1,Ca(z)}}}function s1(u,r,s){const y=["use","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r,{use:p=[]}=r;const L=wo(xo());let N;function U(){return N}function G(X){hn[X?"unshift":"push"](()=>{N=X,s(1,N)})}return u.$$set=X=>{r=Ti(Ti({},r),bo(X)),s(3,w=cr(r,y)),"use"in X&&s(0,p=X.use),"$$scope"in X&&s(5,f=X.$$scope)},[p,N,L,w,U,f,z,G]}class l1 extends gn{constructor(r){super(),_n(this,r,s1,a1,vn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function u1(u){let r,s,y,w,z;const f=u[6].default,p=Zn(f,u,u[5],null);let L=[u[3]],N={};for(let U=0;U<L.length;U+=1)N=Ti(N,L[U]);return{c(){r=mr("main"),p&&p.c(),this.h()},l(U){r=yr(U,"MAIN",{});var G=Vr(r);p&&p.l(G),G.forEach(Bt),this.h()},h(){Dr(r,N)},m(U,G){ki(U,r,G),p&&p.m(r,null),u[7](r),y=!0,w||(z=[Rr(s=aa.call(null,r,u[0])),Rr(u[2].call(null,r))],w=!0)},p(U,[G]){p&&p.p&&(!y||G&32)&&Hn(p,f,U,U[5],y?Xn(f,U[5],G,null):Wn(U[5]),null),Dr(r,N=Kn(L,[G&8&&U[3]])),s&&Oo(s.update)&&G&1&&s.update.call(null,U[0])},i(U){y||(li(p,U),y=!0)},o(U){pi(p,U),y=!1},d(U){U&&Bt(r),p&&p.d(U),u[7](null),w=!1,Ca(z)}}}function c1(u,r,s){const y=["use","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r,{use:p=[]}=r;const L=wo(xo());let N;function U(){return N}function G(X){hn[X?"unshift":"push"](()=>{N=X,s(1,N)})}return u.$$set=X=>{r=Ti(Ti({},r),bo(X)),s(3,w=cr(r,y)),"use"in X&&s(0,p=X.use),"$$scope"in X&&s(5,f=X.$$scope)},[p,N,L,w,U,f,z,G]}class h1 extends gn{constructor(r){super(),_n(this,r,c1,u1,vn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function p1(u){let r,s,y,w,z;const f=u[6].default,p=Zn(f,u,u[5],null);let L=[u[3]],N={};for(let U=0;U<L.length;U+=1)N=Ti(N,L[U]);return{c(){r=mr("nav"),p&&p.c(),this.h()},l(U){r=yr(U,"NAV",{});var G=Vr(r);p&&p.l(G),G.forEach(Bt),this.h()},h(){Dr(r,N)},m(U,G){ki(U,r,G),p&&p.m(r,null),u[7](r),y=!0,w||(z=[Rr(s=aa.call(null,r,u[0])),Rr(u[2].call(null,r))],w=!0)},p(U,[G]){p&&p.p&&(!y||G&32)&&Hn(p,f,U,U[5],y?Xn(f,U[5],G,null):Wn(U[5]),null),Dr(r,N=Kn(L,[G&8&&U[3]])),s&&Oo(s.update)&&G&1&&s.update.call(null,U[0])},i(U){y||(li(p,U),y=!0)},o(U){pi(p,U),y=!1},d(U){U&&Bt(r),p&&p.d(U),u[7](null),w=!1,Ca(z)}}}function d1(u,r,s){const y=["use","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r,{use:p=[]}=r;const L=wo(xo());let N;function U(){return N}function G(X){hn[X?"unshift":"push"](()=>{N=X,s(1,N)})}return u.$$set=X=>{r=Ti(Ti({},r),bo(X)),s(3,w=cr(r,y)),"use"in X&&s(0,p=X.use),"$$scope"in X&&s(5,f=X.$$scope)},[p,N,L,w,U,f,z,G]}class f1 extends gn{constructor(r){super(),_n(this,r,d1,p1,vn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function m1(u){let r,s,y,w,z;const f=u[6].default,p=Zn(f,u,u[5],null);let L=[u[3]],N={};for(let U=0;U<L.length;U+=1)N=Ti(N,L[U]);return{c(){r=mr("span"),p&&p.c(),this.h()},l(U){r=yr(U,"SPAN",{});var G=Vr(r);p&&p.l(G),G.forEach(Bt),this.h()},h(){Dr(r,N)},m(U,G){ki(U,r,G),p&&p.m(r,null),u[7](r),y=!0,w||(z=[Rr(s=aa.call(null,r,u[0])),Rr(u[2].call(null,r))],w=!0)},p(U,[G]){p&&p.p&&(!y||G&32)&&Hn(p,f,U,U[5],y?Xn(f,U[5],G,null):Wn(U[5]),null),Dr(r,N=Kn(L,[G&8&&U[3]])),s&&Oo(s.update)&&G&1&&s.update.call(null,U[0])},i(U){y||(li(p,U),y=!0)},o(U){pi(p,U),y=!1},d(U){U&&Bt(r),p&&p.d(U),u[7](null),w=!1,Ca(z)}}}function y1(u,r,s){const y=["use","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r,{use:p=[]}=r;const L=wo(xo());let N;function U(){return N}function G(X){hn[X?"unshift":"push"](()=>{N=X,s(1,N)})}return u.$$set=X=>{r=Ti(Ti({},r),bo(X)),s(3,w=cr(r,y)),"use"in X&&s(0,p=X.use),"$$scope"in X&&s(5,f=X.$$scope)},[p,N,L,w,U,f,z,G]}class wv extends gn{constructor(r){super(),_n(this,r,y1,m1,vn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}function g1(u){let r,s,y,w,z;const f=u[6].default,p=Zn(f,u,u[5],null);let L=[u[3]],N={};for(let U=0;U<L.length;U+=1)N=Ti(N,L[U]);return{c(){r=mr("ul"),p&&p.c(),this.h()},l(U){r=yr(U,"UL",{});var G=Vr(r);p&&p.l(G),G.forEach(Bt),this.h()},h(){Dr(r,N)},m(U,G){ki(U,r,G),p&&p.m(r,null),u[7](r),y=!0,w||(z=[Rr(s=aa.call(null,r,u[0])),Rr(u[2].call(null,r))],w=!0)},p(U,[G]){p&&p.p&&(!y||G&32)&&Hn(p,f,U,U[5],y?Xn(f,U[5],G,null):Wn(U[5]),null),Dr(r,N=Kn(L,[G&8&&U[3]])),s&&Oo(s.update)&&G&1&&s.update.call(null,U[0])},i(U){y||(li(p,U),y=!0)},o(U){pi(p,U),y=!1},d(U){U&&Bt(r),p&&p.d(U),u[7](null),w=!1,Ca(z)}}}function _1(u,r,s){const y=["use","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r,{use:p=[]}=r;const L=wo(xo());let N;function U(){return N}function G(X){hn[X?"unshift":"push"](()=>{N=X,s(1,N)})}return u.$$set=X=>{r=Ti(Ti({},r),bo(X)),s(3,w=cr(r,y)),"use"in X&&s(0,p=X.use),"$$scope"in X&&s(5,f=X.$$scope)},[p,N,L,w,U,f,z,G]}class v1 extends gn{constructor(r){super(),_n(this,r,_1,g1,vn,{use:0,getElement:4})}get getElement(){return this.$$.ctx[4]}}const Ev=Wx,x1=Jx,Nd=bv,b1=Qx,w1=i1,E1=o1,S1=l1,I1=h1,T1=f1,Zp=wv,A1=v1;var C1=dl({class:"mdc-top-app-bar__row",component:Nd});function k1(u){let r,s,y,w,z,f;const p=u[9].default,L=Zn(p,u,u[8],null);let N=[{class:s=Ln({[u[1]]:!0,"mdc-top-app-bar__section":!0,"mdc-top-app-bar__section--align-start":u[2]==="start","mdc-top-app-bar__section--align-end":u[2]==="end"})},u[3]?{role:"toolbar"}:{},u[6]],U={};for(let G=0;G<N.length;G+=1)U=Ti(U,N[G]);return{c(){r=mr("section"),L&&L.c(),this.h()},l(G){r=yr(G,"SECTION",{class:!0});var X=Vr(r);L&&L.l(X),X.forEach(Bt),this.h()},h(){Dr(r,U)},m(G,X){ki(G,r,X),L&&L.m(r,null),u[10](r),w=!0,z||(f=[Rr(y=aa.call(null,r,u[0])),Rr(u[5].call(null,r))],z=!0)},p(G,[X]){L&&L.p&&(!w||X&256)&&Hn(L,p,G,G[8],w?Xn(p,G[8],X,null):Wn(G[8]),null),Dr(r,U=Kn(N,[(!w||X&6&&s!==(s=Ln({[G[1]]:!0,"mdc-top-app-bar__section":!0,"mdc-top-app-bar__section--align-start":G[2]==="start","mdc-top-app-bar__section--align-end":G[2]==="end"})))&&{class:s},X&8&&(G[3]?{role:"toolbar"}:{}),X&64&&G[6]])),y&&Oo(y.update)&&X&1&&y.update.call(null,G[0])},i(G){w||(li(L,G),w=!0)},o(G){pi(L,G),w=!1},d(G){G&&Bt(r),L&&L.d(G),u[10](null),z=!1,Ca(f)}}}function z1(u,r,s){const y=["use","class","align","toolbar","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r;const p=wo(xo());let{use:L=[]}=r,{class:N=""}=r,{align:U="start"}=r,{toolbar:G=!1}=r,X;Bo("SMUI:icon-button:context",G?"top-app-bar:action":"top-app-bar:navigation"),Bo("SMUI:button:context",G?"top-app-bar:action":"top-app-bar:navigation");function Se(){return X}function ge(De){hn[De?"unshift":"push"](()=>{X=De,s(4,X)})}return u.$$set=De=>{r=Ti(Ti({},r),bo(De)),s(6,w=cr(r,y)),"use"in De&&s(0,L=De.use),"class"in De&&s(1,N=De.class),"align"in De&&s(2,U=De.align),"toolbar"in De&&s(3,G=De.toolbar),"$$scope"in De&&s(8,f=De.$$scope)},[L,N,U,G,X,p,w,Se,f,z,ge]}class P1 extends gn{constructor(r){super(),_n(this,r,z1,k1,vn,{use:0,class:1,align:2,toolbar:3,getElement:7})}get getElement(){return this.$$.ctx[7]}}var M1=dl({class:"mdc-top-app-bar__title",component:Zp});function L1(u){let r;const s=u[11].default,y=Zn(s,u,u[13],null);return{c(){y&&y.c()},l(w){y&&y.l(w)},m(w,z){y&&y.m(w,z),r=!0},p(w,z){y&&y.p&&(!r||z&8192)&&Hn(y,s,w,w[13],r?Xn(s,w[13],z,null):Wn(w[13]),null)},i(w){r||(li(y,w),r=!0)},o(w){pi(y,w),r=!1},d(w){y&&y.d(w)}}}function D1(u){let r,s,y;const w=[{use:[u[6],...u[0]]},{class:Ln({[u[1]]:!0,[u[5]]:!0})},u[7]];var z=u[2];function f(p){let L={$$slots:{default:[L1]},$$scope:{ctx:p}};for(let N=0;N<w.length;N+=1)L=Ti(L,w[N]);return{props:L}}return z&&(r=new z(f(u)),u[12](r)),{c(){r&&gr(r.$$.fragment),s=an()},l(p){r&&qr(r.$$.fragment,p),s=an()},m(p,L){r&&_r(r,p,L),ki(p,s,L),y=!0},p(p,[L]){const N=L&227?Kn(w,[L&65&&{use:[p[6],...p[0]]},L&34&&{class:Ln({[p[1]]:!0,[p[5]]:!0})},L&128&&ts(p[7])]):{};if(L&8192&&(N.$$scope={dirty:L,ctx:p}),z!==(z=p[2])){if(r){hl();const U=r;pi(U.$$.fragment,1,0,()=>{vr(U,1)}),cl()}z?(r=new z(f(p)),p[12](r),gr(r.$$.fragment),li(r.$$.fragment,1),_r(r,s.parentNode,s)):r=null}else z&&r.$set(N)},i(p){y||(r&&li(r.$$.fragment,p),y=!0)},o(p){r&&pi(r.$$.fragment,p),y=!1},d(p){u[12](null),p&&Bt(s),r&&vr(r,p)}}}function R1(u,r,s){let y,w;const z=["use","class","topAppBar","component","getElement"];let f=cr(r,z),p,L=Bl,N=()=>(L(),L=mx(y,st=>s(10,p=st)),y);u.$$.on_destroy.push(()=>L());let{$$slots:U={},$$scope:G}=r;const X=wo(xo());let{use:Se=[]}=r,{class:ge=""}=r,{topAppBar:De}=r,Le,{component:ft=I1}=r;function Ue(){return Le.getElement()}function Re(st){hn[st?"unshift":"push"](()=>{Le=st,s(4,Le)})}return u.$$set=st=>{r=Ti(Ti({},r),bo(st)),s(7,f=cr(r,z)),"use"in st&&s(0,Se=st.use),"class"in st&&s(1,ge=st.class),"topAppBar"in st&&s(8,De=st.topAppBar),"component"in st&&s(2,ft=st.component),"$$scope"in st&&s(13,G=st.$$scope)},u.$$.update=()=>{u.$$.dirty&256&&N(s(3,y=De&&De.getPropStore())),u.$$.dirty&1032&&s(5,w=(()=>!y||p.variant==="static"?"":p.variant==="short"?"mdc-top-app-bar--short-fixed-adjust":p.prominent&&p.dense?"mdc-top-app-bar--dense-prominent-fixed-adjust":p.prominent?"mdc-top-app-bar--prominent-fixed-adjust":p.dense?"mdc-top-app-bar--dense-fixed-adjust":"mdc-top-app-bar--fixed-adjust")())},[Se,ge,ft,y,Le,w,X,f,De,Ue,p,U,Re,G]}class B1 extends gn{constructor(r){super(),_n(this,r,R1,D1,vn,{use:0,class:1,topAppBar:8,component:2,getElement:9})}get getElement(){return this.$$.ctx[9]}}const x_=P1,O1=B1;/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var kf={ICON_BUTTON_ON:"mdc-icon-button--on",ROOT:"mdc-icon-button"},Pc={ARIA_LABEL:"aria-label",ARIA_PRESSED:"aria-pressed",DATA_ARIA_LABEL_OFF:"data-aria-label-off",DATA_ARIA_LABEL_ON:"data-aria-label-on",CHANGE_EVENT:"MDCIconButtonToggle:change"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var F1=function(u){pl(r,u);function r(s){var y=u.call(this,Go(Go({},r.defaultAdapter),s))||this;return y.hasToggledAriaLabel=!1,y}return Object.defineProperty(r,"cssClasses",{get:function(){return kf},enumerable:!1,configurable:!0}),Object.defineProperty(r,"strings",{get:function(){return Pc},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{addClass:function(){},hasClass:function(){return!1},notifyChange:function(){},removeClass:function(){},getAttr:function(){return null},setAttr:function(){}}},enumerable:!1,configurable:!0}),r.prototype.init=function(){var s=this.adapter.getAttr(Pc.DATA_ARIA_LABEL_ON),y=this.adapter.getAttr(Pc.DATA_ARIA_LABEL_OFF);if(s&&y){if(this.adapter.getAttr(Pc.ARIA_PRESSED)!==null)throw new Error("MDCIconButtonToggleFoundation: Button should not set `aria-pressed` if it has a toggled aria label.");this.hasToggledAriaLabel=!0}else this.adapter.setAttr(Pc.ARIA_PRESSED,String(this.isOn()))},r.prototype.handleClick=function(){this.toggle(),this.adapter.notifyChange({isOn:this.isOn()})},r.prototype.isOn=function(){return this.adapter.hasClass(kf.ICON_BUTTON_ON)},r.prototype.toggle=function(s){if(s===void 0&&(s=!this.isOn()),s?this.adapter.addClass(kf.ICON_BUTTON_ON):this.adapter.removeClass(kf.ICON_BUTTON_ON),this.hasToggledAriaLabel){var y=s?this.adapter.getAttr(Pc.DATA_ARIA_LABEL_ON):this.adapter.getAttr(Pc.DATA_ARIA_LABEL_OFF);this.adapter.setAttr(Pc.ARIA_LABEL,y||"")}else this.adapter.setAttr(Pc.ARIA_PRESSED,""+s)},r}(Rc);/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var my="mdc-dom-focus-sentinel",U1=function(){function u(r,s){s===void 0&&(s={}),this.root=r,this.options=s,this.elFocusedBeforeTrapFocus=null}return u.prototype.trapFocus=function(){var r=this.getFocusableElements(this.root);if(r.length===0)throw new Error("FocusTrap: Element must have at least one focusable child.");this.elFocusedBeforeTrapFocus=document.activeElement instanceof HTMLElement?document.activeElement:null,this.wrapTabFocus(this.root),this.options.skipInitialFocus||this.focusInitialElement(r,this.options.initialFocusEl)},u.prototype.releaseFocus=function(){[].slice.call(this.root.querySelectorAll("."+my)).forEach(function(r){r.parentElement.removeChild(r)}),!this.options.skipRestoreFocus&&this.elFocusedBeforeTrapFocus&&this.elFocusedBeforeTrapFocus.focus()},u.prototype.wrapTabFocus=function(r){var s=this,y=this.createSentinel(),w=this.createSentinel();y.addEventListener("focus",function(){var z=s.getFocusableElements(r);z.length>0&&z[z.length-1].focus()}),w.addEventListener("focus",function(){var z=s.getFocusableElements(r);z.length>0&&z[0].focus()}),r.insertBefore(y,r.children[0]),r.appendChild(w)},u.prototype.focusInitialElement=function(r,s){var y=0;s&&(y=Math.max(r.indexOf(s),0)),r[y].focus()},u.prototype.getFocusableElements=function(r){var s=[].slice.call(r.querySelectorAll("[autofocus], [tabindex], a, input, textarea, select, button"));return s.filter(function(y){var w=y.getAttribute("aria-disabled")==="true"||y.getAttribute("disabled")!=null||y.getAttribute("hidden")!=null||y.getAttribute("aria-hidden")==="true",z=y.tabIndex>=0&&y.getBoundingClientRect().width>0&&!y.classList.contains(my)&&!w,f=!1;if(z){var p=getComputedStyle(y);f=p.display==="none"||p.visibility==="hidden"}return z&&!f})},u.prototype.createSentinel=function(){var r=document.createElement("div");return r.setAttribute("tabindex","0"),r.setAttribute("aria-hidden","true"),r.classList.add(my),r},u}(),N1=Object.freeze(Object.defineProperty({__proto__:null,FocusTrap:U1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Yr={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape",TAB:"Tab"},ws=new Set;ws.add(Yr.BACKSPACE);ws.add(Yr.ENTER);ws.add(Yr.SPACEBAR);ws.add(Yr.PAGE_UP);ws.add(Yr.PAGE_DOWN);ws.add(Yr.END);ws.add(Yr.HOME);ws.add(Yr.ARROW_LEFT);ws.add(Yr.ARROW_UP);ws.add(Yr.ARROW_RIGHT);ws.add(Yr.ARROW_DOWN);ws.add(Yr.DELETE);ws.add(Yr.ESCAPE);ws.add(Yr.TAB);var Vs={BACKSPACE:8,ENTER:13,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ESCAPE:27,TAB:9},Es=new Map;Es.set(Vs.BACKSPACE,Yr.BACKSPACE);Es.set(Vs.ENTER,Yr.ENTER);Es.set(Vs.SPACEBAR,Yr.SPACEBAR);Es.set(Vs.PAGE_UP,Yr.PAGE_UP);Es.set(Vs.PAGE_DOWN,Yr.PAGE_DOWN);Es.set(Vs.END,Yr.END);Es.set(Vs.HOME,Yr.HOME);Es.set(Vs.ARROW_LEFT,Yr.ARROW_LEFT);Es.set(Vs.ARROW_UP,Yr.ARROW_UP);Es.set(Vs.ARROW_RIGHT,Yr.ARROW_RIGHT);Es.set(Vs.ARROW_DOWN,Yr.ARROW_DOWN);Es.set(Vs.DELETE,Yr.DELETE);Es.set(Vs.ESCAPE,Yr.ESCAPE);Es.set(Vs.TAB,Yr.TAB);var bh=new Set;bh.add(Yr.PAGE_UP);bh.add(Yr.PAGE_DOWN);bh.add(Yr.END);bh.add(Yr.HOME);bh.add(Yr.ARROW_LEFT);bh.add(Yr.ARROW_UP);bh.add(Yr.ARROW_RIGHT);bh.add(Yr.ARROW_DOWN);function es(u){var r=u.key;if(ws.has(r))return r;var s=Es.get(u.keyCode);return s||Yr.UNKNOWN}const{applyPassive:zf}=Sx,{matches:j1}=vv;function Fp(u,{ripple:r=!0,surface:s=!1,unbounded:y=!1,disabled:w=!1,color:z,active:f,rippleElement:p,eventTarget:L,activeTarget:N,addClass:U=ge=>u.classList.add(ge),removeClass:G=ge=>u.classList.remove(ge),addStyle:X=(ge,De)=>u.style.setProperty(ge,De),initPromise:Se=Promise.resolve()}={}){let ge,De=ra("SMUI:addLayoutListener"),Le,ft=f,Ue=L,Re=N;function st(){s?(U("mdc-ripple-surface"),z==="primary"?(U("smui-ripple-surface--primary"),G("smui-ripple-surface--secondary")):z==="secondary"?(G("smui-ripple-surface--primary"),U("smui-ripple-surface--secondary")):(G("smui-ripple-surface--primary"),G("smui-ripple-surface--secondary"))):(G("mdc-ripple-surface"),G("smui-ripple-surface--primary"),G("smui-ripple-surface--secondary")),ge&&ft!==f&&(ft=f,f?ge.activate():f===!1&&ge.deactivate()),r&&!ge?(ge=new Px({addClass:U,browserSupportsCssVars:()=>kx(window),computeBoundingRect:()=>(p||u).getBoundingClientRect(),containsEventTarget:ht=>u.contains(ht),deregisterDocumentInteractionHandler:(ht,at)=>document.documentElement.removeEventListener(ht,at,zf()),deregisterInteractionHandler:(ht,at)=>(L||u).removeEventListener(ht,at,zf()),deregisterResizeHandler:ht=>window.removeEventListener("resize",ht),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset}),isSurfaceActive:()=>f==null?j1(N||u,":active"):f,isSurfaceDisabled:()=>!!w,isUnbounded:()=>!!y,registerDocumentInteractionHandler:(ht,at)=>document.documentElement.addEventListener(ht,at,zf()),registerInteractionHandler:(ht,at)=>(L||u).addEventListener(ht,at,zf()),registerResizeHandler:ht=>window.addEventListener("resize",ht),removeClass:G,updateCssVariable:X}),Se.then(()=>{ge&&(ge.init(),ge.setUnbounded(y))})):ge&&!r&&Se.then(()=>{ge&&(ge.destroy(),ge=void 0)}),ge&&(Ue!==L||Re!==N)&&(Ue=L,Re=N,ge.destroy(),requestAnimationFrame(()=>{ge&&(ge.init(),ge.setUnbounded(y))})),!r&&y&&U("mdc-ripple-upgraded--unbounded")}st(),De&&(Le=De(ut));function ut(){ge&&ge.layout()}return{update(ht){({ripple:r,surface:s,unbounded:y,disabled:w,color:z,active:f,rippleElement:p,eventTarget:L,activeTarget:N,addClass:U,removeClass:G,addStyle:X,initPromise:Se}=Object.assign({ripple:!0,surface:!1,unbounded:!1,disabled:!1,color:void 0,active:void 0,rippleElement:void 0,eventTarget:void 0,activeTarget:void 0,addClass:at=>u.classList.add(at),removeClass:at=>u.classList.remove(at),addStyle:(at,$t)=>u.style.setProperty(at,$t),initPromise:Promise.resolve()},ht)),st()},destroy(){ge&&(ge.destroy(),ge=void 0,G("mdc-ripple-surface"),G("smui-ripple-surface--primary"),G("smui-ripple-surface--secondary")),Le&&Le()}}}function b_(u){let r;return{c(){r=mr("div"),this.h()},l(s){r=yr(s,"DIV",{class:!0}),Vr(r).forEach(Bt),this.h()},h(){jr(r,"class","mdc-icon-button__touch")},m(s,y){ki(s,r,y)},d(s){s&&Bt(r)}}}function V1(u){let r,s,y,w;const z=u[32].default,f=Zn(z,u,u[36],null);let p=u[8]&&b_();return{c(){r=mr("div"),s=na(),f&&f.c(),p&&p.c(),y=an(),this.h()},l(L){r=yr(L,"DIV",{class:!0}),Vr(r).forEach(Bt),s=oa(L),f&&f.l(L),p&&p.l(L),y=an(),this.h()},h(){jr(r,"class","mdc-icon-button__ripple")},m(L,N){ki(L,r,N),ki(L,s,N),f&&f.m(L,N),p&&p.m(L,N),ki(L,y,N),w=!0},p(L,N){f&&f.p&&(!w||N[1]&32)&&Hn(f,z,L,L[36],w?Xn(z,L[36],N,null):Wn(L[36]),null),L[8]?p||(p=b_(),p.c(),p.m(y.parentNode,y)):p&&(p.d(1),p=null)},i(L){w||(li(f,L),w=!0)},o(L){pi(f,L),w=!1},d(L){L&&Bt(r),L&&Bt(s),f&&f.d(L),p&&p.d(L),L&&Bt(y)}}}function q1(u){let r,s,y;const w=[{use:[[Fp,{ripple:u[4],unbounded:!0,color:u[5],disabled:!!u[28].disabled,addClass:u[25],removeClass:u[26],addStyle:u[27]}],u[21],...u[1]]},{class:Ln(bs({[u[2]]:!0,"mdc-icon-button":!0,"mdc-icon-button--on":!u[22](u[0])&&u[0],"mdc-icon-button--touch":u[8],"mdc-icon-button--display-flex":u[9],"smui-icon-button--size-button":u[10]==="button","mdc-icon-button--reduced-size":u[10]==="mini"||u[10]==="button","mdc-card__action":u[23]==="card:action","mdc-card__action--icon":u[23]==="card:action","mdc-top-app-bar__navigation-icon":u[23]==="top-app-bar:navigation","mdc-top-app-bar__action-item":u[23]==="top-app-bar:action","mdc-snackbar__dismiss":u[23]==="snackbar:actions","mdc-data-table__pagination-button":u[23]==="data-table:pagination","mdc-data-table__sort-icon-button":u[23]==="data-table:sortable-header-cell","mdc-dialog__close":u[23]==="dialog:header"&&u[12]==="close"},u[17]))},{style:Object.entries(u[18]).map(w_).concat([u[3]]).join(" ")},{"aria-pressed":u[22](u[0])?null:u[0]?"true":"false"},{"aria-label":u[0]?u[6]:u[7]},{"data-aria-label-on":u[6]},{"data-aria-label-off":u[7]},{"aria-describedby":u[24]},{href:u[11]},u[20],u[19],u[28]];var z=u[13];function f(p){let L={$$slots:{default:[V1]},$$scope:{ctx:p}};for(let N=0;N<w.length;N+=1)L=Ti(L,w[N]);return{props:L}}return z&&(r=new z(f(u)),u[33](r),r.$on("click",u[34]),r.$on("click",u[35])),{c(){r&&gr(r.$$.fragment),s=an()},l(p){r&&qr(r.$$.fragment,p),s=an()},m(p,L){r&&_r(r,p,L),ki(p,s,L),y=!0},p(p,L){const N=L[0]&536748031?Kn(w,[L[0]&505413682&&{use:[[Fp,{ripple:p[4],unbounded:!0,color:p[5],disabled:!!p[28].disabled,addClass:p[25],removeClass:p[26],addStyle:p[27]}],p[21],...p[1]]},L[0]&12719877&&{class:Ln(bs({[p[2]]:!0,"mdc-icon-button":!0,"mdc-icon-button--on":!p[22](p[0])&&p[0],"mdc-icon-button--touch":p[8],"mdc-icon-button--display-flex":p[9],"smui-icon-button--size-button":p[10]==="button","mdc-icon-button--reduced-size":p[10]==="mini"||p[10]==="button","mdc-card__action":p[23]==="card:action","mdc-card__action--icon":p[23]==="card:action","mdc-top-app-bar__navigation-icon":p[23]==="top-app-bar:navigation","mdc-top-app-bar__action-item":p[23]==="top-app-bar:action","mdc-snackbar__dismiss":p[23]==="snackbar:actions","mdc-data-table__pagination-button":p[23]==="data-table:pagination","mdc-data-table__sort-icon-button":p[23]==="data-table:sortable-header-cell","mdc-dialog__close":p[23]==="dialog:header"&&p[12]==="close"},p[17]))},L[0]&262152&&{style:Object.entries(p[18]).map(w_).concat([p[3]]).join(" ")},L[0]&4194305&&{"aria-pressed":p[22](p[0])?null:p[0]?"true":"false"},L[0]&193&&{"aria-label":p[0]?p[6]:p[7]},L[0]&64&&{"data-aria-label-on":p[6]},L[0]&128&&{"data-aria-label-off":p[7]},L[0]&16777216&&{"aria-describedby":p[24]},L[0]&2048&&{href:p[11]},L[0]&1048576&&ts(p[20]),L[0]&524288&&ts(p[19]),L[0]&268435456&&ts(p[28])]):{};if(L[0]&256|L[1]&32&&(N.$$scope={dirty:L,ctx:p}),z!==(z=p[13])){if(r){hl();const U=r;pi(U.$$.fragment,1,0,()=>{vr(U,1)}),cl()}z?(r=new z(f(p)),p[33](r),r.$on("click",p[34]),r.$on("click",p[35]),gr(r.$$.fragment),li(r.$$.fragment,1),_r(r,s.parentNode,s)):r=null}else z&&r.$set(N)},i(p){y||(r&&li(r.$$.fragment,p),y=!0)},o(p){r&&pi(r.$$.fragment,p),y=!1},d(p){u[33](null),p&&Bt(s),r&&vr(r,p)}}}const w_=([u,r])=>`${u}: ${r};`;function G1(u,r,s){let y;const w=["use","class","style","ripple","color","toggle","pressed","ariaLabelOn","ariaLabelOff","touch","displayFlex","size","href","action","component","getElement"];let z=cr(r,w),{$$slots:f={},$$scope:p}=r;const L=wo(xo());let N=()=>{};function U(Mt){return Mt===N}let{use:G=[]}=r,{class:X=""}=r,{style:Se=""}=r,{ripple:ge=!0}=r,{color:De=void 0}=r,{toggle:Le=!1}=r,{pressed:ft=N}=r,{ariaLabelOn:Ue=void 0}=r,{ariaLabelOff:Re=void 0}=r,{touch:st=!1}=r,{displayFlex:ut=!0}=r,{size:ht="normal"}=r,{href:at=void 0}=r,{action:$t=void 0}=r,xt,qt,_i={},Ri={},Ht={},Qt=ra("SMUI:icon-button:context"),Si=ra("SMUI:icon-button:aria-describedby"),{component:bt=at==null?x1:Ev}=r,Fi=z.disabled;Bo("SMUI:icon:context","icon-button");let Dt=null;Vp(()=>{qt&&qt.destroy()});function bi(Mt){return Mt in _i?_i[Mt]:Ni().classList.contains(Mt)}function zt(Mt){_i[Mt]||s(17,_i[Mt]=!0,_i)}function Yt(Mt){(!(Mt in _i)||_i[Mt])&&s(17,_i[Mt]=!1,_i)}function Et(Mt,rr){Ri[Mt]!=rr&&(rr===""||rr==null?(delete Ri[Mt],s(18,Ri)):s(18,Ri[Mt]=rr,Ri))}function xi(Mt){var rr;return Mt in Ht?(rr=Ht[Mt])!==null&&rr!==void 0?rr:null:Ni().getAttribute(Mt)}function Gt(Mt,rr){Ht[Mt]!==rr&&s(19,Ht[Mt]=rr,Ht)}function Ji(Mt){s(0,ft=Mt.isOn)}function Ni(){return xt.getElement()}function Ai(Mt){hn[Mt?"unshift":"push"](()=>{xt=Mt,s(15,xt)})}const or=()=>qt&&qt.handleClick(),Li=()=>Qt==="top-app-bar:navigation"&&Aa(Ni(),"SMUITopAppBarIconButton:nav");return u.$$set=Mt=>{r=Ti(Ti({},r),bo(Mt)),s(28,z=cr(r,w)),"use"in Mt&&s(1,G=Mt.use),"class"in Mt&&s(2,X=Mt.class),"style"in Mt&&s(3,Se=Mt.style),"ripple"in Mt&&s(4,ge=Mt.ripple),"color"in Mt&&s(5,De=Mt.color),"toggle"in Mt&&s(29,Le=Mt.toggle),"pressed"in Mt&&s(0,ft=Mt.pressed),"ariaLabelOn"in Mt&&s(6,Ue=Mt.ariaLabelOn),"ariaLabelOff"in Mt&&s(7,Re=Mt.ariaLabelOff),"touch"in Mt&&s(8,st=Mt.touch),"displayFlex"in Mt&&s(9,ut=Mt.displayFlex),"size"in Mt&&s(10,ht=Mt.size),"href"in Mt&&s(11,at=Mt.href),"action"in Mt&&s(12,$t=Mt.action),"component"in Mt&&s(13,bt=Mt.component),"$$scope"in Mt&&s(36,p=Mt.$$scope)},u.$$.update=()=>{if(u.$$.dirty[0]&4096&&s(20,y=(()=>{if(Qt==="data-table:pagination")switch($t){case"first-page":return{"data-first-page":"true"};case"prev-page":return{"data-prev-page":"true"};case"next-page":return{"data-next-page":"true"};case"last-page":return{"data-last-page":"true"};default:return{"data-action":"true"}}else return Qt==="dialog:header"?{"data-mdc-dialog-action":$t}:{action:$t}})()),Fi!==z.disabled){const Mt=Ni();"blur"in Mt&&Mt.blur(),s(30,Fi=z.disabled)}u.$$.dirty[0]&536969216|u.$$.dirty[1]&1&&xt&&Ni()&&Le!==Dt&&(Le&&!qt?(s(16,qt=new F1({addClass:zt,hasClass:bi,notifyChange:Mt=>{Ji(Mt),Aa(Ni(),"SMUIIconButtonToggle:change",Mt,void 0,!0)},removeClass:Yt,getAttr:xi,setAttr:Gt})),qt.init()):!Le&&qt&&(qt.destroy(),s(16,qt=void 0),s(17,_i={}),s(19,Ht={})),s(31,Dt=Le)),u.$$.dirty[0]&65537&&qt&&!U(ft)&&qt.isOn()!==ft&&qt.toggle(ft)},[ft,G,X,Se,ge,De,Ue,Re,st,ut,ht,at,$t,bt,Ni,xt,qt,_i,Ri,Ht,y,L,U,Qt,Si,zt,Yt,Et,z,Le,Fi,Dt,f,Ai,or,Li,p]}class Ny extends gn{constructor(r){super(),_n(this,r,G1,q1,vn,{use:1,class:2,style:3,ripple:4,color:5,toggle:29,pressed:0,ariaLabelOn:6,ariaLabelOff:7,touch:8,displayFlex:9,size:10,href:11,action:12,component:13,getElement:14},null,[-1,-1])}get getElement(){return this.$$.ctx[14]}}function Z1(u){let r;const s=u[9].default,y=Zn(s,u,u[11],null);return{c(){y&&y.c()},l(w){y&&y.l(w)},m(w,z){y&&y.m(w,z),r=!0},p(w,z){y&&y.p&&(!r||z&2048)&&Hn(y,s,w,w[11],r?Xn(s,w[11],z,null):Wn(w[11]),null)},i(w){r||(li(y,w),r=!0)},o(w){pi(y,w),r=!1},d(w){y&&y.d(w)}}}function H1(u){let r,s,y;const w=[{use:[u[4],...u[0]]},{class:Ln({[u[1]]:!0,"mdc-button__label":u[5]==="button","mdc-fab__label":u[5]==="fab","mdc-tab__text-label":u[5]==="tab","mdc-image-list__label":u[5]==="image-list","mdc-snackbar__label":u[5]==="snackbar","mdc-banner__text":u[5]==="banner","mdc-segmented-button__label":u[5]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":u[5]==="data-table:pagination","mdc-data-table__header-cell-label":u[5]==="data-table:sortable-header-cell"})},u[5]==="snackbar"?{"aria-atomic":"false"}:{},{tabindex:u[6]},u[7]];var z=u[2];function f(p){let L={$$slots:{default:[Z1]},$$scope:{ctx:p}};for(let N=0;N<w.length;N+=1)L=Ti(L,w[N]);return{props:L}}return z&&(r=new z(f(u)),u[10](r)),{c(){r&&gr(r.$$.fragment),s=an()},l(p){r&&qr(r.$$.fragment,p),s=an()},m(p,L){r&&_r(r,p,L),ki(p,s,L),y=!0},p(p,[L]){const N=L&243?Kn(w,[L&17&&{use:[p[4],...p[0]]},L&34&&{class:Ln({[p[1]]:!0,"mdc-button__label":p[5]==="button","mdc-fab__label":p[5]==="fab","mdc-tab__text-label":p[5]==="tab","mdc-image-list__label":p[5]==="image-list","mdc-snackbar__label":p[5]==="snackbar","mdc-banner__text":p[5]==="banner","mdc-segmented-button__label":p[5]==="segmented-button","mdc-data-table__pagination-rows-per-page-label":p[5]==="data-table:pagination","mdc-data-table__header-cell-label":p[5]==="data-table:sortable-header-cell"})},L&32&&ts(p[5]==="snackbar"?{"aria-atomic":"false"}:{}),L&64&&{tabindex:p[6]},L&128&&ts(p[7])]):{};if(L&2048&&(N.$$scope={dirty:L,ctx:p}),z!==(z=p[2])){if(r){hl();const U=r;pi(U.$$.fragment,1,0,()=>{vr(U,1)}),cl()}z?(r=new z(f(p)),p[10](r),gr(r.$$.fragment),li(r.$$.fragment,1),_r(r,s.parentNode,s)):r=null}else z&&r.$set(N)},i(p){y||(r&&li(r.$$.fragment,p),y=!0)},o(p){r&&pi(r.$$.fragment,p),y=!1},d(p){u[10](null),p&&Bt(s),r&&vr(r,p)}}}function W1(u,r,s){const y=["use","class","component","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r;const p=wo(xo());let{use:L=[]}=r,{class:N=""}=r,U,{component:G=wv}=r;const X=ra("SMUI:label:context"),Se=ra("SMUI:label:tabindex");function ge(){return U.getElement()}function De(Le){hn[Le?"unshift":"push"](()=>{U=Le,s(3,U)})}return u.$$set=Le=>{r=Ti(Ti({},r),bo(Le)),s(7,w=cr(r,y)),"use"in Le&&s(0,L=Le.use),"class"in Le&&s(1,N=Le.class),"component"in Le&&s(2,G=Le.component),"$$scope"in Le&&s(11,f=Le.$$scope)},[L,N,G,U,p,X,Se,w,ge,z,De,f]}class X1 extends gn{constructor(r){super(),_n(this,r,W1,H1,vn,{use:0,class:1,component:2,getElement:8})}get getElement(){return this.$$.ctx[8]}}function K1(u){let r;const s=u[4].default,y=Zn(s,u,u[3],null);return{c(){y&&y.c()},l(w){y&&y.l(w)},m(w,z){y&&y.m(w,z),r=!0},p(w,[z]){y&&y.p&&(!r||z&8)&&Hn(y,s,w,w[3],r?Xn(s,w[3],z,null):Wn(w[3]),null)},i(w){r||(li(y,w),r=!0)},o(w){pi(y,w),r=!1},d(w){y&&y.d(w)}}}function J1(u,r,s){let y,{$$slots:w={},$$scope:z}=r,{key:f}=r,{value:p}=r;const L=Yf(p);return Lc(u,L,N=>s(5,y=N)),Bo(f,L),Vp(()=>{L.set(void 0)}),u.$$set=N=>{"key"in N&&s(1,f=N.key),"value"in N&&s(2,p=N.value),"$$scope"in N&&s(3,z=N.$$scope)},u.$$.update=()=>{u.$$.dirty&4&&gv(L,y=p,y)},[L,f,p,z,w]}class Sv extends gn{constructor(r){super(),_n(this,r,J1,K1,vn,{key:1,value:2})}}const Y1=X1,Ur={title:"GIS for Water",url:"https://water-gis.com",logo:"https://raw.githubusercontent.com/watergis/logo/main/logo.svg",basePath:"/sveltekit-watergis-template",attribution:"\xA9NARWASSCO",styles:[{title:"UNVT(Water)",uri:"https://narwassco.github.io/mapbox-stylefiles/unvt/style.json"},{title:"UNVT(Sewer",uri:"https://narwassco.github.io/mapbox-stylefiles/unvt/style-sewer.json"}],center:{lng:35.87063,lat:-1.08551},zoom:13,search:{url:"https://narwassco.github.io/vt/meter.geojson",target:["connno","serialno"],format:u=>`${u.customer}, ${u.connno}, ${u.serialno}, ${u.village}`,place_type:["meter"],placeholder:"Search CONN NO or S/N",zoom:17},popup:{target:["meter","flow meter","valve","washout","firehydrant","tank","pipeline"]},areaSwitcher:{areas:[{title:"Narok",latlng:[35.87063,-1.08551],zoom:14},{title:"Ololulung'a",latlng:[35.65072,-1.0085],zoom:13},{title:"Kilgoris",latlng:[34.87533,-1.00278],zoom:14},{title:"Suswa",latlng:[36.33078,-1.05307],zoom:13}]},legend:{targets:{pipeline:"Pipeline",pipeline_annotation:"Pipeline Label",meter:"Water Meter","flow meter":"Flow Meter",valve:"Valve",firehydrant:"Fire Hydrant",washout:"Washout",tank:"Tank",tank_annotation:"Tank Label",wtp:"WTP",wtp_annotation:"WTP Label",intake:"Intake",intake_annotation:"Intake Label",parcels:"Parcels",parcels_annotation:"Parcels Label",village:"Village",village_annotation:"Village Label",dma:"DMA","dma-annotation":"DMA Label","contour-line":"Countour","contour-label":"Contour Label",hillshade:"Hillshade"},options:{showDefault:!1,showCheckbox:!0,reverseOrder:!0,onlyRendered:!0}},elevation:{url:"https://narwassco.github.io/narok-terrain/tiles/{z}/{x}/{y}.png",options:{tileSize:512,font:["Roboto Medium"],fontSize:12,fontHalo:1,mainColor:"#263238",haloColor:"#fff",units:"kilometers"}},valhalla:{url:"https://valhalla.water-gis.com",options:{Contours:[{time:3,distance:1,color:"ff0000"},{time:5,distance:2,color:"ffff00"},{time:10,distance:3,color:"0000ff"},{time:15,distance:4,color:"ff00ff"}]}}};function $1(u){let r;return{c(){r=mr("link"),this.h()},l(s){r=yr(s,"LINK",{rel:!0,href:!0}),this.h()},h(){jr(r,"rel","stylesheet"),jr(r,"href",Ur.basePath+"/smui.css")},m(s,y){ki(s,r,y)},p:Bl,d(s){s&&Bt(r)}}}function Q1(u){let r,s,y;return{c(){r=mr("link"),s=na(),y=mr("link"),this.h()},l(w){r=yr(w,"LINK",{rel:!0,href:!0,media:!0}),s=oa(w),y=yr(w,"LINK",{rel:!0,href:!0,media:!0}),this.h()},h(){jr(r,"rel","stylesheet"),jr(r,"href",Ur.basePath+"/smui.css"),jr(r,"media","print"),jr(y,"rel","stylesheet"),jr(y,"href",Ur.basePath+"/smui-dark.css"),jr(y,"media","screen")},m(w,z){ki(w,r,z),ki(w,s,z),ki(w,y,z)},p:Bl,d(w){w&&Bt(r),w&&Bt(s),w&&Bt(y)}}}function eb(u){let r,s,y;return{c(){r=mr("link"),s=na(),y=mr("link"),this.h()},l(w){r=yr(w,"LINK",{rel:!0,href:!0,media:!0}),s=oa(w),y=yr(w,"LINK",{rel:!0,href:!0,media:!0}),this.h()},h(){jr(r,"rel","stylesheet"),jr(r,"href",Ur.basePath+"/smui.css"),jr(r,"media","(prefers-color-scheme: light)"),jr(y,"rel","stylesheet"),jr(y,"href",Ur.basePath+"/smui-dark.css"),jr(y,"media","screen and (prefers-color-scheme: dark)")},m(w,z){ki(w,r,z),ki(w,s,z),ki(w,y,z)},p:Bl,d(w){w&&Bt(r),w&&Bt(s),w&&Bt(y)}}}function tb(u){let r;return{c(){r=qp("menu")},l(s){r=Gp(s,"menu")},m(s,y){ki(s,r,y)},d(s){s&&Bt(r)}}}function ib(u){let r=Ur.title+"",s;return{c(){s=qp(r)},l(y){s=Gp(y,r)},m(y,w){ki(y,s,w)},p:Bl,d(y){y&&Bt(s)}}}function rb(u){let r,s,y,w,z,f,p,L;return r=new Ny({props:{class:"material-icons",$$slots:{default:[tb]},$$scope:{ctx:u}}}),r.$on("click",u[6]),p=new M1({props:{$$slots:{default:[ib]},$$scope:{ctx:u}}}),{c(){gr(r.$$.fragment),s=na(),y=mr("a"),w=mr("img"),f=na(),gr(p.$$.fragment),this.h()},l(N){qr(r.$$.fragment,N),s=oa(N),y=yr(N,"A",{href:!0});var U=Vr(y);w=yr(U,"IMG",{src:!0,alt:!0,class:!0}),U.forEach(Bt),f=oa(N),qr(p.$$.fragment,N),this.h()},h(){gx(w.src,z=Ur.logo)||jr(w,"src",z),jr(w,"alt","logo"),jr(w,"class","logo svelte-1cnjkz4"),jr(y,"href",Ur.url)},m(N,U){_r(r,N,U),ki(N,s,U),ki(N,y,U),Ta(y,w),ki(N,f,U),_r(p,N,U),L=!0},p(N,U){const G={};U&256&&(G.$$scope={dirty:U,ctx:N}),r.$set(G);const X={};U&256&&(X.$$scope={dirty:U,ctx:N}),p.$set(X)},i(N){L||(li(r.$$.fragment,N),li(p.$$.fragment,N),L=!0)},o(N){pi(r.$$.fragment,N),pi(p.$$.fragment,N),L=!1},d(N){vr(r,N),N&&Bt(s),N&&Bt(y),N&&Bt(f),vr(p,N)}}}function nb(u){let r;return{c(){r=qp("print")},l(s){r=Gp(s,"print")},m(s,y){ki(s,r,y)},d(s){s&&Bt(r)}}}function ob(u){let r;return{c(){r=qp(u[3])},l(s){r=Gp(s,u[3])},m(s,y){ki(s,r,y)},p(s,y){y&8&&$y(r,s[3])},d(s){s&&Bt(r)}}}function ab(u){let r,s,y,w;return r=new Ny({props:{class:"material-icons","aria-label":"Print",$$slots:{default:[nb]},$$scope:{ctx:u}}}),y=new Ny({props:{"aria-label":u[4],class:"material-icons",title:u[4],$$slots:{default:[ob]},$$scope:{ctx:u}}}),y.$on("click",u[5]),{c(){gr(r.$$.fragment),s=na(),gr(y.$$.fragment)},l(z){qr(r.$$.fragment,z),s=oa(z),qr(y.$$.fragment,z)},m(z,f){_r(r,z,f),ki(z,s,f),_r(y,z,f),w=!0},p(z,f){const p={};f&256&&(p.$$scope={dirty:f,ctx:z}),r.$set(p);const L={};f&16&&(L["aria-label"]=z[4]),f&16&&(L.title=z[4]),f&264&&(L.$$scope={dirty:f,ctx:z}),y.$set(L)},i(z){w||(li(r.$$.fragment,z),li(y.$$.fragment,z),w=!0)},o(z){pi(r.$$.fragment,z),pi(y.$$.fragment,z),w=!1},d(z){vr(r,z),z&&Bt(s),vr(y,z)}}}function sb(u){let r,s,y,w,z,f;return r=new x_({props:{$$slots:{default:[rb]},$$scope:{ctx:u}}}),z=new x_({props:{align:"end",toolbar:!0,$$slots:{default:[ab]},$$scope:{ctx:u}}}),{c(){gr(r.$$.fragment),s=na(),y=mr("section"),w=na(),gr(z.$$.fragment)},l(p){qr(r.$$.fragment,p),s=oa(p),y=yr(p,"SECTION",{}),Vr(y).forEach(Bt),w=oa(p),qr(z.$$.fragment,p)},m(p,L){_r(r,p,L),ki(p,s,L),ki(p,y,L),ki(p,w,L),_r(z,p,L),f=!0},p(p,L){const N={};L&257&&(N.$$scope={dirty:L,ctx:p}),r.$set(N);const U={};L&280&&(U.$$scope={dirty:L,ctx:p}),z.$set(U)},i(p){f||(li(r.$$.fragment,p),li(z.$$.fragment,p),f=!0)},o(p){pi(r.$$.fragment,p),pi(z.$$.fragment,p),f=!1},d(p){vr(r,p),p&&Bt(s),p&&Bt(y),p&&Bt(w),vr(z,p)}}}function lb(u){let r,s;return r=new C1({props:{$$slots:{default:[sb]},$$scope:{ctx:u}}}),{c(){gr(r.$$.fragment)},l(y){qr(r.$$.fragment,y)},m(y,w){_r(r,y,w),s=!0},p(y,w){const z={};w&281&&(z.$$scope={dirty:w,ctx:y}),r.$set(z)},i(y){s||(li(r.$$.fragment,y),s=!0)},o(y){pi(r.$$.fragment,y),s=!1},d(y){vr(r,y)}}}function ub(u){let r,s,y,w,z,f;function p(G,X){return G[1]===void 0?eb:G[1]?Q1:$1}let L=p(u),N=L(u),U={variant:"fixed",$$slots:{default:[lb]},$$scope:{ctx:u}};return y=new Fx({props:U}),u[7](y),z=new O1({props:{topAppBar:u[2]}}),{c(){N.c(),r=an(),s=na(),gr(y.$$.fragment),w=na(),gr(z.$$.fragment)},l(G){const X=yx('[data-svelte="svelte-7r4yyr"]',document.head);N.l(X),r=an(),X.forEach(Bt),s=oa(G),qr(y.$$.fragment,G),w=oa(G),qr(z.$$.fragment,G)},m(G,X){N.m(document.head,null),Ta(document.head,r),ki(G,s,X),_r(y,G,X),ki(G,w,X),_r(z,G,X),f=!0},p(G,[X]){L===(L=p(G))&&N?N.p(G,X):(N.d(1),N=L(G),N&&(N.c(),N.m(r.parentNode,r)));const Se={};X&281&&(Se.$$scope={dirty:X,ctx:G}),y.$set(Se);const ge={};X&4&&(ge.topAppBar=G[2]),z.$set(ge)},i(G){f||(li(y.$$.fragment,G),li(z.$$.fragment,G),f=!0)},o(G){pi(y.$$.fragment,G),pi(z.$$.fragment,G),f=!1},d(G){N.d(G),Bt(r),G&&Bt(s),u[7](null),vr(y,G),G&&Bt(w),vr(z,G)}}}function cb(u,r,s){let y,w,{drawerOpen:z=!1}=r,f,p;Qu(()=>{s(1,f=window.matchMedia("(prefers-color-scheme: dark)").matches)});const L=()=>s(1,f=!f),N=()=>s(0,z=!z);function U(G){hn[G?"unshift":"push"](()=>{p=G,s(2,p)})}return u.$$set=G=>{"drawerOpen"in G&&s(0,z=G.drawerOpen)},u.$$.update=()=>{u.$$.dirty&2&&s(4,y=`switch to ${f?"light":"dark"} mode`),u.$$.dirty&2&&s(3,w=f?"light_mode":"dark_mode")},[z,f,p,w,y,L,N,U]}class hb extends gn{constructor(r){super(),_n(this,r,cb,ub,vn,{drawerOpen:0})}}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var ph,Mc,Nr={LIST_ITEM_ACTIVATED_CLASS:"mdc-list-item--activated",LIST_ITEM_CLASS:"mdc-list-item",LIST_ITEM_DISABLED_CLASS:"mdc-list-item--disabled",LIST_ITEM_SELECTED_CLASS:"mdc-list-item--selected",LIST_ITEM_TEXT_CLASS:"mdc-list-item__text",LIST_ITEM_PRIMARY_TEXT_CLASS:"mdc-list-item__primary-text",ROOT:"mdc-list"};ph={},ph[""+Nr.LIST_ITEM_ACTIVATED_CLASS]="mdc-list-item--activated",ph[""+Nr.LIST_ITEM_CLASS]="mdc-list-item",ph[""+Nr.LIST_ITEM_DISABLED_CLASS]="mdc-list-item--disabled",ph[""+Nr.LIST_ITEM_SELECTED_CLASS]="mdc-list-item--selected",ph[""+Nr.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-list-item__primary-text",ph[""+Nr.ROOT]="mdc-list";var kp=(Mc={},Mc[""+Nr.LIST_ITEM_ACTIVATED_CLASS]="mdc-deprecated-list-item--activated",Mc[""+Nr.LIST_ITEM_CLASS]="mdc-deprecated-list-item",Mc[""+Nr.LIST_ITEM_DISABLED_CLASS]="mdc-deprecated-list-item--disabled",Mc[""+Nr.LIST_ITEM_SELECTED_CLASS]="mdc-deprecated-list-item--selected",Mc[""+Nr.LIST_ITEM_TEXT_CLASS]="mdc-deprecated-list-item__text",Mc[""+Nr.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-deprecated-list-item__primary-text",Mc[""+Nr.ROOT]="mdc-deprecated-list",Mc),dh={ACTION_EVENT:"MDCList:action",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",ARIA_INTERACTIVE_ROLES_SELECTOR:'[role="listbox"], [role="menu"]',ARIA_MULTI_SELECTABLE_SELECTOR:'[aria-multiselectable="true"]',CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:`
    .`+Nr.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+Nr.LIST_ITEM_CLASS+` a,
    .`+kp[Nr.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+kp[Nr.LIST_ITEM_CLASS]+` a
  `,DEPRECATED_SELECTOR:".mdc-deprecated-list",FOCUSABLE_CHILD_ELEMENTS:`
    .`+Nr.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+Nr.LIST_ITEM_CLASS+` a,
    .`+Nr.LIST_ITEM_CLASS+` input[type="radio"]:not(:disabled),
    .`+Nr.LIST_ITEM_CLASS+` input[type="checkbox"]:not(:disabled),
    .`+kp[Nr.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+kp[Nr.LIST_ITEM_CLASS]+` a,
    .`+kp[Nr.LIST_ITEM_CLASS]+` input[type="radio"]:not(:disabled),
    .`+kp[Nr.LIST_ITEM_CLASS]+` input[type="checkbox"]:not(:disabled)
  `,RADIO_SELECTOR:'input[type="radio"]',SELECTED_ITEM_SELECTOR:'[aria-selected="true"], [aria-current="true"]'},ya={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var pb=["input","button","textarea","select"],Jh=function(u){var r=u.target;if(!!r){var s=(""+r.tagName).toLowerCase();pb.indexOf(s)===-1&&u.preventDefault()}};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function db(){var u={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""};return u}function fb(u,r){for(var s=new Map,y=0;y<u;y++){var w=r(y).trim();if(!!w){var z=w[0].toLowerCase();s.has(z)||s.set(z,[]),s.get(z).push({text:w.toLowerCase(),index:y})}}return s.forEach(function(f){f.sort(function(p,L){return p.index-L.index})}),s}function jy(u,r){var s=u.nextChar,y=u.focusItemAtIndex,w=u.sortedIndexByFirstChar,z=u.focusedItemIndex,f=u.skipFocus,p=u.isItemAtIndexDisabled;clearTimeout(r.bufferClearTimeout),r.bufferClearTimeout=setTimeout(function(){Tv(r)},ya.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),r.typeaheadBuffer=r.typeaheadBuffer+s;var L;return r.typeaheadBuffer.length===1?L=mb(w,z,p,r):L=yb(w,p,r),L!==-1&&!f&&y(L),L}function mb(u,r,s,y){var w=y.typeaheadBuffer[0],z=u.get(w);if(!z)return-1;if(w===y.currentFirstChar&&z[y.sortedIndexCursor].index===r){y.sortedIndexCursor=(y.sortedIndexCursor+1)%z.length;var f=z[y.sortedIndexCursor].index;if(!s(f))return f}y.currentFirstChar=w;var p=-1,L;for(L=0;L<z.length;L++)if(!s(z[L].index)){p=L;break}for(;L<z.length;L++)if(z[L].index>r&&!s(z[L].index)){p=L;break}return p!==-1?(y.sortedIndexCursor=p,z[y.sortedIndexCursor].index):-1}function yb(u,r,s){var y=s.typeaheadBuffer[0],w=u.get(y);if(!w)return-1;var z=w[s.sortedIndexCursor];if(z.text.lastIndexOf(s.typeaheadBuffer,0)===0&&!r(z.index))return z.index;for(var f=(s.sortedIndexCursor+1)%w.length,p=-1;f!==s.sortedIndexCursor;){var L=w[f],N=L.text.lastIndexOf(s.typeaheadBuffer,0)===0,U=!r(L.index);if(N&&U){p=f;break}f=(f+1)%w.length}return p!==-1?(s.sortedIndexCursor=p,w[s.sortedIndexCursor].index):-1}function Iv(u){return u.typeaheadBuffer.length>0}function Tv(u){u.typeaheadBuffer=""}function E_(u,r){var s=u.event,y=u.isTargetListItem,w=u.focusedItemIndex,z=u.focusItemAtIndex,f=u.sortedIndexByFirstChar,p=u.isItemAtIndexDisabled,L=es(s)==="ArrowLeft",N=es(s)==="ArrowUp",U=es(s)==="ArrowRight",G=es(s)==="ArrowDown",X=es(s)==="Home",Se=es(s)==="End",ge=es(s)==="Enter",De=es(s)==="Spacebar";if(s.ctrlKey||s.metaKey||L||N||U||G||X||Se||ge)return-1;var Le=!De&&s.key.length===1;if(Le){Jh(s);var ft={focusItemAtIndex:z,focusedItemIndex:w,nextChar:s.key.toLowerCase(),sortedIndexByFirstChar:f,skipFocus:!1,isItemAtIndexDisabled:p};return jy(ft,r)}if(!De)return-1;y&&Jh(s);var Ue=y&&Iv(r);if(Ue){var ft={focusItemAtIndex:z,focusedItemIndex:w,nextChar:" ",sortedIndexByFirstChar:f,skipFocus:!1,isItemAtIndexDisabled:p};return jy(ft,r)}return-1}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function gb(u){return u instanceof Array}var _b=function(u){pl(r,u);function r(s){var y=u.call(this,Go(Go({},r.defaultAdapter),s))||this;return y.wrapFocus=!1,y.isVertical=!0,y.isSingleSelectionList=!1,y.selectedIndex=ya.UNSET_INDEX,y.focusedItemIndex=ya.UNSET_INDEX,y.useActivatedClass=!1,y.useSelectedAttr=!1,y.ariaCurrentAttrValue=null,y.isCheckboxList=!1,y.isRadioList=!1,y.hasTypeahead=!1,y.typeaheadState=db(),y.sortedIndexByFirstChar=new Map,y}return Object.defineProperty(r,"strings",{get:function(){return dh},enumerable:!1,configurable:!0}),Object.defineProperty(r,"cssClasses",{get:function(){return Nr},enumerable:!1,configurable:!0}),Object.defineProperty(r,"numbers",{get:function(){return ya},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{addClassForElementIndex:function(){},focusItemAtIndex:function(){},getAttributeForElementIndex:function(){return null},getFocusedElementIndex:function(){return 0},getListItemCount:function(){return 0},hasCheckboxAtIndex:function(){return!1},hasRadioAtIndex:function(){return!1},isCheckboxCheckedAtIndex:function(){return!1},isFocusInsideList:function(){return!1},isRootFocused:function(){return!1},listItemAtIndexHasClass:function(){return!1},notifyAction:function(){},removeClassForElementIndex:function(){},setAttributeForElementIndex:function(){},setCheckedCheckboxOrRadioAtIndex:function(){},setTabIndexForListItemChildren:function(){},getPrimaryTextAtIndex:function(){return""}}},enumerable:!1,configurable:!0}),r.prototype.layout=function(){this.adapter.getListItemCount()!==0&&(this.adapter.hasCheckboxAtIndex(0)?this.isCheckboxList=!0:this.adapter.hasRadioAtIndex(0)?this.isRadioList=!0:this.maybeInitializeSingleSelection(),this.hasTypeahead&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex()))},r.prototype.getFocusedItemIndex=function(){return this.focusedItemIndex},r.prototype.setWrapFocus=function(s){this.wrapFocus=s},r.prototype.setVerticalOrientation=function(s){this.isVertical=s},r.prototype.setSingleSelection=function(s){this.isSingleSelectionList=s,s&&(this.maybeInitializeSingleSelection(),this.selectedIndex=this.getSelectedIndexFromDOM())},r.prototype.maybeInitializeSingleSelection=function(){var s=this.getSelectedIndexFromDOM();if(s!==ya.UNSET_INDEX){var y=this.adapter.listItemAtIndexHasClass(s,Nr.LIST_ITEM_ACTIVATED_CLASS);y&&this.setUseActivatedClass(!0),this.isSingleSelectionList=!0,this.selectedIndex=s}},r.prototype.getSelectedIndexFromDOM=function(){for(var s=ya.UNSET_INDEX,y=this.adapter.getListItemCount(),w=0;w<y;w++){var z=this.adapter.listItemAtIndexHasClass(w,Nr.LIST_ITEM_SELECTED_CLASS),f=this.adapter.listItemAtIndexHasClass(w,Nr.LIST_ITEM_ACTIVATED_CLASS);if(!!(z||f)){s=w;break}}return s},r.prototype.setHasTypeahead=function(s){this.hasTypeahead=s,s&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex())},r.prototype.isTypeaheadInProgress=function(){return this.hasTypeahead&&Iv(this.typeaheadState)},r.prototype.setUseActivatedClass=function(s){this.useActivatedClass=s},r.prototype.setUseSelectedAttribute=function(s){this.useSelectedAttr=s},r.prototype.getSelectedIndex=function(){return this.selectedIndex},r.prototype.setSelectedIndex=function(s,y){var w=y===void 0?{}:y,z=w.forceUpdate;!this.isIndexValid(s)||(this.isCheckboxList?this.setCheckboxAtIndex(s):this.isRadioList?this.setRadioAtIndex(s):this.setSingleSelectionAtIndex(s,{forceUpdate:z}))},r.prototype.handleFocusIn=function(s){s>=0&&(this.focusedItemIndex=s,this.adapter.setAttributeForElementIndex(s,"tabindex","0"),this.adapter.setTabIndexForListItemChildren(s,"0"))},r.prototype.handleFocusOut=function(s){var y=this;s>=0&&(this.adapter.setAttributeForElementIndex(s,"tabindex","-1"),this.adapter.setTabIndexForListItemChildren(s,"-1")),setTimeout(function(){y.adapter.isFocusInsideList()||y.setTabindexToFirstSelectedOrFocusedItem()},0)},r.prototype.handleKeydown=function(s,y,w){var z=this,f=es(s)==="ArrowLeft",p=es(s)==="ArrowUp",L=es(s)==="ArrowRight",N=es(s)==="ArrowDown",U=es(s)==="Home",G=es(s)==="End",X=es(s)==="Enter",Se=es(s)==="Spacebar",ge=s.key==="A"||s.key==="a";if(this.adapter.isRootFocused()){if(p||G?(s.preventDefault(),this.focusLastElement()):(N||U)&&(s.preventDefault(),this.focusFirstElement()),this.hasTypeahead){var De={event:s,focusItemAtIndex:function(Ue){z.focusItemAtIndex(Ue)},focusedItemIndex:-1,isTargetListItem:y,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(Ue){return z.adapter.listItemAtIndexHasClass(Ue,Nr.LIST_ITEM_DISABLED_CLASS)}};E_(De,this.typeaheadState)}return}var Le=this.adapter.getFocusedElementIndex();if(!(Le===-1&&(Le=w,Le<0))){if(this.isVertical&&N||!this.isVertical&&L)Jh(s),this.focusNextElement(Le);else if(this.isVertical&&p||!this.isVertical&&f)Jh(s),this.focusPrevElement(Le);else if(U)Jh(s),this.focusFirstElement();else if(G)Jh(s),this.focusLastElement();else if(ge&&s.ctrlKey&&this.isCheckboxList)s.preventDefault(),this.toggleAll(this.selectedIndex===ya.UNSET_INDEX?[]:this.selectedIndex);else if((X||Se)&&y){var ft=s.target;if(ft&&ft.tagName==="A"&&X||(Jh(s),this.adapter.listItemAtIndexHasClass(Le,Nr.LIST_ITEM_DISABLED_CLASS)))return;this.isTypeaheadInProgress()||(this.isSelectableList()&&this.setSelectedIndexOnAction(Le),this.adapter.notifyAction(Le))}if(this.hasTypeahead){var De={event:s,focusItemAtIndex:function(Re){z.focusItemAtIndex(Re)},focusedItemIndex:this.focusedItemIndex,isTargetListItem:y,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(Re){return z.adapter.listItemAtIndexHasClass(Re,Nr.LIST_ITEM_DISABLED_CLASS)}};E_(De,this.typeaheadState)}}},r.prototype.handleClick=function(s,y){s!==ya.UNSET_INDEX&&(this.adapter.listItemAtIndexHasClass(s,Nr.LIST_ITEM_DISABLED_CLASS)||(this.isSelectableList()&&this.setSelectedIndexOnAction(s,y),this.adapter.notifyAction(s)))},r.prototype.focusNextElement=function(s){var y=this.adapter.getListItemCount(),w=s+1;if(w>=y)if(this.wrapFocus)w=0;else return s;return this.focusItemAtIndex(w),w},r.prototype.focusPrevElement=function(s){var y=s-1;if(y<0)if(this.wrapFocus)y=this.adapter.getListItemCount()-1;else return s;return this.focusItemAtIndex(y),y},r.prototype.focusFirstElement=function(){return this.focusItemAtIndex(0),0},r.prototype.focusLastElement=function(){var s=this.adapter.getListItemCount()-1;return this.focusItemAtIndex(s),s},r.prototype.focusInitialElement=function(){var s=this.getFirstSelectedOrFocusedItemIndex();return this.focusItemAtIndex(s),s},r.prototype.setEnabled=function(s,y){!this.isIndexValid(s)||(y?(this.adapter.removeClassForElementIndex(s,Nr.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(s,dh.ARIA_DISABLED,"false")):(this.adapter.addClassForElementIndex(s,Nr.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(s,dh.ARIA_DISABLED,"true")))},r.prototype.setSingleSelectionAtIndex=function(s,y){var w=y===void 0?{}:y,z=w.forceUpdate;if(!(this.selectedIndex===s&&!z)){var f=Nr.LIST_ITEM_SELECTED_CLASS;this.useActivatedClass&&(f=Nr.LIST_ITEM_ACTIVATED_CLASS),this.selectedIndex!==ya.UNSET_INDEX&&this.adapter.removeClassForElementIndex(this.selectedIndex,f),this.setAriaForSingleSelectionAtIndex(s),this.setTabindexAtIndex(s),s!==ya.UNSET_INDEX&&this.adapter.addClassForElementIndex(s,f),this.selectedIndex=s}},r.prototype.setAriaForSingleSelectionAtIndex=function(s){this.selectedIndex===ya.UNSET_INDEX&&(this.ariaCurrentAttrValue=this.adapter.getAttributeForElementIndex(s,dh.ARIA_CURRENT));var y=this.ariaCurrentAttrValue!==null,w=y?dh.ARIA_CURRENT:dh.ARIA_SELECTED;if(this.selectedIndex!==ya.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,w,"false"),s!==ya.UNSET_INDEX){var z=y?this.ariaCurrentAttrValue:"true";this.adapter.setAttributeForElementIndex(s,w,z)}},r.prototype.getSelectionAttribute=function(){return this.useSelectedAttr?dh.ARIA_SELECTED:dh.ARIA_CHECKED},r.prototype.setRadioAtIndex=function(s){var y=this.getSelectionAttribute();this.adapter.setCheckedCheckboxOrRadioAtIndex(s,!0),this.selectedIndex!==ya.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,y,"false"),this.adapter.setAttributeForElementIndex(s,y,"true"),this.selectedIndex=s},r.prototype.setCheckboxAtIndex=function(s){for(var y=this.getSelectionAttribute(),w=0;w<this.adapter.getListItemCount();w++){var z=!1;s.indexOf(w)>=0&&(z=!0),this.adapter.setCheckedCheckboxOrRadioAtIndex(w,z),this.adapter.setAttributeForElementIndex(w,y,z?"true":"false")}this.selectedIndex=s},r.prototype.setTabindexAtIndex=function(s){this.focusedItemIndex===ya.UNSET_INDEX&&s!==0?this.adapter.setAttributeForElementIndex(0,"tabindex","-1"):this.focusedItemIndex>=0&&this.focusedItemIndex!==s&&this.adapter.setAttributeForElementIndex(this.focusedItemIndex,"tabindex","-1"),!(this.selectedIndex instanceof Array)&&this.selectedIndex!==s&&this.adapter.setAttributeForElementIndex(this.selectedIndex,"tabindex","-1"),s!==ya.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(s,"tabindex","0")},r.prototype.isSelectableList=function(){return this.isSingleSelectionList||this.isCheckboxList||this.isRadioList},r.prototype.setTabindexToFirstSelectedOrFocusedItem=function(){var s=this.getFirstSelectedOrFocusedItemIndex();this.setTabindexAtIndex(s)},r.prototype.getFirstSelectedOrFocusedItemIndex=function(){return this.isSelectableList()?typeof this.selectedIndex=="number"&&this.selectedIndex!==ya.UNSET_INDEX?this.selectedIndex:gb(this.selectedIndex)&&this.selectedIndex.length>0?this.selectedIndex.reduce(function(s,y){return Math.min(s,y)}):0:Math.max(this.focusedItemIndex,0)},r.prototype.isIndexValid=function(s){var y=this;if(s instanceof Array){if(!this.isCheckboxList)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");return s.length===0?!0:s.some(function(w){return y.isIndexInRange(w)})}else if(typeof s=="number"){if(this.isCheckboxList)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+s);return this.isIndexInRange(s)||this.isSingleSelectionList&&s===ya.UNSET_INDEX}else return!1},r.prototype.isIndexInRange=function(s){var y=this.adapter.getListItemCount();return s>=0&&s<y},r.prototype.setSelectedIndexOnAction=function(s,y){y===void 0&&(y=!0),this.isCheckboxList?this.toggleCheckboxAtIndex(s,y):this.setSelectedIndex(s)},r.prototype.toggleCheckboxAtIndex=function(s,y){var w=this.getSelectionAttribute(),z=this.adapter.isCheckboxCheckedAtIndex(s);y&&(z=!z,this.adapter.setCheckedCheckboxOrRadioAtIndex(s,z)),this.adapter.setAttributeForElementIndex(s,w,z?"true":"false");var f=this.selectedIndex===ya.UNSET_INDEX?[]:this.selectedIndex.slice();z?f.push(s):f=f.filter(function(p){return p!==s}),this.selectedIndex=f},r.prototype.focusItemAtIndex=function(s){this.adapter.focusItemAtIndex(s),this.focusedItemIndex=s},r.prototype.toggleAll=function(s){var y=this.adapter.getListItemCount();if(s.length===y)this.setCheckboxAtIndex([]);else{for(var w=[],z=0;z<y;z++)(!this.adapter.listItemAtIndexHasClass(z,Nr.LIST_ITEM_DISABLED_CLASS)||s.indexOf(z)>-1)&&w.push(z);this.setCheckboxAtIndex(w)}},r.prototype.typeaheadMatchItem=function(s,y,w){var z=this;w===void 0&&(w=!1);var f={focusItemAtIndex:function(p){z.focusItemAtIndex(p)},focusedItemIndex:y||this.focusedItemIndex,nextChar:s,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:w,isItemAtIndexDisabled:function(p){return z.adapter.listItemAtIndexHasClass(p,Nr.LIST_ITEM_DISABLED_CLASS)}};return jy(f,this.typeaheadState)},r.prototype.typeaheadInitSortedIndex=function(){return fb(this.adapter.getListItemCount(),this.adapter.getPrimaryTextAtIndex)},r.prototype.clearTypeaheadBuffer=function(){Tv(this.typeaheadState)},r}(Rc);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var js={ANIMATE:"mdc-drawer--animate",CLOSING:"mdc-drawer--closing",DISMISSIBLE:"mdc-drawer--dismissible",MODAL:"mdc-drawer--modal",OPEN:"mdc-drawer--open",OPENING:"mdc-drawer--opening",ROOT:"mdc-drawer"},vb={APP_CONTENT_SELECTOR:".mdc-drawer-app-content",CLOSE_EVENT:"MDCDrawer:closed",OPEN_EVENT:"MDCDrawer:opened",SCRIM_SELECTOR:".mdc-drawer-scrim",LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",LIST_ITEM_ACTIVATED_SELECTOR:".mdc-list-item--activated,.mdc-deprecated-list-item--activated"};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Av=function(u){pl(r,u);function r(s){var y=u.call(this,Go(Go({},r.defaultAdapter),s))||this;return y.animationFrame=0,y.animationTimer=0,y}return Object.defineProperty(r,"strings",{get:function(){return vb},enumerable:!1,configurable:!0}),Object.defineProperty(r,"cssClasses",{get:function(){return js},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},elementHasClass:function(){return!1},notifyClose:function(){},notifyOpen:function(){},saveFocus:function(){},restoreFocus:function(){},focusActiveNavigationItem:function(){},trapFocus:function(){},releaseFocus:function(){}}},enumerable:!1,configurable:!0}),r.prototype.destroy=function(){this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.animationTimer&&clearTimeout(this.animationTimer)},r.prototype.open=function(){var s=this;this.isOpen()||this.isOpening()||this.isClosing()||(this.adapter.addClass(js.OPEN),this.adapter.addClass(js.ANIMATE),this.runNextAnimationFrame(function(){s.adapter.addClass(js.OPENING)}),this.adapter.saveFocus())},r.prototype.close=function(){!this.isOpen()||this.isOpening()||this.isClosing()||this.adapter.addClass(js.CLOSING)},r.prototype.isOpen=function(){return this.adapter.hasClass(js.OPEN)},r.prototype.isOpening=function(){return this.adapter.hasClass(js.OPENING)||this.adapter.hasClass(js.ANIMATE)},r.prototype.isClosing=function(){return this.adapter.hasClass(js.CLOSING)},r.prototype.handleKeydown=function(s){var y=s.keyCode,w=s.key,z=w==="Escape"||y===27;z&&this.close()},r.prototype.handleTransitionEnd=function(s){var y=js.OPENING,w=js.CLOSING,z=js.OPEN,f=js.ANIMATE,p=js.ROOT,L=this.isElement(s.target)&&this.adapter.elementHasClass(s.target,p);!L||(this.isClosing()?(this.adapter.removeClass(z),this.closed(),this.adapter.restoreFocus(),this.adapter.notifyClose()):(this.adapter.focusActiveNavigationItem(),this.opened(),this.adapter.notifyOpen()),this.adapter.removeClass(f),this.adapter.removeClass(y),this.adapter.removeClass(w))},r.prototype.opened=function(){},r.prototype.closed=function(){},r.prototype.runNextAnimationFrame=function(s){var y=this;cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(function(){y.animationFrame=0,clearTimeout(y.animationTimer),y.animationTimer=setTimeout(s,0)})},r.prototype.isElement=function(s){return Boolean(s.classList)},r}(Rc);/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var xb=function(u){pl(r,u);function r(){return u!==null&&u.apply(this,arguments)||this}return r.prototype.handleScrimClick=function(){this.close()},r.prototype.opened=function(){this.adapter.trapFocus()},r.prototype.closed=function(){this.adapter.releaseFocus()},r}(Av);function bb(u){let r,s,y,w,z,f;const p=u[15].default,L=Zn(p,u,u[14],null);let N=[{class:s=Ln(bs({[u[1]]:!0,"mdc-drawer":!0,"mdc-drawer--dismissible":u[2]==="dismissible","mdc-drawer--modal":u[2]==="modal","smui-drawer__absolute":u[2]==="modal"&&!u[3]},u[6]))},u[8]],U={};for(let G=0;G<N.length;G+=1)U=Ti(U,N[G]);return{c(){r=mr("aside"),L&&L.c(),this.h()},l(G){r=yr(G,"ASIDE",{class:!0});var X=Vr(r);L&&L.l(X),X.forEach(Bt),this.h()},h(){Dr(r,U)},m(G,X){ki(G,r,X),L&&L.m(r,null),u[16](r),w=!0,z||(f=[Rr(y=aa.call(null,r,u[0])),Rr(u[7].call(null,r)),Oa(r,"keydown",u[17]),Oa(r,"transitionend",u[18])],z=!0)},p(G,[X]){L&&L.p&&(!w||X&16384)&&Hn(L,p,G,G[14],w?Xn(p,G[14],X,null):Wn(G[14]),null),Dr(r,U=Kn(N,[(!w||X&78&&s!==(s=Ln(bs({[G[1]]:!0,"mdc-drawer":!0,"mdc-drawer--dismissible":G[2]==="dismissible","mdc-drawer--modal":G[2]==="modal","smui-drawer__absolute":G[2]==="modal"&&!G[3]},G[6]))))&&{class:s},X&256&&G[8]])),y&&Oo(y.update)&&X&1&&y.update.call(null,G[0])},i(G){w||(li(L,G),w=!0)},o(G){pi(L,G),w=!1},d(G){G&&Bt(r),L&&L.d(G),u[16](null),z=!1,Ca(f)}}}function wb(u,r,s){const y=["use","class","variant","open","fixed","setOpen","isOpen","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r;const{FocusTrap:p}=N1,L=wo(xo());let{use:N=[]}=r,{class:U=""}=r,{variant:G=void 0}=r,{open:X=!1}=r,{fixed:Se=!0}=r,ge,De,Le={},ft=null,Ue,Re=!1;Bo("SMUI:list:nav",!0),Bo("SMUI:list:item:nav",!0),Bo("SMUI:list:wrapFocus",!0);let st=G;Qu(()=>{Ue=new p(ge,{skipInitialFocus:!0}),s(4,De=ut()),De&&De.init()}),Vp(()=>{De&&De.destroy(),Re&&Re.removeEventListener("SMUIDrawerScrim:click",xt)});function ut(){var bt,Fi;Re&&Re.removeEventListener("SMUIDrawerScrim:click",xt),G==="modal"&&(Re=(Fi=(bt=ge.parentNode)===null||bt===void 0?void 0:bt.querySelector(".mdc-drawer-scrim"))!==null&&Fi!==void 0?Fi:!1,Re&&Re.addEventListener("SMUIDrawerScrim:click",xt));const Dt=G==="dismissible"?Av:G==="modal"?xb:void 0;return Dt?new Dt({addClass:at,removeClass:$t,hasClass:ht,elementHasClass:(bi,zt)=>bi.classList.contains(zt),saveFocus:()=>ft=document.activeElement,restoreFocus:()=>{ft&&"focus"in ft&&ge.contains(document.activeElement)&&ft.focus()},focusActiveNavigationItem:()=>{const bi=ge.querySelector(".mdc-list-item--activated,.mdc-deprecated-list-item--activated");bi&&bi.focus()},notifyClose:()=>{s(9,X=!1),Aa(ge,"SMUIDrawer:closed",void 0,void 0,!0)},notifyOpen:()=>{s(9,X=!0),Aa(ge,"SMUIDrawer:opened",void 0,void 0,!0)},trapFocus:()=>Ue.trapFocus(),releaseFocus:()=>Ue.releaseFocus()}):void 0}function ht(bt){return bt in Le?Le[bt]:Ri().classList.contains(bt)}function at(bt){Le[bt]||s(6,Le[bt]=!0,Le)}function $t(bt){(!(bt in Le)||Le[bt])&&s(6,Le[bt]=!1,Le)}function xt(){De&&"handleScrimClick"in De&&De.handleScrimClick()}function qt(bt){s(9,X=bt)}function _i(){return X}function Ri(){return ge}function Ht(bt){hn[bt?"unshift":"push"](()=>{ge=bt,s(5,ge)})}const Qt=bt=>De&&De.handleKeydown(bt),Si=bt=>De&&De.handleTransitionEnd(bt);return u.$$set=bt=>{r=Ti(Ti({},r),bo(bt)),s(8,w=cr(r,y)),"use"in bt&&s(0,N=bt.use),"class"in bt&&s(1,U=bt.class),"variant"in bt&&s(2,G=bt.variant),"open"in bt&&s(9,X=bt.open),"fixed"in bt&&s(3,Se=bt.fixed),"$$scope"in bt&&s(14,f=bt.$$scope)},u.$$.update=()=>{u.$$.dirty&8212&&st!==G&&(s(13,st=G),De&&De.destroy(),s(6,Le={}),s(4,De=ut()),De&&De.init()),u.$$.dirty&528&&De&&De.isOpen()!==X&&(X?De.open():De.close())},[N,U,G,Se,De,ge,Le,L,w,X,qt,_i,Ri,st,f,z,Ht,Qt,Si]}class Eb extends gn{constructor(r){super(),_n(this,r,wb,bb,vn,{use:0,class:1,variant:2,open:9,fixed:3,setOpen:10,isOpen:11,getElement:12})}get setOpen(){return this.$$.ctx[10]}get isOpen(){return this.$$.ctx[11]}get getElement(){return this.$$.ctx[12]}}var Sb=dl({class:"mdc-drawer-app-content",component:Nd}),Ib=dl({class:"mdc-drawer__content",component:Nd}),Tb=dl({class:"mdc-drawer__header",component:Nd});dl({class:"mdc-drawer__title",component:b1});dl({class:"mdc-drawer__subtitle",component:w1});function Ab(u){let r;const s=u[37].default,y=Zn(s,u,u[43],null);return{c(){y&&y.c()},l(w){y&&y.l(w)},m(w,z){y&&y.m(w,z),r=!0},p(w,z){y&&y.p&&(!r||z[1]&4096)&&Hn(y,s,w,w[43],r?Xn(s,w[43],z,null):Wn(w[43]),null)},i(w){r||(li(y,w),r=!0)},o(w){pi(y,w),r=!1},d(w){y&&y.d(w)}}}function Cb(u){let r,s,y;const w=[{use:[u[17],...u[0]]},{class:Ln({[u[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":u[2],"mdc-deprecated-list--dense":u[3],"mdc-deprecated-list--textual-list":u[4],"mdc-deprecated-list--avatar-list":u[5]||u[18],"mdc-deprecated-list--icon-list":u[6],"mdc-deprecated-list--image-list":u[7],"mdc-deprecated-list--thumbnail-list":u[8],"mdc-deprecated-list--video-list":u[9],"mdc-deprecated-list--two-line":u[10],"smui-list--three-line":u[11]&&!u[10]})},{role:u[15]},u[23]];var z=u[12];function f(p){let L={$$slots:{default:[Ab]},$$scope:{ctx:p}};for(let N=0;N<w.length;N+=1)L=Ti(L,w[N]);return{props:L}}return z&&(r=new z(f(u)),u[38](r),r.$on("keydown",u[39]),r.$on("focusin",u[40]),r.$on("focusout",u[41]),r.$on("click",u[42]),r.$on("SMUIListItem:mount",u[19]),r.$on("SMUIListItem:unmount",u[20]),r.$on("SMUI:action",u[21])),{c(){r&&gr(r.$$.fragment),s=an()},l(p){r&&qr(r.$$.fragment,p),s=an()},m(p,L){r&&_r(r,p,L),ki(p,s,L),y=!0},p(p,L){const N=L[0]&8818687?Kn(w,[L[0]&131073&&{use:[p[17],...p[0]]},L[0]&266238&&{class:Ln({[p[1]]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":p[2],"mdc-deprecated-list--dense":p[3],"mdc-deprecated-list--textual-list":p[4],"mdc-deprecated-list--avatar-list":p[5]||p[18],"mdc-deprecated-list--icon-list":p[6],"mdc-deprecated-list--image-list":p[7],"mdc-deprecated-list--thumbnail-list":p[8],"mdc-deprecated-list--video-list":p[9],"mdc-deprecated-list--two-line":p[10],"smui-list--three-line":p[11]&&!p[10]})},L[0]&32768&&{role:p[15]},L[0]&8388608&&ts(p[23])]):{};if(L[1]&4096&&(N.$$scope={dirty:L,ctx:p}),z!==(z=p[12])){if(r){hl();const U=r;pi(U.$$.fragment,1,0,()=>{vr(U,1)}),cl()}z?(r=new z(f(p)),p[38](r),r.$on("keydown",p[39]),r.$on("focusin",p[40]),r.$on("focusout",p[41]),r.$on("click",p[42]),r.$on("SMUIListItem:mount",p[19]),r.$on("SMUIListItem:unmount",p[20]),r.$on("SMUI:action",p[21]),gr(r.$$.fragment),li(r.$$.fragment,1),_r(r,s.parentNode,s)):r=null}else z&&r.$set(N)},i(p){y||(r&&li(r.$$.fragment,p),y=!0)},o(p){r&&pi(r.$$.fragment,p),y=!1},d(p){u[38](null),p&&Bt(s),r&&vr(r,p)}}}function kb(u,r,s){const y=["use","class","nonInteractive","dense","textualList","avatarList","iconList","imageList","thumbnailList","videoList","twoLine","threeLine","vertical","wrapFocus","singleSelection","selectedIndex","radioList","checkList","hasTypeahead","component","layout","setEnabled","getTypeaheadInProgress","getSelectedIndex","getFocusedItemIndex","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r;var p;const{closest:L,matches:N}=vv,U=wo(xo());let{use:G=[]}=r,{class:X=""}=r,{nonInteractive:Se=!1}=r,{dense:ge=!1}=r,{textualList:De=!1}=r,{avatarList:Le=!1}=r,{iconList:ft=!1}=r,{imageList:Ue=!1}=r,{thumbnailList:Re=!1}=r,{videoList:st=!1}=r,{twoLine:ut=!1}=r,{threeLine:ht=!1}=r,{vertical:at=!0}=r,{wrapFocus:$t=(p=ra("SMUI:list:wrapFocus"))!==null&&p!==void 0?p:!1}=r,{singleSelection:xt=!1}=r,{selectedIndex:qt=-1}=r,{radioList:_i=!1}=r,{checkList:Ri=!1}=r,{hasTypeahead:Ht=!1}=r,Qt,Si,bt=[],Fi=ra("SMUI:list:role"),Dt=ra("SMUI:list:nav");const bi=new WeakMap;let zt=ra("SMUI:dialog:selection"),Yt=ra("SMUI:addLayoutListener"),Et,{component:xi=Dt?T1:A1}=r;Bo("SMUI:list:nonInteractive",Se),Bo("SMUI:separator:context","list"),Fi||(xt?(Fi="listbox",Bo("SMUI:list:item:role","option")):_i?(Fi="radiogroup",Bo("SMUI:list:item:role","radio")):Ri?(Fi="group",Bo("SMUI:list:item:role","checkbox")):(Fi="list",Bo("SMUI:list:item:role",void 0))),Yt&&(Et=Yt(ho)),Qu(()=>{s(13,Si=new _b({addClassForElementIndex:Mt,focusItemAtIndex:or,getAttributeForElementIndex:(_t,Ci)=>{var fr,wr;return(wr=(fr=Ai()[_t])===null||fr===void 0?void 0:fr.getAttr(Ci))!==null&&wr!==void 0?wr:null},getFocusedElementIndex:()=>document.activeElement?Ai().map(_t=>_t.element).indexOf(document.activeElement):-1,getListItemCount:()=>bt.length,getPrimaryTextAtIndex:nr,hasCheckboxAtIndex:_t=>{var Ci,fr;return(fr=(Ci=Ai()[_t])===null||Ci===void 0?void 0:Ci.hasCheckbox)!==null&&fr!==void 0?fr:!1},hasRadioAtIndex:_t=>{var Ci,fr;return(fr=(Ci=Ai()[_t])===null||Ci===void 0?void 0:Ci.hasRadio)!==null&&fr!==void 0?fr:!1},isCheckboxCheckedAtIndex:_t=>{var Ci;const fr=Ai()[_t];return(Ci=(fr==null?void 0:fr.hasCheckbox)&&fr.checked)!==null&&Ci!==void 0?Ci:!1},isFocusInsideList:()=>Qt!=null&&Yn()!==document.activeElement&&Yn().contains(document.activeElement),isRootFocused:()=>Qt!=null&&document.activeElement===Yn(),listItemAtIndexHasClass:Li,notifyAction:_t=>{s(24,qt=_t),Qt!=null&&Aa(Yn(),"SMUIList:action",{index:_t},void 0,!0)},removeClassForElementIndex:rr,setAttributeForElementIndex:Ft,setCheckedCheckboxOrRadioAtIndex:(_t,Ci)=>{Ai()[_t].checked=Ci},setTabIndexForListItemChildren:(_t,Ci)=>{const fr=Ai()[_t],wr="button:not(:disabled), a";Array.prototype.forEach.call(fr.element.querySelectorAll(wr),Qn=>{Qn.setAttribute("tabindex",Ci)})}}));const qe={get element(){return Yn()},get items(){return bt},get typeaheadInProgress(){return Si.isTypeaheadInProgress()},typeaheadMatchItem(_t,Ci){return Si.typeaheadMatchItem(_t,Ci,!0)},getOrderedList:Ai,focusItemAtIndex:or,addClassForElementIndex:Mt,removeClassForElementIndex:rr,setAttributeForElementIndex:Ft,removeAttributeForElementIndex:rt,getAttributeFromElementIndex:wi,getPrimaryTextAtIndex:nr};return Aa(Yn(),"SMUIList:mount",qe),Si.init(),()=>{Si.destroy()}}),Vp(()=>{Et&&Et()});function Gt(qe){bt.push(qe.detail),bi.set(qe.detail.element,qe.detail),xt&&qe.detail.selected&&s(24,qt=Pr(qe.detail.element)),qe.stopPropagation()}function Ji(qe){var _t;const Ci=(_t=qe.detail&&bt.indexOf(qe.detail))!==null&&_t!==void 0?_t:-1;Ci!==-1&&(bt.splice(Ci,1),bt=bt,bi.delete(qe.detail.element)),qe.stopPropagation()}function Ni(qe){if(_i||Ri){const _t=Pr(qe.target);if(_t!==-1){const Ci=Ai()[_t];Ci&&(_i&&!Ci.checked||Ri)&&(Ci.checked=!Ci.checked,Ci.activateRipple(),window.requestAnimationFrame(()=>{Ci.deactivateRipple()}))}}}function Ai(){return Qt==null?[]:[...Yn().children].map(qe=>bi.get(qe)).filter(qe=>qe&&qe._smui_list_item_accessor)}function or(qe){const _t=Ai()[qe];_t&&"focus"in _t.element&&_t.element.focus()}function Li(qe,_t){var Ci;const fr=Ai()[qe];return(Ci=fr&&fr.hasClass(_t))!==null&&Ci!==void 0?Ci:!1}function Mt(qe,_t){const Ci=Ai()[qe];Ci&&Ci.addClass(_t)}function rr(qe,_t){const Ci=Ai()[qe];Ci&&Ci.removeClass(_t)}function Ft(qe,_t,Ci){const fr=Ai()[qe];fr&&fr.addAttr(_t,Ci)}function rt(qe,_t){const Ci=Ai()[qe];Ci&&Ci.removeAttr(_t)}function wi(qe,_t){const Ci=Ai()[qe];return Ci?Ci.getAttr(_t):null}function nr(qe){var _t;const Ci=Ai()[qe];return(_t=Ci&&Ci.getPrimaryText())!==null&&_t!==void 0?_t:""}function Pr(qe){const _t=L(qe,".mdc-deprecated-list-item, .mdc-deprecated-list");return _t&&N(_t,".mdc-deprecated-list-item")?Ai().map(Ci=>Ci==null?void 0:Ci.element).indexOf(_t):-1}function ho(){return Si.layout()}function Jn(qe,_t){return Si.setEnabled(qe,_t)}function Fo(){return Si.isTypeaheadInProgress()}function xn(){return Si.getSelectedIndex()}function po(){return Si.getFocusedItemIndex()}function Yn(){return Qt.getElement()}function Wi(qe){hn[qe?"unshift":"push"](()=>{Qt=qe,s(14,Qt)})}const Nn=qe=>Si&&Si.handleKeydown(qe,qe.target.classList.contains("mdc-deprecated-list-item"),Pr(qe.target)),Ao=qe=>Si&&Si.handleFocusIn(Pr(qe.target)),$n=qe=>Si&&Si.handleFocusOut(Pr(qe.target)),Ua=qe=>Si&&Si.handleClick(Pr(qe.target),!N(qe.target,'input[type="checkbox"], input[type="radio"]'));return u.$$set=qe=>{r=Ti(Ti({},r),bo(qe)),s(23,w=cr(r,y)),"use"in qe&&s(0,G=qe.use),"class"in qe&&s(1,X=qe.class),"nonInteractive"in qe&&s(2,Se=qe.nonInteractive),"dense"in qe&&s(3,ge=qe.dense),"textualList"in qe&&s(4,De=qe.textualList),"avatarList"in qe&&s(5,Le=qe.avatarList),"iconList"in qe&&s(6,ft=qe.iconList),"imageList"in qe&&s(7,Ue=qe.imageList),"thumbnailList"in qe&&s(8,Re=qe.thumbnailList),"videoList"in qe&&s(9,st=qe.videoList),"twoLine"in qe&&s(10,ut=qe.twoLine),"threeLine"in qe&&s(11,ht=qe.threeLine),"vertical"in qe&&s(25,at=qe.vertical),"wrapFocus"in qe&&s(26,$t=qe.wrapFocus),"singleSelection"in qe&&s(27,xt=qe.singleSelection),"selectedIndex"in qe&&s(24,qt=qe.selectedIndex),"radioList"in qe&&s(28,_i=qe.radioList),"checkList"in qe&&s(29,Ri=qe.checkList),"hasTypeahead"in qe&&s(30,Ht=qe.hasTypeahead),"component"in qe&&s(12,xi=qe.component),"$$scope"in qe&&s(43,f=qe.$$scope)},u.$$.update=()=>{u.$$.dirty[0]&33562624&&Si&&Si.setVerticalOrientation(at),u.$$.dirty[0]&67117056&&Si&&Si.setWrapFocus($t),u.$$.dirty[0]&1073750016&&Si&&Si.setHasTypeahead(Ht),u.$$.dirty[0]&134225920&&Si&&Si.setSingleSelection(xt),u.$$.dirty[0]&151003136&&Si&&xt&&xn()!==qt&&Si.setSelectedIndex(qt)},[G,X,Se,ge,De,Le,ft,Ue,Re,st,ut,ht,xi,Si,Qt,Fi,N,U,zt,Gt,Ji,Ni,Pr,w,qt,at,$t,xt,_i,Ri,Ht,ho,Jn,Fo,xn,po,Yn,z,Wi,Nn,Ao,$n,Ua,f]}class zb extends gn{constructor(r){super(),_n(this,r,kb,Cb,vn,{use:0,class:1,nonInteractive:2,dense:3,textualList:4,avatarList:5,iconList:6,imageList:7,thumbnailList:8,videoList:9,twoLine:10,threeLine:11,vertical:25,wrapFocus:26,singleSelection:27,selectedIndex:24,radioList:28,checkList:29,hasTypeahead:30,component:12,layout:31,setEnabled:32,getTypeaheadInProgress:33,getSelectedIndex:34,getFocusedItemIndex:35,getElement:36},null,[-1,-1])}get layout(){return this.$$.ctx[31]}get setEnabled(){return this.$$.ctx[32]}get getTypeaheadInProgress(){return this.$$.ctx[33]}get getSelectedIndex(){return this.$$.ctx[34]}get getFocusedItemIndex(){return this.$$.ctx[35]}get getElement(){return this.$$.ctx[36]}}function S_(u){let r;return{c(){r=mr("span"),this.h()},l(s){r=yr(s,"SPAN",{class:!0}),Vr(r).forEach(Bt),this.h()},h(){jr(r,"class","mdc-deprecated-list-item__ripple")},m(s,y){ki(s,r,y)},d(s){s&&Bt(r)}}}function Pb(u){let r,s,y=u[7]&&S_();const w=u[32].default,z=Zn(w,u,u[35],null);return{c(){y&&y.c(),r=an(),z&&z.c()},l(f){y&&y.l(f),r=an(),z&&z.l(f)},m(f,p){y&&y.m(f,p),ki(f,r,p),z&&z.m(f,p),s=!0},p(f,p){f[7]?y||(y=S_(),y.c(),y.m(r.parentNode,r)):y&&(y.d(1),y=null),z&&z.p&&(!s||p[1]&16)&&Hn(z,w,f,f[35],s?Xn(w,f[35],p,null):Wn(f[35]),null)},i(f){s||(li(z,f),s=!0)},o(f){pi(z,f),s=!1},d(f){y&&y.d(f),f&&Bt(r),z&&z.d(f)}}}function Mb(u){let r,s,y;const w=[{use:[...u[6]?[]:[[Fp,{ripple:!u[14],unbounded:!1,color:(u[1]||u[0])&&u[5]==null?"primary":u[5],disabled:u[9],addClass:u[22],removeClass:u[23],addStyle:u[24]}]],u[20],...u[2]]},{class:Ln(bs({[u[3]]:!0,"mdc-deprecated-list-item":!0,"mdc-deprecated-list-item--activated":u[1],"mdc-deprecated-list-item--selected":u[0],"mdc-deprecated-list-item--disabled":u[9],"mdc-menu-item--selected":!u[21]&&u[8]==="menuitem"&&u[0],"smui-menu-item--non-interactive":u[6]},u[16]))},{style:Object.entries(u[17]).map(I_).concat([u[4]]).join(" ")},u[21]&&u[1]?{"aria-current":"page"}:{},u[21]?{}:{role:u[8]},!u[21]&&u[8]==="option"?{"aria-selected":u[0]?"true":"false"}:{},!u[21]&&(u[8]==="radio"||u[8]==="checkbox")?{"aria-checked":u[14]&&u[14].checked?"true":"false"}:{},u[21]?{}:{"aria-disabled":u[9]?"true":"false"},{"data-menu-item-skip-restore-focus":u[10]||void 0},{tabindex:u[19]},{href:u[11]},u[18],u[27]];var z=u[12];function f(p){let L={$$slots:{default:[Pb]},$$scope:{ctx:p}};for(let N=0;N<w.length;N+=1)L=Ti(L,w[N]);return{props:L}}return z&&(r=new z(f(u)),u[33](r),r.$on("click",u[13]),r.$on("keydown",u[25]),r.$on("SMUIGenericInput:mount",u[26]),r.$on("SMUIGenericInput:unmount",u[34])),{c(){r&&gr(r.$$.fragment),s=an()},l(p){r&&qr(r.$$.fragment,p),s=an()},m(p,L){r&&_r(r,p,L),ki(p,s,L),y=!0},p(p,L){const N=L[0]&167726975?Kn(w,[L[0]&30425703&&{use:[...p[6]?[]:[[Fp,{ripple:!p[14],unbounded:!1,color:(p[1]||p[0])&&p[5]==null?"primary":p[5],disabled:p[9],addClass:p[22],removeClass:p[23],addStyle:p[24]}]],p[20],...p[2]]},L[0]&2163531&&{class:Ln(bs({[p[3]]:!0,"mdc-deprecated-list-item":!0,"mdc-deprecated-list-item--activated":p[1],"mdc-deprecated-list-item--selected":p[0],"mdc-deprecated-list-item--disabled":p[9],"mdc-menu-item--selected":!p[21]&&p[8]==="menuitem"&&p[0],"smui-menu-item--non-interactive":p[6]},p[16]))},L[0]&131088&&{style:Object.entries(p[17]).map(I_).concat([p[4]]).join(" ")},L[0]&2097154&&ts(p[21]&&p[1]?{"aria-current":"page"}:{}),L[0]&2097408&&ts(p[21]?{}:{role:p[8]}),L[0]&2097409&&ts(!p[21]&&p[8]==="option"?{"aria-selected":p[0]?"true":"false"}:{}),L[0]&2113792&&ts(!p[21]&&(p[8]==="radio"||p[8]==="checkbox")?{"aria-checked":p[14]&&p[14].checked?"true":"false"}:{}),L[0]&2097664&&ts(p[21]?{}:{"aria-disabled":p[9]?"true":"false"}),L[0]&1024&&{"data-menu-item-skip-restore-focus":p[10]||void 0},L[0]&524288&&{tabindex:p[19]},L[0]&2048&&{href:p[11]},L[0]&262144&&ts(p[18]),L[0]&134217728&&ts(p[27])]):{};if(L[0]&128|L[1]&16&&(N.$$scope={dirty:L,ctx:p}),z!==(z=p[12])){if(r){hl();const U=r;pi(U.$$.fragment,1,0,()=>{vr(U,1)}),cl()}z?(r=new z(f(p)),p[33](r),r.$on("click",p[13]),r.$on("keydown",p[25]),r.$on("SMUIGenericInput:mount",p[26]),r.$on("SMUIGenericInput:unmount",p[34]),gr(r.$$.fragment),li(r.$$.fragment,1),_r(r,s.parentNode,s)):r=null}else z&&r.$set(N)},i(p){y||(r&&li(r.$$.fragment,p),y=!0)},o(p){r&&pi(r.$$.fragment,p),y=!1},d(p){u[33](null),p&&Bt(s),r&&vr(r,p)}}}let Lb=0;const I_=([u,r])=>`${u}: ${r};`;function Db(u,r,s){let y;const w=["use","class","style","color","nonInteractive","ripple","activated","role","selected","disabled","skipRestoreFocus","tabindex","inputId","href","component","action","getPrimaryText","getElement"];let z=cr(r,w),{$$slots:f={},$$scope:p}=r;var L;const N=wo(xo());let U=()=>{};function G(rt){return rt===U}let{use:X=[]}=r,{class:Se=""}=r,{style:ge=""}=r,{color:De=void 0}=r,{nonInteractive:Le=(L=ra("SMUI:list:nonInteractive"))!==null&&L!==void 0?L:!1}=r;Bo("SMUI:list:nonInteractive",void 0);let{ripple:ft=!Le}=r,{activated:Ue=!1}=r,{role:Re=ra("SMUI:list:item:role")}=r;Bo("SMUI:list:item:role",void 0);let{selected:st=!1}=r,{disabled:ut=!1}=r,{skipRestoreFocus:ht=!1}=r,{tabindex:at=U}=r,{inputId:$t="SMUI-form-field-list-"+Lb++}=r,{href:xt=void 0}=r,qt,_i={},Ri={},Ht={},Qt,Si,bt=ra("SMUI:list:item:nav"),{component:Fi=bt?xt?Ev:Zp:S1}=r;Bo("SMUI:generic:input:props",{id:$t}),Bo("SMUI:separator:context",void 0),Qu(()=>{if(!st&&!Le){let wi=!0,nr=qt;for(;nr.previousSibling;)if(nr=nr.previousSibling,nr.nodeType===1&&nr.classList.contains("mdc-deprecated-list-item")&&!nr.classList.contains("mdc-deprecated-list-item--disabled")){wi=!1;break}wi&&(Si=window.requestAnimationFrame(Ji))}const rt={_smui_list_item_accessor:!0,get element(){return Mt()},get selected(){return st},set selected(wi){s(0,st=wi)},hasClass:Dt,addClass:bi,removeClass:zt,getAttr:Et,addAttr:xi,removeAttr:Gt,getPrimaryText:Li,get checked(){var wi;return(wi=Qt&&Qt.checked)!==null&&wi!==void 0?wi:!1},set checked(wi){Qt&&s(14,Qt.checked=!!wi,Qt)},get hasCheckbox(){return!!(Qt&&"_smui_checkbox_accessor"in Qt)},get hasRadio(){return!!(Qt&&"_smui_radio_accessor"in Qt)},activateRipple(){Qt&&Qt.activateRipple()},deactivateRipple(){Qt&&Qt.deactivateRipple()},getValue(){return z.value},action:or,get tabindex(){return y},set tabindex(wi){s(28,at=wi)},get disabled(){return ut},get activated(){return Ue},set activated(wi){s(1,Ue=wi)}};return Aa(Mt(),"SMUIListItem:mount",rt),()=>{Aa(Mt(),"SMUIListItem:unmount",rt)}}),Vp(()=>{Si&&window.cancelAnimationFrame(Si)});function Dt(rt){return rt in _i?_i[rt]:Mt().classList.contains(rt)}function bi(rt){_i[rt]||s(16,_i[rt]=!0,_i)}function zt(rt){(!(rt in _i)||_i[rt])&&s(16,_i[rt]=!1,_i)}function Yt(rt,wi){Ri[rt]!=wi&&(wi===""||wi==null?(delete Ri[rt],s(17,Ri)):s(17,Ri[rt]=wi,Ri))}function Et(rt){var wi;return rt in Ht?(wi=Ht[rt])!==null&&wi!==void 0?wi:null:Mt().getAttribute(rt)}function xi(rt,wi){Ht[rt]!==wi&&s(18,Ht[rt]=wi,Ht)}function Gt(rt){(!(rt in Ht)||Ht[rt]!=null)&&s(18,Ht[rt]=void 0,Ht)}function Ji(){let rt=!0,wi=qt.getElement();for(;wi.nextElementSibling;)if(wi=wi.nextElementSibling,wi.nodeType===1&&wi.classList.contains("mdc-deprecated-list-item")){const nr=wi.attributes.getNamedItem("tabindex");if(nr&&nr.value==="0"){rt=!1;break}}rt&&s(19,y=0)}function Ni(rt){const wi=rt.key==="Enter",nr=rt.key==="Space";(wi||nr)&&or(rt)}function Ai(rt){("_smui_checkbox_accessor"in rt.detail||"_smui_radio_accessor"in rt.detail)&&s(14,Qt=rt.detail)}function or(rt){ut||Aa(Mt(),"SMUI:action",rt)}function Li(){var rt,wi,nr;const Pr=Mt(),ho=Pr.querySelector(".mdc-deprecated-list-item__primary-text");if(ho)return(rt=ho.textContent)!==null&&rt!==void 0?rt:"";const Jn=Pr.querySelector(".mdc-deprecated-list-item__text");return Jn?(wi=Jn.textContent)!==null&&wi!==void 0?wi:"":(nr=Pr.textContent)!==null&&nr!==void 0?nr:""}function Mt(){return qt.getElement()}function rr(rt){hn[rt?"unshift":"push"](()=>{qt=rt,s(15,qt)})}const Ft=()=>s(14,Qt=void 0);return u.$$set=rt=>{r=Ti(Ti({},r),bo(rt)),s(27,z=cr(r,w)),"use"in rt&&s(2,X=rt.use),"class"in rt&&s(3,Se=rt.class),"style"in rt&&s(4,ge=rt.style),"color"in rt&&s(5,De=rt.color),"nonInteractive"in rt&&s(6,Le=rt.nonInteractive),"ripple"in rt&&s(7,ft=rt.ripple),"activated"in rt&&s(1,Ue=rt.activated),"role"in rt&&s(8,Re=rt.role),"selected"in rt&&s(0,st=rt.selected),"disabled"in rt&&s(9,ut=rt.disabled),"skipRestoreFocus"in rt&&s(10,ht=rt.skipRestoreFocus),"tabindex"in rt&&s(28,at=rt.tabindex),"inputId"in rt&&s(29,$t=rt.inputId),"href"in rt&&s(11,xt=rt.href),"component"in rt&&s(12,Fi=rt.component),"$$scope"in rt&&s(35,p=rt.$$scope)},u.$$.update=()=>{u.$$.dirty[0]&268452417&&s(19,y=G(at)?!Le&&!ut&&(st||Qt&&Qt.checked)?0:-1:at)},[st,Ue,X,Se,ge,De,Le,ft,Re,ut,ht,xt,Fi,or,Qt,qt,_i,Ri,Ht,y,N,bt,bi,zt,Yt,Ni,Ai,z,at,$t,Li,Mt,f,rr,Ft,p]}class Rb extends gn{constructor(r){super(),_n(this,r,Db,Mb,vn,{use:2,class:3,style:4,color:5,nonInteractive:6,ripple:7,activated:1,role:8,selected:0,disabled:9,skipRestoreFocus:10,tabindex:28,inputId:29,href:11,component:12,action:13,getPrimaryText:30,getElement:31},null,[-1,-1])}get action(){return this.$$.ctx[13]}get getPrimaryText(){return this.$$.ctx[30]}get getElement(){return this.$$.ctx[31]}}dl({class:"mdc-deprecated-list-item__text",component:Zp});dl({class:"mdc-deprecated-list-item__primary-text",component:Zp});dl({class:"mdc-deprecated-list-item__secondary-text",component:Zp});dl({class:"mdc-deprecated-list-item__meta",component:Zp});dl({class:"mdc-deprecated-list-group",component:Nd});dl({class:"mdc-deprecated-list-group__subheader",component:E1});const $f=Rb;/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Bb={SINGLE_SELECT:"mdc-segmented-button--single-select"};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Ob=function(u){pl(r,u);function r(s){return u.call(this,Go(Go({},r.defaultAdapter),s))||this}return Object.defineProperty(r,"defaultAdapter",{get:function(){return{hasClass:function(){return!1},getSegments:function(){return[]},selectSegment:function(){},unselectSegment:function(){},notifySelectedChange:function(){}}},enumerable:!1,configurable:!0}),r.prototype.selectSegment=function(s){this.adapter.selectSegment(s)},r.prototype.unselectSegment=function(s){this.adapter.unselectSegment(s)},r.prototype.getSelectedSegments=function(){return this.adapter.getSegments().filter(function(s){return s.selected})},r.prototype.isSegmentSelected=function(s){return this.adapter.getSegments().some(function(y){return(y.index===s||y.segmentId===s)&&y.selected})},r.prototype.isSingleSelect=function(){return this.adapter.hasClass(Bb.SINGLE_SELECT)},r.prototype.handleSelected=function(s){this.isSingleSelect()&&this.unselectPrevSelected(s.index),this.adapter.notifySelectedChange(s)},r.prototype.unselectPrevSelected=function(s){var y,w;try{for(var z=Md(this.getSelectedSegments()),f=z.next();!f.done;f=z.next()){var p=f.value;p.index!==s&&this.unselectSegment(p.index)}}catch(L){y={error:L}}finally{try{f&&!f.done&&(w=z.return)&&w.call(z)}finally{if(y)throw y.error}}},r}(Rc);function T_(u,r,s){const y=u.slice();return y[30]=r[s],y[32]=s,y}const Fb=u=>({segment:u[0]&4}),A_=u=>({segment:u[30]});function Ub(u){let r;const s=u[16].default,y=Zn(s,u,u[21],A_);return{c(){y&&y.c()},l(w){y&&y.l(w)},m(w,z){y&&y.m(w,z),r=!0},p(w,z){y&&y.p&&(!r||z[0]&2097156)&&Hn(y,s,w,w[21],r?Xn(s,w[21],z,Fb):Wn(w[21]),A_)},i(w){r||(li(y,w),r=!0)},o(w){pi(y,w),r=!1},d(w){y&&y.d(w)}}}function Nb(u){let r,s,y;return r=new Sv({props:{key:"SMUI:segmented-button:segment:initialSelected",value:u[8][u[32]],$$slots:{default:[Ub]},$$scope:{ctx:u}}}),{c(){gr(r.$$.fragment),s=na()},l(w){qr(r.$$.fragment,w),s=oa(w)},m(w,z){_r(r,w,z),ki(w,s,z),y=!0},p(w,z){const f={};z[0]&4&&(f.value=w[8][w[32]]),z[0]&2097156&&(f.$$scope={dirty:z,ctx:w}),r.$set(f)},i(w){y||(li(r.$$.fragment,w),y=!0)},o(w){pi(r.$$.fragment,w),y=!1},d(w){vr(r,w),w&&Bt(s)}}}function C_(u,r){let s,y,w;return y=new Sv({props:{key:"SMUI:segmented-button:segment:index",value:r[32],$$slots:{default:[Nb]},$$scope:{ctx:r}}}),{key:u,first:null,c(){s=an(),gr(y.$$.fragment),this.h()},l(z){s=an(),qr(y.$$.fragment,z),this.h()},h(){this.first=s},m(z,f){ki(z,s,f),_r(y,z,f),w=!0},p(z,f){r=z;const p={};f[0]&4&&(p.value=r[32]),f[0]&2097156&&(p.$$scope={dirty:f,ctx:r}),y.$set(p)},i(z){w||(li(y.$$.fragment,z),w=!0)},o(z){pi(y.$$.fragment,z),w=!1},d(z){z&&Bt(s),vr(y,z)}}}function jb(u){let r,s=[],y=new Map,w,z,f,p,L,N,U=u[2];const G=ge=>ge[3](ge[30]);for(let ge=0;ge<U.length;ge+=1){let De=T_(u,U,ge),Le=G(De);y.set(Le,s[ge]=C_(Le,De))}let X=[{class:w=Ln({[u[1]]:!0,"mdc-segmented-button":!0,"mdc-segmented-button--single-select":u[4]})},{role:z=u[4]?"radiogroup":"group"},u[12]],Se={};for(let ge=0;ge<X.length;ge+=1)Se=Ti(Se,X[ge]);return{c(){r=mr("div");for(let ge=0;ge<s.length;ge+=1)s[ge].c();this.h()},l(ge){r=yr(ge,"DIV",{class:!0,role:!0});var De=Vr(r);for(let Le=0;Le<s.length;Le+=1)s[Le].l(De);De.forEach(Bt),this.h()},h(){Dr(r,Se)},m(ge,De){ki(ge,r,De);for(let Le=0;Le<s.length;Le+=1)s[Le].m(r,null);u[17](r),p=!0,L||(N=[Rr(f=aa.call(null,r,u[0])),Rr(u[7].call(null,r)),Oa(r,"SMUISegmentedButtonSegment:mount",u[18]),Oa(r,"SMUISegmentedButtonSegment:unmount",u[19]),Oa(r,"selected",u[20])],L=!0)},p(ge,De){De[0]&2097420&&(U=ge[2],hl(),s=_x(s,De,G,1,ge,U,y,r,vx,C_,null,T_),cl()),Dr(r,Se=Kn(X,[(!p||De[0]&18&&w!==(w=Ln({[ge[1]]:!0,"mdc-segmented-button":!0,"mdc-segmented-button--single-select":ge[4]})))&&{class:w},(!p||De[0]&16&&z!==(z=ge[4]?"radiogroup":"group"))&&{role:z},De[0]&4096&&ge[12]])),f&&Oo(f.update)&&De[0]&1&&f.update.call(null,ge[0])},i(ge){if(!p){for(let De=0;De<U.length;De+=1)li(s[De]);p=!0}},o(ge){for(let De=0;De<s.length;De+=1)pi(s[De]);p=!1},d(ge){ge&&Bt(r);for(let De=0;De<s.length;De+=1)s[De].d();u[17](null),L=!1,Ca(N)}}}function k_(u,r){let s=new Set(u);for(let y of r)s.delete(y);return s}function Vb(u,r,s){const y=["use","class","segments","key","singleSelect","selected","getElement"];let w=cr(r,y),z,{$$slots:f={},$$scope:p}=r;const L=wo(xo());let{use:N=[]}=r,{class:U=""}=r,{segments:G=[]}=r,{key:X=Dt=>Dt}=r,{singleSelect:Se=!1}=r,{selected:ge=Se?void 0:[]}=r,De,Le,ft={},Ue=new WeakMap,Re=G.map(Dt=>Se&&ge===Dt||!Se&&ge.indexOf(Dt)!==-1);Bo("SMUI:icon:context","segmented-button"),Bo("SMUI:label:context","segmented-button");const st=Yf(Se);Lc(u,st,Dt=>s(23,z=Dt)),Bo("SMUI:segmented-button:singleSelect",st);let ut=Se?ge:new Set(ge);Qu(()=>(s(5,Le=new Ob({hasClass:Dt=>Ht().classList.contains(Dt),getSegments:()=>G.map((Dt,bi)=>({index:bi,selected:Se?ge===Dt:ge.indexOf(Dt)!==-1})),selectSegment:_i,unselectSegment:Ri,notifySelectedChange:Dt=>{Dt.selected?_i(Dt.index):Ri(Dt.index),Aa(Ht(),"change",Dt)}})),Le.init(),()=>{Le.destroy()}));function ht(Dt){const bi=Dt.detail;xt(bi.segmentId,bi)}function at(Dt){const bi=Dt.detail;qt(bi.segmentId)}function $t(Dt){return Dt instanceof Object?Ue.get(Dt):ft[Dt]}function xt(Dt,bi){Dt instanceof Object?Ue.set(Dt,bi):ft[Dt]=bi}function qt(Dt){Dt instanceof Object?Ue.delete(Dt):delete ft[Dt]}function _i(Dt){let bi=G.indexOf(Dt);bi===-1&&(bi=Dt),Se?ge!==G[bi]&&s(13,ge=G[bi]):ge.indexOf(G[bi])===-1&&(ge.push(G[bi]),s(13,ge));const zt=$t(G[bi]);zt&&(zt.selected=!0)}function Ri(Dt){let bi=G.indexOf(Dt);if(bi===-1&&(bi=Dt),Se)ge===G[bi]&&s(13,ge=null);else{const Yt=ge.indexOf(G[bi]);Yt!==-1&&(ge.splice(Yt,1),s(13,ge))}const zt=$t(G[bi]);zt&&(zt.selected=!1)}function Ht(){return De}function Qt(Dt){hn[Dt?"unshift":"push"](()=>{De=Dt,s(6,De)})}const Si=Dt=>ht(Dt),bt=Dt=>at(Dt),Fi=Dt=>Le&&Le.handleSelected(Dt.detail);return u.$$set=Dt=>{r=Ti(Ti({},r),bo(Dt)),s(12,w=cr(r,y)),"use"in Dt&&s(0,N=Dt.use),"class"in Dt&&s(1,U=Dt.class),"segments"in Dt&&s(2,G=Dt.segments),"key"in Dt&&s(3,X=Dt.key),"singleSelect"in Dt&&s(4,Se=Dt.singleSelect),"selected"in Dt&&s(13,ge=Dt.selected),"$$scope"in Dt&&s(21,p=Dt.$$scope)},u.$$.update=()=>{if(u.$$.dirty[0]&16&&gv(st,z=Se,z),u.$$.dirty[0]&41008&&Le&&Se&&ut!==ge&&(ut!=null&&Le.unselectSegment(ut),s(15,ut=ge),ge!=null&&Le.selectSegment(ge)),u.$$.dirty[0]&41012&&Le&&!Se){const Dt=new Set(ge),bi=k_(ut,Dt),zt=k_(Dt,ut);if(bi.size||zt.size){s(15,ut=Dt);for(let Yt of bi){const Et=G.indexOf(Yt);Et!==-1&&Le.unselectSegment(Et)}for(let Yt of zt)Le.selectSegment(G.indexOf(Yt))}}},[N,U,G,X,Se,Le,De,L,Re,st,ht,at,w,ge,Ht,ut,f,Qt,Si,bt,Fi,p]}class qb extends gn{constructor(r){super(),_n(this,r,Vb,jb,vn,{use:0,class:1,segments:2,key:3,singleSelect:4,selected:13,getElement:14},null,[-1,-1])}get getElement(){return this.$$.ctx[14]}}/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var z_={TRUE:"true",FALSE:"false"},yy={ARIA_CHECKED:"aria-checked",ARIA_PRESSED:"aria-pressed",DATA_SEGMENT_ID:"data-segment-id"},gy={SELECTED:"mdc-segmented-button__segment--selected"};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Gb={bottom:0,height:0,left:0,right:0,top:0,width:0},Zb=function(u){pl(r,u);function r(s){return u.call(this,Go(Go({},r.defaultAdapter),s))||this}return Object.defineProperty(r,"defaultAdapter",{get:function(){return{isSingleSelect:function(){return!1},getAttr:function(){return""},setAttr:function(){},addClass:function(){},removeClass:function(){},hasClass:function(){return!1},notifySelectedChange:function(){},getRootBoundingClientRect:function(){return Gb}}},enumerable:!1,configurable:!0}),r.prototype.isSelected=function(){return this.adapter.hasClass(gy.SELECTED)},r.prototype.setSelected=function(){this.adapter.addClass(gy.SELECTED),this.setAriaAttr(z_.TRUE)},r.prototype.setUnselected=function(){this.adapter.removeClass(gy.SELECTED),this.setAriaAttr(z_.FALSE)},r.prototype.getSegmentId=function(){var s;return(s=this.adapter.getAttr(yy.DATA_SEGMENT_ID))!==null&&s!==void 0?s:void 0},r.prototype.handleClick=function(){this.adapter.isSingleSelect()?this.setSelected():this.toggleSelection(),this.adapter.notifySelectedChange(this.isSelected())},r.prototype.getDimensions=function(){return this.adapter.getRootBoundingClientRect()},r.prototype.toggleSelection=function(){this.isSelected()?this.setUnselected():this.setSelected()},r.prototype.setAriaAttr=function(s){this.adapter.isSingleSelect()?this.adapter.setAttr(yy.ARIA_CHECKED,s):this.adapter.setAttr(yy.ARIA_PRESSED,s)},r}(Rc);function P_(u){let r;return{c(){r=mr("div"),this.h()},l(s){r=yr(s,"DIV",{class:!0}),Vr(r).forEach(Bt),this.h()},h(){jr(r,"class","mdc-segmented-button__ripple")},m(s,y){ki(s,r,y)},d(s){s&&Bt(r)}}}function M_(u){let r;return{c(){r=mr("div"),this.h()},l(s){r=yr(s,"DIV",{class:!0}),Vr(r).forEach(Bt),this.h()},h(){jr(r,"class","mdc-segmented-button__segment__touch")},m(s,y){ki(s,r,y)},d(s){s&&Bt(r)}}}function Hb(u){let r,s,y,w,z,f,p,L,N,U,G,X,Se=u[4]&&P_();const ge=u[23].default,De=Zn(ge,u,u[22],null);let Le=u[5]&&M_(),ft=[{class:y=Ln(bs({[u[2]]:!0,"mdc-segmented-button__segment":!0,"mdc-segmented-button__segment--touch":u[5],"mdc-segmented-button__segment--selected":u[0]},u[8]))},{style:w=Object.entries(u[9]).map(L_).concat([u[3]]).join(" ")},{role:z=u[14]?"radio":void 0},{"aria-pressed":f=u[14]?void 0:u[0]?"true":"false"},{"aria-checked":p=u[14]?u[0]?"true":"false":void 0},u[10],u[19]],Ue={};for(let Re=0;Re<ft.length;Re+=1)Ue=Ti(Ue,ft[Re]);return{c(){r=mr("button"),Se&&Se.c(),s=an(),De&&De.c(),Le&&Le.c(),this.h()},l(Re){r=yr(Re,"BUTTON",{class:!0,style:!0,role:!0,"aria-pressed":!0,"aria-checked":!0});var st=Vr(r);Se&&Se.l(st),s=an(),De&&De.l(st),Le&&Le.l(st),st.forEach(Bt),this.h()},h(){Dr(r,Ue)},m(Re,st){ki(Re,r,st),Se&&Se.m(r,null),Ta(r,s),De&&De.m(r,null),Le&&Le.m(r,null),r.autofocus&&r.focus(),u[24](r),U=!0,G||(X=[Rr(L=Fp.call(null,r,{ripple:u[4],unbounded:!1,addClass:u[16],removeClass:u[17],addStyle:u[18]})),Rr(u[11].call(null,r)),Rr(N=aa.call(null,r,u[1])),Oa(r,"click",u[25])],G=!0)},p(Re,st){Re[4]?Se||(Se=P_(),Se.c(),Se.m(r,s)):Se&&(Se.d(1),Se=null),De&&De.p&&(!U||st[0]&4194304)&&Hn(De,ge,Re,Re[22],U?Xn(ge,Re[22],st,null):Wn(Re[22]),null),Re[5]?Le||(Le=M_(),Le.c(),Le.m(r,null)):Le&&(Le.d(1),Le=null),Dr(r,Ue=Kn(ft,[(!U||st[0]&293&&y!==(y=Ln(bs({[Re[2]]:!0,"mdc-segmented-button__segment":!0,"mdc-segmented-button__segment--touch":Re[5],"mdc-segmented-button__segment--selected":Re[0]},Re[8]))))&&{class:y},(!U||st[0]&520&&w!==(w=Object.entries(Re[9]).map(L_).concat([Re[3]]).join(" ")))&&{style:w},{role:z},(!U||st[0]&1&&f!==(f=Re[14]?void 0:Re[0]?"true":"false"))&&{"aria-pressed":f},(!U||st[0]&1&&p!==(p=Re[14]?Re[0]?"true":"false":void 0))&&{"aria-checked":p},st[0]&1024&&Re[10],st[0]&524288&&Re[19]])),L&&Oo(L.update)&&st[0]&16&&L.update.call(null,{ripple:Re[4],unbounded:!1,addClass:Re[16],removeClass:Re[17],addStyle:Re[18]}),N&&Oo(N.update)&&st[0]&2&&N.update.call(null,Re[1])},i(Re){U||(li(De,Re),U=!0)},o(Re){pi(De,Re),U=!1},d(Re){Re&&Bt(r),Se&&Se.d(),De&&De.d(Re),Le&&Le.d(),u[24](null),G=!1,Ca(X)}}}const L_=([u,r])=>`${u}: ${r};`;function Wb(u,r,s){const y=["use","class","style","segment","ripple","touch","selected","getElement"];let w=cr(r,y),z,f,p,{$$slots:L={},$$scope:N}=r;const U=wo(xo());let G=()=>{};function X(Et){return Et===G}let{use:Se=[]}=r,{class:ge=""}=r,{style:De=""}=r,{segment:Le}=r,{ripple:ft=!0}=r,{touch:Ue=!1}=r;const Re=ra("SMUI:segmented-button:segment:initialSelected");Lc(u,Re,Et=>s(28,p=Et));let{selected:st=G}=r,ut=!X(st);X(st)&&(st=p);let ht,at,$t={},xt={},qt={};const _i=ra("SMUI:segmented-button:singleSelect");Lc(u,_i,Et=>s(27,f=Et));const Ri=ra("SMUI:segmented-button:segment:index");if(Lc(u,Ri,Et=>s(26,z=Et)),!Le)throw new Error("The segment property is required! It should be passed down from the SegmentedButton to the Segment.");Qu(()=>{s(6,at=new Zb({isSingleSelect:()=>f,getAttr:bt,setAttr:Fi,addClass:Qt,removeClass:Si,hasClass:Ht,notifySelectedChange:xi=>{s(0,st=xi),Aa(bi(),"selected",{index:z,selected:st,segmentId:Le})},getRootBoundingClientRect:()=>bi().getBoundingClientRect()}));const Et={segmentId:Le,get selected(){return st},set selected(xi){st!==xi&&s(0,st=xi)}};return Aa(bi(),"SMUISegmentedButtonSegment:mount",Et),at.init(),()=>{Aa(bi(),"SMUISegmentedButtonSegment:unmount",Et),at.destroy()}});function Ht(Et){return Et in $t?$t[Et]:bi().classList.contains(Et)}function Qt(Et){$t[Et]||s(8,$t[Et]=!0,$t)}function Si(Et){(!(Et in $t)||$t[Et])&&s(8,$t[Et]=!1,$t)}function bt(Et){var xi;return Et in qt?(xi=qt[Et])!==null&&xi!==void 0?xi:null:bi().getAttribute(Et)}function Fi(Et,xi){qt[Et]!==xi&&s(10,qt[Et]=xi,qt)}function Dt(Et,xi){xt[Et]!=xi&&(xi===""||xi==null?(delete xt[Et],s(9,xt)):s(9,xt[Et]=xi,xt))}function bi(){return ht}function zt(Et){hn[Et?"unshift":"push"](()=>{ht=Et,s(7,ht)})}const Yt=Et=>!Et.defaultPrevented&&at&&!ut&&at.handleClick();return u.$$set=Et=>{r=Ti(Ti({},r),bo(Et)),s(19,w=cr(r,y)),"use"in Et&&s(1,Se=Et.use),"class"in Et&&s(2,ge=Et.class),"style"in Et&&s(3,De=Et.style),"segment"in Et&&s(20,Le=Et.segment),"ripple"in Et&&s(4,ft=Et.ripple),"touch"in Et&&s(5,Ue=Et.touch),"selected"in Et&&s(0,st=Et.selected),"$$scope"in Et&&s(22,N=Et.$$scope)},u.$$.update=()=>{u.$$.dirty[0]&65&&at&&at.isSelected()&&!st&&at.setUnselected(),u.$$.dirty[0]&65&&at&&!at.isSelected()&&st&&at.setSelected()},[st,Se,ge,De,ft,Ue,at,ht,$t,xt,qt,U,Re,ut,_i,Ri,Qt,Si,Dt,w,Le,bi,N,L,zt,Yt]}class Xb extends gn{constructor(r){super(),_n(this,r,Wb,Hb,vn,{use:1,class:2,style:3,segment:20,ripple:4,touch:5,selected:0,getElement:21},null,[-1,-1])}get getElement(){return this.$$.ctx[21]}}const Kb=Xb,Qf=Yf(null),D_=Yf(null);/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var zd={ANIM_CHECKED_INDETERMINATE:"mdc-checkbox--anim-checked-indeterminate",ANIM_CHECKED_UNCHECKED:"mdc-checkbox--anim-checked-unchecked",ANIM_INDETERMINATE_CHECKED:"mdc-checkbox--anim-indeterminate-checked",ANIM_INDETERMINATE_UNCHECKED:"mdc-checkbox--anim-indeterminate-unchecked",ANIM_UNCHECKED_CHECKED:"mdc-checkbox--anim-unchecked-checked",ANIM_UNCHECKED_INDETERMINATE:"mdc-checkbox--anim-unchecked-indeterminate",BACKGROUND:"mdc-checkbox__background",CHECKED:"mdc-checkbox--checked",CHECKMARK:"mdc-checkbox__checkmark",CHECKMARK_PATH:"mdc-checkbox__checkmark-path",DISABLED:"mdc-checkbox--disabled",INDETERMINATE:"mdc-checkbox--indeterminate",MIXEDMARK:"mdc-checkbox__mixedmark",NATIVE_CONTROL:"mdc-checkbox__native-control",ROOT:"mdc-checkbox",SELECTED:"mdc-checkbox--selected",UPGRADED:"mdc-checkbox--upgraded"},Ll={ARIA_CHECKED_ATTR:"aria-checked",ARIA_CHECKED_INDETERMINATE_VALUE:"mixed",DATA_INDETERMINATE_ATTR:"data-indeterminate",NATIVE_CONTROL_SELECTOR:".mdc-checkbox__native-control",TRANSITION_STATE_CHECKED:"checked",TRANSITION_STATE_INDETERMINATE:"indeterminate",TRANSITION_STATE_INIT:"init",TRANSITION_STATE_UNCHECKED:"unchecked"},R_={ANIM_END_LATCH_MS:250};/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var Jb=function(u){pl(r,u);function r(s){var y=u.call(this,Go(Go({},r.defaultAdapter),s))||this;return y.currentCheckState=Ll.TRANSITION_STATE_INIT,y.currentAnimationClass="",y.animEndLatchTimer=0,y.enableAnimationEndHandler=!1,y}return Object.defineProperty(r,"cssClasses",{get:function(){return zd},enumerable:!1,configurable:!0}),Object.defineProperty(r,"strings",{get:function(){return Ll},enumerable:!1,configurable:!0}),Object.defineProperty(r,"numbers",{get:function(){return R_},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{addClass:function(){},forceLayout:function(){},hasNativeControl:function(){return!1},isAttachedToDOM:function(){return!1},isChecked:function(){return!1},isIndeterminate:function(){return!1},removeClass:function(){},removeNativeControlAttr:function(){},setNativeControlAttr:function(){},setNativeControlDisabled:function(){}}},enumerable:!1,configurable:!0}),r.prototype.init=function(){this.currentCheckState=this.determineCheckState(),this.updateAriaChecked(),this.adapter.addClass(zd.UPGRADED)},r.prototype.destroy=function(){clearTimeout(this.animEndLatchTimer)},r.prototype.setDisabled=function(s){this.adapter.setNativeControlDisabled(s),s?this.adapter.addClass(zd.DISABLED):this.adapter.removeClass(zd.DISABLED)},r.prototype.handleAnimationEnd=function(){var s=this;!this.enableAnimationEndHandler||(clearTimeout(this.animEndLatchTimer),this.animEndLatchTimer=setTimeout(function(){s.adapter.removeClass(s.currentAnimationClass),s.enableAnimationEndHandler=!1},R_.ANIM_END_LATCH_MS))},r.prototype.handleChange=function(){this.transitionCheckState()},r.prototype.transitionCheckState=function(){if(!!this.adapter.hasNativeControl()){var s=this.currentCheckState,y=this.determineCheckState();if(s!==y){this.updateAriaChecked();var w=Ll.TRANSITION_STATE_UNCHECKED,z=zd.SELECTED;y===w?this.adapter.removeClass(z):this.adapter.addClass(z),this.currentAnimationClass.length>0&&(clearTimeout(this.animEndLatchTimer),this.adapter.forceLayout(),this.adapter.removeClass(this.currentAnimationClass)),this.currentAnimationClass=this.getTransitionAnimationClass(s,y),this.currentCheckState=y,this.adapter.isAttachedToDOM()&&this.currentAnimationClass.length>0&&(this.adapter.addClass(this.currentAnimationClass),this.enableAnimationEndHandler=!0)}}},r.prototype.determineCheckState=function(){var s=Ll.TRANSITION_STATE_INDETERMINATE,y=Ll.TRANSITION_STATE_CHECKED,w=Ll.TRANSITION_STATE_UNCHECKED;return this.adapter.isIndeterminate()?s:this.adapter.isChecked()?y:w},r.prototype.getTransitionAnimationClass=function(s,y){var w=Ll.TRANSITION_STATE_INIT,z=Ll.TRANSITION_STATE_CHECKED,f=Ll.TRANSITION_STATE_UNCHECKED,p=r.cssClasses,L=p.ANIM_UNCHECKED_CHECKED,N=p.ANIM_UNCHECKED_INDETERMINATE,U=p.ANIM_CHECKED_UNCHECKED,G=p.ANIM_CHECKED_INDETERMINATE,X=p.ANIM_INDETERMINATE_CHECKED,Se=p.ANIM_INDETERMINATE_UNCHECKED;switch(s){case w:return y===f?"":y===z?X:Se;case f:return y===z?L:N;case z:return y===f?U:G;default:return y===z?X:Se}},r.prototype.updateAriaChecked=function(){this.adapter.isIndeterminate()?this.adapter.setNativeControlAttr(Ll.ARIA_CHECKED_ATTR,Ll.ARIA_CHECKED_INDETERMINATE_VALUE):this.adapter.removeNativeControlAttr(Ll.ARIA_CHECKED_ATTR)},r}(Rc);function Yb(u){let r,s,y,w,z,f,p,L,N,U,G,X,Se,ge,De,Le,ft,Ue,Re,st,ut=[{class:y=Ln({[u[9]]:!0,"mdc-checkbox__native-control":!0})},{type:"checkbox"},u[20],{disabled:u[1]},{__value:w=u[19](u[7])?u[6]:u[7]},{"data-indeterminate":z=!u[19](u[0])&&u[0]?"true":void 0},u[16],qf(u[26],"input$")],ht={};for(let xt=0;xt<ut.length;xt+=1)ht=Ti(ht,ut[xt]);let at=[{class:De=Ln(bs({[u[3]]:!0,"mdc-checkbox":!0,"mdc-checkbox--disabled":u[1],"mdc-checkbox--touch":u[5],"mdc-data-table__header-row-checkbox":u[21]==="data-table"&&u[22],"mdc-data-table__row-checkbox":u[21]==="data-table"&&!u[22]},u[14]))},{style:Le=Object.entries(u[15]).map(B_).concat([u[4]]).join(" ")},Vf(u[26],["input$"])],$t={};for(let xt=0;xt<at.length;xt+=1)$t=Ti($t,at[xt]);return{c(){r=mr("div"),s=mr("input"),p=na(),L=mr("div"),N=c_("svg"),U=c_("path"),G=na(),X=mr("div"),Se=na(),ge=mr("div"),this.h()},l(xt){r=yr(xt,"DIV",{class:!0,style:!0});var qt=Vr(r);s=yr(qt,"INPUT",{class:!0,type:!0,"data-indeterminate":!0}),p=oa(qt),L=yr(qt,"DIV",{class:!0});var _i=Vr(L);N=h_(_i,"svg",{class:!0,viewBox:!0});var Ri=Vr(N);U=h_(Ri,"path",{class:!0,fill:!0,d:!0}),Vr(U).forEach(Bt),Ri.forEach(Bt),G=oa(_i),X=yr(_i,"DIV",{class:!0}),Vr(X).forEach(Bt),_i.forEach(Bt),Se=oa(qt),ge=yr(qt,"DIV",{class:!0}),Vr(ge).forEach(Bt),qt.forEach(Bt),this.h()},h(){Dr(s,ht),jr(U,"class","mdc-checkbox__checkmark-path"),jr(U,"fill","none"),jr(U,"d","M1.73,12.91 8.1,19.28 22.79,4.59"),jr(N,"class","mdc-checkbox__checkmark"),jr(N,"viewBox","0 0 24 24"),jr(X,"class","mdc-checkbox__mixedmark"),jr(L,"class","mdc-checkbox__background"),jr(ge,"class","mdc-checkbox__ripple"),Dr(r,$t)},m(xt,qt){ki(xt,r,qt),Ta(r,s),s.autofocus&&s.focus(),u[36](s),s.checked=u[12],Ta(r,p),Ta(r,L),Ta(L,N),Ta(N,U),Ta(L,G),Ta(L,X),Ta(r,Se),Ta(r,ge),u[38](r),Re||(st=[Rr(f=aa.call(null,s,u[8])),Oa(s,"change",u[37]),Oa(s,"blur",u[34]),Oa(s,"focus",u[35]),Rr(ft=aa.call(null,r,u[2])),Rr(u[18].call(null,r)),Rr(Ue=Fp.call(null,r,{unbounded:!0,addClass:u[23],removeClass:u[24],addStyle:u[25],active:u[17],eventTarget:u[11]})),Oa(r,"animationend",u[39])],Re=!0)},p(xt,qt){Dr(s,ht=Kn(ut,[qt[0]&512&&y!==(y=Ln({[xt[9]]:!0,"mdc-checkbox__native-control":!0}))&&{class:y},{type:"checkbox"},xt[20],qt[0]&2&&{disabled:xt[1]},qt[0]&192&&w!==(w=xt[19](xt[7])?xt[6]:xt[7])&&{__value:w},qt[0]&1&&z!==(z=!xt[19](xt[0])&&xt[0]?"true":void 0)&&{"data-indeterminate":z},qt[0]&65536&&xt[16],qt[0]&67108864&&qf(xt[26],"input$")])),f&&Oo(f.update)&&qt[0]&256&&f.update.call(null,xt[8]),qt[0]&4096&&(s.checked=xt[12]),Dr(r,$t=Kn(at,[qt[0]&16426&&De!==(De=Ln(bs({[xt[3]]:!0,"mdc-checkbox":!0,"mdc-checkbox--disabled":xt[1],"mdc-checkbox--touch":xt[5],"mdc-data-table__header-row-checkbox":xt[21]==="data-table"&&xt[22],"mdc-data-table__row-checkbox":xt[21]==="data-table"&&!xt[22]},xt[14])))&&{class:De},qt[0]&32784&&Le!==(Le=Object.entries(xt[15]).map(B_).concat([xt[4]]).join(" "))&&{style:Le},qt[0]&67108864&&Vf(xt[26],["input$"])])),ft&&Oo(ft.update)&&qt[0]&4&&ft.update.call(null,xt[2]),Ue&&Oo(Ue.update)&&qt[0]&133120&&Ue.update.call(null,{unbounded:!0,addClass:xt[23],removeClass:xt[24],addStyle:xt[25],active:xt[17],eventTarget:xt[11]})},i:Bl,o:Bl,d(xt){xt&&Bt(r),u[36](null),u[38](null),Re=!1,Ca(st)}}}const B_=([u,r])=>`${u}: ${r};`;function $b(u,r,s){const y=["use","class","style","disabled","touch","indeterminate","group","checked","value","valueKey","input$use","input$class","getId","getElement"];let w=cr(r,y);var z;const f=wo(xo());let p=()=>{};function L(Ft){return Ft===p}let{use:N=[]}=r,{class:U=""}=r,{style:G=""}=r,{disabled:X=!1}=r,{touch:Se=!1}=r,{indeterminate:ge=p}=r,{group:De=p}=r,{checked:Le=p}=r,{value:ft=null}=r,{valueKey:Ue=p}=r,{input$use:Re=[]}=r,{input$class:st=""}=r,ut,ht,at,$t={},xt={},qt={},_i=!1,Ri=(z=ra("SMUI:generic:input:props"))!==null&&z!==void 0?z:{},Ht=L(De)?L(Le)?!1:Le!=null?Le:void 0:De.indexOf(ft)!==-1,Qt=ra("SMUI:checkbox:context"),Si=ra("SMUI:data-table:row:header"),bt=Le,Fi=L(De)?[]:[...De],Dt=Ht;Qu(()=>{s(11,at.indeterminate=!L(ge)&&ge,at),s(10,ht=new Jb({addClass:bi,forceLayout:()=>ut.offsetWidth,hasNativeControl:()=>!0,isAttachedToDOM:()=>Boolean(ut.parentNode),isChecked:()=>Ht!=null?Ht:!1,isIndeterminate:()=>L(ge)?!1:ge,removeClass:zt,removeNativeControlAttr:xi,setNativeControlAttr:Et,setNativeControlDisabled:rt=>s(1,X=rt)}));const Ft={_smui_checkbox_accessor:!0,get element(){return Ji()},get checked(){return Ht!=null?Ht:!1},set checked(rt){Ht!==rt&&s(12,Ht=rt)},get indeterminate(){return L(ge)?!1:ge},set indeterminate(rt){s(0,ge=rt)},activateRipple(){X||s(17,_i=!0)},deactivateRipple(){s(17,_i=!1)}};return Aa(ut,"SMUIGenericInput:mount",Ft),Aa(ut,"SMUICheckbox:mount",Ft),ht.init(),()=>{Aa(ut,"SMUIGenericInput:unmount",Ft),Aa(ut,"SMUICheckbox:unmount",Ft),ht.destroy()}});function bi(Ft){$t[Ft]||s(14,$t[Ft]=!0,$t)}function zt(Ft){(!(Ft in $t)||$t[Ft])&&s(14,$t[Ft]=!1,$t)}function Yt(Ft,rt){xt[Ft]!=rt&&(rt===""||rt==null?(delete xt[Ft],s(15,xt)):s(15,xt[Ft]=rt,xt))}function Et(Ft,rt){qt[Ft]!==rt&&s(16,qt[Ft]=rt,qt)}function xi(Ft){(!(Ft in qt)||qt[Ft]!=null)&&s(16,qt[Ft]=void 0,qt)}function Gt(){return Ri&&Ri.id}function Ji(){return ut}function Ni(Ft){Fy.call(this,u,Ft)}function Ai(Ft){Fy.call(this,u,Ft)}function or(Ft){hn[Ft?"unshift":"push"](()=>{at=Ft,s(11,at),s(27,De),s(33,Dt),s(12,Ht),s(6,ft),s(32,Fi),s(28,Le),s(31,bt),s(0,ge),s(10,ht)})}function Li(){Ht=this.checked,s(12,Ht),s(27,De),s(33,Dt),s(6,ft),s(32,Fi),s(28,Le),s(31,bt),s(0,ge),s(11,at),s(10,ht)}function Mt(Ft){hn[Ft?"unshift":"push"](()=>{ut=Ft,s(13,ut)})}const rr=()=>ht&&ht.handleAnimationEnd();return u.$$set=Ft=>{r=Ti(Ti({},r),bo(Ft)),s(26,w=cr(r,y)),"use"in Ft&&s(2,N=Ft.use),"class"in Ft&&s(3,U=Ft.class),"style"in Ft&&s(4,G=Ft.style),"disabled"in Ft&&s(1,X=Ft.disabled),"touch"in Ft&&s(5,Se=Ft.touch),"indeterminate"in Ft&&s(0,ge=Ft.indeterminate),"group"in Ft&&s(27,De=Ft.group),"checked"in Ft&&s(28,Le=Ft.checked),"value"in Ft&&s(6,ft=Ft.value),"valueKey"in Ft&&s(7,Ue=Ft.valueKey),"input$use"in Ft&&s(8,Re=Ft.input$use),"input$class"in Ft&&s(9,st=Ft.input$class)},u.$$.update=()=>{if(u.$$.dirty[0]&402660417|u.$$.dirty[1]&7){let Ft=!1;if(!L(De))if(Dt!==Ht){const rt=De.indexOf(ft);Ht&&rt===-1?(De.push(ft),s(27,De),s(33,Dt),s(12,Ht),s(6,ft),s(32,Fi),s(28,Le),s(31,bt),s(0,ge),s(11,at),s(10,ht)):!Ht&&rt!==-1&&(De.splice(rt,1),s(27,De),s(33,Dt),s(12,Ht),s(6,ft),s(32,Fi),s(28,Le),s(31,bt),s(0,ge),s(11,at),s(10,ht)),Ft=!0}else{const rt=Fi.indexOf(ft),wi=De.indexOf(ft);rt>-1&&wi===-1?(s(12,Ht=!1),Ft=!0):wi>-1&&rt===-1&&(s(12,Ht=!0),Ft=!0)}L(Le)?!!Dt!=!!Ht&&(Ft=!0):Le!==(Ht!=null?Ht:null)&&(Le===bt?(s(28,Le=Ht!=null?Ht:null),L(ge)||s(0,ge=!1)):s(12,Ht=Le!=null?Le:void 0),Ft=!0),at&&(L(ge)?at.indeterminate&&(s(11,at.indeterminate=!1,at),Ft=!0):!ge&&at.indeterminate?(s(11,at.indeterminate=!1,at),Ft=!0):ge&&!at.indeterminate&&(s(11,at.indeterminate=!0,at),Ft=!0)),s(31,bt=Le),s(32,Fi=L(De)?[]:[...De]),s(33,Dt=Ht),Ft&&ht&&ht.handleChange()}},[ge,X,N,U,G,Se,ft,Ue,Re,st,ht,at,Ht,ut,$t,xt,qt,_i,f,L,Ri,Qt,Si,bi,zt,Yt,w,De,Le,Gt,Ji,bt,Fi,Dt,Ni,Ai,or,Li,Mt,rr]}class Qb extends gn{constructor(r){super(),_n(this,r,$b,Yb,vn,{use:2,class:3,style:4,disabled:1,touch:5,indeterminate:0,group:27,checked:28,value:6,valueKey:7,input$use:8,input$class:9,getId:29,getElement:30},null,[-1,-1])}get getId(){return this.$$.ctx[29]}get getElement(){return this.$$.ctx[30]}}/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var ew={ROOT:"mdc-form-field"},tw={LABEL_SELECTOR:".mdc-form-field > label"};/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var iw=function(u){pl(r,u);function r(s){var y=u.call(this,Go(Go({},r.defaultAdapter),s))||this;return y.click=function(){y.handleClick()},y}return Object.defineProperty(r,"cssClasses",{get:function(){return ew},enumerable:!1,configurable:!0}),Object.defineProperty(r,"strings",{get:function(){return tw},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultAdapter",{get:function(){return{activateInputRipple:function(){},deactivateInputRipple:function(){},deregisterInteractionHandler:function(){},registerInteractionHandler:function(){}}},enumerable:!1,configurable:!0}),r.prototype.init=function(){this.adapter.registerInteractionHandler("click",this.click)},r.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("click",this.click)},r.prototype.handleClick=function(){var s=this;this.adapter.activateInputRipple(),requestAnimationFrame(function(){s.adapter.deactivateInputRipple()})},r}(Rc);const rw=u=>({}),O_=u=>({});function nw(u){let r,s,y,w,z,f,p,L,N;const U=u[13].default,G=Zn(U,u,u[12],null),X=u[13].label,Se=Zn(X,u,u[12],O_);let ge=[{for:u[4]},qf(u[10],"label$")],De={};for(let Ue=0;Ue<ge.length;Ue+=1)De=Ti(De,ge[Ue]);let Le=[{class:z=Ln({[u[1]]:!0,"mdc-form-field":!0,"mdc-form-field--align-end":u[2]==="end","mdc-form-field--nowrap":u[3]})},Vf(u[10],["label$"])],ft={};for(let Ue=0;Ue<Le.length;Ue+=1)ft=Ti(ft,Le[Ue]);return{c(){r=mr("div"),G&&G.c(),s=na(),y=mr("label"),Se&&Se.c(),this.h()},l(Ue){r=yr(Ue,"DIV",{class:!0});var Re=Vr(r);G&&G.l(Re),s=oa(Re),y=yr(Re,"LABEL",{for:!0});var st=Vr(y);Se&&Se.l(st),st.forEach(Bt),Re.forEach(Bt),this.h()},h(){Dr(y,De),Dr(r,ft)},m(Ue,Re){ki(Ue,r,Re),G&&G.m(r,null),Ta(r,s),Ta(r,y),Se&&Se.m(y,null),u[14](y),u[15](r),p=!0,L||(N=[Rr(w=aa.call(null,y,u[5])),Rr(f=aa.call(null,r,u[0])),Rr(u[9].call(null,r)),Oa(r,"SMUIGenericInput:mount",u[16]),Oa(r,"SMUIGenericInput:unmount",u[17])],L=!0)},p(Ue,[Re]){G&&G.p&&(!p||Re&4096)&&Hn(G,U,Ue,Ue[12],p?Xn(U,Ue[12],Re,null):Wn(Ue[12]),null),Se&&Se.p&&(!p||Re&4096)&&Hn(Se,X,Ue,Ue[12],p?Xn(X,Ue[12],Re,rw):Wn(Ue[12]),O_),Dr(y,De=Kn(ge,[(!p||Re&16)&&{for:Ue[4]},Re&1024&&qf(Ue[10],"label$")])),w&&Oo(w.update)&&Re&32&&w.update.call(null,Ue[5]),Dr(r,ft=Kn(Le,[(!p||Re&14&&z!==(z=Ln({[Ue[1]]:!0,"mdc-form-field":!0,"mdc-form-field--align-end":Ue[2]==="end","mdc-form-field--nowrap":Ue[3]})))&&{class:z},Re&1024&&Vf(Ue[10],["label$"])])),f&&Oo(f.update)&&Re&1&&f.update.call(null,Ue[0])},i(Ue){p||(li(G,Ue),li(Se,Ue),p=!0)},o(Ue){pi(G,Ue),pi(Se,Ue),p=!1},d(Ue){Ue&&Bt(r),G&&G.d(Ue),Se&&Se.d(Ue),u[14](null),u[15](null),L=!1,Ca(N)}}}let ow=0;function aw(u,r,s){const y=["use","class","align","noWrap","inputId","label$use","getElement"];let w=cr(r,y),{$$slots:z={},$$scope:f}=r;const p=wo(xo());let{use:L=[]}=r,{class:N=""}=r,{align:U="start"}=r,{noWrap:G=!1}=r,{inputId:X="SMUI-form-field-"+ow++}=r,{label$use:Se=[]}=r,ge,De,Le,ft;Bo("SMUI:generic:input:props",{id:X}),Qu(()=>(De=new iw({activateInputRipple:()=>{ft&&ft.activateRipple()},deactivateInputRipple:()=>{ft&&ft.deactivateRipple()},deregisterInteractionHandler:(at,$t)=>{Le.removeEventListener(at,$t)},registerInteractionHandler:(at,$t)=>{Le.addEventListener(at,$t)}}),De.init(),()=>{De.destroy()}));function Ue(){return ge}function Re(at){hn[at?"unshift":"push"](()=>{Le=at,s(7,Le)})}function st(at){hn[at?"unshift":"push"](()=>{ge=at,s(6,ge)})}const ut=at=>s(8,ft=at.detail),ht=()=>s(8,ft=void 0);return u.$$set=at=>{r=Ti(Ti({},r),bo(at)),s(10,w=cr(r,y)),"use"in at&&s(0,L=at.use),"class"in at&&s(1,N=at.class),"align"in at&&s(2,U=at.align),"noWrap"in at&&s(3,G=at.noWrap),"inputId"in at&&s(4,X=at.inputId),"label$use"in at&&s(5,Se=at.label$use),"$$scope"in at&&s(12,f=at.$$scope)},[L,N,U,G,X,Se,ge,Le,ft,p,w,Ue,f,z,Re,st,ut,ht]}class sw extends gn{constructor(r){super(),_n(this,r,aw,nw,vn,{use:0,class:1,align:2,noWrap:3,inputId:4,label$use:5,getElement:11})}get getElement(){return this.$$.ctx[11]}}var lw=8,uw={version:{required:!0,type:"enum",values:[8],doc:"Style specification version number. Must be 8.",example:8},name:{type:"string",doc:"A human-readable name for the style.",example:"Bright"},metadata:{type:"*",doc:"Arbitrary properties useful to track with the stylesheet, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},center:{type:"array",value:"number",doc:"Default map center in longitude and latitude.  The style center will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:[-73.9749,40.7736]},zoom:{type:"number",doc:"Default zoom level.  The style zoom will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:12.5},bearing:{type:"number",default:0,period:360,units:"degrees",doc:'Default bearing, in degrees. The bearing is the compass direction that is "up"; for example, a bearing of 90\xB0 orients the map so that east is up. This value will be used only if the map has not been positioned by other means (e.g. map options or user interaction).',example:29},pitch:{type:"number",default:0,units:"degrees",doc:"Default pitch, in degrees. Zero is perpendicular to the surface, for a look straight down at the map, while a greater value like 60 looks ahead towards the horizon. The style pitch will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:50},light:{type:"light",doc:"The global light source.",example:{anchor:"viewport",color:"white",intensity:.4}},terrain:{type:"terrain",doc:"A global modifier that elevates layers and markers based on a DEM data source."},fog:{type:"fog",doc:"A global effect that fades layers and markers based on their distance to the camera. The fog can be used to approximate the effect of atmosphere on distant objects and enhance the depth perception of the map when used with terrain or 3D features."},sources:{required:!0,type:"sources",doc:"Data source specifications.",example:{"mapbox-streets":{type:"vector",url:"mapbox://mapbox.mapbox-streets-v6"}}},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended. This property is required if any layer uses the `background-pattern`, `fill-pattern`, `line-pattern`, `fill-extrusion-pattern`, or `icon-image` properties. The URL must be absolute, containing the [scheme, authority and path components](https://en.wikipedia.org/wiki/URL#Syntax).",example:"mapbox://sprites/mapbox/bright-v8"},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. The URL must include `{fontstack}` and `{range}` tokens. This property is required if any layer uses the `text-field` layout property. The URL must be absolute, containing the [scheme, authority and path components](https://en.wikipedia.org/wiki/URL#Syntax).",example:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},transition:{type:"transition",doc:"A global transition definition to use as a default across properties, to be used for timing transitions between one value and the next when no property-specific transition is set. Collision-based symbol fading is controlled independently of the style's `transition` property.",example:{duration:300,delay:0}},projection:{type:"projection",doc:"The projection the map should be rendered in. Supported projections are Albers, Equal Earth, Equirectangular (WGS84), Lambert conformal conic, Mercator, Natural Earth, and Winkel Tripel. Terrain, fog, sky and CustomLayerInterface are not supported for projections other than mercator.",example:{name:"albers",center:[-154,50],parallels:[55,65]}},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array.",example:[{id:"water",source:"mapbox-streets","source-layer":"water",type:"fill",paint:{"fill-color":"#00ffff"}}]}},cw={"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For image and video sources, a URL must be provided. For GeoJSON sources, a URL or inline GeoJSON must be provided."}},hw=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],pw={type:{required:!0,type:"enum",values:{vector:{doc:"A vector tile source."}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},scheme:{type:"enum",values:{xyz:{doc:"Slippy map tilenames scheme."},tms:{doc:"OSGeo spec scheme."}},default:"xyz",doc:"Influences the y direction of the tile coordinates. The global-mercator (aka Spherical Mercator) profile is assumed."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},promoteId:{type:"promoteId",doc:"A property to use as a feature id (for feature state). Either a property name, or an object of the form `{<sourceLayer>: <propertyName>}`. If specified as a string for a vector tile source, the same property is used across all its source layers."},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},dw={type:{required:!0,type:"enum",values:{raster:{doc:"A raster tile source."}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},scheme:{type:"enum",values:{xyz:{doc:"Slippy map tilenames scheme."},tms:{doc:"OSGeo spec scheme."}},default:"xyz",doc:"Influences the y direction of the tile coordinates. The global-mercator (aka Spherical Mercator) profile is assumed."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},fw={type:{required:!0,type:"enum",values:{"raster-dem":{doc:"A RGB-encoded raster DEM source"}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},encoding:{type:"enum",values:{terrarium:{doc:"Terrarium format PNG tiles. See https://aws.amazon.com/es/public-datasets/terrain/ for more info."},mapbox:{doc:"Mapbox Terrain RGB tiles. See https://www.mapbox.com/help/access-elevation-data/#mapbox-terrain-rgb for more info."}},default:"mapbox",doc:"The encoding used by this source. Mapbox Terrain RGB is used by default"},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},mw={type:{required:!0,type:"enum",values:{geojson:{doc:"A GeoJSON data source."}},doc:"The data type of the GeoJSON source."},data:{type:"*",doc:"A URL to a GeoJSON file, or inline GeoJSON."},maxzoom:{type:"number",default:18,doc:"Maximum zoom level at which to create vector tiles (higher means greater detail at high zoom levels)."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},buffer:{type:"number",default:128,maximum:512,minimum:0,doc:"Size of the tile buffer on each side. A value of 0 produces no buffer. A value of 512 produces a buffer as wide as the tile itself. Larger values produce fewer rendering artifacts near tile edges and slower performance."},filter:{type:"*",doc:"An expression for filtering features prior to processing them for rendering."},tolerance:{type:"number",default:.375,doc:"Douglas-Peucker simplification tolerance (higher means simpler geometries and faster performance)."},cluster:{type:"boolean",default:!1,doc:"If the data is a collection of point features, setting this to true clusters the points by radius into groups. Cluster groups become new `Point` features in the source with additional properties:\n * `cluster` Is `true` if the point is a cluster \n * `cluster_id` A unqiue id for the cluster to be used in conjunction with the [cluster inspection methods](https://www.mapbox.com/mapbox-gl-js/api/#geojsonsource#getclusterexpansionzoom)\n * `point_count` Number of original points grouped into this cluster\n * `point_count_abbreviated` An abbreviated point count"},clusterRadius:{type:"number",default:50,minimum:0,doc:"Radius of each cluster if clustering is enabled. A value of 512 indicates a radius equal to the width of a tile."},clusterMaxZoom:{type:"number",doc:"Max zoom on which to cluster points if clustering is enabled. Defaults to one zoom less than maxzoom (so that last zoom features are not clustered). Clusters are re-evaluated at integer zoom levels so setting clusterMaxZoom to 14 means the clusters will be displayed until z15."},clusterMinPoints:{type:"number",doc:"Minimum number of points necessary to form a cluster if clustering is enabled. Defaults to `2`."},clusterProperties:{type:"*",doc:'An object defining custom properties on the generated clusters if clustering is enabled, aggregating values from clustered points. Has the form `{"property_name": [operator, map_expression]}`. `operator` is any expression function that accepts at least 2 operands (e.g. `"+"` or `"max"`) \u2014 it accumulates the property value from clusters/points the cluster contains; `map_expression` produces the value of a single point.\n\nExample: `{"sum": ["+", ["get", "scalerank"]]}`.\n\nFor more advanced use cases, in place of `operator`, you can use a custom reduce expression that references a special `["accumulated"]` value, e.g.:\n`{"sum": [["+", ["accumulated"], ["get", "sum"]], ["get", "scalerank"]]}`'},lineMetrics:{type:"boolean",default:!1,doc:"Whether to calculate line distance metrics. This is required for line layers that specify `line-gradient` values."},generateId:{type:"boolean",default:!1,doc:"Whether to generate ids for the geojson features. When enabled, the `feature.id` property will be auto assigned based on its index in the `features` array, over-writing any previous values."},promoteId:{type:"promoteId",doc:"A property to use as a feature id (for feature state). Either a property name, or an object of the form `{<sourceLayer>: <propertyName>}`."}},yw={type:{required:!0,type:"enum",values:{video:{doc:"A video data source."}},doc:"The data type of the video source."},urls:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,doc:"Corners of video specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},gw={type:{required:!0,type:"enum",values:{image:{doc:"An image data source."}},doc:"The data type of the image source."},url:{required:!0,type:"string",doc:"URL that points to an image."},coordinates:{required:!0,doc:"Corners of image specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},_w={id:{type:"string",doc:"Unique layer name.",required:!0},type:{type:"enum",values:{fill:{doc:"A filled polygon with an optional stroked border.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},line:{doc:"A stroked line.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},symbol:{doc:"An icon or a text label.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},circle:{doc:"A filled circle.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},heatmap:{doc:"A heatmap.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"fill-extrusion":{doc:"An extruded (3D) polygon.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},raster:{doc:"Raster map textures such as satellite imagery.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},hillshade:{doc:"Client-side hillshading visualization based on DEM data. Currently, the implementation only supports Mapbox Terrain RGB and Mapzen Terrarium tiles.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},background:{doc:"The background color or pattern of the map.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},sky:{doc:"A spherical dome around the map that is always rendered behind all other layers.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}}},doc:"Rendering type of this layer.",required:!0},metadata:{type:"*",doc:"Arbitrary properties useful to track with the layer, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},source:{type:"string",doc:"Name of a source description to be used for this layer. Required for all layer types except `background`."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required for vector tile sources; prohibited for all other source types, including GeoJSON sources."},minzoom:{type:"number",minimum:0,maximum:24,doc:"The minimum zoom level for the layer. At zoom levels less than the minzoom, the layer will be hidden."},maxzoom:{type:"number",minimum:0,maximum:24,doc:"The maximum zoom level for the layer. At zoom levels equal to or greater than the maxzoom, the layer will be hidden."},filter:{type:"filter",doc:'An expression specifying conditions on source features. Only features that match the filter are displayed. Zoom expressions in filters are only evaluated at integer zoom levels. The `["feature-state", ...]` expression is not supported in filter expressions.  The `["pitch"]` and `["distance-from-center"]` expressions are supported only for filter expressions on the symbol layer.'},layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."}},vw=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],xw={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},bw={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"constant"}},ww={"fill-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"},"data-driven styling":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},Ew={"circle-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.2.0",ios:"5.9.0",macos:"0.16.0"},"data-driven styling":{js:"1.2.0",android:"9.2.0",ios:"5.9.0",macos:"0.16.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},Sw={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},"property-type":"constant"}},Iw={"line-cap":{type:"enum",values:{butt:{doc:"A cap with a squared-off end which is drawn to the exact endpoint of the line."},round:{doc:"A cap with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},square:{doc:"A cap with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."}},default:"butt",doc:"The display of line endings.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{doc:"A join with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."},round:{doc:"A join with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},miter:{doc:"A join with a sharp, angled corner which is drawn with the outer sides beyond the endpoint of the path until they meet."}},default:"miter",doc:"The display of lines when joining.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"},"data-driven styling":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},Tw={"symbol-placement":{type:"enum",values:{point:{doc:"The label is placed at the point where the geometry is located."},line:{doc:"The label is placed along the line of the geometry. Can only be used on `LineString` and `Polygon` geometries."},"line-center":{doc:"The label is placed at the center of the line of the geometry. Can only be used on `LineString` and `Polygon` geometries. Note that a single feature in a vector tile may contain multiple line geometries."}},default:"point",doc:"Label placement relative to its geometry.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`line-center` value":{js:"0.47.0",android:"6.4.0",ios:"4.3.0",macos:"0.10.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",doc:"Distance between two symbol anchors.",requires:[{"symbol-placement":"line"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,doc:"If true, the symbols will not cross tile edges to avoid mutual collisions. Recommended in layers that don't have enough padding in the vector tile to prevent collisions, or if it is a point symbol layer placed after a line symbol layer. When using a client that supports global collision detection, like Mapbox GL JS version 0.42.0 or greater, enabling this property is not needed to prevent clipped labels at tile boundaries.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with lower sort keys are drawn and placed first.  When `icon-allow-overlap` or `text-allow-overlap` is `false`, features with a lower sort key will have priority during placement. When `icon-allow-overlap` or `text-allow-overlap` is set to `true`, features with a higher sort key will overlap over features with a lower sort key.","sdk-support":{"basic functionality":{js:"0.53.0",android:"7.4.0",ios:"4.11.0",macos:"0.14.0"},"data-driven styling":{js:"0.53.0",android:"7.4.0",ios:"4.11.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{doc:"Sorts symbols by `symbol-sort-key` if set. Otherwise, sorts symbols by their y-position relative to the viewport if `icon-allow-overlap` or `text-allow-overlap` is set to `true` or `icon-ignore-placement` or `text-ignore-placement` is `false`."},"viewport-y":{doc:"Sorts symbols by their y-position relative to the viewport if `icon-allow-overlap` or `text-allow-overlap` is set to `true` or `icon-ignore-placement` or `text-ignore-placement` is `false`."},source:{doc:"Sorts symbols by `symbol-sort-key` if set. Otherwise, no sorting is applied; symbols are rendered in the same order as the source data."}},default:"auto",doc:"Determines whether overlapping symbols in the same layer are rendered in the order that they appear in the data source or by their y-position relative to the viewport. To control the order and prioritization of symbols otherwise, use `symbol-sort-key`.","sdk-support":{"basic functionality":{js:"0.49.0",android:"6.6.0",ios:"4.5.0",macos:"0.12.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,doc:"If true, the icon will be visible even if it collides with other previously drawn symbols.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,doc:"If true, other symbols can be visible even if they collide with the icon.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,doc:"If true, text will display without their corresponding icons when the icon collides with other symbols and the text does not.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{doc:"When `symbol-placement` is set to `point`, aligns icons east-west. When `symbol-placement` is set to `line` or `line-center`, aligns icon x-axes with the line."},viewport:{doc:"Produces icons whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line` or `line-center`, this is equivalent to `map`."}},default:"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of icons.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",doc:"Scales the original size of the icon by the provided factor. The new pixel size of the image will be the original pixel size multiplied by `icon-size`. 1 is the original size; 3 triples the size of the image.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{doc:"The icon is displayed at its intrinsic aspect ratio."},width:{doc:"The icon is scaled in the x-dimension to fit the width of the text."},height:{doc:"The icon is scaled in the y-dimension to fit the height of the text."},both:{doc:"The icon is scaled in both x- and y-dimensions."}},default:"none",doc:"Scales the icon to fit around the associated text.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"stretchable icons":{js:"1.6.0",android:"9.2.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",doc:"Size of the additional area added to dimensions determined by `icon-text-fit`, in clockwise order: top, right, bottom, left.",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",doc:"Name of image in sprite to use for drawing an image background.",tokens:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",doc:"Size of the additional area around the icon bounding box used for detecting symbol collisions.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down.",requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],doc:"Offset distance of icon from its anchor. Positive values indicate right and down, while negative values indicate left and up. Each component is multiplied by the value of `icon-size` to obtain the final offset in pixels. When combined with `icon-rotate` the offset will be as if the rotated direction was up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{doc:"The center of the icon is placed closest to the anchor."},left:{doc:"The left side of the icon is placed closest to the anchor."},right:{doc:"The right side of the icon is placed closest to the anchor."},top:{doc:"The top of the icon is placed closest to the anchor."},bottom:{doc:"The bottom of the icon is placed closest to the anchor."},"top-left":{doc:"The top left corner of the icon is placed closest to the anchor."},"top-right":{doc:"The top right corner of the icon is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the icon is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the icon is placed closest to the anchor."}},default:"center",doc:"Part of the icon placed closest to the anchor.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{doc:"The icon is aligned to the plane of the map."},viewport:{doc:"The icon is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `icon-rotation-alignment`."}},default:"auto",doc:"Orientation of icon when map is pitched.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{doc:"The text is aligned to the plane of the map."},viewport:{doc:"The text is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `text-rotation-alignment`."}},default:"auto",doc:"Orientation of text when map is pitched.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{doc:"When `symbol-placement` is set to `point`, aligns text east-west. When `symbol-placement` is set to `line` or `line-center`, aligns text x-axes with the line."},viewport:{doc:"Produces glyphs whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line` or `line-center`, this is equivalent to `map`."}},default:"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of the individual glyphs forming the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,doc:"Value to use for a text label. If a plain `string` is provided, it will be treated as a `formatted` with default/inherited formatting options. SDF images are not supported in formatted text and will be ignored.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],doc:"Font stack to use for displaying text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",doc:"Font size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",doc:"The maximum line width for text wrapping.",requires:["text-field",{"symbol-placement":["point"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",doc:"Text leading value for multi-line text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",doc:"Text tracking amount.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{doc:"The text is aligned towards the anchor position."},left:{doc:"The text is aligned to the left."},center:{doc:"The text is centered."},right:{doc:"The text is aligned to the right."}},default:"center",doc:"Text justification options.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"},auto:{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,doc:"Radial offset of text, in the direction of the symbol's anchor. Useful in combination with `text-variable-anchor`, which defaults to using the two-dimensional `text-offset` if present.","sdk-support":{"basic functionality":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"},"data-driven styling":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},requires:["text-field",{"symbol-placement":["point"]}],doc:"To increase the chance of placing high-priority labels on the map, you can provide an array of `text-anchor` locations: the renderer will attempt to place the label at each location, in order, before moving onto the next label. Use `text-justify: auto` to choose justification based on anchor position. To apply an offset, use the `text-radial-offset` or the two-dimensional `text-offset`.","sdk-support":{"basic functionality":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},default:"center",doc:"Part of the text placed closest to the anchor.",requires:["text-field",{"!":"text-variable-anchor"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{doc:"If a text's language supports horizontal writing mode, symbols would be laid out horizontally."},vertical:{doc:"If a text's language supports vertical writing mode, symbols would be laid out vertically."}},doc:"The property allows control over a symbol's orientation. Note that the property values act as a hint, so that a symbol whose language doesn\u2019t support the provided orientation will be laid out in its natural orientation. Example: English point symbol will be rendered horizontally even if array value contains single 'vertical' enum value. For symbol with point placement, the order of elements in an array define priority order for the placement of an orientation variant. For symbol with line placement, the default text writing mode is either ['horizontal', 'vertical'] or ['vertical', 'horizontal'], the order doesn't affect the placement.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"1.3.0",android:"8.3.0",ios:"5.3.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",doc:"Rotates the text clockwise.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",doc:"Size of the additional area around the text bounding box used for detecting symbol collisions.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{doc:"The text is not altered."},uppercase:{doc:"Forces all letters to be displayed in uppercase."},lowercase:{doc:"Forces all letters to be displayed in lowercase."}},default:"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",doc:"Offset distance of text from its anchor. Positive values indicate right and down, while negative values indicate left and up. If used with text-variable-anchor, input values will be taken as absolute values. Offsets along the x- and y-axis will be applied automatically based on the anchor position.",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,doc:"If true, the text will be visible even if it collides with other previously drawn symbols.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,doc:"If true, other symbols can be visible even if they collide with the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,doc:"If true, icons will display without their corresponding text when the text collides with other symbols and the icon does not.",requires:["text-field","icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},Aw={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},Cw={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},"property-type":"constant"}},kw={type:"array",value:"*",doc:"A filter selects specific features from a layer."},zw={type:"boolean",doc:'Expression which determines whether or not to display a symbol. Symbols support dynamic filtering, meaning this expression can use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},Pw={type:"boolean",doc:'Expression which determines whether or not to display a polygon. Fill layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},Mw={type:"boolean",doc:'Expression which determines whether or not to display a Polygon or LineString. Line layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},Lw={type:"boolean",doc:'Expression which determines whether or not to display a circle. Circle layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},Dw={type:"boolean",doc:'Expression used to determine whether a point is being displayed or not. Heatmap layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},Rw={type:"enum",values:{"==":{doc:'`["==", key, value]` equality: `feature[key] = value`'},"!=":{doc:'`["!=", key, value]` inequality: `feature[key] \u2260 value`'},">":{doc:'`[">", key, value]` greater than: `feature[key] > value`'},">=":{doc:'`[">=", key, value]` greater than or equal: `feature[key] \u2265 value`'},"<":{doc:'`["<", key, value]` less than: `feature[key] < value`'},"<=":{doc:'`["<=", key, value]` less than or equal: `feature[key] \u2264 value`'},in:{doc:'`["in", key, v0, ..., vn]` set inclusion: `feature[key] \u2208 {v0, ..., vn}`'},"!in":{doc:'`["!in", key, v0, ..., vn]` set exclusion: `feature[key] \u2209 {v0, ..., vn}`'},all:{doc:'`["all", f0, ..., fn]` logical `AND`: `f0 \u2227 ... \u2227 fn`'},any:{doc:'`["any", f0, ..., fn]` logical `OR`: `f0 \u2228 ... \u2228 fn`'},none:{doc:'`["none", f0, ..., fn]` logical `NOR`: `\xACf0 \u2227 ... \u2227 \xACfn`'},has:{doc:'`["has", key]` `feature[key]` exists'},"!has":{doc:'`["!has", key]` `feature[key]` does not exist'},within:{doc:'`["within", object]` feature geometry is within object geometry'}},doc:"The filter operator."},Bw={type:"enum",values:{Point:{doc:"Filter to point geometries."},LineString:{doc:"Filter to line geometries."},Polygon:{doc:"Filter to polygon geometries."}},doc:"The geometry type for the filter to select."},Ow={type:"array",minimum:0,maximum:24,value:["number","color"],length:2,doc:"Zoom level and value pair."},Fw={type:"array",value:"*",minimum:1,doc:"An expression defines a function that can be used for data-driven style properties or feature filters."},Uw={doc:"",type:"enum",values:{let:{doc:'Binds expressions to named variables, which can then be referenced in the result expression using ["var", "variable_name"].',group:"Variable binding","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},var:{doc:'References variable bound using "let".',group:"Variable binding","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},literal:{doc:"Provides a literal array or object value.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},array:{doc:"Asserts that the input is an array (optionally with a specific item type and length).  If, when the input expression is evaluated, it is not of the asserted type, then this assertion will cause the whole expression to be aborted.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},at:{doc:"Retrieves an item from an array.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},in:{doc:"Determines whether an item exists in an array or a substring exists in a string. In the specific case when the second and third arguments are string literals, you must wrap at least one of them in a [`literal`](#types-literal) expression to hint correct interpretation to the [type system](#type-system).",group:"Lookup","sdk-support":{"basic functionality":{js:"1.6.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}}},"index-of":{doc:"Returns the first position at which an item can be found in an array or a substring can be found in a string, or `-1` if the input cannot be found. Accepts an optional index from where to begin the search.",group:"Lookup","sdk-support":{"basic functionality":{js:"1.10.0"}}},slice:{doc:"Returns an item from an array or a substring from a string from a specified start index, or between a start index and an end index if set. The return value is inclusive of the start index but not of the end index.",group:"Lookup","sdk-support":{"basic functionality":{js:"1.10.0"}}},case:{doc:"Selects the first output whose corresponding test condition evaluates to true, or the fallback value otherwise.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},match:{doc:'Selects the output for which the label value matches the input value, or the fallback value if no match is found. The input can be any expression (for example, `["get", "building_type"]`). Each label must be unique, and must be either:\n - a single literal value; or\n - an array of literal values, the values of which must be all strings or all numbers (for example `[100, 101]` or `["c", "b"]`).\n\nThe input matches if any of the values in the array matches using strict equality, similar to the `"in"` operator.\nIf the input type does not match the type of the labels, the result will be the fallback value.',group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},coalesce:{doc:"Evaluates each expression in turn until the first valid value is obtained. Invalid values are `null` and [`'image'`](#types-image) expressions that are unavailable in the style. If all values are invalid, `coalesce` returns the first value listed.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},step:{doc:'Produces discrete, stepped results by evaluating a piecewise-constant function defined by pairs of input and output values ("stops"). The `input` may be any numeric expression (e.g., `["get", "population"]`). Stop inputs must be numeric literals in strictly ascending order. Returns the output value of the stop just less than the input, or the first output if the input is less than the first stop.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},interpolate:{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). The `input` may be any numeric expression (e.g., `["get", "population"]`). Stop inputs must be numeric literals in strictly ascending order. The output type must be `number`, `array<number>`, or `color`.\n\nInterpolation types:\n- `["linear"]`: Interpolates linearly between the pair of stops just less than and just greater than the input.\n- `["exponential", base]`: Interpolates exponentially between the stops just less than and just greater than the input. `base` controls the rate at which the output increases: higher values make the output increase more towards the high end of the range. With values close to 1 the output increases linearly.\n- `["cubic-bezier", x1, y1, x2, y2]`: Interpolates using the cubic bezier curve defined by the given control points.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"interpolate-hcl":{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). Works like `interpolate`, but the output type must be `color`, and the interpolation is performed in the Hue-Chroma-Luminance color space.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.49.0"}}},"interpolate-lab":{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). Works like `interpolate`, but the output type must be `color`, and the interpolation is performed in the CIELAB color space.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.49.0"}}},ln2:{doc:"Returns mathematical constant ln(2).",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},pi:{doc:"Returns the mathematical constant pi.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},e:{doc:"Returns the mathematical constant e.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},typeof:{doc:"Returns a string describing the type of the given value.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},string:{doc:"Asserts that the input value is a string. If multiple values are provided, each one is evaluated in order until a string is obtained. If none of the inputs are strings, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},number:{doc:"Asserts that the input value is a number. If multiple values are provided, each one is evaluated in order until a number is obtained. If none of the inputs are numbers, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},boolean:{doc:"Asserts that the input value is a boolean. If multiple values are provided, each one is evaluated in order until a boolean is obtained. If none of the inputs are booleans, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},object:{doc:"Asserts that the input value is an object. If multiple values are provided, each one is evaluated in order until an object is obtained. If none of the inputs are objects, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},collator:{doc:"Returns a `collator` for use in locale-dependent comparison operations. The `case-sensitive` and `diacritic-sensitive` options default to `false`. The `locale` argument specifies the IETF language tag of the locale to use. If none is provided, the default locale is used. If the requested locale is not available, the `collator` will use a system-defined fallback locale. Use `resolved-locale` to test the results of locale fallback behavior.",group:"Types","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},format:{doc:'Returns a `formatted` string for displaying mixed-format text in the `text-field` property. The input may contain a string literal or expression, including an [`\'image\'`](#types-image) expression. Strings may be followed by a style override object that supports the following properties:\n- `"text-font"`: Overrides the font stack specified by the root layout property.\n- `"text-color"`: Overrides the color specified by the root paint property.\n- `"font-scale"`: Applies a scaling factor on `text-size` as specified by the root layout property.',group:"Types","sdk-support":{"basic functionality":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"text-font":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"font-scale":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"text-color":{js:"1.3.0",android:"7.3.0",ios:"4.10.0",macos:"0.14.0"},image:{js:"1.6.0",android:"8.6.0",ios:"5.7.0",macos:"0.15.0"}}},image:{doc:"Returns a [`ResolvedImage`](/mapbox-gl-js/style-spec/types/#resolvedimage) for use in [`icon-image`](/mapbox-gl-js/style-spec/layers/#layout-symbol-icon-image), `*-pattern` entries, and as a section in the [`'format'`](#types-format) expression. A [`'coalesce'`](#coalesce) expression containing `image` expressions will evaluate to the first listed image that is currently in the style. This validation process is synchronous and requires the image to have been added to the style before requesting it in the `'image'` argument.",group:"Types","sdk-support":{"basic functionality":{js:"1.4.0",android:"8.6.0",ios:"5.7.0",macos:"0.15.0"}}},"number-format":{doc:"Converts the input number into a string representation using the providing formatting rules. If set, the `locale` argument specifies the locale to use, as a BCP 47 language tag. If set, the `currency` argument specifies an ISO 4217 code to use for currency-style formatting. If set, the `min-fraction-digits` and `max-fraction-digits` arguments specify the minimum and maximum number of fractional digits to include.",group:"Types","sdk-support":{"basic functionality":{js:"0.54.0",android:"8.4.0",ios:"5.4.0",macos:"0.15.0"}}},"to-string":{doc:'Converts the input value to a string. If the input is `null`, the result is `""`. If the input is a [`boolean`](#types-boolean), the result is `"true"` or `"false"`. If the input is a number, it is converted to a string as specified by the ["NumberToString" algorithm](https://tc39.github.io/ecma262/#sec-tostring-applied-to-the-number-type) of the ECMAScript Language Specification. If the input is a [`color`](#color), it is converted to a string of the form `"rgba(r,g,b,a)"`, where `r`, `g`, and `b` are numerals ranging from 0 to 255, and `a` ranges from 0 to 1. If the input is an [`\'image\'`](#types-image) expression, `\'to-string\'` returns the image name. Otherwise, the input is converted to a string in the format specified by the [`JSON.stringify`](https://tc39.github.io/ecma262/#sec-json.stringify) function of the ECMAScript Language Specification.',group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-number":{doc:'Converts the input value to a number, if possible. If the input is `null` or `false`, the result is 0. If the input is `true`, the result is 1. If the input is a string, it is converted to a number as specified by the ["ToNumber Applied to the String Type" algorithm](https://tc39.github.io/ecma262/#sec-tonumber-applied-to-the-string-type) of the ECMAScript Language Specification. If multiple values are provided, each one is evaluated in order until the first successful conversion is obtained. If none of the inputs can be converted, the expression is an error.',group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-boolean":{doc:"Converts the input value to a boolean. The result is `false` when then input is an empty string, 0, `false`, `null`, or `NaN`; otherwise it is `true`.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-rgba":{doc:"Returns a four-element array containing the input color's red, green, blue, and alpha components, in that order.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-color":{doc:"Converts the input value to a color. If multiple values are provided, each one is evaluated in order until the first successful conversion is obtained. If none of the inputs can be converted, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},rgb:{doc:"Creates a color value from red, green, and blue components, which must range between 0 and 255, and an alpha component of 1. If any component is out of range, the expression is an error.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},rgba:{doc:"Creates a color value from red, green, blue components, which must range between 0 and 255, and an alpha component which must range between 0 and 1. If any component is out of range, the expression is an error.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},get:{doc:"Retrieves a property value from the current feature's properties, or from another object if a second argument is provided. Returns `null` if the requested property is missing.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},has:{doc:"Tests for the presence of an property value in the current feature's properties, or from another object if a second argument is provided.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},length:{doc:"Returns the length of an array or string.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},properties:{doc:'Returns the feature properties object.  Note that in some cases, it may be more efficient to use `["get", "property_name"]` directly.',group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"feature-state":{doc:"Retrieves a property value from the current feature's state. Returns `null` if the requested property is not present on the feature's state. A feature's state is not part of the GeoJSON or vector tile data, and must be set programmatically on each feature. Features are identified by their `id` attribute, which must be an integer or a string that can be cast to an integer. Note that [\"feature-state\"] can only be used with paint properties that support data-driven styling.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.46.0"}}},"geometry-type":{doc:"Returns the feature's geometry type: `Point`, `MultiPoint`, `LineString`, `MultiLineString`, `Polygon`, `MultiPolygon`. `Multi*` feature types are only returned in GeoJSON sources. When working with vector tile sources, use the singular forms.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},id:{doc:"Returns the feature's id, if it has one.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},zoom:{doc:'Returns the current zoom level.  Note that in style layout and paint properties, ["zoom"] may only appear as the input to a top-level "step" or "interpolate" expression.',group:"Camera","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},pitch:{doc:'Returns the current pitch in degrees. `["pitch"]` may only be used in the `filter` expression for a `symbol` layer.',group:"Camera","sdk-support":{"basic functionality":{js:"2.6.0"}}},"distance-from-center":{doc:'Returns the distance of a `symbol` instance from the center of the map. The distance is measured in pixels divided by the height of the map container. It measures 0 at the center, decreases towards the camera and increase away from the camera. For example, if the height of the map is 1000px, a value of -1 means 1000px away from the center towards the camera, and a value of 1 means a distance of 1000px away from the camera from the center. `["distance-from-center"]` may only be used in the `filter` expression for a `symbol` layer.',group:"Camera","sdk-support":{"basic functionality":{js:"2.6.0"}}},"heatmap-density":{doc:"Returns the kernel density estimation of a pixel in a heatmap layer, which is a relative measure of how many data points are crowded around a particular pixel. Can only be used in the `heatmap-color` property.",group:"Heatmap","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"line-progress":{doc:"Returns the progress along a gradient line. Can only be used in the `line-gradient` property.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.6.0",macos:"0.12.0"}}},"sky-radial-progress":{doc:"Returns the distance of a point on the sky from the sun position. Returns 0 at sun position and 1 when the distance reaches `sky-gradient-radius`. Can only be used in the `sky-gradient` property.",group:"sky","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}},accumulated:{doc:"Returns the value of a cluster property accumulated so far. Can only be used in the `clusterProperties` option of a clustered GeoJSON source.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.53.0",android:"8.4.0",ios:"5.5.0",macos:"0.15.0"}}},"+":{doc:"Returns the sum of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"*":{doc:"Returns the product of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"-":{doc:"For two inputs, returns the result of subtracting the second input from the first. For a single input, returns the result of subtracting it from 0.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"/":{doc:"Returns the result of floating point division of the first input by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"%":{doc:"Returns the remainder after integer division of the first input by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"^":{doc:"Returns the result of raising the first input to the power specified by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},sqrt:{doc:"Returns the square root of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},log10:{doc:"Returns the base-ten logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},ln:{doc:"Returns the natural logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},log2:{doc:"Returns the base-two logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},sin:{doc:"Returns the sine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},cos:{doc:"Returns the cosine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},tan:{doc:"Returns the tangent of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},asin:{doc:"Returns the arcsine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},acos:{doc:"Returns the arccosine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},atan:{doc:"Returns the arctangent of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},min:{doc:"Returns the minimum value of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},max:{doc:"Returns the maximum value of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},round:{doc:'Rounds the input to the nearest integer. Halfway values are rounded away from zero. For example, `["round", -1.5]` evaluates to -2.',group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},abs:{doc:"Returns the absolute value of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},ceil:{doc:"Returns the smallest integer that is greater than or equal to the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},floor:{doc:"Returns the largest integer that is less than or equal to the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},distance:{doc:"Returns the shortest distance in meters between the evaluated feature and the input geometry. The input value can be a valid GeoJSON of type `Point`, `MultiPoint`, `LineString`, `MultiLineString`, `Polygon`, `MultiPolygon`, `Feature`, or `FeatureCollection`. Distance values returned may vary in precision due to loss in precision from encoding geometries, particularly below zoom level 13.",group:"Math","sdk-support":{"basic functionality":{android:"9.2.0",ios:"5.9.0",macos:"0.16.0"}}},"==":{doc:"Returns `true` if the input values are equal, `false` otherwise. The comparison is strictly typed: values of different runtime types are always considered unequal. Cases where the types are known to be different at parse time are considered invalid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"!=":{doc:"Returns `true` if the input values are not equal, `false` otherwise. The comparison is strictly typed: values of different runtime types are always considered unequal. Cases where the types are known to be different at parse time are considered invalid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},">":{doc:"Returns `true` if the first input is strictly greater than the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"<":{doc:"Returns `true` if the first input is strictly less than the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},">=":{doc:"Returns `true` if the first input is greater than or equal to the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"<=":{doc:"Returns `true` if the first input is less than or equal to the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},all:{doc:"Returns `true` if all the inputs are `true`, `false` otherwise. The inputs are evaluated in order, and evaluation is short-circuiting: once an input expression evaluates to `false`, the result is `false` and no further input expressions are evaluated.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},any:{doc:"Returns `true` if any of the inputs are `true`, `false` otherwise. The inputs are evaluated in order, and evaluation is short-circuiting: once an input expression evaluates to `true`, the result is `true` and no further input expressions are evaluated.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"!":{doc:"Logical negation. Returns `true` if the input is `false`, and `false` if the input is `true`.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},within:{doc:"Returns `true` if the evaluated feature is fully contained inside a boundary of the input geometry, `false` otherwise. The input value can be a valid GeoJSON of type `Polygon`, `MultiPolygon`, `Feature`, or `FeatureCollection`. Supported features for evaluation:\n- `Point`: Returns `false` if a point is on the boundary or falls outside the boundary.\n- `LineString`: Returns `false` if any part of a line falls outside the boundary, the line intersects the boundary, or a line's endpoint is on the boundary.",group:"Decision","sdk-support":{"basic functionality":{js:"1.9.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}}},"is-supported-script":{doc:"Returns `true` if the input string is expected to render legibly. Returns `false` if the input string contains sections that cannot be rendered without potential loss of meaning (e.g. Indic scripts that require complex text shaping, or right-to-left scripts if the the `mapbox-gl-rtl-text` plugin is not in use in Mapbox GL JS).",group:"String","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.6.0"}}},upcase:{doc:"Returns the input string converted to uppercase. Follows the Unicode Default Case Conversion algorithm and the locale-insensitive case mappings in the Unicode Character Database.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},downcase:{doc:"Returns the input string converted to lowercase. Follows the Unicode Default Case Conversion algorithm and the locale-insensitive case mappings in the Unicode Character Database.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},concat:{doc:"Returns a `string` consisting of the concatenation of the inputs. Each input is converted to a string as if by `to-string`.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"resolved-locale":{doc:"Returns the IETF language tag of the locale being used by the provided `collator`. This can be used to determine the default system locale, or to determine if a requested locale was successfully loaded.",group:"String","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}}}},Nw={range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},doc:"The start and end distance range in which fog fades from fully transparent to fully opaque. The distance to the point at the center of the map is defined as zero, so that negative range values are closer to the camera, and positive values are farther away.",example:[.5,10],"sdk-support":{"basic functionality":{js:"2.3.0"}}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"The color of the fog. Using opacity is recommended only for smoothly transitioning fog on/off as anything less than 100% opacity results in more tiles loaded and drawn.","sdk-support":{"basic functionality":{js:"2.3.0"}}},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Horizon blend applies a smooth fade from the color of the fog to the color of the sky. A value of zero leaves a sharp transition from fog to sky. Increasing the value blends the color of fog into increasingly high angles of the sky.","sdk-support":{"basic functionality":{js:"2.3.0"}}}},jw={anchor:{type:"enum",default:"viewport",values:{map:{doc:"The position of the light source is aligned to the rotation of the map."},viewport:{doc:"The position of the light source is aligned to the rotation of the viewport."}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]},doc:"Whether extruded geometries are lit relative to the map or viewport.",example:"map","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},doc:"Position of the light source relative to lit (extruded) geometries, in [r radial coordinate, a azimuthal angle, p polar angle] where r indicates the distance from the center of the base of an object to its light, a indicates the position of the light relative to 0\xB0 (0\xB0 when `light.anchor` is set to `viewport` corresponds to the top of the viewport, or 0\xB0 when `light.anchor` is set to `map` corresponds to due north, and degrees proceed clockwise), and p indicates the height of the light (from 0\xB0, directly above, to 180\xB0, directly below).",example:[1.5,90,80],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Color tint for lighting extruded geometries.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Intensity of lighting (on a scale from 0 to 1). Higher numbers will present as more extreme contrast.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}}},Vw={name:{type:"enum",values:{albers:{doc:"An Albers equal-area projection centered on the continental United States. You can configure the projection for a different region by setting `center` and `parallels` properties. You may want to set max bounds to constrain the map to the relevant region."},equalEarth:{doc:"An Equal Earth projection."},equirectangular:{doc:"An Equirectangular projection. This projection is very similar to the Plate Carr\xE9e projection."},lambertConformalConic:{doc:"A Lambert conformal conic projection. You can configure the projection for a region by setting `center` and `parallels` properties. You may want to set max bounds to constrain the map to the relevant region."},mercator:{doc:"The Mercator projection is the default projection."},naturalEarth:{doc:"A Natural Earth projection."},winkelTripel:{doc:"A Winkel Tripel projection."}},default:"mercator",doc:"The name of the projection to be used for rendering the map.",required:!0,"sdk-support":{"basic functionality":{js:"2.6.0"}}},center:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,doc:"The reference longitude and latitude of the projection. `center` takes the form of [lng, lat]. This property is only configurable for conic projections (Albers and Lambert Conformal Conic). All other projections are centered on [0, 0].",example:[-96,37.5],requires:[{name:["albers","lambertConformalConic"]}],"sdk-support":{"basic functionality":{js:"2.6.0"}}},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,doc:"The standard parallels of the projection, denoting the desired latitude range with minimal distortion. `parallels` takes the form of [lat0, lat1]. This property is only configurable for conic projections (Albers and Lambert Conformal Conic).",example:[29.5,45.5],requires:[{name:["albers","lambertConformalConic"]}],"sdk-support":{"basic functionality":{js:"2.6.0"}}}},qw={source:{type:"string",doc:"Name of a source of `raster_dem` type to be used for terrain elevation.",required:!0,"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Exaggerates the elevation of the terrain by multiplying the data from the DEM with this value.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}}},Gw=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],Zw={"fill-antialias":{type:"boolean",default:!0,doc:"Whether or not the fill should be antialiased.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire fill layer. In contrast to the `fill-color`, this value will also affect the 1px stroke around the fill, if the stroke is used.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",doc:"The color of the filled part of this layer. This color can be specified as `rgba` with an alpha component and the color's opacity will not affect the opacity of the 1px stroke, if it is used.",transition:!0,requires:[{"!":"fill-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{doc:"The fill is translated relative to the map."},viewport:{doc:"The fill is translated relative to the viewport."}},doc:"Controls the frame of reference for `fill-translate`.",default:"map",requires:["fill-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing image fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},Hw={"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",doc:"The color with which the line will be drawn.",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.23.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{doc:"The line is translated relative to the map."},viewport:{doc:"The line is translated relative to the viewport."}},doc:"Controls the frame of reference for `line-translate`.",default:"map",requires:["line-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",doc:"Stroke thickness.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.",transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,doc:"The line's offset. For linear features, a positive value offsets the line to the right, relative to the direction of the line, and a negative value to the left. For polygon features, a positive value results in an inset, and a negative value results in an outset.",transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.12.1",android:"3.0.0",ios:"3.1.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width. Note that GeoJSON sources with `lineMetrics: true` specified won't render dashed lines to the expected scale. Also note that zoom-dependent expressions will be evaluated only at integer zoom levels.",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing image lines. For seamless patterns, image width must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",doc:'Defines a gradient with which to color a line feature. Can only be used with GeoJSON sources that specify `"lineMetrics": true`.',transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],"sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.4.0",macos:"0.11.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},Ww={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",doc:"Circle radius.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",doc:"The fill color of the circle.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,doc:"Amount to blur the circle. 1 blurs the circle such that only the centerpoint is full opacity.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",doc:"The opacity at which the circle will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{doc:"The circle is translated relative to the map."},viewport:{doc:"The circle is translated relative to the viewport."}},doc:"Controls the frame of reference for `circle-translate`.",default:"map",requires:["circle-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{doc:"Circles are scaled according to their apparent distance to the camera."},viewport:{doc:"Circles are not scaled."}},default:"map",doc:"Controls the scaling behavior of the circle when the map is pitched.","sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{doc:"The circle is aligned to the plane of the map."},viewport:{doc:"The circle is aligned to the plane of the viewport."}},default:"viewport",doc:"Orientation of circle when map is pitched.","sdk-support":{"basic functionality":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"The width of the circle's stroke. Strokes are placed outside of the `circle-radius`.","sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",doc:"The stroke color of the circle.",transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",doc:"The opacity of the circle's stroke.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},Xw={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",doc:"Radius of influence of one heatmap point in pixels. Increasing the value makes the heatmap smoother, but less detailed. `queryRenderedFeatures` on heatmap layers will return points within this radius.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,doc:"A measure of how much an individual point contributes to the heatmap. A value of 10 would be equivalent to having 10 points of weight 1 in the same spot. Especially useful when combined with clustering.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,doc:"Similar to `heatmap-weight` but controls the intensity of the heatmap globally. Primarily used for adjusting the heatmap based on zoom level.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],doc:'Defines the color of each pixel based on its density value in a heatmap.  Should be an expression that uses `["heatmap-density"]` as input.',transition:!1,"sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",doc:"The global opacity at which the heatmap layer will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Kw={"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,doc:"The color of the icon. This can only be used with [SDF icons](/help/troubleshooting/using-recolorable-images-in-mapbox-maps/).",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,doc:"The color of the icon's halo. Icon halos can only be used with [SDF icons](/help/troubleshooting/using-recolorable-images-in-mapbox-maps/).",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"Distance that the icon's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{doc:"Icons are translated relative to the map."},viewport:{doc:"Icons are translated relative to the viewport."}},doc:"Controls the frame of reference for `icon-translate`.",default:"map",requires:["icon-image","icon-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",doc:"The color with which the text will be drawn.",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"Distance that the text's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{doc:"The text is translated relative to the map."},viewport:{doc:"The text is translated relative to the viewport."}},doc:"Controls the frame of reference for `text-translate`.",default:"map",requires:["text-field","text-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},Jw={"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",doc:"Rotates hues around the color wheel.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.",default:0,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.",default:0,minimum:-1,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.",default:0,minimum:-1,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",doc:"The resampling/interpolation method to use for overscaling, also known as texture magnification filter",values:{linear:{doc:"(Bi)linear filtering interpolates pixel values using the weighted average of the four closest original source pixels creating a smooth but blurry look when overscaled"},nearest:{doc:"Nearest neighbor filtering interpolates pixel values using the nearest original source pixel creating a sharp but pixelated look when overscaled"}},default:"linear","sdk-support":{"basic functionality":{js:"0.47.0",android:"6.3.0",ios:"4.2.0",macos:"0.9.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",doc:"Fade duration when a new tile is added.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Yw={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,doc:"The direction of the light source used to generate the hillshading with 0 as the top of the viewport if `hillshade-illumination-anchor` is set to `viewport` and due north if `hillshade-illumination-anchor` is set to `map`.",transition:!1,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{doc:"The hillshade illumination is relative to the north direction."},viewport:{doc:"The hillshade illumination is relative to the top of the viewport."}},default:"viewport",doc:"Direction of light source when map is rotated.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",doc:"Intensity of the hillshade",default:.5,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",doc:"The shading color of areas that face away from the light source.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",doc:"The shading color of areas that faces towards the light source.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",doc:"The shading color used to accentuate rugged terrain like sharp cliffs and gorges.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},$w={"background-color":{type:"color",default:"#000000",doc:"The color with which the background will be drawn.",transition:!0,requires:[{"!":"background-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing an image background. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Qw={"sky-type":{type:"enum",values:{gradient:{doc:"Renders the sky with a gradient that can be configured with `sky-gradient-radius` and `sky-gradient`."},atmosphere:{doc:"Renders the sky with a simulated atmospheric scattering algorithm, the sun direction can be attached to the light position or explicitly set through `sky-atmosphere-sun`."}},default:"atmosphere",doc:"The type of the sky","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,doc:"Position of the sun center [a azimuthal angle, p polar angle]. The azimuthal angle indicates the position of the sun relative to 0\xB0 north, where degrees proceed clockwise. The polar angle indicates the height of the sun, where 0\xB0 is directly above, at zenith, and 90\xB0 at the horizon. When this property is ommitted, the sun center is directly inherited from the light position.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,doc:"Intensity of the sun as a light source in the atmosphere (on a scale from 0 to a 100). Setting higher values will brighten up the sky.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,doc:"Position of the gradient center [a azimuthal angle, p polar angle]. The azimuthal angle indicates the position of the gradient center relative to 0\xB0 north, where degrees proceed clockwise. The polar angle indicates the height of the gradient center, where 0\xB0 is directly above, at zenith, and 90\xB0 at the horizon.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,doc:"The angular distance (measured in degrees) from `sky-gradient-center` up to which the gradient extends. A value of 180 causes the gradient to wrap around to the opposite direction from `sky-gradient-center`.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],doc:"Defines a radial color gradient with which to color the sky. The color values can be interpolated with an expression using `sky-radial-progress`. The range [0, 1] for the interpolant covers a radial distance (in degrees) of [0, `sky-gradient-radius`] centered at the position specified by `sky-gradient-center`.",transition:!1,requires:[{"sky-type":"gradient"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",doc:"A color applied to the atmosphere sun halo. The alpha channel describes how strongly the sun halo is represented in an atmosphere sky layer.",transition:!1,requires:[{"sky-type":"atmosphere"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",doc:"A color used to tweak the main atmospheric scattering coefficients. Using white applies the default coefficients giving the natural blue color to the atmosphere. This color affects how heavily the corresponding wavelength is represented during scattering. The alpha channel describes the density of the atmosphere, with 1 maximum density and 0 no density.",transition:!1,requires:[{"sky-type":"atmosphere"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire sky layer.",transition:!0,"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},e2={duration:{type:"number",default:300,minimum:0,units:"milliseconds",doc:"Time allotted for transitions to complete."},delay:{type:"number",default:0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}},t2={"*":{type:"string",doc:"A name of a feature property to use as ID for feature state."}},i2={$version:lw,$root:uw,sources:cw,source:hw,source_vector:pw,source_raster:dw,source_raster_dem:fw,source_geojson:mw,source_video:yw,source_image:gw,layer:_w,layout:vw,layout_background:xw,layout_sky:bw,layout_fill:ww,layout_circle:Ew,layout_heatmap:Sw,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},"property-type":"constant"}},layout_line:Iw,layout_symbol:Tw,layout_raster:Aw,layout_hillshade:Cw,filter:kw,filter_symbol:zw,filter_fill:Pw,filter_line:Mw,filter_circle:Lw,"filter_fill-extrusion":{type:"boolean",doc:'Expression which determines whether or not to display a Polygon. Fill-extrusion layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:Dw,filter_operator:Rw,geometry_type:Bw,function:{expression:{type:"expression",doc:"An expression."},stops:{type:"array",doc:"An array of stops.",value:"function_stop"},base:{type:"number",default:1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."},property:{type:"string",doc:"The name of a feature property to use as the function input.",default:"$zoom"},type:{type:"enum",values:{identity:{doc:"Return the input value as the output value."},exponential:{doc:"Generate an output by interpolating between stops just less than and just greater than the function input."},interval:{doc:"Return the output value of the stop just less than the function input."},categorical:{doc:"Return the output value of the stop equal to the function input."}},doc:"The interpolation strategy to use in function evaluation.",default:"exponential"},colorSpace:{type:"enum",values:{rgb:{doc:"Use the RGB color space to interpolate color values"},lab:{doc:"Use the LAB color space to interpolate color values."},hcl:{doc:"Use the HCL color space to interpolate color values, interpolating the Hue, Chroma, and Luminance channels individually."}},doc:"The color space in which colors interpolated. Interpolating colors in perceptual color spaces like LAB and HCL tend to produce color ramps that look more consistent and produce colors that can be differentiated more easily than those interpolated in RGB space.",default:"rgb"},default:{type:"*",required:!1,doc:`A value to serve as a fallback function result when a value isn't otherwise available. It is used in the following circumstances:
* In categorical functions, when the feature value does not match any of the stop domain values.
* In property and zoom-and-property functions, when a feature does not contain a value for the specified property.
* In identity functions, when the feature value is not valid for the style property (for example, if the function is being used for a \`circle-color\` property but the feature property value is not a string or not a valid color).
* In interval or exponential property and zoom-and-property functions, when the feature value is not numeric.
If no default is provided, the style property's default is used in these circumstances.`}},function_stop:Ow,expression:Fw,expression_name:Uw,fog:Nw,light:jw,projection:Vw,terrain:qw,paint:Gw,paint_fill:Zw,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire fill extrusion layer. This is rendered on a per-layer, not per-feature, basis, and data-driven styling is not available.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",doc:"The base color of the extruded fill. The extrusion's surfaces will be shaded differently based on this color in combination with the root `light` settings. If this color is specified as `rgba` with an alpha component, the alpha component will be ignored; use `fill-extrusion-opacity` to set layer opacity.",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up (on the flat plane), respectively.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{doc:"The fill extrusion is translated relative to the map."},viewport:{doc:"The fill extrusion is translated relative to the viewport."}},doc:"Controls the frame of reference for `fill-extrusion-translate`.",default:"map",requires:["fill-extrusion-translate"],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing images on extruded fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",doc:"The height with which to extrude this layer.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",doc:"The height with which to extrude the base of this layer. Must be less than or equal to `fill-extrusion-height`.",transition:!0,requires:["fill-extrusion-height"],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,doc:"Whether to apply a vertical gradient to the sides of a fill-extrusion layer. If true, sides will be shaded slightly darker farther down.",transition:!1,"sdk-support":{"basic functionality":{js:"0.50.0",android:"7.0.0",ios:"4.7.0",macos:"0.13.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:Hw,paint_circle:Ww,paint_heatmap:Xw,paint_symbol:Kw,paint_raster:Jw,paint_hillshade:Yw,paint_background:$w,paint_sky:Qw,transition:e2,"property-type":{"data-driven":{type:"property-type",doc:"Property is interpolable and can be represented using a property expression."},"cross-faded":{type:"property-type",doc:"Property is non-interpolable; rather, its values will be cross-faded to smoothly transition between integer zooms."},"cross-faded-data-driven":{type:"property-type",doc:"Property is non-interpolable; rather, its values will be cross-faded to smoothly transition between integer zooms. It can be represented using a property expression."},"color-ramp":{type:"property-type",doc:"Property should be specified using a color ramp from which the output color can be sampled based on a property calculation."},"data-constant":{type:"property-type",doc:"Property is interpolable but cannot be represented using a property expression."},constant:{type:"property-type",doc:"Property is constant across all zoom levels and property values."}},promoteId:t2},_y=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function em(u){var r={exports:{}};return u(r,r.exports),r.exports}function r2(u){throw new Error('Could not dynamically require "'+u+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}/*! https://mths.be/punycode v1.3.2 by @mathias */em(function(u,r){(function(s){var y=r&&!r.nodeType&&r,w=u&&!u.nodeType&&u,z=typeof _y=="object"&&_y;(z.global===z||z.window===z||z.self===z)&&(s=z);var f,p=2147483647,L=36,N=1,U=26,G=38,X=700,Se=72,ge=128,De="-",Le=/^xn--/,ft=/[^\x20-\x7E]/,Ue=/[\x2E\u3002\uFF0E\uFF61]/g,Re={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},st=L-N,ut=Math.floor,ht=String.fromCharCode,at;function $t(zt){throw RangeError(Re[zt])}function xt(zt,Yt){for(var Et=zt.length,xi=[];Et--;)xi[Et]=Yt(zt[Et]);return xi}function qt(zt,Yt){var Et=zt.split("@"),xi="";Et.length>1&&(xi=Et[0]+"@",zt=Et[1]),zt=zt.replace(Ue,".");var Gt=zt.split("."),Ji=xt(Gt,Yt).join(".");return xi+Ji}function _i(zt){for(var Yt=[],Et=0,xi=zt.length,Gt,Ji;Et<xi;)Gt=zt.charCodeAt(Et++),Gt>=55296&&Gt<=56319&&Et<xi?(Ji=zt.charCodeAt(Et++),(Ji&64512)==56320?Yt.push(((Gt&1023)<<10)+(Ji&1023)+65536):(Yt.push(Gt),Et--)):Yt.push(Gt);return Yt}function Ri(zt){return xt(zt,function(Yt){var Et="";return Yt>65535&&(Yt-=65536,Et+=ht(Yt>>>10&1023|55296),Yt=56320|Yt&1023),Et+=ht(Yt),Et}).join("")}function Ht(zt){return zt-48<10?zt-22:zt-65<26?zt-65:zt-97<26?zt-97:L}function Qt(zt,Yt){return zt+22+75*(zt<26)-((Yt!=0)<<5)}function Si(zt,Yt,Et){var xi=0;for(zt=Et?ut(zt/X):zt>>1,zt+=ut(zt/Yt);zt>st*U>>1;xi+=L)zt=ut(zt/st);return ut(xi+(st+1)*zt/(zt+G))}function bt(zt){var Yt=[],Et=zt.length,xi,Gt=0,Ji=ge,Ni=Se,Ai,or,Li,Mt,rr,Ft,rt,wi,nr;for(Ai=zt.lastIndexOf(De),Ai<0&&(Ai=0),or=0;or<Ai;++or)zt.charCodeAt(or)>=128&&$t("not-basic"),Yt.push(zt.charCodeAt(or));for(Li=Ai>0?Ai+1:0;Li<Et;){for(Mt=Gt,rr=1,Ft=L;Li>=Et&&$t("invalid-input"),rt=Ht(zt.charCodeAt(Li++)),(rt>=L||rt>ut((p-Gt)/rr))&&$t("overflow"),Gt+=rt*rr,wi=Ft<=Ni?N:Ft>=Ni+U?U:Ft-Ni,!(rt<wi);Ft+=L)nr=L-wi,rr>ut(p/nr)&&$t("overflow"),rr*=nr;xi=Yt.length+1,Ni=Si(Gt-Mt,xi,Mt==0),ut(Gt/xi)>p-Ji&&$t("overflow"),Ji+=ut(Gt/xi),Gt%=xi,Yt.splice(Gt++,0,Ji)}return Ri(Yt)}function Fi(zt){var Yt,Et,xi,Gt,Ji,Ni,Ai,or,Li,Mt,rr,Ft=[],rt,wi,nr,Pr;for(zt=_i(zt),rt=zt.length,Yt=ge,Et=0,Ji=Se,Ni=0;Ni<rt;++Ni)rr=zt[Ni],rr<128&&Ft.push(ht(rr));for(xi=Gt=Ft.length,Gt&&Ft.push(De);xi<rt;){for(Ai=p,Ni=0;Ni<rt;++Ni)rr=zt[Ni],rr>=Yt&&rr<Ai&&(Ai=rr);for(wi=xi+1,Ai-Yt>ut((p-Et)/wi)&&$t("overflow"),Et+=(Ai-Yt)*wi,Yt=Ai,Ni=0;Ni<rt;++Ni)if(rr=zt[Ni],rr<Yt&&++Et>p&&$t("overflow"),rr==Yt){for(or=Et,Li=L;Mt=Li<=Ji?N:Li>=Ji+U?U:Li-Ji,!(or<Mt);Li+=L)Pr=or-Mt,nr=L-Mt,Ft.push(ht(Qt(Mt+Pr%nr,0))),or=ut(Pr/nr);Ft.push(ht(Qt(or,0))),Ji=Si(Et,wi,xi==Gt),Et=0,++xi}++Et,++Yt}return Ft.join("")}function Dt(zt){return qt(zt,function(Yt){return Le.test(Yt)?bt(Yt.slice(4).toLowerCase()):Yt})}function bi(zt){return qt(zt,function(Yt){return ft.test(Yt)?"xn--"+Fi(Yt):Yt})}if(f={version:"1.3.2",ucs2:{decode:_i,encode:Ri},decode:bt,encode:Fi,toASCII:bi,toUnicode:Dt},y&&w)if(u.exports==y)w.exports=f;else for(at in f)f.hasOwnProperty(at)&&(y[at]=f[at]);else s.punycode=f})(_y)});function n2(u,r){return Object.prototype.hasOwnProperty.call(u,r)}var o2=function(u,r,s,y){r=r||"&",s=s||"=";var w={};if(typeof u!="string"||u.length===0)return w;var z=/\+/g;u=u.split(r);var f=1e3;y&&typeof y.maxKeys=="number"&&(f=y.maxKeys);var p=u.length;f>0&&p>f&&(p=f);for(var L=0;L<p;++L){var N=u[L].replace(z,"%20"),U=N.indexOf(s),G,X,Se,ge;U>=0?(G=N.substr(0,U),X=N.substr(U+1)):(G=N,X=""),Se=decodeURIComponent(G),ge=decodeURIComponent(X),n2(w,Se)?Array.isArray(w[Se])?w[Se].push(ge):w[Se]=[w[Se],ge]:w[Se]=ge}return w},Pd=function(u){switch(typeof u){case"string":return u;case"boolean":return u?"true":"false";case"number":return isFinite(u)?u:"";default:return""}},a2=function(u,r,s,y){return r=r||"&",s=s||"=",u===null&&(u=void 0),typeof u=="object"?Object.keys(u).map(function(w){var z=encodeURIComponent(Pd(w))+s;return Array.isArray(u[w])?u[w].map(function(f){return z+encodeURIComponent(Pd(f))}).join(r):z+encodeURIComponent(Pd(u[w]))}).join(r):y?encodeURIComponent(Pd(y))+s+encodeURIComponent(Pd(u)):""};em(function(u,r){r.decode=r.parse=o2,r.encode=r.stringify=a2});function Cv(u,...r){for(const s of r)for(const y in s)u[y]=s[y];return u}class $u extends Error{constructor(r,s){super(s),this.message=s,this.key=r}}class eg{constructor(r,s=[]){this.parent=r,this.bindings={};for(const[y,w]of s)this.bindings[y]=w}concat(r){return new eg(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return this.bindings[r]?!0:this.parent?this.parent.has(r):!1}}const tm={kind:"null"},hi={kind:"number"},Fr={kind:"string"},Tr={kind:"boolean"},Dc={kind:"color"},Lp={kind:"object"},Ar={kind:"value"},s2={kind:"error"},im={kind:"collator"},rm={kind:"formatted"},jd={kind:"resolvedImage"};function Dl(u,r){return{kind:"array",itemType:u,N:r}}function vo(u){if(u.kind==="array"){const r=vo(u.itemType);return typeof u.N=="number"?`array<${r}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${r}>`}else return u.kind}const l2=[tm,hi,Fr,Tr,Dc,rm,Lp,Dl(Ar),jd];function Bd(u,r){if(r.kind==="error")return null;if(u.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!Bd(u.itemType,r.itemType))&&(typeof u.N!="number"||u.N===r.N))return null}else{if(u.kind===r.kind)return null;if(u.kind==="value"){for(const s of l2)if(!Bd(s,r))return null}}return`Expected ${vo(u)} but found ${vo(r)} instead.`}function tg(u,r){return r.some(s=>s.kind===u.kind)}function Od(u,r){return r.some(s=>s==="null"?u===null:s==="array"?Array.isArray(u):s==="object"?u&&!Array.isArray(u)&&typeof u=="object":s===typeof u)}var u2=em(function(u,r){var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function y(N){return N=Math.round(N),N<0?0:N>255?255:N}function w(N){return N<0?0:N>1?1:N}function z(N){return N[N.length-1]==="%"?y(parseFloat(N)/100*255):y(parseInt(N))}function f(N){return N[N.length-1]==="%"?w(parseFloat(N)/100):w(parseFloat(N))}function p(N,U,G){return G<0?G+=1:G>1&&(G-=1),G*6<1?N+(U-N)*G*6:G*2<1?U:G*3<2?N+(U-N)*(2/3-G)*6:N}function L(N){var U=N.replace(/ /g,"").toLowerCase();if(U in s)return s[U].slice();if(U[0]==="#"){if(U.length===4){var G=parseInt(U.substr(1),16);return G>=0&&G<=4095?[(G&3840)>>4|(G&3840)>>8,G&240|(G&240)>>4,G&15|(G&15)<<4,1]:null}else if(U.length===7){var G=parseInt(U.substr(1),16);return G>=0&&G<=16777215?[(G&16711680)>>16,(G&65280)>>8,G&255,1]:null}return null}var X=U.indexOf("("),Se=U.indexOf(")");if(X!==-1&&Se+1===U.length){var ge=U.substr(0,X),De=U.substr(X+1,Se-(X+1)).split(","),Le=1;switch(ge){case"rgba":if(De.length!==4)return null;Le=f(De.pop());case"rgb":return De.length!==3?null:[z(De[0]),z(De[1]),z(De[2]),Le];case"hsla":if(De.length!==4)return null;Le=f(De.pop());case"hsl":if(De.length!==3)return null;var ft=(parseFloat(De[0])%360+360)%360/360,Ue=f(De[1]),Re=f(De[2]),st=Re<=.5?Re*(Ue+1):Re+Ue-Re*Ue,ut=Re*2-st;return[y(p(ut,st,ft+1/3)*255),y(p(ut,st,ft)*255),y(p(ut,st,ft-1/3)*255),Le];default:return null}}return null}try{r.parseCSSColor=L}catch{}});class En{constructor(r,s,y,w=1){this.r=r,this.g=s,this.b=y,this.a=w}static parse(r){if(!r)return;if(r instanceof En)return r;if(typeof r!="string")return;const s=u2.parseCSSColor(r);if(!!s)return new En(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3])}toString(){const[r,s,y,w]=this.toArray();return`rgba(${Math.round(r)},${Math.round(s)},${Math.round(y)},${w})`}toArray(){const{r,g:s,b:y,a:w}=this;return w===0?[0,0,0,0]:[r*255/w,s*255/w,y*255/w,w]}}En.black=new En(0,0,0,1);En.white=new En(1,1,1,1);En.transparent=new En(0,0,0,0);En.red=new En(1,0,0,1);En.blue=new En(0,0,1,1);class ig{constructor(r,s,y){r?this.sensitivity=s?"variant":"case":this.sensitivity=s?"accent":"base",this.locale=y,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,s){return this.collator.compare(r,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Vy{constructor(r,s,y,w,z){this.text=r.normalize?r.normalize():r,this.image=s,this.scale=y,this.fontStack=w,this.textColor=z}}class xu{constructor(r){this.sections=r}static fromString(r){return new xu([new Vy(r,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof xu?r:xu.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}serialize(){const r=["format"];for(const s of this.sections){if(s.image){r.push(["image",s.image.name]);continue}r.push(s.text);const y={};s.fontStack&&(y["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(y["font-scale"]=s.scale),s.textColor&&(y["text-color"]=["rgba"].concat(s.textColor.toArray())),r.push(y)}return r}}class Bc{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new Bc({name:r,available:!1}):null}serialize(){return["image",this.name]}}function kv(u,r,s,y){return typeof u=="number"&&u>=0&&u<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof s=="number"&&s>=0&&s<=255?typeof y=="undefined"||typeof y=="number"&&y>=0&&y<=1?null:`Invalid rgba value [${[u,r,s,y].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof y=="number"?[u,r,s,y]:[u,r,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Gf(u){if(u===null)return!0;if(typeof u=="string")return!0;if(typeof u=="boolean")return!0;if(typeof u=="number")return!0;if(u instanceof En)return!0;if(u instanceof ig)return!0;if(u instanceof xu)return!0;if(u instanceof Bc)return!0;if(Array.isArray(u)){for(const r of u)if(!Gf(r))return!1;return!0}else if(typeof u=="object"){for(const r in u)if(!Gf(u[r]))return!1;return!0}else return!1}function ga(u){if(u===null)return tm;if(typeof u=="string")return Fr;if(typeof u=="boolean")return Tr;if(typeof u=="number")return hi;if(u instanceof En)return Dc;if(u instanceof ig)return im;if(u instanceof xu)return rm;if(u instanceof Bc)return jd;if(Array.isArray(u)){const r=u.length;let s;for(const y of u){const w=ga(y);if(!s)s=w;else{if(s===w)continue;s=Ar;break}}return Dl(s||Ar,r)}else return Lp}function Rd(u){const r=typeof u;return u===null?"":r==="string"||r==="number"||r==="boolean"?String(u):u instanceof En||u instanceof xu||u instanceof Bc?u.toString():JSON.stringify(u)}class Up{constructor(r,s){this.type=r,this.value=s}static parse(r,s){if(r.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!Gf(r[1]))return s.error("invalid value");const y=r[1];let w=ga(y);const z=s.expectedType;return w.kind==="array"&&w.N===0&&z&&z.kind==="array"&&(typeof z.N!="number"||z.N===0)&&(w=z),new Up(w,y)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof En?["rgba"].concat(this.value.toArray()):this.value instanceof xu?this.value.serialize():this.value}}class Fa{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const vy={string:Fr,number:hi,boolean:Tr,object:Lp};class _u{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let y=1,w;const z=r[0];if(z==="array"){let p;if(r.length>2){const N=r[1];if(typeof N!="string"||!(N in vy)||N==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);p=vy[N],y++}else p=Ar;let L;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return s.error('The length argument to "array" must be a positive integer literal',2);L=r[2],y++}w=Dl(p,L)}else w=vy[z];const f=[];for(;y<r.length;y++){const p=s.parse(r[y],y,Ar);if(!p)return null;f.push(p)}return new _u(w,f)}evaluate(r){for(let s=0;s<this.args.length;s++){const y=this.args[s].evaluate(r);if(Bd(this.type,ga(y))){if(s===this.args.length-1)throw new Fa(`Expected value to be of type ${vo(this.type)}, but found ${vo(ga(y))} instead.`)}else return y}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=this.type,s=[r.kind];if(r.kind==="array"){const y=r.itemType;if(y.kind==="string"||y.kind==="number"||y.kind==="boolean"){s.push(y.kind);const w=r.N;(typeof w=="number"||this.args.length>1)&&s.push(w)}}return s.concat(this.args.map(y=>y.serialize()))}}class nm{constructor(r){this.type=rm,this.sections=r}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const y=r[1];if(!Array.isArray(y)&&typeof y=="object")return s.error("First argument must be an image or text section.");const w=[];let z=!1;for(let f=1;f<=r.length-1;++f){const p=r[f];if(z&&typeof p=="object"&&!Array.isArray(p)){z=!1;let L=null;if(p["font-scale"]&&(L=s.parse(p["font-scale"],1,hi),!L))return null;let N=null;if(p["text-font"]&&(N=s.parse(p["text-font"],1,Dl(Fr)),!N))return null;let U=null;if(p["text-color"]&&(U=s.parse(p["text-color"],1,Dc),!U))return null;const G=w[w.length-1];G.scale=L,G.font=N,G.textColor=U}else{const L=s.parse(r[f],1,Ar);if(!L)return null;const N=L.type.kind;if(N!=="string"&&N!=="value"&&N!=="null"&&N!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");z=!0,w.push({content:L,scale:null,font:null,textColor:null})}}return new nm(w)}evaluate(r){const s=y=>{const w=y.content.evaluate(r);return ga(w)===jd?new Vy("",w,null,null,null):new Vy(Rd(w),null,y.scale?y.scale.evaluate(r):null,y.font?y.font.evaluate(r).join(","):null,y.textColor?y.textColor.evaluate(r):null)};return new xu(this.sections.map(s))}eachChild(r){for(const s of this.sections)r(s.content),s.scale&&r(s.scale),s.font&&r(s.font),s.textColor&&r(s.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const s of this.sections){r.push(s.content.serialize());const y={};s.scale&&(y["font-scale"]=s.scale.serialize()),s.font&&(y["text-font"]=s.font.serialize()),s.textColor&&(y["text-color"]=s.textColor.serialize()),r.push(y)}return r}}class om{constructor(r){this.type=jd,this.input=r}static parse(r,s){if(r.length!==2)return s.error("Expected two arguments.");const y=s.parse(r[1],1,Fr);return y?new om(y):s.error("No image name provided.")}evaluate(r){const s=this.input.evaluate(r),y=Bc.fromString(s);return y&&r.availableImages&&(y.available=r.availableImages.indexOf(s)>-1),y}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const c2={"to-boolean":Tr,"to-color":Dc,"to-number":hi,"to-string":Fr};class yh{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const y=r[0];if((y==="to-boolean"||y==="to-string")&&r.length!==2)return s.error("Expected one argument.");const w=c2[y],z=[];for(let f=1;f<r.length;f++){const p=s.parse(r[f],f,Ar);if(!p)return null;z.push(p)}return new yh(w,z)}evaluate(r){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(r));if(this.type.kind==="color"){let s,y;for(const w of this.args){if(s=w.evaluate(r),y=null,s instanceof En)return s;if(typeof s=="string"){const z=r.parseColor(s);if(z)return z}else if(Array.isArray(s)&&(s.length<3||s.length>4?y=`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:y=kv(s[0],s[1],s[2],s[3]),!y))return new En(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Fa(y||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}else if(this.type.kind==="number"){let s=null;for(const y of this.args){if(s=y.evaluate(r),s===null)return 0;const w=Number(s);if(!isNaN(w))return w}throw new Fa(`Could not convert ${JSON.stringify(s)} to number.`)}else return this.type.kind==="formatted"?xu.fromString(Rd(this.args[0].evaluate(r))):this.type.kind==="resolvedImage"?Bc.fromString(Rd(this.args[0].evaluate(r))):Rd(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){if(this.type.kind==="formatted")return new nm([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new om(this.args[0]).serialize();const r=[`to-${this.type.kind}`];return this.eachChild(s=>{r.push(s.serialize())}),r}}const h2=["Unknown","Point","LineString","Polygon"];class zv{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?h2[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:y,y:w}=this.featureTileCoord,z=y*s-r[0],f=w*s-r[1],p=this.featureDistanceData.bearing[0],L=this.featureDistanceData.bearing[1];return p*z+L*f}return 0}parseColor(r){let s=this._parseColorCache[r];return s||(s=this._parseColorCache[r]=En.parse(r)),s}}class vu{constructor(r,s,y,w){this.name=r,this.type=s,this._evaluate=y,this.args=w}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(r=>r.serialize()))}static parse(r,s){const y=r[0],w=vu.definitions[y];if(!w)return s.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0);const z=Array.isArray(w)?w[0]:w.type,f=Array.isArray(w)?[[w[1],w[2]]]:w.overloads,p=f.filter(([N])=>!Array.isArray(N)||N.length===r.length-1);let L=null;for(const[N,U]of p){L=new lm(s.registry,s.path,null,s.scope);const G=[];let X=!1;for(let Se=1;Se<r.length;Se++){const ge=r[Se],De=Array.isArray(N)?N[Se-1]:N.type,Le=L.parse(ge,1+G.length,De);if(!Le){X=!0;break}G.push(Le)}if(!X){if(Array.isArray(N)&&N.length!==G.length){L.error(`Expected ${N.length} arguments, but found ${G.length} instead.`);continue}for(let Se=0;Se<G.length;Se++){const ge=Array.isArray(N)?N[Se]:N.type,De=G[Se];L.concat(Se+1).checkSubtype(ge,De.type)}if(L.errors.length===0)return new vu(y,z,U,G)}}if(p.length===1)s.errors.push(...L.errors);else{const U=(p.length?p:f).map(([X])=>p2(X)).join(" | "),G=[];for(let X=1;X<r.length;X++){const Se=s.parse(r[X],1+G.length);if(!Se)return null;G.push(vo(Se.type))}s.error(`Expected arguments of type ${U}, but found (${G.join(", ")}) instead.`)}return null}static register(r,s){vu.definitions=s;for(const y in s)r[y]=vu}}function p2(u){return Array.isArray(u)?`(${u.map(vo).join(", ")})`:`(${vo(u.type)}...)`}class am{constructor(r,s,y){this.type=im,this.locale=y,this.caseSensitive=r,this.diacriticSensitive=s}static parse(r,s){if(r.length!==2)return s.error("Expected one argument.");const y=r[1];if(typeof y!="object"||Array.isArray(y))return s.error("Collator options argument must be an object.");const w=s.parse(y["case-sensitive"]===void 0?!1:y["case-sensitive"],1,Tr);if(!w)return null;const z=s.parse(y["diacritic-sensitive"]===void 0?!1:y["diacritic-sensitive"],1,Tr);if(!z)return null;let f=null;return y.locale&&(f=s.parse(y.locale,1,Fr),!f)?null:new am(w,z,f)}evaluate(r){return new ig(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}const gh=8192;function rg(u,r){u[0]=Math.min(u[0],r[0]),u[1]=Math.min(u[1],r[1]),u[2]=Math.max(u[2],r[0]),u[3]=Math.max(u[3],r[1])}function d2(u){return(180+u)/360}function f2(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function Zf(u,r){return!(u[0]<=r[0]||u[2]>=r[2]||u[1]<=r[1]||u[3]>=r[3])}function m2(u,r){const s=d2(u[0]),y=f2(u[1]),w=Math.pow(2,r.z);return[Math.round(s*w*gh),Math.round(y*w*gh)]}function y2(u,r,s){const y=u[0]-r[0],w=u[1]-r[1],z=u[0]-s[0],f=u[1]-s[1];return y*f-z*w===0&&y*z<=0&&w*f<=0}function g2(u,r,s){return r[1]>u[1]!=s[1]>u[1]&&u[0]<(s[0]-r[0])*(u[1]-r[1])/(s[1]-r[1])+r[0]}function ng(u,r){let s=!1;for(let y=0,w=r.length;y<w;y++){const z=r[y];for(let f=0,p=z.length;f<p-1;f++){if(y2(u,z[f],z[f+1]))return!1;g2(u,z[f],z[f+1])&&(s=!s)}}return s}function _2(u,r){for(let s=0;s<r.length;s++)if(ng(u,r[s]))return!0;return!1}function v2(u,r){return u[0]*r[1]-u[1]*r[0]}function F_(u,r,s,y){const w=u[0]-s[0],z=u[1]-s[1],f=r[0]-s[0],p=r[1]-s[1],L=y[0]-s[0],N=y[1]-s[1],U=w*N-L*z,G=f*N-L*p;return U>0&&G<0||U<0&&G>0}function x2(u,r,s,y){const w=[r[0]-u[0],r[1]-u[1]],z=[y[0]-s[0],y[1]-s[1]];return v2(z,w)===0?!1:!!(F_(u,r,s,y)&&F_(s,y,u,r))}function b2(u,r,s){for(const y of s)for(let w=0;w<y.length-1;++w)if(x2(u,r,y[w],y[w+1]))return!0;return!1}function Pv(u,r){for(let s=0;s<u.length;++s)if(!ng(u[s],r))return!1;for(let s=0;s<u.length-1;++s)if(b2(u[s],u[s+1],r))return!1;return!0}function w2(u,r){for(let s=0;s<r.length;s++)if(Pv(u,r[s]))return!0;return!1}function og(u,r,s){const y=[];for(let w=0;w<u.length;w++){const z=[];for(let f=0;f<u[w].length;f++){const p=m2(u[w][f],s);rg(r,p),z.push(p)}y.push(z)}return y}function Mv(u,r,s){const y=[];for(let w=0;w<u.length;w++){const z=og(u[w],r,s);y.push(z)}return y}function Lv(u,r,s,y){if(u[0]<s[0]||u[0]>s[2]){const w=y*.5;let z=u[0]-s[0]>w?-y:s[0]-u[0]>w?y:0;z===0&&(z=u[0]-s[2]>w?-y:s[2]-u[0]>w?y:0),u[0]+=z}rg(r,u)}function E2(u){u[0]=u[1]=1/0,u[2]=u[3]=-1/0}function U_(u,r,s,y){const w=Math.pow(2,y.z)*gh,z=[y.x*gh,y.y*gh],f=[];if(!u)return f;for(const p of u)for(const L of p){const N=[L.x+z[0],L.y+z[1]];Lv(N,r,s,w),f.push(N)}return f}function N_(u,r,s,y){const w=Math.pow(2,y.z)*gh,z=[y.x*gh,y.y*gh],f=[];if(!u)return f;for(const p of u){const L=[];for(const N of p){const U=[N.x+z[0],N.y+z[1]];rg(r,U),L.push(U)}f.push(L)}if(r[2]-r[0]<=w/2){E2(r);for(const p of f)for(const L of p)Lv(L,r,s,w)}return f}function S2(u,r){const s=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(!w)return!1;if(r.type==="Polygon"){const z=og(r.coordinates,y,w),f=U_(u.geometry(),s,y,w);if(!Zf(s,y))return!1;for(const p of f)if(!ng(p,z))return!1}if(r.type==="MultiPolygon"){const z=Mv(r.coordinates,y,w),f=U_(u.geometry(),s,y,w);if(!Zf(s,y))return!1;for(const p of f)if(!_2(p,z))return!1}return!0}function I2(u,r){const s=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],w=u.canonicalID();if(!w)return!1;if(r.type==="Polygon"){const z=og(r.coordinates,y,w),f=N_(u.geometry(),s,y,w);if(!Zf(s,y))return!1;for(const p of f)if(!Pv(p,z))return!1}if(r.type==="MultiPolygon"){const z=Mv(r.coordinates,y,w),f=N_(u.geometry(),s,y,w);if(!Zf(s,y))return!1;for(const p of f)if(!w2(p,z))return!1}return!0}class Qh{constructor(r,s){this.type=Tr,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Gf(r[1])){const y=r[1];if(y.type==="FeatureCollection")for(let w=0;w<y.features.length;++w){const z=y.features[w].geometry.type;if(z==="Polygon"||z==="MultiPolygon")return new Qh(y,y.features[w].geometry)}else if(y.type==="Feature"){const w=y.geometry.type;if(w==="Polygon"||w==="MultiPolygon")return new Qh(y,y.geometry)}else if(y.type==="Polygon"||y.type==="MultiPolygon")return new Qh(y,y)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return S2(r,this.geometries);if(r.geometryType()==="LineString")return I2(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function ag(u){if(u instanceof vu){if(u.name==="get"&&u.args.length===1)return!1;if(u.name==="feature-state")return!1;if(u.name==="has"&&u.args.length===1)return!1;if(u.name==="properties"||u.name==="geometry-type"||u.name==="id")return!1;if(/^filter-/.test(u.name))return!1}if(u instanceof Qh)return!1;let r=!0;return u.eachChild(s=>{r&&!ag(s)&&(r=!1)}),r}function sg(u){if(u instanceof vu&&u.name==="feature-state")return!1;let r=!0;return u.eachChild(s=>{r&&!sg(s)&&(r=!1)}),r}function lg(u,r){if(u instanceof vu&&r.indexOf(u.name)>=0)return!1;let s=!0;return u.eachChild(y=>{s&&!lg(y,r)&&(s=!1)}),s}class sm{constructor(r,s){this.type=s.type,this.name=r,this.boundExpression=s}static parse(r,s){if(r.length!==2||typeof r[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const y=r[1];return s.scope.has(y)?new sm(y,s.scope.get(y)):s.error(`Unknown variable "${y}". Make sure "${y}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class lm{constructor(r,s=[],y,w=new eg,z=[]){this.registry=r,this.path=s,this.key=s.map(f=>`[${f}]`).join(""),this.scope=w,this.errors=z,this.expectedType=y}parse(r,s,y,w,z={}){return s?this.concat(s,y,w)._parse(r,z):this._parse(r,z)}_parse(r,s){(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number")&&(r=["literal",r]);function y(w,z,f){return f==="assert"?new _u(z,[w]):f==="coerce"?new yh(z,[w]):w}if(Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const w=r[0];if(typeof w!="string")return this.error(`Expression name must be a string, but found ${typeof w} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const z=this.registry[w];if(z){let f=z.parse(r,this);if(!f)return null;if(this.expectedType){const p=this.expectedType,L=f.type;if((p.kind==="string"||p.kind==="number"||p.kind==="boolean"||p.kind==="object"||p.kind==="array")&&L.kind==="value")f=y(f,p,s.typeAnnotation||"assert");else if((p.kind==="color"||p.kind==="formatted"||p.kind==="resolvedImage")&&(L.kind==="value"||L.kind==="string"))f=y(f,p,s.typeAnnotation||"coerce");else if(this.checkSubtype(p,L))return null}if(!(f instanceof Up)&&f.type.kind!=="resolvedImage"&&qy(f)){const p=new zv;try{f=new Up(f.type,f.evaluate(p))}catch(L){return this.error(L.message),null}}return f}return this.error(`Unknown expression "${w}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof r=="undefined"?this.error("'undefined' value invalid. Use null instead."):typeof r=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof r} instead.`)}concat(r,s,y){const w=typeof r=="number"?this.path.concat(r):this.path,z=y?this.scope.concat(y):this.scope;return new lm(this.registry,w,s||null,z,this.errors)}error(r,...s){const y=`${this.key}${s.map(w=>`[${w}]`).join("")}`;this.errors.push(new $u(y,r))}checkSubtype(r,s){const y=Bd(r,s);return y&&this.error(y),y}}function qy(u){if(u instanceof sm)return qy(u.boundExpression);if(u instanceof vu&&u.name==="error")return!1;if(u instanceof am)return!1;if(u instanceof Qh)return!1;const r=u instanceof yh||u instanceof _u;let s=!0;return u.eachChild(y=>{r?s=s&&qy(y):s=s&&y instanceof Up}),s?ag(u)&&lg(u,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"]):!1}function um(u,r){const s=u.length-1;let y=0,w=s,z=0,f,p;for(;y<=w;)if(z=Math.floor((y+w)/2),f=u[z],p=u[z+1],f<=r){if(z===s||r<p)return z;y=z+1}else if(f>r)w=z-1;else throw new Fa("Input is not a number.");return 0}class cm{constructor(r,s,y){this.type=r,this.input=s,this.labels=[],this.outputs=[];for(const[w,z]of y)this.labels.push(w),this.outputs.push(z)}static parse(r,s){if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!==0)return s.error("Expected an even number of arguments.");const y=s.parse(r[1],1,hi);if(!y)return null;const w=[];let z=null;s.expectedType&&s.expectedType.kind!=="value"&&(z=s.expectedType);for(let f=1;f<r.length;f+=2){const p=f===1?-1/0:r[f],L=r[f+1],N=f,U=f+1;if(typeof p!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(w.length&&w[w.length-1][0]>=p)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',N);const G=s.parse(L,U,z);if(!G)return null;z=z||G.type,w.push([p,G])}return new cm(z,y,w)}evaluate(r){const s=this.labels,y=this.outputs;if(s.length===1)return y[0].evaluate(r);const w=this.input.evaluate(r);if(w<=s[0])return y[0].evaluate(r);const z=s.length;if(w>=s[z-1])return y[z-1].evaluate(r);const f=um(s,w);return y[f].evaluate(r)}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){const r=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&r.push(this.labels[s]),r.push(this.outputs[s].serialize());return r}}var T2=Hp;function Hp(u,r,s,y){this.cx=3*u,this.bx=3*(s-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(y-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=y,this.p2x=s,this.p2y=y}Hp.prototype.sampleCurveX=function(u){return((this.ax*u+this.bx)*u+this.cx)*u};Hp.prototype.sampleCurveY=function(u){return((this.ay*u+this.by)*u+this.cy)*u};Hp.prototype.sampleCurveDerivativeX=function(u){return(3*this.ax*u+2*this.bx)*u+this.cx};Hp.prototype.solveCurveX=function(u,r){typeof r=="undefined"&&(r=1e-6);var s,y,w,z,f;for(w=u,f=0;f<8;f++){if(z=this.sampleCurveX(w)-u,Math.abs(z)<r)return w;var p=this.sampleCurveDerivativeX(w);if(Math.abs(p)<1e-6)break;w=w-z/p}if(s=0,y=1,w=u,w<s)return s;if(w>y)return y;for(;s<y;){if(z=this.sampleCurveX(w),Math.abs(z-u)<r)return w;u>z?s=w:y=w,w=(y-s)*.5+s}return w};Hp.prototype.solve=function(u,r){return this.sampleCurveY(this.solveCurveX(u,r))};function ul(u,r,s){return u*(1-s)+r*s}function A2(u,r,s){return new En(ul(u.r,r.r,s),ul(u.g,r.g,s),ul(u.b,r.b,s),ul(u.a,r.a,s))}function C2(u,r,s){return u.map((y,w)=>ul(y,r[w],s))}var Dv=Object.freeze({__proto__:null,number:ul,color:A2,array:C2});const Rv=.95047,Bv=1,Ov=1.08883,Fv=4/29,Dp=6/29,Uv=3*Dp*Dp,k2=Dp*Dp*Dp,z2=Math.PI/180,P2=180/Math.PI;function xy(u){return u>k2?Math.pow(u,1/3):u/Uv+Fv}function by(u){return u>Dp?u*u*u:Uv*(u-Fv)}function wy(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function Ey(u){return u/=255,u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Nv(u){const r=Ey(u.r),s=Ey(u.g),y=Ey(u.b),w=xy((.4124564*r+.3575761*s+.1804375*y)/Rv),z=xy((.2126729*r+.7151522*s+.072175*y)/Bv),f=xy((.0193339*r+.119192*s+.9503041*y)/Ov);return{l:116*z-16,a:500*(w-z),b:200*(z-f),alpha:u.a}}function jv(u){let r=(u.l+16)/116,s=isNaN(u.a)?r:r+u.a/500,y=isNaN(u.b)?r:r-u.b/200;return r=Bv*by(r),s=Rv*by(s),y=Ov*by(y),new En(wy(3.2404542*s-1.5371385*r-.4985314*y),wy(-.969266*s+1.8760108*r+.041556*y),wy(.0556434*s-.2040259*r+1.0572252*y),u.alpha)}function M2(u,r,s){return{l:ul(u.l,r.l,s),a:ul(u.a,r.a,s),b:ul(u.b,r.b,s),alpha:ul(u.alpha,r.alpha,s)}}function L2(u){const{l:r,a:s,b:y}=Nv(u),w=Math.atan2(y,s)*P2;return{h:w<0?w+360:w,c:Math.sqrt(s*s+y*y),l:r,alpha:u.a}}function D2(u){const r=u.h*z2,s=u.c,y=u.l;return jv({l:y,a:Math.cos(r)*s,b:Math.sin(r)*s,alpha:u.alpha})}function R2(u,r,s){const y=r-u;return u+s*(y>180||y<-180?y-360*Math.round(y/360):y)}function B2(u,r,s){return{h:R2(u.h,r.h,s),c:ul(u.c,r.c,s),l:ul(u.l,r.l,s),alpha:ul(u.alpha,r.alpha,s)}}const Ld={forward:Nv,reverse:jv,interpolate:M2},Dd={forward:L2,reverse:D2,interpolate:B2};var Vv=Object.freeze({__proto__:null,lab:Ld,hcl:Dd});class Ol{constructor(r,s,y,w,z){this.type=r,this.operator=s,this.interpolation=y,this.input=w,this.labels=[],this.outputs=[];for(const[f,p]of z)this.labels.push(f),this.outputs.push(p)}static interpolationFactor(r,s,y,w){let z=0;if(r.name==="exponential")z=Sy(s,r.base,y,w);else if(r.name==="linear")z=Sy(s,1,y,w);else if(r.name==="cubic-bezier"){const f=r.controlPoints;z=new T2(f[0],f[1],f[2],f[3]).solve(Sy(s,1,y,w))}return z}static parse(r,s){let[y,w,z,...f]=r;if(!Array.isArray(w)||w.length===0)return s.error("Expected an interpolation type expression.",1);if(w[0]==="linear")w={name:"linear"};else if(w[0]==="exponential"){const N=w[1];if(typeof N!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);w={name:"exponential",base:N}}else if(w[0]==="cubic-bezier"){const N=w.slice(1);if(N.length!==4||N.some(U=>typeof U!="number"||U<0||U>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);w={name:"cubic-bezier",controlPoints:N}}else return s.error(`Unknown interpolation type ${String(w[0])}`,1,0);if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!==0)return s.error("Expected an even number of arguments.");if(z=s.parse(z,2,hi),!z)return null;const p=[];let L=null;y==="interpolate-hcl"||y==="interpolate-lab"?L=Dc:s.expectedType&&s.expectedType.kind!=="value"&&(L=s.expectedType);for(let N=0;N<f.length;N+=2){const U=f[N],G=f[N+1],X=N+3,Se=N+4;if(typeof U!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',X);if(p.length&&p[p.length-1][0]>=U)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',X);const ge=s.parse(G,Se,L);if(!ge)return null;L=L||ge.type,p.push([U,ge])}return L.kind!=="number"&&L.kind!=="color"&&!(L.kind==="array"&&L.itemType.kind==="number"&&typeof L.N=="number")?s.error(`Type ${vo(L)} is not interpolatable.`):new Ol(L,y,w,z,p)}evaluate(r){const s=this.labels,y=this.outputs;if(s.length===1)return y[0].evaluate(r);const w=this.input.evaluate(r);if(w<=s[0])return y[0].evaluate(r);const z=s.length;if(w>=s[z-1])return y[z-1].evaluate(r);const f=um(s,w),p=s[f],L=s[f+1],N=Ol.interpolationFactor(this.interpolation,w,p,L),U=y[f].evaluate(r),G=y[f+1].evaluate(r);return this.operator==="interpolate"?Dv[this.type.kind.toLowerCase()](U,G,N):this.operator==="interpolate-hcl"?Dd.reverse(Dd.interpolate(Dd.forward(U),Dd.forward(G),N)):Ld.reverse(Ld.interpolate(Ld.forward(U),Ld.forward(G),N))}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){let r;this.interpolation.name==="linear"?r=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?r=["linear"]:r=["exponential",this.interpolation.base]:r=["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,r,this.input.serialize()];for(let y=0;y<this.labels.length;y++)s.push(this.labels[y],this.outputs[y].serialize());return s}}function Sy(u,r,s,y){const w=y-s,z=u-s;return w===0?0:r===1?z/w:(Math.pow(r,z)-1)/(Math.pow(r,w)-1)}class Fd{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expectected at least one argument.");let y=null;const w=s.expectedType;w&&w.kind!=="value"&&(y=w);const z=[];for(const p of r.slice(1)){const L=s.parse(p,1+z.length,y,void 0,{typeAnnotation:"omit"});if(!L)return null;y=y||L.type,z.push(L)}return w&&z.some(p=>Bd(w,p.type))?new Fd(Ar,z):new Fd(y,z)}evaluate(r){let s=null,y=0,w;for(const z of this.args){if(y++,s=z.evaluate(r),s&&s instanceof Bc&&!s.available&&(w||(w=s),s=null,y===this.args.length))return w;if(s!==null)break}return s}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=["coalesce"];return this.eachChild(s=>{r.push(s.serialize())}),r}}class hm{constructor(r,s){this.type=s.type,this.bindings=[].concat(r),this.result=s}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const s of this.bindings)r(s[1]);r(this.result)}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const y=[];for(let z=1;z<r.length-1;z+=2){const f=r[z];if(typeof f!="string")return s.error(`Expected string, but found ${typeof f} instead.`,z);if(/[^a-zA-Z0-9_]/.test(f))return s.error("Variable names must contain only alphanumeric characters or '_'.",z);const p=s.parse(r[z+1],z+1);if(!p)return null;y.push([f,p])}const w=s.parse(r[r.length-1],r.length-1,s.expectedType,y);return w?new hm(y,w):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[s,y]of this.bindings)r.push(s,y.serialize());return r.push(this.result.serialize()),r}}class ug{constructor(r,s,y){this.type=r,this.index=s,this.input=y}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const y=s.parse(r[1],1,hi),w=s.parse(r[2],2,Dl(s.expectedType||Ar));if(!y||!w)return null;const z=w.type;return new ug(z.itemType,y,w)}evaluate(r){const s=this.index.evaluate(r),y=this.input.evaluate(r);if(s<0)throw new Fa(`Array index out of bounds: ${s} < 0.`);if(s>=y.length)throw new Fa(`Array index out of bounds: ${s} > ${y.length-1}.`);if(s!==Math.floor(s))throw new Fa(`Array index must be an integer, but found ${s} instead.`);return y[s]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class cg{constructor(r,s){this.type=Tr,this.needle=r,this.haystack=s}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const y=s.parse(r[1],1,Ar),w=s.parse(r[2],2,Ar);return!y||!w?null:tg(y.type,[Tr,Fr,hi,tm,Ar])?new cg(y,w):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${vo(y.type)} instead`)}evaluate(r){const s=this.needle.evaluate(r),y=this.haystack.evaluate(r);if(y==null)return!1;if(!Od(s,["boolean","string","number","null"]))throw new Fa(`Expected first argument to be of type boolean, string, number or null, but found ${vo(ga(s))} instead.`);if(!Od(y,["string","array"]))throw new Fa(`Expected second argument to be of type array or string, but found ${vo(ga(y))} instead.`);return y.indexOf(s)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Hf{constructor(r,s,y){this.type=hi,this.needle=r,this.haystack=s,this.fromIndex=y}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const y=s.parse(r[1],1,Ar),w=s.parse(r[2],2,Ar);if(!y||!w)return null;if(!tg(y.type,[Tr,Fr,hi,tm,Ar]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${vo(y.type)} instead`);if(r.length===4){const z=s.parse(r[3],3,hi);return z?new Hf(y,w,z):null}else return new Hf(y,w)}evaluate(r){const s=this.needle.evaluate(r),y=this.haystack.evaluate(r);if(!Od(s,["boolean","string","number","null"]))throw new Fa(`Expected first argument to be of type boolean, string, number or null, but found ${vo(ga(s))} instead.`);if(!Od(y,["string","array"]))throw new Fa(`Expected second argument to be of type array or string, but found ${vo(ga(y))} instead.`);if(this.fromIndex){const w=this.fromIndex.evaluate(r);return y.indexOf(s,w)}return y.indexOf(s)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class hg{constructor(r,s,y,w,z,f){this.inputType=r,this.type=s,this.input=y,this.cases=w,this.outputs=z,this.otherwise=f}static parse(r,s){if(r.length<5)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!==1)return s.error("Expected an even number of arguments.");let y,w;s.expectedType&&s.expectedType.kind!=="value"&&(w=s.expectedType);const z={},f=[];for(let N=2;N<r.length-1;N+=2){let U=r[N];const G=r[N+1];Array.isArray(U)||(U=[U]);const X=s.concat(N);if(U.length===0)return X.error("Expected at least one branch label.");for(const ge of U){if(typeof ge!="number"&&typeof ge!="string")return X.error("Branch labels must be numbers or strings.");if(typeof ge=="number"&&Math.abs(ge)>Number.MAX_SAFE_INTEGER)return X.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ge=="number"&&Math.floor(ge)!==ge)return X.error("Numeric branch labels must be integer values.");if(!y)y=ga(ge);else if(X.checkSubtype(y,ga(ge)))return null;if(typeof z[String(ge)]!="undefined")return X.error("Branch labels must be unique.");z[String(ge)]=f.length}const Se=s.parse(G,N,w);if(!Se)return null;w=w||Se.type,f.push(Se)}const p=s.parse(r[1],1,Ar);if(!p)return null;const L=s.parse(r[r.length-1],r.length-1,w);return!L||p.type.kind!=="value"&&s.concat(1).checkSubtype(y,p.type)?null:new hg(y,w,p,z,f,L)}evaluate(r){const s=this.input.evaluate(r);return(ga(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),y=[],w={};for(const f of s){const p=w[this.cases[f]];p===void 0?(w[this.cases[f]]=y.length,y.push([this.cases[f],[f]])):y[p][1].push(f)}const z=f=>this.inputType.kind==="number"?Number(f):f;for(const[f,p]of y)p.length===1?r.push(z(p[0])):r.push(p.map(z)),r.push(this.outputs[f].serialize());return r.push(this.otherwise.serialize()),r}}class pg{constructor(r,s,y){this.type=r,this.branches=s,this.otherwise=y}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!==0)return s.error("Expected an odd number of arguments.");let y;s.expectedType&&s.expectedType.kind!=="value"&&(y=s.expectedType);const w=[];for(let f=1;f<r.length-1;f+=2){const p=s.parse(r[f],f,Tr);if(!p)return null;const L=s.parse(r[f+1],f+1,y);if(!L)return null;w.push([p,L]),y=y||L.type}const z=s.parse(r[r.length-1],r.length-1,y);return z?new pg(y,w,z):null}evaluate(r){for(const[s,y]of this.branches)if(s.evaluate(r))return y.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[s,y]of this.branches)r(s),r(y);r(this.otherwise)}outputDefined(){return this.branches.every(([r,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild(s=>{r.push(s.serialize())}),r}}class Wf{constructor(r,s,y,w){this.type=r,this.input=s,this.beginIndex=y,this.endIndex=w}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const y=s.parse(r[1],1,Ar),w=s.parse(r[2],2,hi);if(!y||!w)return null;if(!tg(y.type,[Dl(Ar),Fr,Ar]))return s.error(`Expected first argument to be of type array or string, but found ${vo(y.type)} instead`);if(r.length===4){const z=s.parse(r[3],3,hi);return z?new Wf(y.type,y,w,z):null}else return new Wf(y.type,y,w)}evaluate(r){const s=this.input.evaluate(r),y=this.beginIndex.evaluate(r);if(!Od(s,["string","array"]))throw new Fa(`Expected first argument to be of type array or string, but found ${vo(ga(s))} instead.`);if(this.endIndex){const w=this.endIndex.evaluate(r);return s.slice(y,w)}return s.slice(y)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function j_(u,r){return u==="=="||u==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function O2(u,r,s){return r===s}function F2(u,r,s){return r!==s}function U2(u,r,s){return r<s}function N2(u,r,s){return r>s}function j2(u,r,s){return r<=s}function V2(u,r,s){return r>=s}function qv(u,r,s,y){return y.compare(r,s)===0}function q2(u,r,s,y){return!qv(u,r,s,y)}function G2(u,r,s,y){return y.compare(r,s)<0}function Z2(u,r,s,y){return y.compare(r,s)>0}function H2(u,r,s,y){return y.compare(r,s)<=0}function W2(u,r,s,y){return y.compare(r,s)>=0}function Wp(u,r,s){const y=u!=="=="&&u!=="!=";return class Gv{constructor(z,f,p){this.type=Tr,this.lhs=z,this.rhs=f,this.collator=p,this.hasUntypedArgument=z.type.kind==="value"||f.type.kind==="value"}static parse(z,f){if(z.length!==3&&z.length!==4)return f.error("Expected two or three arguments.");const p=z[0];let L=f.parse(z[1],1,Ar);if(!L)return null;if(!j_(p,L.type))return f.concat(1).error(`"${p}" comparisons are not supported for type '${vo(L.type)}'.`);let N=f.parse(z[2],2,Ar);if(!N)return null;if(!j_(p,N.type))return f.concat(2).error(`"${p}" comparisons are not supported for type '${vo(N.type)}'.`);if(L.type.kind!==N.type.kind&&L.type.kind!=="value"&&N.type.kind!=="value")return f.error(`Cannot compare types '${vo(L.type)}' and '${vo(N.type)}'.`);y&&(L.type.kind==="value"&&N.type.kind!=="value"?L=new _u(N.type,[L]):L.type.kind!=="value"&&N.type.kind==="value"&&(N=new _u(L.type,[N])));let U=null;if(z.length===4){if(L.type.kind!=="string"&&N.type.kind!=="string"&&L.type.kind!=="value"&&N.type.kind!=="value")return f.error("Cannot use collator to compare non-string types.");if(U=f.parse(z[3],3,im),!U)return null}return new Gv(L,N,U)}evaluate(z){const f=this.lhs.evaluate(z),p=this.rhs.evaluate(z);if(y&&this.hasUntypedArgument){const L=ga(f),N=ga(p);if(L.kind!==N.kind||!(L.kind==="string"||L.kind==="number"))throw new Fa(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${L.kind}, ${N.kind}) instead.`)}if(this.collator&&!y&&this.hasUntypedArgument){const L=ga(f),N=ga(p);if(L.kind!=="string"||N.kind!=="string")return r(z,f,p)}return this.collator?s(z,f,p,this.collator.evaluate(z)):r(z,f,p)}eachChild(z){z(this.lhs),z(this.rhs),this.collator&&z(this.collator)}outputDefined(){return!0}serialize(){const z=[u];return this.eachChild(f=>{z.push(f.serialize())}),z}}}const X2=Wp("==",O2,qv),K2=Wp("!=",F2,q2),J2=Wp("<",U2,G2),Y2=Wp(">",N2,Z2),$2=Wp("<=",j2,H2),Q2=Wp(">=",V2,W2);class dg{constructor(r,s,y,w,z){this.type=Fr,this.number=r,this.locale=s,this.currency=y,this.minFractionDigits=w,this.maxFractionDigits=z}static parse(r,s){if(r.length!==3)return s.error("Expected two arguments.");const y=s.parse(r[1],1,hi);if(!y)return null;const w=r[2];if(typeof w!="object"||Array.isArray(w))return s.error("NumberFormat options argument must be an object.");let z=null;if(w.locale&&(z=s.parse(w.locale,1,Fr),!z))return null;let f=null;if(w.currency&&(f=s.parse(w.currency,1,Fr),!f))return null;let p=null;if(w["min-fraction-digits"]&&(p=s.parse(w["min-fraction-digits"],1,hi),!p))return null;let L=null;return w["max-fraction-digits"]&&(L=s.parse(w["max-fraction-digits"],1,hi),!L)?null:new dg(y,z,f,p,L)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class fg{constructor(r){this.type=hi,this.input=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const y=s.parse(r[1],1);return y?y.type.kind!=="array"&&y.type.kind!=="string"&&y.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${vo(y.type)} instead.`):new fg(y):null}evaluate(r){const s=this.input.evaluate(r);if(typeof s=="string")return s.length;if(Array.isArray(s))return s.length;throw new Fa(`Expected value to be of type string or array, but found ${vo(ga(s))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild(s=>{r.push(s.serialize())}),r}}const mg={"==":X2,"!=":K2,">":Y2,"<":J2,">=":Q2,"<=":$2,array:_u,at:ug,boolean:_u,case:pg,coalesce:Fd,collator:am,format:nm,image:om,in:cg,"index-of":Hf,interpolate:Ol,"interpolate-hcl":Ol,"interpolate-lab":Ol,length:fg,let:hm,literal:Up,match:hg,number:_u,"number-format":dg,object:_u,slice:Wf,step:cm,string:_u,"to-boolean":yh,"to-color":yh,"to-number":yh,"to-string":yh,var:sm,within:Qh};function V_(u,[r,s,y,w]){r=r.evaluate(u),s=s.evaluate(u),y=y.evaluate(u);const z=w?w.evaluate(u):1,f=kv(r,s,y,z);if(f)throw new Fa(f);return new En(r/255*z,s/255*z,y/255*z,z)}function q_(u,r){return u in r}function Iy(u,r){const s=r[u];return typeof s=="undefined"?null:s}function eE(u,r,s,y){for(;s<=y;){const w=s+y>>1;if(r[w]===u)return!0;r[w]>u?y=w-1:s=w+1}return!1}function Wh(u){return{type:u}}vu.register(mg,{error:[s2,[Fr],(u,[r])=>{throw new Fa(r.evaluate(u))}],typeof:[Fr,[Ar],(u,[r])=>vo(ga(r.evaluate(u)))],"to-rgba":[Dl(hi,4),[Dc],(u,[r])=>r.evaluate(u).toArray()],rgb:[Dc,[hi,hi,hi],V_],rgba:[Dc,[hi,hi,hi,hi],V_],has:{type:Tr,overloads:[[[Fr],(u,[r])=>q_(r.evaluate(u),u.properties())],[[Fr,Lp],(u,[r,s])=>q_(r.evaluate(u),s.evaluate(u))]]},get:{type:Ar,overloads:[[[Fr],(u,[r])=>Iy(r.evaluate(u),u.properties())],[[Fr,Lp],(u,[r,s])=>Iy(r.evaluate(u),s.evaluate(u))]]},"feature-state":[Ar,[Fr],(u,[r])=>Iy(r.evaluate(u),u.featureState||{})],properties:[Lp,[],u=>u.properties()],"geometry-type":[Fr,[],u=>u.geometryType()],id:[Ar,[],u=>u.id()],zoom:[hi,[],u=>u.globals.zoom],pitch:[hi,[],u=>u.globals.pitch||0],"distance-from-center":[hi,[],u=>u.distanceFromCenter()],"heatmap-density":[hi,[],u=>u.globals.heatmapDensity||0],"line-progress":[hi,[],u=>u.globals.lineProgress||0],"sky-radial-progress":[hi,[],u=>u.globals.skyRadialProgress||0],accumulated:[Ar,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[hi,Wh(hi),(u,r)=>{let s=0;for(const y of r)s+=y.evaluate(u);return s}],"*":[hi,Wh(hi),(u,r)=>{let s=1;for(const y of r)s*=y.evaluate(u);return s}],"-":{type:hi,overloads:[[[hi,hi],(u,[r,s])=>r.evaluate(u)-s.evaluate(u)],[[hi],(u,[r])=>-r.evaluate(u)]]},"/":[hi,[hi,hi],(u,[r,s])=>r.evaluate(u)/s.evaluate(u)],"%":[hi,[hi,hi],(u,[r,s])=>r.evaluate(u)%s.evaluate(u)],ln2:[hi,[],()=>Math.LN2],pi:[hi,[],()=>Math.PI],e:[hi,[],()=>Math.E],"^":[hi,[hi,hi],(u,[r,s])=>Math.pow(r.evaluate(u),s.evaluate(u))],sqrt:[hi,[hi],(u,[r])=>Math.sqrt(r.evaluate(u))],log10:[hi,[hi],(u,[r])=>Math.log(r.evaluate(u))/Math.LN10],ln:[hi,[hi],(u,[r])=>Math.log(r.evaluate(u))],log2:[hi,[hi],(u,[r])=>Math.log(r.evaluate(u))/Math.LN2],sin:[hi,[hi],(u,[r])=>Math.sin(r.evaluate(u))],cos:[hi,[hi],(u,[r])=>Math.cos(r.evaluate(u))],tan:[hi,[hi],(u,[r])=>Math.tan(r.evaluate(u))],asin:[hi,[hi],(u,[r])=>Math.asin(r.evaluate(u))],acos:[hi,[hi],(u,[r])=>Math.acos(r.evaluate(u))],atan:[hi,[hi],(u,[r])=>Math.atan(r.evaluate(u))],min:[hi,Wh(hi),(u,r)=>Math.min(...r.map(s=>s.evaluate(u)))],max:[hi,Wh(hi),(u,r)=>Math.max(...r.map(s=>s.evaluate(u)))],abs:[hi,[hi],(u,[r])=>Math.abs(r.evaluate(u))],round:[hi,[hi],(u,[r])=>{const s=r.evaluate(u);return s<0?-Math.round(-s):Math.round(s)}],floor:[hi,[hi],(u,[r])=>Math.floor(r.evaluate(u))],ceil:[hi,[hi],(u,[r])=>Math.ceil(r.evaluate(u))],"filter-==":[Tr,[Fr,Ar],(u,[r,s])=>u.properties()[r.value]===s.value],"filter-id-==":[Tr,[Ar],(u,[r])=>u.id()===r.value],"filter-type-==":[Tr,[Fr],(u,[r])=>u.geometryType()===r.value],"filter-<":[Tr,[Fr,Ar],(u,[r,s])=>{const y=u.properties()[r.value],w=s.value;return typeof y==typeof w&&y<w}],"filter-id-<":[Tr,[Ar],(u,[r])=>{const s=u.id(),y=r.value;return typeof s==typeof y&&s<y}],"filter->":[Tr,[Fr,Ar],(u,[r,s])=>{const y=u.properties()[r.value],w=s.value;return typeof y==typeof w&&y>w}],"filter-id->":[Tr,[Ar],(u,[r])=>{const s=u.id(),y=r.value;return typeof s==typeof y&&s>y}],"filter-<=":[Tr,[Fr,Ar],(u,[r,s])=>{const y=u.properties()[r.value],w=s.value;return typeof y==typeof w&&y<=w}],"filter-id-<=":[Tr,[Ar],(u,[r])=>{const s=u.id(),y=r.value;return typeof s==typeof y&&s<=y}],"filter->=":[Tr,[Fr,Ar],(u,[r,s])=>{const y=u.properties()[r.value],w=s.value;return typeof y==typeof w&&y>=w}],"filter-id->=":[Tr,[Ar],(u,[r])=>{const s=u.id(),y=r.value;return typeof s==typeof y&&s>=y}],"filter-has":[Tr,[Ar],(u,[r])=>r.value in u.properties()],"filter-has-id":[Tr,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Tr,[Dl(Fr)],(u,[r])=>r.value.indexOf(u.geometryType())>=0],"filter-id-in":[Tr,[Dl(Ar)],(u,[r])=>r.value.indexOf(u.id())>=0],"filter-in-small":[Tr,[Fr,Dl(Ar)],(u,[r,s])=>s.value.indexOf(u.properties()[r.value])>=0],"filter-in-large":[Tr,[Fr,Dl(Ar)],(u,[r,s])=>eE(u.properties()[r.value],s.value,0,s.value.length-1)],all:{type:Tr,overloads:[[[Tr,Tr],(u,[r,s])=>r.evaluate(u)&&s.evaluate(u)],[Wh(Tr),(u,r)=>{for(const s of r)if(!s.evaluate(u))return!1;return!0}]]},any:{type:Tr,overloads:[[[Tr,Tr],(u,[r,s])=>r.evaluate(u)||s.evaluate(u)],[Wh(Tr),(u,r)=>{for(const s of r)if(s.evaluate(u))return!0;return!1}]]},"!":[Tr,[Tr],(u,[r])=>!r.evaluate(u)],"is-supported-script":[Tr,[Fr],(u,[r])=>{const s=u.globals&&u.globals.isSupportedScript;return s?s(r.evaluate(u)):!0}],upcase:[Fr,[Fr],(u,[r])=>r.evaluate(u).toUpperCase()],downcase:[Fr,[Fr],(u,[r])=>r.evaluate(u).toLowerCase()],concat:[Fr,Wh(Ar),(u,r)=>r.map(s=>Rd(s.evaluate(u))).join("")],"resolved-locale":[Fr,[im],(u,[r])=>r.evaluate(u).resolvedLocale()]});function Gy(u){return{result:"success",value:u}}function Mp(u){return{result:"error",value:u}}function tE(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function iE(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function Zv(u){return!!u.expression&&u.expression.interpolated}function yg(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function gg(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function rE(u){return u}function _g(u,r){const s=r.type==="color",y=u.stops&&typeof u.stops[0][0]=="object",w=y||u.property!==void 0,z=y||!w,f=u.type||(Zv(r)?"exponential":"interval");if(s&&(u=Cv({},u),u.stops&&(u.stops=u.stops.map(U=>[U[0],En.parse(U[1])])),u.default?u.default=En.parse(u.default):u.default=En.parse(r.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!Vv[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let p,L,N;if(f==="exponential")p=G_;else if(f==="interval")p=oE;else if(f==="categorical"){p=nE,L=Object.create(null);for(const U of u.stops)L[U[0]]=U[1];N=typeof u.stops[0][0]}else if(f==="identity")p=aE;else throw new Error(`Unknown function type "${f}"`);if(y){const U={},G=[];for(let ge=0;ge<u.stops.length;ge++){const De=u.stops[ge],Le=De[0].zoom;U[Le]===void 0&&(U[Le]={zoom:Le,type:u.type,property:u.property,default:u.default,stops:[]},G.push(Le)),U[Le].stops.push([De[0].value,De[1]])}const X=[];for(const ge of G)X.push([U[ge].zoom,_g(U[ge],r)]);const Se={name:"linear"};return{kind:"composite",interpolationType:Se,interpolationFactor:Ol.interpolationFactor.bind(void 0,Se),zoomStops:X.map(ge=>ge[0]),evaluate({zoom:ge},De){return G_({stops:X,base:u.base},r,ge).evaluate(ge,De)}}}else if(z){const U=f==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:U,interpolationFactor:Ol.interpolationFactor.bind(void 0,U),zoomStops:u.stops.map(G=>G[0]),evaluate:({zoom:G})=>p(u,r,G,L,N)}}else return{kind:"source",evaluate(U,G){const X=G&&G.properties?G.properties[u.property]:void 0;return X===void 0?Vd(u.default,r.default):p(u,r,X,L,N)}}}function Vd(u,r,s){if(u!==void 0)return u;if(r!==void 0)return r;if(s!==void 0)return s}function nE(u,r,s,y,w){const z=typeof s===w?y[s]:void 0;return Vd(z,u.default,r.default)}function oE(u,r,s){if(yg(s)!=="number")return Vd(u.default,r.default);const y=u.stops.length;if(y===1||s<=u.stops[0][0])return u.stops[0][1];if(s>=u.stops[y-1][0])return u.stops[y-1][1];const w=um(u.stops.map(z=>z[0]),s);return u.stops[w][1]}function G_(u,r,s){const y=u.base!==void 0?u.base:1;if(yg(s)!=="number")return Vd(u.default,r.default);const w=u.stops.length;if(w===1||s<=u.stops[0][0])return u.stops[0][1];if(s>=u.stops[w-1][0])return u.stops[w-1][1];const z=um(u.stops.map(U=>U[0]),s),f=sE(s,y,u.stops[z][0],u.stops[z+1][0]),p=u.stops[z][1],L=u.stops[z+1][1];let N=Dv[r.type]||rE;if(u.colorSpace&&u.colorSpace!=="rgb"){const U=Vv[u.colorSpace];N=(G,X)=>U.reverse(U.interpolate(U.forward(G),U.forward(X),f))}return typeof p.evaluate=="function"?{evaluate(...U){const G=p.evaluate.apply(void 0,U),X=L.evaluate.apply(void 0,U);if(!(G===void 0||X===void 0))return N(G,X,f)}}:N(p,L,f)}function aE(u,r,s){return r.type==="color"?s=En.parse(s):r.type==="formatted"?s=xu.fromString(s.toString()):r.type==="resolvedImage"?s=Bc.fromString(s.toString()):yg(s)!==r.type&&(r.type!=="enum"||!r.values[s])&&(s=void 0),Vd(s,u.default,r.default)}function sE(u,r,s,y){const w=y-s,z=u-s;return w===0?0:r===1?z/w:(Math.pow(r,z)-1)/(Math.pow(r,w)-1)}class Hv{constructor(r,s){this.expression=r,this._warningHistory={},this._evaluator=new zv,this._defaultValue=s?cE(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(r,s,y,w,z,f,p,L){return this._evaluator.globals=r,this._evaluator.feature=s,this._evaluator.featureState=y,this._evaluator.canonical=w||null,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=f,this._evaluator.featureTileCoord=p||null,this._evaluator.featureDistanceData=L||null,this.expression.evaluate(this._evaluator)}evaluate(r,s,y,w,z,f,p,L){this._evaluator.globals=r,this._evaluator.feature=s||null,this._evaluator.featureState=y||null,this._evaluator.canonical=w||null,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=f||null,this._evaluator.featureTileCoord=p||null,this._evaluator.featureDistanceData=L||null;try{const N=this.expression.evaluate(this._evaluator);if(N==null||typeof N=="number"&&N!==N)return this._defaultValue;if(this._enumValues&&!(N in this._enumValues))throw new Fa(`Expected value to be one of ${Object.keys(this._enumValues).map(U=>JSON.stringify(U)).join(", ")}, but found ${JSON.stringify(N)} instead.`);return N}catch(N){return this._warningHistory[N.message]||(this._warningHistory[N.message]=!0,typeof console!="undefined"&&console.warn(N.message)),this._defaultValue}}}function Wv(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in mg}function Xv(u,r){const s=new lm(mg,[],r?uE(r):void 0),y=s.parse(u,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return y?Gy(new Hv(y,r)):Mp(s.errors)}class Zy{constructor(r,s){this.kind=r,this._styleExpression=s,this.isStateDependent=r!=="constant"&&!sg(s.expression)}evaluateWithoutErrorHandling(r,s,y,w,z,f){return this._styleExpression.evaluateWithoutErrorHandling(r,s,y,w,z,f)}evaluate(r,s,y,w,z,f){return this._styleExpression.evaluate(r,s,y,w,z,f)}}class Hy{constructor(r,s,y,w){this.kind=r,this.zoomStops=y,this._styleExpression=s,this.isStateDependent=r!=="camera"&&!sg(s.expression),this.interpolationType=w}evaluateWithoutErrorHandling(r,s,y,w,z,f){return this._styleExpression.evaluateWithoutErrorHandling(r,s,y,w,z,f)}evaluate(r,s,y,w,z,f){return this._styleExpression.evaluate(r,s,y,w,z,f)}interpolationFactor(r,s,y){return this.interpolationType?Ol.interpolationFactor(this.interpolationType,r,s,y):0}}function Kv(u,r){if(u=Xv(u,r),u.result==="error")return u;const s=u.value.expression,y=ag(s);if(!y&&!tE(r))return Mp([new $u("","data expressions not supported")]);const w=lg(s,["zoom","pitch","distance-from-center"]);if(!w&&!iE(r))return Mp([new $u("","zoom expressions not supported")]);const z=Bf(s);if(!z&&!w)return Mp([new $u("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(z instanceof $u)return Mp([z]);if(z instanceof Ol&&!Zv(r))return Mp([new $u("",'"interpolate" expressions cannot be used with this property')]);if(!z)return Gy(y?new Zy("constant",u.value):new Zy("source",u.value));const f=z instanceof Ol?z.interpolation:void 0;return Gy(y?new Hy("camera",u.value,z.labels,f):new Hy("composite",u.value,z.labels,f))}class pm{constructor(r,s){this._parameters=r,this._specification=s,Cv(this,_g(this._parameters,this._specification))}static deserialize(r){return new pm(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function lE(u,r){if(gg(u))return new pm(u,r);if(Wv(u)){const s=Kv(u,r);if(s.result==="error")throw new Error(s.value.map(y=>`${y.key}: ${y.message}`).join(", "));return s.value}else{let s=u;return typeof u=="string"&&r.type==="color"&&(s=En.parse(u)),{kind:"constant",evaluate:()=>s}}}function Bf(u){let r=null;if(u instanceof hm)r=Bf(u.result);else if(u instanceof Fd){for(const s of u.args)if(r=Bf(s),r)break}else(u instanceof cm||u instanceof Ol)&&u.input instanceof vu&&u.input.name==="zoom"&&(r=u);return r instanceof $u||u.eachChild(s=>{const y=Bf(s);y instanceof $u?r=y:!r&&y?r=new $u("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&y&&r!==y&&(r=new $u("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function uE(u){const r={color:Dc,string:Fr,number:hi,enum:Fr,boolean:Tr,formatted:rm,resolvedImage:jd};return u.type==="array"?Dl(r[u.value]||Ar,u.length):r[u.type]}function cE(u){return u.type==="color"&&gg(u.default)?new En(0,0,0,0):u.type==="color"?En.parse(u.default)||null:u.default===void 0?null:u.default}function Ud(u){return typeof u=="object"?["literal",u]:u}function hE(u,r){let s=u.stops;if(!s)return pE(u,r);const y=s&&typeof s[0][0]=="object",w=y||u.property!==void 0,z=y||!w;return s=s.map(f=>!w&&r.tokens&&typeof f[1]=="string"?[f[0],yE(f[1])]:[f[0],Ud(f[1])]),y?dE(u,r,s):z?mE(u,r,s):Wy(u,r,s)}function pE(u,r){const s=["get",u.property];if(u.default===void 0)return r.type==="string"?["string",s]:s;if(r.type==="enum")return["match",s,Object.keys(r.values),s,u.default];{const y=[r.type==="color"?"to-color":r.type,s,Ud(u.default)];return r.type==="array"&&y.splice(1,0,r.value,r.length||null),y}}function vg(u){switch(u.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function dE(u,r,s){const y={},w={},z=[];for(let p=0;p<s.length;p++){const L=s[p],N=L[0].zoom;y[N]===void 0&&(y[N]={zoom:N,type:u.type,property:u.property,default:u.default},w[N]=[],z.push(N)),w[N].push([L[0].value,L[1]])}if(bg({},r)==="exponential"){const p=[vg(u),["linear"],["zoom"]];for(const L of z){const N=Wy(y[L],r,w[L]);Rp(p,L,N,!1)}return p}else{const p=["step",["zoom"]];for(const L of z){const N=Wy(y[L],r,w[L]);Rp(p,L,N,!0)}return xg(p),p}}function fE(u,r){if(u!==void 0)return u;if(r!==void 0)return r}function Z_(u,r){const s=Ud(fE(u.default,r.default));return s===void 0&&r.type==="resolvedImage"?"":s}function Wy(u,r,s){const y=bg(u,r),w=["get",u.property];if(y==="categorical"&&typeof s[0][0]=="boolean"){const z=["case"];for(const f of s)z.push(["==",w,f[0]],f[1]);return z.push(Z_(u,r)),z}else if(y==="categorical"){const z=["match",w];for(const f of s)Rp(z,f[0],f[1],!1);return z.push(Z_(u,r)),z}else if(y==="interval"){const z=["step",["number",w]];for(const f of s)Rp(z,f[0],f[1],!0);return xg(z),u.default===void 0?z:["case",["==",["typeof",w],"number"],z,Ud(u.default)]}else if(y==="exponential"){const z=u.base!==void 0?u.base:1,f=[vg(u),z===1?["linear"]:["exponential",z],["number",w]];for(const p of s)Rp(f,p[0],p[1],!1);return u.default===void 0?f:["case",["==",["typeof",w],"number"],f,Ud(u.default)]}else throw new Error(`Unknown property function type ${y}`)}function mE(u,r,s,y=["zoom"]){const w=bg(u,r);let z,f=!1;if(w==="interval")z=["step",y],f=!0;else if(w==="exponential"){const p=u.base!==void 0?u.base:1;z=[vg(u),p===1?["linear"]:["exponential",p],y]}else throw new Error(`Unknown zoom function type "${w}"`);for(const p of s)Rp(z,p[0],p[1],f);return xg(z),z}function xg(u){u[0]==="step"&&u.length===3&&(u.push(0),u.push(u[3]))}function Rp(u,r,s,y){u.length>3&&r===u[u.length-2]||(y&&u.length===2||u.push(r),u.push(s))}function bg(u,r){return u.type?u.type:r.expression.interpolated?"exponential":"interval"}function yE(u){const r=["concat"],s=/{([^{}]+)}/g;let y=0;for(let w=s.exec(u);w!==null;w=s.exec(u)){const z=u.slice(y,s.lastIndex-w[0].length);y=s.lastIndex,z.length>0&&r.push(z),r.push(["get",w[1]])}if(r.length===1)return u;if(y<u.length)r.push(u.slice(y));else if(r.length===2)return["to-string",r[1]];return r}function Jv(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const r of u.slice(1))if(!Jv(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}em(function(u,r){var s=function(){var y=function(ft,Ue,Re,st){for(Re=Re||{},st=ft.length;st--;Re[ft[st]]=Ue);return Re},w=[1,12],z=[1,13],f=[1,9],p=[1,10],L=[1,11],N=[1,14],U=[1,15],G=[14,18,22,24],X=[18,22],Se=[22,24],ge={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(Ue,Re,st,ut,ht,at,$t){var xt=at.length-1;switch(ht){case 1:this.$=new String(Ue.replace(/\\(\\|")/g,"$1").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b")),this.$.__line__=this._$.first_line;break;case 2:this.$=new Number(Ue),this.$.__line__=this._$.first_line;break;case 3:this.$=null;break;case 4:this.$=new Boolean(!0),this.$.__line__=this._$.first_line;break;case 5:this.$=new Boolean(!1),this.$.__line__=this._$.first_line;break;case 6:return this.$=at[xt-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=at[xt-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[at[xt-2],at[xt]];break;case 16:this.$={},this.$[at[xt][0]]=at[xt][1];break;case 17:this.$=at[xt-2],at[xt-2][at[xt][0]]=at[xt][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[at[xt]];break;case 21:this.$=at[xt-2],at[xt-2].push(at[xt]);break}},table:[{3:5,4:w,5:6,6:z,7:3,8:f,9:4,10:p,11:L,12:1,13:2,15:7,16:8,17:N,23:U},{1:[3]},{14:[1,16]},y(G,[2,7]),y(G,[2,8]),y(G,[2,9]),y(G,[2,10]),y(G,[2,11]),y(G,[2,12]),y(G,[2,3]),y(G,[2,4]),y(G,[2,5]),y([14,18,21,22,24],[2,1]),y(G,[2,2]),{3:20,4:w,18:[1,17],19:18,20:19},{3:5,4:w,5:6,6:z,7:3,8:f,9:4,10:p,11:L,13:23,15:7,16:8,17:N,23:U,24:[1,21],25:22},{1:[2,6]},y(G,[2,13]),{18:[1,24],22:[1,25]},y(X,[2,16]),{21:[1,26]},y(G,[2,18]),{22:[1,28],24:[1,27]},y(Se,[2,20]),y(G,[2,14]),{3:20,4:w,20:29},{3:5,4:w,5:6,6:z,7:3,8:f,9:4,10:p,11:L,13:30,15:7,16:8,17:N,23:U},y(G,[2,19]),{3:5,4:w,5:6,6:z,7:3,8:f,9:4,10:p,11:L,13:31,15:7,16:8,17:N,23:U},y(X,[2,17]),y(X,[2,15]),y(Se,[2,21])],defaultActions:{16:[2,6]},parseError:function(Ue,Re){if(Re.recoverable)this.trace(Ue);else throw new Error(Ue)},parse:function(Ue){var Re=this,st=[0],ut=[null],ht=[],at=this.table,$t="",xt=0,qt=0,_i=2,Ri=1,Ht=ht.slice.call(arguments,1),Qt=Object.create(this.lexer),Si={yy:{}};for(var bt in this.yy)Object.prototype.hasOwnProperty.call(this.yy,bt)&&(Si.yy[bt]=this.yy[bt]);Qt.setInput(Ue,Si.yy),Si.yy.lexer=Qt,Si.yy.parser=this,typeof Qt.yylloc=="undefined"&&(Qt.yylloc={});var Fi=Qt.yylloc;ht.push(Fi);var Dt=Qt.options&&Qt.options.ranges;typeof Si.yy.parseError=="function"?this.parseError=Si.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function bi(){var Mt;return Mt=Qt.lex()||Ri,typeof Mt!="number"&&(Mt=Re.symbols_[Mt]||Mt),Mt}for(var zt,Yt,Et,xi,Gt={},Ji,Ni,Ai,or;;){if(Yt=st[st.length-1],this.defaultActions[Yt]?Et=this.defaultActions[Yt]:((zt===null||typeof zt=="undefined")&&(zt=bi()),Et=at[Yt]&&at[Yt][zt]),typeof Et=="undefined"||!Et.length||!Et[0]){var Li="";or=[];for(Ji in at[Yt])this.terminals_[Ji]&&Ji>_i&&or.push("'"+this.terminals_[Ji]+"'");Qt.showPosition?Li="Parse error on line "+(xt+1)+`:
`+Qt.showPosition()+`
Expecting `+or.join(", ")+", got '"+(this.terminals_[zt]||zt)+"'":Li="Parse error on line "+(xt+1)+": Unexpected "+(zt==Ri?"end of input":"'"+(this.terminals_[zt]||zt)+"'"),this.parseError(Li,{text:Qt.match,token:this.terminals_[zt]||zt,line:Qt.yylineno,loc:Fi,expected:or})}if(Et[0]instanceof Array&&Et.length>1)throw new Error("Parse Error: multiple actions possible at state: "+Yt+", token: "+zt);switch(Et[0]){case 1:st.push(zt),ut.push(Qt.yytext),ht.push(Qt.yylloc),st.push(Et[1]),zt=null,qt=Qt.yyleng,$t=Qt.yytext,xt=Qt.yylineno,Fi=Qt.yylloc;break;case 2:if(Ni=this.productions_[Et[1]][1],Gt.$=ut[ut.length-Ni],Gt._$={first_line:ht[ht.length-(Ni||1)].first_line,last_line:ht[ht.length-1].last_line,first_column:ht[ht.length-(Ni||1)].first_column,last_column:ht[ht.length-1].last_column},Dt&&(Gt._$.range=[ht[ht.length-(Ni||1)].range[0],ht[ht.length-1].range[1]]),xi=this.performAction.apply(Gt,[$t,qt,xt,Si.yy,Et[1],ut,ht].concat(Ht)),typeof xi!="undefined")return xi;Ni&&(st=st.slice(0,-1*Ni*2),ut=ut.slice(0,-1*Ni),ht=ht.slice(0,-1*Ni)),st.push(this.productions_[Et[1]][0]),ut.push(Gt.$),ht.push(Gt._$),Ai=at[st[st.length-2]][st[st.length-1]],st.push(Ai);break;case 3:return!0}}return!0}},De=function(){var ft={EOF:1,parseError:function(Re,st){if(this.yy.parser)this.yy.parser.parseError(Re,st);else throw new Error(Re)},setInput:function(Ue,Re){return this.yy=Re||this.yy||{},this._input=Ue,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var Ue=this._input[0];this.yytext+=Ue,this.yyleng++,this.offset++,this.match+=Ue,this.matched+=Ue;var Re=Ue.match(/(?:\r\n?|\n).*/g);return Re?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),Ue},unput:function(Ue){var Re=Ue.length,st=Ue.split(/(?:\r\n?|\n)/g);this._input=Ue+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Re),this.offset-=Re;var ut=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),st.length-1&&(this.yylineno-=st.length-1);var ht=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:st?(st.length===ut.length?this.yylloc.first_column:0)+ut[ut.length-st.length].length-st[0].length:this.yylloc.first_column-Re},this.options.ranges&&(this.yylloc.range=[ht[0],ht[0]+this.yyleng-Re]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(Ue){this.unput(this.match.slice(Ue))},pastInput:function(){var Ue=this.matched.substr(0,this.matched.length-this.match.length);return(Ue.length>20?"...":"")+Ue.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var Ue=this.match;return Ue.length<20&&(Ue+=this._input.substr(0,20-Ue.length)),(Ue.substr(0,20)+(Ue.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var Ue=this.pastInput(),Re=new Array(Ue.length+1).join("-");return Ue+this.upcomingInput()+`
`+Re+"^"},test_match:function(Ue,Re){var st,ut,ht;if(this.options.backtrack_lexer&&(ht={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(ht.yylloc.range=this.yylloc.range.slice(0))),ut=Ue[0].match(/(?:\r\n?|\n).*/g),ut&&(this.yylineno+=ut.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:ut?ut[ut.length-1].length-ut[ut.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+Ue[0].length},this.yytext+=Ue[0],this.match+=Ue[0],this.matches=Ue,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(Ue[0].length),this.matched+=Ue[0],st=this.performAction.call(this,this.yy,this,Re,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),st)return st;if(this._backtrack){for(var at in ht)this[at]=ht[at];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var Ue,Re,st,ut;this._more||(this.yytext="",this.match="");for(var ht=this._currentRules(),at=0;at<ht.length;at++)if(st=this._input.match(this.rules[ht[at]]),st&&(!Re||st[0].length>Re[0].length)){if(Re=st,ut=at,this.options.backtrack_lexer){if(Ue=this.test_match(st,ht[at]),Ue!==!1)return Ue;if(this._backtrack){Re=!1;continue}else return!1}else if(!this.options.flex)break}return Re?(Ue=this.test_match(Re,ht[ut]),Ue!==!1?Ue:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var Re=this.next();return Re||this.lex()},begin:function(Re){this.conditionStack.push(Re)},popState:function(){var Re=this.conditionStack.length-1;return Re>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(Re){return Re=this.conditionStack.length-1-Math.abs(Re||0),Re>=0?this.conditionStack[Re]:"INITIAL"},pushState:function(Re){this.begin(Re)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(Re,st,ut,ht){switch(ut){case 0:break;case 1:return 6;case 2:return st.yytext=st.yytext.substr(1,st.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return ft}();ge.lexer=De;function Le(){this.yy={}}return Le.prototype=ge,ge.Parser=Le,new Le}();typeof r2!="undefined"&&(r.parser=s,r.Parser=s.Parser,r.parse=function(){return s.parse.apply(s,arguments)})});const gE={StyleExpression:Hv,isExpression:Wv,isExpressionFilter:Jv,createExpression:Xv,createPropertyExpression:Kv,normalizePropertyExpression:lE,ZoomConstantExpression:Zy,ZoomDependentExpression:Hy,StylePropertyFunction:pm},_E={convertFunction:hE,createFunction:_g,isFunction:gg};function vE(u){var r=u.expr,s=u.layer,y=Math.min(r(s,"paint","circle-radius"),8),w=Math.min(r(s,"paint","circle-stroke-width"),4),z=r(s,"paint","circle-color"),f=r(s,"paint","circle-opacity"),p=r(s,"paint","circle-stroke-color"),L=r(s,"paint","circle-stroke-opacity"),N=y-w/2;return{element:"svg",attributes:{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",style:{filter:"blur("+r(s,"paint","circle-blur")*N+"px)"}},children:[{element:"circle",attributes:{key:"l1",cx:10,cy:10,fill:z,opacity:f,r:N}},{element:"circle",attributes:{key:"l2",cx:10,cy:10,fill:"transparent",opacity:L,r:y,"stroke-width":w,stroke:p}}]}}function xE(u){var r=u.expr,s=u.layer;return{element:"div",attributes:{style:{width:"100%",height:"100%",backgroundImage:"url("+(0,u.image)(r(s,"paint","fill-pattern"))+")",backgroundColor:r(s,"paint","fill-color"),opacity:r(s,"paint","fill-opacity"),backgroundSize:"66% 66%",backgroundPosition:"center"}}}}function bE(u){var r=u.layer,s=u.expr,y=(0,u.image)(s(r,"paint","line-pattern")),w={stroke:y?"url(#img1)":s(r,"paint","line-color"),strokeWidth:Math.max(2,Math.min(s(r,"paint","line-width"),8)),strokeOpacity:s(r,"paint","line-opacity")},z=w.strokeWidth;return{element:"svg",attributes:{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},children:[{element:"defs",attributes:{key:"defs"},children:[{element:"pattern",attributes:{key:"pattern",id:"img1",x:0,y:0,width:w.strokeWidth,height:w.strokeWidth,patternUnits:"userSpaceOnUse",patternTransform:"translate("+-z/2+" "+-z/2+") rotate(45)"},children:[{element:"image",attributes:{key:"img",xlinkHref:y,x:0,y:0,width:w.strokeWidth,height:w.strokeWidth}}]}]},{element:"path",attributes:{key:"path",style:w,stroke:w.stroke,d:"M0 20 L 20 0"}}]}}function wE(u){return function(p){var L=p.image,N=(0,p.expr)(p.layer,"layout","icon-image");if(!N)return null;var U=L(N);return U?{element:"div",attributes:{style:{backgroundImage:"url("+U+")",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",width:"100%",height:"100%"}}}:null}(u)||(w=(s=(r=u).expr)(y=r.layer,"paint","text-color"),z=s(y,"paint","text-opacity"),{element:"svg",attributes:{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},children:[{element:"path",attributes:{key:"l1",d:f="M 4,4 L 16,4 L 16,7 L 11.5 7 L 11.5 16 L 8.5 16 L 8.5 7 L 4 7 Z",stroke:s(y,"paint","text-halo-color"),"stroke-width":2*s(y,"paint","text-halo-width"),fill:"transparent","stroke-linejoin":"round"}},{element:"path",attributes:{key:"l2",d:f,fill:"white"}},{element:"path",attributes:{key:"l3",d:f,fill:w,opacity:z}}]});var r,s,y,w,z,f}var EE=[["background"],["circle"],["fill-extrusion"],["fill"],["heatmap"],["hillshade"],["line"],["raster"],["icon","symbol"],["text","symbol"]];function SE(u){var r,s=u.sprite,y=u.layer,w={circle:vE,symbol:wE,line:bE,fill:xE}[y.type],z=(r=u.zoom,function(f,p,L){var N=function(ge){var De=EE.find(function(Le){return ge.startsWith(Le[0])});return De?De[1]||De[0]:null}(L),U=i2[p+"_"+N][L];if(!f[p])return U.default;var G=f[p][L];if(G===void 0)return U.default;if(typeof G=="object"){var X;if(!(X=Array.isArray(G)?gE.createExpression(G).value:_E.createFunction(G,U)).evaluate)return null;var Se=X.evaluate({zoom:r},{});return Se?Se.name||Se:null}return G});return w?w({layer:y,expr:z,image:function(f){if(s&&s.json){var p=s.json[f];if(p)return L=s.image,U=(N=p).x,G=N.y,X=N.width,Se=N.height,(ge=document.createElement("canvas")).width=2*X,ge.height=2*Se,ge.getContext("2d").drawImage(L,2*U,2*G,2*X,2*Se,0,0,2*X,2*Se),ge.toDataURL()}var L,N,U,G,X,Se,ge;return null}}):null}class IE{constructor(r){this.spriteUrl=r}async load(){const r=await Promise.all([this.loadImage(`${this.spriteUrl}@2x.png`),this.fetchUrl(`${this.spriteUrl}@2x.json`)]);return this.sprite={image:r[0],json:r[1]},this.sprite}loadImage(r){let s=!1;const y=new Promise((w,z)=>{const f=new Image;f.crossOrigin="Anonymous",f.onload=()=>{s||w(f)},f.onerror=p=>{s||z(p)},f.src=r});return y.cancel=()=>{s=!0},y}async fetchUrl(r){return(await fetch(r)).json()}getIconDataUrl(r){let s;if(r.layout&&r.layout["icon-image"]){let y=r.layout["icon-image"];if(Array.isArray(y)&&(y=y[y.length-1]),this.sprite.json){let w;Object.keys(this.sprite.json).forEach(z=>{z===y&&(w=this.sprite.json[z])}),w&&(s=this.extractPartOfImage(this.sprite.image,w))}}return s}extractPartOfImage(r,s){const w=document.createElement("canvas");return w.width=s.width*1,w.height=s.height*1,w.getContext("2d").drawImage(r,s.x*1,s.y*1,s.width*1,s.height*1,0,0,s.width*1,s.height*1),w.toDataURL()}}function TE(u){let r,s=u[0].innerHTML+"";return{c(){r=mr("div"),this.h()},l(y){r=yr(y,"DIV",{class:!0});var w=Vr(r);w.forEach(Bt),this.h()},h(){jr(r,"class","legend svelte-1dizgfa")},m(y,w){ki(y,r,w),r.innerHTML=s},p(y,[w]){w&1&&s!==(s=y[0].innerHTML+"")&&(r.innerHTML=s)},i:Bl,o:Bl,d(y){y&&Bt(r)}}}function AE(u,r,s){let y,w;Lc(u,Qf,L=>s(2,y=L)),Lc(u,D_,L=>s(3,w=L));let{layer:z}=r,f=document.createElement("div");const p=async()=>{if(!w){const G=y.getStyle().sprite,X=new IE(G);await X.load(),D_.update(()=>X)}const L=y.getZoom(),N=SE({zoom:L,layer:z});if(s(0,f.innerText="",f),N){let G,X,Se;switch(N.element){case"div":if(N.attributes.style.backgroundImage&&!["url(undefined)","url(null)"].includes(N.attributes.style.backgroundImage)){var U=document.createElement("img");U.src=N.attributes.style.backgroundImage.replace("url(","").replace(")",""),U.alt=z.id,U.style.cssText="height: 24px;",f.appendChild(U)}G=document.createElement("div"),G.style.height="24px",G.style.width="50px",G.style.backgroundColor=N.attributes.style.backgroundColor,G.style.backgroundPosition=N.attributes.style.backgroundPosition,G.style.backgroundSize=N.attributes.style.backgroundSize,G.style.backgroundRepeat=N.attributes.style.backgroundRepeat,G.style.opacity=N.attributes.style.opacity,f.appendChild(G);break;case"svg":if(Se=w.getIconDataUrl(z),Se){const ge=document.createElement("img");ge.src=Se,ge.alt=z.id,ge.style.cssText="height: 24px;",f.appendChild(ge);break}X=document.createElementNS("http://www.w3.org/2000/svg","svg"),X.style.cssText="height: 24px;",X.setAttributeNS(null,"version","1.1"),Object.keys(N.attributes).forEach(ge=>{X.setAttribute(ge,N.attributes[ge]);let De=document.createElementNS("http://www.w3.org/2000/svg","g");N.children.forEach(Le=>{var ft=document.createElementNS("http://www.w3.org/2000/svg",Le.element);Object.keys(Le.attributes).forEach(Ue=>{ft.setAttributeNS(null,Ue,Le.attributes[Ue])}),De.appendChild(ft)}),X.appendChild(De)}),f.appendChild(X);break;default:console.log(N.element);return}}else{const G=document.createElementNS("http://www.w3.org/2000/svg","svg"),X=document.createElementNS("http://www.w3.org/2000/svg","path"),Se=document.createElementNS("http://www.w3.org/2000/svg","path");G.setAttribute("fill","none"),G.setAttribute("viewBox","0 0 24 24"),G.setAttribute("stroke","black"),G.classList.add("post-icon"),X.setAttribute("d","M21,0H3A3,3,0,0,0,0,3V21a3,3,0,0,0,3,3H21a3,3,0,0,0,3-3V3A3,3,0,0,0,21,0ZM3,2H21a1,1,0,0,1,1,1V15.86L14.18,9.35a5.06,5.06,0,0,0-6.39-.06L2,13.92V3A1,1,0,0,1,3,2ZM21,22H3a1,1,0,0,1-1-1V16.48l7-5.63a3.06,3.06,0,0,1,3.86,0L22,18.47V21A1,1,0,0,1,21,22Z"),X.setAttribute("stroke-linecap","round"),X.setAttribute("stroke-linejoin","round"),X.setAttribute("stroke-width","2"),Se.setAttribute("d","M18,9a3,3,0,1,0-3-3A3,3,0,0,0,18,9Zm0-4a1,1,0,1,1-1,1A1,1,0,0,1,18,5Z"),Se.setAttribute("stroke-linecap","round"),Se.setAttribute("stroke-linejoin","round"),Se.setAttribute("stroke-width","2"),G.appendChild(X),G.appendChild(Se),f.appendChild(G)}};return y.on("moveend",p),y.on("zoom",p),u.$$set=L=>{"layer"in L&&s(1,z=L.layer)},u.$$.update=()=>{u.$$.dirty&2&&p()},[f,z]}class CE extends gn{constructor(r){super(),_n(this,r,AE,TE,vn,{layer:1})}}function kE(u){let r,s,y,w,z;function f(L){u[2](L)}let p={touch:!0};return u[1]!==void 0&&(p.checked=u[1]),r=new Qb({props:p}),hn.push(()=>Nf(r,"checked",f)),w=new CE({props:{layer:u[0]}}),{c(){gr(r.$$.fragment),y=na(),gr(w.$$.fragment)},l(L){qr(r.$$.fragment,L),y=oa(L),qr(w.$$.fragment,L)},m(L,N){_r(r,L,N),ki(L,y,N),_r(w,L,N),z=!0},p(L,N){const U={};!s&&N&2&&(s=!0,U.checked=L[1],jf(()=>s=!1)),r.$set(U);const G={};N&1&&(G.layer=L[0]),w.$set(G)},i(L){z||(li(r.$$.fragment,L),li(w.$$.fragment,L),z=!0)},o(L){pi(r.$$.fragment,L),pi(w.$$.fragment,L),z=!1},d(L){vr(r,L),L&&Bt(y),vr(w,L)}}}function zE(u){let r,s=(Ur.legend&&Ur.legend.targets&&Ur.legend.targets[u[0].id]?Ur.legend.targets[u[0].id]:u[0].id)+"",y;return{c(){r=mr("span"),y=qp(s),this.h()},l(w){r=yr(w,"SPAN",{slot:!0});var z=Vr(r);y=Gp(z,s),z.forEach(Bt),this.h()},h(){jr(r,"slot","label")},m(w,z){ki(w,r,z),Ta(r,y)},p(w,z){z&1&&s!==(s=(Ur.legend&&Ur.legend.targets&&Ur.legend.targets[w[0].id]?Ur.legend.targets[w[0].id]:w[0].id)+"")&&$y(y,s)},d(w){w&&Bt(r)}}}function PE(u){let r,s,y;return s=new sw({props:{$$slots:{label:[zE],default:[kE]},$$scope:{ctx:u}}}),{c(){r=mr("div"),gr(s.$$.fragment)},l(w){r=yr(w,"DIV",{});var z=Vr(r);qr(s.$$.fragment,z),z.forEach(Bt)},m(w,z){ki(w,r,z),_r(s,r,null),y=!0},p(w,[z]){const f={};z&67&&(f.$$scope={dirty:z,ctx:w}),s.$set(f)},i(w){y||(li(s.$$.fragment,w),y=!0)},o(w){pi(s.$$.fragment,w),y=!1},d(w){w&&Bt(r),vr(s)}}}function ME(u,r,s){let y;Lc(u,Qf,N=>s(4,y=N));let{layer:w}=r,z="visible";w.layout&&w.layout.visibility==="none"&&(z="none");let f=z==="visible";const p=()=>{y.setLayoutProperty(w.id,"visibility",f===!0?"visible":"none")};function L(N){f=N,s(1,f)}return u.$$set=N=>{"layer"in N&&s(0,w=N.layer)},u.$$.update=()=>{u.$$.dirty&2&&p()},[w,f,L]}class dm extends gn{constructor(r){super(),_n(this,r,ME,PE,vn,{layer:0})}}function H_(u,r,s){const y=u.slice();return y[15]=r[s],y}function LE(u){let r=u[18].name+"",s;return{c(){s=qp(r)},l(y){s=Gp(y,r)},m(y,w){ki(y,s,w)},p(y,w){w&262144&&r!==(r=y[18].name+"")&&$y(s,r)},d(y){y&&Bt(s)}}}function DE(u){let r,s;return r=new Y1({props:{$$slots:{default:[LE]},$$scope:{ctx:u}}}),{c(){gr(r.$$.fragment)},l(y){qr(r.$$.fragment,y)},m(y,w){_r(r,y,w),s=!0},p(y,w){const z={};w&266240&&(z.$$scope={dirty:w,ctx:y}),r.$set(z)},i(y){s||(li(r.$$.fragment,y),s=!0)},o(y){pi(r.$$.fragment,y),s=!1},d(y){vr(r,y)}}}function RE(u){let r,s;function y(){return u[10](u[18])}return r=new Kb({props:{segment:u[18],selected:u[18].selected,$$slots:{default:[DE]},$$scope:{ctx:u}}}),r.$on("click",y),{c(){gr(r.$$.fragment)},l(w){qr(r.$$.fragment,w)},m(w,z){_r(r,w,z),s=!0},p(w,z){u=w;const f={};z&262144&&(f.segment=u[18]),z&262144&&(f.selected=u[18].selected),z&266240&&(f.$$scope={dirty:z,ctx:u}),r.$set(f)},i(w){s||(li(r.$$.fragment,w),s=!0)},o(w){pi(r.$$.fragment,w),s=!1},d(w){vr(r,w)}}}function BE(u){let r,s,y,w;return r=new qb({props:{segments:u[1],key:YE,$$slots:{default:[RE,({segment:z})=>({18:z}),({segment:z})=>z?262144:0]},$$scope:{ctx:u}}}),{c(){gr(r.$$.fragment),s=na(),y=mr("hr")},l(z){qr(r.$$.fragment,z),s=oa(z),y=yr(z,"HR",{})},m(z,f){_r(r,z,f),ki(z,s,f),ki(z,y,f),w=!0},p(z,f){const p={};f&2&&(p.segments=z[1]),f&266242&&(p.$$scope={dirty:f,ctx:z}),r.$set(p)},i(z){w||(li(r.$$.fragment,z),w=!0)},o(z){pi(r.$$.fragment,z),w=!1},d(z){vr(r,z),z&&Bt(s),z&&Bt(y)}}}function OE(u){let r,s;return r=new $f({props:{$$slots:{default:[NE]},$$scope:{ctx:u}}}),{c(){gr(r.$$.fragment)},l(y){qr(r.$$.fragment,y)},m(y,w){_r(r,y,w),s=!0},p(y,w){const z={};w&4112&&(z.$$scope={dirty:w,ctx:y}),r.$set(z)},i(y){s||(li(r.$$.fragment,y),s=!0)},o(y){pi(r.$$.fragment,y),s=!1},d(y){vr(r,y)}}}function FE(u){let r,s,y=u[6][u[15].id]&&W_(u);return{c(){y&&y.c(),r=an()},l(w){y&&y.l(w),r=an()},m(w,z){y&&y.m(w,z),ki(w,r,z),s=!0},p(w,z){w[6][w[15].id]?y?(y.p(w,z),z&80&&li(y,1)):(y=W_(w),y.c(),li(y,1),y.m(r.parentNode,r)):y&&(hl(),pi(y,1,1,()=>{y=null}),cl())},i(w){s||(li(y),s=!0)},o(w){pi(y),s=!1},d(w){y&&y.d(w),w&&Bt(r)}}}function UE(u){let r,s,y=u[5][u[15].id]&&X_(u);return{c(){y&&y.c(),r=an()},l(w){y&&y.l(w),r=an()},m(w,z){y&&y.m(w,z),ki(w,r,z),s=!0},p(w,z){w[5][w[15].id]?y?(y.p(w,z),z&48&&li(y,1)):(y=X_(w),y.c(),li(y,1),y.m(r.parentNode,r)):y&&(hl(),pi(y,1,1,()=>{y=null}),cl())},i(w){s||(li(y),s=!0)},o(w){pi(y),s=!1},d(w){y&&y.d(w),w&&Bt(r)}}}function NE(u){let r,s;return r=new dm({props:{layer:u[15]}}),{c(){gr(r.$$.fragment)},l(y){qr(r.$$.fragment,y)},m(y,w){_r(r,y,w),s=!0},p(y,w){const z={};w&16&&(z.layer=y[15]),r.$set(z)},i(y){s||(li(r.$$.fragment,y),s=!0)},o(y){pi(r.$$.fragment,y),s=!1},d(y){vr(r,y)}}}function W_(u){let r,s;return r=new $f({props:{$$slots:{default:[jE]},$$scope:{ctx:u}}}),{c(){gr(r.$$.fragment)},l(y){qr(r.$$.fragment,y)},m(y,w){_r(r,y,w),s=!0},p(y,w){const z={};w&4112&&(z.$$scope={dirty:w,ctx:y}),r.$set(z)},i(y){s||(li(r.$$.fragment,y),s=!0)},o(y){pi(r.$$.fragment,y),s=!1},d(y){vr(r,y)}}}function jE(u){let r,s;return r=new dm({props:{layer:u[15]}}),{c(){gr(r.$$.fragment)},l(y){qr(r.$$.fragment,y)},m(y,w){_r(r,y,w),s=!0},p(y,w){const z={};w&16&&(z.layer=y[15]),r.$set(z)},i(y){s||(li(r.$$.fragment,y),s=!0)},o(y){pi(r.$$.fragment,y),s=!1},d(y){vr(r,y)}}}function X_(u){let r,s,y,w;const z=[qE,VE],f=[];function p(L,N){return L[3]===!0?0:1}return r=p(u),s=f[r]=z[r](u),{c(){s.c(),y=an()},l(L){s.l(L),y=an()},m(L,N){f[r].m(L,N),ki(L,y,N),w=!0},p(L,N){let U=r;r=p(L),r===U?f[r].p(L,N):(hl(),pi(f[U],1,1,()=>{f[U]=null}),cl(),s=f[r],s?s.p(L,N):(s=f[r]=z[r](L),s.c()),li(s,1),s.m(y.parentNode,y))},i(L){w||(li(s),w=!0)},o(L){pi(s),w=!1},d(L){f[r].d(L),L&&Bt(y)}}}function VE(u){let r,s;return r=new $f({props:{$$slots:{default:[GE]},$$scope:{ctx:u}}}),{c(){gr(r.$$.fragment)},l(y){qr(r.$$.fragment,y)},m(y,w){_r(r,y,w),s=!0},p(y,w){const z={};w&4112&&(z.$$scope={dirty:w,ctx:y}),r.$set(z)},i(y){s||(li(r.$$.fragment,y),s=!0)},o(y){pi(r.$$.fragment,y),s=!1},d(y){vr(r,y)}}}function qE(u){let r,s,y=u[6][u[15].id]&&K_(u);return{c(){y&&y.c(),r=an()},l(w){y&&y.l(w),r=an()},m(w,z){y&&y.m(w,z),ki(w,r,z),s=!0},p(w,z){w[6][w[15].id]?y?(y.p(w,z),z&80&&li(y,1)):(y=K_(w),y.c(),li(y,1),y.m(r.parentNode,r)):y&&(hl(),pi(y,1,1,()=>{y=null}),cl())},i(w){s||(li(y),s=!0)},o(w){pi(y),s=!1},d(w){y&&y.d(w),w&&Bt(r)}}}function GE(u){let r,s;return r=new dm({props:{layer:u[15]}}),{c(){gr(r.$$.fragment)},l(y){qr(r.$$.fragment,y)},m(y,w){_r(r,y,w),s=!0},p(y,w){const z={};w&16&&(z.layer=y[15]),r.$set(z)},i(y){s||(li(r.$$.fragment,y),s=!0)},o(y){pi(r.$$.fragment,y),s=!1},d(y){vr(r,y)}}}function K_(u){let r,s;return r=new $f({props:{$$slots:{default:[ZE]},$$scope:{ctx:u}}}),{c(){gr(r.$$.fragment)},l(y){qr(r.$$.fragment,y)},m(y,w){_r(r,y,w),s=!0},p(y,w){const z={};w&4112&&(z.$$scope={dirty:w,ctx:y}),r.$set(z)},i(y){s||(li(r.$$.fragment,y),s=!0)},o(y){pi(r.$$.fragment,y),s=!1},d(y){vr(r,y)}}}function ZE(u){let r,s;return r=new dm({props:{layer:u[15]}}),{c(){gr(r.$$.fragment)},l(y){qr(r.$$.fragment,y)},m(y,w){_r(r,y,w),s=!0},p(y,w){const z={};w&16&&(z.layer=y[15]),r.$set(z)},i(y){s||(li(r.$$.fragment,y),s=!0)},o(y){pi(r.$$.fragment,y),s=!1},d(y){vr(r,y)}}}function J_(u){let r,s,y,w;const z=[UE,FE,OE],f=[];function p(L,N){return L[2]===!0?0:L[3]===!0?1:2}return r=p(u),s=f[r]=z[r](u),{c(){s.c(),y=an()},l(L){s.l(L),y=an()},m(L,N){f[r].m(L,N),ki(L,y,N),w=!0},p(L,N){let U=r;r=p(L),r===U?f[r].p(L,N):(hl(),pi(f[U],1,1,()=>{f[U]=null}),cl(),s=f[r],s?s.p(L,N):(s=f[r]=z[r](L),s.c()),li(s,1),s.m(y.parentNode,y))},i(L){w||(li(s),w=!0)},o(L){pi(s),w=!1},d(L){f[r].d(L),L&&Bt(y)}}}function HE(u){let r,s,y=u[4],w=[];for(let f=0;f<y.length;f+=1)w[f]=J_(H_(u,y,f));const z=f=>pi(w[f],1,1,()=>{w[f]=null});return{c(){for(let f=0;f<w.length;f+=1)w[f].c();r=an()},l(f){for(let p=0;p<w.length;p+=1)w[p].l(f);r=an()},m(f,p){for(let L=0;L<w.length;L+=1)w[L].m(f,p);ki(f,r,p),s=!0},p(f,p){if(p&124){y=f[4];let L;for(L=0;L<y.length;L+=1){const N=H_(f,y,L);w[L]?(w[L].p(N,p),li(w[L],1)):(w[L]=J_(N),w[L].c(),li(w[L],1),w[L].m(r.parentNode,r))}for(hl(),L=y.length;L<w.length;L+=1)z(L);cl()}},i(f){if(!s){for(let p=0;p<y.length;p+=1)li(w[p]);s=!0}},o(f){w=w.filter(Boolean);for(let p=0;p<w.length;p+=1)pi(w[p]);s=!1},d(f){xx(w,f),f&&Bt(r)}}}function WE(u){let r,s;return r=new zb({props:{$$slots:{default:[HE]},$$scope:{ctx:u}}}),{c(){gr(r.$$.fragment)},l(y){qr(r.$$.fragment,y)},m(y,w){_r(r,y,w),s=!0},p(y,w){const z={};w&4220&&(z.$$scope={dirty:w,ctx:y}),r.$set(z)},i(y){s||(li(r.$$.fragment,y),s=!0)},o(y){pi(r.$$.fragment,y),s=!1},d(y){vr(r,y)}}}function XE(u){let r,s,y,w,z;return s=new Tb({props:{$$slots:{default:[BE]},$$scope:{ctx:u}}}),w=new Ib({props:{$$slots:{default:[WE]},$$scope:{ctx:u}}}),{c(){r=mr("div"),gr(s.$$.fragment),y=na(),gr(w.$$.fragment),this.h()},l(f){r=yr(f,"DIV",{class:!0});var p=Vr(r);qr(s.$$.fragment,p),y=oa(p),qr(w.$$.fragment,p),p.forEach(Bt),this.h()},h(){jr(r,"class","drawer-content svelte-kw9kwo")},m(f,p){ki(f,r,p),_r(s,r,null),Ta(r,y),_r(w,r,null),z=!0},p(f,p){const L={};p&4098&&(L.$$scope={dirty:p,ctx:f}),s.$set(L);const N={};p&4220&&(N.$$scope={dirty:p,ctx:f}),w.$set(N)},i(f){z||(li(s.$$.fragment,f),li(w.$$.fragment,f),z=!0)},o(f){pi(s.$$.fragment,f),pi(w.$$.fragment,f),z=!1},d(f){f&&Bt(r),vr(s),vr(w)}}}function KE(u){let r,s;const y=u[9].default,w=Zn(y,u,u[12],null);return{c(){r=mr("main"),w&&w.c(),this.h()},l(z){r=yr(z,"MAIN",{class:!0});var f=Vr(r);w&&w.l(f),f.forEach(Bt),this.h()},h(){jr(r,"class","main-content svelte-kw9kwo")},m(z,f){ki(z,r,f),w&&w.m(r,null),s=!0},p(z,f){w&&w.p&&(!s||f&4096)&&Hn(w,y,z,z[12],s?Xn(y,z[12],f,null):Wn(z[12]),null)},i(z){s||(li(w,z),s=!0)},o(z){pi(w,z),s=!1},d(z){z&&Bt(r),w&&w.d(z)}}}function JE(u){let r,s,y,w,z,f;function p(N){u[11](N)}let L={variant:"dismissible",$$slots:{default:[XE]},$$scope:{ctx:u}};return u[0]!==void 0&&(L.open=u[0]),s=new Eb({props:L}),hn.push(()=>Nf(s,"open",p)),z=new Sb({props:{class:"app-content",$$slots:{default:[KE]},$$scope:{ctx:u}}}),{c(){r=mr("div"),gr(s.$$.fragment),w=na(),gr(z.$$.fragment),this.h()},l(N){r=yr(N,"DIV",{class:!0});var U=Vr(r);qr(s.$$.fragment,U),w=oa(U),qr(z.$$.fragment,U),U.forEach(Bt),this.h()},h(){jr(r,"class","drawer-container svelte-kw9kwo")},m(N,U){ki(N,r,U),_r(s,r,null),Ta(r,w),_r(z,r,null),f=!0},p(N,[U]){const G={};U&4222&&(G.$$scope={dirty:U,ctx:N}),!y&&U&1&&(y=!0,G.open=N[0],jf(()=>y=!1)),s.$set(G);const X={};U&4096&&(X.$$scope={dirty:U,ctx:N}),z.$set(X)},i(N){f||(li(s.$$.fragment,N),li(z.$$.fragment,N),f=!0)},o(N){pi(s.$$.fragment,N),pi(z.$$.fragment,N),f=!1},d(N){N&&Bt(r),vr(s),vr(z)}}}const YE=u=>u.name;function $E(u,r,s){let y;Lc(u,Qf,Ue=>s(8,y=Ue));let{$$slots:w={},$$scope:z}=r,{open:f=!1}=r,p,L=!0,N=!0,U=[{name:"Rendered",selected:!0},{name:"Water",selected:!0}];const G=()=>{s(2,L=!!U.find(Ue=>Ue.name==="Rendered"&&Ue.selected)),s(3,N=!!U.find(Ue=>Ue.name==="Water"&&Ue.selected))};let X=[],Se={},ge={};Ur.legend&&Ur.legend.targets&&(ge=Ur.legend.targets);const De=()=>{if(s(5,Se={}),y&&y.queryRenderedFeatures){const Ue=y.queryRenderedFeatures();for(let Re of Ue)s(5,Se[Re.layer.id]=Re.layer,Se)}},Le=Ue=>{Ue.selected=!Ue.selected,s(1,U)};function ft(Ue){f=Ue,s(0,f)}return u.$$set=Ue=>{"open"in Ue&&s(0,f=Ue.open),"$$scope"in Ue&&s(12,z=Ue.$$scope)},u.$$.update=()=>{u.$$.dirty&2&&G(),u.$$.dirty&384&&y&&(s(7,p=y.getStyle()),s(4,X=p.layers),y.on("load",De),y.on("moveend",De)),u.$$.dirty&1&&De()},[f,U,L,N,X,Se,ge,p,y,w,Le,ft,z]}class QE extends gn{constructor(r){super(),_n(this,r,$E,JE,vn,{open:0})}}var Rl=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function cC(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}function eS(u){if(u.__esModule)return u;var r=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(u).forEach(function(s){var y=Object.getOwnPropertyDescriptor(u,s);Object.defineProperty(r,s,y.get?y:{enumerable:!0,get:function(){return u[s]}})}),r}var Yh={exports:{}};(function(u,r){(function(s,y){u.exports=y()})(Rl,function(){var s,y,w;function z(p,L){if(!s)s=L;else if(!y)y=L;else{var N="var sharedChunk = {}; ("+s+")(sharedChunk); ("+y+")(sharedChunk);",U={};s(U),w=L(U),typeof window!="undefined"&&(w.workerUrl=window.URL.createObjectURL(new Blob([N],{type:"text/javascript"})))}}z(["exports"],function(p){var L=N;function N(i,t,a,h){this.cx=3*i,this.bx=3*(a-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(h-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=t,this.p2x=a,this.p2y=h}function U(i,t,a,h){const _=new L(i,t,a,h);return function(b){return _.solve(b)}}N.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,t){if(t===void 0&&(t=1e-6),i<0)return 0;if(i>1)return 1;for(var a=i,h=0;h<8;h++){var _=this.sampleCurveX(a)-i;if(Math.abs(_)<t)return a;var b=this.sampleCurveDerivativeX(a);if(Math.abs(b)<1e-6)break;a-=_/b}var S=0,P=1;for(a=i,h=0;h<20&&(_=this.sampleCurveX(a),!(Math.abs(_-i)<t));h++)i>_?S=a:P=a,a=.5*(P-S)+S;return a},solve:function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))}};const G=U(.25,.1,.25,1);function X(i,t,a){return Math.min(a,Math.max(t,i))}function Se(i,t,a){const h=a-t,_=((i-t)%h+h)%h+t;return _===t?a:_}function ge(i,...t){for(const a of t)for(const h in a)i[h]=a[h];return i}let De=1;function Le(i,t){i.forEach(a=>{t[a]&&(t[a]=t[a].bind(t))})}function ft(i,t,a){const h={};for(const _ in i)h[_]=t.call(a||this,i[_],_,i);return h}function Ue(i,t,a){const h={};for(const _ in i)t.call(a||this,i[_],_,i)&&(h[_]=i[_]);return h}function Re(i){return Array.isArray(i)?i.map(Re):typeof i=="object"&&i?ft(i,Re):i}const st={};function ut(i){st[i]||(typeof console!="undefined"&&console.warn(i),st[i]=!0)}function ht(i,t,a){return(a.y-i.y)*(t.x-i.x)>(t.y-i.y)*(a.x-i.x)}function at(i){let t=0;for(let a,h,_=0,b=i.length,S=b-1;_<b;S=_++)a=i[_],h=i[S],t+=(h.x-a.x)*(a.y+h.y);return t}function $t(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function xt(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,h,_,b)=>{const S=_||b;return t[h]=!S||S.toLowerCase(),""}),t["max-age"]){const a=parseInt(t["max-age"],10);isNaN(a)?delete t["max-age"]:t["max-age"]=a}return t}let qt,_i,Ri=null;function Ht(i){if(Ri==null){const t=i.navigator?i.navigator.userAgent:null;Ri=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Ri}function Qt(i){return typeof ImageBitmap!="undefined"&&i instanceof ImageBitmap}const Si={now:typeof performance!="undefined"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(i){const t=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(i,t=0){const a=window.document.createElement("canvas"),h=a.getContext("2d");if(!h)throw new Error("failed to create canvas 2d context");return a.width=i.width,a.height=i.height,h.drawImage(i,0,0,i.width,i.height),h.getImageData(-t,-t,i.width+2*t,i.height+2*t)},resolveURL:i=>(qt||(qt=document.createElement("a")),qt.href=i,qt.href),hardwareConcurrency:typeof navigator!="undefined"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(_i==null&&(_i=matchMedia("(prefers-reduced-motion: reduce)")),_i.matches)}};var bt=Fi;function Fi(i,t){this.x=i,this.y=t}Fi.prototype={clone:function(){return new Fi(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,t){return this.clone()._rotateAround(i,t)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var t=i.x-this.x,a=i.y-this.y;return t*t+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult:function(i){var t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var t=Math.cos(i),a=Math.sin(i),h=a*this.x+t*this.y;return this.x=t*this.x-a*this.y,this.y=h,this},_rotateAround:function(i,t){var a=Math.cos(i),h=Math.sin(i),_=t.y+h*(this.x-t.x)+a*(this.y-t.y);return this.x=t.x+a*(this.x-t.x)-h*(this.y-t.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Fi.convert=function(i){return i instanceof Fi?i:Array.isArray(i)?new Fi(i[0],i[1]):i};const Dt={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},bi="mapbox-tiles";let zt,Yt,Et=500,xi=50;function Gt(){typeof caches=="undefined"||zt||(zt=caches.open(bi))}let Ji=1/0;const Ni={supported:!1,testSupport:function(i){!Li&&or&&(Mt?rr(i):Ai=i)}};let Ai,or,Li=!1,Mt=!1;function rr(i){const t=i.createTexture();i.bindTexture(i.TEXTURE_2D,t);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,or),i.isContextLost())return;Ni.supported=!0}catch{}i.deleteTexture(t),Li=!0}typeof document!="undefined"&&(or=document.createElement("img"),or.onload=function(){Ai&&rr(Ai),Ai=null,Mt=!0},or.onerror=function(){Li=!0,Ai=null},or.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Ft={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ft);class rt extends Error{constructor(t,a,h,_){super(`AJAXError: ${a} (${t}): ${h}`),this.status=t,this.statusText=a,this.url=h,this.body=_}}const wi=$t()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function nr(i,t){const a=new AbortController,h=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,referrer:wi(),signal:a.signal});let _=!1,b=!1;return i.type==="json"&&h.headers.set("Accept","application/json"),((S,P,R)=>{if(b)return;const O=Date.now();fetch(h).then(V=>V.ok?((j,K,$)=>{(i.type==="arrayBuffer"?j.arrayBuffer():i.type==="json"?j.json():j.text()).then(Q=>{b||(K&&$&&function(se,pe,ke){if(Gt(),!zt)return;const Ne={status:pe.status,statusText:pe.statusText,headers:new Headers};pe.headers.forEach((He,it)=>Ne.headers.set(it,He));const Ze=xt(pe.headers.get("Cache-Control")||"");Ze["no-store"]||(Ze["max-age"]&&Ne.headers.set("Expires",new Date(ke+1e3*Ze["max-age"]).toUTCString()),new Date(Ne.headers.get("Expires")).getTime()-ke<42e4||function(He,it){if(Yt===void 0)try{new Response(new ReadableStream),Yt=!0}catch{Yt=!1}Yt?it(He.body):He.blob().then(it)}(pe,He=>{const it=new Response(He,Ne);Gt(),zt&&zt.then(We=>We.put(function(kt){const At=kt.indexOf("?");return At<0?kt:kt.slice(0,At)}(se.url),it)).catch(We=>ut(We.message))}))}(h,K,$),_=!0,t(null,Q,j.headers.get("Cache-Control"),j.headers.get("Expires")))}).catch(Q=>{b||t(new Error(Q.message))})})(V,null,O):V.blob().then(j=>t(new rt(V.status,V.statusText,i.url,j)))).catch(V=>{V.code!==20&&t(new Error(V.message))})})(),{cancel:()=>{b=!0,_||a.abort()}}}const Pr=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){if($t()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t);if(!$t()){const h=i.url.substring(0,i.url.indexOf("://"));return(Dt.REGISTERED_PROTOCOLS[h]||nr)(i,t)}}if(!(/^file:/.test(a=i.url)||/^file:/.test(wi())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return nr(i,t);if($t()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t,void 0,!0)}var a;return function(h,_){const b=new XMLHttpRequest;b.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(b.responseType="arraybuffer");for(const S in h.headers)b.setRequestHeader(S,h.headers[S]);return h.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=h.credentials==="include",b.onerror=()=>{_(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let S=b.response;if(h.type==="json")try{S=JSON.parse(b.response)}catch(P){return _(P)}_(null,S,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else{const S=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});_(new rt(b.status,b.statusText,h.url,S))}},b.send(h.body),{cancel:()=>b.abort()}}(i,t)},ho=function(i,t){return Pr(ge(i,{type:"arrayBuffer"}),t)};function Jn(i){const t=window.document.createElement("a");return t.href=i,t.protocol===window.document.location.protocol&&t.host===window.document.location.host}const Fo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let xn,po;xn=[],po=0;const Yn=function(i,t){if(Ni.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),po>=Dt.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:i,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return xn.push(b),b}po++;let a=!1;const h=()=>{if(!a)for(a=!0,po--;xn.length&&po<Dt.MAX_PARALLEL_IMAGE_REQUESTS;){const b=xn.shift(),{requestParameters:S,callback:P,cancelled:R}=b;R||(b.cancel=Yn(S,P).cancel)}},_=ho(i,(b,S,P,R)=>{h(),b?t(b):S&&function(O,V){typeof createImageBitmap=="function"?function(j,K){const $=new Blob([new Uint8Array(j)],{type:"image/png"});createImageBitmap($).then(Q=>{K(null,Q)}).catch(Q=>{K(new Error(`Could not load image because of ${Q.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(O,V):function(j,K){const $=new Image;$.onload=()=>{K(null,$),URL.revokeObjectURL($.src),$.onload=null,window.requestAnimationFrame(()=>{$.src=Fo})},$.onerror=()=>K(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Q=new Blob([new Uint8Array(j)],{type:"image/png"});$.src=j.byteLength?URL.createObjectURL(Q):Fo}(O,V)}(S,(O,V)=>{O!=null?t(O):V!=null&&t(null,V,{cacheControl:P,expires:R})})});return{cancel:()=>{_.cancel(),h()}}};function Wi(i,t,a){a[i]&&a[i].indexOf(t)!==-1||(a[i]=a[i]||[],a[i].push(t))}function Nn(i,t,a){if(a&&a[i]){const h=a[i].indexOf(t);h!==-1&&a[i].splice(h,1)}}class Ao{constructor(t,a={}){ge(this,a),this.type=t}}class $n extends Ao{constructor(t,a={}){super("error",ge({error:t},a))}}class Ua{on(t,a){return this._listeners=this._listeners||{},Wi(t,a,this._listeners),this}off(t,a){return Nn(t,a,this._listeners),Nn(t,a,this._oneTimeListeners),this}once(t,a){return this._oneTimeListeners=this._oneTimeListeners||{},Wi(t,a,this._oneTimeListeners),this}fire(t,a){typeof t=="string"&&(t=new Ao(t,a||{}));const h=t.type;if(this.listens(h)){t.target=this;const _=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const P of _)P.call(this,t);const b=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const P of b)Nn(h,P,this._oneTimeListeners),P.call(this,t);const S=this._eventedParent;S&&(ge(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(t))}else t instanceof $n&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,a){return this._eventedParent=t,this._eventedParentData=a,this}}var qe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class _t{constructor(t,a,h,_){this.message=(t?`${t}: `:"")+h,_&&(this.identifier=_),a!=null&&a.__line__&&(this.line=a.__line__)}}function Ci(i){const t=i.value;return t?[new _t(i.key,t,"constants have been deprecated as of v8")]:[]}function fr(i,...t){for(const a of t)for(const h in a)i[h]=a[h];return i}function wr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Qn(i){if(Array.isArray(i))return i.map(Qn);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const a in i)t[a]=Qn(i[a]);return t}return wr(i)}class eo extends Error{constructor(t,a){super(a),this.message=a,this.key=t}}class sa{constructor(t,a=[]){this.parent=t,this.bindings={};for(const[h,_]of a)this.bindings[h]=_}concat(t){return new sa(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const $r={kind:"null"},Jt={kind:"number"},ar={kind:"string"},Yi={kind:"boolean"},Rn={kind:"color"},to={kind:"object"},Gi={kind:"value"},_a={kind:"collator"},Uo={kind:"formatted"},Xr={kind:"resolvedImage"};function te(i,t){return{kind:"array",itemType:i,N:t}}function oe(i){if(i.kind==="array"){const t=oe(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const le=[$r,Jt,ar,Yi,Rn,Uo,to,te(Gi),Xr];function _e(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!_e(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const a of le)if(!_e(a,t))return null}}return`Expected ${oe(i)} but found ${oe(t)} instead.`}function Ae(i,t){return t.some(a=>a.kind===i.kind)}function je(i,t){return t.some(a=>a==="null"?i===null:a==="array"?Array.isArray(i):a==="object"?i&&!Array.isArray(i)&&typeof i=="object":a===typeof i)}var Ge,ye={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Me(i){return(i=Math.round(i))<0?0:i>255?255:i}function Qe(i){return Me(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function ae(i){return(t=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:t>1?1:t;var t}function H(i,t,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?i+(t-i)*a*6:2*a<1?t:3*a<2?i+(t-i)*(2/3-a)*6:i}try{Ge={}.parseCSSColor=function(i){var t,a=i.replace(/ /g,"").toLowerCase();if(a in ye)return ye[a].slice();if(a[0]==="#")return a.length===4?(t=parseInt(a.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:a.length===7&&(t=parseInt(a.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var h=a.indexOf("("),_=a.indexOf(")");if(h!==-1&&_+1===a.length){var b=a.substr(0,h),S=a.substr(h+1,_-(h+1)).split(","),P=1;switch(b){case"rgba":if(S.length!==4)return null;P=ae(S.pop());case"rgb":return S.length!==3?null:[Qe(S[0]),Qe(S[1]),Qe(S[2]),P];case"hsla":if(S.length!==4)return null;P=ae(S.pop());case"hsl":if(S.length!==3)return null;var R=(parseFloat(S[0])%360+360)%360/360,O=ae(S[1]),V=ae(S[2]),j=V<=.5?V*(O+1):V+O-V*O,K=2*V-j;return[Me(255*H(K,j,R+1/3)),Me(255*H(K,j,R)),Me(255*H(K,j,R-1/3)),P];default:return null}}return null}}catch{}class W{constructor(t,a,h,_=1){this.r=t,this.g=a,this.b=h,this.a=_}static parse(t){if(!t)return;if(t instanceof W)return t;if(typeof t!="string")return;const a=Ge(t);return a?new W(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[t,a,h,_]=this.toArray();return`rgba(${Math.round(t)},${Math.round(a)},${Math.round(h)},${_})`}toArray(){const{r:t,g:a,b:h,a:_}=this;return _===0?[0,0,0,0]:[255*t/_,255*a/_,255*h/_,_]}}W.black=new W(0,0,0,1),W.white=new W(1,1,1,1),W.transparent=new W(0,0,0,0),W.red=new W(1,0,0,1);class ne{constructor(t,a,h){this.sensitivity=t?a?"variant":"case":a?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,a){return this.collator.compare(t,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ce{constructor(t,a,h,_,b){this.text=t,this.image=a,this.scale=h,this.fontStack=_,this.textColor=b}}class ve{constructor(t){this.sections=t}static fromString(t){return new ve([new ce(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof ve?t:ve.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const a of this.sections){if(a.image){t.push(["image",a.image.name]);continue}t.push(a.text);const h={};a.fontStack&&(h["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(h["font-scale"]=a.scale),a.textColor&&(h["text-color"]=["rgba"].concat(a.textColor.toArray())),t.push(h)}return t}}class fe{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new fe({name:t,available:!1}):null}serialize(){return["image",this.name]}}function Ie(i,t,a,h){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof a=="number"&&a>=0&&a<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[i,t,a,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[i,t,a,h]:[i,t,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ee(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof W||i instanceof ne||i instanceof ve||i instanceof fe)return!0;if(Array.isArray(i)){for(const t of i)if(!Ee(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!Ee(i[t]))return!1;return!0}return!1}function Te(i){if(i===null)return $r;if(typeof i=="string")return ar;if(typeof i=="boolean")return Yi;if(typeof i=="number")return Jt;if(i instanceof W)return Rn;if(i instanceof ne)return _a;if(i instanceof ve)return Uo;if(i instanceof fe)return Xr;if(Array.isArray(i)){const t=i.length;let a;for(const h of i){const _=Te(h);if(a){if(a===_)continue;a=Gi;break}a=_}return te(a||Gi,t)}return to}function et(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof W||i instanceof ve||i instanceof fe?i.toString():JSON.stringify(i)}class Ke{constructor(t,a){this.type=t,this.value=a}static parse(t,a){if(t.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ee(t[1]))return a.error("invalid value");const h=t[1];let _=Te(h);const b=a.expectedType;return _.kind!=="array"||_.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(_=b),new Ke(_,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof W?["rgba"].concat(this.value.toArray()):this.value instanceof ve?this.value.serialize():this.value}}class tt{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const jt={string:ar,number:Jt,boolean:Yi,object:to};class Ct{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let h,_=1;const b=t[0];if(b==="array"){let P,R;if(t.length>2){const O=t[1];if(typeof O!="string"||!(O in jt)||O==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);P=jt[O],_++}else P=Gi;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return a.error('The length argument to "array" must be a positive integer literal',2);R=t[2],_++}h=te(P,R)}else h=jt[b];const S=[];for(;_<t.length;_++){const P=a.parse(t[_],_,Gi);if(!P)return null;S.push(P)}return new Ct(h,S)}evaluate(t){for(let a=0;a<this.args.length;a++){const h=this.args[a].evaluate(t);if(!_e(this.type,Te(h)))return h;if(a===this.args.length-1)throw new tt(`Expected value to be of type ${oe(this.type)}, but found ${oe(Te(h))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,a=[t.kind];if(t.kind==="array"){const h=t.itemType;if(h.kind==="string"||h.kind==="number"||h.kind==="boolean"){a.push(h.kind);const _=t.N;(typeof _=="number"||this.args.length>1)&&a.push(_)}}return a.concat(this.args.map(h=>h.serialize()))}}class Ut{constructor(t){this.type=Uo,this.sections=t}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const h=t[1];if(!Array.isArray(h)&&typeof h=="object")return a.error("First argument must be an image or text section.");const _=[];let b=!1;for(let S=1;S<=t.length-1;++S){const P=t[S];if(b&&typeof P=="object"&&!Array.isArray(P)){b=!1;let R=null;if(P["font-scale"]&&(R=a.parse(P["font-scale"],1,Jt),!R))return null;let O=null;if(P["text-font"]&&(O=a.parse(P["text-font"],1,te(ar)),!O))return null;let V=null;if(P["text-color"]&&(V=a.parse(P["text-color"],1,Rn),!V))return null;const j=_[_.length-1];j.scale=R,j.font=O,j.textColor=V}else{const R=a.parse(t[S],1,Gi);if(!R)return null;const O=R.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,_.push({content:R,scale:null,font:null,textColor:null})}}return new Ut(_)}evaluate(t){return new ve(this.sections.map(a=>{const h=a.content.evaluate(t);return Te(h)===Xr?new ce("",h,null,null,null):new ce(et(h),null,a.scale?a.scale.evaluate(t):null,a.font?a.font.evaluate(t).join(","):null,a.textColor?a.textColor.evaluate(t):null)}))}eachChild(t){for(const a of this.sections)t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const a of this.sections){t.push(a.content.serialize());const h={};a.scale&&(h["font-scale"]=a.scale.serialize()),a.font&&(h["text-font"]=a.font.serialize()),a.textColor&&(h["text-color"]=a.textColor.serialize()),t.push(h)}return t}}class Zt{constructor(t){this.type=Xr,this.input=t}static parse(t,a){if(t.length!==2)return a.error("Expected two arguments.");const h=a.parse(t[1],1,ar);return h?new Zt(h):a.error("No image name provided.")}evaluate(t){const a=this.input.evaluate(t),h=fe.fromString(a);return h&&t.availableImages&&(h.available=t.availableImages.indexOf(a)>-1),h}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Xi={"to-boolean":Yi,"to-color":Rn,"to-number":Jt,"to-string":ar};class vi{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const h=t[0];if((h==="to-boolean"||h==="to-string")&&t.length!==2)return a.error("Expected one argument.");const _=Xi[h],b=[];for(let S=1;S<t.length;S++){const P=a.parse(t[S],S,Gi);if(!P)return null;b.push(P)}return new vi(_,b)}evaluate(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){let a,h;for(const _ of this.args){if(a=_.evaluate(t),h=null,a instanceof W)return a;if(typeof a=="string"){const b=t.parseColor(a);if(b)return b}else if(Array.isArray(a)&&(h=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Ie(a[0],a[1],a[2],a[3]),!h))return new W(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new tt(h||`Could not parse color from value '${typeof a=="string"?a:String(JSON.stringify(a))}'`)}if(this.type.kind==="number"){let a=null;for(const h of this.args){if(a=h.evaluate(t),a===null)return 0;const _=Number(a);if(!isNaN(_))return _}throw new tt(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?ve.fromString(et(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?fe.fromString(et(this.args[0].evaluate(t))):et(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Ut([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Zt(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(a=>{t.push(a.serialize())}),t}}const Pi=["Unknown","Point","LineString","Polygon"];class di{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Pi[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let a=this._parseColorCache[t];return a||(a=this._parseColorCache[t]=W.parse(t)),a}}class ei{constructor(t,a,h,_){this.name=t,this.type=a,this._evaluate=h,this.args=_}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,a){const h=t[0],_=ei.definitions[h];if(!_)return a.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(_)?_[0]:_.type,S=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,P=S.filter(([O])=>!Array.isArray(O)||O.length===t.length-1);let R=null;for(const[O,V]of P){R=new Na(a.registry,a.path,null,a.scope);const j=[];let K=!1;for(let $=1;$<t.length;$++){const Q=t[$],se=Array.isArray(O)?O[$-1]:O.type,pe=R.parse(Q,1+j.length,se);if(!pe){K=!0;break}j.push(pe)}if(!K)if(Array.isArray(O)&&O.length!==j.length)R.error(`Expected ${O.length} arguments, but found ${j.length} instead.`);else{for(let $=0;$<j.length;$++){const Q=Array.isArray(O)?O[$]:O.type,se=j[$];R.concat($+1).checkSubtype(Q,se.type)}if(R.errors.length===0)return new ei(h,b,V,j)}}if(P.length===1)a.errors.push(...R.errors);else{const O=(P.length?P:S).map(([j])=>{return K=j,Array.isArray(K)?`(${K.map(oe).join(", ")})`:`(${oe(K.type)}...)`;var K}).join(" | "),V=[];for(let j=1;j<t.length;j++){const K=a.parse(t[j],1+V.length);if(!K)return null;V.push(oe(K.type))}a.error(`Expected arguments of type ${O}, but found (${V.join(", ")}) instead.`)}return null}static register(t,a){ei.definitions=a;for(const h in a)t[h]=ei}}class Ui{constructor(t,a,h){this.type=_a,this.locale=h,this.caseSensitive=t,this.diacriticSensitive=a}static parse(t,a){if(t.length!==2)return a.error("Expected one argument.");const h=t[1];if(typeof h!="object"||Array.isArray(h))return a.error("Collator options argument must be an object.");const _=a.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,Yi);if(!_)return null;const b=a.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,Yi);if(!b)return null;let S=null;return h.locale&&(S=a.parse(h.locale,1,ar),!S)?null:new Ui(_,b,S)}evaluate(t){return new ne(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const Ir=8192;function kn(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function Cr(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function Eo(i,t){const a=(180+i[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,_=Math.pow(2,t.z);return[Math.round(a*_*Ir),Math.round(h*_*Ir)]}function Fl(i,t,a){const h=i[0]-t[0],_=i[1]-t[1],b=i[0]-a[0],S=i[1]-a[1];return h*S-b*_==0&&h*b<=0&&_*S<=0}function Gr(i,t){let a=!1;for(let S=0,P=t.length;S<P;S++){const R=t[S];for(let O=0,V=R.length;O<V-1;O++){if(Fl(i,R[O],R[O+1]))return!1;(_=R[O])[1]>(h=i)[1]!=(b=R[O+1])[1]>h[1]&&h[0]<(b[0]-_[0])*(h[1]-_[1])/(b[1]-_[1])+_[0]&&(a=!a)}}var h,_,b;return a}function Sn(i,t){for(let a=0;a<t.length;a++)if(Gr(i,t[a]))return!0;return!1}function Gs(i,t,a,h){const _=h[0]-a[0],b=h[1]-a[1],S=(i[0]-a[0])*b-_*(i[1]-a[1]),P=(t[0]-a[0])*b-_*(t[1]-a[1]);return S>0&&P<0||S<0&&P>0}function Co(i,t,a){for(const O of a)for(let V=0;V<O.length-1;++V)if((P=[(S=O[V+1])[0]-(b=O[V])[0],S[1]-b[1]])[0]*(R=[(_=t)[0]-(h=i)[0],_[1]-h[1]])[1]-P[1]*R[0]!=0&&Gs(h,_,b,S)&&Gs(b,S,h,_))return!0;var h,_,b,S,P,R;return!1}function Bn(i,t){for(let a=0;a<i.length;++a)if(!Gr(i[a],t))return!1;for(let a=0;a<i.length-1;++a)if(Co(i[a],i[a+1],t))return!1;return!0}function la(i,t){for(let a=0;a<t.length;a++)if(Bn(i,t[a]))return!0;return!1}function Qr(i,t,a){const h=[];for(let _=0;_<i.length;_++){const b=[];for(let S=0;S<i[_].length;S++){const P=Eo(i[_][S],a);kn(t,P),b.push(P)}h.push(b)}return h}function ua(i,t,a){const h=[];for(let _=0;_<i.length;_++){const b=Qr(i[_],t,a);h.push(b)}return h}function No(i,t,a,h){if(i[0]<a[0]||i[0]>a[2]){const _=.5*h;let b=i[0]-a[0]>_?-h:a[0]-i[0]>_?h:0;b===0&&(b=i[0]-a[2]>_?-h:a[2]-i[0]>_?h:0),i[0]+=b}kn(t,i)}function ec(i,t,a,h){const _=Math.pow(2,h.z)*Ir,b=[h.x*Ir,h.y*Ir],S=[];for(const P of i)for(const R of P){const O=[R.x+b[0],R.y+b[1]];No(O,t,a,_),S.push(O)}return S}function ca(i,t,a,h){const _=Math.pow(2,h.z)*Ir,b=[h.x*Ir,h.y*Ir],S=[];for(const R of i){const O=[];for(const V of R){const j=[V.x+b[0],V.y+b[1]];kn(t,j),O.push(j)}S.push(O)}if(t[2]-t[0]<=_/2){(P=t)[0]=P[1]=1/0,P[2]=P[3]=-1/0;for(const R of S)for(const O of R)No(O,t,a,_)}var P;return S}class Zs{constructor(t,a){this.type=Yi,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ee(t[1])){const h=t[1];if(h.type==="FeatureCollection")for(let _=0;_<h.features.length;++_){const b=h.features[_].geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new Zs(h,h.features[_].geometry)}else if(h.type==="Feature"){const _=h.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Zs(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new Zs(h,h)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,h){const _=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],S=a.canonicalID();if(h.type==="Polygon"){const P=Qr(h.coordinates,b,S),R=ec(a.geometry(),_,b,S);if(!Cr(_,b))return!1;for(const O of R)if(!Gr(O,P))return!1}if(h.type==="MultiPolygon"){const P=ua(h.coordinates,b,S),R=ec(a.geometry(),_,b,S);if(!Cr(_,b))return!1;for(const O of R)if(!Sn(O,P))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,h){const _=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],S=a.canonicalID();if(h.type==="Polygon"){const P=Qr(h.coordinates,b,S),R=ca(a.geometry(),_,b,S);if(!Cr(_,b))return!1;for(const O of R)if(!Bn(O,P))return!1}if(h.type==="MultiPolygon"){const P=ua(h.coordinates,b,S),R=ca(a.geometry(),_,b,S);if(!Cr(_,b))return!1;for(const O of R)if(!la(O,P))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function va(i){if(i instanceof ei&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Zs)return!1;let t=!0;return i.eachChild(a=>{t&&!va(a)&&(t=!1)}),t}function In(i){if(i instanceof ei&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(a=>{t&&!In(a)&&(t=!1)}),t}function Zo(i,t){if(i instanceof ei&&t.indexOf(i.name)>=0)return!1;let a=!0;return i.eachChild(h=>{a&&!Zo(h,t)&&(a=!1)}),a}class io{constructor(t,a){this.type=a.type,this.name=t,this.boundExpression=a}static parse(t,a){if(t.length!==2||typeof t[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const h=t[1];return a.scope.has(h)?new io(h,a.scope.get(h)):a.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Na{constructor(t,a=[],h,_=new sa,b=[]){this.registry=t,this.path=a,this.key=a.map(S=>`[${S}]`).join(""),this.scope=_,this.errors=b,this.expectedType=h}parse(t,a,h,_,b={}){return a?this.concat(a,h,_)._parse(t,b):this._parse(t,b)}_parse(t,a){function h(_,b,S){return S==="assert"?new Ct(b,[_]):S==="coerce"?new vi(b,[_]):_}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=t[0];if(typeof _!="string")return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[_];if(b){let S=b.parse(t,this);if(!S)return null;if(this.expectedType){const P=this.expectedType,R=S.type;if(P.kind!=="string"&&P.kind!=="number"&&P.kind!=="boolean"&&P.kind!=="object"&&P.kind!=="array"||R.kind!=="value")if(P.kind!=="color"&&P.kind!=="formatted"&&P.kind!=="resolvedImage"||R.kind!=="value"&&R.kind!=="string"){if(this.checkSubtype(P,R))return null}else S=h(S,P,a.typeAnnotation||"coerce");else S=h(S,P,a.typeAnnotation||"assert")}if(!(S instanceof Ke)&&S.type.kind!=="resolvedImage"&&Ul(S)){const P=new di;try{S=new Ke(S.type,S.evaluate(P))}catch(R){return this.error(R.message),null}}return S}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,a,h){const _=typeof t=="number"?this.path.concat(t):this.path,b=h?this.scope.concat(h):this.scope;return new Na(this.registry,_,a||null,b,this.errors)}error(t,...a){const h=`${this.key}${a.map(_=>`[${_}]`).join("")}`;this.errors.push(new eo(h,t))}checkSubtype(t,a){const h=_e(t,a);return h&&this.error(h),h}}function Ul(i){if(i instanceof io)return Ul(i.boundExpression);if(i instanceof ei&&i.name==="error"||i instanceof Ui||i instanceof Zs)return!1;const t=i instanceof vi||i instanceof Ct;let a=!0;return i.eachChild(h=>{a=t?a&&Ul(h):a&&h instanceof Ke}),!!a&&va(i)&&Zo(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function wu(i,t){const a=i.length-1;let h,_,b=0,S=a,P=0;for(;b<=S;)if(P=Math.floor((b+S)/2),h=i[P],_=i[P+1],h<=t){if(P===a||t<_)return P;b=P+1}else{if(!(h>t))throw new tt("Input is not a number.");S=P-1}return 0}class Hs{constructor(t,a,h){this.type=t,this.input=a,this.labels=[],this.outputs=[];for(const[_,b]of h)this.labels.push(_),this.outputs.push(b)}static parse(t,a){if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");const h=a.parse(t[1],1,Jt);if(!h)return null;const _=[];let b=null;a.expectedType&&a.expectedType.kind!=="value"&&(b=a.expectedType);for(let S=1;S<t.length;S+=2){const P=S===1?-1/0:t[S],R=t[S+1],O=S,V=S+1;if(typeof P!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(_.length&&_[_.length-1][0]>=P)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const j=a.parse(R,V,b);if(!j)return null;b=b||j.type,_.push([P,j])}return new Hs(b,h,_)}evaluate(t){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(t);const _=this.input.evaluate(t);if(_<=a[0])return h[0].evaluate(t);const b=a.length;return _>=a[b-1]?h[b-1].evaluate(t):h[wu(a,_)].evaluate(t)}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&t.push(this.labels[a]),t.push(this.outputs[a].serialize());return t}}function jn(i,t,a){return i*(1-a)+t*a}var ml=Object.freeze({__proto__:null,number:jn,color:function(i,t,a){return new W(jn(i.r,t.r,a),jn(i.g,t.g,a),jn(i.b,t.b,a),jn(i.a,t.a,a))},array:function(i,t,a){return i.map((h,_)=>jn(h,t[_],a))}});const tc=.95047,ic=1.08883,rc=4/29,rs=6/29,Nl=3*rs*rs,jl=Math.PI/180,Oc=180/Math.PI;function yl(i){return i>.008856451679035631?Math.pow(i,1/3):i/Nl+rc}function Ho(i){return i>rs?i*i*i:Nl*(i-rc)}function ja(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function Va(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Ss(i){const t=Va(i.r),a=Va(i.g),h=Va(i.b),_=yl((.4124564*t+.3575761*a+.1804375*h)/tc),b=yl((.2126729*t+.7151522*a+.072175*h)/1);return{l:116*b-16,a:500*(_-b),b:200*(b-yl((.0193339*t+.119192*a+.9503041*h)/ic)),alpha:i.a}}function pr(i){let t=(i.l+16)/116,a=isNaN(i.a)?t:t+i.a/500,h=isNaN(i.b)?t:t-i.b/200;return t=1*Ho(t),a=tc*Ho(a),h=ic*Ho(h),new W(ja(3.2404542*a-1.5371385*t-.4985314*h),ja(-.969266*a+1.8760108*t+.041556*h),ja(.0556434*a-.2040259*t+1.0572252*h),i.alpha)}function Is(i,t,a){const h=t-i;return i+a*(h>180||h<-180?h-360*Math.round(h/360):h)}const Ts={forward:Ss,reverse:pr,interpolate:function(i,t,a){return{l:jn(i.l,t.l,a),a:jn(i.a,t.a,a),b:jn(i.b,t.b,a),alpha:jn(i.alpha,t.alpha,a)}}},fo={forward:function(i){const{l:t,a,b:h}=Ss(i),_=Math.atan2(h,a)*Oc;return{h:_<0?_+360:_,c:Math.sqrt(a*a+h*h),l:t,alpha:i.a}},reverse:function(i){const t=i.h*jl,a=i.c;return pr({l:i.l,a:Math.cos(t)*a,b:Math.sin(t)*a,alpha:i.alpha})},interpolate:function(i,t,a){return{h:Is(i.h,t.h,a),c:jn(i.c,t.c,a),l:jn(i.l,t.l,a),alpha:jn(i.alpha,t.alpha,a)}}};var Tn=Object.freeze({__proto__:null,lab:Ts,hcl:fo});class mo{constructor(t,a,h,_,b){this.type=t,this.operator=a,this.interpolation=h,this.input=_,this.labels=[],this.outputs=[];for(const[S,P]of b)this.labels.push(S),this.outputs.push(P)}static interpolationFactor(t,a,h,_){let b=0;if(t.name==="exponential")b=Eu(a,t.base,h,_);else if(t.name==="linear")b=Eu(a,1,h,_);else if(t.name==="cubic-bezier"){const S=t.controlPoints;b=new L(S[0],S[1],S[2],S[3]).solve(Eu(a,1,h,_))}return b}static parse(t,a){let[h,_,b,...S]=t;if(!Array.isArray(_)||_.length===0)return a.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const O=_[1];if(typeof O!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:O}}else{if(_[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const O=_.slice(1);if(O.length!==4||O.some(V=>typeof V!="number"||V<0||V>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:O}}}if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(b=a.parse(b,2,Jt),!b)return null;const P=[];let R=null;h==="interpolate-hcl"||h==="interpolate-lab"?R=Rn:a.expectedType&&a.expectedType.kind!=="value"&&(R=a.expectedType);for(let O=0;O<S.length;O+=2){const V=S[O],j=S[O+1],K=O+3,$=O+4;if(typeof V!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',K);if(P.length&&P[P.length-1][0]>=V)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',K);const Q=a.parse(j,$,R);if(!Q)return null;R=R||Q.type,P.push([V,Q])}return R.kind==="number"||R.kind==="color"||R.kind==="array"&&R.itemType.kind==="number"&&typeof R.N=="number"?new mo(R,h,_,b,P):a.error(`Type ${oe(R)} is not interpolatable.`)}evaluate(t){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(t);const _=this.input.evaluate(t);if(_<=a[0])return h[0].evaluate(t);const b=a.length;if(_>=a[b-1])return h[b-1].evaluate(t);const S=wu(a,_),P=mo.interpolationFactor(this.interpolation,_,a[S],a[S+1]),R=h[S].evaluate(t),O=h[S+1].evaluate(t);return this.operator==="interpolate"?ml[this.type.kind.toLowerCase()](R,O,P):this.operator==="interpolate-hcl"?fo.reverse(fo.interpolate(fo.forward(R),fo.forward(O),P)):Ts.reverse(Ts.interpolate(Ts.forward(R),Ts.forward(O),P))}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,t,this.input.serialize()];for(let h=0;h<this.labels.length;h++)a.push(this.labels[h],this.outputs[h].serialize());return a}}function Eu(i,t,a,h){const _=h-a,b=i-a;return _===0?0:t===1?b/_:(Math.pow(t,b)-1)/(Math.pow(t,_)-1)}class Su{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expectected at least one argument.");let h=null;const _=a.expectedType;_&&_.kind!=="value"&&(h=_);const b=[];for(const P of t.slice(1)){const R=a.parse(P,1+b.length,h,void 0,{typeAnnotation:"omit"});if(!R)return null;h=h||R.type,b.push(R)}const S=_&&b.some(P=>_e(_,P.type));return new Su(S?Gi:h,b)}evaluate(t){let a,h=null,_=0;for(const b of this.args)if(_++,h=b.evaluate(t),h&&h instanceof fe&&!h.available&&(a||(a=h.name),h=null,_===this.args.length&&(h=a)),h!==null)break;return h}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(a=>{t.push(a.serialize())}),t}}class Iu{constructor(t,a){this.type=a.type,this.bindings=[].concat(t),this.result=a}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const a of this.bindings)t(a[1]);t(this.result)}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const h=[];for(let b=1;b<t.length-1;b+=2){const S=t[b];if(typeof S!="string")return a.error(`Expected string, but found ${typeof S} instead.`,b);if(/[^a-zA-Z0-9_]/.test(S))return a.error("Variable names must contain only alphanumeric characters or '_'.",b);const P=a.parse(t[b+1],b+1);if(!P)return null;h.push([S,P])}const _=a.parse(t[t.length-1],t.length-1,a.expectedType,h);return _?new Iu(h,_):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[a,h]of this.bindings)t.push(a,h.serialize());return t.push(this.result.serialize()),t}}class Vl{constructor(t,a,h){this.type=t,this.index=a,this.input=h}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,Jt),_=a.parse(t[2],2,te(a.expectedType||Gi));return h&&_?new Vl(_.type.itemType,h,_):null}evaluate(t){const a=this.index.evaluate(t),h=this.input.evaluate(t);if(a<0)throw new tt(`Array index out of bounds: ${a} < 0.`);if(a>=h.length)throw new tt(`Array index out of bounds: ${a} > ${h.length-1}.`);if(a!==Math.floor(a))throw new tt(`Array index must be an integer, but found ${a} instead.`);return h[a]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class ql{constructor(t,a){this.type=Yi,this.needle=t,this.haystack=a}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,Gi),_=a.parse(t[2],2,Gi);return h&&_?Ae(h.type,[Yi,ar,Jt,$r,Gi])?new ql(h,_):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${oe(h.type)} instead`):null}evaluate(t){const a=this.needle.evaluate(t),h=this.haystack.evaluate(t);if(!h)return!1;if(!je(a,["boolean","string","number","null"]))throw new tt(`Expected first argument to be of type boolean, string, number or null, but found ${oe(Te(a))} instead.`);if(!je(h,["string","array"]))throw new tt(`Expected second argument to be of type array or string, but found ${oe(Te(h))} instead.`);return h.indexOf(a)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class gl{constructor(t,a,h){this.type=Jt,this.needle=t,this.haystack=a,this.fromIndex=h}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,Gi),_=a.parse(t[2],2,Gi);if(!h||!_)return null;if(!Ae(h.type,[Yi,ar,Jt,$r,Gi]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${oe(h.type)} instead`);if(t.length===4){const b=a.parse(t[3],3,Jt);return b?new gl(h,_,b):null}return new gl(h,_)}evaluate(t){const a=this.needle.evaluate(t),h=this.haystack.evaluate(t);if(!je(a,["boolean","string","number","null"]))throw new tt(`Expected first argument to be of type boolean, string, number or null, but found ${oe(Te(a))} instead.`);if(!je(h,["string","array"]))throw new tt(`Expected second argument to be of type array or string, but found ${oe(Te(h))} instead.`);if(this.fromIndex){const _=this.fromIndex.evaluate(t);return h.indexOf(a,_)}return h.indexOf(a)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Gl{constructor(t,a,h,_,b,S){this.inputType=t,this.type=a,this.input=h,this.cases=_,this.outputs=b,this.otherwise=S}static parse(t,a){if(t.length<5)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return a.error("Expected an even number of arguments.");let h,_;a.expectedType&&a.expectedType.kind!=="value"&&(_=a.expectedType);const b={},S=[];for(let O=2;O<t.length-1;O+=2){let V=t[O];const j=t[O+1];Array.isArray(V)||(V=[V]);const K=a.concat(O);if(V.length===0)return K.error("Expected at least one branch label.");for(const Q of V){if(typeof Q!="number"&&typeof Q!="string")return K.error("Branch labels must be numbers or strings.");if(typeof Q=="number"&&Math.abs(Q)>Number.MAX_SAFE_INTEGER)return K.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Q=="number"&&Math.floor(Q)!==Q)return K.error("Numeric branch labels must be integer values.");if(h){if(K.checkSubtype(h,Te(Q)))return null}else h=Te(Q);if(b[String(Q)]!==void 0)return K.error("Branch labels must be unique.");b[String(Q)]=S.length}const $=a.parse(j,O,_);if(!$)return null;_=_||$.type,S.push($)}const P=a.parse(t[1],1,Gi);if(!P)return null;const R=a.parse(t[t.length-1],t.length-1,_);return R?P.type.kind!=="value"&&a.concat(1).checkSubtype(h,P.type)?null:new Gl(h,_,P,b,S,R):null}evaluate(t){const a=this.input.evaluate(t);return(Te(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),h=[],_={};for(const S of a){const P=_[this.cases[S]];P===void 0?(_[this.cases[S]]=h.length,h.push([this.cases[S],[S]])):h[P][1].push(S)}const b=S=>this.inputType.kind==="number"?Number(S):S;for(const[S,P]of h)t.push(P.length===1?b(P[0]):P.map(b)),t.push(this.outputs[S].serialize());return t.push(this.otherwise.serialize()),t}}class Tu{constructor(t,a,h){this.type=t,this.branches=a,this.otherwise=h}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return a.error("Expected an odd number of arguments.");let h;a.expectedType&&a.expectedType.kind!=="value"&&(h=a.expectedType);const _=[];for(let S=1;S<t.length-1;S+=2){const P=a.parse(t[S],S,Yi);if(!P)return null;const R=a.parse(t[S+1],S+1,h);if(!R)return null;_.push([P,R]),h=h||R.type}const b=a.parse(t[t.length-1],t.length-1,h);return b?new Tu(h,_,b):null}evaluate(t){for(const[a,h]of this.branches)if(a.evaluate(t))return h.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[a,h]of this.branches)t(a),t(h);t(this.otherwise)}outputDefined(){return this.branches.every(([t,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(a=>{t.push(a.serialize())}),t}}class Zl{constructor(t,a,h,_){this.type=t,this.input=a,this.beginIndex=h,this.endIndex=_}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,Gi),_=a.parse(t[2],2,Jt);if(!h||!_)return null;if(!Ae(h.type,[te(Gi),ar,Gi]))return a.error(`Expected first argument to be of type array or string, but found ${oe(h.type)} instead`);if(t.length===4){const b=a.parse(t[3],3,Jt);return b?new Zl(h.type,h,_,b):null}return new Zl(h.type,h,_)}evaluate(t){const a=this.input.evaluate(t),h=this.beginIndex.evaluate(t);if(!je(a,["string","array"]))throw new tt(`Expected first argument to be of type array or string, but found ${oe(Te(a))} instead.`);if(this.endIndex){const _=this.endIndex.evaluate(t);return a.slice(h,_)}return a.slice(h)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Fc(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function _l(i,t,a,h){return h.compare(t,a)===0}function qa(i,t,a){const h=i!=="=="&&i!=="!=";return class Yv{constructor(b,S,P){this.type=Yi,this.lhs=b,this.rhs=S,this.collator=P,this.hasUntypedArgument=b.type.kind==="value"||S.type.kind==="value"}static parse(b,S){if(b.length!==3&&b.length!==4)return S.error("Expected two or three arguments.");const P=b[0];let R=S.parse(b[1],1,Gi);if(!R)return null;if(!Fc(P,R.type))return S.concat(1).error(`"${P}" comparisons are not supported for type '${oe(R.type)}'.`);let O=S.parse(b[2],2,Gi);if(!O)return null;if(!Fc(P,O.type))return S.concat(2).error(`"${P}" comparisons are not supported for type '${oe(O.type)}'.`);if(R.type.kind!==O.type.kind&&R.type.kind!=="value"&&O.type.kind!=="value")return S.error(`Cannot compare types '${oe(R.type)}' and '${oe(O.type)}'.`);h&&(R.type.kind==="value"&&O.type.kind!=="value"?R=new Ct(O.type,[R]):R.type.kind!=="value"&&O.type.kind==="value"&&(O=new Ct(R.type,[O])));let V=null;if(b.length===4){if(R.type.kind!=="string"&&O.type.kind!=="string"&&R.type.kind!=="value"&&O.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(V=S.parse(b[3],3,_a),!V)return null}return new Yv(R,O,V)}evaluate(b){const S=this.lhs.evaluate(b),P=this.rhs.evaluate(b);if(h&&this.hasUntypedArgument){const R=Te(S),O=Te(P);if(R.kind!==O.kind||R.kind!=="string"&&R.kind!=="number")throw new tt(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${R.kind}, ${O.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const R=Te(S),O=Te(P);if(R.kind!=="string"||O.kind!=="string")return t(b,S,P)}return this.collator?a(b,S,P,this.collator.evaluate(b)):t(b,S,P)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}serialize(){const b=[i];return this.eachChild(S=>{b.push(S.serialize())}),b}}}const Uc=qa("==",function(i,t,a){return t===a},_l),yo=qa("!=",function(i,t,a){return t!==a},function(i,t,a,h){return!_l(0,t,a,h)}),nc=qa("<",function(i,t,a){return t<a},function(i,t,a,h){return h.compare(t,a)<0}),As=qa(">",function(i,t,a){return t>a},function(i,t,a,h){return h.compare(t,a)>0}),Cs=qa("<=",function(i,t,a){return t<=a},function(i,t,a,h){return h.compare(t,a)<=0}),Ws=qa(">=",function(i,t,a){return t>=a},function(i,t,a,h){return h.compare(t,a)>=0});class ns{constructor(t,a,h,_,b){this.type=ar,this.number=t,this.locale=a,this.currency=h,this.minFractionDigits=_,this.maxFractionDigits=b}static parse(t,a){if(t.length!==3)return a.error("Expected two arguments.");const h=a.parse(t[1],1,Jt);if(!h)return null;const _=t[2];if(typeof _!="object"||Array.isArray(_))return a.error("NumberFormat options argument must be an object.");let b=null;if(_.locale&&(b=a.parse(_.locale,1,ar),!b))return null;let S=null;if(_.currency&&(S=a.parse(_.currency,1,ar),!S))return null;let P=null;if(_["min-fraction-digits"]&&(P=a.parse(_["min-fraction-digits"],1,Jt),!P))return null;let R=null;return _["max-fraction-digits"]&&(R=a.parse(_["max-fraction-digits"],1,Jt),!R)?null:new ns(h,b,S,P,R)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Ga{constructor(t){this.type=Jt,this.input=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const h=a.parse(t[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${oe(h.type)} instead.`):new Ga(h):null}evaluate(t){const a=this.input.evaluate(t);if(typeof a=="string"||Array.isArray(a))return a.length;throw new tt(`Expected value to be of type string or array, but found ${oe(Te(a))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(a=>{t.push(a.serialize())}),t}}const xa={"==":Uc,"!=":yo,">":As,"<":nc,">=":Ws,"<=":Cs,array:Ct,at:Vl,boolean:Ct,case:Tu,coalesce:Su,collator:Ui,format:Ut,image:Zt,in:ql,"index-of":gl,interpolate:mo,"interpolate-hcl":mo,"interpolate-lab":mo,length:Ga,let:Iu,literal:Ke,match:Gl,number:Ct,"number-format":ns,object:Ct,slice:Zl,step:Hs,string:Ct,"to-boolean":vi,"to-color":vi,"to-number":vi,"to-string":vi,var:io,within:Zs};function ks(i,[t,a,h,_]){t=t.evaluate(i),a=a.evaluate(i),h=h.evaluate(i);const b=_?_.evaluate(i):1,S=Ie(t,a,h,b);if(S)throw new tt(S);return new W(t/255*b,a/255*b,h/255*b,b)}function os(i,t){return i in t}function Au(i,t){const a=t[i];return a===void 0?null:a}function zs(i){return{type:i}}function Zr(i){return{result:"success",value:i}}function Xs(i){return{result:"error",value:i}}function as(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function oc(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Cu(i){return!!i.expression&&i.expression.interpolated}function $i(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Hl(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Er(i){return i}function ka(i,t){const a=t.type==="color",h=i.stops&&typeof i.stops[0][0]=="object",_=h||!(h||i.property!==void 0),b=i.type||(Cu(t)?"exponential":"interval");if(a&&((i=fr({},i)).stops&&(i.stops=i.stops.map(O=>[O[0],W.parse(O[1])])),i.default=W.parse(i.default?i.default:t.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!Tn[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let S,P,R;if(b==="exponential")S=Xl;else if(b==="interval")S=Wl;else if(b==="categorical"){S=An,P=Object.create(null);for(const O of i.stops)P[O[0]]=O[1];R=typeof i.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);S=Ks}if(h){const O={},V=[];for(let $=0;$<i.stops.length;$++){const Q=i.stops[$],se=Q[0].zoom;O[se]===void 0&&(O[se]={zoom:se,type:i.type,property:i.property,default:i.default,stops:[]},V.push(se)),O[se].stops.push([Q[0].value,Q[1]])}const j=[];for(const $ of V)j.push([O[$].zoom,ka(O[$],t)]);const K={name:"linear"};return{kind:"composite",interpolationType:K,interpolationFactor:mo.interpolationFactor.bind(void 0,K),zoomStops:j.map($=>$[0]),evaluate:({zoom:$},Q)=>Xl({stops:j,base:i.base},t,$).evaluate($,Q)}}if(_){const O=b==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:mo.interpolationFactor.bind(void 0,O),zoomStops:i.stops.map(V=>V[0]),evaluate:({zoom:V})=>S(i,t,V,P,R)}}return{kind:"source",evaluate(O,V){const j=V&&V.properties?V.properties[i.property]:void 0;return j===void 0?Kr(i.default,t.default):S(i,t,j,P,R)}}}function Kr(i,t,a){return i!==void 0?i:t!==void 0?t:a!==void 0?a:void 0}function An(i,t,a,h,_){return Kr(typeof a===_?h[a]:void 0,i.default,t.default)}function Wl(i,t,a){if($i(a)!=="number")return Kr(i.default,t.default);const h=i.stops.length;if(h===1||a<=i.stops[0][0])return i.stops[0][1];if(a>=i.stops[h-1][0])return i.stops[h-1][1];const _=wu(i.stops.map(b=>b[0]),a);return i.stops[_][1]}function Xl(i,t,a){const h=i.base!==void 0?i.base:1;if($i(a)!=="number")return Kr(i.default,t.default);const _=i.stops.length;if(_===1||a<=i.stops[0][0])return i.stops[0][1];if(a>=i.stops[_-1][0])return i.stops[_-1][1];const b=wu(i.stops.map(V=>V[0]),a),S=function(V,j,K,$){const Q=$-K,se=V-K;return Q===0?0:j===1?se/Q:(Math.pow(j,se)-1)/(Math.pow(j,Q)-1)}(a,h,i.stops[b][0],i.stops[b+1][0]),P=i.stops[b][1],R=i.stops[b+1][1];let O=ml[t.type]||Er;if(i.colorSpace&&i.colorSpace!=="rgb"){const V=Tn[i.colorSpace];O=(j,K)=>V.reverse(V.interpolate(V.forward(j),V.forward(K),S))}return typeof P.evaluate=="function"?{evaluate(...V){const j=P.evaluate.apply(void 0,V),K=R.evaluate.apply(void 0,V);if(j!==void 0&&K!==void 0)return O(j,K,S)}}:O(P,R,S)}function Ks(i,t,a){return t.type==="color"?a=W.parse(a):t.type==="formatted"?a=ve.fromString(a.toString()):t.type==="resolvedImage"?a=fe.fromString(a.toString()):$i(a)===t.type||t.type==="enum"&&t.values[a]||(a=void 0),Kr(a,i.default,t.default)}ei.register(xa,{error:[{kind:"error"},[ar],(i,[t])=>{throw new tt(t.evaluate(i))}],typeof:[ar,[Gi],(i,[t])=>oe(Te(t.evaluate(i)))],"to-rgba":[te(Jt,4),[Rn],(i,[t])=>t.evaluate(i).toArray()],rgb:[Rn,[Jt,Jt,Jt],ks],rgba:[Rn,[Jt,Jt,Jt,Jt],ks],has:{type:Yi,overloads:[[[ar],(i,[t])=>os(t.evaluate(i),i.properties())],[[ar,to],(i,[t,a])=>os(t.evaluate(i),a.evaluate(i))]]},get:{type:Gi,overloads:[[[ar],(i,[t])=>Au(t.evaluate(i),i.properties())],[[ar,to],(i,[t,a])=>Au(t.evaluate(i),a.evaluate(i))]]},"feature-state":[Gi,[ar],(i,[t])=>Au(t.evaluate(i),i.featureState||{})],properties:[to,[],i=>i.properties()],"geometry-type":[ar,[],i=>i.geometryType()],id:[Gi,[],i=>i.id()],zoom:[Jt,[],i=>i.globals.zoom],"heatmap-density":[Jt,[],i=>i.globals.heatmapDensity||0],"line-progress":[Jt,[],i=>i.globals.lineProgress||0],accumulated:[Gi,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Jt,zs(Jt),(i,t)=>{let a=0;for(const h of t)a+=h.evaluate(i);return a}],"*":[Jt,zs(Jt),(i,t)=>{let a=1;for(const h of t)a*=h.evaluate(i);return a}],"-":{type:Jt,overloads:[[[Jt,Jt],(i,[t,a])=>t.evaluate(i)-a.evaluate(i)],[[Jt],(i,[t])=>-t.evaluate(i)]]},"/":[Jt,[Jt,Jt],(i,[t,a])=>t.evaluate(i)/a.evaluate(i)],"%":[Jt,[Jt,Jt],(i,[t,a])=>t.evaluate(i)%a.evaluate(i)],ln2:[Jt,[],()=>Math.LN2],pi:[Jt,[],()=>Math.PI],e:[Jt,[],()=>Math.E],"^":[Jt,[Jt,Jt],(i,[t,a])=>Math.pow(t.evaluate(i),a.evaluate(i))],sqrt:[Jt,[Jt],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[Jt,[Jt],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[Jt,[Jt],(i,[t])=>Math.log(t.evaluate(i))],log2:[Jt,[Jt],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[Jt,[Jt],(i,[t])=>Math.sin(t.evaluate(i))],cos:[Jt,[Jt],(i,[t])=>Math.cos(t.evaluate(i))],tan:[Jt,[Jt],(i,[t])=>Math.tan(t.evaluate(i))],asin:[Jt,[Jt],(i,[t])=>Math.asin(t.evaluate(i))],acos:[Jt,[Jt],(i,[t])=>Math.acos(t.evaluate(i))],atan:[Jt,[Jt],(i,[t])=>Math.atan(t.evaluate(i))],min:[Jt,zs(Jt),(i,t)=>Math.min(...t.map(a=>a.evaluate(i)))],max:[Jt,zs(Jt),(i,t)=>Math.max(...t.map(a=>a.evaluate(i)))],abs:[Jt,[Jt],(i,[t])=>Math.abs(t.evaluate(i))],round:[Jt,[Jt],(i,[t])=>{const a=t.evaluate(i);return a<0?-Math.round(-a):Math.round(a)}],floor:[Jt,[Jt],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[Jt,[Jt],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[Yi,[ar,Gi],(i,[t,a])=>i.properties()[t.value]===a.value],"filter-id-==":[Yi,[Gi],(i,[t])=>i.id()===t.value],"filter-type-==":[Yi,[ar],(i,[t])=>i.geometryType()===t.value],"filter-<":[Yi,[ar,Gi],(i,[t,a])=>{const h=i.properties()[t.value],_=a.value;return typeof h==typeof _&&h<_}],"filter-id-<":[Yi,[Gi],(i,[t])=>{const a=i.id(),h=t.value;return typeof a==typeof h&&a<h}],"filter->":[Yi,[ar,Gi],(i,[t,a])=>{const h=i.properties()[t.value],_=a.value;return typeof h==typeof _&&h>_}],"filter-id->":[Yi,[Gi],(i,[t])=>{const a=i.id(),h=t.value;return typeof a==typeof h&&a>h}],"filter-<=":[Yi,[ar,Gi],(i,[t,a])=>{const h=i.properties()[t.value],_=a.value;return typeof h==typeof _&&h<=_}],"filter-id-<=":[Yi,[Gi],(i,[t])=>{const a=i.id(),h=t.value;return typeof a==typeof h&&a<=h}],"filter->=":[Yi,[ar,Gi],(i,[t,a])=>{const h=i.properties()[t.value],_=a.value;return typeof h==typeof _&&h>=_}],"filter-id->=":[Yi,[Gi],(i,[t])=>{const a=i.id(),h=t.value;return typeof a==typeof h&&a>=h}],"filter-has":[Yi,[Gi],(i,[t])=>t.value in i.properties()],"filter-has-id":[Yi,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Yi,[te(ar)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[Yi,[te(Gi)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[Yi,[ar,te(Gi)],(i,[t,a])=>a.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[Yi,[ar,te(Gi)],(i,[t,a])=>function(h,_,b,S){for(;b<=S;){const P=b+S>>1;if(_[P]===h)return!0;_[P]>h?S=P-1:b=P+1}return!1}(i.properties()[t.value],a.value,0,a.value.length-1)],all:{type:Yi,overloads:[[[Yi,Yi],(i,[t,a])=>t.evaluate(i)&&a.evaluate(i)],[zs(Yi),(i,t)=>{for(const a of t)if(!a.evaluate(i))return!1;return!0}]]},any:{type:Yi,overloads:[[[Yi,Yi],(i,[t,a])=>t.evaluate(i)||a.evaluate(i)],[zs(Yi),(i,t)=>{for(const a of t)if(a.evaluate(i))return!0;return!1}]]},"!":[Yi,[Yi],(i,[t])=>!t.evaluate(i)],"is-supported-script":[Yi,[ar],(i,[t])=>{const a=i.globals&&i.globals.isSupportedScript;return!a||a(t.evaluate(i))}],upcase:[ar,[ar],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[ar,[ar],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[ar,zs(Gi),(i,t)=>t.map(a=>et(a.evaluate(i))).join("")],"resolved-locale":[ar,[_a],(i,[t])=>t.evaluate(i).resolvedLocale()]});class ku{constructor(t,a){this.expression=t,this._warningHistory={},this._evaluator=new di,this._defaultValue=a?function(h){return h.type==="color"&&Hl(h.default)?new W(0,0,0,0):h.type==="color"?W.parse(h.default)||null:h.default===void 0?null:h.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(t,a,h,_,b,S){return this._evaluator.globals=t,this._evaluator.feature=a,this._evaluator.featureState=h,this._evaluator.canonical=_,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)}evaluate(t,a,h,_,b,S){this._evaluator.globals=t,this._evaluator.feature=a||null,this._evaluator.featureState=h||null,this._evaluator.canonical=_,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=S||null;try{const P=this.expression.evaluate(this._evaluator);if(P==null||typeof P=="number"&&P!=P)return this._defaultValue;if(this._enumValues&&!(P in this._enumValues))throw new tt(`Expected value to be one of ${Object.keys(this._enumValues).map(R=>JSON.stringify(R)).join(", ")}, but found ${JSON.stringify(P)} instead.`);return P}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console!="undefined"&&console.warn(P.message)),this._defaultValue}}}function Za(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in xa}function Ha(i,t){const a=new Na(xa,[],t?function(_){const b={color:Rn,string:ar,number:Jt,enum:ar,boolean:Yi,formatted:Uo,resolvedImage:Xr};return _.type==="array"?te(b[_.value]||Gi,_.length):b[_.type]}(t):void 0),h=a.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?Zr(new ku(h,t)):Xs(a.errors)}class Kl{constructor(t,a){this.kind=t,this._styleExpression=a,this.isStateDependent=t!=="constant"&&!In(a.expression)}evaluateWithoutErrorHandling(t,a,h,_,b,S){return this._styleExpression.evaluateWithoutErrorHandling(t,a,h,_,b,S)}evaluate(t,a,h,_,b,S){return this._styleExpression.evaluate(t,a,h,_,b,S)}}class Ps{constructor(t,a,h,_){this.kind=t,this.zoomStops=h,this._styleExpression=a,this.isStateDependent=t!=="camera"&&!In(a.expression),this.interpolationType=_}evaluateWithoutErrorHandling(t,a,h,_,b,S){return this._styleExpression.evaluateWithoutErrorHandling(t,a,h,_,b,S)}evaluate(t,a,h,_,b,S){return this._styleExpression.evaluate(t,a,h,_,b,S)}interpolationFactor(t,a,h){return this.interpolationType?mo.interpolationFactor(this.interpolationType,t,a,h):0}}function Jr(i,t){const a=Ha(i,t);if(a.result==="error")return a;const h=a.value.expression,_=va(h);if(!_&&!as(t))return Xs([new eo("","data expressions not supported")]);const b=Zo(h,["zoom"]);if(!b&&!oc(t))return Xs([new eo("","zoom expressions not supported")]);const S=zu(h);return S||b?S instanceof eo?Xs([S]):S instanceof mo&&!Cu(t)?Xs([new eo("",'"interpolate" expressions cannot be used with this property')]):Zr(S?new Ps(_?"camera":"composite",a.value,S.labels,S instanceof mo?S.interpolation:void 0):new Kl(_?"constant":"source",a.value)):Xs([new eo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ss{constructor(t,a){this._parameters=t,this._specification=a,fr(this,ka(this._parameters,this._specification))}static deserialize(t){return new ss(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function zu(i){let t=null;if(i instanceof Iu)t=zu(i.result);else if(i instanceof Su){for(const a of i.args)if(t=zu(a),t)break}else(i instanceof Hs||i instanceof mo)&&i.input instanceof ei&&i.input.name==="zoom"&&(t=i);return t instanceof eo||i.eachChild(a=>{const h=zu(a);h instanceof eo?t=h:!t&&h?t=new eo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&h&&t!==h&&(t=new eo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function ko(i){const t=i.key,a=i.value,h=i.valueSpec||{},_=i.objectElementValidators||{},b=i.style,S=i.styleSpec;let P=[];const R=$i(a);if(R!=="object")return[new _t(t,a,`object expected, ${R} found`)];for(const O in a){const V=O.split(".")[0],j=h[V]||h["*"];let K;if(_[V])K=_[V];else if(h[V])K=Po;else if(_["*"])K=_["*"];else{if(!h["*"]){P.push(new _t(t,a[O],`unknown property "${O}"`));continue}K=Po}P=P.concat(K({key:(t&&`${t}.`)+O,value:a[O],valueSpec:j,style:b,styleSpec:S,object:a,objectKey:O},a))}for(const O in h)_[O]||h[O].required&&h[O].default===void 0&&a[O]===void 0&&P.push(new _t(t,a,`missing required property "${O}"`));return P}function ac(i){const t=i.value,a=i.valueSpec,h=i.style,_=i.styleSpec,b=i.key,S=i.arrayElementValidator||Po;if($i(t)!=="array")return[new _t(b,t,`array expected, ${$i(t)} found`)];if(a.length&&t.length!==a.length)return[new _t(b,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new _t(b,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let P={type:a.value,values:a.values};_.$version<7&&(P.function=a.function),$i(a.value)==="object"&&(P=a.value);let R=[];for(let O=0;O<t.length;O++)R=R.concat(S({array:t,arrayIndex:O,value:t[O],valueSpec:P,style:h,styleSpec:_,key:`${b}[${O}]`}));return R}function Nc(i){const t=i.key,a=i.value,h=i.valueSpec;let _=$i(a);return _==="number"&&a!=a&&(_="NaN"),_!=="number"?[new _t(t,a,`number expected, ${_} found`)]:"minimum"in h&&a<h.minimum?[new _t(t,a,`${a} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&a>h.maximum?[new _t(t,a,`${a} is greater than the maximum value ${h.maximum}`)]:[]}function sc(i){const t=i.valueSpec,a=wr(i.value.type);let h,_,b,S={};const P=a!=="categorical"&&i.value.property===void 0,R=!P,O=$i(i.value.stops)==="array"&&$i(i.value.stops[0])==="array"&&$i(i.value.stops[0][0])==="object",V=ko({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function($){if(a==="identity")return[new _t($.key,$.value,'identity function may not have a "stops" property')];let Q=[];const se=$.value;return Q=Q.concat(ac({key:$.key,value:se,valueSpec:$.valueSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:j})),$i(se)==="array"&&se.length===0&&Q.push(new _t($.key,se,"array must have at least one stop")),Q},default:function($){return Po({key:$.key,value:$.value,valueSpec:t,style:$.style,styleSpec:$.styleSpec})}}});return a==="identity"&&P&&V.push(new _t(i.key,i.value,'missing required property "property"')),a==="identity"||i.value.stops||V.push(new _t(i.key,i.value,'missing required property "stops"')),a==="exponential"&&i.valueSpec.expression&&!Cu(i.valueSpec)&&V.push(new _t(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(R&&!as(i.valueSpec)?V.push(new _t(i.key,i.value,"property functions not supported")):P&&!oc(i.valueSpec)&&V.push(new _t(i.key,i.value,"zoom functions not supported"))),a!=="categorical"&&!O||i.value.property!==void 0||V.push(new _t(i.key,i.value,'"property" property is required')),V;function j($){let Q=[];const se=$.value,pe=$.key;if($i(se)!=="array")return[new _t(pe,se,`array expected, ${$i(se)} found`)];if(se.length!==2)return[new _t(pe,se,`array length 2 expected, length ${se.length} found`)];if(O){if($i(se[0])!=="object")return[new _t(pe,se,`object expected, ${$i(se[0])} found`)];if(se[0].zoom===void 0)return[new _t(pe,se,"object stop key must have zoom")];if(se[0].value===void 0)return[new _t(pe,se,"object stop key must have value")];if(b&&b>wr(se[0].zoom))return[new _t(pe,se[0].zoom,"stop zoom values must appear in ascending order")];wr(se[0].zoom)!==b&&(b=wr(se[0].zoom),_=void 0,S={}),Q=Q.concat(ko({key:`${pe}[0]`,value:se[0],valueSpec:{zoom:{}},style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:Nc,value:K}}))}else Q=Q.concat(K({key:`${pe}[0]`,value:se[0],valueSpec:{},style:$.style,styleSpec:$.styleSpec},se));return Za(Qn(se[1]))?Q.concat([new _t(`${pe}[1]`,se[1],"expressions are not allowed in function stops.")]):Q.concat(Po({key:`${pe}[1]`,value:se[1],valueSpec:t,style:$.style,styleSpec:$.styleSpec}))}function K($,Q){const se=$i($.value),pe=wr($.value),ke=$.value!==null?$.value:Q;if(h){if(se!==h)return[new _t($.key,ke,`${se} stop domain type must match previous stop domain type ${h}`)]}else h=se;if(se!=="number"&&se!=="string"&&se!=="boolean")return[new _t($.key,ke,"stop domain value must be a number, string, or boolean")];if(se!=="number"&&a!=="categorical"){let Ne=`number expected, ${se} found`;return as(t)&&a===void 0&&(Ne+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new _t($.key,ke,Ne)]}return a!=="categorical"||se!=="number"||isFinite(pe)&&Math.floor(pe)===pe?a!=="categorical"&&se==="number"&&_!==void 0&&pe<_?[new _t($.key,ke,"stop domain values must appear in ascending order")]:(_=pe,a==="categorical"&&pe in S?[new _t($.key,ke,"stop domain values must be unique")]:(S[pe]=!0,[])):[new _t($.key,ke,`integer expected, found ${pe}`)]}}function ls(i){const t=(i.expressionContext==="property"?Jr:Ha)(Qn(i.value),i.valueSpec);if(t.result==="error")return t.value.map(h=>new _t(`${i.key}${h.key}`,i.value,h.message));const a=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!a.outputDefined())return[new _t(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!In(a))return[new _t(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!In(a))return[new _t(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Zo(a,["zoom","feature-state"]))return[new _t(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!va(a))return[new _t(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function us(i){const t=i.key,a=i.value,h=i.valueSpec,_=[];return Array.isArray(h.values)?h.values.indexOf(wr(a))===-1&&_.push(new _t(t,a,`expected one of [${h.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(h.values).indexOf(wr(a))===-1&&_.push(new _t(t,a,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(a)} found`)),_}function Js(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!Js(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Jl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ms(i){if(i==null)return{filter:()=>!0,needGeometry:!1};Js(i)||(i=Wa(i));const t=Ha(i,Jl);if(t.result==="error")throw new Error(t.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,h,_)=>t.value.evaluate(a,h,{},_),needGeometry:lc(i)}}function cs(i,t){return i<t?-1:i>t?1:0}function lc(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let t=1;t<i.length;t++)if(lc(i[t]))return!0;return!1}function Wa(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?ha(i[1],i[2],"=="):t==="!="?Ys(ha(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?ha(i[1],i[2],t):t==="any"?(a=i.slice(1),["any"].concat(a.map(Wa))):t==="all"?["all"].concat(i.slice(1).map(Wa)):t==="none"?["all"].concat(i.slice(1).map(Wa).map(Ys)):t==="in"?Yl(i[1],i.slice(2)):t==="!in"?Ys(Yl(i[1],i.slice(2))):t==="has"?$l(i[1]):t==="!has"?Ys($l(i[1])):t!=="within"||i;var a}function ha(i,t,a){switch(i){case"$type":return[`filter-type-${a}`,t];case"$id":return[`filter-id-${a}`,t];default:return[`filter-${a}`,i,t]}}function Yl(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(a=>typeof a!=typeof t[0])?["filter-in-large",i,["literal",t.sort(cs)]]:["filter-in-small",i,["literal",t]]}}function $l(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Ys(i){return["!",i]}function za(i){return Js(Qn(i.value))?ls(fr({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):vl(i)}function vl(i){const t=i.value,a=i.key;if($i(t)!=="array")return[new _t(a,t,`array expected, ${$i(t)} found`)];const h=i.styleSpec;let _,b=[];if(t.length<1)return[new _t(a,t,"filter array must have at least 1 element")];switch(b=b.concat(us({key:`${a}[0]`,value:t[0],valueSpec:h.filter_operator,style:i.style,styleSpec:i.styleSpec})),wr(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&wr(t[1])==="$type"&&b.push(new _t(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&b.push(new _t(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(_=$i(t[1]),_!=="string"&&b.push(new _t(`${a}[1]`,t[1],`string expected, ${_} found`)));for(let S=2;S<t.length;S++)_=$i(t[S]),wr(t[1])==="$type"?b=b.concat(us({key:`${a}[${S}]`,value:t[S],valueSpec:h.geometry_type,style:i.style,styleSpec:i.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&b.push(new _t(`${a}[${S}]`,t[S],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let S=1;S<t.length;S++)b=b.concat(vl({key:`${a}[${S}]`,value:t[S],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":_=$i(t[1]),t.length!==2?b.push(new _t(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):_!=="string"&&b.push(new _t(`${a}[1]`,t[1],`string expected, ${_} found`));break;case"within":_=$i(t[1]),t.length!==2?b.push(new _t(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):_!=="object"&&b.push(new _t(`${a}[1]`,t[1],`object expected, ${_} found`))}return b}function Ls(i,t){const a=i.key,h=i.style,_=i.styleSpec,b=i.value,S=i.objectKey,P=_[`${t}_${i.layerType}`];if(!P)return[];const R=S.match(/^(.*)-transition$/);if(t==="paint"&&R&&P[R[1]]&&P[R[1]].transition)return Po({key:a,value:b,valueSpec:_.transition,style:h,styleSpec:_});const O=i.valueSpec||P[S];if(!O)return[new _t(a,b,`unknown property "${S}"`)];let V;if($i(b)==="string"&&as(O)&&!O.tokens&&(V=/^{([^}]+)}$/.exec(b)))return[new _t(a,b,`"${S}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(V[1])} }\`.`)];const j=[];return i.layerType==="symbol"&&(S==="text-field"&&h&&!h.glyphs&&j.push(new _t(a,b,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&Hl(Qn(b))&&wr(b.type)==="identity"&&j.push(new _t(a,b,'"text-font" does not support identity functions'))),j.concat(Po({key:i.key,value:b,valueSpec:O,style:h,styleSpec:_,expressionContext:"property",propertyType:t,propertyKey:S}))}function Pu(i){return Ls(i,"paint")}function Ql(i){return Ls(i,"layout")}function jc(i){let t=[];const a=i.value,h=i.key,_=i.style,b=i.styleSpec;a.type||a.ref||t.push(new _t(h,a,'either "type" or "ref" is required'));let S=wr(a.type);const P=wr(a.ref);if(a.id){const R=wr(a.id);for(let O=0;O<i.arrayIndex;O++){const V=_.layers[O];wr(V.id)===R&&t.push(new _t(h,a.id,`duplicate layer id "${a.id}", previously used at line ${V.id.__line__}`))}}if("ref"in a){let R;["type","source","source-layer","filter","layout"].forEach(O=>{O in a&&t.push(new _t(h,a[O],`"${O}" is prohibited for ref layers`))}),_.layers.forEach(O=>{wr(O.id)===P&&(R=O)}),R?R.ref?t.push(new _t(h,a.ref,"ref cannot reference another ref layer")):S=wr(R.type):t.push(new _t(h,a.ref,`ref layer "${P}" not found`))}else if(S!=="background")if(a.source){const R=_.sources&&_.sources[a.source],O=R&&wr(R.type);R?O==="vector"&&S==="raster"?t.push(new _t(h,a.source,`layer "${a.id}" requires a raster source`)):O==="raster"&&S!=="raster"?t.push(new _t(h,a.source,`layer "${a.id}" requires a vector source`)):O!=="vector"||a["source-layer"]?O==="raster-dem"&&S!=="hillshade"?t.push(new _t(h,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):S!=="line"||!a.paint||!a.paint["line-gradient"]||O==="geojson"&&R.lineMetrics||t.push(new _t(h,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new _t(h,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new _t(h,a.source,`source "${a.source}" not found`))}else t.push(new _t(h,a,'missing required property "source"'));return t=t.concat(ko({key:h,value:a,valueSpec:b.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Po({key:`${h}.type`,value:a.type,valueSpec:b.layer.type,style:i.style,styleSpec:i.styleSpec,object:a,objectKey:"type"}),filter:za,layout:R=>ko({layer:a,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":O=>Ql(fr({layerType:S},O))}}),paint:R=>ko({layer:a,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":O=>Pu(fr({layerType:S},O))}})}})),t}function hs(i){const t=i.value,a=i.key,h=$i(t);return h!=="string"?[new _t(a,t,`string expected, ${h} found`)]:[]}const Mu={promoteId:function({key:i,value:t}){if($i(t)==="string")return hs({key:i,value:t});{const a=[];for(const h in t)a.push(...hs({key:`${i}.${h}`,value:t[h]}));return a}}};function xl(i){const t=i.value,a=i.key,h=i.styleSpec,_=i.style;if(!t.type)return[new _t(a,t,'"type" is required')];const b=wr(t.type);let S;switch(b){case"vector":case"raster":case"raster-dem":return S=ko({key:a,value:t,valueSpec:h[`source_${b.replace("-","_")}`],style:i.style,styleSpec:h,objectElementValidators:Mu}),S;case"geojson":if(S=ko({key:a,value:t,valueSpec:h.source_geojson,style:_,styleSpec:h,objectElementValidators:Mu}),t.cluster)for(const P in t.clusterProperties){const[R,O]=t.clusterProperties[P],V=typeof R=="string"?[R,["accumulated"],["get",P]]:R;S.push(...ls({key:`${a}.${P}.map`,value:O,expressionContext:"cluster-map"})),S.push(...ls({key:`${a}.${P}.reduce`,value:V,expressionContext:"cluster-reduce"}))}return S;case"video":return ko({key:a,value:t,valueSpec:h.source_video,style:_,styleSpec:h});case"image":return ko({key:a,value:t,valueSpec:h.source_image,style:_,styleSpec:h});case"canvas":return[new _t(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return us({key:`${a}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:_,styleSpec:h})}}function bl(i){const t=i.value,a=i.styleSpec,h=a.light,_=i.style;let b=[];const S=$i(t);if(t===void 0)return b;if(S!=="object")return b=b.concat([new _t("light",t,`object expected, ${S} found`)]),b;for(const P in t){const R=P.match(/^(.*)-transition$/);b=b.concat(R&&h[R[1]]&&h[R[1]].transition?Po({key:P,value:t[P],valueSpec:a.transition,style:_,styleSpec:a}):h[P]?Po({key:P,value:t[P],valueSpec:h[P],style:_,styleSpec:a}):[new _t(P,t[P],`unknown property "${P}"`)])}return b}const zo={"*":()=>[],array:ac,boolean:function(i){const t=i.value,a=i.key,h=$i(t);return h!=="boolean"?[new _t(a,t,`boolean expected, ${h} found`)]:[]},number:Nc,color:function(i){const t=i.key,a=i.value,h=$i(a);return h!=="string"?[new _t(t,a,`color expected, ${h} found`)]:Ge(a)===null?[new _t(t,a,`color expected, "${a}" found`)]:[]},constants:Ci,enum:us,filter:za,function:sc,layer:jc,object:ko,source:xl,light:bl,string:hs,formatted:function(i){return hs(i).length===0?[]:ls(i)},resolvedImage:function(i){return hs(i).length===0?[]:ls(i)}};function Po(i){const t=i.value,a=i.valueSpec,h=i.styleSpec;return a.expression&&Hl(wr(t))?sc(i):a.expression&&Za(Qn(t))?ls(i):a.type&&zo[a.type]?zo[a.type](i):ko(fr({},i,{valueSpec:a.type?h[a.type]:a}))}function uc(i){const t=i.value,a=i.key,h=hs(i);return h.length||(t.indexOf("{fontstack}")===-1&&h.push(new _t(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&h.push(new _t(a,t,'"glyphs" url must include a "{range}" token'))),h}function ps(i,t=qe){let a=[];return a=a.concat(Po({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,objectElementValidators:{glyphs:uc,"*":()=>[]}})),i.constants&&(a=a.concat(Ci({key:"constants",value:i.constants,style:i,styleSpec:t}))),wl(a)}function wl(i){return[].concat(i).sort((t,a)=>t.line-a.line)}function $s(i){return function(...t){return wl(i.apply(this,t))}}ps.source=$s(xl),ps.light=$s(bl),ps.layer=$s(jc),ps.filter=$s(za),ps.paintProperty=$s(Pu),ps.layoutProperty=$s(Ql);const pa=ps,sn=pa.light,El=pa.paintProperty,Qs=pa.layoutProperty;function ds(i,t){let a=!1;if(t&&t.length)for(const h of t)i.fire(new $n(new Error(h.message))),a=!0;return a}class tr{constructor(t,a,h){const _=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const S=new Int32Array(this.arrayBuffer);t=S[0],this.d=(a=S[1])+2*(h=S[2]);for(let R=0;R<this.d*this.d;R++){const O=S[3+R],V=S[3+R+1];_.push(O===V?null:S.subarray(O,V))}const P=S[3+_.length+1];this.keys=S.subarray(S[3+_.length],P),this.bboxes=S.subarray(P),this.insert=this._insertReadonly}else{this.d=a+2*h;for(let S=0;S<this.d*this.d;S++)_.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=t,this.padding=h,this.scale=a/t,this.uid=0;const b=h/a*t;this.min=-b,this.max=t+b}insert(t,a,h,_,b){this._forEachCell(a,h,_,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(_),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,a,h,_,b,S){this.cells[b].push(S)}query(t,a,h,_,b){const S=this.min,P=this.max;if(t<=S&&a<=S&&P<=h&&P<=_&&!b)return Array.prototype.slice.call(this.keys);{const R=[];return this._forEachCell(t,a,h,_,this._queryCell,R,{},b),R}}_queryCell(t,a,h,_,b,S,P,R){const O=this.cells[b];if(O!==null){const V=this.keys,j=this.bboxes;for(let K=0;K<O.length;K++){const $=O[K];if(P[$]===void 0){const Q=4*$;(R?R(j[Q+0],j[Q+1],j[Q+2],j[Q+3]):t<=j[Q+2]&&a<=j[Q+3]&&h>=j[Q+0]&&_>=j[Q+1])?(P[$]=!0,S.push(V[$])):P[$]=!1}}}}_forEachCell(t,a,h,_,b,S,P,R){const O=this._convertToCellCoord(t),V=this._convertToCellCoord(a),j=this._convertToCellCoord(h),K=this._convertToCellCoord(_);for(let $=O;$<=j;$++)for(let Q=V;Q<=K;Q++){const se=this.d*Q+$;if((!R||R(this._convertFromCellCoord($),this._convertFromCellCoord(Q),this._convertFromCellCoord($+1),this._convertFromCellCoord(Q+1)))&&b.call(this,t,a,h,_,se,S,P,R))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,a=3+this.cells.length+1+1;let h=0;for(let S=0;S<this.cells.length;S++)h+=this.cells[S].length;const _=new Int32Array(a+h+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;let b=a;for(let S=0;S<t.length;S++){const P=t[S];_[3+S]=b,_.set(P,b),b+=P.length}return _[3+t.length]=b,_.set(this.keys,b),b+=this.keys.length,_[3+t.length+1]=b,_.set(this.bboxes,b),b+=this.bboxes.length,_.buffer}static serialize(t,a){const h=t.toArrayBuffer();return a&&a.push(h),{buffer:h}}static deserialize(t){return new tr(t.buffer)}}const Mr={};function ti(i,t,a={}){Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),Mr[i]={klass:t,omit:a.omit||[],shallow:a.shallow||[]}}ti("Object",Object),ti("TransferableGridIndex",tr),ti("Color",W),ti("Error",Error),ti("AJAXError",rt),ti("ResolvedImage",fe),ti("StylePropertyFunction",ss),ti("StyleExpression",ku,{omit:["_evaluator"]}),ti("ZoomDependentExpression",Ps),ti("ZoomConstantExpression",Kl),ti("CompoundExpression",ei,{omit:["_evaluate"]});for(const i in xa)xa[i]._classRegistryKey||ti(`Expression_${i}`,xa[i]);function el(i){return i&&typeof ArrayBuffer!="undefined"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Xa(i,t){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob)return i;if(el(i)||Qt(i))return t&&t.push(i),i;if(ArrayBuffer.isView(i)){const a=i;return t&&t.push(a.buffer),a}if(i instanceof ImageData)return t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const a=[];for(const h of i)a.push(Xa(h,t));return a}if(typeof i=="object"){const a=i.constructor,h=a._classRegistryKey;if(!h)throw new Error("can't serialize object of unregistered class");const _=a.serialize?a.serialize(i,t):{};if(!a.serialize){for(const b in i){if(!i.hasOwnProperty(b)||Mr[h].omit.indexOf(b)>=0)continue;const S=i[b];_[b]=Mr[h].shallow.indexOf(b)>=0?S:Xa(S,t)}i instanceof Error&&(_.message=i.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(_.$name=h),_}throw new Error("can't serialize object of type "+typeof i)}function Pa(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||el(i)||Qt(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(Pa);if(typeof i=="object"){const t=i.$name||"Object";if(!Mr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:a}=Mr[t];if(!a)throw new Error(`can't deserialize unregistered class ${t}`);if(a.deserialize)return a.deserialize(i);const h=Object.create(a.prototype);for(const _ of Object.keys(i)){if(_==="$name")continue;const b=i[_];h[_]=Mr[t].shallow.indexOf(_)>=0?b:Pa(b)}return h}throw new Error("can't deserialize object of type "+typeof i)}class eu{constructor(){this.first=!0}update(t,a){const h=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=a),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=h,!0))}}const ai={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function tl(i){for(const t of i)if(pn(t.charCodeAt(0)))return!0;return!1}function Sl(i){for(const t of i)if(!fs(t.charCodeAt(0)))return!1;return!0}function fs(i){return!(ai.Arabic(i)||ai["Arabic Supplement"](i)||ai["Arabic Extended-A"](i)||ai["Arabic Presentation Forms-A"](i)||ai["Arabic Presentation Forms-B"](i))}function pn(i){return!(i!==746&&i!==747&&(i<4352||!(ai["Bopomofo Extended"](i)||ai.Bopomofo(i)||ai["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||ai["CJK Compatibility Ideographs"](i)||ai["CJK Compatibility"](i)||ai["CJK Radicals Supplement"](i)||ai["CJK Strokes"](i)||!(!ai["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||ai["CJK Unified Ideographs Extension A"](i)||ai["CJK Unified Ideographs"](i)||ai["Enclosed CJK Letters and Months"](i)||ai["Hangul Compatibility Jamo"](i)||ai["Hangul Jamo Extended-A"](i)||ai["Hangul Jamo Extended-B"](i)||ai["Hangul Jamo"](i)||ai["Hangul Syllables"](i)||ai.Hiragana(i)||ai["Ideographic Description Characters"](i)||ai.Kanbun(i)||ai["Kangxi Radicals"](i)||ai["Katakana Phonetic Extensions"](i)||ai.Katakana(i)&&i!==12540||!(!ai["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!ai["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||ai["Unified Canadian Aboriginal Syllabics"](i)||ai["Unified Canadian Aboriginal Syllabics Extended"](i)||ai["Vertical Forms"](i)||ai["Yijing Hexagram Symbols"](i)||ai["Yi Syllables"](i)||ai["Yi Radicals"](i))))}function Il(i){return!(pn(i)||function(t){return!!(ai["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||ai["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||ai["Letterlike Symbols"](t)||ai["Number Forms"](t)||ai["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||ai["Control Pictures"](t)&&t!==9251||ai["Optical Character Recognition"](t)||ai["Enclosed Alphanumerics"](t)||ai["Geometric Shapes"](t)||ai["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||ai["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||ai["CJK Symbols and Punctuation"](t)||ai.Katakana(t)||ai["Private Use Area"](t)||ai["CJK Compatibility Forms"](t)||ai["Small Form Variants"](t)||ai["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}function cc(i){return i>=1424&&i<=2303||ai["Arabic Presentation Forms-A"](i)||ai["Arabic Presentation Forms-B"](i)}function zn(i,t){return!(!t&&cc(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||ai.Khmer(i))}function ui(i){for(const t of i)if(cc(t.charCodeAt(0)))return!0;return!1}const So="deferred",Tl="loading",Ds="loaded";let da=null,ln="unavailable",Ka=null;const Wt=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(ln="error"),da&&da(i)};function tu(){ms.fire(new Ao("pluginStateChange",{pluginStatus:ln,pluginURL:Ka}))}const ms=new Ua,iu=function(){return ln},jo=function(){if(ln!==So||!Ka)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ln=Tl,tu(),Ka&&ho({url:Ka},i=>{i?Wt(i):(ln=Ds,tu())})},dn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ln===Ds||dn.applyArabicShaping!=null,isLoading:()=>ln===Tl,setState(i){ln=i.pluginStatus,Ka=i.pluginURL},isParsed:()=>dn.applyArabicShaping!=null&&dn.processBidirectionalText!=null&&dn.processStyledBidirectionalText!=null,getPluginURL:()=>Ka};class rn{constructor(t,a){this.zoom=t,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new eu,this.transition={})}isSupportedScript(t){return function(a,h){for(const _ of a)if(!zn(_.charCodeAt(0),h))return!1;return!0}(t,dn.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,a=t-Math.floor(t),h=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*a}}}class il{constructor(t,a){this.property=t,this.value=a,this.expression=function(h,_){if(Hl(h))return new ss(h,_);if(Za(h)){const b=Jr(h,_);if(b.result==="error")throw new Error(b.value.map(S=>`${S.key}: ${S.message}`).join(", "));return b.value}{let b=h;return typeof h=="string"&&_.type==="color"&&(b=W.parse(h)),{kind:"constant",evaluate:()=>b}}}(a===void 0?t.specification.default:a,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,a,h){return this.property.possiblyEvaluate(this,t,a,h)}}class Io{constructor(t){this.property=t,this.value=new il(t,void 0)}transitioned(t,a){return new hc(this.property,this.value,a,ge({},t.transition,this.transition),t.now)}untransitioned(){return new hc(this.property,this.value,null,{},0)}}class Ma{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Re(this._values[t].value.value)}setValue(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Io(this._values[t].property)),this._values[t].value=new il(this._values[t].property,a===null?void 0:Re(a))}getTransition(t){return Re(this._values[t].transition)}setTransition(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Io(this._values[t].property)),this._values[t].transition=Re(a)||void 0}serialize(){const t={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(t[a]=h);const _=this.getTransition(a);_!==void 0&&(t[`${a}-transition`]=_)}return t}transitioned(t,a){const h=new Al(this._properties);for(const _ of Object.keys(this._values))h._values[_]=this._values[_].transitioned(t,a._values[_]);return h}untransitioned(){const t=new Al(this._properties);for(const a of Object.keys(this._values))t._values[a]=this._values[a].untransitioned();return t}}class hc{constructor(t,a,h,_,b){this.property=t,this.value=a,this.begin=b+_.delay||0,this.end=this.begin+_.duration||0,t.specification.transition&&(_.delay||_.duration)&&(this.prior=h)}possiblyEvaluate(t,a,h){const _=t.now||0,b=this.value.possiblyEvaluate(t,a,h),S=this.prior;if(S){if(_>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(_<this.begin)return S.possiblyEvaluate(t,a,h);{const P=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(t,a,h),b,function(R){if(R<=0)return 0;if(R>=1)return 1;const O=R*R,V=O*R;return 4*(R<.5?V:3*(R-O)+V-.75)}(P))}}return b}}class Al{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,a,h){const _=new Wo(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(t,a,h);return _}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class pc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return Re(this._values[t].value)}setValue(t,a){this._values[t]=new il(this._values[t].property,a===null?void 0:Re(a))}serialize(){const t={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(t[a]=h)}return t}possiblyEvaluate(t,a,h){const _=new Wo(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(t,a,h);return _}}class ba{constructor(t,a,h){this.property=t,this.value=a,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,a,h,_){return this.property.evaluate(this.value,this.parameters,t,a,h,_)}}class Wo{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class ci{constructor(t){this.specification=t}possiblyEvaluate(t,a){return t.expression.evaluate(a)}interpolate(t,a,h){const _=ml[this.specification.type];return _?_(t,a,h):t}}class Vt{constructor(t,a){this.specification=t,this.overrides=a}possiblyEvaluate(t,a,h,_){return new ba(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(a,null,{},h,_)}:t.expression,a)}interpolate(t,a,h){if(t.value.kind!=="constant"||a.value.kind!=="constant")return t;if(t.value.value===void 0||a.value.value===void 0)return new ba(this,{kind:"constant",value:void 0},t.parameters);const _=ml[this.specification.type];return _?new ba(this,{kind:"constant",value:_(t.value.value,a.value.value,h)},t.parameters):t}evaluate(t,a,h,_,b,S){return t.kind==="constant"?t.value:t.evaluate(a,h,_,b,S)}}class Xo extends Vt{possiblyEvaluate(t,a,h,_){if(t.value===void 0)return new ba(this,{kind:"constant",value:void 0},a);if(t.expression.kind==="constant"){const b=t.expression.evaluate(a,null,{},h,_),S=t.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,P=this._calculate(S,S,S,a);return new ba(this,{kind:"constant",value:P},a)}if(t.expression.kind==="camera"){const b=this._calculate(t.expression.evaluate({zoom:a.zoom-1}),t.expression.evaluate({zoom:a.zoom}),t.expression.evaluate({zoom:a.zoom+1}),a);return new ba(this,{kind:"constant",value:b},a)}return new ba(this,t.expression,a)}evaluate(t,a,h,_,b,S){if(t.kind==="source"){const P=t.evaluate(a,h,_,b,S);return this._calculate(P,P,P,a)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(a.zoom)-1},h,_),t.evaluate({zoom:Math.floor(a.zoom)},h,_),t.evaluate({zoom:Math.floor(a.zoom)+1},h,_),a):t.value}_calculate(t,a,h,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:h,to:a}}interpolate(t){return t}}class Mo{constructor(t){this.specification=t}possiblyEvaluate(t,a,h,_){if(t.value!==void 0){if(t.expression.kind==="constant"){const b=t.expression.evaluate(a,null,{},h,_);return this._calculate(b,b,b,a)}return this._calculate(t.expression.evaluate(new rn(Math.floor(a.zoom-1),a)),t.expression.evaluate(new rn(Math.floor(a.zoom),a)),t.expression.evaluate(new rn(Math.floor(a.zoom+1),a)),a)}}_calculate(t,a,h,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:h,to:a}}interpolate(t){return t}}class Vn{constructor(t){this.specification=t}possiblyEvaluate(t,a,h,_){return!!t.expression.evaluate(a,null,{},h,_)}interpolate(){return!1}}class fn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in t){const h=t[a];h.specification.overridable&&this.overridableProperties.push(a);const _=this.defaultPropertyValues[a]=new il(h,void 0),b=this.defaultTransitionablePropertyValues[a]=new Io(h);this.defaultTransitioningPropertyValues[a]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=_.possiblyEvaluate({})}}}ti("DataDrivenProperty",Vt),ti("DataConstantProperty",ci),ti("CrossFadedDataDrivenProperty",Xo),ti("CrossFadedProperty",Mo),ti("ColorRampProperty",Vn);const Ko="-transition";class bn extends Ua{constructor(t,a){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),a.layout&&(this._unevaluatedLayout=new pc(a.layout)),a.paint)){this._transitionablePaint=new Ma(a.paint);for(const h in t.paint)this.setPaintProperty(h,t.paint[h],{validate:!1});for(const h in t.layout)this.setLayoutProperty(h,t.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wo(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,a,h={}){a!=null&&this._validate(Qs,`layers.${this.id}.layout.${t}`,t,a,h)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,a):this.visibility=a)}getPaintProperty(t){return t.endsWith(Ko)?this._transitionablePaint.getTransition(t.slice(0,-Ko.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,a,h={}){if(a!=null&&this._validate(El,`layers.${this.id}.paint.${t}`,t,a,h))return!1;if(t.endsWith(Ko))return this._transitionablePaint.setTransition(t.slice(0,-Ko.length),a||void 0),!1;{const _=this._transitionablePaint._values[t],b=_.property.specification["property-type"]==="cross-faded-data-driven",S=_.value.isDataDriven(),P=_.value;this._transitionablePaint.setValue(t,a),this._handleSpecialPaintPropertyUpdate(t);const R=this._transitionablePaint._values[t].value;return R.isDataDriven()||S||b||this._handleOverridablePaintPropertyUpdate(t,P,R)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,a,h){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,a){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,a)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Ue(t,(a,h)=>!(a===void 0||h==="layout"&&!Object.keys(a).length||h==="paint"&&!Object.keys(a).length))}_validate(t,a,h,_,b={}){return(!b||b.validate!==!1)&&ds(this,t.call(pa,{key:a,layerType:this.type,objectKey:h,value:_,styleSpec:qe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const a=this.paint.get(t);if(a instanceof ba&&as(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const Lo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ys{constructor(t,a){this._structArray=t,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Kt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,a){return t._trim(),a&&(t.isTransferred=!0,a.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const a=Object.create(this.prototype);return a.arrayBuffer=t.arrayBuffer,a.length=t.length,a.capacity=t.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Xt(i,t=1){let a=0,h=0;return{members:i.map(_=>{const b=Lo[_.type].BYTES_PER_ELEMENT,S=a=ru(a,Math.max(t,b)),P=_.components||1;return h=Math.max(h,b),a+=b*P,{name:_.name,type:_.type,components:P,offset:S}}),size:ru(a,Math.max(h,t)),alignment:t}}function ru(i,t){return Math.ceil(i/t)*t}class On extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,a)}emplace(t,a,h){const _=2*t;return this.int16[_+0]=a,this.int16[_+1]=h,t}}On.prototype.bytesPerElement=4,ti("StructArrayLayout2i4",On);class Vo extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,a,h,_)}emplace(t,a,h,_,b){const S=4*t;return this.int16[S+0]=a,this.int16[S+1]=h,this.int16[S+2]=_,this.int16[S+3]=b,t}}Vo.prototype.bytesPerElement=8,ti("StructArrayLayout4i8",Vo);class T extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,_,b,S){const P=this.length;return this.resize(P+1),this.emplace(P,t,a,h,_,b,S)}emplace(t,a,h,_,b,S,P){const R=6*t;return this.int16[R+0]=a,this.int16[R+1]=h,this.int16[R+2]=_,this.int16[R+3]=b,this.int16[R+4]=S,this.int16[R+5]=P,t}}T.prototype.bytesPerElement=12,ti("StructArrayLayout2i4i12",T);class o extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,_,b,S){const P=this.length;return this.resize(P+1),this.emplace(P,t,a,h,_,b,S)}emplace(t,a,h,_,b,S,P){const R=4*t,O=8*t;return this.int16[R+0]=a,this.int16[R+1]=h,this.uint8[O+4]=_,this.uint8[O+5]=b,this.uint8[O+6]=S,this.uint8[O+7]=P,t}}o.prototype.bytesPerElement=8,ti("StructArrayLayout2i4ub8",o);class g extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,a)}emplace(t,a,h){const _=2*t;return this.float32[_+0]=a,this.float32[_+1]=h,t}}g.prototype.bytesPerElement=8,ti("StructArrayLayout2f8",g);class I extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h,_,b,S,P,R,O,V){const j=this.length;return this.resize(j+1),this.emplace(j,t,a,h,_,b,S,P,R,O,V)}emplace(t,a,h,_,b,S,P,R,O,V,j){const K=10*t;return this.uint16[K+0]=a,this.uint16[K+1]=h,this.uint16[K+2]=_,this.uint16[K+3]=b,this.uint16[K+4]=S,this.uint16[K+5]=P,this.uint16[K+6]=R,this.uint16[K+7]=O,this.uint16[K+8]=V,this.uint16[K+9]=j,t}}I.prototype.bytesPerElement=20,ti("StructArrayLayout10ui20",I);class A extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h,_,b,S,P,R,O,V,j,K){const $=this.length;return this.resize($+1),this.emplace($,t,a,h,_,b,S,P,R,O,V,j,K)}emplace(t,a,h,_,b,S,P,R,O,V,j,K,$){const Q=12*t;return this.int16[Q+0]=a,this.int16[Q+1]=h,this.int16[Q+2]=_,this.int16[Q+3]=b,this.uint16[Q+4]=S,this.uint16[Q+5]=P,this.uint16[Q+6]=R,this.uint16[Q+7]=O,this.int16[Q+8]=V,this.int16[Q+9]=j,this.int16[Q+10]=K,this.int16[Q+11]=$,t}}A.prototype.bytesPerElement=24,ti("StructArrayLayout4i4ui4i24",A);class M extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h){const _=this.length;return this.resize(_+1),this.emplace(_,t,a,h)}emplace(t,a,h,_){const b=3*t;return this.float32[b+0]=a,this.float32[b+1]=h,this.float32[b+2]=_,t}}M.prototype.bytesPerElement=12,ti("StructArrayLayout3f12",M);class F extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint32[1*t+0]=a,t}}F.prototype.bytesPerElement=4,ti("StructArrayLayout1ul4",F);class Z extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h,_,b,S,P,R,O){const V=this.length;return this.resize(V+1),this.emplace(V,t,a,h,_,b,S,P,R,O)}emplace(t,a,h,_,b,S,P,R,O,V){const j=10*t,K=5*t;return this.int16[j+0]=a,this.int16[j+1]=h,this.int16[j+2]=_,this.int16[j+3]=b,this.int16[j+4]=S,this.int16[j+5]=P,this.uint32[K+3]=R,this.uint16[j+8]=O,this.uint16[j+9]=V,t}}Z.prototype.bytesPerElement=20,ti("StructArrayLayout6i1ul2ui20",Z);class J extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,_,b,S){const P=this.length;return this.resize(P+1),this.emplace(P,t,a,h,_,b,S)}emplace(t,a,h,_,b,S,P){const R=6*t;return this.int16[R+0]=a,this.int16[R+1]=h,this.int16[R+2]=_,this.int16[R+3]=b,this.int16[R+4]=S,this.int16[R+5]=P,t}}J.prototype.bytesPerElement=12,ti("StructArrayLayout2i2i2i12",J);class ee extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,_,b){const S=this.length;return this.resize(S+1),this.emplace(S,t,a,h,_,b)}emplace(t,a,h,_,b,S){const P=4*t,R=8*t;return this.float32[P+0]=a,this.float32[P+1]=h,this.float32[P+2]=_,this.int16[R+6]=b,this.int16[R+7]=S,t}}ee.prototype.bytesPerElement=16,ti("StructArrayLayout2f1f2i16",ee);class re extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,a,h,_)}emplace(t,a,h,_,b){const S=12*t,P=3*t;return this.uint8[S+0]=a,this.uint8[S+1]=h,this.float32[P+1]=_,this.float32[P+2]=b,t}}re.prototype.bytesPerElement=12,ti("StructArrayLayout2ub2f12",re);class ue extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h){const _=this.length;return this.resize(_+1),this.emplace(_,t,a,h)}emplace(t,a,h,_){const b=3*t;return this.uint16[b+0]=a,this.uint16[b+1]=h,this.uint16[b+2]=_,t}}ue.prototype.bytesPerElement=6,ti("StructArrayLayout3ui6",ue);class xe extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,_,b,S,P,R,O,V,j,K,$,Q,se,pe,ke){const Ne=this.length;return this.resize(Ne+1),this.emplace(Ne,t,a,h,_,b,S,P,R,O,V,j,K,$,Q,se,pe,ke)}emplace(t,a,h,_,b,S,P,R,O,V,j,K,$,Q,se,pe,ke,Ne){const Ze=24*t,He=12*t,it=48*t;return this.int16[Ze+0]=a,this.int16[Ze+1]=h,this.uint16[Ze+2]=_,this.uint16[Ze+3]=b,this.uint32[He+2]=S,this.uint32[He+3]=P,this.uint32[He+4]=R,this.uint16[Ze+10]=O,this.uint16[Ze+11]=V,this.uint16[Ze+12]=j,this.float32[He+7]=K,this.float32[He+8]=$,this.uint8[it+36]=Q,this.uint8[it+37]=se,this.uint8[it+38]=pe,this.uint32[He+10]=ke,this.int16[Ze+22]=Ne,t}}xe.prototype.bytesPerElement=48,ti("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",xe);class Fe extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,_,b,S,P,R,O,V,j,K,$,Q,se,pe,ke,Ne,Ze,He,it,We,kt,At,pt,Tt,gt,Pt){const mt=this.length;return this.resize(mt+1),this.emplace(mt,t,a,h,_,b,S,P,R,O,V,j,K,$,Q,se,pe,ke,Ne,Ze,He,it,We,kt,At,pt,Tt,gt,Pt)}emplace(t,a,h,_,b,S,P,R,O,V,j,K,$,Q,se,pe,ke,Ne,Ze,He,it,We,kt,At,pt,Tt,gt,Pt,mt){const vt=34*t,oi=17*t;return this.int16[vt+0]=a,this.int16[vt+1]=h,this.int16[vt+2]=_,this.int16[vt+3]=b,this.int16[vt+4]=S,this.int16[vt+5]=P,this.int16[vt+6]=R,this.int16[vt+7]=O,this.uint16[vt+8]=V,this.uint16[vt+9]=j,this.uint16[vt+10]=K,this.uint16[vt+11]=$,this.uint16[vt+12]=Q,this.uint16[vt+13]=se,this.uint16[vt+14]=pe,this.uint16[vt+15]=ke,this.uint16[vt+16]=Ne,this.uint16[vt+17]=Ze,this.uint16[vt+18]=He,this.uint16[vt+19]=it,this.uint16[vt+20]=We,this.uint16[vt+21]=kt,this.uint16[vt+22]=At,this.uint32[oi+12]=pt,this.float32[oi+13]=Tt,this.float32[oi+14]=gt,this.float32[oi+15]=Pt,this.float32[oi+16]=mt,t}}Fe.prototype.bytesPerElement=68,ti("StructArrayLayout8i15ui1ul4f68",Fe);class we extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.float32[1*t+0]=a,t}}we.prototype.bytesPerElement=4,ti("StructArrayLayout1f4",we);class Oe extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h){const _=this.length;return this.resize(_+1),this.emplace(_,t,a,h)}emplace(t,a,h,_){const b=3*t;return this.int16[b+0]=a,this.int16[b+1]=h,this.int16[b+2]=_,t}}Oe.prototype.bytesPerElement=6,ti("StructArrayLayout3i6",Oe);class Je extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h){const _=this.length;return this.resize(_+1),this.emplace(_,t,a,h)}emplace(t,a,h,_){const b=4*t;return this.uint32[2*t+0]=a,this.uint16[b+2]=h,this.uint16[b+3]=_,t}}Je.prototype.bytesPerElement=8,ti("StructArrayLayout1ul2ui8",Je);class Xe extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,a)}emplace(t,a,h){const _=2*t;return this.uint16[_+0]=a,this.uint16[_+1]=h,t}}Xe.prototype.bytesPerElement=4,ti("StructArrayLayout2ui4",Xe);class nt extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint16[1*t+0]=a,t}}nt.prototype.bytesPerElement=2,ti("StructArrayLayout1ui2",nt);class $e extends Kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,a,h,_)}emplace(t,a,h,_,b){const S=4*t;return this.float32[S+0]=a,this.float32[S+1]=h,this.float32[S+2]=_,this.float32[S+3]=b,t}}$e.prototype.bytesPerElement=16,ti("StructArrayLayout4f16",$e);class wt extends ys{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new bt(this.anchorPointX,this.anchorPointY)}}wt.prototype.size=20;class dt extends Z{get(t){return new wt(this,t)}}ti("CollisionBoxArray",dt);class yt extends ys{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}yt.prototype.size=48;class Lt extends xe{get(t){return new yt(this,t)}}ti("PlacedSymbolArray",Lt);class Nt extends ys{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Nt.prototype.size=68;class St extends Fe{get(t){return new Nt(this,t)}}ti("SymbolInstanceArray",St);class mi extends we{getoffsetX(t){return this.float32[1*t+0]}}ti("GlyphOffsetArray",mi);class ni extends Oe{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}ti("SymbolLineVertexArray",ni);class qi extends ys{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}qi.prototype.size=8;class c extends Je{get(t){return new qi(this,t)}}ti("FeatureIndexArray",c);class m extends On{}class d extends On{}class x extends T{}class k extends o{}class D extends g{}class B extends I{}class q extends A{}class Y extends M{}class ie extends F{}class he extends J{}class de extends re{}class me extends ue{}class ze extends Xe{}const Ce=Xt([{name:"a_pos",components:2,type:"Int16"}],4),{members:Be}=Ce;class be{constructor(t=[]){this.segments=t}prepareSegment(t,a,h,_){let b=this.segments[this.segments.length-1];return t>be.MAX_VERTEX_ARRAY_LENGTH&&ut(`Max vertices per segment is ${be.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!b||b.vertexLength+t>be.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==_)&&(b={vertexOffset:a.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},_!==void 0&&(b.sortKey=_),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const t of this.segments)for(const a in t.vaos)t.vaos[a].destroy()}static simpleSegment(t,a,h,_){return new be([{vertexOffset:t,primitiveOffset:a,vertexLength:h,primitiveLength:_,vaos:{},sortKey:0}])}}function Pe(i,t){return 256*(i=X(Math.floor(i),0,255))+X(Math.floor(t),0,255)}be.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ti("SegmentVector",be);const Ve=Xt([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ye={exports:{}},ot={exports:{}};ot.exports=function(i,t){var a,h,_,b,S,P,R,O;for(h=i.length-(a=3&i.length),_=t,S=3432918353,P=461845907,O=0;O<h;)R=255&i.charCodeAt(O)|(255&i.charCodeAt(++O))<<8|(255&i.charCodeAt(++O))<<16|(255&i.charCodeAt(++O))<<24,++O,_=27492+(65535&(b=5*(65535&(_=(_^=R=(65535&(R=(R=(65535&R)*S+(((R>>>16)*S&65535)<<16)&4294967295)<<15|R>>>17))*P+(((R>>>16)*P&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(R=0,a){case 3:R^=(255&i.charCodeAt(O+2))<<16;case 2:R^=(255&i.charCodeAt(O+1))<<8;case 1:_^=R=(65535&(R=(R=(65535&(R^=255&i.charCodeAt(O)))*S+(((R>>>16)*S&65535)<<16)&4294967295)<<15|R>>>17))*P+(((R>>>16)*P&65535)<<16)&4294967295}return _^=i.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0};var lt={exports:{}};lt.exports=function(i,t){for(var a,h=i.length,_=t^h,b=0;h>=4;)a=1540483477*(65535&(a=255&i.charCodeAt(b)|(255&i.charCodeAt(++b))<<8|(255&i.charCodeAt(++b))<<16|(255&i.charCodeAt(++b))<<24))+((1540483477*(a>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),h-=4,++b;switch(h){case 3:_^=(255&i.charCodeAt(b+2))<<16;case 2:_^=(255&i.charCodeAt(b+1))<<8;case 1:_=1540483477*(65535&(_^=255&i.charCodeAt(b)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0};var ct=ot.exports,It=lt.exports;Ye.exports=ct,Ye.exports.murmur3=ct,Ye.exports.murmur2=It;var Ot=Ye.exports;class Rt{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,a,h,_){this.ids.push(ii(t)),this.positions.push(a,h,_)}getPositions(t){const a=ii(t);let h=0,_=this.ids.length-1;for(;h<_;){const S=h+_>>1;this.ids[S]>=a?_=S:h=S+1}const b=[];for(;this.ids[h]===a;)b.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return b}static serialize(t,a){const h=new Float64Array(t.ids),_=new Uint32Array(t.positions);return gi(h,_,0,h.length-1),a&&a.push(h.buffer,_.buffer),{ids:h,positions:_}}static deserialize(t){const a=new Rt;return a.ids=t.ids,a.positions=t.positions,a.indexed=!0,a}}function ii(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Ot(String(i))}function gi(i,t,a,h){for(;a<h;){const _=i[a+h>>1];let b=a-1,S=h+1;for(;;){do b++;while(i[b]<_);do S--;while(i[S]>_);if(b>=S)break;Ii(i,b,S),Ii(t,3*b,3*S),Ii(t,3*b+1,3*S+1),Ii(t,3*b+2,3*S+2)}S-a<h-S?(gi(i,t,a,S),a=S+1):(gi(i,t,S+1,h),h=S)}}function Ii(i,t,a){const h=i[t];i[t]=i[a],i[a]=h}ti("FeaturePositionMap",Rt);class yi{constructor(t,a){this.gl=t.gl,this.location=a}}class lr extends yi{constructor(t,a){super(t,a),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class si extends yi{constructor(t,a){super(t,a),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class ji extends yi{constructor(t,a){super(t,a),this.current=W.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const ir=new Float32Array(16);function Oi(i){return[Pe(255*i.r,255*i.g),Pe(255*i.b,255*i.a)]}class Di{constructor(t,a,h){this.value=t,this.uniformNames=a.map(_=>`u_${_}`),this.type=h}setUniform(t,a,h){t.set(h.constantOr(this.value))}getBinding(t,a,h){return this.type==="color"?new ji(t,a):new lr(t,a)}}class Zi{constructor(t,a){this.uniformNames=a.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=t.tlbr}setUniform(t,a,h,_){const b=_==="u_pattern_to"?this.patternTo:_==="u_pattern_from"?this.patternFrom:_==="u_pixel_ratio_to"?this.pixelRatioTo:_==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&t.set(b)}getBinding(t,a,h){return h.substr(0,9)==="u_pattern"?new si(t,a):new lr(t,a)}}class zi{constructor(t,a,h,_){this.expression=t,this.type=h,this.maxValue=0,this.paintVertexAttributes=a.map(b=>({name:`a_${b}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,a,h,_,b){const S=this.paintVertexArray.length,P=this.expression.evaluate(new rn(0),a,{},_,[],b);this.paintVertexArray.resize(t),this._setPaintValue(S,t,P)}updatePaintArray(t,a,h,_){const b=this.expression.evaluate({zoom:0},h,_);this._setPaintValue(t,a,b)}_setPaintValue(t,a,h){if(this.type==="color"){const _=Oi(h);for(let b=t;b<a;b++)this.paintVertexArray.emplace(b,_[0],_[1])}else{for(let _=t;_<a;_++)this.paintVertexArray.emplace(_,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ei{constructor(t,a,h,_,b,S){this.expression=t,this.uniformNames=a.map(P=>`u_${P}_t`),this.type=h,this.useIntegerZoom=_,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=a.map(P=>({name:`a_${P}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(t,a,h,_,b){const S=this.expression.evaluate(new rn(this.zoom),a,{},_,[],b),P=this.expression.evaluate(new rn(this.zoom+1),a,{},_,[],b),R=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(R,t,S,P)}updatePaintArray(t,a,h,_){const b=this.expression.evaluate({zoom:this.zoom},h,_),S=this.expression.evaluate({zoom:this.zoom+1},h,_);this._setPaintValue(t,a,b,S)}_setPaintValue(t,a,h,_){if(this.type==="color"){const b=Oi(h),S=Oi(_);for(let P=t;P<a;P++)this.paintVertexArray.emplace(P,b[0],b[1],S[0],S[1])}else{for(let b=t;b<a;b++)this.paintVertexArray.emplace(b,h,_);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(_))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,a){const h=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,_=X(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);t.set(_)}getBinding(t,a,h){return new lr(t,a)}}class mn{constructor(t,a,h,_,b,S){this.expression=t,this.type=a,this.useIntegerZoom=h,this.zoom=_,this.layerId=S,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(t,a,h){const _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(_,t,a.patterns&&a.patterns[this.layerId],h)}updatePaintArray(t,a,h,_,b){this._setPaintValues(t,a,h.patterns&&h.patterns[this.layerId],b)}_setPaintValues(t,a,h,_){if(!_||!h)return;const{min:b,mid:S,max:P}=h,R=_[b],O=_[S],V=_[P];if(R&&O&&V)for(let j=t;j<a;j++)this.zoomInPaintVertexArray.emplace(j,O.tl[0],O.tl[1],O.br[0],O.br[1],R.tl[0],R.tl[1],R.br[0],R.br[1],O.pixelRatio,R.pixelRatio),this.zoomOutPaintVertexArray.emplace(j,O.tl[0],O.tl[1],O.br[0],O.br[1],V.tl[0],V.tl[1],V.br[0],V.br[1],O.pixelRatio,V.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Ve.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Ve.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Cn{constructor(t,a,h){this.binders={},this._buffers=[];const _=[];for(const b in t.paint._values){if(!h(b))continue;const S=t.paint.get(b);if(!(S instanceof ba&&as(S.property.specification)))continue;const P=To(b,t.type),R=S.value,O=S.property.specification.type,V=S.property.useIntegerZoom,j=S.property.specification["property-type"],K=j==="cross-faded"||j==="cross-faded-data-driven";if(R.kind==="constant")this.binders[b]=K?new Zi(R.value,P):new Di(R.value,P,O),_.push(`/u_${b}`);else if(R.kind==="source"||K){const $=wn(b,O,"source");this.binders[b]=K?new mn(R,O,V,a,$,t.id):new zi(R,P,O,$),_.push(`/a_${b}`)}else{const $=wn(b,O,"composite");this.binders[b]=new Ei(R,P,O,V,a,$),_.push(`/z_${b}`)}}this.cacheKey=_.sort().join("")}getMaxValue(t){const a=this.binders[t];return a instanceof zi||a instanceof Ei?a.maxValue:0}populatePaintArrays(t,a,h,_,b){for(const S in this.binders){const P=this.binders[S];(P instanceof zi||P instanceof Ei||P instanceof mn)&&P.populatePaintArray(t,a,h,_,b)}}setConstantPatternPositions(t,a){for(const h in this.binders){const _=this.binders[h];_ instanceof Zi&&_.setConstantPatternPositions(t,a)}}updatePaintArrays(t,a,h,_,b){let S=!1;for(const P in t){const R=a.getPositions(P);for(const O of R){const V=h.feature(O.index);for(const j in this.binders){const K=this.binders[j];if((K instanceof zi||K instanceof Ei||K instanceof mn)&&K.expression.isStateDependent===!0){const $=_.paint.get(j);K.expression=$.value,K.updatePaintArray(O.start,O.end,V,t[P],b),S=!0}}}}return S}defines(){const t=[];for(const a in this.binders){const h=this.binders[a];(h instanceof Di||h instanceof Zi)&&t.push(...h.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return t}getBinderAttributes(){const t=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof zi||h instanceof Ei)for(let _=0;_<h.paintVertexAttributes.length;_++)t.push(h.paintVertexAttributes[_].name);else if(h instanceof mn)for(let _=0;_<Ve.members.length;_++)t.push(Ve.members[_].name)}return t}getBinderUniforms(){const t=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof Di||h instanceof Zi||h instanceof Ei)for(const _ of h.uniformNames)t.push(_)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,a){const h=[];for(const _ in this.binders){const b=this.binders[_];if(b instanceof Di||b instanceof Zi||b instanceof Ei){for(const S of b.uniformNames)if(a[S]){const P=b.getBinding(t,a[S],S);h.push({name:S,property:_,binding:P})}}}return h}setUniforms(t,a,h,_){for(const{name:b,property:S,binding:P}of a)this.binders[S].setUniform(P,_,h.get(S),b)}updatePaintBuffers(t){this._buffers=[];for(const a in this.binders){const h=this.binders[a];if(t&&h instanceof mn){const _=t.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(h instanceof zi||h instanceof Ei)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(t){for(const a in this.binders){const h=this.binders[a];(h instanceof zi||h instanceof Ei||h instanceof mn)&&h.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const a=this.binders[t];(a instanceof zi||a instanceof Ei||a instanceof mn)&&a.destroy()}}}class Fn{constructor(t,a,h=()=>!0){this.programConfigurations={};for(const _ of t)this.programConfigurations[_.id]=new Cn(_,a,h);this.needsUpload=!1,this._featureMap=new Rt,this._bufferOffset=0}populatePaintArrays(t,a,h,_,b,S){for(const P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(t,a,_,b,S);a.id!==void 0&&this._featureMap.add(a.id,h,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,a,h,_){for(const b of h)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(t,this._featureMap,a,b,_)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function To(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function wn(i,t,a){const h={color:{source:g,composite:$e},number:{source:we,composite:g}},_=function(b){return{"line-pattern":{source:B,composite:B},"fill-pattern":{source:B,composite:B},"fill-extrusion-pattern":{source:B,composite:B}}[b]}(i);return _&&_[a]||h[t][a]}ti("ConstantBinder",Di),ti("CrossFadedConstantBinder",Zi),ti("SourceExpressionBinder",zi),ti("CrossFadedCompositeBinder",mn),ti("CompositeExpressionBinder",Ei),ti("ProgramConfiguration",Cn,{omit:["_buffers"]}),ti("ProgramConfigurationSet",Fn);var hr=8192;const Jo=Math.pow(2,14)-1,qo=-Jo-1;function wa(i){const t=hr/i.extent,a=i.loadGeometry();for(let h=0;h<a.length;h++){const _=a[h];for(let b=0;b<_.length;b++){const S=_[b],P=Math.round(S.x*t),R=Math.round(S.y*t);S.x=X(P,qo,Jo),S.y=X(R,qo,Jo),(P<S.x||P>S.x+1||R<S.y||R>S.y+1)&&ut("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function ro(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?wa(i):[]}}function Ea(i,t,a,h,_){i.emplaceBack(2*t+(h+1)/2,2*a+(_+1)/2)}class Sa{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new m,this.indexArray=new me,this.segments=new be,this.programConfigurations=new Fn(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){const _=this.layers[0],b=[];let S=null,P=!1;_.type==="circle"&&(S=_.layout.get("circle-sort-key"),P=!S.isConstant());for(const{feature:R,id:O,index:V,sourceLayerIndex:j}of t){const K=this.layers[0]._featureFilter.needGeometry,$=ro(R,K);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),$,h))continue;const Q=P?S.evaluate($,{},h):void 0,se={id:O,properties:R.properties,type:R.type,sourceLayerIndex:j,index:V,geometry:K?$.geometry:wa(R),patterns:{},sortKey:Q};b.push(se)}P&&b.sort((R,O)=>R.sortKey-O.sortKey);for(const R of b){const{geometry:O,index:V,sourceLayerIndex:j}=R,K=t[V].feature;this.addFeature(R,O,V,h),a.featureIndex.insert(K,O,V,j,this.index)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Be),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,h,_){for(const b of a)for(const S of b){const P=S.x,R=S.y;if(P<0||P>=hr||R<0||R>=hr)continue;const O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),V=O.vertexLength;Ea(this.layoutVertexArray,P,R,-1,-1),Ea(this.layoutVertexArray,P,R,1,-1),Ea(this.layoutVertexArray,P,R,1,1),Ea(this.layoutVertexArray,P,R,-1,1),this.indexArray.emplaceBack(V,V+1,V+2),this.indexArray.emplaceBack(V,V+3,V+2),O.vertexLength+=4,O.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,{},_)}}function Lu(i,t){for(let a=0;a<i.length;a++)if(Ia(t,i[a]))return!0;for(let a=0;a<t.length;a++)if(Ia(i,t[a]))return!0;return!!nu(i,t)}function Du(i,t,a){return!!Ia(i,t)||!!ou(t,i,a)}function rl(i,t){if(i.length===1)return no(t,i[0]);for(let a=0;a<t.length;a++){const h=t[a];for(let _=0;_<h.length;_++)if(Ia(i,h[_]))return!0}for(let a=0;a<i.length;a++)if(no(t,i[a]))return!0;for(let a=0;a<t.length;a++)if(nu(i,t[a]))return!0;return!1}function Ru(i,t,a){if(i.length>1){if(nu(i,t))return!0;for(let h=0;h<t.length;h++)if(ou(t[h],i,a))return!0}for(let h=0;h<i.length;h++)if(ou(i[h],t,a))return!0;return!1}function nu(i,t){if(i.length===0||t.length===0)return!1;for(let a=0;a<i.length-1;a++){const h=i[a],_=i[a+1];for(let b=0;b<t.length-1;b++)if(Rs(h,_,t[b],t[b+1]))return!0}return!1}function Rs(i,t,a,h){return ht(i,a,h)!==ht(t,a,h)&&ht(i,t,a)!==ht(i,t,h)}function ou(i,t,a){const h=a*a;if(t.length===1)return i.distSqr(t[0])<h;for(let _=1;_<t.length;_++)if(gs(i,t[_-1],t[_])<h)return!0;return!1}function gs(i,t,a){const h=t.distSqr(a);if(h===0)return i.distSqr(t);const _=((i.x-t.x)*(a.x-t.x)+(i.y-t.y)*(a.y-t.y))/h;return i.distSqr(_<0?t:_>1?a:a.sub(t)._mult(_)._add(t))}function no(i,t){let a,h,_,b=!1;for(let S=0;S<i.length;S++){a=i[S];for(let P=0,R=a.length-1;P<a.length;R=P++)h=a[P],_=a[R],h.y>t.y!=_.y>t.y&&t.x<(_.x-h.x)*(t.y-h.y)/(_.y-h.y)+h.x&&(b=!b)}return b}function Ia(i,t){let a=!1;for(let h=0,_=i.length-1;h<i.length;_=h++){const b=i[h],S=i[_];b.y>t.y!=S.y>t.y&&t.x<(S.x-b.x)*(t.y-b.y)/(S.y-b.y)+b.x&&(a=!a)}return a}function Cl(i,t,a){const h=a[0],_=a[2];if(i.x<h.x&&t.x<h.x||i.x>_.x&&t.x>_.x||i.y<h.y&&t.y<h.y||i.y>_.y&&t.y>_.y)return!1;const b=ht(i,t,a[0]);return b!==ht(i,t,a[1])||b!==ht(i,t,a[2])||b!==ht(i,t,a[3])}function _s(i,t,a){const h=t.paint.get(i).value;return h.kind==="constant"?h.value:a.programConfigurations.get(t.id).getMaxValue(i)}function Sr(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Yo(i,t,a,h,_){if(!t[0]&&!t[1])return i;const b=bt.convert(t)._mult(_);a==="viewport"&&b._rotate(-h);const S=[];for(let P=0;P<i.length;P++)S.push(i[P].sub(b));return S}ti("CircleBucket",Sa,{omit:["layers"]});const fa=new fn({"circle-sort-key":new Vt(qe.layout_circle["circle-sort-key"])});var au={paint:new fn({"circle-radius":new Vt(qe.paint_circle["circle-radius"]),"circle-color":new Vt(qe.paint_circle["circle-color"]),"circle-blur":new Vt(qe.paint_circle["circle-blur"]),"circle-opacity":new Vt(qe.paint_circle["circle-opacity"]),"circle-translate":new ci(qe.paint_circle["circle-translate"]),"circle-translate-anchor":new ci(qe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ci(qe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ci(qe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Vt(qe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Vt(qe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Vt(qe.paint_circle["circle-stroke-opacity"])}),layout:fa},Bu=typeof Float32Array!="undefined"?Float32Array:Array;function Ou(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function ip(i,t,a){var h=t[0],_=t[1],b=t[2],S=t[3],P=t[4],R=t[5],O=t[6],V=t[7],j=t[8],K=t[9],$=t[10],Q=t[11],se=t[12],pe=t[13],ke=t[14],Ne=t[15],Ze=a[0],He=a[1],it=a[2],We=a[3];return i[0]=Ze*h+He*P+it*j+We*se,i[1]=Ze*_+He*R+it*K+We*pe,i[2]=Ze*b+He*O+it*$+We*ke,i[3]=Ze*S+He*V+it*Q+We*Ne,i[4]=(Ze=a[4])*h+(He=a[5])*P+(it=a[6])*j+(We=a[7])*se,i[5]=Ze*_+He*R+it*K+We*pe,i[6]=Ze*b+He*O+it*$+We*ke,i[7]=Ze*S+He*V+it*Q+We*Ne,i[8]=(Ze=a[8])*h+(He=a[9])*P+(it=a[10])*j+(We=a[11])*se,i[9]=Ze*_+He*R+it*K+We*pe,i[10]=Ze*b+He*O+it*$+We*ke,i[11]=Ze*S+He*V+it*Q+We*Ne,i[12]=(Ze=a[12])*h+(He=a[13])*P+(it=a[14])*j+(We=a[15])*se,i[13]=Ze*_+He*R+it*K+We*pe,i[14]=Ze*b+He*O+it*$+We*ke,i[15]=Ze*S+He*V+it*Q+We*Ne,i}Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});var nl,rp=ip;function ol(i,t,a){var h=t[0],_=t[1],b=t[2],S=t[3];return i[0]=a[0]*h+a[4]*_+a[8]*b+a[12]*S,i[1]=a[1]*h+a[5]*_+a[9]*b+a[13]*S,i[2]=a[2]*h+a[6]*_+a[10]*b+a[14]*S,i[3]=a[3]*h+a[7]*_+a[11]*b+a[15]*S,i}function dc(i,t){const a=ol([],[i.x,i.y,0,1],t);return new bt(a[0]/a[3],a[1]/a[3])}nl=new Bu(4),Bu!=Float32Array&&(nl[0]=0,nl[1]=0,nl[2]=0,nl[3]=0);class np extends Sa{}ti("HeatmapBucket",np,{omit:["layers"]});var fc={paint:new fn({"heatmap-radius":new Vt(qe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Vt(qe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ci(qe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Vn(qe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ci(qe.paint_heatmap["heatmap-opacity"])})};function $o(i,{width:t,height:a},h,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==t*a*h)throw new RangeError(`mismatched image size. expected: ${_.length} but got: ${t*a*h}`)}else _=new Uint8Array(t*a*h);return i.width=t,i.height=a,i.data=_,i}function Gd(i,{width:t,height:a},h){if(t===i.width&&a===i.height)return;const _=$o({},{width:t,height:a},h);op(i,_,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,a)},h),i.width=t,i.height=a,i.data=_.data}function op(i,t,a,h,_,b){if(_.width===0||_.height===0)return t;if(_.width>i.width||_.height>i.height||a.x>i.width-_.width||a.y>i.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>t.width||_.height>t.height||h.x>t.width-_.width||h.y>t.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const S=i.data,P=t.data;for(let R=0;R<_.height;R++){const O=((a.y+R)*i.width+a.x)*b,V=((h.y+R)*t.width+h.x)*b;for(let j=0;j<_.width*b;j++)P[V+j]=S[O+j]}return t}class wh{constructor(t,a){$o(this,t,1,a)}resize(t){Gd(this,t,1)}clone(){return new wh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,h,_,b){op(t,a,h,_,b,1)}}class vs{constructor(t,a){$o(this,t,4,a)}resize(t){Gd(this,t,4)}replace(t,a){a?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new vs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,h,_,b){op(t,a,h,_,b,4)}}function Zd(i){const t={},a=i.resolution||256,h=i.clips?i.clips.length:1,_=i.image||new vs({width:a,height:h}),b=(S,P,R)=>{t[i.evaluationKey]=R;const O=i.expression.evaluate(t);_.data[S+P+0]=Math.floor(255*O.r/O.a),_.data[S+P+1]=Math.floor(255*O.g/O.a),_.data[S+P+2]=Math.floor(255*O.b/O.a),_.data[S+P+3]=Math.floor(255*O.a)};if(i.clips)for(let S=0,P=0;S<h;++S,P+=4*a)for(let R=0,O=0;R<a;R++,O+=4){const V=R/(a-1),{start:j,end:K}=i.clips[S];b(P,O,j*(1-V)+K*V)}else for(let S=0,P=0;S<a;S++,P+=4)b(0,P,S/(a-1));return _}ti("AlphaImage",wh),ti("RGBAImage",vs);var bm={paint:new fn({"hillshade-illumination-direction":new ci(qe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ci(qe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ci(qe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ci(qe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ci(qe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ci(qe.paint_hillshade["hillshade-accent-color"])})};const Kp=Xt([{name:"a_pos",components:2,type:"Int16"}],4),{members:wm}=Kp;var Vc={exports:{}};function Eh(i,t,a){a=a||2;var h,_,b,S,P,R,O,V=t&&t.length,j=V?t[0]*a:i.length,K=su(i,0,j,a,!0),$=[];if(!K||K.next===K.prev)return $;if(V&&(K=function(se,pe,ke,Ne){var Ze,He,it,We=[];for(Ze=0,He=pe.length;Ze<He;Ze++)(it=su(se,pe[Ze]*Ne,Ze<He-1?pe[Ze+1]*Ne:se.length,Ne,!1))===it.next&&(it.steiner=!0),We.push(qc(it));for(We.sort(Am),Ze=0;Ze<We.length;Ze++)ke=Bs(ke=Cm(We[Ze],ke),ke.next);return ke}(i,t,K,a)),i.length>80*a){h=b=i[0],_=S=i[1];for(var Q=a;Q<j;Q+=a)(P=i[Q])<h&&(h=P),(R=i[Q+1])<_&&(_=R),P>b&&(b=P),R>S&&(S=R);O=(O=Math.max(b-h,S-_))!==0?1/O:0}return Sh(K,$,a,h,_,O),$}function su(i,t,a,h,_){var b,S;if(_===Qp(i,t,a,h)>0)for(b=t;b<a;b+=h)S=Hc(b,i[b],i[b+1],S);else for(b=a-h;b>=t;b-=h)S=Hc(b,i[b],i[b+1],S);return S&&Ih(S,S.next)&&(yc(S),S=S.next),S}function Bs(i,t){if(!i)return i;t||(t=i);var a,h=i;do if(a=!1,h.steiner||!Ih(h,h.next)&&Pn(h.prev,h,h.next)!==0)h=h.next;else{if(yc(h),(h=t=h.prev)===h.next)break;a=!0}while(a||h!==t);return t}function Sh(i,t,a,h,_,b,S){if(i){!S&&b&&function(V,j,K,$){var Q=V;do Q.z===null&&(Q.z=Yp(Q.x,Q.y,j,K,$)),Q.prevZ=Q.prev,Q.nextZ=Q.next,Q=Q.next;while(Q!==V);Q.prevZ.nextZ=null,Q.prevZ=null,function(se){var pe,ke,Ne,Ze,He,it,We,kt,At=1;do{for(ke=se,se=null,He=null,it=0;ke;){for(it++,Ne=ke,We=0,pe=0;pe<At&&(We++,Ne=Ne.nextZ);pe++);for(kt=At;We>0||kt>0&&Ne;)We!==0&&(kt===0||!Ne||ke.z<=Ne.z)?(Ze=ke,ke=ke.nextZ,We--):(Ze=Ne,Ne=Ne.nextZ,kt--),He?He.nextZ=Ze:se=Ze,Ze.prevZ=He,He=Ze;ke=Ne}He.nextZ=null,At*=2}while(it>1)}(Q)}(i,h,_,b);for(var P,R,O=i;i.prev!==i.next;)if(P=i.prev,R=i.next,b?Sm(i,h,_,b):Em(i))t.push(P.i/a),t.push(i.i/a),t.push(R.i/a),yc(i),i=R.next,O=R.next;else if((i=R)===O){S?S===1?Sh(i=Im(Bs(i),t,a),t,a,h,_,b,2):S===2&&Tm(i,t,a,h,_,b):Sh(Bs(i),t,a,h,_,b,1);break}}}function Em(i){var t=i.prev,a=i,h=i.next;if(Pn(t,a,h)>=0)return!1;for(var _=i.next.next;_!==i.prev;){if(Gc(t.x,t.y,a.x,a.y,h.x,h.y,_.x,_.y)&&Pn(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function Sm(i,t,a,h){var _=i.prev,b=i,S=i.next;if(Pn(_,b,S)>=0)return!1;for(var P=_.x>b.x?_.x>S.x?_.x:S.x:b.x>S.x?b.x:S.x,R=_.y>b.y?_.y>S.y?_.y:S.y:b.y>S.y?b.y:S.y,O=Yp(_.x<b.x?_.x<S.x?_.x:S.x:b.x<S.x?b.x:S.x,_.y<b.y?_.y<S.y?_.y:S.y:b.y<S.y?b.y:S.y,t,a,h),V=Yp(P,R,t,a,h),j=i.prevZ,K=i.nextZ;j&&j.z>=O&&K&&K.z<=V;){if(j!==i.prev&&j!==i.next&&Gc(_.x,_.y,b.x,b.y,S.x,S.y,j.x,j.y)&&Pn(j.prev,j,j.next)>=0||(j=j.prevZ,K!==i.prev&&K!==i.next&&Gc(_.x,_.y,b.x,b.y,S.x,S.y,K.x,K.y)&&Pn(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;j&&j.z>=O;){if(j!==i.prev&&j!==i.next&&Gc(_.x,_.y,b.x,b.y,S.x,S.y,j.x,j.y)&&Pn(j.prev,j,j.next)>=0)return!1;j=j.prevZ}for(;K&&K.z<=V;){if(K!==i.prev&&K!==i.next&&Gc(_.x,_.y,b.x,b.y,S.x,S.y,K.x,K.y)&&Pn(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function Im(i,t,a){var h=i;do{var _=h.prev,b=h.next.next;!Ih(_,b)&&Th(_,h,h.next,b)&&Zc(_,b)&&Zc(b,_)&&(t.push(_.i/a),t.push(h.i/a),t.push(b.i/a),yc(h),yc(h.next),h=i=b),h=h.next}while(h!==i);return Bs(h)}function Tm(i,t,a,h,_,b){var S=i;do{for(var P=S.next.next;P!==S.prev;){if(S.i!==P.i&&oo(S,P)){var R=$p(S,P);return S=Bs(S,S.next),R=Bs(R,R.next),Sh(S,t,a,h,_,b),void Sh(R,t,a,h,_,b)}P=P.next}S=S.next}while(S!==i)}function Am(i,t){return i.x-t.x}function Cm(i,t){var a=function(b,S){var P,R=S,O=b.x,V=b.y,j=-1/0;do{if(V<=R.y&&V>=R.next.y&&R.next.y!==R.y){var K=R.x+(V-R.y)*(R.next.x-R.x)/(R.next.y-R.y);if(K<=O&&K>j){if(j=K,K===O){if(V===R.y)return R;if(V===R.next.y)return R.next}P=R.x<R.next.x?R:R.next}}R=R.next}while(R!==S);if(!P)return null;if(O===j)return P;var $,Q=P,se=P.x,pe=P.y,ke=1/0;R=P;do O>=R.x&&R.x>=se&&O!==R.x&&Gc(V<pe?O:j,V,se,pe,V<pe?j:O,V,R.x,R.y)&&($=Math.abs(V-R.y)/(O-R.x),Zc(R,b)&&($<ke||$===ke&&(R.x>P.x||R.x===P.x&&Jp(P,R)))&&(P=R,ke=$)),R=R.next;while(R!==Q);return P}(i,t);if(!a)return t;var h=$p(a,i),_=Bs(a,a.next);return Bs(h,h.next),t===a?_:t}function Jp(i,t){return Pn(i.prev,i,t.prev)<0&&Pn(t.next,i,i.next)<0}function Yp(i,t,a,h,_){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-a)*_)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-h)*_)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function qc(i){var t=i,a=i;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==i);return a}function Gc(i,t,a,h,_,b,S,P){return(_-S)*(t-P)-(i-S)*(b-P)>=0&&(i-S)*(h-P)-(a-S)*(t-P)>=0&&(a-S)*(b-P)-(_-S)*(h-P)>=0}function oo(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(a,h){var _=a;do{if(_.i!==a.i&&_.next.i!==a.i&&_.i!==h.i&&_.next.i!==h.i&&Th(_,_.next,a,h))return!0;_=_.next}while(_!==a);return!1}(i,t)&&(Zc(i,t)&&Zc(t,i)&&function(a,h){var _=a,b=!1,S=(a.x+h.x)/2,P=(a.y+h.y)/2;do _.y>P!=_.next.y>P&&_.next.y!==_.y&&S<(_.next.x-_.x)*(P-_.y)/(_.next.y-_.y)+_.x&&(b=!b),_=_.next;while(_!==a);return b}(i,t)&&(Pn(i.prev,i,t.prev)||Pn(i,t.prev,t))||Ih(i,t)&&Pn(i.prev,i,i.next)>0&&Pn(t.prev,t,t.next)>0)}function Pn(i,t,a){return(t.y-i.y)*(a.x-t.x)-(t.x-i.x)*(a.y-t.y)}function Ih(i,t){return i.x===t.x&&i.y===t.y}function Th(i,t,a,h){var _=Fu(Pn(i,t,a)),b=Fu(Pn(i,t,h)),S=Fu(Pn(a,h,i)),P=Fu(Pn(a,h,t));return _!==b&&S!==P||!(_!==0||!mc(i,a,t))||!(b!==0||!mc(i,h,t))||!(S!==0||!mc(a,i,h))||!(P!==0||!mc(a,t,h))}function mc(i,t,a){return t.x<=Math.max(i.x,a.x)&&t.x>=Math.min(i.x,a.x)&&t.y<=Math.max(i.y,a.y)&&t.y>=Math.min(i.y,a.y)}function Fu(i){return i>0?1:i<0?-1:0}function Zc(i,t){return Pn(i.prev,i,i.next)<0?Pn(i,t,i.next)>=0&&Pn(i,i.prev,t)>=0:Pn(i,t,i.prev)<0||Pn(i,i.next,t)<0}function $p(i,t){var a=new Ah(i.i,i.x,i.y),h=new Ah(t.i,t.x,t.y),_=i.next,b=t.prev;return i.next=t,t.prev=i,a.next=_,_.prev=a,h.next=a,a.prev=h,b.next=h,h.prev=b,h}function Hc(i,t,a,h){var _=new Ah(i,t,a);return h?(_.next=h.next,_.prev=h,h.next.prev=_,h.next=_):(_.prev=_,_.next=_),_}function yc(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Ah(i,t,a){this.i=i,this.x=t,this.y=a,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qp(i,t,a,h){for(var _=0,b=t,S=a-h;b<a;b+=h)_+=(i[S]-i[b])*(i[b+1]+i[S+1]),S=b;return _}Vc.exports=Eh,Vc.exports.default=Eh,Eh.deviation=function(i,t,a,h){var _=t&&t.length,b=Math.abs(Qp(i,0,_?t[0]*a:i.length,a));if(_)for(var S=0,P=t.length;S<P;S++)b-=Math.abs(Qp(i,t[S]*a,S<P-1?t[S+1]*a:i.length,a));var R=0;for(S=0;S<h.length;S+=3){var O=h[S]*a,V=h[S+1]*a,j=h[S+2]*a;R+=Math.abs((i[O]-i[j])*(i[V+1]-i[O+1])-(i[O]-i[V])*(i[j+1]-i[O+1]))}return b===0&&R===0?0:Math.abs((R-b)/b)},Eh.flatten=function(i){for(var t=i[0][0].length,a={vertices:[],holes:[],dimensions:t},h=0,_=0;_<i.length;_++){for(var b=0;b<i[_].length;b++)for(var S=0;S<t;S++)a.vertices.push(i[_][b][S]);_>0&&a.holes.push(h+=i[_-1].length)}return a};var Wc=Vc.exports;function km(i,t,a,h,_){ap(i,t,a||0,h||i.length-1,_||ed)}function ap(i,t,a,h,_){for(;h>a;){if(h-a>600){var b=h-a+1,S=t-a+1,P=Math.log(b),R=.5*Math.exp(2*P/3),O=.5*Math.sqrt(P*R*(b-R)/b)*(S-b/2<0?-1:1);ap(i,t,Math.max(a,Math.floor(t-S*R/b+O)),Math.min(h,Math.floor(t+(b-S)*R/b+O)),_)}var V=i[t],j=a,K=h;for(Ch(i,a,t),_(i[h],V)>0&&Ch(i,a,h);j<K;){for(Ch(i,j,K),j++,K--;_(i[j],V)<0;)j++;for(;_(i[K],V)>0;)K--}_(i[a],V)===0?Ch(i,a,K):Ch(i,++K,h),K<=t&&(a=K+1),t<=K&&(h=K-1)}}function Ch(i,t,a){var h=i[t];i[t]=i[a],i[a]=h}function ed(i,t){return i<t?-1:i>t?1:0}function kh(i,t){const a=i.length;if(a<=1)return[i];const h=[];let _,b;for(let S=0;S<a;S++){const P=at(i[S]);P!==0&&(i[S].area=Math.abs(P),b===void 0&&(b=P<0),b===P<0?(_&&h.push(_),_=[i[S]]):_.push(i[S]))}if(_&&h.push(_),t>1)for(let S=0;S<h.length;S++)h[S].length<=t||(km(h[S],t,1,h[S].length-1,al),h[S]=h[S].slice(0,t));return h}function al(i,t){return t.area-i.area}function td(i,t,a){const h=a.patternDependencies;let _=!1;for(const b of t){const S=b.paint.get(`${i}-pattern`);S.isConstant()||(_=!0);const P=S.constantOr(null);P&&(_=!0,h[P.to]=!0,h[P.from]=!0)}return _}function id(i,t,a,h,_){const b=_.patternDependencies;for(const S of t){const P=S.paint.get(`${i}-pattern`).value;if(P.kind!=="constant"){let R=P.evaluate({zoom:h-1},a,{},_.availableImages),O=P.evaluate({zoom:h},a,{},_.availableImages),V=P.evaluate({zoom:h+1},a,{},_.availableImages);R=R&&R.name?R.name:R,O=O&&O.name?O.name:O,V=V&&V.name?V.name:V,b[R]=!0,b[O]=!0,b[V]=!0,a.patterns[S.id]={min:R,mid:O,max:V}}}return a}class rd{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new d,this.indexArray=new me,this.indexArray2=new ze,this.programConfigurations=new Fn(t.layers,t.zoom),this.segments=new be,this.segments2=new be,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){this.hasPattern=td("fill",this.layers,a);const _=this.layers[0].layout.get("fill-sort-key"),b=!_.isConstant(),S=[];for(const{feature:P,id:R,index:O,sourceLayerIndex:V}of t){const j=this.layers[0]._featureFilter.needGeometry,K=ro(P,j);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),K,h))continue;const $=b?_.evaluate(K,{},h,a.availableImages):void 0,Q={id:R,properties:P.properties,type:P.type,sourceLayerIndex:V,index:O,geometry:j?K.geometry:wa(P),patterns:{},sortKey:$};S.push(Q)}b&&S.sort((P,R)=>P.sortKey-R.sortKey);for(const P of S){const{geometry:R,index:O,sourceLayerIndex:V}=P;if(this.hasPattern){const j=id("fill",this.layers,P,this.zoom,a);this.patternFeatures.push(j)}else this.addFeature(P,R,O,h,{});a.featureIndex.insert(t[O].feature,R,O,V,this.index)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,h)}addFeatures(t,a,h){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wm),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,a,h,_,b){for(const S of kh(a,500)){let P=0;for(const $ of S)P+=$.length;const R=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray),O=R.vertexLength,V=[],j=[];for(const $ of S){if($.length===0)continue;$!==S[0]&&j.push(V.length/2);const Q=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),se=Q.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(se+$.length-1,se),V.push($[0].x),V.push($[0].y);for(let pe=1;pe<$.length;pe++)this.layoutVertexArray.emplaceBack($[pe].x,$[pe].y),this.indexArray2.emplaceBack(se+pe-1,se+pe),V.push($[pe].x),V.push($[pe].y);Q.vertexLength+=$.length,Q.primitiveLength+=$.length}const K=Wc(V,j);for(let $=0;$<K.length;$+=3)this.indexArray.emplaceBack(O+K[$],O+K[$+1],O+K[$+2]);R.vertexLength+=P,R.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,b,_)}}ti("FillBucket",rd,{omit:["layers","patternFeatures"]});const zm=new fn({"fill-sort-key":new Vt(qe.layout_fill["fill-sort-key"])});var Hd={paint:new fn({"fill-antialias":new ci(qe.paint_fill["fill-antialias"]),"fill-opacity":new Vt(qe.paint_fill["fill-opacity"]),"fill-color":new Vt(qe.paint_fill["fill-color"]),"fill-outline-color":new Vt(qe.paint_fill["fill-outline-color"]),"fill-translate":new ci(qe.paint_fill["fill-translate"]),"fill-translate-anchor":new ci(qe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Xo(qe.paint_fill["fill-pattern"])}),layout:zm};const Xc=Xt([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),{members:Pm}=Xc;var Uu={},Wd=bt,nd=Kc;function Kc(i,t,a,h,_){this.properties={},this.extent=a,this.type=0,this._pbf=i,this._geometry=-1,this._keys=h,this._values=_,i.readFields(Mm,this,t)}function Mm(i,t,a){i==1?t.id=a.readVarint():i==2?function(h,_){for(var b=h.readVarint()+h.pos;h.pos<b;){var S=_._keys[h.readVarint()],P=_._values[h.readVarint()];_.properties[S]=P}}(a,t):i==3?t.type=a.readVarint():i==4&&(t._geometry=a.pos)}function Jc(i){for(var t,a,h=0,_=0,b=i.length,S=b-1;_<b;S=_++)h+=((a=i[S]).x-(t=i[_]).x)*(t.y+a.y);return h}Kc.types=["Unknown","Point","LineString","Polygon"],Kc.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t,a=i.readVarint()+i.pos,h=1,_=0,b=0,S=0,P=[];i.pos<a;){if(_<=0){var R=i.readVarint();h=7&R,_=R>>3}if(_--,h===1||h===2)b+=i.readSVarint(),S+=i.readSVarint(),h===1&&(t&&P.push(t),t=[]),t.push(new Wd(b,S));else{if(h!==7)throw new Error("unknown command "+h);t&&t.push(t[0].clone())}}return t&&P.push(t),P},Kc.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,a=1,h=0,_=0,b=0,S=1/0,P=-1/0,R=1/0,O=-1/0;i.pos<t;){if(h<=0){var V=i.readVarint();a=7&V,h=V>>3}if(h--,a===1||a===2)(_+=i.readSVarint())<S&&(S=_),_>P&&(P=_),(b+=i.readSVarint())<R&&(R=b),b>O&&(O=b);else if(a!==7)throw new Error("unknown command "+a)}return[S,R,P,O]},Kc.prototype.toGeoJSON=function(i,t,a){var h,_,b=this.extent*Math.pow(2,a),S=this.extent*i,P=this.extent*t,R=this.loadGeometry(),O=Kc.types[this.type];function V($){for(var Q=0;Q<$.length;Q++){var se=$[Q];$[Q]=[360*(se.x+S)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(se.y+P)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var j=[];for(h=0;h<R.length;h++)j[h]=R[h][0];V(R=j);break;case 2:for(h=0;h<R.length;h++)V(R[h]);break;case 3:for(R=function($){var Q=$.length;if(Q<=1)return[$];for(var se,pe,ke=[],Ne=0;Ne<Q;Ne++){var Ze=Jc($[Ne]);Ze!==0&&(pe===void 0&&(pe=Ze<0),pe===Ze<0?(se&&ke.push(se),se=[$[Ne]]):se.push($[Ne]))}return se&&ke.push(se),ke}(R),h=0;h<R.length;h++)for(_=0;_<R[h].length;_++)V(R[h][_])}R.length===1?R=R[0]:O="Multi"+O;var K={type:"Feature",geometry:{type:O,coordinates:R},properties:this.properties};return"id"in this&&(K.id=this.id),K};var Lm=nd,sp=Yc;function Yc(i,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(sl,this,t),this.length=this._features.length}function sl(i,t,a){i===15?t.version=a.readVarint():i===1?t.name=a.readString():i===5?t.extent=a.readVarint():i===2?t._features.push(a.pos):i===3?t._keys.push(a.readString()):i===4&&t._values.push(function(h){for(var _=null,b=h.readVarint()+h.pos;h.pos<b;){var S=h.readVarint()>>3;_=S===1?h.readString():S===2?h.readFloat():S===3?h.readDouble():S===4?h.readVarint64():S===5?h.readVarint():S===6?h.readSVarint():S===7?h.readBoolean():null}return _}(a))}Yc.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var t=this._pbf.readVarint()+this._pbf.pos;return new Lm(this._pbf,t,this.extent,this._keys,this._values)};var Dm=sp;function Rm(i,t,a){if(i===3){var h=new Dm(a,a.readVarint()+a.pos);h.length&&(t[h.name]=h)}}Uu.VectorTile=function(i,t){this.layers=i.readFields(Rm,{},t)},Uu.VectorTileFeature=nd,Uu.VectorTileLayer=sp;const Bm=Uu.VectorTileFeature.types,gc=Math.pow(2,13);function $c(i,t,a,h,_,b,S,P){i.emplaceBack(t,a,2*Math.floor(h*gc)+S,_*gc*2,b*gc*2,Math.round(P))}class od{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new x,this.indexArray=new me,this.programConfigurations=new Fn(t.layers,t.zoom),this.segments=new be,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){this.features=[],this.hasPattern=td("fill-extrusion",this.layers,a);for(const{feature:_,id:b,index:S,sourceLayerIndex:P}of t){const R=this.layers[0]._featureFilter.needGeometry,O=ro(_,R);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),O,h))continue;const V={id:b,sourceLayerIndex:P,index:S,geometry:R?O.geometry:wa(_),properties:_.properties,type:_.type,patterns:{}};this.hasPattern?this.features.push(id("fill-extrusion",this.layers,V,this.zoom,a)):this.addFeature(V,V.geometry,S,h,{}),a.featureIndex.insert(_,V.geometry,S,P,this.index,!0)}}addFeatures(t,a,h){for(const _ of this.features){const{geometry:b}=_;this.addFeature(_,b,_.index,a,h)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Pm),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,h,_,b){for(const S of kh(a,500)){let P=0;for(const $ of S)P+=$.length;let R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const $ of S){if($.length===0||Fm($))continue;let Q=0;for(let se=0;se<$.length;se++){const pe=$[se];if(se>=1){const ke=$[se-1];if(!Om(pe,ke)){R.vertexLength+4>be.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Ne=pe.sub(ke)._perp()._unit(),Ze=ke.dist(pe);Q+Ze>32768&&(Q=0),$c(this.layoutVertexArray,pe.x,pe.y,Ne.x,Ne.y,0,0,Q),$c(this.layoutVertexArray,pe.x,pe.y,Ne.x,Ne.y,0,1,Q),Q+=Ze,$c(this.layoutVertexArray,ke.x,ke.y,Ne.x,Ne.y,0,0,Q),$c(this.layoutVertexArray,ke.x,ke.y,Ne.x,Ne.y,0,1,Q);const He=R.vertexLength;this.indexArray.emplaceBack(He,He+2,He+1),this.indexArray.emplaceBack(He+1,He+2,He+3),R.vertexLength+=4,R.primitiveLength+=2}}}}if(R.vertexLength+P>be.MAX_VERTEX_ARRAY_LENGTH&&(R=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray)),Bm[t.type]!=="Polygon")continue;const O=[],V=[],j=R.vertexLength;for(const $ of S)if($.length!==0){$!==S[0]&&V.push(O.length/2);for(let Q=0;Q<$.length;Q++){const se=$[Q];$c(this.layoutVertexArray,se.x,se.y,0,0,1,1,0),O.push(se.x),O.push(se.y)}}const K=Wc(O,V);for(let $=0;$<K.length;$+=3)this.indexArray.emplaceBack(j+K[$],j+K[$+2],j+K[$+1]);R.primitiveLength+=K.length/3,R.vertexLength+=P}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,b,_)}}function Om(i,t){return i.x===t.x&&(i.x<0||i.x>hr)||i.y===t.y&&(i.y<0||i.y>hr)}function Fm(i){return i.every(t=>t.x<0)||i.every(t=>t.x>hr)||i.every(t=>t.y<0)||i.every(t=>t.y>hr)}ti("FillExtrusionBucket",od,{omit:["layers","features"]});var Um={paint:new fn({"fill-extrusion-opacity":new ci(qe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Vt(qe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ci(qe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ci(qe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Xo(qe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Vt(qe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Vt(qe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ci(qe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Qc(i,t){return i.x*t.x+i.y*t.y}function Qo(i,t){if(i.length===1){let a=0;const h=t[a++];let _;for(;!_||h.equals(_);)if(_=t[a++],!_)return 1/0;for(;a<t.length;a++){const b=t[a],S=i[0],P=_.sub(h),R=b.sub(h),O=S.sub(h),V=Qc(P,P),j=Qc(P,R),K=Qc(R,R),$=Qc(O,P),Q=Qc(O,R),se=V*K-j*j,pe=(K*$-j*Q)/se,ke=(V*Q-j*$)/se,Ne=h.z*(1-pe-ke)+_.z*pe+b.z*ke;if(isFinite(Ne))return Ne}return 1/0}{let a=1/0;for(const h of t)a=Math.min(a,h.z);return a}}const Nm=Xt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Xd}=Nm,Kd=Xt([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:jm}=Kd,Jd=Uu.VectorTileFeature.types,Vm=Math.cos(Math.PI/180*37.5),Yd=Math.pow(2,14)/.5;class ad{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new k,this.layoutVertexArray2=new D,this.indexArray=new me,this.programConfigurations=new Fn(t.layers,t.zoom),this.segments=new be,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){this.hasPattern=td("line",this.layers,a);const _=this.layers[0].layout.get("line-sort-key"),b=!_.isConstant(),S=[];for(const{feature:P,id:R,index:O,sourceLayerIndex:V}of t){const j=this.layers[0]._featureFilter.needGeometry,K=ro(P,j);if(!this.layers[0]._featureFilter.filter(new rn(this.zoom),K,h))continue;const $=b?_.evaluate(K,{},h):void 0,Q={id:R,properties:P.properties,type:P.type,sourceLayerIndex:V,index:O,geometry:j?K.geometry:wa(P),patterns:{},sortKey:$};S.push(Q)}b&&S.sort((P,R)=>P.sortKey-R.sortKey);for(const P of S){const{geometry:R,index:O,sourceLayerIndex:V}=P;if(this.hasPattern){const j=id("line",this.layers,P,this.zoom,a);this.patternFeatures.push(j)}else this.addFeature(P,R,O,h,{});a.featureIndex.insert(t[O].feature,R,O,V,this.index)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,h)}addFeatures(t,a,h){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,jm)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xd),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,a,h,_,b){const S=this.layers[0].layout,P=S.get("line-join").evaluate(t,{}),R=S.get("line-cap"),O=S.get("line-miter-limit"),V=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const j of a)this.addLine(j,t,P,R,O,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,b,_)}addLine(t,a,h,_,b,S){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ke=0;ke<t.length-1;ke++)this.totalDistance+=t[ke].dist(t[ke+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=Jd[a.type]==="Polygon";let R=t.length;for(;R>=2&&t[R-1].equals(t[R-2]);)R--;let O=0;for(;O<R-1&&t[O].equals(t[O+1]);)O++;if(R<(P?3:2))return;h==="bevel"&&(b=1.05);const V=this.overscaling<=16?122880/(512*this.overscaling):0,j=this.segments.prepareSegment(10*R,this.layoutVertexArray,this.indexArray);let K,$,Q,se,pe;this.e1=this.e2=-1,P&&(K=t[R-2],pe=t[O].sub(K)._unit()._perp());for(let ke=O;ke<R;ke++){if(Q=ke===R-1?P?t[O+1]:void 0:t[ke+1],Q&&t[ke].equals(Q))continue;pe&&(se=pe),K&&($=K),K=t[ke],pe=Q?Q.sub(K)._unit()._perp():se,se=se||pe;let Ne=se.add(pe);Ne.x===0&&Ne.y===0||Ne._unit();const Ze=se.x*pe.x+se.y*pe.y,He=Ne.x*pe.x+Ne.y*pe.y,it=He!==0?1/He:1/0,We=2*Math.sqrt(2-2*He),kt=He<Vm&&$&&Q,At=se.x*pe.y-se.y*pe.x>0;if(kt&&ke>O){const gt=K.dist($);if(gt>2*V){const Pt=K.sub(K.sub($)._mult(V/gt)._round());this.updateDistance($,Pt),this.addCurrentVertex(Pt,se,0,0,j),$=Pt}}const pt=$&&Q;let Tt=pt?h:P?"butt":_;if(pt&&Tt==="round"&&(it<S?Tt="miter":it<=2&&(Tt="fakeround")),Tt==="miter"&&it>b&&(Tt="bevel"),Tt==="bevel"&&(it>2&&(Tt="flipbevel"),it<b&&(Tt="miter")),$&&this.updateDistance($,K),Tt==="miter")Ne._mult(it),this.addCurrentVertex(K,Ne,0,0,j);else if(Tt==="flipbevel"){if(it>100)Ne=pe.mult(-1);else{const gt=it*se.add(pe).mag()/se.sub(pe).mag();Ne._perp()._mult(gt*(At?-1:1))}this.addCurrentVertex(K,Ne,0,0,j),this.addCurrentVertex(K,Ne.mult(-1),0,0,j)}else if(Tt==="bevel"||Tt==="fakeround"){const gt=-Math.sqrt(it*it-1),Pt=At?gt:0,mt=At?0:gt;if($&&this.addCurrentVertex(K,se,Pt,mt,j),Tt==="fakeround"){const vt=Math.round(180*We/Math.PI/20);for(let oi=1;oi<vt;oi++){let ri=oi/vt;if(ri!==.5){const Bi=ri-.5;ri+=ri*Bi*(ri-1)*((1.0904+Ze*(Ze*(3.55645-1.43519*Ze)-3.2452))*Bi*Bi+(.848013+Ze*(.215638*Ze-1.06021)))}const Mi=pe.sub(se)._mult(ri)._add(se)._unit()._mult(At?-1:1);this.addHalfVertex(K,Mi.x,Mi.y,!1,At,0,j)}}Q&&this.addCurrentVertex(K,pe,-Pt,-mt,j)}else if(Tt==="butt")this.addCurrentVertex(K,Ne,0,0,j);else if(Tt==="square"){const gt=$?1:-1;this.addCurrentVertex(K,Ne,gt,gt,j)}else Tt==="round"&&($&&(this.addCurrentVertex(K,se,0,0,j),this.addCurrentVertex(K,se,1,1,j,!0)),Q&&(this.addCurrentVertex(K,pe,-1,-1,j,!0),this.addCurrentVertex(K,pe,0,0,j)));if(kt&&ke<R-1){const gt=K.dist(Q);if(gt>2*V){const Pt=K.add(Q.sub(K)._mult(V/gt)._round());this.updateDistance(K,Pt),this.addCurrentVertex(Pt,pe,0,0,j),K=Pt}}}}addCurrentVertex(t,a,h,_,b,S=!1){const P=a.y*_-a.x,R=-a.y-a.x*_;this.addHalfVertex(t,a.x+a.y*h,a.y-a.x*h,S,!1,h,b),this.addHalfVertex(t,P,R,S,!0,-_,b),this.distance>Yd/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(t,a,h,_,b,S))}addHalfVertex({x:t,y:a},h,_,b,S,P,R){const O=.5*(this.lineClips?this.scaledDistance*(Yd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(b?1:0),(a<<1)+(S?1:0),Math.round(63*h)+128,Math.round(63*_)+128,1+(P===0?0:P<0?-1:1)|(63&O)<<2,O>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const V=R.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,V),R.primitiveLength++),S?this.e2=V:this.e1=V}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,a){this.distance+=t.dist(a),this.updateScaledDistance()}}ti("LineBucket",ad,{omit:["layers","patternFeatures"]});const $d=new fn({"line-cap":new ci(qe.layout_line["line-cap"]),"line-join":new Vt(qe.layout_line["line-join"]),"line-miter-limit":new ci(qe.layout_line["line-miter-limit"]),"line-round-limit":new ci(qe.layout_line["line-round-limit"]),"line-sort-key":new Vt(qe.layout_line["line-sort-key"])});var Qd={paint:new fn({"line-opacity":new Vt(qe.paint_line["line-opacity"]),"line-color":new Vt(qe.paint_line["line-color"]),"line-translate":new ci(qe.paint_line["line-translate"]),"line-translate-anchor":new ci(qe.paint_line["line-translate-anchor"]),"line-width":new Vt(qe.paint_line["line-width"]),"line-gap-width":new Vt(qe.paint_line["line-gap-width"]),"line-offset":new Vt(qe.paint_line["line-offset"]),"line-blur":new Vt(qe.paint_line["line-blur"]),"line-dasharray":new Mo(qe.paint_line["line-dasharray"]),"line-pattern":new Xo(qe.paint_line["line-pattern"]),"line-gradient":new Vn(qe.paint_line["line-gradient"])}),layout:$d};const ef=new class extends Vt{possiblyEvaluate(i,t){return t=new rn(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(i,t)}evaluate(i,t,a,h){return t=ge({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(i,t,a,h)}}(Qd.paint.properties["line-width"].specification);function eh(i,t){return t>0?t+2*i:i}ef.useIntegerZoom=!0;const tf=Xt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),rf=Xt([{name:"a_projected_pos",components:3,type:"Float32"}],4);Xt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const lp=Xt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Xt([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const nn=Xt([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),nf=Xt([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function lu(i,t,a){return i.sections.forEach(h=>{h.text=function(_,b,S){const P=b.layout.get("text-transform").evaluate(S,{});return P==="uppercase"?_=_.toLocaleUpperCase():P==="lowercase"&&(_=_.toLocaleLowerCase()),dn.applyArabicShaping&&(_=dn.applyArabicShaping(_)),_}(h.text,t,a)}),i}Xt([{name:"triangle",components:3,type:"Uint16"}]),Xt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Xt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Xt([{type:"Float32",name:"offsetX"}]),Xt([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const kl={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var Do=24,sd=un,of=function(i,t,a,h,_){var b,S,P=8*_-h-1,R=(1<<P)-1,O=R>>1,V=-7,j=a?_-1:0,K=a?-1:1,$=i[t+j];for(j+=K,b=$&(1<<-V)-1,$>>=-V,V+=P;V>0;b=256*b+i[t+j],j+=K,V-=8);for(S=b&(1<<-V)-1,b>>=-V,V+=h;V>0;S=256*S+i[t+j],j+=K,V-=8);if(b===0)b=1-O;else{if(b===R)return S?NaN:1/0*($?-1:1);S+=Math.pow(2,h),b-=O}return($?-1:1)*S*Math.pow(2,b-h)},af=function(i,t,a,h,_,b){var S,P,R,O=8*b-_-1,V=(1<<O)-1,j=V>>1,K=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=h?0:b-1,Q=h?1:-1,se=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(P=isNaN(t)?1:0,S=V):(S=Math.floor(Math.log(t)/Math.LN2),t*(R=Math.pow(2,-S))<1&&(S--,R*=2),(t+=S+j>=1?K/R:K*Math.pow(2,1-j))*R>=2&&(S++,R/=2),S+j>=V?(P=0,S=V):S+j>=1?(P=(t*R-1)*Math.pow(2,_),S+=j):(P=t*Math.pow(2,j-1)*Math.pow(2,_),S=0));_>=8;i[a+$]=255&P,$+=Q,P/=256,_-=8);for(S=S<<_|P,O+=_;O>0;i[a+$]=255&S,$+=Q,S/=256,O-=8);i[a+$-Q]|=128*se};function un(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}un.Varint=0,un.Fixed64=1,un.Bytes=2,un.Fixed32=5;var Nu,ld=4294967296,sf=1/ld,lf=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function uu(i){return i.type===un.Bytes?i.readVarint()+i.pos:i.pos+1}function cu(i,t,a){return a?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function _c(i,t,a){var h=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));a.realloc(h);for(var _=a.pos-1;_>=i;_--)a.buf[_+h]=a.buf[_]}function uf(i,t){for(var a=0;a<i.length;a++)t.writeVarint(i[a])}function qm(i,t){for(var a=0;a<i.length;a++)t.writeSVarint(i[a])}function Gm(i,t){for(var a=0;a<i.length;a++)t.writeFloat(i[a])}function Zm(i,t){for(var a=0;a<i.length;a++)t.writeDouble(i[a])}function cf(i,t){for(var a=0;a<i.length;a++)t.writeBoolean(i[a])}function up(i,t){for(var a=0;a<i.length;a++)t.writeFixed32(i[a])}function zh(i,t){for(var a=0;a<i.length;a++)t.writeSFixed32(i[a])}function Ph(i,t){for(var a=0;a<i.length;a++)t.writeFixed64(i[a])}function Ja(i,t){for(var a=0;a<i.length;a++)t.writeSFixed64(i[a])}function hu(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+16777216*i[t+3]}function ao(i,t,a){i[a]=t,i[a+1]=t>>>8,i[a+2]=t>>>16,i[a+3]=t>>>24}function Mh(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+(i[t+3]<<24)}function cp(i,t,a){i===1&&a.readMessage(La,t)}function La(i,t,a){if(i===3){const{id:h,bitmap:_,width:b,height:S,left:P,top:R,advance:O}=a.readMessage(hf,{});t.push({id:h,bitmap:new wh({width:b+6,height:S+6},_),metrics:{width:b,height:S,left:P,top:R,advance:O}})}}function hf(i,t,a){i===1?t.id=a.readVarint():i===2?t.bitmap=a.readBytes():i===3?t.width=a.readVarint():i===4?t.height=a.readVarint():i===5?t.left=a.readSVarint():i===6?t.top=a.readSVarint():i===7&&(t.advance=a.readVarint())}function ud(i){let t=0,a=0;for(const S of i)t+=S.w*S.h,a=Math.max(a,S.w);i.sort((S,P)=>P.h-S.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),a),h:1/0}];let _=0,b=0;for(const S of i)for(let P=h.length-1;P>=0;P--){const R=h[P];if(!(S.w>R.w||S.h>R.h)){if(S.x=R.x,S.y=R.y,b=Math.max(b,S.y+S.h),_=Math.max(_,S.x+S.w),S.w===R.w&&S.h===R.h){const O=h.pop();P<h.length&&(h[P]=O)}else S.h===R.h?(R.x+=S.w,R.w-=S.w):S.w===R.w?(R.y+=S.h,R.h-=S.h):(h.push({x:R.x+S.w,y:R.y,w:R.w-S.w,h:S.h}),R.y+=S.h,R.h-=S.h);break}}return{w:_,h:b,fill:t/(_*b)||0}}un.prototype={destroy:function(){this.buf=null},readFields:function(i,t,a){for(a=a||this.length;this.pos<a;){var h=this.readVarint(),_=h>>3,b=this.pos;this.type=7&h,i(_,t,this),this.pos===b&&this.skip(h)}return t},readMessage:function(i,t){return this.readFields(i,t,this.readVarint()+this.pos)},readFixed32:function(){var i=hu(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Mh(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=hu(this.buf,this.pos)+hu(this.buf,this.pos+4)*ld;return this.pos+=8,i},readSFixed64:function(){var i=hu(this.buf,this.pos)+Mh(this.buf,this.pos+4)*ld;return this.pos+=8,i},readFloat:function(){var i=of(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=of(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var t,a,h=this.buf;return t=127&(a=h[this.pos++]),a<128?t:(t|=(127&(a=h[this.pos++]))<<7,a<128?t:(t|=(127&(a=h[this.pos++]))<<14,a<128?t:(t|=(127&(a=h[this.pos++]))<<21,a<128?t:function(_,b,S){var P,R,O=S.buf;if(P=(112&(R=O[S.pos++]))>>4,R<128||(P|=(127&(R=O[S.pos++]))<<3,R<128)||(P|=(127&(R=O[S.pos++]))<<10,R<128)||(P|=(127&(R=O[S.pos++]))<<17,R<128)||(P|=(127&(R=O[S.pos++]))<<24,R<128)||(P|=(1&(R=O[S.pos++]))<<31,R<128))return cu(_,P,b);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(a=h[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var i=this.readVarint()+this.pos,t=this.pos;return this.pos=i,i-t>=12&&lf?function(a,h,_){return lf.decode(a.subarray(h,_))}(this.buf,t,i):function(a,h,_){for(var b="",S=h;S<_;){var P,R,O,V=a[S],j=null,K=V>239?4:V>223?3:V>191?2:1;if(S+K>_)break;K===1?V<128&&(j=V):K===2?(192&(P=a[S+1]))==128&&(j=(31&V)<<6|63&P)<=127&&(j=null):K===3?(R=a[S+2],(192&(P=a[S+1]))==128&&(192&R)==128&&((j=(15&V)<<12|(63&P)<<6|63&R)<=2047||j>=55296&&j<=57343)&&(j=null)):K===4&&(R=a[S+2],O=a[S+3],(192&(P=a[S+1]))==128&&(192&R)==128&&(192&O)==128&&((j=(15&V)<<18|(63&P)<<12|(63&R)<<6|63&O)<=65535||j>=1114112)&&(j=null)),j===null?(j=65533,K=1):j>65535&&(j-=65536,b+=String.fromCharCode(j>>>10&1023|55296),j=56320|1023&j),b+=String.fromCharCode(j),S+=K}return b}(this.buf,t,i)},readBytes:function(){var i=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,i);return this.pos=i,t},readPackedVarint:function(i,t){if(this.type!==un.Bytes)return i.push(this.readVarint(t));var a=uu(this);for(i=i||[];this.pos<a;)i.push(this.readVarint(t));return i},readPackedSVarint:function(i){if(this.type!==un.Bytes)return i.push(this.readSVarint());var t=uu(this);for(i=i||[];this.pos<t;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==un.Bytes)return i.push(this.readBoolean());var t=uu(this);for(i=i||[];this.pos<t;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==un.Bytes)return i.push(this.readFloat());var t=uu(this);for(i=i||[];this.pos<t;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==un.Bytes)return i.push(this.readDouble());var t=uu(this);for(i=i||[];this.pos<t;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==un.Bytes)return i.push(this.readFixed32());var t=uu(this);for(i=i||[];this.pos<t;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==un.Bytes)return i.push(this.readSFixed32());var t=uu(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==un.Bytes)return i.push(this.readFixed64());var t=uu(this);for(i=i||[];this.pos<t;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==un.Bytes)return i.push(this.readSFixed64());var t=uu(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed64());return i},skip:function(i){var t=7&i;if(t===un.Varint)for(;this.buf[this.pos++]>127;);else if(t===un.Bytes)this.pos=this.readVarint()+this.pos;else if(t===un.Fixed32)this.pos+=4;else{if(t!==un.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(i,t){this.writeVarint(i<<3|t)},realloc:function(i){for(var t=this.length||16;t<this.pos+i;)t*=2;if(t!==this.length){var a=new Uint8Array(t);a.set(this.buf),this.buf=a,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),ao(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),ao(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),ao(this.buf,-1&i,this.pos),ao(this.buf,Math.floor(i*sf),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),ao(this.buf,-1&i,this.pos),ao(this.buf,Math.floor(i*sf),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(t,a){var h,_;if(t>=0?(h=t%4294967296|0,_=t/4294967296|0):(_=~(-t/4294967296),4294967295^(h=~(-t%4294967296))?h=h+1|0:(h=0,_=_+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),function(b,S,P){P.buf[P.pos++]=127&b|128,b>>>=7,P.buf[P.pos++]=127&b|128,b>>>=7,P.buf[P.pos++]=127&b|128,b>>>=7,P.buf[P.pos++]=127&b|128,P.buf[P.pos]=127&(b>>>=7)}(h,0,a),function(b,S){var P=(7&b)<<4;S.buf[S.pos++]|=P|((b>>>=3)?128:0),b&&(S.buf[S.pos++]=127&b|((b>>>=7)?128:0),b&&(S.buf[S.pos++]=127&b|((b>>>=7)?128:0),b&&(S.buf[S.pos++]=127&b|((b>>>=7)?128:0),b&&(S.buf[S.pos++]=127&b|((b>>>=7)?128:0),b&&(S.buf[S.pos++]=127&b)))))}(_,a)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(Boolean(i))},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var t=this.pos;this.pos=function(h,_,b){for(var S,P,R=0;R<_.length;R++){if((S=_.charCodeAt(R))>55295&&S<57344){if(!P){S>56319||R+1===_.length?(h[b++]=239,h[b++]=191,h[b++]=189):P=S;continue}if(S<56320){h[b++]=239,h[b++]=191,h[b++]=189,P=S;continue}S=P-55296<<10|S-56320|65536,P=null}else P&&(h[b++]=239,h[b++]=191,h[b++]=189,P=null);S<128?h[b++]=S:(S<2048?h[b++]=S>>6|192:(S<65536?h[b++]=S>>12|224:(h[b++]=S>>18|240,h[b++]=S>>12&63|128),h[b++]=S>>6&63|128),h[b++]=63&S|128)}return b}(this.buf,i,this.pos);var a=this.pos-t;a>=128&&_c(t,a,this),this.pos=t-1,this.writeVarint(a),this.pos+=a},writeFloat:function(i){this.realloc(4),af(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),af(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var t=i.length;this.writeVarint(t),this.realloc(t);for(var a=0;a<t;a++)this.buf[this.pos++]=i[a]},writeRawMessage:function(i,t){this.pos++;var a=this.pos;i(t,this);var h=this.pos-a;h>=128&&_c(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h},writeMessage:function(i,t,a){this.writeTag(i,un.Bytes),this.writeRawMessage(t,a)},writePackedVarint:function(i,t){t.length&&this.writeMessage(i,uf,t)},writePackedSVarint:function(i,t){t.length&&this.writeMessage(i,qm,t)},writePackedBoolean:function(i,t){t.length&&this.writeMessage(i,cf,t)},writePackedFloat:function(i,t){t.length&&this.writeMessage(i,Gm,t)},writePackedDouble:function(i,t){t.length&&this.writeMessage(i,Zm,t)},writePackedFixed32:function(i,t){t.length&&this.writeMessage(i,up,t)},writePackedSFixed32:function(i,t){t.length&&this.writeMessage(i,zh,t)},writePackedFixed64:function(i,t){t.length&&this.writeMessage(i,Ph,t)},writePackedSFixed64:function(i,t){t.length&&this.writeMessage(i,Ja,t)},writeBytesField:function(i,t){this.writeTag(i,un.Bytes),this.writeBytes(t)},writeFixed32Field:function(i,t){this.writeTag(i,un.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(i,t){this.writeTag(i,un.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(i,t){this.writeTag(i,un.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(i,t){this.writeTag(i,un.Fixed64),this.writeSFixed64(t)},writeVarintField:function(i,t){this.writeTag(i,un.Varint),this.writeVarint(t)},writeSVarintField:function(i,t){this.writeTag(i,un.Varint),this.writeSVarint(t)},writeStringField:function(i,t){this.writeTag(i,un.Bytes),this.writeString(t)},writeFloatField:function(i,t){this.writeTag(i,un.Fixed32),this.writeFloat(t)},writeDoubleField:function(i,t){this.writeTag(i,un.Fixed64),this.writeDouble(t)},writeBooleanField:function(i,t){this.writeVarintField(i,Boolean(t))}};class cd{constructor(t,{pixelRatio:a,version:h,stretchX:_,stretchY:b,content:S}){this.paddedRect=t,this.pixelRatio=a,this.stretchX=_,this.stretchY=b,this.content=S,this.version=h}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class hd{constructor(t,a){const h={},_={};this.haveRenderCallbacks=[];const b=[];this.addImages(t,h,b),this.addImages(a,_,b);const{w:S,h:P}=ud(b),R=new vs({width:S||1,height:P||1});for(const O in t){const V=t[O],j=h[O].paddedRect;vs.copy(V.data,R,{x:0,y:0},{x:j.x+1,y:j.y+1},V.data)}for(const O in a){const V=a[O],j=_[O].paddedRect,K=j.x+1,$=j.y+1,Q=V.data.width,se=V.data.height;vs.copy(V.data,R,{x:0,y:0},{x:K,y:$},V.data),vs.copy(V.data,R,{x:0,y:se-1},{x:K,y:$-1},{width:Q,height:1}),vs.copy(V.data,R,{x:0,y:0},{x:K,y:$+se},{width:Q,height:1}),vs.copy(V.data,R,{x:Q-1,y:0},{x:K-1,y:$},{width:1,height:se}),vs.copy(V.data,R,{x:0,y:0},{x:K+Q,y:$},{width:1,height:se})}this.image=R,this.iconPositions=h,this.patternPositions=_}addImages(t,a,h){for(const _ in t){const b=t[_],S={x:0,y:0,w:b.data.width+2,h:b.data.height+2};h.push(S),a[_]=new cd(S,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(t,a){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in t.updatedImages)this.patchUpdatedImage(this.iconPositions[h],t.getImage(h),a),this.patchUpdatedImage(this.patternPositions[h],t.getImage(h),a)}patchUpdatedImage(t,a,h){if(!t||!a||t.version===a.version)return;t.version=a.version;const[_,b]=t.tl;h.update(a.data,void 0,{x:_,y:b})}}ti("ImagePosition",cd),ti("ImageAtlas",hd),p.WritingMode=void 0,(Nu=p.WritingMode||(p.WritingMode={}))[Nu.none=0]="none",Nu[Nu.horizontal=1]="horizontal",Nu[Nu.vertical=2]="vertical",Nu[Nu.horizontalOnly=3]="horizontalOnly";const th=-17;class vc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,a){const h=new vc;return h.scale=t||1,h.fontStack=a,h}static forImage(t){const a=new vc;return a.imageName=t,a}}class ih{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,a){const h=new ih;for(let _=0;_<t.sections.length;_++){const b=t.sections[_];b.image?h.addImageSection(b):h.addTextSection(b,a)}return h}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let a="";for(let h=0;h<t.length;h++){const _=t.charCodeAt(h+1)||null,b=t.charCodeAt(h-1)||null;a+=_&&Il(_)&&!kl[t[h+1]]||b&&Il(b)&&!kl[t[h-1]]||!kl[t[h]]?t[h]:kl[t[h]]}return a}(this.text)}trim(){let t=0;for(let h=0;h<this.text.length&&pu[this.text.charCodeAt(h)];h++)t++;let a=this.text.length;for(let h=this.text.length-1;h>=0&&h>=t&&pu[this.text.charCodeAt(h)];h--)a--;this.text=this.text.substring(t,a),this.sectionIndex=this.sectionIndex.slice(t,a)}substring(t,a){const h=new ih;return h.text=this.text.substring(t,a),h.sectionIndex=this.sectionIndex.slice(t,a),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,a)=>Math.max(t,this.sections[a].scale),0)}addTextSection(t,a){this.text+=t.text,this.sections.push(vc.forText(t.scale,t.fontStack||a));const h=this.sections.length-1;for(let _=0;_<t.text.length;++_)this.sectionIndex.push(h)}addImageSection(t){const a=t.image?t.image.name:"";if(a.length===0)return void ut("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(vc.forImage(a)),this.sectionIndex.push(this.sections.length-1)):ut("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Lh(i,t,a,h,_,b,S,P,R,O,V,j,K,$,Q,se){const pe=ih.fromFeature(i,_);let ke;j===p.WritingMode.vertical&&pe.verticalizePunctuation();const{processBidirectionalText:Ne,processStyledBidirectionalText:Ze}=dn;if(Ne&&pe.sections.length===1){ke=[];const We=Ne(pe.toString(),hp(pe,O,b,t,h,$,Q));for(const kt of We){const At=new ih;At.text=kt,At.sections=pe.sections;for(let pt=0;pt<kt.length;pt++)At.sectionIndex.push(0);ke.push(At)}}else if(Ze){ke=[];const We=Ze(pe.text,pe.sectionIndex,hp(pe,O,b,t,h,$,Q));for(const kt of We){const At=new ih;At.text=kt[0],At.sectionIndex=kt[1],At.sections=pe.sections,ke.push(At)}}else ke=function(We,kt){const At=[],pt=We.text;let Tt=0;for(const gt of kt)At.push(We.substring(Tt,gt)),Tt=gt;return Tt<pt.length&&At.push(We.substring(Tt,pt.length)),At}(pe,hp(pe,O,b,t,h,$,Q));const He=[],it={positionedLines:He,text:pe.toString(),top:V[1],bottom:V[1],left:V[0],right:V[0],writingMode:j,iconsInText:!1,verticalizable:!1};return function(We,kt,At,pt,Tt,gt,Pt,mt,vt,oi,ri,Mi){let Bi=0,Qi=th,ur=0,kr=0;const zr=mt==="right"?1:mt==="left"?0:.5;let xr=0;for(const Ki of Tt){Ki.trim();const er=Ki.getMaxScale(),Hi=(er-1)*Do,on={positionedGlyphs:[],lineOffset:0};We.positionedLines[xr]=on;const en=on.positionedGlyphs;let dr=0;if(!Ki.length()){Qi+=gt,++xr;continue}for(let Lr=0;Lr<Ki.length();Lr++){const fi=Ki.getSection(Lr),lo=Ki.getSectionIndex(Lr),cn=Ki.getCharCode(Lr);let Mn=0,Wr=null,Ro=null,_o=null,Ya=Do;const ea=!(vt===p.WritingMode.horizontal||!ri&&!pn(cn)||ri&&(pu[cn]||(Br=cn,ai.Arabic(Br)||ai["Arabic Supplement"](Br)||ai["Arabic Extended-A"](Br)||ai["Arabic Presentation Forms-A"](Br)||ai["Arabic Presentation Forms-B"](Br))));if(fi.imageName){const ta=pt[fi.imageName];if(!ta)continue;_o=fi.imageName,We.iconsInText=We.iconsInText||!0,Ro=ta.paddedRect;const uo=ta.displaySize;fi.scale=fi.scale*Do/Mi,Wr={width:uo[0],height:uo[1],left:1,top:-3,advance:ea?uo[1]:uo[0]},Mn=Hi+(Do-uo[1]*fi.scale),Ya=Wr.advance;const $a=ea?uo[0]*fi.scale-Do*er:uo[1]*fi.scale-Do*er;$a>0&&$a>dr&&(dr=$a)}else{const ta=At[fi.fontStack],uo=ta&&ta[cn];if(uo&&uo.rect)Ro=uo.rect,Wr=uo.metrics;else{const $a=kt[fi.fontStack],Wu=$a&&$a[cn];if(!Wu)continue;Wr=Wu.metrics}Mn=(er-fi.scale)*Do}ea?(We.verticalizable=!0,en.push({glyph:cn,imageName:_o,x:Bi,y:Qi+Mn,vertical:ea,scale:fi.scale,fontStack:fi.fontStack,sectionIndex:lo,metrics:Wr,rect:Ro}),Bi+=Ya*fi.scale+oi):(en.push({glyph:cn,imageName:_o,x:Bi,y:Qi+Mn,vertical:ea,scale:fi.scale,fontStack:fi.fontStack,sectionIndex:lo,metrics:Wr,rect:Ro}),Bi+=Wr.advance*fi.scale+oi)}en.length!==0&&(ur=Math.max(Bi-oi,ur),Wm(en,0,en.length-1,zr,dr)),Bi=0;const sr=gt*er+dr;on.lineOffset=Math.max(dr,Hi),Qi+=sr,kr=Math.max(sr,kr),++xr}var Br;const br=Qi-th,{horizontalAlign:Or,verticalAlign:Vi}=pp(Pt);(function(Ki,er,Hi,on,en,dr,sr,Lr,fi){const lo=(er-Hi)*en;let cn=0;cn=dr!==sr?-Lr*on-th:(-on*fi+.5)*sr;for(const Mn of Ki)for(const Wr of Mn.positionedGlyphs)Wr.x+=lo,Wr.y+=cn})(We.positionedLines,zr,Or,Vi,ur,kr,gt,br,Tt.length),We.top+=-Vi*br,We.bottom=We.top+br,We.left+=-Or*ur,We.right=We.left+ur}(it,t,a,h,ke,S,P,R,j,O,K,se),!function(We){for(const kt of We)if(kt.positionedGlyphs.length!==0)return!1;return!0}(He)&&it}const pu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},pd={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function dd(i,t,a,h,_,b){if(t.imageName){const S=h[t.imageName];return S?S.displaySize[0]*t.scale*Do/b+_:0}{const S=a[t.fontStack],P=S&&S[i];return P?P.metrics.advance*t.scale+_:0}}function fd(i,t,a,h){const _=Math.pow(i-t,2);return h?i<t?_/2:2*_:_+Math.abs(a)*a}function Hm(i,t,a){let h=0;return i===10&&(h-=1e4),a&&(h+=150),i!==40&&i!==65288||(h+=50),t!==41&&t!==65289||(h+=50),h}function md(i,t,a,h,_,b){let S=null,P=fd(t,a,_,b);for(const R of h){const O=fd(t-R.x,a,_,b)+R.badness;O<=P&&(S=R,P=O)}return{index:i,x:t,priorBreak:S,badness:P}}function yd(i){return i?yd(i.priorBreak).concat(i.index):[]}function hp(i,t,a,h,_,b,S){if(b!=="point")return[];if(!i)return[];const P=[],R=function(K,$,Q,se,pe,ke){let Ne=0;for(let Ze=0;Ze<K.length();Ze++){const He=K.getSection(Ze);Ne+=dd(K.getCharCode(Ze),He,se,pe,$,ke)}return Ne/Math.max(1,Math.ceil(Ne/Q))}(i,t,a,h,_,S),O=i.text.indexOf("\u200B")>=0;let V=0;for(let K=0;K<i.length();K++){const $=i.getSection(K),Q=i.getCharCode(K);if(pu[Q]||(V+=dd(Q,$,h,_,t,S)),K<i.length()-1){const se=!((j=Q)<11904||!(ai["Bopomofo Extended"](j)||ai.Bopomofo(j)||ai["CJK Compatibility Forms"](j)||ai["CJK Compatibility Ideographs"](j)||ai["CJK Compatibility"](j)||ai["CJK Radicals Supplement"](j)||ai["CJK Strokes"](j)||ai["CJK Symbols and Punctuation"](j)||ai["CJK Unified Ideographs Extension A"](j)||ai["CJK Unified Ideographs"](j)||ai["Enclosed CJK Letters and Months"](j)||ai["Halfwidth and Fullwidth Forms"](j)||ai.Hiragana(j)||ai["Ideographic Description Characters"](j)||ai["Kangxi Radicals"](j)||ai["Katakana Phonetic Extensions"](j)||ai.Katakana(j)||ai["Vertical Forms"](j)||ai["Yi Radicals"](j)||ai["Yi Syllables"](j)));(pd[Q]||se||$.imageName)&&P.push(md(K+1,V,R,P,Hm(Q,i.getCharCode(K+1),se&&O),!1))}}var j;return yd(md(i.length(),V,R,P,0,!0))}function pp(i){let t=.5,a=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function Wm(i,t,a,h,_){if(!h&&!_)return;const b=i[a],S=(i[a].x+b.metrics.advance*b.scale)*h;for(let P=t;P<=a;P++)i[P].x-=S,i[P].y+=_}function Xm(i,t,a){const{horizontalAlign:h,verticalAlign:_}=pp(a),b=t[0]-i.displaySize[0]*h,S=t[1]-i.displaySize[1]*_;return{image:i,top:S,bottom:S+i.displaySize[1],left:b,right:b+i.displaySize[0]}}function gd(i,t,a,h,_,b){const S=i.image;let P;if(S.content){const pe=S.content,ke=S.pixelRatio||1;P=[pe[0]/ke,pe[1]/ke,S.displaySize[0]-pe[2]/ke,S.displaySize[1]-pe[3]/ke]}const R=t.left*b,O=t.right*b;let V,j,K,$;a==="width"||a==="both"?($=_[0]+R-h[3],j=_[0]+O+h[1]):($=_[0]+(R+O-S.displaySize[0])/2,j=$+S.displaySize[0]);const Q=t.top*b,se=t.bottom*b;return a==="height"||a==="both"?(V=_[1]+Q-h[0],K=_[1]+se+h[2]):(V=_[1]+(Q+se-S.displaySize[1])/2,K=V+S.displaySize[1]),{image:S,top:V,right:j,bottom:K,left:$,collisionPadding:P}}const zl=128;function Dh(i,t){const{expression:a}=t;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new rn(i+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:_}=a;let b=0;for(;b<h.length&&h[b]<=i;)b++;b=Math.max(0,b-1);let S=b;for(;S<h.length&&h[S]<i+1;)S++;S=Math.min(h.length-1,S);const P=h[b],R=h[S];return a.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:R,interpolationType:_}:{kind:"camera",minZoom:P,maxZoom:R,minSize:a.evaluate(new rn(P)),maxSize:a.evaluate(new rn(R)),interpolationType:_}}}class du extends bt{constructor(t,a,h,_){super(t,a),this.angle=h,_!==void 0&&(this.segment=_)}clone(){return new du(this.x,this.y,this.angle,this.segment)}}function Rh(i,t,a,h,_){if(t.segment===void 0)return!0;let b=t,S=t.segment+1,P=0;for(;P>-a/2;){if(S--,S<0)return!1;P-=i[S].dist(b),b=i[S]}P+=i[S].dist(i[S+1]),S++;const R=[];let O=0;for(;P<a/2;){const V=i[S],j=i[S+1];if(!j)return!1;let K=i[S-1].angleTo(V)-V.angleTo(j);for(K=Math.abs((K+3*Math.PI)%(2*Math.PI)-Math.PI),R.push({distance:P,angleDelta:K}),O+=K;P-R[0].distance>h;)O-=R.shift().angleDelta;if(O>_)return!1;S++,P+=V.dist(j)}return!0}function Bh(i){let t=0;for(let a=0;a<i.length-1;a++)t+=i[a].dist(i[a+1]);return t}function Oh(i,t,a){return i?.6*t*a:0}function xc(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function Km(i,t,a,h,_,b){const S=Oh(a,_,b),P=xc(a,h)*b;let R=0;const O=Bh(i)/2;for(let V=0;V<i.length-1;V++){const j=i[V],K=i[V+1],$=j.dist(K);if(R+$>O){const Q=(O-R)/$,se=jn(j.x,K.x,Q),pe=jn(j.y,K.y,Q),ke=new du(se,pe,K.angleTo(j),V);return ke._round(),!S||Rh(i,ke,P,S,t)?ke:void 0}R+=$}}function Jm(i,t,a,h,_,b,S,P,R){const O=Oh(h,b,S),V=xc(h,_),j=V*S,K=i[0].x===0||i[0].x===R||i[0].y===0||i[0].y===R;return t-j<t/4&&(t=j+t/4),pf(i,K?t/2*P%t:(V/2+2*b)*S*P%t,t,O,a,j,K,!1,R)}function pf(i,t,a,h,_,b,S,P,R){const O=b/2,V=Bh(i);let j=0,K=t-a,$=[];for(let Q=0;Q<i.length-1;Q++){const se=i[Q],pe=i[Q+1],ke=se.dist(pe),Ne=pe.angleTo(se);for(;K+a<j+ke;){K+=a;const Ze=(K-j)/ke,He=jn(se.x,pe.x,Ze),it=jn(se.y,pe.y,Ze);if(He>=0&&He<R&&it>=0&&it<R&&K-O>=0&&K+O<=V){const We=new du(He,it,Ne,Q);We._round(),h&&!Rh(i,We,b,h,_)||$.push(We)}}j+=ke}return P||$.length||S||($=pf(i,j/2,a,h,_,b,S,!0,R)),$}function bc(i,t,a,h,_){const b=[];for(let S=0;S<i.length;S++){const P=i[S];let R;for(let O=0;O<P.length-1;O++){let V=P[O],j=P[O+1];V.x<t&&j.x<t||(V.x<t?V=new bt(t,V.y+(t-V.x)/(j.x-V.x)*(j.y-V.y))._round():j.x<t&&(j=new bt(t,V.y+(t-V.x)/(j.x-V.x)*(j.y-V.y))._round()),V.y<a&&j.y<a||(V.y<a?V=new bt(V.x+(a-V.y)/(j.y-V.y)*(j.x-V.x),a)._round():j.y<a&&(j=new bt(V.x+(a-V.y)/(j.y-V.y)*(j.x-V.x),a)._round()),V.x>=h&&j.x>=h||(V.x>=h?V=new bt(h,V.y+(h-V.x)/(j.x-V.x)*(j.y-V.y))._round():j.x>=h&&(j=new bt(h,V.y+(h-V.x)/(j.x-V.x)*(j.y-V.y))._round()),V.y>=_&&j.y>=_||(V.y>=_?V=new bt(V.x+(_-V.y)/(j.y-V.y)*(j.x-V.x),_)._round():j.y>=_&&(j=new bt(V.x+(_-V.y)/(j.y-V.y)*(j.x-V.x),_)._round()),R&&V.equals(R[R.length-1])||(R=[V],b.push(R)),R.push(j)))))}}return b}function dp(i,t,a,h){const _=[],b=i.image,S=b.pixelRatio,P=b.paddedRect.w-2,R=b.paddedRect.h-2,O=i.right-i.left,V=i.bottom-i.top,j=b.stretchX||[[0,P]],K=b.stretchY||[[0,R]],$=(gt,Pt)=>gt+Pt[1]-Pt[0],Q=j.reduce($,0),se=K.reduce($,0),pe=P-Q,ke=R-se;let Ne=0,Ze=Q,He=0,it=se,We=0,kt=pe,At=0,pt=ke;if(b.content&&h){const gt=b.content;Ne=Fh(j,0,gt[0]),He=Fh(K,0,gt[1]),Ze=Fh(j,gt[0],gt[2]),it=Fh(K,gt[1],gt[3]),We=gt[0]-Ne,At=gt[1]-He,kt=gt[2]-gt[0]-Ze,pt=gt[3]-gt[1]-it}const Tt=(gt,Pt,mt,vt)=>{const oi=Uh(gt.stretch-Ne,Ze,O,i.left),ri=Nh(gt.fixed-We,kt,gt.stretch,Q),Mi=Uh(Pt.stretch-He,it,V,i.top),Bi=Nh(Pt.fixed-At,pt,Pt.stretch,se),Qi=Uh(mt.stretch-Ne,Ze,O,i.left),ur=Nh(mt.fixed-We,kt,mt.stretch,Q),kr=Uh(vt.stretch-He,it,V,i.top),zr=Nh(vt.fixed-At,pt,vt.stretch,se),xr=new bt(oi,Mi),Br=new bt(Qi,Mi),br=new bt(Qi,kr),Or=new bt(oi,kr),Vi=new bt(ri/S,Bi/S),Ki=new bt(ur/S,zr/S),er=t*Math.PI/180;if(er){const en=Math.sin(er),dr=Math.cos(er),sr=[dr,-en,en,dr];xr._matMult(sr),Br._matMult(sr),Or._matMult(sr),br._matMult(sr)}const Hi=gt.stretch+gt.fixed,on=Pt.stretch+Pt.fixed;return{tl:xr,tr:Br,bl:Or,br,tex:{x:b.paddedRect.x+1+Hi,y:b.paddedRect.y+1+on,w:mt.stretch+mt.fixed-Hi,h:vt.stretch+vt.fixed-on},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Vi,pixelOffsetBR:Ki,minFontScaleX:kt/S/O,minFontScaleY:pt/S/V,isSDF:a}};if(h&&(b.stretchX||b.stretchY)){const gt=fp(j,pe,Q),Pt=fp(K,ke,se);for(let mt=0;mt<gt.length-1;mt++){const vt=gt[mt],oi=gt[mt+1];for(let ri=0;ri<Pt.length-1;ri++)_.push(Tt(vt,Pt[ri],oi,Pt[ri+1]))}}else _.push(Tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:R+1}));return _}function Fh(i,t,a){let h=0;for(const _ of i)h+=Math.max(t,Math.min(a,_[1]))-Math.max(t,Math.min(a,_[0]));return h}function fp(i,t,a){const h=[{fixed:-1,stretch:0}];for(const[_,b]of i){const S=h[h.length-1];h.push({fixed:_-S.stretch,stretch:S.stretch}),h.push({fixed:_-S.stretch,stretch:S.stretch+(b-_)})}return h.push({fixed:t+1,stretch:a}),h}function Uh(i,t,a,h){return i/t*a+h}function Nh(i,t,a,h){return i-t*a/h}ti("Anchor",du);class mp{constructor(t,a,h,_,b,S,P,R,O,V){if(this.boxStartIndex=t.length,O){let j=S.top,K=S.bottom;const $=S.collisionPadding;$&&(j-=$[1],K+=$[3]);let Q=K-j;Q>0&&(Q=Math.max(10,Q),this.circleDiameter=Q)}else{let j=S.top*P-R,K=S.bottom*P+R,$=S.left*P-R,Q=S.right*P+R;const se=S.collisionPadding;if(se&&($-=se[0]*P,j-=se[1]*P,Q+=se[2]*P,K+=se[3]*P),V){const pe=new bt($,j),ke=new bt(Q,j),Ne=new bt($,K),Ze=new bt(Q,K),He=V*Math.PI/180;pe._rotate(He),ke._rotate(He),Ne._rotate(He),Ze._rotate(He),$=Math.min(pe.x,ke.x,Ne.x,Ze.x),Q=Math.max(pe.x,ke.x,Ne.x,Ze.x),j=Math.min(pe.y,ke.y,Ne.y,Ze.y),K=Math.max(pe.y,ke.y,Ne.y,Ze.y)}t.emplaceBack(a.x,a.y,$,j,Q,K,h,_,b)}this.boxEndIndex=t.length}}class Ym{constructor(t=[],a=$m){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:a,compare:h}=this,_=a[t];for(;t>0;){const b=t-1>>1,S=a[b];if(h(_,S)>=0)break;a[t]=S,t=b}a[t]=_}_down(t){const{data:a,compare:h}=this,_=this.length>>1,b=a[t];for(;t<_;){let S=1+(t<<1),P=a[S];const R=S+1;if(R<this.length&&h(a[R],P)<0&&(S=R,P=a[R]),h(P,b)>=0)break;a[t]=P,t=S}a[t]=b}}function $m(i,t){return i<t?-1:i>t?1:0}function yp(i,t=1,a=!1){let h=1/0,_=1/0,b=-1/0,S=-1/0;const P=i[0];for(let $=0;$<P.length;$++){const Q=P[$];(!$||Q.x<h)&&(h=Q.x),(!$||Q.y<_)&&(_=Q.y),(!$||Q.x>b)&&(b=Q.x),(!$||Q.y>S)&&(S=Q.y)}const R=Math.min(b-h,S-_);let O=R/2;const V=new Ym([],_d);if(R===0)return new bt(h,_);for(let $=h;$<b;$+=R)for(let Q=_;Q<S;Q+=R)V.push(new rh($+O,Q+O,O,i));let j=function($){let Q=0,se=0,pe=0;const ke=$[0];for(let Ne=0,Ze=ke.length,He=Ze-1;Ne<Ze;He=Ne++){const it=ke[Ne],We=ke[He],kt=it.x*We.y-We.x*it.y;se+=(it.x+We.x)*kt,pe+=(it.y+We.y)*kt,Q+=3*kt}return new rh(se/Q,pe/Q,0,$)}(i),K=V.length;for(;V.length;){const $=V.pop();($.d>j.d||!j.d)&&(j=$,a&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,K)),$.max-j.d<=t||(O=$.h/2,V.push(new rh($.p.x-O,$.p.y-O,O,i)),V.push(new rh($.p.x+O,$.p.y-O,O,i)),V.push(new rh($.p.x-O,$.p.y+O,O,i)),V.push(new rh($.p.x+O,$.p.y+O,O,i)),K+=4)}return a&&(console.log(`num probes: ${K}`),console.log(`best distance: ${j.d}`)),j.p}function _d(i,t){return t.max-i.max}function rh(i,t,a,h){this.p=new bt(i,t),this.h=a,this.d=function(_,b){let S=!1,P=1/0;for(let R=0;R<b.length;R++){const O=b[R];for(let V=0,j=O.length,K=j-1;V<j;K=V++){const $=O[V],Q=O[K];$.y>_.y!=Q.y>_.y&&_.x<(Q.x-$.x)*(_.y-$.y)/(Q.y-$.y)+$.x&&(S=!S),P=Math.min(P,gs(_,$,Q))}}return(S?1:-1)*Math.sqrt(P)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}const ju=Number.POSITIVE_INFINITY;function nh(i,t){return t[1]!==ju?function(a,h,_){let b=0,S=0;switch(h=Math.abs(h),_=Math.abs(_),a){case"top-right":case"top-left":case"top":S=_-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-_}switch(a){case"top-right":case"bottom-right":case"right":b=-h;break;case"top-left":case"bottom-left":case"left":b=h}return[b,S]}(i,t[0],t[1]):function(a,h){let _=0,b=0;h<0&&(h=0);const S=h/Math.sqrt(2);switch(a){case"top-right":case"top-left":b=S-7;break;case"bottom-right":case"bottom-left":b=7-S;break;case"bottom":b=7-h;break;case"top":b=h-7}switch(a){case"top-right":case"bottom-right":_=-S;break;case"top-left":case"bottom-left":_=S;break;case"left":_=h;break;case"right":_=-h}return[_,b]}(i,t[0])}function Hr(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Qm(i,t,a,h,_,b,S,P,R,O,V){let j=b.textMaxSize.evaluate(t,{});j===void 0&&(j=S);const K=i.layers[0].layout,$=K.get("icon-offset").evaluate(t,{},V),Q=df(a.horizontal),se=S/24,pe=i.tilePixelRatio*se,ke=i.tilePixelRatio*j/24,Ne=i.tilePixelRatio*P,Ze=i.tilePixelRatio*K.get("symbol-spacing"),He=K.get("text-padding")*i.tilePixelRatio,it=K.get("icon-padding")*i.tilePixelRatio,We=K.get("text-max-angle")/180*Math.PI,kt=K.get("text-rotation-alignment")!=="viewport"&&K.get("symbol-placement")!=="point",At=K.get("icon-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",pt=K.get("symbol-placement"),Tt=Ze/2,gt=K.get("icon-text-fit");let Pt;h&&gt!=="none"&&(i.allowVerticalPlacement&&a.vertical&&(Pt=gd(h,a.vertical,gt,K.get("icon-text-fit-padding"),$,se)),Q&&(h=gd(h,Q,gt,K.get("icon-text-fit-padding"),$,se)));const mt=(vt,oi)=>{oi.x<0||oi.x>=hr||oi.y<0||oi.y>=hr||function(ri,Mi,Bi,Qi,ur,kr,zr,xr,Br,br,Or,Vi,Ki,er,Hi,on,en,dr,sr,Lr,fi,lo,cn,Mn,Wr){const Ro=ri.addToLineVertexArray(Mi,Bi);let _o,Ya,ea,ta,uo=0,$a=0,Wu=0,Ic=0,Tc=-1,lh=-1;const Fs={};let Ml=Ot(""),Ac=0,Xu=0;if(xr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Ac,Xu]=xr.layout.get("text-offset").evaluate(fi,{},Mn).map(ia=>ia*Do):(Ac=xr.layout.get("text-radial-offset").evaluate(fi,{},Mn)*Do,Xu=ju),ri.allowVerticalPlacement&&Qi.vertical){const ia=xr.layout.get("text-rotate").evaluate(fi,{},Mn)+90;ea=new mp(Br,Mi,br,Or,Vi,Qi.vertical,Ki,er,Hi,ia),zr&&(ta=new mp(Br,Mi,br,Or,Vi,zr,en,dr,Hi,ia))}if(ur){const ia=xr.layout.get("icon-rotate").evaluate(fi,{}),Ra=xr.layout.get("icon-text-fit")!=="none",yu=dp(ur,ia,cn,Ra),ll=zr?dp(zr,ia,cn,Ra):void 0;Ya=new mp(Br,Mi,br,Or,Vi,ur,en,dr,!1,ia),uo=4*yu.length;const ch=ri.iconSizeData;let Us=null;ch.kind==="source"?(Us=[zl*xr.layout.get("icon-size").evaluate(fi,{})],Us[0]>Pl&&ut(`${ri.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):ch.kind==="composite"&&(Us=[zl*lo.compositeIconSizes[0].evaluate(fi,{},Mn),zl*lo.compositeIconSizes[1].evaluate(fi,{},Mn)],(Us[0]>Pl||Us[1]>Pl)&&ut(`${ri.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),ri.addSymbols(ri.icon,yu,Us,Lr,sr,fi,p.WritingMode.none,Mi,Ro.lineStartIndex,Ro.lineLength,-1,Mn),Tc=ri.icon.placedSymbolArray.length-1,ll&&($a=4*ll.length,ri.addSymbols(ri.icon,ll,Us,Lr,sr,fi,p.WritingMode.vertical,Mi,Ro.lineStartIndex,Ro.lineLength,-1,Mn),lh=ri.icon.placedSymbolArray.length-1)}const mu=Object.keys(Qi.horizontal);for(const ia of mu){const Ra=Qi.horizontal[ia];if(!_o){Ml=Ot(Ra.text);const ll=xr.layout.get("text-rotate").evaluate(fi,{},Mn);_o=new mp(Br,Mi,br,Or,Vi,Ra,Ki,er,Hi,ll)}const yu=Ra.positionedLines.length===1;if(Wu+=wc(ri,Mi,Ra,kr,xr,Hi,fi,on,Ro,Qi.vertical?p.WritingMode.horizontal:p.WritingMode.horizontalOnly,yu?mu:[ia],Fs,Tc,lo,Mn),yu)break}Qi.vertical&&(Ic+=wc(ri,Mi,Qi.vertical,kr,xr,Hi,fi,on,Ro,p.WritingMode.vertical,["vertical"],Fs,lh,lo,Mn));const uh=_o?_o.boxStartIndex:ri.collisionBoxArray.length,wp=_o?_o.boxEndIndex:ri.collisionBoxArray.length,Ep=ea?ea.boxStartIndex:ri.collisionBoxArray.length,Vh=ea?ea.boxEndIndex:ri.collisionBoxArray.length,qh=Ya?Ya.boxStartIndex:ri.collisionBoxArray.length,Sp=Ya?Ya.boxEndIndex:ri.collisionBoxArray.length,Gh=ta?ta.boxStartIndex:ri.collisionBoxArray.length,Zh=ta?ta.boxEndIndex:ri.collisionBoxArray.length;let Da=-1;const Cc=(ia,Ra)=>ia&&ia.circleDiameter?Math.max(ia.circleDiameter,Ra):Ra;Da=Cc(_o,Da),Da=Cc(ea,Da),Da=Cc(Ya,Da),Da=Cc(ta,Da);const kc=Da>-1?1:0;kc&&(Da*=Wr/Do),ri.glyphOffsetArray.length>=Ec.MAX_GLYPHS&&ut("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),fi.sortKey!==void 0&&ri.addToSortKeyRanges(ri.symbolInstances.length,fi.sortKey),ri.symbolInstances.emplaceBack(Mi.x,Mi.y,Fs.right>=0?Fs.right:-1,Fs.center>=0?Fs.center:-1,Fs.left>=0?Fs.left:-1,Fs.vertical||-1,Tc,lh,Ml,uh,wp,Ep,Vh,qh,Sp,Gh,Zh,br,Wu,Ic,uo,$a,kc,0,Ki,Ac,Xu,Da)}(i,oi,vt,a,h,_,Pt,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,pe,He,kt,R,Ne,it,At,$,t,b,O,V,S)};if(pt==="line")for(const vt of bc(t.geometry,0,0,hr,hr)){const oi=Jm(vt,Ze,We,a.vertical||Q,h,24,ke,i.overscaling,hr);for(const ri of oi){const Mi=Q;Mi&&ey(i,Mi.text,Tt,ri)||mt(vt,ri)}}else if(pt==="line-center"){for(const vt of t.geometry)if(vt.length>1){const oi=Km(vt,We,a.vertical||Q,h,24,ke);oi&&mt(vt,oi)}}else if(t.type==="Polygon")for(const vt of kh(t.geometry,0)){const oi=yp(vt,16);mt(vt[0],new du(oi.x,oi.y,0))}else if(t.type==="LineString")for(const vt of t.geometry)mt(vt,new du(vt[0].x,vt[0].y,0));else if(t.type==="Point")for(const vt of t.geometry)for(const oi of vt)mt([oi],new du(oi.x,oi.y,0))}const Pl=32640;function wc(i,t,a,h,_,b,S,P,R,O,V,j,K,$,Q){const se=function(Ne,Ze,He,it,We,kt,At,pt){const Tt=it.layout.get("text-rotate").evaluate(kt,{})*Math.PI/180,gt=[];for(const Pt of Ze.positionedLines)for(const mt of Pt.positionedGlyphs){if(!mt.rect)continue;const vt=mt.rect||{};let oi=4,ri=!0,Mi=1,Bi=0;const Qi=(We||pt)&&mt.vertical,ur=mt.metrics.advance*mt.scale/2;if(pt&&Ze.verticalizable){const sr=(mt.scale-1)*Do,Lr=(Do-mt.metrics.width*mt.scale)/2;Bi=Pt.lineOffset/2-(mt.imageName?-Lr:sr)}if(mt.imageName){const sr=At[mt.imageName];ri=sr.sdf,Mi=sr.pixelRatio,oi=1/Mi}const kr=We?[mt.x+ur,mt.y]:[0,0];let zr=We?[0,0]:[mt.x+ur+He[0],mt.y+He[1]-Bi],xr=[0,0];Qi&&(xr=zr,zr=[0,0]);const Br=(mt.metrics.left-oi)*mt.scale-ur+zr[0],br=(-mt.metrics.top-oi)*mt.scale+zr[1],Or=Br+vt.w*mt.scale/Mi,Vi=br+vt.h*mt.scale/Mi,Ki=new bt(Br,br),er=new bt(Or,br),Hi=new bt(Br,Vi),on=new bt(Or,Vi);if(Qi){const sr=new bt(-ur,ur-th),Lr=-Math.PI/2,fi=12-ur,lo=new bt(22-fi,-(mt.imageName?fi:0)),cn=new bt(...xr);Ki._rotateAround(Lr,sr)._add(lo)._add(cn),er._rotateAround(Lr,sr)._add(lo)._add(cn),Hi._rotateAround(Lr,sr)._add(lo)._add(cn),on._rotateAround(Lr,sr)._add(lo)._add(cn)}if(Tt){const sr=Math.sin(Tt),Lr=Math.cos(Tt),fi=[Lr,-sr,sr,Lr];Ki._matMult(fi),er._matMult(fi),Hi._matMult(fi),on._matMult(fi)}const en=new bt(0,0),dr=new bt(0,0);gt.push({tl:Ki,tr:er,bl:Hi,br:on,tex:vt,writingMode:Ze.writingMode,glyphOffset:kr,sectionIndex:mt.sectionIndex,isSDF:ri,pixelOffsetTL:en,pixelOffsetBR:dr,minFontScaleX:0,minFontScaleY:0})}return gt}(0,a,P,_,b,S,h,i.allowVerticalPlacement),pe=i.textSizeData;let ke=null;pe.kind==="source"?(ke=[zl*_.layout.get("text-size").evaluate(S,{})],ke[0]>Pl&&ut(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):pe.kind==="composite"&&(ke=[zl*$.compositeTextSizes[0].evaluate(S,{},Q),zl*$.compositeTextSizes[1].evaluate(S,{},Q)],(ke[0]>Pl||ke[1]>Pl)&&ut(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,se,ke,P,b,S,O,t,R.lineStartIndex,R.lineLength,K,Q);for(const Ne of V)j[Ne]=i.text.placedSymbolArray.length-1;return 4*se.length}function df(i){for(const t in i)return i[t];return null}function ey(i,t,a,h){const _=i.compareText;if(t in _){const b=_[t];for(let S=b.length-1;S>=0;S--)if(h.dist(b[S])<a)return!0}else _[t]=[];return _[t].push(h),!1}const ty=Uu.VectorTileFeature.types,iy=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function gp(i,t,a,h,_,b,S,P,R,O,V,j,K){const $=P?Math.min(Pl,Math.round(P[0])):0,Q=P?Math.min(Pl,Math.round(P[1])):0;i.emplaceBack(t,a,Math.round(32*h),Math.round(32*_),b,S,($<<1)+(R?1:0),Q,16*O,16*V,256*j,256*K)}function vd(i,t,a){i.emplaceBack(t.x,t.y,a),i.emplaceBack(t.x,t.y,a),i.emplaceBack(t.x,t.y,a),i.emplaceBack(t.x,t.y,a)}function ry(i){for(const t of i.sections)if(ui(t.text))return!0;return!1}class _p{constructor(t){this.layoutVertexArray=new q,this.indexArray=new me,this.programConfigurations=t,this.segments=new be,this.dynamicLayoutVertexArray=new Y,this.opacityVertexArray=new ie,this.placedSymbolArray=new Lt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,a,h,_){this.isEmpty()||(h&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,tf.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,rf.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,iy,!0),this.opacityVertexBuffer.itemSize=1),(h||_)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ti("SymbolBuffers",_p);class vp{constructor(t,a,h){this.layoutVertexArray=new t,this.layoutAttributes=a,this.indexArray=new h,this.segments=new be,this.collisionVertexArray=new de}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,lp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ti("CollisionBuffers",vp);class Ec{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(S=>S.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ou([]),this.placementViewportMatrix=Ou([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Dh(this.zoom,a["text-size"]),this.iconSizeData=Dh(this.zoom,a["icon-size"]);const h=this.layers[0].layout,_=h.get("symbol-sort-key"),b=h.get("symbol-z-order");this.canOverlap=qu(h,"text-overlap","text-allow-overlap")!=="never"||qu(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!_.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map(S=>p.WritingMode[S])),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=t.sourceID}createArrays(){this.text=new _p(new Fn(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new _p(new Fn(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new mi,this.lineVertexArray=new ni,this.symbolInstances=new St}calculateGlyphDependencies(t,a,h,_,b){for(let S=0;S<t.length;S++)if(a[t.charCodeAt(S)]=!0,(h||_)&&b){const P=kl[t.charAt(S)];P&&(a[P.charCodeAt(0)]=!0)}}populate(t,a,h){const _=this.layers[0],b=_.layout,S=b.get("text-font"),P=b.get("text-field"),R=b.get("icon-image"),O=(P.value.kind!=="constant"||P.value.value instanceof ve&&!P.value.value.isEmpty()||P.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),V=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,j=b.get("symbol-sort-key");if(this.features=[],!O&&!V)return;const K=a.iconDependencies,$=a.glyphDependencies,Q=a.availableImages,se=new rn(this.zoom);for(const{feature:pe,id:ke,index:Ne,sourceLayerIndex:Ze}of t){const He=_._featureFilter.needGeometry,it=ro(pe,He);if(!_._featureFilter.filter(se,it,h))continue;let We,kt;if(He||(it.geometry=wa(pe)),O){const pt=_.getValueAndResolveTokens("text-field",it,h,Q),Tt=ve.factory(pt);ry(Tt)&&(this.hasRTLText=!0),(!this.hasRTLText||iu()==="unavailable"||this.hasRTLText&&dn.isParsed())&&(We=lu(Tt,_,it))}if(V){const pt=_.getValueAndResolveTokens("icon-image",it,h,Q);kt=pt instanceof fe?pt:fe.fromString(pt)}if(!We&&!kt)continue;const At=this.sortFeaturesByKey?j.evaluate(it,{},h):void 0;if(this.features.push({id:ke,text:We,icon:kt,index:Ne,sourceLayerIndex:Ze,geometry:it.geometry,properties:pe.properties,type:ty[pe.type],sortKey:At}),kt&&(K[kt.name]=!0),We){const pt=S.evaluate(it,{},h).join(","),Tt=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(p.WritingMode.vertical)>=0;for(const gt of We.sections)if(gt.image)K[gt.image.name]=!0;else{const Pt=tl(We.toString()),mt=gt.fontStack||pt,vt=$[mt]=$[mt]||{};this.calculateGlyphDependencies(gt.text,vt,Tt,this.allowVerticalPlacement,Pt)}}}b.get("symbol-placement")==="line"&&(this.features=function(pe){const ke={},Ne={},Ze=[];let He=0;function it(pt){Ze.push(pe[pt]),He++}function We(pt,Tt,gt){const Pt=Ne[pt];return delete Ne[pt],Ne[Tt]=Pt,Ze[Pt].geometry[0].pop(),Ze[Pt].geometry[0]=Ze[Pt].geometry[0].concat(gt[0]),Pt}function kt(pt,Tt,gt){const Pt=ke[Tt];return delete ke[Tt],ke[pt]=Pt,Ze[Pt].geometry[0].shift(),Ze[Pt].geometry[0]=gt[0].concat(Ze[Pt].geometry[0]),Pt}function At(pt,Tt,gt){const Pt=gt?Tt[0][Tt[0].length-1]:Tt[0][0];return`${pt}:${Pt.x}:${Pt.y}`}for(let pt=0;pt<pe.length;pt++){const Tt=pe[pt],gt=Tt.geometry,Pt=Tt.text?Tt.text.toString():null;if(!Pt){it(pt);continue}const mt=At(Pt,gt),vt=At(Pt,gt,!0);if(mt in Ne&&vt in ke&&Ne[mt]!==ke[vt]){const oi=kt(mt,vt,gt),ri=We(mt,vt,Ze[oi].geometry);delete ke[mt],delete Ne[vt],Ne[At(Pt,Ze[ri].geometry,!0)]=ri,Ze[oi].geometry=null}else mt in Ne?We(mt,vt,gt):vt in ke?kt(mt,vt,gt):(it(pt),ke[mt]=He-1,Ne[vt]=He-1)}return Ze.filter(pt=>pt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((pe,ke)=>pe.sortKey-ke.sortKey)}update(t,a,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,a,this.layers,h),this.icon.programConfigurations.updatePaintArrays(t,a,this.layers,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,a){const h=this.lineVertexArray.length;if(t.segment!==void 0){let _=t.dist(a[t.segment+1]),b=t.dist(a[t.segment]);const S={};for(let P=t.segment+1;P<a.length;P++)S[P]={x:a[P].x,y:a[P].y,tileUnitDistanceFromAnchor:_},P<a.length-1&&(_+=a[P+1].dist(a[P]));for(let P=t.segment||0;P>=0;P--)S[P]={x:a[P].x,y:a[P].y,tileUnitDistanceFromAnchor:b},P>0&&(b+=a[P-1].dist(a[P]));for(let P=0;P<a.length;P++){const R=S[P];this.lineVertexArray.emplaceBack(R.x,R.y,R.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(t,a,h,_,b,S,P,R,O,V,j,K){const $=t.indexArray,Q=t.layoutVertexArray,se=t.segments.prepareSegment(4*a.length,Q,$,this.canOverlap?S.sortKey:void 0),pe=this.glyphOffsetArray.length,ke=se.vertexLength,Ne=this.allowVerticalPlacement&&P===p.WritingMode.vertical?Math.PI/2:0,Ze=S.text&&S.text.sections;for(let He=0;He<a.length;He++){const{tl:it,tr:We,bl:kt,br:At,tex:pt,pixelOffsetTL:Tt,pixelOffsetBR:gt,minFontScaleX:Pt,minFontScaleY:mt,glyphOffset:vt,isSDF:oi,sectionIndex:ri}=a[He],Mi=se.vertexLength,Bi=vt[1];gp(Q,R.x,R.y,it.x,Bi+it.y,pt.x,pt.y,h,oi,Tt.x,Tt.y,Pt,mt),gp(Q,R.x,R.y,We.x,Bi+We.y,pt.x+pt.w,pt.y,h,oi,gt.x,Tt.y,Pt,mt),gp(Q,R.x,R.y,kt.x,Bi+kt.y,pt.x,pt.y+pt.h,h,oi,Tt.x,gt.y,Pt,mt),gp(Q,R.x,R.y,At.x,Bi+At.y,pt.x+pt.w,pt.y+pt.h,h,oi,gt.x,gt.y,Pt,mt),vd(t.dynamicLayoutVertexArray,R,Ne),$.emplaceBack(Mi,Mi+1,Mi+2),$.emplaceBack(Mi+1,Mi+2,Mi+3),se.vertexLength+=4,se.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(vt[0]),He!==a.length-1&&ri===a[He+1].sectionIndex||t.programConfigurations.populatePaintArrays(Q.length,S,S.index,{},K,Ze&&Ze[ri])}t.placedSymbolArray.emplaceBack(R.x,R.y,pe,this.glyphOffsetArray.length-pe,ke,O,V,R.segment,h?h[0]:0,h?h[1]:0,_[0],_[1],P,0,!1,0,j)}_addCollisionDebugVertex(t,a,h,_,b,S){return a.emplaceBack(0,0),t.emplaceBack(h.x,h.y,_,b,Math.round(S.x),Math.round(S.y))}addCollisionDebugVertices(t,a,h,_,b,S,P){const R=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),O=R.vertexLength,V=b.layoutVertexArray,j=b.collisionVertexArray,K=P.anchorX,$=P.anchorY;this._addCollisionDebugVertex(V,j,S,K,$,new bt(t,a)),this._addCollisionDebugVertex(V,j,S,K,$,new bt(h,a)),this._addCollisionDebugVertex(V,j,S,K,$,new bt(h,_)),this._addCollisionDebugVertex(V,j,S,K,$,new bt(t,_)),R.vertexLength+=4;const Q=b.indexArray;Q.emplaceBack(O,O+1),Q.emplaceBack(O+1,O+2),Q.emplaceBack(O+2,O+3),Q.emplaceBack(O+3,O),R.primitiveLength+=4}addDebugCollisionBoxes(t,a,h,_){for(let b=t;b<a;b++){const S=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,_?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new vp(he,nn.members,ze),this.iconCollisionBox=new vp(he,nn.members,ze);for(let t=0;t<this.symbolInstances.length;t++){const a=this.symbolInstances.get(t);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(t,a,h,_,b,S,P,R,O){const V={};for(let j=a;j<h;j++){const K=t.get(j);V.textBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},V.textFeatureIndex=K.featureIndex;break}for(let j=_;j<b;j++){const K=t.get(j);V.verticalTextBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},V.verticalTextFeatureIndex=K.featureIndex;break}for(let j=S;j<P;j++){const K=t.get(j);V.iconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},V.iconFeatureIndex=K.featureIndex;break}for(let j=R;j<O;j++){const K=t.get(j);V.verticalIconBox={x1:K.x1,y1:K.y1,x2:K.x2,y2:K.y2,anchorPointX:K.anchorPointX,anchorPointY:K.anchorPointY},V.verticalIconFeatureIndex=K.featureIndex;break}return V}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,a){const h=t.placedSymbolArray.get(a),_=h.vertexStartIndex+4*h.numGlyphs;for(let b=h.vertexStartIndex;b<_;b+=4)t.indexArray.emplaceBack(b,b+1,b+2),t.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(t),h=Math.cos(t),_=[],b=[],S=[];for(let P=0;P<this.symbolInstances.length;++P){S.push(P);const R=this.symbolInstances.get(P);_.push(0|Math.round(a*R.anchorX+h*R.anchorY)),b.push(R.featureIndex)}return S.sort((P,R)=>_[P]-_[R]||b[R]-b[P]),S}addToSortKeyRanges(t,a){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===a?h.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const h=this.symbolInstances.get(a);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((_,b,S)=>{_>=0&&S.indexOf(_)===b&&this.addIndicesForPlacedSymbol(this.text,_)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}ti("SymbolBucket",Ec,{omit:["layers","collisionBoxArray","features","compareText"]}),Ec.MAX_GLYPHS=65535,Ec.addDynamicAttributes=vd;const ff=new fn({"symbol-placement":new ci(qe.layout_symbol["symbol-placement"]),"symbol-spacing":new ci(qe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ci(qe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Vt(qe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ci(qe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ci(qe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ci(qe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ci(qe.layout_symbol["icon-ignore-placement"]),"icon-optional":new ci(qe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ci(qe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Vt(qe.layout_symbol["icon-size"]),"icon-text-fit":new ci(qe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ci(qe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Vt(qe.layout_symbol["icon-image"]),"icon-rotate":new Vt(qe.layout_symbol["icon-rotate"]),"icon-padding":new ci(qe.layout_symbol["icon-padding"]),"icon-keep-upright":new ci(qe.layout_symbol["icon-keep-upright"]),"icon-offset":new Vt(qe.layout_symbol["icon-offset"]),"icon-anchor":new Vt(qe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ci(qe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ci(qe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ci(qe.layout_symbol["text-rotation-alignment"]),"text-field":new Vt(qe.layout_symbol["text-field"]),"text-font":new Vt(qe.layout_symbol["text-font"]),"text-size":new Vt(qe.layout_symbol["text-size"]),"text-max-width":new Vt(qe.layout_symbol["text-max-width"]),"text-line-height":new ci(qe.layout_symbol["text-line-height"]),"text-letter-spacing":new Vt(qe.layout_symbol["text-letter-spacing"]),"text-justify":new Vt(qe.layout_symbol["text-justify"]),"text-radial-offset":new Vt(qe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ci(qe.layout_symbol["text-variable-anchor"]),"text-anchor":new Vt(qe.layout_symbol["text-anchor"]),"text-max-angle":new ci(qe.layout_symbol["text-max-angle"]),"text-writing-mode":new ci(qe.layout_symbol["text-writing-mode"]),"text-rotate":new Vt(qe.layout_symbol["text-rotate"]),"text-padding":new ci(qe.layout_symbol["text-padding"]),"text-keep-upright":new ci(qe.layout_symbol["text-keep-upright"]),"text-transform":new Vt(qe.layout_symbol["text-transform"]),"text-offset":new Vt(qe.layout_symbol["text-offset"]),"text-allow-overlap":new ci(qe.layout_symbol["text-allow-overlap"]),"text-overlap":new ci(qe.layout_symbol["text-overlap"]),"text-ignore-placement":new ci(qe.layout_symbol["text-ignore-placement"]),"text-optional":new ci(qe.layout_symbol["text-optional"])});var oh={paint:new fn({"icon-opacity":new Vt(qe.paint_symbol["icon-opacity"]),"icon-color":new Vt(qe.paint_symbol["icon-color"]),"icon-halo-color":new Vt(qe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Vt(qe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Vt(qe.paint_symbol["icon-halo-blur"]),"icon-translate":new ci(qe.paint_symbol["icon-translate"]),"icon-translate-anchor":new ci(qe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Vt(qe.paint_symbol["text-opacity"]),"text-color":new Vt(qe.paint_symbol["text-color"],{runtimeType:Rn,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Vt(qe.paint_symbol["text-halo-color"]),"text-halo-width":new Vt(qe.paint_symbol["text-halo-width"]),"text-halo-blur":new Vt(qe.paint_symbol["text-halo-blur"]),"text-translate":new ci(qe.paint_symbol["text-translate"]),"text-translate-anchor":new ci(qe.paint_symbol["text-translate-anchor"])}),layout:ff};class Vu{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:$r,this.defaultValue=t}evaluate(t){if(t.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(t.formattedSection))return a.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ti("FormatSectionOverride",Vu,{omit:["defaultValue"]});class ah extends bn{constructor(t){super(t,oh)}recalculate(t,a){if(super.recalculate(t,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const _=[];for(const b of h)_.indexOf(b)<0&&_.push(b);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,a,h,_){const b=this.layout.get(t).evaluate(a,{},h,_),S=this._unevaluatedLayout._values[t];return S.isDataDriven()||Za(S.value)||!b?b:function(P,R){return R.replace(/{([^{}]+)}/g,(O,V)=>V in P?String(P[V]):"")}(a.properties,b)}createBucket(t){return new Ec(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of oh.paint.overridableProperties){if(!ah.hasPaintOverride(this.layout,t))continue;const a=this.paint.get(t),h=new Vu(a),_=new ku(h,a.property.specification);let b=null;b=a.value.kind==="constant"||a.value.kind==="source"?new Kl("source",_):new Ps("composite",_,a.value.zoomStops,a.value._interpolationType),this.paint._values[t]=new ba(a.property,b,a.parameters)}}_handleOverridablePaintPropertyUpdate(t,a,h){return!(!this.layout||a.isDataDriven()||h.isDataDriven())&&ah.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,a){const h=t.get("text-field"),_=oh.paint.properties[a];let b=!1;const S=P=>{for(const R of P)if(_.overrides&&_.overrides.hasOverride(R))return void(b=!0)};if(h.value.kind==="constant"&&h.value.value instanceof ve)S(h.value.value.sections);else if(h.value.kind==="source"){const P=O=>{b||(O instanceof Ke&&Te(O.value)===Uo?S(O.value.sections):O instanceof Ut?S(O.sections):O.eachChild(P))},R=h.value;R._styleExpression&&P(R._styleExpression.expression)}return b}}function qu(i,t,a){let h="never";const _=i.get(t);return _?h=_:i.get(a)&&(h="always"),h}var mf={paint:new fn({"background-color":new ci(qe.paint_background["background-color"]),"background-pattern":new Mo(qe.paint_background["background-pattern"]),"background-opacity":new ci(qe.paint_background["background-opacity"])})},so={paint:new fn({"raster-opacity":new ci(qe.paint_raster["raster-opacity"]),"raster-hue-rotate":new ci(qe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ci(qe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ci(qe.paint_raster["raster-brightness-max"]),"raster-saturation":new ci(qe.paint_raster["raster-saturation"]),"raster-contrast":new ci(qe.paint_raster["raster-contrast"]),"raster-resampling":new ci(qe.paint_raster["raster-resampling"]),"raster-fade-duration":new ci(qe.paint_raster["raster-fade-duration"])})};class yn extends bn{constructor(t){super(t,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}}const yf={circle:class extends bn{constructor(i){super(i,au)}createBucket(i){return new Sa(i)}queryRadius(i){const t=i;return _s("circle-radius",this,t)+_s("circle-stroke-width",this,t)+Sr(this.paint.get("circle-translate"))}queryIntersectsFeature(i,t,a,h,_,b,S,P){const R=Yo(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,S),O=this.paint.get("circle-radius").evaluate(t,a)+this.paint.get("circle-stroke-width").evaluate(t,a),V=this.paint.get("circle-pitch-alignment")==="map",j=V?R:function($,Q){return $.map(se=>dc(se,Q))}(R,P),K=V?O*S:O;for(const $ of h)for(const Q of $){const se=V?Q:dc(Q,P);let pe=K;const ke=ol([],[Q.x,Q.y,0,1],P);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?pe*=ke[3]/b.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(pe*=b.cameraToCenterDistance/ke[3]),Du(j,se,pe))return!0}return!1}},heatmap:class extends bn{constructor(i){super(i,fc),this._updateColorRamp()}createBucket(i){return new np(i)}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Zd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends bn{constructor(i){super(i,bm)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends bn{constructor(i){super(i,Hd)}recalculate(i,t){super.recalculate(i,t);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new rd(i)}queryRadius(){return Sr(this.paint.get("fill-translate"))}queryIntersectsFeature(i,t,a,h,_,b,S){return rl(Yo(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,S),h)}isTileClipped(){return!0}},"fill-extrusion":class extends bn{constructor(i){super(i,Um)}createBucket(i){return new od(i)}queryRadius(){return Sr(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(i,t,a,h,_,b,S,P){const R=Yo(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,S),O=this.paint.get("fill-extrusion-height").evaluate(t,a),V=this.paint.get("fill-extrusion-base").evaluate(t,a),j=function($,Q,se,pe){const ke=[];for(const Ne of $){const Ze=[Ne.x,Ne.y,0,1];ol(Ze,Ze,Q),ke.push(new bt(Ze[0]/Ze[3],Ze[1]/Ze[3]))}return ke}(R,P),K=function($,Q,se,pe){const ke=[],Ne=[],Ze=pe[8]*Q,He=pe[9]*Q,it=pe[10]*Q,We=pe[11]*Q,kt=pe[8]*se,At=pe[9]*se,pt=pe[10]*se,Tt=pe[11]*se;for(const gt of $){const Pt=[],mt=[];for(const vt of gt){const oi=vt.x,ri=vt.y,Mi=pe[0]*oi+pe[4]*ri+pe[12],Bi=pe[1]*oi+pe[5]*ri+pe[13],Qi=pe[2]*oi+pe[6]*ri+pe[14],ur=pe[3]*oi+pe[7]*ri+pe[15],kr=Qi+it,zr=ur+We,xr=Mi+kt,Br=Bi+At,br=Qi+pt,Or=ur+Tt,Vi=new bt((Mi+Ze)/zr,(Bi+He)/zr);Vi.z=kr/zr,Pt.push(Vi);const Ki=new bt(xr/Or,Br/Or);Ki.z=br/Or,mt.push(Ki)}ke.push(Pt),Ne.push(mt)}return[ke,Ne]}(h,V,O,P);return function($,Q,se){let pe=1/0;rl(se,Q)&&(pe=Qo(se,Q[0]));for(let ke=0;ke<Q.length;ke++){const Ne=Q[ke],Ze=$[ke];for(let He=0;He<Ne.length-1;He++){const it=Ne[He],We=[it,Ne[He+1],Ze[He+1],Ze[He],it];Lu(se,We)&&(pe=Math.min(pe,Qo(se,We)))}}return pe!==1/0&&pe}(K[0],K[1],j)}},line:class extends bn{constructor(i){super(i,Qd),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Hs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,t){super.recalculate(i,t),this.paint._values["line-floorwidth"]=ef.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new ad(i)}queryRadius(i){const t=i,a=eh(_s("line-width",this,t),_s("line-gap-width",this,t)),h=_s("line-offset",this,t);return a/2+Math.abs(h)+Sr(this.paint.get("line-translate"))}queryIntersectsFeature(i,t,a,h,_,b,S){const P=Yo(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,S),R=S/2*eh(this.paint.get("line-width").evaluate(t,a),this.paint.get("line-gap-width").evaluate(t,a)),O=this.paint.get("line-offset").evaluate(t,a);return O&&(h=function(V,j){const K=[];for(let $=0;$<V.length;$++){const Q=V[$],se=[];for(let pe=0;pe<Q.length;pe++){const ke=Q[pe-1],Ne=Q[pe],Ze=Q[pe+1],He=pe===0?new bt(0,0):Ne.sub(ke)._unit()._perp(),it=pe===Q.length-1?new bt(0,0):Ze.sub(Ne)._unit()._perp(),We=He._add(it)._unit(),kt=We.x*it.x+We.y*it.y;kt!==0&&We._mult(1/kt),se.push(We._mult(j)._add(Ne))}K.push(se)}return K}(h,O*S)),function(V,j,K){for(let $=0;$<j.length;$++){const Q=j[$];if(V.length>=3){for(let se=0;se<Q.length;se++)if(Ia(V,Q[se]))return!0}if(Ru(V,Q,K))return!0}return!1}(P,h,R)}isTileClipped(){return!0}},symbol:ah,background:class extends bn{constructor(i){super(i,mf)}},raster:class extends bn{constructor(i){super(i,so)}}};class gf{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const xd=63710088e-1;class Un{constructor(t,a){if(isNaN(t)||isNaN(a))throw new Error(`Invalid LngLat object: (${t}, ${a})`);if(this.lng=+t,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Un(Se(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const a=Math.PI/180,h=this.lat*a,_=t.lat*a,b=Math.sin(h)*Math.sin(_)+Math.cos(h)*Math.cos(_)*Math.cos((t.lng-this.lng)*a);return xd*Math.acos(Math.min(b,1))}toBounds(t=0){const a=360*t/40075017,h=a/Math.cos(Math.PI/180*this.lat);return new Gu(new Un(this.lng-h,this.lat-a),new Un(this.lng+h,this.lat+a))}static convert(t){if(t instanceof Un)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Un(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Un(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Gu{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Un?new Un(t.lng,t.lat):Un.convert(t),this}setSouthWest(t){return this._sw=t instanceof Un?new Un(t.lng,t.lat):Un.convert(t),this}extend(t){const a=this._sw,h=this._ne;let _,b;if(t instanceof Un)_=t,b=t;else{if(!(t instanceof Gu))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Gu.convert(t)):this.extend(Un.convert(t)):this;if(_=t._sw,b=t._ne,!_||!b)return this}return a||h?(a.lng=Math.min(_.lng,a.lng),a.lat=Math.min(_.lat,a.lat),h.lng=Math.max(b.lng,h.lng),h.lat=Math.max(b.lat,h.lat)):(this._sw=new Un(_.lng,_.lat),this._ne=new Un(b.lng,b.lat)),this}getCenter(){return new Un((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Un(this.getWest(),this.getNorth())}getSouthEast(){return new Un(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:h}=Un.convert(t);let _=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&_}static convert(t){return t instanceof Gu?t:t&&new Gu(t)}}const xp=2*Math.PI*xd;function Zu(i){return xp*Math.cos(i*Math.PI/180)}function Hu(i){return(180+i)/360}function bd(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function qn(i,t){return i/Zu(t)}function Sc(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class Os{constructor(t,a,h=0){this.x=+t,this.y=+a,this.z=+h}static fromLngLat(t,a=0){const h=Un.convert(t);return new Os(Hu(h.lng),bd(h.lat),qn(a,h.lat))}toLngLat(){return new Un(360*this.x-180,Sc(this.y))}toAltitude(){return this.z*Zu(Sc(this.y))}meterInMercatorCoordinateUnits(){return 1/xp*(t=Sc(this.y),1/Math.cos(t*Math.PI/180));var t}}function jh(i,t,a){var h=2*Math.PI*6378137/256/Math.pow(2,a);return[i*h-2*Math.PI*6378137/2,t*h-2*Math.PI*6378137/2]}class sh{constructor(t,a,h){this.z=t,this.x=a,this.y=h,this.key=xs(0,t,t,a,h)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,a,h){const _=(S=this.y,P=this.z,R=jh(256*(b=this.x),256*(S=Math.pow(2,P)-S-1),P),O=jh(256*(b+1),256*(S+1),P),R[0]+","+R[1]+","+O[0]+","+O[1]);var b,S,P,R,O;const V=function(j,K,$){let Q,se="";for(let pe=j;pe>0;pe--)Q=1<<pe-1,se+=(K&Q?1:0)+($&Q?2:0);return se}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,V).replace(/{bbox-epsg-3857}/g,_)}getTilePoint(t){const a=Math.pow(2,this.z);return new bt((t.x*a-this.x)*hr,(t.y*a-this.y)*hr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class bp{constructor(t,a){this.wrap=t,this.canonical=a,this.key=xs(t,a.z,a.z,a.x,a.y)}}class ma{constructor(t,a,h,_,b){this.overscaledZ=t,this.wrap=a,this.canonical=new sh(h,+_,+b),this.key=xs(a,t,h,_,b)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const a=this.canonical.z-t;return t>this.canonical.z?new ma(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ma(t,this.wrap,t,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(t,a){const h=this.canonical.z-t;return t>this.canonical.z?xs(this.wrap*+a,t,this.canonical.z,this.canonical.x,this.canonical.y):xs(this.wrap*+a,t,t,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const a=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>a&&t.canonical.y===this.canonical.y>>a}children(t){if(this.overscaledZ>=t)return[new ma(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,h=2*this.canonical.x,_=2*this.canonical.y;return[new ma(a,this.wrap,a,h,_),new ma(a,this.wrap,a,h+1,_),new ma(a,this.wrap,a,h,_+1),new ma(a,this.wrap,a,h+1,_+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new ma(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new ma(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new bp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Os(t.x-this.wrap,t.y))}}function xs(i,t,a,h,_){(i*=2)<0&&(i=-1*i-1);const b=1<<a;return(b*b*i+b*_+h).toString(36)+a.toString(36)+t.toString(36)}ti("CanonicalTileID",sh),ti("OverscaledTileID",ma,{omit:["posMatrix"]});class wd{constructor(t,a,h){if(this.uid=t,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void ut(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const _=this.dim=a.height-2;this.data=new Uint32Array(a.data.buffer),this.encoding=h||"mapbox";for(let b=0;b<_;b++)this.data[this._idx(-1,b)]=this.data[this._idx(0,b)],this.data[this._idx(_,b)]=this.data[this._idx(_-1,b)],this.data[this._idx(b,-1)]=this.data[this._idx(b,0)],this.data[this._idx(b,_)]=this.data[this._idx(b,_-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(_,-1)]=this.data[this._idx(_-1,0)],this.data[this._idx(-1,_)]=this.data[this._idx(0,_-1)],this.data[this._idx(_,_)]=this.data[this._idx(_-1,_-1)]}get(t,a){const h=new Uint8Array(this.data.buffer),_=4*this._idx(t,a);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(h[_],h[_+1],h[_+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(t,a){if(t<-1||t>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(t+1)}_unpackMapbox(t,a,h){return(256*t*256+256*a+h)/10-1e4}_unpackTerrarium(t,a,h){return 256*t+a+h/256-32768}getPixels(){return new vs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,a,h){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let _=a*this.dim,b=a*this.dim+this.dim,S=h*this.dim,P=h*this.dim+this.dim;switch(a){case-1:_=b-1;break;case 1:b=_+1}switch(h){case-1:S=P-1;break;case 1:P=S+1}const R=-a*this.dim,O=-h*this.dim;for(let V=S;V<P;V++)for(let j=_;j<b;j++)this.data[this._idx(j,V)]=t.data[this._idx(j+R,V+O)]}}ti("DEMData",wd);class Ed{constructor(t){this._stringToNumber={},this._numberToString=[];for(let a=0;a<t.length;a++){const h=t[a];this._stringToNumber[h]=a,this._numberToString[a]=h}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}class _f{constructor(t,a,h,_,b){this.type="Feature",this._vectorTileFeature=t,t._z=a,t._x=h,t._y=_,this.properties=t.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(t[a]=this[a]);return t}}class go{constructor(t,a){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new tr(hr,16,0),this.grid3D=new tr(hr,16,0),this.featureIndexArray=new c,this.promoteId=a}insert(t,a,h,_,b,S){const P=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,_,b);const R=S?this.grid3D:this.grid;for(let O=0;O<a.length;O++){const V=a[O],j=[1/0,1/0,-1/0,-1/0];for(let K=0;K<V.length;K++){const $=V[K];j[0]=Math.min(j[0],$.x),j[1]=Math.min(j[1],$.y),j[2]=Math.max(j[2],$.x),j[3]=Math.max(j[3],$.y)}j[0]<hr&&j[1]<hr&&j[2]>=0&&j[3]>=0&&R.insert(P,j[0],j[1],j[2],j[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Uu.VectorTile(new sd(this.rawTileData)).layers,this.sourceLayerCoder=new Ed(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,a,h,_){this.loadVTLayers();const b=t.params||{},S=hr/t.tileSize/t.scale,P=Ms(b.filter),R=t.queryGeometry,O=t.queryPadding*S,V=Sd(R),j=this.grid.query(V.minX-O,V.minY-O,V.maxX+O,V.maxY+O),K=Sd(t.cameraQueryGeometry),$=this.grid3D.query(K.minX-O,K.minY-O,K.maxX+O,K.maxY+O,(pe,ke,Ne,Ze)=>function(He,it,We,kt,At){for(const Tt of He)if(it<=Tt.x&&We<=Tt.y&&kt>=Tt.x&&At>=Tt.y)return!0;const pt=[new bt(it,We),new bt(it,At),new bt(kt,At),new bt(kt,We)];if(He.length>2){for(const Tt of pt)if(Ia(He,Tt))return!0}for(let Tt=0;Tt<He.length-1;Tt++)if(Cl(He[Tt],He[Tt+1],pt))return!0;return!1}(t.cameraQueryGeometry,pe-O,ke-O,Ne+O,Ze+O));for(const pe of $)j.push(pe);j.sort(e);const Q={};let se;for(let pe=0;pe<j.length;pe++){const ke=j[pe];if(ke===se)continue;se=ke;const Ne=this.featureIndexArray.get(ke);let Ze=null;this.loadMatchingFeature(Q,Ne.bucketIndex,Ne.sourceLayerIndex,Ne.featureIndex,P,b.layers,b.availableImages,a,h,_,(He,it,We)=>(Ze||(Ze=wa(He)),it.queryIntersectsFeature(R,He,We,Ze,this.z,t.transform,S,t.pixelPosMatrix)))}return Q}loadMatchingFeature(t,a,h,_,b,S,P,R,O,V,j){const K=this.bucketLayerIDs[a];if(S&&!function(pe,ke){for(let Ne=0;Ne<pe.length;Ne++)if(ke.indexOf(pe[Ne])>=0)return!0;return!1}(S,K))return;const $=this.sourceLayerCoder.decode(h),Q=this.vtLayers[$].feature(_);if(b.needGeometry){const pe=ro(Q,!0);if(!b.filter(new rn(this.tileID.overscaledZ),pe,this.tileID.canonical))return}else if(!b.filter(new rn(this.tileID.overscaledZ),Q))return;const se=this.getId(Q,$);for(let pe=0;pe<K.length;pe++){const ke=K[pe];if(S&&S.indexOf(ke)<0)continue;const Ne=R[ke];if(!Ne)continue;let Ze={};se&&V&&(Ze=V.getState(Ne.sourceLayer||"_geojsonTileLayer",se));const He=ge({},O[ke]);He.paint=fu(He.paint,Ne.paint,Q,Ze,P),He.layout=fu(He.layout,Ne.layout,Q,Ze,P);const it=!j||j(Q,Ne,Ze);if(!it)continue;const We=new _f(Q,this.z,this.x,this.y,se);We.layer=He;let kt=t[ke];kt===void 0&&(kt=t[ke]=[]),kt.push({featureIndex:_,feature:We,intersectionZ:it})}}lookupSymbolFeatures(t,a,h,_,b,S,P,R){const O={};this.loadVTLayers();const V=Ms(b);for(const j of t)this.loadMatchingFeature(O,h,_,j,V,S,P,R,a);return O}hasLayer(t){for(const a of this.bucketLayerIDs)for(const h of a)if(t===h)return!0;return!1}getId(t,a){let h=t.id;return this.promoteId&&(h=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof h=="boolean"&&(h=Number(h))),h}}function fu(i,t,a,h,_){return ft(i,(b,S)=>{const P=t instanceof Wo?t.get(S):null;return P&&P.evaluate?P.evaluate(a,h,_):P})}function Sd(i){let t=1/0,a=1/0,h=-1/0,_=-1/0;for(const b of i)t=Math.min(t,b.x),a=Math.min(a,b.y),h=Math.max(h,b.x),_=Math.max(_,b.y);return{minX:t,minY:a,maxX:h,maxY:_}}function e(i,t){return t-i}var n;ti("FeatureIndex",go,{omit:["rawTileData","sourceLayerCoder"]}),p.PerformanceMarkers=void 0,(n=p.PerformanceMarkers||(p.PerformanceMarkers={})).create="create",n.load="load",n.fullLoad="fullLoad";let l=null,v=[];const E=1e3/30,C={mark(i){performance.mark(i)},frame(i){const t=i;l!=null&&v.push(t-l),l=t},clearMetrics(){l=null,v=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const i in p.PerformanceMarkers)performance.clearMarks(p.PerformanceMarkers[i])},getPerformanceMetrics(){performance.measure("loadTime",p.PerformanceMarkers.create,p.PerformanceMarkers.load),performance.measure("fullLoadTime",p.PerformanceMarkers.create,p.PerformanceMarkers.fullLoad);const i=performance.getEntriesByName("loadTime")[0].duration,t=performance.getEntriesByName("fullLoadTime")[0].duration,a=v.length,h=1/(v.reduce((b,S)=>b+S,0)/a/1e3),_=v.filter(b=>b>E).reduce((b,S)=>b+(S-E)/E,0);return{loadTime:i,fullLoadTime:t,fps:h,percentDroppedFrames:_/(a+_)*100}}};p.AJAXError=rt,p.ARRAY_TYPE=Bu,p.Actor=class{constructor(i,t,a){this.target=i,this.parent=t,this.mapId=a,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Le(["receive","process"],this),this.invoker=new gf(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=$t()?i:window}send(i,t,a,h,_=!1){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(this.callbacks[b]=a);const S=Ht(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:i,hasCallback:!!a,targetMapId:h,mustQueue:_,sourceMapId:this.mapId,data:Xa(t,S)},S),{cancel:()=>{a&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(i){const t=i.data,a=t.id;if(a&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[a];const h=this.cancelCallbacks[a];delete this.cancelCallbacks[a],h&&h()}else $t()||t.mustQueue?(this.tasks[a]=t,this.taskQueue.push(a),this.invoker.trigger()):this.processTask(a,t)}process(){if(!this.taskQueue.length)return;const i=this.taskQueue.shift(),t=this.tasks[i];delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(i,t)}processTask(i,t){if(t.type==="<response>"){const a=this.callbacks[i];delete this.callbacks[i],a&&(t.error?a(Pa(t.error)):a(null,Pa(t.data)))}else{let a=!1;const h=Ht(this.globalScope)?void 0:[],_=t.hasCallback?(P,R)=>{a=!0,delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:P?Xa(P):null,data:Xa(R,h)},h)}:P=>{a=!0};let b=null;const S=Pa(t.data);if(this.parent[t.type])b=this.parent[t.type](t.sourceMapId,S,_);else if(this.parent.getWorkerSource){const P=t.type.split(".");b=this.parent.getWorkerSource(t.sourceMapId,P[0],S.source)[P[1]](S,_)}else _(new Error(`Could not find function ${t.type}`));!a&&b&&b.cancel&&(this.cancelCallbacks[i]=b.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},p.AlphaImage=wh,p.CanonicalTileID=sh,p.CollisionBoxArray=dt,p.CollisionCircleLayoutArray=class extends ee{},p.Color=W,p.DEMData=wd,p.DataConstantProperty=ci,p.DictionaryCoder=Ed,p.EXTENT=hr,p.ErrorEvent=$n,p.EvaluationParameters=rn,p.Event=Ao,p.Evented=Ua,p.FeatureIndex=go,p.FillBucket=rd,p.FillExtrusionBucket=od,p.GeoJSONFeature=_f,p.ImageAtlas=hd,p.ImagePosition=cd,p.LineBucket=ad,p.LineStripIndexArray=class extends nt{},p.LngLat=Un,p.LngLatBounds=Gu,p.MercatorCoordinate=Os,p.ONE_EM=Do,p.OverscaledTileID=ma,p.PerformanceUtils=C,p.PosArray=class extends On{},p.Properties=fn,p.QuadTriangleArray=class extends ue{},p.RGBAImage=vs,p.RasterBoundsArray=class extends Vo{},p.RequestPerformance=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},p.ResourceType=Ft,p.SegmentVector=be,p.SymbolBucket=Ec,p.Transitionable=Ma,p.TriangleIndexArray=me,p.Uniform1f=lr,p.Uniform1i=class extends yi{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},p.Uniform2f=class extends yi{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},p.Uniform3f=class extends yi{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},p.Uniform4f=si,p.UniformColor=ji,p.UniformMatrix4f=class extends yi{constructor(i,t){super(i,t),this.current=ir}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},p.UnwrappedTileID=bp,p.ValidationError=_t,p.ZoomHistory=eu,p.addDynamicAttributes=vd,p.asyncAll=function(i,t,a){if(!i.length)return a(null,[]);let h=i.length;const _=new Array(i.length);let b=null;i.forEach((S,P)=>{t(S,(R,O)=>{R&&(b=R),_[P]=O,--h==0&&a(b,_)})})},p.bezier=U,p.bindAll=Le,p.cacheEntryPossiblyAdded=function(i){Ji++,Ji>xi&&(i.getActor().send("enforceCacheSizeLimit",Et),Ji=0)},p.clamp=X,p.clearTileCache=function(i){const t=caches.delete(bi);i&&t.catch(i).then(()=>i())},p.clipLine=bc,p.clone=function(i){var t=new Bu(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},p.clone$1=Re,p.collisionCircleLayout=nf,p.config=Dt,p.create=function(){var i=new Bu(16);return Bu!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},p.createExpression=Ha,p.createFilter=Ms,p.createLayout=Xt,p.createStyleLayer=function(i){return i.type==="custom"?new yn(i):new yf[i.type](i)},p.dot=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]*t[3]},p.ease=G,p.emitValidationErrors=ds,p.enforceCacheSizeLimit=function(i){Gt(),zt&&zt.then(t=>{t.keys().then(a=>{for(let h=0;h<a.length-i;h++)t.delete(a[h])})})},p.evaluateSizeForFeature=function(i,{uSize:t,uSizeT:a},{lowerSize:h,upperSize:_}){return i.kind==="source"?h/zl:i.kind==="composite"?jn(h/zl,_/zl,a):t},p.evaluateSizeForZoom=function(i,t){let a=0,h=0;if(i.kind==="constant")h=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:_,minZoom:b,maxZoom:S}=i,P=_?X(mo.interpolationFactor(_,t,b,S),0,1):0;i.kind==="camera"?h=jn(i.minSize,i.maxSize,P):a=P}return{uSizeT:a,uSize:h}},p.evaluateVariableOffset=nh,p.evented=ms,p.exported=Si,p.exported$1=Ni,p.extend=ge,p.filterObject=Ue,p.getAnchorAlignment=pp,p.getAnchorJustification=Hr,p.getArrayBuffer=ho,p.getImage=Yn,p.getJSON=function(i,t){return Pr(ge(i,{type:"json"}),t)},p.getOverlapMode=qu,p.getRTLTextPluginStatus=iu,p.getReferrer=wi,p.getVideo=function(i,t){const a=window.document.createElement("video");a.muted=!0,a.onloadstart=function(){t(null,a)};for(let h=0;h<i.length;h++){const _=window.document.createElement("source");Jn(i[h])||(a.crossOrigin="Anonymous"),_.src=i[h],a.appendChild(_)}return{cancel:()=>{}}},p.identity=Ou,p.invert=function(i,t){var a=t[0],h=t[1],_=t[2],b=t[3],S=t[4],P=t[5],R=t[6],O=t[7],V=t[8],j=t[9],K=t[10],$=t[11],Q=t[12],se=t[13],pe=t[14],ke=t[15],Ne=a*P-h*S,Ze=a*R-_*S,He=a*O-b*S,it=h*R-_*P,We=h*O-b*P,kt=_*O-b*R,At=V*se-j*Q,pt=V*pe-K*Q,Tt=V*ke-$*Q,gt=j*pe-K*se,Pt=j*ke-$*se,mt=K*ke-$*pe,vt=Ne*mt-Ze*Pt+He*gt+it*Tt-We*pt+kt*At;return vt?(i[0]=(P*mt-R*Pt+O*gt)*(vt=1/vt),i[1]=(_*Pt-h*mt-b*gt)*vt,i[2]=(se*kt-pe*We+ke*it)*vt,i[3]=(K*We-j*kt-$*it)*vt,i[4]=(R*Tt-S*mt-O*pt)*vt,i[5]=(a*mt-_*Tt+b*pt)*vt,i[6]=(pe*He-Q*kt-ke*Ze)*vt,i[7]=(V*kt-K*He+$*Ze)*vt,i[8]=(S*Pt-P*Tt+O*At)*vt,i[9]=(h*Tt-a*Pt-b*At)*vt,i[10]=(Q*We-se*He+ke*Ne)*vt,i[11]=(j*He-V*We-$*Ne)*vt,i[12]=(P*pt-S*gt-R*At)*vt,i[13]=(a*gt-h*pt+_*At)*vt,i[14]=(se*Ze-Q*it-pe*Ne)*vt,i[15]=(V*it-j*Ze+K*Ne)*vt,i):null},p.isImageBitmap=Qt,p.isSafari=Ht,p.keysDifference=function(i,t){const a=[];for(const h in i)h in t||a.push(h);return a},p.lazyLoadRTLTextPlugin=function(){dn.isLoading()||dn.isLoaded()||iu()!=="deferred"||jo()},p.makeRequest=Pr,p.mapObject=ft,p.mercatorXfromLng=Hu,p.mercatorYfromLat=bd,p.mercatorZfromAltitude=qn,p.mul=rp,p.multiply=ip,p.nextPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},p.number=jn,p.ortho=function(i,t,a,h,_,b,S){var P=1/(t-a),R=1/(h-_),O=1/(b-S);return i[0]=-2*P,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*R,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*O,i[11]=0,i[12]=(t+a)*P,i[13]=(_+h)*R,i[14]=(S+b)*O,i[15]=1,i},p.parseCacheControl=xt,p.parseGlyphPBF=function(i){return new sd(i).readFields(cp,[])},p.pbf=sd,p.performSymbolLayout=function(i,t,a,h,_,b,S){i.createArrays(),i.tilePixelRatio=hr/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const P=i.layers[0].layout,R=i.layers[0]._unevaluatedLayout._values,O={layoutIconSize:R["icon-size"].possiblyEvaluate(new rn(i.zoom+1),S),layoutTextSize:R["text-size"].possiblyEvaluate(new rn(i.zoom+1),S),textMaxSize:R["text-size"].possiblyEvaluate(new rn(18))};if(i.textSizeData.kind==="composite"){const{minZoom:Q,maxZoom:se}=i.textSizeData;O.compositeTextSizes=[R["text-size"].possiblyEvaluate(new rn(Q),S),R["text-size"].possiblyEvaluate(new rn(se),S)]}if(i.iconSizeData.kind==="composite"){const{minZoom:Q,maxZoom:se}=i.iconSizeData;O.compositeIconSizes=[R["icon-size"].possiblyEvaluate(new rn(Q),S),R["icon-size"].possiblyEvaluate(new rn(se),S)]}const V=P.get("text-line-height")*Do,j=P.get("text-rotation-alignment")!=="viewport"&&P.get("symbol-placement")!=="point",K=P.get("text-keep-upright"),$=P.get("text-size");for(const Q of i.features){const se=P.get("text-font").evaluate(Q,{},S).join(","),pe=$.evaluate(Q,{},S),ke=O.layoutTextSize.evaluate(Q,{},S),Ne=O.layoutIconSize.evaluate(Q,{},S),Ze={horizontal:{},vertical:void 0},He=Q.text;let it,We=[0,0];if(He){const pt=He.toString(),Tt=P.get("text-letter-spacing").evaluate(Q,{},S)*Do,gt=Sl(pt)?Tt:0,Pt=P.get("text-anchor").evaluate(Q,{},S),mt=P.get("text-variable-anchor");if(!mt){const Bi=P.get("text-radial-offset").evaluate(Q,{},S);We=Bi?nh(Pt,[Bi*Do,ju]):P.get("text-offset").evaluate(Q,{},S).map(Qi=>Qi*Do)}let vt=j?"center":P.get("text-justify").evaluate(Q,{},S);const oi=P.get("symbol-placement"),ri=oi==="point"?P.get("text-max-width").evaluate(Q,{},S)*Do:0,Mi=()=>{i.allowVerticalPlacement&&tl(pt)&&(Ze.vertical=Lh(He,t,a,_,se,ri,V,Pt,"left",gt,We,p.WritingMode.vertical,!0,oi,ke,pe))};if(!j&&mt){const Bi=vt==="auto"?mt.map(ur=>Hr(ur)):[vt];let Qi=!1;for(let ur=0;ur<Bi.length;ur++){const kr=Bi[ur];if(!Ze.horizontal[kr])if(Qi)Ze.horizontal[kr]=Ze.horizontal[0];else{const zr=Lh(He,t,a,_,se,ri,V,"center",kr,gt,We,p.WritingMode.horizontal,!1,oi,ke,pe);zr&&(Ze.horizontal[kr]=zr,Qi=zr.positionedLines.length===1)}}Mi()}else{vt==="auto"&&(vt=Hr(Pt));const Bi=Lh(He,t,a,_,se,ri,V,Pt,vt,gt,We,p.WritingMode.horizontal,!1,oi,ke,pe);Bi&&(Ze.horizontal[vt]=Bi),Mi(),tl(pt)&&j&&K&&(Ze.vertical=Lh(He,t,a,_,se,ri,V,Pt,vt,gt,We,p.WritingMode.vertical,!1,oi,ke,pe))}}let kt=!1;if(Q.icon&&Q.icon.name){const pt=h[Q.icon.name];pt&&(it=Xm(_[Q.icon.name],P.get("icon-offset").evaluate(Q,{},S),P.get("icon-anchor").evaluate(Q,{},S)),kt=!!pt.sdf,i.sdfIcons===void 0?i.sdfIcons=kt:i.sdfIcons!==kt&&ut("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pt.pixelRatio!==i.pixelRatio||P.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const At=df(Ze.horizontal)||Ze.vertical;i.iconsInText=!!At&&At.iconsInText,(At||it)&&Qm(i,Q,Ze,it,h,O,ke,Ne,We,kt,S)}b&&i.generateCollisionDebugBuffers()},p.perspective=function(i,t,a,h,_){var b,S=1/Math.tan(t/2);return i[0]=S/a,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=S,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,_!=null&&_!==1/0?(i[10]=(_+h)*(b=1/(h-_)),i[14]=2*_*h*b):(i[10]=-1,i[14]=-2*h),i},p.pick=function(i,t){const a={};for(let h=0;h<t.length;h++){const _=t[h];_ in i&&(a[_]=i[_])}return a},p.plugin=dn,p.pointGeometry=bt,p.polygonIntersectsPolygon=Lu,p.potpack=ud,p.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],p.register=ti,p.registerForPluginStateChange=function(i){return i({pluginStatus:ln,pluginURL:Ka}),ms.on("pluginStateChange",i),i},p.renderColorRamp=Zd,p.rotateX=function(i,t,a){var h=Math.sin(a),_=Math.cos(a),b=t[4],S=t[5],P=t[6],R=t[7],O=t[8],V=t[9],j=t[10],K=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=b*_+O*h,i[5]=S*_+V*h,i[6]=P*_+j*h,i[7]=R*_+K*h,i[8]=O*_-b*h,i[9]=V*_-S*h,i[10]=j*_-P*h,i[11]=K*_-R*h,i},p.rotateZ=function(i,t,a){var h=Math.sin(a),_=Math.cos(a),b=t[0],S=t[1],P=t[2],R=t[3],O=t[4],V=t[5],j=t[6],K=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=b*_+O*h,i[1]=S*_+V*h,i[2]=P*_+j*h,i[3]=R*_+K*h,i[4]=O*_-b*h,i[5]=V*_-S*h,i[6]=j*_-P*h,i[7]=K*_-R*h,i},p.scale=function(i,t,a){var h=a[0],_=a[1],b=a[2];return i[0]=t[0]*h,i[1]=t[1]*h,i[2]=t[2]*h,i[3]=t[3]*h,i[4]=t[4]*_,i[5]=t[5]*_,i[6]=t[6]*_,i[7]=t[7]*_,i[8]=t[8]*b,i[9]=t[9]*b,i[10]=t[10]*b,i[11]=t[11]*b,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},p.scale$1=function(i,t,a){return i[0]=t[0]*a,i[1]=t[1]*a,i[2]=t[2]*a,i[3]=t[3]*a,i},p.setCacheLimits=function(i,t){Et=i,xi=t},p.setRTLTextPlugin=function(i,t,a=!1){if(ln===So||ln===Tl||ln===Ds)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ka=Si.resolveURL(i),ln=So,da=t,tu(),a||jo()},p.spec=qe,p.sphericalToCartesian=function([i,t,a]){return t+=90,t*=Math.PI/180,a*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(a),y:i*Math.sin(t)*Math.sin(a),z:i*Math.cos(a)}},p.toEvaluationFeature=ro,p.transformMat4=ol,p.translate=function(i,t,a){var h,_,b,S,P,R,O,V,j,K,$,Q,se=a[0],pe=a[1],ke=a[2];return t===i?(i[12]=t[0]*se+t[4]*pe+t[8]*ke+t[12],i[13]=t[1]*se+t[5]*pe+t[9]*ke+t[13],i[14]=t[2]*se+t[6]*pe+t[10]*ke+t[14],i[15]=t[3]*se+t[7]*pe+t[11]*ke+t[15]):(_=t[1],b=t[2],S=t[3],P=t[4],R=t[5],O=t[6],V=t[7],j=t[8],K=t[9],$=t[10],Q=t[11],i[0]=h=t[0],i[1]=_,i[2]=b,i[3]=S,i[4]=P,i[5]=R,i[6]=O,i[7]=V,i[8]=j,i[9]=K,i[10]=$,i[11]=Q,i[12]=h*se+P*pe+j*ke+t[12],i[13]=_*se+R*pe+K*ke+t[13],i[14]=b*se+O*pe+$*ke+t[14],i[15]=S*se+V*pe+Q*ke+t[15]),i},p.triggerPluginCompletionEvent=Wt,p.unicodeBlockLookup=ai,p.uniqueId=function(){return De++},p.validateCustomStyleLayer=function(i){const t=[],a=i.id;return a===void 0&&t.push({message:`layers.${a}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${a}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),t},p.validateLight=sn,p.validateStyle=pa,p.vectorTile=Uu,p.warnOnce=ut,p.wrap=Se}),z(["./shared"],function(p){function L(ae){const H=typeof ae;if(H==="number"||H==="boolean"||H==="string"||ae==null)return JSON.stringify(ae);if(Array.isArray(ae)){let ce="[";for(const ve of ae)ce+=`${L(ve)},`;return`${ce}]`}const W=Object.keys(ae).sort();let ne="{";for(let ce=0;ce<W.length;ce++)ne+=`${JSON.stringify(W[ce])}:${L(ae[W[ce]])},`;return`${ne}}`}function N(ae){let H="";for(const W of p.refProperties)H+=`/${L(ae[W])}`;return H}class U{constructor(H){this.keyCache={},H&&this.replace(H)}replace(H){this._layerConfigs={},this._layers={},this.update(H,[])}update(H,W){for(const ce of H){this._layerConfigs[ce.id]=ce;const ve=this._layers[ce.id]=p.createStyleLayer(ce);ve._featureFilter=p.createFilter(ve.filter),this.keyCache[ce.id]&&delete this.keyCache[ce.id]}for(const ce of W)delete this.keyCache[ce],delete this._layerConfigs[ce],delete this._layers[ce];this.familiesBySource={};const ne=function(ce,ve){const fe={};for(let Ee=0;Ee<ce.length;Ee++){const Te=ve&&ve[ce[Ee].id]||N(ce[Ee]);ve&&(ve[ce[Ee].id]=Te);let et=fe[Te];et||(et=fe[Te]=[]),et.push(ce[Ee])}const Ie=[];for(const Ee in fe)Ie.push(fe[Ee]);return Ie}(Object.values(this._layerConfigs),this.keyCache);for(const ce of ne){const ve=ce.map(Ke=>this._layers[Ke.id]),fe=ve[0];if(fe.visibility==="none")continue;const Ie=fe.source||"";let Ee=this.familiesBySource[Ie];Ee||(Ee=this.familiesBySource[Ie]={});const Te=fe.sourceLayer||"_geojsonTileLayer";let et=Ee[Te];et||(et=Ee[Te]=[]),et.push(ve)}}}class G{constructor(H){const W={},ne=[];for(const Ie in H){const Ee=H[Ie],Te=W[Ie]={};for(const et in Ee){const Ke=Ee[+et];if(!Ke||Ke.bitmap.width===0||Ke.bitmap.height===0)continue;const tt={x:0,y:0,w:Ke.bitmap.width+2,h:Ke.bitmap.height+2};ne.push(tt),Te[et]={rect:tt,metrics:Ke.metrics}}}const{w:ce,h:ve}=p.potpack(ne),fe=new p.AlphaImage({width:ce||1,height:ve||1});for(const Ie in H){const Ee=H[Ie];for(const Te in Ee){const et=Ee[+Te];if(!et||et.bitmap.width===0||et.bitmap.height===0)continue;const Ke=W[Ie][Te].rect;p.AlphaImage.copy(et.bitmap,fe,{x:0,y:0},{x:Ke.x+1,y:Ke.y+1},et.bitmap)}}this.image=fe,this.positions=W}}p.register("GlyphAtlas",G);class X{constructor(H){this.tileID=new p.OverscaledTileID(H.tileID.overscaledZ,H.tileID.wrap,H.tileID.canonical.z,H.tileID.canonical.x,H.tileID.canonical.y),this.uid=H.uid,this.zoom=H.zoom,this.pixelRatio=H.pixelRatio,this.tileSize=H.tileSize,this.source=H.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=H.showCollisionBoxes,this.collectResourceTiming=!!H.collectResourceTiming,this.returnDependencies=!!H.returnDependencies,this.promoteId=H.promoteId}parse(H,W,ne,ce,ve){this.status="parsing",this.data=H,this.collisionBoxArray=new p.CollisionBoxArray;const fe=new p.DictionaryCoder(Object.keys(H.layers).sort()),Ie=new p.FeatureIndex(this.tileID,this.promoteId);Ie.bucketLayerIDs=[];const Ee={},Te={featureIndex:Ie,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ne},et=W.familiesBySource[this.source];for(const Pi in et){const di=H.layers[Pi];if(!di)continue;di.version===1&&p.warnOnce(`Vector tile source "${this.source}" layer "${Pi}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ei=fe.encode(Pi),Ui=[];for(let Ir=0;Ir<di.length;Ir++){const kn=di.feature(Ir),Cr=Ie.getId(kn,Pi);Ui.push({feature:kn,id:Cr,index:Ir,sourceLayerIndex:ei})}for(const Ir of et[Pi]){const kn=Ir[0];kn.minzoom&&this.zoom<Math.floor(kn.minzoom)||kn.maxzoom&&this.zoom>=kn.maxzoom||kn.visibility!=="none"&&(Se(Ir,this.zoom,ne),(Ee[kn.id]=kn.createBucket({index:Ie.bucketLayerIDs.length,layers:Ir,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ei,sourceID:this.source})).populate(Ui,Te,this.tileID.canonical),Ie.bucketLayerIDs.push(Ir.map(Cr=>Cr.id)))}}let Ke,tt,jt,Ct;const Ut=p.mapObject(Te.glyphDependencies,Pi=>Object.keys(Pi).map(Number));Object.keys(Ut).length?ce.send("getGlyphs",{uid:this.uid,stacks:Ut},(Pi,di)=>{Ke||(Ke=Pi,tt=di,vi.call(this))}):tt={};const Zt=Object.keys(Te.iconDependencies);Zt.length?ce.send("getImages",{icons:Zt,source:this.source,tileID:this.tileID,type:"icons"},(Pi,di)=>{Ke||(Ke=Pi,jt=di,vi.call(this))}):jt={};const Xi=Object.keys(Te.patternDependencies);function vi(){if(Ke)return ve(Ke);if(tt&&jt&&Ct){const Pi=new G(tt),di=new p.ImageAtlas(jt,Ct);for(const ei in Ee){const Ui=Ee[ei];Ui instanceof p.SymbolBucket?(Se(Ui.layers,this.zoom,ne),p.performSymbolLayout(Ui,tt,Pi.positions,jt,di.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Ui.hasPattern&&(Ui instanceof p.LineBucket||Ui instanceof p.FillBucket||Ui instanceof p.FillExtrusionBucket)&&(Se(Ui.layers,this.zoom,ne),Ui.addFeatures(Te,this.tileID.canonical,di.patternPositions))}this.status="done",ve(null,{buckets:Object.values(Ee).filter(ei=>!ei.isEmpty()),featureIndex:Ie,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Pi.image,imageAtlas:di,glyphMap:this.returnDependencies?tt:null,iconMap:this.returnDependencies?jt:null,glyphPositions:this.returnDependencies?Pi.positions:null})}}Xi.length?ce.send("getImages",{icons:Xi,source:this.source,tileID:this.tileID,type:"patterns"},(Pi,di)=>{Ke||(Ke=Pi,Ct=di,vi.call(this))}):Ct={},vi.call(this)}}function Se(ae,H,W){const ne=new p.EvaluationParameters(H);for(const ce of ae)ce.recalculate(ne,W)}function ge(ae,H){const W=p.getArrayBuffer(ae.request,(ne,ce,ve,fe)=>{ne?H(ne):ce&&H(null,{vectorTile:new p.vectorTile.VectorTile(new p.pbf(ce)),rawData:ce,cacheControl:ve,expires:fe})});return()=>{W.cancel(),H()}}class De{constructor(H,W,ne,ce){this.actor=H,this.layerIndex=W,this.availableImages=ne,this.loadVectorData=ce||ge,this.loading={},this.loaded={}}loadTile(H,W){const ne=H.uid;this.loading||(this.loading={});const ce=!!(H&&H.request&&H.request.collectResourceTiming)&&new p.RequestPerformance(H.request),ve=this.loading[ne]=new X(H);ve.abort=this.loadVectorData(H,(fe,Ie)=>{if(delete this.loading[ne],fe||!Ie)return ve.status="done",this.loaded[ne]=ve,W(fe);const Ee=Ie.rawData,Te={};Ie.expires&&(Te.expires=Ie.expires),Ie.cacheControl&&(Te.cacheControl=Ie.cacheControl);const et={};if(ce){const Ke=ce.finish();Ke&&(et.resourceTiming=JSON.parse(JSON.stringify(Ke)))}ve.vectorTile=Ie.vectorTile,ve.parse(Ie.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ke,tt)=>{if(Ke||!tt)return W(Ke);W(null,p.extend({rawTileData:Ee.slice(0)},tt,Te,et))}),this.loaded=this.loaded||{},this.loaded[ne]=ve})}reloadTile(H,W){const ne=this.loaded,ce=H.uid,ve=this;if(ne&&ne[ce]){const fe=ne[ce];fe.showCollisionBoxes=H.showCollisionBoxes;const Ie=(Ee,Te)=>{const et=fe.reloadCallback;et&&(delete fe.reloadCallback,fe.parse(fe.vectorTile,ve.layerIndex,this.availableImages,ve.actor,et)),W(Ee,Te)};fe.status==="parsing"?fe.reloadCallback=Ie:fe.status==="done"&&(fe.vectorTile?fe.parse(fe.vectorTile,this.layerIndex,this.availableImages,this.actor,Ie):Ie())}}abortTile(H,W){const ne=this.loading,ce=H.uid;ne&&ne[ce]&&ne[ce].abort&&(ne[ce].abort(),delete ne[ce]),W()}removeTile(H,W){const ne=this.loaded,ce=H.uid;ne&&ne[ce]&&delete ne[ce],W()}}class Le{constructor(){this.loaded={}}loadTile(H,W){const{uid:ne,encoding:ce,rawImageData:ve}=H,fe=p.isImageBitmap(ve)?this.getImageData(ve):ve,Ie=new p.DEMData(ne,fe,ce);this.loaded=this.loaded||{},this.loaded[ne]=Ie,W(null,Ie)}getImageData(H){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(H.width,H.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=H.width,this.offscreenCanvas.height=H.height,this.offscreenCanvasContext.drawImage(H,0,0,H.width,H.height);const W=this.offscreenCanvasContext.getImageData(-1,-1,H.width+2,H.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new p.RGBAImage({width:W.width,height:W.height},W.data)}removeTile(H){const W=this.loaded,ne=H.uid;W&&W[ne]&&delete W[ne]}}var ft=function ae(H,W){var ne,ce=H&&H.type;if(ce==="FeatureCollection")for(ne=0;ne<H.features.length;ne++)ae(H.features[ne],W);else if(ce==="GeometryCollection")for(ne=0;ne<H.geometries.length;ne++)ae(H.geometries[ne],W);else if(ce==="Feature")ae(H.geometry,W);else if(ce==="Polygon")Ue(H.coordinates,W);else if(ce==="MultiPolygon")for(ne=0;ne<H.coordinates.length;ne++)Ue(H.coordinates[ne],W);return H};function Ue(ae,H){if(ae.length!==0){Re(ae[0],H);for(var W=1;W<ae.length;W++)Re(ae[W],!H)}}function Re(ae,H){for(var W=0,ne=0,ce=0,ve=ae.length,fe=ve-1;ce<ve;fe=ce++){var Ie=(ae[ce][0]-ae[fe][0])*(ae[fe][1]+ae[ce][1]),Ee=W+Ie;ne+=Math.abs(W)>=Math.abs(Ie)?W-Ee+Ie:Ie-Ee+W,W=Ee}W+ne>=0!=!!H&&ae.reverse()}const st=p.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ut{constructor(H){this._feature=H,this.extent=p.EXTENT,this.type=H.type,this.properties=H.tags,"id"in H&&!isNaN(H.id)&&(this.id=parseInt(H.id,10))}loadGeometry(){if(this._feature.type===1){const H=[];for(const W of this._feature.geometry)H.push([new p.pointGeometry(W[0],W[1])]);return H}{const H=[];for(const W of this._feature.geometry){const ne=[];for(const ce of W)ne.push(new p.pointGeometry(ce[0],ce[1]));H.push(ne)}return H}}toGeoJSON(H,W,ne){return st.call(this,H,W,ne)}}class ht{constructor(H){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=p.EXTENT,this.length=H.length,this._features=H}feature(H){return new ut(this._features[H])}}var at={exports:{}},$t=p.pointGeometry,xt=p.vectorTile.VectorTileFeature,qt=_i;function _i(ae,H){this.options=H||{},this.features=ae,this.length=ae.length}function Ri(ae,H){this.id=typeof ae.id=="number"?ae.id:void 0,this.type=ae.type,this.rawGeometry=ae.type===1?[ae.geometry]:ae.geometry,this.properties=ae.tags,this.extent=H||4096}_i.prototype.feature=function(ae){return new Ri(this.features[ae],this.options.extent)},Ri.prototype.loadGeometry=function(){var ae=this.rawGeometry;this.geometry=[];for(var H=0;H<ae.length;H++){for(var W=ae[H],ne=[],ce=0;ce<W.length;ce++)ne.push(new $t(W[ce][0],W[ce][1]));this.geometry.push(ne)}return this.geometry},Ri.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ae=this.geometry,H=1/0,W=-1/0,ne=1/0,ce=-1/0,ve=0;ve<ae.length;ve++)for(var fe=ae[ve],Ie=0;Ie<fe.length;Ie++){var Ee=fe[Ie];H=Math.min(H,Ee.x),W=Math.max(W,Ee.x),ne=Math.min(ne,Ee.y),ce=Math.max(ce,Ee.y)}return[H,ne,W,ce]},Ri.prototype.toGeoJSON=xt.prototype.toGeoJSON;var Ht=p.pbf,Qt=qt;function Si(ae){var H=new Ht;return function(W,ne){for(var ce in W.layers)ne.writeMessage(3,bt,W.layers[ce])}(ae,H),H.finish()}function bt(ae,H){var W;H.writeVarintField(15,ae.version||1),H.writeStringField(1,ae.name||""),H.writeVarintField(5,ae.extent||4096);var ne={keys:[],values:[],keycache:{},valuecache:{}};for(W=0;W<ae.length;W++)ne.feature=ae.feature(W),H.writeMessage(2,Fi,ne);var ce=ne.keys;for(W=0;W<ce.length;W++)H.writeStringField(3,ce[W]);var ve=ne.values;for(W=0;W<ve.length;W++)H.writeMessage(4,Et,ve[W])}function Fi(ae,H){var W=ae.feature;W.id!==void 0&&H.writeVarintField(1,W.id),H.writeMessage(2,Dt,ae),H.writeVarintField(3,W.type),H.writeMessage(4,Yt,W)}function Dt(ae,H){var W=ae.feature,ne=ae.keys,ce=ae.values,ve=ae.keycache,fe=ae.valuecache;for(var Ie in W.properties){var Ee=W.properties[Ie],Te=ve[Ie];if(Ee!==null){Te===void 0&&(ne.push(Ie),ve[Ie]=Te=ne.length-1),H.writeVarint(Te);var et=typeof Ee;et!=="string"&&et!=="boolean"&&et!=="number"&&(Ee=JSON.stringify(Ee));var Ke=et+":"+Ee,tt=fe[Ke];tt===void 0&&(ce.push(Ee),fe[Ke]=tt=ce.length-1),H.writeVarint(tt)}}}function bi(ae,H){return(H<<3)+(7&ae)}function zt(ae){return ae<<1^ae>>31}function Yt(ae,H){for(var W=ae.loadGeometry(),ne=ae.type,ce=0,ve=0,fe=W.length,Ie=0;Ie<fe;Ie++){var Ee=W[Ie],Te=1;ne===1&&(Te=Ee.length),H.writeVarint(bi(1,Te));for(var et=ne===3?Ee.length-1:Ee.length,Ke=0;Ke<et;Ke++){Ke===1&&ne!==1&&H.writeVarint(bi(2,et-1));var tt=Ee[Ke].x-ce,jt=Ee[Ke].y-ve;H.writeVarint(zt(tt)),H.writeVarint(zt(jt)),ce+=tt,ve+=jt}ne===3&&H.writeVarint(bi(7,1))}}function Et(ae,H){var W=typeof ae;W==="string"?H.writeStringField(1,ae):W==="boolean"?H.writeBooleanField(7,ae):W==="number"&&(ae%1!=0?H.writeDoubleField(3,ae):ae<0?H.writeSVarintField(6,ae):H.writeVarintField(5,ae))}at.exports=Si,at.exports.fromVectorTileJs=Si,at.exports.fromGeojsonVt=function(ae,H){H=H||{};var W={};for(var ne in ae)W[ne]=new Qt(ae[ne].features,H),W[ne].name=ne,W[ne].version=H.version,W[ne].extent=H.extent;return Si({layers:W})},at.exports.GeoJSONWrapper=Qt;var xi=at.exports;function Gt(ae,H,W,ne,ce,ve){if(ce-ne<=W)return;const fe=ne+ce>>1;Ji(ae,H,fe,ne,ce,ve%2),Gt(ae,H,W,ne,fe-1,ve+1),Gt(ae,H,W,fe+1,ce,ve+1)}function Ji(ae,H,W,ne,ce,ve){for(;ce>ne;){if(ce-ne>600){const Te=ce-ne+1,et=W-ne+1,Ke=Math.log(Te),tt=.5*Math.exp(2*Ke/3),jt=.5*Math.sqrt(Ke*tt*(Te-tt)/Te)*(et-Te/2<0?-1:1);Ji(ae,H,W,Math.max(ne,Math.floor(W-et*tt/Te+jt)),Math.min(ce,Math.floor(W+(Te-et)*tt/Te+jt)),ve)}const fe=H[2*W+ve];let Ie=ne,Ee=ce;for(Ni(ae,H,ne,W),H[2*ce+ve]>fe&&Ni(ae,H,ne,ce);Ie<Ee;){for(Ni(ae,H,Ie,Ee),Ie++,Ee--;H[2*Ie+ve]<fe;)Ie++;for(;H[2*Ee+ve]>fe;)Ee--}H[2*ne+ve]===fe?Ni(ae,H,ne,Ee):(Ee++,Ni(ae,H,Ee,ce)),Ee<=W&&(ne=Ee+1),W<=Ee&&(ce=Ee-1)}}function Ni(ae,H,W,ne){Ai(ae,W,ne),Ai(H,2*W,2*ne),Ai(H,2*W+1,2*ne+1)}function Ai(ae,H,W){const ne=ae[H];ae[H]=ae[W],ae[W]=ne}function or(ae,H,W,ne){const ce=ae-W,ve=H-ne;return ce*ce+ve*ve}const Li=ae=>ae[0],Mt=ae=>ae[1];class rr{constructor(H,W=Li,ne=Mt,ce=64,ve=Float64Array){this.nodeSize=ce,this.points=H;const fe=H.length<65536?Uint16Array:Uint32Array,Ie=this.ids=new fe(H.length),Ee=this.coords=new ve(2*H.length);for(let Te=0;Te<H.length;Te++)Ie[Te]=Te,Ee[2*Te]=W(H[Te]),Ee[2*Te+1]=ne(H[Te]);Gt(Ie,Ee,ce,0,Ie.length-1,0)}range(H,W,ne,ce){return function(ve,fe,Ie,Ee,Te,et,Ke){const tt=[0,ve.length-1,0],jt=[];let Ct,Ut;for(;tt.length;){const Zt=tt.pop(),Xi=tt.pop(),vi=tt.pop();if(Xi-vi<=Ke){for(let ei=vi;ei<=Xi;ei++)Ct=fe[2*ei],Ut=fe[2*ei+1],Ct>=Ie&&Ct<=Te&&Ut>=Ee&&Ut<=et&&jt.push(ve[ei]);continue}const Pi=Math.floor((vi+Xi)/2);Ct=fe[2*Pi],Ut=fe[2*Pi+1],Ct>=Ie&&Ct<=Te&&Ut>=Ee&&Ut<=et&&jt.push(ve[Pi]);const di=(Zt+1)%2;(Zt===0?Ie<=Ct:Ee<=Ut)&&(tt.push(vi),tt.push(Pi-1),tt.push(di)),(Zt===0?Te>=Ct:et>=Ut)&&(tt.push(Pi+1),tt.push(Xi),tt.push(di))}return jt}(this.ids,this.coords,H,W,ne,ce,this.nodeSize)}within(H,W,ne){return function(ce,ve,fe,Ie,Ee,Te){const et=[0,ce.length-1,0],Ke=[],tt=Ee*Ee;for(;et.length;){const jt=et.pop(),Ct=et.pop(),Ut=et.pop();if(Ct-Ut<=Te){for(let di=Ut;di<=Ct;di++)or(ve[2*di],ve[2*di+1],fe,Ie)<=tt&&Ke.push(ce[di]);continue}const Zt=Math.floor((Ut+Ct)/2),Xi=ve[2*Zt],vi=ve[2*Zt+1];or(Xi,vi,fe,Ie)<=tt&&Ke.push(ce[Zt]);const Pi=(jt+1)%2;(jt===0?fe-Ee<=Xi:Ie-Ee<=vi)&&(et.push(Ut),et.push(Zt-1),et.push(Pi)),(jt===0?fe+Ee>=Xi:Ie+Ee>=vi)&&(et.push(Zt+1),et.push(Ct),et.push(Pi))}return Ke}(this.ids,this.coords,H,W,ne,this.nodeSize)}}const Ft={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ae=>ae},rt=Math.fround||(wi=new Float32Array(1),ae=>(wi[0]=+ae,wi[0]));var wi;class nr{constructor(H){this.options=Wi(Object.create(Ft),H),this.trees=new Array(this.options.maxZoom+1)}load(H){const{log:W,minZoom:ne,maxZoom:ce,nodeSize:ve}=this.options;W&&console.time("total time");const fe=`prepare ${H.length} points`;W&&console.time(fe),this.points=H;let Ie=[];for(let Ee=0;Ee<H.length;Ee++)H[Ee].geometry&&Ie.push(ho(H[Ee],Ee));this.trees[ce+1]=new rr(Ie,Nn,Ao,ve,Float32Array),W&&console.timeEnd(fe);for(let Ee=ce;Ee>=ne;Ee--){const Te=+Date.now();Ie=this._cluster(Ie,Ee),this.trees[Ee]=new rr(Ie,Nn,Ao,ve,Float32Array),W&&console.log("z%d: %d clusters in %dms",Ee,Ie.length,+Date.now()-Te)}return W&&console.timeEnd("total time"),this}getClusters(H,W){let ne=((H[0]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,H[1]));let ve=H[2]===180?180:((H[2]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,H[3]));if(H[2]-H[0]>=360)ne=-180,ve=180;else if(ne>ve){const et=this.getClusters([ne,ce,180,fe],W),Ke=this.getClusters([-180,ce,ve,fe],W);return et.concat(Ke)}const Ie=this.trees[this._limitZoom(W)],Ee=Ie.range(xn(ne),po(fe),xn(ve),po(ce)),Te=[];for(const et of Ee){const Ke=Ie.points[et];Te.push(Ke.numPoints?Jn(Ke):this.points[Ke.index])}return Te}getChildren(H){const W=this._getOriginId(H),ne=this._getOriginZoom(H),ce="No cluster with the specified id.",ve=this.trees[ne];if(!ve)throw new Error(ce);const fe=ve.points[W];if(!fe)throw new Error(ce);const Ie=this.options.radius/(this.options.extent*Math.pow(2,ne-1)),Ee=ve.within(fe.x,fe.y,Ie),Te=[];for(const et of Ee){const Ke=ve.points[et];Ke.parentId===H&&Te.push(Ke.numPoints?Jn(Ke):this.points[Ke.index])}if(Te.length===0)throw new Error(ce);return Te}getLeaves(H,W,ne){const ce=[];return this._appendLeaves(ce,H,W=W||10,ne=ne||0,0),ce}getTile(H,W,ne){const ce=this.trees[this._limitZoom(H)],ve=Math.pow(2,H),{extent:fe,radius:Ie}=this.options,Ee=Ie/fe,Te=(ne-Ee)/ve,et=(ne+1+Ee)/ve,Ke={features:[]};return this._addTileFeatures(ce.range((W-Ee)/ve,Te,(W+1+Ee)/ve,et),ce.points,W,ne,ve,Ke),W===0&&this._addTileFeatures(ce.range(1-Ee/ve,Te,1,et),ce.points,ve,ne,ve,Ke),W===ve-1&&this._addTileFeatures(ce.range(0,Te,Ee/ve,et),ce.points,-1,ne,ve,Ke),Ke.features.length?Ke:null}getClusterExpansionZoom(H){let W=this._getOriginZoom(H)-1;for(;W<=this.options.maxZoom;){const ne=this.getChildren(H);if(W++,ne.length!==1)break;H=ne[0].properties.cluster_id}return W}_appendLeaves(H,W,ne,ce,ve){const fe=this.getChildren(W);for(const Ie of fe){const Ee=Ie.properties;if(Ee&&Ee.cluster?ve+Ee.point_count<=ce?ve+=Ee.point_count:ve=this._appendLeaves(H,Ee.cluster_id,ne,ce,ve):ve<ce?ve++:H.push(Ie),H.length===ne)break}return ve}_addTileFeatures(H,W,ne,ce,ve,fe){for(const Ie of H){const Ee=W[Ie],Te=Ee.numPoints;let et,Ke,tt;if(Te)et=Fo(Ee),Ke=Ee.x,tt=Ee.y;else{const Ut=this.points[Ee.index];et=Ut.properties,Ke=xn(Ut.geometry.coordinates[0]),tt=po(Ut.geometry.coordinates[1])}const jt={type:1,geometry:[[Math.round(this.options.extent*(Ke*ve-ne)),Math.round(this.options.extent*(tt*ve-ce))]],tags:et};let Ct;Te?Ct=Ee.id:this.options.generateId?Ct=Ee.index:this.points[Ee.index].id&&(Ct=this.points[Ee.index].id),Ct!==void 0&&(jt.id=Ct),fe.features.push(jt)}}_limitZoom(H){return Math.max(this.options.minZoom,Math.min(+H,this.options.maxZoom+1))}_cluster(H,W){const ne=[],{radius:ce,extent:ve,reduce:fe,minPoints:Ie}=this.options,Ee=ce/(ve*Math.pow(2,W));for(let Te=0;Te<H.length;Te++){const et=H[Te];if(et.zoom<=W)continue;et.zoom=W;const Ke=this.trees[W+1],tt=Ke.within(et.x,et.y,Ee),jt=et.numPoints||1;let Ct=jt;for(const Ut of tt){const Zt=Ke.points[Ut];Zt.zoom>W&&(Ct+=Zt.numPoints||1)}if(Ct>jt&&Ct>=Ie){let Ut=et.x*jt,Zt=et.y*jt,Xi=fe&&jt>1?this._map(et,!0):null;const vi=(Te<<5)+(W+1)+this.points.length;for(const Pi of tt){const di=Ke.points[Pi];if(di.zoom<=W)continue;di.zoom=W;const ei=di.numPoints||1;Ut+=di.x*ei,Zt+=di.y*ei,di.parentId=vi,fe&&(Xi||(Xi=this._map(et,!0)),fe(Xi,this._map(di)))}et.parentId=vi,ne.push(Pr(Ut/Ct,Zt/Ct,vi,Ct,Xi))}else if(ne.push(et),Ct>1)for(const Ut of tt){const Zt=Ke.points[Ut];Zt.zoom<=W||(Zt.zoom=W,ne.push(Zt))}}return ne}_getOriginId(H){return H-this.points.length>>5}_getOriginZoom(H){return(H-this.points.length)%32}_map(H,W){if(H.numPoints)return W?Wi({},H.properties):H.properties;const ne=this.points[H.index].properties,ce=this.options.map(ne);return W&&ce===ne?Wi({},ce):ce}}function Pr(ae,H,W,ne,ce){return{x:rt(ae),y:rt(H),zoom:1/0,id:W,parentId:-1,numPoints:ne,properties:ce}}function ho(ae,H){const[W,ne]=ae.geometry.coordinates;return{x:rt(xn(W)),y:rt(po(ne)),zoom:1/0,index:H,parentId:-1}}function Jn(ae){return{type:"Feature",id:ae.id,properties:Fo(ae),geometry:{type:"Point",coordinates:[(H=ae.x,360*(H-.5)),Yn(ae.y)]}};var H}function Fo(ae){const H=ae.numPoints,W=H>=1e4?`${Math.round(H/1e3)}k`:H>=1e3?Math.round(H/100)/10+"k":H;return Wi(Wi({},ae.properties),{cluster:!0,cluster_id:ae.id,point_count:H,point_count_abbreviated:W})}function xn(ae){return ae/360+.5}function po(ae){const H=Math.sin(ae*Math.PI/180),W=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return W<0?0:W>1?1:W}function Yn(ae){const H=(180-360*ae)*Math.PI/180;return 360*Math.atan(Math.exp(H))/Math.PI-90}function Wi(ae,H){for(const W in H)ae[W]=H[W];return ae}function Nn(ae){return ae.x}function Ao(ae){return ae.y}function $n(ae,H,W,ne){for(var ce,ve=ne,fe=W-H>>1,Ie=W-H,Ee=ae[H],Te=ae[H+1],et=ae[W],Ke=ae[W+1],tt=H+3;tt<W;tt+=3){var jt=Ua(ae[tt],ae[tt+1],Ee,Te,et,Ke);if(jt>ve)ce=tt,ve=jt;else if(jt===ve){var Ct=Math.abs(tt-fe);Ct<Ie&&(ce=tt,Ie=Ct)}}ve>ne&&(ce-H>3&&$n(ae,H,ce,ne),ae[ce+2]=ve,W-ce>3&&$n(ae,ce,W,ne))}function Ua(ae,H,W,ne,ce,ve){var fe=ce-W,Ie=ve-ne;if(fe!==0||Ie!==0){var Ee=((ae-W)*fe+(H-ne)*Ie)/(fe*fe+Ie*Ie);Ee>1?(W=ce,ne=ve):Ee>0&&(W+=fe*Ee,ne+=Ie*Ee)}return(fe=ae-W)*fe+(Ie=H-ne)*Ie}function qe(ae,H,W,ne){var ce={id:ae===void 0?null:ae,type:H,geometry:W,tags:ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ve){var fe=ve.geometry,Ie=ve.type;if(Ie==="Point"||Ie==="MultiPoint"||Ie==="LineString")_t(ve,fe);else if(Ie==="Polygon"||Ie==="MultiLineString")for(var Ee=0;Ee<fe.length;Ee++)_t(ve,fe[Ee]);else if(Ie==="MultiPolygon")for(Ee=0;Ee<fe.length;Ee++)for(var Te=0;Te<fe[Ee].length;Te++)_t(ve,fe[Ee][Te])}(ce),ce}function _t(ae,H){for(var W=0;W<H.length;W+=3)ae.minX=Math.min(ae.minX,H[W]),ae.minY=Math.min(ae.minY,H[W+1]),ae.maxX=Math.max(ae.maxX,H[W]),ae.maxY=Math.max(ae.maxY,H[W+1])}function Ci(ae,H,W,ne){if(H.geometry){var ce=H.geometry.coordinates,ve=H.geometry.type,fe=Math.pow(W.tolerance/((1<<W.maxZoom)*W.extent),2),Ie=[],Ee=H.id;if(W.promoteId?Ee=H.properties[W.promoteId]:W.generateId&&(Ee=ne||0),ve==="Point")fr(ce,Ie);else if(ve==="MultiPoint")for(var Te=0;Te<ce.length;Te++)fr(ce[Te],Ie);else if(ve==="LineString")wr(ce,Ie,fe,!1);else if(ve==="MultiLineString"){if(W.lineMetrics){for(Te=0;Te<ce.length;Te++)wr(ce[Te],Ie=[],fe,!1),ae.push(qe(Ee,"LineString",Ie,H.properties));return}Qn(ce,Ie,fe,!1)}else if(ve==="Polygon")Qn(ce,Ie,fe,!0);else{if(ve!=="MultiPolygon"){if(ve==="GeometryCollection"){for(Te=0;Te<H.geometry.geometries.length;Te++)Ci(ae,{id:Ee,geometry:H.geometry.geometries[Te],properties:H.properties},W,ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Te=0;Te<ce.length;Te++){var et=[];Qn(ce[Te],et,fe,!0),Ie.push(et)}}ae.push(qe(Ee,ve,Ie,H.properties))}}function fr(ae,H){H.push(eo(ae[0])),H.push(sa(ae[1])),H.push(0)}function wr(ae,H,W,ne){for(var ce,ve,fe=0,Ie=0;Ie<ae.length;Ie++){var Ee=eo(ae[Ie][0]),Te=sa(ae[Ie][1]);H.push(Ee),H.push(Te),H.push(0),Ie>0&&(fe+=ne?(ce*Te-Ee*ve)/2:Math.sqrt(Math.pow(Ee-ce,2)+Math.pow(Te-ve,2))),ce=Ee,ve=Te}var et=H.length-3;H[2]=1,$n(H,0,et,W),H[et+2]=1,H.size=Math.abs(fe),H.start=0,H.end=H.size}function Qn(ae,H,W,ne){for(var ce=0;ce<ae.length;ce++){var ve=[];wr(ae[ce],ve,W,ne),H.push(ve)}}function eo(ae){return ae/360+.5}function sa(ae){var H=Math.sin(ae*Math.PI/180),W=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return W<0?0:W>1?1:W}function $r(ae,H,W,ne,ce,ve,fe,Ie){if(ne/=H,ve>=(W/=H)&&fe<ne)return ae;if(fe<W||ve>=ne)return null;for(var Ee=[],Te=0;Te<ae.length;Te++){var et=ae[Te],Ke=et.geometry,tt=et.type,jt=ce===0?et.minX:et.minY,Ct=ce===0?et.maxX:et.maxY;if(jt>=W&&Ct<ne)Ee.push(et);else if(!(Ct<W||jt>=ne)){var Ut=[];if(tt==="Point"||tt==="MultiPoint")Jt(Ke,Ut,W,ne,ce);else if(tt==="LineString")ar(Ke,Ut,W,ne,ce,!1,Ie.lineMetrics);else if(tt==="MultiLineString")Rn(Ke,Ut,W,ne,ce,!1);else if(tt==="Polygon")Rn(Ke,Ut,W,ne,ce,!0);else if(tt==="MultiPolygon")for(var Zt=0;Zt<Ke.length;Zt++){var Xi=[];Rn(Ke[Zt],Xi,W,ne,ce,!0),Xi.length&&Ut.push(Xi)}if(Ut.length){if(Ie.lineMetrics&&tt==="LineString"){for(Zt=0;Zt<Ut.length;Zt++)Ee.push(qe(et.id,tt,Ut[Zt],et.tags));continue}tt!=="LineString"&&tt!=="MultiLineString"||(Ut.length===1?(tt="LineString",Ut=Ut[0]):tt="MultiLineString"),tt!=="Point"&&tt!=="MultiPoint"||(tt=Ut.length===3?"Point":"MultiPoint"),Ee.push(qe(et.id,tt,Ut,et.tags))}}}return Ee.length?Ee:null}function Jt(ae,H,W,ne,ce){for(var ve=0;ve<ae.length;ve+=3){var fe=ae[ve+ce];fe>=W&&fe<=ne&&(H.push(ae[ve]),H.push(ae[ve+1]),H.push(ae[ve+2]))}}function ar(ae,H,W,ne,ce,ve,fe){for(var Ie,Ee,Te=Yi(ae),et=ce===0?Gi:_a,Ke=ae.start,tt=0;tt<ae.length-3;tt+=3){var jt=ae[tt],Ct=ae[tt+1],Ut=ae[tt+2],Zt=ae[tt+3],Xi=ae[tt+4],vi=ce===0?jt:Ct,Pi=ce===0?Zt:Xi,di=!1;fe&&(Ie=Math.sqrt(Math.pow(jt-Zt,2)+Math.pow(Ct-Xi,2))),vi<W?Pi>W&&(Ee=et(Te,jt,Ct,Zt,Xi,W),fe&&(Te.start=Ke+Ie*Ee)):vi>ne?Pi<ne&&(Ee=et(Te,jt,Ct,Zt,Xi,ne),fe&&(Te.start=Ke+Ie*Ee)):to(Te,jt,Ct,Ut),Pi<W&&vi>=W&&(Ee=et(Te,jt,Ct,Zt,Xi,W),di=!0),Pi>ne&&vi<=ne&&(Ee=et(Te,jt,Ct,Zt,Xi,ne),di=!0),!ve&&di&&(fe&&(Te.end=Ke+Ie*Ee),H.push(Te),Te=Yi(ae)),fe&&(Ke+=Ie)}var ei=ae.length-3;jt=ae[ei],Ct=ae[ei+1],Ut=ae[ei+2],(vi=ce===0?jt:Ct)>=W&&vi<=ne&&to(Te,jt,Ct,Ut),ei=Te.length-3,ve&&ei>=3&&(Te[ei]!==Te[0]||Te[ei+1]!==Te[1])&&to(Te,Te[0],Te[1],Te[2]),Te.length&&H.push(Te)}function Yi(ae){var H=[];return H.size=ae.size,H.start=ae.start,H.end=ae.end,H}function Rn(ae,H,W,ne,ce,ve){for(var fe=0;fe<ae.length;fe++)ar(ae[fe],H,W,ne,ce,ve,!1)}function to(ae,H,W,ne){ae.push(H),ae.push(W),ae.push(ne)}function Gi(ae,H,W,ne,ce,ve){var fe=(ve-H)/(ne-H);return ae.push(ve),ae.push(W+(ce-W)*fe),ae.push(1),fe}function _a(ae,H,W,ne,ce,ve){var fe=(ve-W)/(ce-W);return ae.push(H+(ne-H)*fe),ae.push(ve),ae.push(1),fe}function Uo(ae,H){for(var W=[],ne=0;ne<ae.length;ne++){var ce,ve=ae[ne],fe=ve.type;if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")ce=Xr(ve.geometry,H);else if(fe==="MultiLineString"||fe==="Polygon"){ce=[];for(var Ie=0;Ie<ve.geometry.length;Ie++)ce.push(Xr(ve.geometry[Ie],H))}else if(fe==="MultiPolygon")for(ce=[],Ie=0;Ie<ve.geometry.length;Ie++){for(var Ee=[],Te=0;Te<ve.geometry[Ie].length;Te++)Ee.push(Xr(ve.geometry[Ie][Te],H));ce.push(Ee)}W.push(qe(ve.id,fe,ce,ve.tags))}return W}function Xr(ae,H){var W=[];W.size=ae.size,ae.start!==void 0&&(W.start=ae.start,W.end=ae.end);for(var ne=0;ne<ae.length;ne+=3)W.push(ae[ne]+H,ae[ne+1],ae[ne+2]);return W}function te(ae,H){if(ae.transformed)return ae;var W,ne,ce,ve=1<<ae.z,fe=ae.x,Ie=ae.y;for(W=0;W<ae.features.length;W++){var Ee=ae.features[W],Te=Ee.geometry,et=Ee.type;if(Ee.geometry=[],et===1)for(ne=0;ne<Te.length;ne+=2)Ee.geometry.push(oe(Te[ne],Te[ne+1],H,ve,fe,Ie));else for(ne=0;ne<Te.length;ne++){var Ke=[];for(ce=0;ce<Te[ne].length;ce+=2)Ke.push(oe(Te[ne][ce],Te[ne][ce+1],H,ve,fe,Ie));Ee.geometry.push(Ke)}}return ae.transformed=!0,ae}function oe(ae,H,W,ne,ce,ve){return[Math.round(W*(ae*ne-ce)),Math.round(W*(H*ne-ve))]}function le(ae,H,W,ne,ce){for(var ve=H===ce.maxZoom?0:ce.tolerance/((1<<H)*ce.extent),fe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:W,y:ne,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ie=0;Ie<ae.length;Ie++){fe.numFeatures++,_e(fe,ae[Ie],ve,ce);var Ee=ae[Ie].minX,Te=ae[Ie].minY,et=ae[Ie].maxX,Ke=ae[Ie].maxY;Ee<fe.minX&&(fe.minX=Ee),Te<fe.minY&&(fe.minY=Te),et>fe.maxX&&(fe.maxX=et),Ke>fe.maxY&&(fe.maxY=Ke)}return fe}function _e(ae,H,W,ne){var ce=H.geometry,ve=H.type,fe=[];if(ve==="Point"||ve==="MultiPoint")for(var Ie=0;Ie<ce.length;Ie+=3)fe.push(ce[Ie]),fe.push(ce[Ie+1]),ae.numPoints++,ae.numSimplified++;else if(ve==="LineString")Ae(fe,ce,ae,W,!1,!1);else if(ve==="MultiLineString"||ve==="Polygon")for(Ie=0;Ie<ce.length;Ie++)Ae(fe,ce[Ie],ae,W,ve==="Polygon",Ie===0);else if(ve==="MultiPolygon")for(var Ee=0;Ee<ce.length;Ee++){var Te=ce[Ee];for(Ie=0;Ie<Te.length;Ie++)Ae(fe,Te[Ie],ae,W,!0,Ie===0)}if(fe.length){var et=H.tags||null;if(ve==="LineString"&&ne.lineMetrics){for(var Ke in et={},H.tags)et[Ke]=H.tags[Ke];et.mapbox_clip_start=ce.start/ce.size,et.mapbox_clip_end=ce.end/ce.size}var tt={geometry:fe,type:ve==="Polygon"||ve==="MultiPolygon"?3:ve==="LineString"||ve==="MultiLineString"?2:1,tags:et};H.id!==null&&(tt.id=H.id),ae.features.push(tt)}}function Ae(ae,H,W,ne,ce,ve){var fe=ne*ne;if(ne>0&&H.size<(ce?fe:ne))W.numPoints+=H.length/3;else{for(var Ie=[],Ee=0;Ee<H.length;Ee+=3)(ne===0||H[Ee+2]>fe)&&(W.numSimplified++,Ie.push(H[Ee]),Ie.push(H[Ee+1])),W.numPoints++;ce&&function(Te,et){for(var Ke=0,tt=0,jt=Te.length,Ct=jt-2;tt<jt;Ct=tt,tt+=2)Ke+=(Te[tt]-Te[Ct])*(Te[tt+1]+Te[Ct+1]);if(Ke>0===et)for(tt=0,jt=Te.length;tt<jt/2;tt+=2){var Ut=Te[tt],Zt=Te[tt+1];Te[tt]=Te[jt-2-tt],Te[tt+1]=Te[jt-1-tt],Te[jt-2-tt]=Ut,Te[jt-1-tt]=Zt}}(Ie,ve),ae.push(Ie)}}function je(ae,H){var W=(H=this.options=function(ce,ve){for(var fe in ve)ce[fe]=ve[fe];return ce}(Object.create(this.options),H)).debug;if(W&&console.time("preprocess data"),H.maxZoom<0||H.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(H.promoteId&&H.generateId)throw new Error("promoteId and generateId cannot be used together.");var ne=function(ce,ve){var fe=[];if(ce.type==="FeatureCollection")for(var Ie=0;Ie<ce.features.length;Ie++)Ci(fe,ce.features[Ie],ve,Ie);else Ci(fe,ce.type==="Feature"?ce:{geometry:ce},ve);return fe}(ae,H);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",H.indexMaxZoom,H.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ne=function(ce,ve){var fe=ve.buffer/ve.extent,Ie=ce,Ee=$r(ce,1,-1-fe,fe,0,-1,2,ve),Te=$r(ce,1,1-fe,2+fe,0,-1,2,ve);return(Ee||Te)&&(Ie=$r(ce,1,-fe,1+fe,0,-1,2,ve)||[],Ee&&(Ie=Uo(Ee,1).concat(Ie)),Te&&(Ie=Ie.concat(Uo(Te,-1)))),Ie}(ne,H),ne.length&&this.splitTile(ne,0,0,0),W&&(ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ge(ae,H,W){return 32*((1<<ae)*W+H)+ae}function ye(ae,H){const W=ae.tileID.canonical;if(!this._geoJSONIndex)return H(null,null);const ne=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!ne)return H(null,null);const ce=new ht(ne.features);let ve=xi(ce);ve.byteOffset===0&&ve.byteLength===ve.buffer.byteLength||(ve=new Uint8Array(ve)),H(null,{vectorTile:ce,rawData:ve.buffer})}je.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},je.prototype.splitTile=function(ae,H,W,ne,ce,ve,fe){for(var Ie=[ae,H,W,ne],Ee=this.options,Te=Ee.debug;Ie.length;){ne=Ie.pop(),W=Ie.pop(),H=Ie.pop(),ae=Ie.pop();var et=1<<H,Ke=Ge(H,W,ne),tt=this.tiles[Ke];if(!tt&&(Te>1&&console.time("creation"),tt=this.tiles[Ke]=le(ae,H,W,ne,Ee),this.tileCoords.push({z:H,x:W,y:ne}),Te)){Te>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",H,W,ne,tt.numFeatures,tt.numPoints,tt.numSimplified),console.timeEnd("creation"));var jt="z"+H;this.stats[jt]=(this.stats[jt]||0)+1,this.total++}if(tt.source=ae,ce){if(H===Ee.maxZoom||H===ce)continue;var Ct=1<<ce-H;if(W!==Math.floor(ve/Ct)||ne!==Math.floor(fe/Ct))continue}else if(H===Ee.indexMaxZoom||tt.numPoints<=Ee.indexMaxPoints)continue;if(tt.source=null,ae.length!==0){Te>1&&console.time("clipping");var Ut,Zt,Xi,vi,Pi,di,ei=.5*Ee.buffer/Ee.extent,Ui=.5-ei,Ir=.5+ei,kn=1+ei;Ut=Zt=Xi=vi=null,Pi=$r(ae,et,W-ei,W+Ir,0,tt.minX,tt.maxX,Ee),di=$r(ae,et,W+Ui,W+kn,0,tt.minX,tt.maxX,Ee),ae=null,Pi&&(Ut=$r(Pi,et,ne-ei,ne+Ir,1,tt.minY,tt.maxY,Ee),Zt=$r(Pi,et,ne+Ui,ne+kn,1,tt.minY,tt.maxY,Ee),Pi=null),di&&(Xi=$r(di,et,ne-ei,ne+Ir,1,tt.minY,tt.maxY,Ee),vi=$r(di,et,ne+Ui,ne+kn,1,tt.minY,tt.maxY,Ee),di=null),Te>1&&console.timeEnd("clipping"),Ie.push(Ut||[],H+1,2*W,2*ne),Ie.push(Zt||[],H+1,2*W,2*ne+1),Ie.push(Xi||[],H+1,2*W+1,2*ne),Ie.push(vi||[],H+1,2*W+1,2*ne+1)}}},je.prototype.getTile=function(ae,H,W){var ne=this.options,ce=ne.extent,ve=ne.debug;if(ae<0||ae>24)return null;var fe=1<<ae,Ie=Ge(ae,H=(H%fe+fe)%fe,W);if(this.tiles[Ie])return te(this.tiles[Ie],ce);ve>1&&console.log("drilling down to z%d-%d-%d",ae,H,W);for(var Ee,Te=ae,et=H,Ke=W;!Ee&&Te>0;)Te--,et=Math.floor(et/2),Ke=Math.floor(Ke/2),Ee=this.tiles[Ge(Te,et,Ke)];return Ee&&Ee.source?(ve>1&&console.log("found parent tile z%d-%d-%d",Te,et,Ke),ve>1&&console.time("drilling down"),this.splitTile(Ee.source,Te,et,Ke,ae,H,W),ve>1&&console.timeEnd("drilling down"),this.tiles[Ie]?te(this.tiles[Ie],ce):null):null};class Me extends De{constructor(H,W,ne,ce){super(H,W,ne,ye),ce&&(this.loadGeoJSON=ce)}loadData(H,W){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=W,this._pendingLoadDataParams=H,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())}_loadData(){if(!this._pendingCallback||!this._pendingLoadDataParams)return;const H=this._pendingCallback,W=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;const ne=!!(W&&W.request&&W.request.collectResourceTiming)&&new p.RequestPerformance(W.request);this.loadGeoJSON(W,(ce,ve)=>{if(ce||!ve)return H(ce);if(typeof ve!="object")return H(new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`));{ft(ve,!0);try{if(W.filter){const Ie=p.createExpression(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ie.result==="error")throw new Error(Ie.value.map(Te=>`${Te.key}: ${Te.message}`).join(", "));const Ee=ve.features.filter(Te=>Ie.value.evaluate({zoom:0},Te));ve={type:"FeatureCollection",features:Ee}}this._geoJSONIndex=W.cluster?new nr(function({superclusterOptions:Ie,clusterProperties:Ee}){if(!Ee||!Ie)return Ie;const Te={},et={},Ke={accumulated:null,zoom:0},tt={properties:null},jt=Object.keys(Ee);for(const Ct of jt){const[Ut,Zt]=Ee[Ct],Xi=p.createExpression(Zt),vi=p.createExpression(typeof Ut=="string"?[Ut,["accumulated"],["get",Ct]]:Ut);Te[Ct]=Xi.value,et[Ct]=vi.value}return Ie.map=Ct=>{tt.properties=Ct;const Ut={};for(const Zt of jt)Ut[Zt]=Te[Zt].evaluate(Ke,tt);return Ut},Ie.reduce=(Ct,Ut)=>{tt.properties=Ut;for(const Zt of jt)Ke.accumulated=Ct[Zt],Ct[Zt]=et[Zt].evaluate(Ke,tt)},Ie}(W)).load(ve.features):function(Ie,Ee){return new je(Ie,Ee)}(ve,W.geojsonVtOptions)}catch(Ie){return H(Ie)}this.loaded={};const fe={};if(ne){const Ie=ne.finish();Ie&&(fe.resourceTiming={},fe.resourceTiming[W.source]=JSON.parse(JSON.stringify(Ie)))}H(null,fe)}})}coalesce(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())}reloadTile(H,W){const ne=this.loaded;return ne&&ne[H.uid]?super.reloadTile(H,W):this.loadTile(H,W)}loadGeoJSON(H,W){if(H.request)p.getJSON(H.request,W);else{if(typeof H.data!="string")return W(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`));try{return W(null,JSON.parse(H.data))}catch{return W(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`))}}}removeSource(H,W){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),W()}getClusterExpansionZoom(H,W){try{W(null,this._geoJSONIndex.getClusterExpansionZoom(H.clusterId))}catch(ne){W(ne)}}getClusterChildren(H,W){try{W(null,this._geoJSONIndex.getChildren(H.clusterId))}catch(ne){W(ne)}}getClusterLeaves(H,W){try{W(null,this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset))}catch(ne){W(ne)}}}class Qe{constructor(H){this.self=H,this.actor=new p.Actor(H,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:De,geojson:Me},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(W,ne)=>{if(this.workerSourceTypes[W])throw new Error(`Worker source with name "${W}" already registered.`);this.workerSourceTypes[W]=ne},this.self.registerRTLTextPlugin=W=>{if(p.plugin.isParsed())throw new Error("RTL text plugin already registered.");p.plugin.applyArabicShaping=W.applyArabicShaping,p.plugin.processBidirectionalText=W.processBidirectionalText,p.plugin.processStyledBidirectionalText=W.processStyledBidirectionalText}}setReferrer(H,W){this.referrer=W}setImages(H,W,ne){this.availableImages[H]=W;for(const ce in this.workerSources[H]){const ve=this.workerSources[H][ce];for(const fe in ve)ve[fe].availableImages=W}ne()}setLayers(H,W,ne){this.getLayerIndex(H).replace(W),ne()}updateLayers(H,W,ne){this.getLayerIndex(H).update(W.layers,W.removedIds),ne()}loadTile(H,W,ne){this.getWorkerSource(H,W.type,W.source).loadTile(W,ne)}loadDEMTile(H,W,ne){this.getDEMWorkerSource(H,W.source).loadTile(W,ne)}reloadTile(H,W,ne){this.getWorkerSource(H,W.type,W.source).reloadTile(W,ne)}abortTile(H,W,ne){this.getWorkerSource(H,W.type,W.source).abortTile(W,ne)}removeTile(H,W,ne){this.getWorkerSource(H,W.type,W.source).removeTile(W,ne)}removeDEMTile(H,W){this.getDEMWorkerSource(H,W.source).removeTile(W)}removeSource(H,W,ne){if(!this.workerSources[H]||!this.workerSources[H][W.type]||!this.workerSources[H][W.type][W.source])return;const ce=this.workerSources[H][W.type][W.source];delete this.workerSources[H][W.type][W.source],ce.removeSource!==void 0?ce.removeSource(W,ne):ne()}loadWorkerSource(H,W,ne){try{this.self.importScripts(W.url),ne()}catch(ce){ne(ce.toString())}}syncRTLPluginState(H,W,ne){try{p.plugin.setState(W);const ce=p.plugin.getPluginURL();if(p.plugin.isLoaded()&&!p.plugin.isParsed()&&ce!=null){this.self.importScripts(ce);const ve=p.plugin.isParsed();ne(ve?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ce}`),ve)}}catch(ce){ne(ce.toString())}}getAvailableImages(H){let W=this.availableImages[H];return W||(W=[]),W}getLayerIndex(H){let W=this.layerIndexes[H];return W||(W=this.layerIndexes[H]=new U),W}getWorkerSource(H,W,ne){if(this.workerSources[H]||(this.workerSources[H]={}),this.workerSources[H][W]||(this.workerSources[H][W]={}),!this.workerSources[H][W][ne]){const ce={send:(ve,fe,Ie)=>{this.actor.send(ve,fe,Ie,H)}};this.workerSources[H][W][ne]=new this.workerSourceTypes[W](ce,this.getLayerIndex(H),this.getAvailableImages(H))}return this.workerSources[H][W][ne]}getDEMWorkerSource(H,W){return this.demWorkerSources[H]||(this.demWorkerSources[H]={}),this.demWorkerSources[H][W]||(this.demWorkerSources[H][W]=new Le),this.demWorkerSources[H][W]}enforceCacheSizeLimit(H,W){p.enforceCacheSizeLimit(W)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Qe(self)),Qe}),z(["./shared"],function(p){var L=N;function N(T){return!function(o){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var I,A,M=new Blob([""],{type:"text/javascript"}),F=URL.createObjectURL(M);try{A=new Worker(F),I=!0}catch{I=!1}return A&&A.terminate(),URL.revokeObjectURL(F),I}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var I=document.createElement("canvas");I.width=I.height=1;var A=I.getContext("2d");if(!A)return!1;var M=A.getImageData(0,0,1,1);return M&&M.width===I.width}()?(U[g=o&&o.failIfMajorPerformanceCaveat]===void 0&&(U[g]=function(I){var A,M=function(F){var Z=document.createElement("canvas"),J=Object.create(N.webGLContextAttributes);return J.failIfMajorPerformanceCaveat=F,Z.getContext("webgl",J)||Z.getContext("experimental-webgl",J)}(I);if(!M)return!1;try{A=M.createShader(M.VERTEX_SHADER)}catch{return!1}return!(!A||M.isContextLost())&&(M.shaderSource(A,"void main() {}"),M.compileShader(A),M.getShaderParameter(A,M.COMPILE_STATUS)===!0)}(g)),U[g]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var g}(T)}var U={};function G(T,o){if(Array.isArray(T)){if(!Array.isArray(o)||T.length!==o.length)return!1;for(let g=0;g<T.length;g++)if(!G(T[g],o[g]))return!1;return!0}if(typeof T=="object"&&T!==null&&o!==null){if(typeof o!="object"||Object.keys(T).length!==Object.keys(o).length)return!1;for(const g in T)if(!G(T[g],o[g]))return!1;return!0}return T===o}N.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class X{static testProp(o){if(!X.docStyle)return o[0];for(let g=0;g<o.length;g++)if(o[g]in X.docStyle)return o[g];return o[0]}static create(o,g,I){const A=window.document.createElement(o);return g!==void 0&&(A.className=g),I&&I.appendChild(A),A}static createNS(o,g){return window.document.createElementNS(o,g)}static disableDrag(){X.docStyle&&X.selectProp&&(X.userSelect=X.docStyle[X.selectProp],X.docStyle[X.selectProp]="none")}static enableDrag(){X.docStyle&&X.selectProp&&(X.docStyle[X.selectProp]=X.userSelect)}static setTransform(o,g){o.style[X.transformProp]=g}static addEventListener(o,g,I,A={}){o.addEventListener(g,I,"passive"in A?A:A.capture)}static removeEventListener(o,g,I,A={}){o.removeEventListener(g,I,"passive"in A?A:A.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",X.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",X.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",X.suppressClickInternal,!0)},0)}static mousePos(o,g){const I=o.getBoundingClientRect();return new p.pointGeometry(g.clientX-I.left-o.clientLeft,g.clientY-I.top-o.clientTop)}static touchPos(o,g){const I=o.getBoundingClientRect(),A=[];for(let M=0;M<g.length;M++)A.push(new p.pointGeometry(g[M].clientX-I.left-o.clientLeft,g[M].clientY-I.top-o.clientTop));return A}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}}X.docStyle=typeof window!="undefined"&&window.document&&window.document.documentElement.style,X.selectProp=X.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),X.transformProp=X.testProp(["transform","WebkitTransform"]);class Se{constructor(o){this._transformRequestFn=o}transformRequest(o,g){return this._transformRequestFn&&this._transformRequestFn(o,g)||{url:o}}normalizeSpriteURL(o,g,I){const A=function(M){const F=M.match(ge);if(!F)throw new Error(`Unable to parse URL "${M}"`);return{protocol:F[1],authority:F[2],path:F[3]||"/",params:F[4]?F[4].split("&"):[]}}(o);return A.path+=`${g}${I}`,function(M){const F=M.params.length?`?${M.params.join("&")}`:"";return`${M.protocol}://${M.authority}${M.path}${F}`}(A)}setTransformRequest(o){this._transformRequestFn=o}}const ge=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function De(T){var o=new p.ARRAY_TYPE(3);return o[0]=T[0],o[1]=T[1],o[2]=T[2],o}var Le,ft=function(T,o,g){return T[0]=o[0]-g[0],T[1]=o[1]-g[1],T[2]=o[2]-g[2],T};Le=new p.ARRAY_TYPE(3),p.ARRAY_TYPE!=Float32Array&&(Le[0]=0,Le[1]=0,Le[2]=0);var Ue=function(T){var o=T[0],g=T[1];return o*o+g*g};(function(){var T=new p.ARRAY_TYPE(2);p.ARRAY_TYPE!=Float32Array&&(T[0]=0,T[1]=0)})();class Re{constructor(o,g,I,A){this.context=o,this.format=I,this.texture=o.gl.createTexture(),this.update(g,A)}update(o,g,I){const{width:A,height:M}=o,F=!(this.size&&this.size[0]===A&&this.size[1]===M||I),{context:Z}=this,{gl:J}=Z;if(this.useMipmap=Boolean(g&&g.useMipmap),J.bindTexture(J.TEXTURE_2D,this.texture),Z.pixelStoreUnpackFlipY.set(!1),Z.pixelStoreUnpack.set(1),Z.pixelStoreUnpackPremultiplyAlpha.set(this.format===J.RGBA&&(!g||g.premultiply!==!1)),F)this.size=[A,M],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||p.isImageBitmap(o)?J.texImage2D(J.TEXTURE_2D,0,this.format,this.format,J.UNSIGNED_BYTE,o):J.texImage2D(J.TEXTURE_2D,0,this.format,A,M,0,this.format,J.UNSIGNED_BYTE,o.data);else{const{x:ee,y:re}=I||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||p.isImageBitmap(o)?J.texSubImage2D(J.TEXTURE_2D,0,ee,re,J.RGBA,J.UNSIGNED_BYTE,o):J.texSubImage2D(J.TEXTURE_2D,0,ee,re,A,M,J.RGBA,J.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&J.generateMipmap(J.TEXTURE_2D)}bind(o,g,I){const{context:A}=this,{gl:M}=A;M.bindTexture(M.TEXTURE_2D,this.texture),I!==M.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(I=M.LINEAR),o!==this.filter&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,o),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,I||o),this.filter=o),g!==this.wrap&&(M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,g),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,g),this.wrap=g)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}function st(T){const{userImage:o}=T;return!!(o&&o.render&&o.render())&&(T.data.replace(new Uint8Array(o.data.buffer)),!0)}class ut extends p.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new p.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:g,callback:I}of this.requestors)this._notify(g,I);this.requestors=[]}}getImage(o){return this.images[o]}addImage(o,g){this._validate(o,g)&&(this.images[o]=g)}_validate(o,g){let I=!0;return this._validateStretch(g.stretchX,g.data&&g.data.width)||(this.fire(new p.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),I=!1),this._validateStretch(g.stretchY,g.data&&g.data.height)||(this.fire(new p.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),I=!1),this._validateContent(g.content,g)||(this.fire(new p.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),I=!1),I}_validateStretch(o,g){if(!o)return!0;let I=0;for(const A of o){if(A[0]<I||A[1]<A[0]||g<A[1])return!1;I=A[1]}return!0}_validateContent(o,g){return!(o&&(o.length!==4||o[0]<0||g.data.width<o[0]||o[1]<0||g.data.height<o[1]||o[2]<0||g.data.width<o[2]||o[3]<0||g.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,g){g.version=this.images[o].version+1,this.images[o]=g,this.updatedImages[o]=!0}removeImage(o){const g=this.images[o];delete this.images[o],delete this.patterns[o],g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,g){let I=!0;if(!this.isLoaded())for(const A of o)this.images[A]||(I=!1);this.isLoaded()||I?this._notify(o,g):this.requestors.push({ids:o,callback:g})}_notify(o,g){const I={};for(const A of o){this.images[A]||this.fire(new p.Event("styleimagemissing",{id:A}));const M=this.images[A];M?I[A]={data:M.data.clone(),pixelRatio:M.pixelRatio,sdf:M.sdf,version:M.version,stretchX:M.stretchX,stretchY:M.stretchY,content:M.content,hasRenderCallback:Boolean(M.userImage&&M.userImage.render)}:p.warnOnce(`Image "${A}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}g(null,I)}getPixelSize(){const{width:o,height:g}=this.atlasImage;return{width:o,height:g}}getPattern(o){const g=this.patterns[o],I=this.getImage(o);if(!I)return null;if(g&&g.position.version===I.version)return g.position;if(g)g.position.version=I.version;else{const A={w:I.data.width+2,h:I.data.height+2,x:0,y:0},M=new p.ImagePosition(A,I);this.patterns[o]={bin:A,position:M}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const g=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Re(o,this.atlasImage,g.RGBA),this.atlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const M in this.patterns)o.push(this.patterns[M].bin);const{w:g,h:I}=p.potpack(o),A=this.atlasImage;A.resize({width:g||1,height:I||1});for(const M in this.patterns){const{bin:F}=this.patterns[M],Z=F.x+1,J=F.y+1,ee=this.images[M].data,re=ee.width,ue=ee.height;p.RGBAImage.copy(ee,A,{x:0,y:0},{x:Z,y:J},{width:re,height:ue}),p.RGBAImage.copy(ee,A,{x:0,y:ue-1},{x:Z,y:J-1},{width:re,height:1}),p.RGBAImage.copy(ee,A,{x:0,y:0},{x:Z,y:J+ue},{width:re,height:1}),p.RGBAImage.copy(ee,A,{x:re-1,y:0},{x:Z-1,y:J},{width:1,height:ue}),p.RGBAImage.copy(ee,A,{x:0,y:0},{x:Z+re,y:J},{width:1,height:ue})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const g of o){if(this.callbackDispatchedThisFrame[g])continue;this.callbackDispatchedThisFrame[g]=!0;const I=this.images[g];st(I)&&this.updateImage(g,I)}}}const ht=1e20;function at(T,o,g,I,A,M,F,Z,J){for(let ee=o;ee<o+I;ee++)$t(T,g*M+ee,M,A,F,Z,J);for(let ee=g;ee<g+A;ee++)$t(T,ee*M+o,1,I,F,Z,J)}function $t(T,o,g,I,A,M,F){M[0]=0,F[0]=-ht,F[1]=ht,A[0]=T[o];for(let Z=1,J=0,ee=0;Z<I;Z++){A[Z]=T[o+Z*g];const re=Z*Z;do{const ue=M[J];ee=(A[Z]-A[ue]+re-ue*ue)/(Z-ue)/2}while(ee<=F[J]&&--J>-1);J++,M[J]=Z,F[J]=ee,F[J+1]=ht}for(let Z=0,J=0;Z<I;Z++){for(;F[J+1]<Z;)J++;const ee=M[J],re=Z-ee;T[o+Z*g]=A[ee]+re*re}}class xt{constructor(o,g){this.requestManager=o,this.localIdeographFontFamily=g,this.entries={}}setURL(o){this.url=o}getGlyphs(o,g){const I=[];for(const A in o)for(const M of o[A])I.push({stack:A,id:M});p.asyncAll(I,({stack:A,id:M},F)=>{let Z=this.entries[A];Z||(Z=this.entries[A]={glyphs:{},requests:{},ranges:{}});let J=Z.glyphs[M];if(J!==void 0)return void F(null,{stack:A,id:M,glyph:J});if(J=this._tinySDF(Z,A,M),J)return Z.glyphs[M]=J,void F(null,{stack:A,id:M,glyph:J});const ee=Math.floor(M/256);if(256*ee>65535)return void F(new Error("glyphs > 65535 not supported"));if(Z.ranges[ee])return void F(null,{stack:A,id:M,glyph:J});let re=Z.requests[ee];re||(re=Z.requests[ee]=[],xt.loadGlyphRange(A,ee,this.url,this.requestManager,(ue,xe)=>{if(xe){for(const Fe in xe)this._doesCharSupportLocalGlyph(+Fe)||(Z.glyphs[+Fe]=xe[+Fe]);Z.ranges[ee]=!0}for(const Fe of re)Fe(ue,xe);delete Z.requests[ee]})),re.push((ue,xe)=>{ue?F(ue):xe&&F(null,{stack:A,id:M,glyph:xe[M]||null})})},(A,M)=>{if(A)g(A);else if(M){const F={};for(const{stack:Z,id:J,glyph:ee}of M)(F[Z]||(F[Z]={}))[J]=ee&&{id:ee.id,bitmap:ee.bitmap.clone(),metrics:ee.metrics};g(null,F)}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(p.unicodeBlockLookup["CJK Unified Ideographs"](o)||p.unicodeBlockLookup["Hangul Syllables"](o)||p.unicodeBlockLookup.Hiragana(o)||p.unicodeBlockLookup.Katakana(o))}_tinySDF(o,g,I){const A=this.localIdeographFontFamily;if(!A||!this._doesCharSupportLocalGlyph(I))return;let M=o.tinySDF;if(!M){let Z="400";/bold/i.test(g)?Z="900":/medium/i.test(g)?Z="500":/light/i.test(g)&&(Z="200"),M=o.tinySDF=new xt.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:A,fontWeight:Z})}const F=M.draw(String.fromCharCode(I));return{id:I,bitmap:new p.AlphaImage({width:F.width||30,height:F.height||30},F.data),metrics:{width:F.glyphWidth||24,height:F.glyphHeight||24,left:F.glyphLeft||0,top:F.glyphTop-27||-8,advance:F.glyphAdvance||24}}}}xt.loadGlyphRange=function(T,o,g,I,A){const M=256*o,F=M+255,Z=I.transformRequest(g.replace("{fontstack}",T).replace("{range}",`${M}-${F}`),p.ResourceType.Glyphs);p.getArrayBuffer(Z,(J,ee)=>{if(J)A(J);else if(ee){const re={};for(const ue of p.parseGlyphPBF(ee))re[ue.id]=ue;A(null,re)}})},xt.TinySDF=class{constructor({fontSize:T=24,buffer:o=3,radius:g=8,cutoff:I=.25,fontFamily:A="sans-serif",fontWeight:M="normal",fontStyle:F="normal"}={}){this.buffer=o,this.cutoff=I,this.radius=g;const Z=this.size=T+4*o,J=this._createCanvas(Z),ee=this.ctx=J.getContext("2d",{willReadFrequently:!0});ee.font=`${F} ${M} ${T}px ${A}`,ee.textBaseline="alphabetic",ee.textAlign="left",ee.fillStyle="black",this.gridOuter=new Float64Array(Z*Z),this.gridInner=new Float64Array(Z*Z),this.f=new Float64Array(Z),this.z=new Float64Array(Z+1),this.v=new Uint16Array(Z)}_createCanvas(T){const o=document.createElement("canvas");return o.width=o.height=T,o}draw(T){const{width:o,actualBoundingBoxAscent:g,actualBoundingBoxDescent:I,actualBoundingBoxLeft:A,actualBoundingBoxRight:M}=this.ctx.measureText(T),F=Math.ceil(g),Z=Math.min(this.size-this.buffer,Math.ceil(M-A)),J=Math.min(this.size-this.buffer,F+Math.ceil(I)),ee=Z+2*this.buffer,re=J+2*this.buffer,ue=Math.max(ee*re,0),xe=new Uint8ClampedArray(ue),Fe={data:xe,width:ee,height:re,glyphWidth:Z,glyphHeight:J,glyphTop:F,glyphLeft:0,glyphAdvance:o};if(Z===0||J===0)return Fe;const{ctx:we,buffer:Oe,gridInner:Je,gridOuter:Xe}=this;we.clearRect(Oe,Oe,Z,J),we.fillText(T,Oe,Oe+F);const nt=we.getImageData(Oe,Oe,Z,J);Xe.fill(ht,0,ue),Je.fill(0,0,ue);for(let $e=0;$e<J;$e++)for(let wt=0;wt<Z;wt++){const dt=nt.data[4*($e*Z+wt)+3]/255;if(dt===0)continue;const yt=($e+Oe)*ee+wt+Oe;if(dt===1)Xe[yt]=0,Je[yt]=ht;else{const Lt=.5-dt;Xe[yt]=Lt>0?Lt*Lt:0,Je[yt]=Lt<0?Lt*Lt:0}}at(Xe,0,0,ee,re,ee,this.f,this.v,this.z),at(Je,Oe,Oe,Z,J,ee,this.f,this.v,this.z);for(let $e=0;$e<ue;$e++){const wt=Math.sqrt(Xe[$e])-Math.sqrt(Je[$e]);xe[$e]=Math.round(255-255*(wt/this.radius+this.cutoff))}return Fe}};const qt=new p.Properties({anchor:new p.DataConstantProperty(p.spec.light.anchor),position:new class{constructor(){this.specification=p.spec.light.position}possiblyEvaluate(T,o){return p.sphericalToCartesian(T.expression.evaluate(o))}interpolate(T,o,g){return{x:p.number(T.x,o.x,g),y:p.number(T.y,o.y,g),z:p.number(T.z,o.z,g)}}},color:new p.DataConstantProperty(p.spec.light.color),intensity:new p.DataConstantProperty(p.spec.light.intensity)}),_i="-transition";class Ri extends p.Evented{constructor(o){super(),this._transitionable=new p.Transitionable(qt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,g={}){if(!this._validate(p.validateLight,o,g))for(const I in o){const A=o[I];I.endsWith(_i)?this._transitionable.setTransition(I.slice(0,-_i.length),A):this._transitionable.setValue(I,A)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,g,I){return(!I||I.validate!==!1)&&p.emitValidationErrors(this,o.call(p.validateStyle,p.extend({value:g,style:{glyphs:!0,sprite:!0},styleSpec:p.spec})))}}class Ht{constructor(o,g){this.width=o,this.height=g,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,g){const I=o.join(",")+String(g);return this.dashEntry[I]||(this.dashEntry[I]=this.addDash(o,g)),this.dashEntry[I]}getDashRanges(o,g,I){const A=[];let M=o.length%2==1?-o[o.length-1]*I:0,F=o[0]*I,Z=!0;A.push({left:M,right:F,isDash:Z,zeroLength:o[0]===0});let J=o[0];for(let ee=1;ee<o.length;ee++){Z=!Z;const re=o[ee];M=J*I,J+=re,F=J*I,A.push({left:M,right:F,isDash:Z,zeroLength:re===0})}return A}addRoundDash(o,g,I){const A=g/2;for(let M=-I;M<=I;M++){const F=this.width*(this.nextRow+I+M);let Z=0,J=o[Z];for(let ee=0;ee<this.width;ee++){ee/J.right>1&&(J=o[++Z]);const re=Math.abs(ee-J.left),ue=Math.abs(ee-J.right),xe=Math.min(re,ue);let Fe;const we=M/I*(A+1);if(J.isDash){const Oe=A-Math.abs(we);Fe=Math.sqrt(xe*xe+Oe*Oe)}else Fe=A-Math.sqrt(xe*xe+we*we);this.data[F+ee]=Math.max(0,Math.min(255,Fe+128))}}}addRegularDash(o){for(let Z=o.length-1;Z>=0;--Z){const J=o[Z],ee=o[Z+1];J.zeroLength?o.splice(Z,1):ee&&ee.isDash===J.isDash&&(ee.left=J.left,o.splice(Z,1))}const g=o[0],I=o[o.length-1];g.isDash===I.isDash&&(g.left=I.left-this.width,I.right=g.right+this.width);const A=this.width*this.nextRow;let M=0,F=o[M];for(let Z=0;Z<this.width;Z++){Z/F.right>1&&(F=o[++M]);const J=Math.abs(Z-F.left),ee=Math.abs(Z-F.right),re=Math.min(J,ee);this.data[A+Z]=Math.max(0,Math.min(255,(F.isDash?re:-re)+128))}}addDash(o,g){const I=g?7:0,A=2*I+1;if(this.nextRow+A>this.height)return p.warnOnce("LineAtlas out of space"),null;let M=0;for(let Z=0;Z<o.length;Z++)M+=o[Z];if(M!==0){const Z=this.width/M,J=this.getDashRanges(o,this.width,Z);g?this.addRoundDash(J,Z,I):this.addRegularDash(J)}const F={y:(this.nextRow+I+.5)/this.height,height:2*I/this.height,width:M};return this.nextRow+=A,this.dirty=!0,F}bind(o){const g=o.gl;this.texture?(g.bindTexture(g.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,g.texSubImage2D(g.TEXTURE_2D,0,0,0,this.width,this.height,g.ALPHA,g.UNSIGNED_BYTE,this.data))):(this.texture=g.createTexture(),g.bindTexture(g.TEXTURE_2D,this.texture),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.REPEAT),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texImage2D(g.TEXTURE_2D,0,g.ALPHA,this.width,this.height,0,g.ALPHA,g.UNSIGNED_BYTE,this.data))}}class Qt{constructor(o,g){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=p.uniqueId();const I=this.workerPool.acquire(this.id);for(let A=0;A<I.length;A++){const M=new Qt.Actor(I[A],g,this.id);M.name=`Worker ${A}`,this.actors.push(M)}}broadcast(o,g,I){p.asyncAll(this.actors,(A,M)=>{A.send(o,g,M)},I=I||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Si(T,o,g){const I=function(A,M){if(A)return g(A);if(M){const F=p.pick(p.extend(M,T),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(F.vectorLayers=M.vector_layers,F.vectorLayerIds=F.vectorLayers.map(Z=>Z.id)),g(null,F)}};return T.url?p.getJSON(o.transformRequest(T.url,p.ResourceType.Source),I):p.exported.frame(()=>I(null,T))}Qt.Actor=p.Actor;class bt{constructor(o,g,I){this.bounds=p.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=g||0,this.maxzoom=I||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const g=Math.pow(2,o.z),I=Math.floor(p.mercatorXfromLng(this.bounds.getWest())*g),A=Math.floor(p.mercatorYfromLat(this.bounds.getNorth())*g),M=Math.ceil(p.mercatorXfromLng(this.bounds.getEast())*g),F=Math.ceil(p.mercatorYfromLat(this.bounds.getSouth())*g);return o.x>=I&&o.x<M&&o.y>=A&&o.y<F}}class Fi extends p.Evented{constructor(o,g,I,A){if(super(),this.id=o,this.dispatcher=I,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,p.extend(this,p.pick(g,["url","scheme","tileSize","promoteId"])),this._options=p.extend({type:"vector"},g),this._collectResourceTiming=g.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(A)}load(){this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Si(this._options,this.map._requestManager,(o,g)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),o?this.fire(new p.ErrorEvent(o)):g&&(p.extend(this,g),g.bounds&&(this.tileBounds=new bt(g.bounds,this.minzoom,this.maxzoom)),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return p.extend({},this._options)}loadTile(o,g){const I=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),A={request:this.map._requestManager.transformRequest(I,p.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function M(F,Z){return delete o.request,o.aborted?g(null):F&&F.status!==404?g(F):(Z&&Z.resourceTiming&&(o.resourceTiming=Z.resourceTiming),this.map._refreshExpiredTiles&&Z&&o.setExpiryData(Z),o.loadVectorData(Z,this.map.painter),p.cacheEntryPossiblyAdded(this.dispatcher),g(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}A.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=g:o.request=o.actor.send("reloadTile",A,M.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",A,M.bind(this)))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Dt extends p.Evented{constructor(o,g,I,A){super(),this.id=o,this.dispatcher=I,this.setEventedParent(A),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=p.extend({type:"raster"},g),p.extend(this,p.pick(g,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Si(this._options,this.map._requestManager,(o,g)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new p.ErrorEvent(o)):g&&(p.extend(this,g),g.bounds&&(this.tileBounds=new bt(g.bounds,this.minzoom,this.maxzoom)),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return p.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,g){const I=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.request=p.getImage(this.map._requestManager.transformRequest(I,p.ResourceType.Tile),(A,M,F)=>{if(delete o.request,o.aborted)o.state="unloaded",g(null);else if(A)o.state="errored",g(A);else if(M){this.map._refreshExpiredTiles&&o.setExpiryData(F);const Z=this.map.painter.context,J=Z.gl;o.texture=this.map.painter.getTileTexture(M.width),o.texture?o.texture.update(M,{useMipmap:!0}):(o.texture=new Re(Z,M,J.RGBA,{useMipmap:!0}),o.texture.bind(J.LINEAR,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST),Z.extTextureFilterAnisotropic&&J.texParameterf(J.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax)),o.state="loaded",p.cacheEntryPossiblyAdded(this.dispatcher),g(null)}})}abortTile(o,g){o.request&&(o.request.cancel(),delete o.request),g()}unloadTile(o,g){o.texture&&this.map.painter.saveTileTexture(o.texture),g()}hasTransition(){return!1}}let bi;class zt extends Dt{constructor(o,g,I,A){super(o,g,I,A),this.type="raster-dem",this.maxzoom=22,this._options=p.extend({type:"raster-dem"},g),this.encoding=g.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(o,g){const I=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function A(M,F){M&&(o.state="errored",g(M)),F&&(o.dem=F,o.needsHillshadePrepare=!0,o.state="loaded",g(null))}o.request=p.getImage(this.map._requestManager.transformRequest(I,p.ResourceType.Tile),function(M,F){if(delete o.request,o.aborted)o.state="unloaded",g(null);else if(M)o.state="errored",g(M);else if(F){this.map._refreshExpiredTiles&&o.setExpiryData(F),delete F.cacheControl,delete F.expires;const Z=p.isImageBitmap(F)&&(bi==null&&(bi=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),bi)?F:p.exported.getImageData(F,1),J={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:Z,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",J,A.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)}_getNeighboringTiles(o){const g=o.canonical,I=Math.pow(2,g.z),A=(g.x-1+I)%I,M=g.x===0?o.wrap-1:o.wrap,F=(g.x+1+I)%I,Z=g.x+1===I?o.wrap+1:o.wrap,J={};return J[new p.OverscaledTileID(o.overscaledZ,M,g.z,A,g.y).key]={backfilled:!1},J[new p.OverscaledTileID(o.overscaledZ,Z,g.z,F,g.y).key]={backfilled:!1},g.y>0&&(J[new p.OverscaledTileID(o.overscaledZ,M,g.z,A,g.y-1).key]={backfilled:!1},J[new p.OverscaledTileID(o.overscaledZ,o.wrap,g.z,g.x,g.y-1).key]={backfilled:!1},J[new p.OverscaledTileID(o.overscaledZ,Z,g.z,F,g.y-1).key]={backfilled:!1}),g.y+1<I&&(J[new p.OverscaledTileID(o.overscaledZ,M,g.z,A,g.y+1).key]={backfilled:!1},J[new p.OverscaledTileID(o.overscaledZ,o.wrap,g.z,g.x,g.y+1).key]={backfilled:!1},J[new p.OverscaledTileID(o.overscaledZ,Z,g.z,F,g.y+1).key]={backfilled:!1}),J}unloadTile(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})}}class Yt extends p.Evented{constructor(o,g,I,A){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=I.getActor(),this.setEventedParent(A),this._data=g.data,this._options=p.extend({},g),this._collectResourceTiming=g.collectResourceTiming,g.maxzoom!==void 0&&(this.maxzoom=g.maxzoom),g.type&&(this.type=g.type),g.attribution&&(this.attribution=g.attribution),this.promoteId=g.promoteId;const M=p.EXTENT/this.tileSize;this.workerOptions=p.extend({source:this.id,cluster:g.cluster||!1,geojsonVtOptions:{buffer:(g.buffer!==void 0?g.buffer:128)*M,tolerance:(g.tolerance!==void 0?g.tolerance:.375)*M,extent:p.EXTENT,maxZoom:this.maxzoom,lineMetrics:g.lineMetrics||!1,generateId:g.generateId||!1},superclusterOptions:{maxZoom:g.clusterMaxZoom!==void 0?g.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,g.clusterMinPoints||2),extent:p.EXTENT,radius:(g.clusterRadius||50)*M,log:!1,generateId:g.generateId||!1},clusterProperties:g.clusterProperties,filter:g.filter},g.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData("content"),this}getClusterExpansionZoom(o,g){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},g),this}getClusterChildren(o,g){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},g),this}getClusterLeaves(o,g,I,A){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:g,offset:I},A),this}_updateWorkerData(o){const g=p.extend({},this.workerOptions),I=this._data;typeof I=="string"?(g.request=this.map._requestManager.transformRequest(p.exported.resolveURL(I),p.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(I),this._pendingLoads++,this.fire(new p.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,g,(A,M)=>{if(this._pendingLoads--,this._removed||M&&M.abandoned)return;let F=null;if(M&&M.resourceTiming&&M.resourceTiming[this.id]&&(F=M.resourceTiming[this.id].slice(0)),this.actor.send(`${this.type}.coalesce`,{source:g.source},null),A)return void this.fire(new p.ErrorEvent(A));const Z={dataType:"source",sourceDataType:o};this._collectResourceTiming&&F&&F.length>0&&p.extend(Z,{resourceTiming:F}),this.fire(new p.Event("data",Z))})}loaded(){return this._pendingLoads===0}loadTile(o,g){const I=o.actor?"reloadTile":"loadTile";o.actor=this.actor;const A={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};o.request=this.actor.send(I,A,(M,F)=>(delete o.request,o.unloadVectorData(),o.aborted?g(null):M?g(M):(o.loadVectorData(F,this.map.painter,I==="reloadTile"),g(null))))}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0}unloadTile(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return p.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Et=p.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class xi extends p.Evented{constructor(o,g,I,A){super(),this.id=o,this.dispatcher=I,this.coordinates=g.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(A),this.options=g}load(o,g){this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this.url=this.options.url,p.getImage(this.map._requestManager.transformRequest(this.url,p.ResourceType.Image),(I,A)=>{this._loaded=!0,I?this.fire(new p.ErrorEvent(I)):A&&(this.image=A,o&&(this.coordinates=o),g&&g(),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}setCoordinates(o){this.coordinates=o;const g=o.map(p.MercatorCoordinate.fromLngLat);this.tileID=function(A){let M=1/0,F=1/0,Z=-1/0,J=-1/0;for(const xe of A)M=Math.min(M,xe.x),F=Math.min(F,xe.y),Z=Math.max(Z,xe.x),J=Math.max(J,xe.y);const ee=Math.max(Z-M,J-F),re=Math.max(0,Math.floor(-Math.log(ee)/Math.LN2)),ue=Math.pow(2,re);return new p.CanonicalTileID(re,Math.floor((M+Z)/2*ue),Math.floor((F+J)/2*ue))}(g),this.minzoom=this.maxzoom=this.tileID.z;const I=g.map(A=>this.tileID.getTilePoint(A)._round());return this._boundsArray=new p.RasterBoundsArray,this._boundsArray.emplaceBack(I[0].x,I[0].y,0,0),this._boundsArray.emplaceBack(I[1].x,I[1].y,p.EXTENT,0),this._boundsArray.emplaceBack(I[3].x,I[3].y,0,p.EXTENT),this._boundsArray.emplaceBack(I[2].x,I[2].y,p.EXTENT,p.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,g=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Et.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Re(o,this.image,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE));for(const I in this.tiles){const A=this.tiles[I];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture)}}loadTile(o,g){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},g(null)):(o.state="errored",g(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Gt extends xi{constructor(o,g,I,A){super(o,g,I,A),this.roundZoom=!0,this.type="video",this.options=g}load(){this._loaded=!1;const o=this.options;this.urls=[];for(const g of o.urls)this.urls.push(this.map._requestManager.transformRequest(g,p.ResourceType.Source).url);p.getVideo(this.urls,(g,I)=>{this._loaded=!0,g?this.fire(new p.ErrorEvent(g)):I&&(this.video=I,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const g=this.video.seekable;o<g.start(0)||o>g.end(0)?this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${g.start(0)} and ${g.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const o=this.map.painter.context,g=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Et.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE),g.texSubImage2D(g.TEXTURE_2D,0,0,0,g.RGBA,g.UNSIGNED_BYTE,this.video)):(this.texture=new Re(o,this.video,g.RGBA),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE));for(const I in this.tiles){const A=this.tiles[I];A.state!=="loaded"&&(A.state="loaded",A.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Ji extends xi{constructor(o,g,I,A){super(o,g,I,A),g.coordinates?Array.isArray(g.coordinates)&&g.coordinates.length===4&&!g.coordinates.some(M=>!Array.isArray(M)||M.length!==2||M.some(F=>typeof F!="number"))||this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${o}`,null,'missing required property "coordinates"'))),g.animate&&typeof g.animate!="boolean"&&this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),g.canvas?typeof g.canvas=="string"||g.canvas instanceof HTMLCanvasElement||this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${o}`,null,'missing required property "canvas"'))),this.options=g,this.animate=g.animate===void 0||g.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new p.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const g=this.map.painter.context,I=g.gl;this.boundsBuffer||(this.boundsBuffer=g.createVertexBuffer(this._boundsArray,Et.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Re(g,this.canvas,I.RGBA,{premultiply:!0});for(const A in this.tiles){const M=this.tiles[A];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Ni={vector:Fi,raster:Dt,"raster-dem":zt,geojson:Yt,video:Gt,image:xi,canvas:Ji};function Ai(T,o){const g=p.create();return p.translate(g,g,[1,1,0]),p.scale(g,g,[.5*T.width,.5*T.height,1]),p.multiply(g,g,T.calculatePosMatrix(o.toUnwrapped()))}function or(T,o,g,I,A,M){const F=function(ue,xe,Fe){if(ue)for(const we of ue){const Oe=xe[we];if(Oe&&Oe.source===Fe&&Oe.type==="fill-extrusion")return!0}else for(const we in xe){const Oe=xe[we];if(Oe.source===Fe&&Oe.type==="fill-extrusion")return!0}return!1}(A&&A.layers,o,T.id),Z=M.maxPitchScaleFactor(),J=T.tilesIn(I,Z,F);J.sort(Li);const ee=[];for(const ue of J)ee.push({wrappedTileID:ue.tileID.wrapped().key,queryResults:ue.tile.queryRenderedFeatures(o,g,T._state,ue.queryGeometry,ue.cameraQueryGeometry,ue.scale,A,M,Z,Ai(T.transform,ue.tileID))});const re=function(ue){const xe={},Fe={};for(const we of ue){const Oe=we.queryResults,Je=we.wrappedTileID,Xe=Fe[Je]=Fe[Je]||{};for(const nt in Oe){const $e=Oe[nt],wt=Xe[nt]=Xe[nt]||{},dt=xe[nt]=xe[nt]||[];for(const yt of $e)wt[yt.featureIndex]||(wt[yt.featureIndex]=!0,dt.push(yt))}}return xe}(ee);for(const ue in re)re[ue].forEach(xe=>{const Fe=xe.feature,we=T.getFeatureState(Fe.layer["source-layer"],Fe.id);Fe.source=Fe.layer.source,Fe.layer["source-layer"]&&(Fe.sourceLayer=Fe.layer["source-layer"]),Fe.state=we});return re}function Li(T,o){const g=T.tileID,I=o.tileID;return g.overscaledZ-I.overscaledZ||g.canonical.y-I.canonical.y||g.wrap-I.wrap||g.canonical.x-I.canonical.x}class Mt{constructor(o,g){this.tileID=o,this.uid=p.uniqueId(),this.uses=0,this.tileSize=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const g=o+this.timeAdded;g<p.exported.now()||this.fadeEndTime&&g<this.fadeEndTime||(this.fadeEndTime=g)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}loadVectorData(o,g,I){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(A,M){const F={};if(!M)return F;for(const Z of A){const J=Z.layerIds.map(ee=>M.getLayer(ee)).filter(Boolean);if(J.length!==0){Z.layers=J,Z.stateDependentLayerIds&&(Z.stateDependentLayers=Z.stateDependentLayerIds.map(ee=>J.filter(re=>re.id===ee)[0]));for(const ee of J)F[ee.id]=Z}}return F}(o.buckets,g.style),this.hasSymbolBuckets=!1;for(const A in this.buckets){const M=this.buckets[A];if(M instanceof p.SymbolBucket){if(this.hasSymbolBuckets=!0,!I)break;M.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const A in this.buckets){const M=this.buckets[A];if(M instanceof p.SymbolBucket&&M.hasRTLText){this.hasRTLText=!0,p.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const A in this.buckets){const M=this.buckets[A];this.queryPadding=Math.max(this.queryPadding,g.style.getLayer(A).queryRadius(M))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new p.CollisionBoxArray}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const I in this.buckets){const A=this.buckets[I];A.uploadPending()&&A.upload(o)}const g=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Re(o,this.imageAtlas.image,g.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Re(o,this.glyphAtlasImage,g.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,g,I,A,M,F,Z,J,ee,re){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:A,cameraQueryGeometry:M,scale:F,tileSize:this.tileSize,pixelPosMatrix:re,transform:J,params:Z,queryPadding:this.queryPadding*ee},o,g,I):{}}querySourceFeatures(o,g){const I=this.latestFeatureIndex;if(!I||!I.rawTileData)return;const A=I.loadVTLayers(),M=g?g.sourceLayer:"",F=A._geojsonTileLayer||A[M];if(!F)return;const Z=p.createFilter(g&&g.filter),{z:J,x:ee,y:re}=this.tileID.canonical,ue={z:J,x:ee,y:re};for(let xe=0;xe<F.length;xe++){const Fe=F.feature(xe);if(Z.needGeometry){const Je=p.toEvaluationFeature(Fe,!0);if(!Z.filter(new p.EvaluationParameters(this.tileID.overscaledZ),Je,this.tileID.canonical))continue}else if(!Z.filter(new p.EvaluationParameters(this.tileID.overscaledZ),Fe))continue;const we=I.getId(Fe,M),Oe=new p.GeoJSONFeature(Fe,J,ee,re,we);Oe.tile=ue,o.push(Oe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const g=this.expirationTime;if(o.cacheControl){const I=p.parseCacheControl(o.cacheControl);I["max-age"]&&(this.expirationTime=Date.now()+1e3*I["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const I=Date.now();let A=!1;if(this.expirationTime>I)A=!1;else if(g)if(this.expirationTime<g)A=!0;else{const M=this.expirationTime-g;M?this.expirationTime=I+Math.max(M,3e4):A=!0}else A=!0;A?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,g){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const I=this.latestFeatureIndex.loadVTLayers();for(const A in this.buckets){if(!g.style.hasLayer(A))continue;const M=this.buckets[A],F=M.layers[0].sourceLayer||"_geojsonTileLayer",Z=I[F],J=o[F];if(!Z||!J||Object.keys(J).length===0)continue;M.update(J,Z,this.imageAtlas&&this.imageAtlas.patternPositions||{});const ee=g&&g.style&&g.style.getLayer(A);ee&&(this.queryPadding=Math.max(this.queryPadding,ee.queryRadius(M)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<p.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=p.exported.now()+o}setDependencies(o,g){const I={};for(const A of g)I[A]=!0;this.dependencies[o]=I}hasDependency(o,g){for(const I of o){const A=this.dependencies[I];if(A){for(const M of g)if(A[M])return!0}}return!1}}class rr{constructor(o,g){this.max=o,this.onRemove=g,this.reset()}reset(){for(const o in this.data)for(const g of this.data[o])g.timeout&&clearTimeout(g.timeout),this.onRemove(g.value);return this.data={},this.order=[],this}add(o,g,I){const A=o.wrapped().key;this.data[A]===void 0&&(this.data[A]=[]);const M={value:g,timeout:void 0};if(I!==void 0&&(M.timeout=setTimeout(()=>{this.remove(o,M)},I)),this.data[A].push(M),this.order.push(A),this.order.length>this.max){const F=this._getAndRemoveByKey(this.order[0]);F&&this.onRemove(F)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const g=this.data[o].shift();return g.timeout&&clearTimeout(g.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),g.value}getByKey(o){const g=this.data[o];return g?g[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,g){if(!this.has(o))return this;const I=o.wrapped().key,A=g===void 0?0:this.data[I].indexOf(g),M=this.data[I][A];return this.data[I].splice(A,1),M.timeout&&clearTimeout(M.timeout),this.data[I].length===0&&delete this.data[I],this.onRemove(M.value),this.order.splice(this.order.indexOf(I),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}filter(o){const g=[];for(const I in this.data)for(const A of this.data[I])o(A.value)||g.push(A);for(const I of g)this.remove(I.value.tileID,I)}}class Ft{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,g,I){const A=String(g);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][A]=this.stateChanges[o][A]||{},p.extend(this.stateChanges[o][A],I),this.deletedStates[o]===null){this.deletedStates[o]={};for(const M in this.state[o])M!==A&&(this.deletedStates[o][M]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][A]===null){this.deletedStates[o][A]={};for(const M in this.state[o][A])I[M]||(this.deletedStates[o][A][M]=null)}else for(const M in I)this.deletedStates[o]&&this.deletedStates[o][A]&&this.deletedStates[o][A][M]===null&&delete this.deletedStates[o][A][M]}removeFeatureState(o,g,I){if(this.deletedStates[o]===null)return;const A=String(g);if(this.deletedStates[o]=this.deletedStates[o]||{},I&&g!==void 0)this.deletedStates[o][A]!==null&&(this.deletedStates[o][A]=this.deletedStates[o][A]||{},this.deletedStates[o][A][I]=null);else if(g!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][A])for(I in this.deletedStates[o][A]={},this.stateChanges[o][A])this.deletedStates[o][A][I]=null;else this.deletedStates[o][A]=null;else this.deletedStates[o]=null}getState(o,g){const I=String(g),A=p.extend({},(this.state[o]||{})[I],(this.stateChanges[o]||{})[I]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const M=this.deletedStates[o][g];if(M===null)return{};for(const F in M)delete A[F]}return A}initializeTileState(o,g){o.setFeatureState(this.state,g)}coalesceChanges(o,g){const I={};for(const A in this.stateChanges){this.state[A]=this.state[A]||{};const M={};for(const F in this.stateChanges[A])this.state[A][F]||(this.state[A][F]={}),p.extend(this.state[A][F],this.stateChanges[A][F]),M[F]=this.state[A][F];I[A]=M}for(const A in this.deletedStates){this.state[A]=this.state[A]||{};const M={};if(this.deletedStates[A]===null)for(const F in this.state[A])M[F]={},this.state[A][F]={};else for(const F in this.deletedStates[A]){if(this.deletedStates[A][F]===null)this.state[A][F]={};else for(const Z of Object.keys(this.deletedStates[A][F]))delete this.state[A][F][Z];M[F]=this.state[A][F]}I[A]=I[A]||{},p.extend(I[A],M)}if(this.stateChanges={},this.deletedStates={},Object.keys(I).length!==0)for(const A in o)o[A].setFeatureState(I,g)}}class rt extends p.Evented{constructor(o,g,I){super(),this.id=o,this.dispatcher=I,this.on("data",A=>{A.dataType==="source"&&A.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&A.dataType==="source"&&A.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(A,M,F,Z){const J=new Ni[M.type](A,M,F,Z);if(J.id!==A)throw new Error(`Expected Source id to be ${A} instead of ${J.id}`);return p.bindAll(["load","abort","unload","serialize","prepare"],J),J}(o,g,I,this),this._tiles={},this._cache=new rr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ft}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const g=this._tiles[o];if(g.state!=="loaded"&&g.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,g){return this._source.loadTile(o,g)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){this._source.abortTile&&this._source.abortTile(o,()=>{}),this._source.fire(new p.Event("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const g in this._tiles){const I=this._tiles[g];I.upload(o),I.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(wi).map(o=>o.key)}getRenderableIds(o){const g=[];for(const I in this._tiles)this._isIdRenderable(I,o)&&g.push(this._tiles[I]);return o?g.sort((I,A)=>{const M=I.tileID,F=A.tileID,Z=new p.pointGeometry(M.canonical.x,M.canonical.y)._rotate(this.transform.angle),J=new p.pointGeometry(F.canonical.x,F.canonical.y)._rotate(this.transform.angle);return M.overscaledZ-F.overscaledZ||J.y-Z.y||J.x-Z.x}).map(I=>I.tileID.key):g.map(I=>I.tileID).sort(wi).map(I=>I.key)}hasRenderableParent(o){const g=this.findLoadedParent(o,0);return!!g&&this._isIdRenderable(g.tileID.key)}_isIdRenderable(o,g){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(g||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")}}_reloadTile(o,g){const I=this._tiles[o];I&&(I.state!=="loading"&&(I.state=g),this._loadTile(I,this._tileLoaded.bind(this,I,o,g)))}_tileLoaded(o,g,I,A){if(A)return o.state="errored",void(A.status!==404?this._source.fire(new p.ErrorEvent(A,{tile:o})):this.update(this.transform));o.timeAdded=p.exported.now(),I==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(g,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new p.Event("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const g=this.getRenderableIds();for(let A=0;A<g.length;A++){const M=g[A];if(o.neighboringTiles&&o.neighboringTiles[M]){const F=this.getTileByID(M);I(o,F),I(F,o)}}function I(A,M){A.needsHillshadePrepare=!0;let F=M.tileID.canonical.x-A.tileID.canonical.x;const Z=M.tileID.canonical.y-A.tileID.canonical.y,J=Math.pow(2,A.tileID.canonical.z),ee=M.tileID.key;F===0&&Z===0||Math.abs(Z)>1||(Math.abs(F)>1&&(Math.abs(F+J)===1?F+=J:Math.abs(F-J)===1&&(F-=J)),M.dem&&A.dem&&(A.dem.backfillBorder(M.dem,F,Z),A.neighboringTiles&&A.neighboringTiles[ee]&&(A.neighboringTiles[ee].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,g,I,A){for(const M in this._tiles){let F=this._tiles[M];if(A[M]||!F.hasData()||F.tileID.overscaledZ<=g||F.tileID.overscaledZ>I)continue;let Z=F.tileID;for(;F&&F.tileID.overscaledZ>g+1;){const ee=F.tileID.scaledTo(F.tileID.overscaledZ-1);F=this._tiles[ee.key],F&&F.hasData()&&(Z=ee)}let J=Z;for(;J.overscaledZ>g;)if(J=J.scaledTo(J.overscaledZ-1),o[J.key]){A[Z.key]=Z;break}}}findLoadedParent(o,g){if(o.key in this._loadedParentTiles){const I=this._loadedParentTiles[o.key];return I&&I.tileID.overscaledZ>=g?I:null}for(let I=o.overscaledZ-1;I>=g;I--){const A=o.scaledTo(I),M=this._getLoadedTile(A);if(M)return M}}_getLoadedTile(o){const g=this._tiles[o.key];return g&&g.hasData()?g:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const g=Math.ceil(o.width/this._source.tileSize)+1,I=Math.ceil(o.height/this._source.tileSize)+1,A=Math.floor(g*I*5),M=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,A):A;this._cache.setMaxSize(M)}handleWrapJump(o){const g=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,g){const I={};for(const A in this._tiles){const M=this._tiles[A];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+g),I[M.tileID.key]=M}this._tiles=I;for(const A in this._timers)clearTimeout(this._timers[A]),delete this._timers[A];for(const A in this._tiles)this._setTileReloadTimer(A,this._tiles[A])}}update(o){if(this.transform=o,!this._sourceLoaded||this._paused)return;let g;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?g=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(J=>new p.OverscaledTileID(J.canonical.z,J.wrap,J.canonical.z,J.canonical.x,J.canonical.y)):(g=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(g=g.filter(J=>this._source.hasTile(J)))):g=[];const I=o.coveringZoomLevel(this._source),A=Math.max(I-rt.maxOverzooming,this._source.minzoom),M=Math.max(I+rt.maxUnderzooming,this._source.minzoom),F=this._updateRetainedTiles(g,I);if(nr(this._source.type)){const J={},ee={},re=Object.keys(F);for(const ue of re){const xe=F[ue],Fe=this._tiles[ue];if(!Fe||Fe.fadeEndTime&&Fe.fadeEndTime<=p.exported.now())continue;const we=this.findLoadedParent(xe,A);we&&(this._addTile(we.tileID),J[we.tileID.key]=we.tileID),ee[ue]=xe}this._retainLoadedChildren(ee,I,M,F);for(const ue in J)F[ue]||(this._coveredTiles[ue]=!0,F[ue]=J[ue])}for(const J in F)this._tiles[J].clearFadeHold();const Z=p.keysDifference(this._tiles,F);for(const J of Z){const ee=this._tiles[J];ee.hasSymbolBuckets&&!ee.holdingForFade()?ee.setHoldDuration(this.map._fadeDuration):ee.hasSymbolBuckets&&!ee.symbolFadeFinished()||this._removeTile(J)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,g){const I={},A={},M=Math.max(g-rt.maxOverzooming,this._source.minzoom),F=Math.max(g+rt.maxUnderzooming,this._source.minzoom),Z={};for(const J of o){const ee=this._addTile(J);I[J.key]=J,ee.hasData()||g<this._source.maxzoom&&(Z[J.key]=J)}this._retainLoadedChildren(Z,g,F,I);for(const J of o){let ee=this._tiles[J.key];if(ee.hasData())continue;if(g+1>this._source.maxzoom){const ue=J.children(this._source.maxzoom)[0],xe=this.getTile(ue);if(xe&&xe.hasData()){I[ue.key]=ue;continue}}else{const ue=J.children(this._source.maxzoom);if(I[ue[0].key]&&I[ue[1].key]&&I[ue[2].key]&&I[ue[3].key])continue}let re=ee.wasRequested();for(let ue=J.overscaledZ-1;ue>=M;--ue){const xe=J.scaledTo(ue);if(A[xe.key]||(A[xe.key]=!0,ee=this.getTile(xe),!ee&&re&&(ee=this._addTile(xe)),ee&&(I[xe.key]=xe,re=ee.wasRequested(),ee.hasData())))break}}return I}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const g=[];let I,A=this._tiles[o].tileID;for(;A.overscaledZ>0;){if(A.key in this._loadedParentTiles){I=this._loadedParentTiles[A.key];break}g.push(A.key);const M=A.scaledTo(A.overscaledZ-1);if(I=this._getLoadedTile(M),I)break;A=M}for(const M of g)this._loadedParentTiles[M]=I}}_addTile(o){let g=this._tiles[o.key];if(g)return g;g=this._cache.getAndRemove(o),g&&(this._setTileReloadTimer(o.key,g),g.tileID=o,this._state.initializeTileState(g,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,g)));const I=g;return g||(g=new Mt(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(g,this._tileLoaded.bind(this,g,o.key,g.state))),g.uses++,this._tiles[o.key]=g,I||this._source.fire(new p.Event("dataloading",{tile:g,coord:g.tileID,dataType:"source"})),g}_setTileReloadTimer(o,g){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const I=g.getExpiryTimeout();I&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},I))}_removeTile(o){const g=this._tiles[o];g&&(g.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),g.uses>0||(g.hasData()&&g.state!=="reloading"?this._cache.add(g.tileID,g,g.getExpiryTimeout()):(g.aborted=!0,this._abortTile(g),this._unloadTile(g))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,g,I){const A=[],M=this.transform;if(!M)return A;const F=I?M.getCameraQueryGeometry(o):o,Z=o.map(we=>M.pointCoordinate(we)),J=F.map(we=>M.pointCoordinate(we)),ee=this.getIds();let re=1/0,ue=1/0,xe=-1/0,Fe=-1/0;for(const we of J)re=Math.min(re,we.x),ue=Math.min(ue,we.y),xe=Math.max(xe,we.x),Fe=Math.max(Fe,we.y);for(let we=0;we<ee.length;we++){const Oe=this._tiles[ee[we]];if(Oe.holdingForFade())continue;const Je=Oe.tileID,Xe=Math.pow(2,M.zoom-Oe.tileID.overscaledZ),nt=g*Oe.queryPadding*p.EXTENT/Oe.tileSize/Xe,$e=[Je.getTilePoint(new p.MercatorCoordinate(re,ue)),Je.getTilePoint(new p.MercatorCoordinate(xe,Fe))];if($e[0].x-nt<p.EXTENT&&$e[0].y-nt<p.EXTENT&&$e[1].x+nt>=0&&$e[1].y+nt>=0){const wt=Z.map(yt=>Je.getTilePoint(yt)),dt=J.map(yt=>Je.getTilePoint(yt));A.push({tile:Oe,tileID:Je,queryGeometry:wt,cameraQueryGeometry:dt,scale:Xe})}}return A}getVisibleCoordinates(o){const g=this.getRenderableIds(o).map(I=>this._tiles[I].tileID);for(const I of g)I.posMatrix=this.transform.calculatePosMatrix(I.toUnwrapped());return g}hasTransition(){if(this._source.hasTransition())return!0;if(nr(this._source.type))for(const o in this._tiles){const g=this._tiles[o];if(g.fadeEndTime!==void 0&&g.fadeEndTime>=p.exported.now())return!0}return!1}setFeatureState(o,g,I){this._state.updateState(o=o||"_geojsonTileLayer",g,I)}removeFeatureState(o,g,I){this._state.removeFeatureState(o=o||"_geojsonTileLayer",g,I)}getFeatureState(o,g){return this._state.getState(o=o||"_geojsonTileLayer",g)}setDependencies(o,g,I){const A=this._tiles[o];A&&A.setDependencies(g,I)}reloadTilesForDependencies(o,g){for(const I in this._tiles)this._tiles[I].hasDependency(o,g)&&this._reloadTile(I,"reloading");this._cache.filter(I=>!I.hasDependency(o,g))}}function wi(T,o){const g=Math.abs(2*T.wrap)-+(T.wrap<0),I=Math.abs(2*o.wrap)-+(o.wrap<0);return T.overscaledZ-o.overscaledZ||I-g||o.canonical.y-T.canonical.y||o.canonical.x-T.canonical.x}function nr(T){return T==="raster"||T==="image"||T==="video"}rt.maxOverzooming=10,rt.maxUnderzooming=3;const Pr="mapboxgl_preloaded_worker_pool";class ho{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<ho.workerCount;)this.workers.push(new Worker(Vo.workerUrl));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(g=>{g.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Pr]}numActive(){return Object.keys(this.active).length}}const Jn=Math.floor(p.exported.hardwareConcurrency/2);let Fo;function xn(){return Fo||(Fo=new ho),Fo}function po(T,o){const g={};for(const I in T)I!=="ref"&&(g[I]=T[I]);return p.refProperties.forEach(I=>{I in o&&(g[I]=o[I])}),g}function Yn(T){T=T.slice();const o=Object.create(null);for(let g=0;g<T.length;g++)o[T[g].id]=T[g];for(let g=0;g<T.length;g++)"ref"in T[g]&&(T[g]=po(T[g],o[T[g].ref]));return T}ho.workerCount=Math.max(Math.min(Jn,6),1);const Wi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Nn(T,o,g){g.push({command:Wi.addSource,args:[T,o[T]]})}function Ao(T,o,g){o.push({command:Wi.removeSource,args:[T]}),g[T]=!0}function $n(T,o,g,I){Ao(T,g,I),Nn(T,o,g)}function Ua(T,o,g){let I;for(I in T[g])if(Object.prototype.hasOwnProperty.call(T[g],I)&&I!=="data"&&!G(T[g][I],o[g][I]))return!1;for(I in o[g])if(Object.prototype.hasOwnProperty.call(o[g],I)&&I!=="data"&&!G(T[g][I],o[g][I]))return!1;return!0}function qe(T,o,g,I,A,M){let F;for(F in o=o||{},T=T||{})Object.prototype.hasOwnProperty.call(T,F)&&(G(T[F],o[F])||g.push({command:M,args:[I,F,o[F],A]}));for(F in o)Object.prototype.hasOwnProperty.call(o,F)&&!Object.prototype.hasOwnProperty.call(T,F)&&(G(T[F],o[F])||g.push({command:M,args:[I,F,o[F],A]}))}function _t(T){return T.id}function Ci(T,o){return T[o.id]=o,T}class fr{constructor(o,g){this.reset(o,g)}reset(o,g){this.points=o||[],this._distances=[0];for(let I=1;I<this.points.length;I++)this._distances[I]=this._distances[I-1]+this.points[I].dist(this.points[I-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(g||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=p.clamp(o,0,1);let g=1,I=this._distances[g];const A=o*this.paddedLength+this.padding;for(;I<A&&g<this._distances.length;)I=this._distances[++g];const M=g-1,F=this._distances[M],Z=I-F,J=Z>0?(A-F)/Z:0;return this.points[M].mult(1-J).add(this.points[g].mult(J))}}function wr(T,o){let g=!0;return T==="always"||T!=="never"&&o!=="never"||(g=!1),g}class Qn{constructor(o,g,I){const A=this.boxCells=[],M=this.circleCells=[];this.xCellCount=Math.ceil(o/I),this.yCellCount=Math.ceil(g/I);for(let F=0;F<this.xCellCount*this.yCellCount;F++)A.push([]),M.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=g,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/g,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,g,I,A,M){this._forEachCell(g,I,A,M,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(g),this.bboxes.push(I),this.bboxes.push(A),this.bboxes.push(M)}insertCircle(o,g,I,A){this._forEachCell(g-A,I-A,g+A,I+A,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(g),this.circles.push(I),this.circles.push(A)}_insertBoxCell(o,g,I,A,M,F){this.boxCells[M].push(F)}_insertCircleCell(o,g,I,A,M,F){this.circleCells[M].push(F)}_query(o,g,I,A,M,F,Z){if(I<0||o>this.width||A<0||g>this.height)return[];const J=[];if(o<=0&&g<=0&&this.width<=I&&this.height<=A){if(M)return[{key:null,x1:o,y1:g,x2:I,y2:A}];for(let ee=0;ee<this.boxKeys.length;ee++)J.push({key:this.boxKeys[ee],x1:this.bboxes[4*ee],y1:this.bboxes[4*ee+1],x2:this.bboxes[4*ee+2],y2:this.bboxes[4*ee+3]});for(let ee=0;ee<this.circleKeys.length;ee++){const re=this.circles[3*ee],ue=this.circles[3*ee+1],xe=this.circles[3*ee+2];J.push({key:this.circleKeys[ee],x1:re-xe,y1:ue-xe,x2:re+xe,y2:ue+xe})}}else this._forEachCell(o,g,I,A,this._queryCell,J,{hitTest:M,overlapMode:F,seenUids:{box:{},circle:{}}},Z);return J}query(o,g,I,A){return this._query(o,g,I,A,!1,null)}hitTest(o,g,I,A,M,F){return this._query(o,g,I,A,!0,M,F).length>0}hitTestCircle(o,g,I,A,M){const F=o-I,Z=o+I,J=g-I,ee=g+I;if(Z<0||F>this.width||ee<0||J>this.height)return!1;const re=[];return this._forEachCell(F,J,Z,ee,this._queryCellCircle,re,{hitTest:!0,overlapMode:A,circle:{x:o,y:g,radius:I},seenUids:{box:{},circle:{}}},M),re.length>0}_queryCell(o,g,I,A,M,F,Z,J){const{seenUids:ee,hitTest:re,overlapMode:ue}=Z,xe=this.boxCells[M];if(xe!==null){const we=this.bboxes;for(const Oe of xe)if(!ee.box[Oe]){ee.box[Oe]=!0;const Je=4*Oe,Xe=this.boxKeys[Oe];if(o<=we[Je+2]&&g<=we[Je+3]&&I>=we[Je+0]&&A>=we[Je+1]&&(!J||J(Xe))&&(!re||!wr(ue,Xe.overlapMode))&&(F.push({key:Xe,x1:we[Je],y1:we[Je+1],x2:we[Je+2],y2:we[Je+3]}),re))return!0}}const Fe=this.circleCells[M];if(Fe!==null){const we=this.circles;for(const Oe of Fe)if(!ee.circle[Oe]){ee.circle[Oe]=!0;const Je=3*Oe,Xe=this.circleKeys[Oe];if(this._circleAndRectCollide(we[Je],we[Je+1],we[Je+2],o,g,I,A)&&(!J||J(Xe))&&(!re||!wr(ue,Xe.overlapMode))){const nt=we[Je],$e=we[Je+1],wt=we[Je+2];if(F.push({key:Xe,x1:nt-wt,y1:$e-wt,x2:nt+wt,y2:$e+wt}),re)return!0}}}return!1}_queryCellCircle(o,g,I,A,M,F,Z,J){const{circle:ee,seenUids:re,overlapMode:ue}=Z,xe=this.boxCells[M];if(xe!==null){const we=this.bboxes;for(const Oe of xe)if(!re.box[Oe]){re.box[Oe]=!0;const Je=4*Oe,Xe=this.boxKeys[Oe];if(this._circleAndRectCollide(ee.x,ee.y,ee.radius,we[Je+0],we[Je+1],we[Je+2],we[Je+3])&&(!J||J(Xe))&&!wr(ue,Xe.overlapMode))return F.push(!0),!0}}const Fe=this.circleCells[M];if(Fe!==null){const we=this.circles;for(const Oe of Fe)if(!re.circle[Oe]){re.circle[Oe]=!0;const Je=3*Oe,Xe=this.circleKeys[Oe];if(this._circlesCollide(we[Je],we[Je+1],we[Je+2],ee.x,ee.y,ee.radius)&&(!J||J(Xe))&&!wr(ue,Xe.overlapMode))return F.push(!0),!0}}}_forEachCell(o,g,I,A,M,F,Z,J){const ee=this._convertToXCellCoord(o),re=this._convertToYCellCoord(g),ue=this._convertToXCellCoord(I),xe=this._convertToYCellCoord(A);for(let Fe=ee;Fe<=ue;Fe++)for(let we=re;we<=xe;we++)if(M.call(this,o,g,I,A,this.xCellCount*we+Fe,F,Z,J))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,g,I,A,M,F){const Z=A-o,J=M-g,ee=I+F;return ee*ee>Z*Z+J*J}_circleAndRectCollide(o,g,I,A,M,F,Z){const J=(F-A)/2,ee=Math.abs(o-(A+J));if(ee>J+I)return!1;const re=(Z-M)/2,ue=Math.abs(g-(M+re));if(ue>re+I)return!1;if(ee<=J||ue<=re)return!0;const xe=ee-J,Fe=ue-re;return xe*xe+Fe*Fe<=I*I}}function eo(T,o,g,I,A){const M=p.create();return o?(p.scale(M,M,[1/A,1/A,1]),g||p.rotateZ(M,M,I.angle)):p.multiply(M,I.labelPlaneMatrix,T),M}function sa(T,o,g,I,A){if(o){const M=p.clone(T);return p.scale(M,M,[A,A,1]),g||p.rotateZ(M,M,-I.angle),M}return I.glCoordMatrix}function $r(T,o){const g=[T.x,T.y,0,1];oe(g,g,o);const I=g[3];return{point:new p.pointGeometry(g[0]/I,g[1]/I),signedDistanceFromCamera:I}}function Jt(T,o){return .5+T/o*.5}function ar(T,o){const g=T[0]/T[3],I=T[1]/T[3];return g>=-o[0]&&g<=o[0]&&I>=-o[1]&&I<=o[1]}function Yi(T,o,g,I,A,M,F,Z,J){const ee=I?T.textSizeData:T.iconSizeData,re=p.evaluateSizeForZoom(ee,g.transform.zoom),ue=[256/g.width*2+1,256/g.height*2+1],xe=I?T.text.dynamicLayoutVertexArray:T.icon.dynamicLayoutVertexArray;xe.clear();const Fe=T.lineVertexArray,we=I?T.text.placedSymbolArray:T.icon.placedSymbolArray,Oe=g.transform.width/g.transform.height;let Je=!1;for(let Xe=0;Xe<we.length;Xe++){const nt=we.get(Xe);if(nt.hidden||nt.writingMode===p.WritingMode.vertical&&!Je){te(nt.numGlyphs,xe);continue}Je=!1;const $e=[nt.anchorX,nt.anchorY,0,1];if(p.transformMat4($e,$e,o),!ar($e,ue)){te(nt.numGlyphs,xe);continue}const wt=Jt(g.transform.cameraToCenterDistance,$e[3]),dt=p.evaluateSizeForFeature(ee,re,nt),yt=F?dt/wt:dt*wt,Lt=new p.pointGeometry(nt.anchorX,nt.anchorY),Nt=$r(Lt,A).point,St={},mi=Gi(nt,yt,!1,Z,o,A,M,T.glyphOffsetArray,Fe,xe,Nt,Lt,St,Oe,J);Je=mi.useVertical,(mi.notEnoughRoom||Je||mi.needsFlipping&&Gi(nt,yt,!0,Z,o,A,M,T.glyphOffsetArray,Fe,xe,Nt,Lt,St,Oe,J).notEnoughRoom)&&te(nt.numGlyphs,xe)}I?T.text.dynamicLayoutVertexBuffer.updateData(xe):T.icon.dynamicLayoutVertexBuffer.updateData(xe)}function Rn(T,o,g,I,A,M,F,Z,J,ee,re,ue){const xe=Z.glyphStartIndex+Z.numGlyphs,Fe=Z.lineStartIndex,we=Z.lineStartIndex+Z.lineLength,Oe=o.getoffsetX(Z.glyphStartIndex),Je=o.getoffsetX(xe-1),Xe=Uo(T*Oe,g,I,A,M,F,Z.segment,Fe,we,J,ee,re,ue);if(!Xe)return null;const nt=Uo(T*Je,g,I,A,M,F,Z.segment,Fe,we,J,ee,re,ue);return nt?{first:Xe,last:nt}:null}function to(T,o,g,I){return T===p.WritingMode.horizontal&&Math.abs(g.y-o.y)>Math.abs(g.x-o.x)*I?{useVertical:!0}:(T===p.WritingMode.vertical?o.y<g.y:o.x>g.x)?{needsFlipping:!0}:null}function Gi(T,o,g,I,A,M,F,Z,J,ee,re,ue,xe,Fe,we){const Oe=o/24,Je=T.lineOffsetX*Oe,Xe=T.lineOffsetY*Oe;let nt;if(T.numGlyphs>1){const $e=T.glyphStartIndex+T.numGlyphs,wt=T.lineStartIndex,dt=T.lineStartIndex+T.lineLength,yt=Rn(Oe,Z,Je,Xe,g,re,ue,T,J,M,xe,we);if(!yt)return{notEnoughRoom:!0};const Lt=$r(yt.first.point,F).point,Nt=$r(yt.last.point,F).point;if(I&&!g){const St=to(T.writingMode,Lt,Nt,Fe);if(St)return St}nt=[yt.first];for(let St=T.glyphStartIndex+1;St<$e-1;St++)nt.push(Uo(Oe*Z.getoffsetX(St),Je,Xe,g,re,ue,T.segment,wt,dt,J,M,xe,we));nt.push(yt.last)}else{if(I&&!g){const wt=$r(ue,A).point,dt=T.lineStartIndex+T.segment+1,yt=new p.pointGeometry(J.getx(dt),J.gety(dt)),Lt=$r(yt,A),Nt=Lt.signedDistanceFromCamera>0?Lt.point:_a(ue,yt,wt,1,A),St=to(T.writingMode,wt,Nt,Fe);if(St)return St}const $e=Uo(Oe*Z.getoffsetX(T.glyphStartIndex),Je,Xe,g,re,ue,T.segment,T.lineStartIndex,T.lineStartIndex+T.lineLength,J,M,xe,we);if(!$e)return{notEnoughRoom:!0};nt=[$e]}for(const $e of nt)p.addDynamicAttributes(ee,$e.point,$e.angle);return{}}function _a(T,o,g,I,A){const M=$r(T.add(T.sub(o)._unit()),A).point,F=g.sub(M);return g.add(F._mult(I/F.mag()))}function Uo(T,o,g,I,A,M,F,Z,J,ee,re,ue,xe){const Fe=I?T-o:T+o;let we=Fe>0?1:-1,Oe=0;I&&(we*=-1,Oe=Math.PI),we<0&&(Oe+=Math.PI);let Je=we>0?Z+F:Z+F+1,Xe=A,nt=A,$e=0,wt=0;const dt=Math.abs(Fe),yt=[];for(;$e+wt<=dt;){if(Je+=we,Je<Z||Je>=J)return null;if(nt=Xe,yt.push(Xe),Xe=ue[Je],Xe===void 0){const ni=new p.pointGeometry(ee.getx(Je),ee.gety(Je)),qi=$r(ni,re);if(qi.signedDistanceFromCamera>0)Xe=ue[Je]=qi.point;else{const c=Je-we;Xe=_a($e===0?M:new p.pointGeometry(ee.getx(c),ee.gety(c)),ni,nt,dt-$e+1,re)}}$e+=wt,wt=nt.dist(Xe)}const Lt=(dt-$e)/wt,Nt=Xe.sub(nt),St=Nt.mult(Lt)._add(nt);St._add(Nt._unit()._perp()._mult(g*we));const mi=Oe+Math.atan2(Xe.y-nt.y,Xe.x-nt.x);return yt.push(St),{point:St,angle:xe?mi:0,path:yt}}const Xr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function te(T,o){for(let g=0;g<T;g++){const I=o.length;o.resize(I+4),o.float32.set(Xr,3*I)}}function oe(T,o,g){const I=o[0],A=o[1];return T[0]=g[0]*I+g[4]*A+g[12],T[1]=g[1]*I+g[5]*A+g[13],T[3]=g[3]*I+g[7]*A+g[15],T}const le=100;class _e{constructor(o,g=new Qn(o.width+200,o.height+200,25),I=new Qn(o.width+200,o.height+200,25)){this.transform=o,this.grid=g,this.ignoredGrid=I,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+le,this.screenBottomBoundary=o.height+le,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200}placeCollisionBox(o,g,I,A,M){const F=this.projectAndGetPerspectiveRatio(A,o.anchorPointX,o.anchorPointY),Z=I*F.perspectiveRatio,J=o.x1*Z+F.point.x,ee=o.y1*Z+F.point.y,re=o.x2*Z+F.point.x,ue=o.y2*Z+F.point.y;return!this.isInsideGrid(J,ee,re,ue)||g!=="always"&&this.grid.hitTest(J,ee,re,ue,g,M)?{box:[],offscreen:!1}:{box:[J,ee,re,ue],offscreen:this.isOffscreen(J,ee,re,ue)}}placeCollisionCircles(o,g,I,A,M,F,Z,J,ee,re,ue,xe,Fe){const we=[],Oe=new p.pointGeometry(g.anchorX,g.anchorY),Je=$r(Oe,F),Xe=Jt(this.transform.cameraToCenterDistance,Je.signedDistanceFromCamera),nt=(re?M/Xe:M*Xe)/p.ONE_EM,$e=$r(Oe,Z).point,wt=Rn(nt,A,g.lineOffsetX*nt,g.lineOffsetY*nt,!1,$e,Oe,g,I,Z,{},!1);let dt=!1,yt=!1,Lt=!0;if(wt){const Nt=.5*xe*Xe+Fe,St=new p.pointGeometry(-100,-100),mi=new p.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),ni=new fr,qi=wt.first,c=wt.last;let m=[];for(let k=qi.path.length-1;k>=1;k--)m.push(qi.path[k]);for(let k=1;k<c.path.length;k++)m.push(c.path[k]);const d=2.5*Nt;if(J){const k=m.map(D=>$r(D,J));m=k.some(D=>D.signedDistanceFromCamera<=0)?[]:k.map(D=>D.point)}let x=[];if(m.length>0){const k=m[0].clone(),D=m[0].clone();for(let B=1;B<m.length;B++)k.x=Math.min(k.x,m[B].x),k.y=Math.min(k.y,m[B].y),D.x=Math.max(D.x,m[B].x),D.y=Math.max(D.y,m[B].y);x=k.x>=St.x&&D.x<=mi.x&&k.y>=St.y&&D.y<=mi.y?[m]:D.x<St.x||k.x>mi.x||D.y<St.y||k.y>mi.y?[]:p.clipLine([m],St.x,St.y,mi.x,mi.y)}for(const k of x){ni.reset(k,.25*Nt);let D=0;D=ni.length<=.5*Nt?1:Math.ceil(ni.paddedLength/d)+1;for(let B=0;B<D;B++){const q=B/Math.max(D-1,1),Y=ni.lerp(q),ie=Y.x+le,he=Y.y+le;we.push(ie,he,Nt,0);const de=ie-Nt,me=he-Nt,ze=ie+Nt,Ce=he+Nt;if(Lt=Lt&&this.isOffscreen(de,me,ze,Ce),yt=yt||this.isInsideGrid(de,me,ze,Ce),o!=="always"&&this.grid.hitTestCircle(ie,he,Nt,o,ue)&&(dt=!0,!ee))return{circles:[],offscreen:!1,collisionDetected:dt}}}}return{circles:!ee&&dt||!yt?[]:we,offscreen:Lt,collisionDetected:dt}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const g=[];let I=1/0,A=1/0,M=-1/0,F=-1/0;for(const re of o){const ue=new p.pointGeometry(re.x+le,re.y+le);I=Math.min(I,ue.x),A=Math.min(A,ue.y),M=Math.max(M,ue.x),F=Math.max(F,ue.y),g.push(ue)}const Z=this.grid.query(I,A,M,F).concat(this.ignoredGrid.query(I,A,M,F)),J={},ee={};for(const re of Z){const ue=re.key;if(J[ue.bucketInstanceId]===void 0&&(J[ue.bucketInstanceId]={}),J[ue.bucketInstanceId][ue.featureIndex])continue;const xe=[new p.pointGeometry(re.x1,re.y1),new p.pointGeometry(re.x2,re.y1),new p.pointGeometry(re.x2,re.y2),new p.pointGeometry(re.x1,re.y2)];p.polygonIntersectsPolygon(g,xe)&&(J[ue.bucketInstanceId][ue.featureIndex]=!0,ee[ue.bucketInstanceId]===void 0&&(ee[ue.bucketInstanceId]=[]),ee[ue.bucketInstanceId].push(ue.featureIndex))}return ee}insertCollisionBox(o,g,I,A,M,F){(I?this.ignoredGrid:this.grid).insert({bucketInstanceId:A,featureIndex:M,collisionGroupID:F,overlapMode:g},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,g,I,A,M,F){const Z=I?this.ignoredGrid:this.grid,J={bucketInstanceId:A,featureIndex:M,collisionGroupID:F,overlapMode:g};for(let ee=0;ee<o.length;ee+=4)Z.insertCircle(J,o[ee],o[ee+1],o[ee+2])}projectAndGetPerspectiveRatio(o,g,I){const A=[g,I,0,1];return oe(A,A,o),{point:new p.pointGeometry((A[0]/A[3]+1)/2*this.transform.width+le,(-A[1]/A[3]+1)/2*this.transform.height+le),perspectiveRatio:.5+this.transform.cameraToCenterDistance/A[3]*.5}}isOffscreen(o,g,I,A){return I<le||o>=this.screenRightBoundary||A<le||g>this.screenBottomBoundary}isInsideGrid(o,g,I,A){return I>=0&&o<this.gridRightBoundary&&A>=0&&g<this.gridBottomBoundary}getViewportMatrix(){const o=p.identity([]);return p.translate(o,o,[-100,-100,0]),o}}function Ae(T,o,g){return o*(p.EXTENT/(T.tileSize*Math.pow(2,g-T.tileID.overscaledZ)))}class je{constructor(o,g,I,A){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?g:-g))):A&&I?1:0,this.placed=I}isHidden(){return this.opacity===0&&!this.placed}}class Ge{constructor(o,g,I,A,M){this.text=new je(o?o.text:null,g,I,M),this.icon=new je(o?o.icon:null,g,A,M)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ye{constructor(o,g,I){this.text=o,this.icon=g,this.skipFade=I}}class Me{constructor(){this.invProjMatrix=p.create(),this.viewportMatrix=p.create(),this.circles=[]}}class Qe{constructor(o,g,I,A,M){this.bucketInstanceId=o,this.featureIndex=g,this.sourceLayerIndex=I,this.bucketIndex=A,this.tileID=M}}class ae{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const g=++this.maxGroupID;this.collisionGroups[o]={ID:g,predicate:I=>I.collisionGroupID===g}}return this.collisionGroups[o]}}function H(T,o,g,I,A){const{horizontalAlign:M,verticalAlign:F}=p.getAnchorAlignment(T),Z=-(M-.5)*o,J=-(F-.5)*g,ee=p.evaluateVariableOffset(T,I);return new p.pointGeometry(Z+ee[0]*A,J+ee[1]*A)}function W(T,o,g,I,A,M){const{x1:F,x2:Z,y1:J,y2:ee,anchorPointX:re,anchorPointY:ue}=T,xe=new p.pointGeometry(o,g);return I&&xe._rotate(A?M:-M),{x1:F+xe.x,y1:J+xe.y,x2:Z+xe.x,y2:ee+xe.y,anchorPointX:re,anchorPointY:ue}}class ne{constructor(o,g,I,A){this.transform=o.clone(),this.collisionIndex=new _e(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new ae(I),this.collisionCircleArrays={},this.prevPlacement=A,A&&(A.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,g,I,A){const M=I.getBucket(g),F=I.latestFeatureIndex;if(!M||!F||g.id!==M.layerIds[0])return;const Z=I.collisionBoxArray,J=M.layers[0].layout,ee=Math.pow(2,this.transform.zoom-I.tileID.overscaledZ),re=I.tileSize/p.EXTENT,ue=this.transform.calculatePosMatrix(I.tileID.toUnwrapped()),xe=J.get("text-pitch-alignment")==="map",Fe=J.get("text-rotation-alignment")==="map",we=Ae(I,1,this.transform.zoom),Oe=eo(ue,xe,Fe,this.transform,we);let Je=null;if(xe){const nt=sa(ue,xe,Fe,this.transform,we);Je=p.multiply([],this.transform.labelPlaneMatrix,nt)}this.retainedQueryData[M.bucketInstanceId]=new Qe(M.bucketInstanceId,F,M.sourceLayerIndex,M.index,I.tileID);const Xe={bucket:M,layout:J,posMatrix:ue,textLabelPlaneMatrix:Oe,labelToScreenMatrix:Je,scale:ee,textPixelRatio:re,holdingForFade:I.holdingForFade(),collisionBoxArray:Z,partiallyEvaluatedTextSize:p.evaluateSizeForZoom(M.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(M.sourceID)};if(A)for(const nt of M.sortKeyRanges){const{sortKey:$e,symbolInstanceStart:wt,symbolInstanceEnd:dt}=nt;o.push({sortKey:$e,symbolInstanceStart:wt,symbolInstanceEnd:dt,parameters:Xe})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:M.symbolInstances.length,parameters:Xe})}attemptAnchorPlacement(o,g,I,A,M,F,Z,J,ee,re,ue,xe,Fe,we,Oe){const Je=[xe.textOffset0,xe.textOffset1],Xe=H(o,I,A,Je,M),nt=this.collisionIndex.placeCollisionBox(W(g,Xe.x,Xe.y,F,Z,this.transform.angle),ue,J,ee,re.predicate);if((!Oe||this.collisionIndex.placeCollisionBox(W(Oe,Xe.x,Xe.y,F,Z,this.transform.angle),ue,J,ee,re.predicate).box.length!==0)&&nt.box.length>0){let $e;return this.prevPlacement&&this.prevPlacement.variableOffsets[xe.crossTileID]&&this.prevPlacement.placements[xe.crossTileID]&&this.prevPlacement.placements[xe.crossTileID].text&&($e=this.prevPlacement.variableOffsets[xe.crossTileID].anchor),this.variableOffsets[xe.crossTileID]={textOffset:Je,width:I,height:A,anchor:o,textBoxScale:M,prevAnchor:$e},this.markUsedJustification(Fe,o,xe,we),Fe.allowVerticalPlacement&&(this.markUsedOrientation(Fe,we,xe),this.placedOrientations[xe.crossTileID]=we),{shift:Xe,placedGlyphBoxes:nt}}}placeLayerBucketPart(o,g,I){const{bucket:A,layout:M,posMatrix:F,textLabelPlaneMatrix:Z,labelToScreenMatrix:J,textPixelRatio:ee,holdingForFade:re,collisionBoxArray:ue,partiallyEvaluatedTextSize:xe,collisionGroup:Fe}=o.parameters,we=M.get("text-optional"),Oe=M.get("icon-optional"),Je=p.getOverlapMode(M,"text-overlap","text-allow-overlap"),Xe=Je==="always",nt=p.getOverlapMode(M,"icon-overlap","icon-allow-overlap"),$e=nt==="always",wt=M.get("text-rotation-alignment")==="map",dt=M.get("text-pitch-alignment")==="map",yt=M.get("icon-text-fit")!=="none",Lt=M.get("symbol-z-order")==="viewport-y",Nt=Xe&&($e||!A.hasIconData()||Oe),St=$e&&(Xe||!A.hasTextData()||we);!A.collisionArrays&&ue&&A.deserializeCollisionBoxes(ue);const mi=(ni,qi)=>{if(g[ni.crossTileID])return;if(re)return void(this.placements[ni.crossTileID]=new ye(!1,!1,!1));let c=!1,m=!1,d=!0,x=null,k={box:null,offscreen:null},D={box:null,offscreen:null},B=null,q=null,Y=null,ie=0,he=0,de=0;qi.textFeatureIndex?ie=qi.textFeatureIndex:ni.useRuntimeCollisionCircles&&(ie=ni.featureIndex),qi.verticalTextFeatureIndex&&(he=qi.verticalTextFeatureIndex);const me=qi.textBox;if(me){const Be=Pe=>{let Ve=p.WritingMode.horizontal;if(A.allowVerticalPlacement&&!Pe&&this.prevPlacement){const Ye=this.prevPlacement.placedOrientations[ni.crossTileID];Ye&&(this.placedOrientations[ni.crossTileID]=Ye,Ve=Ye,this.markUsedOrientation(A,Ve,ni))}return Ve},be=(Pe,Ve)=>{if(A.allowVerticalPlacement&&ni.numVerticalGlyphVertices>0&&qi.verticalTextBox){for(const Ye of A.writingModes)if(Ye===p.WritingMode.vertical?(k=Ve(),D=k):k=Pe(),k&&k.box&&k.box.length)break}else k=Pe()};if(M.get("text-variable-anchor")){let Pe=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ni.crossTileID]){const ot=this.prevPlacement.variableOffsets[ni.crossTileID];Pe.indexOf(ot.anchor)>0&&(Pe=Pe.filter(lt=>lt!==ot.anchor),Pe.unshift(ot.anchor))}const Ve=(ot,lt,ct)=>{const It=ot.x2-ot.x1,Ot=ot.y2-ot.y1,Rt=ni.textBoxScale,ii=yt&&nt==="never"?lt:null;let gi={box:[],offscreen:!1};const Ii=Je!=="never"?2*Pe.length:Pe.length;for(let yi=0;yi<Ii;++yi){const lr=this.attemptAnchorPlacement(Pe[yi%Pe.length],ot,It,Ot,Rt,wt,dt,ee,F,Fe,yi>=Pe.length?Je:"never",ni,A,ct,ii);if(lr&&(gi=lr.placedGlyphBoxes,gi&&gi.box&&gi.box.length)){c=!0,x=lr.shift;break}}return gi};be(()=>Ve(me,qi.iconBox,p.WritingMode.horizontal),()=>{const ot=qi.verticalTextBox;return A.allowVerticalPlacement&&!(k&&k.box&&k.box.length)&&ni.numVerticalGlyphVertices>0&&ot?Ve(ot,qi.verticalIconBox,p.WritingMode.vertical):{box:null,offscreen:null}}),k&&(c=k.box,d=k.offscreen);const Ye=Be(k&&k.box);if(!c&&this.prevPlacement){const ot=this.prevPlacement.variableOffsets[ni.crossTileID];ot&&(this.variableOffsets[ni.crossTileID]=ot,this.markUsedJustification(A,ot.anchor,ni,Ye))}}else{const Pe=(Ve,Ye)=>{const ot=this.collisionIndex.placeCollisionBox(Ve,Je,ee,F,Fe.predicate);return ot&&ot.box&&ot.box.length&&(this.markUsedOrientation(A,Ye,ni),this.placedOrientations[ni.crossTileID]=Ye),ot};be(()=>Pe(me,p.WritingMode.horizontal),()=>{const Ve=qi.verticalTextBox;return A.allowVerticalPlacement&&ni.numVerticalGlyphVertices>0&&Ve?Pe(Ve,p.WritingMode.vertical):{box:null,offscreen:null}}),Be(k&&k.box&&k.box.length)}}if(B=k,c=B&&B.box&&B.box.length>0,d=B&&B.offscreen,ni.useRuntimeCollisionCircles){const Be=A.text.placedSymbolArray.get(ni.centerJustifiedTextSymbolIndex),be=p.evaluateSizeForFeature(A.textSizeData,xe,Be),Pe=M.get("text-padding");q=this.collisionIndex.placeCollisionCircles(Je,Be,A.lineVertexArray,A.glyphOffsetArray,be,F,Z,J,I,dt,Fe.predicate,ni.collisionCircleDiameter,Pe),c=Xe||q.circles.length>0&&!q.collisionDetected,d=d&&q.offscreen}if(qi.iconFeatureIndex&&(de=qi.iconFeatureIndex),qi.iconBox){const Be=be=>{const Pe=yt&&x?W(be,x.x,x.y,wt,dt,this.transform.angle):be;return this.collisionIndex.placeCollisionBox(Pe,nt,ee,F,Fe.predicate)};D&&D.box&&D.box.length&&qi.verticalIconBox?(Y=Be(qi.verticalIconBox),m=Y.box.length>0):(Y=Be(qi.iconBox),m=Y.box.length>0),d=d&&Y.offscreen}const ze=we||ni.numHorizontalGlyphVertices===0&&ni.numVerticalGlyphVertices===0,Ce=Oe||ni.numIconVertices===0;if(ze||Ce?Ce?ze||(m=m&&c):c=m&&c:m=c=m&&c,c&&B&&B.box&&this.collisionIndex.insertCollisionBox(B.box,Je,M.get("text-ignore-placement"),A.bucketInstanceId,D&&D.box&&he?he:ie,Fe.ID),m&&Y&&this.collisionIndex.insertCollisionBox(Y.box,nt,M.get("icon-ignore-placement"),A.bucketInstanceId,de,Fe.ID),q&&(c&&this.collisionIndex.insertCollisionCircles(q.circles,Je,M.get("text-ignore-placement"),A.bucketInstanceId,ie,Fe.ID),I)){const Be=A.bucketInstanceId;let be=this.collisionCircleArrays[Be];be===void 0&&(be=this.collisionCircleArrays[Be]=new Me);for(let Pe=0;Pe<q.circles.length;Pe+=4)be.circles.push(q.circles[Pe+0]),be.circles.push(q.circles[Pe+1]),be.circles.push(q.circles[Pe+2]),be.circles.push(q.collisionDetected?1:0)}this.placements[ni.crossTileID]=new ye(c||Nt,m||St,d||A.justReloaded),g[ni.crossTileID]=!0};if(Lt){const ni=A.getSortedSymbolIndexes(this.transform.angle);for(let qi=ni.length-1;qi>=0;--qi){const c=ni[qi];mi(A.symbolInstances.get(c),A.collisionArrays[c])}}else for(let ni=o.symbolInstanceStart;ni<o.symbolInstanceEnd;ni++)mi(A.symbolInstances.get(ni),A.collisionArrays[ni]);if(I&&A.bucketInstanceId in this.collisionCircleArrays){const ni=this.collisionCircleArrays[A.bucketInstanceId];p.invert(ni.invProjMatrix,F),ni.viewportMatrix=this.collisionIndex.getViewportMatrix()}A.justReloaded=!1}markUsedJustification(o,g,I,A){let M;M=A===p.WritingMode.vertical?I.verticalPlacedTextSymbolIndex:{left:I.leftJustifiedTextSymbolIndex,center:I.centerJustifiedTextSymbolIndex,right:I.rightJustifiedTextSymbolIndex}[p.getAnchorJustification(g)];const F=[I.leftJustifiedTextSymbolIndex,I.centerJustifiedTextSymbolIndex,I.rightJustifiedTextSymbolIndex,I.verticalPlacedTextSymbolIndex];for(const Z of F)Z>=0&&(o.text.placedSymbolArray.get(Z).crossTileID=M>=0&&Z!==M?0:I.crossTileID)}markUsedOrientation(o,g,I){const A=g===p.WritingMode.horizontal||g===p.WritingMode.horizontalOnly?g:0,M=g===p.WritingMode.vertical?g:0,F=[I.leftJustifiedTextSymbolIndex,I.centerJustifiedTextSymbolIndex,I.rightJustifiedTextSymbolIndex];for(const Z of F)o.text.placedSymbolArray.get(Z).placedOrientation=A;I.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(I.verticalPlacedTextSymbolIndex).placedOrientation=M)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const g=this.prevPlacement;let I=!1;this.prevZoomAdjustment=g?g.zoomAdjustment(this.transform.zoom):0;const A=g?g.symbolFadeChange(o):1,M=g?g.opacities:{},F=g?g.variableOffsets:{},Z=g?g.placedOrientations:{};for(const J in this.placements){const ee=this.placements[J],re=M[J];re?(this.opacities[J]=new Ge(re,A,ee.text,ee.icon),I=I||ee.text!==re.text.placed||ee.icon!==re.icon.placed):(this.opacities[J]=new Ge(null,A,ee.text,ee.icon,ee.skipFade),I=I||ee.text||ee.icon)}for(const J in M){const ee=M[J];if(!this.opacities[J]){const re=new Ge(ee,A,!1,!1);re.isHidden()||(this.opacities[J]=re,I=I||ee.text.placed||ee.icon.placed)}}for(const J in F)this.variableOffsets[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.variableOffsets[J]=F[J]);for(const J in Z)this.placedOrientations[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.placedOrientations[J]=Z[J]);I?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=g?g.lastPlacementChangeTime:o)}updateLayerOpacities(o,g){const I={};for(const A of g){const M=A.getBucket(o);M&&A.latestFeatureIndex&&o.id===M.layerIds[0]&&this.updateBucketOpacities(M,I,A.collisionBoxArray)}}updateBucketOpacities(o,g,I){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const A=o.layers[0].layout,M=new Ge(null,0,!1,!1,!0),F=A.get("text-allow-overlap"),Z=A.get("icon-allow-overlap"),J=A.get("text-variable-anchor"),ee=A.get("text-rotation-alignment")==="map",re=A.get("text-pitch-alignment")==="map",ue=A.get("icon-text-fit")!=="none",xe=new Ge(null,0,F&&(Z||!o.hasIconData()||A.get("icon-optional")),Z&&(F||!o.hasTextData()||A.get("text-optional")),!0);!o.collisionArrays&&I&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(I);const Fe=(we,Oe,Je)=>{for(let Xe=0;Xe<Oe/4;Xe++)we.opacityVertexArray.emplaceBack(Je)};for(let we=0;we<o.symbolInstances.length;we++){const Oe=o.symbolInstances.get(we),{numHorizontalGlyphVertices:Je,numVerticalGlyphVertices:Xe,crossTileID:nt}=Oe;let $e=this.opacities[nt];g[nt]?$e=M:$e||($e=xe,this.opacities[nt]=$e),g[nt]=!0;const wt=Oe.numIconVertices>0,dt=this.placedOrientations[Oe.crossTileID],yt=dt===p.WritingMode.vertical,Lt=dt===p.WritingMode.horizontal||dt===p.WritingMode.horizontalOnly;if(Je>0||Xe>0){const Nt=tt($e.text);Fe(o.text,Je,yt?jt:Nt),Fe(o.text,Xe,Lt?jt:Nt);const St=$e.text.isHidden();[Oe.rightJustifiedTextSymbolIndex,Oe.centerJustifiedTextSymbolIndex,Oe.leftJustifiedTextSymbolIndex].forEach(qi=>{qi>=0&&(o.text.placedSymbolArray.get(qi).hidden=St||yt?1:0)}),Oe.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(Oe.verticalPlacedTextSymbolIndex).hidden=St||Lt?1:0);const mi=this.variableOffsets[Oe.crossTileID];mi&&this.markUsedJustification(o,mi.anchor,Oe,dt);const ni=this.placedOrientations[Oe.crossTileID];ni&&(this.markUsedJustification(o,"left",Oe,ni),this.markUsedOrientation(o,ni,Oe))}if(wt){const Nt=tt($e.icon),St=!(ue&&Oe.verticalPlacedIconSymbolIndex&&yt);Oe.placedIconSymbolIndex>=0&&(Fe(o.icon,Oe.numIconVertices,St?Nt:jt),o.icon.placedSymbolArray.get(Oe.placedIconSymbolIndex).hidden=$e.icon.isHidden()),Oe.verticalPlacedIconSymbolIndex>=0&&(Fe(o.icon,Oe.numVerticalIconVertices,St?jt:Nt),o.icon.placedSymbolArray.get(Oe.verticalPlacedIconSymbolIndex).hidden=$e.icon.isHidden())}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Nt=o.collisionArrays[we];if(Nt){let St=new p.pointGeometry(0,0);if(Nt.textBox||Nt.verticalTextBox){let ni=!0;if(J){const qi=this.variableOffsets[nt];qi?(St=H(qi.anchor,qi.width,qi.height,qi.textOffset,qi.textBoxScale),ee&&St._rotate(re?this.transform.angle:-this.transform.angle)):ni=!1}Nt.textBox&&ce(o.textCollisionBox.collisionVertexArray,$e.text.placed,!ni||yt,St.x,St.y),Nt.verticalTextBox&&ce(o.textCollisionBox.collisionVertexArray,$e.text.placed,!ni||Lt,St.x,St.y)}const mi=Boolean(!Lt&&Nt.verticalIconBox);Nt.iconBox&&ce(o.iconCollisionBox.collisionVertexArray,$e.icon.placed,mi,ue?St.x:0,ue?St.y:0),Nt.verticalIconBox&&ce(o.iconCollisionBox.collisionVertexArray,$e.icon.placed,!mi,ue?St.x:0,ue?St.y:0)}}}if(o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const we=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=we.invProjMatrix,o.placementViewportMatrix=we.viewportMatrix,o.collisionCircleArray=we.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,g){const I=this.zoomAtLastRecencyCheck===g?1-this.zoomAdjustment(g):1;return this.zoomAtLastRecencyCheck=g,this.commitTime+this.fadeDuration*I>o}setStale(){this.stale=!0}}function ce(T,o,g,I,A){T.emplaceBack(o?1:0,g?1:0,I||0,A||0),T.emplaceBack(o?1:0,g?1:0,I||0,A||0),T.emplaceBack(o?1:0,g?1:0,I||0,A||0),T.emplaceBack(o?1:0,g?1:0,I||0,A||0)}const ve=Math.pow(2,25),fe=Math.pow(2,24),Ie=Math.pow(2,17),Ee=Math.pow(2,16),Te=Math.pow(2,9),et=Math.pow(2,8),Ke=Math.pow(2,1);function tt(T){if(T.opacity===0&&!T.placed)return 0;if(T.opacity===1&&T.placed)return 4294967295;const o=T.placed?1:0,g=Math.floor(127*T.opacity);return g*ve+o*fe+g*Ie+o*Ee+g*Te+o*et+g*Ke+o}const jt=0;class Ct{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,g,I,A,M){const F=this._bucketParts;for(;this._currentTileIndex<o.length;)if(g.getBucketParts(F,A,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,M())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,F.sort((Z,J)=>Z.sortKey-J.sortKey));this._currentPartIndex<F.length;)if(g.placeLayerBucketPart(F[this._currentPartIndex],this._seenCrossTileIDs,I),this._currentPartIndex++,M())return!0;return!1}}class Ut{constructor(o,g,I,A,M,F,Z){this.placement=new ne(o,M,F,Z),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=I,this._showCollisionBoxes=A,this._done=!1}isDone(){return this._done}continuePlacement(o,g,I){const A=p.exported.now(),M=()=>{const F=p.exported.now()-A;return!this._forceFullPlacement&&F>2};for(;this._currentPlacementIndex>=0;){const F=g[o[this._currentPlacementIndex]],Z=this.placement.collisionIndex.transform.zoom;if(F.type==="symbol"&&(!F.minzoom||F.minzoom<=Z)&&(!F.maxzoom||F.maxzoom>Z)){if(this._inProgressLayer||(this._inProgressLayer=new Ct(F)),this._inProgressLayer.continuePlacement(I[F.source],this.placement,this._showCollisionBoxes,F,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Zt=512/p.EXTENT/2;class Xi{constructor(o,g,I){this.tileID=o,this.indexedSymbolInstances={},this.bucketInstanceId=I;for(let A=0;A<g.length;A++){const M=g.get(A),F=M.key;this.indexedSymbolInstances[F]||(this.indexedSymbolInstances[F]=[]),this.indexedSymbolInstances[F].push({crossTileID:M.crossTileID,coord:this.getScaledCoordinates(M,o)})}}getScaledCoordinates(o,g){const I=Zt/Math.pow(2,g.canonical.z-this.tileID.canonical.z);return{x:Math.floor((g.canonical.x*p.EXTENT+o.anchorX)*I),y:Math.floor((g.canonical.y*p.EXTENT+o.anchorY)*I)}}findMatches(o,g,I){const A=this.tileID.canonical.z<g.canonical.z?1:Math.pow(2,this.tileID.canonical.z-g.canonical.z);for(let M=0;M<o.length;M++){const F=o.get(M);if(F.crossTileID)continue;const Z=this.indexedSymbolInstances[F.key];if(!Z)continue;const J=this.getScaledCoordinates(F,g);for(const ee of Z)if(Math.abs(ee.coord.x-J.x)<=A&&Math.abs(ee.coord.y-J.y)<=A&&!I[ee.crossTileID]){I[ee.crossTileID]=!0,F.crossTileID=ee.crossTileID;break}}}}class vi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Pi{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const g=Math.round((o-this.lng)/360);if(g!==0)for(const I in this.indexes){const A=this.indexes[I],M={};for(const F in A){const Z=A[F];Z.tileID=Z.tileID.unwrapTo(Z.tileID.wrap+g),M[Z.tileID.key]=Z}this.indexes[I]=M}this.lng=o}addBucket(o,g,I){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===g.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let M=0;M<g.symbolInstances.length;M++)g.symbolInstances.get(M).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const A=this.usedCrossTileIDs[o.overscaledZ];for(const M in this.indexes){const F=this.indexes[M];if(Number(M)>o.overscaledZ)for(const Z in F){const J=F[Z];J.tileID.isChildOf(o)&&J.findMatches(g.symbolInstances,o,A)}else{const Z=F[o.scaledTo(Number(M)).key];Z&&Z.findMatches(g.symbolInstances,o,A)}}for(let M=0;M<g.symbolInstances.length;M++){const F=g.symbolInstances.get(M);F.crossTileID||(F.crossTileID=I.generate(),A[F.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Xi(o,g.symbolInstances,g.bucketInstanceId),!0}removeBucketCrossTileIDs(o,g){for(const I in g.indexedSymbolInstances)for(const A of g.indexedSymbolInstances[I])delete this.usedCrossTileIDs[o][A.crossTileID]}removeStaleBuckets(o){let g=!1;for(const I in this.indexes){const A=this.indexes[I];for(const M in A)o[A[M].bucketInstanceId]||(this.removeBucketCrossTileIDs(I,A[M]),delete A[M],g=!0)}return g}}class di{constructor(){this.layerIndexes={},this.crossTileIDs=new vi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,g,I){let A=this.layerIndexes[o.id];A===void 0&&(A=this.layerIndexes[o.id]=new Pi);let M=!1;const F={};A.handleWrapJump(I);for(const Z of g){const J=Z.getBucket(o);J&&o.id===J.layerIds[0]&&(J.bucketInstanceId||(J.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(Z.tileID,J,this.crossTileIDs)&&(M=!0),F[J.bucketInstanceId]=!0)}return A.removeStaleBuckets(F)&&(M=!0),M}pruneUnusedLayers(o){const g={};o.forEach(I=>{g[I]=!0});for(const I in this.layerIndexes)g[I]||delete this.layerIndexes[I]}}const ei=(T,o)=>p.emitValidationErrors(T,o&&o.filter(g=>g.identifier!=="source.canvas")),Ui=p.pick(Wi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ir=p.pick(Wi,["setCenter","setZoom","setBearing","setPitch"]),kn=function(){const T={},o=p.spec.$version;for(const g in p.spec.$root){const I=p.spec.$root[g];if(I.required){let A=null;A=g==="version"?o:I.type==="array"?[]:{},A!=null&&(T[g]=A)}}return T}();class Cr extends p.Evented{constructor(o,g={}){super(),this.map=o,this.dispatcher=new Qt(xn(),this),this.imageManager=new ut,this.imageManager.setEventedParent(this),this.glyphManager=new xt(o._requestManager,g.localIdeographFontFamily),this.lineAtlas=new Ht(256,512),this.crossTileSymbolIndex=new di,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new p.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",p.getReferrer());const I=this;this._rtlTextPluginCallback=Cr.registerForPluginStateChange(A=>{I.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:A.pluginStatus,pluginURL:A.pluginURL},(M,F)=>{if(p.triggerPluginCompletionEvent(M),F&&F.every(Z=>Z))for(const Z in I.sourceCaches)I.sourceCaches[Z].reload()})}),this.on("data",A=>{if(A.dataType!=="source"||A.sourceDataType!=="metadata")return;const M=this.sourceCaches[A.sourceId];if(!M)return;const F=M.getSource();if(F&&F.vectorLayerIds)for(const Z in this._layers){const J=this._layers[Z];J.source===F.id&&this._validateLayer(J)}})}loadURL(o,g={}){this.fire(new p.Event("dataloading",{dataType:"style"}));const I=typeof g.validate!="boolean"||g.validate,A=this.map._requestManager.transformRequest(o,p.ResourceType.Style);this._request=p.getJSON(A,(M,F)=>{this._request=null,M?this.fire(new p.ErrorEvent(M)):F&&this._load(F,I)})}loadJSON(o,g={}){this.fire(new p.Event("dataloading",{dataType:"style"})),this._request=p.exported.frame(()=>{this._request=null,this._load(o,g.validate!==!1)})}loadEmpty(){this.fire(new p.Event("dataloading",{dataType:"style"})),this._load(kn,!1)}_load(o,g){if(g&&ei(this,p.validateStyle(o)))return;this._loaded=!0,this.stylesheet=o;for(const A in o.sources)this.addSource(A,o.sources[A],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);const I=Yn(this.stylesheet.layers);this._order=I.map(A=>A.id),this._layers={},this._serializedLayers={};for(let A of I)A=p.createStyleLayer(A),A.setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=A,this._serializedLayers[A.id]=A.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ri(this.stylesheet.light),this.fire(new p.Event("data",{dataType:"style"})),this.fire(new p.Event("style.load"))}_loadSprite(o){this._spriteRequest=function(g,I,A,M){let F,Z,J;const ee=A>1?"@2x":"";let re=p.getJSON(I.transformRequest(I.normalizeSpriteURL(g,ee,".json"),p.ResourceType.SpriteJSON),(Fe,we)=>{re=null,J||(J=Fe,F=we,xe())}),ue=p.getImage(I.transformRequest(I.normalizeSpriteURL(g,ee,".png"),p.ResourceType.SpriteImage),(Fe,we)=>{ue=null,J||(J=Fe,Z=we,xe())});function xe(){if(J)M(J);else if(F&&Z){const Fe=p.exported.getImageData(Z),we={};for(const Oe in F){const{width:Je,height:Xe,x:nt,y:$e,sdf:wt,pixelRatio:dt,stretchX:yt,stretchY:Lt,content:Nt}=F[Oe],St=new p.RGBAImage({width:Je,height:Xe});p.RGBAImage.copy(Fe,St,{x:nt,y:$e},{x:0,y:0},{width:Je,height:Xe}),we[Oe]={data:St,pixelRatio:dt,sdf:wt,stretchX:yt,stretchY:Lt,content:Nt}}M(null,we)}}return{cancel(){re&&(re.cancel(),re=null),ue&&(ue.cancel(),ue=null)}}}(o,this.map._requestManager,this.map.getPixelRatio(),(g,I)=>{if(this._spriteRequest=null,g)this.fire(new p.ErrorEvent(g));else if(I)for(const A in I)this.imageManager.addImage(A,I[A]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new p.Event("data",{dataType:"style"}))})}_validateLayer(o){const g=this.sourceCaches[o.source];if(!g)return;const I=o.sourceLayer;if(!I)return;const A=g.getSource();(A.type==="geojson"||A.vectorLayerIds&&A.vectorLayerIds.indexOf(I)===-1)&&this.fire(new p.ErrorEvent(new Error(`Source layer "${I}" does not exist on source "${A.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const g=[];for(const I of o){const A=this._layers[I];A.type!=="custom"&&g.push(A.serialize())}return g}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const g=this._changed;if(this._changed){const A=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);(A.length||M.length)&&this._updateWorkerLayers(A,M);for(const F in this._updatedSources){const Z=this._updatedSources[F];Z==="reload"?this._reloadSource(F):Z==="clear"&&this._clearSource(F)}this._updateTilesForChangedImages();for(const F in this._updatedPaintProps)this._layers[F].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}const I={};for(const A in this.sourceCaches){const M=this.sourceCaches[A];I[A]=M.used,M.used=!1}for(const A of this._order){const M=this._layers[A];M.recalculate(o,this._availableImages),!M.isHidden(o.zoom)&&M.source&&(this.sourceCaches[M.source].used=!0)}for(const A in I){const M=this.sourceCaches[A];I[A]!==M.used&&M.fire(new p.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:A}))}this.light.recalculate(o),this.z=o.zoom,g&&this.fire(new p.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const g in this.sourceCaches)this.sourceCaches[g].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,g){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:g})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),ei(this,p.validateStyle(o)))return!1;(o=p.clone$1(o)).layers=Yn(o.layers);const g=function(A,M){if(!A)return[{command:Wi.setStyle,args:[M]}];let F=[];try{if(!G(A.version,M.version))return[{command:Wi.setStyle,args:[M]}];G(A.center,M.center)||F.push({command:Wi.setCenter,args:[M.center]}),G(A.zoom,M.zoom)||F.push({command:Wi.setZoom,args:[M.zoom]}),G(A.bearing,M.bearing)||F.push({command:Wi.setBearing,args:[M.bearing]}),G(A.pitch,M.pitch)||F.push({command:Wi.setPitch,args:[M.pitch]}),G(A.sprite,M.sprite)||F.push({command:Wi.setSprite,args:[M.sprite]}),G(A.glyphs,M.glyphs)||F.push({command:Wi.setGlyphs,args:[M.glyphs]}),G(A.transition,M.transition)||F.push({command:Wi.setTransition,args:[M.transition]}),G(A.light,M.light)||F.push({command:Wi.setLight,args:[M.light]});const Z={},J=[];(function(re,ue,xe,Fe){let we;for(we in ue=ue||{},re=re||{})Object.prototype.hasOwnProperty.call(re,we)&&(Object.prototype.hasOwnProperty.call(ue,we)||Ao(we,xe,Fe));for(we in ue)Object.prototype.hasOwnProperty.call(ue,we)&&(Object.prototype.hasOwnProperty.call(re,we)?G(re[we],ue[we])||(re[we].type==="geojson"&&ue[we].type==="geojson"&&Ua(re,ue,we)?xe.push({command:Wi.setGeoJSONSourceData,args:[we,ue[we].data]}):$n(we,ue,xe,Fe)):Nn(we,ue,xe))})(A.sources,M.sources,J,Z);const ee=[];A.layers&&A.layers.forEach(re=>{Z[re.source]?F.push({command:Wi.removeLayer,args:[re.id]}):ee.push(re)}),F=F.concat(J),function(re,ue,xe){ue=ue||[];const Fe=(re=re||[]).map(_t),we=ue.map(_t),Oe=re.reduce(Ci,{}),Je=ue.reduce(Ci,{}),Xe=Fe.slice(),nt=Object.create(null);let $e,wt,dt,yt,Lt,Nt,St;for($e=0,wt=0;$e<Fe.length;$e++)dt=Fe[$e],Object.prototype.hasOwnProperty.call(Je,dt)?wt++:(xe.push({command:Wi.removeLayer,args:[dt]}),Xe.splice(Xe.indexOf(dt,wt),1));for($e=0,wt=0;$e<we.length;$e++)dt=we[we.length-1-$e],Xe[Xe.length-1-$e]!==dt&&(Object.prototype.hasOwnProperty.call(Oe,dt)?(xe.push({command:Wi.removeLayer,args:[dt]}),Xe.splice(Xe.lastIndexOf(dt,Xe.length-wt),1)):wt++,Nt=Xe[Xe.length-$e],xe.push({command:Wi.addLayer,args:[Je[dt],Nt]}),Xe.splice(Xe.length-$e,0,dt),nt[dt]=!0);for($e=0;$e<we.length;$e++)if(dt=we[$e],yt=Oe[dt],Lt=Je[dt],!nt[dt]&&!G(yt,Lt))if(G(yt.source,Lt.source)&&G(yt["source-layer"],Lt["source-layer"])&&G(yt.type,Lt.type)){for(St in qe(yt.layout,Lt.layout,xe,dt,null,Wi.setLayoutProperty),qe(yt.paint,Lt.paint,xe,dt,null,Wi.setPaintProperty),G(yt.filter,Lt.filter)||xe.push({command:Wi.setFilter,args:[dt,Lt.filter]}),G(yt.minzoom,Lt.minzoom)&&G(yt.maxzoom,Lt.maxzoom)||xe.push({command:Wi.setLayerZoomRange,args:[dt,Lt.minzoom,Lt.maxzoom]}),yt)Object.prototype.hasOwnProperty.call(yt,St)&&St!=="layout"&&St!=="paint"&&St!=="filter"&&St!=="metadata"&&St!=="minzoom"&&St!=="maxzoom"&&(St.indexOf("paint.")===0?qe(yt[St],Lt[St],xe,dt,St.slice(6),Wi.setPaintProperty):G(yt[St],Lt[St])||xe.push({command:Wi.setLayerProperty,args:[dt,St,Lt[St]]}));for(St in Lt)Object.prototype.hasOwnProperty.call(Lt,St)&&!Object.prototype.hasOwnProperty.call(yt,St)&&St!=="layout"&&St!=="paint"&&St!=="filter"&&St!=="metadata"&&St!=="minzoom"&&St!=="maxzoom"&&(St.indexOf("paint.")===0?qe(yt[St],Lt[St],xe,dt,St.slice(6),Wi.setPaintProperty):G(yt[St],Lt[St])||xe.push({command:Wi.setLayerProperty,args:[dt,St,Lt[St]]}))}else xe.push({command:Wi.removeLayer,args:[dt]}),Nt=Xe[Xe.lastIndexOf(dt)+1],xe.push({command:Wi.addLayer,args:[Lt,Nt]})}(ee,M.layers,F)}catch(Z){console.warn("Unable to compute style diff:",Z),F=[{command:Wi.setStyle,args:[M]}]}return F}(this.serialize(),o).filter(A=>!(A.command in Ir));if(g.length===0)return!1;const I=g.filter(A=>!(A.command in Ui));if(I.length>0)throw new Error(`Unimplemented: ${I.map(A=>A.command).join(", ")}.`);return g.forEach(A=>{A.command!=="setTransition"&&this[A.command].apply(this,A.args)}),this.stylesheet=o,!0}addImage(o,g){if(this.getImage(o))return this.fire(new p.ErrorEvent(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,g),this._afterImageUpdated(o)}updateImage(o,g){this.imageManager.updateImage(o,g)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new p.ErrorEvent(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new p.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,g,I={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!g.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(g).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(g.type)>=0&&this._validate(p.validateStyle.source,`sources.${o}`,g,null,I))return;this.map&&this.map._collectResourceTiming&&(g.collectResourceTiming=!0);const A=this.sourceCaches[o]=new rt(o,g,this.dispatcher);A.style=this,A.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:A.serialize(),sourceId:o})),A.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const I in this._layers)if(this._layers[I].source===o)return this.fire(new p.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${I}" is using it.`)));const g=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],g.fire(new p.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),g.setEventedParent(null),g.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,g){this._checkLoaded(),this.sourceCaches[o].getSource().setData(g),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,g,I={}){this._checkLoaded();const A=o.id;if(this.getLayer(A))return void this.fire(new p.ErrorEvent(new Error(`Layer "${A}" already exists on this map.`)));let M;if(o.type==="custom"){if(ei(this,p.validateCustomStyleLayer(o)))return;M=p.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(A,o.source),o=p.clone$1(o),o=p.extend(o,{source:A})),this._validate(p.validateStyle.layer,`layers.${A}`,o,{arrayIndex:-1},I))return;M=p.createStyleLayer(o),this._validateLayer(M),M.setEventedParent(this,{layer:{id:A}}),this._serializedLayers[M.id]=M.serialize()}const F=g?this._order.indexOf(g):this._order.length;if(g&&F===-1)this.fire(new p.ErrorEvent(new Error(`Cannot add layer "${A}" before non-existing layer "${g}".`)));else{if(this._order.splice(F,0,A),this._layerOrderChanged=!0,this._layers[A]=M,this._removedLayers[A]&&M.source&&M.type!=="custom"){const Z=this._removedLayers[A];delete this._removedLayers[A],Z.type!==M.type?this._updatedSources[M.source]="clear":(this._updatedSources[M.source]="reload",this.sourceCaches[M.source].pause())}this._updateLayer(M),M.onAdd&&M.onAdd(this.map)}}moveLayer(o,g){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new p.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===g)return;const I=this._order.indexOf(o);this._order.splice(I,1);const A=g?this._order.indexOf(g):this._order.length;g&&A===-1?this.fire(new p.ErrorEvent(new Error(`Cannot move layer "${o}" before non-existing layer "${g}".`))):(this._order.splice(A,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const g=this._layers[o];if(!g)return void this.fire(new p.ErrorEvent(new Error(`Cannot remove non-existing layer "${o}".`)));g.setEventedParent(null);const I=this._order.indexOf(o);this._order.splice(I,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=g,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],g.onRemove&&g.onRemove(this.map)}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,g,I){this._checkLoaded();const A=this.getLayer(o);A?A.minzoom===g&&A.maxzoom===I||(g!=null&&(A.minzoom=g),I!=null&&(A.maxzoom=I),this._updateLayer(A)):this.fire(new p.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,g,I={}){this._checkLoaded();const A=this.getLayer(o);if(A){if(!G(A.filter,g))return g==null?(A.filter=void 0,void this._updateLayer(A)):void(this._validate(p.validateStyle.filter,`layers.${A.id}.filter`,g,null,I)||(A.filter=p.clone$1(g),this._updateLayer(A)))}else this.fire(new p.ErrorEvent(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return p.clone$1(this.getLayer(o).filter)}setLayoutProperty(o,g,I,A={}){this._checkLoaded();const M=this.getLayer(o);M?G(M.getLayoutProperty(g),I)||(M.setLayoutProperty(g,I,A),this._updateLayer(M)):this.fire(new p.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,g){const I=this.getLayer(o);if(I)return I.getLayoutProperty(g);this.fire(new p.ErrorEvent(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,g,I,A={}){this._checkLoaded();const M=this.getLayer(o);M?G(M.getPaintProperty(g),I)||(M.setPaintProperty(g,I,A)&&this._updateLayer(M),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new p.ErrorEvent(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,g){return this.getLayer(o).getPaintProperty(g)}setFeatureState(o,g){this._checkLoaded();const I=o.source,A=o.sourceLayer,M=this.sourceCaches[I];if(M===void 0)return void this.fire(new p.ErrorEvent(new Error(`The source '${I}' does not exist in the map's style.`)));const F=M.getSource().type;F==="geojson"&&A?this.fire(new p.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):F!=="vector"||A?(o.id===void 0&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided."))),M.setFeatureState(A,o.id,g)):this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,g){this._checkLoaded();const I=o.source,A=this.sourceCaches[I];if(A===void 0)return void this.fire(new p.ErrorEvent(new Error(`The source '${I}' does not exist in the map's style.`)));const M=A.getSource().type,F=M==="vector"?o.sourceLayer:void 0;M!=="vector"||F?g&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new p.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):A.removeFeatureState(F,o.id,g):this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const g=o.source,I=o.sourceLayer,A=this.sourceCaches[g];if(A!==void 0)return A.getSource().type!=="vector"||I?(o.id===void 0&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided."))),A.getFeatureState(I,o.id)):void this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new p.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)))}getTransition(){return p.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return p.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:p.mapObject(this.sourceCaches,o=>o.serialize()),layers:this._serializeLayers(this._order)},o=>o!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(o){const g=F=>this._layers[F].type==="fill-extrusion",I={},A=[];for(let F=this._order.length-1;F>=0;F--){const Z=this._order[F];if(g(Z)){I[Z]=F;for(const J of o){const ee=J[Z];if(ee)for(const re of ee)A.push(re)}}}A.sort((F,Z)=>Z.intersectionZ-F.intersectionZ);const M=[];for(let F=this._order.length-1;F>=0;F--){const Z=this._order[F];if(g(Z))for(let J=A.length-1;J>=0;J--){const ee=A[J].feature;if(I[ee.layer.id]<F)break;M.push(ee),A.pop()}else for(const J of o){const ee=J[Z];if(ee)for(const re of ee)M.push(re.feature)}}return M}queryRenderedFeatures(o,g,I){g&&g.filter&&this._validate(p.validateStyle.filter,"queryRenderedFeatures.filter",g.filter,null,g);const A={};if(g&&g.layers){if(!Array.isArray(g.layers))return this.fire(new p.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const F of g.layers){const Z=this._layers[F];if(!Z)return this.fire(new p.ErrorEvent(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];A[Z.source]=!0}}const M=[];g.availableImages=this._availableImages;for(const F in this.sourceCaches)g.layers&&!A[F]||M.push(or(this.sourceCaches[F],this._layers,this._serializedLayers,o,g,I));return this.placement&&M.push(function(F,Z,J,ee,re,ue,xe){const Fe={},we=ue.queryRenderedSymbols(ee),Oe=[];for(const Je of Object.keys(we).map(Number))Oe.push(xe[Je]);Oe.sort(Li);for(const Je of Oe){const Xe=Je.featureIndex.lookupSymbolFeatures(we[Je.bucketInstanceId],Z,Je.bucketIndex,Je.sourceLayerIndex,re.filter,re.layers,re.availableImages,F);for(const nt in Xe){const $e=Fe[nt]=Fe[nt]||[],wt=Xe[nt];wt.sort((dt,yt)=>{const Lt=Je.featureSortOrder;if(Lt){const Nt=Lt.indexOf(dt.featureIndex);return Lt.indexOf(yt.featureIndex)-Nt}return yt.featureIndex-dt.featureIndex});for(const dt of wt)$e.push(dt)}}for(const Je in Fe)Fe[Je].forEach(Xe=>{const nt=Xe.feature,$e=J[F[Je].source].getFeatureState(nt.layer["source-layer"],nt.id);nt.source=nt.layer.source,nt.layer["source-layer"]&&(nt.sourceLayer=nt.layer["source-layer"]),nt.state=$e});return Fe}(this._layers,this._serializedLayers,this.sourceCaches,o,g,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(M)}querySourceFeatures(o,g){g&&g.filter&&this._validate(p.validateStyle.filter,"querySourceFeatures.filter",g.filter,null,g);const I=this.sourceCaches[o];return I?function(A,M){const F=A.getRenderableIds().map(ee=>A.getTileByID(ee)),Z=[],J={};for(let ee=0;ee<F.length;ee++){const re=F[ee],ue=re.tileID.canonical.key;J[ue]||(J[ue]=!0,re.querySourceFeatures(Z,M))}return Z}(I,g):[]}addSourceType(o,g,I){return Cr.getSourceType(o)?I(new Error(`A source type called "${o}" already exists.`)):(Cr.setSourceType(o,g),g.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:g.workerSourceURL},I):I(null,null))}getLight(){return this.light.getLight()}setLight(o,g={}){this._checkLoaded();const I=this.light.getLight();let A=!1;for(const F in o)if(!G(o[F],I[F])){A=!0;break}if(!A)return;const M={now:p.exported.now(),transition:p.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,g),this.light.updateTransitions(M)}_validate(o,g,I,A,M={}){return(!M||M.validate!==!1)&&ei(this,o.call(p.validateStyle,p.extend({key:g,style:this.serialize(),value:I,styleSpec:p.spec},A)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),p.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const g=this.sourceCaches[o];g.setEventedParent(null),g.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const g in this.sourceCaches)this.sourceCaches[g].update(o)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,g,I,A,M=!1){let F=!1,Z=!1;const J={};for(const ee of this._order){const re=this._layers[ee];if(re.type!=="symbol")continue;if(!J[re.source]){const xe=this.sourceCaches[re.source];J[re.source]=xe.getRenderableIds(!0).map(Fe=>xe.getTileByID(Fe)).sort((Fe,we)=>we.tileID.overscaledZ-Fe.tileID.overscaledZ||(Fe.tileID.isLessThan(we.tileID)?-1:1))}const ue=this.crossTileSymbolIndex.addLayer(re,J[re.source],o.center.lng);F=F||ue}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((M=M||this._layerOrderChanged||I===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(p.exported.now(),o.zoom))&&(this.pauseablePlacement=new Ut(o,this._order,M,g,I,A,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,J),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(p.exported.now()),Z=!0),F&&this.pauseablePlacement.placement.setStale()),Z||F)for(const ee of this._order){const re=this._layers[ee];re.type==="symbol"&&this.placement.updateLayerOpacities(re,J[re.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(p.exported.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,g,I){this.imageManager.getImages(g.icons,I),this._updateTilesForChangedImages();const A=this.sourceCaches[g.source];A&&A.setDependencies(g.tileID.key,g.type,g.icons)}getGlyphs(o,g,I){this.glyphManager.getGlyphs(g.stacks,I)}getResource(o,g,I){return p.makeRequest(g,I)}}Cr.getSourceType=function(T){return Ni[T]},Cr.setSourceType=function(T,o){Ni[T]=o},Cr.registerForPluginStateChange=p.registerForPluginStateChange;var Eo=p.createLayout([{name:"a_pos",type:"Int16",components:2}]),Fl={prelude:Gr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),background:Gr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Gr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Gr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Gr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Gr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Gr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Gr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Gr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Gr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),fill:Gr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Gr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Gr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Gr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Gr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Gr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Gr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Gr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Gr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),lineGradient:Gr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),linePattern:Gr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Gr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Gr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Gr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),symbolSDF:Gr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Gr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`)};function Gr(T,o){const g=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,I=o.match(/attribute ([\w]+) ([\w]+)/g),A=T.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),F=M?M.concat(A):A,Z={};return{fragmentSource:T=T.replace(g,(J,ee,re,ue,xe)=>(Z[xe]=!0,ee==="define"?`
#ifndef HAS_UNIFORM_u_${xe}
varying ${re} ${ue} ${xe};
#else
uniform ${re} ${ue} u_${xe};
#endif
`:`
#ifdef HAS_UNIFORM_u_${xe}
    ${re} ${ue} ${xe} = u_${xe};
#endif
`)),vertexSource:o=o.replace(g,(J,ee,re,ue,xe)=>{const Fe=ue==="float"?"vec2":"vec4",we=xe.match(/color/)?"color":Fe;return Z[xe]?ee==="define"?`
#ifndef HAS_UNIFORM_u_${xe}
uniform lowp float u_${xe}_t;
attribute ${re} ${Fe} a_${xe};
varying ${re} ${ue} ${xe};
#else
uniform ${re} ${ue} u_${xe};
#endif
`:we==="vec4"?`
#ifndef HAS_UNIFORM_u_${xe}
    ${xe} = a_${xe};
#else
    ${re} ${ue} ${xe} = u_${xe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${xe}
    ${xe} = unpack_mix_${we}(a_${xe}, u_${xe}_t);
#else
    ${re} ${ue} ${xe} = u_${xe};
#endif
`:ee==="define"?`
#ifndef HAS_UNIFORM_u_${xe}
uniform lowp float u_${xe}_t;
attribute ${re} ${Fe} a_${xe};
#else
uniform ${re} ${ue} u_${xe};
#endif
`:we==="vec4"?`
#ifndef HAS_UNIFORM_u_${xe}
    ${re} ${ue} ${xe} = a_${xe};
#else
    ${re} ${ue} ${xe} = u_${xe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${xe}
    ${re} ${ue} ${xe} = unpack_mix_${we}(a_${xe}, u_${xe}_t);
#else
    ${re} ${ue} ${xe} = u_${xe};
#endif
`}),staticAttributes:I,staticUniforms:F}}class Sn{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,g,I,A,M,F,Z,J){this.context=o;let ee=this.boundPaintVertexBuffers.length!==A.length;for(let re=0;!ee&&re<A.length;re++)this.boundPaintVertexBuffers[re]!==A[re]&&(ee=!0);o.extVertexArrayObject&&this.vao&&this.boundProgram===g&&this.boundLayoutVertexBuffer===I&&!ee&&this.boundIndexBuffer===M&&this.boundVertexOffset===F&&this.boundDynamicVertexBuffer===Z&&this.boundDynamicVertexBuffer2===J?(o.bindVertexArrayOES.set(this.vao),Z&&Z.bind(),M&&M.dynamicDraw&&M.bind(),J&&J.bind()):this.freshBind(g,I,A,M,F,Z,J)}freshBind(o,g,I,A,M,F,Z){let J;const ee=o.numAttributes,re=this.context,ue=re.gl;if(re.extVertexArrayObject)this.vao&&this.destroy(),this.vao=re.extVertexArrayObject.createVertexArrayOES(),re.bindVertexArrayOES.set(this.vao),J=0,this.boundProgram=o,this.boundLayoutVertexBuffer=g,this.boundPaintVertexBuffers=I,this.boundIndexBuffer=A,this.boundVertexOffset=M,this.boundDynamicVertexBuffer=F,this.boundDynamicVertexBuffer2=Z;else{J=re.currentNumAttributes||0;for(let xe=ee;xe<J;xe++)ue.disableVertexAttribArray(xe)}g.enableAttributes(ue,o);for(const xe of I)xe.enableAttributes(ue,o);F&&F.enableAttributes(ue,o),Z&&Z.enableAttributes(ue,o),g.bind(),g.setVertexAttribPointers(ue,o,M);for(const xe of I)xe.bind(),xe.setVertexAttribPointers(ue,o,M);F&&(F.bind(),F.setVertexAttribPointers(ue,o,M)),A&&A.bind(),Z&&(Z.bind(),Z.setVertexAttribPointers(ue,o,M)),re.currentNumAttributes=ee}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Gs(T){const o=[];for(let g=0;g<T.length;g++){if(T[g]===null)continue;const I=T[g].split(" ");o.push(I.pop())}return o}class Co{constructor(o,g,I,A,M,F){const Z=o.gl;this.program=Z.createProgram();const J=Gs(I.staticAttributes),ee=A?A.getBinderAttributes():[],re=J.concat(ee),ue=I.staticUniforms?Gs(I.staticUniforms):[],xe=A?A.getBinderUniforms():[],Fe=ue.concat(xe),we=[];for(const dt of Fe)we.indexOf(dt)<0&&we.push(dt);const Oe=A?A.defines():[];F&&Oe.push("#define OVERDRAW_INSPECTOR;");const Je=Oe.concat(Fl.prelude.fragmentSource,I.fragmentSource).join(`
`),Xe=Oe.concat(Fl.prelude.vertexSource,I.vertexSource).join(`
`),nt=Z.createShader(Z.FRAGMENT_SHADER);if(Z.isContextLost())return void(this.failedToCreate=!0);Z.shaderSource(nt,Je),Z.compileShader(nt),Z.attachShader(this.program,nt);const $e=Z.createShader(Z.VERTEX_SHADER);if(Z.isContextLost())return void(this.failedToCreate=!0);Z.shaderSource($e,Xe),Z.compileShader($e),Z.attachShader(this.program,$e),this.attributes={};const wt={};this.numAttributes=re.length;for(let dt=0;dt<this.numAttributes;dt++)re[dt]&&(Z.bindAttribLocation(this.program,dt,re[dt]),this.attributes[re[dt]]=dt);Z.linkProgram(this.program),Z.deleteShader($e),Z.deleteShader(nt);for(let dt=0;dt<we.length;dt++){const yt=we[dt];if(yt&&!wt[yt]){const Lt=Z.getUniformLocation(this.program,yt);Lt&&(wt[yt]=Lt)}}this.fixedUniforms=M(o,wt),this.binderUniforms=A?A.getUniforms(o,wt):[]}draw(o,g,I,A,M,F,Z,J,ee,re,ue,xe,Fe,we,Oe,Je){const Xe=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(I),o.setStencilMode(A),o.setColorMode(M),o.setCullFace(F);for(const $e in this.fixedUniforms)this.fixedUniforms[$e].set(Z[$e]);we&&we.setUniforms(o,this.binderUniforms,xe,{zoom:Fe});const nt={[Xe.LINES]:2,[Xe.TRIANGLES]:3,[Xe.LINE_STRIP]:1}[g];for(const $e of ue.get()){const wt=$e.vaos||($e.vaos={});(wt[J]||(wt[J]=new Sn)).bind(o,this,ee,we?we.getPaintVertexBuffers():[],re,$e.vertexOffset,Oe,Je),Xe.drawElements(g,$e.primitiveLength*nt,Xe.UNSIGNED_SHORT,$e.primitiveOffset*nt*2)}}}function Bn(T,o,g){const I=1/Ae(g,1,o.transform.tileZoom),A=Math.pow(2,g.tileID.overscaledZ),M=g.tileSize*Math.pow(2,o.transform.tileZoom)/A,F=M*(g.tileID.canonical.x+g.tileID.wrap*A),Z=M*g.tileID.canonical.y;return{u_image:0,u_texsize:g.imageAtlasTexture.size,u_scale:[I,T.fromScale,T.toScale],u_fade:T.t,u_pixel_coord_upper:[F>>16,Z>>16],u_pixel_coord_lower:[65535&F,65535&Z]}}const la=(T,o,g,I)=>{const A=o.style.light,M=A.properties.get("position"),F=[M.x,M.y,M.z],Z=function(){var ee=new p.ARRAY_TYPE(9);return p.ARRAY_TYPE!=Float32Array&&(ee[1]=0,ee[2]=0,ee[3]=0,ee[5]=0,ee[6]=0,ee[7]=0),ee[0]=1,ee[4]=1,ee[8]=1,ee}();A.properties.get("anchor")==="viewport"&&function(ee,re){var ue=Math.sin(re),xe=Math.cos(re);ee[0]=xe,ee[1]=ue,ee[2]=0,ee[3]=-ue,ee[4]=xe,ee[5]=0,ee[6]=0,ee[7]=0,ee[8]=1}(Z,-o.transform.angle),function(ee,re,ue){var xe=re[0],Fe=re[1],we=re[2];ee[0]=xe*ue[0]+Fe*ue[3]+we*ue[6],ee[1]=xe*ue[1]+Fe*ue[4]+we*ue[7],ee[2]=xe*ue[2]+Fe*ue[5]+we*ue[8]}(F,F,Z);const J=A.properties.get("color");return{u_matrix:T,u_lightpos:F,u_lightintensity:A.properties.get("intensity"),u_lightcolor:[J.r,J.g,J.b],u_vertical_gradient:+g,u_opacity:I}},Qr=(T,o,g,I,A,M,F)=>p.extend(la(T,o,g,I),Bn(M,o,F),{u_height_factor:-Math.pow(2,A.overscaledZ)/F.tileSize/8}),ua=T=>({u_matrix:T}),No=(T,o,g,I)=>p.extend(ua(T),Bn(g,o,I)),ec=(T,o)=>({u_matrix:T,u_world:o}),ca=(T,o,g,I,A)=>p.extend(No(T,o,g,I),{u_world:A}),Zs=(T,o,g,I)=>{const A=T.transform;let M,F;if(I.paint.get("circle-pitch-alignment")==="map"){const Z=Ae(g,1,A.zoom);M=!0,F=[Z,Z]}else M=!1,F=A.pixelsToGLUnits;return{u_camera_to_center_distance:A.cameraToCenterDistance,u_scale_with_map:+(I.paint.get("circle-pitch-scale")==="map"),u_matrix:T.translatePosMatrix(o.posMatrix,g,I.paint.get("circle-translate"),I.paint.get("circle-translate-anchor")),u_pitch_with_map:+M,u_device_pixel_ratio:T.pixelRatio,u_extrude_scale:F}},va=(T,o,g)=>{const I=Ae(g,1,o.zoom),A=Math.pow(2,o.zoom-g.tileID.overscaledZ),M=g.tileID.overscaleFactor();return{u_matrix:T,u_camera_to_center_distance:o.cameraToCenterDistance,u_pixels_to_tile_units:I,u_extrude_scale:[o.pixelsToGLUnits[0]/(I*A),o.pixelsToGLUnits[1]/(I*A)],u_overscale_factor:M}},In=(T,o,g=1)=>({u_matrix:T,u_color:o,u_overlay:0,u_overlay_scale:g}),Zo=T=>({u_matrix:T}),io=(T,o,g,I)=>({u_matrix:T,u_extrude_scale:Ae(o,1,g),u_intensity:I});function Na(T,o){const g=Math.pow(2,o.canonical.z),I=o.canonical.y;return[new p.MercatorCoordinate(0,I/g).toLngLat().lat,new p.MercatorCoordinate(0,(I+1)/g).toLngLat().lat]}const Ul=(T,o,g)=>{const I=T.transform;return{u_matrix:tc(T,o,g),u_ratio:1/Ae(o,1,I.zoom),u_device_pixel_ratio:T.pixelRatio,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]]}},wu=(T,o,g,I)=>p.extend(Ul(T,o,g),{u_image:0,u_image_height:I}),Hs=(T,o,g,I)=>{const A=T.transform,M=ml(o,A);return{u_matrix:tc(T,o,g),u_texsize:o.imageAtlasTexture.size,u_ratio:1/Ae(o,1,A.zoom),u_device_pixel_ratio:T.pixelRatio,u_image:0,u_scale:[M,I.fromScale,I.toScale],u_fade:I.t,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]]}},jn=(T,o,g,I,A)=>{const M=T.lineAtlas,F=ml(o,T.transform),Z=g.layout.get("line-cap")==="round",J=M.getDash(I.from,Z),ee=M.getDash(I.to,Z),re=J.width*A.fromScale,ue=ee.width*A.toScale;return p.extend(Ul(T,o,g),{u_patternscale_a:[F/re,-J.height/2],u_patternscale_b:[F/ue,-ee.height/2],u_sdfgamma:M.width/(256*Math.min(re,ue)*T.pixelRatio)/2,u_image:0,u_tex_y_a:J.y,u_tex_y_b:ee.y,u_mix:A.t})};function ml(T,o){return 1/Ae(T,1,o.tileZoom)}function tc(T,o,g){return T.translatePosMatrix(o.tileID.posMatrix,o,g.paint.get("line-translate"),g.paint.get("line-translate-anchor"))}const ic=(T,o,g,I,A)=>{return{u_matrix:T,u_tl_parent:o,u_scale_parent:g,u_buffer_scale:1,u_fade_t:I.mix,u_opacity:I.opacity*A.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:A.paint.get("raster-brightness-min"),u_brightness_high:A.paint.get("raster-brightness-max"),u_saturation_factor:(F=A.paint.get("raster-saturation"),F>0?1-1/(1.001-F):-F),u_contrast_factor:(M=A.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:rc(A.paint.get("raster-hue-rotate"))};var M,F};function rc(T){T*=Math.PI/180;const o=Math.sin(T),g=Math.cos(T);return[(2*g+1)/3,(-Math.sqrt(3)*o-g+1)/3,(Math.sqrt(3)*o-g+1)/3]}const rs=(T,o,g,I,A,M,F,Z,J,ee)=>{const re=A.transform;return{u_is_size_zoom_constant:+(T==="constant"||T==="source"),u_is_size_feature_constant:+(T==="constant"||T==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:re.cameraToCenterDistance,u_pitch:re.pitch/360*2*Math.PI,u_rotate_symbol:+g,u_aspect_ratio:re.width/re.height,u_fade_change:A.options.fadeDuration?A.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:F,u_coord_matrix:Z,u_is_text:+J,u_pitch_with_map:+I,u_texsize:ee,u_texture:0}},Nl=(T,o,g,I,A,M,F,Z,J,ee,re)=>{const ue=A.transform;return p.extend(rs(T,o,g,I,A,M,F,Z,J,ee),{u_gamma_scale:I?Math.cos(ue._pitch)*ue.cameraToCenterDistance:1,u_device_pixel_ratio:A.pixelRatio,u_is_halo:+re})},jl=(T,o,g,I,A,M,F,Z,J,ee)=>p.extend(Nl(T,o,g,I,A,M,F,Z,!0,J,!0),{u_texsize_icon:ee,u_texture_icon:1}),Oc=(T,o,g)=>({u_matrix:T,u_opacity:o,u_color:g}),yl=(T,o,g,I,A,M)=>p.extend(function(F,Z,J,ee){const re=J.imageManager.getPattern(F.from.toString()),ue=J.imageManager.getPattern(F.to.toString()),{width:xe,height:Fe}=J.imageManager.getPixelSize(),we=Math.pow(2,ee.tileID.overscaledZ),Oe=ee.tileSize*Math.pow(2,J.transform.tileZoom)/we,Je=Oe*(ee.tileID.canonical.x+ee.tileID.wrap*we),Xe=Oe*ee.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:re.tl,u_pattern_br_a:re.br,u_pattern_tl_b:ue.tl,u_pattern_br_b:ue.br,u_texsize:[xe,Fe],u_mix:Z.t,u_pattern_size_a:re.displaySize,u_pattern_size_b:ue.displaySize,u_scale_a:Z.fromScale,u_scale_b:Z.toScale,u_tile_units_to_pixels:1/Ae(ee,1,J.transform.tileZoom),u_pixel_coord_upper:[Je>>16,Xe>>16],u_pixel_coord_lower:[65535&Je,65535&Xe]}}(I,M,g,A),{u_matrix:T,u_opacity:o}),Ho={fillExtrusion:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_lightpos:new p.Uniform3f(T,o.u_lightpos),u_lightintensity:new p.Uniform1f(T,o.u_lightintensity),u_lightcolor:new p.Uniform3f(T,o.u_lightcolor),u_vertical_gradient:new p.Uniform1f(T,o.u_vertical_gradient),u_opacity:new p.Uniform1f(T,o.u_opacity)}),fillExtrusionPattern:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_lightpos:new p.Uniform3f(T,o.u_lightpos),u_lightintensity:new p.Uniform1f(T,o.u_lightintensity),u_lightcolor:new p.Uniform3f(T,o.u_lightcolor),u_vertical_gradient:new p.Uniform1f(T,o.u_vertical_gradient),u_height_factor:new p.Uniform1f(T,o.u_height_factor),u_image:new p.Uniform1i(T,o.u_image),u_texsize:new p.Uniform2f(T,o.u_texsize),u_pixel_coord_upper:new p.Uniform2f(T,o.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(T,o.u_pixel_coord_lower),u_scale:new p.Uniform3f(T,o.u_scale),u_fade:new p.Uniform1f(T,o.u_fade),u_opacity:new p.Uniform1f(T,o.u_opacity)}),fill:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix)}),fillPattern:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_image:new p.Uniform1i(T,o.u_image),u_texsize:new p.Uniform2f(T,o.u_texsize),u_pixel_coord_upper:new p.Uniform2f(T,o.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(T,o.u_pixel_coord_lower),u_scale:new p.Uniform3f(T,o.u_scale),u_fade:new p.Uniform1f(T,o.u_fade)}),fillOutline:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_world:new p.Uniform2f(T,o.u_world)}),fillOutlinePattern:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_world:new p.Uniform2f(T,o.u_world),u_image:new p.Uniform1i(T,o.u_image),u_texsize:new p.Uniform2f(T,o.u_texsize),u_pixel_coord_upper:new p.Uniform2f(T,o.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(T,o.u_pixel_coord_lower),u_scale:new p.Uniform3f(T,o.u_scale),u_fade:new p.Uniform1f(T,o.u_fade)}),circle:(T,o)=>({u_camera_to_center_distance:new p.Uniform1f(T,o.u_camera_to_center_distance),u_scale_with_map:new p.Uniform1i(T,o.u_scale_with_map),u_pitch_with_map:new p.Uniform1i(T,o.u_pitch_with_map),u_extrude_scale:new p.Uniform2f(T,o.u_extrude_scale),u_device_pixel_ratio:new p.Uniform1f(T,o.u_device_pixel_ratio),u_matrix:new p.UniformMatrix4f(T,o.u_matrix)}),collisionBox:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_camera_to_center_distance:new p.Uniform1f(T,o.u_camera_to_center_distance),u_pixels_to_tile_units:new p.Uniform1f(T,o.u_pixels_to_tile_units),u_extrude_scale:new p.Uniform2f(T,o.u_extrude_scale),u_overscale_factor:new p.Uniform1f(T,o.u_overscale_factor)}),collisionCircle:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_inv_matrix:new p.UniformMatrix4f(T,o.u_inv_matrix),u_camera_to_center_distance:new p.Uniform1f(T,o.u_camera_to_center_distance),u_viewport_size:new p.Uniform2f(T,o.u_viewport_size)}),debug:(T,o)=>({u_color:new p.UniformColor(T,o.u_color),u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_overlay:new p.Uniform1i(T,o.u_overlay),u_overlay_scale:new p.Uniform1f(T,o.u_overlay_scale)}),clippingMask:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix)}),heatmap:(T,o)=>({u_extrude_scale:new p.Uniform1f(T,o.u_extrude_scale),u_intensity:new p.Uniform1f(T,o.u_intensity),u_matrix:new p.UniformMatrix4f(T,o.u_matrix)}),heatmapTexture:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_world:new p.Uniform2f(T,o.u_world),u_image:new p.Uniform1i(T,o.u_image),u_color_ramp:new p.Uniform1i(T,o.u_color_ramp),u_opacity:new p.Uniform1f(T,o.u_opacity)}),hillshade:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_image:new p.Uniform1i(T,o.u_image),u_latrange:new p.Uniform2f(T,o.u_latrange),u_light:new p.Uniform2f(T,o.u_light),u_shadow:new p.UniformColor(T,o.u_shadow),u_highlight:new p.UniformColor(T,o.u_highlight),u_accent:new p.UniformColor(T,o.u_accent)}),hillshadePrepare:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_image:new p.Uniform1i(T,o.u_image),u_dimension:new p.Uniform2f(T,o.u_dimension),u_zoom:new p.Uniform1f(T,o.u_zoom),u_unpack:new p.Uniform4f(T,o.u_unpack)}),line:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_ratio:new p.Uniform1f(T,o.u_ratio),u_device_pixel_ratio:new p.Uniform1f(T,o.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(T,o.u_units_to_pixels)}),lineGradient:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_ratio:new p.Uniform1f(T,o.u_ratio),u_device_pixel_ratio:new p.Uniform1f(T,o.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(T,o.u_units_to_pixels),u_image:new p.Uniform1i(T,o.u_image),u_image_height:new p.Uniform1f(T,o.u_image_height)}),linePattern:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_texsize:new p.Uniform2f(T,o.u_texsize),u_ratio:new p.Uniform1f(T,o.u_ratio),u_device_pixel_ratio:new p.Uniform1f(T,o.u_device_pixel_ratio),u_image:new p.Uniform1i(T,o.u_image),u_units_to_pixels:new p.Uniform2f(T,o.u_units_to_pixels),u_scale:new p.Uniform3f(T,o.u_scale),u_fade:new p.Uniform1f(T,o.u_fade)}),lineSDF:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_ratio:new p.Uniform1f(T,o.u_ratio),u_device_pixel_ratio:new p.Uniform1f(T,o.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(T,o.u_units_to_pixels),u_patternscale_a:new p.Uniform2f(T,o.u_patternscale_a),u_patternscale_b:new p.Uniform2f(T,o.u_patternscale_b),u_sdfgamma:new p.Uniform1f(T,o.u_sdfgamma),u_image:new p.Uniform1i(T,o.u_image),u_tex_y_a:new p.Uniform1f(T,o.u_tex_y_a),u_tex_y_b:new p.Uniform1f(T,o.u_tex_y_b),u_mix:new p.Uniform1f(T,o.u_mix)}),raster:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_tl_parent:new p.Uniform2f(T,o.u_tl_parent),u_scale_parent:new p.Uniform1f(T,o.u_scale_parent),u_buffer_scale:new p.Uniform1f(T,o.u_buffer_scale),u_fade_t:new p.Uniform1f(T,o.u_fade_t),u_opacity:new p.Uniform1f(T,o.u_opacity),u_image0:new p.Uniform1i(T,o.u_image0),u_image1:new p.Uniform1i(T,o.u_image1),u_brightness_low:new p.Uniform1f(T,o.u_brightness_low),u_brightness_high:new p.Uniform1f(T,o.u_brightness_high),u_saturation_factor:new p.Uniform1f(T,o.u_saturation_factor),u_contrast_factor:new p.Uniform1f(T,o.u_contrast_factor),u_spin_weights:new p.Uniform3f(T,o.u_spin_weights)}),symbolIcon:(T,o)=>({u_is_size_zoom_constant:new p.Uniform1i(T,o.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(T,o.u_is_size_feature_constant),u_size_t:new p.Uniform1f(T,o.u_size_t),u_size:new p.Uniform1f(T,o.u_size),u_camera_to_center_distance:new p.Uniform1f(T,o.u_camera_to_center_distance),u_pitch:new p.Uniform1f(T,o.u_pitch),u_rotate_symbol:new p.Uniform1i(T,o.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(T,o.u_aspect_ratio),u_fade_change:new p.Uniform1f(T,o.u_fade_change),u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(T,o.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(T,o.u_coord_matrix),u_is_text:new p.Uniform1i(T,o.u_is_text),u_pitch_with_map:new p.Uniform1i(T,o.u_pitch_with_map),u_texsize:new p.Uniform2f(T,o.u_texsize),u_texture:new p.Uniform1i(T,o.u_texture)}),symbolSDF:(T,o)=>({u_is_size_zoom_constant:new p.Uniform1i(T,o.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(T,o.u_is_size_feature_constant),u_size_t:new p.Uniform1f(T,o.u_size_t),u_size:new p.Uniform1f(T,o.u_size),u_camera_to_center_distance:new p.Uniform1f(T,o.u_camera_to_center_distance),u_pitch:new p.Uniform1f(T,o.u_pitch),u_rotate_symbol:new p.Uniform1i(T,o.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(T,o.u_aspect_ratio),u_fade_change:new p.Uniform1f(T,o.u_fade_change),u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(T,o.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(T,o.u_coord_matrix),u_is_text:new p.Uniform1i(T,o.u_is_text),u_pitch_with_map:new p.Uniform1i(T,o.u_pitch_with_map),u_texsize:new p.Uniform2f(T,o.u_texsize),u_texture:new p.Uniform1i(T,o.u_texture),u_gamma_scale:new p.Uniform1f(T,o.u_gamma_scale),u_device_pixel_ratio:new p.Uniform1f(T,o.u_device_pixel_ratio),u_is_halo:new p.Uniform1i(T,o.u_is_halo)}),symbolTextAndIcon:(T,o)=>({u_is_size_zoom_constant:new p.Uniform1i(T,o.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(T,o.u_is_size_feature_constant),u_size_t:new p.Uniform1f(T,o.u_size_t),u_size:new p.Uniform1f(T,o.u_size),u_camera_to_center_distance:new p.Uniform1f(T,o.u_camera_to_center_distance),u_pitch:new p.Uniform1f(T,o.u_pitch),u_rotate_symbol:new p.Uniform1i(T,o.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(T,o.u_aspect_ratio),u_fade_change:new p.Uniform1f(T,o.u_fade_change),u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(T,o.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(T,o.u_coord_matrix),u_is_text:new p.Uniform1i(T,o.u_is_text),u_pitch_with_map:new p.Uniform1i(T,o.u_pitch_with_map),u_texsize:new p.Uniform2f(T,o.u_texsize),u_texsize_icon:new p.Uniform2f(T,o.u_texsize_icon),u_texture:new p.Uniform1i(T,o.u_texture),u_texture_icon:new p.Uniform1i(T,o.u_texture_icon),u_gamma_scale:new p.Uniform1f(T,o.u_gamma_scale),u_device_pixel_ratio:new p.Uniform1f(T,o.u_device_pixel_ratio),u_is_halo:new p.Uniform1i(T,o.u_is_halo)}),background:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_opacity:new p.Uniform1f(T,o.u_opacity),u_color:new p.UniformColor(T,o.u_color)}),backgroundPattern:(T,o)=>({u_matrix:new p.UniformMatrix4f(T,o.u_matrix),u_opacity:new p.Uniform1f(T,o.u_opacity),u_image:new p.Uniform1i(T,o.u_image),u_pattern_tl_a:new p.Uniform2f(T,o.u_pattern_tl_a),u_pattern_br_a:new p.Uniform2f(T,o.u_pattern_br_a),u_pattern_tl_b:new p.Uniform2f(T,o.u_pattern_tl_b),u_pattern_br_b:new p.Uniform2f(T,o.u_pattern_br_b),u_texsize:new p.Uniform2f(T,o.u_texsize),u_mix:new p.Uniform1f(T,o.u_mix),u_pattern_size_a:new p.Uniform2f(T,o.u_pattern_size_a),u_pattern_size_b:new p.Uniform2f(T,o.u_pattern_size_b),u_scale_a:new p.Uniform1f(T,o.u_scale_a),u_scale_b:new p.Uniform1f(T,o.u_scale_b),u_pixel_coord_upper:new p.Uniform2f(T,o.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(T,o.u_pixel_coord_lower),u_tile_units_to_pixels:new p.Uniform1f(T,o.u_tile_units_to_pixels)})};class ja{constructor(o,g,I){this.context=o;const A=o.gl;this.buffer=A.createBuffer(),this.dynamicDraw=Boolean(I),this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||delete g.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const g=this.context.gl;this.context.unbindVAO(),this.bind(),g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Va={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ss{constructor(o,g,I,A){this.length=g.length,this.attributes=I,this.itemSize=g.bytesPerElement,this.dynamicDraw=A,this.context=o;const M=o.gl;this.buffer=M.createBuffer(),o.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||delete g.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const g=this.context.gl;this.bind(),g.bufferSubData(g.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,g){for(let I=0;I<this.attributes.length;I++){const A=g.attributes[this.attributes[I].name];A!==void 0&&o.enableVertexAttribArray(A)}}setVertexAttribPointers(o,g,I){for(let A=0;A<this.attributes.length;A++){const M=this.attributes[A],F=g.attributes[M.name];F!==void 0&&o.vertexAttribPointer(F,M.components,o[Va[M.type]],!1,this.itemSize,M.offset+this.itemSize*(I||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class pr{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Is extends pr{getDefault(){return p.Color.transparent}set(o){const g=this.current;(o.r!==g.r||o.g!==g.g||o.b!==g.b||o.a!==g.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Ts extends pr{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class fo extends pr{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Tn extends pr{getDefault(){return[!0,!0,!0,!0]}set(o){const g=this.current;(o[0]!==g[0]||o[1]!==g[1]||o[2]!==g[2]||o[3]!==g[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class mo extends pr{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Eu extends pr{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Su extends pr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const g=this.current;(o.func!==g.func||o.ref!==g.ref||o.mask!==g.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Iu extends pr{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const g=this.current;(o[0]!==g[0]||o[1]!==g[1]||o[2]!==g[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Vl extends pr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const g=this.gl;o?g.enable(g.STENCIL_TEST):g.disable(g.STENCIL_TEST),this.current=o,this.dirty=!1}}class ql extends pr{getDefault(){return[0,1]}set(o){const g=this.current;(o[0]!==g[0]||o[1]!==g[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class gl extends pr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const g=this.gl;o?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),this.current=o,this.dirty=!1}}class Gl extends pr{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Tu extends pr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const g=this.gl;o?g.enable(g.BLEND):g.disable(g.BLEND),this.current=o,this.dirty=!1}}class Zl extends pr{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const g=this.current;(o[0]!==g[0]||o[1]!==g[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Fc extends pr{getDefault(){return p.Color.transparent}set(o){const g=this.current;(o.r!==g.r||o.g!==g.g||o.b!==g.b||o.a!==g.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class _l extends pr{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class qa extends pr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const g=this.gl;o?g.enable(g.CULL_FACE):g.disable(g.CULL_FACE),this.current=o,this.dirty=!1}}class Uc extends pr{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class yo extends pr{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class nc extends pr{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class As extends pr{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Cs extends pr{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const g=this.current;(o[0]!==g[0]||o[1]!==g[1]||o[2]!==g[2]||o[3]!==g[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ws extends pr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const g=this.gl;g.bindFramebuffer(g.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class ns extends pr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const g=this.gl;g.bindRenderbuffer(g.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Ga extends pr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const g=this.gl;g.bindTexture(g.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class xa extends pr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const g=this.gl;g.bindBuffer(g.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ks extends pr{getDefault(){return null}set(o){const g=this.gl;g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class os extends pr{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class Au extends pr{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class zs extends pr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Zr extends pr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const g=this.gl;g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Xs extends pr{constructor(o,g){super(o),this.context=o,this.parent=g}getDefault(){return null}}class as extends Xs{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class oc extends Xs{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const g=this.gl;g.framebufferRenderbuffer(g.FRAMEBUFFER,g.DEPTH_ATTACHMENT,g.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Cu{constructor(o,g,I,A){this.context=o,this.width=g,this.height=I;const M=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new as(o,M),A&&(this.depthAttachment=new oc(o,M))}destroy(){const o=this.context.gl,g=this.colorAttachment.get();if(g&&o.deleteTexture(g),this.depthAttachment){const I=this.depthAttachment.get();I&&o.deleteRenderbuffer(I)}o.deleteFramebuffer(this.framebuffer)}}class $i{constructor(o,g,I){this.blendFunction=o,this.blendColor=g,this.mask=I}}$i.Replace=[1,0],$i.disabled=new $i($i.Replace,p.Color.transparent,[!1,!1,!1,!1]),$i.unblended=new $i($i.Replace,p.Color.transparent,[!0,!0,!0,!0]),$i.alphaBlended=new $i([1,771],p.Color.transparent,[!0,!0,!0,!0]);class Hl{constructor(o){this.gl=o,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Is(this),this.clearDepth=new Ts(this),this.clearStencil=new fo(this),this.colorMask=new Tn(this),this.depthMask=new mo(this),this.stencilMask=new Eu(this),this.stencilFunc=new Su(this),this.stencilOp=new Iu(this),this.stencilTest=new Vl(this),this.depthRange=new ql(this),this.depthTest=new gl(this),this.depthFunc=new Gl(this),this.blend=new Tu(this),this.blendFunc=new Zl(this),this.blendColor=new Fc(this),this.blendEquation=new _l(this),this.cullFace=new qa(this),this.cullFaceSide=new Uc(this),this.frontFace=new yo(this),this.program=new nc(this),this.activeTexture=new As(this),this.viewport=new Cs(this),this.bindFramebuffer=new Ws(this),this.bindRenderbuffer=new ns(this),this.bindTexture=new Ga(this),this.bindVertexBuffer=new xa(this),this.bindElementBuffer=new ks(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new os(this),this.pixelStoreUnpack=new Au(this),this.pixelStoreUnpackPremultiplyAlpha=new zs(this),this.pixelStoreUnpackFlipY=new Zr(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=o.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(o.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,g){return new ja(this,o,g)}createVertexBuffer(o,g,I){return new Ss(this,o,g,I)}createRenderbuffer(o,g,I){const A=this.gl,M=A.createRenderbuffer();return this.bindRenderbuffer.set(M),A.renderbufferStorage(A.RENDERBUFFER,o,g,I),this.bindRenderbuffer.set(null),M}createFramebuffer(o,g,I){return new Cu(this,o,g,I)}clear({color:o,depth:g}){const I=this.gl;let A=0;o&&(A|=I.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),g!==void 0&&(A|=I.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(g),this.depthMask.set(!0)),I.clear(A)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){G(o.blendFunction,$i.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Er{constructor(o,g,I){this.func=o,this.mask=g,this.range=I}}Er.ReadOnly=!1,Er.ReadWrite=!0,Er.disabled=new Er(519,Er.ReadOnly,[0,1]);const ka=7680;class Kr{constructor(o,g,I,A,M,F){this.test=o,this.ref=g,this.mask=I,this.fail=A,this.depthFail=M,this.pass=F}}Kr.disabled=new Kr({func:519,mask:0},0,0,ka,ka,ka);class An{constructor(o,g,I){this.enable=o,this.mode=g,this.frontFace=I}}let Wl;function Xl(T,o,g,I,A,M,F){const Z=T.context,J=Z.gl,ee=T.useProgram("collisionBox"),re=[];let ue=0,xe=0;for(let $e=0;$e<I.length;$e++){const wt=I[$e],dt=o.getTile(wt),yt=dt.getBucket(g);if(!yt)continue;let Lt=wt.posMatrix;A[0]===0&&A[1]===0||(Lt=T.translatePosMatrix(wt.posMatrix,dt,A,M));const Nt=F?yt.textCollisionBox:yt.iconCollisionBox,St=yt.collisionCircleArray;if(St.length>0){const mi=p.create(),ni=Lt;p.mul(mi,yt.placementInvProjMatrix,T.transform.glCoordMatrix),p.mul(mi,mi,yt.placementViewportMatrix),re.push({circleArray:St,circleOffset:xe,transform:ni,invTransform:mi}),ue+=St.length/4,xe=ue}Nt&&ee.draw(Z,J.LINES,Er.disabled,Kr.disabled,T.colorModeForRenderPass(),An.disabled,va(Lt,T.transform,dt),g.id,Nt.layoutVertexBuffer,Nt.indexBuffer,Nt.segments,null,T.transform.zoom,null,null,Nt.collisionVertexBuffer)}if(!F||!re.length)return;const Fe=T.useProgram("collisionCircle"),we=new p.CollisionCircleLayoutArray;we.resize(4*ue),we._trim();let Oe=0;for(const $e of re)for(let wt=0;wt<$e.circleArray.length/4;wt++){const dt=4*wt,yt=$e.circleArray[dt+0],Lt=$e.circleArray[dt+1],Nt=$e.circleArray[dt+2],St=$e.circleArray[dt+3];we.emplace(Oe++,yt,Lt,Nt,St,0),we.emplace(Oe++,yt,Lt,Nt,St,1),we.emplace(Oe++,yt,Lt,Nt,St,2),we.emplace(Oe++,yt,Lt,Nt,St,3)}(!Wl||Wl.length<2*ue)&&(Wl=function($e){const wt=2*$e,dt=new p.QuadTriangleArray;dt.resize(wt),dt._trim();for(let yt=0;yt<wt;yt++){const Lt=6*yt;dt.uint16[Lt+0]=4*yt+0,dt.uint16[Lt+1]=4*yt+1,dt.uint16[Lt+2]=4*yt+2,dt.uint16[Lt+3]=4*yt+2,dt.uint16[Lt+4]=4*yt+3,dt.uint16[Lt+5]=4*yt+0}return dt}(ue));const Je=Z.createIndexBuffer(Wl,!0),Xe=Z.createVertexBuffer(we,p.collisionCircleLayout.members,!0);for(const $e of re){const wt={u_matrix:$e.transform,u_inv_matrix:$e.invTransform,u_camera_to_center_distance:(nt=T.transform).cameraToCenterDistance,u_viewport_size:[nt.width,nt.height]};Fe.draw(Z,J.TRIANGLES,Er.disabled,Kr.disabled,T.colorModeForRenderPass(),An.disabled,wt,g.id,Xe,Je,p.SegmentVector.simpleSegment(0,2*$e.circleOffset,$e.circleArray.length,$e.circleArray.length/2),null,T.transform.zoom,null,null,null)}var nt;Xe.destroy(),Je.destroy()}An.disabled=new An(!1,1029,2305),An.backCCW=new An(!0,1029,2305);const Ks=p.identity(new Float32Array(16));function ku(T,o,g,I,A,M){const{horizontalAlign:F,verticalAlign:Z}=p.getAnchorAlignment(T),J=-(F-.5)*o,ee=-(Z-.5)*g,re=p.evaluateVariableOffset(T,I);return new p.pointGeometry((J/A+re[0])*M,(ee/A+re[1])*M)}function Za(T,o,g,I,A,M,F,Z,J,ee){const re=T.text.placedSymbolArray,ue=T.text.dynamicLayoutVertexArray,xe=T.icon.dynamicLayoutVertexArray,Fe={};ue.clear();for(let we=0;we<re.length;we++){const Oe=re.get(we),Je=T.allowVerticalPlacement&&!Oe.placedOrientation,Xe=Oe.hidden||!Oe.crossTileID||Je?null:I[Oe.crossTileID];if(Xe){const nt=new p.pointGeometry(Oe.anchorX,Oe.anchorY),$e=$r(nt,g?F:M),wt=Jt(A.cameraToCenterDistance,$e.signedDistanceFromCamera);let dt=p.evaluateSizeForFeature(T.textSizeData,J,Oe)*wt/p.ONE_EM;g&&(dt*=T.tilePixelRatio/Z);const{width:yt,height:Lt,anchor:Nt,textOffset:St,textBoxScale:mi}=Xe,ni=ku(Nt,yt,Lt,St,mi,dt),qi=g?$r(nt.add(ni),M).point:$e.point.add(o?ni.rotate(-A.angle):ni),c=T.allowVerticalPlacement&&Oe.placedOrientation===p.WritingMode.vertical?Math.PI/2:0;for(let m=0;m<Oe.numGlyphs;m++)p.addDynamicAttributes(ue,qi,c);ee&&Oe.associatedIconIndex>=0&&(Fe[Oe.associatedIconIndex]={shiftedAnchor:qi,angle:c})}else te(Oe.numGlyphs,ue)}if(ee){xe.clear();const we=T.icon.placedSymbolArray;for(let Oe=0;Oe<we.length;Oe++){const Je=we.get(Oe);if(Je.hidden)te(Je.numGlyphs,xe);else{const Xe=Fe[Oe];if(Xe)for(let nt=0;nt<Je.numGlyphs;nt++)p.addDynamicAttributes(xe,Xe.shiftedAnchor,Xe.angle);else te(Je.numGlyphs,xe)}}T.icon.dynamicLayoutVertexBuffer.updateData(xe)}T.text.dynamicLayoutVertexBuffer.updateData(ue)}function Ha(T,o,g){return g.iconsInText&&o?"symbolTextAndIcon":T?"symbolSDF":"symbolIcon"}function Kl(T,o,g,I,A,M,F,Z,J,ee,re,ue){const xe=T.context,Fe=xe.gl,we=T.transform,Oe=Z==="map",Je=J==="map",Xe=Z!=="viewport"&&g.layout.get("symbol-placement")!=="point",nt=Oe&&!Je&&!Xe,$e=!g.layout.get("symbol-sort-key").isConstant();let wt=!1;const dt=T.depthModeForSublayer(0,Er.ReadOnly),yt=g.layout.get("text-variable-anchor"),Lt=[];for(const Nt of I){const St=o.getTile(Nt),mi=St.getBucket(g);if(!mi)continue;const ni=A?mi.text:mi.icon;if(!ni||!ni.segments.get().length)continue;const qi=ni.programConfigurations.get(g.id),c=A||mi.sdfIcons,m=A?mi.textSizeData:mi.iconSizeData,d=Je||we.pitch!==0,x=T.useProgram(Ha(c,A,mi),qi),k=p.evaluateSizeForZoom(m,we.zoom);let D,B,q,Y,ie=[0,0],he=null;if(A){if(B=St.glyphAtlasTexture,q=Fe.LINEAR,D=St.glyphAtlasTexture.size,mi.iconsInText){ie=St.imageAtlasTexture.size,he=St.imageAtlasTexture;const ct=m.kind==="composite"||m.kind==="camera";Y=d||T.options.rotating||T.options.zooming||ct?Fe.LINEAR:Fe.NEAREST}}else{const ct=g.layout.get("icon-size").constantOr(0)!==1||mi.iconsNeedLinear;B=St.imageAtlasTexture,q=c||T.options.rotating||T.options.zooming||ct||d?Fe.LINEAR:Fe.NEAREST,D=St.imageAtlasTexture.size}const de=Ae(St,1,T.transform.zoom),me=eo(Nt.posMatrix,Je,Oe,T.transform,de),ze=sa(Nt.posMatrix,Je,Oe,T.transform,de),Ce=yt&&mi.hasTextData(),Be=g.layout.get("icon-text-fit")!=="none"&&Ce&&mi.hasIconData();if(Xe){const ct=g.layout.get("text-rotation-alignment")==="map";Yi(mi,Nt.posMatrix,T,A,me,ze,Je,ee,ct)}const be=T.translatePosMatrix(Nt.posMatrix,St,M,F),Pe=Xe||A&&yt||Be?Ks:me,Ve=T.translatePosMatrix(ze,St,M,F,!0),Ye=c&&g.paint.get(A?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ot;ot=c?mi.iconsInText?jl(m.kind,k,nt,Je,T,be,Pe,Ve,D,ie):Nl(m.kind,k,nt,Je,T,be,Pe,Ve,A,D,!0):rs(m.kind,k,nt,Je,T,be,Pe,Ve,A,D);const lt={program:x,buffers:ni,uniformValues:ot,atlasTexture:B,atlasTextureIcon:he,atlasInterpolation:q,atlasInterpolationIcon:Y,isSDF:c,hasHalo:Ye};if($e&&mi.canOverlap){wt=!0;const ct=ni.segments.get();for(const It of ct)Lt.push({segments:new p.SegmentVector([It]),sortKey:It.sortKey,state:lt})}else Lt.push({segments:ni.segments,sortKey:0,state:lt})}wt&&Lt.sort((Nt,St)=>Nt.sortKey-St.sortKey);for(const Nt of Lt){const St=Nt.state;if(xe.activeTexture.set(Fe.TEXTURE0),St.atlasTexture.bind(St.atlasInterpolation,Fe.CLAMP_TO_EDGE),St.atlasTextureIcon&&(xe.activeTexture.set(Fe.TEXTURE1),St.atlasTextureIcon&&St.atlasTextureIcon.bind(St.atlasInterpolationIcon,Fe.CLAMP_TO_EDGE)),St.isSDF){const mi=St.uniformValues;St.hasHalo&&(mi.u_is_halo=1,Ps(St.buffers,Nt.segments,g,T,St.program,dt,re,ue,mi)),mi.u_is_halo=0}Ps(St.buffers,Nt.segments,g,T,St.program,dt,re,ue,St.uniformValues)}}function Ps(T,o,g,I,A,M,F,Z,J){const ee=I.context;A.draw(ee,ee.gl.TRIANGLES,M,F,Z,An.disabled,J,g.id,T.layoutVertexBuffer,T.indexBuffer,o,g.paint,I.transform.zoom,T.programConfigurations.get(g.id),T.dynamicLayoutVertexBuffer,T.opacityVertexBuffer)}function Jr(T,o,g,I,A,M,F){const Z=T.context.gl,J=g.paint.get("fill-pattern"),ee=J&&J.constantOr(1),re=g.getCrossfadeParameters();let ue,xe,Fe,we,Oe;F?(xe=ee&&!g.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ue=Z.LINES):(xe=ee?"fillPattern":"fill",ue=Z.TRIANGLES);for(const Je of I){const Xe=o.getTile(Je);if(ee&&!Xe.patternsLoaded())continue;const nt=Xe.getBucket(g);if(!nt)continue;const $e=nt.programConfigurations.get(g.id),wt=T.useProgram(xe,$e);ee&&(T.context.activeTexture.set(Z.TEXTURE0),Xe.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),$e.updatePaintBuffers(re));const dt=J.constantOr(null);if(dt&&Xe.imageAtlas){const Lt=Xe.imageAtlas,Nt=Lt.patternPositions[dt.to.toString()],St=Lt.patternPositions[dt.from.toString()];Nt&&St&&$e.setConstantPatternPositions(Nt,St)}const yt=T.translatePosMatrix(Je.posMatrix,Xe,g.paint.get("fill-translate"),g.paint.get("fill-translate-anchor"));if(F){we=nt.indexBuffer2,Oe=nt.segments2;const Lt=[Z.drawingBufferWidth,Z.drawingBufferHeight];Fe=xe==="fillOutlinePattern"&&ee?ca(yt,T,re,Xe,Lt):ec(yt,Lt)}else we=nt.indexBuffer,Oe=nt.segments,Fe=ee?No(yt,T,re,Xe):ua(yt);wt.draw(T.context,ue,A,T.stencilModeForClipping(Je),M,An.disabled,Fe,g.id,nt.layoutVertexBuffer,we,Oe,g.paint,T.transform.zoom,$e)}}function ss(T,o,g,I,A,M,F){const Z=T.context,J=Z.gl,ee=g.paint.get("fill-extrusion-pattern"),re=ee.constantOr(1),ue=g.getCrossfadeParameters(),xe=g.paint.get("fill-extrusion-opacity");for(const Fe of I){const we=o.getTile(Fe),Oe=we.getBucket(g);if(!Oe)continue;const Je=Oe.programConfigurations.get(g.id),Xe=T.useProgram(re?"fillExtrusionPattern":"fillExtrusion",Je);re&&(T.context.activeTexture.set(J.TEXTURE0),we.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),Je.updatePaintBuffers(ue));const nt=ee.constantOr(null);if(nt&&we.imageAtlas){const yt=we.imageAtlas,Lt=yt.patternPositions[nt.to.toString()],Nt=yt.patternPositions[nt.from.toString()];Lt&&Nt&&Je.setConstantPatternPositions(Lt,Nt)}const $e=T.translatePosMatrix(Fe.posMatrix,we,g.paint.get("fill-extrusion-translate"),g.paint.get("fill-extrusion-translate-anchor")),wt=g.paint.get("fill-extrusion-vertical-gradient"),dt=re?Qr($e,T,wt,xe,Fe,ue,we):la($e,T,wt,xe);Xe.draw(Z,Z.gl.TRIANGLES,A,M,F,An.backCCW,dt,g.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,g.paint,T.transform.zoom,Je)}}function zu(T,o,g,I,A,M){const F=T.context,Z=F.gl,J=o.fbo;if(!J)return;const ee=T.useProgram("hillshade");F.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,J.colorAttachment.get());const re=((ue,xe,Fe)=>{const we=Fe.paint.get("hillshade-shadow-color"),Oe=Fe.paint.get("hillshade-highlight-color"),Je=Fe.paint.get("hillshade-accent-color");let Xe=Fe.paint.get("hillshade-illumination-direction")*(Math.PI/180);Fe.paint.get("hillshade-illumination-anchor")==="viewport"&&(Xe-=ue.transform.angle);const nt=!ue.options.moving;return{u_matrix:ue.transform.calculatePosMatrix(xe.tileID.toUnwrapped(),nt),u_image:0,u_latrange:Na(0,xe.tileID),u_light:[Fe.paint.get("hillshade-exaggeration"),Xe],u_shadow:we,u_highlight:Oe,u_accent:Je}})(T,o,g);ee.draw(F,Z.TRIANGLES,I,A,M,An.disabled,re,g.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments)}function ko(T,o,g,I,A,M){const F=T.context,Z=F.gl,J=o.dem;if(J&&J.data){const ee=J.dim,re=J.stride,ue=J.getPixels();if(F.activeTexture.set(Z.TEXTURE1),F.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||T.getTileTexture(re),o.demTexture){const Fe=o.demTexture;Fe.update(ue,{premultiply:!1}),Fe.bind(Z.NEAREST,Z.CLAMP_TO_EDGE)}else o.demTexture=new Re(F,ue,Z.RGBA,{premultiply:!1}),o.demTexture.bind(Z.NEAREST,Z.CLAMP_TO_EDGE);F.activeTexture.set(Z.TEXTURE0);let xe=o.fbo;if(!xe){const Fe=new Re(F,{width:ee,height:ee,data:null},Z.RGBA);Fe.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),xe=o.fbo=F.createFramebuffer(ee,ee,!0),xe.colorAttachment.set(Fe.texture)}F.bindFramebuffer.set(xe.framebuffer),F.viewport.set([0,0,ee,ee]),T.useProgram("hillshadePrepare").draw(F,Z.TRIANGLES,I,A,M,An.disabled,((Fe,we)=>{const Oe=we.stride,Je=p.create();return p.ortho(Je,0,p.EXTENT,-p.EXTENT,0,0,1),p.translate(Je,Je,[0,-p.EXTENT,0]),{u_matrix:Je,u_image:1,u_dimension:[Oe,Oe],u_zoom:Fe.overscaledZ,u_unpack:we.getUnpackVector()}})(o.tileID,J),g.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments),o.needsHillshadePrepare=!1}}function ac(T,o,g,I,A){const M=I.paint.get("raster-fade-duration");if(M>0){const F=p.exported.now(),Z=(F-T.timeAdded)/M,J=o?(F-o.timeAdded)/M:-1,ee=g.getSource(),re=A.coveringZoomLevel({tileSize:ee.tileSize,roundZoom:ee.roundZoom}),ue=!o||Math.abs(o.tileID.overscaledZ-re)>Math.abs(T.tileID.overscaledZ-re),xe=ue&&T.refreshedUponExpiration?1:p.clamp(ue?Z:1-J,0,1);return T.refreshedUponExpiration&&Z>=1&&(T.refreshedUponExpiration=!1),o?{opacity:1,mix:1-xe}:{opacity:xe,mix:0}}return{opacity:1,mix:0}}const Nc=new p.Color(1,0,0,1),sc=new p.Color(0,1,0,1),ls=new p.Color(0,0,1,1),us=new p.Color(1,0,1,1),Js=new p.Color(0,1,1,1);function Jl(T,o,g,I){cs(T,0,o+g/2,T.transform.width,g,I)}function Ms(T,o,g,I){cs(T,o-g/2,0,g,T.transform.height,I)}function cs(T,o,g,I,A,M){const F=T.context,Z=F.gl;Z.enable(Z.SCISSOR_TEST),Z.scissor(o*T.pixelRatio,g*T.pixelRatio,I*T.pixelRatio,A*T.pixelRatio),F.clear({color:M}),Z.disable(Z.SCISSOR_TEST)}function lc(T,o,g){const I=T.context,A=I.gl,M=g.posMatrix,F=T.useProgram("debug"),Z=Er.disabled,J=Kr.disabled,ee=T.colorModeForRenderPass(),re="$debug";I.activeTexture.set(A.TEXTURE0),T.emptyTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),F.draw(I,A.LINE_STRIP,Z,J,ee,An.disabled,In(M,p.Color.red),re,T.debugBuffer,T.tileBorderIndexBuffer,T.debugSegments);const ue=o.getTileByID(g.key).latestRawTileData,xe=Math.floor((ue&&ue.byteLength||0)/1024),Fe=o.getTile(g).tileSize,we=512/Math.min(Fe,512)*(g.overscaledZ/T.transform.zoom)*.5;let Oe=g.canonical.toString();g.overscaledZ!==g.canonical.z&&(Oe+=` => ${g.overscaledZ}`),function(Je,Xe){Je.initDebugOverlayCanvas();const nt=Je.debugOverlayCanvas,$e=Je.context.gl,wt=Je.debugOverlayCanvas.getContext("2d");wt.clearRect(0,0,nt.width,nt.height),wt.shadowColor="white",wt.shadowBlur=2,wt.lineWidth=1.5,wt.strokeStyle="white",wt.textBaseline="top",wt.font="bold 36px Open Sans, sans-serif",wt.fillText(Xe,5,5),wt.strokeText(Xe,5,5),Je.debugOverlayTexture.update(nt),Je.debugOverlayTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE)}(T,`${Oe} ${xe}kb`),F.draw(I,A.TRIANGLES,Z,J,$i.alphaBlended,An.disabled,In(M,p.Color.transparent,we),re,T.debugBuffer,T.quadTriangleIndexBuffer,T.debugSegments)}const Wa={symbol:function(T,o,g,I,A){if(T.renderPass!=="translucent")return;const M=Kr.disabled,F=T.colorModeForRenderPass();g.layout.get("text-variable-anchor")&&function(Z,J,ee,re,ue,xe,Fe){const we=J.transform,Oe=ue==="map",Je=xe==="map";for(const Xe of Z){const nt=re.getTile(Xe),$e=nt.getBucket(ee);if(!$e||!$e.text||!$e.text.segments.get().length)continue;const wt=p.evaluateSizeForZoom($e.textSizeData,we.zoom),dt=Ae(nt,1,J.transform.zoom),yt=eo(Xe.posMatrix,Je,Oe,J.transform,dt),Lt=ee.layout.get("icon-text-fit")!=="none"&&$e.hasIconData();if(wt){const Nt=Math.pow(2,we.zoom-nt.tileID.overscaledZ);Za($e,Oe,Je,Fe,we,yt,Xe.posMatrix,Nt,wt,Lt)}}}(I,T,g,o,g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),A),g.paint.get("icon-opacity").constantOr(1)!==0&&Kl(T,o,g,I,!1,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),g.layout.get("icon-rotation-alignment"),g.layout.get("icon-pitch-alignment"),g.layout.get("icon-keep-upright"),M,F),g.paint.get("text-opacity").constantOr(1)!==0&&Kl(T,o,g,I,!0,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),g.layout.get("text-rotation-alignment"),g.layout.get("text-pitch-alignment"),g.layout.get("text-keep-upright"),M,F),o.map.showCollisionBoxes&&(Xl(T,o,g,I,g.paint.get("text-translate"),g.paint.get("text-translate-anchor"),!0),Xl(T,o,g,I,g.paint.get("icon-translate"),g.paint.get("icon-translate-anchor"),!1))},circle:function(T,o,g,I){if(T.renderPass!=="translucent")return;const A=g.paint.get("circle-opacity"),M=g.paint.get("circle-stroke-width"),F=g.paint.get("circle-stroke-opacity"),Z=!g.layout.get("circle-sort-key").isConstant();if(A.constantOr(1)===0&&(M.constantOr(1)===0||F.constantOr(1)===0))return;const J=T.context,ee=J.gl,re=T.depthModeForSublayer(0,Er.ReadOnly),ue=Kr.disabled,xe=T.colorModeForRenderPass(),Fe=[];for(let we=0;we<I.length;we++){const Oe=I[we],Je=o.getTile(Oe),Xe=Je.getBucket(g);if(!Xe)continue;const nt=Xe.programConfigurations.get(g.id),$e={programConfiguration:nt,program:T.useProgram("circle",nt),layoutVertexBuffer:Xe.layoutVertexBuffer,indexBuffer:Xe.indexBuffer,uniformValues:Zs(T,Oe,Je,g)};if(Z){const wt=Xe.segments.get();for(const dt of wt)Fe.push({segments:new p.SegmentVector([dt]),sortKey:dt.sortKey,state:$e})}else Fe.push({segments:Xe.segments,sortKey:0,state:$e})}Z&&Fe.sort((we,Oe)=>we.sortKey-Oe.sortKey);for(const we of Fe){const{programConfiguration:Oe,program:Je,layoutVertexBuffer:Xe,indexBuffer:nt,uniformValues:$e}=we.state;Je.draw(J,ee.TRIANGLES,re,ue,xe,An.disabled,$e,g.id,Xe,nt,we.segments,g.paint,T.transform.zoom,Oe)}},heatmap:function(T,o,g,I){if(g.paint.get("heatmap-opacity")!==0)if(T.renderPass==="offscreen"){const A=T.context,M=A.gl,F=Kr.disabled,Z=new $i([M.ONE,M.ONE],p.Color.transparent,[!0,!0,!0,!0]);(function(J,ee,re){const ue=J.gl;J.activeTexture.set(ue.TEXTURE1),J.viewport.set([0,0,ee.width/4,ee.height/4]);let xe=re.heatmapFbo;if(xe)ue.bindTexture(ue.TEXTURE_2D,xe.colorAttachment.get()),J.bindFramebuffer.set(xe.framebuffer);else{const Fe=ue.createTexture();ue.bindTexture(ue.TEXTURE_2D,Fe),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MAG_FILTER,ue.LINEAR),xe=re.heatmapFbo=J.createFramebuffer(ee.width/4,ee.height/4,!1),function(we,Oe,Je,Xe){const nt=we.gl;nt.texImage2D(nt.TEXTURE_2D,0,nt.RGBA,Oe.width/4,Oe.height/4,0,nt.RGBA,we.extRenderToTextureHalfFloat?we.extTextureHalfFloat.HALF_FLOAT_OES:nt.UNSIGNED_BYTE,null),Xe.colorAttachment.set(Je)}(J,ee,Fe,xe)}})(A,T,g),A.clear({color:p.Color.transparent});for(let J=0;J<I.length;J++){const ee=I[J];if(o.hasRenderableParent(ee))continue;const re=o.getTile(ee),ue=re.getBucket(g);if(!ue)continue;const xe=ue.programConfigurations.get(g.id),Fe=T.useProgram("heatmap",xe),{zoom:we}=T.transform;Fe.draw(A,M.TRIANGLES,Er.disabled,F,Z,An.disabled,io(ee.posMatrix,re,we,g.paint.get("heatmap-intensity")),g.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,g.paint,T.transform.zoom,xe)}A.viewport.set([0,0,T.width,T.height])}else T.renderPass==="translucent"&&(T.context.setColorMode(T.colorModeForRenderPass()),function(A,M){const F=A.context,Z=F.gl,J=M.heatmapFbo;if(!J)return;F.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,J.colorAttachment.get()),F.activeTexture.set(Z.TEXTURE1);let ee=M.colorRampTexture;ee||(ee=M.colorRampTexture=new Re(F,M.colorRamp,Z.RGBA)),ee.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),A.useProgram("heatmapTexture").draw(F,Z.TRIANGLES,Er.disabled,Kr.disabled,A.colorModeForRenderPass(),An.disabled,((re,ue,xe,Fe)=>{const we=p.create();p.ortho(we,0,re.width,re.height,0,0,1);const Oe=re.context.gl;return{u_matrix:we,u_world:[Oe.drawingBufferWidth,Oe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ue.paint.get("heatmap-opacity")}})(A,M),M.id,A.viewportBuffer,A.quadTriangleIndexBuffer,A.viewportSegments,M.paint,A.transform.zoom)}(T,g))},line:function(T,o,g,I){if(T.renderPass!=="translucent")return;const A=g.paint.get("line-opacity"),M=g.paint.get("line-width");if(A.constantOr(1)===0||M.constantOr(1)===0)return;const F=T.depthModeForSublayer(0,Er.ReadOnly),Z=T.colorModeForRenderPass(),J=g.paint.get("line-dasharray"),ee=g.paint.get("line-pattern"),re=ee.constantOr(1),ue=g.paint.get("line-gradient"),xe=g.getCrossfadeParameters(),Fe=re?"linePattern":J?"lineSDF":ue?"lineGradient":"line",we=T.context,Oe=we.gl;let Je=!0;for(const Xe of I){const nt=o.getTile(Xe);if(re&&!nt.patternsLoaded())continue;const $e=nt.getBucket(g);if(!$e)continue;const wt=$e.programConfigurations.get(g.id),dt=T.context.program.get(),yt=T.useProgram(Fe,wt),Lt=Je||yt.program!==dt,Nt=ee.constantOr(null);if(Nt&&nt.imageAtlas){const mi=nt.imageAtlas,ni=mi.patternPositions[Nt.to.toString()],qi=mi.patternPositions[Nt.from.toString()];ni&&qi&&wt.setConstantPatternPositions(ni,qi)}const St=re?Hs(T,nt,g,xe):J?jn(T,nt,g,J,xe):ue?wu(T,nt,g,$e.lineClipsArray.length):Ul(T,nt,g);if(re)we.activeTexture.set(Oe.TEXTURE0),nt.imageAtlasTexture.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE),wt.updatePaintBuffers(xe);else if(J&&(Lt||T.lineAtlas.dirty))we.activeTexture.set(Oe.TEXTURE0),T.lineAtlas.bind(we);else if(ue){const mi=$e.gradients[g.id];let ni=mi.texture;if(g.gradientVersion!==mi.version){let qi=256;if(g.stepInterpolant){const c=o.getSource().maxzoom,m=Xe.canonical.z===c?Math.ceil(1<<T.transform.maxZoom-Xe.canonical.z):1;qi=p.clamp(p.nextPowerOfTwo($e.maxLineLength/p.EXTENT*1024*m),256,we.maxTextureSize)}mi.gradient=p.renderColorRamp({expression:g.gradientExpression(),evaluationKey:"lineProgress",resolution:qi,image:mi.gradient||void 0,clips:$e.lineClipsArray}),mi.texture?mi.texture.update(mi.gradient):mi.texture=new Re(we,mi.gradient,Oe.RGBA),mi.version=g.gradientVersion,ni=mi.texture}we.activeTexture.set(Oe.TEXTURE0),ni.bind(g.stepInterpolant?Oe.NEAREST:Oe.LINEAR,Oe.CLAMP_TO_EDGE)}yt.draw(we,Oe.TRIANGLES,F,T.stencilModeForClipping(Xe),Z,An.disabled,St,g.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,g.paint,T.transform.zoom,wt,$e.layoutVertexBuffer2),Je=!1}},fill:function(T,o,g,I){const A=g.paint.get("fill-color"),M=g.paint.get("fill-opacity");if(M.constantOr(1)===0)return;const F=T.colorModeForRenderPass(),Z=g.paint.get("fill-pattern"),J=T.opaquePassEnabledForLayer()&&!Z.constantOr(1)&&A.constantOr(p.Color.transparent).a===1&&M.constantOr(0)===1?"opaque":"translucent";if(T.renderPass===J){const ee=T.depthModeForSublayer(1,T.renderPass==="opaque"?Er.ReadWrite:Er.ReadOnly);Jr(T,o,g,I,ee,F,!1)}if(T.renderPass==="translucent"&&g.paint.get("fill-antialias")){const ee=T.depthModeForSublayer(g.getPaintProperty("fill-outline-color")?2:0,Er.ReadOnly);Jr(T,o,g,I,ee,F,!0)}},"fill-extrusion":function(T,o,g,I){const A=g.paint.get("fill-extrusion-opacity");if(A!==0&&T.renderPass==="translucent"){const M=new Er(T.context.gl.LEQUAL,Er.ReadWrite,T.depthRangeFor3D);if(A!==1||g.paint.get("fill-extrusion-pattern").constantOr(1))ss(T,o,g,I,M,Kr.disabled,$i.disabled),ss(T,o,g,I,M,T.stencilModeFor3D(),T.colorModeForRenderPass());else{const F=T.colorModeForRenderPass();ss(T,o,g,I,M,Kr.disabled,F)}}},hillshade:function(T,o,g,I){if(T.renderPass!=="offscreen"&&T.renderPass!=="translucent")return;const A=T.context,M=T.depthModeForSublayer(0,Er.ReadOnly),F=T.colorModeForRenderPass(),[Z,J]=T.renderPass==="translucent"?T.stencilConfigForOverlap(I):[{},I];for(const ee of J){const re=o.getTile(ee);re.needsHillshadePrepare&&T.renderPass==="offscreen"?ko(T,re,g,M,Kr.disabled,F):T.renderPass==="translucent"&&zu(T,re,g,M,Z[ee.overscaledZ],F)}A.viewport.set([0,0,T.width,T.height])},raster:function(T,o,g,I){if(T.renderPass!=="translucent"||g.paint.get("raster-opacity")===0||!I.length)return;const A=T.context,M=A.gl,F=o.getSource(),Z=T.useProgram("raster"),J=T.colorModeForRenderPass(),[ee,re]=F instanceof xi?[{},I]:T.stencilConfigForOverlap(I),ue=re[re.length-1].overscaledZ,xe=!T.options.moving;for(const Fe of re){const we=T.depthModeForSublayer(Fe.overscaledZ-ue,g.paint.get("raster-opacity")===1?Er.ReadWrite:Er.ReadOnly,M.LESS),Oe=o.getTile(Fe),Je=T.transform.calculatePosMatrix(Fe.toUnwrapped(),xe);Oe.registerFadeDuration(g.paint.get("raster-fade-duration"));const Xe=o.findLoadedParent(Fe,0),nt=ac(Oe,Xe,o,g,T.transform);let $e,wt;const dt=g.paint.get("raster-resampling")==="nearest"?M.NEAREST:M.LINEAR;A.activeTexture.set(M.TEXTURE0),Oe.texture.bind(dt,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),A.activeTexture.set(M.TEXTURE1),Xe?(Xe.texture.bind(dt,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),$e=Math.pow(2,Xe.tileID.overscaledZ-Oe.tileID.overscaledZ),wt=[Oe.tileID.canonical.x*$e%1,Oe.tileID.canonical.y*$e%1]):Oe.texture.bind(dt,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST);const yt=ic(Je,wt||[0,0],$e||1,nt,g);F instanceof xi?Z.draw(A,M.TRIANGLES,we,Kr.disabled,J,An.disabled,yt,g.id,F.boundsBuffer,T.quadTriangleIndexBuffer,F.boundsSegments):Z.draw(A,M.TRIANGLES,we,ee[Fe.overscaledZ],J,An.disabled,yt,g.id,T.rasterBoundsBuffer,T.quadTriangleIndexBuffer,T.rasterBoundsSegments)}},background:function(T,o,g){const I=g.paint.get("background-color"),A=g.paint.get("background-opacity");if(A===0)return;const M=T.context,F=M.gl,Z=T.transform,J=Z.tileSize,ee=g.paint.get("background-pattern");if(T.isPatternMissing(ee))return;const re=!ee&&I.a===1&&A===1&&T.opaquePassEnabledForLayer()?"opaque":"translucent";if(T.renderPass!==re)return;const ue=Kr.disabled,xe=T.depthModeForSublayer(0,re==="opaque"?Er.ReadWrite:Er.ReadOnly),Fe=T.colorModeForRenderPass(),we=T.useProgram(ee?"backgroundPattern":"background"),Oe=Z.coveringTiles({tileSize:J});ee&&(M.activeTexture.set(F.TEXTURE0),T.imageManager.bind(T.context));const Je=g.getCrossfadeParameters();for(const Xe of Oe){const nt=T.transform.calculatePosMatrix(Xe.toUnwrapped()),$e=ee?yl(nt,A,T,ee,{tileID:Xe,tileSize:J},Je):Oc(nt,A,I);we.draw(M,F.TRIANGLES,xe,ue,Fe,An.disabled,$e,g.id,T.tileExtentBuffer,T.quadTriangleIndexBuffer,T.tileExtentSegments)}},debug:function(T,o,g){for(let I=0;I<g.length;I++)lc(T,o,g[I])},custom:function(T,o,g){const I=T.context,A=g.implementation;if(T.renderPass==="offscreen"){const M=A.prerender;M&&(T.setCustomLayerDefaults(),I.setColorMode(T.colorModeForRenderPass()),M.call(A,I.gl,T.transform.customLayerMatrix()),I.setDirty(),T.setBaseState())}else if(T.renderPass==="translucent"){T.setCustomLayerDefaults(),I.setColorMode(T.colorModeForRenderPass()),I.setStencilMode(Kr.disabled);const M=A.renderingMode==="3d"?new Er(T.context.gl.LEQUAL,Er.ReadWrite,T.depthRangeFor3D):T.depthModeForSublayer(0,Er.ReadOnly);I.setDepthMode(M),A.render(I.gl,T.transform.customLayerMatrix()),I.setDirty(),T.setBaseState(),I.bindFramebuffer.set(null)}}};class ha{constructor(o,g){this.context=new Hl(o),this.transform=g,this._tileTextures={},this.setup(),this.numSublayers=rt.maxUnderzooming+rt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new di,this.gpuTimers={}}resize(o,g,I){if(this.width=o*I,this.height=g*I,this.pixelRatio=I,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const A of this.style._order)this.style._layers[A].resize()}setup(){const o=this.context,g=new p.PosArray;g.emplaceBack(0,0),g.emplaceBack(p.EXTENT,0),g.emplaceBack(0,p.EXTENT),g.emplaceBack(p.EXTENT,p.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(g,Eo.members),this.tileExtentSegments=p.SegmentVector.simpleSegment(0,0,4,2);const I=new p.PosArray;I.emplaceBack(0,0),I.emplaceBack(p.EXTENT,0),I.emplaceBack(0,p.EXTENT),I.emplaceBack(p.EXTENT,p.EXTENT),this.debugBuffer=o.createVertexBuffer(I,Eo.members),this.debugSegments=p.SegmentVector.simpleSegment(0,0,4,5);const A=new p.RasterBoundsArray;A.emplaceBack(0,0,0,0),A.emplaceBack(p.EXTENT,0,p.EXTENT,0),A.emplaceBack(0,p.EXTENT,0,p.EXTENT),A.emplaceBack(p.EXTENT,p.EXTENT,p.EXTENT,p.EXTENT),this.rasterBoundsBuffer=o.createVertexBuffer(A,Et.members),this.rasterBoundsSegments=p.SegmentVector.simpleSegment(0,0,4,2);const M=new p.PosArray;M.emplaceBack(0,0),M.emplaceBack(1,0),M.emplaceBack(0,1),M.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(M,Eo.members),this.viewportSegments=p.SegmentVector.simpleSegment(0,0,4,2);const F=new p.LineStripIndexArray;F.emplaceBack(0),F.emplaceBack(1),F.emplaceBack(3),F.emplaceBack(2),F.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(F);const Z=new p.TriangleIndexArray;Z.emplaceBack(0,1,2),Z.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(Z),this.emptyTexture=new Re(o,{width:1,height:1,data:new Uint8Array([0,0,0,0])},o.gl.RGBA);const J=this.context.gl;this.stencilClearMode=new Kr({func:J.ALWAYS,mask:0},0,255,J.ZERO,J.ZERO,J.ZERO)}clearStencil(){const o=this.context,g=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const I=p.create();p.ortho(I,0,this.width,this.height,0,0,1),p.scale(I,I,[g.drawingBufferWidth,g.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(o,g.TRIANGLES,Er.disabled,this.stencilClearMode,$i.disabled,An.disabled,Zo(I),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,g){if(this.currentStencilSource===o.source||!o.isTileClipped()||!g||!g.length)return;this.currentStencilSource=o.source;const I=this.context,A=I.gl;this.nextStencilID+g.length>256&&this.clearStencil(),I.setColorMode($i.disabled),I.setDepthMode(Er.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const F of g){const Z=this._tileClippingMaskIDs[F.key]=this.nextStencilID++;M.draw(I,A.TRIANGLES,Er.disabled,new Kr({func:A.ALWAYS,mask:0},Z,255,A.KEEP,A.KEEP,A.REPLACE),$i.disabled,An.disabled,Zo(F.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,g=this.context.gl;return new Kr({func:g.NOTEQUAL,mask:255},o,255,g.KEEP,g.KEEP,g.REPLACE)}stencilModeForClipping(o){const g=this.context.gl;return new Kr({func:g.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,g.KEEP,g.KEEP,g.REPLACE)}stencilConfigForOverlap(o){const g=this.context.gl,I=o.sort((F,Z)=>Z.overscaledZ-F.overscaledZ),A=I[I.length-1].overscaledZ,M=I[0].overscaledZ-A+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();const F={};for(let Z=0;Z<M;Z++)F[Z+A]=new Kr({func:g.GEQUAL,mask:255},Z+this.nextStencilID,255,g.KEEP,g.KEEP,g.REPLACE);return this.nextStencilID+=M,[F,I]}return[{[A]:Kr.disabled},I]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new $i([o.CONSTANT_COLOR,o.ONE],new p.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?$i.unblended:$i.alphaBlended}depthModeForSublayer(o,g,I){if(!this.opaquePassEnabledForLayer())return Er.disabled;const A=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new Er(I||this.context.gl.LEQUAL,g,[A,A])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,g){this.style=o,this.options=g,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(p.exported.now()),this.imageManager.beginFrame();const I=this.style._order,A=this.style.sourceCaches;for(const J in A){const ee=A[J];ee.used&&ee.prepare(this.context)}const M={},F={},Z={};for(const J in A){const ee=A[J];M[J]=ee.getVisibleCoordinates(),F[J]=M[J].slice().reverse(),Z[J]=ee.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let J=0;J<I.length;J++)if(this.style._layers[I[J]].is3D()){this.opaquePassCutoff=J;break}this.renderPass="offscreen";for(const J of I){const ee=this.style._layers[J];if(!ee.hasOffscreenPass()||ee.isHidden(this.transform.zoom))continue;const re=F[ee.source];(ee.type==="custom"||re.length)&&this.renderLayer(this,A[ee.source],ee,re)}for(this.context.bindFramebuffer.set(null),this.context.clear({color:g.showOverdrawInspector?p.Color.black:p.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=g.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=I.length-1;this.currentLayer>=0;this.currentLayer--){const J=this.style._layers[I[this.currentLayer]],ee=A[J.source],re=M[J.source];this._renderTileClippingMasks(J,re),this.renderLayer(this,ee,J,re)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<I.length;this.currentLayer++){const J=this.style._layers[I[this.currentLayer]],ee=A[J.source],re=(J.type==="symbol"?Z:F)[J.source];this._renderTileClippingMasks(J,M[J.source]),this.renderLayer(this,ee,J,re)}if(this.options.showTileBoundaries){let J,ee;Object.values(this.style._layers).forEach(re=>{re.source&&!re.isHidden(this.transform.zoom)&&(re.source!==(ee&&ee.id)&&(ee=this.style.sourceCaches[re.source]),(!J||J.getSource().maxzoom<ee.getSource().maxzoom)&&(J=ee))}),J&&Wa.debug(this,J,J.getVisibleCoordinates())}this.options.showPadding&&function(J){const ee=J.transform.padding;Jl(J,J.transform.height-(ee.top||0),3,Nc),Jl(J,ee.bottom||0,3,sc),Ms(J,ee.left||0,3,ls),Ms(J,J.transform.width-(ee.right||0),3,us);const re=J.transform.centerPoint;(function(ue,xe,Fe,we){cs(ue,xe-1,Fe-10,2,20,we),cs(ue,xe-10,Fe-1,20,2,we)})(J,re.x,J.transform.height-re.y,Js)}(this),this.context.setDefault()}renderLayer(o,g,I,A){I.isHidden(this.transform.zoom)||(I.type==="background"||I.type==="custom"||A.length)&&(this.id=I.id,this.gpuTimingStart(I),Wa[I.type](o,g,I,A,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const g=this.context.extTimerQuery;let I=this.gpuTimers[o.id];I||(I=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:g.createQueryEXT()}),I.calls++,g.beginQueryEXT(g.TIME_ELAPSED_EXT,I.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}queryGpuTimers(o){const g={};for(const I in o){const A=o[I],M=this.context.extTimerQuery,F=M.getQueryObjectEXT(A.query,M.QUERY_RESULT_EXT)/1e6;M.deleteQueryEXT(A.query),g[I]=F}return g}translatePosMatrix(o,g,I,A,M){if(!I[0]&&!I[1])return o;const F=M?A==="map"?this.transform.angle:0:A==="viewport"?-this.transform.angle:0;if(F){const ee=Math.sin(F),re=Math.cos(F);I=[I[0]*re-I[1]*ee,I[0]*ee+I[1]*re]}const Z=[M?I[0]:Ae(g,I[0],this.transform.zoom),M?I[1]:Ae(g,I[1],this.transform.zoom),0],J=new Float32Array(16);return p.translate(J,o,Z),J}saveTileTexture(o){const g=this._tileTextures[o.size[0]];g?g.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const g=this._tileTextures[o];return g&&g.length>0?g.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const g=this.imageManager.getPattern(o.from.toString()),I=this.imageManager.getPattern(o.to.toString());return!g||!I}useProgram(o,g){this.cache=this.cache||{};const I=`${o}${g?g.cacheKey:""}${this._showOverdrawInspector?"/overdraw":""}`;return this.cache[I]||(this.cache[I]=new Co(this.context,o,Fl[o],g,Ho[o],this._showOverdrawInspector)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Re(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Yl{constructor(o,g){this.points=o,this.planes=g}static fromInvProjectionMatrix(o,g,I){const A=Math.pow(2,I),M=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(Z=>p.transformMat4([],Z,o)).map(Z=>p.scale$1([],Z,1/Z[3]/g*A)),F=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(Z=>{const J=function(xe,Fe){var we=Fe[0],Oe=Fe[1],Je=Fe[2],Xe=we*we+Oe*Oe+Je*Je;return Xe>0&&(Xe=1/Math.sqrt(Xe)),xe[0]=Fe[0]*Xe,xe[1]=Fe[1]*Xe,xe[2]=Fe[2]*Xe,xe}([],function(xe,Fe,we){var Oe=Fe[0],Je=Fe[1],Xe=Fe[2],nt=we[0],$e=we[1],wt=we[2];return xe[0]=Je*wt-Xe*$e,xe[1]=Xe*nt-Oe*wt,xe[2]=Oe*$e-Je*nt,xe}([],ft([],M[Z[0]],M[Z[1]]),ft([],M[Z[2]],M[Z[1]]))),ee=-((re=J)[0]*(ue=M[Z[1]])[0]+re[1]*ue[1]+re[2]*ue[2]);var re,ue;return J.concat(ee)});return new Yl(M,F)}}class $l{constructor(o,g){this.min=o,this.max=g,this.center=function(I,A,M){return I[0]=.5*A[0],I[1]=.5*A[1],I[2]=.5*A[2],I}([],function(I,A,M){return I[0]=A[0]+M[0],I[1]=A[1]+M[1],I[2]=A[2]+M[2],I}([],this.min,this.max))}quadrant(o){const g=[o%2==0,o<2],I=De(this.min),A=De(this.max);for(let M=0;M<g.length;M++)I[M]=g[M]?this.min[M]:this.center[M],A[M]=g[M]?this.center[M]:this.max[M];return A[2]=this.max[2],new $l(I,A)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersects(o){const g=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]];let I=!0;for(let A=0;A<o.planes.length;A++){const M=o.planes[A];let F=0;for(let Z=0;Z<g.length;Z++)p.dot(M,g[Z])>=0&&F++;if(F===0)return 0;F!==g.length&&(I=!1)}if(I)return 2;for(let A=0;A<3;A++){let M=Number.MAX_VALUE,F=-Number.MAX_VALUE;for(let Z=0;Z<o.points.length;Z++){const J=o.points[Z][A]-this.min[A];M=Math.min(M,J),F=Math.max(F,J)}if(F<0||M>this.max[A]-this.min[A])return 0}return 1}}class Ys{constructor(o=0,g=0,I=0,A=0){if(isNaN(o)||o<0||isNaN(g)||g<0||isNaN(I)||I<0||isNaN(A)||A<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=g,this.left=I,this.right=A}interpolate(o,g,I){return g.top!=null&&o.top!=null&&(this.top=p.number(o.top,g.top,I)),g.bottom!=null&&o.bottom!=null&&(this.bottom=p.number(o.bottom,g.bottom,I)),g.left!=null&&o.left!=null&&(this.left=p.number(o.left,g.left,I)),g.right!=null&&o.right!=null&&(this.right=p.number(o.right,g.right,I)),this}getCenter(o,g){const I=p.clamp((this.left+o-this.right)/2,0,o),A=p.clamp((this.top+g-this.bottom)/2,0,g);return new p.pointGeometry(I,A)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Ys(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class za{constructor(o,g,I,A,M){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=M===void 0||!!M,this._minZoom=o||0,this._maxZoom=g||22,this._minPitch=I==null?0:I,this._maxPitch=A==null?60:A,this.setMaxBounds(),this.width=0,this.height=0,this._center=new p.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ys,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const o=new za(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return o.tileSize=this.tileSize,o.latRange=this.latRange,o.width=this.width,o.height=this.height,o._center=this._center,o.zoom=this.zoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._calcMatrices(),o}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new p.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(o){const g=-p.wrap(o,-180,180)*Math.PI/180;this.angle!==g&&(this._unmodified=!1,this.angle=g,this._calcMatrices(),this.rotationMatrix=function(){var I=new p.ARRAY_TYPE(4);return p.ARRAY_TYPE!=Float32Array&&(I[1]=0,I[2]=0),I[0]=1,I[3]=1,I}(),function(I,A,M){var F=A[0],Z=A[1],J=A[2],ee=A[3],re=Math.sin(M),ue=Math.cos(M);I[0]=F*ue+J*re,I[1]=Z*ue+ee*re,I[2]=F*-re+J*ue,I[3]=Z*-re+ee*ue}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const g=p.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==g&&(this._unmodified=!1,this._pitch=g,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=o/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(o){const g=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==g&&(this._unmodified=!1,this._zoom=g,this.scale=this.zoomScale(g),this.tileZoom=Math.floor(g),this.zoomFraction=g-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,g,I){this._unmodified=!1,this._edgeInsets.interpolate(o,g,I),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const g=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,g)}getVisibleUnwrappedCoordinates(o){const g=[new p.UnwrappedTileID(0,o)];if(this._renderWorldCopies){const I=this.pointCoordinate(new p.pointGeometry(0,0)),A=this.pointCoordinate(new p.pointGeometry(this.width,0)),M=this.pointCoordinate(new p.pointGeometry(this.width,this.height)),F=this.pointCoordinate(new p.pointGeometry(0,this.height)),Z=Math.floor(Math.min(I.x,A.x,M.x,F.x)),J=Math.floor(Math.max(I.x,A.x,M.x,F.x)),ee=1;for(let re=Z-ee;re<=J+ee;re++)re!==0&&g.push(new p.UnwrappedTileID(re,o))}return g}coveringTiles(o){let g=this.coveringZoomLevel(o);const I=g;if(o.minzoom!==void 0&&g<o.minzoom)return[];o.maxzoom!==void 0&&g>o.maxzoom&&(g=o.maxzoom);const A=p.MercatorCoordinate.fromLngLat(this.center),M=Math.pow(2,g),F=[M*A.x,M*A.y,0],Z=Yl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,g);let J=o.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(J=g);const ee=we=>({aabb:new $l([we*M,0,0],[(we+1)*M,M,0]),zoom:0,x:0,y:0,wrap:we,fullyVisible:!1}),re=[],ue=[],xe=g,Fe=o.reparseOverscaled?I:g;if(this._renderWorldCopies)for(let we=1;we<=3;we++)re.push(ee(-we)),re.push(ee(we));for(re.push(ee(0));re.length>0;){const we=re.pop(),Oe=we.x,Je=we.y;let Xe=we.fullyVisible;if(!Xe){const yt=we.aabb.intersects(Z);if(yt===0)continue;Xe=yt===2}const nt=we.aabb.distanceX(F),$e=we.aabb.distanceY(F),wt=Math.max(Math.abs(nt),Math.abs($e)),dt=3+(1<<xe-we.zoom)-2;if(we.zoom===xe||wt>dt&&we.zoom>=J)ue.push({tileID:new p.OverscaledTileID(we.zoom===xe?Fe:we.zoom,we.wrap,we.zoom,Oe,Je),distanceSq:Ue([F[0]-.5-Oe,F[1]-.5-Je])});else for(let yt=0;yt<4;yt++){const Lt=(Oe<<1)+yt%2,Nt=(Je<<1)+(yt>>1);re.push({aabb:we.aabb.quadrant(yt),zoom:we.zoom+1,x:Lt,y:Nt,wrap:we.wrap,fullyVisible:Xe})}}return ue.sort((we,Oe)=>we.distanceSq-Oe.distanceSq).map(we=>we.tileID)}resize(o,g){this.width=o,this.height=g,this.pixelsToGLUnits=[2/o,-2/g],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const g=p.clamp(o.lat,-this.maxValidLatitude,this.maxValidLatitude);return new p.pointGeometry(p.mercatorXfromLng(o.lng)*this.worldSize,p.mercatorYfromLat(g)*this.worldSize)}unproject(o){return new p.MercatorCoordinate(o.x/this.worldSize,o.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(o,g){const I=this.pointCoordinate(g),A=this.pointCoordinate(this.centerPoint),M=this.locationCoordinate(o),F=new p.MercatorCoordinate(M.x-(I.x-A.x),M.y-(I.y-A.y));this.center=this.coordinateLocation(F),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(o){return this.coordinatePoint(this.locationCoordinate(o))}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}locationCoordinate(o){return p.MercatorCoordinate.fromLngLat(o)}coordinateLocation(o){return o.toLngLat()}pointCoordinate(o){const g=[o.x,o.y,0,1],I=[o.x,o.y,1,1];p.transformMat4(g,g,this.pixelMatrixInverse),p.transformMat4(I,I,this.pixelMatrixInverse);const A=g[3],M=I[3],F=g[1]/A,Z=I[1]/M,J=g[2]/A,ee=I[2]/M,re=J===ee?0:(0-J)/(ee-J);return new p.MercatorCoordinate(p.number(g[0]/A,I[0]/M,re)/this.worldSize,p.number(F,Z,re)/this.worldSize)}coordinatePoint(o){const g=[o.x*this.worldSize,o.y*this.worldSize,0,1];return p.transformMat4(g,g,this.pixelMatrix),new p.pointGeometry(g[0]/g[3],g[1]/g[3])}getBounds(){return new p.LngLatBounds().extend(this.pointLocation(new p.pointGeometry(0,0))).extend(this.pointLocation(new p.pointGeometry(this.width,0))).extend(this.pointLocation(new p.pointGeometry(this.width,this.height))).extend(this.pointLocation(new p.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new p.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(o){o?(this.lngRange=[o.getWest(),o.getEast()],this.latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(o,g=!1){const I=o.key,A=g?this._alignedPosMatrixCache:this._posMatrixCache;if(A[I])return A[I];const M=o.canonical,F=this.worldSize/this.zoomScale(M.z),Z=M.x+Math.pow(2,M.z)*o.wrap,J=p.identity(new Float64Array(16));return p.translate(J,J,[Z*F,M.y*F,0]),p.scale(J,J,[F/p.EXTENT,F/p.EXTENT,1]),p.multiply(J,g?this.alignedProjMatrix:this.projMatrix,J),A[I]=new Float32Array(J),A[I]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let o,g,I,A,M=-90,F=90,Z=-180,J=180;const ee=this.size,re=this._unmodified;if(this.latRange){const Fe=this.latRange;M=p.mercatorYfromLat(Fe[1])*this.worldSize,F=p.mercatorYfromLat(Fe[0])*this.worldSize,o=F-M<ee.y?ee.y/(F-M):0}if(this.lngRange){const Fe=this.lngRange;Z=p.mercatorXfromLng(Fe[0])*this.worldSize,J=p.mercatorXfromLng(Fe[1])*this.worldSize,g=J-Z<ee.x?ee.x/(J-Z):0}const ue=this.point,xe=Math.max(g||0,o||0);if(xe)return this.center=this.unproject(new p.pointGeometry(g?(J+Z)/2:ue.x,o?(F+M)/2:ue.y)),this.zoom+=this.scaleZoom(xe),this._unmodified=re,void(this._constraining=!1);if(this.latRange){const Fe=ue.y,we=ee.y/2;Fe-we<M&&(A=M+we),Fe+we>F&&(A=F-we)}if(this.lngRange){const Fe=ue.x,we=ee.x/2;Fe-we<Z&&(I=Z+we),Fe+we>J&&(I=J-we)}I===void 0&&A===void 0||(this.center=this.unproject(new p.pointGeometry(I!==void 0?I:ue.x,A!==void 0?A:ue.y))),this._unmodified=re,this._constraining=!1}_calcMatrices(){if(!this.height)return;const o=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const g=Math.PI/2+this._pitch,I=this._fov*(.5+o.y/this.height),A=Math.sin(I)*this.cameraToCenterDistance/Math.sin(p.clamp(Math.PI-g-I,.01,Math.PI-.01)),M=this.point,F=M.x,Z=M.y,J=1.01*(Math.cos(Math.PI/2-this._pitch)*A+this.cameraToCenterDistance),ee=this.height/50;let re=new Float64Array(16);p.perspective(re,this._fov,this.width/this.height,ee,J),re[8]=2*-o.x/this.width,re[9]=2*o.y/this.height,p.scale(re,re,[1,-1,1]),p.translate(re,re,[0,0,-this.cameraToCenterDistance]),p.rotateX(re,re,this._pitch),p.rotateZ(re,re,this.angle),p.translate(re,re,[-F,-Z,0]),this.mercatorMatrix=p.scale([],re,[this.worldSize,this.worldSize,this.worldSize]),p.scale(re,re,[1,1,p.mercatorZfromAltitude(1,this.center.lat)*this.worldSize]),this.projMatrix=re,this.invProjMatrix=p.invert([],this.projMatrix);const ue=this.width%2/2,xe=this.height%2/2,Fe=Math.cos(this.angle),we=Math.sin(this.angle),Oe=F-Math.round(F)+Fe*ue+we*xe,Je=Z-Math.round(Z)+Fe*xe+we*ue,Xe=new Float64Array(re);if(p.translate(Xe,Xe,[Oe>.5?Oe-1:Oe,Je>.5?Je-1:Je,0]),this.alignedProjMatrix=Xe,re=p.create(),p.scale(re,re,[this.width/2,-this.height/2,1]),p.translate(re,re,[1,-1,0]),this.labelPlaneMatrix=re,re=p.create(),p.scale(re,re,[1,-1,1]),p.translate(re,re,[-1,-1,0]),p.scale(re,re,[2/this.width,2/this.height,1]),this.glCoordMatrix=re,this.pixelMatrix=p.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),re=p.invert(new Float64Array(16),this.pixelMatrix),!re)throw new Error("failed to invert matrix");this.pixelMatrixInverse=re,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const o=this.pointCoordinate(new p.pointGeometry(0,0)),g=[o.x*this.worldSize,o.y*this.worldSize,0,1];return p.transformMat4(g,g,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new p.pointGeometry(0,o))}getCameraQueryGeometry(o){const g=this.getCameraPoint();if(o.length===1)return[o[0],g];{let I=g.x,A=g.y,M=g.x,F=g.y;for(const Z of o)I=Math.min(I,Z.x),A=Math.min(A,Z.y),M=Math.max(M,Z.x),F=Math.max(F,Z.y);return[new p.pointGeometry(I,A),new p.pointGeometry(M,A),new p.pointGeometry(M,F),new p.pointGeometry(I,F),new p.pointGeometry(I,A)]}}}class vl{constructor(o){this._hashName=o&&encodeURIComponent(o),p.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(g,I){let A=!1,M=null;const F=()=>{M=null,A&&(g(),M=setTimeout(F,300),A=!1)};return()=>(A=!0,M||F(),M)}(this._updateHashUnthrottled.bind(this))}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(o){const g=this._map.getCenter(),I=Math.round(100*this._map.getZoom())/100,A=Math.ceil((I*Math.LN2+Math.log(512/360/.5))/Math.LN10),M=Math.pow(10,A),F=Math.round(g.lng*M)/M,Z=Math.round(g.lat*M)/M,J=this._map.getBearing(),ee=this._map.getPitch();let re="";if(re+=o?`/${F}/${Z}/${I}`:`${I}/${Z}/${F}`,(J||ee)&&(re+="/"+Math.round(10*J)/10),ee&&(re+=`/${Math.round(ee)}`),this._hashName){const ue=this._hashName;let xe=!1;const Fe=window.location.hash.slice(1).split("&").map(we=>{const Oe=we.split("=")[0];return Oe===ue?(xe=!0,`${Oe}=${re}`):we}).filter(we=>we);return xe||Fe.push(`${ue}=${re}`),`#${Fe.join("&")}`}return`#${re}`}_getCurrentHash(){const o=window.location.hash.replace("#","");if(this._hashName){let g;return o.split("&").map(I=>I.split("=")).forEach(I=>{I[0]===this._hashName&&(g=I)}),(g&&g[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._getCurrentHash();if(o.length>=3&&!o.some(g=>isNaN(g))){const g=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:g,pitch:+(o[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,o)}catch{}}}const Ls={linearity:.3,easing:p.bezier(0,0,.3,1)},Pu=p.extend({deceleration:2500,maxSpeed:1400},Ls),Ql=p.extend({deceleration:20,maxSpeed:1400},Ls),jc=p.extend({deceleration:1e3,maxSpeed:360},Ls),hs=p.extend({deceleration:1e3,maxSpeed:90},Ls);class Mu{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:p.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,g=p.exported.now();for(;o.length>0&&g-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const g={zoom:0,bearing:0,pitch:0,pan:new p.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:M}of this._inertiaBuffer)g.zoom+=M.zoomDelta||0,g.bearing+=M.bearingDelta||0,g.pitch+=M.pitchDelta||0,M.panDelta&&g.pan._add(M.panDelta),M.around&&(g.around=M.around),M.pinchAround&&(g.pinchAround=M.pinchAround);const I=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,A={};if(g.pan.mag()){const M=bl(g.pan.mag(),I,p.extend({},Pu,o||{}));A.offset=g.pan.mult(M.amount/g.pan.mag()),A.center=this._map.transform.center,xl(A,M)}if(g.zoom){const M=bl(g.zoom,I,Ql);A.zoom=this._map.transform.zoom+M.amount,xl(A,M)}if(g.bearing){const M=bl(g.bearing,I,jc);A.bearing=this._map.transform.bearing+p.clamp(M.amount,-179,179),xl(A,M)}if(g.pitch){const M=bl(g.pitch,I,hs);A.pitch=this._map.transform.pitch+M.amount,xl(A,M)}if(A.zoom||A.bearing){const M=g.pinchAround===void 0?g.around:g.pinchAround;A.around=M?this._map.unproject(M):this._map.getCenter()}return this.clear(),p.extend(A,{noMoveStart:!0})}}function xl(T,o){(!T.duration||T.duration<o.duration)&&(T.duration=o.duration,T.easing=o.easing)}function bl(T,o,g){const{maxSpeed:I,linearity:A,deceleration:M}=g,F=p.clamp(T*A/(o/1e3),-I,I),Z=Math.abs(F)/(M*A);return{easing:g.easing,duration:1e3*Z,amount:F*(Z/2)}}class zo extends p.Event{constructor(o,g,I,A={}){const M=X.mousePos(g.getCanvasContainer(),I),F=g.unproject(M);super(o,p.extend({point:M,lngLat:F,originalEvent:I},A)),this._defaultPrevented=!1,this.target=g}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Po extends p.Event{constructor(o,g,I){const A=o==="touchend"?I.changedTouches:I.touches,M=X.touchPos(g.getCanvasContainer(),A),F=M.map(J=>g.unproject(J)),Z=M.reduce((J,ee,re,ue)=>J.add(ee.div(ue.length)),new p.pointGeometry(0,0));super(o,{points:M,point:Z,lngLats:F,lngLat:g.unproject(Z),originalEvent:I}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class uc extends p.Event{constructor(o,g,I){super(o,{originalEvent:I}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class ps{constructor(o,g){this._map=o,this._clickTolerance=g.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new uc(o.type,this._map,o))}mousedown(o,g){return this._mousedownPos=g,this._firePreventable(new zo(o.type,this._map,o))}mouseup(o){this._map.fire(new zo(o.type,this._map,o))}click(o,g){this._mousedownPos&&this._mousedownPos.dist(g)>=this._clickTolerance||this._map.fire(new zo(o.type,this._map,o))}dblclick(o){return this._firePreventable(new zo(o.type,this._map,o))}mouseover(o){this._map.fire(new zo(o.type,this._map,o))}mouseout(o){this._map.fire(new zo(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Po(o.type,this._map,o))}touchmove(o){this._map.fire(new Po(o.type,this._map,o))}touchend(o){this._map.fire(new Po(o.type,this._map,o))}touchcancel(o){this._map.fire(new Po(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wl{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(o){this._map.fire(new zo(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new zo(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class $s{constructor(o,g){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=g.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,g){this.isEnabled()&&o.shiftKey&&o.button===0&&(X.disableDrag(),this._startPos=this._lastPos=g,this._active=!0)}mousemoveWindow(o,g){if(!this._active)return;const I=g;if(this._lastPos.equals(I)||!this._box&&I.dist(this._startPos)<this._clickTolerance)return;const A=this._startPos;this._lastPos=I,this._box||(this._box=X.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const M=Math.min(A.x,I.x),F=Math.max(A.x,I.x),Z=Math.min(A.y,I.y),J=Math.max(A.y,I.y);X.setTransform(this._box,`translate(${M}px,${Z}px)`),this._box.style.width=F-M+"px",this._box.style.height=J-Z+"px"}mouseupWindow(o,g){if(!this._active||o.button!==0)return;const I=this._startPos,A=g;if(this.reset(),X.suppressClick(),I.x!==A.x||I.y!==A.y)return this._map.fire(new p.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:M=>M.fitScreenCoordinates(I,A,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(X.remove(this._box),this._box=null),X.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,g){return this._map.fire(new p.Event(o,{originalEvent:g}))}}function pa(T,o){const g={};for(let I=0;I<T.length;I++)g[T[I].identifier]=o[I];return g}class sn{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,g,I){(this.centroid||I.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),I.length===this.numTouches&&(this.centroid=function(A){const M=new p.pointGeometry(0,0);for(const F of A)M._add(F);return M.div(A.length)}(g),this.touches=pa(I,g)))}touchmove(o,g,I){if(this.aborted||!this.centroid)return;const A=pa(I,g);for(const M in this.touches){const F=this.touches[M],Z=A[M];(!Z||Z.dist(F)>30)&&(this.aborted=!0)}}touchend(o,g,I){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),I.length===0){const A=!this.aborted&&this.centroid;if(this.reset(),A)return A}}}class El{constructor(o){this.singleTap=new sn(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,g,I){this.singleTap.touchstart(o,g,I)}touchmove(o,g,I){this.singleTap.touchmove(o,g,I)}touchend(o,g,I){const A=this.singleTap.touchend(o,g,I);if(A){const M=o.timeStamp-this.lastTime<500,F=!this.lastTap||this.lastTap.dist(A)<30;if(M&&F||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=A,this.count===this.numTaps)return this.reset(),A}}}class Qs{constructor(){this._zoomIn=new El({numTouches:1,numTaps:2}),this._zoomOut=new El({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,g,I){this._zoomIn.touchstart(o,g,I),this._zoomOut.touchstart(o,g,I)}touchmove(o,g,I){this._zoomIn.touchmove(o,g,I),this._zoomOut.touchmove(o,g,I)}touchend(o,g,I){const A=this._zoomIn.touchend(o,g,I),M=this._zoomOut.touchend(o,g,I);return A?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:F.getZoom()+1,around:F.unproject(A)},{originalEvent:o})}):M?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:F.getZoom()-1,around:F.unproject(M)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const ds={0:1,2:2};class tr{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(o,g){return!1}_move(o,g){return{}}mousedown(o,g){if(this._lastPoint)return;const I=X.mouseButton(o);this._correctButton(o,I)&&(this._lastPoint=g,this._eventButton=I)}mousemoveWindow(o,g){const I=this._lastPoint;if(I){if(o.preventDefault(),function(A,M){const F=ds[M];return A.buttons===void 0||(A.buttons&F)!==F}(o,this._eventButton))this.reset();else if(this._moved||!(g.dist(I)<this._clickTolerance))return this._moved=!0,this._lastPoint=g,this._move(I,g)}}mouseupWindow(o){this._lastPoint&&X.mouseButton(o)===this._eventButton&&(this._moved&&X.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Mr extends tr{mousedown(o,g){super.mousedown(o,g),this._lastPoint&&(this._active=!0)}_correctButton(o,g){return g===0&&!o.ctrlKey}_move(o,g){return{around:g,panDelta:g.sub(o)}}}class ti extends tr{_correctButton(o,g){return g===0&&o.ctrlKey||g===2}_move(o,g){const I=.8*(g.x-o.x);if(I)return this._active=!0,{bearingDelta:I}}contextmenu(o){o.preventDefault()}}class el extends tr{_correctButton(o,g){return g===0&&o.ctrlKey||g===2}_move(o,g){const I=-.5*(g.y-o.y);if(I)return this._active=!0,{pitchDelta:I}}contextmenu(o){o.preventDefault()}}class Xa{constructor(o){this._minTouches=1,this._clickTolerance=o.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new p.pointGeometry(0,0)}touchstart(o,g,I){return this._calculateTransform(o,g,I)}touchmove(o,g,I){if(this._active&&!(I.length<this._minTouches))return o.preventDefault(),this._calculateTransform(o,g,I)}touchend(o,g,I){this._calculateTransform(o,g,I),this._active&&I.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,g,I){I.length>0&&(this._active=!0);const A=pa(I,g),M=new p.pointGeometry(0,0),F=new p.pointGeometry(0,0);let Z=0;for(const ee in A){const re=A[ee],ue=this._touches[ee];ue&&(M._add(re),F._add(re.sub(ue)),Z++,A[ee]=re)}if(this._touches=A,Z<this._minTouches||!F.mag())return;const J=F.div(Z);return this._sum._add(J),this._sum.mag()<this._clickTolerance?void 0:{around:M.div(Z),panDelta:J}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pa{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(o){}_move(o,g,I){return{}}touchstart(o,g,I){this._firstTwoTouches||I.length<2||(this._firstTwoTouches=[I[0].identifier,I[1].identifier],this._start([g[0],g[1]]))}touchmove(o,g,I){if(!this._firstTwoTouches)return;o.preventDefault();const[A,M]=this._firstTwoTouches,F=eu(I,g,A),Z=eu(I,g,M);if(!F||!Z)return;const J=this._aroundCenter?null:F.add(Z).div(2);return this._move([F,Z],J,o)}touchend(o,g,I){if(!this._firstTwoTouches)return;const[A,M]=this._firstTwoTouches,F=eu(I,g,A),Z=eu(I,g,M);F&&Z||(this._active&&X.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function eu(T,o,g){for(let I=0;I<T.length;I++)if(T[I].identifier===g)return o[I]}function ai(T,o){return Math.log(T/o)/Math.LN2}class tl extends Pa{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,g){const I=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(ai(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ai(this._distance,I),pinchAround:g}}}function Sl(T,o){return 180*T.angleWith(o)/Math.PI}class fs extends Pa{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,g){const I=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Sl(this._vector,I),pinchAround:g}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const g=25/(Math.PI*this._minDiameter)*360,I=Sl(o,this._startVector);return Math.abs(I)<g}}function pn(T){return Math.abs(T.y)>Math.abs(T.x)}class Il extends Pa{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(o){this._lastPoints=o,pn(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,g,I){const A=o[0].sub(this._lastPoints[0]),M=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(A,M,I.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(A.y+M.y)/2*-.5}}gestureBeginsVertically(o,g,I){if(this._valid!==void 0)return this._valid;const A=o.mag()>=2,M=g.mag()>=2;if(!A&&!M)return;if(!A||!M)return this._firstMove===void 0&&(this._firstMove=I),I-this._firstMove<100&&void 0;const F=o.y>0==g.y>0;return pn(o)&&pn(g)&&F}}const cc={panStep:100,bearingStep:15,pitchStep:10};class zn{constructor(){const o=cc;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let g=0,I=0,A=0,M=0,F=0;switch(o.keyCode){case 61:case 107:case 171:case 187:g=1;break;case 189:case 109:case 173:g=-1;break;case 37:o.shiftKey?I=-1:(o.preventDefault(),M=-1);break;case 39:o.shiftKey?I=1:(o.preventDefault(),M=1);break;case 38:o.shiftKey?A=1:(o.preventDefault(),F=-1);break;case 40:o.shiftKey?A=-1:(o.preventDefault(),F=1);break;default:return}return this._rotationDisabled&&(I=0,A=0),{cameraAnimation:Z=>{const J=Z.getZoom();Z.easeTo({duration:300,easeId:"keyboardHandler",easing:ui,zoom:g?Math.round(J)+g*(o.shiftKey?2:1):J,bearing:Z.getBearing()+I*this._bearingStep,pitch:Z.getPitch()+A*this._pitchStep,offset:[-M*this._panStep,-F*this._panStep],center:Z.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ui(T){return T*(2-T)}const So=4.000244140625;class Tl{constructor(o,g){this._map=o,this._el=o.getCanvasContainer(),this._handler=g,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,p.bindAll(["_onTimeout"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(o){if(!this.isEnabled())return;let g=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const I=p.exported.now(),A=I-(this._lastWheelEventTime||0);this._lastWheelEventTime=I,g!==0&&g%So==0?this._type="wheel":g!==0&&Math.abs(g)<4?this._type="trackpad":A>400?(this._type=null,this._lastValue=g,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(A*g)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,g+=this._lastValue)),o.shiftKey&&g&&(g/=4),this._type&&(this._lastWheelEvent=o,this._delta-=g,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const g=X.mousePos(this._el,o);this._around=p.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(g)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;if(this._delta!==0){const Z=this._type==="wheel"&&Math.abs(this._delta)>So?this._wheelZoomRate:this._defaultZoomRate;let J=2/(1+Math.exp(-Math.abs(this._delta*Z)));this._delta<0&&J!==0&&(J=1/J);const ee=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):o.scale;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(ee*J))),this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:o.zoom,I=this._startZoom,A=this._easing;let M,F=!1;if(this._type==="wheel"&&I&&A){const Z=Math.min((p.exported.now()-this._lastWheelEventTime)/200,1),J=A(Z);M=p.number(I,g,J),Z<1?this._frameId||(this._frameId=!0):F=!0}else M=g,F=!0;return this._active=!0,F&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!F,zoomDelta:M-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let g=p.ease;if(this._prevEase){const I=this._prevEase,A=(p.exported.now()-I.start)/I.duration,M=I.easing(A+.01)-I.easing(A),F=.27/Math.sqrt(M*M+1e-4)*.01,Z=Math.sqrt(.0729-F*F);g=p.bezier(F,Z,.25,1)}return this._prevEase={start:p.exported.now(),duration:o,easing:g},g}reset(){this._active=!1}}class Ds{constructor(o,g){this._clickZoom=o,this._tapZoom=g}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class da{constructor(){this.reset()}reset(){this._active=!1}dblclick(o,g){return o.preventDefault(),{cameraAnimation:I=>{I.easeTo({duration:300,zoom:I.getZoom()+(o.shiftKey?-1:1),around:I.unproject(g)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ln{constructor(){this._tap=new El({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(o,g,I){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?I.length>0&&(this._swipePoint=g[0],this._swipeTouch=I[0].identifier):this._tap.touchstart(o,g,I))}touchmove(o,g,I){if(this._tapTime){if(this._swipePoint){if(I[0].identifier!==this._swipeTouch)return;const A=g[0],M=A.y-this._swipePoint.y;return this._swipePoint=A,o.preventDefault(),this._active=!0,{zoomDelta:M/128}}}else this._tap.touchmove(o,g,I)}touchend(o,g,I){this._tapTime?this._swipePoint&&I.length===0&&this.reset():this._tap.touchend(o,g,I)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ka{constructor(o,g,I){this._el=o,this._mousePan=g,this._touchPan=I}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Wt{constructor(o,g,I){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=g,this._mousePitch=I}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class tu{constructor(o,g,I,A){this._el=o,this._touchZoom=g,this._touchRotate=I,this._tapDragZoom=A,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ms=T=>T.zoom||T.drag||T.pitch||T.rotate;class iu extends p.Event{}function jo(T){return T.panDelta&&T.panDelta.mag()||T.zoomDelta||T.bearingDelta||T.pitchDelta}class dn{constructor(o,g){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Mu(o),this._bearingSnap=g.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(g),p.bindAll(["handleEvent","handleWindowEvent"],this);const I=this._el;this._listeners=[[I,"touchstart",{passive:!0}],[I,"touchmove",{passive:!1}],[I,"touchend",void 0],[I,"touchcancel",void 0],[I,"mousedown",void 0],[I,"mousemove",void 0],[I,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[I,"mouseover",void 0],[I,"mouseout",void 0],[I,"dblclick",void 0],[I,"click",void 0],[I,"keydown",{capture:!1}],[I,"keyup",void 0],[I,"wheel",{passive:!1}],[I,"contextmenu",void 0],[window,"blur",void 0]];for(const[A,M,F]of this._listeners)X.addEventListener(A,M,A===document?this.handleWindowEvent:this.handleEvent,F)}destroy(){for(const[o,g,I]of this._listeners)X.removeEventListener(o,g,o===document?this.handleWindowEvent:this.handleEvent,I)}_addDefaultHandlers(o){const g=this._map,I=g.getCanvasContainer();this._add("mapEvent",new ps(g,o));const A=g.boxZoom=new $s(g,o);this._add("boxZoom",A);const M=new Qs,F=new da;g.doubleClickZoom=new Ds(F,M),this._add("tapZoom",M),this._add("clickZoom",F);const Z=new ln;this._add("tapDragZoom",Z);const J=g.touchPitch=new Il;this._add("touchPitch",J);const ee=new ti(o),re=new el(o);g.dragRotate=new Wt(o,ee,re),this._add("mouseRotate",ee,["mousePitch"]),this._add("mousePitch",re,["mouseRotate"]);const ue=new Mr(o),xe=new Xa(o);g.dragPan=new Ka(I,ue,xe),this._add("mousePan",ue),this._add("touchPan",xe,["touchZoom","touchRotate"]);const Fe=new fs,we=new tl;g.touchZoomRotate=new tu(I,we,Fe,Z),this._add("touchRotate",Fe,["touchPan","touchZoom"]),this._add("touchZoom",we,["touchPan","touchRotate"]);const Oe=g.scrollZoom=new Tl(g,this);this._add("scrollZoom",Oe,["mousePan"]);const Je=g.keyboard=new zn;this._add("keyboard",Je),this._add("blockableMapEvent",new wl(g));for(const Xe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[Xe]&&g[Xe].enable(o[Xe])}_add(o,g,I){this._handlers.push({handlerName:o,handler:g,allowed:I}),this._handlersById[o]=g}stop(o){if(!this._updatingCamera){for(const{handler:g}of this._handlers)g.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(ms(this._eventsInProgress))||this.isZooming()}_blockedByActive(o,g,I){for(const A in o)if(A!==I&&(!g||g.indexOf(A)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const g=[];for(const I of o)this._el.contains(I.target)&&g.push(I);return g}handleEvent(o,g){if(o.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const I=o.type==="renderFrame"?void 0:o,A={needsRenderFrame:!1},M={},F={},Z=o.touches,J=Z?this._getMapTouches(Z):void 0,ee=J?X.touchPos(this._el,J):X.mousePos(this._el,o);for(const{handlerName:xe,handler:Fe,allowed:we}of this._handlers){if(!Fe.isEnabled())continue;let Oe;this._blockedByActive(F,we,xe)?Fe.reset():Fe[g||o.type]&&(Oe=Fe[g||o.type](o,ee,J),this.mergeHandlerResult(A,M,Oe,xe,I),Oe&&Oe.needsRenderFrame&&this._triggerRenderFrame()),(Oe||Fe.isActive())&&(F[xe]=Fe)}const re={};for(const xe in this._previousActiveHandlers)F[xe]||(re[xe]=I);this._previousActiveHandlers=F,(Object.keys(re).length||jo(A))&&(this._changes.push([A,M,re]),this._triggerRenderFrame()),(Object.keys(F).length||jo(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ue}=A;ue&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ue(this._map))}mergeHandlerResult(o,g,I,A,M){if(!I)return;p.extend(o,I);const F={handlerName:A,originalEvent:I.originalEvent||M};I.zoomDelta!==void 0&&(g.zoom=F),I.panDelta!==void 0&&(g.drag=F),I.pitchDelta!==void 0&&(g.pitch=F),I.bearingDelta!==void 0&&(g.rotate=F)}_applyChanges(){const o={},g={},I={};for(const[A,M,F]of this._changes)A.panDelta&&(o.panDelta=(o.panDelta||new p.pointGeometry(0,0))._add(A.panDelta)),A.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+A.zoomDelta),A.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+A.bearingDelta),A.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+A.pitchDelta),A.around!==void 0&&(o.around=A.around),A.pinchAround!==void 0&&(o.pinchAround=A.pinchAround),A.noInertia&&(o.noInertia=A.noInertia),p.extend(g,M),p.extend(I,F);this._updateMapTransform(o,g,I),this._changes=[]}_updateMapTransform(o,g,I){const A=this._map,M=A.transform;if(!jo(o))return this._fireEvents(g,I,!0);let{panDelta:F,zoomDelta:Z,bearingDelta:J,pitchDelta:ee,around:re,pinchAround:ue}=o;ue!==void 0&&(re=ue),A._stop(!0),re=re||A.transform.centerPoint;const xe=M.pointLocation(F?re.sub(F):re);J&&(M.bearing+=J),ee&&(M.pitch+=ee),Z&&(M.zoom+=Z),M.setLocationAtPoint(xe,re),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(g,I,!0)}_fireEvents(o,g,I){const A=ms(this._eventsInProgress),M=ms(o),F={};for(const re in o){const{originalEvent:ue}=o[re];this._eventsInProgress[re]||(F[`${re}start`]=ue),this._eventsInProgress[re]=o[re]}!A&&M&&this._fireEvent("movestart",M.originalEvent);for(const re in F)this._fireEvent(re,F[re]);M&&this._fireEvent("move",M.originalEvent);for(const re in o){const{originalEvent:ue}=o[re];this._fireEvent(re,ue)}const Z={};let J;for(const re in this._eventsInProgress){const{handlerName:ue,originalEvent:xe}=this._eventsInProgress[re];this._handlersById[ue].isActive()||(delete this._eventsInProgress[re],J=g[ue]||xe,Z[`${re}end`]=J)}for(const re in Z)this._fireEvent(re,Z[re]);const ee=ms(this._eventsInProgress);if(I&&(A||M)&&!ee){this._updatingCamera=!0;const re=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ue=xe=>xe!==0&&-this._bearingSnap<xe&&xe<this._bearingSnap;re?(ue(re.bearing||this._map.getBearing())&&(re.bearing=0),this._map.easeTo(re,{originalEvent:J})):(this._map.fire(new p.Event("moveend",{originalEvent:J})),ue(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,g){this._map.fire(new p.Event(o,g?{originalEvent:g}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new iu("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const rn={extend:(T,...o)=>p.extend(T,...o),run(T){T()},logToElement(T,o=!1,g="log"){const I=window.document.getElementById(g);I&&(o&&(I.innerHTML=""),I.innerHTML+=`<br>${T}`)}};class il extends p.Evented{constructor(o,g){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=g.bearingSnap,p.bindAll(["_renderFrameCallback"],this)}getCenter(){return new p.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,g){return this.jumpTo({center:o},g)}panBy(o,g,I){return o=p.pointGeometry.convert(o).mult(-1),this.panTo(this.transform.center,p.extend({offset:o},g),I)}panTo(o,g,I){return this.easeTo(p.extend({center:o},g),I)}getZoom(){return this.transform.zoom}setZoom(o,g){return this.jumpTo({zoom:o},g),this}zoomTo(o,g,I){return this.easeTo(p.extend({zoom:o},g),I)}zoomIn(o,g){return this.zoomTo(this.getZoom()+1,o,g),this}zoomOut(o,g){return this.zoomTo(this.getZoom()-1,o,g),this}getBearing(){return this.transform.bearing}setBearing(o,g){return this.jumpTo({bearing:o},g),this}getPadding(){return this.transform.padding}setPadding(o,g){return this.jumpTo({padding:o},g),this}rotateTo(o,g,I){return this.easeTo(p.extend({bearing:o},g),I)}resetNorth(o,g){return this.rotateTo(0,p.extend({duration:1e3},o),g),this}resetNorthPitch(o,g){return this.easeTo(p.extend({bearing:0,pitch:0,duration:1e3},o),g),this}snapToNorth(o,g){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,g):this}getPitch(){return this.transform.pitch}setPitch(o,g){return this.jumpTo({pitch:o},g),this}cameraForBounds(o,g){o=p.LngLatBounds.convert(o);const I=g&&g.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),I,g)}_cameraForBoxAndBearing(o,g,I,A){const M={top:0,bottom:0,right:0,left:0};if(typeof(A=p.extend({padding:M,offset:[0,0],maxZoom:this.transform.maxZoom},A)).padding=="number"){const dt=A.padding;A.padding={top:dt,bottom:dt,right:dt,left:dt}}A.padding=p.extend(M,A.padding);const F=this.transform,Z=F.padding,J=F.project(p.LngLat.convert(o)),ee=F.project(p.LngLat.convert(g)),re=J.rotate(-I*Math.PI/180),ue=ee.rotate(-I*Math.PI/180),xe=new p.pointGeometry(Math.max(re.x,ue.x),Math.max(re.y,ue.y)),Fe=new p.pointGeometry(Math.min(re.x,ue.x),Math.min(re.y,ue.y)),we=xe.sub(Fe),Oe=(F.width-(Z.left+Z.right+A.padding.left+A.padding.right))/we.x,Je=(F.height-(Z.top+Z.bottom+A.padding.top+A.padding.bottom))/we.y;if(Je<0||Oe<0)return void p.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Xe=Math.min(F.scaleZoom(F.scale*Math.min(Oe,Je)),A.maxZoom),nt=p.pointGeometry.convert(A.offset),$e=new p.pointGeometry((A.padding.left-A.padding.right)/2,(A.padding.top-A.padding.bottom)/2).rotate(I*Math.PI/180),wt=nt.add($e).mult(F.scale/F.zoomScale(Xe));return{center:F.unproject(J.add(ee).div(2).sub(wt)),zoom:Xe,bearing:I}}fitBounds(o,g,I){return this._fitInternal(this.cameraForBounds(o,g),g,I)}fitScreenCoordinates(o,g,I,A,M){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(p.pointGeometry.convert(o)),this.transform.pointLocation(p.pointGeometry.convert(g)),I,A),A,M)}_fitInternal(o,g,I){return o?(delete(g=p.extend(o,g)).padding,g.linear?this.easeTo(g,I):this.flyTo(g,I)):this}jumpTo(o,g){this.stop();const I=this.transform;let A=!1,M=!1,F=!1;return"zoom"in o&&I.zoom!==+o.zoom&&(A=!0,I.zoom=+o.zoom),o.center!==void 0&&(I.center=p.LngLat.convert(o.center)),"bearing"in o&&I.bearing!==+o.bearing&&(M=!0,I.bearing=+o.bearing),"pitch"in o&&I.pitch!==+o.pitch&&(F=!0,I.pitch=+o.pitch),o.padding==null||I.isPaddingEqual(o.padding)||(I.padding=o.padding),this.fire(new p.Event("movestart",g)).fire(new p.Event("move",g)),A&&this.fire(new p.Event("zoomstart",g)).fire(new p.Event("zoom",g)).fire(new p.Event("zoomend",g)),M&&this.fire(new p.Event("rotatestart",g)).fire(new p.Event("rotate",g)).fire(new p.Event("rotateend",g)),F&&this.fire(new p.Event("pitchstart",g)).fire(new p.Event("pitch",g)).fire(new p.Event("pitchend",g)),this.fire(new p.Event("moveend",g))}easeTo(o,g){this._stop(!1,o.easeId),((o=p.extend({offset:[0,0],duration:500,easing:p.ease},o)).animate===!1||!o.essential&&p.exported.prefersReducedMotion)&&(o.duration=0);const I=this.transform,A=this.getZoom(),M=this.getBearing(),F=this.getPitch(),Z=this.getPadding(),J="zoom"in o?+o.zoom:A,ee="bearing"in o?this._normalizeBearing(o.bearing,M):M,re="pitch"in o?+o.pitch:F,ue="padding"in o?o.padding:I.padding,xe=p.pointGeometry.convert(o.offset);let Fe=I.centerPoint.add(xe);const we=I.pointLocation(Fe),Oe=p.LngLat.convert(o.center||we);this._normalizeCenter(Oe);const Je=I.project(we),Xe=I.project(Oe).sub(Je),nt=I.zoomScale(J-A);let $e,wt;o.around&&($e=p.LngLat.convert(o.around),wt=I.locationPoint($e));const dt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||J!==A,this._rotating=this._rotating||M!==ee,this._pitching=this._pitching||re!==F,this._padding=!I.isPaddingEqual(ue),this._easeId=o.easeId,this._prepareEase(g,o.noMoveStart,dt),this._ease(yt=>{if(this._zooming&&(I.zoom=p.number(A,J,yt)),this._rotating&&(I.bearing=p.number(M,ee,yt)),this._pitching&&(I.pitch=p.number(F,re,yt)),this._padding&&(I.interpolatePadding(Z,ue,yt),Fe=I.centerPoint.add(xe)),$e)I.setLocationAtPoint($e,wt);else{const Lt=I.zoomScale(I.zoom-A),Nt=J>A?Math.min(2,nt):Math.max(.5,nt),St=Math.pow(Nt,1-yt),mi=I.unproject(Je.add(Xe.mult(yt*St)).mult(Lt));I.setLocationAtPoint(I.renderWorldCopies?mi.wrap():mi,Fe)}this._fireMoveEvents(g)},yt=>{this._afterEase(g,yt)},o),this}_prepareEase(o,g,I={}){this._moving=!0,g||I.moving||this.fire(new p.Event("movestart",o)),this._zooming&&!I.zooming&&this.fire(new p.Event("zoomstart",o)),this._rotating&&!I.rotating&&this.fire(new p.Event("rotatestart",o)),this._pitching&&!I.pitching&&this.fire(new p.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new p.Event("move",o)),this._zooming&&this.fire(new p.Event("zoom",o)),this._rotating&&this.fire(new p.Event("rotate",o)),this._pitching&&this.fire(new p.Event("pitch",o))}_afterEase(o,g){if(this._easeId&&g&&this._easeId===g)return;delete this._easeId;const I=this._zooming,A=this._rotating,M=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,I&&this.fire(new p.Event("zoomend",o)),A&&this.fire(new p.Event("rotateend",o)),M&&this.fire(new p.Event("pitchend",o)),this.fire(new p.Event("moveend",o))}flyTo(o,g){if(!o.essential&&p.exported.prefersReducedMotion){const d=p.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(d,g)}this.stop(),o=p.extend({offset:[0,0],speed:1.2,curve:1.42,easing:p.ease},o);const I=this.transform,A=this.getZoom(),M=this.getBearing(),F=this.getPitch(),Z=this.getPadding(),J="zoom"in o?p.clamp(+o.zoom,I.minZoom,I.maxZoom):A,ee="bearing"in o?this._normalizeBearing(o.bearing,M):M,re="pitch"in o?+o.pitch:F,ue="padding"in o?o.padding:I.padding,xe=I.zoomScale(J-A),Fe=p.pointGeometry.convert(o.offset);let we=I.centerPoint.add(Fe);const Oe=I.pointLocation(we),Je=p.LngLat.convert(o.center||Oe);this._normalizeCenter(Je);const Xe=I.project(Oe),nt=I.project(Je).sub(Xe);let $e=o.curve;const wt=Math.max(I.width,I.height),dt=wt/xe,yt=nt.mag();if("minZoom"in o){const d=p.clamp(Math.min(o.minZoom,A,J),I.minZoom,I.maxZoom),x=wt/I.zoomScale(d-A);$e=Math.sqrt(x/yt*2)}const Lt=$e*$e;function Nt(d){const x=(dt*dt-wt*wt+(d?-1:1)*Lt*Lt*yt*yt)/(2*(d?dt:wt)*Lt*yt);return Math.log(Math.sqrt(x*x+1)-x)}function St(d){return(Math.exp(d)-Math.exp(-d))/2}function mi(d){return(Math.exp(d)+Math.exp(-d))/2}const ni=Nt(0);let qi=function(d){return mi(ni)/mi(ni+$e*d)},c=function(d){return wt*((mi(ni)*(St(x=ni+$e*d)/mi(x))-St(ni))/Lt)/yt;var x},m=(Nt(1)-ni)/$e;if(Math.abs(yt)<1e-6||!isFinite(m)){if(Math.abs(wt-dt)<1e-6)return this.easeTo(o,g);const d=dt<wt?-1:1;m=Math.abs(Math.log(dt/wt))/$e,c=function(){return 0},qi=function(x){return Math.exp(d*$e*x)}}return o.duration="duration"in o?+o.duration:1e3*m/("screenSpeed"in o?+o.screenSpeed/$e:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=M!==ee,this._pitching=re!==F,this._padding=!I.isPaddingEqual(ue),this._prepareEase(g,!1),this._ease(d=>{const x=d*m,k=1/qi(x);I.zoom=d===1?J:A+I.scaleZoom(k),this._rotating&&(I.bearing=p.number(M,ee,d)),this._pitching&&(I.pitch=p.number(F,re,d)),this._padding&&(I.interpolatePadding(Z,ue,d),we=I.centerPoint.add(Fe));const D=d===1?Je:I.unproject(Xe.add(nt.mult(c(x))).mult(k));I.setLocationAtPoint(I.renderWorldCopies?D.wrap():D,we),this._fireMoveEvents(g)},()=>this._afterEase(g),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,g){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const I=this._onEaseEnd;delete this._onEaseEnd,I.call(this,g)}if(!o){const I=this.handlers;I&&I.stop(!1)}return this}_ease(o,g,I){I.animate===!1||I.duration===0?(o(1),g()):(this._easeStart=p.exported.now(),this._easeOptions=I,this._onEaseFrame=o,this._onEaseEnd=g,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((p.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,g){o=p.wrap(o,-180,180);const I=Math.abs(o-g);return Math.abs(o-360-g)<I&&(o-=360),Math.abs(o+360-g)<I&&(o+=360),o}_normalizeCenter(o){const g=this.transform;if(!g.renderWorldCopies||g.lngRange)return;const I=o.lng-g.center.lng;o.lng+=I>180?-360:I<-180?360:0}}class Io{constructor(o={}){this.options=o,p.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options&&this.options.compact,this._container=X.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=X.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=X.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){X.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,g){const I=this._map._getUIString(`AttributionControl.${g}`);o.title=I,o.setAttribute("aria-label",I)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(A=>typeof A!="string"?"":A)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const A=this._map.style.stylesheet;this.styleOwner=A.owner,this.styleId=A.id}const g=this._map.style.sourceCaches;for(const A in g){const M=g[A];if(M.used){const F=M.getSource();F.attribution&&o.indexOf(F.attribution)<0&&o.push(F.attribution)}}o=o.filter(A=>String(A).trim()),o.sort((A,M)=>A.length-M.length),o=o.filter((A,M)=>{for(let F=M+1;F<o.length;F++)if(o[F].indexOf(A)>=0)return!1;return!0});const I=o.join(" | ");I!==this._attribHTML&&(this._attribHTML=I,o.length?(this._innerContainer.innerHTML=I,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Ma{constructor(o={}){this.options=o,p.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=X.create("div","maplibregl-ctrl mapboxgl-ctrl");const g=X.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return g.target="_blank",g.rel="noopener nofollow",g.href="https://maplibre.org/",g.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),g.setAttribute("rel","noopener nofollow"),this._container.appendChild(g),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){X.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const o=this._container.children;if(o.length){const g=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&g.classList.add("maplibregl-compact","mapboxgl-compact"):g.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class hc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const g=++this._id;return this._queue.push({callback:o,id:g,cancelled:!1}),g}remove(o){const g=this._currentlyRunning,I=g?this._queue.concat(g):this._queue;for(const A of I)if(A.id===o)return void(A.cancelled=!0)}run(o=0){const g=this._currentlyRunning=this._queue;this._queue=[];for(const I of g)if(!I.cancelled&&(I.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Al={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},pc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},ba={showCompass:!0,showZoom:!0,visualizePitch:!1};class Wo{constructor(o,g,I=!1){this._clickTolerance=10,this.element=g,this.mouseRotate=new ti({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,I&&(this.mousePitch=new el({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),p.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),X.addEventListener(g,"mousedown",this.mousedown),X.addEventListener(g,"touchstart",this.touchstart,{passive:!1}),X.addEventListener(g,"touchmove",this.touchmove),X.addEventListener(g,"touchend",this.touchend),X.addEventListener(g,"touchcancel",this.reset)}down(o,g){this.mouseRotate.mousedown(o,g),this.mousePitch&&this.mousePitch.mousedown(o,g),X.disableDrag()}move(o,g){const I=this.map,A=this.mouseRotate.mousemoveWindow(o,g);if(A&&A.bearingDelta&&I.setBearing(I.getBearing()+A.bearingDelta),this.mousePitch){const M=this.mousePitch.mousemoveWindow(o,g);M&&M.pitchDelta&&I.setPitch(I.getPitch()+M.pitchDelta)}}off(){const o=this.element;X.removeEventListener(o,"mousedown",this.mousedown),X.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),X.removeEventListener(o,"touchmove",this.touchmove),X.removeEventListener(o,"touchend",this.touchend),X.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){X.enableDrag(),X.removeEventListener(window,"mousemove",this.mousemove),X.removeEventListener(window,"mouseup",this.mouseup)}mousedown(o){this.down(p.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),X.mousePos(this.element,o)),X.addEventListener(window,"mousemove",this.mousemove),X.addEventListener(window,"mouseup",this.mouseup)}mousemove(o){this.move(o,X.mousePos(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=X.touchPos(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=X.touchPos(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function ci(T,o,g){if(T=new p.LngLat(T.lng,T.lat),o){const I=new p.LngLat(T.lng-360,T.lat),A=new p.LngLat(T.lng+360,T.lat),M=g.locationPoint(T).distSqr(o);g.locationPoint(I).distSqr(o)<M?T=I:g.locationPoint(A).distSqr(o)<M&&(T=A)}for(;Math.abs(T.lng-g.center.lng)>180;){const I=g.locationPoint(T);if(I.x>=0&&I.y>=0&&I.x<=g.width&&I.y<=g.height)break;T.lng>g.center.lng?T.lng-=360:T.lng+=360}return T}const Vt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Xo(T,o,g){const I=T.classList;for(const A in Vt)I.remove(`maplibregl-${g}-anchor-${A}`,`mapboxgl-${g}-anchor-${A}`);I.add(`maplibregl-${g}-anchor-${o}`,`mapboxgl-${g}-anchor-${o}`)}class Mo extends p.Evented{constructor(o,g){if(super(),(o instanceof HTMLElement||g)&&(o=p.extend({element:o},g)),p.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=p.pointGeometry.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=X.create("div"),this._element.setAttribute("aria-label","Map marker");const I=X.createNS("http://www.w3.org/2000/svg","svg"),A=41,M=27;I.setAttributeNS(null,"display","block"),I.setAttributeNS(null,"height",`${A}px`),I.setAttributeNS(null,"width",`${M}px`),I.setAttributeNS(null,"viewBox",`0 0 ${M} ${A}`);const F=X.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"stroke","none"),F.setAttributeNS(null,"stroke-width","1"),F.setAttributeNS(null,"fill","none"),F.setAttributeNS(null,"fill-rule","evenodd");const Z=X.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"fill-rule","nonzero");const J=X.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(3.0, 29.0)"),J.setAttributeNS(null,"fill","#000000");const ee=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const nt of ee){const $e=X.createNS("http://www.w3.org/2000/svg","ellipse");$e.setAttributeNS(null,"opacity","0.04"),$e.setAttributeNS(null,"cx","10.5"),$e.setAttributeNS(null,"cy","5.80029008"),$e.setAttributeNS(null,"rx",nt.rx),$e.setAttributeNS(null,"ry",nt.ry),J.appendChild($e)}const re=X.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"fill",this._color);const ue=X.createNS("http://www.w3.org/2000/svg","path");ue.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),re.appendChild(ue);const xe=X.createNS("http://www.w3.org/2000/svg","g");xe.setAttributeNS(null,"opacity","0.25"),xe.setAttributeNS(null,"fill","#000000");const Fe=X.createNS("http://www.w3.org/2000/svg","path");Fe.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),xe.appendChild(Fe);const we=X.createNS("http://www.w3.org/2000/svg","g");we.setAttributeNS(null,"transform","translate(6.0, 7.0)"),we.setAttributeNS(null,"fill","#FFFFFF");const Oe=X.createNS("http://www.w3.org/2000/svg","g");Oe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Je=X.createNS("http://www.w3.org/2000/svg","circle");Je.setAttributeNS(null,"fill","#000000"),Je.setAttributeNS(null,"opacity","0.25"),Je.setAttributeNS(null,"cx","5.5"),Je.setAttributeNS(null,"cy","5.5"),Je.setAttributeNS(null,"r","5.4999962");const Xe=X.createNS("http://www.w3.org/2000/svg","circle");Xe.setAttributeNS(null,"fill","#FFFFFF"),Xe.setAttributeNS(null,"cx","5.5"),Xe.setAttributeNS(null,"cy","5.5"),Xe.setAttributeNS(null,"r","5.4999962"),Oe.appendChild(Je),Oe.appendChild(Xe),Z.appendChild(J),Z.appendChild(re),Z.appendChild(xe),Z.appendChild(we),Z.appendChild(Oe),I.appendChild(Z),I.setAttributeNS(null,"height",A*this._scale+"px"),I.setAttributeNS(null,"width",M*this._scale+"px"),this._element.appendChild(I),this._offset=p.pointGeometry.convert(o&&o.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",I=>{I.preventDefault()}),this._element.addEventListener("mousedown",I=>{I.preventDefault()}),Xo(this._element,this._anchor,"marker"),this._popup=null}addTo(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),X.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=p.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const A=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[A,-1*(38.1-13.5+A)],"bottom-right":[-A,-1*(38.1-13.5+A)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(o){const g=o.code,I=o.charCode||o.keyCode;g!=="Space"&&g!=="Enter"&&I!==32&&I!==13||this.togglePopup()}_onMapClick(o){const g=o.originalEvent.target,I=this._element;this._popup&&(g===I||I.contains(g))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this}_update(o){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=ci(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let I="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?I="rotateX(0deg)":this._pitchAlignment==="map"&&(I=`rotateX(${this._map.getPitch()}deg)`),o&&o.type!=="moveend"||(this._pos=this._pos.round()),X.setTransform(this._element,`${Vt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${I} ${g}`)}getOffset(){return this._offset}setOffset(o){return this._offset=p.pointGeometry.convert(o),this._update(),this}_onMove(o){if(!this._isDragging){const g=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new p.Event("dragstart"))),this.fire(new p.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new p.Event("dragend")),this._state="inactive"}_addDragHandler(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Vn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let fn,Ko=0,bn=!1;const Lo={maxWidth:100,unit:"metric"};function ys(T,o,g){const I=g&&g.maxWidth||100,A=T._container.clientHeight/2,M=T.unproject([0,A]),F=T.unproject([I,A]),Z=M.distanceTo(F);if(g&&g.unit==="imperial"){const J=3.2808*Z;J>5280?Kt(o,I,J/5280,T._getUIString("ScaleControl.Miles")):Kt(o,I,J,T._getUIString("ScaleControl.Feet"))}else g&&g.unit==="nautical"?Kt(o,I,Z/1852,T._getUIString("ScaleControl.NauticalMiles")):Z>=1e3?Kt(o,I,Z/1e3,T._getUIString("ScaleControl.Kilometers")):Kt(o,I,Z,T._getUIString("ScaleControl.Meters"))}function Kt(T,o,g,I){const A=function(M){const F=Math.pow(10,`${Math.floor(M)}`.length-1);let Z=M/F;return Z=Z>=10?10:Z>=5?5:Z>=3?3:Z>=2?2:Z>=1?1:function(J){const ee=Math.pow(10,Math.ceil(-Math.log(J)/Math.LN10));return Math.round(J*ee)/ee}(Z),F*Z}(g);T.style.width=o*(A/g)+"px",T.innerHTML=`${A}&nbsp;${I}`}const Xt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ru=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function On(T){if(T){if(typeof T=="number"){const o=Math.round(Math.sqrt(.5*Math.pow(T,2)));return{center:new p.pointGeometry(0,0),top:new p.pointGeometry(0,T),"top-left":new p.pointGeometry(o,o),"top-right":new p.pointGeometry(-o,o),bottom:new p.pointGeometry(0,-T),"bottom-left":new p.pointGeometry(o,-o),"bottom-right":new p.pointGeometry(-o,-o),left:new p.pointGeometry(T,0),right:new p.pointGeometry(-T,0)}}if(T instanceof p.pointGeometry||Array.isArray(T)){const o=p.pointGeometry.convert(T);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:p.pointGeometry.convert(T.center||[0,0]),top:p.pointGeometry.convert(T.top||[0,0]),"top-left":p.pointGeometry.convert(T["top-left"]||[0,0]),"top-right":p.pointGeometry.convert(T["top-right"]||[0,0]),bottom:p.pointGeometry.convert(T.bottom||[0,0]),"bottom-left":p.pointGeometry.convert(T["bottom-left"]||[0,0]),"bottom-right":p.pointGeometry.convert(T["bottom-right"]||[0,0]),left:p.pointGeometry.convert(T.left||[0,0]),right:p.pointGeometry.convert(T.right||[0,0])}}return On(new p.pointGeometry(0,0))}const Vo={supported:L,setRTLTextPlugin:p.setRTLTextPlugin,getRTLTextPluginStatus:p.getRTLTextPluginStatus,Map:class extends il{constructor(T){var o;if(p.PerformanceUtils.mark(p.PerformanceMarkers.create),(T=p.extend({},pc,T)).minZoom!=null&&T.maxZoom!=null&&T.minZoom>T.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(T.minPitch!=null&&T.maxPitch!=null&&T.minPitch>T.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(T.minPitch!=null&&T.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(T.maxPitch!=null&&T.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new za(T.minZoom,T.maxZoom,T.minPitch,T.maxPitch,T.renderWorldCopies),{bearingSnap:T.bearingSnap}),this._interactive=T.interactive,this._maxTileCacheSize=T.maxTileCacheSize,this._failIfMajorPerformanceCaveat=T.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=T.preserveDrawingBuffer,this._antialias=T.antialias,this._trackResize=T.trackResize,this._bearingSnap=T.bearingSnap,this._refreshExpiredTiles=T.refreshExpiredTiles,this._fadeDuration=T.fadeDuration,this._crossSourceCollisions=T.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=T.collectResourceTiming,this._renderTaskQueue=new hc,this._controls=[],this._mapId=p.uniqueId(),this._locale=p.extend({},Al,T.locale),this._clickTolerance=T.clickTolerance,this._pixelRatio=(o=T.pixelRatio)!==null&&o!==void 0?o:devicePixelRatio,this._requestManager=new Se(T.transformRequest),typeof T.container=="string"){if(this._container=document.getElementById(T.container),!this._container)throw new Error(`Container '${T.container}' not found.`)}else{if(!(T.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=T.container}if(T.maxBounds&&this.setMaxBounds(T.maxBounds),p.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),typeof window!="undefined"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new dn(this,T),this._hash=T.hash&&new vl(typeof T.hash=="string"&&T.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:T.center,zoom:T.zoom,bearing:T.bearing,pitch:T.pitch}),T.bounds&&(this.resize(),this.fitBounds(T.bounds,p.extend({},T.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=T.localIdeographFontFamily,T.style&&this.setStyle(T.style,{localIdeographFontFamily:T.localIdeographFontFamily}),T.attributionControl&&this.addControl(new Io({customAttribution:T.customAttribution})),T.maplibreLogo&&this.addControl(new Ma,T.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",g=>{this._update(g.dataType==="style"),this.fire(new p.Event(`${g.dataType}data`,g))}),this.on("dataloading",g=>{this.fire(new p.Event(`${g.dataType}dataloading`,g))}),this.on("dataabort",g=>{this.fire(new p.Event("sourcedataabort",g))})}_getMapId(){return this._mapId}addControl(T,o){if(o===void 0&&(o=T.getDefaultPosition?T.getDefaultPosition():"top-right"),!T||!T.onAdd)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const g=T.onAdd(this);this._controls.push(T);const I=this._controlPositions[o];return o.indexOf("bottom")!==-1?I.insertBefore(g,I.firstChild):I.appendChild(g),this}removeControl(T){if(!T||!T.onRemove)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(T);return o>-1&&this._controls.splice(o,1),T.onRemove(this),this}hasControl(T){return this._controls.indexOf(T)>-1}resize(T){const o=this._containerDimensions(),g=o[0],I=o[1];this._resizeCanvas(g,I,this.getPixelRatio()),this.transform.resize(g,I),this.painter.resize(g,I,this.getPixelRatio());const A=!this._moving;return A&&(this.stop(),this.fire(new p.Event("movestart",T)).fire(new p.Event("move",T))),this.fire(new p.Event("resize",T)),A&&this.fire(new p.Event("moveend",T)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(T){const[o,g]=this._containerDimensions();this._pixelRatio=T,this._resizeCanvas(o,g,T),this.painter.resize(o,g,T)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(T){return this.transform.setMaxBounds(p.LngLatBounds.convert(T)),this._update()}setMinZoom(T){if((T=T==null?-2:T)>=-2&&T<=this.transform.maxZoom)return this.transform.minZoom=T,this._update(),this.getZoom()<T&&this.setZoom(T),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(T){if((T=T==null?22:T)>=this.transform.minZoom)return this.transform.maxZoom=T,this._update(),this.getZoom()>T&&this.setZoom(T),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(T){if((T=T==null?0:T)<0)throw new Error("minPitch must be greater than or equal to 0");if(T>=0&&T<=this.transform.maxPitch)return this.transform.minPitch=T,this._update(),this.getPitch()<T&&this.setPitch(T),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(T){if((T=T==null?60:T)>85)throw new Error("maxPitch must be less than or equal to 85");if(T>=this.transform.minPitch)return this.transform.maxPitch=T,this._update(),this.getPitch()>T&&this.setPitch(T),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(T){return this.transform.renderWorldCopies=T,this._update()}project(T){return this.transform.locationPoint(p.LngLat.convert(T))}unproject(T){return this.transform.pointLocation(p.pointGeometry.convert(T))}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(T,o,g){if(T==="mouseenter"||T==="mouseover"){let I=!1;return{layer:o,listener:g,delegates:{mousemove:M=>{const F=this.getLayer(o)?this.queryRenderedFeatures(M.point,{layers:[o]}):[];F.length?I||(I=!0,g.call(this,new zo(T,this,M.originalEvent,{features:F}))):I=!1},mouseout:()=>{I=!1}}}}if(T==="mouseleave"||T==="mouseout"){let I=!1;return{layer:o,listener:g,delegates:{mousemove:F=>{(this.getLayer(o)?this.queryRenderedFeatures(F.point,{layers:[o]}):[]).length?I=!0:I&&(I=!1,g.call(this,new zo(T,this,F.originalEvent)))},mouseout:F=>{I&&(I=!1,g.call(this,new zo(T,this,F.originalEvent)))}}}}{const I=A=>{const M=this.getLayer(o)?this.queryRenderedFeatures(A.point,{layers:[o]}):[];M.length&&(A.features=M,g.call(this,A),delete A.features)};return{layer:o,listener:g,delegates:{[T]:I}}}}on(T,o,g){if(g===void 0)return super.on(T,o);const I=this._createDelegatedListener(T,o,g);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[T]=this._delegatedListeners[T]||[],this._delegatedListeners[T].push(I);for(const A in I.delegates)this.on(A,I.delegates[A]);return this}once(T,o,g){if(g===void 0)return super.once(T,o);const I=this._createDelegatedListener(T,o,g);for(const A in I.delegates)this.once(A,I.delegates[A]);return this}off(T,o,g){return g===void 0?super.off(T,o):(this._delegatedListeners&&this._delegatedListeners[T]&&(I=>{const A=this._delegatedListeners[T];for(let M=0;M<A.length;M++){const F=A[M];if(F.layer===o&&F.listener===g){for(const Z in F.delegates)this.off(Z,F.delegates[Z]);return A.splice(M,1),this}}})(),this)}queryRenderedFeatures(T,o){if(!this.style)return[];let g;if(o!==void 0||T===void 0||T instanceof p.pointGeometry||Array.isArray(T)||(o=T,T=void 0),o=o||{},(T=T||[[0,0],[this.transform.width,this.transform.height]])instanceof p.pointGeometry||typeof T[0]=="number")g=[p.pointGeometry.convert(T)];else{const I=p.pointGeometry.convert(T[0]),A=p.pointGeometry.convert(T[1]);g=[I,new p.pointGeometry(A.x,I.y),A,new p.pointGeometry(I.x,A.y),I]}return this.style.queryRenderedFeatures(g,o,this.transform)}querySourceFeatures(T,o){return this.style.querySourceFeatures(T,o)}setStyle(T,o){return(o=p.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&T?(this._diffStyle(T,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(T,o))}setTransformRequest(T){return this._requestManager.setTransformRequest(T),this}_getUIString(T){const o=this._locale[T];if(o==null)throw new Error(`Missing UI string '${T}'`);return o}_updateStyle(T,o){return this.style&&(this.style.setEventedParent(null),this.style._remove()),T?(this.style=new Cr(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof T=="string"?this.style.loadURL(T):this.style.loadJSON(T),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Cr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(T,o){if(typeof T=="string"){const g=this._requestManager.transformRequest(T,p.ResourceType.Style);p.getJSON(g,(I,A)=>{I?this.fire(new p.ErrorEvent(I)):A&&this._updateDiff(A,o)})}else typeof T=="object"&&this._updateDiff(T,o)}_updateDiff(T,o){try{this.style.setState(T)&&this._update(!0)}catch(g){p.warnOnce(`Unable to perform style diff: ${g.message||g.error||g}.  Rebuilding the style from scratch.`),this._updateStyle(T,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():p.warnOnce("There is no style added to the map.")}addSource(T,o){return this._lazyInitEmptyStyle(),this.style.addSource(T,o),this._update(!0)}isSourceLoaded(T){const o=this.style&&this.style.sourceCaches[T];if(o!==void 0)return o.loaded();this.fire(new p.ErrorEvent(new Error(`There is no source with ID '${T}'`)))}areTilesLoaded(){const T=this.style&&this.style.sourceCaches;for(const o in T){const g=T[o]._tiles;for(const I in g){const A=g[I];if(A.state!=="loaded"&&A.state!=="errored")return!1}}return!0}addSourceType(T,o,g){return this._lazyInitEmptyStyle(),this.style.addSourceType(T,o,g)}removeSource(T){return this.style.removeSource(T),this._update(!0)}getSource(T){return this.style.getSource(T)}addImage(T,o,{pixelRatio:g=1,sdf:I=!1,stretchX:A,stretchY:M,content:F}={}){if(this._lazyInitEmptyStyle(),o instanceof HTMLImageElement||p.isImageBitmap(o)){const{width:Z,height:J,data:ee}=p.exported.getImageData(o);this.style.addImage(T,{data:new p.RGBAImage({width:Z,height:J},ee),pixelRatio:g,stretchX:A,stretchY:M,content:F,sdf:I,version:0})}else{if(o.width===void 0||o.height===void 0)return this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Z,height:J,data:ee}=o,re=o;this.style.addImage(T,{data:new p.RGBAImage({width:Z,height:J},new Uint8Array(ee)),pixelRatio:g,stretchX:A,stretchY:M,content:F,sdf:I,version:0,userImage:re}),re.onAdd&&re.onAdd(this,T)}}}updateImage(T,o){const g=this.style.getImage(T);if(!g)return this.fire(new p.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const I=o instanceof HTMLImageElement||p.isImageBitmap(o)?p.exported.getImageData(o):o,{width:A,height:M,data:F}=I;if(A===void 0||M===void 0)return this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(A!==g.data.width||M!==g.data.height)return this.fire(new p.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const Z=!(o instanceof HTMLImageElement||p.isImageBitmap(o));g.data.replace(F,Z),this.style.updateImage(T,g)}hasImage(T){return T?!!this.style.getImage(T):(this.fire(new p.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(T){this.style.removeImage(T)}loadImage(T,o){p.getImage(this._requestManager.transformRequest(T,p.ResourceType.Image),o)}listImages(){return this.style.listImages()}addLayer(T,o){return this._lazyInitEmptyStyle(),this.style.addLayer(T,o),this._update(!0)}moveLayer(T,o){return this.style.moveLayer(T,o),this._update(!0)}removeLayer(T){return this.style.removeLayer(T),this._update(!0)}getLayer(T){return this.style.getLayer(T)}setLayerZoomRange(T,o,g){return this.style.setLayerZoomRange(T,o,g),this._update(!0)}setFilter(T,o,g={}){return this.style.setFilter(T,o,g),this._update(!0)}getFilter(T){return this.style.getFilter(T)}setPaintProperty(T,o,g,I={}){return this.style.setPaintProperty(T,o,g,I),this._update(!0)}getPaintProperty(T,o){return this.style.getPaintProperty(T,o)}setLayoutProperty(T,o,g,I={}){return this.style.setLayoutProperty(T,o,g,I),this._update(!0)}getLayoutProperty(T,o){return this.style.getLayoutProperty(T,o)}setLight(T,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(T,o),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(T,o){return this.style.setFeatureState(T,o),this._update()}removeFeatureState(T,o){return this.style.removeFeatureState(T,o),this._update()}getFeatureState(T){return this.style.getFeatureState(T)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let T=0,o=0;return this._container&&(T=this._container.clientWidth||400,o=this._container.clientHeight||300),[T,o]}_setupContainer(){const T=this._container;T.classList.add("maplibregl-map","mapboxgl-map");const o=this._canvasContainer=X.create("div","maplibregl-canvas-container mapboxgl-canvas-container",T);this._interactive&&o.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=X.create("canvas","maplibregl-canvas mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const g=this._containerDimensions();this._resizeCanvas(g[0],g[1],this.getPixelRatio());const I=this._controlContainer=X.create("div","maplibregl-control-container mapboxgl-control-container",T),A=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(M=>{A[M]=X.create("div",`maplibregl-ctrl-${M} mapboxgl-ctrl-${M}`,I)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(T,o,g){this._canvas.width=g*T,this._canvas.height=g*o,this._canvas.style.width=`${T}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const T=p.extend({},L.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl",T)||this._canvas.getContext("experimental-webgl",T);o?(this.painter=new ha(o,this.transform),p.exported$1.testSupport(o)):this.fire(new p.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(T){T.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new p.Event("webglcontextlost",{originalEvent:T}))}_contextRestored(T){this._setupPainter(),this.resize(),this._update(),this.fire(new p.Event("webglcontextrestored",{originalEvent:T}))}_onMapScroll(T){if(T.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(T){return this.style?(this._styleDirty=this._styleDirty||T,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(T){return this._update(),this._renderTaskQueue.add(T)}_cancelRenderFrame(T){this._renderTaskQueue.remove(T)}_render(T){let o,g=0;const I=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(o=I.createQueryEXT(),I.beginQueryEXT(I.TIME_ELAPSED_EXT,o),g=p.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(T),this._removed)return;let A=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const F=this.transform.zoom,Z=p.exported.now();this.style.zoomHistory.update(F,Z);const J=new p.EvaluationParameters(F,{now:Z,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ee=J.crossFadingFactor();ee===1&&ee===this._crossFadingFactor||(A=!0,this._crossFadingFactor=ee),this.style.update(J)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new p.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,p.PerformanceUtils.mark(p.PerformanceMarkers.load),this.fire(new p.Event("load"))),this.style&&(this.style.hasTransitions()||A)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const F=p.exported.now()-g;I.endQueryEXT(I.TIME_ELAPSED_EXT,o),setTimeout(()=>{const Z=I.getQueryObjectEXT(o,I.QUERY_RESULT_EXT)/1e6;I.deleteQueryEXT(o),this.fire(new p.Event("gpu-timing-frame",{cpuTime:F,gpuTime:Z}))},50)}if(this.listens("gpu-timing-layer")){const F=this.painter.collectGpuTimers();setTimeout(()=>{const Z=this.painter.queryGpuTimers(F);this.fire(new p.Event("gpu-timing-layer",{layerTimes:Z}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty;return M||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new p.Event("idle")),!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,p.PerformanceUtils.mark(p.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window!="undefined"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const T=this.painter.context.gl.getExtension("WEBGL_lose_context");T&&T.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),X.remove(this._canvasContainer),X.remove(this._controlContainer),this._container.classList.remove("maplibregl-map","mapboxgl-map"),p.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new p.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=p.exported.frame(T=>{p.PerformanceUtils.frame(T),this._frame=null,this._render(T)}))}_onWindowOnline(){this._update()}_onWindowResize(T){this._trackResize&&this.resize({originalEvent:T})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(T){this._showTileBoundaries!==T&&(this._showTileBoundaries=T,this._update())}get showPadding(){return!!this._showPadding}set showPadding(T){this._showPadding!==T&&(this._showPadding=T,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(T){this._showCollisionBoxes!==T&&(this._showCollisionBoxes=T,T?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(T){this._showOverdrawInspector!==T&&(this._showOverdrawInspector=T,this._update())}get repaint(){return!!this._repaint}set repaint(T){this._repaint!==T&&(this._repaint=T,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(T){this._vertices=T,this._update()}_setCacheLimits(T,o){p.setCacheLimits(T,o)}},NavigationControl:class{constructor(T){this.options=p.extend({},ba,T),this._container=X.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(p.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),X.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),X.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(p.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=X.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const T=this._map.getZoom(),o=T===this._map.getMaxZoom(),g=T===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const T=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=T}onAdd(T){return this._map=T,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Wo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){X.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(T,o){const g=X.create("button",T,this._container);return g.type="button",g.addEventListener("click",o),g}_setButtonTitle(T,o){const g=this._map._getUIString(`NavigationControl.${o}`);T.title=g,T.setAttribute("aria-label",g)}},GeolocateControl:class extends p.Evented{constructor(T){super(),this.options=p.extend({},Vn,T),p.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(T){var o;return this._map=T,this._container=X.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),o=this._setupUI,fn!==void 0?o(fn):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(g=>{fn=g.state!=="denied",o(fn)}):(fn=!!window.navigator.geolocation,o(fn)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),X.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ko=0,bn=!1}_isOutOfMapMaxBounds(T){const o=this._map.getMaxBounds(),g=T.coords;return o&&(g.longitude<o.getWest()||g.longitude>o.getEast()||g.latitude<o.getSouth()||g.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(T){if(this._map){if(this._isOutOfMapMaxBounds(T))return this._setErrorState(),this.fire(new p.Event("outofmaxbounds",T)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=T,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(T),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(T),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new p.Event("geolocate",T)),this._finish()}}_updateCamera(T){const o=new p.LngLat(T.coords.longitude,T.coords.latitude),g=T.coords.accuracy,I=this._map.getBearing(),A=p.extend({bearing:I},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(g),A,{geolocateSource:!0})}_updateMarker(T){if(T){const o=new p.LngLat(T.coords.longitude,T.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=T.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const T=this._map._container.clientHeight/2,o=this._map.unproject([0,T]),g=this._map.unproject([1,T]),I=o.distanceTo(g),A=Math.ceil(2*this._accuracy/I);this._circleElement.style.width=`${A}px`,this._circleElement.style.height=`${A}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(T){if(this._map){if(this.options.trackUserLocation)if(T.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(T.code===3&&bn)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new p.Event("error",T)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(T){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=X.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),X.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",T===!1){p.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=X.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Mo(this._dotElement),this._circleElement=X.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Mo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new p.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return p.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new p.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ko--,bn=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new p.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new p.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let T;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ko++,Ko>1?(T={maximumAge:6e5,timeout:0},bn=!0):(T=this.options.positionOptions,bn=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,T)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Io,LogoControl:Ma,ScaleControl:class{constructor(T){this.options=p.extend({},Lo,T),p.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){ys(this._map,this._container,this.options)}onAdd(T){return this._map=T,this._container=X.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",T.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){X.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(T){this.options.unit=T,ys(this._map,this._container,this.options)}},FullscreenControl:class{constructor(T){this._fullscreen=!1,T&&T.container&&(T.container instanceof HTMLElement?this._container=T.container:p.warnOnce("Full screen control 'container' must be a DOM element.")),p.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(T){return this._map=T,this._container||(this._container=this._map.getContainer()),this._controlContainer=X.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",p.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){X.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const T=this._fullscreenButton=X.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);X.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",T).setAttribute("aria-hidden","true"),T.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const T=this._getTitle();this._fullscreenButton.setAttribute("aria-label",T),this._fullscreenButton.title=T}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends p.Evented{constructor(T){super(),this.options=p.extend(Object.create(Xt),T),p.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(T){return this._map&&this.remove(),this._map=T,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new p.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&X.remove(this._content),this._container&&(X.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new p.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(T){return this._lngLat=p.LngLat.convert(T),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(T){return this.setDOMContent(document.createTextNode(T))}setHTML(T){const o=document.createDocumentFragment(),g=document.createElement("body");let I;for(g.innerHTML=T;I=g.firstChild,I;)o.appendChild(I);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(T){return this.options.maxWidth=T,this._update(),this}setDOMContent(T){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=X.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(T),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(T){this._container&&this._container.classList.add(T)}removeClassName(T){this._container&&this._container.classList.remove(T)}setOffset(T){return this.options.offset=T,this._update(),this}toggleClassName(T){if(this._container)return this._container.classList.toggle(T)}_createCloseButton(){this.options.closeButton&&(this._closeButton=X.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(T){this._update(T.point)}_onMouseMove(T){this._update(T.point)}_onDrag(T){this._update(T.point)}_update(T){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=X.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=X.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(M=>this._container.classList.add(M)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ci(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!T))return;const o=this._pos=this._trackPointer&&T?T:this._map.project(this._lngLat);let g=this.options.anchor;const I=On(this.options.offset);if(!g){const M=this._container.offsetWidth,F=this._container.offsetHeight;let Z;Z=o.y+I.bottom.y<F?["top"]:o.y>this._map.transform.height-F?["bottom"]:[],o.x<M/2?Z.push("left"):o.x>this._map.transform.width-M/2&&Z.push("right"),g=Z.length===0?"bottom":Z.join("-")}const A=o.add(I[g]).round();X.setTransform(this._container,`${Vt[g]} translate(${A.x}px,${A.y}px)`),Xo(this._container,g,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const T=this._container.querySelector(ru);T&&T.focus()}_onClose(){this.remove()}},Marker:Mo,Style:Cr,LngLat:p.LngLat,LngLatBounds:p.LngLatBounds,Point:p.pointGeometry,MercatorCoordinate:p.MercatorCoordinate,Evented:p.Evented,AJAXError:p.AJAXError,config:p.config,CanvasSource:Ji,GeoJSONSource:Yt,ImageSource:xi,RasterDEMTileSource:zt,RasterTileSource:Dt,VectorTileSource:Fi,VideoSource:Gt,prewarm:function(){xn().acquire(Pr)},clearPrewarmedResources:function(){const T=Fo;T&&(T.isPreloaded()&&T.numActive()===1?(T.release(Pr),Fo=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get workerCount(){return ho.workerCount},set workerCount(T){ho.workerCount=T},get maxParallelImageRequests(){return p.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(T){p.config.MAX_PARALLEL_IMAGE_REQUESTS=T},clearStorage(T){p.clearTileCache(T)},workerUrl:"",addProtocol(T,o){p.config.REGISTERED_PROTOCOLS[T]=o},removeProtocol(T){delete p.config.REGISTERED_PROTOCOLS[T]}};return rn.extend(Vo,{isSafari:p.isSafari,getPerformanceMetrics:p.PerformanceUtils.getPerformanceMetrics}),Vo});var f=w;return f})})(Yh);var tS=Yh.exports,Xp=rS,iS=Object.prototype.hasOwnProperty;function rS(){for(var u={},r=0;r<arguments.length;r++){var s=arguments[r];for(var y in s)iS.call(s,y)&&(u[y]=s[y])}return u}var $v={exports:{}};(function(u,r){(function(){var s={};u.exports=s,s.simpleFilter=function(y,w){return w.filter(function(z){return s.test(y,z)})},s.test=function(y,w){return s.match(y,w)!==null},s.match=function(y,w,z){z=z||{};var f=0,p=[],L=w.length,N=0,U=0,G=z.pre||"",X=z.post||"",Se=z.caseSensitive&&w||w.toLowerCase(),ge;y=z.caseSensitive&&y||y.toLowerCase();for(var De=0;De<L;De++)ge=w[De],Se[De]===y[f]?(ge=G+ge+X,f+=1,U+=1+U):U=0,N+=U,p[p.length]=ge;return f===y.length?(N=Se===y?1/0:N,{rendered:p.join(""),score:N}):null},s.filter=function(y,w,z){return!w||w.length===0?[]:typeof y!="string"?w:(z=z||{},w.reduce(function(f,p,L,N){var U=p;z.extract&&(U=z.extract(p));var G=s.match(y,U,z);return G!=null&&(f[f.length]={string:G.rendered,score:G.score,index:L,original:p}),f},[]).sort(function(f,p){var L=p.score-f.score;return L||f.index-p.index}))}})()})($v);var qs=function(u){return this.component=u,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,u.el.parentNode.insertBefore(this.wrapper,u.el.nextSibling),this};qs.prototype.show=function(){this.element.style.display="block"};qs.prototype.hide=function(){this.element.style.display="none"};qs.prototype.add=function(u){this.items.push(u)};qs.prototype.clear=function(){this.items=[],this.active=0};qs.prototype.isEmpty=function(){return!this.items.length};qs.prototype.isVisible=function(){return this.element.style.display==="block"};qs.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var u=0;u<this.items.length;u++)this.drawItem(this.items[u],this.active===u);this.show()};qs.prototype.drawItem=function(u,r){var s=document.createElement("li"),y=document.createElement("a");r&&(s.className+=" active"),y.innerHTML=u.string,s.appendChild(y),this.element.appendChild(s),s.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),s.addEventListener("mouseup",function(){this.handleMouseUp.call(this,u)}.bind(this))};qs.prototype.handleMouseUp=function(u){this.selectingListItem=!1,this.component.value(u.original),this.clear(),this.draw()};qs.prototype.move=function(u){this.active=u,this.draw()};qs.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)};qs.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)};qs.prototype.drawError=function(u){var r=document.createElement("li");r.innerHTML=u,this.element.appendChild(r),this.show()};var nS=qs,oS=Xp,aS=$v.exports,sS=nS,is=function(u,r,s){return s=s||{},this.options=oS({minLength:2,limit:5,filter:!0,hideOnBlur:!0},s),this.el=u,this.data=r||[],this.list=new sS(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(y){this.handleKeyUp(y.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(y){this.handleKeyDown(y)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(y){this.handlePaste(y)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};is.prototype.handleKeyUp=function(u){u===40||u===38||u===27||u===13||u===9||this.handleInputChange(this.el.value)};is.prototype.handleKeyDown=function(u){switch(u.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&u.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};is.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};is.prototype.handlePaste=function(u){if(u.clipboardData)this.handleInputChange(u.clipboardData.getData("Text"));else{var r=this;setTimeout(function(){r.handleInputChange(u.target.value)},100)}};is.prototype.handleInputChange=function(u){if(this.query=this.normalize(u),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates(function(r){for(var s=0;s<r.length&&(this.list.add(r[s]),s!==this.options.limit-1);s++);this.list.draw()}.bind(this))};is.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};is.prototype.update=function(u){this.data=u,this.handleKeyUp()};is.prototype.clear=function(){this.data=[],this.list.clear()};is.prototype.normalize=function(u){return u=u.toLowerCase(),u};is.prototype.match=function(u,r){return u.indexOf(r)>-1};is.prototype.value=function(u){if(this.selected=u,this.el.value=this.getItemValue(u),document.createEvent){var r=document.createEvent("HTMLEvents");r.initEvent("change",!0,!1),this.el.dispatchEvent(r)}else this.el.fireEvent("onchange")};is.prototype.getCandidates=function(u){var r={pre:"<strong>",post:"</strong>",extract:function(y){return this.getItemValue(y)}.bind(this)},s;this.options.filter?(s=aS.filter(this.query,this.data,r),s=s.map(function(y){return{original:y.original,string:this.render(y.original,y.string)}}.bind(this))):s=this.data.map(function(y){var w=this.render(y);return{original:y,string:w}}.bind(this)),u(s)};is.prototype.getItemValue=function(u){return u};is.prototype.render=function(u,r){if(r)return r;for(var s=u.original?this.getItemValue(u.original):this.getItemValue(u),y=this.normalize(s),w=y.lastIndexOf(this.query);w>-1;){var z=w+this.query.length;s=s.slice(0,w)+"<strong>"+s.slice(w,z)+"</strong>"+s.slice(z),w=y.slice(0,w).lastIndexOf(this.query)}return s};is.prototype.renderError=function(u){this.list.drawError(u)};var lS=is,Qv=lS,uS=Qv;typeof window!="undefined"&&(window.Suggestions=Qv);var cS="Expected a function",Y_=0/0,hS="[object Symbol]",pS=/^\s+|\s+$/g,dS=/^[-+]0x[0-9a-f]+$/i,fS=/^0b[01]+$/i,mS=/^0o[0-7]+$/i,yS=parseInt,gS=typeof Rl=="object"&&Rl&&Rl.Object===Object&&Rl,_S=typeof self=="object"&&self&&self.Object===Object&&self,vS=gS||_S||Function("return this")(),xS=Object.prototype,bS=xS.toString,wS=Math.max,ES=Math.min,Ty=function(){return vS.Date.now()};function SS(u,r,s){var y,w,z,f,p,L,N=0,U=!1,G=!1,X=!0;if(typeof u!="function")throw new TypeError(cS);r=$_(r)||0,Xy(s)&&(U=!!s.leading,G="maxWait"in s,z=G?wS($_(s.maxWait)||0,r):z,X="trailing"in s?!!s.trailing:X);function Se(ht){var at=y,$t=w;return y=w=void 0,N=ht,f=u.apply($t,at),f}function ge(ht){return N=ht,p=setTimeout(ft,r),U?Se(ht):f}function De(ht){var at=ht-L,$t=ht-N,xt=r-at;return G?ES(xt,z-$t):xt}function Le(ht){var at=ht-L,$t=ht-N;return L===void 0||at>=r||at<0||G&&$t>=z}function ft(){var ht=Ty();if(Le(ht))return Ue(ht);p=setTimeout(ft,De(ht))}function Ue(ht){return p=void 0,X&&y?Se(ht):(y=w=void 0,f)}function Re(){p!==void 0&&clearTimeout(p),N=0,y=L=w=p=void 0}function st(){return p===void 0?f:Ue(Ty())}function ut(){var ht=Ty(),at=Le(ht);if(y=arguments,w=this,L=ht,at){if(p===void 0)return ge(L);if(G)return p=setTimeout(ft,r),Se(L)}return p===void 0&&(p=setTimeout(ft,r)),f}return ut.cancel=Re,ut.flush=st,ut}function Xy(u){var r=typeof u;return!!u&&(r=="object"||r=="function")}function IS(u){return!!u&&typeof u=="object"}function TS(u){return typeof u=="symbol"||IS(u)&&bS.call(u)==hS}function $_(u){if(typeof u=="number")return u;if(TS(u))return Y_;if(Xy(u)){var r=typeof u.valueOf=="function"?u.valueOf():u;u=Xy(r)?r+"":r}if(typeof u!="string")return u===0?u:+u;u=u.replace(pS,"");var s=fS.test(u);return s||mS.test(u)?yS(u.slice(2),s?2:8):dS.test(u)?Y_:+u}var AS=SS,wg={exports:{}},Bp=typeof Reflect=="object"?Reflect:null,Q_=Bp&&typeof Bp.apply=="function"?Bp.apply:function(r,s,y){return Function.prototype.apply.call(r,s,y)},Of;Bp&&typeof Bp.ownKeys=="function"?Of=Bp.ownKeys:Object.getOwnPropertySymbols?Of=function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:Of=function(r){return Object.getOwnPropertyNames(r)};function CS(u){console&&console.warn&&console.warn(u)}var e0=Number.isNaN||function(r){return r!==r};function Dn(){Dn.init.call(this)}wg.exports=Dn;wg.exports.once=MS;Dn.EventEmitter=Dn;Dn.prototype._events=void 0;Dn.prototype._eventsCount=0;Dn.prototype._maxListeners=void 0;var ev=10;function fm(u){if(typeof u!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof u)}Object.defineProperty(Dn,"defaultMaxListeners",{enumerable:!0,get:function(){return ev},set:function(u){if(typeof u!="number"||u<0||e0(u))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+u+".");ev=u}});Dn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Dn.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||e0(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this};function t0(u){return u._maxListeners===void 0?Dn.defaultMaxListeners:u._maxListeners}Dn.prototype.getMaxListeners=function(){return t0(this)};Dn.prototype.emit=function(r){for(var s=[],y=1;y<arguments.length;y++)s.push(arguments[y]);var w=r==="error",z=this._events;if(z!==void 0)w=w&&z.error===void 0;else if(!w)return!1;if(w){var f;if(s.length>0&&(f=s[0]),f instanceof Error)throw f;var p=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw p.context=f,p}var L=z[r];if(L===void 0)return!1;if(typeof L=="function")Q_(L,this,s);else for(var N=L.length,U=a0(L,N),y=0;y<N;++y)Q_(U[y],this,s);return!0};function i0(u,r,s,y){var w,z,f;if(fm(s),z=u._events,z===void 0?(z=u._events=Object.create(null),u._eventsCount=0):(z.newListener!==void 0&&(u.emit("newListener",r,s.listener?s.listener:s),z=u._events),f=z[r]),f===void 0)f=z[r]=s,++u._eventsCount;else if(typeof f=="function"?f=z[r]=y?[s,f]:[f,s]:y?f.unshift(s):f.push(s),w=t0(u),w>0&&f.length>w&&!f.warned){f.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=u,p.type=r,p.count=f.length,CS(p)}return u}Dn.prototype.addListener=function(r,s){return i0(this,r,s,!1)};Dn.prototype.on=Dn.prototype.addListener;Dn.prototype.prependListener=function(r,s){return i0(this,r,s,!0)};function kS(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function r0(u,r,s){var y={fired:!1,wrapFn:void 0,target:u,type:r,listener:s},w=kS.bind(y);return w.listener=s,y.wrapFn=w,w}Dn.prototype.once=function(r,s){return fm(s),this.on(r,r0(this,r,s)),this};Dn.prototype.prependOnceListener=function(r,s){return fm(s),this.prependListener(r,r0(this,r,s)),this};Dn.prototype.removeListener=function(r,s){var y,w,z,f,p;if(fm(s),w=this._events,w===void 0)return this;if(y=w[r],y===void 0)return this;if(y===s||y.listener===s)--this._eventsCount===0?this._events=Object.create(null):(delete w[r],w.removeListener&&this.emit("removeListener",r,y.listener||s));else if(typeof y!="function"){for(z=-1,f=y.length-1;f>=0;f--)if(y[f]===s||y[f].listener===s){p=y[f].listener,z=f;break}if(z<0)return this;z===0?y.shift():zS(y,z),y.length===1&&(w[r]=y[0]),w.removeListener!==void 0&&this.emit("removeListener",r,p||s)}return this};Dn.prototype.off=Dn.prototype.removeListener;Dn.prototype.removeAllListeners=function(r){var s,y,w;if(y=this._events,y===void 0)return this;if(y.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):y[r]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete y[r]),this;if(arguments.length===0){var z=Object.keys(y),f;for(w=0;w<z.length;++w)f=z[w],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(s=y[r],typeof s=="function")this.removeListener(r,s);else if(s!==void 0)for(w=s.length-1;w>=0;w--)this.removeListener(r,s[w]);return this};function n0(u,r,s){var y=u._events;if(y===void 0)return[];var w=y[r];return w===void 0?[]:typeof w=="function"?s?[w.listener||w]:[w]:s?PS(w):a0(w,w.length)}Dn.prototype.listeners=function(r){return n0(this,r,!0)};Dn.prototype.rawListeners=function(r){return n0(this,r,!1)};Dn.listenerCount=function(u,r){return typeof u.listenerCount=="function"?u.listenerCount(r):o0.call(u,r)};Dn.prototype.listenerCount=o0;function o0(u){var r=this._events;if(r!==void 0){var s=r[u];if(typeof s=="function")return 1;if(s!==void 0)return s.length}return 0}Dn.prototype.eventNames=function(){return this._eventsCount>0?Of(this._events):[]};function a0(u,r){for(var s=new Array(r),y=0;y<r;++y)s[y]=u[y];return s}function zS(u,r){for(;r+1<u.length;r++)u[r]=u[r+1];u.pop()}function PS(u){for(var r=new Array(u.length),s=0;s<r.length;++s)r[s]=u[s].listener||u[s];return r}function MS(u,r){return new Promise(function(s,y){function w(f){u.removeListener(r,z),y(f)}function z(){typeof u.removeListener=="function"&&u.removeListener("error",w),s([].slice.call(arguments))}s0(u,r,z,{once:!0}),r!=="error"&&LS(u,w,{once:!0})})}function LS(u,r,s){typeof u.on=="function"&&s0(u,"error",r,s)}function s0(u,r,s,y){if(typeof u.on=="function")y.once?u.once(r,s):u.on(r,s);else if(typeof u.addEventListener=="function")u.addEventListener(r,function w(z){y.once&&u.removeEventListener(r,w),s(z)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof u)}var DS={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};function RS(u){var r=u.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return r?{key:r[1],value:r[2]}:null}function BS(u){var r=u.match(/<?([^>]*)>(.*)/);if(!r)return null;var s=r[1],y=r[2].split(";"),w=null,z=y.reduce(function(f,p){var L=RS(p);return L?L.key==="rel"?(w||(w=L.value),f):(f[L.key]=L.value,f):f},{});return w?{url:s,rel:w,params:z}:null}function OS(u){return u?u.split(/,\s*</).reduce(function(r,s){var y=BS(s);if(!y)return r;var w=y.rel.split(/\s+/);return w.forEach(function(z){r[z]||(r[z]={url:y.url,params:y.params})}),r},{}):{}}var FS=OS,US=FS;function Eg(u,r){this.request=u,this.headers=r.headers,this.rawBody=r.body,this.statusCode=r.statusCode;try{this.body=JSON.parse(r.body||"{}")}catch{this.body=r.body}this.links=US(this.headers.link)}Eg.prototype.hasNextPage=function(){return!!this.links.next};Eg.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null};var NS=Eg,mm={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"},tv=mm;function jS(u){var r=u.type||tv.ERROR_HTTP,s;if(u.body)try{s=JSON.parse(u.body)}catch{s=u.body}else s=null;var y=u.message||null;y||(typeof s=="string"?y=s:s&&typeof s.message=="string"?y=s.message:r===tv.ERROR_REQUEST_ABORTED&&(y="Request aborted")),this.message=y,this.type=r,this.statusCode=u.statusCode||null,this.request=u.request,this.body=s}var VS=jS;function qS(u){var r=u.indexOf(":"),s=u.substring(0,r).trim().toLowerCase(),y=u.substring(r+1).trim();return{name:s,value:y}}function GS(u){var r={};return u&&u.trim().split(/[\r|\n]+/).forEach(function(s){var y=qS(s);r[y.name]=y.value}),r}var ZS=GS,HS=NS,iv=VS,Ay=mm,WS=ZS,Xf={};function XS(u){var r=Xf[u.id];!r||(r.abort(),delete Xf[u.id])}function KS(u,r){return new HS(u,{body:r.response,headers:WS(r.getAllResponseHeaders()),statusCode:r.status})}function rv(u){var r=u.total,s=u.loaded,y=100*s/r;return{total:r,transferred:s,percent:y}}function l0(u,r){return new Promise(function(s,y){r.onprogress=function(f){u.emitter.emit(Ay.EVENT_PROGRESS_DOWNLOAD,rv(f))};var w=u.file;w&&(r.upload.onprogress=function(f){u.emitter.emit(Ay.EVENT_PROGRESS_UPLOAD,rv(f))}),r.onerror=function(f){y(f)},r.onabort=function(){var f=new iv({request:u,type:Ay.ERROR_REQUEST_ABORTED});y(f)},r.onload=function(){if(delete Xf[u.id],r.status<200||r.status>=400){var f=new iv({request:u,body:r.response,statusCode:r.status});y(f);return}s(r)};var z=u.body;typeof z=="string"?r.send(z):z?r.send(JSON.stringify(z)):w?r.send(w):r.send(),Xf[u.id]=r}).then(function(s){return KS(u,s)})}function u0(u,r){var s=u.url(r),y=new window.XMLHttpRequest;return y.open(u.method,s),Object.keys(u.headers).forEach(function(w){y.setRequestHeader(w,u.headers[w])}),y}function JS(u){return Promise.resolve().then(function(){var r=u0(u,u.client.accessToken);return l0(u,r)})}var YS={browserAbort:XS,sendRequestXhr:l0,browserSend:JS,createRequestXhr:u0},Ky={exports:{}};/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */(function(u,r){(function(s){var y=r,w=u&&u.exports==y&&u,z=typeof Rl=="object"&&Rl;(z.global===z||z.window===z)&&(s=z);var f=function(ge){this.message=ge};f.prototype=new Error,f.prototype.name="InvalidCharacterError";var p=function(ge){throw new f(ge)},L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N=/[\t\n\f\r ]/g,U=function(ge){ge=String(ge).replace(N,"");var De=ge.length;De%4==0&&(ge=ge.replace(/==?$/,""),De=ge.length),(De%4==1||/[^+a-zA-Z0-9/]/.test(ge))&&p("Invalid character: the string to be decoded is not correctly encoded.");for(var Le=0,ft,Ue,Re="",st=-1;++st<De;)Ue=L.indexOf(ge.charAt(st)),ft=Le%4?ft*64+Ue:Ue,Le++%4&&(Re+=String.fromCharCode(255&ft>>(-2*Le&6)));return Re},G=function(ge){ge=String(ge),/[^\0-\xFF]/.test(ge)&&p("The string to be encoded contains characters outside of the Latin1 range.");for(var De=ge.length%3,Le="",ft=-1,Ue,Re,st,ut,ht=ge.length-De;++ft<ht;)Ue=ge.charCodeAt(ft)<<16,Re=ge.charCodeAt(++ft)<<8,st=ge.charCodeAt(++ft),ut=Ue+Re+st,Le+=L.charAt(ut>>18&63)+L.charAt(ut>>12&63)+L.charAt(ut>>6&63)+L.charAt(ut&63);return De==2?(Ue=ge.charCodeAt(ft)<<8,Re=ge.charCodeAt(++ft),ut=Ue+Re,Le+=L.charAt(ut>>10)+L.charAt(ut>>4&63)+L.charAt(ut<<2&63)+"="):De==1&&(ut=ge.charCodeAt(ft),Le+=L.charAt(ut>>2)+L.charAt(ut<<4&63)+"=="),Le},X={encode:G,decode:U,version:"0.1.0"};if(y&&!y.nodeType)if(w)w.exports=X;else for(var Se in X)X.hasOwnProperty(Se)&&(y[Se]=X[Se]);else s.base64=X})(Rl)})(Ky,Ky.exports);var $S=Ky.exports,Cy={};function QS(u){if(Cy[u])return Cy[u];var r=u.split("."),s=r[0],y=r[1];if(!y)throw new Error("Invalid token");var w=eI(y),z={usage:s,user:w.u};return Xh(w,"a")&&(z.authorization=w.a),Xh(w,"exp")&&(z.expires=w.exp*1e3),Xh(w,"iat")&&(z.created=w.iat*1e3),Xh(w,"scopes")&&(z.scopes=w.scopes),Xh(w,"client")&&(z.client=w.client),Xh(w,"ll")&&(z.lastLogin=w.ll),Xh(w,"iu")&&(z.impersonator=w.iu),Cy[u]=z,z}function eI(u){try{return JSON.parse($S.decode(u))}catch{throw new Error("Invalid token")}}function Xh(u,r){return Object.prototype.hasOwnProperty.call(u,r)}var c0=QS,h0={exports:{}};(function(u){var r=Object.prototype.hasOwnProperty,s="~";function y(){}Object.create&&(y.prototype=Object.create(null),new y().__proto__||(s=!1));function w(L,N,U){this.fn=L,this.context=N,this.once=U||!1}function z(L,N,U,G,X){if(typeof U!="function")throw new TypeError("The listener must be a function");var Se=new w(U,G||L,X),ge=s?s+N:N;return L._events[ge]?L._events[ge].fn?L._events[ge]=[L._events[ge],Se]:L._events[ge].push(Se):(L._events[ge]=Se,L._eventsCount++),L}function f(L,N){--L._eventsCount===0?L._events=new y:delete L._events[N]}function p(){this._events=new y,this._eventsCount=0}p.prototype.eventNames=function(){var N=[],U,G;if(this._eventsCount===0)return N;for(G in U=this._events)r.call(U,G)&&N.push(s?G.slice(1):G);return Object.getOwnPropertySymbols?N.concat(Object.getOwnPropertySymbols(U)):N},p.prototype.listeners=function(N){var U=s?s+N:N,G=this._events[U];if(!G)return[];if(G.fn)return[G.fn];for(var X=0,Se=G.length,ge=new Array(Se);X<Se;X++)ge[X]=G[X].fn;return ge},p.prototype.listenerCount=function(N){var U=s?s+N:N,G=this._events[U];return G?G.fn?1:G.length:0},p.prototype.emit=function(N,U,G,X,Se,ge){var De=s?s+N:N;if(!this._events[De])return!1;var Le=this._events[De],ft=arguments.length,Ue,Re;if(Le.fn){switch(Le.once&&this.removeListener(N,Le.fn,void 0,!0),ft){case 1:return Le.fn.call(Le.context),!0;case 2:return Le.fn.call(Le.context,U),!0;case 3:return Le.fn.call(Le.context,U,G),!0;case 4:return Le.fn.call(Le.context,U,G,X),!0;case 5:return Le.fn.call(Le.context,U,G,X,Se),!0;case 6:return Le.fn.call(Le.context,U,G,X,Se,ge),!0}for(Re=1,Ue=new Array(ft-1);Re<ft;Re++)Ue[Re-1]=arguments[Re];Le.fn.apply(Le.context,Ue)}else{var st=Le.length,ut;for(Re=0;Re<st;Re++)switch(Le[Re].once&&this.removeListener(N,Le[Re].fn,void 0,!0),ft){case 1:Le[Re].fn.call(Le[Re].context);break;case 2:Le[Re].fn.call(Le[Re].context,U);break;case 3:Le[Re].fn.call(Le[Re].context,U,G);break;case 4:Le[Re].fn.call(Le[Re].context,U,G,X);break;default:if(!Ue)for(ut=1,Ue=new Array(ft-1);ut<ft;ut++)Ue[ut-1]=arguments[ut];Le[Re].fn.apply(Le[Re].context,Ue)}}return!0},p.prototype.on=function(N,U,G){return z(this,N,U,G,!1)},p.prototype.once=function(N,U,G){return z(this,N,U,G,!0)},p.prototype.removeListener=function(N,U,G,X){var Se=s?s+N:N;if(!this._events[Se])return this;if(!U)return f(this,Se),this;var ge=this._events[Se];if(ge.fn)ge.fn===U&&(!X||ge.once)&&(!G||ge.context===G)&&f(this,Se);else{for(var De=0,Le=[],ft=ge.length;De<ft;De++)(ge[De].fn!==U||X&&!ge[De].once||G&&ge[De].context!==G)&&Le.push(ge[De]);Le.length?this._events[Se]=Le.length===1?Le[0]:Le:f(this,Se)}return this},p.prototype.removeAllListeners=function(N){var U;return N?(U=s?s+N:N,this._events[U]&&f(this,U)):(this._events=new y,this._eventsCount=0),this},p.prototype.off=p.prototype.removeListener,p.prototype.addListener=p.prototype.on,p.prefixed=s,p.EventEmitter=p,u.exports=p})(h0);function tI(u){return u.map(encodeURIComponent).join(",")}function p0(u){return Array.isArray(u)?tI(u):encodeURIComponent(String(u))}function d0(u,r,s){if(s===!1||s===null)return u;var y=/\?/.test(u)?"&":"?",w=encodeURIComponent(r);return s!==void 0&&s!==""&&s!==!0&&(w+="="+p0(s)),""+u+y+w}function iI(u,r){if(!r)return u;var s=u;return Object.keys(r).forEach(function(y){var w=r[y];w!==void 0&&(Array.isArray(w)&&(w=w.filter(function(z){return z!=null}).join(",")),s=d0(s,y,w))}),s}function rI(u,r){if(!r||u.slice(0,4)==="http")return u;var s=u[0]==="/"?"":"/";return""+r.replace(/\/$/,"")+s+u}function nI(u,r){return r?u.replace(/\/:([a-zA-Z0-9]+)/g,function(s,y){var w=r[y];if(w===void 0)throw new Error("Unspecified route parameter "+y);var z=p0(w);return"/"+z}):u}var oI={appendQueryObject:iI,appendQueryParam:d0,prependOrigin:rI,interpolateRouteParams:nI},aI=c0,Sg=Xp,sI=h0.exports,Pf=oI,nv=mm,lI=1;function vh(u,r){if(!u)throw new Error("MapiRequest requires a client");if(!r||!r.path||!r.method)throw new Error("MapiRequest requires an options object with path and method properties");var s={};r.body&&(s["content-type"]="application/json");var y=Sg(s,r.headers),w=Object.keys(y).reduce(function(z,f){return z[f.toLowerCase()]=y[f],z},{});this.id=lI++,this._options=r,this.emitter=new sI,this.client=u,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=r.path,this.method=r.method,this.origin=r.origin||u.origin,this.query=r.query||{},this.params=r.params||{},this.body=r.body||null,this.file=r.file||null,this.encoding=r.encoding||"utf8",this.sendFileAs=r.sendFileAs||null,this.headers=w}vh.prototype.url=function(r){var s=Pf.prependOrigin(this.path,this.origin);s=Pf.appendQueryObject(s,this.query);var y=this.params,w=r==null?this.client.accessToken:r;if(w){s=Pf.appendQueryParam(s,"access_token",w);var z=aI(w).user;y=Sg({ownerId:z},y)}return s=Pf.interpolateRouteParams(s,y),s};vh.prototype.send=function(){var r=this;if(r.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return r.sent=!0,r.client.sendRequest(r).then(function(s){return r.response=s,r.emitter.emit(nv.EVENT_RESPONSE,s),s},function(s){throw r.error=s,r.emitter.emit(nv.EVENT_ERROR,s),s})};vh.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))};vh.prototype.eachPage=function(r){var s=this;function y(f){function p(){delete s._nextPageRequest;var L=f.nextPage();L&&(s._nextPageRequest=L,z(L))}r(null,f,p)}function w(f){r(f,null,function(){})}function z(f){f.send().then(y,w)}z(this)};vh.prototype.clone=function(){return this._extend()};vh.prototype._extend=function(r){var s=Sg(this._options,r);return new vh(this.client,s)};var uI=vh,cI=c0,hI=uI,pI=mm;function f0(u){if(!u||!u.accessToken)throw new Error("Cannot create a client without an access token");cI(u.accessToken),this.accessToken=u.accessToken,this.origin=u.origin||pI.API_ORIGIN}f0.prototype.createRequest=function(r){return new hI(this,r)};var m0=f0,y0=YS,g0=m0;function Np(u){g0.call(this,u)}Np.prototype=Object.create(g0.prototype);Np.prototype.constructor=Np;Np.prototype.sendRequest=y0.browserSend;Np.prototype.abortRequest=y0.browserAbort;function dI(u){return new Np(u)}var _0=dI,fI=_0,mI=fI,yI=Object.prototype.toString,gI=function(u){var r;return yI.call(u)==="[object Object]"&&(r=Object.getPrototypeOf(u),r===null||r===Object.getPrototypeOf({}))},_I=gI,vI=Xp,v0="value",ky=`
  `,Gn={};Gn.assert=function(u,r){return r=r||{},function(s){var y=xh(u,s);if(!!y){var w=Ig(y,r);throw r.apiName&&(w=r.apiName+": "+w),new Error(w)}}};Gn.shape=function(r){var s=EI(r);return function(w){var z=xh(Gn.plainObject,w);if(z)return z;for(var f,p,L=[],N=0;N<s.length;N++)f=s[N].key,p=s[N].value,z=xh(p,w[f]),z&&L.push([f].concat(z));return L.length<2?L[0]:function(U){L=L.map(function(Se){var ge=Se[0],De=Ig(Se,U).split(`
`).join(ky);return"- "+ge+": "+De});var G=U.path.join("."),X=G===v0?"":" of "+G;return"The following properties"+X+" have invalid values:"+ky+L.join(ky)}}};Gn.strictShape=function(r){var s=Gn.shape(r);return function(w){var z=s(w);if(z)return z;var f=Object.keys(w).reduce(function(p,L){return r[L]===void 0&&p.push(L),p},[]);if(f.length!==0)return function(){return"The following keys are invalid: "+f.join(", ")}}};Gn.arrayOf=function(r){return x0(r)};Gn.tuple=function(){var r=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return x0(r)};function x0(u){var r=Array.isArray(u),s=function(y){return r?u[y]:u};return function(w){var z=xh(Gn.plainArray,w);if(z)return z;if(r&&w.length!==u.length)return"an array with "+u.length+" items";for(var f=0;f<w.length;f++)if(z=xh(s(f),w[f]),z)return[f].concat(z)}}Gn.required=function(r){function s(y){return y==null?function(w){return b0(w,w0(w.path)?"cannot be undefined/null.":"is required.")}:r.apply(this,arguments)}return s.__required=!0,s};Gn.oneOfType=function(){var r=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(y){var w=r.map(function(z){return xh(z,y)}).filter(Boolean);if(w.length===r.length)return w.every(function(z){return z.length===1&&typeof z[0]=="string"})?xI(w.map(function(z){return z[0]})):w.reduce(function(z,f){return f.length>z.length?f:z})}};Gn.equal=function(r){return function(y){if(y!==r)return JSON.stringify(r)}};Gn.oneOf=function(){var r=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),s=r.map(function(y){return Gn.equal(y)});return Gn.oneOfType.apply(this,s)};Gn.range=function(r){var s=r[0],y=r[1];return function(z){var f=xh(Gn.number,z);if(f||z<s||z>y)return"number between "+s+" & "+y+" (inclusive)"}};Gn.any=function(){};Gn.boolean=function(r){if(typeof r!="boolean")return"boolean"};Gn.number=function(r){if(typeof r!="number")return"number"};Gn.plainArray=function(r){if(!Array.isArray(r))return"array"};Gn.plainObject=function(r){if(!_I(r))return"object"};Gn.string=function(r){if(typeof r!="string")return"string"};Gn.func=function(r){if(typeof r!="function")return"function"};function xh(u,r){if(!(r==null&&!u.hasOwnProperty("__required"))){var s=u(r);if(s)return Array.isArray(s)?s:[s]}}function Ig(u,r){var s=u.length,y=u[s-1],w=u.slice(0,s-1);return w.length===0&&(w=[v0]),r=vI(r,{path:w}),typeof y=="function"?y(r):b0(r,bI(y))}function xI(u){return u.length<2?u[0]:u.length===2?u.join(" or "):u.slice(0,-1).join(", ")+", or "+u.slice(-1)}function bI(u){return"must be "+wI(u)+"."}function wI(u){return/^an? /.test(u)?u:/^[aeiou]/i.test(u)?"an "+u:/^[a-z]/i.test(u)?"a "+u:u}function b0(u,r){var s=w0(u.path),y=u.path.join(".")+" "+r,w=s?"Item at position ":"";return w+y}function w0(u){return typeof u[u.length-1]=="number"||typeof u[0]=="number"}function EI(u){return Object.keys(u||{}).map(function(r){return{key:r,value:u[r]}})}Gn.validate=xh;Gn.processMessage=Ig;var SI=Gn,II=Xp,Op=SI;function TI(u){if(typeof window!="undefined")return u instanceof Rl.Blob||u instanceof Rl.ArrayBuffer?void 0:"Blob or ArrayBuffer";if(!(typeof u=="string"||u.pipe!==void 0))return"Filename or Readable stream"}function AI(u,r){return Op.assert(Op.strictShape(u),r)}function CI(u){var r="date";if(typeof u=="boolean")return r;try{var s=new Date(u);if(s.getTime&&isNaN(s.getTime()))return r}catch{return r}}function kI(u){return Op.tuple(Op.number,Op.number)(u)}var zI=II(Op,{file:TI,date:CI,coordinates:kI,assertShape:AI});function PI(u,r){var s=function(y,w){return r.indexOf(y)!==-1&&w!==void 0};return typeof r=="function"&&(s=r),Object.keys(u).filter(function(y){return s(y,u[y])}).reduce(function(y,w){return y[w]=u[w],y},{})}var MI=PI;function LI(u,r){return Object.keys(u).reduce(function(s,y){return s[y]=r(y,u[y]),s},{})}var DI=LI,RI=DI;function BI(u){return RI(u,function(r,s){return typeof s=="boolean"?JSON.stringify(s):s})}var OI=BI,FI=m0,UI=_0;function NI(u){return function(r){var s;FI.prototype.isPrototypeOf(r)?s=r:s=UI(r);var y=Object.create(u);return y.client=s,y}}var jI=NI,E0=Xp,tn=zI,Kf=MI,S0=OI,VI=jI,Tg={},I0=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];Tg.forwardGeocode=function(u){tn.assertShape({query:tn.required(tn.string),mode:tn.oneOf("mapbox.places","mapbox.places-permanent"),countries:tn.arrayOf(tn.string),proximity:tn.oneOf(tn.coordinates,"ip"),types:tn.arrayOf(tn.oneOf(I0)),autocomplete:tn.boolean,bbox:tn.arrayOf(tn.number),limit:tn.number,language:tn.arrayOf(tn.string),routing:tn.boolean,fuzzyMatch:tn.boolean,worldview:tn.string})(u),u.mode=u.mode||"mapbox.places";var r=S0(E0({country:u.countries},Kf(u,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Kf(u,["mode","query"]),query:r})};Tg.reverseGeocode=function(u){tn.assertShape({query:tn.required(tn.coordinates),mode:tn.oneOf("mapbox.places","mapbox.places-permanent"),countries:tn.arrayOf(tn.string),types:tn.arrayOf(tn.oneOf(I0)),bbox:tn.arrayOf(tn.number),limit:tn.number,language:tn.arrayOf(tn.string),reverseMode:tn.oneOf("distance","score"),routing:tn.boolean,worldview:tn.string})(u),u.mode=u.mode||"mapbox.places";var r=S0(E0({country:u.countries},Kf(u,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:Kf(u,["mode","query"]),query:r})};var qI=VI(Tg);let GI="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",T0=u=>crypto.getRandomValues(new Uint8Array(u)),A0=(u,r,s)=>{let y=(2<<Math.log(u.length-1)/Math.LN2)-1,w=-~(1.6*y*r/u.length);return(z=r)=>{let f="";for(;;){let p=s(w),L=w;for(;L--;)if(f+=u[p[L]&y]||"",f.length===z)return f}}},ZI=(u,r=21)=>A0(u,r,T0),HI=(u=21)=>{let r="",s=crypto.getRandomValues(new Uint8Array(u));for(;u--;){let y=s[u]&63;y<36?r+=y.toString(36):y<62?r+=(y-26).toString(36).toUpperCase():y<63?r+="_":r+="-"}return r};var WI=Object.freeze(Object.defineProperty({__proto__:null,nanoid:HI,customAlphabet:ZI,customRandom:A0,urlAlphabet:GI,random:T0},Symbol.toStringTag,{value:"Module"})),XI=eS(WI),KI=XI.nanoid;function C0(u){this.origin=u.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=u.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=u,this.send=this.send.bind(this),this.countries=u.countries?u.countries.split(","):null,this.types=u.types?u.types.split(","):null,this.bbox=u.bbox?u.bbox:null,this.language=u.language?u.language.split(","):null,this.limit=u.limit?+u.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(u),this.eventQueue=new Array,this.flushInterval=u.flushInterval||1e3,this.maxQueueSize=u.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}C0.prototype={select:function(u,r){var s=this.getSelectedIndex(u,r),y=this.getEventPayload("search.select",r);if(y.resultIndex=s,y.resultPlaceName=u.place_name,y.resultId=u.id,!(s===this.lastSentIndex&&y.queryString===this.lastSentInput||s==-1)&&(this.lastSentIndex=s,this.lastSentInput=y.queryString,!!y.queryString))return this.push(y)},start:function(u){var r=this.getEventPayload("search.start",u);if(!!r.queryString)return this.push(r)},keyevent:function(u,r){if(!!u.key&&!(u.metaKey||[9,27,37,39,13,38,40].indexOf(u.keyCode)!==-1)){var s=this.getEventPayload("search.keystroke",r);if(s.lastAction=u.key,!!s.queryString)return this.push(s)}},send:function(u,r){if(!this.enableEventLogging)return r?r():void 0;var s=this.getRequestOptions(u);this.request(s,function(y){if(y)return this.handleError(y,r);if(r)return r()}.bind(this))},getRequestOptions:function(u){Array.isArray(u)||(u=[u]);var r={method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(u)};return r},getEventPayload:function(u,r){var s;r.options.proximity?typeof r.options.proximity=="object"?s=[r.options.proximity.longitude,r.options.proximity.latitude]:r.options.proximity==="ip"?s=[999,999]:s=r.options.proximity:s=null;var y=r._map?r._map.getZoom():void 0,w={event:u,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:r.options.autocomplete,fuzzyMatch:r.options.fuzzyMatch,proximity:s,limit:r.options.limit,routing:r.options.routing,worldview:r.options.worldview,mapZoom:y,keyboardLocale:this.locale};return u==="search.select"?w.queryString=r.inputString:u!="search.select"&&r._inputEl?w.queryString=r._inputEl.value:w.queryString=r.inputString,w},request:function(u,r){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(this.readyState==4)return this.status==204?r(null):r(this.statusText)},s.open(u.method,u.host+"/"+u.path,!0);for(var y in u.headers){var w=u.headers[y];s.setRequestHeader(y,w)}s.send(u.body)},handleError:function(u,r){if(r)return r(u)},generateSessionID:function(){return KI()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(u,r){if(!!r._typeahead){var s=r._typeahead.data,y=u.id,w=s.map(function(f){return f.id}),z=w.indexOf(y);return z}},shouldEnableLogging:function(u){return!(u.enableEventLogging===!1||u.origin&&u.origin.indexOf("api.mapbox.com")==-1||u.localGeocoder||u.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(u,r){this.eventQueue.push(u),(this.eventQueue.length>=this.maxQueueSize||r)&&this.flush()},remove:function(){this.flush()}};var JI=C0,YI={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05DC\u05D7\u05E4\u05E9",ja:"\u30B5\u30FC\u30C1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041F\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641C\u7D22",cs:"Vyhled\xE1v\xE1n\xED",hu:"Keres\xE9s",ka:"\u10EB\u10D8\u10D4\u10D1\u10D0",nb:"S\xF8ke",sk:"Vyh\u013Ead\xE1vanie",th:"\u0E04\u0E49\u0E19\u0E2B\u0E32",fi:"Hae",is:"Leita",ko:"\uC218\uC0C9",pl:"Szukaj",sl:"Iskanje",fa:"\u062C\u0633\u062A\u062C\u0648",ru:"\u041F\u043E\u0438\u0441\u043A"},$I={placeholder:YI},k0={exports:{}};(function(u){(function(r,s,y){u.exports?u.exports=y():r[s]=y()})(Rl,"subtag",function(){var r="",s=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function y(L){return L.match(s)||[]}function w(L){return y(L).filter(function(N,U){return N&&U})}function z(L){return L=y(L),{language:L[1]||r,extlang:L[2]||r,script:L[3]||r,region:L[4]||r}}function f(L,N,U){Object.defineProperty(L,N,{value:U,enumerable:!0})}function p(L,N,U){function G(X){return y(X)[L]||r}f(G,"pattern",N),f(z,U,G)}return p(1,/^[a-zA-Z]{2,3}$/,"language"),p(2,/^[a-zA-Z]{3}$/,"extlang"),p(3,/^[a-zA-Z]{4}$/,"script"),p(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),f(z,"split",w),z})})(k0);function z0(){}z0.prototype={isSupport:function(){return Boolean(window.navigator.geolocation)},getCurrentPosition:function(){const u={enableHighAccuracy:!0};return new Promise(function(r,s){window.navigator.geolocation.getCurrentPosition(r,s,u)})}};var QI=z0;function eT(u,r){const s=P0(u),y=["address","street","place","country"];var w;if(typeof r=="function")return r(s);const z=y.indexOf(r);return z===-1?w=y:w=y.slice(z),w.reduce(function(f,p){return s[p]?(f!==""&&(f=f+", "),f+s[p]):f},"")}function P0(u){const r=u.address||"",s=u.text||"",y=u.place_name||"",z={address:y.split(",")[0],houseNumber:r,street:s,placeName:y};return u.context.forEach(function(f){const p=f.id.split(".")[0];z[p]=f.text}),z}var tT={transformFeatureToGeolocationText:eT,getAddressInfo:P0},iT=uS,rT=AS,Kh=Xp,nT=wg.exports.EventEmitter,ov=DS,zy=mI,Py=qI,oT=JI,aT=$I,sT=k0.exports,lT=QI,uT=tT;const fh={FORWARD:0,LOCAL:1,REVERSE:2};function cT(){var u=document.createElement("div");return u.className="mapboxgl-ctrl-geocoder--powered-by",u.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',u}function M0(u){this._eventEmitter=new nT,this.options=Kh({},this.options,u),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new lT}M0.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(u){return u.place_name},render:function(u){var r=u.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+r[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+r.splice(1,r.length).join(",")+"</div></div>"}},addTo:function(u){function r(s,y){if(!document.body.contains(y))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const w=s.onAdd();y.appendChild(w)}if(u._controlContainer)u.addControl(this);else if(u instanceof HTMLElement)r(this,u);else if(typeof u=="string"){const s=document.querySelectorAll(u);if(s.length===0)throw new Error("Element ",u,"not found.");if(s.length>1)throw new Error("Geocoder can only be added to a single html element");r(this,s[0])}else throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(u){if(u&&typeof u!="string"&&(this._map=u),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=Py(zy({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new oT(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var r=this.container=document.createElement("div");r.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var s=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",rT(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",function(N){this.eventManager.keyevent(N,this)}.bind(this));var y=document.createElement("div");y.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var w=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(w),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),y.appendChild(this._clearEl),y.appendChild(this._loadingEl),r.appendChild(s),r.appendChild(this._inputEl),r.appendChild(y),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var z=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(z),y.appendChild(this._geolocateEl),this._showGeolocateButton()}var f=this._typeahead=new iT(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),f.getItemValue=this.options.getItemValue;var p=f.list.draw,L=this._footerNode=cT();return f.list.draw=function(){p.call(this),L.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),L.addEventListener("mouseup",function(){this.selectingListItem=!1}.bind(this)),this.element.appendChild(L)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),r},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then(function(u){this._hideLoadingIcon();const r={geometry:{type:"Point",coordinates:[u.coords.longitude,u.coords.latitude]}};this._handleMarker(r),this._fly(r),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(r),this._showClearButton(),this.fresh=!1;const s={limit:1,language:[this.options.language],query:r.geometry.coordinates,types:["address"]};if(this.options.localGeocoderOnly){const y=r.geometry.coordinates[0]+","+r.geometry.coordinates[1];this._setInputValue(y),this._eventEmitter.emit("result",{result:r})}else this.geocoderService.reverseGeocode(s).send().then(function(y){const w=y.body.features[0];if(w){const z=uT.transformFeatureToGeolocationText(w,this.options.addressAccuracy);this._setInputValue(z),w.user_coordinates=r.geometry.coordinates,this._eventEmitter.emit("result",{result:w})}else this._eventEmitter.emit("result",{result:{user_coordinates:r.geometry.coordinates}})}.bind(this))}.bind(this)).catch(function(u){u.code===1?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}.bind(this))},createIcon:function(u,r){var s=document.createElementNS("http://www.w3.org/2000/svg","svg");return s.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+u),s.setAttribute("viewBox","0 0 18 18"),s.setAttribute("xml:space","preserve"),s.setAttribute("width",18),s.setAttribute("height",18),s.innerHTML=r,s},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(u){this._inputEl.value=u,setTimeout(function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}.bind(this),1)},_onPaste:function(u){var r=(u.clipboardData||window.clipboardData).getData("text");r.length>=this.options.minLength&&this._geocode(r)},_onKeyDown:function(u){var r=27,s=9;if(u.keyCode===r&&this.options.clearAndBlurOnEsc)return this._clear(u),this._inputEl.blur();var y=u.target&&u.target.shadowRoot?u.target.shadowRoot.activeElement:u.target,w=y?y.value:"";if(!w)return this.fresh=!0,u.keyCode!==s&&this.clear(u),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!(u.metaKey||[s,r,37,39,13,38,40].indexOf(u.keyCode)!==-1)&&y.value.length>=this.options.minLength&&this._geocode(y.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(u){this.options.clearOnBlur&&this._clearOnBlur(u),this.options.collapsed&&this._collapse()},_onChange:function(){var u=this._typeahead.selected;u&&JSON.stringify(u)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(u),this.options.marker&&this._mapboxgl&&this._handleMarker(u),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(u),this._eventEmitter.emit("result",{result:u}),this.eventManager.select(u,this))},_fly:function(u){var r;if(u.properties&&ov[u.properties.short_code])r=Kh({},this.options.flyTo),this._map&&this._map.fitBounds(ov[u.properties.short_code].bbox,r);else if(u.bbox){var s=u.bbox;r=Kh({},this.options.flyTo),this._map&&this._map.fitBounds([[s[0],s[1]],[s[2],s[3]]],r)}else{var y={zoom:this.options.zoom};r=Kh({},y,this.options.flyTo),u.center?r.center=u.center:u.geometry&&u.geometry.type&&u.geometry.type==="Point"&&u.geometry.coordinates&&(r.center=u.geometry.coordinates),this._map&&this._map.flyTo(r)}},_requestType:function(u,r){var s;const y=/^[ ]*(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/;return u.localGeocoderOnly?s=fh.LOCAL:u.reverseGeocode&&y.test(r)?s=fh.REVERSE:s=fh.FORWARD,s},_setupConfig:function(u,r){const s=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"],y=/[\s,]+/;var w=this,z=s.reduce(function(p,L){if(w.options[L]===void 0||w.options[L]===null)return p;["countries","types","language"].indexOf(L)>-1?p[L]=w.options[L].split(y):p[L]=w.options[L];const N=typeof w.options[L].longitude=="number"&&typeof w.options[L].latitude=="number";if(L==="proximity"&&N){const U=w.options[L].longitude,G=w.options[L].latitude;p[L]=[U,G]}return p},{});switch(u){case fh.REVERSE:{var f=r.split(y).map(function(p){return parseFloat(p,10)});w.options.flipCoordinates||f.reverse(),z.types&&z.types[0],z=Kh(z,{query:f,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(p){p in z&&delete z[p]})}break;case fh.FORWARD:/^[ ]*(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)*[ ]*$/.test(r)&&(r=r.replace(/,/g," ")),z=Kh(z,{query:r});break}return z},_geocode:function(u){this.inputString=u,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:u});const r=this._requestType(this.options,u),s=this._setupConfig(r,u);var y;switch(r){case fh.LOCAL:y=Promise.resolve();break;case fh.FORWARD:y=this.geocoderService.forwardGeocode(s).send();break;case fh.REVERSE:y=this.geocoderService.reverseGeocode(s).send();break}var w=this.options.localGeocoder?this.options.localGeocoder(u)||[]:[],z=[],f=null;return y.catch(function(p){f=p}.bind(this)).then(function(p){this._hideLoadingIcon();var L={};return p?p.statusCode=="200"&&(L=p.body,L.request=p.request,L.headers=p.headers):L={type:"FeatureCollection",features:[]},L.config=s,this.fresh&&(this.eventManager.start(this),this.fresh=!1),L.features=L.features?w.concat(L.features):w,this.options.externalGeocoder?(z=this.options.externalGeocoder(u,L.features)||Promise.resolve([]),z.then(function(N){return L.features=L.features?N.concat(L.features):N,L},function(){return L})):L}.bind(this)).then(function(p){if(f)throw f;this.options.filter&&p.features.length&&(p.features=p.features.filter(this.options.filter)),p.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",p),this._typeahead.update(p.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",p))}.bind(this)).catch(function(p){this._hideLoadingIcon(),this._hideAttribution(),w.length&&this.options.localGeocoder||z.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(w)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:w}),this._eventEmitter.emit("error",{error:p})}.bind(this)),y},_clear:function(u){u&&u.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(u){this._clear(u),this._inputEl.focus()},_clearOnBlur:function(u){var r=this;u.relatedTarget&&r._clear(u)},_onQueryResult:function(u){var r=u.body;if(!!r.features.length){var s=r.features[0];this._typeahead.selected=s,this._inputEl.value=s.place_name,this._onChange()}},_updateProximity:function(){if(!(!this._map||!this.options.trackProximity))if(this._map.getZoom()>9){var u=this._map.getCenter().wrap();this.setProximity({longitude:u.lng,latitude:u.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(u){return this._geocode(u).then(this._onQueryResult),this},_renderError:function(){var u="<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(u)},_renderLocationError:function(){var u="<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>";this._renderMessage(u)},_renderNoResults:function(){var u="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>";this._renderMessage(u)},_renderUserDeniedGeolocationError:function(){var u="<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>";this._renderMessage(u)},_renderMessage:function(u){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(u)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var u=this.options.language.split(",")[0],r=sT.language(u),s=aT.placeholder[r];if(s)return s}return"Search"},setInput:function(u){return this._inputEl.value=u,this._typeahead.selected=null,this._typeahead.clear(),u.length>=this.options.minLength&&this._geocode(u),this},setProximity:function(u,r=!0){return this.options.proximity=u,r&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(u){return u&&typeof u=="function"&&(this._typeahead.render=u),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(u){var r=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=u||this.options.language||r,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(u){return this.options.zoom=u,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(u){return this.options.flyTo=u,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(u){return this.placeholder=u||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(u){return this.options.bbox=u,this},getCountries:function(){return this.options.countries},setCountries:function(u){return this.options.countries=u,this},getTypes:function(){return this.options.types},setTypes:function(u){return this.options.types=u,this},getMinLength:function(){return this.options.minLength},setMinLength:function(u){return this.options.minLength=u,this._typeahead&&(this._typeahead.options.minLength=u),this},getLimit:function(){return this.options.limit},setLimit:function(u){return this.options.limit=u,this._typeahead&&(this._typeahead.options.limit=u),this},getFilter:function(){return this.options.filter},setFilter:function(u){return this.options.filter=u,this},setOrigin:function(u){return this.options.origin=u,this.geocoderService=Py(zy({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(u){return this.options.accessToken=u,this.geocoderService=Py(zy({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(u){return this.options.autocomplete=u,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(u){return this.options.fuzzyMatch=u,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(u){return this.options.routing=u,this},getRouting:function(){return this.options.routing},setWorldview:function(u){return this.options.worldview=u,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(u){if(!!this._map){this._removeMarker();var r={color:"#4668F2"},s=Kh({},r,this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(s),u.center?this.mapMarker.setLngLat(u.center).addTo(this._map):u.geometry&&u.geometry.type&&u.geometry.type==="Point"&&u.geometry.coordinates&&this.mapMarker.setLngLat(u.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(u,r){return this._eventEmitter.on(u,r),this},off:function(u,r){return this._eventEmitter.removeListener(u,r),this.eventManager.remove(),this}};var hT=M0,L0={};Object.defineProperty(L0,"__esModule",{value:!0});class _h{constructor(r,s){this.areas=r||_h.DEFAULT_AREAS,this.limit_no_areas=s||_h.DEFAULT_NO_AREAS,this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}onAdd(r){this.map=r;const s=this;if(this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.areas.length<=this.limit_no_areas){this.mapAreaContainer=document.createElement("div"),this.areaButton=document.createElement("button"),this.mapAreaContainer.classList.add("mapboxgl-area-list");for(const y of this.areas){const w=document.createElement("button");w.innerText=y.title,w.classList.add(y.title.replace(/[^a-z0-9-]/gi,"_")),w.value=JSON.stringify({center:y.latlng,zoom:y.zoom}),w.addEventListener("click",z=>{const f=z.srcElement;this.map.jumpTo(JSON.parse(f.value)),this.mapAreaContainer.style.display="none",this.areaButton.style.display="block";const p=this.mapAreaContainer.getElementsByClassName("active");for(;p[0];)p[0].classList.remove("active");f.classList.add("active")}),y.title===_h.DEFAULT_AREA&&w.classList.add("active"),this.mapAreaContainer.appendChild(w)}this.areaButton.classList.add("mapboxgl-ctrl-icon"),this.areaButton.classList.add("mapboxgl-area-switcher"),this.areaButton.addEventListener("click",()=>{this.areaButton.style.display="none",this.mapAreaContainer.style.display="block"}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.areaButton),this.controlContainer.appendChild(this.mapAreaContainer)}else this.controlContainer.classList.add("mapboxgl-ctrl-area-switch"),this.select=document.createElement("select"),this.select.setAttribute("type","select"),this.select.addEventListener("change",function(y){!y.target||s.map.flyTo(JSON.parse(y.target[this.selectedIndex].value))}),this.controlContainer.appendChild(this.select),this.areas.forEach(function(y){var w=document.createElement("option");w.setAttribute("type","option"),w.text=y.title,w.value=JSON.stringify({center:y.latlng,zoom:y.zoom}),s.select.appendChild(w)});return this.controlContainer}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.areaButton||(this.areaButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.map=void 0)}onDocumentClick(r){this.controlContainer&&!this.controlContainer.contains(r.target)&&this.mapAreaContainer&&this.areaButton&&(this.mapAreaContainer.style.display="none",this.areaButton.style.display="block")}}var pT=L0.default=_h;_h.DEFAULT_AREA="Narok";_h.DEFAULT_AREAS=[{title:"Narok",latlng:[35.86974,-1.08707],zoom:13},{title:"Nairobi",latlng:[36.8034,-1.2809],zoom:11},{title:"Mombasa",latlng:[39.65449,-4.05099],zoom:12}];_h.DEFAULT_NO_AREAS=5;var D0={},Ag={exports:{}};(function(u,r){(function(s,y){u.exports=y()})(Rl,function(){var s,y,w;function z(f,p){if(!s)s=p;else if(!y)y=p;else{var L="var sharedChunk = {}; ("+s+")(sharedChunk); ("+y+")(sharedChunk);",N={};s(N),w=p(N),typeof window!="undefined"&&(w.workerUrl=window.URL.createObjectURL(new Blob([L],{type:"text/javascript"})))}}return z(["exports"],function(f){function p(e,n){return e(n={exports:{}},n.exports),n.exports}var L=N;function N(e,n,l,v){this.cx=3*e,this.bx=3*(l-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(v-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=v,this.p2x=l,this.p2y=v}N.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},N.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},N.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},N.prototype.solveCurveX=function(e,n){var l,v,E,C,i;for(n===void 0&&(n=1e-6),E=e,i=0;i<8;i++){if(C=this.sampleCurveX(E)-e,Math.abs(C)<n)return E;var t=this.sampleCurveDerivativeX(E);if(Math.abs(t)<1e-6)break;E-=C/t}if((E=e)<(l=0))return l;if(E>(v=1))return v;for(;l<v;){if(C=this.sampleCurveX(E),Math.abs(C-e)<n)return E;e>C?l=E:v=E,E=.5*(v-l)+l}return E},N.prototype.solve=function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))};var U=G;function G(e,n){this.x=e,this.y=n}G.prototype={clone:function(){return new G(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,n){return this.clone()._rotateAround(e,n)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var n=e.x-this.x,l=e.y-this.y;return n*n+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,n){return Math.atan2(this.x*n-this.y*e,this.x*e+this.y*n)},_matMult:function(e){var n=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=n,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var n=Math.cos(e),l=Math.sin(e),v=l*this.x+n*this.y;return this.x=n*this.x-l*this.y,this.y=v,this},_rotateAround:function(e,n){var l=Math.cos(e),v=Math.sin(e),E=n.y+v*(this.x-n.x)+l*(this.y-n.y);return this.x=n.x+l*(this.x-n.x)-v*(this.y-n.y),this.y=E,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},G.convert=function(e){return e instanceof G?e:Array.isArray(e)?new G(e[0],e[1]):e};var X=typeof self!="undefined"?self:{},Se=Math.pow(2,53)-1;function ge(e,n,l,v){var E=new L(e,n,l,v);return function(C){return E.solve(C)}}var De=ge(.25,.1,.25,1);function Le(e,n,l){return Math.min(l,Math.max(n,e))}function ft(e,n,l){var v=l-n,E=((e-n)%v+v)%v+n;return E===n?l:E}function Ue(e){for(var n=[],l=arguments.length-1;l-- >0;)n[l]=arguments[l+1];for(var v=0,E=n;v<E.length;v+=1){var C=E[v];for(var i in C)e[i]=C[i]}return e}var Re=1;function st(){return Re++}function ut(){return function e(n){return n?(n^16*Math.random()>>n/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function ht(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function at(e,n){e.forEach(function(l){n[l]&&(n[l]=n[l].bind(n))})}function $t(e,n){return e.indexOf(n,e.length-n.length)!==-1}function xt(e,n,l){var v={};for(var E in e)v[E]=n.call(l||this,e[E],E,e);return v}function qt(e,n,l){var v={};for(var E in e)n.call(l||this,e[E],E,e)&&(v[E]=e[E]);return v}function _i(e){return Array.isArray(e)?e.map(_i):typeof e=="object"&&e?xt(e,_i):e}var Ri={};function Ht(e){Ri[e]||(typeof console!="undefined"&&console.warn(e),Ri[e]=!0)}function Qt(e,n,l){return(l.y-e.y)*(n.x-e.x)>(n.y-e.y)*(l.x-e.x)}function Si(e){for(var n=0,l=0,v=e.length,E=v-1,C=void 0,i=void 0;l<v;E=l++)n+=((i=e[E]).x-(C=e[l]).x)*(C.y+i.y);return n}function bt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Fi(e){var n={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(v,E,C,i){var t=C||i;return n[E]=!t||t.toLowerCase(),""}),n["max-age"]){var l=parseInt(n["max-age"],10);isNaN(l)?delete n["max-age"]:n["max-age"]=l}return n}var Dt=null;function bi(e){if(Dt==null){var n=e.navigator?e.navigator.userAgent:null;Dt=!!e.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Dt}function zt(e){try{var n=X[e];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}}var Yt,Et,xi,Gt,Ji=X.performance&&X.performance.now?X.performance.now.bind(X.performance):Date.now.bind(Date),Ni=X.requestAnimationFrame||X.mozRequestAnimationFrame||X.webkitRequestAnimationFrame||X.msRequestAnimationFrame,Ai=X.cancelAnimationFrame||X.mozCancelAnimationFrame||X.webkitCancelAnimationFrame||X.msCancelAnimationFrame,or={now:Ji,frame:function(e){var n=Ni(e);return{cancel:function(){return Ai(n)}}},getImageData:function(e,n){n===void 0&&(n=0);var l=X.document.createElement("canvas"),v=l.getContext("2d");if(!v)throw new Error("failed to create canvas 2d context");return l.width=e.width,l.height=e.height,v.drawImage(e,0,0,e.width,e.height),v.getImageData(-n,-n,e.width+2*n,e.height+2*n)},resolveURL:function(e){return Yt||(Yt=X.document.createElement("a")),Yt.href=e,Yt.href},hardwareConcurrency:X.navigator&&X.navigator.hardwareConcurrency||4,get devicePixelRatio(){return X.devicePixelRatio},get prefersReducedMotion(){return!!X.matchMedia&&(Et==null&&(Et=X.matchMedia("(prefers-reduced-motion: reduce)")),Et.matches)}},Li={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Mt={supported:!1,testSupport:function(e){!rr&&Gt&&(Ft?rt(e):xi=e)}},rr=!1,Ft=!1;function rt(e){var n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Gt),e.isContextLost())return;Mt.supported=!0}catch{}e.deleteTexture(n),rr=!0}X.document&&((Gt=X.document.createElement("img")).onload=function(){xi&&rt(xi),xi=null,Ft=!0},Gt.onerror=function(){rr=!0,xi=null},Gt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var wi="01",nr=function(e,n){this._transformRequestFn=e,this._customAccessToken=n,this._createSkuToken()};function Pr(e){return e.indexOf("mapbox:")===0}nr.prototype._createSkuToken=function(){var e=function(){for(var n="",l=0;l<10;l++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",wi,n].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},nr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},nr.prototype.transformRequest=function(e,n){return this._transformRequestFn&&this._transformRequestFn(e,n)||{url:e}},nr.prototype.normalizeStyleURL=function(e,n){if(!Pr(e))return e;var l=xn(e);return l.path="/styles/v1"+l.path,this._makeAPIURL(l,this._customAccessToken||n)},nr.prototype.normalizeGlyphsURL=function(e,n){if(!Pr(e))return e;var l=xn(e);return l.path="/fonts/v1"+l.path,this._makeAPIURL(l,this._customAccessToken||n)},nr.prototype.normalizeSourceURL=function(e,n){if(!Pr(e))return e;var l=xn(e);return l.path="/v4/"+l.authority+".json",l.params.push("secure"),this._makeAPIURL(l,this._customAccessToken||n)},nr.prototype.normalizeSpriteURL=function(e,n,l,v){var E=xn(e);return Pr(e)?(E.path="/styles/v1"+E.path+"/sprite"+n+l,this._makeAPIURL(E,this._customAccessToken||v)):(E.path+=""+n+l,po(E))},nr.prototype.normalizeTileURL=function(e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Pr(e))return e;var l=xn(e);l.path=l.path.replace(/(\.(png|jpg)\d*)(?=$)/,(or.devicePixelRatio>=2||n===512?"@2x":"")+(Mt.supported?".webp":"$1")),l.path=l.path.replace(/^.+\/v4\//,"/"),l.path="/v4"+l.path;var v=this._customAccessToken||function(E){for(var C=0,i=E;C<i.length;C+=1){var t=i[C].match(/^access_token=(.*)$/);if(t)return t[1]}return null}(l.params)||Li.ACCESS_TOKEN;return Li.REQUIRE_ACCESS_TOKEN&&v&&this._skuToken&&l.params.push("sku="+this._skuToken),this._makeAPIURL(l,v)},nr.prototype.canonicalizeTileURL=function(e,n){var l=xn(e);if(!l.path.match(/(^\/v4\/)/)||!l.path.match(/\.[\w]+$/))return e;var v="mapbox://tiles/";v+=l.path.replace("/v4/","");var E=l.params;return n&&(E=E.filter(function(C){return!C.match(/^access_token=/)})),E.length&&(v+="?"+E.join("&")),v},nr.prototype.canonicalizeTileset=function(e,n){for(var l=!!n&&Pr(n),v=[],E=0,C=e.tiles||[];E<C.length;E+=1){var i=C[E];Jn(i)?v.push(this.canonicalizeTileURL(i,l)):v.push(i)}return v},nr.prototype._makeAPIURL=function(e,n){var l="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",v=xn(Li.API_URL);if(e.protocol=v.protocol,e.authority=v.authority,e.protocol==="http"){var E=e.params.indexOf("secure");E>=0&&e.params.splice(E,1)}if(v.path!=="/"&&(e.path=""+v.path+e.path),!Li.REQUIRE_ACCESS_TOKEN)return po(e);if(!(n=n||Li.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+l);if(n[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+l);return e.params=e.params.filter(function(C){return C.indexOf("access_token")===-1}),e.params.push("access_token="+n),po(e)};var ho=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Jn(e){return ho.test(e)}var Fo=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function xn(e){var n=e.match(Fo);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function po(e){var n=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+n}function Yn(e){if(!e)return null;var n=e.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(decodeURIComponent(X.atob(n[1]).split("").map(function(l){return"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Wi=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Wi.prototype.getStorageKey=function(e){var n,l=Yn(Li.ACCESS_TOKEN);return n=l&&l.u?X.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,function(v,E){return String.fromCharCode(Number("0x"+E))})):Li.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+n:"mapbox.eventData:"+n},Wi.prototype.fetchEventData=function(){var e=zt("localStorage"),n=this.getStorageKey(),l=this.getStorageKey("uuid");if(e)try{var v=X.localStorage.getItem(n);v&&(this.eventData=JSON.parse(v));var E=X.localStorage.getItem(l);E&&(this.anonId=E)}catch{Ht("Unable to read from LocalStorage")}},Wi.prototype.saveEventData=function(){var e=zt("localStorage"),n=this.getStorageKey(),l=this.getStorageKey("uuid");if(e)try{X.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&X.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{Ht("Unable to write to LocalStorage")}},Wi.prototype.processRequests=function(e){},Wi.prototype.postEvent=function(e,n,l,v){var E=this;if(Li.EVENTS_URL){var C=xn(Li.EVENTS_URL);C.params.push("access_token="+(v||Li.ACCESS_TOKEN||""));var i={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:wi,userId:this.anonId},t=n?Ue(i,n):i,a={url:po(C),headers:{"Content-Type":"text/plain"},body:JSON.stringify([t])};this.pendingRequest=Xr(a,function(h){E.pendingRequest=null,l(h),E.saveEventData(),E.processRequests(v)})}},Wi.prototype.queueRequest=function(e,n){this.queue.push(e),this.processRequests(n)};var Nn,Ao,$n=function(e){function n(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.postMapLoadEvent=function(l,v,E,C){this.skuToken=E,(Li.EVENTS_URL&&C||Li.ACCESS_TOKEN&&Array.isArray(l)&&l.some(function(i){return Pr(i)||Jn(i)}))&&this.queueRequest({id:v,timestamp:Date.now()},C)},n.prototype.processRequests=function(l){var v=this;if(!this.pendingRequest&&this.queue.length!==0){var E=this.queue.shift(),C=E.id,i=E.timestamp;C&&this.success[C]||(this.anonId||this.fetchEventData(),ht(this.anonId)||(this.anonId=ut()),this.postEvent(i,{skuToken:this.skuToken},function(t){t||C&&(v.success[C]=!0)},l))}},n}(Wi),Ua=new(function(e){function n(l){e.call(this,"appUserTurnstile"),this._customAccessToken=l}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.postTurnstileEvent=function(l,v){Li.EVENTS_URL&&Li.ACCESS_TOKEN&&Array.isArray(l)&&l.some(function(E){return Pr(E)||Jn(E)})&&this.queueRequest(Date.now(),v)},n.prototype.processRequests=function(l){var v=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var E=Yn(Li.ACCESS_TOKEN),C=E?E.u:Li.ACCESS_TOKEN,i=C!==this.eventData.tokenU;ht(this.anonId)||(this.anonId=ut(),i=!0);var t=this.queue.shift();if(this.eventData.lastSuccess){var a=new Date(this.eventData.lastSuccess),h=new Date(t),_=(t-this.eventData.lastSuccess)/864e5;i=i||_>=1||_<-1||a.getDate()!==h.getDate()}else i=!0;if(!i)return this.processRequests();this.postEvent(t,{"enabled.telemetry":!1},function(b){b||(v.eventData.lastSuccess=t,v.eventData.tokenU=C)},l)}},n}(Wi)),qe=Ua.postTurnstileEvent.bind(Ua),_t=new $n,Ci=_t.postMapLoadEvent.bind(_t),fr=500,wr=50;function Qn(){X.caches&&!Nn&&(Nn=X.caches.open("mapbox-tiles"))}function eo(e){var n=e.indexOf("?");return n<0?e:e.slice(0,n)}var sa,$r=1/0;function Jt(){return sa==null&&(sa=X.OffscreenCanvas&&new X.OffscreenCanvas(1,1).getContext("2d")&&typeof X.createImageBitmap=="function"),sa}var ar={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ar);var Yi=function(e){function n(l,v,E){v===401&&Jn(E)&&(l+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,l),this.status=v,this.url=E,this.name=this.constructor.name,this.message=l}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},n}(Error),Rn=bt()?function(){return self.worker&&self.worker.referrer}:function(){return(X.location.protocol==="blob:"?X.parent:X).location.href},to,Gi,_a=function(e,n){if(!(/^file:/.test(l=e.url)||/^file:/.test(Rn())&&!/^\w+:/.test(l))){if(X.fetch&&X.Request&&X.AbortController&&X.Request.prototype.hasOwnProperty("signal"))return function(v,E){var C,i=new X.AbortController,t=new X.Request(v.url,{method:v.method||"GET",body:v.body,credentials:v.credentials,headers:v.headers,referrer:Rn(),signal:i.signal}),a=!1,h=!1,_=(C=t.url).indexOf("sku=")>0&&Jn(C);v.type==="json"&&t.headers.set("Accept","application/json");var b=function(P,R,O){if(!h){if(P&&P.message!=="SecurityError"&&Ht(P),R&&O)return S(R);var V=Date.now();X.fetch(t).then(function(j){if(j.ok){var K=_?j.clone():null;return S(j,K,V)}return E(new Yi(j.statusText,j.status,v.url))}).catch(function(j){j.code!==20&&E(new Error(j.message))})}},S=function(P,R,O){(v.type==="arrayBuffer"?P.arrayBuffer():v.type==="json"?P.json():P.text()).then(function(V){h||(R&&O&&function(j,K,$){if(Qn(),Nn){var Q={status:K.status,statusText:K.statusText,headers:new X.Headers};K.headers.forEach(function(pe,ke){return Q.headers.set(ke,pe)});var se=Fi(K.headers.get("Cache-Control")||"");se["no-store"]||(se["max-age"]&&Q.headers.set("Expires",new Date($+1e3*se["max-age"]).toUTCString()),new Date(Q.headers.get("Expires")).getTime()-$<42e4||function(pe,ke){if(Ao===void 0)try{new Response(new ReadableStream),Ao=!0}catch{Ao=!1}Ao?ke(pe.body):pe.blob().then(ke)}(K,function(pe){var ke=new X.Response(pe,Q);Qn(),Nn&&Nn.then(function(Ne){return Ne.put(eo(j.url),ke)}).catch(function(Ne){return Ht(Ne.message)})}))}}(t,R,O),a=!0,E(null,V,P.headers.get("Cache-Control"),P.headers.get("Expires")))}).catch(function(V){h||E(new Error(V.message))})};return _?function(P,R){if(Qn(),!Nn)return R(null);var O=eo(P.url);Nn.then(function(V){V.match(O).then(function(j){var K=function($){if(!$)return!1;var Q=new Date($.headers.get("Expires")||0),se=Fi($.headers.get("Cache-Control")||"");return Q>Date.now()&&!se["no-cache"]}(j);V.delete(O),K&&V.put(O,j.clone()),R(null,j,K)}).catch(R)}).catch(R)}(t,b):b(null,null),{cancel:function(){h=!0,a||i.abort()}}}(e,n);if(bt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,n,void 0,!0)}var l;return function(v,E){var C=new X.XMLHttpRequest;for(var i in C.open(v.method||"GET",v.url,!0),v.type==="arrayBuffer"&&(C.responseType="arraybuffer"),v.headers)C.setRequestHeader(i,v.headers[i]);return v.type==="json"&&(C.responseType="text",C.setRequestHeader("Accept","application/json")),C.withCredentials=v.credentials==="include",C.onerror=function(){E(new Error(C.statusText))},C.onload=function(){if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){var t=C.response;if(v.type==="json")try{t=JSON.parse(C.response)}catch(a){return E(a)}E(null,t,C.getResponseHeader("Cache-Control"),C.getResponseHeader("Expires"))}else E(new Yi(C.statusText,C.status,v.url))},C.send(v.body),{cancel:function(){return C.abort()}}}(e,n)},Uo=function(e,n){return _a(Ue(e,{type:"arrayBuffer"}),n)},Xr=function(e,n){return _a(Ue(e,{method:"POST"}),n)},te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";to=[],Gi=0;var oe=function(e,n){if(Mt.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),Gi>=Li.MAX_PARALLEL_IMAGE_REQUESTS){var l={requestParameters:e,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return to.push(l),l}Gi++;var v=!1,E=function(){if(!v)for(v=!0,Gi--;to.length&&Gi<Li.MAX_PARALLEL_IMAGE_REQUESTS;){var i=to.shift();i.cancelled||(i.cancel=oe(i.requestParameters,i.callback).cancel)}},C=Uo(e,function(i,t,a,h){E(),i?n(i):t&&(Jt()?function(_,b){var S=new X.Blob([new Uint8Array(_)],{type:"image/png"});X.createImageBitmap(S).then(function(P){b(null,P)}).catch(function(P){b(new Error("Could not load image because of "+P.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(t,n):function(_,b,S,P){var R=new X.Image,O=X.URL;R.onload=function(){b(null,R),O.revokeObjectURL(R.src),R.onload=null,X.requestAnimationFrame(function(){R.src=te})},R.onerror=function(){return b(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var V=new X.Blob([new Uint8Array(_)],{type:"image/png"});R.cacheControl=S,R.expires=P,R.src=_.byteLength?O.createObjectURL(V):te}(t,n,a,h))});return{cancel:function(){C.cancel(),E()}}};function le(e,n,l){l[e]&&l[e].indexOf(n)!==-1||(l[e]=l[e]||[],l[e].push(n))}function _e(e,n,l){if(l&&l[e]){var v=l[e].indexOf(n);v!==-1&&l[e].splice(v,1)}}var Ae=function(e,n){n===void 0&&(n={}),Ue(this,n),this.type=e},je=function(e){function n(l,v){v===void 0&&(v={}),e.call(this,"error",Ue({error:l},v))}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(Ae),Ge=function(){};Ge.prototype.on=function(e,n){return this._listeners=this._listeners||{},le(e,n,this._listeners),this},Ge.prototype.off=function(e,n){return _e(e,n,this._listeners),_e(e,n,this._oneTimeListeners),this},Ge.prototype.once=function(e,n){return this._oneTimeListeners=this._oneTimeListeners||{},le(e,n,this._oneTimeListeners),this},Ge.prototype.fire=function(e,n){typeof e=="string"&&(e=new Ae(e,n||{}));var l=e.type;if(this.listens(l)){e.target=this;for(var v=0,E=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];v<E.length;v+=1)E[v].call(this,e);for(var C=0,i=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];C<i.length;C+=1){var t=i[C];_e(l,t,this._oneTimeListeners),t.call(this,e)}var a=this._eventedParent;a&&(Ue(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),a.fire(e))}else e instanceof je&&console.error(e.error);return this},Ge.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Ge.prototype.setEventedParent=function(e,n){return this._eventedParent=e,this._eventedParentData=n,this};var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Me=function(e,n,l,v){this.message=(e?e+": ":"")+l,v&&(this.identifier=v),n!=null&&n.__line__&&(this.line=n.__line__)};function Qe(e){var n=e.value;return n?[new Me(e.key,n,"constants have been deprecated as of v8")]:[]}function ae(e){for(var n=[],l=arguments.length-1;l-- >0;)n[l]=arguments[l+1];for(var v=0,E=n;v<E.length;v+=1){var C=E[v];for(var i in C)e[i]=C[i]}return e}function H(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function W(e){if(Array.isArray(e))return e.map(W);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var n={};for(var l in e)n[l]=W(e[l]);return n}return H(e)}var ne=function(e){function n(l,v){e.call(this,v),this.message=v,this.key=l}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(Error),ce=function(e,n){n===void 0&&(n=[]),this.parent=e,this.bindings={};for(var l=0,v=n;l<v.length;l+=1){var E=v[l];this.bindings[E[0]]=E[1]}};ce.prototype.concat=function(e){return new ce(this,e)},ce.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},ce.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var ve={kind:"null"},fe={kind:"number"},Ie={kind:"string"},Ee={kind:"boolean"},Te={kind:"color"},et={kind:"object"},Ke={kind:"value"},tt={kind:"collator"},jt={kind:"formatted"},Ct={kind:"resolvedImage"};function Ut(e,n){return{kind:"array",itemType:e,N:n}}function Zt(e){if(e.kind==="array"){var n=Zt(e.itemType);return typeof e.N=="number"?"array<"+n+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+n+">"}return e.kind}var Xi=[ve,fe,Ie,Ee,Te,jt,et,Ut(Ke),Ct];function vi(e,n){if(n.kind==="error")return null;if(e.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!vi(e.itemType,n.itemType))&&(typeof e.N!="number"||e.N===n.N))return null}else{if(e.kind===n.kind)return null;if(e.kind==="value"){for(var l=0,v=Xi;l<v.length;l+=1)if(!vi(v[l],n))return null}}return"Expected "+Zt(e)+" but found "+Zt(n)+" instead."}function Pi(e,n){return n.some(function(l){return l.kind===e.kind})}function di(e,n){return n.some(function(l){return l==="null"?e===null:l==="array"?Array.isArray(e):l==="object"?e&&!Array.isArray(e)&&typeof e=="object":l===typeof e})}var ei=p(function(e,n){var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function v(t){return(t=Math.round(t))<0?0:t>255?255:t}function E(t){return v(t[t.length-1]==="%"?parseFloat(t)/100*255:parseInt(t))}function C(t){return(a=t[t.length-1]==="%"?parseFloat(t)/100:parseFloat(t))<0?0:a>1?1:a;var a}function i(t,a,h){return h<0?h+=1:h>1&&(h-=1),6*h<1?t+(a-t)*h*6:2*h<1?a:3*h<2?t+(a-t)*(2/3-h)*6:t}try{n.parseCSSColor=function(t){var a,h=t.replace(/ /g,"").toLowerCase();if(h in l)return l[h].slice();if(h[0]==="#")return h.length===4?(a=parseInt(h.substr(1),16))>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null:h.length===7&&(a=parseInt(h.substr(1),16))>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null;var _=h.indexOf("("),b=h.indexOf(")");if(_!==-1&&b+1===h.length){var S=h.substr(0,_),P=h.substr(_+1,b-(_+1)).split(","),R=1;switch(S){case"rgba":if(P.length!==4)return null;R=C(P.pop());case"rgb":return P.length!==3?null:[E(P[0]),E(P[1]),E(P[2]),R];case"hsla":if(P.length!==4)return null;R=C(P.pop());case"hsl":if(P.length!==3)return null;var O=(parseFloat(P[0])%360+360)%360/360,V=C(P[1]),j=C(P[2]),K=j<=.5?j*(V+1):j+V-j*V,$=2*j-K;return[v(255*i($,K,O+1/3)),v(255*i($,K,O)),v(255*i($,K,O-1/3)),R];default:return null}}return null}}catch{}}).parseCSSColor,Ui=function(e,n,l,v){v===void 0&&(v=1),this.r=e,this.g=n,this.b=l,this.a=v};Ui.parse=function(e){if(e){if(e instanceof Ui)return e;if(typeof e=="string"){var n=ei(e);if(n)return new Ui(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3])}}},Ui.prototype.toString=function(){var e=this.toArray(),n=e[1],l=e[2],v=e[3];return"rgba("+Math.round(e[0])+","+Math.round(n)+","+Math.round(l)+","+v+")"},Ui.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Ui.black=new Ui(0,0,0,1),Ui.white=new Ui(1,1,1,1),Ui.transparent=new Ui(0,0,0,0),Ui.red=new Ui(1,0,0,1);var Ir=function(e,n,l){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Ir.prototype.compare=function(e,n){return this.collator.compare(e,n)},Ir.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var kn=function(e,n,l,v,E){this.text=e,this.image=n,this.scale=l,this.fontStack=v,this.textColor=E},Cr=function(e){this.sections=e};Cr.fromString=function(e){return new Cr([new kn(e,null,null,null,null)])},Cr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Cr.factory=function(e){return e instanceof Cr?e:Cr.fromString(e)},Cr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Cr.prototype.serialize=function(){for(var e=["format"],n=0,l=this.sections;n<l.length;n+=1){var v=l[n];if(v.image)e.push(["image",v.image.name]);else{e.push(v.text);var E={};v.fontStack&&(E["text-font"]=["literal",v.fontStack.split(",")]),v.scale&&(E["font-scale"]=v.scale),v.textColor&&(E["text-color"]=["rgba"].concat(v.textColor.toArray())),e.push(E)}}return e};var Eo=function(e){this.name=e.name,this.available=e.available};function Fl(e,n,l,v){return typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof l=="number"&&l>=0&&l<=255?v===void 0||typeof v=="number"&&v>=0&&v<=1?null:"Invalid rgba value ["+[e,n,l,v].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof v=="number"?[e,n,l,v]:[e,n,l]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Gr(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof Ui||e instanceof Ir||e instanceof Cr||e instanceof Eo)return!0;if(Array.isArray(e)){for(var n=0,l=e;n<l.length;n+=1)if(!Gr(l[n]))return!1;return!0}if(typeof e=="object"){for(var v in e)if(!Gr(e[v]))return!1;return!0}return!1}function Sn(e){if(e===null)return ve;if(typeof e=="string")return Ie;if(typeof e=="boolean")return Ee;if(typeof e=="number")return fe;if(e instanceof Ui)return Te;if(e instanceof Ir)return tt;if(e instanceof Cr)return jt;if(e instanceof Eo)return Ct;if(Array.isArray(e)){for(var n,l=e.length,v=0,E=e;v<E.length;v+=1){var C=Sn(E[v]);if(n){if(n===C)continue;n=Ke;break}n=C}return Ut(n||Ke,l)}return et}function Gs(e){var n=typeof e;return e===null?"":n==="string"||n==="number"||n==="boolean"?String(e):e instanceof Ui||e instanceof Cr||e instanceof Eo?e.toString():JSON.stringify(e)}Eo.prototype.toString=function(){return this.name},Eo.fromString=function(e){return e?new Eo({name:e,available:!1}):null},Eo.prototype.serialize=function(){return["image",this.name]};var Co=function(e,n){this.type=e,this.value=n};Co.parse=function(e,n){if(e.length!==2)return n.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Gr(e[1]))return n.error("invalid value");var l=e[1],v=Sn(l),E=n.expectedType;return v.kind!=="array"||v.N!==0||!E||E.kind!=="array"||typeof E.N=="number"&&E.N!==0||(v=E),new Co(v,l)},Co.prototype.evaluate=function(){return this.value},Co.prototype.eachChild=function(){},Co.prototype.outputDefined=function(){return!0},Co.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ui?["rgba"].concat(this.value.toArray()):this.value instanceof Cr?this.value.serialize():this.value};var Bn=function(e){this.name="ExpressionEvaluationError",this.message=e};Bn.prototype.toJSON=function(){return this.message};var la={string:Ie,number:fe,boolean:Ee,object:et},Qr=function(e,n){this.type=e,this.args=n};Qr.parse=function(e,n){if(e.length<2)return n.error("Expected at least one argument.");var l,v=1,E=e[0];if(E==="array"){var C,i;if(e.length>2){var t=e[1];if(typeof t!="string"||!(t in la)||t==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);C=la[t],v++}else C=Ke;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);i=e[2],v++}l=Ut(C,i)}else l=la[E];for(var a=[];v<e.length;v++){var h=n.parse(e[v],v,Ke);if(!h)return null;a.push(h)}return new Qr(l,a)},Qr.prototype.evaluate=function(e){for(var n=0;n<this.args.length;n++){var l=this.args[n].evaluate(e);if(!vi(this.type,Sn(l)))return l;if(n===this.args.length-1)throw new Bn("Expected value to be of type "+Zt(this.type)+", but found "+Zt(Sn(l))+" instead.")}return null},Qr.prototype.eachChild=function(e){this.args.forEach(e)},Qr.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Qr.prototype.serialize=function(){var e=this.type,n=[e.kind];if(e.kind==="array"){var l=e.itemType;if(l.kind==="string"||l.kind==="number"||l.kind==="boolean"){n.push(l.kind);var v=e.N;(typeof v=="number"||this.args.length>1)&&n.push(v)}}return n.concat(this.args.map(function(E){return E.serialize()}))};var ua=function(e){this.type=jt,this.sections=e};ua.parse=function(e,n){if(e.length<2)return n.error("Expected at least one argument.");var l=e[1];if(!Array.isArray(l)&&typeof l=="object")return n.error("First argument must be an image or text section.");for(var v=[],E=!1,C=1;C<=e.length-1;++C){var i=e[C];if(E&&typeof i=="object"&&!Array.isArray(i)){E=!1;var t=null;if(i["font-scale"]&&!(t=n.parse(i["font-scale"],1,fe)))return null;var a=null;if(i["text-font"]&&!(a=n.parse(i["text-font"],1,Ut(Ie))))return null;var h=null;if(i["text-color"]&&!(h=n.parse(i["text-color"],1,Te)))return null;var _=v[v.length-1];_.scale=t,_.font=a,_.textColor=h}else{var b=n.parse(e[C],1,Ke);if(!b)return null;var S=b.type.kind;if(S!=="string"&&S!=="value"&&S!=="null"&&S!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");E=!0,v.push({content:b,scale:null,font:null,textColor:null})}}return new ua(v)},ua.prototype.evaluate=function(e){return new Cr(this.sections.map(function(n){var l=n.content.evaluate(e);return Sn(l)===Ct?new kn("",l,null,null,null):new kn(Gs(l),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))},ua.prototype.eachChild=function(e){for(var n=0,l=this.sections;n<l.length;n+=1){var v=l[n];e(v.content),v.scale&&e(v.scale),v.font&&e(v.font),v.textColor&&e(v.textColor)}},ua.prototype.outputDefined=function(){return!1},ua.prototype.serialize=function(){for(var e=["format"],n=0,l=this.sections;n<l.length;n+=1){var v=l[n];e.push(v.content.serialize());var E={};v.scale&&(E["font-scale"]=v.scale.serialize()),v.font&&(E["text-font"]=v.font.serialize()),v.textColor&&(E["text-color"]=v.textColor.serialize()),e.push(E)}return e};var No=function(e){this.type=Ct,this.input=e};No.parse=function(e,n){if(e.length!==2)return n.error("Expected two arguments.");var l=n.parse(e[1],1,Ie);return l?new No(l):n.error("No image name provided.")},No.prototype.evaluate=function(e){var n=this.input.evaluate(e),l=Eo.fromString(n);return l&&e.availableImages&&(l.available=e.availableImages.indexOf(n)>-1),l},No.prototype.eachChild=function(e){e(this.input)},No.prototype.outputDefined=function(){return!1},No.prototype.serialize=function(){return["image",this.input.serialize()]};var ec={"to-boolean":Ee,"to-color":Te,"to-number":fe,"to-string":Ie},ca=function(e,n){this.type=e,this.args=n};ca.parse=function(e,n){if(e.length<2)return n.error("Expected at least one argument.");var l=e[0];if((l==="to-boolean"||l==="to-string")&&e.length!==2)return n.error("Expected one argument.");for(var v=ec[l],E=[],C=1;C<e.length;C++){var i=n.parse(e[C],C,Ke);if(!i)return null;E.push(i)}return new ca(v,E)},ca.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var n,l,v=0,E=this.args;v<E.length;v+=1){if(l=null,(n=E[v].evaluate(e))instanceof Ui)return n;if(typeof n=="string"){var C=e.parseColor(n);if(C)return C}else if(Array.isArray(n)&&!(l=n.length<3||n.length>4?"Invalid rbga value "+JSON.stringify(n)+": expected an array containing either three or four numeric values.":Fl(n[0],n[1],n[2],n[3])))return new Ui(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Bn(l||"Could not parse color from value '"+(typeof n=="string"?n:String(JSON.stringify(n)))+"'")}if(this.type.kind==="number"){for(var i=null,t=0,a=this.args;t<a.length;t+=1){if((i=a[t].evaluate(e))===null)return 0;var h=Number(i);if(!isNaN(h))return h}throw new Bn("Could not convert "+JSON.stringify(i)+" to number.")}return this.type.kind==="formatted"?Cr.fromString(Gs(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Eo.fromString(Gs(this.args[0].evaluate(e))):Gs(this.args[0].evaluate(e))},ca.prototype.eachChild=function(e){this.args.forEach(e)},ca.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},ca.prototype.serialize=function(){if(this.type.kind==="formatted")return new ua([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new No(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(n){e.push(n.serialize())}),e};var Zs=["Unknown","Point","LineString","Polygon"],va=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};va.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},va.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Zs[this.feature.type]:this.feature.type:null},va.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},va.prototype.canonicalID=function(){return this.canonical},va.prototype.properties=function(){return this.feature&&this.feature.properties||{}},va.prototype.parseColor=function(e){var n=this._parseColorCache[e];return n||(n=this._parseColorCache[e]=Ui.parse(e)),n};var In=function(e,n,l,v){this.name=e,this.type=n,this._evaluate=l,this.args=v};In.prototype.evaluate=function(e){return this._evaluate(e,this.args)},In.prototype.eachChild=function(e){this.args.forEach(e)},In.prototype.outputDefined=function(){return!1},In.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},In.parse=function(e,n){var l,v=e[0],E=In.definitions[v];if(!E)return n.error('Unknown expression "'+v+'". If you wanted a literal array, use ["literal", [...]].',0);for(var C=Array.isArray(E)?E[0]:E.type,i=Array.isArray(E)?[[E[1],E[2]]]:E.overloads,t=i.filter(function(it){var We=it[0];return!Array.isArray(We)||We.length===e.length-1}),a=null,h=0,_=t;h<_.length;h+=1){var b=_[h],S=b[0],P=b[1];a=new Is(n.registry,n.path,null,n.scope);for(var R=[],O=!1,V=1;V<e.length;V++){var j=e[V],K=Array.isArray(S)?S[V-1]:S.type,$=a.parse(j,1+R.length,K);if(!$){O=!0;break}R.push($)}if(!O)if(Array.isArray(S)&&S.length!==R.length)a.error("Expected "+S.length+" arguments, but found "+R.length+" instead.");else{for(var Q=0;Q<R.length;Q++){var se=Array.isArray(S)?S[Q]:S.type,pe=R[Q];a.concat(Q+1).checkSubtype(se,pe.type)}if(a.errors.length===0)return new In(v,C,P,R)}}if(t.length===1)(l=n.errors).push.apply(l,a.errors);else{for(var ke=(t.length?t:i).map(function(it){var We;return We=it[0],Array.isArray(We)?"("+We.map(Zt).join(", ")+")":"("+Zt(We.type)+"...)"}).join(" | "),Ne=[],Ze=1;Ze<e.length;Ze++){var He=n.parse(e[Ze],1+Ne.length);if(!He)return null;Ne.push(Zt(He.type))}n.error("Expected arguments of type "+ke+", but found ("+Ne.join(", ")+") instead.")}return null},In.register=function(e,n){for(var l in In.definitions=n,n)e[l]=In};var Zo=function(e,n,l){this.type=tt,this.locale=l,this.caseSensitive=e,this.diacriticSensitive=n};function io(e,n){e[0]=Math.min(e[0],n[0]),e[1]=Math.min(e[1],n[1]),e[2]=Math.max(e[2],n[0]),e[3]=Math.max(e[3],n[1])}function Na(e,n){return!(e[0]<=n[0]||e[2]>=n[2]||e[1]<=n[1]||e[3]>=n[3])}function Ul(e,n){var l=(180+e[0])/360,v=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,E=Math.pow(2,n.z);return[Math.round(l*E*8192),Math.round(v*E*8192)]}function wu(e,n,l){return n[1]>e[1]!=l[1]>e[1]&&e[0]<(l[0]-n[0])*(e[1]-n[1])/(l[1]-n[1])+n[0]}function Hs(e,n){for(var l,v,E,C,i,t,a,h=!1,_=0,b=n.length;_<b;_++)for(var S=n[_],P=0,R=S.length;P<R-1;P++){if((C=(l=e)[0]-(v=S[P])[0])*(a=l[1]-(E=S[P+1])[1])-(t=l[0]-E[0])*(i=l[1]-v[1])==0&&C*t<=0&&i*a<=0)return!1;wu(e,S[P],S[P+1])&&(h=!h)}return h}function jn(e,n){for(var l=0;l<n.length;l++)if(Hs(e,n[l]))return!0;return!1}function ml(e,n,l,v){var E=v[0]-l[0],C=v[1]-l[1],i=(e[0]-l[0])*C-E*(e[1]-l[1]),t=(n[0]-l[0])*C-E*(n[1]-l[1]);return i>0&&t<0||i<0&&t>0}function tc(e,n,l){for(var v=0,E=l;v<E.length;v+=1)for(var C=E[v],i=0;i<C.length-1;++i)if((b=[(_=C[i+1])[0]-(h=C[i])[0],_[1]-h[1]])[0]*(S=[(a=n)[0]-(t=e)[0],a[1]-t[1]])[1]-b[1]*S[0]!=0&&ml(t,a,h,_)&&ml(h,_,t,a))return!0;var t,a,h,_,b,S;return!1}function ic(e,n){for(var l=0;l<e.length;++l)if(!Hs(e[l],n))return!1;for(var v=0;v<e.length-1;++v)if(tc(e[v],e[v+1],n))return!1;return!0}function rc(e,n){for(var l=0;l<n.length;l++)if(ic(e,n[l]))return!0;return!1}function rs(e,n,l){for(var v=[],E=0;E<e.length;E++){for(var C=[],i=0;i<e[E].length;i++){var t=Ul(e[E][i],l);io(n,t),C.push(t)}v.push(C)}return v}function Nl(e,n,l){for(var v=[],E=0;E<e.length;E++){var C=rs(e[E],n,l);v.push(C)}return v}function jl(e,n,l,v){if(e[0]<l[0]||e[0]>l[2]){var E=.5*v,C=e[0]-l[0]>E?-v:l[0]-e[0]>E?v:0;C===0&&(C=e[0]-l[2]>E?-v:l[2]-e[0]>E?v:0),e[0]+=C}io(n,e)}function Oc(e,n,l,v){for(var E=8192*Math.pow(2,v.z),C=[8192*v.x,8192*v.y],i=[],t=0,a=e;t<a.length;t+=1)for(var h=0,_=a[t];h<_.length;h+=1){var b=_[h],S=[b.x+C[0],b.y+C[1]];jl(S,n,l,E),i.push(S)}return i}function yl(e,n,l,v){for(var E,C=8192*Math.pow(2,v.z),i=[8192*v.x,8192*v.y],t=[],a=0,h=e;a<h.length;a+=1){for(var _=[],b=0,S=h[a];b<S.length;b+=1){var P=S[b],R=[P.x+i[0],P.y+i[1]];io(n,R),_.push(R)}t.push(_)}if(n[2]-n[0]<=C/2){(E=n)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(var O=0,V=t;O<V.length;O+=1)for(var j=0,K=V[O];j<K.length;j+=1)jl(K[j],n,l,C)}return t}Zo.parse=function(e,n){if(e.length!==2)return n.error("Expected one argument.");var l=e[1];if(typeof l!="object"||Array.isArray(l))return n.error("Collator options argument must be an object.");var v=n.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Ee);if(!v)return null;var E=n.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Ee);if(!E)return null;var C=null;return l.locale&&!(C=n.parse(l.locale,1,Ie))?null:new Zo(v,E,C)},Zo.prototype.evaluate=function(e){return new Ir(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Zo.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Zo.prototype.outputDefined=function(){return!1},Zo.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Ho=function(e,n){this.type=Ee,this.geojson=e,this.geometries=n};function ja(e){if(e instanceof In&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Ho)return!1;var n=!0;return e.eachChild(function(l){n&&!ja(l)&&(n=!1)}),n}function Va(e){if(e instanceof In&&e.name==="feature-state")return!1;var n=!0;return e.eachChild(function(l){n&&!Va(l)&&(n=!1)}),n}function Ss(e,n){if(e instanceof In&&n.indexOf(e.name)>=0)return!1;var l=!0;return e.eachChild(function(v){l&&!Ss(v,n)&&(l=!1)}),l}Ho.parse=function(e,n){if(e.length!==2)return n.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Gr(e[1])){var l=e[1];if(l.type==="FeatureCollection")for(var v=0;v<l.features.length;++v){var E=l.features[v].geometry.type;if(E==="Polygon"||E==="MultiPolygon")return new Ho(l,l.features[v].geometry)}else if(l.type==="Feature"){var C=l.geometry.type;if(C==="Polygon"||C==="MultiPolygon")return new Ho(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Ho(l,l)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Ho.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,l){var v=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],C=n.canonicalID();if(l.type==="Polygon"){var i=rs(l.coordinates,E,C),t=Oc(n.geometry(),v,E,C);if(!Na(v,E))return!1;for(var a=0,h=t;a<h.length;a+=1)if(!Hs(h[a],i))return!1}if(l.type==="MultiPolygon"){var _=Nl(l.coordinates,E,C),b=Oc(n.geometry(),v,E,C);if(!Na(v,E))return!1;for(var S=0,P=b;S<P.length;S+=1)if(!jn(P[S],_))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,l){var v=[1/0,1/0,-1/0,-1/0],E=[1/0,1/0,-1/0,-1/0],C=n.canonicalID();if(l.type==="Polygon"){var i=rs(l.coordinates,E,C),t=yl(n.geometry(),v,E,C);if(!Na(v,E))return!1;for(var a=0,h=t;a<h.length;a+=1)if(!ic(h[a],i))return!1}if(l.type==="MultiPolygon"){var _=Nl(l.coordinates,E,C),b=yl(n.geometry(),v,E,C);if(!Na(v,E))return!1;for(var S=0,P=b;S<P.length;S+=1)if(!rc(P[S],_))return!1}return!0}(e,this.geometries)}return!1},Ho.prototype.eachChild=function(){},Ho.prototype.outputDefined=function(){return!0},Ho.prototype.serialize=function(){return["within",this.geojson]};var pr=function(e,n){this.type=n.type,this.name=e,this.boundExpression=n};pr.parse=function(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");var l=e[1];return n.scope.has(l)?new pr(l,n.scope.get(l)):n.error('Unknown variable "'+l+'". Make sure "'+l+'" has been bound in an enclosing "let" expression before using it.',1)},pr.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},pr.prototype.eachChild=function(){},pr.prototype.outputDefined=function(){return!1},pr.prototype.serialize=function(){return["var",this.name]};var Is=function(e,n,l,v,E){n===void 0&&(n=[]),v===void 0&&(v=new ce),E===void 0&&(E=[]),this.registry=e,this.path=n,this.key=n.map(function(C){return"["+C+"]"}).join(""),this.scope=v,this.errors=E,this.expectedType=l};function Ts(e,n){for(var l,v=e.length-1,E=0,C=v,i=0;E<=C;)if((l=e[i=Math.floor((E+C)/2)])<=n){if(i===v||n<e[i+1])return i;E=i+1}else{if(!(l>n))throw new Bn("Input is not a number.");C=i-1}return 0}Is.prototype.parse=function(e,n,l,v,E){return E===void 0&&(E={}),n?this.concat(n,l,v)._parse(e,E):this._parse(e,E)},Is.prototype._parse=function(e,n){function l(h,_,b){return b==="assert"?new Qr(_,[h]):b==="coerce"?new ca(_,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var v=e[0];if(typeof v!="string")return this.error("Expression name must be a string, but found "+typeof v+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var E=this.registry[v];if(E){var C=E.parse(e,this);if(!C)return null;if(this.expectedType){var i=this.expectedType,t=C.type;if(i.kind!=="string"&&i.kind!=="number"&&i.kind!=="boolean"&&i.kind!=="object"&&i.kind!=="array"||t.kind!=="value")if(i.kind!=="color"&&i.kind!=="formatted"&&i.kind!=="resolvedImage"||t.kind!=="value"&&t.kind!=="string"){if(this.checkSubtype(i,t))return null}else C=l(C,i,n.typeAnnotation||"coerce");else C=l(C,i,n.typeAnnotation||"assert")}if(!(C instanceof Co)&&C.type.kind!=="resolvedImage"&&function h(_){if(_ instanceof pr)return h(_.boundExpression);if(_ instanceof In&&_.name==="error"||_ instanceof Zo||_ instanceof Ho)return!1;var b=_ instanceof ca||_ instanceof Qr,S=!0;return _.eachChild(function(P){S=b?S&&h(P):S&&P instanceof Co}),!!S&&ja(_)&&Ss(_,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(C)){var a=new va;try{C=new Co(C.type,C.evaluate(a))}catch(h){return this.error(h.message),null}}return C}return this.error('Unknown expression "'+v+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Is.prototype.concat=function(e,n,l){var v=typeof e=="number"?this.path.concat(e):this.path,E=l?this.scope.concat(l):this.scope;return new Is(this.registry,v,n||null,E,this.errors)},Is.prototype.error=function(e){for(var n=[],l=arguments.length-1;l-- >0;)n[l]=arguments[l+1];var v=""+this.key+n.map(function(E){return"["+E+"]"}).join("");this.errors.push(new ne(v,e))},Is.prototype.checkSubtype=function(e,n){var l=vi(e,n);return l&&this.error(l),l};var fo=function(e,n,l){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(var v=0,E=l;v<E.length;v+=1){var C=E[v],i=C[1];this.labels.push(C[0]),this.outputs.push(i)}};function Tn(e,n,l){return e*(1-l)+n*l}fo.parse=function(e,n){if(e.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");var l=n.parse(e[1],1,fe);if(!l)return null;var v=[],E=null;n.expectedType&&n.expectedType.kind!=="value"&&(E=n.expectedType);for(var C=1;C<e.length;C+=2){var i=C===1?-1/0:e[C],t=e[C+1],a=C,h=C+1;if(typeof i!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(v.length&&v[v.length-1][0]>=i)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);var _=n.parse(t,h,E);if(!_)return null;E=E||_.type,v.push([i,_])}return new fo(E,l,v)},fo.prototype.evaluate=function(e){var n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(e);var v=this.input.evaluate(e);if(v<=n[0])return l[0].evaluate(e);var E=n.length;return v>=n[E-1]?l[E-1].evaluate(e):l[Ts(n,v)].evaluate(e)},fo.prototype.eachChild=function(e){e(this.input);for(var n=0,l=this.outputs;n<l.length;n+=1)e(l[n])},fo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},fo.prototype.serialize=function(){for(var e=["step",this.input.serialize()],n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e};var mo=Object.freeze({__proto__:null,number:Tn,color:function(e,n,l){return new Ui(Tn(e.r,n.r,l),Tn(e.g,n.g,l),Tn(e.b,n.b,l),Tn(e.a,n.a,l))},array:function(e,n,l){return e.map(function(v,E){return Tn(v,n[E],l)})}}),Eu=6/29*3*(6/29),Su=Math.PI/180,Iu=180/Math.PI;function Vl(e){return e>.008856451679035631?Math.pow(e,1/3):e/Eu+4/29}function ql(e){return e>6/29?e*e*e:Eu*(e-4/29)}function gl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Gl(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Tu(e){var n=Gl(e.r),l=Gl(e.g),v=Gl(e.b),E=Vl((.4124564*n+.3575761*l+.1804375*v)/.95047),C=Vl((.2126729*n+.7151522*l+.072175*v)/1);return{l:116*C-16,a:500*(E-C),b:200*(C-Vl((.0193339*n+.119192*l+.9503041*v)/1.08883)),alpha:e.a}}function Zl(e){var n=(e.l+16)/116,l=isNaN(e.a)?n:n+e.a/500,v=isNaN(e.b)?n:n-e.b/200;return n=1*ql(n),l=.95047*ql(l),v=1.08883*ql(v),new Ui(gl(3.2404542*l-1.5371385*n-.4985314*v),gl(-.969266*l+1.8760108*n+.041556*v),gl(.0556434*l-.2040259*n+1.0572252*v),e.alpha)}function Fc(e,n,l){var v=n-e;return e+l*(v>180||v<-180?v-360*Math.round(v/360):v)}var _l={forward:Tu,reverse:Zl,interpolate:function(e,n,l){return{l:Tn(e.l,n.l,l),a:Tn(e.a,n.a,l),b:Tn(e.b,n.b,l),alpha:Tn(e.alpha,n.alpha,l)}}},qa={forward:function(e){var n=Tu(e),l=n.l,v=n.a,E=n.b,C=Math.atan2(E,v)*Iu;return{h:C<0?C+360:C,c:Math.sqrt(v*v+E*E),l,alpha:e.a}},reverse:function(e){var n=e.h*Su,l=e.c;return Zl({l:e.l,a:Math.cos(n)*l,b:Math.sin(n)*l,alpha:e.alpha})},interpolate:function(e,n,l){return{h:Fc(e.h,n.h,l),c:Tn(e.c,n.c,l),l:Tn(e.l,n.l,l),alpha:Tn(e.alpha,n.alpha,l)}}},Uc=Object.freeze({__proto__:null,lab:_l,hcl:qa}),yo=function(e,n,l,v,E){this.type=e,this.operator=n,this.interpolation=l,this.input=v,this.labels=[],this.outputs=[];for(var C=0,i=E;C<i.length;C+=1){var t=i[C],a=t[1];this.labels.push(t[0]),this.outputs.push(a)}};function nc(e,n,l,v){var E=v-l,C=e-l;return E===0?0:n===1?C/E:(Math.pow(n,C)-1)/(Math.pow(n,E)-1)}yo.interpolationFactor=function(e,n,l,v){var E=0;if(e.name==="exponential")E=nc(n,e.base,l,v);else if(e.name==="linear")E=nc(n,1,l,v);else if(e.name==="cubic-bezier"){var C=e.controlPoints;E=new L(C[0],C[1],C[2],C[3]).solve(nc(n,1,l,v))}return E},yo.parse=function(e,n){var l=e[0],v=e[1],E=e[2],C=e.slice(3);if(!Array.isArray(v)||v.length===0)return n.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){var i=v[1];if(typeof i!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:i}}else{if(v[0]!=="cubic-bezier")return n.error("Unknown interpolation type "+String(v[0]),1,0);var t=v.slice(1);if(t.length!==4||t.some(function(V){return typeof V!="number"||V<0||V>1}))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:t}}if(e.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(!(E=n.parse(E,2,fe)))return null;var a=[],h=null;l==="interpolate-hcl"||l==="interpolate-lab"?h=Te:n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);for(var _=0;_<C.length;_+=2){var b=C[_],S=C[_+1],P=_+3,R=_+4;if(typeof b!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(a.length&&a[a.length-1][0]>=b)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',P);var O=n.parse(S,R,h);if(!O)return null;h=h||O.type,a.push([b,O])}return h.kind==="number"||h.kind==="color"||h.kind==="array"&&h.itemType.kind==="number"&&typeof h.N=="number"?new yo(h,l,v,E,a):n.error("Type "+Zt(h)+" is not interpolatable.")},yo.prototype.evaluate=function(e){var n=this.labels,l=this.outputs;if(n.length===1)return l[0].evaluate(e);var v=this.input.evaluate(e);if(v<=n[0])return l[0].evaluate(e);var E=n.length;if(v>=n[E-1])return l[E-1].evaluate(e);var C=Ts(n,v),i=yo.interpolationFactor(this.interpolation,v,n[C],n[C+1]),t=l[C].evaluate(e),a=l[C+1].evaluate(e);return this.operator==="interpolate"?mo[this.type.kind.toLowerCase()](t,a,i):this.operator==="interpolate-hcl"?qa.reverse(qa.interpolate(qa.forward(t),qa.forward(a),i)):_l.reverse(_l.interpolate(_l.forward(t),_l.forward(a),i))},yo.prototype.eachChild=function(e){e(this.input);for(var n=0,l=this.outputs;n<l.length;n+=1)e(l[n])},yo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},yo.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var n=[this.operator,e,this.input.serialize()],l=0;l<this.labels.length;l++)n.push(this.labels[l],this.outputs[l].serialize());return n};var As=function(e,n){this.type=e,this.args=n};As.parse=function(e,n){if(e.length<2)return n.error("Expectected at least one argument.");var l=null,v=n.expectedType;v&&v.kind!=="value"&&(l=v);for(var E=[],C=0,i=e.slice(1);C<i.length;C+=1){var t=n.parse(i[C],1+E.length,l,void 0,{typeAnnotation:"omit"});if(!t)return null;l=l||t.type,E.push(t)}var a=v&&E.some(function(h){return vi(v,h.type)});return new As(a?Ke:l,E)},As.prototype.evaluate=function(e){for(var n,l=null,v=0,E=0,C=this.args;E<C.length&&(v++,(l=C[E].evaluate(e))&&l instanceof Eo&&!l.available&&(n||(n=l.name),l=null,v===this.args.length&&(l=n)),l===null);E+=1);return l},As.prototype.eachChild=function(e){this.args.forEach(e)},As.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},As.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(n){e.push(n.serialize())}),e};var Cs=function(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n};Cs.prototype.evaluate=function(e){return this.result.evaluate(e)},Cs.prototype.eachChild=function(e){for(var n=0,l=this.bindings;n<l.length;n+=1)e(l[n][1]);e(this.result)},Cs.parse=function(e,n){if(e.length<4)return n.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var l=[],v=1;v<e.length-1;v+=2){var E=e[v];if(typeof E!="string")return n.error("Expected string, but found "+typeof E+" instead.",v);if(/[^a-zA-Z0-9_]/.test(E))return n.error("Variable names must contain only alphanumeric characters or '_'.",v);var C=n.parse(e[v+1],v+1);if(!C)return null;l.push([E,C])}var i=n.parse(e[e.length-1],e.length-1,n.expectedType,l);return i?new Cs(l,i):null},Cs.prototype.outputDefined=function(){return this.result.outputDefined()},Cs.prototype.serialize=function(){for(var e=["let"],n=0,l=this.bindings;n<l.length;n+=1){var v=l[n];e.push(v[0],v[1].serialize())}return e.push(this.result.serialize()),e};var Ws=function(e,n,l){this.type=e,this.index=n,this.input=l};Ws.parse=function(e,n){if(e.length!==3)return n.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var l=n.parse(e[1],1,fe),v=n.parse(e[2],2,Ut(n.expectedType||Ke));return l&&v?new Ws(v.type.itemType,l,v):null},Ws.prototype.evaluate=function(e){var n=this.index.evaluate(e),l=this.input.evaluate(e);if(n<0)throw new Bn("Array index out of bounds: "+n+" < 0.");if(n>=l.length)throw new Bn("Array index out of bounds: "+n+" > "+(l.length-1)+".");if(n!==Math.floor(n))throw new Bn("Array index must be an integer, but found "+n+" instead.");return l[n]},Ws.prototype.eachChild=function(e){e(this.index),e(this.input)},Ws.prototype.outputDefined=function(){return!1},Ws.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ns=function(e,n){this.type=Ee,this.needle=e,this.haystack=n};ns.parse=function(e,n){if(e.length!==3)return n.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var l=n.parse(e[1],1,Ke),v=n.parse(e[2],2,Ke);return l&&v?Pi(l.type,[Ee,Ie,fe,ve,Ke])?new ns(l,v):n.error("Expected first argument to be of type boolean, string, number or null, but found "+Zt(l.type)+" instead"):null},ns.prototype.evaluate=function(e){var n=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!l)return!1;if(!di(n,["boolean","string","number","null"]))throw new Bn("Expected first argument to be of type boolean, string, number or null, but found "+Zt(Sn(n))+" instead.");if(!di(l,["string","array"]))throw new Bn("Expected second argument to be of type array or string, but found "+Zt(Sn(l))+" instead.");return l.indexOf(n)>=0},ns.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},ns.prototype.outputDefined=function(){return!0},ns.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ga=function(e,n,l){this.type=fe,this.needle=e,this.haystack=n,this.fromIndex=l};Ga.parse=function(e,n){if(e.length<=2||e.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var l=n.parse(e[1],1,Ke),v=n.parse(e[2],2,Ke);if(!l||!v)return null;if(!Pi(l.type,[Ee,Ie,fe,ve,Ke]))return n.error("Expected first argument to be of type boolean, string, number or null, but found "+Zt(l.type)+" instead");if(e.length===4){var E=n.parse(e[3],3,fe);return E?new Ga(l,v,E):null}return new Ga(l,v)},Ga.prototype.evaluate=function(e){var n=this.needle.evaluate(e),l=this.haystack.evaluate(e);if(!di(n,["boolean","string","number","null"]))throw new Bn("Expected first argument to be of type boolean, string, number or null, but found "+Zt(Sn(n))+" instead.");if(!di(l,["string","array"]))throw new Bn("Expected second argument to be of type array or string, but found "+Zt(Sn(l))+" instead.");if(this.fromIndex){var v=this.fromIndex.evaluate(e);return l.indexOf(n,v)}return l.indexOf(n)},Ga.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Ga.prototype.outputDefined=function(){return!1},Ga.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var xa=function(e,n,l,v,E,C){this.inputType=e,this.type=n,this.input=l,this.cases=v,this.outputs=E,this.otherwise=C};xa.parse=function(e,n){if(e.length<5)return n.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return n.error("Expected an even number of arguments.");var l,v;n.expectedType&&n.expectedType.kind!=="value"&&(v=n.expectedType);for(var E={},C=[],i=2;i<e.length-1;i+=2){var t=e[i],a=e[i+1];Array.isArray(t)||(t=[t]);var h=n.concat(i);if(t.length===0)return h.error("Expected at least one branch label.");for(var _=0,b=t;_<b.length;_+=1){var S=b[_];if(typeof S!="number"&&typeof S!="string")return h.error("Branch labels must be numbers or strings.");if(typeof S=="number"&&Math.abs(S)>Number.MAX_SAFE_INTEGER)return h.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof S=="number"&&Math.floor(S)!==S)return h.error("Numeric branch labels must be integer values.");if(l){if(h.checkSubtype(l,Sn(S)))return null}else l=Sn(S);if(E[String(S)]!==void 0)return h.error("Branch labels must be unique.");E[String(S)]=C.length}var P=n.parse(a,i,v);if(!P)return null;v=v||P.type,C.push(P)}var R=n.parse(e[1],1,Ke);if(!R)return null;var O=n.parse(e[e.length-1],e.length-1,v);return O?R.type.kind!=="value"&&n.concat(1).checkSubtype(l,R.type)?null:new xa(l,v,R,E,C,O):null},xa.prototype.evaluate=function(e){var n=this.input.evaluate(e);return(Sn(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)},xa.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},xa.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},xa.prototype.serialize=function(){for(var e=this,n=["match",this.input.serialize()],l=[],v={},E=0,C=Object.keys(this.cases).sort();E<C.length;E+=1){var i=C[E];(b=v[this.cases[i]])===void 0?(v[this.cases[i]]=l.length,l.push([this.cases[i],[i]])):l[b][1].push(i)}for(var t=function(P){return e.inputType.kind==="number"?Number(P):P},a=0,h=l;a<h.length;a+=1){var _=h[a],b=_[0],S=_[1];n.push(S.length===1?t(S[0]):S.map(t)),n.push(this.outputs[outputIndex$1].serialize())}return n.push(this.otherwise.serialize()),n};var ks=function(e,n,l){this.type=e,this.branches=n,this.otherwise=l};ks.parse=function(e,n){if(e.length<4)return n.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return n.error("Expected an odd number of arguments.");var l;n.expectedType&&n.expectedType.kind!=="value"&&(l=n.expectedType);for(var v=[],E=1;E<e.length-1;E+=2){var C=n.parse(e[E],E,Ee);if(!C)return null;var i=n.parse(e[E+1],E+1,l);if(!i)return null;v.push([C,i]),l=l||i.type}var t=n.parse(e[e.length-1],e.length-1,l);return t?new ks(l,v,t):null},ks.prototype.evaluate=function(e){for(var n=0,l=this.branches;n<l.length;n+=1){var v=l[n],E=v[1];if(v[0].evaluate(e))return E.evaluate(e)}return this.otherwise.evaluate(e)},ks.prototype.eachChild=function(e){for(var n=0,l=this.branches;n<l.length;n+=1){var v=l[n],E=v[1];e(v[0]),e(E)}e(this.otherwise)},ks.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},ks.prototype.serialize=function(){var e=["case"];return this.eachChild(function(n){e.push(n.serialize())}),e};var os=function(e,n,l,v){this.type=e,this.input=n,this.beginIndex=l,this.endIndex=v};function Au(e,n){return e==="=="||e==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function zs(e,n,l,v){return v.compare(n,l)===0}function Zr(e,n,l){var v=e!=="=="&&e!=="!=";return function(){function E(C,i,t){this.type=Ee,this.lhs=C,this.rhs=i,this.collator=t,this.hasUntypedArgument=C.type.kind==="value"||i.type.kind==="value"}return E.parse=function(C,i){if(C.length!==3&&C.length!==4)return i.error("Expected two or three arguments.");var t=C[0],a=i.parse(C[1],1,Ke);if(!a)return null;if(!Au(t,a.type))return i.concat(1).error('"'+t+`" comparisons are not supported for type '`+Zt(a.type)+"'.");var h=i.parse(C[2],2,Ke);if(!h)return null;if(!Au(t,h.type))return i.concat(2).error('"'+t+`" comparisons are not supported for type '`+Zt(h.type)+"'.");if(a.type.kind!==h.type.kind&&a.type.kind!=="value"&&h.type.kind!=="value")return i.error("Cannot compare types '"+Zt(a.type)+"' and '"+Zt(h.type)+"'.");v&&(a.type.kind==="value"&&h.type.kind!=="value"?a=new Qr(h.type,[a]):a.type.kind!=="value"&&h.type.kind==="value"&&(h=new Qr(a.type,[h])));var _=null;if(C.length===4){if(a.type.kind!=="string"&&h.type.kind!=="string"&&a.type.kind!=="value"&&h.type.kind!=="value")return i.error("Cannot use collator to compare non-string types.");if(!(_=i.parse(C[3],3,tt)))return null}return new E(a,h,_)},E.prototype.evaluate=function(C){var i=this.lhs.evaluate(C),t=this.rhs.evaluate(C);if(v&&this.hasUntypedArgument){var a=Sn(i),h=Sn(t);if(a.kind!==h.kind||a.kind!=="string"&&a.kind!=="number")throw new Bn('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+a.kind+", "+h.kind+") instead.")}if(this.collator&&!v&&this.hasUntypedArgument){var _=Sn(i),b=Sn(t);if(_.kind!=="string"||b.kind!=="string")return n(C,i,t)}return this.collator?l(C,i,t,this.collator.evaluate(C)):n(C,i,t)},E.prototype.eachChild=function(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)},E.prototype.outputDefined=function(){return!0},E.prototype.serialize=function(){var C=[e];return this.eachChild(function(i){C.push(i.serialize())}),C},E}()}os.parse=function(e,n){if(e.length<=2||e.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var l=n.parse(e[1],1,Ke),v=n.parse(e[2],2,fe);if(!l||!v)return null;if(!Pi(l.type,[Ut(Ke),Ie,Ke]))return n.error("Expected first argument to be of type array or string, but found "+Zt(l.type)+" instead");if(e.length===4){var E=n.parse(e[3],3,fe);return E?new os(l.type,l,v,E):null}return new os(l.type,l,v)},os.prototype.evaluate=function(e){var n=this.input.evaluate(e),l=this.beginIndex.evaluate(e);if(!di(n,["string","array"]))throw new Bn("Expected first argument to be of type array or string, but found "+Zt(Sn(n))+" instead.");if(this.endIndex){var v=this.endIndex.evaluate(e);return n.slice(l,v)}return n.slice(l)},os.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},os.prototype.outputDefined=function(){return!1},os.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Xs=Zr("==",function(e,n,l){return n===l},zs),as=Zr("!=",function(e,n,l){return n!==l},function(e,n,l,v){return!zs(0,n,l,v)}),oc=Zr("<",function(e,n,l){return n<l},function(e,n,l,v){return v.compare(n,l)<0}),Cu=Zr(">",function(e,n,l){return n>l},function(e,n,l,v){return v.compare(n,l)>0}),$i=Zr("<=",function(e,n,l){return n<=l},function(e,n,l,v){return v.compare(n,l)<=0}),Hl=Zr(">=",function(e,n,l){return n>=l},function(e,n,l,v){return v.compare(n,l)>=0}),Er=function(e,n,l,v,E){this.type=Ie,this.number=e,this.locale=n,this.currency=l,this.minFractionDigits=v,this.maxFractionDigits=E};Er.parse=function(e,n){if(e.length!==3)return n.error("Expected two arguments.");var l=n.parse(e[1],1,fe);if(!l)return null;var v=e[2];if(typeof v!="object"||Array.isArray(v))return n.error("NumberFormat options argument must be an object.");var E=null;if(v.locale&&!(E=n.parse(v.locale,1,Ie)))return null;var C=null;if(v.currency&&!(C=n.parse(v.currency,1,Ie)))return null;var i=null;if(v["min-fraction-digits"]&&!(i=n.parse(v["min-fraction-digits"],1,fe)))return null;var t=null;return v["max-fraction-digits"]&&!(t=n.parse(v["max-fraction-digits"],1,fe))?null:new Er(l,E,C,i,t)},Er.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Er.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Er.prototype.outputDefined=function(){return!1},Er.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var ka=function(e){this.type=fe,this.input=e};ka.parse=function(e,n){if(e.length!==2)return n.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var l=n.parse(e[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?n.error("Expected argument of type string or array, but found "+Zt(l.type)+" instead."):new ka(l):null},ka.prototype.evaluate=function(e){var n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new Bn("Expected value to be of type string or array, but found "+Zt(Sn(n))+" instead.")},ka.prototype.eachChild=function(e){e(this.input)},ka.prototype.outputDefined=function(){return!1},ka.prototype.serialize=function(){var e=["length"];return this.eachChild(function(n){e.push(n.serialize())}),e};var Kr={"==":Xs,"!=":as,">":Cu,"<":oc,">=":Hl,"<=":$i,array:Qr,at:Ws,boolean:Qr,case:ks,coalesce:As,collator:Zo,format:ua,image:No,in:ns,"index-of":Ga,interpolate:yo,"interpolate-hcl":yo,"interpolate-lab":yo,length:ka,let:Cs,literal:Co,match:xa,number:Qr,"number-format":Er,object:Qr,slice:os,step:fo,string:Qr,"to-boolean":ca,"to-color":ca,"to-number":ca,"to-string":ca,var:pr,within:Ho};function An(e,n){var l=n[0],v=n[1],E=n[2],C=n[3];l=l.evaluate(e),v=v.evaluate(e),E=E.evaluate(e);var i=C?C.evaluate(e):1,t=Fl(l,v,E,i);if(t)throw new Bn(t);return new Ui(l/255*i,v/255*i,E/255*i,i)}function Wl(e,n){return e in n}function Xl(e,n){var l=n[e];return l===void 0?null:l}function Ks(e){return{type:e}}function ku(e){return{result:"success",value:e}}function Za(e){return{result:"error",value:e}}function Ha(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Kl(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Ps(e){return!!e.expression&&e.expression.interpolated}function Jr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function ss(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function zu(e){return e}function ko(e,n,l){return e!==void 0?e:n!==void 0?n:l!==void 0?l:void 0}function ac(e,n,l,v,E){return ko(typeof l===E?v[l]:void 0,e.default,n.default)}function Nc(e,n,l){if(Jr(l)!=="number")return ko(e.default,n.default);var v=e.stops.length;if(v===1||l<=e.stops[0][0])return e.stops[0][1];if(l>=e.stops[v-1][0])return e.stops[v-1][1];var E=Ts(e.stops.map(function(C){return C[0]}),l);return e.stops[E][1]}function sc(e,n,l){var v=e.base!==void 0?e.base:1;if(Jr(l)!=="number")return ko(e.default,n.default);var E=e.stops.length;if(E===1||l<=e.stops[0][0])return e.stops[0][1];if(l>=e.stops[E-1][0])return e.stops[E-1][1];var C=Ts(e.stops.map(function(b){return b[0]}),l),i=function(b,S,P,R){var O=R-P,V=b-P;return O===0?0:S===1?V/O:(Math.pow(S,V)-1)/(Math.pow(S,O)-1)}(l,v,e.stops[C][0],e.stops[C+1][0]),t=e.stops[C][1],a=e.stops[C+1][1],h=mo[n.type]||zu;if(e.colorSpace&&e.colorSpace!=="rgb"){var _=Uc[e.colorSpace];h=function(b,S){return _.reverse(_.interpolate(_.forward(b),_.forward(S),i))}}return typeof t.evaluate=="function"?{evaluate:function(){for(var b=[],S=arguments.length;S--;)b[S]=arguments[S];var P=t.evaluate.apply(void 0,b),R=a.evaluate.apply(void 0,b);if(P!==void 0&&R!==void 0)return h(P,R,i)}}:h(t,a,i)}function ls(e,n,l){return n.type==="color"?l=Ui.parse(l):n.type==="formatted"?l=Cr.fromString(l.toString()):n.type==="resolvedImage"?l=Eo.fromString(l.toString()):Jr(l)===n.type||n.type==="enum"&&n.values[l]||(l=void 0),ko(l,e.default,n.default)}In.register(Kr,{error:[{kind:"error"},[Ie],function(e,n){throw new Bn(n[0].evaluate(e))}],typeof:[Ie,[Ke],function(e,n){return Zt(Sn(n[0].evaluate(e)))}],"to-rgba":[Ut(fe,4),[Te],function(e,n){return n[0].evaluate(e).toArray()}],rgb:[Te,[fe,fe,fe],An],rgba:[Te,[fe,fe,fe,fe],An],has:{type:Ee,overloads:[[[Ie],function(e,n){return Wl(n[0].evaluate(e),e.properties())}],[[Ie,et],function(e,n){var l=n[1];return Wl(n[0].evaluate(e),l.evaluate(e))}]]},get:{type:Ke,overloads:[[[Ie],function(e,n){return Xl(n[0].evaluate(e),e.properties())}],[[Ie,et],function(e,n){var l=n[1];return Xl(n[0].evaluate(e),l.evaluate(e))}]]},"feature-state":[Ke,[Ie],function(e,n){return Xl(n[0].evaluate(e),e.featureState||{})}],properties:[et,[],function(e){return e.properties()}],"geometry-type":[Ie,[],function(e){return e.geometryType()}],id:[Ke,[],function(e){return e.id()}],zoom:[fe,[],function(e){return e.globals.zoom}],"heatmap-density":[fe,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[fe,[],function(e){return e.globals.lineProgress||0}],accumulated:[Ke,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[fe,Ks(fe),function(e,n){for(var l=0,v=0,E=n;v<E.length;v+=1)l+=E[v].evaluate(e);return l}],"*":[fe,Ks(fe),function(e,n){for(var l=1,v=0,E=n;v<E.length;v+=1)l*=E[v].evaluate(e);return l}],"-":{type:fe,overloads:[[[fe,fe],function(e,n){var l=n[1];return n[0].evaluate(e)-l.evaluate(e)}],[[fe],function(e,n){return-n[0].evaluate(e)}]]},"/":[fe,[fe,fe],function(e,n){var l=n[1];return n[0].evaluate(e)/l.evaluate(e)}],"%":[fe,[fe,fe],function(e,n){var l=n[1];return n[0].evaluate(e)%l.evaluate(e)}],ln2:[fe,[],function(){return Math.LN2}],pi:[fe,[],function(){return Math.PI}],e:[fe,[],function(){return Math.E}],"^":[fe,[fe,fe],function(e,n){var l=n[1];return Math.pow(n[0].evaluate(e),l.evaluate(e))}],sqrt:[fe,[fe],function(e,n){return Math.sqrt(n[0].evaluate(e))}],log10:[fe,[fe],function(e,n){return Math.log(n[0].evaluate(e))/Math.LN10}],ln:[fe,[fe],function(e,n){return Math.log(n[0].evaluate(e))}],log2:[fe,[fe],function(e,n){return Math.log(n[0].evaluate(e))/Math.LN2}],sin:[fe,[fe],function(e,n){return Math.sin(n[0].evaluate(e))}],cos:[fe,[fe],function(e,n){return Math.cos(n[0].evaluate(e))}],tan:[fe,[fe],function(e,n){return Math.tan(n[0].evaluate(e))}],asin:[fe,[fe],function(e,n){return Math.asin(n[0].evaluate(e))}],acos:[fe,[fe],function(e,n){return Math.acos(n[0].evaluate(e))}],atan:[fe,[fe],function(e,n){return Math.atan(n[0].evaluate(e))}],min:[fe,Ks(fe),function(e,n){return Math.min.apply(Math,n.map(function(l){return l.evaluate(e)}))}],max:[fe,Ks(fe),function(e,n){return Math.max.apply(Math,n.map(function(l){return l.evaluate(e)}))}],abs:[fe,[fe],function(e,n){return Math.abs(n[0].evaluate(e))}],round:[fe,[fe],function(e,n){var l=n[0].evaluate(e);return l<0?-Math.round(-l):Math.round(l)}],floor:[fe,[fe],function(e,n){return Math.floor(n[0].evaluate(e))}],ceil:[fe,[fe],function(e,n){return Math.ceil(n[0].evaluate(e))}],"filter-==":[Ee,[Ie,Ke],function(e,n){var l=n[0],v=n[1];return e.properties()[l.value]===v.value}],"filter-id-==":[Ee,[Ke],function(e,n){var l=n[0];return e.id()===l.value}],"filter-type-==":[Ee,[Ie],function(e,n){var l=n[0];return e.geometryType()===l.value}],"filter-<":[Ee,[Ie,Ke],function(e,n){var l=n[0],v=n[1],E=e.properties()[l.value],C=v.value;return typeof E==typeof C&&E<C}],"filter-id-<":[Ee,[Ke],function(e,n){var l=n[0],v=e.id(),E=l.value;return typeof v==typeof E&&v<E}],"filter->":[Ee,[Ie,Ke],function(e,n){var l=n[0],v=n[1],E=e.properties()[l.value],C=v.value;return typeof E==typeof C&&E>C}],"filter-id->":[Ee,[Ke],function(e,n){var l=n[0],v=e.id(),E=l.value;return typeof v==typeof E&&v>E}],"filter-<=":[Ee,[Ie,Ke],function(e,n){var l=n[0],v=n[1],E=e.properties()[l.value],C=v.value;return typeof E==typeof C&&E<=C}],"filter-id-<=":[Ee,[Ke],function(e,n){var l=n[0],v=e.id(),E=l.value;return typeof v==typeof E&&v<=E}],"filter->=":[Ee,[Ie,Ke],function(e,n){var l=n[0],v=n[1],E=e.properties()[l.value],C=v.value;return typeof E==typeof C&&E>=C}],"filter-id->=":[Ee,[Ke],function(e,n){var l=n[0],v=e.id(),E=l.value;return typeof v==typeof E&&v>=E}],"filter-has":[Ee,[Ke],function(e,n){return n[0].value in e.properties()}],"filter-has-id":[Ee,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Ee,[Ut(Ie)],function(e,n){return n[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Ee,[Ut(Ke)],function(e,n){return n[0].value.indexOf(e.id())>=0}],"filter-in-small":[Ee,[Ie,Ut(Ke)],function(e,n){var l=n[0];return n[1].value.indexOf(e.properties()[l.value])>=0}],"filter-in-large":[Ee,[Ie,Ut(Ke)],function(e,n){var l=n[0],v=n[1];return function(E,C,i,t){for(;i<=t;){var a=i+t>>1;if(C[a]===E)return!0;C[a]>E?t=a-1:i=a+1}return!1}(e.properties()[l.value],v.value,0,v.value.length-1)}],all:{type:Ee,overloads:[[[Ee,Ee],function(e,n){var l=n[1];return n[0].evaluate(e)&&l.evaluate(e)}],[Ks(Ee),function(e,n){for(var l=0,v=n;l<v.length;l+=1)if(!v[l].evaluate(e))return!1;return!0}]]},any:{type:Ee,overloads:[[[Ee,Ee],function(e,n){var l=n[1];return n[0].evaluate(e)||l.evaluate(e)}],[Ks(Ee),function(e,n){for(var l=0,v=n;l<v.length;l+=1)if(v[l].evaluate(e))return!0;return!1}]]},"!":[Ee,[Ee],function(e,n){return!n[0].evaluate(e)}],"is-supported-script":[Ee,[Ie],function(e,n){var l=e.globals&&e.globals.isSupportedScript;return!l||l(n[0].evaluate(e))}],upcase:[Ie,[Ie],function(e,n){return n[0].evaluate(e).toUpperCase()}],downcase:[Ie,[Ie],function(e,n){return n[0].evaluate(e).toLowerCase()}],concat:[Ie,Ks(Ke),function(e,n){return n.map(function(l){return Gs(l.evaluate(e))}).join("")}],"resolved-locale":[Ie,[tt],function(e,n){return n[0].evaluate(e).resolvedLocale()}]});var us=function(e,n){this.expression=e,this._warningHistory={},this._evaluator=new va,this._defaultValue=n?function(l){return l.type==="color"&&ss(l.default)?new Ui(0,0,0,0):l.type==="color"?Ui.parse(l.default)||null:l.default===void 0?null:l.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null};function Js(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Kr}function Jl(e,n){var l=new Is(Kr,[],n?function(E){var C={color:Te,string:Ie,number:fe,enum:Ie,boolean:Ee,formatted:jt,resolvedImage:Ct};return E.type==="array"?Ut(C[E.value]||Ke,E.length):C[E.type]}(n):void 0),v=l.parse(e,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return v?ku(new us(v,n)):Za(l.errors)}us.prototype.evaluateWithoutErrorHandling=function(e,n,l,v,E,C){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=l,this._evaluator.canonical=v,this._evaluator.availableImages=E||null,this._evaluator.formattedSection=C,this.expression.evaluate(this._evaluator)},us.prototype.evaluate=function(e,n,l,v,E,C){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=l||null,this._evaluator.canonical=v,this._evaluator.availableImages=E||null,this._evaluator.formattedSection=C||null;try{var i=this.expression.evaluate(this._evaluator);if(i==null||typeof i=="number"&&i!=i)return this._defaultValue;if(this._enumValues&&!(i in this._enumValues))throw new Bn("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(i)+" instead.");return i}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,typeof console!="undefined"&&console.warn(t.message)),this._defaultValue}};var Ms=function(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!Va(n.expression)};Ms.prototype.evaluateWithoutErrorHandling=function(e,n,l,v,E,C){return this._styleExpression.evaluateWithoutErrorHandling(e,n,l,v,E,C)},Ms.prototype.evaluate=function(e,n,l,v,E,C){return this._styleExpression.evaluate(e,n,l,v,E,C)};var cs=function(e,n,l,v){this.kind=e,this.zoomStops=l,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!Va(n.expression),this.interpolationType=v};function lc(e,n){if((e=Jl(e,n)).result==="error")return e;var l=e.value.expression,v=ja(l);if(!v&&!Ha(n))return Za([new ne("","data expressions not supported")]);var E=Ss(l,["zoom"]);if(!E&&!Kl(n))return Za([new ne("","zoom expressions not supported")]);var C=function i(t){var a=null;if(t instanceof Cs)a=i(t.result);else if(t instanceof As)for(var h=0,_=t.args;h<_.length&&!(a=i(_[h]));h+=1);else(t instanceof fo||t instanceof yo)&&t.input instanceof In&&t.input.name==="zoom"&&(a=t);return a instanceof ne||t.eachChild(function(b){var S=i(b);S instanceof ne?a=S:!a&&S?a=new ne("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&S&&a!==S&&(a=new ne("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}(l);return C||E?C instanceof ne?Za([C]):C instanceof yo&&!Ps(n)?Za([new ne("",'"interpolate" expressions cannot be used with this property')]):ku(C?new cs(v?"camera":"composite",e.value,C.labels,C instanceof yo?C.interpolation:void 0):new Ms(v?"constant":"source",e.value)):Za([new ne("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}cs.prototype.evaluateWithoutErrorHandling=function(e,n,l,v,E,C){return this._styleExpression.evaluateWithoutErrorHandling(e,n,l,v,E,C)},cs.prototype.evaluate=function(e,n,l,v,E,C){return this._styleExpression.evaluate(e,n,l,v,E,C)},cs.prototype.interpolationFactor=function(e,n,l){return this.interpolationType?yo.interpolationFactor(this.interpolationType,e,n,l):0};var Wa=function(e,n){this._parameters=e,this._specification=n,ae(this,function l(v,E){var C,i,t,a=E.type==="color",h=v.stops&&typeof v.stops[0][0]=="object",_=h||!(h||v.property!==void 0),b=v.type||(Ps(E)?"exponential":"interval");if(a&&((v=ae({},v)).stops&&(v.stops=v.stops.map(function(He){return[He[0],Ui.parse(He[1])]})),v.default=Ui.parse(v.default?v.default:E.default)),v.colorSpace&&v.colorSpace!=="rgb"&&!Uc[v.colorSpace])throw new Error("Unknown color space: "+v.colorSpace);if(b==="exponential")C=sc;else if(b==="interval")C=Nc;else if(b==="categorical"){C=ac,i=Object.create(null);for(var S=0,P=v.stops;S<P.length;S+=1){var R=P[S];i[R[0]]=R[1]}t=typeof v.stops[0][0]}else{if(b!=="identity")throw new Error('Unknown function type "'+b+'"');C=ls}if(h){for(var O={},V=[],j=0;j<v.stops.length;j++){var K=v.stops[j],$=K[0].zoom;O[$]===void 0&&(O[$]={zoom:$,type:v.type,property:v.property,default:v.default,stops:[]},V.push($)),O[$].stops.push([K[0].value,K[1]])}for(var Q=[],se=0,pe=V;se<pe.length;se+=1){var ke=pe[se];Q.push([O[ke].zoom,l(O[ke],E)])}var Ne={name:"linear"};return{kind:"composite",interpolationType:Ne,interpolationFactor:yo.interpolationFactor.bind(void 0,Ne),zoomStops:Q.map(function(He){return He[0]}),evaluate:function(He,it){var We=He.zoom;return sc({stops:Q,base:v.base},E,We).evaluate(We,it)}}}if(_){var Ze=b==="exponential"?{name:"exponential",base:v.base!==void 0?v.base:1}:null;return{kind:"camera",interpolationType:Ze,interpolationFactor:yo.interpolationFactor.bind(void 0,Ze),zoomStops:v.stops.map(function(He){return He[0]}),evaluate:function(He){return C(v,E,He.zoom,i,t)}}}return{kind:"source",evaluate:function(He,it){var We=it&&it.properties?it.properties[v.property]:void 0;return We===void 0?ko(v.default,E.default):C(v,E,We,i,t)}}}(this._parameters,this._specification))};function ha(e){var n=e.key,l=e.value,v=e.valueSpec||{},E=e.objectElementValidators||{},C=e.style,i=e.styleSpec,t=[],a=Jr(l);if(a!=="object")return[new Me(n,l,"object expected, "+a+" found")];for(var h in l){var _=h.split(".")[0],b=v[_]||v["*"],S=void 0;if(E[_])S=E[_];else if(v[_])S=tr;else if(E["*"])S=E["*"];else{if(!v["*"]){t.push(new Me(n,l[h],'unknown property "'+h+'"'));continue}S=tr}t=t.concat(S({key:(n&&n+".")+h,value:l[h],valueSpec:b,style:C,styleSpec:i,object:l,objectKey:h},l))}for(var P in v)E[P]||v[P].required&&v[P].default===void 0&&l[P]===void 0&&t.push(new Me(n,l,'missing required property "'+P+'"'));return t}function Yl(e){var n=e.value,l=e.valueSpec,v=e.style,E=e.styleSpec,C=e.key,i=e.arrayElementValidator||tr;if(Jr(n)!=="array")return[new Me(C,n,"array expected, "+Jr(n)+" found")];if(l.length&&n.length!==l.length)return[new Me(C,n,"array length "+l.length+" expected, length "+n.length+" found")];if(l["min-length"]&&n.length<l["min-length"])return[new Me(C,n,"array length at least "+l["min-length"]+" expected, length "+n.length+" found")];var t={type:l.value,values:l.values};E.$version<7&&(t.function=l.function),Jr(l.value)==="object"&&(t=l.value);for(var a=[],h=0;h<n.length;h++)a=a.concat(i({array:n,arrayIndex:h,value:n[h],valueSpec:t,style:v,styleSpec:E,key:C+"["+h+"]"}));return a}function $l(e){var n=e.key,l=e.value,v=e.valueSpec,E=Jr(l);return E==="number"&&l!=l&&(E="NaN"),E!=="number"?[new Me(n,l,"number expected, "+E+" found")]:"minimum"in v&&l<v.minimum?[new Me(n,l,l+" is less than the minimum value "+v.minimum)]:"maximum"in v&&l>v.maximum?[new Me(n,l,l+" is greater than the maximum value "+v.maximum)]:[]}function Ys(e){var n,l,v,E=e.valueSpec,C=H(e.value.type),i={},t=C!=="categorical"&&e.value.property===void 0,a=!t,h=Jr(e.value.stops)==="array"&&Jr(e.value.stops[0])==="array"&&Jr(e.value.stops[0][0])==="object",_=ha({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(P){if(C==="identity")return[new Me(P.key,P.value,'identity function may not have a "stops" property')];var R=[],O=P.value;return R=R.concat(Yl({key:P.key,value:O,valueSpec:P.valueSpec,style:P.style,styleSpec:P.styleSpec,arrayElementValidator:b})),Jr(O)==="array"&&O.length===0&&R.push(new Me(P.key,O,"array must have at least one stop")),R},default:function(P){return tr({key:P.key,value:P.value,valueSpec:E,style:P.style,styleSpec:P.styleSpec})}}});return C==="identity"&&t&&_.push(new Me(e.key,e.value,'missing required property "property"')),C==="identity"||e.value.stops||_.push(new Me(e.key,e.value,'missing required property "stops"')),C==="exponential"&&e.valueSpec.expression&&!Ps(e.valueSpec)&&_.push(new Me(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(a&&!Ha(e.valueSpec)?_.push(new Me(e.key,e.value,"property functions not supported")):t&&!Kl(e.valueSpec)&&_.push(new Me(e.key,e.value,"zoom functions not supported"))),C!=="categorical"&&!h||e.value.property!==void 0||_.push(new Me(e.key,e.value,'"property" property is required')),_;function b(P){var R=[],O=P.value,V=P.key;if(Jr(O)!=="array")return[new Me(V,O,"array expected, "+Jr(O)+" found")];if(O.length!==2)return[new Me(V,O,"array length 2 expected, length "+O.length+" found")];if(h){if(Jr(O[0])!=="object")return[new Me(V,O,"object expected, "+Jr(O[0])+" found")];if(O[0].zoom===void 0)return[new Me(V,O,"object stop key must have zoom")];if(O[0].value===void 0)return[new Me(V,O,"object stop key must have value")];if(v&&v>H(O[0].zoom))return[new Me(V,O[0].zoom,"stop zoom values must appear in ascending order")];H(O[0].zoom)!==v&&(v=H(O[0].zoom),l=void 0,i={}),R=R.concat(ha({key:V+"[0]",value:O[0],valueSpec:{zoom:{}},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{zoom:$l,value:S}}))}else R=R.concat(S({key:V+"[0]",value:O[0],valueSpec:{},style:P.style,styleSpec:P.styleSpec},O));return Js(W(O[1]))?R.concat([new Me(V+"[1]",O[1],"expressions are not allowed in function stops.")]):R.concat(tr({key:V+"[1]",value:O[1],valueSpec:E,style:P.style,styleSpec:P.styleSpec}))}function S(P,R){var O=Jr(P.value),V=H(P.value),j=P.value!==null?P.value:R;if(n){if(O!==n)return[new Me(P.key,j,O+" stop domain type must match previous stop domain type "+n)]}else n=O;if(O!=="number"&&O!=="string"&&O!=="boolean")return[new Me(P.key,j,"stop domain value must be a number, string, or boolean")];if(O!=="number"&&C!=="categorical"){var K="number expected, "+O+" found";return Ha(E)&&C===void 0&&(K+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Me(P.key,j,K)]}return C!=="categorical"||O!=="number"||isFinite(V)&&Math.floor(V)===V?C!=="categorical"&&O==="number"&&l!==void 0&&V<l?[new Me(P.key,j,"stop domain values must appear in ascending order")]:(l=V,C==="categorical"&&V in i?[new Me(P.key,j,"stop domain values must be unique")]:(i[V]=!0,[])):[new Me(P.key,j,"integer expected, found "+V)]}}function za(e){var n=(e.expressionContext==="property"?lc:Jl)(W(e.value),e.valueSpec);if(n.result==="error")return n.value.map(function(v){return new Me(""+e.key+v.key,e.value,v.message)});var l=n.value.expression||n.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!l.outputDefined())return[new Me(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!Va(l))return[new Me(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!Va(l))return[new Me(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Ss(l,["zoom","feature-state"]))return[new Me(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!ja(l))return[new Me(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function vl(e){var n=e.key,l=e.value,v=e.valueSpec,E=[];return Array.isArray(v.values)?v.values.indexOf(H(l))===-1&&E.push(new Me(n,l,"expected one of ["+v.values.join(", ")+"], "+JSON.stringify(l)+" found")):Object.keys(v.values).indexOf(H(l))===-1&&E.push(new Me(n,l,"expected one of ["+Object.keys(v.values).join(", ")+"], "+JSON.stringify(l)+" found")),E}function Ls(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var n=0,l=e.slice(1);n<l.length;n+=1){var v=l[n];if(!Ls(v)&&typeof v!="boolean")return!1}return!0;default:return!0}}Wa.deserialize=function(e){return new Wa(e._parameters,e._specification)},Wa.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Pu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ql(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Ls(e)||(e=hs(e));var n=Jl(e,Pu);if(n.result==="error")throw new Error(n.value.map(function(l){return l.key+": "+l.message}).join(", "));return{filter:function(l,v,E){return n.value.evaluate(l,v,{},E)},needGeometry:function l(v){if(!Array.isArray(v))return!1;if(v[0]==="within")return!0;for(var E=1;E<v.length;E++)if(l(v[E]))return!0;return!1}(e)}}function jc(e,n){return e<n?-1:e>n?1:0}function hs(e){if(!e)return!0;var n,l=e[0];return e.length<=1?l!=="any":l==="=="?Mu(e[1],e[2],"=="):l==="!="?zo(Mu(e[1],e[2],"==")):l==="<"||l===">"||l==="<="||l===">="?Mu(e[1],e[2],l):l==="any"?(n=e.slice(1),["any"].concat(n.map(hs))):l==="all"?["all"].concat(e.slice(1).map(hs)):l==="none"?["all"].concat(e.slice(1).map(hs).map(zo)):l==="in"?xl(e[1],e.slice(2)):l==="!in"?zo(xl(e[1],e.slice(2))):l==="has"?bl(e[1]):l==="!has"?zo(bl(e[1])):l!=="within"||e}function Mu(e,n,l){switch(e){case"$type":return["filter-type-"+l,n];case"$id":return["filter-id-"+l,n];default:return["filter-"+l,e,n]}}function xl(e,n){if(n.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(function(l){return typeof l!=typeof n[0]})?["filter-in-large",e,["literal",n.sort(jc)]]:["filter-in-small",e,["literal",n]]}}function bl(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function zo(e){return["!",e]}function Po(e){return Ls(W(e.value))?za(ae({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function n(l){var v=l.value,E=l.key;if(Jr(v)!=="array")return[new Me(E,v,"array expected, "+Jr(v)+" found")];var C,i=l.styleSpec,t=[];if(v.length<1)return[new Me(E,v,"filter array must have at least 1 element")];switch(t=t.concat(vl({key:E+"[0]",value:v[0],valueSpec:i.filter_operator,style:l.style,styleSpec:l.styleSpec})),H(v[0])){case"<":case"<=":case">":case">=":v.length>=2&&H(v[1])==="$type"&&t.push(new Me(E,v,'"$type" cannot be use with operator "'+v[0]+'"'));case"==":case"!=":v.length!==3&&t.push(new Me(E,v,'filter array for operator "'+v[0]+'" must have 3 elements'));case"in":case"!in":v.length>=2&&(C=Jr(v[1]))!=="string"&&t.push(new Me(E+"[1]",v[1],"string expected, "+C+" found"));for(var a=2;a<v.length;a++)C=Jr(v[a]),H(v[1])==="$type"?t=t.concat(vl({key:E+"["+a+"]",value:v[a],valueSpec:i.geometry_type,style:l.style,styleSpec:l.styleSpec})):C!=="string"&&C!=="number"&&C!=="boolean"&&t.push(new Me(E+"["+a+"]",v[a],"string, number, or boolean expected, "+C+" found"));break;case"any":case"all":case"none":for(var h=1;h<v.length;h++)t=t.concat(n({key:E+"["+h+"]",value:v[h],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":C=Jr(v[1]),v.length!==2?t.push(new Me(E,v,'filter array for "'+v[0]+'" operator must have 2 elements')):C!=="string"&&t.push(new Me(E+"[1]",v[1],"string expected, "+C+" found"));break;case"within":C=Jr(v[1]),v.length!==2?t.push(new Me(E,v,'filter array for "'+v[0]+'" operator must have 2 elements')):C!=="object"&&t.push(new Me(E+"[1]",v[1],"object expected, "+C+" found"))}return t}(e)}function uc(e,n){var l=e.key,v=e.style,E=e.styleSpec,C=e.value,i=e.objectKey,t=E[n+"_"+e.layerType];if(!t)return[];var a=i.match(/^(.*)-transition$/);if(n==="paint"&&a&&t[a[1]]&&t[a[1]].transition)return tr({key:l,value:C,valueSpec:E.transition,style:v,styleSpec:E});var h,_=e.valueSpec||t[i];if(!_)return[new Me(l,C,'unknown property "'+i+'"')];if(Jr(C)==="string"&&Ha(_)&&!_.tokens&&(h=/^{([^}]+)}$/.exec(C)))return[new Me(l,C,'"'+i+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(h[1])+" }`.")];var b=[];return e.layerType==="symbol"&&(i==="text-field"&&v&&!v.glyphs&&b.push(new Me(l,C,'use of "text-field" requires a style "glyphs" property')),i==="text-font"&&ss(W(C))&&H(C.type)==="identity"&&b.push(new Me(l,C,'"text-font" does not support identity functions'))),b.concat(tr({key:e.key,value:C,valueSpec:_,style:v,styleSpec:E,expressionContext:"property",propertyType:n,propertyKey:i}))}function ps(e){return uc(e,"paint")}function wl(e){return uc(e,"layout")}function $s(e){var n=[],l=e.value,v=e.key,E=e.style,C=e.styleSpec;l.type||l.ref||n.push(new Me(v,l,'either "type" or "ref" is required'));var i,t=H(l.type),a=H(l.ref);if(l.id)for(var h=H(l.id),_=0;_<e.arrayIndex;_++){var b=E.layers[_];H(b.id)===h&&n.push(new Me(v,l.id,'duplicate layer id "'+l.id+'", previously used at line '+b.id.__line__))}if("ref"in l)["type","source","source-layer","filter","layout"].forEach(function(R){R in l&&n.push(new Me(v,l[R],'"'+R+'" is prohibited for ref layers'))}),E.layers.forEach(function(R){H(R.id)===a&&(i=R)}),i?i.ref?n.push(new Me(v,l.ref,"ref cannot reference another ref layer")):t=H(i.type):n.push(new Me(v,l.ref,'ref layer "'+a+'" not found'));else if(t!=="background")if(l.source){var S=E.sources&&E.sources[l.source],P=S&&H(S.type);S?P==="vector"&&t==="raster"?n.push(new Me(v,l.source,'layer "'+l.id+'" requires a raster source')):P==="raster"&&t!=="raster"?n.push(new Me(v,l.source,'layer "'+l.id+'" requires a vector source')):P!=="vector"||l["source-layer"]?P==="raster-dem"&&t!=="hillshade"?n.push(new Me(v,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):t!=="line"||!l.paint||!l.paint["line-gradient"]||P==="geojson"&&S.lineMetrics||n.push(new Me(v,l,'layer "'+l.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):n.push(new Me(v,l,'layer "'+l.id+'" must specify a "source-layer"')):n.push(new Me(v,l.source,'source "'+l.source+'" not found'))}else n.push(new Me(v,l,'missing required property "source"'));return n=n.concat(ha({key:v,value:l,valueSpec:C.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return tr({key:v+".type",value:l.type,valueSpec:C.layer.type,style:e.style,styleSpec:e.styleSpec,object:l,objectKey:"type"})},filter:Po,layout:function(R){return ha({layer:l,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":function(O){return wl(ae({layerType:t},O))}}})},paint:function(R){return ha({layer:l,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":function(O){return ps(ae({layerType:t},O))}}})}}}))}function pa(e){var n=e.value,l=e.key,v=Jr(n);return v!=="string"?[new Me(l,n,"string expected, "+v+" found")]:[]}var sn={promoteId:function(e){var n=e.key,l=e.value;if(Jr(l)==="string")return pa({key:n,value:l});var v=[];for(var E in l)v.push.apply(v,pa({key:n+"."+E,value:l[E]}));return v}};function El(e){var n=e.value,l=e.key,v=e.styleSpec,E=e.style;if(!n.type)return[new Me(l,n,'"type" is required')];var C,i=H(n.type);switch(i){case"vector":case"raster":case"raster-dem":return ha({key:l,value:n,valueSpec:v["source_"+i.replace("-","_")],style:e.style,styleSpec:v,objectElementValidators:sn});case"geojson":if(C=ha({key:l,value:n,valueSpec:v.source_geojson,style:E,styleSpec:v,objectElementValidators:sn}),n.cluster)for(var t in n.clusterProperties){var a=n.clusterProperties[t],h=a[0],_=typeof h=="string"?[h,["accumulated"],["get",t]]:h;C.push.apply(C,za({key:l+"."+t+".map",value:a[1],expressionContext:"cluster-map"})),C.push.apply(C,za({key:l+"."+t+".reduce",value:_,expressionContext:"cluster-reduce"}))}return C;case"video":return ha({key:l,value:n,valueSpec:v.source_video,style:E,styleSpec:v});case"image":return ha({key:l,value:n,valueSpec:v.source_image,style:E,styleSpec:v});case"canvas":return[new Me(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vl({key:l+".type",value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:E,styleSpec:v})}}function Qs(e){var n=e.value,l=e.styleSpec,v=l.light,E=e.style,C=[],i=Jr(n);if(n===void 0)return C;if(i!=="object")return C.concat([new Me("light",n,"object expected, "+i+" found")]);for(var t in n){var a=t.match(/^(.*)-transition$/);C=C.concat(a&&v[a[1]]&&v[a[1]].transition?tr({key:t,value:n[t],valueSpec:l.transition,style:E,styleSpec:l}):v[t]?tr({key:t,value:n[t],valueSpec:v[t],style:E,styleSpec:l}):[new Me(t,n[t],'unknown property "'+t+'"')])}return C}var ds={"*":function(){return[]},array:Yl,boolean:function(e){var n=e.value,l=e.key,v=Jr(n);return v!=="boolean"?[new Me(l,n,"boolean expected, "+v+" found")]:[]},number:$l,color:function(e){var n=e.key,l=e.value,v=Jr(l);return v!=="string"?[new Me(n,l,"color expected, "+v+" found")]:ei(l)===null?[new Me(n,l,'color expected, "'+l+'" found')]:[]},constants:Qe,enum:vl,filter:Po,function:Ys,layer:$s,object:ha,source:El,light:Qs,string:pa,formatted:function(e){return pa(e).length===0?[]:za(e)},resolvedImage:function(e){return pa(e).length===0?[]:za(e)}};function tr(e){var n=e.value,l=e.valueSpec,v=e.styleSpec;return l.expression&&ss(H(n))?Ys(e):l.expression&&Js(W(n))?za(e):l.type&&ds[l.type]?ds[l.type](e):ha(ae({},e,{valueSpec:l.type?v[l.type]:l}))}function Mr(e){var n=e.value,l=e.key,v=pa(e);return v.length||(n.indexOf("{fontstack}")===-1&&v.push(new Me(l,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&v.push(new Me(l,n,'"glyphs" url must include a "{range}" token'))),v}function ti(e,n){n===void 0&&(n=ye);var l=[];return l=l.concat(tr({key:"",value:e,valueSpec:n.$root,styleSpec:n,style:e,objectElementValidators:{glyphs:Mr,"*":function(){return[]}}})),e.constants&&(l=l.concat(Qe({key:"constants",value:e.constants,style:e,styleSpec:n}))),el(l)}function el(e){return[].concat(e).sort(function(n,l){return n.line-l.line})}function Xa(e){return function(){for(var n=[],l=arguments.length;l--;)n[l]=arguments[l];return el(e.apply(this,n))}}ti.source=Xa(El),ti.light=Xa(Qs),ti.layer=Xa($s),ti.filter=Xa(Po),ti.paintProperty=Xa(ps),ti.layoutProperty=Xa(wl);var Pa=ti,eu=Pa.light,ai=Pa.paintProperty,tl=Pa.layoutProperty;function Sl(e,n){var l=!1;if(n&&n.length)for(var v=0,E=n;v<E.length;v+=1)e.fire(new je(new Error(E[v].message))),l=!0;return l}var fs=pn;function pn(e,n,l){var v=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var E=new Int32Array(this.arrayBuffer);e=E[0],this.d=(n=E[1])+2*(l=E[2]);for(var C=0;C<this.d*this.d;C++){var i=E[3+C],t=E[3+C+1];v.push(i===t?null:E.subarray(i,t))}var a=E[3+v.length+1];this.keys=E.subarray(E[3+v.length],a),this.bboxes=E.subarray(a),this.insert=this._insertReadonly}else{this.d=n+2*l;for(var h=0;h<this.d*this.d;h++)v.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=e,this.padding=l,this.scale=n/e,this.uid=0;var _=l/n*e;this.min=-_,this.max=e+_}pn.prototype.insert=function(e,n,l,v,E){this._forEachCell(n,l,v,E,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(n),this.bboxes.push(l),this.bboxes.push(v),this.bboxes.push(E)},pn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},pn.prototype._insertCell=function(e,n,l,v,E,C){this.cells[E].push(C)},pn.prototype.query=function(e,n,l,v,E){var C=this.min,i=this.max;if(e<=C&&n<=C&&i<=l&&i<=v&&!E)return Array.prototype.slice.call(this.keys);var t=[];return this._forEachCell(e,n,l,v,this._queryCell,t,{},E),t},pn.prototype._queryCell=function(e,n,l,v,E,C,i,t){var a=this.cells[E];if(a!==null)for(var h=this.keys,_=this.bboxes,b=0;b<a.length;b++){var S=a[b];if(i[S]===void 0){var P=4*S;(t?t(_[P+0],_[P+1],_[P+2],_[P+3]):e<=_[P+2]&&n<=_[P+3]&&l>=_[P+0]&&v>=_[P+1])?(i[S]=!0,C.push(h[S])):i[S]=!1}}},pn.prototype._forEachCell=function(e,n,l,v,E,C,i,t){for(var a=this._convertToCellCoord(e),h=this._convertToCellCoord(n),_=this._convertToCellCoord(l),b=this._convertToCellCoord(v),S=a;S<=_;S++)for(var P=h;P<=b;P++){var R=this.d*P+S;if((!t||t(this._convertFromCellCoord(S),this._convertFromCellCoord(P),this._convertFromCellCoord(S+1),this._convertFromCellCoord(P+1)))&&E.call(this,e,n,l,v,R,C,i,t))return}},pn.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},pn.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},pn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,n=3+this.cells.length+1+1,l=0,v=0;v<this.cells.length;v++)l+=this.cells[v].length;var E=new Int32Array(n+l+this.keys.length+this.bboxes.length);E[0]=this.extent,E[1]=this.n,E[2]=this.padding;for(var C=n,i=0;i<e.length;i++){var t=e[i];E[3+i]=C,E.set(t,C),C+=t.length}return E[3+e.length]=C,E.set(this.keys,C),E[3+e.length+1]=C+=this.keys.length,E.set(this.bboxes,C),C+=this.bboxes.length,E.buffer};var Il=X.ImageData,cc=X.ImageBitmap,zn={};function ui(e,n,l){l===void 0&&(l={}),Object.defineProperty(n,"_classRegistryKey",{value:e,writeable:!1}),zn[e]={klass:n,omit:l.omit||[],shallow:l.shallow||[]}}for(var So in ui("Object",Object),fs.serialize=function(e,n){var l=e.toArrayBuffer();return n&&n.push(l),{buffer:l}},fs.deserialize=function(e){return new fs(e.buffer)},ui("Grid",fs),ui("Color",Ui),ui("Error",Error),ui("ResolvedImage",Eo),ui("StylePropertyFunction",Wa),ui("StyleExpression",us,{omit:["_evaluator"]}),ui("ZoomDependentExpression",cs),ui("ZoomConstantExpression",Ms),ui("CompoundExpression",In,{omit:["_evaluate"]}),Kr)Kr[So]._classRegistryKey||ui("Expression_"+So,Kr[So]);function Tl(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Ds(e){return cc&&e instanceof cc}function da(e,n){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Tl(e)||Ds(e))return n&&n.push(e),e;if(ArrayBuffer.isView(e)){var l=e;return n&&n.push(l.buffer),l}if(e instanceof Il)return n&&n.push(e.data.buffer),e;if(Array.isArray(e)){for(var v=[],E=0,C=e;E<C.length;E+=1)v.push(da(C[E],n));return v}if(typeof e=="object"){var i=e.constructor,t=i._classRegistryKey;if(!t)throw new Error("can't serialize object of unregistered class");var a=i.serialize?i.serialize(e,n):{};if(!i.serialize){for(var h in e)if(e.hasOwnProperty(h)&&!(zn[t].omit.indexOf(h)>=0)){var _=e[h];a[h]=zn[t].shallow.indexOf(h)>=0?_:da(_,n)}e instanceof Error&&(a.message=e.message)}if(a.$name)throw new Error("$name property is reserved for worker serialization logic.");return t!=="Object"&&(a.$name=t),a}throw new Error("can't serialize object of type "+typeof e)}function ln(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Tl(e)||Ds(e)||ArrayBuffer.isView(e)||e instanceof Il)return e;if(Array.isArray(e))return e.map(ln);if(typeof e=="object"){var n=e.$name||"Object",l=zn[n].klass;if(!l)throw new Error("can't deserialize unregistered class "+n);if(l.deserialize)return l.deserialize(e);for(var v=Object.create(l.prototype),E=0,C=Object.keys(e);E<C.length;E+=1){var i=C[E];if(i!=="$name"){var t=e[i];v[i]=zn[n].shallow.indexOf(i)>=0?t:ln(t)}}return v}throw new Error("can't deserialize object of type "+typeof e)}var Ka=function(){this.first=!0};Ka.prototype.update=function(e,n){var l=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=l,!0))};var Wt={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function tu(e){for(var n=0,l=e;n<l.length;n+=1)if(ms(l[n].charCodeAt(0)))return!0;return!1}function ms(e){return!(e!==746&&e!==747&&(e<4352||!(Wt["Bopomofo Extended"](e)||Wt.Bopomofo(e)||Wt["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Wt["CJK Compatibility Ideographs"](e)||Wt["CJK Compatibility"](e)||Wt["CJK Radicals Supplement"](e)||Wt["CJK Strokes"](e)||!(!Wt["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||Wt["CJK Unified Ideographs Extension A"](e)||Wt["CJK Unified Ideographs"](e)||Wt["Enclosed CJK Letters and Months"](e)||Wt["Hangul Compatibility Jamo"](e)||Wt["Hangul Jamo Extended-A"](e)||Wt["Hangul Jamo Extended-B"](e)||Wt["Hangul Jamo"](e)||Wt["Hangul Syllables"](e)||Wt.Hiragana(e)||Wt["Ideographic Description Characters"](e)||Wt.Kanbun(e)||Wt["Kangxi Radicals"](e)||Wt["Katakana Phonetic Extensions"](e)||Wt.Katakana(e)&&e!==12540||!(!Wt["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!Wt["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Wt["Unified Canadian Aboriginal Syllabics"](e)||Wt["Unified Canadian Aboriginal Syllabics Extended"](e)||Wt["Vertical Forms"](e)||Wt["Yijing Hexagram Symbols"](e)||Wt["Yi Syllables"](e)||Wt["Yi Radicals"](e))))}function iu(e){return!(ms(e)||function(n){return!!(Wt["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Wt["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Wt["Letterlike Symbols"](n)||Wt["Number Forms"](n)||Wt["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Wt["Control Pictures"](n)&&n!==9251||Wt["Optical Character Recognition"](n)||Wt["Enclosed Alphanumerics"](n)||Wt["Geometric Shapes"](n)||Wt["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Wt["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Wt["CJK Symbols and Punctuation"](n)||Wt.Katakana(n)||Wt["Private Use Area"](n)||Wt["CJK Compatibility Forms"](n)||Wt["Small Form Variants"](n)||Wt["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(e))}function jo(e){return e>=1424&&e<=2303||Wt["Arabic Presentation Forms-A"](e)||Wt["Arabic Presentation Forms-B"](e)}function dn(e,n){return!(!n&&jo(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Wt.Khmer(e))}function rn(e){for(var n=0,l=e;n<l.length;n+=1)if(jo(l[n].charCodeAt(0)))return!0;return!1}var il=null,Io="unavailable",Ma=null,hc=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(Io="error"),il&&il(e)};function Al(){pc.fire(new Ae("pluginStateChange",{pluginStatus:Io,pluginURL:Ma}))}var pc=new Ge,ba=function(){return Io},Wo=function(){if(Io!=="deferred"||!Ma)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Io="loading",Al(),Ma&&Uo({url:Ma},function(e){e?hc(e):(Io="loaded",Al())})},ci={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Io==="loaded"||ci.applyArabicShaping!=null},isLoading:function(){return Io==="loading"},setState:function(e){Io=e.pluginStatus,Ma=e.pluginURL},isParsed:function(){return ci.applyArabicShaping!=null&&ci.processBidirectionalText!=null&&ci.processStyledBidirectionalText!=null},getPluginURL:function(){return Ma}},Vt=function(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ka,this.transition={})};Vt.prototype.isSupportedScript=function(e){return function(n,l){for(var v=0,E=n;v<E.length;v+=1)if(!dn(E[v].charCodeAt(0),l))return!1;return!0}(e,ci.isLoaded())},Vt.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Vt.prototype.getCrossfadeParameters=function(){var e=this.zoom,n=e-Math.floor(e),l=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*n}};var Xo=function(e,n){this.property=e,this.value=n,this.expression=function(l,v){if(ss(l))return new Wa(l,v);if(Js(l)){var E=lc(l,v);if(E.result==="error")throw new Error(E.value.map(function(i){return i.key+": "+i.message}).join(", "));return E.value}var C=l;return typeof l=="string"&&v.type==="color"&&(C=Ui.parse(l)),{kind:"constant",evaluate:function(){return C}}}(n===void 0?e.specification.default:n,e.specification)};Xo.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Xo.prototype.possiblyEvaluate=function(e,n,l){return this.property.possiblyEvaluate(this,e,n,l)};var Mo=function(e){this.property=e,this.value=new Xo(e,void 0)};Mo.prototype.transitioned=function(e,n){return new fn(this.property,this.value,n,Ue({},e.transition,this.transition),e.now)},Mo.prototype.untransitioned=function(){return new fn(this.property,this.value,null,{},0)};var Vn=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};Vn.prototype.getValue=function(e){return _i(this._values[e].value.value)},Vn.prototype.setValue=function(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Mo(this._values[e].property)),this._values[e].value=new Xo(this._values[e].property,n===null?void 0:_i(n))},Vn.prototype.getTransition=function(e){return _i(this._values[e].transition)},Vn.prototype.setTransition=function(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Mo(this._values[e].property)),this._values[e].transition=_i(n)||void 0},Vn.prototype.serialize=function(){for(var e={},n=0,l=Object.keys(this._values);n<l.length;n+=1){var v=l[n],E=this.getValue(v);E!==void 0&&(e[v]=E);var C=this.getTransition(v);C!==void 0&&(e[v+"-transition"]=C)}return e},Vn.prototype.transitioned=function(e,n){for(var l=new Ko(this._properties),v=0,E=Object.keys(this._values);v<E.length;v+=1){var C=E[v];l._values[C]=this._values[C].transitioned(e,n._values[C])}return l},Vn.prototype.untransitioned=function(){for(var e=new Ko(this._properties),n=0,l=Object.keys(this._values);n<l.length;n+=1){var v=l[n];e._values[v]=this._values[v].untransitioned()}return e};var fn=function(e,n,l,v,E){this.property=e,this.value=n,this.begin=E+v.delay||0,this.end=this.begin+v.duration||0,e.specification.transition&&(v.delay||v.duration)&&(this.prior=l)};fn.prototype.possiblyEvaluate=function(e,n,l){var v=e.now||0,E=this.value.possiblyEvaluate(e,n,l),C=this.prior;if(C){if(v>this.end)return this.prior=null,E;if(this.value.isDataDriven())return this.prior=null,E;if(v<this.begin)return C.possiblyEvaluate(e,n,l);var i=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(C.possiblyEvaluate(e,n,l),E,function(t){if(t<=0)return 0;if(t>=1)return 1;var a=t*t,h=a*t;return 4*(t<.5?h:3*(t-a)+h-.75)}(i))}return E};var Ko=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Ko.prototype.possiblyEvaluate=function(e,n,l){for(var v=new ys(this._properties),E=0,C=Object.keys(this._values);E<C.length;E+=1){var i=C[E];v._values[i]=this._values[i].possiblyEvaluate(e,n,l)}return v},Ko.prototype.hasTransition=function(){for(var e=0,n=Object.keys(this._values);e<n.length;e+=1)if(this._values[n[e]].prior)return!0;return!1};var bn=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};bn.prototype.getValue=function(e){return _i(this._values[e].value)},bn.prototype.setValue=function(e,n){this._values[e]=new Xo(this._values[e].property,n===null?void 0:_i(n))},bn.prototype.serialize=function(){for(var e={},n=0,l=Object.keys(this._values);n<l.length;n+=1){var v=l[n],E=this.getValue(v);E!==void 0&&(e[v]=E)}return e},bn.prototype.possiblyEvaluate=function(e,n,l){for(var v=new ys(this._properties),E=0,C=Object.keys(this._values);E<C.length;E+=1){var i=C[E];v._values[i]=this._values[i].possiblyEvaluate(e,n,l)}return v};var Lo=function(e,n,l){this.property=e,this.value=n,this.parameters=l};Lo.prototype.isConstant=function(){return this.value.kind==="constant"},Lo.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},Lo.prototype.evaluate=function(e,n,l,v){return this.property.evaluate(this.value,this.parameters,e,n,l,v)};var ys=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};ys.prototype.get=function(e){return this._values[e]};var Kt=function(e){this.specification=e};Kt.prototype.possiblyEvaluate=function(e,n){return e.expression.evaluate(n)},Kt.prototype.interpolate=function(e,n,l){var v=mo[this.specification.type];return v?v(e,n,l):e};var Xt=function(e,n){this.specification=e,this.overrides=n};Xt.prototype.possiblyEvaluate=function(e,n,l,v){return new Lo(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},l,v)}:e.expression,n)},Xt.prototype.interpolate=function(e,n,l){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new Lo(this,{kind:"constant",value:void 0},e.parameters);var v=mo[this.specification.type];return v?new Lo(this,{kind:"constant",value:v(e.value.value,n.value.value,l)},e.parameters):e},Xt.prototype.evaluate=function(e,n,l,v,E,C){return e.kind==="constant"?e.value:e.evaluate(n,l,v,E,C)};var ru=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.possiblyEvaluate=function(l,v,E,C){if(l.value===void 0)return new Lo(this,{kind:"constant",value:void 0},v);if(l.expression.kind==="constant"){var i=l.expression.evaluate(v,null,{},E,C),t=l.property.specification.type==="resolvedImage"&&typeof i!="string"?i.name:i,a=this._calculate(t,t,t,v);return new Lo(this,{kind:"constant",value:a},v)}if(l.expression.kind==="camera"){var h=this._calculate(l.expression.evaluate({zoom:v.zoom-1}),l.expression.evaluate({zoom:v.zoom}),l.expression.evaluate({zoom:v.zoom+1}),v);return new Lo(this,{kind:"constant",value:h},v)}return new Lo(this,l.expression,v)},n.prototype.evaluate=function(l,v,E,C,i,t){if(l.kind==="source"){var a=l.evaluate(v,E,C,i,t);return this._calculate(a,a,a,v)}return l.kind==="composite"?this._calculate(l.evaluate({zoom:Math.floor(v.zoom)-1},E,C),l.evaluate({zoom:Math.floor(v.zoom)},E,C),l.evaluate({zoom:Math.floor(v.zoom)+1},E,C),v):l.value},n.prototype._calculate=function(l,v,E,C){return C.zoom>C.zoomHistory.lastIntegerZoom?{from:l,to:v}:{from:E,to:v}},n.prototype.interpolate=function(l){return l},n}(Xt),On=function(e){this.specification=e};On.prototype.possiblyEvaluate=function(e,n,l,v){if(e.value!==void 0){if(e.expression.kind==="constant"){var E=e.expression.evaluate(n,null,{},l,v);return this._calculate(E,E,E,n)}return this._calculate(e.expression.evaluate(new Vt(Math.floor(n.zoom-1),n)),e.expression.evaluate(new Vt(Math.floor(n.zoom),n)),e.expression.evaluate(new Vt(Math.floor(n.zoom+1),n)),n)}},On.prototype._calculate=function(e,n,l,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:l,to:n}},On.prototype.interpolate=function(e){return e};var Vo=function(e){this.specification=e};Vo.prototype.possiblyEvaluate=function(e,n,l,v){return!!e.expression.evaluate(n,null,{},l,v)},Vo.prototype.interpolate=function(){return!1};var T=function(e){for(var n in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var l=e[n];l.specification.overridable&&this.overridableProperties.push(n);var v=this.defaultPropertyValues[n]=new Xo(l,void 0),E=this.defaultTransitionablePropertyValues[n]=new Mo(l);this.defaultTransitioningPropertyValues[n]=E.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=v.possiblyEvaluate({})}};ui("DataDrivenProperty",Xt),ui("DataConstantProperty",Kt),ui("CrossFadedDataDrivenProperty",ru),ui("CrossFadedProperty",On),ui("ColorRampProperty",Vo);var o=function(e){function n(l,v){if(e.call(this),this.id=l.id,this.type=l.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},l.type!=="custom"&&(this.metadata=(l=l).metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter),v.layout&&(this._unevaluatedLayout=new bn(v.layout)),v.paint)){for(var E in this._transitionablePaint=new Vn(v.paint),l.paint)this.setPaintProperty(E,l.paint[E],{validate:!1});for(var C in l.layout)this.setLayoutProperty(C,l.layout[C],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ys(v.paint)}}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},n.prototype.getLayoutProperty=function(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)},n.prototype.setLayoutProperty=function(l,v,E){E===void 0&&(E={}),v!=null&&this._validate(tl,"layers."+this.id+".layout."+l,l,v,E)||(l!=="visibility"?this._unevaluatedLayout.setValue(l,v):this.visibility=v)},n.prototype.getPaintProperty=function(l){return $t(l,"-transition")?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)},n.prototype.setPaintProperty=function(l,v,E){if(E===void 0&&(E={}),v!=null&&this._validate(ai,"layers."+this.id+".paint."+l,l,v,E))return!1;if($t(l,"-transition"))return this._transitionablePaint.setTransition(l.slice(0,-11),v||void 0),!1;var C=this._transitionablePaint._values[l],i=C.property.specification["property-type"]==="cross-faded-data-driven",t=C.value.isDataDriven(),a=C.value;this._transitionablePaint.setValue(l,v),this._handleSpecialPaintPropertyUpdate(l);var h=this._transitionablePaint._values[l].value;return h.isDataDriven()||t||i||this._handleOverridablePaintPropertyUpdate(l,a,h)},n.prototype._handleSpecialPaintPropertyUpdate=function(l){},n.prototype._handleOverridablePaintPropertyUpdate=function(l,v,E){return!1},n.prototype.isHidden=function(l){return!!(this.minzoom&&l<this.minzoom)||!!(this.maxzoom&&l>=this.maxzoom)||this.visibility==="none"},n.prototype.updateTransitions=function(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)},n.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},n.prototype.recalculate=function(l,v){l.getCrossfadeParameters&&(this._crossfadeParameters=l.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,v)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,v)},n.prototype.serialize=function(){var l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),qt(l,function(v,E){return!(v===void 0||E==="layout"&&!Object.keys(v).length||E==="paint"&&!Object.keys(v).length)})},n.prototype._validate=function(l,v,E,C,i){return i===void 0&&(i={}),(!i||i.validate!==!1)&&Sl(this,l.call(Pa,{key:v,layerType:this.type,objectKey:E,value:C,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))},n.prototype.is3D=function(){return!1},n.prototype.isTileClipped=function(){return!1},n.prototype.hasOffscreenPass=function(){return!1},n.prototype.resize=function(){},n.prototype.isStateDependent=function(){for(var l in this.paint._values){var v=this.paint.get(l);if(v instanceof Lo&&Ha(v.property.specification)&&(v.value.kind==="source"||v.value.kind==="composite")&&v.value.isStateDependent)return!0}return!1},n}(Ge),g={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},I=function(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},A=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function M(e,n){n===void 0&&(n=1);var l=0,v=0;return{members:e.map(function(E){var C=g[E.type].BYTES_PER_ELEMENT,i=l=F(l,Math.max(n,C)),t=E.components||1;return v=Math.max(v,C),l+=C*t,{name:E.name,type:E.type,components:t,offset:i}}),size:F(l,Math.max(v,n)),alignment:n}}function F(e,n){return Math.ceil(e/n)*n}A.serialize=function(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},A.deserialize=function(e){var n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n},A.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},A.prototype.clear=function(){this.length=0},A.prototype.resize=function(e){this.reserve(e),this.length=e},A.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}},A.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Z=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v){var E=this.length;return this.resize(E+1),this.emplace(E,l,v)},n.prototype.emplace=function(l,v,E){var C=2*l;return this.int16[C+0]=v,this.int16[C+1]=E,l},n}(A);Z.prototype.bytesPerElement=4,ui("StructArrayLayout2i4",Z);var J=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C){var i=this.length;return this.resize(i+1),this.emplace(i,l,v,E,C)},n.prototype.emplace=function(l,v,E,C,i){var t=4*l;return this.int16[t+0]=v,this.int16[t+1]=E,this.int16[t+2]=C,this.int16[t+3]=i,l},n}(A);J.prototype.bytesPerElement=8,ui("StructArrayLayout4i8",J);var ee=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t){var a=this.length;return this.resize(a+1),this.emplace(a,l,v,E,C,i,t)},n.prototype.emplace=function(l,v,E,C,i,t,a){var h=6*l;return this.int16[h+0]=v,this.int16[h+1]=E,this.int16[h+2]=C,this.int16[h+3]=i,this.int16[h+4]=t,this.int16[h+5]=a,l},n}(A);ee.prototype.bytesPerElement=12,ui("StructArrayLayout2i4i12",ee);var re=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t){var a=this.length;return this.resize(a+1),this.emplace(a,l,v,E,C,i,t)},n.prototype.emplace=function(l,v,E,C,i,t,a){var h=4*l,_=8*l;return this.int16[h+0]=v,this.int16[h+1]=E,this.uint8[_+4]=C,this.uint8[_+5]=i,this.uint8[_+6]=t,this.uint8[_+7]=a,l},n}(A);re.prototype.bytesPerElement=8,ui("StructArrayLayout2i4ub8",re);var ue=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v){var E=this.length;return this.resize(E+1),this.emplace(E,l,v)},n.prototype.emplace=function(l,v,E){var C=2*l;return this.float32[C+0]=v,this.float32[C+1]=E,l},n}(A);ue.prototype.bytesPerElement=8,ui("StructArrayLayout2f8",ue);var xe=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t,a,h,_,b){var S=this.length;return this.resize(S+1),this.emplace(S,l,v,E,C,i,t,a,h,_,b)},n.prototype.emplace=function(l,v,E,C,i,t,a,h,_,b,S){var P=10*l;return this.uint16[P+0]=v,this.uint16[P+1]=E,this.uint16[P+2]=C,this.uint16[P+3]=i,this.uint16[P+4]=t,this.uint16[P+5]=a,this.uint16[P+6]=h,this.uint16[P+7]=_,this.uint16[P+8]=b,this.uint16[P+9]=S,l},n}(A);xe.prototype.bytesPerElement=20,ui("StructArrayLayout10ui20",xe);var Fe=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t,a,h,_,b,S,P){var R=this.length;return this.resize(R+1),this.emplace(R,l,v,E,C,i,t,a,h,_,b,S,P)},n.prototype.emplace=function(l,v,E,C,i,t,a,h,_,b,S,P,R){var O=12*l;return this.int16[O+0]=v,this.int16[O+1]=E,this.int16[O+2]=C,this.int16[O+3]=i,this.uint16[O+4]=t,this.uint16[O+5]=a,this.uint16[O+6]=h,this.uint16[O+7]=_,this.int16[O+8]=b,this.int16[O+9]=S,this.int16[O+10]=P,this.int16[O+11]=R,l},n}(A);Fe.prototype.bytesPerElement=24,ui("StructArrayLayout4i4ui4i24",Fe);var we=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E){var C=this.length;return this.resize(C+1),this.emplace(C,l,v,E)},n.prototype.emplace=function(l,v,E,C){var i=3*l;return this.float32[i+0]=v,this.float32[i+1]=E,this.float32[i+2]=C,l},n}(A);we.prototype.bytesPerElement=12,ui("StructArrayLayout3f12",we);var Oe=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l){var v=this.length;return this.resize(v+1),this.emplace(v,l)},n.prototype.emplace=function(l,v){return this.uint32[1*l+0]=v,l},n}(A);Oe.prototype.bytesPerElement=4,ui("StructArrayLayout1ul4",Oe);var Je=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t,a,h,_){var b=this.length;return this.resize(b+1),this.emplace(b,l,v,E,C,i,t,a,h,_)},n.prototype.emplace=function(l,v,E,C,i,t,a,h,_,b){var S=10*l,P=5*l;return this.int16[S+0]=v,this.int16[S+1]=E,this.int16[S+2]=C,this.int16[S+3]=i,this.int16[S+4]=t,this.int16[S+5]=a,this.uint32[P+3]=h,this.uint16[S+8]=_,this.uint16[S+9]=b,l},n}(A);Je.prototype.bytesPerElement=20,ui("StructArrayLayout6i1ul2ui20",Je);var Xe=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t){var a=this.length;return this.resize(a+1),this.emplace(a,l,v,E,C,i,t)},n.prototype.emplace=function(l,v,E,C,i,t,a){var h=6*l;return this.int16[h+0]=v,this.int16[h+1]=E,this.int16[h+2]=C,this.int16[h+3]=i,this.int16[h+4]=t,this.int16[h+5]=a,l},n}(A);Xe.prototype.bytesPerElement=12,ui("StructArrayLayout2i2i2i12",Xe);var nt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i){var t=this.length;return this.resize(t+1),this.emplace(t,l,v,E,C,i)},n.prototype.emplace=function(l,v,E,C,i,t){var a=4*l,h=8*l;return this.float32[a+0]=v,this.float32[a+1]=E,this.float32[a+2]=C,this.int16[h+6]=i,this.int16[h+7]=t,l},n}(A);nt.prototype.bytesPerElement=16,ui("StructArrayLayout2f1f2i16",nt);var $e=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C){var i=this.length;return this.resize(i+1),this.emplace(i,l,v,E,C)},n.prototype.emplace=function(l,v,E,C,i){var t=12*l,a=3*l;return this.uint8[t+0]=v,this.uint8[t+1]=E,this.float32[a+1]=C,this.float32[a+2]=i,l},n}(A);$e.prototype.bytesPerElement=12,ui("StructArrayLayout2ub2f12",$e);var wt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E){var C=this.length;return this.resize(C+1),this.emplace(C,l,v,E)},n.prototype.emplace=function(l,v,E,C){var i=3*l;return this.uint16[i+0]=v,this.uint16[i+1]=E,this.uint16[i+2]=C,l},n}(A);wt.prototype.bytesPerElement=6,ui("StructArrayLayout3ui6",wt);var dt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t,a,h,_,b,S,P,R,O,V,j,K){var $=this.length;return this.resize($+1),this.emplace($,l,v,E,C,i,t,a,h,_,b,S,P,R,O,V,j,K)},n.prototype.emplace=function(l,v,E,C,i,t,a,h,_,b,S,P,R,O,V,j,K,$){var Q=24*l,se=12*l,pe=48*l;return this.int16[Q+0]=v,this.int16[Q+1]=E,this.uint16[Q+2]=C,this.uint16[Q+3]=i,this.uint32[se+2]=t,this.uint32[se+3]=a,this.uint32[se+4]=h,this.uint16[Q+10]=_,this.uint16[Q+11]=b,this.uint16[Q+12]=S,this.float32[se+7]=P,this.float32[se+8]=R,this.uint8[pe+36]=O,this.uint8[pe+37]=V,this.uint8[pe+38]=j,this.uint32[se+10]=K,this.int16[Q+22]=$,l},n}(A);dt.prototype.bytesPerElement=48,ui("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",dt);var yt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C,i,t,a,h,_,b,S,P,R,O,V,j,K,$,Q,se,pe,ke,Ne,Ze,He,it,We,kt){var At=this.length;return this.resize(At+1),this.emplace(At,l,v,E,C,i,t,a,h,_,b,S,P,R,O,V,j,K,$,Q,se,pe,ke,Ne,Ze,He,it,We,kt)},n.prototype.emplace=function(l,v,E,C,i,t,a,h,_,b,S,P,R,O,V,j,K,$,Q,se,pe,ke,Ne,Ze,He,it,We,kt,At){var pt=34*l,Tt=17*l;return this.int16[pt+0]=v,this.int16[pt+1]=E,this.int16[pt+2]=C,this.int16[pt+3]=i,this.int16[pt+4]=t,this.int16[pt+5]=a,this.int16[pt+6]=h,this.int16[pt+7]=_,this.uint16[pt+8]=b,this.uint16[pt+9]=S,this.uint16[pt+10]=P,this.uint16[pt+11]=R,this.uint16[pt+12]=O,this.uint16[pt+13]=V,this.uint16[pt+14]=j,this.uint16[pt+15]=K,this.uint16[pt+16]=$,this.uint16[pt+17]=Q,this.uint16[pt+18]=se,this.uint16[pt+19]=pe,this.uint16[pt+20]=ke,this.uint16[pt+21]=Ne,this.uint16[pt+22]=Ze,this.uint32[Tt+12]=He,this.float32[Tt+13]=it,this.float32[Tt+14]=We,this.float32[Tt+15]=kt,this.float32[Tt+16]=At,l},n}(A);yt.prototype.bytesPerElement=68,ui("StructArrayLayout8i15ui1ul4f68",yt);var Lt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l){var v=this.length;return this.resize(v+1),this.emplace(v,l)},n.prototype.emplace=function(l,v){return this.float32[1*l+0]=v,l},n}(A);Lt.prototype.bytesPerElement=4,ui("StructArrayLayout1f4",Lt);var Nt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E){var C=this.length;return this.resize(C+1),this.emplace(C,l,v,E)},n.prototype.emplace=function(l,v,E,C){var i=3*l;return this.int16[i+0]=v,this.int16[i+1]=E,this.int16[i+2]=C,l},n}(A);Nt.prototype.bytesPerElement=6,ui("StructArrayLayout3i6",Nt);var St=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E){var C=this.length;return this.resize(C+1),this.emplace(C,l,v,E)},n.prototype.emplace=function(l,v,E,C){var i=4*l;return this.uint32[2*l+0]=v,this.uint16[i+2]=E,this.uint16[i+3]=C,l},n}(A);St.prototype.bytesPerElement=8,ui("StructArrayLayout1ul2ui8",St);var mi=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v){var E=this.length;return this.resize(E+1),this.emplace(E,l,v)},n.prototype.emplace=function(l,v,E){var C=2*l;return this.uint16[C+0]=v,this.uint16[C+1]=E,l},n}(A);mi.prototype.bytesPerElement=4,ui("StructArrayLayout2ui4",mi);var ni=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l){var v=this.length;return this.resize(v+1),this.emplace(v,l)},n.prototype.emplace=function(l,v){return this.uint16[1*l+0]=v,l},n}(A);ni.prototype.bytesPerElement=2,ui("StructArrayLayout1ui2",ni);var qi=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(l,v,E,C){var i=this.length;return this.resize(i+1),this.emplace(i,l,v,E,C)},n.prototype.emplace=function(l,v,E,C,i){var t=4*l;return this.float32[t+0]=v,this.float32[t+1]=E,this.float32[t+2]=C,this.float32[t+3]=i,l},n}(A);qi.prototype.bytesPerElement=16,ui("StructArrayLayout4f16",qi);var c=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var l={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return l.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},l.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},l.x1.get=function(){return this._structArray.int16[this._pos2+2]},l.y1.get=function(){return this._structArray.int16[this._pos2+3]},l.x2.get=function(){return this._structArray.int16[this._pos2+4]},l.y2.get=function(){return this._structArray.int16[this._pos2+5]},l.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},l.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},l.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},l.anchorPoint.get=function(){return new U(this.anchorPointX,this.anchorPointY)},Object.defineProperties(n.prototype,l),n}(I);c.prototype.size=20;var m=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(l){return new c(this,l)},n}(Je);ui("CollisionBoxArray",m);var d=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var l={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return l.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},l.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},l.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},l.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},l.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},l.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},l.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},l.segment.get=function(){return this._structArray.uint16[this._pos2+10]},l.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},l.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},l.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},l.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},l.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},l.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},l.placedOrientation.set=function(v){this._structArray.uint8[this._pos1+37]=v},l.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},l.hidden.set=function(v){this._structArray.uint8[this._pos1+38]=v},l.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},l.crossTileID.set=function(v){this._structArray.uint32[this._pos4+10]=v},l.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(n.prototype,l),n}(I);d.prototype.size=48;var x=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(l){return new d(this,l)},n}(dt);ui("PlacedSymbolArray",x);var k=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var l={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return l.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},l.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},l.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},l.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},l.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},l.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},l.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},l.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},l.key.get=function(){return this._structArray.uint16[this._pos2+8]},l.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},l.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},l.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},l.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},l.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},l.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},l.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},l.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},l.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},l.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},l.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},l.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},l.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},l.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},l.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},l.crossTileID.set=function(v){this._structArray.uint32[this._pos4+12]=v},l.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},l.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},l.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},l.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(n.prototype,l),n}(I);k.prototype.size=68;var D=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(l){return new k(this,l)},n}(yt);ui("SymbolInstanceArray",D);var B=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getoffsetX=function(l){return this.float32[1*l+0]},n}(Lt);ui("GlyphOffsetArray",B);var q=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getx=function(l){return this.int16[3*l+0]},n.prototype.gety=function(l){return this.int16[3*l+1]},n.prototype.gettileUnitDistanceFromAnchor=function(l){return this.int16[3*l+2]},n}(Nt);ui("SymbolLineVertexArray",q);var Y=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var l={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return l.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},l.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},l.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(n.prototype,l),n}(I);Y.prototype.size=8;var ie=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(l){return new Y(this,l)},n}(St);ui("FeatureIndexArray",ie);var he=M([{name:"a_pos",components:2,type:"Int16"}],4).members,de=function(e){e===void 0&&(e=[]),this.segments=e};function me(e,n){return 256*(e=Le(Math.floor(e),0,255))+Le(Math.floor(n),0,255)}de.prototype.prepareSegment=function(e,n,l,v){var E=this.segments[this.segments.length-1];return e>de.MAX_VERTEX_ARRAY_LENGTH&&Ht("Max vertices per segment is "+de.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!E||E.vertexLength+e>de.MAX_VERTEX_ARRAY_LENGTH||E.sortKey!==v)&&(E={vertexOffset:n.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},v!==void 0&&(E.sortKey=v),this.segments.push(E)),E},de.prototype.get=function(){return this.segments},de.prototype.destroy=function(){for(var e=0,n=this.segments;e<n.length;e+=1){var l=n[e];for(var v in l.vaos)l.vaos[v].destroy()}},de.simpleSegment=function(e,n,l,v){return new de([{vertexOffset:e,primitiveOffset:n,vertexLength:l,primitiveLength:v,vaos:{},sortKey:0}])},de.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ui("SegmentVector",de);var ze=M([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Ce=p(function(e){e.exports=function(n,l){var v,E,C,i,t,a,h,_;for(E=n.length-(v=3&n.length),C=l,t=3432918353,a=461845907,_=0;_<E;)h=255&n.charCodeAt(_)|(255&n.charCodeAt(++_))<<8|(255&n.charCodeAt(++_))<<16|(255&n.charCodeAt(++_))<<24,++_,C=27492+(65535&(i=5*(65535&(C=(C^=h=(65535&(h=(h=(65535&h)*t+(((h>>>16)*t&65535)<<16)&4294967295)<<15|h>>>17))*a+(((h>>>16)*a&65535)<<16)&4294967295)<<13|C>>>19))+((5*(C>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(h=0,v){case 3:h^=(255&n.charCodeAt(_+2))<<16;case 2:h^=(255&n.charCodeAt(_+1))<<8;case 1:C^=h=(65535&(h=(h=(65535&(h^=255&n.charCodeAt(_)))*t+(((h>>>16)*t&65535)<<16)&4294967295)<<15|h>>>17))*a+(((h>>>16)*a&65535)<<16)&4294967295}return C^=n.length,C=2246822507*(65535&(C^=C>>>16))+((2246822507*(C>>>16)&65535)<<16)&4294967295,C=3266489909*(65535&(C^=C>>>13))+((3266489909*(C>>>16)&65535)<<16)&4294967295,(C^=C>>>16)>>>0}}),Be=p(function(e){e.exports=function(n,l){for(var v,E=n.length,C=l^E,i=0;E>=4;)v=1540483477*(65535&(v=255&n.charCodeAt(i)|(255&n.charCodeAt(++i))<<8|(255&n.charCodeAt(++i))<<16|(255&n.charCodeAt(++i))<<24))+((1540483477*(v>>>16)&65535)<<16),C=1540483477*(65535&C)+((1540483477*(C>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),E-=4,++i;switch(E){case 3:C^=(255&n.charCodeAt(i+2))<<16;case 2:C^=(255&n.charCodeAt(i+1))<<8;case 1:C=1540483477*(65535&(C^=255&n.charCodeAt(i)))+((1540483477*(C>>>16)&65535)<<16)}return C=1540483477*(65535&(C^=C>>>13))+((1540483477*(C>>>16)&65535)<<16),(C^=C>>>15)>>>0}}),be=Ce,Pe=Be;be.murmur3=Ce,be.murmur2=Pe;var Ve=function(){this.ids=[],this.positions=[],this.indexed=!1};Ve.prototype.add=function(e,n,l,v){this.ids.push(ot(e)),this.positions.push(n,l,v)},Ve.prototype.getPositions=function(e){for(var n=ot(e),l=0,v=this.ids.length-1;l<v;){var E=l+v>>1;this.ids[E]>=n?v=E:l=E+1}for(var C=[];this.ids[l]===n;)C.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return C},Ve.serialize=function(e,n){var l=new Float64Array(e.ids),v=new Uint32Array(e.positions);return function E(C,i,t,a){for(;t<a;){for(var h=C[t+a>>1],_=t-1,b=a+1;;){do _++;while(C[_]<h);do b--;while(C[b]>h);if(_>=b)break;lt(C,_,b),lt(i,3*_,3*b),lt(i,3*_+1,3*b+1),lt(i,3*_+2,3*b+2)}b-t<a-b?(E(C,i,t,b),t=b+1):(E(C,i,b+1,a),a=b)}}(l,v,0,l.length-1),n&&n.push(l.buffer,v.buffer),{ids:l,positions:v}},Ve.deserialize=function(e){var n=new Ve;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n};var Ye=Math.pow(2,53)-1;function ot(e){var n=+e;return!isNaN(n)&&n<=Ye?n:be(String(e))}function lt(e,n,l){var v=e[n];e[n]=e[l],e[l]=v}ui("FeaturePositionMap",Ve);var ct=function(e,n){this.gl=e.gl,this.location=n},It=function(e){function n(l,v){e.call(this,l,v),this.current=0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))},n}(ct),Ot=function(e){function n(l,v){e.call(this,l,v),this.current=0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))},n}(ct),Rt=function(e){function n(l,v){e.call(this,l,v),this.current=[0,0]}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))},n}(ct),ii=function(e){function n(l,v){e.call(this,l,v),this.current=[0,0,0]}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))},n}(ct),gi=function(e){function n(l,v){e.call(this,l,v),this.current=[0,0,0,0]}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3]))},n}(ct),Ii=function(e){function n(l,v){e.call(this,l,v),this.current=Ui.transparent}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a))},n}(ct),yi=new Float32Array(16),lr=function(e){function n(l,v){e.call(this,l,v),this.current=yi}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(var v=1;v<16;v++)if(l[v]!==this.current[v]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}},n}(ct);function si(e){return[me(255*e.r,255*e.g),me(255*e.b,255*e.a)]}var ji=function(e,n,l){this.value=e,this.uniformNames=n.map(function(v){return"u_"+v}),this.type=l};ji.prototype.setUniform=function(e,n,l){e.set(l.constantOr(this.value))},ji.prototype.getBinding=function(e,n,l){return this.type==="color"?new Ii(e,n):new Ot(e,n)};var ir=function(e,n){this.uniformNames=n.map(function(l){return"u_"+l}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ir.prototype.setConstantPatternPositions=function(e,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=e.tlbr},ir.prototype.setUniform=function(e,n,l,v){var E=v==="u_pattern_to"?this.patternTo:v==="u_pattern_from"?this.patternFrom:v==="u_pixel_ratio_to"?this.pixelRatioTo:v==="u_pixel_ratio_from"?this.pixelRatioFrom:null;E&&e.set(E)},ir.prototype.getBinding=function(e,n,l){return l.substr(0,9)==="u_pattern"?new gi(e,n):new Ot(e,n)};var Oi=function(e,n,l,v){this.expression=e,this.type=l,this.maxValue=0,this.paintVertexAttributes=n.map(function(E){return{name:"a_"+E,type:"Float32",components:l==="color"?2:1,offset:0}}),this.paintVertexArray=new v};Oi.prototype.populatePaintArray=function(e,n,l,v,E){var C=this.paintVertexArray.length,i=this.expression.evaluate(new Vt(0),n,{},v,[],E);this.paintVertexArray.resize(e),this._setPaintValue(C,e,i)},Oi.prototype.updatePaintArray=function(e,n,l,v){var E=this.expression.evaluate({zoom:0},l,v);this._setPaintValue(e,n,E)},Oi.prototype._setPaintValue=function(e,n,l){if(this.type==="color")for(var v=si(l),E=e;E<n;E++)this.paintVertexArray.emplace(E,v[0],v[1]);else{for(var C=e;C<n;C++)this.paintVertexArray.emplace(C,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}},Oi.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Oi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Di=function(e,n,l,v,E,C){this.expression=e,this.uniformNames=n.map(function(i){return"u_"+i+"_t"}),this.type=l,this.useIntegerZoom=v,this.zoom=E,this.maxValue=0,this.paintVertexAttributes=n.map(function(i){return{name:"a_"+i,type:"Float32",components:l==="color"?4:2,offset:0}}),this.paintVertexArray=new C};Di.prototype.populatePaintArray=function(e,n,l,v,E){var C=this.expression.evaluate(new Vt(this.zoom),n,{},v,[],E),i=this.expression.evaluate(new Vt(this.zoom+1),n,{},v,[],E),t=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(t,e,C,i)},Di.prototype.updatePaintArray=function(e,n,l,v){var E=this.expression.evaluate({zoom:this.zoom},l,v),C=this.expression.evaluate({zoom:this.zoom+1},l,v);this._setPaintValue(e,n,E,C)},Di.prototype._setPaintValue=function(e,n,l,v){if(this.type==="color")for(var E=si(l),C=si(v),i=e;i<n;i++)this.paintVertexArray.emplace(i,E[0],E[1],C[0],C[1]);else{for(var t=e;t<n;t++)this.paintVertexArray.emplace(t,l,v);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(v))}},Di.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Di.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Di.prototype.setUniform=function(e,n){var l=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,v=Le(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);e.set(v)},Di.prototype.getBinding=function(e,n,l){return new Ot(e,n)};var Zi=function(e,n,l,v,E,C){this.expression=e,this.type=n,this.useIntegerZoom=l,this.zoom=v,this.layerId=C,this.zoomInPaintVertexArray=new E,this.zoomOutPaintVertexArray=new E};Zi.prototype.populatePaintArray=function(e,n,l){var v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(v,e,n.patterns&&n.patterns[this.layerId],l)},Zi.prototype.updatePaintArray=function(e,n,l,v,E){this._setPaintValues(e,n,l.patterns&&l.patterns[this.layerId],E)},Zi.prototype._setPaintValues=function(e,n,l,v){if(v&&l){var E=v[l.min],C=v[l.mid],i=v[l.max];if(E&&C&&i)for(var t=e;t<n;t++)this.zoomInPaintVertexArray.emplace(t,C.tl[0],C.tl[1],C.br[0],C.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],C.pixelRatio,E.pixelRatio),this.zoomOutPaintVertexArray.emplace(t,C.tl[0],C.tl[1],C.br[0],C.br[1],i.tl[0],i.tl[1],i.br[0],i.br[1],C.pixelRatio,i.pixelRatio)}},Zi.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,ze.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,ze.members,this.expression.isStateDependent))},Zi.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var zi=function(e,n,l){this.binders={},this._buffers=[];var v=[];for(var E in e.paint._values)if(l(E)){var C=e.paint.get(E);if(C instanceof Lo&&Ha(C.property.specification)){var i=mn(E,e.type),t=C.value,a=C.property.specification.type,h=C.property.useIntegerZoom,_=C.property.specification["property-type"],b=_==="cross-faded"||_==="cross-faded-data-driven";if(t.kind==="constant")this.binders[E]=b?new ir(t.value,i):new ji(t.value,i,a),v.push("/u_"+E);else if(t.kind==="source"||b){var S=Cn(E,a,"source");this.binders[E]=b?new Zi(t,a,h,n,S,e.id):new Oi(t,i,a,S),v.push("/a_"+E)}else{var P=Cn(E,a,"composite");this.binders[E]=new Di(t,i,a,h,n,P),v.push("/z_"+E)}}}this.cacheKey=v.sort().join("")};zi.prototype.getMaxValue=function(e){var n=this.binders[e];return n instanceof Oi||n instanceof Di?n.maxValue:0},zi.prototype.populatePaintArrays=function(e,n,l,v,E){for(var C in this.binders){var i=this.binders[C];(i instanceof Oi||i instanceof Di||i instanceof Zi)&&i.populatePaintArray(e,n,l,v,E)}},zi.prototype.setConstantPatternPositions=function(e,n){for(var l in this.binders){var v=this.binders[l];v instanceof ir&&v.setConstantPatternPositions(e,n)}},zi.prototype.updatePaintArrays=function(e,n,l,v,E){var C=!1;for(var i in e)for(var t=0,a=n.getPositions(i);t<a.length;t+=1){var h=a[t],_=l.feature(h.index);for(var b in this.binders){var S=this.binders[b];if((S instanceof Oi||S instanceof Di||S instanceof Zi)&&S.expression.isStateDependent===!0){var P=v.paint.get(b);S.expression=P.value,S.updatePaintArray(h.start,h.end,_,e[i],E),C=!0}}}return C},zi.prototype.defines=function(){var e=[];for(var n in this.binders){var l=this.binders[n];(l instanceof ji||l instanceof ir)&&e.push.apply(e,l.uniformNames.map(function(v){return"#define HAS_UNIFORM_"+v}))}return e},zi.prototype.getBinderAttributes=function(){var e=[];for(var n in this.binders){var l=this.binders[n];if(l instanceof Oi||l instanceof Di)for(var v=0;v<l.paintVertexAttributes.length;v++)e.push(l.paintVertexAttributes[v].name);else if(l instanceof Zi)for(var E=0;E<ze.members.length;E++)e.push(ze.members[E].name)}return e},zi.prototype.getBinderUniforms=function(){var e=[];for(var n in this.binders){var l=this.binders[n];if(l instanceof ji||l instanceof ir||l instanceof Di)for(var v=0,E=l.uniformNames;v<E.length;v+=1)e.push(E[v])}return e},zi.prototype.getPaintVertexBuffers=function(){return this._buffers},zi.prototype.getUniforms=function(e,n){var l=[];for(var v in this.binders){var E=this.binders[v];if(E instanceof ji||E instanceof ir||E instanceof Di)for(var C=0,i=E.uniformNames;C<i.length;C+=1){var t=i[C];if(n[t]){var a=E.getBinding(e,n[t],t);l.push({name:t,property:v,binding:a})}}}return l},zi.prototype.setUniforms=function(e,n,l,v){for(var E=0,C=n;E<C.length;E+=1){var i=C[E],t=i.name,a=i.property;this.binders[a].setUniform(i.binding,v,l.get(a),t)}},zi.prototype.updatePaintBuffers=function(e){for(var n in this._buffers=[],this.binders){var l=this.binders[n];if(e&&l instanceof Zi){var v=e.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(l instanceof Oi||l instanceof Di)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}},zi.prototype.upload=function(e){for(var n in this.binders){var l=this.binders[n];(l instanceof Oi||l instanceof Di||l instanceof Zi)&&l.upload(e)}this.updatePaintBuffers()},zi.prototype.destroy=function(){for(var e in this.binders){var n=this.binders[e];(n instanceof Oi||n instanceof Di||n instanceof Zi)&&n.destroy()}};var Ei=function(e,n,l){l===void 0&&(l=function(){return!0}),this.programConfigurations={};for(var v=0,E=e;v<E.length;v+=1){var C=E[v];this.programConfigurations[C.id]=new zi(C,n,l)}this.needsUpload=!1,this._featureMap=new Ve,this._bufferOffset=0};function mn(e,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(n+"-","").replace(/-/g,"_")]}function Cn(e,n,l){var v={color:{source:ue,composite:qi},number:{source:Lt,composite:ue}},E=function(C){return{"line-pattern":{source:xe,composite:xe},"fill-pattern":{source:xe,composite:xe},"fill-extrusion-pattern":{source:xe,composite:xe}}[C]}(e);return E&&E[l]||v[n][l]}Ei.prototype.populatePaintArrays=function(e,n,l,v,E,C){for(var i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(e,n,v,E,C);n.id!==void 0&&this._featureMap.add(n.id,l,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Ei.prototype.updatePaintArrays=function(e,n,l,v){for(var E=0,C=l;E<C.length;E+=1){var i=C[E];this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(e,this._featureMap,n,i,v)||this.needsUpload}},Ei.prototype.get=function(e){return this.programConfigurations[e]},Ei.prototype.upload=function(e){if(this.needsUpload){for(var n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}},Ei.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},ui("ConstantBinder",ji),ui("CrossFadedConstantBinder",ir),ui("SourceExpressionBinder",Oi),ui("CrossFadedCompositeBinder",Zi),ui("CompositeExpressionBinder",Di),ui("ProgramConfiguration",zi,{omit:["_buffers"]}),ui("ProgramConfigurationSet",Ei);var Fn=Math.pow(2,14)-1,To=-Fn-1;function wn(e){for(var n=8192/e.extent,l=e.loadGeometry(),v=0;v<l.length;v++)for(var E=l[v],C=0;C<E.length;C++){var i=E[C],t=Math.round(i.x*n),a=Math.round(i.y*n);i.x=Le(t,To,Fn),i.y=Le(a,To,Fn),(t<i.x||t>i.x+1||a<i.y||a>i.y+1)&&Ht("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return l}function hr(e,n){return{type:e.type,id:e.id,properties:e.properties,geometry:n?wn(e):[]}}function Jo(e,n,l,v,E){e.emplaceBack(2*n+(v+1)/2,2*l+(E+1)/2)}var qo=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Z,this.indexArray=new wt,this.segments=new de,this.programConfigurations=new Ei(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};function wa(e,n){for(var l=0;l<e.length;l++)if(Rs(n,e[l]))return!0;for(var v=0;v<n.length;v++)if(Rs(e,n[v]))return!0;return!!Lu(e,n)}function ro(e,n,l){return!!Rs(e,n)||!!rl(n,e,l)}function Ea(e,n){if(e.length===1)return nu(n,e[0]);for(var l=0;l<n.length;l++)for(var v=n[l],E=0;E<v.length;E++)if(Rs(e,v[E]))return!0;for(var C=0;C<e.length;C++)if(nu(n,e[C]))return!0;for(var i=0;i<n.length;i++)if(Lu(e,n[i]))return!0;return!1}function Sa(e,n,l){if(e.length>1){if(Lu(e,n))return!0;for(var v=0;v<n.length;v++)if(rl(n[v],e,l))return!0}for(var E=0;E<e.length;E++)if(rl(e[E],n,l))return!0;return!1}function Lu(e,n){if(e.length===0||n.length===0)return!1;for(var l=0;l<e.length-1;l++)for(var v=e[l],E=e[l+1],C=0;C<n.length-1;C++)if(Du(v,E,n[C],n[C+1]))return!0;return!1}function Du(e,n,l,v){return Qt(e,l,v)!==Qt(n,l,v)&&Qt(e,n,l)!==Qt(e,n,v)}function rl(e,n,l){var v=l*l;if(n.length===1)return e.distSqr(n[0])<v;for(var E=1;E<n.length;E++)if(Ru(e,n[E-1],n[E])<v)return!0;return!1}function Ru(e,n,l){var v=n.distSqr(l);if(v===0)return e.distSqr(n);var E=((e.x-n.x)*(l.x-n.x)+(e.y-n.y)*(l.y-n.y))/v;return e.distSqr(E<0?n:E>1?l:l.sub(n)._mult(E)._add(n))}function nu(e,n){for(var l,v,E,C=!1,i=0;i<e.length;i++)for(var t=0,a=(l=e[i]).length-1;t<l.length;a=t++)(v=l[t]).y>n.y!=(E=l[a]).y>n.y&&n.x<(E.x-v.x)*(n.y-v.y)/(E.y-v.y)+v.x&&(C=!C);return C}function Rs(e,n){for(var l=!1,v=0,E=e.length-1;v<e.length;E=v++){var C=e[v],i=e[E];C.y>n.y!=i.y>n.y&&n.x<(i.x-C.x)*(n.y-C.y)/(i.y-C.y)+C.x&&(l=!l)}return l}function ou(e,n,l){var v=l[0],E=l[2];if(e.x<v.x&&n.x<v.x||e.x>E.x&&n.x>E.x||e.y<v.y&&n.y<v.y||e.y>E.y&&n.y>E.y)return!1;var C=Qt(e,n,l[0]);return C!==Qt(e,n,l[1])||C!==Qt(e,n,l[2])||C!==Qt(e,n,l[3])}function gs(e,n,l){var v=n.paint.get(e).value;return v.kind==="constant"?v.value:l.programConfigurations.get(n.id).getMaxValue(e)}function no(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Ia(e,n,l,v,E){if(!n[0]&&!n[1])return e;var C=U.convert(n)._mult(E);l==="viewport"&&C._rotate(-v);for(var i=[],t=0;t<e.length;t++)i.push(e[t].sub(C));return i}qo.prototype.populate=function(e,n,l){var v=this.layers[0],E=[],C=null;v.type==="circle"&&(C=v.layout.get("circle-sort-key"));for(var i=0,t=e;i<t.length;i+=1){var a=t[i],h=a.feature,_=a.id,b=a.index,S=a.sourceLayerIndex,P=this.layers[0]._featureFilter.needGeometry,R=hr(h,P);if(this.layers[0]._featureFilter.filter(new Vt(this.zoom),R,l)){var O=C?C.evaluate(R,{},l):void 0,V={id:_,properties:h.properties,type:h.type,sourceLayerIndex:S,index:b,geometry:P?R.geometry:wn(h),patterns:{},sortKey:O};E.push(V)}}C&&E.sort(function(Ne,Ze){return Ne.sortKey-Ze.sortKey});for(var j=0,K=E;j<K.length;j+=1){var $=K[j],Q=$.geometry,se=$.index,pe=$.sourceLayerIndex,ke=e[se].feature;this.addFeature($,Q,se,l),n.featureIndex.insert(ke,Q,se,pe,this.index)}},qo.prototype.update=function(e,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,l)},qo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},qo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},qo.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,he),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},qo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},qo.prototype.addFeature=function(e,n,l,v){for(var E=0,C=n;E<C.length;E+=1)for(var i=0,t=C[E];i<t.length;i+=1){var a=t[i],h=a.x,_=a.y;if(!(h<0||h>=8192||_<0||_>=8192)){var b=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),S=b.vertexLength;Jo(this.layoutVertexArray,h,_,-1,-1),Jo(this.layoutVertexArray,h,_,1,-1),Jo(this.layoutVertexArray,h,_,1,1),Jo(this.layoutVertexArray,h,_,-1,1),this.indexArray.emplaceBack(S,S+1,S+2),this.indexArray.emplaceBack(S,S+3,S+2),b.vertexLength+=4,b.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,{},v)},ui("CircleBucket",qo,{omit:["layers"]});var Cl=new T({"circle-sort-key":new Xt(ye.layout_circle["circle-sort-key"])}),_s={paint:new T({"circle-radius":new Xt(ye.paint_circle["circle-radius"]),"circle-color":new Xt(ye.paint_circle["circle-color"]),"circle-blur":new Xt(ye.paint_circle["circle-blur"]),"circle-opacity":new Xt(ye.paint_circle["circle-opacity"]),"circle-translate":new Kt(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new Kt(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Kt(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Kt(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Xt(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Xt(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Xt(ye.paint_circle["circle-stroke-opacity"])}),layout:Cl},Sr=typeof Float32Array!="undefined"?Float32Array:Array;function Yo(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fa(e,n,l){var v=n[0],E=n[1],C=n[2],i=n[3],t=n[4],a=n[5],h=n[6],_=n[7],b=n[8],S=n[9],P=n[10],R=n[11],O=n[12],V=n[13],j=n[14],K=n[15],$=l[0],Q=l[1],se=l[2],pe=l[3];return e[0]=$*v+Q*t+se*b+pe*O,e[1]=$*E+Q*a+se*S+pe*V,e[2]=$*C+Q*h+se*P+pe*j,e[3]=$*i+Q*_+se*R+pe*K,e[4]=($=l[4])*v+(Q=l[5])*t+(se=l[6])*b+(pe=l[7])*O,e[5]=$*E+Q*a+se*S+pe*V,e[6]=$*C+Q*h+se*P+pe*j,e[7]=$*i+Q*_+se*R+pe*K,e[8]=($=l[8])*v+(Q=l[9])*t+(se=l[10])*b+(pe=l[11])*O,e[9]=$*E+Q*a+se*S+pe*V,e[10]=$*C+Q*h+se*P+pe*j,e[11]=$*i+Q*_+se*R+pe*K,e[12]=($=l[12])*v+(Q=l[13])*t+(se=l[14])*b+(pe=l[15])*O,e[13]=$*E+Q*a+se*S+pe*V,e[14]=$*C+Q*h+se*P+pe*j,e[15]=$*i+Q*_+se*R+pe*K,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,n=0,l=arguments.length;l--;)n+=e[l]*e[l];return Math.sqrt(n)});var au,Bu=fa;function Ou(e,n,l){var v=n[0],E=n[1],C=n[2],i=n[3];return e[0]=l[0]*v+l[4]*E+l[8]*C+l[12]*i,e[1]=l[1]*v+l[5]*E+l[9]*C+l[13]*i,e[2]=l[2]*v+l[6]*E+l[10]*C+l[14]*i,e[3]=l[3]*v+l[7]*E+l[11]*C+l[15]*i,e}au=new Sr(3),Sr!=Float32Array&&(au[0]=0,au[1]=0,au[2]=0),function(){var e=new Sr(4);Sr!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var ip=(function(){var e=new Sr(2);Sr!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function n(l){e.call(this,l,_s)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.createBucket=function(l){return new qo(l)},n.prototype.queryRadius=function(l){var v=l;return gs("circle-radius",this,v)+gs("circle-stroke-width",this,v)+no(this.paint.get("circle-translate"))},n.prototype.queryIntersectsFeature=function(l,v,E,C,i,t,a,h){for(var _=Ia(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),t.angle,a),b=this.paint.get("circle-radius").evaluate(v,E)+this.paint.get("circle-stroke-width").evaluate(v,E),S=this.paint.get("circle-pitch-alignment")==="map",P=S?_:function(ke,Ne){return ke.map(function(Ze){return nl(Ze,Ne)})}(_,h),R=S?b*a:b,O=0,V=C;O<V.length;O+=1)for(var j=0,K=V[O];j<K.length;j+=1){var $=K[j],Q=S?$:nl($,h),se=R,pe=Ou([],[$.x,$.y,0,1],h);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?se*=pe[3]/t.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(se*=t.cameraToCenterDistance/pe[3]),ro(P,Q,se))return!0}return!1},n}(o));function nl(e,n){var l=Ou([],[e.x,e.y,0,1],n);return new U(l[0]/l[3],l[1]/l[3])}var rp=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(qo);function ol(e,n,l,v){var E=n.width,C=n.height;if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==E*C*l)throw new RangeError("mismatched image size")}else v=new Uint8Array(E*C*l);return e.width=E,e.height=C,e.data=v,e}function dc(e,n,l){var v=n.width,E=n.height;if(v!==e.width||E!==e.height){var C=ol({},{width:v,height:E},l);np(e,C,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,v),height:Math.min(e.height,E)},l),e.width=v,e.height=E,e.data=C.data}}function np(e,n,l,v,E,C){if(E.width===0||E.height===0)return n;if(E.width>e.width||E.height>e.height||l.x>e.width-E.width||l.y>e.height-E.height)throw new RangeError("out of range source coordinates for image copy");if(E.width>n.width||E.height>n.height||v.x>n.width-E.width||v.y>n.height-E.height)throw new RangeError("out of range destination coordinates for image copy");for(var i=e.data,t=n.data,a=0;a<E.height;a++)for(var h=((l.y+a)*e.width+l.x)*C,_=((v.y+a)*n.width+v.x)*C,b=0;b<E.width*C;b++)t[_+b]=i[h+b];return n}ui("HeatmapBucket",rp,{omit:["layers"]});var fc=function(e,n){ol(this,e,1,n)};fc.prototype.resize=function(e){dc(this,e,1)},fc.prototype.clone=function(){return new fc({width:this.width,height:this.height},new Uint8Array(this.data))},fc.copy=function(e,n,l,v,E){np(e,n,l,v,E,1)};var $o=function(e,n){ol(this,e,4,n)};$o.prototype.resize=function(e){dc(this,e,4)},$o.prototype.replace=function(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},$o.prototype.clone=function(){return new $o({width:this.width,height:this.height},new Uint8Array(this.data))},$o.copy=function(e,n,l,v,E){np(e,n,l,v,E,4)},ui("AlphaImage",fc),ui("RGBAImage",$o);var Gd={paint:new T({"heatmap-radius":new Xt(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Xt(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Kt(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Vo(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Kt(ye.paint_heatmap["heatmap-opacity"])})};function op(e){var n={},l=e.resolution||256,v=e.clips?e.clips.length:1,E=e.image||new $o({width:l,height:v}),C=function(R,O,V){n[e.evaluationKey]=V;var j=e.expression.evaluate(n);E.data[R+O+0]=Math.floor(255*j.r/j.a),E.data[R+O+1]=Math.floor(255*j.g/j.a),E.data[R+O+2]=Math.floor(255*j.b/j.a),E.data[R+O+3]=Math.floor(255*j.a)};if(e.clips)for(var i=0,t=0;i<v;++i,t+=4*l)for(var a=0,h=0;a<l;a++,h+=4){var _=a/(l-1),b=e.clips[i];C(t,h,b.start*(1-_)+b.end*_)}else for(var S=0,P=0;S<l;S++,P+=4)C(0,P,S/(l-1));return E}var wh=function(e){function n(l){e.call(this,l,Gd),this._updateColorRamp()}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.createBucket=function(l){return new rp(l)},n.prototype._handleSpecialPaintPropertyUpdate=function(l){l==="heatmap-color"&&this._updateColorRamp()},n.prototype._updateColorRamp=function(){this.colorRamp=op({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},n.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},n}(o),vs={paint:new T({"hillshade-illumination-direction":new Kt(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Kt(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Kt(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Kt(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Kt(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Kt(ye.paint_hillshade["hillshade-accent-color"])})},Zd=function(e){function n(l){e.call(this,l,vs)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},n}(o),bm=M([{name:"a_pos",components:2,type:"Int16"}],4).members,Kp=Vc,wm=Vc;function Vc(e,n,l){l=l||2;var v,E,C,i,t,a,h,_=n&&n.length,b=_?n[0]*l:e.length,S=Eh(e,0,b,l,!0),P=[];if(!S||S.next===S.prev)return P;if(_&&(S=function(O,V,j,K){var $,Q,se,pe=[];for($=0,Q=V.length;$<Q;$++)(se=Eh(O,V[$]*K,$<Q-1?V[$+1]*K:O.length,K,!1))===se.next&&(se.steiner=!0),pe.push(Yp(se));for(pe.sort(Tm),$=0;$<pe.length;$++)Am(pe[$],j),j=su(j,j.next);return j}(e,n,S,l)),e.length>80*l){v=C=e[0],E=i=e[1];for(var R=l;R<b;R+=l)(t=e[R])<v&&(v=t),(a=e[R+1])<E&&(E=a),t>C&&(C=t),a>i&&(i=a);h=(h=Math.max(C-v,i-E))!==0?1/h:0}return Bs(S,P,l,v,E,h),P}function Eh(e,n,l,v,E){var C,i;if(E===Ah(e,n,l,v)>0)for(C=n;C<l;C+=v)i=$p(C,e[C],e[C+1],i);else for(C=l-v;C>=n;C-=v)i=$p(C,e[C],e[C+1],i);return i&&Pn(i,i.next)&&(Hc(i),i=i.next),i}function su(e,n){if(!e)return e;n||(n=e);var l,v=e;do if(l=!1,v.steiner||!Pn(v,v.next)&&oo(v.prev,v,v.next)!==0)v=v.next;else{if(Hc(v),(v=n=v.prev)===v.next)break;l=!0}while(l||v!==n);return n}function Bs(e,n,l,v,E,C,i){if(e){!i&&C&&function(_,b,S,P){var R=_;do R.z===null&&(R.z=Jp(R.x,R.y,b,S,P)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==_);R.prevZ.nextZ=null,R.prevZ=null,function(O){var V,j,K,$,Q,se,pe,ke,Ne=1;do{for(j=O,O=null,Q=null,se=0;j;){for(se++,K=j,pe=0,V=0;V<Ne&&(pe++,K=K.nextZ);V++);for(ke=Ne;pe>0||ke>0&&K;)pe!==0&&(ke===0||!K||j.z<=K.z)?($=j,j=j.nextZ,pe--):($=K,K=K.nextZ,ke--),Q?Q.nextZ=$:O=$,$.prevZ=Q,Q=$;j=K}Q.nextZ=null,Ne*=2}while(se>1)}(R)}(e,v,E,C);for(var t,a,h=e;e.prev!==e.next;)if(t=e.prev,a=e.next,C?Em(e,v,E,C):Sh(e))n.push(t.i/l),n.push(e.i/l),n.push(a.i/l),Hc(e),e=a.next,h=a.next;else if((e=a)===h){i?i===1?Bs(e=Sm(su(e),n,l),n,l,v,E,C,2):i===2&&Im(e,n,l,v,E,C):Bs(su(e),n,l,v,E,C,1);break}}}function Sh(e){var n=e.prev,l=e,v=e.next;if(oo(n,l,v)>=0)return!1;for(var E=e.next.next;E!==e.prev;){if(qc(n.x,n.y,l.x,l.y,v.x,v.y,E.x,E.y)&&oo(E.prev,E,E.next)>=0)return!1;E=E.next}return!0}function Em(e,n,l,v){var E=e.prev,C=e,i=e.next;if(oo(E,C,i)>=0)return!1;for(var t=E.x>C.x?E.x>i.x?E.x:i.x:C.x>i.x?C.x:i.x,a=E.y>C.y?E.y>i.y?E.y:i.y:C.y>i.y?C.y:i.y,h=Jp(E.x<C.x?E.x<i.x?E.x:i.x:C.x<i.x?C.x:i.x,E.y<C.y?E.y<i.y?E.y:i.y:C.y<i.y?C.y:i.y,n,l,v),_=Jp(t,a,n,l,v),b=e.prevZ,S=e.nextZ;b&&b.z>=h&&S&&S.z<=_;){if(b!==e.prev&&b!==e.next&&qc(E.x,E.y,C.x,C.y,i.x,i.y,b.x,b.y)&&oo(b.prev,b,b.next)>=0||(b=b.prevZ,S!==e.prev&&S!==e.next&&qc(E.x,E.y,C.x,C.y,i.x,i.y,S.x,S.y)&&oo(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;b&&b.z>=h;){if(b!==e.prev&&b!==e.next&&qc(E.x,E.y,C.x,C.y,i.x,i.y,b.x,b.y)&&oo(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;S&&S.z<=_;){if(S!==e.prev&&S!==e.next&&qc(E.x,E.y,C.x,C.y,i.x,i.y,S.x,S.y)&&oo(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function Sm(e,n,l){var v=e;do{var E=v.prev,C=v.next.next;!Pn(E,C)&&Ih(E,v,v.next,C)&&Fu(E,C)&&Fu(C,E)&&(n.push(E.i/l),n.push(v.i/l),n.push(C.i/l),Hc(v),Hc(v.next),v=e=C),v=v.next}while(v!==e);return su(v)}function Im(e,n,l,v,E,C){var i=e;do{for(var t=i.next.next;t!==i.prev;){if(i.i!==t.i&&Gc(i,t)){var a=Zc(i,t);return i=su(i,i.next),a=su(a,a.next),Bs(i,n,l,v,E,C),void Bs(a,n,l,v,E,C)}t=t.next}i=i.next}while(i!==e)}function Tm(e,n){return e.x-n.x}function Am(e,n){if(n=function(v,E){var C,i=E,t=v.x,a=v.y,h=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var _=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(_<=t&&_>h){if(h=_,_===t){if(a===i.y)return i;if(a===i.next.y)return i.next}C=i.x<i.next.x?i:i.next}}i=i.next}while(i!==E);if(!C)return null;if(t===h)return C;var b,S=C,P=C.x,R=C.y,O=1/0;i=C;do t>=i.x&&i.x>=P&&t!==i.x&&qc(a<R?t:h,a,P,R,a<R?h:t,a,i.x,i.y)&&(b=Math.abs(a-i.y)/(t-i.x),Fu(i,v)&&(b<O||b===O&&(i.x>C.x||i.x===C.x&&Cm(C,i)))&&(C=i,O=b)),i=i.next;while(i!==S);return C}(e,n)){var l=Zc(n,e);su(n,n.next),su(l,l.next)}}function Cm(e,n){return oo(e.prev,e,n.prev)<0&&oo(n.next,e,e.next)<0}function Jp(e,n,l,v,E){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-l)*E)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-v)*E)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Yp(e){var n=e,l=e;do(n.x<l.x||n.x===l.x&&n.y<l.y)&&(l=n),n=n.next;while(n!==e);return l}function qc(e,n,l,v,E,C,i,t){return(E-i)*(n-t)-(e-i)*(C-t)>=0&&(e-i)*(v-t)-(l-i)*(n-t)>=0&&(l-i)*(C-t)-(E-i)*(v-t)>=0}function Gc(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!function(l,v){var E=l;do{if(E.i!==l.i&&E.next.i!==l.i&&E.i!==v.i&&E.next.i!==v.i&&Ih(E,E.next,l,v))return!0;E=E.next}while(E!==l);return!1}(e,n)&&(Fu(e,n)&&Fu(n,e)&&function(l,v){var E=l,C=!1,i=(l.x+v.x)/2,t=(l.y+v.y)/2;do E.y>t!=E.next.y>t&&E.next.y!==E.y&&i<(E.next.x-E.x)*(t-E.y)/(E.next.y-E.y)+E.x&&(C=!C),E=E.next;while(E!==l);return C}(e,n)&&(oo(e.prev,e,n.prev)||oo(e,n.prev,n))||Pn(e,n)&&oo(e.prev,e,e.next)>0&&oo(n.prev,n,n.next)>0)}function oo(e,n,l){return(n.y-e.y)*(l.x-n.x)-(n.x-e.x)*(l.y-n.y)}function Pn(e,n){return e.x===n.x&&e.y===n.y}function Ih(e,n,l,v){var E=mc(oo(e,n,l)),C=mc(oo(e,n,v)),i=mc(oo(l,v,e)),t=mc(oo(l,v,n));return E!==C&&i!==t||!(E!==0||!Th(e,l,n))||!(C!==0||!Th(e,v,n))||!(i!==0||!Th(l,e,v))||!(t!==0||!Th(l,n,v))}function Th(e,n,l){return n.x<=Math.max(e.x,l.x)&&n.x>=Math.min(e.x,l.x)&&n.y<=Math.max(e.y,l.y)&&n.y>=Math.min(e.y,l.y)}function mc(e){return e>0?1:e<0?-1:0}function Fu(e,n){return oo(e.prev,e,e.next)<0?oo(e,n,e.next)>=0&&oo(e,e.prev,n)>=0:oo(e,n,e.prev)<0||oo(e,e.next,n)<0}function Zc(e,n){var l=new yc(e.i,e.x,e.y),v=new yc(n.i,n.x,n.y),E=e.next,C=n.prev;return e.next=n,n.prev=e,l.next=E,E.prev=l,v.next=l,l.prev=v,C.next=v,v.prev=C,v}function $p(e,n,l,v){var E=new yc(e,n,l);return v?(E.next=v.next,E.prev=v,v.next.prev=E,v.next=E):(E.prev=E,E.next=E),E}function Hc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function yc(e,n,l){this.i=e,this.x=n,this.y=l,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ah(e,n,l,v){for(var E=0,C=n,i=l-v;C<l;C+=v)E+=(e[i]-e[C])*(e[C+1]+e[i+1]),i=C;return E}function Qp(e,n,l,v,E){(function C(i,t,a,h,_){for(;h>a;){if(h-a>600){var b=h-a+1,S=t-a+1,P=Math.log(b),R=.5*Math.exp(2*P/3),O=.5*Math.sqrt(P*R*(b-R)/b)*(S-b/2<0?-1:1);C(i,t,Math.max(a,Math.floor(t-S*R/b+O)),Math.min(h,Math.floor(t+(b-S)*R/b+O)),_)}var V=i[t],j=a,K=h;for(Wc(i,a,t),_(i[h],V)>0&&Wc(i,a,h);j<K;){for(Wc(i,j,K),j++,K--;_(i[j],V)<0;)j++;for(;_(i[K],V)>0;)K--}_(i[a],V)===0?Wc(i,a,K):Wc(i,++K,h),K<=t&&(a=K+1),t<=K&&(h=K-1)}})(e,n,l||0,v||e.length-1,E||km)}function Wc(e,n,l){var v=e[n];e[n]=e[l],e[l]=v}function km(e,n){return e<n?-1:e>n?1:0}function ap(e,n){var l=e.length;if(l<=1)return[e];for(var v,E,C=[],i=0;i<l;i++){var t=Si(e[i]);t!==0&&(e[i].area=Math.abs(t),E===void 0&&(E=t<0),E===t<0?(v&&C.push(v),v=[e[i]]):v.push(e[i]))}if(v&&C.push(v),n>1)for(var a=0;a<C.length;a++)C[a].length<=n||(Qp(C[a],n,1,C[a].length-1,Ch),C[a]=C[a].slice(0,n));return C}function Ch(e,n){return n.area-e.area}function ed(e,n,l){for(var v=l.patternDependencies,E=!1,C=0,i=n;C<i.length;C+=1){var t=i[C].paint.get(e+"-pattern");t.isConstant()||(E=!0);var a=t.constantOr(null);a&&(E=!0,v[a.to]=!0,v[a.from]=!0)}return E}function kh(e,n,l,v,E){for(var C=E.patternDependencies,i=0,t=n;i<t.length;i+=1){var a=t[i],h=a.paint.get(e+"-pattern").value;if(h.kind!=="constant"){var _=h.evaluate({zoom:v-1},l,{},E.availableImages),b=h.evaluate({zoom:v},l,{},E.availableImages),S=h.evaluate({zoom:v+1},l,{},E.availableImages);b=b&&b.name?b.name:b,S=S&&S.name?S.name:S,C[_=_&&_.name?_.name:_]=!0,C[b]=!0,C[S]=!0,l.patterns[a.id]={min:_,mid:b,max:S}}}return l}Vc.deviation=function(e,n,l,v){var E=n&&n.length,C=Math.abs(Ah(e,0,E?n[0]*l:e.length,l));if(E)for(var i=0,t=n.length;i<t;i++)C-=Math.abs(Ah(e,n[i]*l,i<t-1?n[i+1]*l:e.length,l));var a=0;for(i=0;i<v.length;i+=3){var h=v[i]*l,_=v[i+1]*l,b=v[i+2]*l;a+=Math.abs((e[h]-e[b])*(e[_+1]-e[h+1])-(e[h]-e[_])*(e[b+1]-e[h+1]))}return C===0&&a===0?0:Math.abs((a-C)/C)},Vc.flatten=function(e){for(var n=e[0][0].length,l={vertices:[],holes:[],dimensions:n},v=0,E=0;E<e.length;E++){for(var C=0;C<e[E].length;C++)for(var i=0;i<n;i++)l.vertices.push(e[E][C][i]);E>0&&l.holes.push(v+=e[E-1].length)}return l},Kp.default=wm;var al=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Z,this.indexArray=new wt,this.indexArray2=new mi,this.programConfigurations=new Ei(e.layers,e.zoom),this.segments=new de,this.segments2=new de,this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};al.prototype.populate=function(e,n,l){this.hasPattern=ed("fill",this.layers,n);for(var v=this.layers[0].layout.get("fill-sort-key"),E=[],C=0,i=e;C<i.length;C+=1){var t=i[C],a=t.feature,h=t.id,_=t.index,b=t.sourceLayerIndex,S=this.layers[0]._featureFilter.needGeometry,P=hr(a,S);if(this.layers[0]._featureFilter.filter(new Vt(this.zoom),P,l)){var R=v?v.evaluate(P,{},l,n.availableImages):void 0,O={id:h,properties:a.properties,type:a.type,sourceLayerIndex:b,index:_,geometry:S?P.geometry:wn(a),patterns:{},sortKey:R};E.push(O)}}v&&E.sort(function(ke,Ne){return ke.sortKey-Ne.sortKey});for(var V=0,j=E;V<j.length;V+=1){var K=j[V],$=K.geometry,Q=K.index,se=K.sourceLayerIndex;if(this.hasPattern){var pe=kh("fill",this.layers,K,this.zoom,n);this.patternFeatures.push(pe)}else this.addFeature(K,$,Q,l,{});n.featureIndex.insert(e[Q].feature,$,Q,se,this.index)}},al.prototype.update=function(e,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,l)},al.prototype.addFeatures=function(e,n,l){for(var v=0,E=this.patternFeatures;v<E.length;v+=1){var C=E[v];this.addFeature(C,C.geometry,C.index,n,l)}},al.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},al.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},al.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,bm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},al.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},al.prototype.addFeature=function(e,n,l,v,E){for(var C=0,i=ap(n,500);C<i.length;C+=1){for(var t=i[C],a=0,h=0,_=t;h<_.length;h+=1)a+=_[h].length;for(var b=this.segments.prepareSegment(a,this.layoutVertexArray,this.indexArray),S=b.vertexLength,P=[],R=[],O=0,V=t;O<V.length;O+=1){var j=V[O];if(j.length!==0){j!==t[0]&&R.push(P.length/2);var K=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),$=K.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack($+j.length-1,$),P.push(j[0].x),P.push(j[0].y);for(var Q=1;Q<j.length;Q++)this.layoutVertexArray.emplaceBack(j[Q].x,j[Q].y),this.indexArray2.emplaceBack($+Q-1,$+Q),P.push(j[Q].x),P.push(j[Q].y);K.vertexLength+=j.length,K.primitiveLength+=j.length}}for(var se=Kp(P,R),pe=0;pe<se.length;pe+=3)this.indexArray.emplaceBack(S+se[pe],S+se[pe+1],S+se[pe+2]);b.vertexLength+=a,b.primitiveLength+=se.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,E,v)},ui("FillBucket",al,{omit:["layers","patternFeatures"]});var td=new T({"fill-sort-key":new Xt(ye.layout_fill["fill-sort-key"])}),id={paint:new T({"fill-antialias":new Kt(ye.paint_fill["fill-antialias"]),"fill-opacity":new Xt(ye.paint_fill["fill-opacity"]),"fill-color":new Xt(ye.paint_fill["fill-color"]),"fill-outline-color":new Xt(ye.paint_fill["fill-outline-color"]),"fill-translate":new Kt(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new Kt(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new ru(ye.paint_fill["fill-pattern"])}),layout:td},rd=function(e){function n(l){e.call(this,l,id)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.recalculate=function(l,v){e.prototype.recalculate.call(this,l,v);var E=this.paint._values["fill-outline-color"];E.value.kind==="constant"&&E.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},n.prototype.createBucket=function(l){return new al(l)},n.prototype.queryRadius=function(){return no(this.paint.get("fill-translate"))},n.prototype.queryIntersectsFeature=function(l,v,E,C,i,t,a){return Ea(Ia(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),t.angle,a),C)},n.prototype.isTileClipped=function(){return!0},n}(o),zm=M([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Hd=Xc;function Xc(e,n,l,v,E){this.properties={},this.extent=l,this.type=0,this._pbf=e,this._geometry=-1,this._keys=v,this._values=E,e.readFields(Pm,this,n)}function Pm(e,n,l){e==1?n.id=l.readVarint():e==2?function(v,E){for(var C=v.readVarint()+v.pos;v.pos<C;){var i=E._keys[v.readVarint()],t=E._values[v.readVarint()];E.properties[i]=t}}(l,n):e==3?n.type=l.readVarint():e==4&&(n._geometry=l.pos)}function Uu(e){for(var n,l,v=0,E=0,C=e.length,i=C-1;E<C;i=E++)v+=((l=e[i]).x-(n=e[E]).x)*(n.y+l.y);return v}Xc.types=["Unknown","Point","LineString","Polygon"],Xc.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var n,l=e.readVarint()+e.pos,v=1,E=0,C=0,i=0,t=[];e.pos<l;){if(E<=0){var a=e.readVarint();v=7&a,E=a>>3}if(E--,v===1||v===2)C+=e.readSVarint(),i+=e.readSVarint(),v===1&&(n&&t.push(n),n=[]),n.push(new U(C,i));else{if(v!==7)throw new Error("unknown command "+v);n&&n.push(n[0].clone())}}return n&&t.push(n),t},Xc.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var n=e.readVarint()+e.pos,l=1,v=0,E=0,C=0,i=1/0,t=-1/0,a=1/0,h=-1/0;e.pos<n;){if(v<=0){var _=e.readVarint();l=7&_,v=_>>3}if(v--,l===1||l===2)(E+=e.readSVarint())<i&&(i=E),E>t&&(t=E),(C+=e.readSVarint())<a&&(a=C),C>h&&(h=C);else if(l!==7)throw new Error("unknown command "+l)}return[i,a,t,h]},Xc.prototype.toGeoJSON=function(e,n,l){var v,E,C=this.extent*Math.pow(2,l),i=this.extent*e,t=this.extent*n,a=this.loadGeometry(),h=Xc.types[this.type];function _(P){for(var R=0;R<P.length;R++){var O=P[R];P[R]=[360*(O.x+i)/C-180,360/Math.PI*Math.atan(Math.exp((180-360*(O.y+t)/C)*Math.PI/180))-90]}}switch(this.type){case 1:var b=[];for(v=0;v<a.length;v++)b[v]=a[v][0];_(a=b);break;case 2:for(v=0;v<a.length;v++)_(a[v]);break;case 3:for(a=function(P){var R=P.length;if(R<=1)return[P];for(var O,V,j=[],K=0;K<R;K++){var $=Uu(P[K]);$!==0&&(V===void 0&&(V=$<0),V===$<0?(O&&j.push(O),O=[P[K]]):O.push(P[K]))}return O&&j.push(O),j}(a),v=0;v<a.length;v++)for(E=0;E<a[v].length;E++)_(a[v][E])}a.length===1?a=a[0]:h="Multi"+h;var S={type:"Feature",geometry:{type:h,coordinates:a},properties:this.properties};return"id"in this&&(S.id=this.id),S};var Wd=nd;function nd(e,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Kc,this,n),this.length=this._features.length}function Kc(e,n,l){e===15?n.version=l.readVarint():e===1?n.name=l.readString():e===5?n.extent=l.readVarint():e===2?n._features.push(l.pos):e===3?n._keys.push(l.readString()):e===4&&n._values.push(function(v){for(var E=null,C=v.readVarint()+v.pos;v.pos<C;){var i=v.readVarint()>>3;E=i===1?v.readString():i===2?v.readFloat():i===3?v.readDouble():i===4?v.readVarint64():i===5?v.readVarint():i===6?v.readSVarint():i===7?v.readBoolean():null}return E}(l))}function Mm(e,n,l){if(e===3){var v=new Wd(l,l.readVarint()+l.pos);v.length&&(n[v.name]=v)}}nd.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var n=this._pbf.readVarint()+this._pbf.pos;return new Hd(this._pbf,n,this.extent,this._keys,this._values)};var Jc={VectorTile:function(e,n){this.layers=e.readFields(Mm,{},n)},VectorTileFeature:Hd,VectorTileLayer:Wd},Lm=Jc.VectorTileFeature.types,sp=Math.pow(2,13);function Yc(e,n,l,v,E,C,i,t){e.emplaceBack(n,l,2*Math.floor(v*sp)+i,E*sp*2,C*sp*2,Math.round(t))}var sl=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ee,this.indexArray=new wt,this.programConfigurations=new Ei(e.layers,e.zoom),this.segments=new de,this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};function Dm(e,n){return e.x===n.x&&(e.x<0||e.x>8192)||e.y===n.y&&(e.y<0||e.y>8192)}sl.prototype.populate=function(e,n,l){this.features=[],this.hasPattern=ed("fill-extrusion",this.layers,n);for(var v=0,E=e;v<E.length;v+=1){var C=E[v],i=C.feature,t=C.id,a=C.index,h=C.sourceLayerIndex,_=this.layers[0]._featureFilter.needGeometry,b=hr(i,_);if(this.layers[0]._featureFilter.filter(new Vt(this.zoom),b,l)){var S={id:t,sourceLayerIndex:h,index:a,geometry:_?b.geometry:wn(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(kh("fill-extrusion",this.layers,S,this.zoom,n)):this.addFeature(S,S.geometry,a,l,{}),n.featureIndex.insert(i,S.geometry,a,h,this.index,!0)}}},sl.prototype.addFeatures=function(e,n,l){for(var v=0,E=this.features;v<E.length;v+=1){var C=E[v];this.addFeature(C,C.geometry,C.index,n,l)}},sl.prototype.update=function(e,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,l)},sl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},sl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},sl.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,zm),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},sl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},sl.prototype.addFeature=function(e,n,l,v,E){for(var C=0,i=ap(n,500);C<i.length;C+=1){for(var t=i[C],a=0,h=0,_=t;h<_.length;h+=1)a+=_[h].length;for(var b=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),S=0,P=t;S<P.length;S+=1){var R=P[S];if(R.length!==0&&!((Tt=R).every(function(gt){return gt.x<0})||Tt.every(function(gt){return gt.x>8192})||Tt.every(function(gt){return gt.y<0})||Tt.every(function(gt){return gt.y>8192})))for(var O=0,V=0;V<R.length;V++){var j=R[V];if(V>=1){var K=R[V-1];if(!Dm(j,K)){b.vertexLength+4>de.MAX_VERTEX_ARRAY_LENGTH&&(b=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var $=j.sub(K)._perp()._unit(),Q=K.dist(j);O+Q>32768&&(O=0),Yc(this.layoutVertexArray,j.x,j.y,$.x,$.y,0,0,O),Yc(this.layoutVertexArray,j.x,j.y,$.x,$.y,0,1,O),Yc(this.layoutVertexArray,K.x,K.y,$.x,$.y,0,0,O+=Q),Yc(this.layoutVertexArray,K.x,K.y,$.x,$.y,0,1,O);var se=b.vertexLength;this.indexArray.emplaceBack(se,se+2,se+1),this.indexArray.emplaceBack(se+1,se+2,se+3),b.vertexLength+=4,b.primitiveLength+=2}}}}if(b.vertexLength+a>de.MAX_VERTEX_ARRAY_LENGTH&&(b=this.segments.prepareSegment(a,this.layoutVertexArray,this.indexArray)),Lm[e.type]==="Polygon"){for(var pe=[],ke=[],Ne=b.vertexLength,Ze=0,He=t;Ze<He.length;Ze+=1){var it=He[Ze];if(it.length!==0){it!==t[0]&&ke.push(pe.length/2);for(var We=0;We<it.length;We++){var kt=it[We];Yc(this.layoutVertexArray,kt.x,kt.y,0,0,1,1,0),pe.push(kt.x),pe.push(kt.y)}}}for(var At=Kp(pe,ke),pt=0;pt<At.length;pt+=3)this.indexArray.emplaceBack(Ne+At[pt],Ne+At[pt+2],Ne+At[pt+1]);b.primitiveLength+=At.length/3,b.vertexLength+=a}}var Tt;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,E,v)},ui("FillExtrusionBucket",sl,{omit:["layers","features"]});var Rm={paint:new T({"fill-extrusion-opacity":new Kt(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Xt(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Kt(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Kt(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ru(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Xt(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Xt(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Kt(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Bm=function(e){function n(l){e.call(this,l,Rm)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.createBucket=function(l){return new sl(l)},n.prototype.queryRadius=function(){return no(this.paint.get("fill-extrusion-translate"))},n.prototype.is3D=function(){return!0},n.prototype.queryIntersectsFeature=function(l,v,E,C,i,t,a,h){var _=Ia(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),t.angle,a),b=this.paint.get("fill-extrusion-height").evaluate(v,E),S=this.paint.get("fill-extrusion-base").evaluate(v,E),P=function(O,V,j,K){for(var $=[],Q=0,se=O;Q<se.length;Q+=1){var pe=se[Q],ke=[pe.x,pe.y,0,1];Ou(ke,ke,V),$.push(new U(ke[0]/ke[3],ke[1]/ke[3]))}return $}(_,h),R=function(O,V,j,K){for(var $=[],Q=[],se=K[8]*V,pe=K[9]*V,ke=K[10]*V,Ne=K[11]*V,Ze=K[8]*j,He=K[9]*j,it=K[10]*j,We=K[11]*j,kt=0,At=O;kt<At.length;kt+=1){for(var pt=[],Tt=[],gt=0,Pt=At[kt];gt<Pt.length;gt+=1){var mt=Pt[gt],vt=mt.x,oi=mt.y,ri=K[0]*vt+K[4]*oi+K[12],Mi=K[1]*vt+K[5]*oi+K[13],Bi=K[2]*vt+K[6]*oi+K[14],Qi=K[3]*vt+K[7]*oi+K[15],ur=Bi+ke,kr=Qi+Ne,zr=ri+Ze,xr=Mi+He,Br=Bi+it,br=Qi+We,Or=new U((ri+se)/kr,(Mi+pe)/kr);Or.z=ur/kr,pt.push(Or);var Vi=new U(zr/br,xr/br);Vi.z=Br/br,Tt.push(Vi)}$.push(pt),Q.push(Tt)}return[$,Q]}(C,S,b,h);return function(O,V,j){var K=1/0;Ea(j,V)&&(K=$c(j,V[0]));for(var $=0;$<V.length;$++)for(var Q=V[$],se=O[$],pe=0;pe<Q.length-1;pe++){var ke=Q[pe],Ne=[ke,Q[pe+1],se[pe+1],se[pe],ke];wa(j,Ne)&&(K=Math.min(K,$c(j,Ne)))}return K!==1/0&&K}(R[0],R[1],P)},n}(o);function gc(e,n){return e.x*n.x+e.y*n.y}function $c(e,n){if(e.length===1){for(var l,v=0,E=n[v++];!l||E.equals(l);)if(!(l=n[v++]))return 1/0;for(;v<n.length;v++){var C=n[v],i=e[0],t=l.sub(E),a=C.sub(E),h=i.sub(E),_=gc(t,t),b=gc(t,a),S=gc(a,a),P=gc(h,t),R=gc(h,a),O=_*S-b*b,V=(S*P-b*R)/O,j=(_*R-b*P)/O,K=E.z*(1-V-j)+l.z*V+C.z*j;if(isFinite(K))return K}return 1/0}for(var $=1/0,Q=0,se=n;Q<se.length;Q+=1)$=Math.min($,se[Q].z);return $}var od=M([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Om=M([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Fm=Jc.VectorTileFeature.types,Um=Math.cos(Math.PI/180*37.5),Qc=Math.pow(2,14)/.5,Qo=function(e){var n=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(l){return l.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(l){n.gradients[l.id]={}}),this.layoutVertexArray=new re,this.layoutVertexArray2=new ue,this.indexArray=new wt,this.programConfigurations=new Ei(e.layers,e.zoom),this.segments=new de,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(l){return l.isStateDependent()}).map(function(l){return l.id})};Qo.prototype.populate=function(e,n,l){this.hasPattern=ed("line",this.layers,n);for(var v=this.layers[0].layout.get("line-sort-key"),E=[],C=0,i=e;C<i.length;C+=1){var t=i[C],a=t.feature,h=t.id,_=t.index,b=t.sourceLayerIndex,S=this.layers[0]._featureFilter.needGeometry,P=hr(a,S);if(this.layers[0]._featureFilter.filter(new Vt(this.zoom),P,l)){var R=v?v.evaluate(P,{},l):void 0,O={id:h,properties:a.properties,type:a.type,sourceLayerIndex:b,index:_,geometry:S?P.geometry:wn(a),patterns:{},sortKey:R};E.push(O)}}v&&E.sort(function(ke,Ne){return ke.sortKey-Ne.sortKey});for(var V=0,j=E;V<j.length;V+=1){var K=j[V],$=K.geometry,Q=K.index,se=K.sourceLayerIndex;if(this.hasPattern){var pe=kh("line",this.layers,K,this.zoom,n);this.patternFeatures.push(pe)}else this.addFeature(K,$,Q,l,{});n.featureIndex.insert(e[Q].feature,$,Q,se,this.index)}},Qo.prototype.update=function(e,n,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,l)},Qo.prototype.addFeatures=function(e,n,l){for(var v=0,E=this.patternFeatures;v<E.length;v+=1){var C=E[v];this.addFeature(C,C.geometry,C.index,n,l)}},Qo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Qo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Qo.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Om)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,od),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Qo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Qo.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Qo.prototype.addFeature=function(e,n,l,v,E){var C=this.layers[0].layout,i=C.get("line-join").evaluate(e,{}),t=C.get("line-cap"),a=C.get("line-miter-limit"),h=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var _=0,b=n;_<b.length;_+=1)this.addLine(b[_],e,i,t,a,h);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,l,E,v)},Qo.prototype.addLine=function(e,n,l,v,E,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var i=0;i<e.length-1;i++)this.totalDistance+=e[i].dist(e[i+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var t=Fm[n.type]==="Polygon",a=e.length;a>=2&&e[a-1].equals(e[a-2]);)a--;for(var h=0;h<a-1&&e[h].equals(e[h+1]);)h++;if(!(a<(t?3:2))){l==="bevel"&&(E=1.05);var _,b=this.overscaling<=16?122880/(512*this.overscaling):0,S=this.segments.prepareSegment(10*a,this.layoutVertexArray,this.indexArray),P=void 0,R=void 0,O=void 0,V=void 0;this.e1=this.e2=-1,t&&(V=e[h].sub(_=e[a-2])._unit()._perp());for(var j=h;j<a;j++)if(!(R=j===a-1?t?e[h+1]:void 0:e[j+1])||!e[j].equals(R)){V&&(O=V),_&&(P=_),_=e[j],V=R?R.sub(_)._unit()._perp():O;var K=(O=O||V).add(V);K.x===0&&K.y===0||K._unit();var $=O.x*V.x+O.y*V.y,Q=K.x*V.x+K.y*V.y,se=Q!==0?1/Q:1/0,pe=2*Math.sqrt(2-2*Q),ke=Q<Um&&P&&R,Ne=O.x*V.y-O.y*V.x>0;if(ke&&j>h){var Ze=_.dist(P);if(Ze>2*b){var He=_.sub(_.sub(P)._mult(b/Ze)._round());this.updateDistance(P,He),this.addCurrentVertex(He,O,0,0,S),P=He}}var it=P&&R,We=it?l:t?"butt":v;if(it&&We==="round"&&(se<C?We="miter":se<=2&&(We="fakeround")),We==="miter"&&se>E&&(We="bevel"),We==="bevel"&&(se>2&&(We="flipbevel"),se<E&&(We="miter")),P&&this.updateDistance(P,_),We==="miter")K._mult(se),this.addCurrentVertex(_,K,0,0,S);else if(We==="flipbevel"){if(se>100)K=V.mult(-1);else{var kt=se*O.add(V).mag()/O.sub(V).mag();K._perp()._mult(kt*(Ne?-1:1))}this.addCurrentVertex(_,K,0,0,S),this.addCurrentVertex(_,K.mult(-1),0,0,S)}else if(We==="bevel"||We==="fakeround"){var At=-Math.sqrt(se*se-1),pt=Ne?At:0,Tt=Ne?0:At;if(P&&this.addCurrentVertex(_,O,pt,Tt,S),We==="fakeround")for(var gt=Math.round(180*pe/Math.PI/20),Pt=1;Pt<gt;Pt++){var mt=Pt/gt;if(mt!==.5){var vt=mt-.5;mt+=mt*vt*(mt-1)*((1.0904+$*($*(3.55645-1.43519*$)-3.2452))*vt*vt+(.848013+$*(.215638*$-1.06021)))}var oi=V.sub(O)._mult(mt)._add(O)._unit()._mult(Ne?-1:1);this.addHalfVertex(_,oi.x,oi.y,!1,Ne,0,S)}R&&this.addCurrentVertex(_,V,-pt,-Tt,S)}else if(We==="butt")this.addCurrentVertex(_,K,0,0,S);else if(We==="square"){var ri=P?1:-1;this.addCurrentVertex(_,K,ri,ri,S)}else We==="round"&&(P&&(this.addCurrentVertex(_,O,0,0,S),this.addCurrentVertex(_,O,1,1,S,!0)),R&&(this.addCurrentVertex(_,V,-1,-1,S,!0),this.addCurrentVertex(_,V,0,0,S)));if(ke&&j<a-1){var Mi=_.dist(R);if(Mi>2*b){var Bi=_.add(R.sub(_)._mult(b/Mi)._round());this.updateDistance(_,Bi),this.addCurrentVertex(Bi,V,0,0,S),_=Bi}}}}},Qo.prototype.addCurrentVertex=function(e,n,l,v,E,C){C===void 0&&(C=!1);var i=n.y*v-n.x,t=-n.y-n.x*v;this.addHalfVertex(e,n.x+n.y*l,n.y-n.x*l,C,!1,l,E),this.addHalfVertex(e,i,t,C,!0,-v,E),this.distance>Qc/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,n,l,v,E,C))},Qo.prototype.addHalfVertex=function(e,n,l,v,E,C,i){var t=.5*(this.lineClips?this.scaledDistance*(Qc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(v?1:0),(e.y<<1)+(E?1:0),Math.round(63*n)+128,Math.round(63*l)+128,1+(C===0?0:C<0?-1:1)|(63&t)<<2,t>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var a=i.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,a),i.primitiveLength++),E?this.e2=a:this.e1=a},Qo.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Qo.prototype.updateDistance=function(e,n){this.distance+=e.dist(n),this.updateScaledDistance()},ui("LineBucket",Qo,{omit:["layers","patternFeatures"]});var Nm=new T({"line-cap":new Kt(ye.layout_line["line-cap"]),"line-join":new Xt(ye.layout_line["line-join"]),"line-miter-limit":new Kt(ye.layout_line["line-miter-limit"]),"line-round-limit":new Kt(ye.layout_line["line-round-limit"]),"line-sort-key":new Xt(ye.layout_line["line-sort-key"])}),Xd={paint:new T({"line-opacity":new Xt(ye.paint_line["line-opacity"]),"line-color":new Xt(ye.paint_line["line-color"]),"line-translate":new Kt(ye.paint_line["line-translate"]),"line-translate-anchor":new Kt(ye.paint_line["line-translate-anchor"]),"line-width":new Xt(ye.paint_line["line-width"]),"line-gap-width":new Xt(ye.paint_line["line-gap-width"]),"line-offset":new Xt(ye.paint_line["line-offset"]),"line-blur":new Xt(ye.paint_line["line-blur"]),"line-dasharray":new On(ye.paint_line["line-dasharray"]),"line-pattern":new ru(ye.paint_line["line-pattern"]),"line-gradient":new Vo(ye.paint_line["line-gradient"])}),layout:Nm},Kd=new(function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.possiblyEvaluate=function(l,v){return v=new Vt(Math.floor(v.zoom),{now:v.now,fadeDuration:v.fadeDuration,zoomHistory:v.zoomHistory,transition:v.transition}),e.prototype.possiblyEvaluate.call(this,l,v)},n.prototype.evaluate=function(l,v,E,C){return v=Ue({},v,{zoom:Math.floor(v.zoom)}),e.prototype.evaluate.call(this,l,v,E,C)},n}(Xt))(Xd.paint.properties["line-width"].specification);Kd.useIntegerZoom=!0;var jm=function(e){function n(l){e.call(this,l,Xd),this.gradientVersion=0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._handleSpecialPaintPropertyUpdate=function(l){l==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof fo,this.gradientVersion=(this.gradientVersion+1)%Se)},n.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},n.prototype.recalculate=function(l,v){e.prototype.recalculate.call(this,l,v),this.paint._values["line-floorwidth"]=Kd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)},n.prototype.createBucket=function(l){return new Qo(l)},n.prototype.queryRadius=function(l){var v=l,E=Jd(gs("line-width",this,v),gs("line-gap-width",this,v)),C=gs("line-offset",this,v);return E/2+Math.abs(C)+no(this.paint.get("line-translate"))},n.prototype.queryIntersectsFeature=function(l,v,E,C,i,t,a){var h=Ia(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),t.angle,a),_=a/2*Jd(this.paint.get("line-width").evaluate(v,E),this.paint.get("line-gap-width").evaluate(v,E)),b=this.paint.get("line-offset").evaluate(v,E);return b&&(C=function(S,P){for(var R=[],O=new U(0,0),V=0;V<S.length;V++){for(var j=S[V],K=[],$=0;$<j.length;$++){var Q=j[$],se=j[$+1],pe=$===0?O:Q.sub(j[$-1])._unit()._perp(),ke=$===j.length-1?O:se.sub(Q)._unit()._perp(),Ne=pe._add(ke)._unit();Ne._mult(1/(Ne.x*ke.x+Ne.y*ke.y)),K.push(Ne._mult(P)._add(Q))}R.push(K)}return R}(C,b*a)),function(S,P,R){for(var O=0;O<P.length;O++){var V=P[O];if(S.length>=3){for(var j=0;j<V.length;j++)if(Rs(S,V[j]))return!0}if(Sa(S,V,R))return!0}return!1}(h,C,_)},n.prototype.isTileClipped=function(){return!0},n}(o);function Jd(e,n){return n>0?n+2*e:e}var Vm=M([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Yd=M([{name:"a_projected_pos",components:3,type:"Float32"}],4),ad=(M([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),M([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),$d=(M([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),M([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Qd=M([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ef(e,n,l){return e.sections.forEach(function(v){v.text=function(E,C,i){var t=C.layout.get("text-transform").evaluate(i,{});return t==="uppercase"?E=E.toLocaleUpperCase():t==="lowercase"&&(E=E.toLocaleLowerCase()),ci.applyArabicShaping&&(E=ci.applyArabicShaping(E)),E}(v.text,n,l)}),e}M([{name:"triangle",components:3,type:"Uint16"}]),M([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),M([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),M([{type:"Float32",name:"offsetX"}]),M([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var eh={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},tf=function(e,n,l,v,E){var C,i,t=8*E-v-1,a=(1<<t)-1,h=a>>1,_=-7,b=l?E-1:0,S=l?-1:1,P=e[n+b];for(b+=S,C=P&(1<<-_)-1,P>>=-_,_+=t;_>0;C=256*C+e[n+b],b+=S,_-=8);for(i=C&(1<<-_)-1,C>>=-_,_+=v;_>0;i=256*i+e[n+b],b+=S,_-=8);if(C===0)C=1-h;else{if(C===a)return i?NaN:1/0*(P?-1:1);i+=Math.pow(2,v),C-=h}return(P?-1:1)*i*Math.pow(2,C-v)},rf=function(e,n,l,v,E,C){var i,t,a,h=8*C-E-1,_=(1<<h)-1,b=_>>1,S=E===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=v?0:C-1,R=v?1:-1,O=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(t=isNaN(n)?1:0,i=_):(i=Math.floor(Math.log(n)/Math.LN2),n*(a=Math.pow(2,-i))<1&&(i--,a*=2),(n+=i+b>=1?S/a:S*Math.pow(2,1-b))*a>=2&&(i++,a/=2),i+b>=_?(t=0,i=_):i+b>=1?(t=(n*a-1)*Math.pow(2,E),i+=b):(t=n*Math.pow(2,b-1)*Math.pow(2,E),i=0));E>=8;e[l+P]=255&t,P+=R,t/=256,E-=8);for(i=i<<E|t,h+=E;h>0;e[l+P]=255&i,P+=R,i/=256,h-=8);e[l+P-R]|=128*O},lp=nn;function nn(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}nn.Varint=0,nn.Fixed64=1,nn.Bytes=2,nn.Fixed32=5;var nf=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function lu(e){return e.type===nn.Bytes?e.readVarint()+e.pos:e.pos+1}function kl(e,n,l){return l?4294967296*n+(e>>>0):4294967296*(n>>>0)+(e>>>0)}function Do(e,n,l){var v=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));l.realloc(v);for(var E=l.pos-1;E>=e;E--)l.buf[E+v]=l.buf[E]}function sd(e,n){for(var l=0;l<e.length;l++)n.writeVarint(e[l])}function of(e,n){for(var l=0;l<e.length;l++)n.writeSVarint(e[l])}function af(e,n){for(var l=0;l<e.length;l++)n.writeFloat(e[l])}function un(e,n){for(var l=0;l<e.length;l++)n.writeDouble(e[l])}function Nu(e,n){for(var l=0;l<e.length;l++)n.writeBoolean(e[l])}function ld(e,n){for(var l=0;l<e.length;l++)n.writeFixed32(e[l])}function sf(e,n){for(var l=0;l<e.length;l++)n.writeSFixed32(e[l])}function lf(e,n){for(var l=0;l<e.length;l++)n.writeFixed64(e[l])}function uu(e,n){for(var l=0;l<e.length;l++)n.writeSFixed64(e[l])}function cu(e,n){return(e[n]|e[n+1]<<8|e[n+2]<<16)+16777216*e[n+3]}function _c(e,n,l){e[l]=n,e[l+1]=n>>>8,e[l+2]=n>>>16,e[l+3]=n>>>24}function uf(e,n){return(e[n]|e[n+1]<<8|e[n+2]<<16)+(e[n+3]<<24)}function qm(e,n,l){e===1&&l.readMessage(Gm,n)}function Gm(e,n,l){if(e===3){var v=l.readMessage(Zm,{}),E=v.width,C=v.height,i=v.left,t=v.top,a=v.advance;n.push({id:v.id,bitmap:new fc({width:E+6,height:C+6},v.bitmap),metrics:{width:E,height:C,left:i,top:t,advance:a}})}}function Zm(e,n,l){e===1?n.id=l.readVarint():e===2?n.bitmap=l.readBytes():e===3?n.width=l.readVarint():e===4?n.height=l.readVarint():e===5?n.left=l.readSVarint():e===6?n.top=l.readSVarint():e===7&&(n.advance=l.readVarint())}function cf(e){for(var n=0,l=0,v=0,E=e;v<E.length;v+=1){var C=E[v];n+=C.w*C.h,l=Math.max(l,C.w)}e.sort(function(O,V){return V.h-O.h});for(var i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),l),h:1/0}],t=0,a=0,h=0,_=e;h<_.length;h+=1)for(var b=_[h],S=i.length-1;S>=0;S--){var P=i[S];if(!(b.w>P.w||b.h>P.h)){if(b.x=P.x,b.y=P.y,a=Math.max(a,b.y+b.h),t=Math.max(t,b.x+b.w),b.w===P.w&&b.h===P.h){var R=i.pop();S<i.length&&(i[S]=R)}else b.h===P.h?(P.x+=b.w,P.w-=b.w):b.w===P.w?(P.y+=b.h,P.h-=b.h):(i.push({x:P.x+b.w,y:P.y,w:P.w-b.w,h:b.h}),P.y+=b.h,P.h-=b.h);break}}return{w:t,h:a,fill:n/(t*a)||0}}nn.prototype={destroy:function(){this.buf=null},readFields:function(e,n,l){for(l=l||this.length;this.pos<l;){var v=this.readVarint(),E=v>>3,C=this.pos;this.type=7&v,e(E,n,this),this.pos===C&&this.skip(v)}return n},readMessage:function(e,n){return this.readFields(e,n,this.readVarint()+this.pos)},readFixed32:function(){var e=cu(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=uf(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=cu(this.buf,this.pos)+4294967296*cu(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=cu(this.buf,this.pos)+4294967296*uf(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=tf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=tf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var n,l,v=this.buf;return n=127&(l=v[this.pos++]),l<128?n:(n|=(127&(l=v[this.pos++]))<<7,l<128?n:(n|=(127&(l=v[this.pos++]))<<14,l<128?n:(n|=(127&(l=v[this.pos++]))<<21,l<128?n:function(E,C,i){var t,a,h=i.buf;if(t=(112&(a=h[i.pos++]))>>4,a<128||(t|=(127&(a=h[i.pos++]))<<3,a<128)||(t|=(127&(a=h[i.pos++]))<<10,a<128)||(t|=(127&(a=h[i.pos++]))<<17,a<128)||(t|=(127&(a=h[i.pos++]))<<24,a<128)||(t|=(1&(a=h[i.pos++]))<<31,a<128))return kl(E,t,C);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(l=v[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,n=this.pos;return this.pos=e,e-n>=12&&nf?function(l,v,E){return nf.decode(l.subarray(v,E))}(this.buf,n,e):function(l,v,E){for(var C="",i=v;i<E;){var t,a,h,_=l[i],b=null,S=_>239?4:_>223?3:_>191?2:1;if(i+S>E)break;S===1?_<128&&(b=_):S===2?(192&(t=l[i+1]))==128&&(b=(31&_)<<6|63&t)<=127&&(b=null):S===3?(a=l[i+2],(192&(t=l[i+1]))==128&&(192&a)==128&&((b=(15&_)<<12|(63&t)<<6|63&a)<=2047||b>=55296&&b<=57343)&&(b=null)):S===4&&(a=l[i+2],h=l[i+3],(192&(t=l[i+1]))==128&&(192&a)==128&&(192&h)==128&&((b=(15&_)<<18|(63&t)<<12|(63&a)<<6|63&h)<=65535||b>=1114112)&&(b=null)),b===null?(b=65533,S=1):b>65535&&(b-=65536,C+=String.fromCharCode(b>>>10&1023|55296),b=56320|1023&b),C+=String.fromCharCode(b),i+=S}return C}(this.buf,n,e)},readBytes:function(){var e=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,e);return this.pos=e,n},readPackedVarint:function(e,n){if(this.type!==nn.Bytes)return e.push(this.readVarint(n));var l=lu(this);for(e=e||[];this.pos<l;)e.push(this.readVarint(n));return e},readPackedSVarint:function(e){if(this.type!==nn.Bytes)return e.push(this.readSVarint());var n=lu(this);for(e=e||[];this.pos<n;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==nn.Bytes)return e.push(this.readBoolean());var n=lu(this);for(e=e||[];this.pos<n;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==nn.Bytes)return e.push(this.readFloat());var n=lu(this);for(e=e||[];this.pos<n;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==nn.Bytes)return e.push(this.readDouble());var n=lu(this);for(e=e||[];this.pos<n;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==nn.Bytes)return e.push(this.readFixed32());var n=lu(this);for(e=e||[];this.pos<n;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==nn.Bytes)return e.push(this.readSFixed32());var n=lu(this);for(e=e||[];this.pos<n;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==nn.Bytes)return e.push(this.readFixed64());var n=lu(this);for(e=e||[];this.pos<n;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==nn.Bytes)return e.push(this.readSFixed64());var n=lu(this);for(e=e||[];this.pos<n;)e.push(this.readSFixed64());return e},skip:function(e){var n=7&e;if(n===nn.Varint)for(;this.buf[this.pos++]>127;);else if(n===nn.Bytes)this.pos=this.readVarint()+this.pos;else if(n===nn.Fixed32)this.pos+=4;else{if(n!==nn.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(e,n){this.writeVarint(e<<3|n)},realloc:function(e){for(var n=this.length||16;n<this.pos+e;)n*=2;if(n!==this.length){var l=new Uint8Array(n);l.set(this.buf),this.buf=l,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),_c(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),_c(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),_c(this.buf,-1&e,this.pos),_c(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),_c(this.buf,-1&e,this.pos),_c(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(n,l){var v,E;if(n>=0?(v=n%4294967296|0,E=n/4294967296|0):(E=~(-n/4294967296),4294967295^(v=~(-n%4294967296))?v=v+1|0:(v=0,E=E+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(C,i,t){t.buf[t.pos++]=127&C|128,C>>>=7,t.buf[t.pos++]=127&C|128,C>>>=7,t.buf[t.pos++]=127&C|128,C>>>=7,t.buf[t.pos++]=127&C|128,t.buf[t.pos]=127&(C>>>=7)}(v,0,l),function(C,i){var t=(7&C)<<4;i.buf[i.pos++]|=t|((C>>>=3)?128:0),C&&(i.buf[i.pos++]=127&C|((C>>>=7)?128:0),C&&(i.buf[i.pos++]=127&C|((C>>>=7)?128:0),C&&(i.buf[i.pos++]=127&C|((C>>>=7)?128:0),C&&(i.buf[i.pos++]=127&C|((C>>>=7)?128:0),C&&(i.buf[i.pos++]=127&C)))))}(E,l)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var n=this.pos;this.pos=function(v,E,C){for(var i,t,a=0;a<E.length;a++){if((i=E.charCodeAt(a))>55295&&i<57344){if(!t){i>56319||a+1===E.length?(v[C++]=239,v[C++]=191,v[C++]=189):t=i;continue}if(i<56320){v[C++]=239,v[C++]=191,v[C++]=189,t=i;continue}i=t-55296<<10|i-56320|65536,t=null}else t&&(v[C++]=239,v[C++]=191,v[C++]=189,t=null);i<128?v[C++]=i:(i<2048?v[C++]=i>>6|192:(i<65536?v[C++]=i>>12|224:(v[C++]=i>>18|240,v[C++]=i>>12&63|128),v[C++]=i>>6&63|128),v[C++]=63&i|128)}return C}(this.buf,e,this.pos);var l=this.pos-n;l>=128&&Do(n,l,this),this.pos=n-1,this.writeVarint(l),this.pos+=l},writeFloat:function(e){this.realloc(4),rf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),rf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var n=e.length;this.writeVarint(n),this.realloc(n);for(var l=0;l<n;l++)this.buf[this.pos++]=e[l]},writeRawMessage:function(e,n){this.pos++;var l=this.pos;e(n,this);var v=this.pos-l;v>=128&&Do(l,v,this),this.pos=l-1,this.writeVarint(v),this.pos+=v},writeMessage:function(e,n,l){this.writeTag(e,nn.Bytes),this.writeRawMessage(n,l)},writePackedVarint:function(e,n){n.length&&this.writeMessage(e,sd,n)},writePackedSVarint:function(e,n){n.length&&this.writeMessage(e,of,n)},writePackedBoolean:function(e,n){n.length&&this.writeMessage(e,Nu,n)},writePackedFloat:function(e,n){n.length&&this.writeMessage(e,af,n)},writePackedDouble:function(e,n){n.length&&this.writeMessage(e,un,n)},writePackedFixed32:function(e,n){n.length&&this.writeMessage(e,ld,n)},writePackedSFixed32:function(e,n){n.length&&this.writeMessage(e,sf,n)},writePackedFixed64:function(e,n){n.length&&this.writeMessage(e,lf,n)},writePackedSFixed64:function(e,n){n.length&&this.writeMessage(e,uu,n)},writeBytesField:function(e,n){this.writeTag(e,nn.Bytes),this.writeBytes(n)},writeFixed32Field:function(e,n){this.writeTag(e,nn.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(e,n){this.writeTag(e,nn.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(e,n){this.writeTag(e,nn.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(e,n){this.writeTag(e,nn.Fixed64),this.writeSFixed64(n)},writeVarintField:function(e,n){this.writeTag(e,nn.Varint),this.writeVarint(n)},writeSVarintField:function(e,n){this.writeTag(e,nn.Varint),this.writeSVarint(n)},writeStringField:function(e,n){this.writeTag(e,nn.Bytes),this.writeString(n)},writeFloatField:function(e,n){this.writeTag(e,nn.Fixed32),this.writeFloat(n)},writeDoubleField:function(e,n){this.writeTag(e,nn.Fixed64),this.writeDouble(n)},writeBooleanField:function(e,n){this.writeVarintField(e,Boolean(n))}};var up=function(e,n){var l=n.pixelRatio,v=n.version,E=n.stretchX,C=n.stretchY,i=n.content;this.paddedRect=e,this.pixelRatio=l,this.stretchX=E,this.stretchY=C,this.content=i,this.version=v},zh={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};zh.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},zh.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},zh.tlbr.get=function(){return this.tl.concat(this.br)},zh.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(up.prototype,zh);var Ph=function(e,n){var l={},v={};this.haveRenderCallbacks=[];var E=[];this.addImages(e,l,E),this.addImages(n,v,E);var C=cf(E),i=new $o({width:C.w||1,height:C.h||1});for(var t in e){var a=e[t],h=l[t].paddedRect;$o.copy(a.data,i,{x:0,y:0},{x:h.x+1,y:h.y+1},a.data)}for(var _ in n){var b=n[_],S=v[_].paddedRect,P=S.x+1,R=S.y+1,O=b.data.width,V=b.data.height;$o.copy(b.data,i,{x:0,y:0},{x:P,y:R},b.data),$o.copy(b.data,i,{x:0,y:V-1},{x:P,y:R-1},{width:O,height:1}),$o.copy(b.data,i,{x:0,y:0},{x:P,y:R+V},{width:O,height:1}),$o.copy(b.data,i,{x:O-1,y:0},{x:P-1,y:R},{width:1,height:V}),$o.copy(b.data,i,{x:0,y:0},{x:P+O,y:R},{width:1,height:V})}this.image=i,this.iconPositions=l,this.patternPositions=v};Ph.prototype.addImages=function(e,n,l){for(var v in e){var E=e[v],C={x:0,y:0,w:E.data.width+2,h:E.data.height+2};l.push(C),n[v]=new up(C,E),E.hasRenderCallback&&this.haveRenderCallbacks.push(v)}},Ph.prototype.patchUpdatedImages=function(e,n){for(var l in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[l],e.getImage(l),n),this.patchUpdatedImage(this.patternPositions[l],e.getImage(l),n)},Ph.prototype.patchUpdatedImage=function(e,n,l){if(e&&n&&e.version!==n.version){e.version=n.version;var v=e.tl;l.update(n.data,void 0,{x:v[0],y:v[1]})}},ui("ImagePosition",up),ui("ImageAtlas",Ph);var Ja={horizontal:1,vertical:2,horizontalOnly:3},hu=function(){this.scale=1,this.fontStack="",this.imageName=null};hu.forText=function(e,n){var l=new hu;return l.scale=e||1,l.fontStack=n,l},hu.forImage=function(e){var n=new hu;return n.imageName=e,n};var ao=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Mh(e,n,l,v,E,C,i,t,a,h,_,b,S,P,R,O){var V,j=ao.fromFeature(e,E);b===Ja.vertical&&j.verticalizePunctuation();var K=ci.processBidirectionalText,$=ci.processStyledBidirectionalText;if(K&&j.sections.length===1){V=[];for(var Q=0,se=K(j.toString(),th(j,h,C,n,v,P,R));Q<se.length;Q+=1){var pe=se[Q],ke=new ao;ke.text=pe,ke.sections=j.sections;for(var Ne=0;Ne<pe.length;Ne++)ke.sectionIndex.push(0);V.push(ke)}}else if($){V=[];for(var Ze=0,He=$(j.text,j.sectionIndex,th(j,h,C,n,v,P,R));Ze<He.length;Ze+=1){var it=He[Ze],We=new ao;We.text=it[0],We.sectionIndex=it[1],We.sections=j.sections,V.push(We)}}else V=function(pt,Tt){for(var gt=[],Pt=pt.text,mt=0,vt=0,oi=Tt;vt<oi.length;vt+=1){var ri=oi[vt];gt.push(pt.substring(mt,ri)),mt=ri}return mt<Pt.length&&gt.push(pt.substring(mt,Pt.length)),gt}(j,th(j,h,C,n,v,P,R));var kt=[],At={positionedLines:kt,text:j.toString(),top:_[1],bottom:_[1],left:_[0],right:_[0],writingMode:b,iconsInText:!1,verticalizable:!1};return function(pt,Tt,gt,Pt,mt,vt,oi,ri,Mi,Bi,Qi,ur){for(var kr=0,zr=-17,xr=0,Br=0,br=ri==="right"?1:ri==="left"?0:.5,Or=0,Vi=0,Ki=mt;Vi<Ki.length;Vi+=1){var er=Ki[Vi];er.trim();var Hi=er.getMaxScale(),on=24*(Hi-1),en={positionedGlyphs:[],lineOffset:0};pt.positionedLines[Or]=en;var dr=en.positionedGlyphs,sr=0;if(er.length()){for(var Lr=0;Lr<er.length();Lr++){var fi=er.getSection(Lr),lo=er.getSectionIndex(Lr),cn=er.getCharCode(Lr),Mn=0,Wr=null,Ro=null,_o=null,Ya=24,ea=!(Mi===Ja.horizontal||!Qi&&!ms(cn)||Qi&&(cp[cn]||(Ml=cn,Wt.Arabic(Ml)||Wt["Arabic Supplement"](Ml)||Wt["Arabic Extended-A"](Ml)||Wt["Arabic Presentation Forms-A"](Ml)||Wt["Arabic Presentation Forms-B"](Ml))));if(fi.imageName){var ta=Pt[fi.imageName];if(!ta)continue;_o=fi.imageName,pt.iconsInText=pt.iconsInText||!0,Ro=ta.paddedRect;var uo=ta.displaySize;fi.scale=24*fi.scale/ur,Mn=on+(24-uo[1]*fi.scale),Ya=(Wr={width:uo[0],height:uo[1],left:1,top:-3,advance:ea?uo[1]:uo[0]}).advance;var $a=ea?uo[0]*fi.scale-24*Hi:uo[1]*fi.scale-24*Hi;$a>0&&$a>sr&&(sr=$a)}else{var Wu=gt[fi.fontStack],Ic=Wu&&Wu[cn];if(Ic&&Ic.rect)Ro=Ic.rect,Wr=Ic.metrics;else{var Tc=Tt[fi.fontStack],lh=Tc&&Tc[cn];if(!lh)continue;Wr=lh.metrics}Mn=24*(Hi-fi.scale)}ea?(pt.verticalizable=!0,dr.push({glyph:cn,imageName:_o,x:kr,y:zr+Mn,vertical:ea,scale:fi.scale,fontStack:fi.fontStack,sectionIndex:lo,metrics:Wr,rect:Ro}),kr+=Ya*fi.scale+Bi):(dr.push({glyph:cn,imageName:_o,x:kr,y:zr+Mn,vertical:ea,scale:fi.scale,fontStack:fi.fontStack,sectionIndex:lo,metrics:Wr,rect:Ro}),kr+=Wr.advance*fi.scale+Bi)}dr.length!==0&&(xr=Math.max(kr-Bi,xr),ih(dr,0,dr.length-1,br,sr)),kr=0;var Fs=vt*Hi+sr;en.lineOffset=Math.max(sr,on),zr+=Fs,Br=Math.max(Fs,Br),++Or}else zr+=vt,++Or}var Ml,Ac=zr- -17,Xu=vc(oi),mu=Xu.horizontalAlign,uh=Xu.verticalAlign;(function(wp,Ep,Vh,qh,Sp,Gh,Zh,Da,Cc){var kc,ia=(Ep-Vh)*Sp;kc=Gh!==Zh?-Da*qh- -17:(-qh*Cc+.5)*Zh;for(var Ra=0,yu=wp;Ra<yu.length;Ra+=1)for(var ll=0,ch=yu[Ra].positionedGlyphs;ll<ch.length;ll+=1){var Us=ch[ll];Us.x+=ia,Us.y+=kc}})(pt.positionedLines,br,mu,uh,xr,Br,vt,Ac,mt.length),pt.top+=-uh*Ac,pt.bottom=pt.top+Ac,pt.left+=-mu*xr,pt.right=pt.left+xr}(At,n,l,v,V,i,t,a,b,h,S,O),!function(pt){for(var Tt=0,gt=pt;Tt<gt.length;Tt+=1)if(gt[Tt].positionedGlyphs.length!==0)return!1;return!0}(kt)&&At}ao.fromFeature=function(e,n){for(var l=new ao,v=0;v<e.sections.length;v++){var E=e.sections[v];E.image?l.addImageSection(E):l.addTextSection(E,n)}return l},ao.prototype.length=function(){return this.text.length},ao.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},ao.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},ao.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},ao.prototype.verticalizePunctuation=function(){this.text=function(e){for(var n="",l=0;l<e.length;l++){var v=e.charCodeAt(l+1)||null,E=e.charCodeAt(l-1)||null;n+=v&&iu(v)&&!eh[e[l+1]]||E&&iu(E)&&!eh[e[l-1]]||!eh[e[l]]?e[l]:eh[e[l]]}return n}(this.text)},ao.prototype.trim=function(){for(var e=0,n=0;n<this.text.length&&cp[this.text.charCodeAt(n)];n++)e++;for(var l=this.text.length,v=this.text.length-1;v>=0&&v>=e&&cp[this.text.charCodeAt(v)];v--)l--;this.text=this.text.substring(e,l),this.sectionIndex=this.sectionIndex.slice(e,l)},ao.prototype.substring=function(e,n){var l=new ao;return l.text=this.text.substring(e,n),l.sectionIndex=this.sectionIndex.slice(e,n),l.sections=this.sections,l},ao.prototype.toString=function(){return this.text},ao.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(n,l){return Math.max(n,e.sections[l].scale)},0)},ao.prototype.addTextSection=function(e,n){this.text+=e.text,this.sections.push(hu.forText(e.scale,e.fontStack||n));for(var l=this.sections.length-1,v=0;v<e.text.length;++v)this.sectionIndex.push(l)},ao.prototype.addImageSection=function(e){var n=e.image?e.image.name:"";if(n.length!==0){var l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(hu.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Ht("Reached maximum number of images 6401")}else Ht("Can't add FormattedSection with an empty image.")},ao.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var cp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},La={};function hf(e,n,l,v,E,C){if(n.imageName){var i=v[n.imageName];return i?i.displaySize[0]*n.scale*24/C+E:0}var t=l[n.fontStack],a=t&&t[e];return a?a.metrics.advance*n.scale+E:0}function ud(e,n,l,v){var E=Math.pow(e-n,2);return v?e<n?E/2:2*E:E+Math.abs(l)*l}function cd(e,n,l){var v=0;return e===10&&(v-=1e4),l&&(v+=150),e!==40&&e!==65288||(v+=50),n!==41&&n!==65289||(v+=50),v}function hd(e,n,l,v,E,C){for(var i=null,t=ud(n,l,E,C),a=0,h=v;a<h.length;a+=1){var _=h[a],b=ud(n-_.x,l,E,C)+_.badness;b<=t&&(i=_,t=b)}return{index:e,x:n,priorBreak:i,badness:t}}function th(e,n,l,v,E,C,i){if(C!=="point")return[];if(!e)return[];for(var t,a=[],h=function(V,j,K,$,Q,se){for(var pe=0,ke=0;ke<V.length();ke++){var Ne=V.getSection(ke);pe+=hf(V.getCharCode(ke),Ne,$,Q,j,se)}return pe/Math.max(1,Math.ceil(pe/K))}(e,n,l,v,E,i),_=e.text.indexOf("\u200B")>=0,b=0,S=0;S<e.length();S++){var P=e.getSection(S),R=e.getCharCode(S);if(cp[R]||(b+=hf(R,P,v,E,n,i)),S<e.length()-1){var O=!((t=R)<11904||!(Wt["Bopomofo Extended"](t)||Wt.Bopomofo(t)||Wt["CJK Compatibility Forms"](t)||Wt["CJK Compatibility Ideographs"](t)||Wt["CJK Compatibility"](t)||Wt["CJK Radicals Supplement"](t)||Wt["CJK Strokes"](t)||Wt["CJK Symbols and Punctuation"](t)||Wt["CJK Unified Ideographs Extension A"](t)||Wt["CJK Unified Ideographs"](t)||Wt["Enclosed CJK Letters and Months"](t)||Wt["Halfwidth and Fullwidth Forms"](t)||Wt.Hiragana(t)||Wt["Ideographic Description Characters"](t)||Wt["Kangxi Radicals"](t)||Wt["Katakana Phonetic Extensions"](t)||Wt.Katakana(t)||Wt["Vertical Forms"](t)||Wt["Yi Radicals"](t)||Wt["Yi Syllables"](t)));(La[R]||O||P.imageName)&&a.push(hd(S+1,b,h,a,cd(R,e.getCharCode(S+1),O&&_),!1))}}return function V(j){return j?V(j.priorBreak).concat(j.index):[]}(hd(e.length(),b,h,a,0,!0))}function vc(e){var n=.5,l=.5;switch(e){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:n,verticalAlign:l}}function ih(e,n,l,v,E){if(v||E)for(var C=e[l],i=(e[l].x+C.metrics.advance*C.scale)*v,t=n;t<=l;t++)e[t].x-=i,e[t].y+=E}function Lh(e,n,l,v,E,C){var i,t=e.image;if(t.content){var a=t.content,h=t.pixelRatio||1;i=[a[0]/h,a[1]/h,t.displaySize[0]-a[2]/h,t.displaySize[1]-a[3]/h]}var _,b,S,P,R=n.left*C,O=n.right*C;l==="width"||l==="both"?(P=E[0]+R-v[3],b=E[0]+O+v[1]):b=(P=E[0]+(R+O-t.displaySize[0])/2)+t.displaySize[0];var V=n.top*C,j=n.bottom*C;return l==="height"||l==="both"?(_=E[1]+V-v[0],S=E[1]+j+v[2]):S=(_=E[1]+(V+j-t.displaySize[1])/2)+t.displaySize[1],{image:t,top:_,right:b,bottom:S,left:P,collisionPadding:i}}La[10]=!0,La[32]=!0,La[38]=!0,La[40]=!0,La[41]=!0,La[43]=!0,La[45]=!0,La[47]=!0,La[173]=!0,La[183]=!0,La[8203]=!0,La[8208]=!0,La[8211]=!0,La[8231]=!0;var pu=function(e){function n(l,v,E,C){e.call(this,l,v),this.angle=E,C!==void 0&&(this.segment=C)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.clone=function(){return new n(this.x,this.y,this.angle,this.segment)},n}(U);function pd(e,n){var l=n.expression;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new Vt(e+1))};if(l.kind==="source")return{kind:"source"};for(var v=l.zoomStops,E=l.interpolationType,C=0;C<v.length&&v[C]<=e;)C++;for(var i=C=Math.max(0,C-1);i<v.length&&v[i]<e+1;)i++;i=Math.min(v.length-1,i);var t=v[C],a=v[i];return l.kind==="composite"?{kind:"composite",minZoom:t,maxZoom:a,interpolationType:E}:{kind:"camera",minZoom:t,maxZoom:a,minSize:l.evaluate(new Vt(t)),maxSize:l.evaluate(new Vt(a)),interpolationType:E}}function dd(e,n,l){var v=n.uSize,E=l.lowerSize;return e.kind==="source"?E/128:e.kind==="composite"?Tn(E/128,l.upperSize/128,n.uSizeT):v}function fd(e,n){var l=0,v=0;if(e.kind==="constant")v=e.layoutSize;else if(e.kind!=="source"){var E=e.interpolationType,C=E?Le(yo.interpolationFactor(E,n,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?v=Tn(e.minSize,e.maxSize,C):l=C}return{uSizeT:l,uSize:v}}ui("Anchor",pu);var Hm=Object.freeze({__proto__:null,getSizeData:pd,evaluateSizeForFeature:dd,evaluateSizeForZoom:fd,SIZE_PACK_FACTOR:128});function md(e,n,l,v,E){if(n.segment===void 0)return!0;for(var C=n,i=n.segment+1,t=0;t>-l/2;){if(--i<0)return!1;t-=e[i].dist(C),C=e[i]}t+=e[i].dist(e[i+1]),i++;for(var a=[],h=0;t<l/2;){var _=e[i],b=e[i+1];if(!b)return!1;var S=e[i-1].angleTo(_)-_.angleTo(b);for(S=Math.abs((S+3*Math.PI)%(2*Math.PI)-Math.PI),a.push({distance:t,angleDelta:S}),h+=S;t-a[0].distance>v;)h-=a.shift().angleDelta;if(h>E)return!1;i++,t+=_.dist(b)}return!0}function yd(e){for(var n=0,l=0;l<e.length-1;l++)n+=e[l].dist(e[l+1]);return n}function hp(e,n,l){return e?.6*n*l:0}function pp(e,n){return Math.max(e?e.right-e.left:0,n?n.right-n.left:0)}function Wm(e,n,l,v,E,C){for(var i=hp(l,E,C),t=pp(l,v)*C,a=0,h=yd(e)/2,_=0;_<e.length-1;_++){var b=e[_],S=e[_+1],P=b.dist(S);if(a+P>h){var R=(h-a)/P,O=Tn(b.x,S.x,R),V=Tn(b.y,S.y,R),j=new pu(O,V,S.angleTo(b),_);return j._round(),!i||md(e,j,t,i,n)?j:void 0}a+=P}}function Xm(e,n,l,v,E,C,i,t,a){var h=hp(v,C,i),_=pp(v,E),b=_*i,S=e[0].x===0||e[0].x===a||e[0].y===0||e[0].y===a;return n-b<n/4&&(n=b+n/4),function P(R,O,V,j,K,$,Q,se,pe){for(var ke=$/2,Ne=yd(R),Ze=0,He=O-V,it=[],We=0;We<R.length-1;We++){for(var kt=R[We],At=R[We+1],pt=kt.dist(At),Tt=At.angleTo(kt);He+V<Ze+pt;){var gt=((He+=V)-Ze)/pt,Pt=Tn(kt.x,At.x,gt),mt=Tn(kt.y,At.y,gt);if(Pt>=0&&Pt<pe&&mt>=0&&mt<pe&&He-ke>=0&&He+ke<=Ne){var vt=new pu(Pt,mt,Tt,We);vt._round(),j&&!md(R,vt,$,j,K)||it.push(vt)}}Ze+=pt}return se||it.length||Q||(it=P(R,Ze/2,V,j,K,$,Q,!0,pe)),it}(e,S?n/2*t%n:(_/2+2*C)*i*t%n,n,h,l,b,S,!1,a)}function gd(e,n,l,v,E){for(var C=[],i=0;i<e.length;i++)for(var t=e[i],a=void 0,h=0;h<t.length-1;h++){var _=t[h],b=t[h+1];_.x<n&&b.x<n||(_.x<n?_=new U(n,_.y+(n-_.x)/(b.x-_.x)*(b.y-_.y))._round():b.x<n&&(b=new U(n,_.y+(n-_.x)/(b.x-_.x)*(b.y-_.y))._round()),_.y<l&&b.y<l||(_.y<l?_=new U(_.x+(l-_.y)/(b.y-_.y)*(b.x-_.x),l)._round():b.y<l&&(b=new U(_.x+(l-_.y)/(b.y-_.y)*(b.x-_.x),l)._round()),_.x>=v&&b.x>=v||(_.x>=v?_=new U(v,_.y+(v-_.x)/(b.x-_.x)*(b.y-_.y))._round():b.x>=v&&(b=new U(v,_.y+(v-_.x)/(b.x-_.x)*(b.y-_.y))._round()),_.y>=E&&b.y>=E||(_.y>=E?_=new U(_.x+(E-_.y)/(b.y-_.y)*(b.x-_.x),E)._round():b.y>=E&&(b=new U(_.x+(E-_.y)/(b.y-_.y)*(b.x-_.x),E)._round()),a&&_.equals(a[a.length-1])||C.push(a=[_]),a.push(b)))))}return C}function zl(e,n,l,v){var E=[],C=e.image,i=C.pixelRatio,t=C.paddedRect.w-2,a=C.paddedRect.h-2,h=e.right-e.left,_=e.bottom-e.top,b=C.stretchX||[[0,t]],S=C.stretchY||[[0,a]],P=function(Pt,mt){return Pt+mt[1]-mt[0]},R=b.reduce(P,0),O=S.reduce(P,0),V=t-R,j=a-O,K=0,$=R,Q=0,se=O,pe=0,ke=V,Ne=0,Ze=j;if(C.content&&v){var He=C.content;K=Dh(b,0,He[0]),Q=Dh(S,0,He[1]),$=Dh(b,He[0],He[2]),se=Dh(S,He[1],He[3]),pe=He[0]-K,Ne=He[1]-Q,ke=He[2]-He[0]-$,Ze=He[3]-He[1]-se}var it=function(Pt,mt,vt,oi){var ri=Rh(Pt.stretch-K,$,h,e.left),Mi=Bh(Pt.fixed-pe,ke,Pt.stretch,R),Bi=Rh(mt.stretch-Q,se,_,e.top),Qi=Bh(mt.fixed-Ne,Ze,mt.stretch,O),ur=Rh(vt.stretch-K,$,h,e.left),kr=Bh(vt.fixed-pe,ke,vt.stretch,R),zr=Rh(oi.stretch-Q,se,_,e.top),xr=Bh(oi.fixed-Ne,Ze,oi.stretch,O),Br=new U(ri,Bi),br=new U(ur,Bi),Or=new U(ur,zr),Vi=new U(ri,zr),Ki=new U(Mi/i,Qi/i),er=new U(kr/i,xr/i),Hi=n*Math.PI/180;if(Hi){var on=Math.sin(Hi),en=Math.cos(Hi),dr=[en,-on,on,en];Br._matMult(dr),br._matMult(dr),Vi._matMult(dr),Or._matMult(dr)}var sr=Pt.stretch+Pt.fixed,Lr=mt.stretch+mt.fixed;return{tl:Br,tr:br,bl:Vi,br:Or,tex:{x:C.paddedRect.x+1+sr,y:C.paddedRect.y+1+Lr,w:vt.stretch+vt.fixed-sr,h:oi.stretch+oi.fixed-Lr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ki,pixelOffsetBR:er,minFontScaleX:ke/i/h,minFontScaleY:Ze/i/_,isSDF:l}};if(v&&(C.stretchX||C.stretchY))for(var We=du(b,V,R),kt=du(S,j,O),At=0;At<We.length-1;At++)for(var pt=We[At],Tt=We[At+1],gt=0;gt<kt.length-1;gt++)E.push(it(pt,kt[gt],Tt,kt[gt+1]));else E.push(it({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:t+1},{fixed:0,stretch:a+1}));return E}function Dh(e,n,l){for(var v=0,E=0,C=e;E<C.length;E+=1){var i=C[E];v+=Math.max(n,Math.min(l,i[1]))-Math.max(n,Math.min(l,i[0]))}return v}function du(e,n,l){for(var v=[{fixed:-1,stretch:0}],E=0,C=e;E<C.length;E+=1){var i=C[E],t=i[0],a=i[1],h=v[v.length-1];v.push({fixed:t-h.stretch,stretch:h.stretch}),v.push({fixed:t-h.stretch,stretch:h.stretch+(a-t)})}return v.push({fixed:n+1,stretch:l}),v}function Rh(e,n,l,v){return e/n*l+v}function Bh(e,n,l,v){return e-n*l/v}var Oh=function(e,n,l,v,E,C,i,t,a,h){if(this.boxStartIndex=e.length,a){var _=C.top,b=C.bottom,S=C.collisionPadding;S&&(_-=S[1],b+=S[3]);var P=b-_;P>0&&(P=Math.max(10,P),this.circleDiameter=P)}else{var R=C.top*i-t,O=C.bottom*i+t,V=C.left*i-t,j=C.right*i+t,K=C.collisionPadding;if(K&&(V-=K[0]*i,R-=K[1]*i,j+=K[2]*i,O+=K[3]*i),h){var $=new U(V,R),Q=new U(j,R),se=new U(V,O),pe=new U(j,O),ke=h*Math.PI/180;$._rotate(ke),Q._rotate(ke),se._rotate(ke),pe._rotate(ke),V=Math.min($.x,Q.x,se.x,pe.x),j=Math.max($.x,Q.x,se.x,pe.x),R=Math.min($.y,Q.y,se.y,pe.y),O=Math.max($.y,Q.y,se.y,pe.y)}e.emplaceBack(n.x,n.y,V,R,j,O,l,v,E)}this.boxEndIndex=e.length},xc=function(e,n){if(e===void 0&&(e=[]),n===void 0&&(n=Km),this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(var l=(this.length>>1)-1;l>=0;l--)this._down(l)};function Km(e,n){return e<n?-1:e>n?1:0}function Jm(e,n,l){n===void 0&&(n=1),l===void 0&&(l=!1);for(var v=1/0,E=1/0,C=-1/0,i=-1/0,t=e[0],a=0;a<t.length;a++){var h=t[a];(!a||h.x<v)&&(v=h.x),(!a||h.y<E)&&(E=h.y),(!a||h.x>C)&&(C=h.x),(!a||h.y>i)&&(i=h.y)}var _=Math.min(C-v,i-E),b=_/2,S=new xc([],pf);if(_===0)return new U(v,E);for(var P=v;P<C;P+=_)for(var R=E;R<i;R+=_)S.push(new bc(P+b,R+b,b,e));for(var O=function(K){for(var $=0,Q=0,se=0,pe=K[0],ke=0,Ne=pe.length,Ze=Ne-1;ke<Ne;Ze=ke++){var He=pe[ke],it=pe[Ze],We=He.x*it.y-it.x*He.y;Q+=(He.x+it.x)*We,se+=(He.y+it.y)*We,$+=3*We}return new bc(Q/$,se/$,0,K)}(e),V=S.length;S.length;){var j=S.pop();(j.d>O.d||!O.d)&&(O=j,l&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,V)),j.max-O.d<=n||(S.push(new bc(j.p.x-(b=j.h/2),j.p.y-b,b,e)),S.push(new bc(j.p.x+b,j.p.y-b,b,e)),S.push(new bc(j.p.x-b,j.p.y+b,b,e)),S.push(new bc(j.p.x+b,j.p.y+b,b,e)),V+=4)}return l&&(console.log("num probes: "+V),console.log("best distance: "+O.d)),O.p}function pf(e,n){return n.max-e.max}function bc(e,n,l,v){this.p=new U(e,n),this.h=l,this.d=function(E,C){for(var i=!1,t=1/0,a=0;a<C.length;a++)for(var h=C[a],_=0,b=h.length,S=b-1;_<b;S=_++){var P=h[_],R=h[S];P.y>E.y!=R.y>E.y&&E.x<(R.x-P.x)*(E.y-P.y)/(R.y-P.y)+P.x&&(i=!i),t=Math.min(t,Ru(E,P,R))}return(i?1:-1)*Math.sqrt(t)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}xc.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},xc.prototype.pop=function(){if(this.length!==0){var e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}},xc.prototype.peek=function(){return this.data[0]},xc.prototype._up=function(e){for(var n=this.data,l=this.compare,v=n[e];e>0;){var E=e-1>>1,C=n[E];if(l(v,C)>=0)break;n[e]=C,e=E}n[e]=v},xc.prototype._down=function(e){for(var n=this.data,l=this.compare,v=this.length>>1,E=n[e];e<v;){var C=1+(e<<1),i=n[C],t=C+1;if(t<this.length&&l(n[t],i)<0&&(C=t,i=n[t]),l(i,E)>=0)break;n[e]=i,e=C}n[e]=E};var dp=Number.POSITIVE_INFINITY;function Fh(e,n){return n[1]!==dp?function(l,v,E){var C=0,i=0;switch(v=Math.abs(v),E=Math.abs(E),l){case"top-right":case"top-left":case"top":i=E-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-E}switch(l){case"top-right":case"bottom-right":case"right":C=-v;break;case"top-left":case"bottom-left":case"left":C=v}return[C,i]}(e,n[0],n[1]):function(l,v){var E=0,C=0;v<0&&(v=0);var i=v/Math.sqrt(2);switch(l){case"top-right":case"top-left":C=i-7;break;case"bottom-right":case"bottom-left":C=7-i;break;case"bottom":C=7-v;break;case"top":C=v-7}switch(l){case"top-right":case"bottom-right":E=-i;break;case"top-left":case"bottom-left":E=i;break;case"left":E=v;break;case"right":E=-v}return[E,C]}(e,n[0])}function fp(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Uh(e,n,l,v,E,C,i,t,a,h,_,b,S,P,R){var O=function(Q,se,pe,ke,Ne,Ze,He,it){for(var We=ke.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,kt=[],At=0,pt=se.positionedLines;At<pt.length;At+=1)for(var Tt=pt[At],gt=0,Pt=Tt.positionedGlyphs;gt<Pt.length;gt+=1){var mt=Pt[gt];if(mt.rect){var vt=mt.rect||{},oi=4,ri=!0,Mi=1,Bi=0,Qi=(Ne||it)&&mt.vertical,ur=mt.metrics.advance*mt.scale/2;if(it&&se.verticalizable&&(Bi=Tt.lineOffset/2-(mt.imageName?-(24-mt.metrics.width*mt.scale)/2:24*(mt.scale-1))),mt.imageName){var kr=He[mt.imageName];ri=kr.sdf,oi=1/(Mi=kr.pixelRatio)}var zr=Ne?[mt.x+ur,mt.y]:[0,0],xr=Ne?[0,0]:[mt.x+ur+pe[0],mt.y+pe[1]-Bi],Br=[0,0];Qi&&(Br=xr,xr=[0,0]);var br=(mt.metrics.left-oi)*mt.scale-ur+xr[0],Or=(-mt.metrics.top-oi)*mt.scale+xr[1],Vi=br+vt.w*mt.scale/Mi,Ki=Or+vt.h*mt.scale/Mi,er=new U(br,Or),Hi=new U(Vi,Or),on=new U(br,Ki),en=new U(Vi,Ki);if(Qi){var dr=new U(-ur,ur- -17),sr=-Math.PI/2,Lr=12-ur,fi=new U(22-Lr,-(mt.imageName?Lr:0)),lo=new(Function.prototype.bind.apply(U,[null].concat(Br)));er._rotateAround(sr,dr)._add(fi)._add(lo),Hi._rotateAround(sr,dr)._add(fi)._add(lo),on._rotateAround(sr,dr)._add(fi)._add(lo),en._rotateAround(sr,dr)._add(fi)._add(lo)}if(We){var cn=Math.sin(We),Mn=Math.cos(We),Wr=[Mn,-cn,cn,Mn];er._matMult(Wr),Hi._matMult(Wr),on._matMult(Wr),en._matMult(Wr)}var Ro=new U(0,0),_o=new U(0,0);kt.push({tl:er,tr:Hi,bl:on,br:en,tex:vt,writingMode:se.writingMode,glyphOffset:zr,sectionIndex:mt.sectionIndex,isSDF:ri,pixelOffsetTL:Ro,pixelOffsetBR:_o,minFontScaleX:0,minFontScaleY:0})}}return kt}(0,l,t,E,C,i,v,e.allowVerticalPlacement),V=e.textSizeData,j=null;V.kind==="source"?(j=[128*E.layout.get("text-size").evaluate(i,{})])[0]>32640&&Ht(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):V.kind==="composite"&&((j=[128*P.compositeTextSizes[0].evaluate(i,{},R),128*P.compositeTextSizes[1].evaluate(i,{},R)])[0]>32640||j[1]>32640)&&Ht(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,O,j,t,C,i,h,n,a.lineStartIndex,a.lineLength,S,R);for(var K=0,$=_;K<$.length;K+=1)b[$[K]]=e.text.placedSymbolArray.length-1;return 4*O.length}function Nh(e){for(var n in e)return e[n];return null}function mp(e,n,l,v){var E=e.compareText;if(n in E){for(var C=E[n],i=C.length-1;i>=0;i--)if(v.dist(C[i])<l)return!0}else E[n]=[];return E[n].push(v),!1}var Ym=Jc.VectorTileFeature.types,$m=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function yp(e,n,l,v,E,C,i,t,a,h,_,b,S){var P=t?Math.min(32640,Math.round(t[0])):0,R=t?Math.min(32640,Math.round(t[1])):0;e.emplaceBack(n,l,Math.round(32*v),Math.round(32*E),C,i,(P<<1)+(a?1:0),R,16*h,16*_,256*b,256*S)}function _d(e,n,l){e.emplaceBack(n.x,n.y,l),e.emplaceBack(n.x,n.y,l),e.emplaceBack(n.x,n.y,l),e.emplaceBack(n.x,n.y,l)}function rh(e){for(var n=0,l=e.sections;n<l.length;n+=1)if(rn(l[n].text))return!0;return!1}var ju=function(e){this.layoutVertexArray=new Fe,this.indexArray=new wt,this.programConfigurations=e,this.segments=new de,this.dynamicLayoutVertexArray=new we,this.opacityVertexArray=new Oe,this.placedSymbolArray=new x};ju.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},ju.prototype.upload=function(e,n,l,v){this.isEmpty()||(l&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Vm.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Yd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,$m,!0),this.opacityVertexBuffer.itemSize=1),(l||v)&&this.programConfigurations.upload(e))},ju.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ui("SymbolBuffers",ju);var nh=function(e,n,l){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new l,this.segments=new de,this.collisionVertexArray=new $e};nh.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,ad.members,!0)},nh.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ui("CollisionBuffers",nh);var Hr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(C){return C.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Yo([]),this.placementViewportMatrix=Yo([]);var n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=pd(this.zoom,n["text-size"]),this.iconSizeData=pd(this.zoom,n["icon-size"]);var l=this.layers[0].layout,v=l.get("symbol-sort-key"),E=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=E!=="viewport-y"&&v.constantOr(1)!==void 0,this.sortFeaturesByY=(E==="viewport-y"||E==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(function(C){return Ja[C]})),this.stateDependentLayerIds=this.layers.filter(function(C){return C.isStateDependent()}).map(function(C){return C.id}),this.sourceID=e.sourceID};Hr.prototype.createArrays=function(){this.text=new ju(new Ei(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new ju(new Ei(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new B,this.lineVertexArray=new q,this.symbolInstances=new D},Hr.prototype.calculateGlyphDependencies=function(e,n,l,v,E){for(var C=0;C<e.length;C++)if(n[e.charCodeAt(C)]=!0,(l||v)&&E){var i=eh[e.charAt(C)];i&&(n[i.charCodeAt(0)]=!0)}},Hr.prototype.populate=function(e,n,l){var v=this.layers[0],E=v.layout,C=E.get("text-font"),i=E.get("text-field"),t=E.get("icon-image"),a=(i.value.kind!=="constant"||i.value.value instanceof Cr&&!i.value.value.isEmpty()||i.value.value.toString().length>0)&&(C.value.kind!=="constant"||C.value.value.length>0),h=t.value.kind!=="constant"||!!t.value.value||Object.keys(t.parameters).length>0,_=E.get("symbol-sort-key");if(this.features=[],a||h){for(var b=n.iconDependencies,S=n.glyphDependencies,P=n.availableImages,R=new Vt(this.zoom),O=0,V=e;O<V.length;O+=1){var j=V[O],K=j.feature,$=j.id,Q=j.index,se=j.sourceLayerIndex,pe=v._featureFilter.needGeometry,ke=hr(K,pe);if(v._featureFilter.filter(R,ke,l)){pe||(ke.geometry=wn(K));var Ne=void 0;if(a){var Ze=v.getValueAndResolveTokens("text-field",ke,l,P),He=Cr.factory(Ze);rh(He)&&(this.hasRTLText=!0),(!this.hasRTLText||ba()==="unavailable"||this.hasRTLText&&ci.isParsed())&&(Ne=ef(He,v,ke))}var it=void 0;if(h){var We=v.getValueAndResolveTokens("icon-image",ke,l,P);it=We instanceof Eo?We:Eo.fromString(We)}if(Ne||it){var kt=this.sortFeaturesByKey?_.evaluate(ke,{},l):void 0;if(this.features.push({id:$,text:Ne,icon:it,index:Q,sourceLayerIndex:se,geometry:ke.geometry,properties:K.properties,type:Ym[K.type],sortKey:kt}),it&&(b[it.name]=!0),Ne){var At=C.evaluate(ke,{},l).join(","),pt=E.get("text-rotation-alignment")==="map"&&E.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ja.vertical)>=0;for(var Tt=0,gt=Ne.sections;Tt<gt.length;Tt+=1){var Pt=gt[Tt];if(Pt.image)b[Pt.image.name]=!0;else{var mt=tu(Ne.toString()),vt=Pt.fontStack||At,oi=S[vt]=S[vt]||{};this.calculateGlyphDependencies(Pt.text,oi,pt,this.allowVerticalPlacement,mt)}}}}}}E.get("symbol-placement")==="line"&&(this.features=function(ri){var Mi={},Bi={},Qi=[],ur=0;function kr(dr){Qi.push(ri[dr]),ur++}function zr(dr,sr,Lr){var fi=Bi[dr];return delete Bi[dr],Bi[sr]=fi,Qi[fi].geometry[0].pop(),Qi[fi].geometry[0]=Qi[fi].geometry[0].concat(Lr[0]),fi}function xr(dr,sr,Lr){var fi=Mi[sr];return delete Mi[sr],Mi[dr]=fi,Qi[fi].geometry[0].shift(),Qi[fi].geometry[0]=Lr[0].concat(Qi[fi].geometry[0]),fi}function Br(dr,sr,Lr){var fi=Lr?sr[0][sr[0].length-1]:sr[0][0];return dr+":"+fi.x+":"+fi.y}for(var br=0;br<ri.length;br++){var Or=ri[br],Vi=Or.geometry,Ki=Or.text?Or.text.toString():null;if(Ki){var er=Br(Ki,Vi),Hi=Br(Ki,Vi,!0);if(er in Bi&&Hi in Mi&&Bi[er]!==Mi[Hi]){var on=xr(er,Hi,Vi),en=zr(er,Hi,Qi[on].geometry);delete Mi[er],delete Bi[Hi],Bi[Br(Ki,Qi[en].geometry,!0)]=en,Qi[on].geometry=null}else er in Bi?zr(er,Hi,Vi):Hi in Mi?xr(er,Hi,Vi):(kr(br),Mi[er]=ur-1,Bi[Hi]=ur-1)}else kr(br)}return Qi.filter(function(dr){return dr.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(ri,Mi){return ri.sortKey-Mi.sortKey})}},Hr.prototype.update=function(e,n,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,l),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,l))},Hr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Hr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Hr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Hr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Hr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Hr.prototype.addToLineVertexArray=function(e,n){var l=this.lineVertexArray.length;if(e.segment!==void 0){for(var v=e.dist(n[e.segment+1]),E=e.dist(n[e.segment]),C={},i=e.segment+1;i<n.length;i++)C[i]={x:n[i].x,y:n[i].y,tileUnitDistanceFromAnchor:v},i<n.length-1&&(v+=n[i+1].dist(n[i]));for(var t=e.segment||0;t>=0;t--)C[t]={x:n[t].x,y:n[t].y,tileUnitDistanceFromAnchor:E},t>0&&(E+=n[t-1].dist(n[t]));for(var a=0;a<n.length;a++){var h=C[a];this.lineVertexArray.emplaceBack(h.x,h.y,h.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}},Hr.prototype.addSymbols=function(e,n,l,v,E,C,i,t,a,h,_,b){for(var S=e.indexArray,P=e.layoutVertexArray,R=e.segments.prepareSegment(4*n.length,P,S,this.canOverlap?C.sortKey:void 0),O=this.glyphOffsetArray.length,V=R.vertexLength,j=this.allowVerticalPlacement&&i===Ja.vertical?Math.PI/2:0,K=C.text&&C.text.sections,$=0;$<n.length;$++){var Q=n[$],se=Q.tl,pe=Q.tr,ke=Q.bl,Ne=Q.br,Ze=Q.tex,He=Q.pixelOffsetTL,it=Q.pixelOffsetBR,We=Q.minFontScaleX,kt=Q.minFontScaleY,At=Q.glyphOffset,pt=Q.isSDF,Tt=Q.sectionIndex,gt=R.vertexLength,Pt=At[1];yp(P,t.x,t.y,se.x,Pt+se.y,Ze.x,Ze.y,l,pt,He.x,He.y,We,kt),yp(P,t.x,t.y,pe.x,Pt+pe.y,Ze.x+Ze.w,Ze.y,l,pt,it.x,He.y,We,kt),yp(P,t.x,t.y,ke.x,Pt+ke.y,Ze.x,Ze.y+Ze.h,l,pt,He.x,it.y,We,kt),yp(P,t.x,t.y,Ne.x,Pt+Ne.y,Ze.x+Ze.w,Ze.y+Ze.h,l,pt,it.x,it.y,We,kt),_d(e.dynamicLayoutVertexArray,t,j),S.emplaceBack(gt,gt+1,gt+2),S.emplaceBack(gt+1,gt+2,gt+3),R.vertexLength+=4,R.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(At[0]),$!==n.length-1&&Tt===n[$+1].sectionIndex||e.programConfigurations.populatePaintArrays(P.length,C,C.index,{},b,K&&K[Tt])}e.placedSymbolArray.emplaceBack(t.x,t.y,O,this.glyphOffsetArray.length-O,V,a,h,t.segment,l?l[0]:0,l?l[1]:0,v[0],v[1],i,0,!1,0,_)},Hr.prototype._addCollisionDebugVertex=function(e,n,l,v,E,C){return n.emplaceBack(0,0),e.emplaceBack(l.x,l.y,v,E,Math.round(C.x),Math.round(C.y))},Hr.prototype.addCollisionDebugVertices=function(e,n,l,v,E,C,i){var t=E.segments.prepareSegment(4,E.layoutVertexArray,E.indexArray),a=t.vertexLength,h=E.layoutVertexArray,_=E.collisionVertexArray,b=i.anchorX,S=i.anchorY;this._addCollisionDebugVertex(h,_,C,b,S,new U(e,n)),this._addCollisionDebugVertex(h,_,C,b,S,new U(l,n)),this._addCollisionDebugVertex(h,_,C,b,S,new U(l,v)),this._addCollisionDebugVertex(h,_,C,b,S,new U(e,v)),t.vertexLength+=4;var P=E.indexArray;P.emplaceBack(a,a+1),P.emplaceBack(a+1,a+2),P.emplaceBack(a+2,a+3),P.emplaceBack(a+3,a),t.primitiveLength+=4},Hr.prototype.addDebugCollisionBoxes=function(e,n,l,v){for(var E=e;E<n;E++){var C=this.collisionBoxArray.get(E);this.addCollisionDebugVertices(C.x1,C.y1,C.x2,C.y2,v?this.textCollisionBox:this.iconCollisionBox,C.anchorPoint,l)}},Hr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new nh(Xe,$d.members,mi),this.iconCollisionBox=new nh(Xe,$d.members,mi);for(var e=0;e<this.symbolInstances.length;e++){var n=this.symbolInstances.get(e);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}},Hr.prototype._deserializeCollisionBoxesForSymbol=function(e,n,l,v,E,C,i,t,a){for(var h={},_=n;_<l;_++){var b=e.get(_);h.textBox={x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2,anchorPointX:b.anchorPointX,anchorPointY:b.anchorPointY},h.textFeatureIndex=b.featureIndex;break}for(var S=v;S<E;S++){var P=e.get(S);h.verticalTextBox={x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,anchorPointX:P.anchorPointX,anchorPointY:P.anchorPointY},h.verticalTextFeatureIndex=P.featureIndex;break}for(var R=C;R<i;R++){var O=e.get(R);h.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},h.iconFeatureIndex=O.featureIndex;break}for(var V=t;V<a;V++){var j=e.get(V);h.verticalIconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},h.verticalIconFeatureIndex=j.featureIndex;break}return h},Hr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var n=0;n<this.symbolInstances.length;n++){var l=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}},Hr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Hr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Hr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Hr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Hr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Hr.prototype.addIndicesForPlacedSymbol=function(e,n){for(var l=e.placedSymbolArray.get(n),v=l.vertexStartIndex+4*l.numGlyphs,E=l.vertexStartIndex;E<v;E+=4)e.indexArray.emplaceBack(E,E+1,E+2),e.indexArray.emplaceBack(E+1,E+2,E+3)},Hr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var n=Math.sin(e),l=Math.cos(e),v=[],E=[],C=[],i=0;i<this.symbolInstances.length;++i){C.push(i);var t=this.symbolInstances.get(i);v.push(0|Math.round(n*t.anchorX+l*t.anchorY)),E.push(t.featureIndex)}return C.sort(function(a,h){return v[a]-v[h]||E[h]-E[a]}),C},Hr.prototype.addToSortKeyRanges=function(e,n){var l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===n?l.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Hr.prototype.sortFeatures=function(e){var n=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var l=0,v=this.symbolInstanceIndexes;l<v.length;l+=1){var E=this.symbolInstances.get(v[l]);this.featureSortOrder.push(E.featureIndex),[E.rightJustifiedTextSymbolIndex,E.centerJustifiedTextSymbolIndex,E.leftJustifiedTextSymbolIndex].forEach(function(C,i,t){C>=0&&t.indexOf(C)===i&&n.addIndicesForPlacedSymbol(n.text,C)}),E.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,E.verticalPlacedTextSymbolIndex),E.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,E.placedIconSymbolIndex),E.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,E.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ui("SymbolBucket",Hr,{omit:["layers","collisionBoxArray","features","compareText"]}),Hr.MAX_GLYPHS=65535,Hr.addDynamicAttributes=_d;var Qm=new T({"symbol-placement":new Kt(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new Kt(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Kt(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Xt(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Kt(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Kt(ye.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Kt(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new Kt(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Kt(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new Xt(ye.layout_symbol["icon-size"]),"icon-text-fit":new Kt(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Kt(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new Xt(ye.layout_symbol["icon-image"]),"icon-rotate":new Xt(ye.layout_symbol["icon-rotate"]),"icon-padding":new Kt(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new Kt(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new Xt(ye.layout_symbol["icon-offset"]),"icon-anchor":new Xt(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Kt(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Kt(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Kt(ye.layout_symbol["text-rotation-alignment"]),"text-field":new Xt(ye.layout_symbol["text-field"]),"text-font":new Xt(ye.layout_symbol["text-font"]),"text-size":new Xt(ye.layout_symbol["text-size"]),"text-max-width":new Xt(ye.layout_symbol["text-max-width"]),"text-line-height":new Kt(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new Xt(ye.layout_symbol["text-letter-spacing"]),"text-justify":new Xt(ye.layout_symbol["text-justify"]),"text-radial-offset":new Xt(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Kt(ye.layout_symbol["text-variable-anchor"]),"text-anchor":new Xt(ye.layout_symbol["text-anchor"]),"text-max-angle":new Kt(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new Kt(ye.layout_symbol["text-writing-mode"]),"text-rotate":new Xt(ye.layout_symbol["text-rotate"]),"text-padding":new Kt(ye.layout_symbol["text-padding"]),"text-keep-upright":new Kt(ye.layout_symbol["text-keep-upright"]),"text-transform":new Xt(ye.layout_symbol["text-transform"]),"text-offset":new Xt(ye.layout_symbol["text-offset"]),"text-allow-overlap":new Kt(ye.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Kt(ye.layout_symbol["text-ignore-placement"]),"text-optional":new Kt(ye.layout_symbol["text-optional"])}),Pl={paint:new T({"icon-opacity":new Xt(ye.paint_symbol["icon-opacity"]),"icon-color":new Xt(ye.paint_symbol["icon-color"]),"icon-halo-color":new Xt(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new Xt(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Xt(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new Kt(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new Kt(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new Xt(ye.paint_symbol["text-opacity"]),"text-color":new Xt(ye.paint_symbol["text-color"],{runtimeType:Te,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new Xt(ye.paint_symbol["text-halo-color"]),"text-halo-width":new Xt(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new Xt(ye.paint_symbol["text-halo-blur"]),"text-translate":new Kt(ye.paint_symbol["text-translate"]),"text-translate-anchor":new Kt(ye.paint_symbol["text-translate-anchor"])}),layout:Qm},wc=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:ve,this.defaultValue=e};wc.prototype.evaluate=function(e){if(e.formattedSection){var n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},wc.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},wc.prototype.outputDefined=function(){return!1},wc.prototype.serialize=function(){return null},ui("FormatSectionOverride",wc,{omit:["defaultValue"]});var df=function(e){function n(l){e.call(this,l,Pl)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.recalculate=function(l,v){if(e.prototype.recalculate.call(this,l,v),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var E=this.layout.get("text-writing-mode");if(E){for(var C=[],i=0,t=E;i<t.length;i+=1){var a=t[i];C.indexOf(a)<0&&C.push(a)}this.layout._values["text-writing-mode"]=C}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},n.prototype.getValueAndResolveTokens=function(l,v,E,C){var i=this.layout.get(l).evaluate(v,{},E,C),t=this._unevaluatedLayout._values[l];return t.isDataDriven()||Js(t.value)||!i?i:function(a,h){return h.replace(/{([^{}]+)}/g,function(_,b){return b in a?String(a[b]):""})}(v.properties,i)},n.prototype.createBucket=function(l){return new Hr(l)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype._setPaintOverrides=function(){for(var l=0,v=Pl.paint.overridableProperties;l<v.length;l+=1){var E=v[l];if(n.hasPaintOverride(this.layout,E)){var C,i=this.paint.get(E),t=new wc(i),a=new us(t,i.property.specification);C=i.value.kind==="constant"||i.value.kind==="source"?new Ms("source",a):new cs("composite",a,i.value.zoomStops,i.value._interpolationType),this.paint._values[E]=new Lo(i.property,C,i.parameters)}}},n.prototype._handleOverridablePaintPropertyUpdate=function(l,v,E){return!(!this.layout||v.isDataDriven()||E.isDataDriven())&&n.hasPaintOverride(this.layout,l)},n.hasPaintOverride=function(l,v){var E=l.get("text-field"),C=Pl.paint.properties[v],i=!1,t=function(_){for(var b=0,S=_;b<S.length;b+=1)if(C.overrides&&C.overrides.hasOverride(S[b]))return void(i=!0)};if(E.value.kind==="constant"&&E.value.value instanceof Cr)t(E.value.value.sections);else if(E.value.kind==="source"){var a=function(_){i||(_ instanceof Co&&Sn(_.value)===jt?t(_.value.sections):_ instanceof ua?t(_.sections):_.eachChild(a))},h=E.value;h._styleExpression&&a(h._styleExpression.expression)}return i},n}(o),ey={paint:new T({"background-color":new Kt(ye.paint_background["background-color"]),"background-pattern":new On(ye.paint_background["background-pattern"]),"background-opacity":new Kt(ye.paint_background["background-opacity"])})},ty=function(e){function n(l){e.call(this,l,ey)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(o),iy={paint:new T({"raster-opacity":new Kt(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new Kt(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Kt(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Kt(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new Kt(ye.paint_raster["raster-saturation"]),"raster-contrast":new Kt(ye.paint_raster["raster-contrast"]),"raster-resampling":new Kt(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new Kt(ye.paint_raster["raster-fade-duration"])})},gp=function(e){function n(l){e.call(this,l,iy)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(o),vd=function(e){function n(l){e.call(this,l,{}),this.implementation=l}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},n.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},n.prototype.recalculate=function(){},n.prototype.updateTransitions=function(){},n.prototype.hasTransition=function(){},n.prototype.serialize=function(){},n.prototype.onAdd=function(l){this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},n.prototype.onRemove=function(l){this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},n}(o),ry={circle:ip,heatmap:wh,hillshade:Zd,fill:rd,"fill-extrusion":Bm,line:jm,symbol:df,background:ty,raster:gp},_p=X.HTMLImageElement,vp=X.HTMLCanvasElement,Ec=X.HTMLVideoElement,ff=X.ImageData,oh=X.ImageBitmap,Vu=function(e,n,l,v){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(n,v)};Vu.prototype.update=function(e,n,l){var v=e.width,E=e.height,C=!(this.size&&this.size[0]===v&&this.size[1]===E||l),i=this.context,t=i.gl;if(this.useMipmap=Boolean(n&&n.useMipmap),t.bindTexture(t.TEXTURE_2D,this.texture),i.pixelStoreUnpackFlipY.set(!1),i.pixelStoreUnpack.set(1),i.pixelStoreUnpackPremultiplyAlpha.set(this.format===t.RGBA&&(!n||n.premultiply!==!1)),C)this.size=[v,E],e instanceof _p||e instanceof vp||e instanceof Ec||e instanceof ff||oh&&e instanceof oh?t.texImage2D(t.TEXTURE_2D,0,this.format,this.format,t.UNSIGNED_BYTE,e):t.texImage2D(t.TEXTURE_2D,0,this.format,v,E,0,this.format,t.UNSIGNED_BYTE,e.data);else{var a=l||{x:0,y:0},h=a.x,_=a.y;e instanceof _p||e instanceof vp||e instanceof Ec||e instanceof ff||oh&&e instanceof oh?t.texSubImage2D(t.TEXTURE_2D,0,h,_,t.RGBA,t.UNSIGNED_BYTE,e):t.texSubImage2D(t.TEXTURE_2D,0,h,_,v,E,t.RGBA,t.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&t.generateMipmap(t.TEXTURE_2D)},Vu.prototype.bind=function(e,n,l){var v=this.context.gl;v.bindTexture(v.TEXTURE_2D,this.texture),l!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=v.LINEAR),e!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,e),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,l||e),this.filter=e),n!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,n),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,n),this.wrap=n)},Vu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Vu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ah=function(e){var n=this;this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){n._triggered=!1,n._callback()})};ah.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},ah.prototype.remove=function(){delete this._channel,this._callback=function(){}};var qu=function(e,n,l){this.target=e,this.parent=n,this.mapId=l,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},at(["receive","process"],this),this.invoker=new ah(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=bt()?e:X};function mf(e,n,l){var v=2*Math.PI*6378137/256/Math.pow(2,l);return[e*v-2*Math.PI*6378137/2,n*v-2*Math.PI*6378137/2]}qu.prototype.send=function(e,n,l,v,E){var C=this;E===void 0&&(E=!1);var i=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(this.callbacks[i]=l);var t=bi(this.globalScope)?void 0:[];return this.target.postMessage({id:i,type:e,hasCallback:!!l,targetMapId:v,mustQueue:E,sourceMapId:this.mapId,data:da(n,t)},t),{cancel:function(){l&&delete C.callbacks[i],C.target.postMessage({id:i,type:"<cancel>",targetMapId:v,sourceMapId:C.mapId})}}},qu.prototype.receive=function(e){var n=e.data,l=n.id;if(l&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){delete this.tasks[l];var v=this.cancelCallbacks[l];delete this.cancelCallbacks[l],v&&v()}else bt()||n.mustQueue?(this.tasks[l]=n,this.taskQueue.push(l),this.invoker.trigger()):this.processTask(l,n)},qu.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),n=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),n&&this.processTask(e,n)}},qu.prototype.processTask=function(e,n){var l=this;if(n.type==="<response>"){var v=this.callbacks[e];delete this.callbacks[e],v&&(n.error?v(ln(n.error)):v(null,ln(n.data)))}else{var E=!1,C=bi(this.globalScope)?void 0:[],i=n.hasCallback?function(_,b){E=!0,delete l.cancelCallbacks[e],l.target.postMessage({id:e,type:"<response>",sourceMapId:l.mapId,error:_?da(_):null,data:da(b,C)},C)}:function(_){E=!0},t=null,a=ln(n.data);if(this.parent[n.type])t=this.parent[n.type](n.sourceMapId,a,i);else if(this.parent.getWorkerSource){var h=n.type.split(".");t=this.parent.getWorkerSource(n.sourceMapId,h[0],a.source)[h[1]](a,i)}else i(new Error("Could not find function "+n.type));!E&&t&&t.cancel&&(this.cancelCallbacks[e]=t.cancel)}},qu.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var so=function(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};so.prototype.setNorthEast=function(e){return this._ne=e instanceof yn?new yn(e.lng,e.lat):yn.convert(e),this},so.prototype.setSouthWest=function(e){return this._sw=e instanceof yn?new yn(e.lng,e.lat):yn.convert(e),this},so.prototype.extend=function(e){var n,l,v=this._sw,E=this._ne;if(e instanceof yn)n=e,l=e;else{if(!(e instanceof so))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(so.convert(e)):this.extend(yn.convert(e)):this;if(l=e._ne,!(n=e._sw)||!l)return this}return v||E?(v.lng=Math.min(n.lng,v.lng),v.lat=Math.min(n.lat,v.lat),E.lng=Math.max(l.lng,E.lng),E.lat=Math.max(l.lat,E.lat)):(this._sw=new yn(n.lng,n.lat),this._ne=new yn(l.lng,l.lat)),this},so.prototype.getCenter=function(){return new yn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},so.prototype.getSouthWest=function(){return this._sw},so.prototype.getNorthEast=function(){return this._ne},so.prototype.getNorthWest=function(){return new yn(this.getWest(),this.getNorth())},so.prototype.getSouthEast=function(){return new yn(this.getEast(),this.getSouth())},so.prototype.getWest=function(){return this._sw.lng},so.prototype.getSouth=function(){return this._sw.lat},so.prototype.getEast=function(){return this._ne.lng},so.prototype.getNorth=function(){return this._ne.lat},so.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},so.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},so.prototype.isEmpty=function(){return!(this._sw&&this._ne)},so.prototype.contains=function(e){var n=yn.convert(e),l=n.lng,v=n.lat,E=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(E=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=v&&v<=this._ne.lat&&E},so.convert=function(e){return!e||e instanceof so?e:new so(e)};var yn=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid LngLat object: ("+e+", "+n+")");if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};yn.prototype.wrap=function(){return new yn(ft(this.lng,-180,180),this.lat)},yn.prototype.toArray=function(){return[this.lng,this.lat]},yn.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},yn.prototype.distanceTo=function(e){var n=Math.PI/180,l=this.lat*n,v=e.lat*n,E=Math.sin(l)*Math.sin(v)+Math.cos(l)*Math.cos(v)*Math.cos((e.lng-this.lng)*n);return 63710088e-1*Math.acos(Math.min(E,1))},yn.prototype.toBounds=function(e){e===void 0&&(e=0);var n=360*e/40075017,l=n/Math.cos(Math.PI/180*this.lat);return new so(new yn(this.lng-l,this.lat-n),new yn(this.lng+l,this.lat+n))},yn.convert=function(e){if(e instanceof yn)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new yn(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new yn(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var yf=2*Math.PI*63710088e-1;function gf(e){return yf*Math.cos(e*Math.PI/180)}function xd(e){return(180+e)/360}function Un(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Gu(e,n){return e/gf(n)}function xp(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Zu=function(e,n,l){l===void 0&&(l=0),this.x=+e,this.y=+n,this.z=+l};Zu.fromLngLat=function(e,n){n===void 0&&(n=0);var l=yn.convert(e);return new Zu(xd(l.lng),Un(l.lat),Gu(n,l.lat))},Zu.prototype.toLngLat=function(){return new yn(360*this.x-180,xp(this.y))},Zu.prototype.toAltitude=function(){return this.z*gf(xp(this.y))},Zu.prototype.meterInMercatorCoordinateUnits=function(){return 1/yf*(e=xp(this.y),1/Math.cos(e*Math.PI/180));var e};var Hu=function(e,n,l){this.z=e,this.x=n,this.y=l,this.key=Sc(0,e,e,n,l)};Hu.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Hu.prototype.url=function(e,n){var l,v,E,C,i,t=(v=this.y,E=this.z,C=mf(256*(l=this.x),256*(v=Math.pow(2,E)-v-1),E),i=mf(256*(l+1),256*(v+1),E),C[0]+","+C[1]+","+i[0]+","+i[1]),a=function(h,_,b){for(var S,P="",R=h;R>0;R--)P+=(_&(S=1<<R-1)?1:0)+(b&S?2:0);return P}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",a).replace("{bbox-epsg-3857}",t)},Hu.prototype.getTilePoint=function(e){var n=Math.pow(2,this.z);return new U(8192*(e.x*n-this.x),8192*(e.y*n-this.y))},Hu.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var bd=function(e,n){this.wrap=e,this.canonical=n,this.key=Sc(e,n.z,n.z,n.x,n.y)},qn=function(e,n,l,v,E){this.overscaledZ=e,this.wrap=n,this.canonical=new Hu(l,+v,+E),this.key=Sc(n,e,l,v,E)};function Sc(e,n,l,v,E){(e*=2)<0&&(e=-1*e-1);var C=1<<l;return(C*C*e+C*E+v).toString(36)+l.toString(36)+n.toString(36)}qn.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},qn.prototype.scaledTo=function(e){var n=this.canonical.z-e;return e>this.canonical.z?new qn(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new qn(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)},qn.prototype.calculateScaledKey=function(e,n){var l=this.canonical.z-e;return e>this.canonical.z?Sc(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y):Sc(this.wrap*+n,e,e,this.canonical.x>>l,this.canonical.y>>l)},qn.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n},qn.prototype.children=function(e){if(this.overscaledZ>=e)return[new qn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var n=this.canonical.z+1,l=2*this.canonical.x,v=2*this.canonical.y;return[new qn(n,this.wrap,n,l,v),new qn(n,this.wrap,n,l+1,v),new qn(n,this.wrap,n,l,v+1),new qn(n,this.wrap,n,l+1,v+1)]},qn.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},qn.prototype.wrapped=function(){return new qn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},qn.prototype.unwrapTo=function(e){return new qn(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},qn.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},qn.prototype.toUnwrapped=function(){return new bd(this.wrap,this.canonical)},qn.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},qn.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Zu(e.x-this.wrap,e.y))},ui("CanonicalTileID",Hu),ui("OverscaledTileID",qn,{omit:["posMatrix"]});var Os=function(e,n,l){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return Ht('"'+l+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=n.height;var v=this.dim=n.height-2;this.data=new Uint32Array(n.data.buffer),this.encoding=l||"mapbox";for(var E=0;E<v;E++)this.data[this._idx(-1,E)]=this.data[this._idx(0,E)],this.data[this._idx(v,E)]=this.data[this._idx(v-1,E)],this.data[this._idx(E,-1)]=this.data[this._idx(E,0)],this.data[this._idx(E,v)]=this.data[this._idx(E,v-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(v,-1)]=this.data[this._idx(v-1,0)],this.data[this._idx(-1,v)]=this.data[this._idx(0,v-1)],this.data[this._idx(v,v)]=this.data[this._idx(v-1,v-1)]};Os.prototype.get=function(e,n){var l=new Uint8Array(this.data.buffer),v=4*this._idx(e,n);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(l[v],l[v+1],l[v+2])},Os.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Os.prototype._idx=function(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)},Os.prototype._unpackMapbox=function(e,n,l){return(256*e*256+256*n+l)/10-1e4},Os.prototype._unpackTerrarium=function(e,n,l){return 256*e+n+l/256-32768},Os.prototype.getPixels=function(){return new $o({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Os.prototype.backfillBorder=function(e,n,l){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var v=n*this.dim,E=n*this.dim+this.dim,C=l*this.dim,i=l*this.dim+this.dim;switch(n){case-1:v=E-1;break;case 1:E=v+1}switch(l){case-1:C=i-1;break;case 1:i=C+1}for(var t=-n*this.dim,a=-l*this.dim,h=C;h<i;h++)for(var _=v;_<E;_++)this.data[this._idx(_,h)]=e.data[this._idx(_+t,h+a)]},ui("DEMData",Os);var jh=function(e){this._stringToNumber={},this._numberToString=[];for(var n=0;n<e.length;n++){var l=e[n];this._stringToNumber[l]=n,this._numberToString[n]=l}};jh.prototype.encode=function(e){return this._stringToNumber[e]},jh.prototype.decode=function(e){return this._numberToString[e]};var sh=function(e,n,l,v,E){this.type="Feature",this._vectorTileFeature=e,e._z=n,e._x=l,e._y=v,this.properties=e.properties,this.id=E},bp={geometry:{configurable:!0}};bp.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},bp.geometry.set=function(e){this._geometry=e},sh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(e[n]=this[n]);return e},Object.defineProperties(sh.prototype,bp);var ma=function(){this.state={},this.stateChanges={},this.deletedStates={}};ma.prototype.updateState=function(e,n,l){var v=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][v]=this.stateChanges[e][v]||{},Ue(this.stateChanges[e][v],l),this.deletedStates[e]===null)for(var E in this.deletedStates[e]={},this.state[e])E!==v&&(this.deletedStates[e][E]=null);else if(this.deletedStates[e]&&this.deletedStates[e][v]===null)for(var C in this.deletedStates[e][v]={},this.state[e][v])l[C]||(this.deletedStates[e][v][C]=null);else for(var i in l)this.deletedStates[e]&&this.deletedStates[e][v]&&this.deletedStates[e][v][i]===null&&delete this.deletedStates[e][v][i]},ma.prototype.removeFeatureState=function(e,n,l){if(this.deletedStates[e]!==null){var v=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&n!==void 0)this.deletedStates[e][v]!==null&&(this.deletedStates[e][v]=this.deletedStates[e][v]||{},this.deletedStates[e][v][l]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][v])for(l in this.deletedStates[e][v]={},this.stateChanges[e][v])this.deletedStates[e][v][l]=null;else this.deletedStates[e][v]=null;else this.deletedStates[e]=null}},ma.prototype.getState=function(e,n){var l=String(n),v=Ue({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var E=this.deletedStates[e][n];if(E===null)return{};for(var C in E)delete v[C]}return v},ma.prototype.initializeTileState=function(e,n){e.setFeatureState(this.state,n)},ma.prototype.coalesceChanges=function(e,n){var l={};for(var v in this.stateChanges){this.state[v]=this.state[v]||{};var E={};for(var C in this.stateChanges[v])this.state[v][C]||(this.state[v][C]={}),Ue(this.state[v][C],this.stateChanges[v][C]),E[C]=this.state[v][C];l[v]=E}for(var i in this.deletedStates){this.state[i]=this.state[i]||{};var t={};if(this.deletedStates[i]===null)for(var a in this.state[i])t[a]={},this.state[i][a]={};else for(var h in this.deletedStates[i]){if(this.deletedStates[i][h]===null)this.state[i][h]={};else for(var _=0,b=Object.keys(this.deletedStates[i][h]);_<b.length;_+=1)delete this.state[i][h][b[_]];t[h]=this.state[i][h]}l[i]=l[i]||{},Ue(l[i],t)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(var S in e)e[S].setFeatureState(l,n)};var xs=function(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new fs(8192,16,0),this.grid3D=new fs(8192,16,0),this.featureIndexArray=new ie,this.promoteId=n};function wd(e,n,l,v,E){return xt(e,function(C,i){var t=n instanceof ys?n.get(i):null;return t&&t.evaluate?t.evaluate(l,v,E):t})}function Ed(e){for(var n=1/0,l=1/0,v=-1/0,E=-1/0,C=0,i=e;C<i.length;C+=1){var t=i[C];n=Math.min(n,t.x),l=Math.min(l,t.y),v=Math.max(v,t.x),E=Math.max(E,t.y)}return{minX:n,minY:l,maxX:v,maxY:E}}function _f(e,n){return n-e}xs.prototype.insert=function(e,n,l,v,E,C){var i=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,v,E);for(var t=C?this.grid3D:this.grid,a=0;a<n.length;a++){for(var h=n[a],_=[1/0,1/0,-1/0,-1/0],b=0;b<h.length;b++){var S=h[b];_[0]=Math.min(_[0],S.x),_[1]=Math.min(_[1],S.y),_[2]=Math.max(_[2],S.x),_[3]=Math.max(_[3],S.y)}_[0]<8192&&_[1]<8192&&_[2]>=0&&_[3]>=0&&t.insert(i,_[0],_[1],_[2],_[3])}},xs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Jc.VectorTile(new lp(this.rawTileData)).layers,this.sourceLayerCoder=new jh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},xs.prototype.query=function(e,n,l,v){var E=this;this.loadVTLayers();for(var C=e.params||{},i=8192/e.tileSize/e.scale,t=Ql(C.filter),a=e.queryGeometry,h=e.queryPadding*i,_=Ed(a),b=this.grid.query(_.minX-h,_.minY-h,_.maxX+h,_.maxY+h),S=Ed(e.cameraQueryGeometry),P=this.grid3D.query(S.minX-h,S.minY-h,S.maxX+h,S.maxY+h,function(Q,se,pe,ke){return function(Ne,Ze,He,it,We){for(var kt=0,At=Ne;kt<At.length;kt+=1){var pt=At[kt];if(Ze<=pt.x&&He<=pt.y&&it>=pt.x&&We>=pt.y)return!0}var Tt=[new U(Ze,He),new U(Ze,We),new U(it,We),new U(it,He)];if(Ne.length>2){for(var gt=0,Pt=Tt;gt<Pt.length;gt+=1)if(Rs(Ne,Pt[gt]))return!0}for(var mt=0;mt<Ne.length-1;mt++)if(ou(Ne[mt],Ne[mt+1],Tt))return!0;return!1}(e.cameraQueryGeometry,Q-h,se-h,pe+h,ke+h)}),R=0,O=P;R<O.length;R+=1)b.push(O[R]);b.sort(_f);for(var V,j={},K=function(Q){var se=b[Q];if(se!==V){V=se;var pe=E.featureIndexArray.get(se),ke=null;E.loadMatchingFeature(j,pe.bucketIndex,pe.sourceLayerIndex,pe.featureIndex,t,C.layers,C.availableImages,n,l,v,function(Ne,Ze,He){return ke||(ke=wn(Ne)),Ze.queryIntersectsFeature(a,Ne,He,ke,E.z,e.transform,i,e.pixelPosMatrix)})}},$=0;$<b.length;$++)K($);return j},xs.prototype.loadMatchingFeature=function(e,n,l,v,E,C,i,t,a,h,_){var b=this.bucketLayerIDs[n];if(!C||function(Ne,Ze){for(var He=0;He<Ne.length;He++)if(Ze.indexOf(Ne[He])>=0)return!0;return!1}(C,b)){var S=this.sourceLayerCoder.decode(l),P=this.vtLayers[S].feature(v);if(E.needGeometry){var R=hr(P,!0);if(!E.filter(new Vt(this.tileID.overscaledZ),R,this.tileID.canonical))return}else if(!E.filter(new Vt(this.tileID.overscaledZ),P))return;for(var O=this.getId(P,S),V=0;V<b.length;V++){var j=b[V];if(!(C&&C.indexOf(j)<0)){var K=t[j];if(K){var $={};O!==void 0&&h&&($=h.getState(K.sourceLayer||"_geojsonTileLayer",O));var Q=Ue({},a[j]);Q.paint=wd(Q.paint,K.paint,P,$,i),Q.layout=wd(Q.layout,K.layout,P,$,i);var se=!_||_(P,K,$);if(se){var pe=new sh(P,this.z,this.x,this.y,O);pe.layer=Q;var ke=e[j];ke===void 0&&(ke=e[j]=[]),ke.push({featureIndex:v,feature:pe,intersectionZ:se})}}}}}},xs.prototype.lookupSymbolFeatures=function(e,n,l,v,E,C,i,t){var a={};this.loadVTLayers();for(var h=Ql(E),_=0,b=e;_<b.length;_+=1)this.loadMatchingFeature(a,l,v,b[_],h,C,i,t,n);return a},xs.prototype.hasLayer=function(e){for(var n=0,l=this.bucketLayerIDs;n<l.length;n+=1)for(var v=0,E=l[n];v<E.length;v+=1)if(e===E[v])return!0;return!1},xs.prototype.getId=function(e,n){var l=e.id;return this.promoteId&&typeof(l=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]])=="boolean"&&(l=Number(l)),l},ui("FeatureIndex",xs,{omit:["rawTileData","sourceLayerCoder"]});var go=function(e,n){this.tileID=e,this.uid=st(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};go.prototype.registerFadeDuration=function(e){var n=e+this.timeAdded;n<or.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)},go.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},go.prototype.loadVectorData=function(e,n,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var v in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,_){var b={};if(!_)return b;for(var S=function(){var O=R[P],V=O.layerIds.map(function($){return _.getLayer($)}).filter(Boolean);if(V.length!==0){O.layers=V,O.stateDependentLayerIds&&(O.stateDependentLayers=O.stateDependentLayerIds.map(function($){return V.filter(function(Q){return Q.id===$})[0]}));for(var j=0,K=V;j<K.length;j+=1)b[K[j].id]=O}},P=0,R=h;P<R.length;P+=1)S();return b}(e.buckets,n.style),this.hasSymbolBuckets=!1,this.buckets){var E=this.buckets[v];if(E instanceof Hr){if(this.hasSymbolBuckets=!0,!l)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var C in this.buckets){var i=this.buckets[C];if(i instanceof Hr&&i.hasRTLText){this.hasRTLText=!0,ci.isLoading()||ci.isLoaded()||ba()!=="deferred"||Wo();break}}for(var t in this.queryPadding=0,this.buckets){var a=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(t).queryRadius(a))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new m},go.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},go.prototype.getBucket=function(e){return this.buckets[e.id]},go.prototype.upload=function(e){for(var n in this.buckets){var l=this.buckets[n];l.uploadPending()&&l.upload(e)}var v=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Vu(e,this.imageAtlas.image,v.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Vu(e,this.glyphAtlasImage,v.ALPHA),this.glyphAtlasImage=null)},go.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},go.prototype.queryRenderedFeatures=function(e,n,l,v,E,C,i,t,a,h){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:E,scale:C,tileSize:this.tileSize,pixelPosMatrix:h,transform:t,params:i,queryPadding:this.queryPadding*a},e,n,l):{}},go.prototype.querySourceFeatures=function(e,n){var l=this.latestFeatureIndex;if(l&&l.rawTileData){var v=l.loadVTLayers(),E=n?n.sourceLayer:"",C=v._geojsonTileLayer||v[E];if(C)for(var i=Ql(n&&n.filter),t=this.tileID.canonical,a=t.z,h=t.x,_=t.y,b={z:a,x:h,y:_},S=0;S<C.length;S++){var P=C.feature(S);if(i.needGeometry){var R=hr(P,!0);if(!i.filter(new Vt(this.tileID.overscaledZ),R,this.tileID.canonical))continue}else if(!i.filter(new Vt(this.tileID.overscaledZ),P))continue;var O=l.getId(P,E),V=new sh(P,a,h,_,O);V.tile=b,e.push(V)}}},go.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},go.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},go.prototype.setExpiryData=function(e){var n=this.expirationTime;if(e.cacheControl){var l=Fi(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var v=Date.now(),E=!1;if(this.expirationTime>v)E=!1;else if(n)if(this.expirationTime<n)E=!0;else{var C=this.expirationTime-n;C?this.expirationTime=v+Math.max(C,3e4):E=!0}else E=!0;E?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},go.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},go.prototype.setFeatureState=function(e,n){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var l=this.latestFeatureIndex.loadVTLayers();for(var v in this.buckets)if(n.style.hasLayer(v)){var E=this.buckets[v],C=E.layers[0].sourceLayer||"_geojsonTileLayer",i=l[C],t=e[C];if(i&&t&&Object.keys(t).length!==0){E.update(t,i,this.imageAtlas&&this.imageAtlas.patternPositions||{});var a=n&&n.style&&n.style.getLayer(v);a&&(this.queryPadding=Math.max(this.queryPadding,a.queryRadius(E)))}}}},go.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},go.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<or.now()},go.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},go.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=or.now()+e},go.prototype.setDependencies=function(e,n){for(var l={},v=0,E=n;v<E.length;v+=1)l[E[v]]=!0;this.dependencies[e]=l},go.prototype.hasDependency=function(e,n){for(var l=0,v=e;l<v.length;l+=1){var E=this.dependencies[v[l]];if(E){for(var C=0,i=n;C<i.length;C+=1)if(E[i[C]])return!0}}return!1};var fu=X.performance,Sd=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},fu.mark(this._marks.start)};Sd.prototype.finish=function(){fu.mark(this._marks.end);var e=fu.getEntriesByName(this._marks.measure);return e.length===0&&(fu.measure(this._marks.measure,this._marks.start,this._marks.end),e=fu.getEntriesByName(this._marks.measure),fu.clearMarks(this._marks.start),fu.clearMarks(this._marks.end),fu.clearMeasures(this._marks.measure)),e},f.Actor=qu,f.AlphaImage=fc,f.CanonicalTileID=Hu,f.CollisionBoxArray=m,f.Color=Ui,f.DEMData=Os,f.DataConstantProperty=Kt,f.DictionaryCoder=jh,f.EXTENT=8192,f.ErrorEvent=je,f.EvaluationParameters=Vt,f.Event=Ae,f.Evented=Ge,f.FeatureIndex=xs,f.FillBucket=al,f.FillExtrusionBucket=sl,f.ImageAtlas=Ph,f.ImagePosition=up,f.LineBucket=Qo,f.LngLat=yn,f.LngLatBounds=so,f.MercatorCoordinate=Zu,f.ONE_EM=24,f.OverscaledTileID=qn,f.Point=U,f.Point$1=U,f.Properties=T,f.Protobuf=lp,f.RGBAImage=$o,f.RequestManager=nr,f.RequestPerformance=Sd,f.ResourceType=ar,f.SegmentVector=de,f.SourceFeatureState=ma,f.StructArrayLayout1ui2=ni,f.StructArrayLayout2f1f2i16=nt,f.StructArrayLayout2i4=Z,f.StructArrayLayout3ui6=wt,f.StructArrayLayout4i8=J,f.SymbolBucket=Hr,f.Texture=Vu,f.Tile=go,f.Transitionable=Vn,f.Uniform1f=Ot,f.Uniform1i=It,f.Uniform2f=Rt,f.Uniform3f=ii,f.Uniform4f=gi,f.UniformColor=Ii,f.UniformMatrix4f=lr,f.UnwrappedTileID=bd,f.ValidationError=Me,f.WritingMode=Ja,f.ZoomHistory=Ka,f.add=function(e,n,l){return e[0]=n[0]+l[0],e[1]=n[1]+l[1],e[2]=n[2]+l[2],e},f.addDynamicAttributes=_d,f.asyncAll=function(e,n,l){if(!e.length)return l(null,[]);var v=e.length,E=new Array(e.length),C=null;e.forEach(function(i,t){n(i,function(a,h){a&&(C=a),E[t]=h,--v==0&&l(C,E)})})},f.bezier=ge,f.bindAll=at,f.browser=or,f.cacheEntryPossiblyAdded=function(e){++$r>wr&&(e.getActor().send("enforceCacheSizeLimit",fr),$r=0)},f.clamp=Le,f.clearTileCache=function(e){var n=X.caches.delete("mapbox-tiles");e&&n.catch(e).then(function(){return e()})},f.clipLine=gd,f.clone=function(e){var n=new Sr(16);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},f.clone$1=_i,f.clone$2=function(e){var n=new Sr(3);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n},f.collisionCircleLayout=Qd,f.config=Li,f.create=function(){var e=new Sr(16);return Sr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},f.create$1=function(){var e=new Sr(9);return Sr!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},f.create$2=function(){var e=new Sr(4);return Sr!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},f.createCommonjsModule=p,f.createExpression=Jl,f.createLayout=M,f.createStyleLayer=function(e){return e.type==="custom"?new vd(e):new ry[e.type](e)},f.cross=function(e,n,l){var v=n[0],E=n[1],C=n[2],i=l[0],t=l[1],a=l[2];return e[0]=E*a-C*t,e[1]=C*i-v*a,e[2]=v*t-E*i,e},f.deepEqual=function e(n,l){if(Array.isArray(n)){if(!Array.isArray(l)||n.length!==l.length)return!1;for(var v=0;v<n.length;v++)if(!e(n[v],l[v]))return!1;return!0}if(typeof n=="object"&&n!==null&&l!==null){if(typeof l!="object"||Object.keys(n).length!==Object.keys(l).length)return!1;for(var E in n)if(!e(n[E],l[E]))return!1;return!0}return n===l},f.dot=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]},f.dot$1=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3]},f.ease=De,f.emitValidationErrors=Sl,f.endsWith=$t,f.enforceCacheSizeLimit=function(e){Qn(),Nn&&Nn.then(function(n){n.keys().then(function(l){for(var v=0;v<l.length-e;v++)n.delete(l[v])})})},f.evaluateSizeForFeature=dd,f.evaluateSizeForZoom=fd,f.evaluateVariableOffset=Fh,f.evented=pc,f.extend=Ue,f.featureFilter=Ql,f.filterObject=qt,f.fromRotation=function(e,n){var l=Math.sin(n),v=Math.cos(n);return e[0]=v,e[1]=l,e[2]=0,e[3]=-l,e[4]=v,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},f.getAnchorAlignment=vc,f.getAnchorJustification=fp,f.getArrayBuffer=Uo,f.getImage=oe,f.getJSON=function(e,n){return _a(Ue(e,{type:"json"}),n)},f.getRTLTextPluginStatus=ba,f.getReferrer=Rn,f.getVideo=function(e,n){var l,v,E=X.document.createElement("video");E.muted=!0,E.onloadstart=function(){n(null,E)};for(var C=0;C<e.length;C++){var i=X.document.createElement("source");l=e[C],v=void 0,(v=X.document.createElement("a")).href=l,(v.protocol!==X.document.location.protocol||v.host!==X.document.location.host)&&(E.crossOrigin="Anonymous"),i.src=e[C],E.appendChild(i)}return{cancel:function(){}}},f.identity=Yo,f.invert=function(e,n){var l=n[0],v=n[1],E=n[2],C=n[3],i=n[4],t=n[5],a=n[6],h=n[7],_=n[8],b=n[9],S=n[10],P=n[11],R=n[12],O=n[13],V=n[14],j=n[15],K=l*t-v*i,$=l*a-E*i,Q=l*h-C*i,se=v*a-E*t,pe=v*h-C*t,ke=E*h-C*a,Ne=_*O-b*R,Ze=_*V-S*R,He=_*j-P*R,it=b*V-S*O,We=b*j-P*O,kt=S*j-P*V,At=K*kt-$*We+Q*it+se*He-pe*Ze+ke*Ne;return At?(e[0]=(t*kt-a*We+h*it)*(At=1/At),e[1]=(E*We-v*kt-C*it)*At,e[2]=(O*ke-V*pe+j*se)*At,e[3]=(S*pe-b*ke-P*se)*At,e[4]=(a*He-i*kt-h*Ze)*At,e[5]=(l*kt-E*He+C*Ze)*At,e[6]=(V*Q-R*ke-j*$)*At,e[7]=(_*ke-S*Q+P*$)*At,e[8]=(i*We-t*He+h*Ne)*At,e[9]=(v*He-l*We-C*Ne)*At,e[10]=(R*pe-O*Q+j*K)*At,e[11]=(b*Q-_*pe-P*K)*At,e[12]=(t*Ze-i*it-a*Ne)*At,e[13]=(l*it-v*Ze+E*Ne)*At,e[14]=(O*$-R*se-V*K)*At,e[15]=(_*se-b*$+S*K)*At,e):null},f.isChar=Wt,f.isMapboxURL=Pr,f.keysDifference=function(e,n){var l=[];for(var v in e)v in n||l.push(v);return l},f.makeRequest=_a,f.mapObject=xt,f.mercatorXfromLng=xd,f.mercatorYfromLat=Un,f.mercatorZfromAltitude=Gu,f.mul=Bu,f.multiply=fa,f.mvt=Jc,f.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},f.normalize=function(e,n){var l=n[0],v=n[1],E=n[2],C=l*l+v*v+E*E;return C>0&&(C=1/Math.sqrt(C)),e[0]=n[0]*C,e[1]=n[1]*C,e[2]=n[2]*C,e},f.number=Tn,f.offscreenCanvasSupported=Jt,f.ortho=function(e,n,l,v,E,C,i){var t=1/(n-l),a=1/(v-E),h=1/(C-i);return e[0]=-2*t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*h,e[11]=0,e[12]=(n+l)*t,e[13]=(E+v)*a,e[14]=(i+C)*h,e[15]=1,e},f.parseGlyphPBF=function(e){return new lp(e).readFields(qm,[])},f.pbf=lp,f.performSymbolLayout=function(e,n,l,v,E,C,i){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var t=e.layers[0].layout,a=e.layers[0]._unevaluatedLayout._values,h={};if(e.textSizeData.kind==="composite"){var _=e.textSizeData,b=_.maxZoom;h.compositeTextSizes=[a["text-size"].possiblyEvaluate(new Vt(_.minZoom),i),a["text-size"].possiblyEvaluate(new Vt(b),i)]}if(e.iconSizeData.kind==="composite"){var S=e.iconSizeData,P=S.maxZoom;h.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new Vt(S.minZoom),i),a["icon-size"].possiblyEvaluate(new Vt(P),i)]}h.layoutTextSize=a["text-size"].possiblyEvaluate(new Vt(e.zoom+1),i),h.layoutIconSize=a["icon-size"].possiblyEvaluate(new Vt(e.zoom+1),i),h.textMaxSize=a["text-size"].possiblyEvaluate(new Vt(18));for(var R=24*t.get("text-line-height"),O=t.get("text-rotation-alignment")==="map"&&t.get("symbol-placement")!=="point",V=t.get("text-keep-upright"),j=t.get("text-size"),K=function(){var se=Q[$],pe=t.get("text-font").evaluate(se,{},i).join(","),ke=j.evaluate(se,{},i),Ne=h.layoutTextSize.evaluate(se,{},i),Ze=h.layoutIconSize.evaluate(se,{},i),He={horizontal:{},vertical:void 0},it=se.text,We=[0,0];if(it){var kt=it.toString(),At=24*t.get("text-letter-spacing").evaluate(se,{},i),pt=function(Vi){for(var Ki=0,er=Vi;Ki<er.length;Ki+=1)if(Hi=er[Ki].charCodeAt(0),Wt.Arabic(Hi)||Wt["Arabic Supplement"](Hi)||Wt["Arabic Extended-A"](Hi)||Wt["Arabic Presentation Forms-A"](Hi)||Wt["Arabic Presentation Forms-B"](Hi))return!1;var Hi;return!0}(kt)?At:0,Tt=t.get("text-anchor").evaluate(se,{},i),gt=t.get("text-variable-anchor");if(!gt){var Pt=t.get("text-radial-offset").evaluate(se,{},i);We=Pt?Fh(Tt,[24*Pt,dp]):t.get("text-offset").evaluate(se,{},i).map(function(Vi){return 24*Vi})}var mt=O?"center":t.get("text-justify").evaluate(se,{},i),vt=t.get("symbol-placement"),oi=vt==="point"?24*t.get("text-max-width").evaluate(se,{},i):0,ri=function(){e.allowVerticalPlacement&&tu(kt)&&(He.vertical=Mh(it,n,l,E,pe,oi,R,Tt,"left",pt,We,Ja.vertical,!0,vt,Ne,ke))};if(!O&&gt){for(var Mi=mt==="auto"?gt.map(function(Vi){return fp(Vi)}):[mt],Bi=!1,Qi=0;Qi<Mi.length;Qi++){var ur=Mi[Qi];if(!He.horizontal[ur])if(Bi)He.horizontal[ur]=He.horizontal[0];else{var kr=Mh(it,n,l,E,pe,oi,R,"center",ur,pt,We,Ja.horizontal,!1,vt,Ne,ke);kr&&(He.horizontal[ur]=kr,Bi=kr.positionedLines.length===1)}}ri()}else{mt==="auto"&&(mt=fp(Tt));var zr=Mh(it,n,l,E,pe,oi,R,Tt,mt,pt,We,Ja.horizontal,!1,vt,Ne,ke);zr&&(He.horizontal[mt]=zr),ri(),tu(kt)&&O&&V&&(He.vertical=Mh(it,n,l,E,pe,oi,R,Tt,mt,pt,We,Ja.vertical,!1,vt,Ne,ke))}}var xr=void 0,Br=!1;if(se.icon&&se.icon.name){var br=v[se.icon.name];br&&(xr=function(Vi,Ki,er){var Hi=vc(er),on=Ki[0]-Vi.displaySize[0]*Hi.horizontalAlign,en=Ki[1]-Vi.displaySize[1]*Hi.verticalAlign;return{image:Vi,top:en,bottom:en+Vi.displaySize[1],left:on,right:on+Vi.displaySize[0]}}(E[se.icon.name],t.get("icon-offset").evaluate(se,{},i),t.get("icon-anchor").evaluate(se,{},i)),Br=br.sdf,e.sdfIcons===void 0?e.sdfIcons=br.sdf:e.sdfIcons!==br.sdf&&Ht("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(br.pixelRatio!==e.pixelRatio||t.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Or=Nh(He.horizontal)||He.vertical;e.iconsInText=!!Or&&Or.iconsInText,(Or||xr)&&function(Vi,Ki,er,Hi,on,en,dr,sr,Lr,fi,lo){var cn=en.textMaxSize.evaluate(Ki,{});cn===void 0&&(cn=dr);var Mn,Wr=Vi.layers[0].layout,Ro=Wr.get("icon-offset").evaluate(Ki,{},lo),_o=Nh(er.horizontal),Ya=dr/24,ea=Vi.tilePixelRatio*Ya,ta=Vi.tilePixelRatio*cn/24,uo=Vi.tilePixelRatio*sr,$a=Vi.tilePixelRatio*Wr.get("symbol-spacing"),Wu=Wr.get("text-padding")*Vi.tilePixelRatio,Ic=Wr.get("icon-padding")*Vi.tilePixelRatio,Tc=Wr.get("text-max-angle")/180*Math.PI,lh=Wr.get("text-rotation-alignment")==="map"&&Wr.get("symbol-placement")!=="point",Fs=Wr.get("icon-rotation-alignment")==="map"&&Wr.get("symbol-placement")!=="point",Ml=Wr.get("symbol-placement"),Ac=$a/2,Xu=Wr.get("icon-text-fit");Hi&&Xu!=="none"&&(Vi.allowVerticalPlacement&&er.vertical&&(Mn=Lh(Hi,er.vertical,Xu,Wr.get("icon-text-fit-padding"),Ro,Ya)),_o&&(Hi=Lh(Hi,_o,Xu,Wr.get("icon-text-fit-padding"),Ro,Ya)));var mu=function(Y0,Id){Id.x<0||Id.x>=8192||Id.y<0||Id.y>=8192||function(co,gu,$0,hh,sy,Ng,vf,Ku,xf,Td,bf,wf,ly,jg,Ad,Vg,qg,Gg,Zg,Hg,Ns,Ef,Wg,Ju,Q0){var Xg,Hh,Ip,Tp,Ap,Cp=co.addToLineVertexArray(gu,$0),Kg=0,Jg=0,Yg=0,$g=0,uy=-1,cy=-1,zc={},Qg=be(""),hy=0,py=0;if(Ku._unevaluatedLayout.getValue("text-radial-offset")===void 0?(hy=(Xg=Ku.layout.get("text-offset").evaluate(Ns,{},Ju).map(function(kd){return 24*kd}))[0],py=Xg[1]):(hy=24*Ku.layout.get("text-radial-offset").evaluate(Ns,{},Ju),py=dp),co.allowVerticalPlacement&&hh.vertical){var e_=Ku.layout.get("text-rotate").evaluate(Ns,{},Ju)+90;Tp=new Oh(xf,gu,Td,bf,wf,hh.vertical,ly,jg,Ad,e_),vf&&(Ap=new Oh(xf,gu,Td,bf,wf,vf,qg,Gg,Ad,e_))}if(sy){var dy=Ku.layout.get("icon-rotate").evaluate(Ns,{}),t_=Ku.layout.get("icon-text-fit")!=="none",i_=zl(sy,dy,Wg,t_),fy=vf?zl(vf,dy,Wg,t_):void 0;Ip=new Oh(xf,gu,Td,bf,wf,sy,qg,Gg,!1,dy),Kg=4*i_.length;var r_=co.iconSizeData,Cd=null;r_.kind==="source"?(Cd=[128*Ku.layout.get("icon-size").evaluate(Ns,{})])[0]>32640&&Ht(co.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):r_.kind==="composite"&&((Cd=[128*Ef.compositeIconSizes[0].evaluate(Ns,{},Ju),128*Ef.compositeIconSizes[1].evaluate(Ns,{},Ju)])[0]>32640||Cd[1]>32640)&&Ht(co.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),co.addSymbols(co.icon,i_,Cd,Hg,Zg,Ns,!1,gu,Cp.lineStartIndex,Cp.lineLength,-1,Ju),uy=co.icon.placedSymbolArray.length-1,fy&&(Jg=4*fy.length,co.addSymbols(co.icon,fy,Cd,Hg,Zg,Ns,Ja.vertical,gu,Cp.lineStartIndex,Cp.lineLength,-1,Ju),cy=co.icon.placedSymbolArray.length-1)}for(var n_ in hh.horizontal){var Sf=hh.horizontal[n_];if(!Hh){Qg=be(Sf.text);var ex=Ku.layout.get("text-rotate").evaluate(Ns,{},Ju);Hh=new Oh(xf,gu,Td,bf,wf,Sf,ly,jg,Ad,ex)}var o_=Sf.positionedLines.length===1;if(Yg+=Uh(co,gu,Sf,Ng,Ku,Ad,Ns,Vg,Cp,hh.vertical?Ja.horizontal:Ja.horizontalOnly,o_?Object.keys(hh.horizontal):[n_],zc,uy,Ef,Ju),o_)break}hh.vertical&&($g+=Uh(co,gu,hh.vertical,Ng,Ku,Ad,Ns,Vg,Cp,Ja.vertical,["vertical"],zc,cy,Ef,Ju));var tx=Hh?Hh.boxStartIndex:co.collisionBoxArray.length,ix=Hh?Hh.boxEndIndex:co.collisionBoxArray.length,rx=Tp?Tp.boxStartIndex:co.collisionBoxArray.length,nx=Tp?Tp.boxEndIndex:co.collisionBoxArray.length,ox=Ip?Ip.boxStartIndex:co.collisionBoxArray.length,ax=Ip?Ip.boxEndIndex:co.collisionBoxArray.length,sx=Ap?Ap.boxStartIndex:co.collisionBoxArray.length,lx=Ap?Ap.boxEndIndex:co.collisionBoxArray.length,Yu=-1,If=function(kd,s_){return kd&&kd.circleDiameter?Math.max(kd.circleDiameter,s_):s_};Yu=If(Hh,Yu),Yu=If(Tp,Yu),Yu=If(Ip,Yu);var a_=(Yu=If(Ap,Yu))>-1?1:0;a_&&(Yu*=Q0/24),co.glyphOffsetArray.length>=Hr.MAX_GLYPHS&&Ht("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ns.sortKey!==void 0&&co.addToSortKeyRanges(co.symbolInstances.length,Ns.sortKey),co.symbolInstances.emplaceBack(gu.x,gu.y,zc.right>=0?zc.right:-1,zc.center>=0?zc.center:-1,zc.left>=0?zc.left:-1,zc.vertical||-1,uy,cy,Qg,tx,ix,rx,nx,ox,ax,sx,lx,Td,Yg,$g,Kg,Jg,a_,0,ly,hy,py,Yu)}(Vi,Id,Y0,er,Hi,on,Mn,Vi.layers[0],Vi.collisionBoxArray,Ki.index,Ki.sourceLayerIndex,Vi.index,ea,Wu,lh,Lr,uo,Ic,Fs,Ro,Ki,en,fi,lo,dr)};if(Ml==="line")for(var uh=0,wp=gd(Ki.geometry,0,0,8192,8192);uh<wp.length;uh+=1)for(var Ep=wp[uh],Vh=0,qh=Xm(Ep,$a,Tc,er.vertical||_o,Hi,24,ta,Vi.overscaling,8192);Vh<qh.length;Vh+=1){var Sp=qh[Vh];_o&&mp(Vi,_o.text,Ac,Sp)||mu(Ep,Sp)}else if(Ml==="line-center")for(var Gh=0,Zh=Ki.geometry;Gh<Zh.length;Gh+=1){var Da=Zh[Gh];if(Da.length>1){var Cc=Wm(Da,Tc,er.vertical||_o,Hi,24,ta);Cc&&mu(Da,Cc)}}else if(Ki.type==="Polygon")for(var kc=0,ia=ap(Ki.geometry,0);kc<ia.length;kc+=1){var Ra=ia[kc],yu=Jm(Ra,16);mu(Ra[0],new pu(yu.x,yu.y,0))}else if(Ki.type==="LineString")for(var ll=0,ch=Ki.geometry;ll<ch.length;ll+=1){var Us=ch[ll];mu(Us,new pu(Us[0].x,Us[0].y,0))}else if(Ki.type==="Point")for(var ny=0,Fg=Ki.geometry;ny<Fg.length;ny+=1)for(var oy=0,Ug=Fg[ny];oy<Ug.length;oy+=1){var ay=Ug[oy];mu([ay],new pu(ay.x,ay.y,0))}}(e,se,He,xr,v,h,Ne,Ze,We,Br,i)},$=0,Q=e.features;$<Q.length;$+=1)K();C&&e.generateCollisionDebugBuffers()},f.perspective=function(e,n,l,v,E){var C,i=1/Math.tan(n/2);return e[0]=i/l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,E!=null&&E!==1/0?(e[10]=(E+v)*(C=1/(v-E)),e[14]=2*E*v*C):(e[10]=-1,e[14]=-2*v),e},f.pick=function(e,n){for(var l={},v=0;v<n.length;v++){var E=n[v];E in e&&(l[E]=e[E])}return l},f.plugin=ci,f.polygonIntersectsPolygon=wa,f.postMapLoadEvent=Ci,f.postTurnstileEvent=qe,f.potpack=cf,f.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],f.register=ui,f.registerForPluginStateChange=function(e){return e({pluginStatus:Io,pluginURL:Ma}),pc.on("pluginStateChange",e),e},f.renderColorRamp=op,f.rotate=function(e,n,l){var v=n[0],E=n[1],C=n[2],i=n[3],t=Math.sin(l),a=Math.cos(l);return e[0]=v*a+C*t,e[1]=E*a+i*t,e[2]=v*-t+C*a,e[3]=E*-t+i*a,e},f.rotateX=function(e,n,l){var v=Math.sin(l),E=Math.cos(l),C=n[4],i=n[5],t=n[6],a=n[7],h=n[8],_=n[9],b=n[10],S=n[11];return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=C*E+h*v,e[5]=i*E+_*v,e[6]=t*E+b*v,e[7]=a*E+S*v,e[8]=h*E-C*v,e[9]=_*E-i*v,e[10]=b*E-t*v,e[11]=S*E-a*v,e},f.rotateZ=function(e,n,l){var v=Math.sin(l),E=Math.cos(l),C=n[0],i=n[1],t=n[2],a=n[3],h=n[4],_=n[5],b=n[6],S=n[7];return n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=C*E+h*v,e[1]=i*E+_*v,e[2]=t*E+b*v,e[3]=a*E+S*v,e[4]=h*E-C*v,e[5]=_*E-i*v,e[6]=b*E-t*v,e[7]=S*E-a*v,e},f.scale=function(e,n,l){var v=l[0],E=l[1],C=l[2];return e[0]=n[0]*v,e[1]=n[1]*v,e[2]=n[2]*v,e[3]=n[3]*v,e[4]=n[4]*E,e[5]=n[5]*E,e[6]=n[6]*E,e[7]=n[7]*E,e[8]=n[8]*C,e[9]=n[9]*C,e[10]=n[10]*C,e[11]=n[11]*C,e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},f.scale$1=function(e,n,l){return e[0]=n[0]*l,e[1]=n[1]*l,e[2]=n[2]*l,e[3]=n[3]*l,e},f.scale$2=function(e,n,l){return e[0]=n[0]*l,e[1]=n[1]*l,e[2]=n[2]*l,e},f.setCacheLimits=function(e,n){fr=e,wr=n},f.setRTLTextPlugin=function(e,n,l){if(l===void 0&&(l=!1),Io==="deferred"||Io==="loading"||Io==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Ma=or.resolveURL(e),Io="deferred",il=n,Al(),l||Wo()},f.sphericalToCartesian=function(e){var n=e[0],l=e[1],v=e[2];return l+=90,l*=Math.PI/180,v*=Math.PI/180,{x:n*Math.cos(l)*Math.sin(v),y:n*Math.sin(l)*Math.sin(v),z:n*Math.cos(v)}},f.sqrLen=function(e){var n=e[0],l=e[1];return n*n+l*l},f.styleSpec=ye,f.sub=function(e,n,l){return e[0]=n[0]-l[0],e[1]=n[1]-l[1],e[2]=n[2]-l[2],e},f.symbolSize=Hm,f.transformMat3=function(e,n,l){var v=n[0],E=n[1],C=n[2];return e[0]=v*l[0]+E*l[3]+C*l[6],e[1]=v*l[1]+E*l[4]+C*l[7],e[2]=v*l[2]+E*l[5]+C*l[8],e},f.transformMat4=Ou,f.translate=function(e,n,l){var v,E,C,i,t,a,h,_,b,S,P,R,O=l[0],V=l[1],j=l[2];return n===e?(e[12]=n[0]*O+n[4]*V+n[8]*j+n[12],e[13]=n[1]*O+n[5]*V+n[9]*j+n[13],e[14]=n[2]*O+n[6]*V+n[10]*j+n[14],e[15]=n[3]*O+n[7]*V+n[11]*j+n[15]):(E=n[1],C=n[2],i=n[3],t=n[4],a=n[5],h=n[6],_=n[7],b=n[8],S=n[9],P=n[10],R=n[11],e[0]=v=n[0],e[1]=E,e[2]=C,e[3]=i,e[4]=t,e[5]=a,e[6]=h,e[7]=_,e[8]=b,e[9]=S,e[10]=P,e[11]=R,e[12]=v*O+t*V+b*j+n[12],e[13]=E*O+a*V+S*j+n[13],e[14]=C*O+h*V+P*j+n[14],e[15]=i*O+_*V+R*j+n[15]),e},f.triggerPluginCompletionEvent=hc,f.uniqueId=st,f.validateCustomStyleLayer=function(e){var n=[],l=e.id;return l===void 0&&n.push({message:"layers."+l+': missing required property "id"'}),e.render===void 0&&n.push({message:"layers."+l+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&n.push({message:"layers."+l+': property "renderingMode" must be either "2d" or "3d"'}),n},f.validateLight=eu,f.validateStyle=Pa,f.values=function(e){var n=[];for(var l in e)n.push(e[l]);return n},f.vectorTile=Jc,f.version="1.13.2",f.warnOnce=Ht,f.webpSupported=Mt,f.window=X,f.wrap=ft}),z(["./shared"],function(f){function p(te){var oe=typeof te;if(oe==="number"||oe==="boolean"||oe==="string"||te==null)return JSON.stringify(te);if(Array.isArray(te)){for(var le="[",_e=0,Ae=te;_e<Ae.length;_e+=1)le+=p(Ae[_e])+",";return le+"]"}for(var je=Object.keys(te).sort(),Ge="{",ye=0;ye<je.length;ye++)Ge+=JSON.stringify(je[ye])+":"+p(te[je[ye]])+",";return Ge+"}"}function L(te){for(var oe="",le=0,_e=f.refProperties;le<_e.length;le+=1)oe+="/"+p(te[_e[le]]);return oe}var N=function(te){this.keyCache={},te&&this.replace(te)};N.prototype.replace=function(te){this._layerConfigs={},this._layers={},this.update(te,[])},N.prototype.update=function(te,oe){for(var le=this,_e=0,Ae=te;_e<Ae.length;_e+=1){var je=Ae[_e];this._layerConfigs[je.id]=je;var Ge=this._layers[je.id]=f.createStyleLayer(je);Ge._featureFilter=f.featureFilter(Ge.filter),this.keyCache[je.id]&&delete this.keyCache[je.id]}for(var ye=0,Me=oe;ye<Me.length;ye+=1){var Qe=Me[ye];delete this.keyCache[Qe],delete this._layerConfigs[Qe],delete this._layers[Qe]}this.familiesBySource={};for(var ae=0,H=function(Ee,Te){for(var et={},Ke=0;Ke<Ee.length;Ke++){var tt=Te&&Te[Ee[Ke].id]||L(Ee[Ke]);Te&&(Te[Ee[Ke].id]=tt);var jt=et[tt];jt||(jt=et[tt]=[]),jt.push(Ee[Ke])}var Ct=[];for(var Ut in et)Ct.push(et[Ut]);return Ct}(f.values(this._layerConfigs),this.keyCache);ae<H.length;ae+=1){var W=H[ae].map(function(Ee){return le._layers[Ee.id]}),ne=W[0];if(ne.visibility!=="none"){var ce=ne.source||"",ve=this.familiesBySource[ce];ve||(ve=this.familiesBySource[ce]={});var fe=ne.sourceLayer||"_geojsonTileLayer",Ie=ve[fe];Ie||(Ie=ve[fe]=[]),Ie.push(W)}}};var U=function(te){var oe={},le=[];for(var _e in te){var Ae=te[_e],je=oe[_e]={};for(var Ge in Ae){var ye=Ae[+Ge];if(ye&&ye.bitmap.width!==0&&ye.bitmap.height!==0){var Me={x:0,y:0,w:ye.bitmap.width+2,h:ye.bitmap.height+2};le.push(Me),je[Ge]={rect:Me,metrics:ye.metrics}}}}var Qe=f.potpack(le),ae=new f.AlphaImage({width:Qe.w||1,height:Qe.h||1});for(var H in te){var W=te[H];for(var ne in W){var ce=W[+ne];if(ce&&ce.bitmap.width!==0&&ce.bitmap.height!==0){var ve=oe[H][ne].rect;f.AlphaImage.copy(ce.bitmap,ae,{x:0,y:0},{x:ve.x+1,y:ve.y+1},ce.bitmap)}}}this.image=ae,this.positions=oe};f.register("GlyphAtlas",U);var G=function(te){this.tileID=new f.OverscaledTileID(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.uid=te.uid,this.zoom=te.zoom,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.collectResourceTiming,this.returnDependencies=!!te.returnDependencies,this.promoteId=te.promoteId};function X(te,oe,le){for(var _e=new f.EvaluationParameters(oe),Ae=0,je=te;Ae<je.length;Ae+=1)je[Ae].recalculate(_e,le)}function Se(te,oe){var le=f.getArrayBuffer(te.request,function(_e,Ae,je,Ge){_e?oe(_e):Ae&&oe(null,{vectorTile:new f.vectorTile.VectorTile(new f.pbf(Ae)),rawData:Ae,cacheControl:je,expires:Ge})});return function(){le.cancel(),oe()}}G.prototype.parse=function(te,oe,le,_e,Ae){var je=this;this.status="parsing",this.data=te,this.collisionBoxArray=new f.CollisionBoxArray;var Ge=new f.DictionaryCoder(Object.keys(te.layers).sort()),ye=new f.FeatureIndex(this.tileID,this.promoteId);ye.bucketLayerIDs=[];var Me,Qe,ae,H,W={},ne={featureIndex:ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:le},ce=oe.familiesBySource[this.source];for(var ve in ce){var fe=te.layers[ve];if(fe){fe.version===1&&f.warnOnce('Vector tile source "'+this.source+'" layer "'+ve+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ie=Ge.encode(ve),Ee=[],Te=0;Te<fe.length;Te++){var et=fe.feature(Te),Ke=ye.getId(et,ve);Ee.push({feature:et,id:Ke,index:Te,sourceLayerIndex:Ie})}for(var tt=0,jt=ce[ve];tt<jt.length;tt+=1){var Ct=jt[tt],Ut=Ct[0];Ut.minzoom&&this.zoom<Math.floor(Ut.minzoom)||Ut.maxzoom&&this.zoom>=Ut.maxzoom||Ut.visibility!=="none"&&(X(Ct,this.zoom,le),(W[Ut.id]=Ut.createBucket({index:ye.bucketLayerIDs.length,layers:Ct,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ie,sourceID:this.source})).populate(Ee,ne,this.tileID.canonical),ye.bucketLayerIDs.push(Ct.map(function(di){return di.id})))}}}var Zt=f.mapObject(ne.glyphDependencies,function(di){return Object.keys(di).map(Number)});Object.keys(Zt).length?_e.send("getGlyphs",{uid:this.uid,stacks:Zt},function(di,ei){Me||(Me=di,Qe=ei,Pi.call(je))}):Qe={};var Xi=Object.keys(ne.iconDependencies);Xi.length?_e.send("getImages",{icons:Xi,source:this.source,tileID:this.tileID,type:"icons"},function(di,ei){Me||(Me=di,ae=ei,Pi.call(je))}):ae={};var vi=Object.keys(ne.patternDependencies);function Pi(){if(Me)return Ae(Me);if(Qe&&ae&&H){var di=new U(Qe),ei=new f.ImageAtlas(ae,H);for(var Ui in W){var Ir=W[Ui];Ir instanceof f.SymbolBucket?(X(Ir.layers,this.zoom,le),f.performSymbolLayout(Ir,Qe,di.positions,ae,ei.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Ir.hasPattern&&(Ir instanceof f.LineBucket||Ir instanceof f.FillBucket||Ir instanceof f.FillExtrusionBucket)&&(X(Ir.layers,this.zoom,le),Ir.addFeatures(ne,this.tileID.canonical,ei.patternPositions))}this.status="done",Ae(null,{buckets:f.values(W).filter(function(kn){return!kn.isEmpty()}),featureIndex:ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:di.image,imageAtlas:ei,glyphMap:this.returnDependencies?Qe:null,iconMap:this.returnDependencies?ae:null,glyphPositions:this.returnDependencies?di.positions:null})}}vi.length?_e.send("getImages",{icons:vi,source:this.source,tileID:this.tileID,type:"patterns"},function(di,ei){Me||(Me=di,H=ei,Pi.call(je))}):H={},Pi.call(this)};var ge=function(te,oe,le,_e){this.actor=te,this.layerIndex=oe,this.availableImages=le,this.loadVectorData=_e||Se,this.loading={},this.loaded={}};ge.prototype.loadTile=function(te,oe){var le=this,_e=te.uid;this.loading||(this.loading={});var Ae=!!(te&&te.request&&te.request.collectResourceTiming)&&new f.RequestPerformance(te.request),je=this.loading[_e]=new G(te);je.abort=this.loadVectorData(te,function(Ge,ye){if(delete le.loading[_e],Ge||!ye)return je.status="done",le.loaded[_e]=je,oe(Ge);var Me=ye.rawData,Qe={};ye.expires&&(Qe.expires=ye.expires),ye.cacheControl&&(Qe.cacheControl=ye.cacheControl);var ae={};if(Ae){var H=Ae.finish();H&&(ae.resourceTiming=JSON.parse(JSON.stringify(H)))}je.vectorTile=ye.vectorTile,je.parse(ye.vectorTile,le.layerIndex,le.availableImages,le.actor,function(W,ne){if(W||!ne)return oe(W);oe(null,f.extend({rawTileData:Me.slice(0)},ne,Qe,ae))}),le.loaded=le.loaded||{},le.loaded[_e]=je})},ge.prototype.reloadTile=function(te,oe){var le=this,_e=this.loaded,Ae=te.uid,je=this;if(_e&&_e[Ae]){var Ge=_e[Ae];Ge.showCollisionBoxes=te.showCollisionBoxes;var ye=function(Me,Qe){var ae=Ge.reloadCallback;ae&&(delete Ge.reloadCallback,Ge.parse(Ge.vectorTile,je.layerIndex,le.availableImages,je.actor,ae)),oe(Me,Qe)};Ge.status==="parsing"?Ge.reloadCallback=ye:Ge.status==="done"&&(Ge.vectorTile?Ge.parse(Ge.vectorTile,this.layerIndex,this.availableImages,this.actor,ye):ye())}},ge.prototype.abortTile=function(te,oe){var le=this.loading,_e=te.uid;le&&le[_e]&&le[_e].abort&&(le[_e].abort(),delete le[_e]),oe()},ge.prototype.removeTile=function(te,oe){var le=this.loaded,_e=te.uid;le&&le[_e]&&delete le[_e],oe()};var De=f.window.ImageBitmap,Le=function(){this.loaded={}};function ft(te,oe){if(te.length!==0){Ue(te[0],oe);for(var le=1;le<te.length;le++)Ue(te[le],!oe)}}function Ue(te,oe){for(var le=0,_e=0,Ae=te.length,je=Ae-1;_e<Ae;je=_e++)le+=(te[_e][0]-te[je][0])*(te[je][1]+te[_e][1]);le>=0!=!!oe&&te.reverse()}Le.prototype.loadTile=function(te,oe){var le=te.uid,_e=te.encoding,Ae=te.rawImageData,je=De&&Ae instanceof De?this.getImageData(Ae):Ae,Ge=new f.DEMData(le,je,_e);this.loaded=this.loaded||{},this.loaded[le]=Ge,oe(null,Ge)},Le.prototype.getImageData=function(te){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(te.width,te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=te.width,this.offscreenCanvas.height=te.height,this.offscreenCanvasContext.drawImage(te,0,0,te.width,te.height);var oe=this.offscreenCanvasContext.getImageData(-1,-1,te.width+2,te.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new f.RGBAImage({width:oe.width,height:oe.height},oe.data)},Le.prototype.removeTile=function(te){var oe=this.loaded,le=te.uid;oe&&oe[le]&&delete oe[le]};var Re=f.vectorTile.VectorTileFeature.prototype.toGeoJSON,st=function(te){this._feature=te,this.extent=f.EXTENT,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))};st.prototype.loadGeometry=function(){if(this._feature.type===1){for(var te=[],oe=0,le=this._feature.geometry;oe<le.length;oe+=1){var _e=le[oe];te.push([new f.Point$1(_e[0],_e[1])])}return te}for(var Ae=[],je=0,Ge=this._feature.geometry;je<Ge.length;je+=1){for(var ye=[],Me=0,Qe=Ge[je];Me<Qe.length;Me+=1){var ae=Qe[Me];ye.push(new f.Point$1(ae[0],ae[1]))}Ae.push(ye)}return Ae},st.prototype.toGeoJSON=function(te,oe,le){return Re.call(this,te,oe,le)};var ut=function(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.EXTENT,this.length=te.length,this._features=te};ut.prototype.feature=function(te){return new st(this._features[te])};var ht=f.vectorTile.VectorTileFeature,at=$t;function $t(te,oe){this.options=oe||{},this.features=te,this.length=te.length}function xt(te,oe){this.id=typeof te.id=="number"?te.id:void 0,this.type=te.type,this.rawGeometry=te.type===1?[te.geometry]:te.geometry,this.properties=te.tags,this.extent=oe||4096}$t.prototype.feature=function(te){return new xt(this.features[te],this.options.extent)},xt.prototype.loadGeometry=function(){var te=this.rawGeometry;this.geometry=[];for(var oe=0;oe<te.length;oe++){for(var le=te[oe],_e=[],Ae=0;Ae<le.length;Ae++)_e.push(new f.Point$1(le[Ae][0],le[Ae][1]));this.geometry.push(_e)}return this.geometry},xt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var te=this.geometry,oe=1/0,le=-1/0,_e=1/0,Ae=-1/0,je=0;je<te.length;je++)for(var Ge=te[je],ye=0;ye<Ge.length;ye++){var Me=Ge[ye];oe=Math.min(oe,Me.x),le=Math.max(le,Me.x),_e=Math.min(_e,Me.y),Ae=Math.max(Ae,Me.y)}return[oe,_e,le,Ae]},xt.prototype.toGeoJSON=ht.prototype.toGeoJSON;var qt=Ri,_i=at;function Ri(te){var oe=new f.pbf;return function(le,_e){for(var Ae in le.layers)_e.writeMessage(3,Ht,le.layers[Ae])}(te,oe),oe.finish()}function Ht(te,oe){var le;oe.writeVarintField(15,te.version||1),oe.writeStringField(1,te.name||""),oe.writeVarintField(5,te.extent||4096);var _e={keys:[],values:[],keycache:{},valuecache:{}};for(le=0;le<te.length;le++)_e.feature=te.feature(le),oe.writeMessage(2,Qt,_e);var Ae=_e.keys;for(le=0;le<Ae.length;le++)oe.writeStringField(3,Ae[le]);var je=_e.values;for(le=0;le<je.length;le++)oe.writeMessage(4,bi,je[le])}function Qt(te,oe){var le=te.feature;le.id!==void 0&&oe.writeVarintField(1,le.id),oe.writeMessage(2,Si,te),oe.writeVarintField(3,le.type),oe.writeMessage(4,Dt,le)}function Si(te,oe){var le=te.feature,_e=te.keys,Ae=te.values,je=te.keycache,Ge=te.valuecache;for(var ye in le.properties){var Me=je[ye];Me===void 0&&(_e.push(ye),je[ye]=Me=_e.length-1),oe.writeVarint(Me);var Qe=le.properties[ye],ae=typeof Qe;ae!=="string"&&ae!=="boolean"&&ae!=="number"&&(Qe=JSON.stringify(Qe));var H=ae+":"+Qe,W=Ge[H];W===void 0&&(Ae.push(Qe),Ge[H]=W=Ae.length-1),oe.writeVarint(W)}}function bt(te,oe){return(oe<<3)+(7&te)}function Fi(te){return te<<1^te>>31}function Dt(te,oe){for(var le=te.loadGeometry(),_e=te.type,Ae=0,je=0,Ge=le.length,ye=0;ye<Ge;ye++){var Me=le[ye],Qe=1;_e===1&&(Qe=Me.length),oe.writeVarint(bt(1,Qe));for(var ae=_e===3?Me.length-1:Me.length,H=0;H<ae;H++){H===1&&_e!==1&&oe.writeVarint(bt(2,ae-1));var W=Me[H].x-Ae,ne=Me[H].y-je;oe.writeVarint(Fi(W)),oe.writeVarint(Fi(ne)),Ae+=W,je+=ne}_e===3&&oe.writeVarint(bt(7,1))}}function bi(te,oe){var le=typeof te;le==="string"?oe.writeStringField(1,te):le==="boolean"?oe.writeBooleanField(7,te):le==="number"&&(te%1!=0?oe.writeDoubleField(3,te):te<0?oe.writeSVarintField(6,te):oe.writeVarintField(5,te))}function zt(te,oe,le,_e){Yt(te,le,_e),Yt(oe,2*le,2*_e),Yt(oe,2*le+1,2*_e+1)}function Yt(te,oe,le){var _e=te[oe];te[oe]=te[le],te[le]=_e}function Et(te,oe,le,_e){var Ae=te-le,je=oe-_e;return Ae*Ae+je*je}qt.fromVectorTileJs=Ri,qt.fromGeojsonVt=function(te,oe){oe=oe||{};var le={};for(var _e in te)le[_e]=new at(te[_e].features,oe),le[_e].name=_e,le[_e].version=oe.version,le[_e].extent=oe.extent;return Ri({layers:le})},qt.GeoJSONWrapper=_i;var xi=function(te){return te[0]},Gt=function(te){return te[1]},Ji=function(te,oe,le,_e,Ae){oe===void 0&&(oe=xi),le===void 0&&(le=Gt),_e===void 0&&(_e=64),Ae===void 0&&(Ae=Float64Array),this.nodeSize=_e,this.points=te;for(var je=te.length<65536?Uint16Array:Uint32Array,Ge=this.ids=new je(te.length),ye=this.coords=new Ae(2*te.length),Me=0;Me<te.length;Me++)Ge[Me]=Me,ye[2*Me]=oe(te[Me]),ye[2*Me+1]=le(te[Me]);(function Qe(ae,H,W,ne,ce,ve){if(!(ce-ne<=W)){var fe=ne+ce>>1;(function Ie(Ee,Te,et,Ke,tt,jt){for(;tt>Ke;){if(tt-Ke>600){var Ct=tt-Ke+1,Ut=et-Ke+1,Zt=Math.log(Ct),Xi=.5*Math.exp(2*Zt/3),vi=.5*Math.sqrt(Zt*Xi*(Ct-Xi)/Ct)*(Ut-Ct/2<0?-1:1);Ie(Ee,Te,et,Math.max(Ke,Math.floor(et-Ut*Xi/Ct+vi)),Math.min(tt,Math.floor(et+(Ct-Ut)*Xi/Ct+vi)),jt)}var Pi=Te[2*et+jt],di=Ke,ei=tt;for(zt(Ee,Te,Ke,et),Te[2*tt+jt]>Pi&&zt(Ee,Te,Ke,tt);di<ei;){for(zt(Ee,Te,di,ei),di++,ei--;Te[2*di+jt]<Pi;)di++;for(;Te[2*ei+jt]>Pi;)ei--}Te[2*Ke+jt]===Pi?zt(Ee,Te,Ke,ei):zt(Ee,Te,++ei,tt),ei<=et&&(Ke=ei+1),et<=ei&&(tt=ei-1)}})(ae,H,fe,ne,ce,ve%2),Qe(ae,H,W,ne,fe-1,ve+1),Qe(ae,H,W,fe+1,ce,ve+1)}})(Ge,ye,_e,0,Ge.length-1,0)};Ji.prototype.range=function(te,oe,le,_e){return function(Ae,je,Ge,ye,Me,Qe,ae){for(var H,W,ne=[0,Ae.length-1,0],ce=[];ne.length;){var ve=ne.pop(),fe=ne.pop(),Ie=ne.pop();if(fe-Ie<=ae)for(var Ee=Ie;Ee<=fe;Ee++)W=je[2*Ee+1],(H=je[2*Ee])>=Ge&&H<=Me&&W>=ye&&W<=Qe&&ce.push(Ae[Ee]);else{var Te=Math.floor((Ie+fe)/2);W=je[2*Te+1],(H=je[2*Te])>=Ge&&H<=Me&&W>=ye&&W<=Qe&&ce.push(Ae[Te]);var et=(ve+1)%2;(ve===0?Ge<=H:ye<=W)&&(ne.push(Ie),ne.push(Te-1),ne.push(et)),(ve===0?Me>=H:Qe>=W)&&(ne.push(Te+1),ne.push(fe),ne.push(et))}}return ce}(this.ids,this.coords,te,oe,le,_e,this.nodeSize)},Ji.prototype.within=function(te,oe,le){return function(_e,Ae,je,Ge,ye,Me){for(var Qe=[0,_e.length-1,0],ae=[],H=ye*ye;Qe.length;){var W=Qe.pop(),ne=Qe.pop(),ce=Qe.pop();if(ne-ce<=Me)for(var ve=ce;ve<=ne;ve++)Et(Ae[2*ve],Ae[2*ve+1],je,Ge)<=H&&ae.push(_e[ve]);else{var fe=Math.floor((ce+ne)/2),Ie=Ae[2*fe],Ee=Ae[2*fe+1];Et(Ie,Ee,je,Ge)<=H&&ae.push(_e[fe]);var Te=(W+1)%2;(W===0?je-ye<=Ie:Ge-ye<=Ee)&&(Qe.push(ce),Qe.push(fe-1),Qe.push(Te)),(W===0?je+ye>=Ie:Ge+ye>=Ee)&&(Qe.push(fe+1),Qe.push(ne),Qe.push(Te))}}return ae}(this.ids,this.coords,te,oe,le,this.nodeSize)};var Ni={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(te){return te}},Ai=function(te){this.options=wi(Object.create(Ni),te),this.trees=new Array(this.options.maxZoom+1)};function or(te,oe,le,_e,Ae){return{x:te,y:oe,zoom:1/0,id:le,parentId:-1,numPoints:_e,properties:Ae}}function Li(te,oe){var le=te.geometry.coordinates,_e=le[1];return{x:Ft(le[0]),y:rt(_e),zoom:1/0,index:oe,parentId:-1}}function Mt(te){return{type:"Feature",id:te.id,properties:rr(te),geometry:{type:"Point",coordinates:[(_e=te.x,360*(_e-.5)),(oe=te.y,le=(180-360*oe)*Math.PI/180,360*Math.atan(Math.exp(le))/Math.PI-90)]}};var oe,le,_e}function rr(te){var oe=te.numPoints,le=oe>=1e4?Math.round(oe/1e3)+"k":oe>=1e3?Math.round(oe/100)/10+"k":oe;return wi(wi({},te.properties),{cluster:!0,cluster_id:te.id,point_count:oe,point_count_abbreviated:le})}function Ft(te){return te/360+.5}function rt(te){var oe=Math.sin(te*Math.PI/180),le=.5-.25*Math.log((1+oe)/(1-oe))/Math.PI;return le<0?0:le>1?1:le}function wi(te,oe){for(var le in oe)te[le]=oe[le];return te}function nr(te){return te.x}function Pr(te){return te.y}function ho(te,oe,le,_e,Ae,je){var Ge=Ae-le,ye=je-_e;if(Ge!==0||ye!==0){var Me=((te-le)*Ge+(oe-_e)*ye)/(Ge*Ge+ye*ye);Me>1?(le=Ae,_e=je):Me>0&&(le+=Ge*Me,_e+=ye*Me)}return(Ge=te-le)*Ge+(ye=oe-_e)*ye}function Jn(te,oe,le,_e){var Ae={id:te===void 0?null:te,type:oe,geometry:le,tags:_e,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(je){var Ge=je.geometry,ye=je.type;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")Fo(je,Ge);else if(ye==="Polygon"||ye==="MultiLineString")for(var Me=0;Me<Ge.length;Me++)Fo(je,Ge[Me]);else if(ye==="MultiPolygon")for(Me=0;Me<Ge.length;Me++)for(var Qe=0;Qe<Ge[Me].length;Qe++)Fo(je,Ge[Me][Qe])}(Ae),Ae}function Fo(te,oe){for(var le=0;le<oe.length;le+=3)te.minX=Math.min(te.minX,oe[le]),te.minY=Math.min(te.minY,oe[le+1]),te.maxX=Math.max(te.maxX,oe[le]),te.maxY=Math.max(te.maxY,oe[le+1])}function xn(te,oe,le,_e){if(oe.geometry){var Ae=oe.geometry.coordinates,je=oe.geometry.type,Ge=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2),ye=[],Me=oe.id;if(le.promoteId?Me=oe.properties[le.promoteId]:le.generateId&&(Me=_e||0),je==="Point")po(Ae,ye);else if(je==="MultiPoint")for(var Qe=0;Qe<Ae.length;Qe++)po(Ae[Qe],ye);else if(je==="LineString")Yn(Ae,ye,Ge,!1);else if(je==="MultiLineString"){if(le.lineMetrics){for(Qe=0;Qe<Ae.length;Qe++)Yn(Ae[Qe],ye=[],Ge,!1),te.push(Jn(Me,"LineString",ye,oe.properties));return}Wi(Ae,ye,Ge,!1)}else if(je==="Polygon")Wi(Ae,ye,Ge,!0);else{if(je!=="MultiPolygon"){if(je==="GeometryCollection"){for(Qe=0;Qe<oe.geometry.geometries.length;Qe++)xn(te,{id:Me,geometry:oe.geometry.geometries[Qe],properties:oe.properties},le,_e);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Qe=0;Qe<Ae.length;Qe++){var ae=[];Wi(Ae[Qe],ae,Ge,!0),ye.push(ae)}}te.push(Jn(Me,je,ye,oe.properties))}}function po(te,oe){oe.push(Nn(te[0])),oe.push(Ao(te[1])),oe.push(0)}function Yn(te,oe,le,_e){for(var Ae,je,Ge=0,ye=0;ye<te.length;ye++){var Me=Nn(te[ye][0]),Qe=Ao(te[ye][1]);oe.push(Me),oe.push(Qe),oe.push(0),ye>0&&(Ge+=_e?(Ae*Qe-Me*je)/2:Math.sqrt(Math.pow(Me-Ae,2)+Math.pow(Qe-je,2))),Ae=Me,je=Qe}var ae=oe.length-3;oe[2]=1,function H(W,ne,ce,ve){for(var fe,Ie=ve,Ee=ce-ne>>1,Te=ce-ne,et=W[ne],Ke=W[ne+1],tt=W[ce],jt=W[ce+1],Ct=ne+3;Ct<ce;Ct+=3){var Ut=ho(W[Ct],W[Ct+1],et,Ke,tt,jt);if(Ut>Ie)fe=Ct,Ie=Ut;else if(Ut===Ie){var Zt=Math.abs(Ct-Ee);Zt<Te&&(fe=Ct,Te=Zt)}}Ie>ve&&(fe-ne>3&&H(W,ne,fe,ve),W[fe+2]=Ie,ce-fe>3&&H(W,fe,ce,ve))}(oe,0,ae,le),oe[ae+2]=1,oe.size=Math.abs(Ge),oe.start=0,oe.end=oe.size}function Wi(te,oe,le,_e){for(var Ae=0;Ae<te.length;Ae++){var je=[];Yn(te[Ae],je,le,_e),oe.push(je)}}function Nn(te){return te/360+.5}function Ao(te){var oe=Math.sin(te*Math.PI/180),le=.5-.25*Math.log((1+oe)/(1-oe))/Math.PI;return le<0?0:le>1?1:le}function $n(te,oe,le,_e,Ae,je,Ge,ye){if(_e/=oe,je>=(le/=oe)&&Ge<_e)return te;if(Ge<le||je>=_e)return null;for(var Me=[],Qe=0;Qe<te.length;Qe++){var ae=te[Qe],H=ae.geometry,W=ae.type,ne=Ae===0?ae.minX:ae.minY,ce=Ae===0?ae.maxX:ae.maxY;if(ne>=le&&ce<_e)Me.push(ae);else if(!(ce<le||ne>=_e)){var ve=[];if(W==="Point"||W==="MultiPoint")Ua(H,ve,le,_e,Ae);else if(W==="LineString")qe(H,ve,le,_e,Ae,!1,ye.lineMetrics);else if(W==="MultiLineString")Ci(H,ve,le,_e,Ae,!1);else if(W==="Polygon")Ci(H,ve,le,_e,Ae,!0);else if(W==="MultiPolygon")for(var fe=0;fe<H.length;fe++){var Ie=[];Ci(H[fe],Ie,le,_e,Ae,!0),Ie.length&&ve.push(Ie)}if(ve.length){if(ye.lineMetrics&&W==="LineString"){for(fe=0;fe<ve.length;fe++)Me.push(Jn(ae.id,W,ve[fe],ae.tags));continue}W!=="LineString"&&W!=="MultiLineString"||(ve.length===1?(W="LineString",ve=ve[0]):W="MultiLineString"),W!=="Point"&&W!=="MultiPoint"||(W=ve.length===3?"Point":"MultiPoint"),Me.push(Jn(ae.id,W,ve,ae.tags))}}}return Me.length?Me:null}function Ua(te,oe,le,_e,Ae){for(var je=0;je<te.length;je+=3){var Ge=te[je+Ae];Ge>=le&&Ge<=_e&&(oe.push(te[je]),oe.push(te[je+1]),oe.push(te[je+2]))}}function qe(te,oe,le,_e,Ae,je,Ge){for(var ye,Me,Qe=_t(te),ae=Ae===0?wr:Qn,H=te.start,W=0;W<te.length-3;W+=3){var ne=te[W],ce=te[W+1],ve=te[W+2],fe=te[W+3],Ie=te[W+4],Ee=Ae===0?ne:ce,Te=Ae===0?fe:Ie,et=!1;Ge&&(ye=Math.sqrt(Math.pow(ne-fe,2)+Math.pow(ce-Ie,2))),Ee<le?Te>le&&(Me=ae(Qe,ne,ce,fe,Ie,le),Ge&&(Qe.start=H+ye*Me)):Ee>_e?Te<_e&&(Me=ae(Qe,ne,ce,fe,Ie,_e),Ge&&(Qe.start=H+ye*Me)):fr(Qe,ne,ce,ve),Te<le&&Ee>=le&&(Me=ae(Qe,ne,ce,fe,Ie,le),et=!0),Te>_e&&Ee<=_e&&(Me=ae(Qe,ne,ce,fe,Ie,_e),et=!0),!je&&et&&(Ge&&(Qe.end=H+ye*Me),oe.push(Qe),Qe=_t(te)),Ge&&(H+=ye)}var Ke=te.length-3;ne=te[Ke],ce=te[Ke+1],ve=te[Ke+2],(Ee=Ae===0?ne:ce)>=le&&Ee<=_e&&fr(Qe,ne,ce,ve),Ke=Qe.length-3,je&&Ke>=3&&(Qe[Ke]!==Qe[0]||Qe[Ke+1]!==Qe[1])&&fr(Qe,Qe[0],Qe[1],Qe[2]),Qe.length&&oe.push(Qe)}function _t(te){var oe=[];return oe.size=te.size,oe.start=te.start,oe.end=te.end,oe}function Ci(te,oe,le,_e,Ae,je){for(var Ge=0;Ge<te.length;Ge++)qe(te[Ge],oe,le,_e,Ae,je,!1)}function fr(te,oe,le,_e){te.push(oe),te.push(le),te.push(_e)}function wr(te,oe,le,_e,Ae,je){var Ge=(je-oe)/(_e-oe);return te.push(je),te.push(le+(Ae-le)*Ge),te.push(1),Ge}function Qn(te,oe,le,_e,Ae,je){var Ge=(je-le)/(Ae-le);return te.push(oe+(_e-oe)*Ge),te.push(je),te.push(1),Ge}function eo(te,oe){for(var le=[],_e=0;_e<te.length;_e++){var Ae,je=te[_e],Ge=je.type;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")Ae=sa(je.geometry,oe);else if(Ge==="MultiLineString"||Ge==="Polygon"){Ae=[];for(var ye=0;ye<je.geometry.length;ye++)Ae.push(sa(je.geometry[ye],oe))}else if(Ge==="MultiPolygon")for(Ae=[],ye=0;ye<je.geometry.length;ye++){for(var Me=[],Qe=0;Qe<je.geometry[ye].length;Qe++)Me.push(sa(je.geometry[ye][Qe],oe));Ae.push(Me)}le.push(Jn(je.id,Ge,Ae,je.tags))}return le}function sa(te,oe){var le=[];le.size=te.size,te.start!==void 0&&(le.start=te.start,le.end=te.end);for(var _e=0;_e<te.length;_e+=3)le.push(te[_e]+oe,te[_e+1],te[_e+2]);return le}function $r(te,oe){if(te.transformed)return te;var le,_e,Ae,je=1<<te.z,Ge=te.x,ye=te.y;for(le=0;le<te.features.length;le++){var Me=te.features[le],Qe=Me.geometry,ae=Me.type;if(Me.geometry=[],ae===1)for(_e=0;_e<Qe.length;_e+=2)Me.geometry.push(Jt(Qe[_e],Qe[_e+1],oe,je,Ge,ye));else for(_e=0;_e<Qe.length;_e++){var H=[];for(Ae=0;Ae<Qe[_e].length;Ae+=2)H.push(Jt(Qe[_e][Ae],Qe[_e][Ae+1],oe,je,Ge,ye));Me.geometry.push(H)}}return te.transformed=!0,te}function Jt(te,oe,le,_e,Ae,je){return[Math.round(le*(te*_e-Ae)),Math.round(le*(oe*_e-je))]}function ar(te,oe,le,_e,Ae){for(var je=oe===Ae.maxZoom?0:Ae.tolerance/((1<<oe)*Ae.extent),Ge={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:le,y:_e,z:oe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ye=0;ye<te.length;ye++){Ge.numFeatures++,Yi(Ge,te[ye],je,Ae);var Me=te[ye].minX,Qe=te[ye].minY,ae=te[ye].maxX,H=te[ye].maxY;Me<Ge.minX&&(Ge.minX=Me),Qe<Ge.minY&&(Ge.minY=Qe),ae>Ge.maxX&&(Ge.maxX=ae),H>Ge.maxY&&(Ge.maxY=H)}return Ge}function Yi(te,oe,le,_e){var Ae=oe.geometry,je=oe.type,Ge=[];if(je==="Point"||je==="MultiPoint")for(var ye=0;ye<Ae.length;ye+=3)Ge.push(Ae[ye]),Ge.push(Ae[ye+1]),te.numPoints++,te.numSimplified++;else if(je==="LineString")Rn(Ge,Ae,te,le,!1,!1);else if(je==="MultiLineString"||je==="Polygon")for(ye=0;ye<Ae.length;ye++)Rn(Ge,Ae[ye],te,le,je==="Polygon",ye===0);else if(je==="MultiPolygon")for(var Me=0;Me<Ae.length;Me++){var Qe=Ae[Me];for(ye=0;ye<Qe.length;ye++)Rn(Ge,Qe[ye],te,le,!0,ye===0)}if(Ge.length){var ae=oe.tags||null;if(je==="LineString"&&_e.lineMetrics){for(var H in ae={},oe.tags)ae[H]=oe.tags[H];ae.mapbox_clip_start=Ae.start/Ae.size,ae.mapbox_clip_end=Ae.end/Ae.size}var W={geometry:Ge,type:je==="Polygon"||je==="MultiPolygon"?3:je==="LineString"||je==="MultiLineString"?2:1,tags:ae};oe.id!==null&&(W.id=oe.id),te.features.push(W)}}function Rn(te,oe,le,_e,Ae,je){var Ge=_e*_e;if(_e>0&&oe.size<(Ae?Ge:_e))le.numPoints+=oe.length/3;else{for(var ye=[],Me=0;Me<oe.length;Me+=3)(_e===0||oe[Me+2]>Ge)&&(le.numSimplified++,ye.push(oe[Me]),ye.push(oe[Me+1])),le.numPoints++;Ae&&function(Qe,ae){for(var H=0,W=0,ne=Qe.length,ce=ne-2;W<ne;ce=W,W+=2)H+=(Qe[W]-Qe[ce])*(Qe[W+1]+Qe[ce+1]);if(H>0===ae)for(W=0,ne=Qe.length;W<ne/2;W+=2){var ve=Qe[W],fe=Qe[W+1];Qe[W]=Qe[ne-2-W],Qe[W+1]=Qe[ne-1-W],Qe[ne-2-W]=ve,Qe[ne-1-W]=fe}}(ye,je),te.push(ye)}}function to(te,oe){var le=(oe=this.options=function(Ae,je){for(var Ge in je)Ae[Ge]=je[Ge];return Ae}(Object.create(this.options),oe)).debug;if(le&&console.time("preprocess data"),oe.maxZoom<0||oe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(oe.promoteId&&oe.generateId)throw new Error("promoteId and generateId cannot be used together.");var _e=function(Ae,je){var Ge=[];if(Ae.type==="FeatureCollection")for(var ye=0;ye<Ae.features.length;ye++)xn(Ge,Ae.features[ye],je,ye);else xn(Ge,Ae.type==="Feature"?Ae:{geometry:Ae},je);return Ge}(te,oe);this.tiles={},this.tileCoords=[],le&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",oe.indexMaxZoom,oe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(_e=function(Ae,je){var Ge=je.buffer/je.extent,ye=Ae,Me=$n(Ae,1,-1-Ge,Ge,0,-1,2,je),Qe=$n(Ae,1,1-Ge,2+Ge,0,-1,2,je);return(Me||Qe)&&(ye=$n(Ae,1,-Ge,1+Ge,0,-1,2,je)||[],Me&&(ye=eo(Me,1).concat(ye)),Qe&&(ye=ye.concat(eo(Qe,-1)))),ye}(_e,oe)).length&&this.splitTile(_e,0,0,0),le&&(_e.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Gi(te,oe,le){return 32*((1<<te)*le+oe)+te}function _a(te,oe){var le=te.tileID.canonical;if(!this._geoJSONIndex)return oe(null,null);var _e=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!_e)return oe(null,null);var Ae=new ut(_e.features),je=qt(Ae);je.byteOffset===0&&je.byteLength===je.buffer.byteLength||(je=new Uint8Array(je)),oe(null,{vectorTile:Ae,rawData:je.buffer})}Ai.prototype.load=function(te){var oe=this.options,le=oe.log,_e=oe.minZoom,Ae=oe.maxZoom,je=oe.nodeSize;le&&console.time("total time");var Ge="prepare "+te.length+" points";le&&console.time(Ge),this.points=te;for(var ye=[],Me=0;Me<te.length;Me++)te[Me].geometry&&ye.push(Li(te[Me],Me));this.trees[Ae+1]=new Ji(ye,nr,Pr,je,Float32Array),le&&console.timeEnd(Ge);for(var Qe=Ae;Qe>=_e;Qe--){var ae=+Date.now();ye=this._cluster(ye,Qe),this.trees[Qe]=new Ji(ye,nr,Pr,je,Float32Array),le&&console.log("z%d: %d clusters in %dms",Qe,ye.length,+Date.now()-ae)}return le&&console.timeEnd("total time"),this},Ai.prototype.getClusters=function(te,oe){var le=((te[0]+180)%360+360)%360-180,_e=Math.max(-90,Math.min(90,te[1])),Ae=te[2]===180?180:((te[2]+180)%360+360)%360-180,je=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)le=-180,Ae=180;else if(le>Ae){var Ge=this.getClusters([le,_e,180,je],oe),ye=this.getClusters([-180,_e,Ae,je],oe);return Ge.concat(ye)}for(var Me=this.trees[this._limitZoom(oe)],Qe=[],ae=0,H=Me.range(Ft(le),rt(je),Ft(Ae),rt(_e));ae<H.length;ae+=1){var W=Me.points[H[ae]];Qe.push(W.numPoints?Mt(W):this.points[W.index])}return Qe},Ai.prototype.getChildren=function(te){var oe=this._getOriginId(te),le=this._getOriginZoom(te),_e="No cluster with the specified id.",Ae=this.trees[le];if(!Ae)throw new Error(_e);var je=Ae.points[oe];if(!je)throw new Error(_e);for(var Ge=this.options.radius/(this.options.extent*Math.pow(2,le-1)),ye=[],Me=0,Qe=Ae.within(je.x,je.y,Ge);Me<Qe.length;Me+=1){var ae=Ae.points[Qe[Me]];ae.parentId===te&&ye.push(ae.numPoints?Mt(ae):this.points[ae.index])}if(ye.length===0)throw new Error(_e);return ye},Ai.prototype.getLeaves=function(te,oe,le){var _e=[];return this._appendLeaves(_e,te,oe=oe||10,le=le||0,0),_e},Ai.prototype.getTile=function(te,oe,le){var _e=this.trees[this._limitZoom(te)],Ae=Math.pow(2,te),je=this.options,Ge=je.radius/je.extent,ye=(le-Ge)/Ae,Me=(le+1+Ge)/Ae,Qe={features:[]};return this._addTileFeatures(_e.range((oe-Ge)/Ae,ye,(oe+1+Ge)/Ae,Me),_e.points,oe,le,Ae,Qe),oe===0&&this._addTileFeatures(_e.range(1-Ge/Ae,ye,1,Me),_e.points,Ae,le,Ae,Qe),oe===Ae-1&&this._addTileFeatures(_e.range(0,ye,Ge/Ae,Me),_e.points,-1,le,Ae,Qe),Qe.features.length?Qe:null},Ai.prototype.getClusterExpansionZoom=function(te){for(var oe=this._getOriginZoom(te)-1;oe<=this.options.maxZoom;){var le=this.getChildren(te);if(oe++,le.length!==1)break;te=le[0].properties.cluster_id}return oe},Ai.prototype._appendLeaves=function(te,oe,le,_e,Ae){for(var je=0,Ge=this.getChildren(oe);je<Ge.length;je+=1){var ye=Ge[je],Me=ye.properties;if(Me&&Me.cluster?Ae+Me.point_count<=_e?Ae+=Me.point_count:Ae=this._appendLeaves(te,Me.cluster_id,le,_e,Ae):Ae<_e?Ae++:te.push(ye),te.length===le)break}return Ae},Ai.prototype._addTileFeatures=function(te,oe,le,_e,Ae,je){for(var Ge=0,ye=te;Ge<ye.length;Ge+=1){var Me=oe[ye[Ge]],Qe=Me.numPoints,ae={type:1,geometry:[[Math.round(this.options.extent*(Me.x*Ae-le)),Math.round(this.options.extent*(Me.y*Ae-_e))]],tags:Qe?rr(Me):this.points[Me.index].properties},H=void 0;Qe?H=Me.id:this.options.generateId?H=Me.index:this.points[Me.index].id&&(H=this.points[Me.index].id),H!==void 0&&(ae.id=H),je.features.push(ae)}},Ai.prototype._limitZoom=function(te){return Math.max(this.options.minZoom,Math.min(+te,this.options.maxZoom+1))},Ai.prototype._cluster=function(te,oe){for(var le=[],_e=this.options,Ae=_e.reduce,je=_e.minPoints,Ge=_e.radius/(_e.extent*Math.pow(2,oe)),ye=0;ye<te.length;ye++){var Me=te[ye];if(!(Me.zoom<=oe)){Me.zoom=oe;for(var Qe=this.trees[oe+1],ae=Qe.within(Me.x,Me.y,Ge),H=Me.numPoints||1,W=H,ne=0,ce=ae;ne<ce.length;ne+=1){var ve=Qe.points[ce[ne]];ve.zoom>oe&&(W+=ve.numPoints||1)}if(W>=je){for(var fe=Me.x*H,Ie=Me.y*H,Ee=Ae&&H>1?this._map(Me,!0):null,Te=(ye<<5)+(oe+1)+this.points.length,et=0,Ke=ae;et<Ke.length;et+=1){var tt=Qe.points[Ke[et]];if(!(tt.zoom<=oe)){tt.zoom=oe;var jt=tt.numPoints||1;fe+=tt.x*jt,Ie+=tt.y*jt,tt.parentId=Te,Ae&&(Ee||(Ee=this._map(Me,!0)),Ae(Ee,this._map(tt)))}}Me.parentId=Te,le.push(or(fe/W,Ie/W,Te,W,Ee))}else if(le.push(Me),W>1)for(var Ct=0,Ut=ae;Ct<Ut.length;Ct+=1){var Zt=Qe.points[Ut[Ct]];Zt.zoom<=oe||(Zt.zoom=oe,le.push(Zt))}}}return le},Ai.prototype._getOriginId=function(te){return te-this.points.length>>5},Ai.prototype._getOriginZoom=function(te){return(te-this.points.length)%32},Ai.prototype._map=function(te,oe){if(te.numPoints)return oe?wi({},te.properties):te.properties;var le=this.points[te.index].properties,_e=this.options.map(le);return oe&&_e===le?wi({},_e):_e},to.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},to.prototype.splitTile=function(te,oe,le,_e,Ae,je,Ge){for(var ye=[te,oe,le,_e],Me=this.options,Qe=Me.debug;ye.length;){_e=ye.pop(),le=ye.pop(),oe=ye.pop(),te=ye.pop();var ae=1<<oe,H=Gi(oe,le,_e),W=this.tiles[H];if(!W&&(Qe>1&&console.time("creation"),W=this.tiles[H]=ar(te,oe,le,_e,Me),this.tileCoords.push({z:oe,x:le,y:_e}),Qe)){Qe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",oe,le,_e,W.numFeatures,W.numPoints,W.numSimplified),console.timeEnd("creation"));var ne="z"+oe;this.stats[ne]=(this.stats[ne]||0)+1,this.total++}if(W.source=te,Ae){if(oe===Me.maxZoom||oe===Ae)continue;var ce=1<<Ae-oe;if(le!==Math.floor(je/ce)||_e!==Math.floor(Ge/ce))continue}else if(oe===Me.indexMaxZoom||W.numPoints<=Me.indexMaxPoints)continue;if(W.source=null,te.length!==0){Qe>1&&console.time("clipping");var ve,fe,Ie,Ee,Te,et,Ke=.5*Me.buffer/Me.extent,tt=.5-Ke,jt=.5+Ke,Ct=1+Ke;ve=fe=Ie=Ee=null,Te=$n(te,ae,le-Ke,le+jt,0,W.minX,W.maxX,Me),et=$n(te,ae,le+tt,le+Ct,0,W.minX,W.maxX,Me),te=null,Te&&(ve=$n(Te,ae,_e-Ke,_e+jt,1,W.minY,W.maxY,Me),fe=$n(Te,ae,_e+tt,_e+Ct,1,W.minY,W.maxY,Me),Te=null),et&&(Ie=$n(et,ae,_e-Ke,_e+jt,1,W.minY,W.maxY,Me),Ee=$n(et,ae,_e+tt,_e+Ct,1,W.minY,W.maxY,Me),et=null),Qe>1&&console.timeEnd("clipping"),ye.push(ve||[],oe+1,2*le,2*_e),ye.push(fe||[],oe+1,2*le,2*_e+1),ye.push(Ie||[],oe+1,2*le+1,2*_e),ye.push(Ee||[],oe+1,2*le+1,2*_e+1)}}},to.prototype.getTile=function(te,oe,le){var _e=this.options,Ae=_e.extent,je=_e.debug;if(te<0||te>24)return null;var Ge=1<<te,ye=Gi(te,oe=(oe%Ge+Ge)%Ge,le);if(this.tiles[ye])return $r(this.tiles[ye],Ae);je>1&&console.log("drilling down to z%d-%d-%d",te,oe,le);for(var Me,Qe=te,ae=oe,H=le;!Me&&Qe>0;)Qe--,ae=Math.floor(ae/2),H=Math.floor(H/2),Me=this.tiles[Gi(Qe,ae,H)];return Me&&Me.source?(je>1&&console.log("found parent tile z%d-%d-%d",Qe,ae,H),je>1&&console.time("drilling down"),this.splitTile(Me.source,Qe,ae,H,te,oe,le),je>1&&console.timeEnd("drilling down"),this.tiles[ye]?$r(this.tiles[ye],Ae):null):null};var Uo=function(te){function oe(le,_e,Ae,je){te.call(this,le,_e,Ae,_a),je&&(this.loadGeoJSON=je)}return te&&(oe.__proto__=te),(oe.prototype=Object.create(te&&te.prototype)).constructor=oe,oe.prototype.loadData=function(le,_e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=_e,this._pendingLoadDataParams=le,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},oe.prototype._loadData=function(){var le=this;if(this._pendingCallback&&this._pendingLoadDataParams){var _e=this._pendingCallback,Ae=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var je=!!(Ae&&Ae.request&&Ae.request.collectResourceTiming)&&new f.RequestPerformance(Ae.request);this.loadGeoJSON(Ae,function(Ge,ye){if(Ge||!ye)return _e(Ge);if(typeof ye!="object")return _e(new Error("Input data given to '"+Ae.source+"' is not a valid GeoJSON object."));(function W(ne,ce){var ve,fe=ne&&ne.type;if(fe==="FeatureCollection")for(ve=0;ve<ne.features.length;ve++)W(ne.features[ve],ce);else if(fe==="GeometryCollection")for(ve=0;ve<ne.geometries.length;ve++)W(ne.geometries[ve],ce);else if(fe==="Feature")W(ne.geometry,ce);else if(fe==="Polygon")ft(ne.coordinates,ce);else if(fe==="MultiPolygon")for(ve=0;ve<ne.coordinates.length;ve++)ft(ne.coordinates[ve],ce);return ne})(ye,!0);try{if(Ae.filter){var Me=f.createExpression(Ae.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Me.result==="error")throw new Error(Me.value.map(function(W){return W.key+": "+W.message}).join(", "));var Qe=ye.features.filter(function(W){return Me.value.evaluate({zoom:0},W)});ye={type:"FeatureCollection",features:Qe}}le._geoJSONIndex=Ae.cluster?new Ai(function(W){var ne=W.superclusterOptions,ce=W.clusterProperties;if(!ce||!ne)return ne;for(var ve={},fe={},Ie={accumulated:null,zoom:0},Ee={properties:null},Te=Object.keys(ce),et=0,Ke=Te;et<Ke.length;et+=1){var tt=Ke[et],jt=ce[tt],Ct=jt[0],Ut=f.createExpression(jt[1]),Zt=f.createExpression(typeof Ct=="string"?[Ct,["accumulated"],["get",tt]]:Ct);ve[tt]=Ut.value,fe[tt]=Zt.value}return ne.map=function(Xi){Ee.properties=Xi;for(var vi={},Pi=0,di=Te;Pi<di.length;Pi+=1){var ei=di[Pi];vi[ei]=ve[ei].evaluate(Ie,Ee)}return vi},ne.reduce=function(Xi,vi){Ee.properties=vi;for(var Pi=0,di=Te;Pi<di.length;Pi+=1){var ei=di[Pi];Ie.accumulated=Xi[ei],Xi[ei]=fe[ei].evaluate(Ie,Ee)}},ne}(Ae)).load(ye.features):function(W,ne){return new to(W,ne)}(ye,Ae.geojsonVtOptions)}catch(W){return _e(W)}le.loaded={};var ae={};if(je){var H=je.finish();H&&(ae.resourceTiming={},ae.resourceTiming[Ae.source]=JSON.parse(JSON.stringify(H)))}_e(null,ae)})}},oe.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},oe.prototype.reloadTile=function(le,_e){var Ae=this.loaded;return Ae&&Ae[le.uid]?te.prototype.reloadTile.call(this,le,_e):this.loadTile(le,_e)},oe.prototype.loadGeoJSON=function(le,_e){if(le.request)f.getJSON(le.request,_e);else{if(typeof le.data!="string")return _e(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."));try{return _e(null,JSON.parse(le.data))}catch{return _e(new Error("Input data given to '"+le.source+"' is not a valid GeoJSON object."))}}},oe.prototype.removeSource=function(le,_e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),_e()},oe.prototype.getClusterExpansionZoom=function(le,_e){try{_e(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(Ae){_e(Ae)}},oe.prototype.getClusterChildren=function(le,_e){try{_e(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(Ae){_e(Ae)}},oe.prototype.getClusterLeaves=function(le,_e){try{_e(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(Ae){_e(Ae)}},oe}(ge),Xr=function(te){var oe=this;this.self=te,this.actor=new f.Actor(te,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ge,geojson:Uo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(le,_e){if(oe.workerSourceTypes[le])throw new Error('Worker source with name "'+le+'" already registered.');oe.workerSourceTypes[le]=_e},this.self.registerRTLTextPlugin=function(le){if(f.plugin.isParsed())throw new Error("RTL text plugin already registered.");f.plugin.applyArabicShaping=le.applyArabicShaping,f.plugin.processBidirectionalText=le.processBidirectionalText,f.plugin.processStyledBidirectionalText=le.processStyledBidirectionalText}};return Xr.prototype.setReferrer=function(te,oe){this.referrer=oe},Xr.prototype.setImages=function(te,oe,le){for(var _e in this.availableImages[te]=oe,this.workerSources[te]){var Ae=this.workerSources[te][_e];for(var je in Ae)Ae[je].availableImages=oe}le()},Xr.prototype.setLayers=function(te,oe,le){this.getLayerIndex(te).replace(oe),le()},Xr.prototype.updateLayers=function(te,oe,le){this.getLayerIndex(te).update(oe.layers,oe.removedIds),le()},Xr.prototype.loadTile=function(te,oe,le){this.getWorkerSource(te,oe.type,oe.source).loadTile(oe,le)},Xr.prototype.loadDEMTile=function(te,oe,le){this.getDEMWorkerSource(te,oe.source).loadTile(oe,le)},Xr.prototype.reloadTile=function(te,oe,le){this.getWorkerSource(te,oe.type,oe.source).reloadTile(oe,le)},Xr.prototype.abortTile=function(te,oe,le){this.getWorkerSource(te,oe.type,oe.source).abortTile(oe,le)},Xr.prototype.removeTile=function(te,oe,le){this.getWorkerSource(te,oe.type,oe.source).removeTile(oe,le)},Xr.prototype.removeDEMTile=function(te,oe){this.getDEMWorkerSource(te,oe.source).removeTile(oe)},Xr.prototype.removeSource=function(te,oe,le){if(this.workerSources[te]&&this.workerSources[te][oe.type]&&this.workerSources[te][oe.type][oe.source]){var _e=this.workerSources[te][oe.type][oe.source];delete this.workerSources[te][oe.type][oe.source],_e.removeSource!==void 0?_e.removeSource(oe,le):le()}},Xr.prototype.loadWorkerSource=function(te,oe,le){try{this.self.importScripts(oe.url),le()}catch(_e){le(_e.toString())}},Xr.prototype.syncRTLPluginState=function(te,oe,le){try{f.plugin.setState(oe);var _e=f.plugin.getPluginURL();if(f.plugin.isLoaded()&&!f.plugin.isParsed()&&_e!=null){this.self.importScripts(_e);var Ae=f.plugin.isParsed();le(Ae?void 0:new Error("RTL Text Plugin failed to import scripts from "+_e),Ae)}}catch(je){le(je.toString())}},Xr.prototype.getAvailableImages=function(te){var oe=this.availableImages[te];return oe||(oe=[]),oe},Xr.prototype.getLayerIndex=function(te){var oe=this.layerIndexes[te];return oe||(oe=this.layerIndexes[te]=new N),oe},Xr.prototype.getWorkerSource=function(te,oe,le){var _e=this;return this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][oe]||(this.workerSources[te][oe]={}),this.workerSources[te][oe][le]||(this.workerSources[te][oe][le]=new this.workerSourceTypes[oe]({send:function(Ae,je,Ge){_e.actor.send(Ae,je,Ge,te)}},this.getLayerIndex(te),this.getAvailableImages(te))),this.workerSources[te][oe][le]},Xr.prototype.getDEMWorkerSource=function(te,oe){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][oe]||(this.demWorkerSources[te][oe]=new Le),this.demWorkerSources[te][oe]},Xr.prototype.enforceCacheSizeLimit=function(te,oe){f.enforceCacheSizeLimit(oe)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Xr(self)),Xr}),z(["./shared"],function(f){var p=f.createCommonjsModule(function(c){function m(k){return!d(k)}function d(k){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var B,q,Y=new Blob([""],{type:"text/javascript"}),ie=URL.createObjectURL(Y);try{q=new Worker(ie),B=!0}catch{B=!1}return q&&q.terminate(),URL.revokeObjectURL(ie),B}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var B=document.createElement("canvas");B.width=B.height=1;var q=B.getContext("2d");if(!q)return!1;var Y=q.getImageData(0,0,1,1);return Y&&Y.width===B.width}()?(x[D=k&&k.failIfMajorPerformanceCaveat]===void 0&&(x[D]=function(B){var q=function(ie){var he=document.createElement("canvas"),de=Object.create(m.webGLContextAttributes);return de.failIfMajorPerformanceCaveat=ie,he.probablySupportsContext?he.probablySupportsContext("webgl",de)||he.probablySupportsContext("experimental-webgl",de):he.supportsContext?he.supportsContext("webgl",de)||he.supportsContext("experimental-webgl",de):he.getContext("webgl",de)||he.getContext("experimental-webgl",de)}(B);if(!q)return!1;var Y=q.createShader(q.VERTEX_SHADER);return!(!Y||q.isContextLost())&&(q.shaderSource(Y,"void main() {}"),q.compileShader(Y),q.getShaderParameter(Y,q.COMPILE_STATUS)===!0)}(D)),x[D]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var D}c.exports?c.exports=m:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=m,window.mapboxgl.notSupportedReason=d);var x={};m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),L={create:function(c,m,d){var x=f.window.document.createElement(c);return m!==void 0&&(x.className=m),d&&d.appendChild(x),x},createNS:function(c,m){return f.window.document.createElementNS(c,m)}},N=f.window.document&&f.window.document.documentElement.style;function U(c){if(!N)return c[0];for(var m=0;m<c.length;m++)if(c[m]in N)return c[m];return c[0]}var G,X=U(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);L.disableDrag=function(){N&&X&&(G=N[X],N[X]="none")},L.enableDrag=function(){N&&X&&(N[X]=G)};var Se=U(["transform","WebkitTransform"]);L.setTransform=function(c,m){c.style[Se]=m};var ge=!1;try{var De=Object.defineProperty({},"passive",{get:function(){ge=!0}});f.window.addEventListener("test",De,De),f.window.removeEventListener("test",De,De)}catch{ge=!1}L.addEventListener=function(c,m,d,x){x===void 0&&(x={}),c.addEventListener(m,d,"passive"in x&&ge?x:x.capture)},L.removeEventListener=function(c,m,d,x){x===void 0&&(x={}),c.removeEventListener(m,d,"passive"in x&&ge?x:x.capture)};var Le=function(c){c.preventDefault(),c.stopPropagation(),f.window.removeEventListener("click",Le,!0)};function ft(c){var m=c.userImage;return!!(m&&m.render&&m.render())&&(c.data.replace(new Uint8Array(m.data.buffer)),!0)}L.suppressClick=function(){f.window.addEventListener("click",Le,!0),f.window.setTimeout(function(){f.window.removeEventListener("click",Le,!0)},0)},L.mousePos=function(c,m){var d=c.getBoundingClientRect();return new f.Point(m.clientX-d.left-c.clientLeft,m.clientY-d.top-c.clientTop)},L.touchPos=function(c,m){for(var d=c.getBoundingClientRect(),x=[],k=0;k<m.length;k++)x.push(new f.Point(m[k].clientX-d.left-c.clientLeft,m[k].clientY-d.top-c.clientTop));return x},L.mouseButton=function(c){return f.window.InstallTrigger!==void 0&&c.button===2&&c.ctrlKey&&f.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:c.button},L.remove=function(c){c.parentNode&&c.parentNode.removeChild(c)};var Ue=function(c){function m(){c.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new f.RGBAImage({width:1,height:1}),this.dirty=!0}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.isLoaded=function(){return this.loaded},m.prototype.setLoaded=function(d){if(this.loaded!==d&&(this.loaded=d,d)){for(var x=0,k=this.requestors;x<k.length;x+=1){var D=k[x];this._notify(D.ids,D.callback)}this.requestors=[]}},m.prototype.getImage=function(d){return this.images[d]},m.prototype.addImage=function(d,x){this._validate(d,x)&&(this.images[d]=x)},m.prototype._validate=function(d,x){var k=!0;return this._validateStretch(x.stretchX,x.data&&x.data.width)||(this.fire(new f.ErrorEvent(new Error('Image "'+d+'" has invalid "stretchX" value'))),k=!1),this._validateStretch(x.stretchY,x.data&&x.data.height)||(this.fire(new f.ErrorEvent(new Error('Image "'+d+'" has invalid "stretchY" value'))),k=!1),this._validateContent(x.content,x)||(this.fire(new f.ErrorEvent(new Error('Image "'+d+'" has invalid "content" value'))),k=!1),k},m.prototype._validateStretch=function(d,x){if(!d)return!0;for(var k=0,D=0,B=d;D<B.length;D+=1){var q=B[D];if(q[0]<k||q[1]<q[0]||x<q[1])return!1;k=q[1]}return!0},m.prototype._validateContent=function(d,x){return!(d&&(d.length!==4||d[0]<0||x.data.width<d[0]||d[1]<0||x.data.height<d[1]||d[2]<0||x.data.width<d[2]||d[3]<0||x.data.height<d[3]||d[2]<d[0]||d[3]<d[1]))},m.prototype.updateImage=function(d,x){x.version=this.images[d].version+1,this.images[d]=x,this.updatedImages[d]=!0},m.prototype.removeImage=function(d){var x=this.images[d];delete this.images[d],delete this.patterns[d],x.userImage&&x.userImage.onRemove&&x.userImage.onRemove()},m.prototype.listImages=function(){return Object.keys(this.images)},m.prototype.getImages=function(d,x){var k=!0;if(!this.isLoaded())for(var D=0,B=d;D<B.length;D+=1)this.images[B[D]]||(k=!1);this.isLoaded()||k?this._notify(d,x):this.requestors.push({ids:d,callback:x})},m.prototype._notify=function(d,x){for(var k={},D=0,B=d;D<B.length;D+=1){var q=B[D];this.images[q]||this.fire(new f.Event("styleimagemissing",{id:q}));var Y=this.images[q];Y?k[q]={data:Y.data.clone(),pixelRatio:Y.pixelRatio,sdf:Y.sdf,version:Y.version,stretchX:Y.stretchX,stretchY:Y.stretchY,content:Y.content,hasRenderCallback:Boolean(Y.userImage&&Y.userImage.render)}:f.warnOnce('Image "'+q+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}x(null,k)},m.prototype.getPixelSize=function(){var d=this.atlasImage;return{width:d.width,height:d.height}},m.prototype.getPattern=function(d){var x=this.patterns[d],k=this.getImage(d);if(!k)return null;if(x&&x.position.version===k.version)return x.position;if(x)x.position.version=k.version;else{var D={w:k.data.width+2,h:k.data.height+2,x:0,y:0},B=new f.ImagePosition(D,k);this.patterns[d]={bin:D,position:B}}return this._updatePatternAtlas(),this.patterns[d].position},m.prototype.bind=function(d){var x=d.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new f.Texture(d,this.atlasImage,x.RGBA),this.atlasTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE)},m.prototype._updatePatternAtlas=function(){var d=[];for(var x in this.patterns)d.push(this.patterns[x].bin);var k=f.potpack(d),D=k.w,B=k.h,q=this.atlasImage;for(var Y in q.resize({width:D||1,height:B||1}),this.patterns){var ie=this.patterns[Y].bin,he=ie.x+1,de=ie.y+1,me=this.images[Y].data,ze=me.width,Ce=me.height;f.RGBAImage.copy(me,q,{x:0,y:0},{x:he,y:de},{width:ze,height:Ce}),f.RGBAImage.copy(me,q,{x:0,y:Ce-1},{x:he,y:de-1},{width:ze,height:1}),f.RGBAImage.copy(me,q,{x:0,y:0},{x:he,y:de+Ce},{width:ze,height:1}),f.RGBAImage.copy(me,q,{x:ze-1,y:0},{x:he-1,y:de},{width:1,height:Ce}),f.RGBAImage.copy(me,q,{x:0,y:0},{x:he+ze,y:de},{width:1,height:Ce})}this.dirty=!0},m.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},m.prototype.dispatchRenderCallbacks=function(d){for(var x=0,k=d;x<k.length;x+=1){var D=k[x];if(!this.callbackDispatchedThisFrame[D]){this.callbackDispatchedThisFrame[D]=!0;var B=this.images[D];ft(B)&&this.updateImage(D,B)}}},m}(f.Evented),Re=ht,st=ht,ut=1e20;function ht(c,m,d,x,k,D){this.fontSize=c||24,this.buffer=m===void 0?3:m,this.cutoff=x||.25,this.fontFamily=k||"sans-serif",this.fontWeight=D||"normal",this.radius=d||8;var B=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=B,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(B*B),this.gridInner=new Float64Array(B*B),this.f=new Float64Array(B),this.d=new Float64Array(B),this.z=new Float64Array(B+1),this.v=new Int16Array(B),this.middle=Math.round(B/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function at(c,m,d,x,k,D,B){for(var q=0;q<m;q++){for(var Y=0;Y<d;Y++)x[Y]=c[Y*m+q];for($t(x,k,D,B,d),Y=0;Y<d;Y++)c[Y*m+q]=k[Y]}for(Y=0;Y<d;Y++){for(q=0;q<m;q++)x[q]=c[Y*m+q];for($t(x,k,D,B,m),q=0;q<m;q++)c[Y*m+q]=Math.sqrt(k[q])}}function $t(c,m,d,x,k){d[0]=0,x[0]=-ut,x[1]=+ut;for(var D=1,B=0;D<k;D++){for(var q=(c[D]+D*D-(c[d[B]]+d[B]*d[B]))/(2*D-2*d[B]);q<=x[B];)B--,q=(c[D]+D*D-(c[d[B]]+d[B]*d[B]))/(2*D-2*d[B]);d[++B]=D,x[B]=q,x[B+1]=+ut}for(D=0,B=0;D<k;D++){for(;x[B+1]<D;)B++;m[D]=(D-d[B])*(D-d[B])+c[d[B]]}}ht.prototype.draw=function(c){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(c,this.buffer,this.middle);for(var m=this.ctx.getImageData(0,0,this.size,this.size),d=new Uint8ClampedArray(this.size*this.size),x=0;x<this.size*this.size;x++){var k=m.data[4*x+3]/255;this.gridOuter[x]=k===1?0:k===0?ut:Math.pow(Math.max(0,.5-k),2),this.gridInner[x]=k===1?ut:k===0?0:Math.pow(Math.max(0,k-.5),2)}for(at(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),at(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),x=0;x<this.size*this.size;x++)d[x]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[x]-this.gridInner[x])/this.radius+this.cutoff))));return d},Re.default=st;var xt=function(c,m){this.requestManager=c,this.localIdeographFontFamily=m,this.entries={}};xt.prototype.setURL=function(c){this.url=c},xt.prototype.getGlyphs=function(c,m){var d=this,x=[];for(var k in c)for(var D=0,B=c[k];D<B.length;D+=1)x.push({stack:k,id:B[D]});f.asyncAll(x,function(q,Y){var ie=q.stack,he=q.id,de=d.entries[ie];de||(de=d.entries[ie]={glyphs:{},requests:{},ranges:{}});var me=de.glyphs[he];if(me===void 0){if(me=d._tinySDF(de,ie,he))return de.glyphs[he]=me,void Y(null,{stack:ie,id:he,glyph:me});var ze=Math.floor(he/256);if(256*ze>65535)Y(new Error("glyphs > 65535 not supported"));else if(de.ranges[ze])Y(null,{stack:ie,id:he,glyph:me});else{var Ce=de.requests[ze];Ce||(Ce=de.requests[ze]=[],xt.loadGlyphRange(ie,ze,d.url,d.requestManager,function(Be,be){if(be){for(var Pe in be)d._doesCharSupportLocalGlyph(+Pe)||(de.glyphs[+Pe]=be[+Pe]);de.ranges[ze]=!0}for(var Ve=0,Ye=Ce;Ve<Ye.length;Ve+=1)(0,Ye[Ve])(Be,be);delete de.requests[ze]})),Ce.push(function(Be,be){Be?Y(Be):be&&Y(null,{stack:ie,id:he,glyph:be[he]||null})})}}else Y(null,{stack:ie,id:he,glyph:me})},function(q,Y){if(q)m(q);else if(Y){for(var ie={},he=0,de=Y;he<de.length;he+=1){var me=de[he],ze=me.stack,Ce=me.id,Be=me.glyph;(ie[ze]||(ie[ze]={}))[Ce]=Be&&{id:Be.id,bitmap:Be.bitmap.clone(),metrics:Be.metrics}}m(null,ie)}})},xt.prototype._doesCharSupportLocalGlyph=function(c){return!!this.localIdeographFontFamily&&(f.isChar["CJK Unified Ideographs"](c)||f.isChar["Hangul Syllables"](c)||f.isChar.Hiragana(c)||f.isChar.Katakana(c))},xt.prototype._tinySDF=function(c,m,d){var x=this.localIdeographFontFamily;if(x&&this._doesCharSupportLocalGlyph(d)){var k=c.tinySDF;if(!k){var D="400";/bold/i.test(m)?D="900":/medium/i.test(m)?D="500":/light/i.test(m)&&(D="200"),k=c.tinySDF=new xt.TinySDF(24,3,8,.25,x,D)}return{id:d,bitmap:new f.AlphaImage({width:30,height:30},k.draw(String.fromCharCode(d))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},xt.loadGlyphRange=function(c,m,d,x,k){var D=256*m,B=D+255,q=x.transformRequest(x.normalizeGlyphsURL(d).replace("{fontstack}",c).replace("{range}",D+"-"+B),f.ResourceType.Glyphs);f.getArrayBuffer(q,function(Y,ie){if(Y)k(Y);else if(ie){for(var he={},de=0,me=f.parseGlyphPBF(ie);de<me.length;de+=1){var ze=me[de];he[ze.id]=ze}k(null,he)}})},xt.TinySDF=Re;var qt=function(){this.specification=f.styleSpec.light.position};qt.prototype.possiblyEvaluate=function(c,m){return f.sphericalToCartesian(c.expression.evaluate(m))},qt.prototype.interpolate=function(c,m,d){return{x:f.number(c.x,m.x,d),y:f.number(c.y,m.y,d),z:f.number(c.z,m.z,d)}};var _i=new f.Properties({anchor:new f.DataConstantProperty(f.styleSpec.light.anchor),position:new qt,color:new f.DataConstantProperty(f.styleSpec.light.color),intensity:new f.DataConstantProperty(f.styleSpec.light.intensity)}),Ri=function(c){function m(d){c.call(this),this._transitionable=new f.Transitionable(_i),this.setLight(d),this._transitioning=this._transitionable.untransitioned()}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getLight=function(){return this._transitionable.serialize()},m.prototype.setLight=function(d,x){if(x===void 0&&(x={}),!this._validate(f.validateLight,d,x))for(var k in d){var D=d[k];f.endsWith(k,"-transition")?this._transitionable.setTransition(k.slice(0,-11),D):this._transitionable.setValue(k,D)}},m.prototype.updateTransitions=function(d){this._transitioning=this._transitionable.transitioned(d,this._transitioning)},m.prototype.hasTransition=function(){return this._transitioning.hasTransition()},m.prototype.recalculate=function(d){this.properties=this._transitioning.possiblyEvaluate(d)},m.prototype._validate=function(d,x,k){return(!k||k.validate!==!1)&&f.emitValidationErrors(this,d.call(f.validateStyle,f.extend({value:x,style:{glyphs:!0,sprite:!0},styleSpec:f.styleSpec})))},m}(f.Evented),Ht=function(c,m){this.width=c,this.height=m,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Ht.prototype.getDash=function(c,m){var d=c.join(",")+String(m);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(c,m)),this.dashEntry[d]},Ht.prototype.getDashRanges=function(c,m,d){var x=[],k=c.length%2==1?-c[c.length-1]*d:0,D=c[0]*d,B=!0;x.push({left:k,right:D,isDash:B,zeroLength:c[0]===0});for(var q=c[0],Y=1;Y<c.length;Y++){var ie=c[Y];x.push({left:k=q*d,right:D=(q+=ie)*d,isDash:B=!B,zeroLength:ie===0})}return x},Ht.prototype.addRoundDash=function(c,m,d){for(var x=m/2,k=-d;k<=d;k++)for(var D=this.width*(this.nextRow+d+k),B=0,q=c[B],Y=0;Y<this.width;Y++){Y/q.right>1&&(q=c[++B]);var ie=Math.abs(Y-q.left),he=Math.abs(Y-q.right),de=Math.min(ie,he),me=void 0,ze=k/d*(x+1);if(q.isDash){var Ce=x-Math.abs(ze);me=Math.sqrt(de*de+Ce*Ce)}else me=x-Math.sqrt(de*de+ze*ze);this.data[D+Y]=Math.max(0,Math.min(255,me+128))}},Ht.prototype.addRegularDash=function(c){for(var m=c.length-1;m>=0;--m){var d=c[m],x=c[m+1];d.zeroLength?c.splice(m,1):x&&x.isDash===d.isDash&&(x.left=d.left,c.splice(m,1))}var k=c[0],D=c[c.length-1];k.isDash===D.isDash&&(k.left=D.left-this.width,D.right=k.right+this.width);for(var B=this.width*this.nextRow,q=0,Y=c[q],ie=0;ie<this.width;ie++){ie/Y.right>1&&(Y=c[++q]);var he=Math.abs(ie-Y.left),de=Math.abs(ie-Y.right),me=Math.min(he,de);this.data[B+ie]=Math.max(0,Math.min(255,(Y.isDash?me:-me)+128))}},Ht.prototype.addDash=function(c,m){var d=m?7:0,x=2*d+1;if(this.nextRow+x>this.height)return f.warnOnce("LineAtlas out of space"),null;for(var k=0,D=0;D<c.length;D++)k+=c[D];if(k!==0){var B=this.width/k,q=this.getDashRanges(c,this.width,B);m?this.addRoundDash(q,B,d):this.addRegularDash(q)}var Y={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:k};return this.nextRow+=x,this.dirty=!0,Y},Ht.prototype.bind=function(c){var m=c.gl;this.texture?(m.bindTexture(m.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,m.texSubImage2D(m.TEXTURE_2D,0,0,0,this.width,this.height,m.ALPHA,m.UNSIGNED_BYTE,this.data))):(this.texture=m.createTexture(),m.bindTexture(m.TEXTURE_2D,this.texture),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),m.texImage2D(m.TEXTURE_2D,0,m.ALPHA,this.width,this.height,0,m.ALPHA,m.UNSIGNED_BYTE,this.data))};var Qt=function c(m,d){this.workerPool=m,this.actors=[],this.currentActor=0,this.id=f.uniqueId();for(var x=this.workerPool.acquire(this.id),k=0;k<x.length;k++){var D=new c.Actor(x[k],d,this.id);D.name="Worker "+k,this.actors.push(D)}};function Si(c,m,d){var x=function(k,D){if(k)return d(k);if(D){var B=f.pick(f.extend(D,c),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(B.vectorLayers=D.vector_layers,B.vectorLayerIds=B.vectorLayers.map(function(q){return q.id})),B.tiles=m.canonicalizeTileset(B,c.url),d(null,B)}};return c.url?f.getJSON(m.transformRequest(m.normalizeSourceURL(c.url),f.ResourceType.Source),x):f.browser.frame(function(){return x(null,c)})}Qt.prototype.broadcast=function(c,m,d){f.asyncAll(this.actors,function(x,k){x.send(c,m,k)},d=d||function(){})},Qt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Qt.prototype.remove=function(){this.actors.forEach(function(c){c.remove()}),this.actors=[],this.workerPool.release(this.id)},Qt.Actor=f.Actor;var bt=function(c,m,d){this.bounds=f.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=m||0,this.maxzoom=d||24};bt.prototype.validateBounds=function(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]},bt.prototype.contains=function(c){var m=Math.pow(2,c.z),d=Math.floor(f.mercatorXfromLng(this.bounds.getWest())*m),x=Math.floor(f.mercatorYfromLat(this.bounds.getNorth())*m),k=Math.ceil(f.mercatorXfromLng(this.bounds.getEast())*m),D=Math.ceil(f.mercatorYfromLat(this.bounds.getSouth())*m);return c.x>=d&&c.x<k&&c.y>=x&&c.y<D};var Fi=function(c){function m(d,x,k,D){if(c.call(this),this.id=d,this.dispatcher=k,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,f.extend(this,f.pick(x,["url","scheme","tileSize","promoteId"])),this._options=f.extend({type:"vector"},x),this._collectResourceTiming=x.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(D)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.load=function(){var d=this;this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Si(this._options,this.map._requestManager,function(x,k){d._tileJSONRequest=null,d._loaded=!0,x?d.fire(new f.ErrorEvent(x)):k&&(f.extend(d,k),k.bounds&&(d.tileBounds=new bt(k.bounds,d.minzoom,d.maxzoom)),f.postTurnstileEvent(k.tiles,d.map._requestManager._customAccessToken),f.postMapLoadEvent(k.tiles,d.map._getMapId(),d.map._requestManager._skuToken,d.map._requestManager._customAccessToken),d.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),d.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"})))})},m.prototype.loaded=function(){return this._loaded},m.prototype.hasTile=function(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)},m.prototype.onAdd=function(d){this.map=d,this.load()},m.prototype.setSourceProperty=function(d){this._tileJSONRequest&&this._tileJSONRequest.cancel(),d(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},m.prototype.setTiles=function(d){var x=this;return this.setSourceProperty(function(){x._options.tiles=d}),this},m.prototype.setUrl=function(d){var x=this;return this.setSourceProperty(function(){x.url=d,x._options.url=d}),this},m.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},m.prototype.serialize=function(){return f.extend({},this._options)},m.prototype.loadTile=function(d,x){var k=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),D={request:this.map._requestManager.transformRequest(k,f.ResourceType.Tile),uid:d.uid,tileID:d.tileID,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:f.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function B(q,Y){return delete d.request,d.aborted?x(null):q&&q.status!==404?x(q):(Y&&Y.resourceTiming&&(d.resourceTiming=Y.resourceTiming),this.map._refreshExpiredTiles&&Y&&d.setExpiryData(Y),d.loadVectorData(Y,this.map.painter),f.cacheEntryPossiblyAdded(this.dispatcher),x(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}D.request.collectResourceTiming=this._collectResourceTiming,d.actor&&d.state!=="expired"?d.state==="loading"?d.reloadCallback=x:d.request=d.actor.send("reloadTile",D,B.bind(this)):(d.actor=this.dispatcher.getActor(),d.request=d.actor.send("loadTile",D,B.bind(this)))},m.prototype.abortTile=function(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id},void 0)},m.prototype.unloadTile=function(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id},void 0)},m.prototype.hasTransition=function(){return!1},m}(f.Evented),Dt=function(c){function m(d,x,k,D){c.call(this),this.id=d,this.dispatcher=k,this.setEventedParent(D),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=f.extend({type:"raster"},x),f.extend(this,f.pick(x,["url","scheme","tileSize"]))}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.load=function(){var d=this;this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Si(this._options,this.map._requestManager,function(x,k){d._tileJSONRequest=null,d._loaded=!0,x?d.fire(new f.ErrorEvent(x)):k&&(f.extend(d,k),k.bounds&&(d.tileBounds=new bt(k.bounds,d.minzoom,d.maxzoom)),f.postTurnstileEvent(k.tiles),f.postMapLoadEvent(k.tiles,d.map._getMapId(),d.map._requestManager._skuToken),d.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),d.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"})))})},m.prototype.loaded=function(){return this._loaded},m.prototype.onAdd=function(d){this.map=d,this.load()},m.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},m.prototype.serialize=function(){return f.extend({},this._options)},m.prototype.hasTile=function(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)},m.prototype.loadTile=function(d,x){var k=this,D=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);d.request=f.getImage(this.map._requestManager.transformRequest(D,f.ResourceType.Tile),function(B,q){if(delete d.request,d.aborted)d.state="unloaded",x(null);else if(B)d.state="errored",x(B);else if(q){k.map._refreshExpiredTiles&&d.setExpiryData(q),delete q.cacheControl,delete q.expires;var Y=k.map.painter.context,ie=Y.gl;d.texture=k.map.painter.getTileTexture(q.width),d.texture?d.texture.update(q,{useMipmap:!0}):(d.texture=new f.Texture(Y,q,ie.RGBA,{useMipmap:!0}),d.texture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE,ie.LINEAR_MIPMAP_NEAREST),Y.extTextureFilterAnisotropic&&ie.texParameterf(ie.TEXTURE_2D,Y.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Y.extTextureFilterAnisotropicMax)),d.state="loaded",f.cacheEntryPossiblyAdded(k.dispatcher),x(null)}})},m.prototype.abortTile=function(d,x){d.request&&(d.request.cancel(),delete d.request),x()},m.prototype.unloadTile=function(d,x){d.texture&&this.map.painter.saveTileTexture(d.texture),x()},m.prototype.hasTransition=function(){return!1},m}(f.Evented),bi=function(c){function m(d,x,k,D){c.call(this,d,x,k,D),this.type="raster-dem",this.maxzoom=22,this._options=f.extend({type:"raster-dem"},x),this.encoding=x.encoding||"mapbox"}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},m.prototype.loadTile=function(d,x){var k=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function D(B,q){B&&(d.state="errored",x(B)),q&&(d.dem=q,d.needsHillshadePrepare=!0,d.state="loaded",x(null))}d.request=f.getImage(this.map._requestManager.transformRequest(k,f.ResourceType.Tile),function(B,q){if(delete d.request,d.aborted)d.state="unloaded",x(null);else if(B)d.state="errored",x(B);else if(q){this.map._refreshExpiredTiles&&d.setExpiryData(q),delete q.cacheControl,delete q.expires;var Y=f.window.ImageBitmap&&q instanceof f.window.ImageBitmap&&f.offscreenCanvasSupported()?q:f.browser.getImageData(q,1),ie={uid:d.uid,coord:d.tileID,source:this.id,rawImageData:Y,encoding:this.encoding};d.actor&&d.state!=="expired"||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",ie,D.bind(this)))}}.bind(this)),d.neighboringTiles=this._getNeighboringTiles(d.tileID)},m.prototype._getNeighboringTiles=function(d){var x=d.canonical,k=Math.pow(2,x.z),D=(x.x-1+k)%k,B=x.x===0?d.wrap-1:d.wrap,q=(x.x+1+k)%k,Y=x.x+1===k?d.wrap+1:d.wrap,ie={};return ie[new f.OverscaledTileID(d.overscaledZ,B,x.z,D,x.y).key]={backfilled:!1},ie[new f.OverscaledTileID(d.overscaledZ,Y,x.z,q,x.y).key]={backfilled:!1},x.y>0&&(ie[new f.OverscaledTileID(d.overscaledZ,B,x.z,D,x.y-1).key]={backfilled:!1},ie[new f.OverscaledTileID(d.overscaledZ,d.wrap,x.z,x.x,x.y-1).key]={backfilled:!1},ie[new f.OverscaledTileID(d.overscaledZ,Y,x.z,q,x.y-1).key]={backfilled:!1}),x.y+1<k&&(ie[new f.OverscaledTileID(d.overscaledZ,B,x.z,D,x.y+1).key]={backfilled:!1},ie[new f.OverscaledTileID(d.overscaledZ,d.wrap,x.z,x.x,x.y+1).key]={backfilled:!1},ie[new f.OverscaledTileID(d.overscaledZ,Y,x.z,q,x.y+1).key]={backfilled:!1}),ie},m.prototype.unloadTile=function(d){d.demTexture&&this.map.painter.saveTileTexture(d.demTexture),d.fbo&&(d.fbo.destroy(),delete d.fbo),d.dem&&delete d.dem,delete d.neighboringTiles,d.state="unloaded",d.actor&&d.actor.send("removeDEMTile",{uid:d.uid,source:this.id})},m}(Dt),zt=function(c){function m(d,x,k,D){c.call(this),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=k.getActor(),this.setEventedParent(D),this._data=x.data,this._options=f.extend({},x),this._collectResourceTiming=x.collectResourceTiming,this._resourceTiming=[],x.maxzoom!==void 0&&(this.maxzoom=x.maxzoom),x.type&&(this.type=x.type),x.attribution&&(this.attribution=x.attribution),this.promoteId=x.promoteId;var B=f.EXTENT/this.tileSize;this.workerOptions=f.extend({source:this.id,cluster:x.cluster||!1,geojsonVtOptions:{buffer:(x.buffer!==void 0?x.buffer:128)*B,tolerance:(x.tolerance!==void 0?x.tolerance:.375)*B,extent:f.EXTENT,maxZoom:this.maxzoom,lineMetrics:x.lineMetrics||!1,generateId:x.generateId||!1},superclusterOptions:{maxZoom:x.clusterMaxZoom!==void 0?Math.min(x.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,x.clusterMinPoints||2),extent:f.EXTENT,radius:(x.clusterRadius||50)*B,log:!1,generateId:x.generateId||!1},clusterProperties:x.clusterProperties,filter:x.filter},x.workerOptions)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.load=function(){var d=this;this.fire(new f.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(x){if(x)d.fire(new f.ErrorEvent(x));else{var k={dataType:"source",sourceDataType:"metadata"};d._collectResourceTiming&&d._resourceTiming&&d._resourceTiming.length>0&&(k.resourceTiming=d._resourceTiming,d._resourceTiming=[]),d.fire(new f.Event("data",k))}})},m.prototype.onAdd=function(d){this.map=d,this.load()},m.prototype.setData=function(d){var x=this;return this._data=d,this.fire(new f.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(k){if(k)x.fire(new f.ErrorEvent(k));else{var D={dataType:"source",sourceDataType:"content"};x._collectResourceTiming&&x._resourceTiming&&x._resourceTiming.length>0&&(D.resourceTiming=x._resourceTiming,x._resourceTiming=[]),x.fire(new f.Event("data",D))}}),this},m.prototype.getClusterExpansionZoom=function(d,x){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id},x),this},m.prototype.getClusterChildren=function(d,x){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id},x),this},m.prototype.getClusterLeaves=function(d,x,k,D){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:d,limit:x,offset:k},D),this},m.prototype._updateWorkerData=function(d){var x=this;this._loaded=!1;var k=f.extend({},this.workerOptions),D=this._data;typeof D=="string"?(k.request=this.map._requestManager.transformRequest(f.browser.resolveURL(D),f.ResourceType.Source),k.request.collectResourceTiming=this._collectResourceTiming):k.data=JSON.stringify(D),this.actor.send(this.type+".loadData",k,function(B,q){x._removed||q&&q.abandoned||(x._loaded=!0,q&&q.resourceTiming&&q.resourceTiming[x.id]&&(x._resourceTiming=q.resourceTiming[x.id].slice(0)),x.actor.send(x.type+".coalesce",{source:k.source},null),d(B))})},m.prototype.loaded=function(){return this._loaded},m.prototype.loadTile=function(d,x){var k=this,D=d.actor?"reloadTile":"loadTile";d.actor=this.actor,d.request=this.actor.send(D,{type:this.type,uid:d.uid,tileID:d.tileID,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:f.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(B,q){return delete d.request,d.unloadVectorData(),d.aborted?x(null):B?x(B):(d.loadVectorData(q,k.map.painter,D==="reloadTile"),x(null))})},m.prototype.abortTile=function(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0},m.prototype.unloadTile=function(d){d.unloadVectorData(),this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})},m.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},m.prototype.serialize=function(){return f.extend({},this._options,{type:this.type,data:this._data})},m.prototype.hasTransition=function(){return!1},m}(f.Evented),Yt=f.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Et=function(c){function m(d,x,k,D){c.call(this),this.id=d,this.dispatcher=k,this.coordinates=x.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(D),this.options=x}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.load=function(d,x){var k=this;this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this.url=this.options.url,f.getImage(this.map._requestManager.transformRequest(this.url,f.ResourceType.Image),function(D,B){k._loaded=!0,D?k.fire(new f.ErrorEvent(D)):B&&(k.image=B,d&&(k.coordinates=d),x&&x(),k._finishLoading())})},m.prototype.loaded=function(){return this._loaded},m.prototype.updateImage=function(d){var x=this;return this.image&&d.url?(this.options.url=d.url,this.load(d.coordinates,function(){x.texture=null}),this):this},m.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})))},m.prototype.onAdd=function(d){this.map=d,this.load()},m.prototype.setCoordinates=function(d){var x=this;this.coordinates=d;var k=d.map(f.MercatorCoordinate.fromLngLat);this.tileID=function(B){for(var q=1/0,Y=1/0,ie=-1/0,he=-1/0,de=0,me=B;de<me.length;de+=1){var ze=me[de];q=Math.min(q,ze.x),Y=Math.min(Y,ze.y),ie=Math.max(ie,ze.x),he=Math.max(he,ze.y)}var Ce=Math.max(ie-q,he-Y),Be=Math.max(0,Math.floor(-Math.log(Ce)/Math.LN2)),be=Math.pow(2,Be);return new f.CanonicalTileID(Be,Math.floor((q+ie)/2*be),Math.floor((Y+he)/2*be))}(k),this.minzoom=this.maxzoom=this.tileID.z;var D=k.map(function(B){return x.tileID.getTilePoint(B)._round()});return this._boundsArray=new f.StructArrayLayout4i8,this._boundsArray.emplaceBack(D[0].x,D[0].y,0,0),this._boundsArray.emplaceBack(D[1].x,D[1].y,f.EXTENT,0),this._boundsArray.emplaceBack(D[3].x,D[3].y,0,f.EXTENT),this._boundsArray.emplaceBack(D[2].x,D[2].y,f.EXTENT,f.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"})),this},m.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var d=this.map.painter.context,x=d.gl;for(var k in this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,Yt.members)),this.boundsSegments||(this.boundsSegments=f.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new f.Texture(d,this.image,x.RGBA),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE)),this.tiles){var D=this.tiles[k];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture)}}},m.prototype.loadTile=function(d,x){this.tileID&&this.tileID.equals(d.tileID.canonical)?(this.tiles[String(d.tileID.wrap)]=d,d.buckets={},x(null)):(d.state="errored",x(null))},m.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},m.prototype.hasTransition=function(){return!1},m}(f.Evented),xi=function(c){function m(d,x,k,D){c.call(this,d,x,k,D),this.roundZoom=!0,this.type="video",this.options=x}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.load=function(){var d=this;this._loaded=!1;var x=this.options;this.urls=[];for(var k=0,D=x.urls;k<D.length;k+=1)this.urls.push(this.map._requestManager.transformRequest(D[k],f.ResourceType.Source).url);f.getVideo(this.urls,function(B,q){d._loaded=!0,B?d.fire(new f.ErrorEvent(B)):q&&(d.video=q,d.video.loop=!0,d.video.addEventListener("playing",function(){d.map.triggerRepaint()}),d.map&&d.video.play(),d._finishLoading())})},m.prototype.pause=function(){this.video&&this.video.pause()},m.prototype.play=function(){this.video&&this.video.play()},m.prototype.seek=function(d){if(this.video){var x=this.video.seekable;d<x.start(0)||d>x.end(0)?this.fire(new f.ErrorEvent(new f.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+x.start(0)+" and "+x.end(0)+"-second mark."))):this.video.currentTime=d}},m.prototype.getVideo=function(){return this.video},m.prototype.onAdd=function(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},m.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var d=this.map.painter.context,x=d.gl;for(var k in this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,Yt.members)),this.boundsSegments||(this.boundsSegments=f.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE),x.texSubImage2D(x.TEXTURE_2D,0,0,0,x.RGBA,x.UNSIGNED_BYTE,this.video)):(this.texture=new f.Texture(d,this.video,x.RGBA),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE)),this.tiles){var D=this.tiles[k];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture)}}},m.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},m.prototype.hasTransition=function(){return this.video&&!this.video.paused},m}(Et),Gt=function(c){function m(d,x,k,D){c.call(this,d,x,k,D),x.coordinates?Array.isArray(x.coordinates)&&x.coordinates.length===4&&!x.coordinates.some(function(B){return!Array.isArray(B)||B.length!==2||B.some(function(q){return typeof q!="number"})})||this.fire(new f.ErrorEvent(new f.ValidationError("sources."+d,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new f.ErrorEvent(new f.ValidationError("sources."+d,null,'missing required property "coordinates"'))),x.animate&&typeof x.animate!="boolean"&&this.fire(new f.ErrorEvent(new f.ValidationError("sources."+d,null,'optional "animate" property must be a boolean value'))),x.canvas?typeof x.canvas=="string"||x.canvas instanceof f.window.HTMLCanvasElement||this.fire(new f.ErrorEvent(new f.ValidationError("sources."+d,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new f.ErrorEvent(new f.ValidationError("sources."+d,null,'missing required property "canvas"'))),this.options=x,this.animate=x.animate===void 0||x.animate}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof f.window.HTMLCanvasElement?this.options.canvas:f.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new f.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},m.prototype.getCanvas=function(){return this.canvas},m.prototype.onAdd=function(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()},m.prototype.onRemove=function(){this.pause()},m.prototype.prepare=function(){var d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var x=this.map.painter.context,k=x.gl;for(var D in this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,Yt.members)),this.boundsSegments||(this.boundsSegments=f.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(d||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new f.Texture(x,this.canvas,k.RGBA,{premultiply:!0}),this.tiles){var B=this.tiles[D];B.state!=="loaded"&&(B.state="loaded",B.texture=this.texture)}}},m.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},m.prototype.hasTransition=function(){return this._playing},m.prototype._hasInvalidDimensions=function(){for(var d=0,x=[this.canvas.width,this.canvas.height];d<x.length;d+=1){var k=x[d];if(isNaN(k)||k<=0)return!0}return!1},m}(Et),Ji={vector:Fi,raster:Dt,"raster-dem":bi,geojson:zt,video:xi,image:Et,canvas:Gt};function Ni(c,m){var d=f.identity([]);return f.translate(d,d,[1,1,0]),f.scale(d,d,[.5*c.width,.5*c.height,1]),f.multiply(d,d,c.calculatePosMatrix(m.toUnwrapped()))}function Ai(c,m,d,x,k,D){var B=function(Be,be,Pe){if(Be)for(var Ve=0,Ye=Be;Ve<Ye.length;Ve+=1){var ot=be[Ye[Ve]];if(ot&&ot.source===Pe&&ot.type==="fill-extrusion")return!0}else for(var lt in be){var ct=be[lt];if(ct.source===Pe&&ct.type==="fill-extrusion")return!0}return!1}(k&&k.layers,m,c.id),q=D.maxPitchScaleFactor(),Y=c.tilesIn(x,q,B);Y.sort(or);for(var ie=[],he=0,de=Y;he<de.length;he+=1){var me=de[he];ie.push({wrappedTileID:me.tileID.wrapped().key,queryResults:me.tile.queryRenderedFeatures(m,d,c._state,me.queryGeometry,me.cameraQueryGeometry,me.scale,k,D,q,Ni(c.transform,me.tileID))})}var ze=function(Be){for(var be={},Pe={},Ve=0,Ye=Be;Ve<Ye.length;Ve+=1){var ot=Ye[Ve],lt=ot.queryResults,ct=ot.wrappedTileID,It=Pe[ct]=Pe[ct]||{};for(var Ot in lt)for(var Rt=lt[Ot],ii=It[Ot]=It[Ot]||{},gi=be[Ot]=be[Ot]||[],Ii=0,yi=Rt;Ii<yi.length;Ii+=1){var lr=yi[Ii];ii[lr.featureIndex]||(ii[lr.featureIndex]=!0,gi.push(lr))}}return be}(ie);for(var Ce in ze)ze[Ce].forEach(function(Be){var be=Be.feature,Pe=c.getFeatureState(be.layer["source-layer"],be.id);be.source=be.layer.source,be.layer["source-layer"]&&(be.sourceLayer=be.layer["source-layer"]),be.state=Pe});return ze}function or(c,m){var d=c.tileID,x=m.tileID;return d.overscaledZ-x.overscaledZ||d.canonical.y-x.canonical.y||d.wrap-x.wrap||d.canonical.x-x.canonical.x}var Li=function(c,m){this.max=c,this.onRemove=m,this.reset()};Li.prototype.reset=function(){for(var c in this.data)for(var m=0,d=this.data[c];m<d.length;m+=1){var x=d[m];x.timeout&&clearTimeout(x.timeout),this.onRemove(x.value)}return this.data={},this.order=[],this},Li.prototype.add=function(c,m,d){var x=this,k=c.wrapped().key;this.data[k]===void 0&&(this.data[k]=[]);var D={value:m,timeout:void 0};if(d!==void 0&&(D.timeout=setTimeout(function(){x.remove(c,D)},d)),this.data[k].push(D),this.order.push(k),this.order.length>this.max){var B=this._getAndRemoveByKey(this.order[0]);B&&this.onRemove(B)}return this},Li.prototype.has=function(c){return c.wrapped().key in this.data},Li.prototype.getAndRemove=function(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null},Li.prototype._getAndRemoveByKey=function(c){var m=this.data[c].shift();return m.timeout&&clearTimeout(m.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),m.value},Li.prototype.getByKey=function(c){var m=this.data[c];return m?m[0].value:null},Li.prototype.get=function(c){return this.has(c)?this.data[c.wrapped().key][0].value:null},Li.prototype.remove=function(c,m){if(!this.has(c))return this;var d=c.wrapped().key,x=m===void 0?0:this.data[d].indexOf(m),k=this.data[d][x];return this.data[d].splice(x,1),k.timeout&&clearTimeout(k.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(k.value),this.order.splice(this.order.indexOf(d),1),this},Li.prototype.setMaxSize=function(c){for(this.max=c;this.order.length>this.max;){var m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this},Li.prototype.filter=function(c){var m=[];for(var d in this.data)for(var x=0,k=this.data[d];x<k.length;x+=1){var D=k[x];c(D.value)||m.push(D)}for(var B=0,q=m;B<q.length;B+=1){var Y=q[B];this.remove(Y.value.tileID,Y)}};var Mt=function(c,m,d){this.context=c;var x=c.gl;this.buffer=x.createBuffer(),this.dynamicDraw=Boolean(d),this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer};Mt.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Mt.prototype.updateData=function(c){var m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)},Mt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var rr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Ft=function(c,m,d,x){this.length=m.length,this.attributes=d,this.itemSize=m.bytesPerElement,this.dynamicDraw=x,this.context=c;var k=c.gl;this.buffer=k.createBuffer(),c.bindVertexBuffer.set(this.buffer),k.bufferData(k.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?k.DYNAMIC_DRAW:k.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer};Ft.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Ft.prototype.updateData=function(c){var m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,c.arrayBuffer)},Ft.prototype.enableAttributes=function(c,m){for(var d=0;d<this.attributes.length;d++){var x=m.attributes[this.attributes[d].name];x!==void 0&&c.enableVertexAttribArray(x)}},Ft.prototype.setVertexAttribPointers=function(c,m,d){for(var x=0;x<this.attributes.length;x++){var k=this.attributes[x],D=m.attributes[k.name];D!==void 0&&c.vertexAttribPointer(D,k.components,c[rr[k.type]],!1,this.itemSize,k.offset+this.itemSize*(d||0))}},Ft.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var rt=function(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};rt.prototype.get=function(){return this.current},rt.prototype.set=function(c){},rt.prototype.getDefault=function(){return this.default},rt.prototype.setDefault=function(){this.set(this.default)};var wi=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return f.Color.transparent},m.prototype.set=function(d){var x=this.current;(d.r!==x.r||d.g!==x.g||d.b!==x.b||d.a!==x.a||this.dirty)&&(this.gl.clearColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)},m}(rt),nr=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return 1},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.clearDepth(d),this.current=d,this.dirty=!1)},m}(rt),Pr=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return 0},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.clearStencil(d),this.current=d,this.dirty=!1)},m}(rt),ho=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return[!0,!0,!0,!0]},m.prototype.set=function(d){var x=this.current;(d[0]!==x[0]||d[1]!==x[1]||d[2]!==x[2]||d[3]!==x[3]||this.dirty)&&(this.gl.colorMask(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)},m}(rt),Jn=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!0},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.depthMask(d),this.current=d,this.dirty=!1)},m}(rt),Fo=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return 255},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.stencilMask(d),this.current=d,this.dirty=!1)},m}(rt),xn=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},m.prototype.set=function(d){var x=this.current;(d.func!==x.func||d.ref!==x.ref||d.mask!==x.mask||this.dirty)&&(this.gl.stencilFunc(d.func,d.ref,d.mask),this.current=d,this.dirty=!1)},m}(rt),po=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){var d=this.gl;return[d.KEEP,d.KEEP,d.KEEP]},m.prototype.set=function(d){var x=this.current;(d[0]!==x[0]||d[1]!==x[1]||d[2]!==x[2]||this.dirty)&&(this.gl.stencilOp(d[0],d[1],d[2]),this.current=d,this.dirty=!1)},m}(rt),Yn=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;d?x.enable(x.STENCIL_TEST):x.disable(x.STENCIL_TEST),this.current=d,this.dirty=!1}},m}(rt),Wi=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return[0,1]},m.prototype.set=function(d){var x=this.current;(d[0]!==x[0]||d[1]!==x[1]||this.dirty)&&(this.gl.depthRange(d[0],d[1]),this.current=d,this.dirty=!1)},m}(rt),Nn=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;d?x.enable(x.DEPTH_TEST):x.disable(x.DEPTH_TEST),this.current=d,this.dirty=!1}},m}(rt),Ao=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.LESS},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.depthFunc(d),this.current=d,this.dirty=!1)},m}(rt),$n=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;d?x.enable(x.BLEND):x.disable(x.BLEND),this.current=d,this.dirty=!1}},m}(rt),Ua=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){var d=this.gl;return[d.ONE,d.ZERO]},m.prototype.set=function(d){var x=this.current;(d[0]!==x[0]||d[1]!==x[1]||this.dirty)&&(this.gl.blendFunc(d[0],d[1]),this.current=d,this.dirty=!1)},m}(rt),qe=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return f.Color.transparent},m.prototype.set=function(d){var x=this.current;(d.r!==x.r||d.g!==x.g||d.b!==x.b||d.a!==x.a||this.dirty)&&(this.gl.blendColor(d.r,d.g,d.b,d.a),this.current=d,this.dirty=!1)},m}(rt),_t=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.FUNC_ADD},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.blendEquation(d),this.current=d,this.dirty=!1)},m}(rt),Ci=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;d?x.enable(x.CULL_FACE):x.disable(x.CULL_FACE),this.current=d,this.dirty=!1}},m}(rt),fr=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.BACK},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.cullFace(d),this.current=d,this.dirty=!1)},m}(rt),wr=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.CCW},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.frontFace(d),this.current=d,this.dirty=!1)},m}(rt),Qn=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.useProgram(d),this.current=d,this.dirty=!1)},m}(rt),eo=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return this.gl.TEXTURE0},m.prototype.set=function(d){(d!==this.current||this.dirty)&&(this.gl.activeTexture(d),this.current=d,this.dirty=!1)},m}(rt),sa=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){var d=this.gl;return[0,0,d.drawingBufferWidth,d.drawingBufferHeight]},m.prototype.set=function(d){var x=this.current;(d[0]!==x[0]||d[1]!==x[1]||d[2]!==x[2]||d[3]!==x[3]||this.dirty)&&(this.gl.viewport(d[0],d[1],d[2],d[3]),this.current=d,this.dirty=!1)},m}(rt),$r=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.bindFramebuffer(x.FRAMEBUFFER,d),this.current=d,this.dirty=!1}},m}(rt),Jt=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.bindRenderbuffer(x.RENDERBUFFER,d),this.current=d,this.dirty=!1}},m}(rt),ar=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.bindTexture(x.TEXTURE_2D,d),this.current=d,this.dirty=!1}},m}(rt),Yi=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.bindBuffer(x.ARRAY_BUFFER,d),this.current=d,this.dirty=!1}},m}(rt),Rn=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){var x=this.gl;x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,d),this.current=d,this.dirty=!1},m}(rt),to=function(c){function m(d){c.call(this,d),this.vao=d.extVertexArrayObject}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m.prototype.set=function(d){this.vao&&(d!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(d),this.current=d,this.dirty=!1)},m}(rt),Gi=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return 4},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.pixelStorei(x.UNPACK_ALIGNMENT,d),this.current=d,this.dirty=!1}},m}(rt),_a=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.pixelStorei(x.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d),this.current=d,this.dirty=!1}},m}(rt),Uo=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return!1},m.prototype.set=function(d){if(d!==this.current||this.dirty){var x=this.gl;x.pixelStorei(x.UNPACK_FLIP_Y_WEBGL,d),this.current=d,this.dirty=!1}},m}(rt),Xr=function(c){function m(d,x){c.call(this,d),this.context=d,this.parent=x}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getDefault=function(){return null},m}(rt),te=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.setDirty=function(){this.dirty=!0},m.prototype.set=function(d){if(d!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var x=this.gl;x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,x.TEXTURE_2D,d,0),this.current=d,this.dirty=!1}},m}(Xr),oe=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.set=function(d){if(d!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var x=this.gl;x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_ATTACHMENT,x.RENDERBUFFER,d),this.current=d,this.dirty=!1}},m}(Xr),le=function(c,m,d,x){this.context=c,this.width=m,this.height=d;var k=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new te(c,k),x&&(this.depthAttachment=new oe(c,k))};le.prototype.destroy=function(){var c=this.context.gl,m=this.colorAttachment.get();if(m&&c.deleteTexture(m),this.depthAttachment){var d=this.depthAttachment.get();d&&c.deleteRenderbuffer(d)}c.deleteFramebuffer(this.framebuffer)};var _e=function(c,m,d){this.func=c,this.mask=m,this.range=d};_e.ReadOnly=!1,_e.ReadWrite=!0,_e.disabled=new _e(519,_e.ReadOnly,[0,1]);var Ae=function(c,m,d,x,k,D){this.test=c,this.ref=m,this.mask=d,this.fail=x,this.depthFail=k,this.pass=D};Ae.disabled=new Ae({func:519,mask:0},0,0,7680,7680,7680);var je=function(c,m,d){this.blendFunction=c,this.blendColor=m,this.mask=d};je.disabled=new je(je.Replace=[1,0],f.Color.transparent,[!1,!1,!1,!1]),je.unblended=new je(je.Replace,f.Color.transparent,[!0,!0,!0,!0]),je.alphaBlended=new je([1,771],f.Color.transparent,[!0,!0,!0,!0]);var Ge=function(c,m,d){this.enable=c,this.mode=m,this.frontFace=d};Ge.disabled=new Ge(!1,1029,2305),Ge.backCCW=new Ge(!0,1029,2305);var ye=function(c){this.gl=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new wi(this),this.clearDepth=new nr(this),this.clearStencil=new Pr(this),this.colorMask=new ho(this),this.depthMask=new Jn(this),this.stencilMask=new Fo(this),this.stencilFunc=new xn(this),this.stencilOp=new po(this),this.stencilTest=new Yn(this),this.depthRange=new Wi(this),this.depthTest=new Nn(this),this.depthFunc=new Ao(this),this.blend=new $n(this),this.blendFunc=new Ua(this),this.blendColor=new qe(this),this.blendEquation=new _t(this),this.cullFace=new Ci(this),this.cullFaceSide=new fr(this),this.frontFace=new wr(this),this.program=new Qn(this),this.activeTexture=new eo(this),this.viewport=new sa(this),this.bindFramebuffer=new $r(this),this.bindRenderbuffer=new Jt(this),this.bindTexture=new ar(this),this.bindVertexBuffer=new Yi(this),this.bindElementBuffer=new Rn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new to(this),this.pixelStoreUnpack=new Gi(this),this.pixelStoreUnpackPremultiplyAlpha=new _a(this),this.pixelStoreUnpackFlipY=new Uo(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=c.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(c.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)};ye.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ye.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ye.prototype.createIndexBuffer=function(c,m){return new Mt(this,c,m)},ye.prototype.createVertexBuffer=function(c,m,d){return new Ft(this,c,m,d)},ye.prototype.createRenderbuffer=function(c,m,d){var x=this.gl,k=x.createRenderbuffer();return this.bindRenderbuffer.set(k),x.renderbufferStorage(x.RENDERBUFFER,c,m,d),this.bindRenderbuffer.set(null),k},ye.prototype.createFramebuffer=function(c,m,d){return new le(this,c,m,d)},ye.prototype.clear=function(c){var m=c.color,d=c.depth,x=this.gl,k=0;m&&(k|=x.COLOR_BUFFER_BIT,this.clearColor.set(m),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(k|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),x.clear(k)},ye.prototype.setCullFace=function(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))},ye.prototype.setDepthMode=function(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)},ye.prototype.setStencilMode=function(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)},ye.prototype.setColorMode=function(c){f.deepEqual(c.blendFunction,je.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)},ye.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Me=function(c){function m(d,x,k){var D=this;c.call(this),this.id=d,this.dispatcher=k,this.on("data",function(B){B.dataType==="source"&&B.sourceDataType==="metadata"&&(D._sourceLoaded=!0),D._sourceLoaded&&!D._paused&&B.dataType==="source"&&B.sourceDataType==="content"&&(D.reload(),D.transform&&D.update(D.transform))}),this.on("error",function(){D._sourceErrored=!0}),this._source=function(B,q,Y,ie){var he=new Ji[q.type](B,q,Y,ie);if(he.id!==B)throw new Error("Expected Source id to be "+B+" instead of "+he.id);return f.bindAll(["load","abort","unload","serialize","prepare"],he),he}(d,x,k,this),this._tiles={},this._cache=new Li(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new f.SourceFeatureState}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.onAdd=function(d){this.map=d,this._maxTileCacheSize=d?d._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(d)},m.prototype.onRemove=function(d){this._source&&this._source.onRemove&&this._source.onRemove(d)},m.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var d in this._tiles){var x=this._tiles[d];if(x.state!=="loaded"&&x.state!=="errored")return!1}return!0},m.prototype.getSource=function(){return this._source},m.prototype.pause=function(){this._paused=!0},m.prototype.resume=function(){if(this._paused){var d=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,d&&this.reload(),this.transform&&this.update(this.transform)}},m.prototype._loadTile=function(d,x){return this._source.loadTile(d,x)},m.prototype._unloadTile=function(d){if(this._source.unloadTile)return this._source.unloadTile(d,function(){})},m.prototype._abortTile=function(d){if(this._source.abortTile)return this._source.abortTile(d,function(){})},m.prototype.serialize=function(){return this._source.serialize()},m.prototype.prepare=function(d){for(var x in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var k=this._tiles[x];k.upload(d),k.prepare(this.map.style.imageManager)}},m.prototype.getIds=function(){return f.values(this._tiles).map(function(d){return d.tileID}).sort(Qe).map(function(d){return d.key})},m.prototype.getRenderableIds=function(d){var x=this,k=[];for(var D in this._tiles)this._isIdRenderable(D,d)&&k.push(this._tiles[D]);return d?k.sort(function(B,q){var Y=B.tileID,ie=q.tileID,he=new f.Point(Y.canonical.x,Y.canonical.y)._rotate(x.transform.angle),de=new f.Point(ie.canonical.x,ie.canonical.y)._rotate(x.transform.angle);return Y.overscaledZ-ie.overscaledZ||de.y-he.y||de.x-he.x}).map(function(B){return B.tileID.key}):k.map(function(B){return B.tileID}).sort(Qe).map(function(B){return B.key})},m.prototype.hasRenderableParent=function(d){var x=this.findLoadedParent(d,0);return!!x&&this._isIdRenderable(x.tileID.key)},m.prototype._isIdRenderable=function(d,x){return this._tiles[d]&&this._tiles[d].hasData()&&!this._coveredTiles[d]&&(x||!this._tiles[d].holdingForFade())},m.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var d in this._cache.reset(),this._tiles)this._tiles[d].state!=="errored"&&this._reloadTile(d,"reloading")},m.prototype._reloadTile=function(d,x){var k=this._tiles[d];k&&(k.state!=="loading"&&(k.state=x),this._loadTile(k,this._tileLoaded.bind(this,k,d,x)))},m.prototype._tileLoaded=function(d,x,k,D){if(D)return d.state="errored",void(D.status!==404?this._source.fire(new f.ErrorEvent(D,{tile:d})):this.update(this.transform));d.timeAdded=f.browser.now(),k==="expired"&&(d.refreshedUponExpiration=!0),this._setTileReloadTimer(x,d),this.getSource().type==="raster-dem"&&d.dem&&this._backfillDEM(d),this._state.initializeTileState(d,this.map?this.map.painter:null),this._source.fire(new f.Event("data",{dataType:"source",tile:d,coord:d.tileID}))},m.prototype._backfillDEM=function(d){for(var x=this.getRenderableIds(),k=0;k<x.length;k++){var D=x[k];if(d.neighboringTiles&&d.neighboringTiles[D]){var B=this.getTileByID(D);q(d,B),q(B,d)}}function q(Y,ie){Y.needsHillshadePrepare=!0;var he=ie.tileID.canonical.x-Y.tileID.canonical.x,de=ie.tileID.canonical.y-Y.tileID.canonical.y,me=Math.pow(2,Y.tileID.canonical.z),ze=ie.tileID.key;he===0&&de===0||Math.abs(de)>1||(Math.abs(he)>1&&(Math.abs(he+me)===1?he+=me:Math.abs(he-me)===1&&(he-=me)),ie.dem&&Y.dem&&(Y.dem.backfillBorder(ie.dem,he,de),Y.neighboringTiles&&Y.neighboringTiles[ze]&&(Y.neighboringTiles[ze].backfilled=!0)))}},m.prototype.getTile=function(d){return this.getTileByID(d.key)},m.prototype.getTileByID=function(d){return this._tiles[d]},m.prototype._retainLoadedChildren=function(d,x,k,D){for(var B in this._tiles){var q=this._tiles[B];if(!(D[B]||!q.hasData()||q.tileID.overscaledZ<=x||q.tileID.overscaledZ>k)){for(var Y=q.tileID;q&&q.tileID.overscaledZ>x+1;){var ie=q.tileID.scaledTo(q.tileID.overscaledZ-1);(q=this._tiles[ie.key])&&q.hasData()&&(Y=ie)}for(var he=Y;he.overscaledZ>x;)if(d[(he=he.scaledTo(he.overscaledZ-1)).key]){D[Y.key]=Y;break}}}},m.prototype.findLoadedParent=function(d,x){if(d.key in this._loadedParentTiles){var k=this._loadedParentTiles[d.key];return k&&k.tileID.overscaledZ>=x?k:null}for(var D=d.overscaledZ-1;D>=x;D--){var B=d.scaledTo(D),q=this._getLoadedTile(B);if(q)return q}},m.prototype._getLoadedTile=function(d){var x=this._tiles[d.key];return x&&x.hasData()?x:this._cache.getByKey(d.wrapped().key)},m.prototype.updateCacheSize=function(d){var x=Math.ceil(d.width/this._source.tileSize)+1,k=Math.ceil(d.height/this._source.tileSize)+1,D=Math.floor(x*k*5),B=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,D):D;this._cache.setMaxSize(B)},m.prototype.handleWrapJump=function(d){var x=Math.round((d-(this._prevLng===void 0?d:this._prevLng))/360);if(this._prevLng=d,x){var k={};for(var D in this._tiles){var B=this._tiles[D];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+x),k[B.tileID.key]=B}for(var q in this._tiles=k,this._timers)clearTimeout(this._timers[q]),delete this._timers[q];for(var Y in this._tiles)this._setTileReloadTimer(Y,this._tiles[Y])}},m.prototype.update=function(d){var x=this;if(this.transform=d,this._sourceLoaded&&!this._paused){var k;this.updateCacheSize(d),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?k=d.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(It){return new f.OverscaledTileID(It.canonical.z,It.wrap,It.canonical.z,It.canonical.x,It.canonical.y)}):(k=d.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(k=k.filter(function(It){return x._source.hasTile(It)}))):k=[];var D=d.coveringZoomLevel(this._source),B=Math.max(D-m.maxOverzooming,this._source.minzoom),q=Math.max(D+m.maxUnderzooming,this._source.minzoom),Y=this._updateRetainedTiles(k,D);if(ae(this._source.type)){for(var ie={},he={},de=0,me=Object.keys(Y);de<me.length;de+=1){var ze=me[de],Ce=Y[ze],Be=this._tiles[ze];if(Be&&!(Be.fadeEndTime&&Be.fadeEndTime<=f.browser.now())){var be=this.findLoadedParent(Ce,B);be&&(this._addTile(be.tileID),ie[be.tileID.key]=be.tileID),he[ze]=Ce}}for(var Pe in this._retainLoadedChildren(he,D,q,Y),ie)Y[Pe]||(this._coveredTiles[Pe]=!0,Y[Pe]=ie[Pe])}for(var Ve in Y)this._tiles[Ve].clearFadeHold();for(var Ye=0,ot=f.keysDifference(this._tiles,Y);Ye<ot.length;Ye+=1){var lt=ot[Ye],ct=this._tiles[lt];ct.hasSymbolBuckets&&!ct.holdingForFade()?ct.setHoldDuration(this.map._fadeDuration):ct.hasSymbolBuckets&&!ct.symbolFadeFinished()||this._removeTile(lt)}this._updateLoadedParentTileCache()}},m.prototype.releaseSymbolFadeTiles=function(){for(var d in this._tiles)this._tiles[d].holdingForFade()&&this._removeTile(d)},m.prototype._updateRetainedTiles=function(d,x){for(var k={},D={},B=Math.max(x-m.maxOverzooming,this._source.minzoom),q=Math.max(x+m.maxUnderzooming,this._source.minzoom),Y={},ie=0,he=d;ie<he.length;ie+=1){var de=he[ie],me=this._addTile(de);k[de.key]=de,me.hasData()||x<this._source.maxzoom&&(Y[de.key]=de)}this._retainLoadedChildren(Y,x,q,k);for(var ze=0,Ce=d;ze<Ce.length;ze+=1){var Be=Ce[ze],be=this._tiles[Be.key];if(!be.hasData()){if(x+1>this._source.maxzoom){var Pe=Be.children(this._source.maxzoom)[0],Ve=this.getTile(Pe);if(Ve&&Ve.hasData()){k[Pe.key]=Pe;continue}}else{var Ye=Be.children(this._source.maxzoom);if(k[Ye[0].key]&&k[Ye[1].key]&&k[Ye[2].key]&&k[Ye[3].key])continue}for(var ot=be.wasRequested(),lt=Be.overscaledZ-1;lt>=B;--lt){var ct=Be.scaledTo(lt);if(D[ct.key]||(D[ct.key]=!0,!(be=this.getTile(ct))&&ot&&(be=this._addTile(ct)),be&&(k[ct.key]=ct,ot=be.wasRequested(),be.hasData())))break}}}return k},m.prototype._updateLoadedParentTileCache=function(){for(var d in this._loadedParentTiles={},this._tiles){for(var x=[],k=void 0,D=this._tiles[d].tileID;D.overscaledZ>0;){if(D.key in this._loadedParentTiles){k=this._loadedParentTiles[D.key];break}x.push(D.key);var B=D.scaledTo(D.overscaledZ-1);if(k=this._getLoadedTile(B))break;D=B}for(var q=0,Y=x;q<Y.length;q+=1)this._loadedParentTiles[Y[q]]=k}},m.prototype._addTile=function(d){var x=this._tiles[d.key];if(x)return x;(x=this._cache.getAndRemove(d))&&(this._setTileReloadTimer(d.key,x),x.tileID=d,this._state.initializeTileState(x,this.map?this.map.painter:null),this._cacheTimers[d.key]&&(clearTimeout(this._cacheTimers[d.key]),delete this._cacheTimers[d.key],this._setTileReloadTimer(d.key,x)));var k=Boolean(x);return k||(x=new f.Tile(d,this._source.tileSize*d.overscaleFactor()),this._loadTile(x,this._tileLoaded.bind(this,x,d.key,x.state))),x?(x.uses++,this._tiles[d.key]=x,k||this._source.fire(new f.Event("dataloading",{tile:x,coord:x.tileID,dataType:"source"})),x):null},m.prototype._setTileReloadTimer=function(d,x){var k=this;d in this._timers&&(clearTimeout(this._timers[d]),delete this._timers[d]);var D=x.getExpiryTimeout();D&&(this._timers[d]=setTimeout(function(){k._reloadTile(d,"expired"),delete k._timers[d]},D))},m.prototype._removeTile=function(d){var x=this._tiles[d];x&&(x.uses--,delete this._tiles[d],this._timers[d]&&(clearTimeout(this._timers[d]),delete this._timers[d]),x.uses>0||(x.hasData()&&x.state!=="reloading"?this._cache.add(x.tileID,x,x.getExpiryTimeout()):(x.aborted=!0,this._abortTile(x),this._unloadTile(x))))},m.prototype.clearTiles=function(){for(var d in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(d);this._cache.reset()},m.prototype.tilesIn=function(d,x,k){var D=this,B=[],q=this.transform;if(!q)return B;for(var Y=k?q.getCameraQueryGeometry(d):d,ie=d.map(function(lt){return q.pointCoordinate(lt)}),he=Y.map(function(lt){return q.pointCoordinate(lt)}),de=this.getIds(),me=1/0,ze=1/0,Ce=-1/0,Be=-1/0,be=0,Pe=he;be<Pe.length;be+=1){var Ve=Pe[be];me=Math.min(me,Ve.x),ze=Math.min(ze,Ve.y),Ce=Math.max(Ce,Ve.x),Be=Math.max(Be,Ve.y)}for(var Ye=function(lt){var ct=D._tiles[de[lt]];if(!ct.holdingForFade()){var It=ct.tileID,Ot=Math.pow(2,q.zoom-ct.tileID.overscaledZ),Rt=x*ct.queryPadding*f.EXTENT/ct.tileSize/Ot,ii=[It.getTilePoint(new f.MercatorCoordinate(me,ze)),It.getTilePoint(new f.MercatorCoordinate(Ce,Be))];if(ii[0].x-Rt<f.EXTENT&&ii[0].y-Rt<f.EXTENT&&ii[1].x+Rt>=0&&ii[1].y+Rt>=0){var gi=ie.map(function(yi){return It.getTilePoint(yi)}),Ii=he.map(function(yi){return It.getTilePoint(yi)});B.push({tile:ct,tileID:It,queryGeometry:gi,cameraQueryGeometry:Ii,scale:Ot})}}},ot=0;ot<de.length;ot++)Ye(ot);return B},m.prototype.getVisibleCoordinates=function(d){for(var x=this,k=this.getRenderableIds(d).map(function(Y){return x._tiles[Y].tileID}),D=0,B=k;D<B.length;D+=1){var q=B[D];q.posMatrix=this.transform.calculatePosMatrix(q.toUnwrapped())}return k},m.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(ae(this._source.type))for(var d in this._tiles){var x=this._tiles[d];if(x.fadeEndTime!==void 0&&x.fadeEndTime>=f.browser.now())return!0}return!1},m.prototype.setFeatureState=function(d,x,k){this._state.updateState(d=d||"_geojsonTileLayer",x,k)},m.prototype.removeFeatureState=function(d,x,k){this._state.removeFeatureState(d=d||"_geojsonTileLayer",x,k)},m.prototype.getFeatureState=function(d,x){return this._state.getState(d=d||"_geojsonTileLayer",x)},m.prototype.setDependencies=function(d,x,k){var D=this._tiles[d];D&&D.setDependencies(x,k)},m.prototype.reloadTilesForDependencies=function(d,x){for(var k in this._tiles)this._tiles[k].hasDependency(d,x)&&this._reloadTile(k,"reloading");this._cache.filter(function(D){return!D.hasDependency(d,x)})},m}(f.Evented);function Qe(c,m){var d=Math.abs(2*c.wrap)-+(c.wrap<0),x=Math.abs(2*m.wrap)-+(m.wrap<0);return c.overscaledZ-m.overscaledZ||x-d||m.canonical.y-c.canonical.y||m.canonical.x-c.canonical.x}function ae(c){return c==="raster"||c==="image"||c==="video"}function H(){return new f.window.Worker(qi.workerUrl)}Me.maxOverzooming=10,Me.maxUnderzooming=3;var W="mapboxgl_preloaded_worker_pool",ne=function(){this.active={}};ne.prototype.acquire=function(c){if(!this.workers)for(this.workers=[];this.workers.length<ne.workerCount;)this.workers.push(new H);return this.active[c]=!0,this.workers.slice()},ne.prototype.release=function(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(function(m){m.terminate()}),this.workers=null)},ne.prototype.isPreloaded=function(){return!!this.active[W]},ne.prototype.numActive=function(){return Object.keys(this.active).length};var ce,ve=Math.floor(f.browser.hardwareConcurrency/2);function fe(){return ce||(ce=new ne),ce}function Ie(c,m){var d={};for(var x in c)x!=="ref"&&(d[x]=c[x]);return f.refProperties.forEach(function(k){k in m&&(d[k]=m[k])}),d}function Ee(c){c=c.slice();for(var m=Object.create(null),d=0;d<c.length;d++)m[c[d].id]=c[d];for(var x=0;x<c.length;x++)"ref"in c[x]&&(c[x]=Ie(c[x],m[c[x].ref]));return c}ne.workerCount=Math.max(Math.min(ve,6),1);var Te={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function et(c,m,d){d.push({command:Te.addSource,args:[c,m[c]]})}function Ke(c,m,d){m.push({command:Te.removeSource,args:[c]}),d[c]=!0}function tt(c,m,d,x){Ke(c,d,x),et(c,m,d)}function jt(c,m,d){var x;for(x in c[d])if(c[d].hasOwnProperty(x)&&x!=="data"&&!f.deepEqual(c[d][x],m[d][x]))return!1;for(x in m[d])if(m[d].hasOwnProperty(x)&&x!=="data"&&!f.deepEqual(c[d][x],m[d][x]))return!1;return!0}function Ct(c,m,d,x,k,D){var B;for(B in m=m||{},c=c||{})c.hasOwnProperty(B)&&(f.deepEqual(c[B],m[B])||d.push({command:D,args:[x,B,m[B],k]}));for(B in m)m.hasOwnProperty(B)&&!c.hasOwnProperty(B)&&(f.deepEqual(c[B],m[B])||d.push({command:D,args:[x,B,m[B],k]}))}function Ut(c){return c.id}function Zt(c,m){return c[m.id]=m,c}var Xi=function(c,m){this.reset(c,m)};Xi.prototype.reset=function(c,m){this.points=c||[],this._distances=[0];for(var d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Xi.prototype.lerp=function(c){if(this.points.length===1)return this.points[0];c=f.clamp(c,0,1);for(var m=1,d=this._distances[m],x=c*this.paddedLength+this.padding;d<x&&m<this._distances.length;)d=this._distances[++m];var k=m-1,D=this._distances[k],B=d-D,q=B>0?(x-D)/B:0;return this.points[k].mult(1-q).add(this.points[m].mult(q))};var vi=function(c,m,d){var x=this.boxCells=[],k=this.circleCells=[];this.xCellCount=Math.ceil(c/d),this.yCellCount=Math.ceil(m/d);for(var D=0;D<this.xCellCount*this.yCellCount;D++)x.push([]),k.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=m,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0};function Pi(c,m,d,x,k){var D=f.create();return m?(f.scale(D,D,[1/k,1/k,1]),d||f.rotateZ(D,D,x.angle)):f.multiply(D,x.labelPlaneMatrix,c),D}function di(c,m,d,x,k){if(m){var D=f.clone(c);return f.scale(D,D,[k,k,1]),d||f.rotateZ(D,D,-x.angle),D}return x.glCoordMatrix}function ei(c,m){var d=[c.x,c.y,0,1];Bn(d,d,m);var x=d[3];return{point:new f.Point(d[0]/x,d[1]/x),signedDistanceFromCamera:x}}function Ui(c,m){return .5+c/m*.5}function Ir(c,m){var d=c[0]/c[3],x=c[1]/c[3];return d>=-m[0]&&d<=m[0]&&x>=-m[1]&&x<=m[1]}function kn(c,m,d,x,k,D,B,q){var Y=x?c.textSizeData:c.iconSizeData,ie=f.evaluateSizeForZoom(Y,d.transform.zoom),he=[256/d.width*2+1,256/d.height*2+1],de=x?c.text.dynamicLayoutVertexArray:c.icon.dynamicLayoutVertexArray;de.clear();for(var me=c.lineVertexArray,ze=x?c.text.placedSymbolArray:c.icon.placedSymbolArray,Ce=d.transform.width/d.transform.height,Be=!1,be=0;be<ze.length;be++){var Pe=ze.get(be);if(Pe.hidden||Pe.writingMode===f.WritingMode.vertical&&!Be)Co(Pe.numGlyphs,de);else{Be=!1;var Ve=[Pe.anchorX,Pe.anchorY,0,1];if(f.transformMat4(Ve,Ve,m),Ir(Ve,he)){var Ye=Ui(d.transform.cameraToCenterDistance,Ve[3]),ot=f.evaluateSizeForFeature(Y,ie,Pe),lt=B?ot/Ye:ot*Ye,ct=new f.Point(Pe.anchorX,Pe.anchorY),It=ei(ct,k).point,Ot={},Rt=Fl(Pe,lt,!1,q,m,k,D,c.glyphOffsetArray,me,de,It,ct,Ot,Ce);Be=Rt.useVertical,(Rt.notEnoughRoom||Be||Rt.needsFlipping&&Fl(Pe,lt,!0,q,m,k,D,c.glyphOffsetArray,me,de,It,ct,Ot,Ce).notEnoughRoom)&&Co(Pe.numGlyphs,de)}else Co(Pe.numGlyphs,de)}}x?c.text.dynamicLayoutVertexBuffer.updateData(de):c.icon.dynamicLayoutVertexBuffer.updateData(de)}function Cr(c,m,d,x,k,D,B,q,Y,ie,he){var de=q.glyphStartIndex+q.numGlyphs,me=q.lineStartIndex,ze=q.lineStartIndex+q.lineLength,Ce=m.getoffsetX(q.glyphStartIndex),Be=m.getoffsetX(de-1),be=Sn(c*Ce,d,x,k,D,B,q.segment,me,ze,Y,ie,he);if(!be)return null;var Pe=Sn(c*Be,d,x,k,D,B,q.segment,me,ze,Y,ie,he);return Pe?{first:be,last:Pe}:null}function Eo(c,m,d,x){return c===f.WritingMode.horizontal&&Math.abs(d.y-m.y)>Math.abs(d.x-m.x)*x?{useVertical:!0}:(c===f.WritingMode.vertical?m.y<d.y:m.x>d.x)?{needsFlipping:!0}:null}function Fl(c,m,d,x,k,D,B,q,Y,ie,he,de,me,ze){var Ce,Be=m/24,be=c.lineOffsetX*Be,Pe=c.lineOffsetY*Be;if(c.numGlyphs>1){var Ve=c.glyphStartIndex+c.numGlyphs,Ye=c.lineStartIndex,ot=c.lineStartIndex+c.lineLength,lt=Cr(Be,q,be,Pe,d,he,de,c,Y,D,me);if(!lt)return{notEnoughRoom:!0};var ct=ei(lt.first.point,B).point,It=ei(lt.last.point,B).point;if(x&&!d){var Ot=Eo(c.writingMode,ct,It,ze);if(Ot)return Ot}Ce=[lt.first];for(var Rt=c.glyphStartIndex+1;Rt<Ve-1;Rt++)Ce.push(Sn(Be*q.getoffsetX(Rt),be,Pe,d,he,de,c.segment,Ye,ot,Y,D,me));Ce.push(lt.last)}else{if(x&&!d){var ii=ei(de,k).point,gi=c.lineStartIndex+c.segment+1,Ii=new f.Point(Y.getx(gi),Y.gety(gi)),yi=ei(Ii,k),lr=yi.signedDistanceFromCamera>0?yi.point:Gr(de,Ii,ii,1,k),si=Eo(c.writingMode,ii,lr,ze);if(si)return si}var ji=Sn(Be*q.getoffsetX(c.glyphStartIndex),be,Pe,d,he,de,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,Y,D,me);if(!ji)return{notEnoughRoom:!0};Ce=[ji]}for(var ir=0,Oi=Ce;ir<Oi.length;ir+=1){var Di=Oi[ir];f.addDynamicAttributes(ie,Di.point,Di.angle)}return{}}function Gr(c,m,d,x,k){var D=ei(c.add(c.sub(m)._unit()),k).point,B=d.sub(D);return d.add(B._mult(x/B.mag()))}function Sn(c,m,d,x,k,D,B,q,Y,ie,he,de){var me=x?c-m:c+m,ze=me>0?1:-1,Ce=0;x&&(ze*=-1,Ce=Math.PI),ze<0&&(Ce+=Math.PI);for(var Be=ze>0?q+B:q+B+1,be=k,Pe=k,Ve=0,Ye=0,ot=Math.abs(me),lt=[];Ve+Ye<=ot;){if((Be+=ze)<q||Be>=Y)return null;if(Pe=be,lt.push(be),(be=de[Be])===void 0){var ct=new f.Point(ie.getx(Be),ie.gety(Be)),It=ei(ct,he);if(It.signedDistanceFromCamera>0)be=de[Be]=It.point;else{var Ot=Be-ze;be=Gr(Ve===0?D:new f.Point(ie.getx(Ot),ie.gety(Ot)),ct,Pe,ot-Ve+1,he)}}Ve+=Ye,Ye=Pe.dist(be)}var Rt=(ot-Ve)/Ye,ii=be.sub(Pe),gi=ii.mult(Rt)._add(Pe);gi._add(ii._unit()._perp()._mult(d*ze));var Ii=Ce+Math.atan2(be.y-Pe.y,be.x-Pe.x);return lt.push(gi),{point:gi,angle:Ii,path:lt}}vi.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},vi.prototype.insert=function(c,m,d,x,k){this._forEachCell(m,d,x,k,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(m),this.bboxes.push(d),this.bboxes.push(x),this.bboxes.push(k)},vi.prototype.insertCircle=function(c,m,d,x){this._forEachCell(m-x,d-x,m+x,d+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(m),this.circles.push(d),this.circles.push(x)},vi.prototype._insertBoxCell=function(c,m,d,x,k,D){this.boxCells[k].push(D)},vi.prototype._insertCircleCell=function(c,m,d,x,k,D){this.circleCells[k].push(D)},vi.prototype._query=function(c,m,d,x,k,D){if(d<0||c>this.width||x<0||m>this.height)return!k&&[];var B=[];if(c<=0&&m<=0&&this.width<=d&&this.height<=x){if(k)return!0;for(var q=0;q<this.boxKeys.length;q++)B.push({key:this.boxKeys[q],x1:this.bboxes[4*q],y1:this.bboxes[4*q+1],x2:this.bboxes[4*q+2],y2:this.bboxes[4*q+3]});for(var Y=0;Y<this.circleKeys.length;Y++){var ie=this.circles[3*Y],he=this.circles[3*Y+1],de=this.circles[3*Y+2];B.push({key:this.circleKeys[Y],x1:ie-de,y1:he-de,x2:ie+de,y2:he+de})}return D?B.filter(D):B}return this._forEachCell(c,m,d,x,this._queryCell,B,{hitTest:k,seenUids:{box:{},circle:{}}},D),k?B.length>0:B},vi.prototype._queryCircle=function(c,m,d,x,k){var D=c-d,B=c+d,q=m-d,Y=m+d;if(B<0||D>this.width||Y<0||q>this.height)return!x&&[];var ie=[];return this._forEachCell(D,q,B,Y,this._queryCellCircle,ie,{hitTest:x,circle:{x:c,y:m,radius:d},seenUids:{box:{},circle:{}}},k),x?ie.length>0:ie},vi.prototype.query=function(c,m,d,x,k){return this._query(c,m,d,x,!1,k)},vi.prototype.hitTest=function(c,m,d,x,k){return this._query(c,m,d,x,!0,k)},vi.prototype.hitTestCircle=function(c,m,d,x){return this._queryCircle(c,m,d,!0,x)},vi.prototype._queryCell=function(c,m,d,x,k,D,B,q){var Y=B.seenUids,ie=this.boxCells[k];if(ie!==null)for(var he=this.bboxes,de=0,me=ie;de<me.length;de+=1){var ze=me[de];if(!Y.box[ze]){Y.box[ze]=!0;var Ce=4*ze;if(c<=he[Ce+2]&&m<=he[Ce+3]&&d>=he[Ce+0]&&x>=he[Ce+1]&&(!q||q(this.boxKeys[ze]))){if(B.hitTest)return D.push(!0),!0;D.push({key:this.boxKeys[ze],x1:he[Ce],y1:he[Ce+1],x2:he[Ce+2],y2:he[Ce+3]})}}}var Be=this.circleCells[k];if(Be!==null)for(var be=this.circles,Pe=0,Ve=Be;Pe<Ve.length;Pe+=1){var Ye=Ve[Pe];if(!Y.circle[Ye]){Y.circle[Ye]=!0;var ot=3*Ye;if(this._circleAndRectCollide(be[ot],be[ot+1],be[ot+2],c,m,d,x)&&(!q||q(this.circleKeys[Ye]))){if(B.hitTest)return D.push(!0),!0;var lt=be[ot],ct=be[ot+1],It=be[ot+2];D.push({key:this.circleKeys[Ye],x1:lt-It,y1:ct-It,x2:lt+It,y2:ct+It})}}}},vi.prototype._queryCellCircle=function(c,m,d,x,k,D,B,q){var Y=B.circle,ie=B.seenUids,he=this.boxCells[k];if(he!==null)for(var de=this.bboxes,me=0,ze=he;me<ze.length;me+=1){var Ce=ze[me];if(!ie.box[Ce]){ie.box[Ce]=!0;var Be=4*Ce;if(this._circleAndRectCollide(Y.x,Y.y,Y.radius,de[Be+0],de[Be+1],de[Be+2],de[Be+3])&&(!q||q(this.boxKeys[Ce])))return D.push(!0),!0}}var be=this.circleCells[k];if(be!==null)for(var Pe=this.circles,Ve=0,Ye=be;Ve<Ye.length;Ve+=1){var ot=Ye[Ve];if(!ie.circle[ot]){ie.circle[ot]=!0;var lt=3*ot;if(this._circlesCollide(Pe[lt],Pe[lt+1],Pe[lt+2],Y.x,Y.y,Y.radius)&&(!q||q(this.circleKeys[ot])))return D.push(!0),!0}}},vi.prototype._forEachCell=function(c,m,d,x,k,D,B,q){for(var Y=this._convertToXCellCoord(c),ie=this._convertToYCellCoord(m),he=this._convertToXCellCoord(d),de=this._convertToYCellCoord(x),me=Y;me<=he;me++)for(var ze=ie;ze<=de;ze++)if(k.call(this,c,m,d,x,this.xCellCount*ze+me,D,B,q))return},vi.prototype._convertToXCellCoord=function(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))},vi.prototype._convertToYCellCoord=function(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))},vi.prototype._circlesCollide=function(c,m,d,x,k,D){var B=x-c,q=k-m,Y=d+D;return Y*Y>B*B+q*q},vi.prototype._circleAndRectCollide=function(c,m,d,x,k,D,B){var q=(D-x)/2,Y=Math.abs(c-(x+q));if(Y>q+d)return!1;var ie=(B-k)/2,he=Math.abs(m-(k+ie));if(he>ie+d)return!1;if(Y<=q||he<=ie)return!0;var de=Y-q,me=he-ie;return de*de+me*me<=d*d};var Gs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Co(c,m){for(var d=0;d<c;d++){var x=m.length;m.resize(x+4),m.float32.set(Gs,3*x)}}function Bn(c,m,d){var x=m[0],k=m[1];return c[0]=d[0]*x+d[4]*k+d[12],c[1]=d[1]*x+d[5]*k+d[13],c[3]=d[3]*x+d[7]*k+d[15],c}var la=function(c,m,d){m===void 0&&(m=new vi(c.width+200,c.height+200,25)),d===void 0&&(d=new vi(c.width+200,c.height+200,25)),this.transform=c,this.grid=m,this.ignoredGrid=d,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+100,this.screenBottomBoundary=c.height+100,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200};function Qr(c,m,d){return m*(f.EXTENT/(c.tileSize*Math.pow(2,d-c.tileID.overscaledZ)))}la.prototype.placeCollisionBox=function(c,m,d,x,k){var D=this.projectAndGetPerspectiveRatio(x,c.anchorPointX,c.anchorPointY),B=d*D.perspectiveRatio,q=c.x1*B+D.point.x,Y=c.y1*B+D.point.y,ie=c.x2*B+D.point.x,he=c.y2*B+D.point.y;return!this.isInsideGrid(q,Y,ie,he)||!m&&this.grid.hitTest(q,Y,ie,he,k)?{box:[],offscreen:!1}:{box:[q,Y,ie,he],offscreen:this.isOffscreen(q,Y,ie,he)}},la.prototype.placeCollisionCircles=function(c,m,d,x,k,D,B,q,Y,ie,he,de,me){var ze=[],Ce=new f.Point(m.anchorX,m.anchorY),Be=ei(Ce,D),be=Ui(this.transform.cameraToCenterDistance,Be.signedDistanceFromCamera),Pe=(ie?k/be:k*be)/f.ONE_EM,Ve=ei(Ce,B).point,Ye=Cr(Pe,x,m.lineOffsetX*Pe,m.lineOffsetY*Pe,!1,Ve,Ce,m,d,B,{}),ot=!1,lt=!1,ct=!0;if(Ye){for(var It=.5*de*be+me,Ot=new f.Point(-100,-100),Rt=new f.Point(this.screenRightBoundary,this.screenBottomBoundary),ii=new Xi,gi=Ye.first,Ii=Ye.last,yi=[],lr=gi.path.length-1;lr>=1;lr--)yi.push(gi.path[lr]);for(var si=1;si<Ii.path.length;si++)yi.push(Ii.path[si]);var ji=2.5*It;if(q){var ir=yi.map(function(Sa){return ei(Sa,q)});yi=ir.some(function(Sa){return Sa.signedDistanceFromCamera<=0})?[]:ir.map(function(Sa){return Sa.point})}var Oi=[];if(yi.length>0){for(var Di=yi[0].clone(),Zi=yi[0].clone(),zi=1;zi<yi.length;zi++)Di.x=Math.min(Di.x,yi[zi].x),Di.y=Math.min(Di.y,yi[zi].y),Zi.x=Math.max(Zi.x,yi[zi].x),Zi.y=Math.max(Zi.y,yi[zi].y);Oi=Di.x>=Ot.x&&Zi.x<=Rt.x&&Di.y>=Ot.y&&Zi.y<=Rt.y?[yi]:Zi.x<Ot.x||Di.x>Rt.x||Zi.y<Ot.y||Di.y>Rt.y?[]:f.clipLine([yi],Ot.x,Ot.y,Rt.x,Rt.y)}for(var Ei=0,mn=Oi;Ei<mn.length;Ei+=1){var Cn;ii.reset(mn[Ei],.25*It),Cn=ii.length<=.5*It?1:Math.ceil(ii.paddedLength/ji)+1;for(var Fn=0;Fn<Cn;Fn++){var To=Fn/Math.max(Cn-1,1),wn=ii.lerp(To),hr=wn.x+100,Jo=wn.y+100;ze.push(hr,Jo,It,0);var qo=hr-It,wa=Jo-It,ro=hr+It,Ea=Jo+It;if(ct=ct&&this.isOffscreen(qo,wa,ro,Ea),lt=lt||this.isInsideGrid(qo,wa,ro,Ea),!c&&this.grid.hitTestCircle(hr,Jo,It,he)&&(ot=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:ot}}}}return{circles:!Y&&ot||!lt?[]:ze,offscreen:ct,collisionDetected:ot}},la.prototype.queryRenderedSymbols=function(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var m=[],d=1/0,x=1/0,k=-1/0,D=-1/0,B=0,q=c;B<q.length;B+=1){var Y=q[B],ie=new f.Point(Y.x+100,Y.y+100);d=Math.min(d,ie.x),x=Math.min(x,ie.y),k=Math.max(k,ie.x),D=Math.max(D,ie.y),m.push(ie)}for(var he={},de={},me=0,ze=this.grid.query(d,x,k,D).concat(this.ignoredGrid.query(d,x,k,D));me<ze.length;me+=1){var Ce=ze[me],Be=Ce.key;if(he[Be.bucketInstanceId]===void 0&&(he[Be.bucketInstanceId]={}),!he[Be.bucketInstanceId][Be.featureIndex]){var be=[new f.Point(Ce.x1,Ce.y1),new f.Point(Ce.x2,Ce.y1),new f.Point(Ce.x2,Ce.y2),new f.Point(Ce.x1,Ce.y2)];f.polygonIntersectsPolygon(m,be)&&(he[Be.bucketInstanceId][Be.featureIndex]=!0,de[Be.bucketInstanceId]===void 0&&(de[Be.bucketInstanceId]=[]),de[Be.bucketInstanceId].push(Be.featureIndex))}}return de},la.prototype.insertCollisionBox=function(c,m,d,x,k){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:x,collisionGroupID:k},c[0],c[1],c[2],c[3])},la.prototype.insertCollisionCircles=function(c,m,d,x,k){for(var D=m?this.ignoredGrid:this.grid,B={bucketInstanceId:d,featureIndex:x,collisionGroupID:k},q=0;q<c.length;q+=4)D.insertCircle(B,c[q],c[q+1],c[q+2])},la.prototype.projectAndGetPerspectiveRatio=function(c,m,d){var x=[m,d,0,1];return Bn(x,x,c),{point:new f.Point((x[0]/x[3]+1)/2*this.transform.width+100,(-x[1]/x[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/x[3]*.5}},la.prototype.isOffscreen=function(c,m,d,x){return d<100||c>=this.screenRightBoundary||x<100||m>this.screenBottomBoundary},la.prototype.isInsideGrid=function(c,m,d,x){return d>=0&&c<this.gridRightBoundary&&x>=0&&m<this.gridBottomBoundary},la.prototype.getViewportMatrix=function(){var c=f.identity([]);return f.translate(c,c,[-100,-100,0]),c};var ua=function(c,m,d,x){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?m:-m))):x&&d?1:0,this.placed=d};ua.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var No=function(c,m,d,x,k){this.text=new ua(c?c.text:null,m,d,k),this.icon=new ua(c?c.icon:null,m,x,k)};No.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ec=function(c,m,d){this.text=c,this.icon=m,this.skipFade=d},ca=function(){this.invProjMatrix=f.create(),this.viewportMatrix=f.create(),this.circles=[]},Zs=function(c,m,d,x,k){this.bucketInstanceId=c,this.featureIndex=m,this.sourceLayerIndex=d,this.bucketIndex=x,this.tileID=k},va=function(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}};function In(c,m,d,x,k){var D=f.getAnchorAlignment(c),B=-(D.horizontalAlign-.5)*m,q=-(D.verticalAlign-.5)*d,Y=f.evaluateVariableOffset(c,x);return new f.Point(B+Y[0]*k,q+Y[1]*k)}function Zo(c,m,d,x,k,D){var B=c.x1,q=c.x2,Y=c.y1,ie=c.y2,he=c.anchorPointX,de=c.anchorPointY,me=new f.Point(m,d);return x&&me._rotate(k?D:-D),{x1:B+me.x,y1:Y+me.y,x2:q+me.x,y2:ie+me.y,anchorPointX:he,anchorPointY:de}}va.prototype.get=function(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){var m=++this.maxGroupID;this.collisionGroups[c]={ID:m,predicate:function(d){return d.collisionGroupID===m}}}return this.collisionGroups[c]};var io=function(c,m,d,x){this.transform=c.clone(),this.collisionIndex=new la(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new va(d),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}};function Na(c,m,d,x,k){c.emplaceBack(m?1:0,d?1:0,x||0,k||0),c.emplaceBack(m?1:0,d?1:0,x||0,k||0),c.emplaceBack(m?1:0,d?1:0,x||0,k||0),c.emplaceBack(m?1:0,d?1:0,x||0,k||0)}io.prototype.getBucketParts=function(c,m,d,x){var k=d.getBucket(m),D=d.latestFeatureIndex;if(k&&D&&m.id===k.layerIds[0]){var B=d.collisionBoxArray,q=k.layers[0].layout,Y=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),ie=d.tileSize/f.EXTENT,he=this.transform.calculatePosMatrix(d.tileID.toUnwrapped()),de=q.get("text-pitch-alignment")==="map",me=q.get("text-rotation-alignment")==="map",ze=Qr(d,1,this.transform.zoom),Ce=Pi(he,de,me,this.transform,ze),Be=null;if(de){var be=di(he,de,me,this.transform,ze);Be=f.multiply([],this.transform.labelPlaneMatrix,be)}this.retainedQueryData[k.bucketInstanceId]=new Zs(k.bucketInstanceId,D,k.sourceLayerIndex,k.index,d.tileID);var Pe={bucket:k,layout:q,posMatrix:he,textLabelPlaneMatrix:Ce,labelToScreenMatrix:Be,scale:Y,textPixelRatio:ie,holdingForFade:d.holdingForFade(),collisionBoxArray:B,partiallyEvaluatedTextSize:f.evaluateSizeForZoom(k.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(k.sourceID)};if(x)for(var Ve=0,Ye=k.sortKeyRanges;Ve<Ye.length;Ve+=1){var ot=Ye[Ve];c.push({sortKey:ot.sortKey,symbolInstanceStart:ot.symbolInstanceStart,symbolInstanceEnd:ot.symbolInstanceEnd,parameters:Pe})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:k.symbolInstances.length,parameters:Pe})}},io.prototype.attemptAnchorPlacement=function(c,m,d,x,k,D,B,q,Y,ie,he,de,me,ze,Ce){var Be,be=[de.textOffset0,de.textOffset1],Pe=In(c,d,x,be,k),Ve=this.collisionIndex.placeCollisionBox(Zo(m,Pe.x,Pe.y,D,B,this.transform.angle),he,q,Y,ie.predicate);if(!Ce||this.collisionIndex.placeCollisionBox(Zo(Ce,Pe.x,Pe.y,D,B,this.transform.angle),he,q,Y,ie.predicate).box.length!==0)return Ve.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[de.crossTileID]&&this.prevPlacement.placements[de.crossTileID]&&this.prevPlacement.placements[de.crossTileID].text&&(Be=this.prevPlacement.variableOffsets[de.crossTileID].anchor),this.variableOffsets[de.crossTileID]={textOffset:be,width:d,height:x,anchor:c,textBoxScale:k,prevAnchor:Be},this.markUsedJustification(me,c,de,ze),me.allowVerticalPlacement&&(this.markUsedOrientation(me,ze,de),this.placedOrientations[de.crossTileID]=ze),{shift:Pe,placedGlyphBoxes:Ve}):void 0},io.prototype.placeLayerBucketPart=function(c,m,d){var x=this,k=c.parameters,D=k.bucket,B=k.layout,q=k.posMatrix,Y=k.textLabelPlaneMatrix,ie=k.labelToScreenMatrix,he=k.textPixelRatio,de=k.holdingForFade,me=k.collisionBoxArray,ze=k.partiallyEvaluatedTextSize,Ce=k.collisionGroup,Be=B.get("text-optional"),be=B.get("icon-optional"),Pe=B.get("text-allow-overlap"),Ve=B.get("icon-allow-overlap"),Ye=B.get("text-rotation-alignment")==="map",ot=B.get("text-pitch-alignment")==="map",lt=B.get("icon-text-fit")!=="none",ct=B.get("symbol-z-order")==="viewport-y",It=Pe&&(Ve||!D.hasIconData()||be),Ot=Ve&&(Pe||!D.hasTextData()||Be);!D.collisionArrays&&me&&D.deserializeCollisionBoxes(me);var Rt=function(si,ji){if(!m[si.crossTileID])if(de)x.placements[si.crossTileID]=new ec(!1,!1,!1);else{var ir,Oi=!1,Di=!1,Zi=!0,zi=null,Ei={box:null,offscreen:null},mn={box:null,offscreen:null},Cn=null,Fn=null,To=0,wn=0,hr=0;ji.textFeatureIndex?To=ji.textFeatureIndex:si.useRuntimeCollisionCircles&&(To=si.featureIndex),ji.verticalTextFeatureIndex&&(wn=ji.verticalTextFeatureIndex);var Jo=ji.textBox;if(Jo){var qo=function(Sr){var Yo=f.WritingMode.horizontal;if(D.allowVerticalPlacement&&!Sr&&x.prevPlacement){var fa=x.prevPlacement.placedOrientations[si.crossTileID];fa&&(x.placedOrientations[si.crossTileID]=fa,x.markUsedOrientation(D,Yo=fa,si))}return Yo},wa=function(Sr,Yo){if(D.allowVerticalPlacement&&si.numVerticalGlyphVertices>0&&ji.verticalTextBox)for(var fa=0,au=D.writingModes;fa<au.length&&(au[fa]===f.WritingMode.vertical?(Ei=Yo(),mn=Ei):Ei=Sr(),!(Ei&&Ei.box&&Ei.box.length));fa+=1);else Ei=Sr()};if(B.get("text-variable-anchor")){var ro=B.get("text-variable-anchor");if(x.prevPlacement&&x.prevPlacement.variableOffsets[si.crossTileID]){var Ea=x.prevPlacement.variableOffsets[si.crossTileID];ro.indexOf(Ea.anchor)>0&&(ro=ro.filter(function(Sr){return Sr!==Ea.anchor})).unshift(Ea.anchor)}var Sa=function(Sr,Yo,fa){for(var au=Sr.x2-Sr.x1,Bu=Sr.y2-Sr.y1,Ou=si.textBoxScale,ip=lt&&!Ve?Yo:null,nl={box:[],offscreen:!1},rp=Pe?2*ro.length:ro.length,ol=0;ol<rp;++ol){var dc=x.attemptAnchorPlacement(ro[ol%ro.length],Sr,au,Bu,Ou,Ye,ot,he,q,Ce,ol>=ro.length,si,D,fa,ip);if(dc&&(nl=dc.placedGlyphBoxes)&&nl.box&&nl.box.length){Oi=!0,zi=dc.shift;break}}return nl};wa(function(){return Sa(Jo,ji.iconBox,f.WritingMode.horizontal)},function(){var Sr=ji.verticalTextBox;return D.allowVerticalPlacement&&!(Ei&&Ei.box&&Ei.box.length)&&si.numVerticalGlyphVertices>0&&Sr?Sa(Sr,ji.verticalIconBox,f.WritingMode.vertical):{box:null,offscreen:null}}),Ei&&(Oi=Ei.box,Zi=Ei.offscreen);var Lu=qo(Ei&&Ei.box);if(!Oi&&x.prevPlacement){var Du=x.prevPlacement.variableOffsets[si.crossTileID];Du&&(x.variableOffsets[si.crossTileID]=Du,x.markUsedJustification(D,Du.anchor,si,Lu))}}else{var rl=function(Sr,Yo){var fa=x.collisionIndex.placeCollisionBox(Sr,Pe,he,q,Ce.predicate);return fa&&fa.box&&fa.box.length&&(x.markUsedOrientation(D,Yo,si),x.placedOrientations[si.crossTileID]=Yo),fa};wa(function(){return rl(Jo,f.WritingMode.horizontal)},function(){var Sr=ji.verticalTextBox;return D.allowVerticalPlacement&&si.numVerticalGlyphVertices>0&&Sr?rl(Sr,f.WritingMode.vertical):{box:null,offscreen:null}}),qo(Ei&&Ei.box&&Ei.box.length)}}if(Oi=(ir=Ei)&&ir.box&&ir.box.length>0,Zi=ir&&ir.offscreen,si.useRuntimeCollisionCircles){var Ru=D.text.placedSymbolArray.get(si.centerJustifiedTextSymbolIndex),nu=f.evaluateSizeForFeature(D.textSizeData,ze,Ru),Rs=B.get("text-padding");Cn=x.collisionIndex.placeCollisionCircles(Pe,Ru,D.lineVertexArray,D.glyphOffsetArray,nu,q,Y,ie,d,ot,Ce.predicate,si.collisionCircleDiameter,Rs),Oi=Pe||Cn.circles.length>0&&!Cn.collisionDetected,Zi=Zi&&Cn.offscreen}if(ji.iconFeatureIndex&&(hr=ji.iconFeatureIndex),ji.iconBox){var ou=function(Sr){var Yo=lt&&zi?Zo(Sr,zi.x,zi.y,Ye,ot,x.transform.angle):Sr;return x.collisionIndex.placeCollisionBox(Yo,Ve,he,q,Ce.predicate)};Di=mn&&mn.box&&mn.box.length&&ji.verticalIconBox?(Fn=ou(ji.verticalIconBox)).box.length>0:(Fn=ou(ji.iconBox)).box.length>0,Zi=Zi&&Fn.offscreen}var gs=Be||si.numHorizontalGlyphVertices===0&&si.numVerticalGlyphVertices===0,no=be||si.numIconVertices===0;if(gs||no?no?gs||(Di=Di&&Oi):Oi=Di&&Oi:Di=Oi=Di&&Oi,Oi&&ir&&ir.box&&x.collisionIndex.insertCollisionBox(ir.box,B.get("text-ignore-placement"),D.bucketInstanceId,mn&&mn.box&&wn?wn:To,Ce.ID),Di&&Fn&&x.collisionIndex.insertCollisionBox(Fn.box,B.get("icon-ignore-placement"),D.bucketInstanceId,hr,Ce.ID),Cn&&(Oi&&x.collisionIndex.insertCollisionCircles(Cn.circles,B.get("text-ignore-placement"),D.bucketInstanceId,To,Ce.ID),d)){var Ia=D.bucketInstanceId,Cl=x.collisionCircleArrays[Ia];Cl===void 0&&(Cl=x.collisionCircleArrays[Ia]=new ca);for(var _s=0;_s<Cn.circles.length;_s+=4)Cl.circles.push(Cn.circles[_s+0]),Cl.circles.push(Cn.circles[_s+1]),Cl.circles.push(Cn.circles[_s+2]),Cl.circles.push(Cn.collisionDetected?1:0)}x.placements[si.crossTileID]=new ec(Oi||It,Di||Ot,Zi||D.justReloaded),m[si.crossTileID]=!0}};if(ct)for(var ii=D.getSortedSymbolIndexes(this.transform.angle),gi=ii.length-1;gi>=0;--gi){var Ii=ii[gi];Rt(D.symbolInstances.get(Ii),D.collisionArrays[Ii])}else for(var yi=c.symbolInstanceStart;yi<c.symbolInstanceEnd;yi++)Rt(D.symbolInstances.get(yi),D.collisionArrays[yi]);if(d&&D.bucketInstanceId in this.collisionCircleArrays){var lr=this.collisionCircleArrays[D.bucketInstanceId];f.invert(lr.invProjMatrix,q),lr.viewportMatrix=this.collisionIndex.getViewportMatrix()}D.justReloaded=!1},io.prototype.markUsedJustification=function(c,m,d,x){var k;k=x===f.WritingMode.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[f.getAnchorJustification(m)];for(var D=0,B=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];D<B.length;D+=1){var q=B[D];q>=0&&(c.text.placedSymbolArray.get(q).crossTileID=k>=0&&q!==k?0:d.crossTileID)}},io.prototype.markUsedOrientation=function(c,m,d){for(var x=m===f.WritingMode.horizontal||m===f.WritingMode.horizontalOnly?m:0,k=m===f.WritingMode.vertical?m:0,D=0,B=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];D<B.length;D+=1)c.text.placedSymbolArray.get(B[D]).placedOrientation=x;d.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=k)},io.prototype.commit=function(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;var m=this.prevPlacement,d=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;var x=m?m.symbolFadeChange(c):1,k=m?m.opacities:{},D=m?m.variableOffsets:{},B=m?m.placedOrientations:{};for(var q in this.placements){var Y=this.placements[q],ie=k[q];ie?(this.opacities[q]=new No(ie,x,Y.text,Y.icon),d=d||Y.text!==ie.text.placed||Y.icon!==ie.icon.placed):(this.opacities[q]=new No(null,x,Y.text,Y.icon,Y.skipFade),d=d||Y.text||Y.icon)}for(var he in k){var de=k[he];if(!this.opacities[he]){var me=new No(de,x,!1,!1);me.isHidden()||(this.opacities[he]=me,d=d||de.text.placed||de.icon.placed)}}for(var ze in D)this.variableOffsets[ze]||!this.opacities[ze]||this.opacities[ze].isHidden()||(this.variableOffsets[ze]=D[ze]);for(var Ce in B)this.placedOrientations[Ce]||!this.opacities[Ce]||this.opacities[Ce].isHidden()||(this.placedOrientations[Ce]=B[Ce]);d?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:c)},io.prototype.updateLayerOpacities=function(c,m){for(var d={},x=0,k=m;x<k.length;x+=1){var D=k[x],B=D.getBucket(c);B&&D.latestFeatureIndex&&c.id===B.layerIds[0]&&this.updateBucketOpacities(B,d,D.collisionBoxArray)}},io.prototype.updateBucketOpacities=function(c,m,d){var x=this;c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();var k=c.layers[0].layout,D=new No(null,0,!1,!1,!0),B=k.get("text-allow-overlap"),q=k.get("icon-allow-overlap"),Y=k.get("text-variable-anchor"),ie=k.get("text-rotation-alignment")==="map",he=k.get("text-pitch-alignment")==="map",de=k.get("icon-text-fit")!=="none",me=new No(null,0,B&&(q||!c.hasIconData()||k.get("icon-optional")),q&&(B||!c.hasTextData()||k.get("text-optional")),!0);!c.collisionArrays&&d&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(d);for(var ze=function(Pe,Ve,Ye){for(var ot=0;ot<Ve/4;ot++)Pe.opacityVertexArray.emplaceBack(Ye)},Ce=function(Pe){var Ve=c.symbolInstances.get(Pe),Ye=Ve.numHorizontalGlyphVertices,ot=Ve.numVerticalGlyphVertices,lt=Ve.crossTileID,ct=x.opacities[lt];m[lt]?ct=D:ct||(x.opacities[lt]=ct=me),m[lt]=!0;var It=Ve.numIconVertices>0,Ot=x.placedOrientations[Ve.crossTileID],Rt=Ot===f.WritingMode.vertical,ii=Ot===f.WritingMode.horizontal||Ot===f.WritingMode.horizontalOnly;if(Ye>0||ot>0){var gi=rc(ct.text);ze(c.text,Ye,Rt?rs:gi),ze(c.text,ot,ii?rs:gi);var Ii=ct.text.isHidden();[Ve.rightJustifiedTextSymbolIndex,Ve.centerJustifiedTextSymbolIndex,Ve.leftJustifiedTextSymbolIndex].forEach(function(Ei){Ei>=0&&(c.text.placedSymbolArray.get(Ei).hidden=Ii||Rt?1:0)}),Ve.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(Ve.verticalPlacedTextSymbolIndex).hidden=Ii||ii?1:0);var yi=x.variableOffsets[Ve.crossTileID];yi&&x.markUsedJustification(c,yi.anchor,Ve,Ot);var lr=x.placedOrientations[Ve.crossTileID];lr&&(x.markUsedJustification(c,"left",Ve,lr),x.markUsedOrientation(c,lr,Ve))}if(It){var si=rc(ct.icon),ji=!(de&&Ve.verticalPlacedIconSymbolIndex&&Rt);Ve.placedIconSymbolIndex>=0&&(ze(c.icon,Ve.numIconVertices,ji?si:rs),c.icon.placedSymbolArray.get(Ve.placedIconSymbolIndex).hidden=ct.icon.isHidden()),Ve.verticalPlacedIconSymbolIndex>=0&&(ze(c.icon,Ve.numVerticalIconVertices,ji?rs:si),c.icon.placedSymbolArray.get(Ve.verticalPlacedIconSymbolIndex).hidden=ct.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){var ir=c.collisionArrays[Pe];if(ir){var Oi=new f.Point(0,0);if(ir.textBox||ir.verticalTextBox){var Di=!0;if(Y){var Zi=x.variableOffsets[lt];Zi?(Oi=In(Zi.anchor,Zi.width,Zi.height,Zi.textOffset,Zi.textBoxScale),ie&&Oi._rotate(he?x.transform.angle:-x.transform.angle)):Di=!1}ir.textBox&&Na(c.textCollisionBox.collisionVertexArray,ct.text.placed,!Di||Rt,Oi.x,Oi.y),ir.verticalTextBox&&Na(c.textCollisionBox.collisionVertexArray,ct.text.placed,!Di||ii,Oi.x,Oi.y)}var zi=Boolean(!ii&&ir.verticalIconBox);ir.iconBox&&Na(c.iconCollisionBox.collisionVertexArray,ct.icon.placed,zi,de?Oi.x:0,de?Oi.y:0),ir.verticalIconBox&&Na(c.iconCollisionBox.collisionVertexArray,ct.icon.placed,!zi,de?Oi.x:0,de?Oi.y:0)}}},Be=0;Be<c.symbolInstances.length;Be++)Ce(Be);if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){var be=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=be.invProjMatrix,c.placementViewportMatrix=be.viewportMatrix,c.collisionCircleArray=be.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}},io.prototype.symbolFadeChange=function(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},io.prototype.zoomAdjustment=function(c){return Math.max(0,(this.transform.zoom-c)/1.5)},io.prototype.hasTransitions=function(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration},io.prototype.stillRecent=function(c,m){var d=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*d>c},io.prototype.setStale=function(){this.stale=!0};var Ul=Math.pow(2,25),wu=Math.pow(2,24),Hs=Math.pow(2,17),jn=Math.pow(2,16),ml=Math.pow(2,9),tc=Math.pow(2,8),ic=Math.pow(2,1);function rc(c){if(c.opacity===0&&!c.placed)return 0;if(c.opacity===1&&c.placed)return 4294967295;var m=c.placed?1:0,d=Math.floor(127*c.opacity);return d*Ul+m*wu+d*Hs+m*jn+d*ml+m*tc+d*ic+m}var rs=0,Nl=function(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&c.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Nl.prototype.continuePlacement=function(c,m,d,x,k){for(var D=this._bucketParts;this._currentTileIndex<c.length;)if(m.getBucketParts(D,x,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,k())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort(function(B,q){return B.sortKey-q.sortKey}));this._currentPartIndex<D.length;)if(m.placeLayerBucketPart(D[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,k())return!0;return!1};var jl=function(c,m,d,x,k,D,B){this.placement=new io(c,k,D,B),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=x,this._done=!1};jl.prototype.isDone=function(){return this._done},jl.prototype.continuePlacement=function(c,m,d){for(var x=this,k=f.browser.now(),D=function(){var Y=f.browser.now()-k;return!x._forceFullPlacement&&Y>2};this._currentPlacementIndex>=0;){var B=m[c[this._currentPlacementIndex]],q=this.placement.collisionIndex.transform.zoom;if(B.type==="symbol"&&(!B.minzoom||B.minzoom<=q)&&(!B.maxzoom||B.maxzoom>q)){if(this._inProgressLayer||(this._inProgressLayer=new Nl(B)),this._inProgressLayer.continuePlacement(d[B.source],this.placement,this._showCollisionBoxes,B,D))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},jl.prototype.commit=function(c){return this.placement.commit(c),this.placement};var Oc=512/f.EXTENT/2,yl=function(c,m,d){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=d;for(var x=0;x<m.length;x++){var k=m.get(x),D=k.key;this.indexedSymbolInstances[D]||(this.indexedSymbolInstances[D]=[]),this.indexedSymbolInstances[D].push({crossTileID:k.crossTileID,coord:this.getScaledCoordinates(k,c)})}};yl.prototype.getScaledCoordinates=function(c,m){var d=Oc/Math.pow(2,m.canonical.z-this.tileID.canonical.z);return{x:Math.floor((m.canonical.x*f.EXTENT+c.anchorX)*d),y:Math.floor((m.canonical.y*f.EXTENT+c.anchorY)*d)}},yl.prototype.findMatches=function(c,m,d){for(var x=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z),k=0;k<c.length;k++){var D=c.get(k);if(!D.crossTileID){var B=this.indexedSymbolInstances[D.key];if(B)for(var q=this.getScaledCoordinates(D,m),Y=0,ie=B;Y<ie.length;Y+=1){var he=ie[Y];if(Math.abs(he.coord.x-q.x)<=x&&Math.abs(he.coord.y-q.y)<=x&&!d[he.crossTileID]){d[he.crossTileID]=!0,D.crossTileID=he.crossTileID;break}}}}};var Ho=function(){this.maxCrossTileID=0};Ho.prototype.generate=function(){return++this.maxCrossTileID};var ja=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ja.prototype.handleWrapJump=function(c){var m=Math.round((c-this.lng)/360);if(m!==0)for(var d in this.indexes){var x=this.indexes[d],k={};for(var D in x){var B=x[D];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+m),k[B.tileID.key]=B}this.indexes[d]=k}this.lng=c},ja.prototype.addBucket=function(c,m,d){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(var x=0;x<m.symbolInstances.length;x++)m.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});var k=this.usedCrossTileIDs[c.overscaledZ];for(var D in this.indexes){var B=this.indexes[D];if(Number(D)>c.overscaledZ)for(var q in B){var Y=B[q];Y.tileID.isChildOf(c)&&Y.findMatches(m.symbolInstances,c,k)}else{var ie=B[c.scaledTo(Number(D)).key];ie&&ie.findMatches(m.symbolInstances,c,k)}}for(var he=0;he<m.symbolInstances.length;he++){var de=m.symbolInstances.get(he);de.crossTileID||(de.crossTileID=d.generate(),k[de.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new yl(c,m.symbolInstances,m.bucketInstanceId),!0},ja.prototype.removeBucketCrossTileIDs=function(c,m){for(var d in m.indexedSymbolInstances)for(var x=0,k=m.indexedSymbolInstances[d];x<k.length;x+=1)delete this.usedCrossTileIDs[c][k[x].crossTileID]},ja.prototype.removeStaleBuckets=function(c){var m=!1;for(var d in this.indexes){var x=this.indexes[d];for(var k in x)c[x[k].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,x[k]),delete x[k],m=!0)}return m};var Va=function(){this.layerIndexes={},this.crossTileIDs=new Ho,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Va.prototype.addLayer=function(c,m,d){var x=this.layerIndexes[c.id];x===void 0&&(x=this.layerIndexes[c.id]=new ja);var k=!1,D={};x.handleWrapJump(d);for(var B=0,q=m;B<q.length;B+=1){var Y=q[B],ie=Y.getBucket(c);ie&&c.id===ie.layerIds[0]&&(ie.bucketInstanceId||(ie.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(Y.tileID,ie,this.crossTileIDs)&&(k=!0),D[ie.bucketInstanceId]=!0)}return x.removeStaleBuckets(D)&&(k=!0),k},Va.prototype.pruneUnusedLayers=function(c){var m={};for(var d in c.forEach(function(x){m[x]=!0}),this.layerIndexes)m[d]||delete this.layerIndexes[d]};var Ss=function(c,m){return f.emitValidationErrors(c,m&&m.filter(function(d){return d.identifier!=="source.canvas"}))},pr=f.pick(Te,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Is=f.pick(Te,["setCenter","setZoom","setBearing","setPitch"]),Ts=function(){var c={},m=f.styleSpec.$version;for(var d in f.styleSpec.$root){var x,k=f.styleSpec.$root[d];k.required&&(x=d==="version"?m:k.type==="array"?[]:{})!=null&&(c[d]=x)}return c}(),fo=function(c){function m(d,x){var k=this;x===void 0&&(x={}),c.call(this),this.map=d,this.dispatcher=new Qt(fe(),this),this.imageManager=new Ue,this.imageManager.setEventedParent(this),this.glyphManager=new xt(d._requestManager,x.localIdeographFontFamily),this.lineAtlas=new Ht(256,512),this.crossTileSymbolIndex=new Va,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new f.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",f.getReferrer());var D=this;this._rtlTextPluginCallback=m.registerForPluginStateChange(function(B){D.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:B.pluginStatus,pluginURL:B.pluginURL},function(q,Y){if(f.triggerPluginCompletionEvent(q),Y&&Y.every(function(he){return he}))for(var ie in D.sourceCaches)D.sourceCaches[ie].reload()})}),this.on("data",function(B){if(B.dataType==="source"&&B.sourceDataType==="metadata"){var q=k.sourceCaches[B.sourceId];if(q){var Y=q.getSource();if(Y&&Y.vectorLayerIds)for(var ie in k._layers){var he=k._layers[ie];he.source===Y.id&&k._validateLayer(he)}}}})}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.loadURL=function(d,x){var k=this;x===void 0&&(x={}),this.fire(new f.Event("dataloading",{dataType:"style"}));var D=typeof x.validate=="boolean"?x.validate:!f.isMapboxURL(d);d=this.map._requestManager.normalizeStyleURL(d,x.accessToken);var B=this.map._requestManager.transformRequest(d,f.ResourceType.Style);this._request=f.getJSON(B,function(q,Y){k._request=null,q?k.fire(new f.ErrorEvent(q)):Y&&k._load(Y,D)})},m.prototype.loadJSON=function(d,x){var k=this;x===void 0&&(x={}),this.fire(new f.Event("dataloading",{dataType:"style"})),this._request=f.browser.frame(function(){k._request=null,k._load(d,x.validate!==!1)})},m.prototype.loadEmpty=function(){this.fire(new f.Event("dataloading",{dataType:"style"})),this._load(Ts,!1)},m.prototype._load=function(d,x){if(!x||!Ss(this,f.validateStyle(d))){for(var k in this._loaded=!0,this.stylesheet=d,d.sources)this.addSource(k,d.sources[k],{validate:!1});d.sprite?this._loadSprite(d.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(d.glyphs);var D=Ee(this.stylesheet.layers);this._order=D.map(function(ie){return ie.id}),this._layers={},this._serializedLayers={};for(var B=0,q=D;B<q.length;B+=1){var Y=q[B];(Y=f.createStyleLayer(Y)).setEventedParent(this,{layer:{id:Y.id}}),this._layers[Y.id]=Y,this._serializedLayers[Y.id]=Y.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ri(this.stylesheet.light),this.fire(new f.Event("data",{dataType:"style"})),this.fire(new f.Event("style.load"))}},m.prototype._loadSprite=function(d){var x=this;this._spriteRequest=function(k,D,B){var q,Y,ie,he=f.browser.devicePixelRatio>1?"@2x":"",de=f.getJSON(D.transformRequest(D.normalizeSpriteURL(k,he,".json"),f.ResourceType.SpriteJSON),function(Ce,Be){de=null,ie||(ie=Ce,q=Be,ze())}),me=f.getImage(D.transformRequest(D.normalizeSpriteURL(k,he,".png"),f.ResourceType.SpriteImage),function(Ce,Be){me=null,ie||(ie=Ce,Y=Be,ze())});function ze(){if(ie)B(ie);else if(q&&Y){var Ce=f.browser.getImageData(Y),Be={};for(var be in q){var Pe=q[be],Ve=Pe.width,Ye=Pe.height,ot=Pe.x,lt=Pe.y,ct=Pe.sdf,It=Pe.pixelRatio,Ot=Pe.stretchX,Rt=Pe.stretchY,ii=Pe.content,gi=new f.RGBAImage({width:Ve,height:Ye});f.RGBAImage.copy(Ce,gi,{x:ot,y:lt},{x:0,y:0},{width:Ve,height:Ye}),Be[be]={data:gi,pixelRatio:It,sdf:ct,stretchX:Ot,stretchY:Rt,content:ii}}B(null,Be)}}return{cancel:function(){de&&(de.cancel(),de=null),me&&(me.cancel(),me=null)}}}(d,this.map._requestManager,function(k,D){if(x._spriteRequest=null,k)x.fire(new f.ErrorEvent(k));else if(D)for(var B in D)x.imageManager.addImage(B,D[B]);x.imageManager.setLoaded(!0),x._availableImages=x.imageManager.listImages(),x.dispatcher.broadcast("setImages",x._availableImages),x.fire(new f.Event("data",{dataType:"style"}))})},m.prototype._validateLayer=function(d){var x=this.sourceCaches[d.source];if(x){var k=d.sourceLayer;if(k){var D=x.getSource();(D.type==="geojson"||D.vectorLayerIds&&D.vectorLayerIds.indexOf(k)===-1)&&this.fire(new f.ErrorEvent(new Error('Source layer "'+k+'" does not exist on source "'+D.id+'" as specified by style layer "'+d.id+'"')))}}},m.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var d in this.sourceCaches)if(!this.sourceCaches[d].loaded())return!1;return!!this.imageManager.isLoaded()},m.prototype._serializeLayers=function(d){for(var x=[],k=0,D=d;k<D.length;k+=1){var B=this._layers[D[k]];B.type!=="custom"&&x.push(B.serialize())}return x},m.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var d in this.sourceCaches)if(this.sourceCaches[d].hasTransition())return!0;for(var x in this._layers)if(this._layers[x].hasTransition())return!0;return!1},m.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},m.prototype.update=function(d){if(this._loaded){var x=this._changed;if(this._changed){var k=Object.keys(this._updatedLayers),D=Object.keys(this._removedLayers);for(var B in(k.length||D.length)&&this._updateWorkerLayers(k,D),this._updatedSources){var q=this._updatedSources[B];q==="reload"?this._reloadSource(B):q==="clear"&&this._clearSource(B)}for(var Y in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Y].updateTransitions(d);this.light.updateTransitions(d),this._resetUpdates()}var ie={};for(var he in this.sourceCaches){var de=this.sourceCaches[he];ie[he]=de.used,de.used=!1}for(var me=0,ze=this._order;me<ze.length;me+=1){var Ce=this._layers[ze[me]];Ce.recalculate(d,this._availableImages),!Ce.isHidden(d.zoom)&&Ce.source&&(this.sourceCaches[Ce.source].used=!0)}for(var Be in ie){var be=this.sourceCaches[Be];ie[Be]!==be.used&&be.fire(new f.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:Be}))}this.light.recalculate(d),this.z=d.zoom,x&&this.fire(new f.Event("data",{dataType:"style"}))}},m.prototype._updateTilesForChangedImages=function(){var d=Object.keys(this._changedImages);if(d.length){for(var x in this.sourceCaches)this.sourceCaches[x].reloadTilesForDependencies(["icons","patterns"],d);this._changedImages={}}},m.prototype._updateWorkerLayers=function(d,x){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(d),removedIds:x})},m.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},m.prototype.setState=function(d){var x=this;if(this._checkLoaded(),Ss(this,f.validateStyle(d)))return!1;(d=f.clone$1(d)).layers=Ee(d.layers);var k=function(B,q){if(!B)return[{command:Te.setStyle,args:[q]}];var Y=[];try{if(!f.deepEqual(B.version,q.version))return[{command:Te.setStyle,args:[q]}];f.deepEqual(B.center,q.center)||Y.push({command:Te.setCenter,args:[q.center]}),f.deepEqual(B.zoom,q.zoom)||Y.push({command:Te.setZoom,args:[q.zoom]}),f.deepEqual(B.bearing,q.bearing)||Y.push({command:Te.setBearing,args:[q.bearing]}),f.deepEqual(B.pitch,q.pitch)||Y.push({command:Te.setPitch,args:[q.pitch]}),f.deepEqual(B.sprite,q.sprite)||Y.push({command:Te.setSprite,args:[q.sprite]}),f.deepEqual(B.glyphs,q.glyphs)||Y.push({command:Te.setGlyphs,args:[q.glyphs]}),f.deepEqual(B.transition,q.transition)||Y.push({command:Te.setTransition,args:[q.transition]}),f.deepEqual(B.light,q.light)||Y.push({command:Te.setLight,args:[q.light]});var ie={},he=[];(function(me,ze,Ce,Be){var be;for(be in ze=ze||{},me=me||{})me.hasOwnProperty(be)&&(ze.hasOwnProperty(be)||Ke(be,Ce,Be));for(be in ze)ze.hasOwnProperty(be)&&(me.hasOwnProperty(be)?f.deepEqual(me[be],ze[be])||(me[be].type==="geojson"&&ze[be].type==="geojson"&&jt(me,ze,be)?Ce.push({command:Te.setGeoJSONSourceData,args:[be,ze[be].data]}):tt(be,ze,Ce,Be)):et(be,ze,Ce))})(B.sources,q.sources,he,ie);var de=[];B.layers&&B.layers.forEach(function(me){ie[me.source]?Y.push({command:Te.removeLayer,args:[me.id]}):de.push(me)}),Y=Y.concat(he),function(me,ze,Ce){ze=ze||[];var Be,be,Pe,Ve,Ye,ot,lt,ct=(me=me||[]).map(Ut),It=ze.map(Ut),Ot=me.reduce(Zt,{}),Rt=ze.reduce(Zt,{}),ii=ct.slice(),gi=Object.create(null);for(Be=0,be=0;Be<ct.length;Be++)Rt.hasOwnProperty(Pe=ct[Be])?be++:(Ce.push({command:Te.removeLayer,args:[Pe]}),ii.splice(ii.indexOf(Pe,be),1));for(Be=0,be=0;Be<It.length;Be++)ii[ii.length-1-Be]!==(Pe=It[It.length-1-Be])&&(Ot.hasOwnProperty(Pe)?(Ce.push({command:Te.removeLayer,args:[Pe]}),ii.splice(ii.lastIndexOf(Pe,ii.length-be),1)):be++,Ce.push({command:Te.addLayer,args:[Rt[Pe],ot=ii[ii.length-Be]]}),ii.splice(ii.length-Be,0,Pe),gi[Pe]=!0);for(Be=0;Be<It.length;Be++)if(Ve=Ot[Pe=It[Be]],Ye=Rt[Pe],!gi[Pe]&&!f.deepEqual(Ve,Ye))if(f.deepEqual(Ve.source,Ye.source)&&f.deepEqual(Ve["source-layer"],Ye["source-layer"])&&f.deepEqual(Ve.type,Ye.type)){for(lt in Ct(Ve.layout,Ye.layout,Ce,Pe,null,Te.setLayoutProperty),Ct(Ve.paint,Ye.paint,Ce,Pe,null,Te.setPaintProperty),f.deepEqual(Ve.filter,Ye.filter)||Ce.push({command:Te.setFilter,args:[Pe,Ye.filter]}),f.deepEqual(Ve.minzoom,Ye.minzoom)&&f.deepEqual(Ve.maxzoom,Ye.maxzoom)||Ce.push({command:Te.setLayerZoomRange,args:[Pe,Ye.minzoom,Ye.maxzoom]}),Ve)Ve.hasOwnProperty(lt)&&lt!=="layout"&&lt!=="paint"&&lt!=="filter"&&lt!=="metadata"&&lt!=="minzoom"&&lt!=="maxzoom"&&(lt.indexOf("paint.")===0?Ct(Ve[lt],Ye[lt],Ce,Pe,lt.slice(6),Te.setPaintProperty):f.deepEqual(Ve[lt],Ye[lt])||Ce.push({command:Te.setLayerProperty,args:[Pe,lt,Ye[lt]]}));for(lt in Ye)Ye.hasOwnProperty(lt)&&!Ve.hasOwnProperty(lt)&&lt!=="layout"&&lt!=="paint"&&lt!=="filter"&&lt!=="metadata"&&lt!=="minzoom"&&lt!=="maxzoom"&&(lt.indexOf("paint.")===0?Ct(Ve[lt],Ye[lt],Ce,Pe,lt.slice(6),Te.setPaintProperty):f.deepEqual(Ve[lt],Ye[lt])||Ce.push({command:Te.setLayerProperty,args:[Pe,lt,Ye[lt]]}))}else Ce.push({command:Te.removeLayer,args:[Pe]}),ot=ii[ii.lastIndexOf(Pe)+1],Ce.push({command:Te.addLayer,args:[Ye,ot]})}(de,q.layers,Y)}catch(me){console.warn("Unable to compute style diff:",me),Y=[{command:Te.setStyle,args:[q]}]}return Y}(this.serialize(),d).filter(function(B){return!(B.command in Is)});if(k.length===0)return!1;var D=k.filter(function(B){return!(B.command in pr)});if(D.length>0)throw new Error("Unimplemented: "+D.map(function(B){return B.command}).join(", ")+".");return k.forEach(function(B){B.command!=="setTransition"&&x[B.command].apply(x,B.args)}),this.stylesheet=d,!0},m.prototype.addImage=function(d,x){if(this.getImage(d))return this.fire(new f.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(d,x),this._afterImageUpdated(d)},m.prototype.updateImage=function(d,x){this.imageManager.updateImage(d,x)},m.prototype.getImage=function(d){return this.imageManager.getImage(d)},m.prototype.removeImage=function(d){if(!this.getImage(d))return this.fire(new f.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(d),this._afterImageUpdated(d)},m.prototype._afterImageUpdated=function(d){this._availableImages=this.imageManager.listImages(),this._changedImages[d]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new f.Event("data",{dataType:"style"}))},m.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},m.prototype.addSource=function(d,x,k){var D=this;if(k===void 0&&(k={}),this._checkLoaded(),this.sourceCaches[d]!==void 0)throw new Error("There is already a source with this ID");if(!x.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(x).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(x.type)>=0&&this._validate(f.validateStyle.source,"sources."+d,x,null,k))){this.map&&this.map._collectResourceTiming&&(x.collectResourceTiming=!0);var B=this.sourceCaches[d]=new Me(d,x,this.dispatcher);B.style=this,B.setEventedParent(this,function(){return{isSourceLoaded:D.loaded(),source:B.serialize(),sourceId:d}}),B.onAdd(this.map),this._changed=!0}},m.prototype.removeSource=function(d){if(this._checkLoaded(),this.sourceCaches[d]===void 0)throw new Error("There is no source with this ID");for(var x in this._layers)if(this._layers[x].source===d)return this.fire(new f.ErrorEvent(new Error('Source "'+d+'" cannot be removed while layer "'+x+'" is using it.')));var k=this.sourceCaches[d];delete this.sourceCaches[d],delete this._updatedSources[d],k.fire(new f.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:d})),k.setEventedParent(null),k.clearTiles(),k.onRemove&&k.onRemove(this.map),this._changed=!0},m.prototype.setGeoJSONSourceData=function(d,x){this._checkLoaded(),this.sourceCaches[d].getSource().setData(x),this._changed=!0},m.prototype.getSource=function(d){return this.sourceCaches[d]&&this.sourceCaches[d].getSource()},m.prototype.addLayer=function(d,x,k){k===void 0&&(k={}),this._checkLoaded();var D=d.id;if(this.getLayer(D))this.fire(new f.ErrorEvent(new Error('Layer with id "'+D+'" already exists on this map')));else{var B;if(d.type==="custom"){if(Ss(this,f.validateCustomStyleLayer(d)))return;B=f.createStyleLayer(d)}else{if(typeof d.source=="object"&&(this.addSource(D,d.source),d=f.clone$1(d),d=f.extend(d,{source:D})),this._validate(f.validateStyle.layer,"layers."+D,d,{arrayIndex:-1},k))return;B=f.createStyleLayer(d),this._validateLayer(B),B.setEventedParent(this,{layer:{id:D}}),this._serializedLayers[B.id]=B.serialize()}var q=x?this._order.indexOf(x):this._order.length;if(x&&q===-1)this.fire(new f.ErrorEvent(new Error('Layer with id "'+x+'" does not exist on this map.')));else{if(this._order.splice(q,0,D),this._layerOrderChanged=!0,this._layers[D]=B,this._removedLayers[D]&&B.source&&B.type!=="custom"){var Y=this._removedLayers[D];delete this._removedLayers[D],Y.type!==B.type?this._updatedSources[B.source]="clear":(this._updatedSources[B.source]="reload",this.sourceCaches[B.source].pause())}this._updateLayer(B),B.onAdd&&B.onAdd(this.map)}}},m.prototype.moveLayer=function(d,x){if(this._checkLoaded(),this._changed=!0,this._layers[d]){if(d!==x){var k=this._order.indexOf(d);this._order.splice(k,1);var D=x?this._order.indexOf(x):this._order.length;x&&D===-1?this.fire(new f.ErrorEvent(new Error('Layer with id "'+x+'" does not exist on this map.'))):(this._order.splice(D,0,d),this._layerOrderChanged=!0)}}else this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot be moved.")))},m.prototype.removeLayer=function(d){this._checkLoaded();var x=this._layers[d];if(x){x.setEventedParent(null);var k=this._order.indexOf(d);this._order.splice(k,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[d]=x,delete this._layers[d],delete this._serializedLayers[d],delete this._updatedLayers[d],delete this._updatedPaintProps[d],x.onRemove&&x.onRemove(this.map)}else this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot be removed.")))},m.prototype.getLayer=function(d){return this._layers[d]},m.prototype.hasLayer=function(d){return d in this._layers},m.prototype.setLayerZoomRange=function(d,x,k){this._checkLoaded();var D=this.getLayer(d);D?D.minzoom===x&&D.maxzoom===k||(x!=null&&(D.minzoom=x),k!=null&&(D.maxzoom=k),this._updateLayer(D)):this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot have zoom extent.")))},m.prototype.setFilter=function(d,x,k){k===void 0&&(k={}),this._checkLoaded();var D=this.getLayer(d);if(D){if(!f.deepEqual(D.filter,x))return x==null?(D.filter=void 0,void this._updateLayer(D)):void(this._validate(f.validateStyle.filter,"layers."+D.id+".filter",x,null,k)||(D.filter=f.clone$1(x),this._updateLayer(D)))}else this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot be filtered.")))},m.prototype.getFilter=function(d){return f.clone$1(this.getLayer(d).filter)},m.prototype.setLayoutProperty=function(d,x,k,D){D===void 0&&(D={}),this._checkLoaded();var B=this.getLayer(d);B?f.deepEqual(B.getLayoutProperty(x),k)||(B.setLayoutProperty(x,k,D),this._updateLayer(B)):this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot be styled.")))},m.prototype.getLayoutProperty=function(d,x){var k=this.getLayer(d);if(k)return k.getLayoutProperty(x);this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style.")))},m.prototype.setPaintProperty=function(d,x,k,D){D===void 0&&(D={}),this._checkLoaded();var B=this.getLayer(d);B?f.deepEqual(B.getPaintProperty(x),k)||(B.setPaintProperty(x,k,D)&&this._updateLayer(B),this._changed=!0,this._updatedPaintProps[d]=!0):this.fire(new f.ErrorEvent(new Error("The layer '"+d+"' does not exist in the map's style and cannot be styled.")))},m.prototype.getPaintProperty=function(d,x){return this.getLayer(d).getPaintProperty(x)},m.prototype.setFeatureState=function(d,x){this._checkLoaded();var k=d.source,D=d.sourceLayer,B=this.sourceCaches[k];if(B!==void 0){var q=B.getSource().type;q==="geojson"&&D?this.fire(new f.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):q!=="vector"||D?(d.id===void 0&&this.fire(new f.ErrorEvent(new Error("The feature id parameter must be provided."))),B.setFeatureState(D,d.id,x)):this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new f.ErrorEvent(new Error("The source '"+k+"' does not exist in the map's style.")))},m.prototype.removeFeatureState=function(d,x){this._checkLoaded();var k=d.source,D=this.sourceCaches[k];if(D!==void 0){var B=D.getSource().type,q=B==="vector"?d.sourceLayer:void 0;B!=="vector"||q?x&&typeof d.id!="string"&&typeof d.id!="number"?this.fire(new f.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):D.removeFeatureState(q,d.id,x):this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new f.ErrorEvent(new Error("The source '"+k+"' does not exist in the map's style.")))},m.prototype.getFeatureState=function(d){this._checkLoaded();var x=d.source,k=d.sourceLayer,D=this.sourceCaches[x];if(D!==void 0){if(D.getSource().type!=="vector"||k)return d.id===void 0&&this.fire(new f.ErrorEvent(new Error("The feature id parameter must be provided."))),D.getFeatureState(k,d.id);this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new f.ErrorEvent(new Error("The source '"+x+"' does not exist in the map's style.")))},m.prototype.getTransition=function(){return f.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},m.prototype.serialize=function(){return f.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:f.mapObject(this.sourceCaches,function(d){return d.serialize()}),layers:this._serializeLayers(this._order)},function(d){return d!==void 0})},m.prototype._updateLayer=function(d){this._updatedLayers[d.id]=!0,d.source&&!this._updatedSources[d.source]&&this.sourceCaches[d.source].getSource().type!=="raster"&&(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause()),this._changed=!0},m.prototype._flattenAndSortRenderedFeatures=function(d){for(var x=this,k=function(Ot){return x._layers[Ot].type==="fill-extrusion"},D={},B=[],q=this._order.length-1;q>=0;q--){var Y=this._order[q];if(k(Y)){D[Y]=q;for(var ie=0,he=d;ie<he.length;ie+=1){var de=he[ie][Y];if(de)for(var me=0,ze=de;me<ze.length;me+=1)B.push(ze[me])}}}B.sort(function(Ot,Rt){return Rt.intersectionZ-Ot.intersectionZ});for(var Ce=[],Be=this._order.length-1;Be>=0;Be--){var be=this._order[Be];if(k(be))for(var Pe=B.length-1;Pe>=0;Pe--){var Ve=B[Pe].feature;if(D[Ve.layer.id]<Be)break;Ce.push(Ve),B.pop()}else for(var Ye=0,ot=d;Ye<ot.length;Ye+=1){var lt=ot[Ye][be];if(lt)for(var ct=0,It=lt;ct<It.length;ct+=1)Ce.push(It[ct].feature)}}return Ce},m.prototype.queryRenderedFeatures=function(d,x,k){x&&x.filter&&this._validate(f.validateStyle.filter,"queryRenderedFeatures.filter",x.filter,null,x);var D={};if(x&&x.layers){if(!Array.isArray(x.layers))return this.fire(new f.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var B=0,q=x.layers;B<q.length;B+=1){var Y=q[B],ie=this._layers[Y];if(!ie)return this.fire(new f.ErrorEvent(new Error("The layer '"+Y+"' does not exist in the map's style and cannot be queried for features."))),[];D[ie.source]=!0}}var he=[];for(var de in x.availableImages=this._availableImages,this.sourceCaches)x.layers&&!D[de]||he.push(Ai(this.sourceCaches[de],this._layers,this._serializedLayers,d,x,k));return this.placement&&he.push(function(me,ze,Ce,Be,be,Pe,Ve){for(var Ye={},ot=Pe.queryRenderedSymbols(Be),lt=[],ct=0,It=Object.keys(ot).map(Number);ct<It.length;ct+=1)lt.push(Ve[It[ct]]);lt.sort(or);for(var Ot=function(){var yi=ii[Rt],lr=yi.featureIndex.lookupSymbolFeatures(ot[yi.bucketInstanceId],ze,yi.bucketIndex,yi.sourceLayerIndex,be.filter,be.layers,be.availableImages,me);for(var si in lr){var ji=Ye[si]=Ye[si]||[],ir=lr[si];ir.sort(function(Zi,zi){var Ei=yi.featureSortOrder;if(Ei){var mn=Ei.indexOf(Zi.featureIndex);return Ei.indexOf(zi.featureIndex)-mn}return zi.featureIndex-Zi.featureIndex});for(var Oi=0,Di=ir;Oi<Di.length;Oi+=1)ji.push(Di[Oi])}},Rt=0,ii=lt;Rt<ii.length;Rt+=1)Ot();var gi=function(yi){Ye[yi].forEach(function(lr){var si=lr.feature,ji=Ce[me[yi].source].getFeatureState(si.layer["source-layer"],si.id);si.source=si.layer.source,si.layer["source-layer"]&&(si.sourceLayer=si.layer["source-layer"]),si.state=ji})};for(var Ii in Ye)gi(Ii);return Ye}(this._layers,this._serializedLayers,this.sourceCaches,d,x,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(he)},m.prototype.querySourceFeatures=function(d,x){x&&x.filter&&this._validate(f.validateStyle.filter,"querySourceFeatures.filter",x.filter,null,x);var k=this.sourceCaches[d];return k?function(D,B){for(var q=D.getRenderableIds().map(function(ze){return D.getTileByID(ze)}),Y=[],ie={},he=0;he<q.length;he++){var de=q[he],me=de.tileID.canonical.key;ie[me]||(ie[me]=!0,de.querySourceFeatures(Y,B))}return Y}(k,x):[]},m.prototype.addSourceType=function(d,x,k){return m.getSourceType(d)?k(new Error('A source type called "'+d+'" already exists.')):(m.setSourceType(d,x),x.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:d,url:x.workerSourceURL},k):k(null,null))},m.prototype.getLight=function(){return this.light.getLight()},m.prototype.setLight=function(d,x){x===void 0&&(x={}),this._checkLoaded();var k=this.light.getLight(),D=!1;for(var B in d)if(!f.deepEqual(d[B],k[B])){D=!0;break}if(D){var q={now:f.browser.now(),transition:f.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(d,x),this.light.updateTransitions(q)}},m.prototype._validate=function(d,x,k,D,B){return B===void 0&&(B={}),(!B||B.validate!==!1)&&Ss(this,d.call(f.validateStyle,f.extend({key:x,style:this.serialize(),value:k,styleSpec:f.styleSpec},D)))},m.prototype._remove=function(){for(var d in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),f.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[d].setEventedParent(null);for(var x in this.sourceCaches)this.sourceCaches[x].clearTiles(),this.sourceCaches[x].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},m.prototype._clearSource=function(d){this.sourceCaches[d].clearTiles()},m.prototype._reloadSource=function(d){this.sourceCaches[d].resume(),this.sourceCaches[d].reload()},m.prototype._updateSources=function(d){for(var x in this.sourceCaches)this.sourceCaches[x].update(d)},m.prototype._generateCollisionBoxes=function(){for(var d in this.sourceCaches)this._reloadSource(d)},m.prototype._updatePlacement=function(d,x,k,D,B){B===void 0&&(B=!1);for(var q=!1,Y=!1,ie={},he=0,de=this._order;he<de.length;he+=1){var me=this._layers[de[he]];if(me.type==="symbol"){if(!ie[me.source]){var ze=this.sourceCaches[me.source];ie[me.source]=ze.getRenderableIds(!0).map(function(Ve){return ze.getTileByID(Ve)}).sort(function(Ve,Ye){return Ye.tileID.overscaledZ-Ve.tileID.overscaledZ||(Ve.tileID.isLessThan(Ye.tileID)?-1:1)})}var Ce=this.crossTileSymbolIndex.addLayer(me,ie[me.source],d.center.lng);q=q||Ce}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((B=B||this._layerOrderChanged||k===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(f.browser.now(),d.zoom))&&(this.pauseablePlacement=new jl(d,this._order,B,x,k,D,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,ie),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(f.browser.now()),Y=!0),q&&this.pauseablePlacement.placement.setStale()),Y||q)for(var Be=0,be=this._order;Be<be.length;Be+=1){var Pe=this._layers[be[Be]];Pe.type==="symbol"&&this.placement.updateLayerOpacities(Pe,ie[Pe.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(f.browser.now())},m.prototype._releaseSymbolFadeTiles=function(){for(var d in this.sourceCaches)this.sourceCaches[d].releaseSymbolFadeTiles()},m.prototype.getImages=function(d,x,k){this.imageManager.getImages(x.icons,k),this._updateTilesForChangedImages();var D=this.sourceCaches[x.source];D&&D.setDependencies(x.tileID.key,x.type,x.icons)},m.prototype.getGlyphs=function(d,x,k){this.glyphManager.getGlyphs(x.stacks,k)},m.prototype.getResource=function(d,x,k){return f.makeRequest(x,k)},m}(f.Evented);fo.getSourceType=function(c){return Ji[c]},fo.setSourceType=function(c,m){Ji[c]=m},fo.registerForPluginStateChange=f.registerForPluginStateChange;var Tn=f.createLayout([{name:"a_pos",type:"Int16",components:2}]),mo=Zr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Eu=Zr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Su=Zr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Iu=Zr(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Vl=Zr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ql=Zr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),gl=Zr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Gl=Zr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Tu=Zr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Zl=Zr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Fc=Zr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),_l=Zr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),qa=Zr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Uc=Zr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),yo=Zr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),nc=Zr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),As=Zr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Cs=Zr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ws=Zr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),ns=Zr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ga=Zr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),xa=Zr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ks=Zr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),os=Zr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Au=Zr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),zs=Zr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Zr(c,m){var d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=m.match(/attribute ([\w]+) ([\w]+)/g),k=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),D=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),B=D?D.concat(k):k,q={};return{fragmentSource:c=c.replace(d,function(Y,ie,he,de,me){return q[me]=!0,ie==="define"?`
#ifndef HAS_UNIFORM_u_`+me+`
varying `+he+" "+de+" "+me+`;
#else
uniform `+he+" "+de+" u_"+me+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+me+`
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`}),vertexSource:m=m.replace(d,function(Y,ie,he,de,me){var ze=de==="float"?"vec2":"vec4",Ce=me.match(/color/)?"color":ze;return q[me]?ie==="define"?`
#ifndef HAS_UNIFORM_u_`+me+`
uniform lowp float u_`+me+`_t;
attribute `+he+" "+ze+" a_"+me+`;
varying `+he+" "+de+" "+me+`;
#else
uniform `+he+" "+de+" u_"+me+`;
#endif
`:Ce==="vec4"?`
#ifndef HAS_UNIFORM_u_`+me+`
    `+me+" = a_"+me+`;
#else
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+me+`
    `+me+" = unpack_mix_"+Ce+"(a_"+me+", u_"+me+`_t);
#else
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`:ie==="define"?`
#ifndef HAS_UNIFORM_u_`+me+`
uniform lowp float u_`+me+`_t;
attribute `+he+" "+ze+" a_"+me+`;
#else
uniform `+he+" "+de+" u_"+me+`;
#endif
`:Ce==="vec4"?`
#ifndef HAS_UNIFORM_u_`+me+`
    `+he+" "+de+" "+me+" = a_"+me+`;
#else
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+me+`
    `+he+" "+de+" "+me+" = unpack_mix_"+Ce+"(a_"+me+", u_"+me+`_t);
#else
    `+he+" "+de+" "+me+" = u_"+me+`;
#endif
`}),staticAttributes:x,staticUniforms:B}}var Xs=Object.freeze({__proto__:null,prelude:mo,background:Eu,backgroundPattern:Su,circle:Iu,clippingMask:Vl,heatmap:ql,heatmapTexture:gl,collisionBox:Gl,collisionCircle:Tu,debug:Zl,fill:Fc,fillOutline:_l,fillOutlinePattern:qa,fillPattern:Uc,fillExtrusion:yo,fillExtrusionPattern:nc,hillshadePrepare:As,hillshade:Cs,line:Ws,lineGradient:ns,linePattern:Ga,lineSDF:xa,raster:ks,symbolIcon:os,symbolSDF:Au,symbolTextAndIcon:zs}),as=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function oc(c){for(var m=[],d=0;d<c.length;d++)if(c[d]!==null){var x=c[d].split(" ");m.push(x.pop())}return m}as.prototype.bind=function(c,m,d,x,k,D,B,q){this.context=c;for(var Y=this.boundPaintVertexBuffers.length!==x.length,ie=0;!Y&&ie<x.length;ie++)this.boundPaintVertexBuffers[ie]!==x[ie]&&(Y=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===m&&this.boundLayoutVertexBuffer===d&&!Y&&this.boundIndexBuffer===k&&this.boundVertexOffset===D&&this.boundDynamicVertexBuffer===B&&this.boundDynamicVertexBuffer2===q?(c.bindVertexArrayOES.set(this.vao),B&&B.bind(),k&&k.dynamicDraw&&k.bind(),q&&q.bind()):this.freshBind(m,d,x,k,D,B,q)},as.prototype.freshBind=function(c,m,d,x,k,D,B){var q,Y=c.numAttributes,ie=this.context,he=ie.gl;if(ie.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ie.extVertexArrayObject.createVertexArrayOES(),ie.bindVertexArrayOES.set(this.vao),q=0,this.boundProgram=c,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=x,this.boundVertexOffset=k,this.boundDynamicVertexBuffer=D,this.boundDynamicVertexBuffer2=B;else{q=ie.currentNumAttributes||0;for(var de=Y;de<q;de++)he.disableVertexAttribArray(de)}m.enableAttributes(he,c);for(var me=0,ze=d;me<ze.length;me+=1)ze[me].enableAttributes(he,c);D&&D.enableAttributes(he,c),B&&B.enableAttributes(he,c),m.bind(),m.setVertexAttribPointers(he,c,k);for(var Ce=0,Be=d;Ce<Be.length;Ce+=1){var be=Be[Ce];be.bind(),be.setVertexAttribPointers(he,c,k)}D&&(D.bind(),D.setVertexAttribPointers(he,c,k)),x&&x.bind(),B&&(B.bind(),B.setVertexAttribPointers(he,c,k)),ie.currentNumAttributes=Y},as.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Cu=function(c,m,d,x,k,D){var B=c.gl;this.program=B.createProgram();for(var q=oc(d.staticAttributes),Y=x?x.getBinderAttributes():[],ie=q.concat(Y),he=d.staticUniforms?oc(d.staticUniforms):[],de=x?x.getBinderUniforms():[],me=[],ze=0,Ce=he.concat(de);ze<Ce.length;ze+=1){var Be=Ce[ze];me.indexOf(Be)<0&&me.push(Be)}var be=x?x.defines():[];D&&be.push("#define OVERDRAW_INSPECTOR;");var Pe=be.concat(mo.fragmentSource,d.fragmentSource).join(`
`),Ve=be.concat(mo.vertexSource,d.vertexSource).join(`
`),Ye=B.createShader(B.FRAGMENT_SHADER);if(B.isContextLost())this.failedToCreate=!0;else{B.shaderSource(Ye,Pe),B.compileShader(Ye),B.attachShader(this.program,Ye);var ot=B.createShader(B.VERTEX_SHADER);if(B.isContextLost())this.failedToCreate=!0;else{B.shaderSource(ot,Ve),B.compileShader(ot),B.attachShader(this.program,ot),this.attributes={};var lt={};this.numAttributes=ie.length;for(var ct=0;ct<this.numAttributes;ct++)ie[ct]&&(B.bindAttribLocation(this.program,ct,ie[ct]),this.attributes[ie[ct]]=ct);B.linkProgram(this.program),B.deleteShader(ot),B.deleteShader(Ye);for(var It=0;It<me.length;It++){var Ot=me[It];if(Ot&&!lt[Ot]){var Rt=B.getUniformLocation(this.program,Ot);Rt&&(lt[Ot]=Rt)}}this.fixedUniforms=k(c,lt),this.binderUniforms=x?x.getUniforms(c,lt):[]}}};function $i(c,m,d){var x=1/Qr(d,1,m.transform.tileZoom),k=Math.pow(2,d.tileID.overscaledZ),D=d.tileSize*Math.pow(2,m.transform.tileZoom)/k,B=D*(d.tileID.canonical.x+d.tileID.wrap*k),q=D*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[x,c.fromScale,c.toScale],u_fade:c.t,u_pixel_coord_upper:[B>>16,q>>16],u_pixel_coord_lower:[65535&B,65535&q]}}Cu.prototype.draw=function(c,m,d,x,k,D,B,q,Y,ie,he,de,me,ze,Ce,Be){var be,Pe=c.gl;if(!this.failedToCreate){for(var Ve in c.program.set(this.program),c.setDepthMode(d),c.setStencilMode(x),c.setColorMode(k),c.setCullFace(D),this.fixedUniforms)this.fixedUniforms[Ve].set(B[Ve]);ze&&ze.setUniforms(c,this.binderUniforms,de,{zoom:me});for(var Ye=(be={},be[Pe.LINES]=2,be[Pe.TRIANGLES]=3,be[Pe.LINE_STRIP]=1,be)[m],ot=0,lt=he.get();ot<lt.length;ot+=1){var ct=lt[ot],It=ct.vaos||(ct.vaos={});(It[q]||(It[q]=new as)).bind(c,this,Y,ze?ze.getPaintVertexBuffers():[],ie,ct.vertexOffset,Ce,Be),Pe.drawElements(m,ct.primitiveLength*Ye,Pe.UNSIGNED_SHORT,ct.primitiveOffset*Ye*2)}}};var Hl=function(c,m,d,x){var k=m.style.light,D=k.properties.get("position"),B=[D.x,D.y,D.z],q=f.create$1();k.properties.get("anchor")==="viewport"&&f.fromRotation(q,-m.transform.angle),f.transformMat3(B,B,q);var Y=k.properties.get("color");return{u_matrix:c,u_lightpos:B,u_lightintensity:k.properties.get("intensity"),u_lightcolor:[Y.r,Y.g,Y.b],u_vertical_gradient:+d,u_opacity:x}},Er=function(c,m,d,x,k,D,B){return f.extend(Hl(c,m,d,x),$i(D,m,B),{u_height_factor:-Math.pow(2,k.overscaledZ)/B.tileSize/8})},ka=function(c){return{u_matrix:c}},Kr=function(c,m,d,x){return f.extend(ka(c),$i(d,m,x))},An=function(c,m){return{u_matrix:c,u_world:m}},Wl=function(c,m,d,x,k){return f.extend(Kr(c,m,d,x),{u_world:k})},Xl=function(c,m,d,x){var k,D,B=c.transform;if(x.paint.get("circle-pitch-alignment")==="map"){var q=Qr(d,1,B.zoom);k=!0,D=[q,q]}else k=!1,D=B.pixelsToGLUnits;return{u_camera_to_center_distance:B.cameraToCenterDistance,u_scale_with_map:+(x.paint.get("circle-pitch-scale")==="map"),u_matrix:c.translatePosMatrix(m.posMatrix,d,x.paint.get("circle-translate"),x.paint.get("circle-translate-anchor")),u_pitch_with_map:+k,u_device_pixel_ratio:f.browser.devicePixelRatio,u_extrude_scale:D}},Ks=function(c,m,d){var x=Qr(d,1,m.zoom),k=Math.pow(2,m.zoom-d.tileID.overscaledZ),D=d.tileID.overscaleFactor();return{u_matrix:c,u_camera_to_center_distance:m.cameraToCenterDistance,u_pixels_to_tile_units:x,u_extrude_scale:[m.pixelsToGLUnits[0]/(x*k),m.pixelsToGLUnits[1]/(x*k)],u_overscale_factor:D}},ku=function(c,m,d){return{u_matrix:c,u_inv_matrix:m,u_camera_to_center_distance:d.cameraToCenterDistance,u_viewport_size:[d.width,d.height]}},Za=function(c,m,d){return d===void 0&&(d=1),{u_matrix:c,u_color:m,u_overlay:0,u_overlay_scale:d}},Ha=function(c){return{u_matrix:c}},Kl=function(c,m,d,x){return{u_matrix:c,u_extrude_scale:Qr(m,1,d),u_intensity:x}},Ps=function(c,m,d){var x=c.transform;return{u_matrix:ac(c,m,d),u_ratio:1/Qr(m,1,x.zoom),u_device_pixel_ratio:f.browser.devicePixelRatio,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Jr=function(c,m,d,x){return f.extend(Ps(c,m,d),{u_image:0,u_image_height:x})},ss=function(c,m,d,x){var k=c.transform,D=ko(m,k);return{u_matrix:ac(c,m,d),u_texsize:m.imageAtlasTexture.size,u_ratio:1/Qr(m,1,k.zoom),u_device_pixel_ratio:f.browser.devicePixelRatio,u_image:0,u_scale:[D,x.fromScale,x.toScale],u_fade:x.t,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]]}},zu=function(c,m,d,x,k){var D=c.lineAtlas,B=ko(m,c.transform),q=d.layout.get("line-cap")==="round",Y=D.getDash(x.from,q),ie=D.getDash(x.to,q),he=Y.width*k.fromScale,de=ie.width*k.toScale;return f.extend(Ps(c,m,d),{u_patternscale_a:[B/he,-Y.height/2],u_patternscale_b:[B/de,-ie.height/2],u_sdfgamma:D.width/(256*Math.min(he,de)*f.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Y.y,u_tex_y_b:ie.y,u_mix:k.t})};function ko(c,m){return 1/Qr(c,1,m.tileZoom)}function ac(c,m,d){return c.translatePosMatrix(m.tileID.posMatrix,m,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}var Nc=function(c,m,d,x,k){return{u_matrix:c,u_tl_parent:m,u_scale_parent:d,u_buffer_scale:1,u_fade_t:x.mix,u_opacity:x.opacity*k.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:k.paint.get("raster-brightness-min"),u_brightness_high:k.paint.get("raster-brightness-max"),u_saturation_factor:(B=k.paint.get("raster-saturation"),B>0?1-1/(1.001-B):-B),u_contrast_factor:(D=k.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:sc(k.paint.get("raster-hue-rotate"))};var D,B};function sc(c){c*=Math.PI/180;var m=Math.sin(c),d=Math.cos(c);return[(2*d+1)/3,(-Math.sqrt(3)*m-d+1)/3,(Math.sqrt(3)*m-d+1)/3]}var ls,us=function(c,m,d,x,k,D,B,q,Y,ie){var he=k.transform;return{u_is_size_zoom_constant:+(c==="constant"||c==="source"),u_is_size_feature_constant:+(c==="constant"||c==="camera"),u_size_t:m?m.uSizeT:0,u_size:m?m.uSize:0,u_camera_to_center_distance:he.cameraToCenterDistance,u_pitch:he.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:he.width/he.height,u_fade_change:k.options.fadeDuration?k.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:B,u_coord_matrix:q,u_is_text:+Y,u_pitch_with_map:+x,u_texsize:ie,u_texture:0}},Js=function(c,m,d,x,k,D,B,q,Y,ie,he){var de=k.transform;return f.extend(us(c,m,d,x,k,D,B,q,Y,ie),{u_gamma_scale:x?Math.cos(de._pitch)*de.cameraToCenterDistance:1,u_device_pixel_ratio:f.browser.devicePixelRatio,u_is_halo:+he})},Jl=function(c,m,d,x,k,D,B,q,Y,ie){return f.extend(Js(c,m,d,x,k,D,B,q,!0,Y,!0),{u_texsize_icon:ie,u_texture_icon:1})},Ms=function(c,m,d){return{u_matrix:c,u_opacity:m,u_color:d}},cs=function(c,m,d,x,k,D){return f.extend(function(B,q,Y,ie){var he=Y.imageManager.getPattern(B.from.toString()),de=Y.imageManager.getPattern(B.to.toString()),me=Y.imageManager.getPixelSize(),ze=me.width,Ce=me.height,Be=Math.pow(2,ie.tileID.overscaledZ),be=ie.tileSize*Math.pow(2,Y.transform.tileZoom)/Be,Pe=be*(ie.tileID.canonical.x+ie.tileID.wrap*Be),Ve=be*ie.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:he.tl,u_pattern_br_a:he.br,u_pattern_tl_b:de.tl,u_pattern_br_b:de.br,u_texsize:[ze,Ce],u_mix:q.t,u_pattern_size_a:he.displaySize,u_pattern_size_b:de.displaySize,u_scale_a:q.fromScale,u_scale_b:q.toScale,u_tile_units_to_pixels:1/Qr(ie,1,Y.transform.tileZoom),u_pixel_coord_upper:[Pe>>16,Ve>>16],u_pixel_coord_lower:[65535&Pe,65535&Ve]}}(x,D,d,k),{u_matrix:c,u_opacity:m})},lc={fillExtrusion:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_lightpos:new f.Uniform3f(c,m.u_lightpos),u_lightintensity:new f.Uniform1f(c,m.u_lightintensity),u_lightcolor:new f.Uniform3f(c,m.u_lightcolor),u_vertical_gradient:new f.Uniform1f(c,m.u_vertical_gradient),u_opacity:new f.Uniform1f(c,m.u_opacity)}},fillExtrusionPattern:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_lightpos:new f.Uniform3f(c,m.u_lightpos),u_lightintensity:new f.Uniform1f(c,m.u_lightintensity),u_lightcolor:new f.Uniform3f(c,m.u_lightcolor),u_vertical_gradient:new f.Uniform1f(c,m.u_vertical_gradient),u_height_factor:new f.Uniform1f(c,m.u_height_factor),u_image:new f.Uniform1i(c,m.u_image),u_texsize:new f.Uniform2f(c,m.u_texsize),u_pixel_coord_upper:new f.Uniform2f(c,m.u_pixel_coord_upper),u_pixel_coord_lower:new f.Uniform2f(c,m.u_pixel_coord_lower),u_scale:new f.Uniform3f(c,m.u_scale),u_fade:new f.Uniform1f(c,m.u_fade),u_opacity:new f.Uniform1f(c,m.u_opacity)}},fill:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix)}},fillPattern:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_image:new f.Uniform1i(c,m.u_image),u_texsize:new f.Uniform2f(c,m.u_texsize),u_pixel_coord_upper:new f.Uniform2f(c,m.u_pixel_coord_upper),u_pixel_coord_lower:new f.Uniform2f(c,m.u_pixel_coord_lower),u_scale:new f.Uniform3f(c,m.u_scale),u_fade:new f.Uniform1f(c,m.u_fade)}},fillOutline:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_world:new f.Uniform2f(c,m.u_world)}},fillOutlinePattern:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_world:new f.Uniform2f(c,m.u_world),u_image:new f.Uniform1i(c,m.u_image),u_texsize:new f.Uniform2f(c,m.u_texsize),u_pixel_coord_upper:new f.Uniform2f(c,m.u_pixel_coord_upper),u_pixel_coord_lower:new f.Uniform2f(c,m.u_pixel_coord_lower),u_scale:new f.Uniform3f(c,m.u_scale),u_fade:new f.Uniform1f(c,m.u_fade)}},circle:function(c,m){return{u_camera_to_center_distance:new f.Uniform1f(c,m.u_camera_to_center_distance),u_scale_with_map:new f.Uniform1i(c,m.u_scale_with_map),u_pitch_with_map:new f.Uniform1i(c,m.u_pitch_with_map),u_extrude_scale:new f.Uniform2f(c,m.u_extrude_scale),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_matrix:new f.UniformMatrix4f(c,m.u_matrix)}},collisionBox:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_camera_to_center_distance:new f.Uniform1f(c,m.u_camera_to_center_distance),u_pixels_to_tile_units:new f.Uniform1f(c,m.u_pixels_to_tile_units),u_extrude_scale:new f.Uniform2f(c,m.u_extrude_scale),u_overscale_factor:new f.Uniform1f(c,m.u_overscale_factor)}},collisionCircle:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_inv_matrix:new f.UniformMatrix4f(c,m.u_inv_matrix),u_camera_to_center_distance:new f.Uniform1f(c,m.u_camera_to_center_distance),u_viewport_size:new f.Uniform2f(c,m.u_viewport_size)}},debug:function(c,m){return{u_color:new f.UniformColor(c,m.u_color),u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_overlay:new f.Uniform1i(c,m.u_overlay),u_overlay_scale:new f.Uniform1f(c,m.u_overlay_scale)}},clippingMask:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix)}},heatmap:function(c,m){return{u_extrude_scale:new f.Uniform1f(c,m.u_extrude_scale),u_intensity:new f.Uniform1f(c,m.u_intensity),u_matrix:new f.UniformMatrix4f(c,m.u_matrix)}},heatmapTexture:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_world:new f.Uniform2f(c,m.u_world),u_image:new f.Uniform1i(c,m.u_image),u_color_ramp:new f.Uniform1i(c,m.u_color_ramp),u_opacity:new f.Uniform1f(c,m.u_opacity)}},hillshade:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_image:new f.Uniform1i(c,m.u_image),u_latrange:new f.Uniform2f(c,m.u_latrange),u_light:new f.Uniform2f(c,m.u_light),u_shadow:new f.UniformColor(c,m.u_shadow),u_highlight:new f.UniformColor(c,m.u_highlight),u_accent:new f.UniformColor(c,m.u_accent)}},hillshadePrepare:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_image:new f.Uniform1i(c,m.u_image),u_dimension:new f.Uniform2f(c,m.u_dimension),u_zoom:new f.Uniform1f(c,m.u_zoom),u_unpack:new f.Uniform4f(c,m.u_unpack)}},line:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_ratio:new f.Uniform1f(c,m.u_ratio),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_units_to_pixels:new f.Uniform2f(c,m.u_units_to_pixels)}},lineGradient:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_ratio:new f.Uniform1f(c,m.u_ratio),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_units_to_pixels:new f.Uniform2f(c,m.u_units_to_pixels),u_image:new f.Uniform1i(c,m.u_image),u_image_height:new f.Uniform1f(c,m.u_image_height)}},linePattern:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_texsize:new f.Uniform2f(c,m.u_texsize),u_ratio:new f.Uniform1f(c,m.u_ratio),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_image:new f.Uniform1i(c,m.u_image),u_units_to_pixels:new f.Uniform2f(c,m.u_units_to_pixels),u_scale:new f.Uniform3f(c,m.u_scale),u_fade:new f.Uniform1f(c,m.u_fade)}},lineSDF:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_ratio:new f.Uniform1f(c,m.u_ratio),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_units_to_pixels:new f.Uniform2f(c,m.u_units_to_pixels),u_patternscale_a:new f.Uniform2f(c,m.u_patternscale_a),u_patternscale_b:new f.Uniform2f(c,m.u_patternscale_b),u_sdfgamma:new f.Uniform1f(c,m.u_sdfgamma),u_image:new f.Uniform1i(c,m.u_image),u_tex_y_a:new f.Uniform1f(c,m.u_tex_y_a),u_tex_y_b:new f.Uniform1f(c,m.u_tex_y_b),u_mix:new f.Uniform1f(c,m.u_mix)}},raster:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_tl_parent:new f.Uniform2f(c,m.u_tl_parent),u_scale_parent:new f.Uniform1f(c,m.u_scale_parent),u_buffer_scale:new f.Uniform1f(c,m.u_buffer_scale),u_fade_t:new f.Uniform1f(c,m.u_fade_t),u_opacity:new f.Uniform1f(c,m.u_opacity),u_image0:new f.Uniform1i(c,m.u_image0),u_image1:new f.Uniform1i(c,m.u_image1),u_brightness_low:new f.Uniform1f(c,m.u_brightness_low),u_brightness_high:new f.Uniform1f(c,m.u_brightness_high),u_saturation_factor:new f.Uniform1f(c,m.u_saturation_factor),u_contrast_factor:new f.Uniform1f(c,m.u_contrast_factor),u_spin_weights:new f.Uniform3f(c,m.u_spin_weights)}},symbolIcon:function(c,m){return{u_is_size_zoom_constant:new f.Uniform1i(c,m.u_is_size_zoom_constant),u_is_size_feature_constant:new f.Uniform1i(c,m.u_is_size_feature_constant),u_size_t:new f.Uniform1f(c,m.u_size_t),u_size:new f.Uniform1f(c,m.u_size),u_camera_to_center_distance:new f.Uniform1f(c,m.u_camera_to_center_distance),u_pitch:new f.Uniform1f(c,m.u_pitch),u_rotate_symbol:new f.Uniform1i(c,m.u_rotate_symbol),u_aspect_ratio:new f.Uniform1f(c,m.u_aspect_ratio),u_fade_change:new f.Uniform1f(c,m.u_fade_change),u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_label_plane_matrix:new f.UniformMatrix4f(c,m.u_label_plane_matrix),u_coord_matrix:new f.UniformMatrix4f(c,m.u_coord_matrix),u_is_text:new f.Uniform1i(c,m.u_is_text),u_pitch_with_map:new f.Uniform1i(c,m.u_pitch_with_map),u_texsize:new f.Uniform2f(c,m.u_texsize),u_texture:new f.Uniform1i(c,m.u_texture)}},symbolSDF:function(c,m){return{u_is_size_zoom_constant:new f.Uniform1i(c,m.u_is_size_zoom_constant),u_is_size_feature_constant:new f.Uniform1i(c,m.u_is_size_feature_constant),u_size_t:new f.Uniform1f(c,m.u_size_t),u_size:new f.Uniform1f(c,m.u_size),u_camera_to_center_distance:new f.Uniform1f(c,m.u_camera_to_center_distance),u_pitch:new f.Uniform1f(c,m.u_pitch),u_rotate_symbol:new f.Uniform1i(c,m.u_rotate_symbol),u_aspect_ratio:new f.Uniform1f(c,m.u_aspect_ratio),u_fade_change:new f.Uniform1f(c,m.u_fade_change),u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_label_plane_matrix:new f.UniformMatrix4f(c,m.u_label_plane_matrix),u_coord_matrix:new f.UniformMatrix4f(c,m.u_coord_matrix),u_is_text:new f.Uniform1i(c,m.u_is_text),u_pitch_with_map:new f.Uniform1i(c,m.u_pitch_with_map),u_texsize:new f.Uniform2f(c,m.u_texsize),u_texture:new f.Uniform1i(c,m.u_texture),u_gamma_scale:new f.Uniform1f(c,m.u_gamma_scale),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_is_halo:new f.Uniform1i(c,m.u_is_halo)}},symbolTextAndIcon:function(c,m){return{u_is_size_zoom_constant:new f.Uniform1i(c,m.u_is_size_zoom_constant),u_is_size_feature_constant:new f.Uniform1i(c,m.u_is_size_feature_constant),u_size_t:new f.Uniform1f(c,m.u_size_t),u_size:new f.Uniform1f(c,m.u_size),u_camera_to_center_distance:new f.Uniform1f(c,m.u_camera_to_center_distance),u_pitch:new f.Uniform1f(c,m.u_pitch),u_rotate_symbol:new f.Uniform1i(c,m.u_rotate_symbol),u_aspect_ratio:new f.Uniform1f(c,m.u_aspect_ratio),u_fade_change:new f.Uniform1f(c,m.u_fade_change),u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_label_plane_matrix:new f.UniformMatrix4f(c,m.u_label_plane_matrix),u_coord_matrix:new f.UniformMatrix4f(c,m.u_coord_matrix),u_is_text:new f.Uniform1i(c,m.u_is_text),u_pitch_with_map:new f.Uniform1i(c,m.u_pitch_with_map),u_texsize:new f.Uniform2f(c,m.u_texsize),u_texsize_icon:new f.Uniform2f(c,m.u_texsize_icon),u_texture:new f.Uniform1i(c,m.u_texture),u_texture_icon:new f.Uniform1i(c,m.u_texture_icon),u_gamma_scale:new f.Uniform1f(c,m.u_gamma_scale),u_device_pixel_ratio:new f.Uniform1f(c,m.u_device_pixel_ratio),u_is_halo:new f.Uniform1i(c,m.u_is_halo)}},background:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_opacity:new f.Uniform1f(c,m.u_opacity),u_color:new f.UniformColor(c,m.u_color)}},backgroundPattern:function(c,m){return{u_matrix:new f.UniformMatrix4f(c,m.u_matrix),u_opacity:new f.Uniform1f(c,m.u_opacity),u_image:new f.Uniform1i(c,m.u_image),u_pattern_tl_a:new f.Uniform2f(c,m.u_pattern_tl_a),u_pattern_br_a:new f.Uniform2f(c,m.u_pattern_br_a),u_pattern_tl_b:new f.Uniform2f(c,m.u_pattern_tl_b),u_pattern_br_b:new f.Uniform2f(c,m.u_pattern_br_b),u_texsize:new f.Uniform2f(c,m.u_texsize),u_mix:new f.Uniform1f(c,m.u_mix),u_pattern_size_a:new f.Uniform2f(c,m.u_pattern_size_a),u_pattern_size_b:new f.Uniform2f(c,m.u_pattern_size_b),u_scale_a:new f.Uniform1f(c,m.u_scale_a),u_scale_b:new f.Uniform1f(c,m.u_scale_b),u_pixel_coord_upper:new f.Uniform2f(c,m.u_pixel_coord_upper),u_pixel_coord_lower:new f.Uniform2f(c,m.u_pixel_coord_lower),u_tile_units_to_pixels:new f.Uniform1f(c,m.u_tile_units_to_pixels)}}};function Wa(c,m,d,x,k,D,B){for(var q=c.context,Y=q.gl,ie=c.useProgram("collisionBox"),he=[],de=0,me=0,ze=0;ze<x.length;ze++){var Ce=x[ze],Be=m.getTile(Ce),be=Be.getBucket(d);if(be){var Pe=Ce.posMatrix;k[0]===0&&k[1]===0||(Pe=c.translatePosMatrix(Ce.posMatrix,Be,k,D));var Ve=B?be.textCollisionBox:be.iconCollisionBox,Ye=be.collisionCircleArray;if(Ye.length>0){var ot=f.create(),lt=Pe;f.mul(ot,be.placementInvProjMatrix,c.transform.glCoordMatrix),f.mul(ot,ot,be.placementViewportMatrix),he.push({circleArray:Ye,circleOffset:me,transform:lt,invTransform:ot}),me=de+=Ye.length/4}Ve&&ie.draw(q,Y.LINES,_e.disabled,Ae.disabled,c.colorModeForRenderPass(),Ge.disabled,Ks(Pe,c.transform,Be),d.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segments,null,c.transform.zoom,null,null,Ve.collisionVertexBuffer)}}if(B&&he.length){var ct=c.useProgram("collisionCircle"),It=new f.StructArrayLayout2f1f2i16;It.resize(4*de),It._trim();for(var Ot=0,Rt=0,ii=he;Rt<ii.length;Rt+=1)for(var gi=ii[Rt],Ii=0;Ii<gi.circleArray.length/4;Ii++){var yi=4*Ii,lr=gi.circleArray[yi+0],si=gi.circleArray[yi+1],ji=gi.circleArray[yi+2],ir=gi.circleArray[yi+3];It.emplace(Ot++,lr,si,ji,ir,0),It.emplace(Ot++,lr,si,ji,ir,1),It.emplace(Ot++,lr,si,ji,ir,2),It.emplace(Ot++,lr,si,ji,ir,3)}(!ls||ls.length<2*de)&&(ls=function(Cn){var Fn=2*Cn,To=new f.StructArrayLayout3ui6;To.resize(Fn),To._trim();for(var wn=0;wn<Fn;wn++){var hr=6*wn;To.uint16[hr+0]=4*wn+0,To.uint16[hr+1]=4*wn+1,To.uint16[hr+2]=4*wn+2,To.uint16[hr+3]=4*wn+2,To.uint16[hr+4]=4*wn+3,To.uint16[hr+5]=4*wn+0}return To}(de));for(var Oi=q.createIndexBuffer(ls,!0),Di=q.createVertexBuffer(It,f.collisionCircleLayout.members,!0),Zi=0,zi=he;Zi<zi.length;Zi+=1){var Ei=zi[Zi],mn=ku(Ei.transform,Ei.invTransform,c.transform);ct.draw(q,Y.TRIANGLES,_e.disabled,Ae.disabled,c.colorModeForRenderPass(),Ge.disabled,mn,d.id,Di,Oi,f.SegmentVector.simpleSegment(0,2*Ei.circleOffset,Ei.circleArray.length,Ei.circleArray.length/2),null,c.transform.zoom,null,null,null)}Di.destroy(),Oi.destroy()}}var ha=f.identity(new Float32Array(16));function Yl(c,m,d,x,k,D){var B=f.getAnchorAlignment(c),q=-(B.horizontalAlign-.5)*m,Y=-(B.verticalAlign-.5)*d,ie=f.evaluateVariableOffset(c,x);return new f.Point((q/k+ie[0])*D,(Y/k+ie[1])*D)}function $l(c,m,d,x,k,D,B,q,Y,ie,he){var de=c.text.placedSymbolArray,me=c.text.dynamicLayoutVertexArray,ze=c.icon.dynamicLayoutVertexArray,Ce={};me.clear();for(var Be=0;Be<de.length;Be++){var be=de.get(Be),Pe=be.hidden||!be.crossTileID||c.allowVerticalPlacement&&!be.placedOrientation?null:x[be.crossTileID];if(Pe){var Ve=new f.Point(be.anchorX,be.anchorY),Ye=ei(Ve,d?q:B),ot=Ui(D.cameraToCenterDistance,Ye.signedDistanceFromCamera),lt=k.evaluateSizeForFeature(c.textSizeData,ie,be)*ot/f.ONE_EM;d&&(lt*=c.tilePixelRatio/Y);for(var ct=Yl(Pe.anchor,Pe.width,Pe.height,Pe.textOffset,Pe.textBoxScale,lt),It=d?ei(Ve.add(ct),B).point:Ye.point.add(m?ct.rotate(-D.angle):ct),Ot=c.allowVerticalPlacement&&be.placedOrientation===f.WritingMode.vertical?Math.PI/2:0,Rt=0;Rt<be.numGlyphs;Rt++)f.addDynamicAttributes(me,It,Ot);he&&be.associatedIconIndex>=0&&(Ce[be.associatedIconIndex]={shiftedAnchor:It,angle:Ot})}else Co(be.numGlyphs,me)}if(he){ze.clear();for(var ii=c.icon.placedSymbolArray,gi=0;gi<ii.length;gi++){var Ii=ii.get(gi);if(Ii.hidden)Co(Ii.numGlyphs,ze);else{var yi=Ce[gi];if(yi)for(var lr=0;lr<Ii.numGlyphs;lr++)f.addDynamicAttributes(ze,yi.shiftedAnchor,yi.angle);else Co(Ii.numGlyphs,ze)}}c.icon.dynamicLayoutVertexBuffer.updateData(ze)}c.text.dynamicLayoutVertexBuffer.updateData(me)}function Ys(c,m,d){return d.iconsInText&&m?"symbolTextAndIcon":c?"symbolSDF":"symbolIcon"}function za(c,m,d,x,k,D,B,q,Y,ie,he,de){for(var me=c.context,ze=me.gl,Ce=c.transform,Be=q==="map",be=Y==="map",Pe=Be&&d.layout.get("symbol-placement")!=="point",Ve=Be&&!be&&!Pe,Ye=d.layout.get("symbol-sort-key").constantOr(1)!==void 0,ot=!1,lt=c.depthModeForSublayer(0,_e.ReadOnly),ct=d.layout.get("text-variable-anchor"),It=[],Ot=0,Rt=x;Ot<Rt.length;Ot+=1){var ii=Rt[Ot],gi=m.getTile(ii),Ii=gi.getBucket(d);if(Ii){var yi=k?Ii.text:Ii.icon;if(yi&&yi.segments.get().length){var lr=yi.programConfigurations.get(d.id),si=k||Ii.sdfIcons,ji=k?Ii.textSizeData:Ii.iconSizeData,ir=be||Ce.pitch!==0,Oi=c.useProgram(Ys(si,k,Ii),lr),Di=f.evaluateSizeForZoom(ji,Ce.zoom),Zi=void 0,zi=[0,0],Ei=void 0,mn=void 0,Cn=null,Fn=void 0;if(k)Ei=gi.glyphAtlasTexture,mn=ze.LINEAR,Zi=gi.glyphAtlasTexture.size,Ii.iconsInText&&(zi=gi.imageAtlasTexture.size,Cn=gi.imageAtlasTexture,Fn=ir||c.options.rotating||c.options.zooming||ji.kind==="composite"||ji.kind==="camera"?ze.LINEAR:ze.NEAREST);else{var To=d.layout.get("icon-size").constantOr(0)!==1||Ii.iconsNeedLinear;Ei=gi.imageAtlasTexture,mn=si||c.options.rotating||c.options.zooming||To||ir?ze.LINEAR:ze.NEAREST,Zi=gi.imageAtlasTexture.size}var wn=Qr(gi,1,c.transform.zoom),hr=Pi(ii.posMatrix,be,Be,c.transform,wn),Jo=di(ii.posMatrix,be,Be,c.transform,wn),qo=ct&&Ii.hasTextData(),wa=d.layout.get("icon-text-fit")!=="none"&&qo&&Ii.hasIconData();Pe&&kn(Ii,ii.posMatrix,c,k,hr,Jo,be,ie);var ro=c.translatePosMatrix(ii.posMatrix,gi,D,B),Ea=Pe||k&&ct||wa?ha:hr,Sa=c.translatePosMatrix(Jo,gi,D,B,!0),Lu=si&&d.paint.get(k?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Du={program:Oi,buffers:yi,uniformValues:si?Ii.iconsInText?Jl(ji.kind,Di,Ve,be,c,ro,Ea,Sa,Zi,zi):Js(ji.kind,Di,Ve,be,c,ro,Ea,Sa,k,Zi,!0):us(ji.kind,Di,Ve,be,c,ro,Ea,Sa,k,Zi),atlasTexture:Ei,atlasTextureIcon:Cn,atlasInterpolation:mn,atlasInterpolationIcon:Fn,isSDF:si,hasHalo:Lu};if(Ye&&Ii.canOverlap){ot=!0;for(var rl=0,Ru=yi.segments.get();rl<Ru.length;rl+=1){var nu=Ru[rl];It.push({segments:new f.SegmentVector([nu]),sortKey:nu.sortKey,state:Du})}}else It.push({segments:yi.segments,sortKey:0,state:Du})}}}ot&&It.sort(function(Cl,_s){return Cl.sortKey-_s.sortKey});for(var Rs=0,ou=It;Rs<ou.length;Rs+=1){var gs=ou[Rs],no=gs.state;if(me.activeTexture.set(ze.TEXTURE0),no.atlasTexture.bind(no.atlasInterpolation,ze.CLAMP_TO_EDGE),no.atlasTextureIcon&&(me.activeTexture.set(ze.TEXTURE1),no.atlasTextureIcon&&no.atlasTextureIcon.bind(no.atlasInterpolationIcon,ze.CLAMP_TO_EDGE)),no.isSDF){var Ia=no.uniformValues;no.hasHalo&&(Ia.u_is_halo=1,vl(no.buffers,gs.segments,d,c,no.program,lt,he,de,Ia)),Ia.u_is_halo=0}vl(no.buffers,gs.segments,d,c,no.program,lt,he,de,no.uniformValues)}}function vl(c,m,d,x,k,D,B,q,Y){var ie=x.context;k.draw(ie,ie.gl.TRIANGLES,D,B,q,Ge.disabled,Y,d.id,c.layoutVertexBuffer,c.indexBuffer,m,d.paint,x.transform.zoom,c.programConfigurations.get(d.id),c.dynamicLayoutVertexBuffer,c.opacityVertexBuffer)}function Ls(c,m,d,x,k,D,B){var q,Y,ie,he,de,me=c.context.gl,ze=d.paint.get("fill-pattern"),Ce=ze&&ze.constantOr(1),Be=d.getCrossfadeParameters();B?(Y=Ce&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=me.LINES):(Y=Ce?"fillPattern":"fill",q=me.TRIANGLES);for(var be=0,Pe=x;be<Pe.length;be+=1){var Ve=Pe[be],Ye=m.getTile(Ve);if(!Ce||Ye.patternsLoaded()){var ot=Ye.getBucket(d);if(ot){var lt=ot.programConfigurations.get(d.id),ct=c.useProgram(Y,lt);Ce&&(c.context.activeTexture.set(me.TEXTURE0),Ye.imageAtlasTexture.bind(me.LINEAR,me.CLAMP_TO_EDGE),lt.updatePaintBuffers(Be));var It=ze.constantOr(null);if(It&&Ye.imageAtlas){var Ot=Ye.imageAtlas,Rt=Ot.patternPositions[It.to.toString()],ii=Ot.patternPositions[It.from.toString()];Rt&&ii&&lt.setConstantPatternPositions(Rt,ii)}var gi=c.translatePosMatrix(Ve.posMatrix,Ye,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(B){he=ot.indexBuffer2,de=ot.segments2;var Ii=[me.drawingBufferWidth,me.drawingBufferHeight];ie=Y==="fillOutlinePattern"&&Ce?Wl(gi,c,Be,Ye,Ii):An(gi,Ii)}else he=ot.indexBuffer,de=ot.segments,ie=Ce?Kr(gi,c,Be,Ye):ka(gi);ct.draw(c.context,q,k,c.stencilModeForClipping(Ve),D,Ge.disabled,ie,d.id,ot.layoutVertexBuffer,he,de,d.paint,c.transform.zoom,lt)}}}}function Pu(c,m,d,x,k,D,B){for(var q=c.context,Y=q.gl,ie=d.paint.get("fill-extrusion-pattern"),he=ie.constantOr(1),de=d.getCrossfadeParameters(),me=d.paint.get("fill-extrusion-opacity"),ze=0,Ce=x;ze<Ce.length;ze+=1){var Be=Ce[ze],be=m.getTile(Be),Pe=be.getBucket(d);if(Pe){var Ve=Pe.programConfigurations.get(d.id),Ye=c.useProgram(he?"fillExtrusionPattern":"fillExtrusion",Ve);he&&(c.context.activeTexture.set(Y.TEXTURE0),be.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Ve.updatePaintBuffers(de));var ot=ie.constantOr(null);if(ot&&be.imageAtlas){var lt=be.imageAtlas,ct=lt.patternPositions[ot.to.toString()],It=lt.patternPositions[ot.from.toString()];ct&&It&&Ve.setConstantPatternPositions(ct,It)}var Ot=c.translatePosMatrix(Be.posMatrix,be,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Rt=d.paint.get("fill-extrusion-vertical-gradient"),ii=he?Er(Ot,c,Rt,me,Be,de,be):Hl(Ot,c,Rt,me);Ye.draw(q,q.gl.TRIANGLES,k,D,B,Ge.backCCW,ii,d.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,d.paint,c.transform.zoom,Ve)}}}function Ql(c,m,d,x,k,D){var B=c.context,q=B.gl,Y=m.fbo;if(Y){var ie=c.useProgram("hillshade");B.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,Y.colorAttachment.get());var he=function(de,me,ze){var Ce=ze.paint.get("hillshade-shadow-color"),Be=ze.paint.get("hillshade-highlight-color"),be=ze.paint.get("hillshade-accent-color"),Pe=ze.paint.get("hillshade-illumination-direction")*(Math.PI/180);ze.paint.get("hillshade-illumination-anchor")==="viewport"&&(Pe-=de.transform.angle);var Ve,Ye,ot,lt=!de.options.moving;return{u_matrix:de.transform.calculatePosMatrix(me.tileID.toUnwrapped(),lt),u_image:0,u_latrange:(Ve=me.tileID,Ye=Math.pow(2,Ve.canonical.z),ot=Ve.canonical.y,[new f.MercatorCoordinate(0,ot/Ye).toLngLat().lat,new f.MercatorCoordinate(0,(ot+1)/Ye).toLngLat().lat]),u_light:[ze.paint.get("hillshade-exaggeration"),Pe],u_shadow:Ce,u_highlight:Be,u_accent:be}}(c,m,d);ie.draw(B,q.TRIANGLES,x,k,D,Ge.disabled,he,d.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments)}}function jc(c,m,d,x,k,D){var B=c.context,q=B.gl,Y=m.dem;if(Y&&Y.data){var ie=Y.dim,he=Y.stride,de=Y.getPixels();if(B.activeTexture.set(q.TEXTURE1),B.pixelStoreUnpackPremultiplyAlpha.set(!1),m.demTexture=m.demTexture||c.getTileTexture(he),m.demTexture){var me=m.demTexture;me.update(de,{premultiply:!1}),me.bind(q.NEAREST,q.CLAMP_TO_EDGE)}else m.demTexture=new f.Texture(B,de,q.RGBA,{premultiply:!1}),m.demTexture.bind(q.NEAREST,q.CLAMP_TO_EDGE);B.activeTexture.set(q.TEXTURE0);var ze=m.fbo;if(!ze){var Ce=new f.Texture(B,{width:ie,height:ie,data:null},q.RGBA);Ce.bind(q.LINEAR,q.CLAMP_TO_EDGE),(ze=m.fbo=B.createFramebuffer(ie,ie,!0)).colorAttachment.set(Ce.texture)}B.bindFramebuffer.set(ze.framebuffer),B.viewport.set([0,0,ie,ie]),c.useProgram("hillshadePrepare").draw(B,q.TRIANGLES,x,k,D,Ge.disabled,function(Be,be){var Pe=be.stride,Ve=f.create();return f.ortho(Ve,0,f.EXTENT,-f.EXTENT,0,0,1),f.translate(Ve,Ve,[0,-f.EXTENT,0]),{u_matrix:Ve,u_image:1,u_dimension:[Pe,Pe],u_zoom:Be.overscaledZ,u_unpack:be.getUnpackVector()}}(m.tileID,Y),d.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments),m.needsHillshadePrepare=!1}}function hs(c,m,d,x,k){var D=x.paint.get("raster-fade-duration");if(D>0){var B=f.browser.now(),q=(B-c.timeAdded)/D,Y=m?(B-m.timeAdded)/D:-1,ie=d.getSource(),he=k.coveringZoomLevel({tileSize:ie.tileSize,roundZoom:ie.roundZoom}),de=!m||Math.abs(m.tileID.overscaledZ-he)>Math.abs(c.tileID.overscaledZ-he),me=de&&c.refreshedUponExpiration?1:f.clamp(de?q:1-Y,0,1);return c.refreshedUponExpiration&&q>=1&&(c.refreshedUponExpiration=!1),m?{opacity:1,mix:1-me}:{opacity:me,mix:0}}return{opacity:1,mix:0}}var Mu=new f.Color(1,0,0,1),xl=new f.Color(0,1,0,1),bl=new f.Color(0,0,1,1),zo=new f.Color(1,0,1,1),Po=new f.Color(0,1,1,1);function uc(c,m,d,x){wl(c,0,m+d/2,c.transform.width,d,x)}function ps(c,m,d,x){wl(c,m-d/2,0,d,c.transform.height,x)}function wl(c,m,d,x,k,D){var B=c.context,q=B.gl;q.enable(q.SCISSOR_TEST),q.scissor(m*f.browser.devicePixelRatio,d*f.browser.devicePixelRatio,x*f.browser.devicePixelRatio,k*f.browser.devicePixelRatio),B.clear({color:D}),q.disable(q.SCISSOR_TEST)}function $s(c,m,d){var x=c.context,k=x.gl,D=d.posMatrix,B=c.useProgram("debug"),q=_e.disabled,Y=Ae.disabled,ie=c.colorModeForRenderPass();x.activeTexture.set(k.TEXTURE0),c.emptyTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),B.draw(x,k.LINE_STRIP,q,Y,ie,Ge.disabled,Za(D,f.Color.red),"$debug",c.debugBuffer,c.tileBorderIndexBuffer,c.debugSegments);var he=m.getTileByID(d.key).latestRawTileData,de=Math.floor((he&&he.byteLength||0)/1024),me=m.getTile(d).tileSize,ze=512/Math.min(me,512)*(d.overscaledZ/c.transform.zoom)*.5,Ce=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(Ce+=" => "+d.overscaledZ),function(Be,be){Be.initDebugOverlayCanvas();var Pe=Be.debugOverlayCanvas,Ve=Be.context.gl,Ye=Be.debugOverlayCanvas.getContext("2d");Ye.clearRect(0,0,Pe.width,Pe.height),Ye.shadowColor="white",Ye.shadowBlur=2,Ye.lineWidth=1.5,Ye.strokeStyle="white",Ye.textBaseline="top",Ye.font="bold 36px Open Sans, sans-serif",Ye.fillText(be,5,5),Ye.strokeText(be,5,5),Be.debugOverlayTexture.update(Pe),Be.debugOverlayTexture.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE)}(c,Ce+" "+de+"kb"),B.draw(x,k.TRIANGLES,q,Y,je.alphaBlended,Ge.disabled,Za(D,f.Color.transparent,ze),"$debug",c.debugBuffer,c.quadTriangleIndexBuffer,c.debugSegments)}var pa={symbol:function(c,m,d,x,k){if(c.renderPass==="translucent"){var D=Ae.disabled,B=c.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(q,Y,ie,he,de,me,ze){for(var Ce=Y.transform,Be=de==="map",be=me==="map",Pe=0,Ve=q;Pe<Ve.length;Pe+=1){var Ye=Ve[Pe],ot=he.getTile(Ye),lt=ot.getBucket(ie);if(lt&&lt.text&&lt.text.segments.get().length){var ct=f.evaluateSizeForZoom(lt.textSizeData,Ce.zoom),It=Qr(ot,1,Y.transform.zoom),Ot=Pi(Ye.posMatrix,be,Be,Y.transform,It),Rt=ie.layout.get("icon-text-fit")!=="none"&&lt.hasIconData();if(ct){var ii=Math.pow(2,Ce.zoom-ot.tileID.overscaledZ);$l(lt,Be,be,ze,f.symbolSize,Ce,Ot,Ye.posMatrix,ii,ct,Rt)}}}}(x,c,d,m,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),k),d.paint.get("icon-opacity").constantOr(1)!==0&&za(c,m,d,x,!1,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),d.layout.get("icon-rotation-alignment"),d.layout.get("icon-pitch-alignment"),d.layout.get("icon-keep-upright"),D,B),d.paint.get("text-opacity").constantOr(1)!==0&&za(c,m,d,x,!0,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),d.layout.get("text-keep-upright"),D,B),m.map.showCollisionBoxes&&(Wa(c,m,d,x,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),Wa(c,m,d,x,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))}},circle:function(c,m,d,x){if(c.renderPass==="translucent"){var k=d.paint.get("circle-opacity"),D=d.paint.get("circle-stroke-width"),B=d.paint.get("circle-stroke-opacity"),q=d.layout.get("circle-sort-key").constantOr(1)!==void 0;if(k.constantOr(1)!==0||D.constantOr(1)!==0&&B.constantOr(1)!==0){for(var Y=c.context,ie=Y.gl,he=c.depthModeForSublayer(0,_e.ReadOnly),de=Ae.disabled,me=c.colorModeForRenderPass(),ze=[],Ce=0;Ce<x.length;Ce++){var Be=x[Ce],be=m.getTile(Be),Pe=be.getBucket(d);if(Pe){var Ve=Pe.programConfigurations.get(d.id),Ye={programConfiguration:Ve,program:c.useProgram("circle",Ve),layoutVertexBuffer:Pe.layoutVertexBuffer,indexBuffer:Pe.indexBuffer,uniformValues:Xl(c,Be,be,d)};if(q)for(var ot=0,lt=Pe.segments.get();ot<lt.length;ot+=1){var ct=lt[ot];ze.push({segments:new f.SegmentVector([ct]),sortKey:ct.sortKey,state:Ye})}else ze.push({segments:Pe.segments,sortKey:0,state:Ye})}}q&&ze.sort(function(gi,Ii){return gi.sortKey-Ii.sortKey});for(var It=0,Ot=ze;It<Ot.length;It+=1){var Rt=Ot[It],ii=Rt.state;ii.program.draw(Y,ie.TRIANGLES,he,de,me,Ge.disabled,ii.uniformValues,d.id,ii.layoutVertexBuffer,ii.indexBuffer,Rt.segments,d.paint,c.transform.zoom,ii.programConfiguration)}}}},heatmap:function(c,m,d,x){if(d.paint.get("heatmap-opacity")!==0)if(c.renderPass==="offscreen"){var k=c.context,D=k.gl,B=Ae.disabled,q=new je([D.ONE,D.ONE],f.Color.transparent,[!0,!0,!0,!0]);(function(ze,Ce,Be){var be=ze.gl;ze.activeTexture.set(be.TEXTURE1),ze.viewport.set([0,0,Ce.width/4,Ce.height/4]);var Pe=Be.heatmapFbo;if(Pe)be.bindTexture(be.TEXTURE_2D,Pe.colorAttachment.get()),ze.bindFramebuffer.set(Pe.framebuffer);else{var Ve=be.createTexture();be.bindTexture(be.TEXTURE_2D,Ve),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_WRAP_S,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_WRAP_T,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_MIN_FILTER,be.LINEAR),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_MAG_FILTER,be.LINEAR),Pe=Be.heatmapFbo=ze.createFramebuffer(Ce.width/4,Ce.height/4,!1),function(Ye,ot,lt,ct){var It=Ye.gl;It.texImage2D(It.TEXTURE_2D,0,It.RGBA,ot.width/4,ot.height/4,0,It.RGBA,Ye.extRenderToTextureHalfFloat?Ye.extTextureHalfFloat.HALF_FLOAT_OES:It.UNSIGNED_BYTE,null),ct.colorAttachment.set(lt)}(ze,Ce,Ve,Pe)}})(k,c,d),k.clear({color:f.Color.transparent});for(var Y=0;Y<x.length;Y++){var ie=x[Y];if(!m.hasRenderableParent(ie)){var he=m.getTile(ie),de=he.getBucket(d);if(de){var me=de.programConfigurations.get(d.id);c.useProgram("heatmap",me).draw(k,D.TRIANGLES,_e.disabled,B,q,Ge.disabled,Kl(ie.posMatrix,he,c.transform.zoom,d.paint.get("heatmap-intensity")),d.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,d.paint,c.transform.zoom,me)}}}k.viewport.set([0,0,c.width,c.height])}else c.renderPass==="translucent"&&(c.context.setColorMode(c.colorModeForRenderPass()),function(ze,Ce){var Be=ze.context,be=Be.gl,Pe=Ce.heatmapFbo;if(Pe){Be.activeTexture.set(be.TEXTURE0),be.bindTexture(be.TEXTURE_2D,Pe.colorAttachment.get()),Be.activeTexture.set(be.TEXTURE1);var Ve=Ce.colorRampTexture;Ve||(Ve=Ce.colorRampTexture=new f.Texture(Be,Ce.colorRamp,be.RGBA)),Ve.bind(be.LINEAR,be.CLAMP_TO_EDGE),ze.useProgram("heatmapTexture").draw(Be,be.TRIANGLES,_e.disabled,Ae.disabled,ze.colorModeForRenderPass(),Ge.disabled,function(Ye,ot,lt,ct){var It=f.create();f.ortho(It,0,Ye.width,Ye.height,0,0,1);var Ot=Ye.context.gl;return{u_matrix:It,u_world:[Ot.drawingBufferWidth,Ot.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ot.paint.get("heatmap-opacity")}}(ze,Ce),Ce.id,ze.viewportBuffer,ze.quadTriangleIndexBuffer,ze.viewportSegments,Ce.paint,ze.transform.zoom)}}(c,d))},line:function(c,m,d,x){if(c.renderPass==="translucent"){var k=d.paint.get("line-opacity"),D=d.paint.get("line-width");if(k.constantOr(1)!==0&&D.constantOr(1)!==0)for(var B=c.depthModeForSublayer(0,_e.ReadOnly),q=c.colorModeForRenderPass(),Y=d.paint.get("line-dasharray"),ie=d.paint.get("line-pattern"),he=ie.constantOr(1),de=d.paint.get("line-gradient"),me=d.getCrossfadeParameters(),ze=he?"linePattern":Y?"lineSDF":de?"lineGradient":"line",Ce=c.context,Be=Ce.gl,be=!0,Pe=0,Ve=x;Pe<Ve.length;Pe+=1){var Ye=Ve[Pe],ot=m.getTile(Ye);if(!he||ot.patternsLoaded()){var lt=ot.getBucket(d);if(lt){var ct=lt.programConfigurations.get(d.id),It=c.context.program.get(),Ot=c.useProgram(ze,ct),Rt=be||Ot.program!==It,ii=ie.constantOr(null);if(ii&&ot.imageAtlas){var gi=ot.imageAtlas,Ii=gi.patternPositions[ii.to.toString()],yi=gi.patternPositions[ii.from.toString()];Ii&&yi&&ct.setConstantPatternPositions(Ii,yi)}var lr=he?ss(c,ot,d,me):Y?zu(c,ot,d,Y,me):de?Jr(c,ot,d,lt.lineClipsArray.length):Ps(c,ot,d);if(he)Ce.activeTexture.set(Be.TEXTURE0),ot.imageAtlasTexture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE),ct.updatePaintBuffers(me);else if(Y&&(Rt||c.lineAtlas.dirty))Ce.activeTexture.set(Be.TEXTURE0),c.lineAtlas.bind(Ce);else if(de){var si=lt.gradients[d.id],ji=si.texture;if(d.gradientVersion!==si.version){var ir=256;if(d.stepInterpolant){var Oi=m.getSource().maxzoom,Di=Ye.canonical.z===Oi?Math.ceil(1<<c.transform.maxZoom-Ye.canonical.z):1;ir=f.clamp(f.nextPowerOfTwo(lt.maxLineLength/f.EXTENT*1024*Di),256,Ce.maxTextureSize)}si.gradient=f.renderColorRamp({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:ir,image:si.gradient||void 0,clips:lt.lineClipsArray}),si.texture?si.texture.update(si.gradient):si.texture=new f.Texture(Ce,si.gradient,Be.RGBA),si.version=d.gradientVersion,ji=si.texture}Ce.activeTexture.set(Be.TEXTURE0),ji.bind(d.stepInterpolant?Be.NEAREST:Be.LINEAR,Be.CLAMP_TO_EDGE)}Ot.draw(Ce,Be.TRIANGLES,B,c.stencilModeForClipping(Ye),q,Ge.disabled,lr,d.id,lt.layoutVertexBuffer,lt.indexBuffer,lt.segments,d.paint,c.transform.zoom,ct,lt.layoutVertexBuffer2),be=!1}}}}},fill:function(c,m,d,x){var k=d.paint.get("fill-color"),D=d.paint.get("fill-opacity");if(D.constantOr(1)!==0){var B=c.colorModeForRenderPass(),q=d.paint.get("fill-pattern"),Y=c.opaquePassEnabledForLayer()&&!q.constantOr(1)&&k.constantOr(f.Color.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(c.renderPass===Y){var ie=c.depthModeForSublayer(1,c.renderPass==="opaque"?_e.ReadWrite:_e.ReadOnly);Ls(c,m,d,x,ie,B,!1)}if(c.renderPass==="translucent"&&d.paint.get("fill-antialias")){var he=c.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,_e.ReadOnly);Ls(c,m,d,x,he,B,!0)}}},"fill-extrusion":function(c,m,d,x){var k=d.paint.get("fill-extrusion-opacity");if(k!==0&&c.renderPass==="translucent"){var D=new _e(c.context.gl.LEQUAL,_e.ReadWrite,c.depthRangeFor3D);if(k!==1||d.paint.get("fill-extrusion-pattern").constantOr(1))Pu(c,m,d,x,D,Ae.disabled,je.disabled),Pu(c,m,d,x,D,c.stencilModeFor3D(),c.colorModeForRenderPass());else{var B=c.colorModeForRenderPass();Pu(c,m,d,x,D,Ae.disabled,B)}}},hillshade:function(c,m,d,x){if(c.renderPass==="offscreen"||c.renderPass==="translucent"){for(var k=c.context,D=c.depthModeForSublayer(0,_e.ReadOnly),B=c.colorModeForRenderPass(),q=c.renderPass==="translucent"?c.stencilConfigForOverlap(x):[{},x],Y=q[0],ie=0,he=q[1];ie<he.length;ie+=1){var de=he[ie],me=m.getTile(de);me.needsHillshadePrepare&&c.renderPass==="offscreen"?jc(c,me,d,D,Ae.disabled,B):c.renderPass==="translucent"&&Ql(c,me,d,D,Y[de.overscaledZ],B)}k.viewport.set([0,0,c.width,c.height])}},raster:function(c,m,d,x){if(c.renderPass==="translucent"&&d.paint.get("raster-opacity")!==0&&x.length)for(var k=c.context,D=k.gl,B=m.getSource(),q=c.useProgram("raster"),Y=c.colorModeForRenderPass(),ie=B instanceof Et?[{},x]:c.stencilConfigForOverlap(x),he=ie[0],de=ie[1],me=de[de.length-1].overscaledZ,ze=!c.options.moving,Ce=0,Be=de;Ce<Be.length;Ce+=1){var be=Be[Ce],Pe=c.depthModeForSublayer(be.overscaledZ-me,d.paint.get("raster-opacity")===1?_e.ReadWrite:_e.ReadOnly,D.LESS),Ve=m.getTile(be),Ye=c.transform.calculatePosMatrix(be.toUnwrapped(),ze);Ve.registerFadeDuration(d.paint.get("raster-fade-duration"));var ot=m.findLoadedParent(be,0),lt=hs(Ve,ot,m,d,c.transform),ct=void 0,It=void 0,Ot=d.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;k.activeTexture.set(D.TEXTURE0),Ve.texture.bind(Ot,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),k.activeTexture.set(D.TEXTURE1),ot?(ot.texture.bind(Ot,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST),ct=Math.pow(2,ot.tileID.overscaledZ-Ve.tileID.overscaledZ),It=[Ve.tileID.canonical.x*ct%1,Ve.tileID.canonical.y*ct%1]):Ve.texture.bind(Ot,D.CLAMP_TO_EDGE,D.LINEAR_MIPMAP_NEAREST);var Rt=Nc(Ye,It||[0,0],ct||1,lt,d);B instanceof Et?q.draw(k,D.TRIANGLES,Pe,Ae.disabled,Y,Ge.disabled,Rt,d.id,B.boundsBuffer,c.quadTriangleIndexBuffer,B.boundsSegments):q.draw(k,D.TRIANGLES,Pe,he[be.overscaledZ],Y,Ge.disabled,Rt,d.id,c.rasterBoundsBuffer,c.quadTriangleIndexBuffer,c.rasterBoundsSegments)}},background:function(c,m,d){var x=d.paint.get("background-color"),k=d.paint.get("background-opacity");if(k!==0){var D=c.context,B=D.gl,q=c.transform,Y=q.tileSize,ie=d.paint.get("background-pattern");if(!c.isPatternMissing(ie)){var he=!ie&&x.a===1&&k===1&&c.opaquePassEnabledForLayer()?"opaque":"translucent";if(c.renderPass===he){var de=Ae.disabled,me=c.depthModeForSublayer(0,he==="opaque"?_e.ReadWrite:_e.ReadOnly),ze=c.colorModeForRenderPass(),Ce=c.useProgram(ie?"backgroundPattern":"background"),Be=q.coveringTiles({tileSize:Y});ie&&(D.activeTexture.set(B.TEXTURE0),c.imageManager.bind(c.context));for(var be=d.getCrossfadeParameters(),Pe=0,Ve=Be;Pe<Ve.length;Pe+=1){var Ye=Ve[Pe],ot=c.transform.calculatePosMatrix(Ye.toUnwrapped()),lt=ie?cs(ot,k,c,ie,{tileID:Ye,tileSize:Y},be):Ms(ot,k,x);Ce.draw(D,B.TRIANGLES,me,de,ze,Ge.disabled,lt,d.id,c.tileExtentBuffer,c.quadTriangleIndexBuffer,c.tileExtentSegments)}}}}},debug:function(c,m,d){for(var x=0;x<d.length;x++)$s(c,m,d[x])},custom:function(c,m,d){var x=c.context,k=d.implementation;if(c.renderPass==="offscreen"){var D=k.prerender;D&&(c.setCustomLayerDefaults(),x.setColorMode(c.colorModeForRenderPass()),D.call(k,x.gl,c.transform.customLayerMatrix()),x.setDirty(),c.setBaseState())}else if(c.renderPass==="translucent"){c.setCustomLayerDefaults(),x.setColorMode(c.colorModeForRenderPass()),x.setStencilMode(Ae.disabled);var B=k.renderingMode==="3d"?new _e(c.context.gl.LEQUAL,_e.ReadWrite,c.depthRangeFor3D):c.depthModeForSublayer(0,_e.ReadOnly);x.setDepthMode(B),k.render(x.gl,c.transform.customLayerMatrix()),x.setDirty(),c.setBaseState(),x.bindFramebuffer.set(null)}}},sn=function(c,m){this.context=new ye(c),this.transform=m,this._tileTextures={},this.setup(),this.numSublayers=Me.maxUnderzooming+Me.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Va,this.gpuTimers={}};sn.prototype.resize=function(c,m){if(this.width=c*f.browser.devicePixelRatio,this.height=m*f.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var d=0,x=this.style._order;d<x.length;d+=1)this.style._layers[x[d]].resize()},sn.prototype.setup=function(){var c=this.context,m=new f.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(f.EXTENT,0),m.emplaceBack(0,f.EXTENT),m.emplaceBack(f.EXTENT,f.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(m,Tn.members),this.tileExtentSegments=f.SegmentVector.simpleSegment(0,0,4,2);var d=new f.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(f.EXTENT,0),d.emplaceBack(0,f.EXTENT),d.emplaceBack(f.EXTENT,f.EXTENT),this.debugBuffer=c.createVertexBuffer(d,Tn.members),this.debugSegments=f.SegmentVector.simpleSegment(0,0,4,5);var x=new f.StructArrayLayout4i8;x.emplaceBack(0,0,0,0),x.emplaceBack(f.EXTENT,0,f.EXTENT,0),x.emplaceBack(0,f.EXTENT,0,f.EXTENT),x.emplaceBack(f.EXTENT,f.EXTENT,f.EXTENT,f.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(x,Yt.members),this.rasterBoundsSegments=f.SegmentVector.simpleSegment(0,0,4,2);var k=new f.StructArrayLayout2i4;k.emplaceBack(0,0),k.emplaceBack(1,0),k.emplaceBack(0,1),k.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(k,Tn.members),this.viewportSegments=f.SegmentVector.simpleSegment(0,0,4,2);var D=new f.StructArrayLayout1ui2;D.emplaceBack(0),D.emplaceBack(1),D.emplaceBack(3),D.emplaceBack(2),D.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(D);var B=new f.StructArrayLayout3ui6;B.emplaceBack(0,1,2),B.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(B),this.emptyTexture=new f.Texture(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA);var q=this.context.gl;this.stencilClearMode=new Ae({func:q.ALWAYS,mask:0},0,255,q.ZERO,q.ZERO,q.ZERO)},sn.prototype.clearStencil=function(){var c=this.context,m=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var d=f.create();f.ortho(d,0,this.width,this.height,0,0,1),f.scale(d,d,[m.drawingBufferWidth,m.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,m.TRIANGLES,_e.disabled,this.stencilClearMode,je.disabled,Ge.disabled,Ha(d),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},sn.prototype._renderTileClippingMasks=function(c,m){if(this.currentStencilSource!==c.source&&c.isTileClipped()&&m&&m.length){this.currentStencilSource=c.source;var d=this.context,x=d.gl;this.nextStencilID+m.length>256&&this.clearStencil(),d.setColorMode(je.disabled),d.setDepthMode(_e.disabled);var k=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var D=0,B=m;D<B.length;D+=1){var q=B[D],Y=this._tileClippingMaskIDs[q.key]=this.nextStencilID++;k.draw(d,x.TRIANGLES,_e.disabled,new Ae({func:x.ALWAYS,mask:0},Y,255,x.KEEP,x.KEEP,x.REPLACE),je.disabled,Ge.disabled,Ha(q.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},sn.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var c=this.nextStencilID++,m=this.context.gl;return new Ae({func:m.NOTEQUAL,mask:255},c,255,m.KEEP,m.KEEP,m.REPLACE)},sn.prototype.stencilModeForClipping=function(c){var m=this.context.gl;return new Ae({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,m.KEEP,m.KEEP,m.REPLACE)},sn.prototype.stencilConfigForOverlap=function(c){var m,d=this.context.gl,x=c.sort(function(Y,ie){return ie.overscaledZ-Y.overscaledZ}),k=x[x.length-1].overscaledZ,D=x[0].overscaledZ-k+1;if(D>1){this.currentStencilSource=void 0,this.nextStencilID+D>256&&this.clearStencil();for(var B={},q=0;q<D;q++)B[q+k]=new Ae({func:d.GEQUAL,mask:255},q+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=D,[B,x]}return[(m={},m[k]=Ae.disabled,m),x]},sn.prototype.colorModeForRenderPass=function(){var c=this.context.gl;return this._showOverdrawInspector?new je([c.CONSTANT_COLOR,c.ONE],new f.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?je.unblended:je.alphaBlended},sn.prototype.depthModeForSublayer=function(c,m,d){if(!this.opaquePassEnabledForLayer())return _e.disabled;var x=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new _e(d||this.context.gl.LEQUAL,m,[x,x])},sn.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},sn.prototype.render=function(c,m){var d=this;this.style=c,this.options=m,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(f.browser.now()),this.imageManager.beginFrame();var x=this.style._order,k=this.style.sourceCaches;for(var D in k){var B=k[D];B.used&&B.prepare(this.context)}var q,Y,ie={},he={},de={};for(var me in k){var ze=k[me];ie[me]=ze.getVisibleCoordinates(),he[me]=ie[me].slice().reverse(),de[me]=ze.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Ce=0;Ce<x.length;Ce++)if(this.style._layers[x[Ce]].is3D()){this.opaquePassCutoff=Ce;break}this.renderPass="offscreen";for(var Be=0,be=x;Be<be.length;Be+=1){var Pe=this.style._layers[be[Be]];if(Pe.hasOffscreenPass()&&!Pe.isHidden(this.transform.zoom)){var Ve=he[Pe.source];(Pe.type==="custom"||Ve.length)&&this.renderLayer(this,k[Pe.source],Pe,Ve)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:m.showOverdrawInspector?f.Color.black:f.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){var Ye=this.style._layers[x[this.currentLayer]],ot=k[Ye.source],lt=ie[Ye.source];this._renderTileClippingMasks(Ye,lt),this.renderLayer(this,ot,Ye,lt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){var ct=this.style._layers[x[this.currentLayer]],It=k[ct.source],Ot=(ct.type==="symbol"?de:he)[ct.source];this._renderTileClippingMasks(ct,ie[ct.source]),this.renderLayer(this,It,ct,Ot)}this.options.showTileBoundaries&&(f.values(this.style._layers).forEach(function(Rt){Rt.source&&!Rt.isHidden(d.transform.zoom)&&(Rt.source!==(Y&&Y.id)&&(Y=d.style.sourceCaches[Rt.source]),(!q||q.getSource().maxzoom<Y.getSource().maxzoom)&&(q=Y))}),q&&pa.debug(this,q,q.getVisibleCoordinates())),this.options.showPadding&&function(Rt){var ii=Rt.transform.padding;uc(Rt,Rt.transform.height-(ii.top||0),3,Mu),uc(Rt,ii.bottom||0,3,xl),ps(Rt,ii.left||0,3,bl),ps(Rt,Rt.transform.width-(ii.right||0),3,zo);var gi=Rt.transform.centerPoint;(function(Ii,yi,lr,si){wl(Ii,yi-1,lr-10,2,20,si),wl(Ii,yi-10,lr-1,20,2,si)})(Rt,gi.x,Rt.transform.height-gi.y,Po)}(this),this.context.setDefault()},sn.prototype.renderLayer=function(c,m,d,x){d.isHidden(this.transform.zoom)||(d.type==="background"||d.type==="custom"||x.length)&&(this.id=d.id,this.gpuTimingStart(d),pa[d.type](c,m,d,x,this.style.placement.variableOffsets),this.gpuTimingEnd())},sn.prototype.gpuTimingStart=function(c){if(this.options.gpuTiming){var m=this.context.extTimerQuery,d=this.gpuTimers[c.id];d||(d=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),d.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,d.query)}},sn.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}},sn.prototype.collectGpuTimers=function(){var c=this.gpuTimers;return this.gpuTimers={},c},sn.prototype.queryGpuTimers=function(c){var m={};for(var d in c){var x=c[d],k=this.context.extTimerQuery,D=k.getQueryObjectEXT(x.query,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(x.query),m[d]=D}return m},sn.prototype.translatePosMatrix=function(c,m,d,x,k){if(!d[0]&&!d[1])return c;var D=k?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(D){var B=Math.sin(D),q=Math.cos(D);d=[d[0]*q-d[1]*B,d[0]*B+d[1]*q]}var Y=[k?d[0]:Qr(m,d[0],this.transform.zoom),k?d[1]:Qr(m,d[1],this.transform.zoom),0],ie=new Float32Array(16);return f.translate(ie,c,Y),ie},sn.prototype.saveTileTexture=function(c){var m=this._tileTextures[c.size[0]];m?m.push(c):this._tileTextures[c.size[0]]=[c]},sn.prototype.getTileTexture=function(c){var m=this._tileTextures[c];return m&&m.length>0?m.pop():null},sn.prototype.isPatternMissing=function(c){if(!c)return!1;if(!c.from||!c.to)return!0;var m=this.imageManager.getPattern(c.from.toString()),d=this.imageManager.getPattern(c.to.toString());return!m||!d},sn.prototype.useProgram=function(c,m){this.cache=this.cache||{};var d=""+c+(m?m.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[d]||(this.cache[d]=new Cu(this.context,c,Xs[c],m,lc[c],this._showOverdrawInspector)),this.cache[d]},sn.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},sn.prototype.setBaseState=function(){var c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)},sn.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=f.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new f.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},sn.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var El=function(c,m){this.points=c,this.planes=m};El.fromInvProjectionMatrix=function(c,m,d){var x=Math.pow(2,d),k=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(B){return f.transformMat4([],B,c)}).map(function(B){return f.scale$1([],B,1/B[3]/m*x)}),D=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(B){var q=f.sub([],k[B[0]],k[B[1]]),Y=f.sub([],k[B[2]],k[B[1]]),ie=f.normalize([],f.cross([],q,Y)),he=-f.dot(ie,k[B[1]]);return ie.concat(he)});return new El(k,D)};var Qs=function(c,m){this.min=c,this.max=m,this.center=f.scale$2([],f.add([],this.min,this.max),.5)};Qs.prototype.quadrant=function(c){for(var m=[c%2==0,c<2],d=f.clone$2(this.min),x=f.clone$2(this.max),k=0;k<m.length;k++)d[k]=m[k]?this.min[k]:this.center[k],x[k]=m[k]?this.center[k]:this.max[k];return x[2]=this.max[2],new Qs(d,x)},Qs.prototype.distanceX=function(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]},Qs.prototype.distanceY=function(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]},Qs.prototype.intersects=function(c){for(var m=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],d=!0,x=0;x<c.planes.length;x++){for(var k=c.planes[x],D=0,B=0;B<m.length;B++)D+=f.dot$1(k,m[B])>=0;if(D===0)return 0;D!==m.length&&(d=!1)}if(d)return 2;for(var q=0;q<3;q++){for(var Y=Number.MAX_VALUE,ie=-Number.MAX_VALUE,he=0;he<c.points.length;he++){var de=c.points[he][q]-this.min[q];Y=Math.min(Y,de),ie=Math.max(ie,de)}if(ie<0||Y>this.max[q]-this.min[q])return 0}return 1};var ds=function(c,m,d,x){if(c===void 0&&(c=0),m===void 0&&(m=0),d===void 0&&(d=0),x===void 0&&(x=0),isNaN(c)||c<0||isNaN(m)||m<0||isNaN(d)||d<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=m,this.left=d,this.right=x};ds.prototype.interpolate=function(c,m,d){return m.top!=null&&c.top!=null&&(this.top=f.number(c.top,m.top,d)),m.bottom!=null&&c.bottom!=null&&(this.bottom=f.number(c.bottom,m.bottom,d)),m.left!=null&&c.left!=null&&(this.left=f.number(c.left,m.left,d)),m.right!=null&&c.right!=null&&(this.right=f.number(c.right,m.right,d)),this},ds.prototype.getCenter=function(c,m){var d=f.clamp((this.left+c-this.right)/2,0,c),x=f.clamp((this.top+m-this.bottom)/2,0,m);return new f.Point(d,x)},ds.prototype.equals=function(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right},ds.prototype.clone=function(){return new ds(this.top,this.bottom,this.left,this.right)},ds.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var tr=function(c,m,d,x,k){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=k===void 0||k,this._minZoom=c||0,this._maxZoom=m||22,this._minPitch=d==null?0:d,this._maxPitch=x==null?60:x,this.setMaxBounds(),this.width=0,this.height=0,this._center=new f.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ds,this._posMatrixCache={},this._alignedPosMatrixCache={}},Mr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};tr.prototype.clone=function(){var c=new tr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c._center=this._center,c.zoom=this.zoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._calcMatrices(),c},Mr.minZoom.get=function(){return this._minZoom},Mr.minZoom.set=function(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))},Mr.maxZoom.get=function(){return this._maxZoom},Mr.maxZoom.set=function(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))},Mr.minPitch.get=function(){return this._minPitch},Mr.minPitch.set=function(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))},Mr.maxPitch.get=function(){return this._maxPitch},Mr.maxPitch.set=function(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))},Mr.renderWorldCopies.get=function(){return this._renderWorldCopies},Mr.renderWorldCopies.set=function(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c},Mr.worldSize.get=function(){return this.tileSize*this.scale},Mr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Mr.size.get=function(){return new f.Point(this.width,this.height)},Mr.bearing.get=function(){return-this.angle/Math.PI*180},Mr.bearing.set=function(c){var m=-f.wrap(c,-180,180)*Math.PI/180;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=f.create$2(),f.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Mr.pitch.get=function(){return this._pitch/Math.PI*180},Mr.pitch.set=function(c){var m=f.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())},Mr.fov.get=function(){return this._fov/Math.PI*180},Mr.fov.set=function(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())},Mr.zoom.get=function(){return this._zoom},Mr.zoom.set=function(c){var m=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._zoom=m,this.scale=this.zoomScale(m),this.tileZoom=Math.floor(m),this.zoomFraction=m-this.tileZoom,this._constrain(),this._calcMatrices())},Mr.center.get=function(){return this._center},Mr.center.set=function(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())},Mr.padding.get=function(){return this._edgeInsets.toJSON()},Mr.padding.set=function(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())},Mr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},tr.prototype.isPaddingEqual=function(c){return this._edgeInsets.equals(c)},tr.prototype.interpolatePadding=function(c,m,d){this._unmodified=!1,this._edgeInsets.interpolate(c,m,d),this._constrain(),this._calcMatrices()},tr.prototype.coveringZoomLevel=function(c){var m=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,m)},tr.prototype.getVisibleUnwrappedCoordinates=function(c){var m=[new f.UnwrappedTileID(0,c)];if(this._renderWorldCopies)for(var d=this.pointCoordinate(new f.Point(0,0)),x=this.pointCoordinate(new f.Point(this.width,0)),k=this.pointCoordinate(new f.Point(this.width,this.height)),D=this.pointCoordinate(new f.Point(0,this.height)),B=Math.floor(Math.min(d.x,x.x,k.x,D.x)),q=Math.floor(Math.max(d.x,x.x,k.x,D.x)),Y=B-1;Y<=q+1;Y++)Y!==0&&m.push(new f.UnwrappedTileID(Y,c));return m},tr.prototype.coveringTiles=function(c){var m=this.coveringZoomLevel(c),d=m;if(c.minzoom!==void 0&&m<c.minzoom)return[];c.maxzoom!==void 0&&m>c.maxzoom&&(m=c.maxzoom);var x=f.MercatorCoordinate.fromLngLat(this.center),k=Math.pow(2,m),D=[k*x.x,k*x.y,0],B=El.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m),q=c.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(q=m);var Y=function(Rt){return{aabb:new Qs([Rt*k,0,0],[(Rt+1)*k,k,0]),zoom:0,x:0,y:0,wrap:Rt,fullyVisible:!1}},ie=[],he=[],de=m,me=c.reparseOverscaled?d:m;if(this._renderWorldCopies)for(var ze=1;ze<=3;ze++)ie.push(Y(-ze)),ie.push(Y(ze));for(ie.push(Y(0));ie.length>0;){var Ce=ie.pop(),Be=Ce.x,be=Ce.y,Pe=Ce.fullyVisible;if(!Pe){var Ve=Ce.aabb.intersects(B);if(Ve===0)continue;Pe=Ve===2}var Ye=Ce.aabb.distanceX(D),ot=Ce.aabb.distanceY(D),lt=Math.max(Math.abs(Ye),Math.abs(ot));if(Ce.zoom===de||lt>3+(1<<de-Ce.zoom)-2&&Ce.zoom>=q)he.push({tileID:new f.OverscaledTileID(Ce.zoom===de?me:Ce.zoom,Ce.wrap,Ce.zoom,Be,be),distanceSq:f.sqrLen([D[0]-.5-Be,D[1]-.5-be])});else for(var ct=0;ct<4;ct++){var It=(Be<<1)+ct%2,Ot=(be<<1)+(ct>>1);ie.push({aabb:Ce.aabb.quadrant(ct),zoom:Ce.zoom+1,x:It,y:Ot,wrap:Ce.wrap,fullyVisible:Pe})}}return he.sort(function(Rt,ii){return Rt.distanceSq-ii.distanceSq}).map(function(Rt){return Rt.tileID})},tr.prototype.resize=function(c,m){this.width=c,this.height=m,this.pixelsToGLUnits=[2/c,-2/m],this._constrain(),this._calcMatrices()},Mr.unmodified.get=function(){return this._unmodified},tr.prototype.zoomScale=function(c){return Math.pow(2,c)},tr.prototype.scaleZoom=function(c){return Math.log(c)/Math.LN2},tr.prototype.project=function(c){var m=f.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new f.Point(f.mercatorXfromLng(c.lng)*this.worldSize,f.mercatorYfromLat(m)*this.worldSize)},tr.prototype.unproject=function(c){return new f.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()},Mr.point.get=function(){return this.project(this.center)},tr.prototype.setLocationAtPoint=function(c,m){var d=this.pointCoordinate(m),x=this.pointCoordinate(this.centerPoint),k=this.locationCoordinate(c),D=new f.MercatorCoordinate(k.x-(d.x-x.x),k.y-(d.y-x.y));this.center=this.coordinateLocation(D),this._renderWorldCopies&&(this.center=this.center.wrap())},tr.prototype.locationPoint=function(c){return this.coordinatePoint(this.locationCoordinate(c))},tr.prototype.pointLocation=function(c){return this.coordinateLocation(this.pointCoordinate(c))},tr.prototype.locationCoordinate=function(c){return f.MercatorCoordinate.fromLngLat(c)},tr.prototype.coordinateLocation=function(c){return c.toLngLat()},tr.prototype.pointCoordinate=function(c){var m=[c.x,c.y,0,1],d=[c.x,c.y,1,1];f.transformMat4(m,m,this.pixelMatrixInverse),f.transformMat4(d,d,this.pixelMatrixInverse);var x=m[3],k=d[3],D=m[1]/x,B=d[1]/k,q=m[2]/x,Y=d[2]/k,ie=q===Y?0:(0-q)/(Y-q);return new f.MercatorCoordinate(f.number(m[0]/x,d[0]/k,ie)/this.worldSize,f.number(D,B,ie)/this.worldSize)},tr.prototype.coordinatePoint=function(c){var m=[c.x*this.worldSize,c.y*this.worldSize,0,1];return f.transformMat4(m,m,this.pixelMatrix),new f.Point(m[0]/m[3],m[1]/m[3])},tr.prototype.getBounds=function(){return new f.LngLatBounds().extend(this.pointLocation(new f.Point(0,0))).extend(this.pointLocation(new f.Point(this.width,0))).extend(this.pointLocation(new f.Point(this.width,this.height))).extend(this.pointLocation(new f.Point(0,this.height)))},tr.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new f.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},tr.prototype.setMaxBounds=function(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},tr.prototype.calculatePosMatrix=function(c,m){m===void 0&&(m=!1);var d=c.key,x=m?this._alignedPosMatrixCache:this._posMatrixCache;if(x[d])return x[d];var k=c.canonical,D=this.worldSize/this.zoomScale(k.z),B=k.x+Math.pow(2,k.z)*c.wrap,q=f.identity(new Float64Array(16));return f.translate(q,q,[B*D,k.y*D,0]),f.scale(q,q,[D/f.EXTENT,D/f.EXTENT,1]),f.multiply(q,m?this.alignedProjMatrix:this.projMatrix,q),x[d]=new Float32Array(q),x[d]},tr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},tr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var c,m,d,x,k=-90,D=90,B=-180,q=180,Y=this.size,ie=this._unmodified;if(this.latRange){var he=this.latRange;k=f.mercatorYfromLat(he[1])*this.worldSize,c=(D=f.mercatorYfromLat(he[0])*this.worldSize)-k<Y.y?Y.y/(D-k):0}if(this.lngRange){var de=this.lngRange;B=f.mercatorXfromLng(de[0])*this.worldSize,m=(q=f.mercatorXfromLng(de[1])*this.worldSize)-B<Y.x?Y.x/(q-B):0}var me=this.point,ze=Math.max(m||0,c||0);if(ze)return this.center=this.unproject(new f.Point(m?(q+B)/2:me.x,c?(D+k)/2:me.y)),this.zoom+=this.scaleZoom(ze),this._unmodified=ie,void(this._constraining=!1);if(this.latRange){var Ce=me.y,Be=Y.y/2;Ce-Be<k&&(x=k+Be),Ce+Be>D&&(x=D-Be)}if(this.lngRange){var be=me.x,Pe=Y.x/2;be-Pe<B&&(d=B+Pe),be+Pe>q&&(d=q-Pe)}d===void 0&&x===void 0||(this.center=this.unproject(new f.Point(d!==void 0?d:me.x,x!==void 0?x:me.y))),this._unmodified=ie,this._constraining=!1}},tr.prototype._calcMatrices=function(){if(this.height){var c=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var m=Math.PI/2+this._pitch,d=this._fov*(.5+c.y/this.height),x=Math.sin(d)*this.cameraToCenterDistance/Math.sin(f.clamp(Math.PI-m-d,.01,Math.PI-.01)),k=this.point,D=k.x,B=k.y,q=1.01*(Math.cos(Math.PI/2-this._pitch)*x+this.cameraToCenterDistance),Y=this.height/50,ie=new Float64Array(16);f.perspective(ie,this._fov,this.width/this.height,Y,q),ie[8]=2*-c.x/this.width,ie[9]=2*c.y/this.height,f.scale(ie,ie,[1,-1,1]),f.translate(ie,ie,[0,0,-this.cameraToCenterDistance]),f.rotateX(ie,ie,this._pitch),f.rotateZ(ie,ie,this.angle),f.translate(ie,ie,[-D,-B,0]),this.mercatorMatrix=f.scale([],ie,[this.worldSize,this.worldSize,this.worldSize]),f.scale(ie,ie,[1,1,f.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=ie,this.invProjMatrix=f.invert([],this.projMatrix);var he=this.width%2/2,de=this.height%2/2,me=Math.cos(this.angle),ze=Math.sin(this.angle),Ce=D-Math.round(D)+me*he+ze*de,Be=B-Math.round(B)+me*de+ze*he,be=new Float64Array(ie);if(f.translate(be,be,[Ce>.5?Ce-1:Ce,Be>.5?Be-1:Be,0]),this.alignedProjMatrix=be,ie=f.create(),f.scale(ie,ie,[this.width/2,-this.height/2,1]),f.translate(ie,ie,[1,-1,0]),this.labelPlaneMatrix=ie,ie=f.create(),f.scale(ie,ie,[1,-1,1]),f.translate(ie,ie,[-1,-1,0]),f.scale(ie,ie,[2/this.width,2/this.height,1]),this.glCoordMatrix=ie,this.pixelMatrix=f.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(ie=f.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=ie,this._posMatrixCache={},this._alignedPosMatrixCache={}}},tr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var c=this.pointCoordinate(new f.Point(0,0)),m=[c.x*this.worldSize,c.y*this.worldSize,0,1];return f.transformMat4(m,m,this.pixelMatrix)[3]/this.cameraToCenterDistance},tr.prototype.getCameraPoint=function(){var c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new f.Point(0,c))},tr.prototype.getCameraQueryGeometry=function(c){var m=this.getCameraPoint();if(c.length===1)return[c[0],m];for(var d=m.x,x=m.y,k=m.x,D=m.y,B=0,q=c;B<q.length;B+=1){var Y=q[B];d=Math.min(d,Y.x),x=Math.min(x,Y.y),k=Math.max(k,Y.x),D=Math.max(D,Y.y)}return[new f.Point(d,x),new f.Point(k,x),new f.Point(k,D),new f.Point(d,D),new f.Point(d,x)]},Object.defineProperties(tr.prototype,Mr);var ti=function(c){var m,d,x,k;this._hashName=c&&encodeURIComponent(c),f.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(m=this._updateHashUnthrottled.bind(this),d=!1,x=null,k=function(){x=null,d&&(m(),x=setTimeout(k,300),d=!1)},function(){return d=!0,x||k(),x})};ti.prototype.addTo=function(c){return this._map=c,f.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},ti.prototype.remove=function(){return f.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},ti.prototype.getHashString=function(c){var m=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,x=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),k=Math.pow(10,x),D=Math.round(m.lng*k)/k,B=Math.round(m.lat*k)/k,q=this._map.getBearing(),Y=this._map.getPitch(),ie="";if(ie+=c?"/"+D+"/"+B+"/"+d:d+"/"+B+"/"+D,(q||Y)&&(ie+="/"+Math.round(10*q)/10),Y&&(ie+="/"+Math.round(Y)),this._hashName){var he=this._hashName,de=!1,me=f.window.location.hash.slice(1).split("&").map(function(ze){var Ce=ze.split("=")[0];return Ce===he?(de=!0,Ce+"="+ie):ze}).filter(function(ze){return ze});return de||me.push(he+"="+ie),"#"+me.join("&")}return"#"+ie},ti.prototype._getCurrentHash=function(){var c,m=this,d=f.window.location.hash.replace("#","");return this._hashName?(d.split("&").map(function(x){return x.split("=")}).forEach(function(x){x[0]===m._hashName&&(c=x)}),(c&&c[1]||"").split("/")):d.split("/")},ti.prototype._onHashChange=function(){var c=this._getCurrentHash();if(c.length>=3&&!c.some(function(d){return isNaN(d)})){var m=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:m,pitch:+(c[4]||0)}),!0}return!1},ti.prototype._updateHashUnthrottled=function(){var c=f.window.location.href.replace(/(#.+)?$/,this.getHashString());try{f.window.history.replaceState(f.window.history.state,null,c)}catch{}};var el={linearity:.3,easing:f.bezier(0,0,.3,1)},Xa=f.extend({deceleration:2500,maxSpeed:1400},el),Pa=f.extend({deceleration:20,maxSpeed:1400},el),eu=f.extend({deceleration:1e3,maxSpeed:360},el),ai=f.extend({deceleration:1e3,maxSpeed:90},el),tl=function(c){this._map=c,this.clear()};function Sl(c,m){(!c.duration||c.duration<m.duration)&&(c.duration=m.duration,c.easing=m.easing)}function fs(c,m,d){var x=d.maxSpeed,k=d.linearity,D=d.deceleration,B=f.clamp(c*k/(m/1e3),-x,x),q=Math.abs(B)/(D*k);return{easing:d.easing,duration:1e3*q,amount:B*(q/2)}}tl.prototype.clear=function(){this._inertiaBuffer=[]},tl.prototype.record=function(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:f.browser.now(),settings:c})},tl.prototype._drainInertiaBuffer=function(){for(var c=this._inertiaBuffer,m=f.browser.now();c.length>0&&m-c[0].time>160;)c.shift()},tl.prototype._onMoveEnd=function(c){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var m={zoom:0,bearing:0,pitch:0,pan:new f.Point(0,0),pinchAround:void 0,around:void 0},d=0,x=this._inertiaBuffer;d<x.length;d+=1){var k=x[d].settings;m.zoom+=k.zoomDelta||0,m.bearing+=k.bearingDelta||0,m.pitch+=k.pitchDelta||0,k.panDelta&&m.pan._add(k.panDelta),k.around&&(m.around=k.around),k.pinchAround&&(m.pinchAround=k.pinchAround)}var D=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,B={};if(m.pan.mag()){var q=fs(m.pan.mag(),D,f.extend({},Xa,c||{}));B.offset=m.pan.mult(q.amount/m.pan.mag()),B.center=this._map.transform.center,Sl(B,q)}if(m.zoom){var Y=fs(m.zoom,D,Pa);B.zoom=this._map.transform.zoom+Y.amount,Sl(B,Y)}if(m.bearing){var ie=fs(m.bearing,D,eu);B.bearing=this._map.transform.bearing+f.clamp(ie.amount,-179,179),Sl(B,ie)}if(m.pitch){var he=fs(m.pitch,D,ai);B.pitch=this._map.transform.pitch+he.amount,Sl(B,he)}if(B.zoom||B.bearing){var de=m.pinchAround===void 0?m.around:m.pinchAround;B.around=de?this._map.unproject(de):this._map.getCenter()}return this.clear(),f.extend(B,{noMoveStart:!0})}};var pn=function(c){function m(x,k,D,B){B===void 0&&(B={});var q=L.mousePos(k.getCanvasContainer(),D),Y=k.unproject(q);c.call(this,x,f.extend({point:q,lngLat:Y,originalEvent:D},B)),this._defaultPrevented=!1,this.target=k}c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m;var d={defaultPrevented:{configurable:!0}};return m.prototype.preventDefault=function(){this._defaultPrevented=!0},d.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(m.prototype,d),m}(f.Event),Il=function(c){function m(x,k,D){var B=x==="touchend"?D.changedTouches:D.touches,q=L.touchPos(k.getCanvasContainer(),B),Y=q.map(function(de){return k.unproject(de)}),ie=q.reduce(function(de,me,ze,Ce){return de.add(me.div(Ce.length))},new f.Point(0,0)),he=k.unproject(ie);c.call(this,x,{points:q,point:ie,lngLats:Y,lngLat:he,originalEvent:D}),this._defaultPrevented=!1}c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m;var d={defaultPrevented:{configurable:!0}};return m.prototype.preventDefault=function(){this._defaultPrevented=!0},d.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(m.prototype,d),m}(f.Event),cc=function(c){function m(x,k,D){c.call(this,x,{originalEvent:D}),this._defaultPrevented=!1}c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m;var d={defaultPrevented:{configurable:!0}};return m.prototype.preventDefault=function(){this._defaultPrevented=!0},d.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(m.prototype,d),m}(f.Event),zn=function(c,m){this._map=c,this._clickTolerance=m.clickTolerance};zn.prototype.reset=function(){delete this._mousedownPos},zn.prototype.wheel=function(c){return this._firePreventable(new cc(c.type,this._map,c))},zn.prototype.mousedown=function(c,m){return this._mousedownPos=m,this._firePreventable(new pn(c.type,this._map,c))},zn.prototype.mouseup=function(c){this._map.fire(new pn(c.type,this._map,c))},zn.prototype.click=function(c,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||this._map.fire(new pn(c.type,this._map,c))},zn.prototype.dblclick=function(c){return this._firePreventable(new pn(c.type,this._map,c))},zn.prototype.mouseover=function(c){this._map.fire(new pn(c.type,this._map,c))},zn.prototype.mouseout=function(c){this._map.fire(new pn(c.type,this._map,c))},zn.prototype.touchstart=function(c){return this._firePreventable(new Il(c.type,this._map,c))},zn.prototype.touchmove=function(c){this._map.fire(new Il(c.type,this._map,c))},zn.prototype.touchend=function(c){this._map.fire(new Il(c.type,this._map,c))},zn.prototype.touchcancel=function(c){this._map.fire(new Il(c.type,this._map,c))},zn.prototype._firePreventable=function(c){if(this._map.fire(c),c.defaultPrevented)return{}},zn.prototype.isEnabled=function(){return!0},zn.prototype.isActive=function(){return!1},zn.prototype.enable=function(){},zn.prototype.disable=function(){};var ui=function(c){this._map=c};ui.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ui.prototype.mousemove=function(c){this._map.fire(new pn(c.type,this._map,c))},ui.prototype.mousedown=function(){this._delayContextMenu=!0},ui.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new pn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ui.prototype.contextmenu=function(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new pn(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()},ui.prototype.isEnabled=function(){return!0},ui.prototype.isActive=function(){return!1},ui.prototype.enable=function(){},ui.prototype.disable=function(){};var So=function(c,m){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=m.clickTolerance||1};function Tl(c,m){for(var d={},x=0;x<c.length;x++)d[c[x].identifier]=m[x];return d}So.prototype.isEnabled=function(){return!!this._enabled},So.prototype.isActive=function(){return!!this._active},So.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},So.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},So.prototype.mousedown=function(c,m){this.isEnabled()&&c.shiftKey&&c.button===0&&(L.disableDrag(),this._startPos=this._lastPos=m,this._active=!0)},So.prototype.mousemoveWindow=function(c,m){if(this._active){var d=m;if(!(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)){var x=this._startPos;this._lastPos=d,this._box||(this._box=L.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));var k=Math.min(x.x,d.x),D=Math.max(x.x,d.x),B=Math.min(x.y,d.y),q=Math.max(x.y,d.y);L.setTransform(this._box,"translate("+k+"px,"+B+"px)"),this._box.style.width=D-k+"px",this._box.style.height=q-B+"px"}}},So.prototype.mouseupWindow=function(c,m){var d=this;if(this._active&&c.button===0){var x=this._startPos,k=m;if(this.reset(),L.suppressClick(),x.x!==k.x||x.y!==k.y)return this._map.fire(new f.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:function(D){return D.fitScreenCoordinates(x,k,d._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",c)}},So.prototype.keydown=function(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))},So.prototype.blur=function(){this.reset()},So.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(L.remove(this._box),this._box=null),L.enableDrag(),delete this._startPos,delete this._lastPos},So.prototype._fireEvent=function(c,m){return this._map.fire(new f.Event(c,{originalEvent:m}))};var Ds=function(c){this.reset(),this.numTouches=c.numTouches};Ds.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ds.prototype.touchstart=function(c,m,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),d.length===this.numTouches&&(this.centroid=function(x){for(var k=new f.Point(0,0),D=0,B=x;D<B.length;D+=1)k._add(B[D]);return k.div(x.length)}(m),this.touches=Tl(d,m)))},Ds.prototype.touchmove=function(c,m,d){if(!this.aborted&&this.centroid){var x=Tl(d,m);for(var k in this.touches){var D=x[k];(!D||D.dist(this.touches[k])>30)&&(this.aborted=!0)}}},Ds.prototype.touchend=function(c,m,d){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){var x=!this.aborted&&this.centroid;if(this.reset(),x)return x}};var da=function(c){this.singleTap=new Ds(c),this.numTaps=c.numTaps,this.reset()};da.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},da.prototype.touchstart=function(c,m,d){this.singleTap.touchstart(c,m,d)},da.prototype.touchmove=function(c,m,d){this.singleTap.touchmove(c,m,d)},da.prototype.touchend=function(c,m,d){var x=this.singleTap.touchend(c,m,d);if(x){var k=c.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(x)<30;if(k&&D||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}};var ln=function(){this._zoomIn=new da({numTouches:1,numTaps:2}),this._zoomOut=new da({numTouches:2,numTaps:1}),this.reset()};ln.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ln.prototype.touchstart=function(c,m,d){this._zoomIn.touchstart(c,m,d),this._zoomOut.touchstart(c,m,d)},ln.prototype.touchmove=function(c,m,d){this._zoomIn.touchmove(c,m,d),this._zoomOut.touchmove(c,m,d)},ln.prototype.touchend=function(c,m,d){var x=this,k=this._zoomIn.touchend(c,m,d),D=this._zoomOut.touchend(c,m,d);return k?(this._active=!0,c.preventDefault(),setTimeout(function(){return x.reset()},0),{cameraAnimation:function(B){return B.easeTo({duration:300,zoom:B.getZoom()+1,around:B.unproject(k)},{originalEvent:c})}}):D?(this._active=!0,c.preventDefault(),setTimeout(function(){return x.reset()},0),{cameraAnimation:function(B){return B.easeTo({duration:300,zoom:B.getZoom()-1,around:B.unproject(D)},{originalEvent:c})}}):void 0},ln.prototype.touchcancel=function(){this.reset()},ln.prototype.enable=function(){this._enabled=!0},ln.prototype.disable=function(){this._enabled=!1,this.reset()},ln.prototype.isEnabled=function(){return this._enabled},ln.prototype.isActive=function(){return this._active};var Ka={0:1,2:2},Wt=function(c){this.reset(),this._clickTolerance=c.clickTolerance||1};Wt.prototype.blur=function(){this.reset()},Wt.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Wt.prototype._correctButton=function(c,m){return!1},Wt.prototype._move=function(c,m){return{}},Wt.prototype.mousedown=function(c,m){if(!this._lastPoint){var d=L.mouseButton(c);this._correctButton(c,d)&&(this._lastPoint=m,this._eventButton=d)}},Wt.prototype.mousemoveWindow=function(c,m){var d=this._lastPoint;if(d){if(c.preventDefault(),function(x,k){var D=Ka[k];return x.buttons===void 0||(x.buttons&D)!==D}(c,this._eventButton))this.reset();else if(this._moved||!(m.dist(d)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(d,m)}},Wt.prototype.mouseupWindow=function(c){this._lastPoint&&L.mouseButton(c)===this._eventButton&&(this._moved&&L.suppressClick(),this.reset())},Wt.prototype.enable=function(){this._enabled=!0},Wt.prototype.disable=function(){this._enabled=!1,this.reset()},Wt.prototype.isEnabled=function(){return this._enabled},Wt.prototype.isActive=function(){return this._active};var tu=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.mousedown=function(d,x){c.prototype.mousedown.call(this,d,x),this._lastPoint&&(this._active=!0)},m.prototype._correctButton=function(d,x){return x===0&&!d.ctrlKey},m.prototype._move=function(d,x){return{around:x,panDelta:x.sub(d)}},m}(Wt),ms=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype._correctButton=function(d,x){return x===0&&d.ctrlKey||x===2},m.prototype._move=function(d,x){var k=.8*(x.x-d.x);if(k)return this._active=!0,{bearingDelta:k}},m.prototype.contextmenu=function(d){d.preventDefault()},m}(Wt),iu=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype._correctButton=function(d,x){return x===0&&d.ctrlKey||x===2},m.prototype._move=function(d,x){var k=-.5*(x.y-d.y);if(k)return this._active=!0,{pitchDelta:k}},m.prototype.contextmenu=function(d){d.preventDefault()},m}(Wt),jo=function(c){this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset()};jo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new f.Point(0,0)},jo.prototype.touchstart=function(c,m,d){return this._calculateTransform(c,m,d)},jo.prototype.touchmove=function(c,m,d){if(this._active&&!(d.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,m,d)},jo.prototype.touchend=function(c,m,d){this._calculateTransform(c,m,d),this._active&&d.length<this._minTouches&&this.reset()},jo.prototype.touchcancel=function(){this.reset()},jo.prototype._calculateTransform=function(c,m,d){d.length>0&&(this._active=!0);var x=Tl(d,m),k=new f.Point(0,0),D=new f.Point(0,0),B=0;for(var q in x){var Y=x[q],ie=this._touches[q];ie&&(k._add(Y),D._add(Y.sub(ie)),B++,x[q]=Y)}if(this._touches=x,!(B<this._minTouches)&&D.mag()){var he=D.div(B);if(this._sum._add(he),!(this._sum.mag()<this._clickTolerance))return{around:k.div(B),panDelta:he}}},jo.prototype.enable=function(){this._enabled=!0},jo.prototype.disable=function(){this._enabled=!1,this.reset()},jo.prototype.isEnabled=function(){return this._enabled},jo.prototype.isActive=function(){return this._active};var dn=function(){this.reset()};function rn(c,m,d){for(var x=0;x<c.length;x++)if(c[x].identifier===d)return m[x]}function il(c,m){return Math.log(c/m)/Math.LN2}dn.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},dn.prototype._start=function(c){},dn.prototype._move=function(c,m,d){return{}},dn.prototype.touchstart=function(c,m,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([m[0],m[1]]))},dn.prototype.touchmove=function(c,m,d){if(this._firstTwoTouches){c.preventDefault();var x=this._firstTwoTouches,k=x[1],D=rn(d,m,x[0]),B=rn(d,m,k);if(D&&B){var q=this._aroundCenter?null:D.add(B).div(2);return this._move([D,B],q,c)}}},dn.prototype.touchend=function(c,m,d){if(this._firstTwoTouches){var x=this._firstTwoTouches,k=x[1],D=rn(d,m,x[0]),B=rn(d,m,k);D&&B||(this._active&&L.suppressClick(),this.reset())}},dn.prototype.touchcancel=function(){this.reset()},dn.prototype.enable=function(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"},dn.prototype.disable=function(){this._enabled=!1,this.reset()},dn.prototype.isEnabled=function(){return this._enabled},dn.prototype.isActive=function(){return this._active};var Io=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.reset=function(){c.prototype.reset.call(this),delete this._distance,delete this._startDistance},m.prototype._start=function(d){this._startDistance=this._distance=d[0].dist(d[1])},m.prototype._move=function(d,x){var k=this._distance;if(this._distance=d[0].dist(d[1]),this._active||!(Math.abs(il(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:il(this._distance,k),pinchAround:x}},m}(dn);function Ma(c,m){return 180*c.angleWith(m)/Math.PI}var hc=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.reset=function(){c.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},m.prototype._start=function(d){this._startVector=this._vector=d[0].sub(d[1]),this._minDiameter=d[0].dist(d[1])},m.prototype._move=function(d,x){var k=this._vector;if(this._vector=d[0].sub(d[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ma(this._vector,k),pinchAround:x}},m.prototype._isBelowThreshold=function(d){this._minDiameter=Math.min(this._minDiameter,d.mag());var x=25/(Math.PI*this._minDiameter)*360,k=Ma(d,this._startVector);return Math.abs(k)<x},m}(dn);function Al(c){return Math.abs(c.y)>Math.abs(c.x)}var pc=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.reset=function(){c.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},m.prototype._start=function(d){this._lastPoints=d,Al(d[0].sub(d[1]))&&(this._valid=!1)},m.prototype._move=function(d,x,k){var D=d[0].sub(this._lastPoints[0]),B=d[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(D,B,k.timeStamp),this._valid)return this._lastPoints=d,this._active=!0,{pitchDelta:(D.y+B.y)/2*-.5}},m.prototype.gestureBeginsVertically=function(d,x,k){if(this._valid!==void 0)return this._valid;var D=d.mag()>=2,B=x.mag()>=2;if(D||B){if(!D||!B)return this._firstMove===void 0&&(this._firstMove=k),k-this._firstMove<100&&void 0;var q=d.y>0==x.y>0;return Al(d)&&Al(x)&&q}},m}(dn),ba={panStep:100,bearingStep:15,pitchStep:10},Wo=function(){var c=ba;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1};function ci(c){return c*(2-c)}Wo.prototype.blur=function(){this.reset()},Wo.prototype.reset=function(){this._active=!1},Wo.prototype.keydown=function(c){var m=this;if(!(c.altKey||c.ctrlKey||c.metaKey)){var d=0,x=0,k=0,D=0,B=0;switch(c.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:c.shiftKey?x=-1:(c.preventDefault(),D=-1);break;case 39:c.shiftKey?x=1:(c.preventDefault(),D=1);break;case 38:c.shiftKey?k=1:(c.preventDefault(),B=-1);break;case 40:c.shiftKey?k=-1:(c.preventDefault(),B=1);break;default:return}return this._rotationDisabled&&(x=0,k=0),{cameraAnimation:function(q){var Y=q.getZoom();q.easeTo({duration:300,easeId:"keyboardHandler",easing:ci,zoom:d?Math.round(Y)+d*(c.shiftKey?2:1):Y,bearing:q.getBearing()+x*m._bearingStep,pitch:q.getPitch()+k*m._pitchStep,offset:[-D*m._panStep,-B*m._panStep],center:q.getCenter()},{originalEvent:c})}}}},Wo.prototype.enable=function(){this._enabled=!0},Wo.prototype.disable=function(){this._enabled=!1,this.reset()},Wo.prototype.isEnabled=function(){return this._enabled},Wo.prototype.isActive=function(){return this._active},Wo.prototype.disableRotation=function(){this._rotationDisabled=!0},Wo.prototype.enableRotation=function(){this._rotationDisabled=!1};var Vt=function(c,m){this._map=c,this._el=c.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,f.bindAll(["_onTimeout"],this)};Vt.prototype.setZoomRate=function(c){this._defaultZoomRate=c},Vt.prototype.setWheelZoomRate=function(c){this._wheelZoomRate=c},Vt.prototype.isEnabled=function(){return!!this._enabled},Vt.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Vt.prototype.isZooming=function(){return!!this._zooming},Vt.prototype.enable=function(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&c.around==="center")},Vt.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Vt.prototype.wheel=function(c){if(this.isEnabled()){var m=c.deltaMode===f.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY,d=f.browser.now(),x=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,m!==0&&m%4.000244140625==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(x*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),c.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=c,this._delta-=m,this._active||this._start(c)),c.preventDefault()}},Vt.prototype._onTimeout=function(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},Vt.prototype._start=function(c){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var m=L.mousePos(this._el,c);this._around=f.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(m)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Vt.prototype.renderFrame=function(){var c=this;if(this._frameId&&(this._frameId=null,this.isActive())){var m=this._map.transform;if(this._delta!==0){var d=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,x=2/(1+Math.exp(-Math.abs(this._delta*d)));this._delta<0&&x!==0&&(x=1/x);var k=typeof this._targetZoom=="number"?m.zoomScale(this._targetZoom):m.scale;this._targetZoom=Math.min(m.maxZoom,Math.max(m.minZoom,m.scaleZoom(k*x))),this._type==="wheel"&&(this._startZoom=m.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var D,B=typeof this._targetZoom=="number"?this._targetZoom:m.zoom,q=this._startZoom,Y=this._easing,ie=!1;if(this._type==="wheel"&&q&&Y){var he=Math.min((f.browser.now()-this._lastWheelEventTime)/200,1),de=Y(he);D=f.number(q,B,de),he<1?this._frameId||(this._frameId=!0):ie=!0}else D=B,ie=!0;return this._active=!0,ie&&(this._active=!1,this._finishTimeout=setTimeout(function(){c._zooming=!1,c._handler._triggerRenderFrame(),delete c._targetZoom,delete c._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!ie,zoomDelta:D-m.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Vt.prototype._smoothOutEasing=function(c){var m=f.ease;if(this._prevEase){var d=this._prevEase,x=(f.browser.now()-d.start)/d.duration,k=d.easing(x+.01)-d.easing(x),D=.27/Math.sqrt(k*k+1e-4)*.01,B=Math.sqrt(.0729-D*D);m=f.bezier(D,B,.25,1)}return this._prevEase={start:f.browser.now(),duration:c,easing:m},m},Vt.prototype.blur=function(){this.reset()},Vt.prototype.reset=function(){this._active=!1};var Xo=function(c,m){this._clickZoom=c,this._tapZoom=m};Xo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Xo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Xo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Xo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Mo=function(){this.reset()};Mo.prototype.reset=function(){this._active=!1},Mo.prototype.blur=function(){this.reset()},Mo.prototype.dblclick=function(c,m){return c.preventDefault(),{cameraAnimation:function(d){d.easeTo({duration:300,zoom:d.getZoom()+(c.shiftKey?-1:1),around:d.unproject(m)},{originalEvent:c})}}},Mo.prototype.enable=function(){this._enabled=!0},Mo.prototype.disable=function(){this._enabled=!1,this.reset()},Mo.prototype.isEnabled=function(){return this._enabled},Mo.prototype.isActive=function(){return this._active};var Vn=function(){this._tap=new da({numTouches:1,numTaps:1}),this.reset()};Vn.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Vn.prototype.touchstart=function(c,m,d){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?d.length>0&&(this._swipePoint=m[0],this._swipeTouch=d[0].identifier):this._tap.touchstart(c,m,d))},Vn.prototype.touchmove=function(c,m,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;var x=m[0],k=x.y-this._swipePoint.y;return this._swipePoint=x,c.preventDefault(),this._active=!0,{zoomDelta:k/128}}}else this._tap.touchmove(c,m,d)},Vn.prototype.touchend=function(c,m,d){this._tapTime?this._swipePoint&&d.length===0&&this.reset():this._tap.touchend(c,m,d)&&(this._tapTime=c.timeStamp)},Vn.prototype.touchcancel=function(){this.reset()},Vn.prototype.enable=function(){this._enabled=!0},Vn.prototype.disable=function(){this._enabled=!1,this.reset()},Vn.prototype.isEnabled=function(){return this._enabled},Vn.prototype.isActive=function(){return this._active};var fn=function(c,m,d){this._el=c,this._mousePan=m,this._touchPan=d};fn.prototype.enable=function(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},fn.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},fn.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},fn.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ko=function(c,m,d){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=m,this._mousePitch=d};Ko.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ko.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ko.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ko.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var bn=function(c,m,d,x){this._el=c,this._touchZoom=m,this._touchRotate=d,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0};bn.prototype.enable=function(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},bn.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},bn.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},bn.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},bn.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},bn.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Lo=function(c){return c.zoom||c.drag||c.pitch||c.rotate},ys=function(c){function m(){c.apply(this,arguments)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m}(f.Event);function Kt(c){return c.panDelta&&c.panDelta.mag()||c.zoomDelta||c.bearingDelta||c.pitchDelta}var Xt=function(c,m){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new tl(c),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(m),f.bindAll(["handleEvent","handleWindowEvent"],this);var d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[f.window.document,"mousemove",{capture:!0}],[f.window.document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[f.window,"blur",void 0]];for(var x=0,k=this._listeners;x<k.length;x+=1){var D=k[x],B=D[0];L.addEventListener(B,D[1],B===f.window.document?this.handleWindowEvent:this.handleEvent,D[2])}};Xt.prototype.destroy=function(){for(var c=0,m=this._listeners;c<m.length;c+=1){var d=m[c],x=d[0];L.removeEventListener(x,d[1],x===f.window.document?this.handleWindowEvent:this.handleEvent,d[2])}},Xt.prototype._addDefaultHandlers=function(c){var m=this._map,d=m.getCanvasContainer();this._add("mapEvent",new zn(m,c));var x=m.boxZoom=new So(m,c);this._add("boxZoom",x);var k=new ln,D=new Mo;m.doubleClickZoom=new Xo(D,k),this._add("tapZoom",k),this._add("clickZoom",D);var B=new Vn;this._add("tapDragZoom",B);var q=m.touchPitch=new pc;this._add("touchPitch",q);var Y=new ms(c),ie=new iu(c);m.dragRotate=new Ko(c,Y,ie),this._add("mouseRotate",Y,["mousePitch"]),this._add("mousePitch",ie,["mouseRotate"]);var he=new tu(c),de=new jo(c);m.dragPan=new fn(d,he,de),this._add("mousePan",he),this._add("touchPan",de,["touchZoom","touchRotate"]);var me=new hc,ze=new Io;m.touchZoomRotate=new bn(d,ze,me,B),this._add("touchRotate",me,["touchPan","touchZoom"]),this._add("touchZoom",ze,["touchPan","touchRotate"]);var Ce=m.scrollZoom=new Vt(m,this);this._add("scrollZoom",Ce,["mousePan"]);var Be=m.keyboard=new Wo;this._add("keyboard",Be),this._add("blockableMapEvent",new ui(m));for(var be=0,Pe=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];be<Pe.length;be+=1){var Ve=Pe[be];c.interactive&&c[Ve]&&m[Ve].enable(c[Ve])}},Xt.prototype._add=function(c,m,d){this._handlers.push({handlerName:c,handler:m,allowed:d}),this._handlersById[c]=m},Xt.prototype.stop=function(c){if(!this._updatingCamera){for(var m=0,d=this._handlers;m<d.length;m+=1)d[m].handler.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}},Xt.prototype.isActive=function(){for(var c=0,m=this._handlers;c<m.length;c+=1)if(m[c].handler.isActive())return!0;return!1},Xt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Xt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Xt.prototype.isMoving=function(){return Boolean(Lo(this._eventsInProgress))||this.isZooming()},Xt.prototype._blockedByActive=function(c,m,d){for(var x in c)if(x!==d&&(!m||m.indexOf(x)<0))return!0;return!1},Xt.prototype.handleWindowEvent=function(c){this.handleEvent(c,c.type+"Window")},Xt.prototype._getMapTouches=function(c){for(var m=[],d=0,x=c;d<x.length;d+=1){var k=x[d];this._el.contains(k.target)&&m.push(k)}return m},Xt.prototype.handleEvent=function(c,m){this._updatingCamera=!0;for(var d=c.type==="renderFrame"?void 0:c,x={needsRenderFrame:!1},k={},D={},B=c.touches?this._getMapTouches(c.touches):void 0,q=B?L.touchPos(this._el,B):L.mousePos(this._el,c),Y=0,ie=this._handlers;Y<ie.length;Y+=1){var he=ie[Y],de=he.handlerName,me=he.handler,ze=he.allowed;if(me.isEnabled()){var Ce=void 0;this._blockedByActive(D,ze,de)?me.reset():me[m||c.type]&&(Ce=me[m||c.type](c,q,B),this.mergeHandlerResult(x,k,Ce,de,d),Ce&&Ce.needsRenderFrame&&this._triggerRenderFrame()),(Ce||me.isActive())&&(D[de]=me)}}var Be={};for(var be in this._previousActiveHandlers)D[be]||(Be[be]=d);this._previousActiveHandlers=D,(Object.keys(Be).length||Kt(x))&&(this._changes.push([x,k,Be]),this._triggerRenderFrame()),(Object.keys(D).length||Kt(x))&&this._map._stop(!0),this._updatingCamera=!1;var Pe=x.cameraAnimation;Pe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Pe(this._map))},Xt.prototype.mergeHandlerResult=function(c,m,d,x,k){if(d){f.extend(c,d);var D={handlerName:x,originalEvent:d.originalEvent||k};d.zoomDelta!==void 0&&(m.zoom=D),d.panDelta!==void 0&&(m.drag=D),d.pitchDelta!==void 0&&(m.pitch=D),d.bearingDelta!==void 0&&(m.rotate=D)}},Xt.prototype._applyChanges=function(){for(var c={},m={},d={},x=0,k=this._changes;x<k.length;x+=1){var D=k[x],B=D[0],q=D[1],Y=D[2];B.panDelta&&(c.panDelta=(c.panDelta||new f.Point(0,0))._add(B.panDelta)),B.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+B.zoomDelta),B.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+B.bearingDelta),B.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+B.pitchDelta),B.around!==void 0&&(c.around=B.around),B.pinchAround!==void 0&&(c.pinchAround=B.pinchAround),B.noInertia&&(c.noInertia=B.noInertia),f.extend(m,q),f.extend(d,Y)}this._updateMapTransform(c,m,d),this._changes=[]},Xt.prototype._updateMapTransform=function(c,m,d){var x=this._map,k=x.transform;if(!Kt(c))return this._fireEvents(m,d,!0);var D=c.panDelta,B=c.zoomDelta,q=c.bearingDelta,Y=c.pitchDelta,ie=c.around,he=c.pinchAround;he!==void 0&&(ie=he),x._stop(!0),ie=ie||x.transform.centerPoint;var de=k.pointLocation(D?ie.sub(D):ie);q&&(k.bearing+=q),Y&&(k.pitch+=Y),B&&(k.zoom+=B),k.setLocationAtPoint(de,ie),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(m,d,!0)},Xt.prototype._fireEvents=function(c,m,d){var x=this,k=Lo(this._eventsInProgress),D=Lo(c),B={};for(var q in c)this._eventsInProgress[q]||(B[q+"start"]=c[q].originalEvent),this._eventsInProgress[q]=c[q];for(var Y in!k&&D&&this._fireEvent("movestart",D.originalEvent),B)this._fireEvent(Y,B[Y]);for(var ie in D&&this._fireEvent("move",D.originalEvent),c)this._fireEvent(ie,c[ie].originalEvent);var he,de={};for(var me in this._eventsInProgress){var ze=this._eventsInProgress[me],Ce=ze.handlerName,Be=ze.originalEvent;this._handlersById[Ce].isActive()||(delete this._eventsInProgress[me],de[me+"end"]=he=m[Ce]||Be)}for(var be in de)this._fireEvent(be,de[be]);var Pe=Lo(this._eventsInProgress);if(d&&(k||D)&&!Pe){this._updatingCamera=!0;var Ve=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Ye=function(ot){return ot!==0&&-x._bearingSnap<ot&&ot<x._bearingSnap};Ve?(Ye(Ve.bearing||this._map.getBearing())&&(Ve.bearing=0),this._map.easeTo(Ve,{originalEvent:he})):(this._map.fire(new f.Event("moveend",{originalEvent:he})),Ye(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Xt.prototype._fireEvent=function(c,m){this._map.fire(new f.Event(c,m?{originalEvent:m}:{}))},Xt.prototype._requestFrame=function(){var c=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(m){delete c._frameId,c.handleEvent(new ys("renderFrame",{timeStamp:m})),c._applyChanges()})},Xt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var ru=function(c){function m(d,x){c.call(this),this._moving=!1,this._zooming=!1,this.transform=d,this._bearingSnap=x.bearingSnap,f.bindAll(["_renderFrameCallback"],this)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.getCenter=function(){return new f.LngLat(this.transform.center.lng,this.transform.center.lat)},m.prototype.setCenter=function(d,x){return this.jumpTo({center:d},x)},m.prototype.panBy=function(d,x,k){return d=f.Point.convert(d).mult(-1),this.panTo(this.transform.center,f.extend({offset:d},x),k)},m.prototype.panTo=function(d,x,k){return this.easeTo(f.extend({center:d},x),k)},m.prototype.getZoom=function(){return this.transform.zoom},m.prototype.setZoom=function(d,x){return this.jumpTo({zoom:d},x),this},m.prototype.zoomTo=function(d,x,k){return this.easeTo(f.extend({zoom:d},x),k)},m.prototype.zoomIn=function(d,x){return this.zoomTo(this.getZoom()+1,d,x),this},m.prototype.zoomOut=function(d,x){return this.zoomTo(this.getZoom()-1,d,x),this},m.prototype.getBearing=function(){return this.transform.bearing},m.prototype.setBearing=function(d,x){return this.jumpTo({bearing:d},x),this},m.prototype.getPadding=function(){return this.transform.padding},m.prototype.setPadding=function(d,x){return this.jumpTo({padding:d},x),this},m.prototype.rotateTo=function(d,x,k){return this.easeTo(f.extend({bearing:d},x),k)},m.prototype.resetNorth=function(d,x){return this.rotateTo(0,f.extend({duration:1e3},d),x),this},m.prototype.resetNorthPitch=function(d,x){return this.easeTo(f.extend({bearing:0,pitch:0,duration:1e3},d),x),this},m.prototype.snapToNorth=function(d,x){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(d,x):this},m.prototype.getPitch=function(){return this.transform.pitch},m.prototype.setPitch=function(d,x){return this.jumpTo({pitch:d},x),this},m.prototype.cameraForBounds=function(d,x){d=f.LngLatBounds.convert(d);var k=x&&x.bearing||0;return this._cameraForBoxAndBearing(d.getNorthWest(),d.getSouthEast(),k,x)},m.prototype._cameraForBoxAndBearing=function(d,x,k,D){var B={top:0,bottom:0,right:0,left:0};if(typeof(D=f.extend({padding:B,offset:[0,0],maxZoom:this.transform.maxZoom},D)).padding=="number"){var q=D.padding;D.padding={top:q,bottom:q,right:q,left:q}}D.padding=f.extend(B,D.padding);var Y=this.transform,ie=Y.padding,he=Y.project(f.LngLat.convert(d)),de=Y.project(f.LngLat.convert(x)),me=he.rotate(-k*Math.PI/180),ze=de.rotate(-k*Math.PI/180),Ce=new f.Point(Math.max(me.x,ze.x),Math.max(me.y,ze.y)),Be=new f.Point(Math.min(me.x,ze.x),Math.min(me.y,ze.y)),be=Ce.sub(Be),Pe=(Y.width-(ie.left+ie.right+D.padding.left+D.padding.right))/be.x,Ve=(Y.height-(ie.top+ie.bottom+D.padding.top+D.padding.bottom))/be.y;if(!(Ve<0||Pe<0)){var Ye=Math.min(Y.scaleZoom(Y.scale*Math.min(Pe,Ve)),D.maxZoom),ot=typeof D.offset.x=="number"?new f.Point(D.offset.x,D.offset.y):f.Point.convert(D.offset),lt=new f.Point((D.padding.left-D.padding.right)/2,(D.padding.top-D.padding.bottom)/2).rotate(k*Math.PI/180),ct=ot.add(lt).mult(Y.scale/Y.zoomScale(Ye));return{center:Y.unproject(he.add(de).div(2).sub(ct)),zoom:Ye,bearing:k}}f.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},m.prototype.fitBounds=function(d,x,k){return this._fitInternal(this.cameraForBounds(d,x),x,k)},m.prototype.fitScreenCoordinates=function(d,x,k,D,B){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(f.Point.convert(d)),this.transform.pointLocation(f.Point.convert(x)),k,D),D,B)},m.prototype._fitInternal=function(d,x,k){return d?(delete(x=f.extend(d,x)).padding,x.linear?this.easeTo(x,k):this.flyTo(x,k)):this},m.prototype.jumpTo=function(d,x){this.stop();var k=this.transform,D=!1,B=!1,q=!1;return"zoom"in d&&k.zoom!==+d.zoom&&(D=!0,k.zoom=+d.zoom),d.center!==void 0&&(k.center=f.LngLat.convert(d.center)),"bearing"in d&&k.bearing!==+d.bearing&&(B=!0,k.bearing=+d.bearing),"pitch"in d&&k.pitch!==+d.pitch&&(q=!0,k.pitch=+d.pitch),d.padding==null||k.isPaddingEqual(d.padding)||(k.padding=d.padding),this.fire(new f.Event("movestart",x)).fire(new f.Event("move",x)),D&&this.fire(new f.Event("zoomstart",x)).fire(new f.Event("zoom",x)).fire(new f.Event("zoomend",x)),B&&this.fire(new f.Event("rotatestart",x)).fire(new f.Event("rotate",x)).fire(new f.Event("rotateend",x)),q&&this.fire(new f.Event("pitchstart",x)).fire(new f.Event("pitch",x)).fire(new f.Event("pitchend",x)),this.fire(new f.Event("moveend",x))},m.prototype.easeTo=function(d,x){var k=this;this._stop(!1,d.easeId),((d=f.extend({offset:[0,0],duration:500,easing:f.ease},d)).animate===!1||!d.essential&&f.browser.prefersReducedMotion)&&(d.duration=0);var D=this.transform,B=this.getZoom(),q=this.getBearing(),Y=this.getPitch(),ie=this.getPadding(),he="zoom"in d?+d.zoom:B,de="bearing"in d?this._normalizeBearing(d.bearing,q):q,me="pitch"in d?+d.pitch:Y,ze="padding"in d?d.padding:D.padding,Ce=f.Point.convert(d.offset),Be=D.centerPoint.add(Ce),be=D.pointLocation(Be),Pe=f.LngLat.convert(d.center||be);this._normalizeCenter(Pe);var Ve,Ye,ot=D.project(be),lt=D.project(Pe).sub(ot),ct=D.zoomScale(he-B);d.around&&(Ve=f.LngLat.convert(d.around),Ye=D.locationPoint(Ve));var It={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||he!==B,this._rotating=this._rotating||q!==de,this._pitching=this._pitching||me!==Y,this._padding=!D.isPaddingEqual(ze),this._easeId=d.easeId,this._prepareEase(x,d.noMoveStart,It),this._ease(function(Ot){if(k._zooming&&(D.zoom=f.number(B,he,Ot)),k._rotating&&(D.bearing=f.number(q,de,Ot)),k._pitching&&(D.pitch=f.number(Y,me,Ot)),k._padding&&(D.interpolatePadding(ie,ze,Ot),Be=D.centerPoint.add(Ce)),Ve)D.setLocationAtPoint(Ve,Ye);else{var Rt=D.zoomScale(D.zoom-B),ii=he>B?Math.min(2,ct):Math.max(.5,ct),gi=Math.pow(ii,1-Ot),Ii=D.unproject(ot.add(lt.mult(Ot*gi)).mult(Rt));D.setLocationAtPoint(D.renderWorldCopies?Ii.wrap():Ii,Be)}k._fireMoveEvents(x)},function(Ot){k._afterEase(x,Ot)},d),this},m.prototype._prepareEase=function(d,x,k){k===void 0&&(k={}),this._moving=!0,x||k.moving||this.fire(new f.Event("movestart",d)),this._zooming&&!k.zooming&&this.fire(new f.Event("zoomstart",d)),this._rotating&&!k.rotating&&this.fire(new f.Event("rotatestart",d)),this._pitching&&!k.pitching&&this.fire(new f.Event("pitchstart",d))},m.prototype._fireMoveEvents=function(d){this.fire(new f.Event("move",d)),this._zooming&&this.fire(new f.Event("zoom",d)),this._rotating&&this.fire(new f.Event("rotate",d)),this._pitching&&this.fire(new f.Event("pitch",d))},m.prototype._afterEase=function(d,x){if(!this._easeId||!x||this._easeId!==x){delete this._easeId;var k=this._zooming,D=this._rotating,B=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,k&&this.fire(new f.Event("zoomend",d)),D&&this.fire(new f.Event("rotateend",d)),B&&this.fire(new f.Event("pitchend",d)),this.fire(new f.Event("moveend",d))}},m.prototype.flyTo=function(d,x){var k=this;if(!d.essential&&f.browser.prefersReducedMotion){var D=f.pick(d,["center","zoom","bearing","pitch","around"]);return this.jumpTo(D,x)}this.stop(),d=f.extend({offset:[0,0],speed:1.2,curve:1.42,easing:f.ease},d);var B=this.transform,q=this.getZoom(),Y=this.getBearing(),ie=this.getPitch(),he=this.getPadding(),de="zoom"in d?f.clamp(+d.zoom,B.minZoom,B.maxZoom):q,me="bearing"in d?this._normalizeBearing(d.bearing,Y):Y,ze="pitch"in d?+d.pitch:ie,Ce="padding"in d?d.padding:B.padding,Be=B.zoomScale(de-q),be=f.Point.convert(d.offset),Pe=B.centerPoint.add(be),Ve=B.pointLocation(Pe),Ye=f.LngLat.convert(d.center||Ve);this._normalizeCenter(Ye);var ot=B.project(Ve),lt=B.project(Ye).sub(ot),ct=d.curve,It=Math.max(B.width,B.height),Ot=It/Be,Rt=lt.mag();if("minZoom"in d){var ii=f.clamp(Math.min(d.minZoom,q,de),B.minZoom,B.maxZoom),gi=It/B.zoomScale(ii-q);ct=Math.sqrt(gi/Rt*2)}var Ii=ct*ct;function yi(zi){var Ei=(Ot*Ot-It*It+(zi?-1:1)*Ii*Ii*Rt*Rt)/(2*(zi?Ot:It)*Ii*Rt);return Math.log(Math.sqrt(Ei*Ei+1)-Ei)}function lr(zi){return(Math.exp(zi)-Math.exp(-zi))/2}function si(zi){return(Math.exp(zi)+Math.exp(-zi))/2}var ji=yi(0),ir=function(zi){return si(ji)/si(ji+ct*zi)},Oi=function(zi){return It*((si(ji)*(lr(Ei=ji+ct*zi)/si(Ei))-lr(ji))/Ii)/Rt;var Ei},Di=(yi(1)-ji)/ct;if(Math.abs(Rt)<1e-6||!isFinite(Di)){if(Math.abs(It-Ot)<1e-6)return this.easeTo(d,x);var Zi=Ot<It?-1:1;Di=Math.abs(Math.log(Ot/It))/ct,Oi=function(){return 0},ir=function(zi){return Math.exp(Zi*ct*zi)}}return d.duration="duration"in d?+d.duration:1e3*Di/("screenSpeed"in d?+d.screenSpeed/ct:+d.speed),d.maxDuration&&d.duration>d.maxDuration&&(d.duration=0),this._zooming=!0,this._rotating=Y!==me,this._pitching=ze!==ie,this._padding=!B.isPaddingEqual(Ce),this._prepareEase(x,!1),this._ease(function(zi){var Ei=zi*Di,mn=1/ir(Ei);B.zoom=zi===1?de:q+B.scaleZoom(mn),k._rotating&&(B.bearing=f.number(Y,me,zi)),k._pitching&&(B.pitch=f.number(ie,ze,zi)),k._padding&&(B.interpolatePadding(he,Ce,zi),Pe=B.centerPoint.add(be));var Cn=zi===1?Ye:B.unproject(ot.add(lt.mult(Oi(Ei))).mult(mn));B.setLocationAtPoint(B.renderWorldCopies?Cn.wrap():Cn,Pe),k._fireMoveEvents(x)},function(){return k._afterEase(x)},d),this},m.prototype.isEasing=function(){return!!this._easeFrameId},m.prototype.stop=function(){return this._stop()},m.prototype._stop=function(d,x){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var k=this._onEaseEnd;delete this._onEaseEnd,k.call(this,x)}if(!d){var D=this.handlers;D&&D.stop(!1)}return this},m.prototype._ease=function(d,x,k){k.animate===!1||k.duration===0?(d(1),x()):(this._easeStart=f.browser.now(),this._easeOptions=k,this._onEaseFrame=d,this._onEaseEnd=x,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},m.prototype._renderFrameCallback=function(){var d=Math.min((f.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},m.prototype._normalizeBearing=function(d,x){d=f.wrap(d,-180,180);var k=Math.abs(d-x);return Math.abs(d-360-x)<k&&(d-=360),Math.abs(d+360-x)<k&&(d+=360),d},m.prototype._normalizeCenter=function(d){var x=this.transform;if(x.renderWorldCopies&&!x.lngRange){var k=d.lng-x.center.lng;d.lng+=k>180?-360:k<-180?360:0}},m}(f.Evented),On=function(c){c===void 0&&(c={}),this.options=c,f.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};On.prototype.getDefaultPosition=function(){return"bottom-right"},On.prototype.onAdd=function(c){var m=this.options&&this.options.compact;return this._map=c,this._container=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),m===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},On.prototype.onRemove=function(){L.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},On.prototype._setElementTitle=function(c,m){var d=this._map._getUIString("AttributionControl."+m);c.title=d,c.setAttribute("aria-label",d)},On.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},On.prototype._updateEditLink=function(){var c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));var m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||f.config.ACCESS_TOKEN}];if(c){var d=m.reduce(function(x,k,D){return k.value&&(x+=k.key+"="+k.value+(D<m.length-1?"&":"")),x},"?");c.href=f.config.FEEDBACK_URL+"/"+d+(this._map._hash?this._map._hash.getHashString(!0):""),c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}},On.prototype._updateData=function(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},On.prototype._updateAttributions=function(){if(this._map.style){var c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(function(q){return typeof q!="string"?"":q})):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){var m=this._map.style.stylesheet;this.styleOwner=m.owner,this.styleId=m.id}var d=this._map.style.sourceCaches;for(var x in d){var k=d[x];if(k.used){var D=k.getSource();D.attribution&&c.indexOf(D.attribution)<0&&c.push(D.attribution)}}c.sort(function(q,Y){return q.length-Y.length});var B=(c=c.filter(function(q,Y){for(var ie=Y+1;ie<c.length;ie++)if(c[ie].indexOf(q)>=0)return!1;return!0})).join(" | ");B!==this._attribHTML&&(this._attribHTML=B,c.length?(this._innerContainer.innerHTML=B,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},On.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Vo=function(){f.bindAll(["_updateLogo"],this),f.bindAll(["_updateCompact"],this)};Vo.prototype.onAdd=function(c){this._map=c,this._container=L.create("div","mapboxgl-ctrl");var m=L.create("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Vo.prototype.onRemove=function(){L.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Vo.prototype.getDefaultPosition=function(){return"bottom-left"},Vo.prototype._updateLogo=function(c){c&&c.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Vo.prototype._logoRequired=function(){if(this._map.style){var c=this._map.style.sourceCaches;for(var m in c)if(c[m].getSource().mapbox_logo)return!0;return!1}},Vo.prototype._updateCompact=function(){var c=this._container.children;if(c.length){var m=c[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}};var T=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};T.prototype.add=function(c){var m=++this._id;return this._queue.push({callback:c,id:m,cancelled:!1}),m},T.prototype.remove=function(c){for(var m=this._currentlyRunning,d=0,x=m?this._queue.concat(m):this._queue;d<x.length;d+=1){var k=x[d];if(k.id===c)return void(k.cancelled=!0)}},T.prototype.run=function(c){c===void 0&&(c=0);var m=this._currentlyRunning=this._queue;this._queue=[];for(var d=0,x=m;d<x.length;d+=1){var k=x[d];if(!k.cancelled&&(k.callback(c),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},T.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var o={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},g=f.window.HTMLImageElement,I=f.window.HTMLElement,A=f.window.ImageBitmap,M={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},F=function(c){function m(x){var k=this;if((x=f.extend({},M,x)).minZoom!=null&&x.maxZoom!=null&&x.minZoom>x.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(x.minPitch!=null&&x.maxPitch!=null&&x.minPitch>x.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(x.minPitch!=null&&x.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(x.maxPitch!=null&&x.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var D=new tr(x.minZoom,x.maxZoom,x.minPitch,x.maxPitch,x.renderWorldCopies);if(c.call(this,D,x),this._interactive=x.interactive,this._maxTileCacheSize=x.maxTileCacheSize,this._failIfMajorPerformanceCaveat=x.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=x.preserveDrawingBuffer,this._antialias=x.antialias,this._trackResize=x.trackResize,this._bearingSnap=x.bearingSnap,this._refreshExpiredTiles=x.refreshExpiredTiles,this._fadeDuration=x.fadeDuration,this._crossSourceCollisions=x.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=x.collectResourceTiming,this._renderTaskQueue=new T,this._controls=[],this._mapId=f.uniqueId(),this._locale=f.extend({},o,x.locale),this._clickTolerance=x.clickTolerance,this._requestManager=new f.RequestManager(x.transformRequest,x.accessToken),typeof x.container=="string"){if(this._container=f.window.document.getElementById(x.container),!this._container)throw new Error("Container '"+x.container+"' not found.")}else{if(!(x.container instanceof I))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=x.container}if(x.maxBounds&&this.setMaxBounds(x.maxBounds),f.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return k._update(!1)}),this.on("moveend",function(){return k._update(!1)}),this.on("zoom",function(){return k._update(!0)}),f.window!==void 0&&(f.window.addEventListener("online",this._onWindowOnline,!1),f.window.addEventListener("resize",this._onWindowResize,!1),f.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Xt(this,x),this._hash=x.hash&&new ti(typeof x.hash=="string"&&x.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch}),x.bounds&&(this.resize(),this.fitBounds(x.bounds,f.extend({},x.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=x.localIdeographFontFamily,x.style&&this.setStyle(x.style,{localIdeographFontFamily:x.localIdeographFontFamily}),x.attributionControl&&this.addControl(new On({customAttribution:x.customAttribution})),this.addControl(new Vo,x.logoPosition),this.on("style.load",function(){k.transform.unmodified&&k.jumpTo(k.style.stylesheet)}),this.on("data",function(B){k._update(B.dataType==="style"),k.fire(new f.Event(B.dataType+"data",B))}),this.on("dataloading",function(B){k.fire(new f.Event(B.dataType+"dataloading",B))})}c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m;var d={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return m.prototype._getMapId=function(){return this._mapId},m.prototype.addControl=function(x,k){if(k===void 0&&(k=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new f.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var D=x.onAdd(this);this._controls.push(x);var B=this._controlPositions[k];return k.indexOf("bottom")!==-1?B.insertBefore(D,B.firstChild):B.appendChild(D),this},m.prototype.removeControl=function(x){if(!x||!x.onRemove)return this.fire(new f.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var k=this._controls.indexOf(x);return k>-1&&this._controls.splice(k,1),x.onRemove(this),this},m.prototype.hasControl=function(x){return this._controls.indexOf(x)>-1},m.prototype.resize=function(x){var k=this._containerDimensions(),D=k[0],B=k[1];if(D===this.transform.width&&B===this.transform.height)return this;this._resizeCanvas(D,B),this.transform.resize(D,B),this.painter.resize(D,B);var q=!this._moving;return q&&this.fire(new f.Event("movestart",x)).fire(new f.Event("move",x)),this.fire(new f.Event("resize",x)),q&&this.fire(new f.Event("moveend",x)),this},m.prototype.getBounds=function(){return this.transform.getBounds()},m.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},m.prototype.setMaxBounds=function(x){return this.transform.setMaxBounds(f.LngLatBounds.convert(x)),this._update()},m.prototype.setMinZoom=function(x){if((x=x==null?-2:x)>=-2&&x<=this.transform.maxZoom)return this.transform.minZoom=x,this._update(),this.getZoom()<x&&this.setZoom(x),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},m.prototype.getMinZoom=function(){return this.transform.minZoom},m.prototype.setMaxZoom=function(x){if((x=x==null?22:x)>=this.transform.minZoom)return this.transform.maxZoom=x,this._update(),this.getZoom()>x&&this.setZoom(x),this;throw new Error("maxZoom must be greater than the current minZoom")},m.prototype.getMaxZoom=function(){return this.transform.maxZoom},m.prototype.setMinPitch=function(x){if((x=x==null?0:x)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.minPitch=x,this._update(),this.getPitch()<x&&this.setPitch(x),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},m.prototype.getMinPitch=function(){return this.transform.minPitch},m.prototype.setMaxPitch=function(x){if((x=x==null?60:x)>60)throw new Error("maxPitch must be less than or equal to 60");if(x>=this.transform.minPitch)return this.transform.maxPitch=x,this._update(),this.getPitch()>x&&this.setPitch(x),this;throw new Error("maxPitch must be greater than the current minPitch")},m.prototype.getMaxPitch=function(){return this.transform.maxPitch},m.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},m.prototype.setRenderWorldCopies=function(x){return this.transform.renderWorldCopies=x,this._update()},m.prototype.project=function(x){return this.transform.locationPoint(f.LngLat.convert(x))},m.prototype.unproject=function(x){return this.transform.pointLocation(f.Point.convert(x))},m.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},m.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},m.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},m.prototype._createDelegatedListener=function(x,k,D){var B,q=this;if(x==="mouseenter"||x==="mouseover"){var Y=!1;return{layer:k,listener:D,delegates:{mousemove:function(he){var de=q.getLayer(k)?q.queryRenderedFeatures(he.point,{layers:[k]}):[];de.length?Y||(Y=!0,D.call(q,new pn(x,q,he.originalEvent,{features:de}))):Y=!1},mouseout:function(){Y=!1}}}}if(x==="mouseleave"||x==="mouseout"){var ie=!1;return{layer:k,listener:D,delegates:{mousemove:function(he){(q.getLayer(k)?q.queryRenderedFeatures(he.point,{layers:[k]}):[]).length?ie=!0:ie&&(ie=!1,D.call(q,new pn(x,q,he.originalEvent)))},mouseout:function(he){ie&&(ie=!1,D.call(q,new pn(x,q,he.originalEvent)))}}}}return{layer:k,listener:D,delegates:(B={},B[x]=function(he){var de=q.getLayer(k)?q.queryRenderedFeatures(he.point,{layers:[k]}):[];de.length&&(he.features=de,D.call(q,he),delete he.features)},B)}},m.prototype.on=function(x,k,D){if(D===void 0)return c.prototype.on.call(this,x,k);var B=this._createDelegatedListener(x,k,D);for(var q in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(B),B.delegates)this.on(q,B.delegates[q]);return this},m.prototype.once=function(x,k,D){if(D===void 0)return c.prototype.once.call(this,x,k);var B=this._createDelegatedListener(x,k,D);for(var q in B.delegates)this.once(q,B.delegates[q]);return this},m.prototype.off=function(x,k,D){var B=this;return D===void 0?c.prototype.off.call(this,x,k):(this._delegatedListeners&&this._delegatedListeners[x]&&function(q){for(var Y=q[x],ie=0;ie<Y.length;ie++){var he=Y[ie];if(he.layer===k&&he.listener===D){for(var de in he.delegates)B.off(de,he.delegates[de]);return Y.splice(ie,1),B}}}(this._delegatedListeners),this)},m.prototype.queryRenderedFeatures=function(x,k){if(!this.style)return[];var D;if(k!==void 0||x===void 0||x instanceof f.Point||Array.isArray(x)||(k=x,x=void 0),k=k||{},(x=x||[[0,0],[this.transform.width,this.transform.height]])instanceof f.Point||typeof x[0]=="number")D=[f.Point.convert(x)];else{var B=f.Point.convert(x[0]),q=f.Point.convert(x[1]);D=[B,new f.Point(q.x,B.y),q,new f.Point(B.x,q.y),B]}return this.style.queryRenderedFeatures(D,k,this.transform)},m.prototype.querySourceFeatures=function(x,k){return this.style.querySourceFeatures(x,k)},m.prototype.setStyle=function(x,k){return(k=f.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},k)).diff!==!1&&k.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&x?(this._diffStyle(x,k),this):(this._localIdeographFontFamily=k.localIdeographFontFamily,this._updateStyle(x,k))},m.prototype._getUIString=function(x){var k=this._locale[x];if(k==null)throw new Error("Missing UI string '"+x+"'");return k},m.prototype._updateStyle=function(x,k){return this.style&&(this.style.setEventedParent(null),this.style._remove()),x?(this.style=new fo(this,k||{}),this.style.setEventedParent(this,{style:this.style}),typeof x=="string"?this.style.loadURL(x):this.style.loadJSON(x),this):(delete this.style,this)},m.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new fo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},m.prototype._diffStyle=function(x,k){var D=this;if(typeof x=="string"){var B=this._requestManager.normalizeStyleURL(x),q=this._requestManager.transformRequest(B,f.ResourceType.Style);f.getJSON(q,function(Y,ie){Y?D.fire(new f.ErrorEvent(Y)):ie&&D._updateDiff(ie,k)})}else typeof x=="object"&&this._updateDiff(x,k)},m.prototype._updateDiff=function(x,k){try{this.style.setState(x)&&this._update(!0)}catch(D){f.warnOnce("Unable to perform style diff: "+(D.message||D.error||D)+".  Rebuilding the style from scratch."),this._updateStyle(x,k)}},m.prototype.getStyle=function(){if(this.style)return this.style.serialize()},m.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():f.warnOnce("There is no style added to the map.")},m.prototype.addSource=function(x,k){return this._lazyInitEmptyStyle(),this.style.addSource(x,k),this._update(!0)},m.prototype.isSourceLoaded=function(x){var k=this.style&&this.style.sourceCaches[x];if(k!==void 0)return k.loaded();this.fire(new f.ErrorEvent(new Error("There is no source with ID '"+x+"'")))},m.prototype.areTilesLoaded=function(){var x=this.style&&this.style.sourceCaches;for(var k in x){var D=x[k]._tiles;for(var B in D){var q=D[B];if(q.state!=="loaded"&&q.state!=="errored")return!1}}return!0},m.prototype.addSourceType=function(x,k,D){return this._lazyInitEmptyStyle(),this.style.addSourceType(x,k,D)},m.prototype.removeSource=function(x){return this.style.removeSource(x),this._update(!0)},m.prototype.getSource=function(x){return this.style.getSource(x)},m.prototype.addImage=function(x,k,D){D===void 0&&(D={});var B=D.pixelRatio;B===void 0&&(B=1);var q=D.sdf;q===void 0&&(q=!1);var Y=D.stretchX,ie=D.stretchY,he=D.content;if(this._lazyInitEmptyStyle(),k instanceof g||A&&k instanceof A){var de=f.browser.getImageData(k);this.style.addImage(x,{data:new f.RGBAImage({width:de.width,height:de.height},de.data),pixelRatio:B,stretchX:Y,stretchY:ie,content:he,sdf:q,version:0})}else{if(k.width===void 0||k.height===void 0)return this.fire(new f.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var me=k;this.style.addImage(x,{data:new f.RGBAImage({width:k.width,height:k.height},new Uint8Array(k.data)),pixelRatio:B,stretchX:Y,stretchY:ie,content:he,sdf:q,version:0,userImage:me}),me.onAdd&&me.onAdd(this,x)}},m.prototype.updateImage=function(x,k){var D=this.style.getImage(x);if(!D)return this.fire(new f.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var B=k instanceof g||A&&k instanceof A?f.browser.getImageData(k):k,q=B.width,Y=B.height,ie=B.data;return q===void 0||Y===void 0?this.fire(new f.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):q!==D.data.width||Y!==D.data.height?this.fire(new f.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(D.data.replace(ie,!(k instanceof g||A&&k instanceof A)),void this.style.updateImage(x,D))},m.prototype.hasImage=function(x){return x?!!this.style.getImage(x):(this.fire(new f.ErrorEvent(new Error("Missing required image id"))),!1)},m.prototype.removeImage=function(x){this.style.removeImage(x)},m.prototype.loadImage=function(x,k){f.getImage(this._requestManager.transformRequest(x,f.ResourceType.Image),k)},m.prototype.listImages=function(){return this.style.listImages()},m.prototype.addLayer=function(x,k){return this._lazyInitEmptyStyle(),this.style.addLayer(x,k),this._update(!0)},m.prototype.moveLayer=function(x,k){return this.style.moveLayer(x,k),this._update(!0)},m.prototype.removeLayer=function(x){return this.style.removeLayer(x),this._update(!0)},m.prototype.getLayer=function(x){return this.style.getLayer(x)},m.prototype.setLayerZoomRange=function(x,k,D){return this.style.setLayerZoomRange(x,k,D),this._update(!0)},m.prototype.setFilter=function(x,k,D){return D===void 0&&(D={}),this.style.setFilter(x,k,D),this._update(!0)},m.prototype.getFilter=function(x){return this.style.getFilter(x)},m.prototype.setPaintProperty=function(x,k,D,B){return B===void 0&&(B={}),this.style.setPaintProperty(x,k,D,B),this._update(!0)},m.prototype.getPaintProperty=function(x,k){return this.style.getPaintProperty(x,k)},m.prototype.setLayoutProperty=function(x,k,D,B){return B===void 0&&(B={}),this.style.setLayoutProperty(x,k,D,B),this._update(!0)},m.prototype.getLayoutProperty=function(x,k){return this.style.getLayoutProperty(x,k)},m.prototype.setLight=function(x,k){return k===void 0&&(k={}),this._lazyInitEmptyStyle(),this.style.setLight(x,k),this._update(!0)},m.prototype.getLight=function(){return this.style.getLight()},m.prototype.setFeatureState=function(x,k){return this.style.setFeatureState(x,k),this._update()},m.prototype.removeFeatureState=function(x,k){return this.style.removeFeatureState(x,k),this._update()},m.prototype.getFeatureState=function(x){return this.style.getFeatureState(x)},m.prototype.getContainer=function(){return this._container},m.prototype.getCanvasContainer=function(){return this._canvasContainer},m.prototype.getCanvas=function(){return this._canvas},m.prototype._containerDimensions=function(){var x=0,k=0;return this._container&&(x=this._container.clientWidth||400,k=this._container.clientHeight||300),[x,k]},m.prototype._detectMissingCSS=function(){f.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&f.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},m.prototype._setupContainer=function(){var x=this._container;x.classList.add("mapboxgl-map"),(this._missingCSSCanary=L.create("div","mapboxgl-canary",x)).style.visibility="hidden",this._detectMissingCSS();var k=this._canvasContainer=L.create("div","mapboxgl-canvas-container",x);this._interactive&&k.classList.add("mapboxgl-interactive"),this._canvas=L.create("canvas","mapboxgl-canvas",k),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var D=this._containerDimensions();this._resizeCanvas(D[0],D[1]);var B=this._controlContainer=L.create("div","mapboxgl-control-container",x),q=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Y){q[Y]=L.create("div","mapboxgl-ctrl-"+Y,B)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},m.prototype._resizeCanvas=function(x,k){var D=f.browser.devicePixelRatio||1;this._canvas.width=D*x,this._canvas.height=D*k,this._canvas.style.width=x+"px",this._canvas.style.height=k+"px"},m.prototype._setupPainter=function(){var x=f.extend({},p.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),k=this._canvas.getContext("webgl",x)||this._canvas.getContext("experimental-webgl",x);k?(this.painter=new sn(k,this.transform),f.webpSupported.testSupport(k)):this.fire(new f.ErrorEvent(new Error("Failed to initialize WebGL")))},m.prototype._contextLost=function(x){x.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new f.Event("webglcontextlost",{originalEvent:x}))},m.prototype._contextRestored=function(x){this._setupPainter(),this.resize(),this._update(),this.fire(new f.Event("webglcontextrestored",{originalEvent:x}))},m.prototype._onMapScroll=function(x){if(x.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},m.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},m.prototype._update=function(x){return this.style?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this},m.prototype._requestRenderFrame=function(x){return this._update(),this._renderTaskQueue.add(x)},m.prototype._cancelRenderFrame=function(x){this._renderTaskQueue.remove(x)},m.prototype._render=function(x){var k,D=this,B=0,q=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(k=q.createQueryEXT(),q.beginQueryEXT(q.TIME_ELAPSED_EXT,k),B=f.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(x),!this._removed){var Y=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var ie=this.transform.zoom,he=f.browser.now();this.style.zoomHistory.update(ie,he);var de=new f.EvaluationParameters(ie,{now:he,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),me=de.crossFadingFactor();me===1&&me===this._crossFadingFactor||(Y=!0,this._crossFadingFactor=me),this.style.update(de)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new f.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new f.Event("load"))),this.style&&(this.style.hasTransitions()||Y)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var ze=f.browser.now()-B;q.endQueryEXT(q.TIME_ELAPSED_EXT,k),setTimeout(function(){var be=q.getQueryObjectEXT(k,q.QUERY_RESULT_EXT)/1e6;q.deleteQueryEXT(k),D.fire(new f.Event("gpu-timing-frame",{cpuTime:ze,gpuTime:be}))},50)}if(this.listens("gpu-timing-layer")){var Ce=this.painter.collectGpuTimers();setTimeout(function(){var be=D.painter.queryGpuTimers(Ce);D.fire(new f.Event("gpu-timing-layer",{layerTimes:be}))},50)}var Be=this._sourcesDirty||this._styleDirty||this._placementDirty;return Be||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new f.Event("idle")),!this._loaded||this._fullyLoaded||Be||(this._fullyLoaded=!0),this}},m.prototype.remove=function(){this._hash&&this._hash.remove();for(var x=0,k=this._controls;x<k.length;x+=1)k[x].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),f.window!==void 0&&(f.window.removeEventListener("resize",this._onWindowResize,!1),f.window.removeEventListener("orientationchange",this._onWindowResize,!1),f.window.removeEventListener("online",this._onWindowOnline,!1));var D=this.painter.context.gl.getExtension("WEBGL_lose_context");D&&D.loseContext(),Z(this._canvasContainer),Z(this._controlContainer),Z(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new f.Event("remove"))},m.prototype.triggerRepaint=function(){var x=this;this.style&&!this._frame&&(this._frame=f.browser.frame(function(k){x._frame=null,x._render(k)}))},m.prototype._onWindowOnline=function(){this._update()},m.prototype._onWindowResize=function(x){this._trackResize&&this.resize({originalEvent:x})._update()},d.showTileBoundaries.get=function(){return!!this._showTileBoundaries},d.showTileBoundaries.set=function(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._update())},d.showPadding.get=function(){return!!this._showPadding},d.showPadding.set=function(x){this._showPadding!==x&&(this._showPadding=x,this._update())},d.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},d.showCollisionBoxes.set=function(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,x?this.style._generateCollisionBoxes():this._update())},d.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},d.showOverdrawInspector.set=function(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._update())},d.repaint.get=function(){return!!this._repaint},d.repaint.set=function(x){this._repaint!==x&&(this._repaint=x,this.triggerRepaint())},d.vertices.get=function(){return!!this._vertices},d.vertices.set=function(x){this._vertices=x,this._update()},m.prototype._setCacheLimits=function(x,k){f.setCacheLimits(x,k)},d.version.get=function(){return f.version},Object.defineProperties(m.prototype,d),m}(ru);function Z(c){c.parentNode&&c.parentNode.removeChild(c)}var J={showCompass:!0,showZoom:!0,visualizePitch:!1},ee=function(c){var m=this;this.options=f.extend({},J,c),this._container=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(d){return d.preventDefault()}),this.options.showZoom&&(f.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(d){return m._map.zoomIn({},{originalEvent:d})}),L.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(d){return m._map.zoomOut({},{originalEvent:d})}),L.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(f.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(d){m.options.visualizePitch?m._map.resetNorthPitch({},{originalEvent:d}):m._map.resetNorth({},{originalEvent:d})}),this._compassIcon=L.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ee.prototype._updateZoomButtons=function(){var c=this._map.getZoom(),m=c===this._map.getMaxZoom(),d=c===this._map.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},ee.prototype._rotateCompassArrow=function(){var c=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=c},ee.prototype.onAdd=function(c){return this._map=c,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new re(this._map,this._compass,this.options.visualizePitch)),this._container},ee.prototype.onRemove=function(){L.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ee.prototype._createButton=function(c,m){var d=L.create("button",c,this._container);return d.type="button",d.addEventListener("click",m),d},ee.prototype._setButtonTitle=function(c,m){var d=this._map._getUIString("NavigationControl."+m);c.title=d,c.setAttribute("aria-label",d)};var re=function(c,m,d){d===void 0&&(d=!1),this._clickTolerance=10,this.element=m,this.mouseRotate=new ms({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,d&&(this.mousePitch=new iu({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),f.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),L.addEventListener(m,"mousedown",this.mousedown),L.addEventListener(m,"touchstart",this.touchstart,{passive:!1}),L.addEventListener(m,"touchmove",this.touchmove),L.addEventListener(m,"touchend",this.touchend),L.addEventListener(m,"touchcancel",this.reset)};function ue(c,m,d){if(c=new f.LngLat(c.lng,c.lat),m){var x=new f.LngLat(c.lng-360,c.lat),k=new f.LngLat(c.lng+360,c.lat),D=d.locationPoint(c).distSqr(m);d.locationPoint(x).distSqr(m)<D?c=x:d.locationPoint(k).distSqr(m)<D&&(c=k)}for(;Math.abs(c.lng-d.center.lng)>180;){var B=d.locationPoint(c);if(B.x>=0&&B.y>=0&&B.x<=d.width&&B.y<=d.height)break;c.lng>d.center.lng?c.lng-=360:c.lng+=360}return c}re.prototype.down=function(c,m){this.mouseRotate.mousedown(c,m),this.mousePitch&&this.mousePitch.mousedown(c,m),L.disableDrag()},re.prototype.move=function(c,m){var d=this.map,x=this.mouseRotate.mousemoveWindow(c,m);if(x&&x.bearingDelta&&d.setBearing(d.getBearing()+x.bearingDelta),this.mousePitch){var k=this.mousePitch.mousemoveWindow(c,m);k&&k.pitchDelta&&d.setPitch(d.getPitch()+k.pitchDelta)}},re.prototype.off=function(){var c=this.element;L.removeEventListener(c,"mousedown",this.mousedown),L.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),L.removeEventListener(c,"touchmove",this.touchmove),L.removeEventListener(c,"touchend",this.touchend),L.removeEventListener(c,"touchcancel",this.reset),this.offTemp()},re.prototype.offTemp=function(){L.enableDrag(),L.removeEventListener(f.window,"mousemove",this.mousemove),L.removeEventListener(f.window,"mouseup",this.mouseup)},re.prototype.mousedown=function(c){this.down(f.extend({},c,{ctrlKey:!0,preventDefault:function(){return c.preventDefault()}}),L.mousePos(this.element,c)),L.addEventListener(f.window,"mousemove",this.mousemove),L.addEventListener(f.window,"mouseup",this.mouseup)},re.prototype.mousemove=function(c){this.move(c,L.mousePos(this.element,c))},re.prototype.mouseup=function(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()},re.prototype.touchstart=function(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=L.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return c.preventDefault()}},this._startPos))},re.prototype.touchmove=function(c){c.targetTouches.length!==1?this.reset():(this._lastPos=L.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:function(){return c.preventDefault()}},this._lastPos))},re.prototype.touchend=function(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},re.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var xe={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Fe(c,m,d){var x=c.classList;for(var k in xe)x.remove("mapboxgl-"+d+"-anchor-"+k);x.add("mapboxgl-"+d+"-anchor-"+m)}var we,Oe=function(c){function m(d,x){if(c.call(this),(d instanceof f.window.HTMLElement||x)&&(d=f.extend({element:d},x)),f.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=d&&d.anchor||"center",this._color=d&&d.color||"#3FB1CE",this._scale=d&&d.scale||1,this._draggable=d&&d.draggable||!1,this._clickTolerance=d&&d.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=d&&d.rotation||0,this._rotationAlignment=d&&d.rotationAlignment||"auto",this._pitchAlignment=d&&d.pitchAlignment&&d.pitchAlignment!=="auto"?d.pitchAlignment:this._rotationAlignment,d&&d.element)this._element=d.element,this._offset=f.Point.convert(d&&d.offset||[0,0]);else{this._defaultMarker=!0,this._element=L.create("div"),this._element.setAttribute("aria-label","Map marker");var k=L.createNS("http://www.w3.org/2000/svg","svg");k.setAttributeNS(null,"display","block"),k.setAttributeNS(null,"height","41px"),k.setAttributeNS(null,"width","27px"),k.setAttributeNS(null,"viewBox","0 0 27 41");var D=L.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"stroke","none"),D.setAttributeNS(null,"stroke-width","1"),D.setAttributeNS(null,"fill","none"),D.setAttributeNS(null,"fill-rule","evenodd");var B=L.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill-rule","nonzero");var q=L.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(3.0, 29.0)"),q.setAttributeNS(null,"fill","#000000");for(var Y=0,ie=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Y<ie.length;Y+=1){var he=ie[Y],de=L.createNS("http://www.w3.org/2000/svg","ellipse");de.setAttributeNS(null,"opacity","0.04"),de.setAttributeNS(null,"cx","10.5"),de.setAttributeNS(null,"cy","5.80029008"),de.setAttributeNS(null,"rx",he.rx),de.setAttributeNS(null,"ry",he.ry),q.appendChild(de)}var me=L.createNS("http://www.w3.org/2000/svg","g");me.setAttributeNS(null,"fill",this._color);var ze=L.createNS("http://www.w3.org/2000/svg","path");ze.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),me.appendChild(ze);var Ce=L.createNS("http://www.w3.org/2000/svg","g");Ce.setAttributeNS(null,"opacity","0.25"),Ce.setAttributeNS(null,"fill","#000000");var Be=L.createNS("http://www.w3.org/2000/svg","path");Be.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ce.appendChild(Be);var be=L.createNS("http://www.w3.org/2000/svg","g");be.setAttributeNS(null,"transform","translate(6.0, 7.0)"),be.setAttributeNS(null,"fill","#FFFFFF");var Pe=L.createNS("http://www.w3.org/2000/svg","g");Pe.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Ve=L.createNS("http://www.w3.org/2000/svg","circle");Ve.setAttributeNS(null,"fill","#000000"),Ve.setAttributeNS(null,"opacity","0.25"),Ve.setAttributeNS(null,"cx","5.5"),Ve.setAttributeNS(null,"cy","5.5"),Ve.setAttributeNS(null,"r","5.4999962");var Ye=L.createNS("http://www.w3.org/2000/svg","circle");Ye.setAttributeNS(null,"fill","#FFFFFF"),Ye.setAttributeNS(null,"cx","5.5"),Ye.setAttributeNS(null,"cy","5.5"),Ye.setAttributeNS(null,"r","5.4999962"),Pe.appendChild(Ve),Pe.appendChild(Ye),B.appendChild(q),B.appendChild(me),B.appendChild(Ce),B.appendChild(be),B.appendChild(Pe),k.appendChild(B),k.setAttributeNS(null,"height",41*this._scale+"px"),k.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(k),this._offset=f.Point.convert(d&&d.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(ot){ot.preventDefault()}),this._element.addEventListener("mousedown",function(ot){ot.preventDefault()}),Fe(this._element,this._anchor,"marker"),this._popup=null}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.addTo=function(d){return this.remove(),this._map=d,d.getCanvasContainer().appendChild(this._element),d.on("move",this._update),d.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},m.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),L.remove(this._element),this._popup&&this._popup.remove(),this},m.prototype.getLngLat=function(){return this._lngLat},m.prototype.setLngLat=function(d){return this._lngLat=f.LngLat.convert(d),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},m.prototype.getElement=function(){return this._element},m.prototype.setPopup=function(d){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),d){if(!("offset"in d.options)){var x=Math.sqrt(Math.pow(13.5,2)/2);d.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(24.6+x)],"bottom-right":[-x,-1*(24.6+x)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=d,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},m.prototype._onKeyPress=function(d){var x=d.code,k=d.charCode||d.keyCode;x!=="Space"&&x!=="Enter"&&k!==32&&k!==13||this.togglePopup()},m.prototype._onMapClick=function(d){var x=d.originalEvent.target,k=this._element;this._popup&&(x===k||k.contains(x))&&this.togglePopup()},m.prototype.getPopup=function(){return this._popup},m.prototype.togglePopup=function(){var d=this._popup;return d?(d.isOpen()?d.remove():d.addTo(this._map),this):this},m.prototype._update=function(d){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ue(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(x="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var k="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?k="rotateX(0deg)":this._pitchAlignment==="map"&&(k="rotateX("+this._map.getPitch()+"deg)"),d&&d.type!=="moveend"||(this._pos=this._pos.round()),L.setTransform(this._element,xe[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+k+" "+x)}},m.prototype.getOffset=function(){return this._offset},m.prototype.setOffset=function(d){return this._offset=f.Point.convert(d),this._update(),this},m.prototype._onMove=function(d){if(!this._isDragging){var x=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=x}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new f.Event("dragstart"))),this.fire(new f.Event("drag")))},m.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new f.Event("dragend")),this._state="inactive"},m.prototype._addDragHandler=function(d){this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},m.prototype.setDraggable=function(d){return this._draggable=!!d,this._map&&(d?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},m.prototype.isDraggable=function(){return this._draggable},m.prototype.setRotation=function(d){return this._rotation=d||0,this._update(),this},m.prototype.getRotation=function(){return this._rotation},m.prototype.setRotationAlignment=function(d){return this._rotationAlignment=d||"auto",this._update(),this},m.prototype.getRotationAlignment=function(){return this._rotationAlignment},m.prototype.setPitchAlignment=function(d){return this._pitchAlignment=d&&d!=="auto"?d:this._rotationAlignment,this._update(),this},m.prototype.getPitchAlignment=function(){return this._pitchAlignment},m}(f.Evented),Je={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Xe=0,nt=!1,$e=function(c){function m(d){c.call(this),this.options=f.extend({},Je,d),f.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.onAdd=function(d){var x;return this._map=d,this._container=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),x=this._setupUI,we!==void 0?x(we):f.window.navigator.permissions!==void 0?f.window.navigator.permissions.query({name:"geolocation"}).then(function(k){x(we=k.state!=="denied")}):x(we=!!f.window.navigator.geolocation),this._container},m.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(f.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),L.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Xe=0,nt=!1},m.prototype._isOutOfMapMaxBounds=function(d){var x=this._map.getMaxBounds(),k=d.coords;return x&&(k.longitude<x.getWest()||k.longitude>x.getEast()||k.latitude<x.getSouth()||k.latitude>x.getNorth())},m.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},m.prototype._onSuccess=function(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new f.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new f.Event("geolocate",d)),this._finish()}},m.prototype._updateCamera=function(d){var x=new f.LngLat(d.coords.longitude,d.coords.latitude),k=d.coords.accuracy,D=this._map.getBearing(),B=f.extend({bearing:D},this.options.fitBoundsOptions);this._map.fitBounds(x.toBounds(k),B,{geolocateSource:!0})},m.prototype._updateMarker=function(d){if(d){var x=new f.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(x).addTo(this._map),this._userLocationDotMarker.setLngLat(x).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},m.prototype._updateCircleRadius=function(){var d=this._map._container.clientHeight/2,x=this._map.unproject([0,d]),k=this._map.unproject([1,d]),D=x.distanceTo(k),B=Math.ceil(2*this._accuracy/D);this._circleElement.style.width=B+"px",this._circleElement.style.height=B+"px"},m.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},m.prototype._onError=function(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var x=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=x,this._geolocateButton.setAttribute("aria-label",x),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&nt)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new f.Event("error",d)),this._finish()}},m.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},m.prototype._setupUI=function(d){var x=this;if(this._container.addEventListener("contextmenu",function(B){return B.preventDefault()}),this._geolocateButton=L.create("button","mapboxgl-ctrl-geolocate",this._container),L.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",d===!1){f.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var k=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=k,this._geolocateButton.setAttribute("aria-label",k)}else{var D=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=D,this._geolocateButton.setAttribute("aria-label",D)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Oe(this._dotElement),this._circleElement=L.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Oe({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(B){B.geolocateSource||x._watchState!=="ACTIVE_LOCK"||B.originalEvent&&B.originalEvent.type==="resize"||(x._watchState="BACKGROUND",x._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),x._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),x.fire(new f.Event("trackuserlocationend")))})},m.prototype.trigger=function(){if(!this._setup)return f.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new f.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Xe--,nt=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new f.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new f.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Xe>1?(d={maximumAge:6e5,timeout:0},nt=!0):(d=this.options.positionOptions,nt=!1),this._geolocationWatchID=f.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,d)}}else f.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},m.prototype._clearWatch=function(){f.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},m}(f.Evented),wt={maxWidth:100,unit:"metric"},dt=function(c){this.options=f.extend({},wt,c),f.bindAll(["_onMove","setUnit"],this)};function yt(c,m,d){var x=d&&d.maxWidth||100,k=c._container.clientHeight/2,D=c.unproject([0,k]),B=c.unproject([x,k]),q=D.distanceTo(B);if(d&&d.unit==="imperial"){var Y=3.2808*q;Y>5280?Lt(m,x,Y/5280,c._getUIString("ScaleControl.Miles")):Lt(m,x,Y,c._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?Lt(m,x,q/1852,c._getUIString("ScaleControl.NauticalMiles")):q>=1e3?Lt(m,x,q/1e3,c._getUIString("ScaleControl.Kilometers")):Lt(m,x,q,c._getUIString("ScaleControl.Meters"))}function Lt(c,m,d,x){var k,D,B,q=(k=d,(D=Math.pow(10,(""+Math.floor(k)).length-1))*(B=(B=k/D)>=10?10:B>=5?5:B>=3?3:B>=2?2:B>=1?1:function(Y){var ie=Math.pow(10,Math.ceil(-Math.log(Y)/Math.LN10));return Math.round(Y*ie)/ie}(B)));c.style.width=m*(q/d)+"px",c.innerHTML=q+"&nbsp;"+x}dt.prototype.getDefaultPosition=function(){return"bottom-left"},dt.prototype._onMove=function(){yt(this._map,this._container,this.options)},dt.prototype.onAdd=function(c){return this._map=c,this._container=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",c.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},dt.prototype.onRemove=function(){L.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},dt.prototype.setUnit=function(c){this.options.unit=c,yt(this._map,this._container,this.options)};var Nt=function(c){this._fullscreen=!1,c&&c.container&&(c.container instanceof f.window.HTMLElement?this._container=c.container:f.warnOnce("Full screen control 'container' must be a DOM element.")),f.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in f.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in f.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in f.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in f.window.document&&(this._fullscreenchange="MSFullscreenChange")};Nt.prototype.onAdd=function(c){return this._map=c,this._container||(this._container=this._map.getContainer()),this._controlContainer=L.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",f.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Nt.prototype.onRemove=function(){L.remove(this._controlContainer),this._map=null,f.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Nt.prototype._checkFullscreenSupport=function(){return!!(f.window.document.fullscreenEnabled||f.window.document.mozFullScreenEnabled||f.window.document.msFullscreenEnabled||f.window.document.webkitFullscreenEnabled)},Nt.prototype._setupUI=function(){var c=this._fullscreenButton=L.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);L.create("span","mapboxgl-ctrl-icon",c).setAttribute("aria-hidden",!0),c.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),f.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Nt.prototype._updateTitle=function(){var c=this._getTitle();this._fullscreenButton.setAttribute("aria-label",c),this._fullscreenButton.title=c},Nt.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Nt.prototype._isFullscreen=function(){return this._fullscreen},Nt.prototype._changeIcon=function(){(f.window.document.fullscreenElement||f.window.document.mozFullScreenElement||f.window.document.webkitFullscreenElement||f.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Nt.prototype._onClickFullscreen=function(){this._isFullscreen()?f.window.document.exitFullscreen?f.window.document.exitFullscreen():f.window.document.mozCancelFullScreen?f.window.document.mozCancelFullScreen():f.window.document.msExitFullscreen?f.window.document.msExitFullscreen():f.window.document.webkitCancelFullScreen&&f.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var St={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},mi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),ni=function(c){function m(d){c.call(this),this.options=f.extend(Object.create(St),d),f.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return c&&(m.__proto__=c),(m.prototype=Object.create(c&&c.prototype)).constructor=m,m.prototype.addTo=function(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new f.Event("open")),this},m.prototype.isOpen=function(){return!!this._map},m.prototype.remove=function(){return this._content&&L.remove(this._content),this._container&&(L.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new f.Event("close")),this},m.prototype.getLngLat=function(){return this._lngLat},m.prototype.setLngLat=function(d){return this._lngLat=f.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},m.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},m.prototype.getElement=function(){return this._container},m.prototype.setText=function(d){return this.setDOMContent(f.window.document.createTextNode(d))},m.prototype.setHTML=function(d){var x,k=f.window.document.createDocumentFragment(),D=f.window.document.createElement("body");for(D.innerHTML=d;x=D.firstChild;)k.appendChild(x);return this.setDOMContent(k)},m.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},m.prototype.setMaxWidth=function(d){return this.options.maxWidth=d,this._update(),this},m.prototype.setDOMContent=function(d){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=L.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(d),this._createCloseButton(),this._update(),this._focusFirstElement(),this},m.prototype.addClassName=function(d){this._container&&this._container.classList.add(d)},m.prototype.removeClassName=function(d){this._container&&this._container.classList.remove(d)},m.prototype.setOffset=function(d){return this.options.offset=d,this._update(),this},m.prototype.toggleClassName=function(d){if(this._container)return this._container.classList.toggle(d)},m.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=L.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},m.prototype._onMouseUp=function(d){this._update(d.point)},m.prototype._onMouseMove=function(d){this._update(d.point)},m.prototype._onDrag=function(d){this._update(d.point)},m.prototype._update=function(d){var x=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=L.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=L.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(de){return x._container.classList.add(de)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ue(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||d)){var k=this._pos=this._trackPointer&&d?d:this._map.project(this._lngLat),D=this.options.anchor,B=function de(me){if(me){if(typeof me=="number"){var ze=Math.round(Math.sqrt(.5*Math.pow(me,2)));return{center:new f.Point(0,0),top:new f.Point(0,me),"top-left":new f.Point(ze,ze),"top-right":new f.Point(-ze,ze),bottom:new f.Point(0,-me),"bottom-left":new f.Point(ze,-ze),"bottom-right":new f.Point(-ze,-ze),left:new f.Point(me,0),right:new f.Point(-me,0)}}if(me instanceof f.Point||Array.isArray(me)){var Ce=f.Point.convert(me);return{center:Ce,top:Ce,"top-left":Ce,"top-right":Ce,bottom:Ce,"bottom-left":Ce,"bottom-right":Ce,left:Ce,right:Ce}}return{center:f.Point.convert(me.center||[0,0]),top:f.Point.convert(me.top||[0,0]),"top-left":f.Point.convert(me["top-left"]||[0,0]),"top-right":f.Point.convert(me["top-right"]||[0,0]),bottom:f.Point.convert(me.bottom||[0,0]),"bottom-left":f.Point.convert(me["bottom-left"]||[0,0]),"bottom-right":f.Point.convert(me["bottom-right"]||[0,0]),left:f.Point.convert(me.left||[0,0]),right:f.Point.convert(me.right||[0,0])}}return de(new f.Point(0,0))}(this.options.offset);if(!D){var q,Y=this._container.offsetWidth,ie=this._container.offsetHeight;q=k.y+B.bottom.y<ie?["top"]:k.y>this._map.transform.height-ie?["bottom"]:[],k.x<Y/2?q.push("left"):k.x>this._map.transform.width-Y/2&&q.push("right"),D=q.length===0?"bottom":q.join("-")}var he=k.add(B[D]).round();L.setTransform(this._container,xe[D]+" translate("+he.x+"px,"+he.y+"px)"),Fe(this._container,D,"popup")}},m.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var d=this._container.querySelector(mi);d&&d.focus()}},m.prototype._onClose=function(){this.remove()},m}(f.Evented),qi={version:f.version,supported:p,setRTLTextPlugin:f.setRTLTextPlugin,getRTLTextPluginStatus:f.getRTLTextPluginStatus,Map:F,NavigationControl:ee,GeolocateControl:$e,AttributionControl:On,ScaleControl:dt,FullscreenControl:Nt,Popup:ni,Marker:Oe,Style:fo,LngLat:f.LngLat,LngLatBounds:f.LngLatBounds,Point:f.Point,MercatorCoordinate:f.MercatorCoordinate,Evented:f.Evented,config:f.config,prewarm:function(){fe().acquire(W)},clearPrewarmedResources:function(){var c=ce;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(W),ce=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return f.config.ACCESS_TOKEN},set accessToken(c){f.config.ACCESS_TOKEN=c},get baseApiUrl(){return f.config.API_URL},set baseApiUrl(c){f.config.API_URL=c},get workerCount(){return ne.workerCount},set workerCount(c){ne.workerCount=c},get maxParallelImageRequests(){return f.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(c){f.config.MAX_PARALLEL_IMAGE_REQUESTS=c},clearStorage:function(c){f.clearTileCache(c)},workerUrl:""};return qi}),w})})(Ag);Object.defineProperty(D0,"__esModule",{value:!0});const dT=Ag.exports;class fT{constructor(r){this.map=r,this.contents=[]}add(r,s,y){var w;let z=`
    <div class="mapboxgl-popup-layer-name">${y}</div>
    <div class="mapboxgl-popup-panel_area"><table class="mapboxgl-popup-table">
    ${Object.keys(s.properties).map(L=>`<tr><th class="mapboxgl-popup-th">${L.replace(/_/g," ").replace(/-/g," ")}</th><td class="mapboxgl-popup-td">${s.properties[L]}</td></tr>`).join("")}
    </table></div>`;this.contents.push(z);let f;if(this.contents.length===1?f=this.contents[0]:f=`
      <div class="mapboxgl-popup-tab_wrap">
      ${this.contents.map(L=>{let N=this.contents.indexOf(L)+1;return`<input id="mapboxgl-popup-tab${N}" type="radio" name="tab_btn" ${N===0?"checked":""}>`}).join("")}
      <div class="mapboxgl-popup-tab_area">
      ${this.contents.map(L=>{let N=this.contents.indexOf(L)+1;return`<label class="mapboxgl-popup-tab${N}_label" for="mapboxgl-popup-tab${N}">${N}</label>`}).join("")}
      </div>
      <div class="mapboxgl-popup-panel_area">
      ${this.contents.map(L=>`<div id="mapboxgl-popup-panel${this.contents.indexOf(L)+1}" class="mapboxgl-popup-tab_panel">${L}</div>`).join("")}
      </div>
     </div>`,this.popup?this.popup.setHTML(f):this.popup=new dT.Popup().setLngLat(r).setHTML(f).setMaxWidth("400px").addTo(this.map),this.contents.length>1){const L=document.getElementById("mapboxgl-popup-tab1");L.checked=!0}var p=this;(w=p.popup)===null||w===void 0||w.on("close",function(){p.popup=null,p.contents=[]})}}class mT{constructor(r=[]){this.targets=r}createPopup(r,s){var y;let w=r.lngLat;const z=r.features[0];for(z.geometry.type==="Point"&&(w=z.geometry.coordinates.slice());Math.abs(r.lngLat.lng-w[0])>180;)w[0]+=r.lngLat.lng>w[0]?360:-360;!this.map||(y=this.popupManager)===null||y===void 0||y.add(w,z,s)}onAdd(r){if(this.map=r,this.popupManager=new fT(this.map),this.targets.length>0){const s=this;this.targets.forEach(y=>{r.on("click",y,function(w){s.createPopup(w,y)})})}return this.controlContainer=document.createElement("div"),this.controlContainer.className="mapboxgl-ctrl mapboxgl-ctrl-group",Object.assign(this.controlContainer,{style:"display:none"}),this.popupButton=document.createElement("button"),this.popupButton.className="mapboxgl-ctrl-icon",this.popupButton.type="button",this.controlContainer.appendChild(this.popupButton),this.controlContainer}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.popupButton||(this.controlContainer.parentNode.removeChild(this.controlContainer),this.map=void 0)}}var yT=D0.default=mT,Cg={};Object.defineProperty(Cg,"__esModule",{value:!0});var R0=Cg.MapboxStyleSwitcherControl=void 0;class jp{constructor(r,s){this.styles=r||jp.DEFAULT_STYLES,this.defaultStyle=s||jp.DEFAULT_STYLE,this.styleUrl=new gT,this.defaultStyleFromUrl=this.styleUrl.get();let y=!1;for(const w of this.styles)w.title===this.defaultStyleFromUrl&&(y=!0);y||(this.styleUrl.delete(),this.defaultStyleFromUrl=null),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}onAdd(r){this.map=r,this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.mapStyleContainer=document.createElement("div"),this.styleButton=document.createElement("button"),this.styleButton.type="button",this.mapStyleContainer.classList.add("mapboxgl-style-list");for(const s of this.styles){const y=document.createElement("button");y.type="button",y.innerText=s.title,y.classList.add(s.title.replace(/[^a-z0-9-]/gi,"_")),y.dataset.uri=JSON.stringify(s.uri),y.dataset.title=s.title,y.addEventListener("click",w=>{const z=w.srcElement;if(z.classList.contains("active"))return;this.map.setStyle(JSON.parse(z.dataset.uri)),this.styleUrl.set(z.dataset.title),this.mapStyleContainer.style.display="none",this.styleButton.style.display="block";const f=this.mapStyleContainer.getElementsByClassName("active");for(;f[0];)f[0].classList.remove("active");z.classList.add("active")}),s.title===this.defaultStyleFromUrl&&this.mapStyleContainer.getElementsByClassName("active").length===0&&(y.classList.add("active"),this.map.setStyle(s.uri)),!this.defaultStyleFromUrl&&s.title===this.defaultStyle&&this.mapStyleContainer.getElementsByClassName("active").length===0&&(y.classList.add("active"),this.map.setStyle(s.uri)),this.mapStyleContainer.appendChild(y)}return this.styleButton.classList.add("mapboxgl-ctrl-icon"),this.styleButton.classList.add("mapboxgl-style-switcher"),this.styleButton.addEventListener("click",()=>{this.styleButton.style.display="none",this.mapStyleContainer.style.display="block"}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.styleButton),this.controlContainer.appendChild(this.mapStyleContainer),this.controlContainer}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.styleButton||(this.styleButton.removeEventListener("click",this.onDocumentClick),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.map=void 0)}onDocumentClick(r){this.controlContainer&&!this.controlContainer.contains(r.target)&&this.mapStyleContainer&&this.styleButton&&(this.mapStyleContainer.style.display="none",this.styleButton.style.display="block")}}R0=Cg.MapboxStyleSwitcherControl=jp;jp.DEFAULT_STYLE="Streets";jp.DEFAULT_STYLES=[{title:"Dark",uri:"mapbox://styles/mapbox/dark-v10"},{title:"Light",uri:"mapbox://styles/mapbox/light-v10"},{title:"Outdoors",uri:"mapbox://styles/mapbox/outdoors-v11"},{title:"Satellite",uri:"mapbox://styles/mapbox/satellite-streets-v11"},{title:"Streets",uri:"mapbox://styles/mapbox/streets-v11"}];class gT{constructor(){this.STYLE_PATHNAME="style"}getUrl(){const r=window.location,s=new URL(r.href);return s.hash=r.hash,s}updateUrl(r){history.replaceState("","",r.toString())}get(){return this.getUrl().searchParams.get(this.STYLE_PATHNAME)}set(r){const s=this.getUrl();s.searchParams.set(this.STYLE_PATHNAME,r),this.updateUrl(s)}delete(){const r=this.getUrl();r.searchParams.delete(this.STYLE_PATHNAME),this.updateUrl(r)}}var B0={},kg={},zg={},ym={},Pg={exports:{}},O0=function(r,s){return function(){for(var w=new Array(arguments.length),z=0;z<w.length;z++)w[z]=arguments[z];return r.apply(s,w)}},_T=O0,tp=Object.prototype.toString;function Mg(u){return tp.call(u)==="[object Array]"}function Jy(u){return typeof u=="undefined"}function vT(u){return u!==null&&!Jy(u)&&u.constructor!==null&&!Jy(u.constructor)&&typeof u.constructor.isBuffer=="function"&&u.constructor.isBuffer(u)}function xT(u){return tp.call(u)==="[object ArrayBuffer]"}function bT(u){return typeof FormData!="undefined"&&u instanceof FormData}function wT(u){var r;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?r=ArrayBuffer.isView(u):r=u&&u.buffer&&u.buffer instanceof ArrayBuffer,r}function ET(u){return typeof u=="string"}function ST(u){return typeof u=="number"}function F0(u){return u!==null&&typeof u=="object"}function Ff(u){if(tp.call(u)!=="[object Object]")return!1;var r=Object.getPrototypeOf(u);return r===null||r===Object.prototype}function IT(u){return tp.call(u)==="[object Date]"}function TT(u){return tp.call(u)==="[object File]"}function AT(u){return tp.call(u)==="[object Blob]"}function U0(u){return tp.call(u)==="[object Function]"}function CT(u){return F0(u)&&U0(u.pipe)}function kT(u){return typeof URLSearchParams!="undefined"&&u instanceof URLSearchParams}function zT(u){return u.trim?u.trim():u.replace(/^\s+|\s+$/g,"")}function PT(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function Lg(u,r){if(!(u===null||typeof u=="undefined"))if(typeof u!="object"&&(u=[u]),Mg(u))for(var s=0,y=u.length;s<y;s++)r.call(null,u[s],s,u);else for(var w in u)Object.prototype.hasOwnProperty.call(u,w)&&r.call(null,u[w],w,u)}function Yy(){var u={};function r(w,z){Ff(u[z])&&Ff(w)?u[z]=Yy(u[z],w):Ff(w)?u[z]=Yy({},w):Mg(w)?u[z]=w.slice():u[z]=w}for(var s=0,y=arguments.length;s<y;s++)Lg(arguments[s],r);return u}function MT(u,r,s){return Lg(r,function(w,z){s&&typeof w=="function"?u[z]=_T(w,s):u[z]=w}),u}function LT(u){return u.charCodeAt(0)===65279&&(u=u.slice(1)),u}var fl={isArray:Mg,isArrayBuffer:xT,isBuffer:vT,isFormData:bT,isArrayBufferView:wT,isString:ET,isNumber:ST,isObject:F0,isPlainObject:Ff,isUndefined:Jy,isDate:IT,isFile:TT,isBlob:AT,isFunction:U0,isStream:CT,isURLSearchParams:kT,isStandardBrowserEnv:PT,forEach:Lg,merge:Yy,extend:MT,trim:zT,stripBOM:LT},zp=fl;function av(u){return encodeURIComponent(u).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var N0=function(r,s,y){if(!s)return r;var w;if(y)w=y(s);else if(zp.isURLSearchParams(s))w=s.toString();else{var z=[];zp.forEach(s,function(L,N){L===null||typeof L=="undefined"||(zp.isArray(L)?N=N+"[]":L=[L],zp.forEach(L,function(G){zp.isDate(G)?G=G.toISOString():zp.isObject(G)&&(G=JSON.stringify(G)),z.push(av(N)+"="+av(G))}))}),w=z.join("&")}if(w){var f=r.indexOf("#");f!==-1&&(r=r.slice(0,f)),r+=(r.indexOf("?")===-1?"?":"&")+w}return r},DT=fl;function gm(){this.handlers=[]}gm.prototype.use=function(r,s,y){return this.handlers.push({fulfilled:r,rejected:s,synchronous:y?y.synchronous:!1,runWhen:y?y.runWhen:null}),this.handlers.length-1};gm.prototype.eject=function(r){this.handlers[r]&&(this.handlers[r]=null)};gm.prototype.forEach=function(r){DT.forEach(this.handlers,function(y){y!==null&&r(y)})};var RT=gm,BT=fl,OT=function(r,s){BT.forEach(r,function(w,z){z!==s&&z.toUpperCase()===s.toUpperCase()&&(r[s]=w,delete r[z])})},j0=function(r,s,y,w,z){return r.config=s,y&&(r.code=y),r.request=w,r.response=z,r.isAxiosError=!0,r.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},r},FT=j0,V0=function(r,s,y,w,z){var f=new Error(r);return FT(f,s,y,w,z)},UT=V0,NT=function(r,s,y){var w=y.config.validateStatus;!y.status||!w||w(y.status)?r(y):s(UT("Request failed with status code "+y.status,y.config,null,y.request,y))},Mf=fl,jT=Mf.isStandardBrowserEnv()?function(){return{write:function(s,y,w,z,f,p){var L=[];L.push(s+"="+encodeURIComponent(y)),Mf.isNumber(w)&&L.push("expires="+new Date(w).toGMTString()),Mf.isString(z)&&L.push("path="+z),Mf.isString(f)&&L.push("domain="+f),p===!0&&L.push("secure"),document.cookie=L.join("; ")},read:function(s){var y=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return y?decodeURIComponent(y[3]):null},remove:function(s){this.write(s,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),VT=function(r){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(r)},qT=function(r,s){return s?r.replace(/\/+$/,"")+"/"+s.replace(/^\/+/,""):r},GT=VT,ZT=qT,HT=function(r,s){return r&&!GT(s)?ZT(r,s):s},My=fl,WT=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],XT=function(r){var s={},y,w,z;return r&&My.forEach(r.split(`
`),function(p){if(z=p.indexOf(":"),y=My.trim(p.substr(0,z)).toLowerCase(),w=My.trim(p.substr(z+1)),y){if(s[y]&&WT.indexOf(y)>=0)return;y==="set-cookie"?s[y]=(s[y]?s[y]:[]).concat([w]):s[y]=s[y]?s[y]+", "+w:w}}),s},sv=fl,KT=sv.isStandardBrowserEnv()?function(){var r=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a"),y;function w(z){var f=z;return r&&(s.setAttribute("href",f),f=s.href),s.setAttribute("href",f),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return y=w(window.location.href),function(f){var p=sv.isString(f)?w(f):f;return p.protocol===y.protocol&&p.host===y.host}}():function(){return function(){return!0}}(),Lf=fl,JT=NT,YT=jT,$T=N0,QT=HT,eA=XT,tA=KT,Ly=V0,lv=function(r){return new Promise(function(y,w){var z=r.data,f=r.headers,p=r.responseType;Lf.isFormData(z)&&delete f["Content-Type"];var L=new XMLHttpRequest;if(r.auth){var N=r.auth.username||"",U=r.auth.password?unescape(encodeURIComponent(r.auth.password)):"";f.Authorization="Basic "+btoa(N+":"+U)}var G=QT(r.baseURL,r.url);L.open(r.method.toUpperCase(),$T(G,r.params,r.paramsSerializer),!0),L.timeout=r.timeout;function X(){if(!!L){var ge="getAllResponseHeaders"in L?eA(L.getAllResponseHeaders()):null,De=!p||p==="text"||p==="json"?L.responseText:L.response,Le={data:De,status:L.status,statusText:L.statusText,headers:ge,config:r,request:L};JT(y,w,Le),L=null}}if("onloadend"in L?L.onloadend=X:L.onreadystatechange=function(){!L||L.readyState!==4||L.status===0&&!(L.responseURL&&L.responseURL.indexOf("file:")===0)||setTimeout(X)},L.onabort=function(){!L||(w(Ly("Request aborted",r,"ECONNABORTED",L)),L=null)},L.onerror=function(){w(Ly("Network Error",r,null,L)),L=null},L.ontimeout=function(){var De="timeout of "+r.timeout+"ms exceeded";r.timeoutErrorMessage&&(De=r.timeoutErrorMessage),w(Ly(De,r,r.transitional&&r.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",L)),L=null},Lf.isStandardBrowserEnv()){var Se=(r.withCredentials||tA(G))&&r.xsrfCookieName?YT.read(r.xsrfCookieName):void 0;Se&&(f[r.xsrfHeaderName]=Se)}"setRequestHeader"in L&&Lf.forEach(f,function(De,Le){typeof z=="undefined"&&Le.toLowerCase()==="content-type"?delete f[Le]:L.setRequestHeader(Le,De)}),Lf.isUndefined(r.withCredentials)||(L.withCredentials=!!r.withCredentials),p&&p!=="json"&&(L.responseType=r.responseType),typeof r.onDownloadProgress=="function"&&L.addEventListener("progress",r.onDownloadProgress),typeof r.onUploadProgress=="function"&&L.upload&&L.upload.addEventListener("progress",r.onUploadProgress),r.cancelToken&&r.cancelToken.promise.then(function(De){!L||(L.abort(),w(De),L=null)}),z||(z=null),L.send(z)})},Ba=fl,uv=OT,iA=j0,rA={"Content-Type":"application/x-www-form-urlencoded"};function cv(u,r){!Ba.isUndefined(u)&&Ba.isUndefined(u["Content-Type"])&&(u["Content-Type"]=r)}function nA(){var u;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(u=lv),u}function oA(u,r,s){if(Ba.isString(u))try{return(r||JSON.parse)(u),Ba.trim(u)}catch(y){if(y.name!=="SyntaxError")throw y}return(s||JSON.stringify)(u)}var _m={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:nA(),transformRequest:[function(r,s){return uv(s,"Accept"),uv(s,"Content-Type"),Ba.isFormData(r)||Ba.isArrayBuffer(r)||Ba.isBuffer(r)||Ba.isStream(r)||Ba.isFile(r)||Ba.isBlob(r)?r:Ba.isArrayBufferView(r)?r.buffer:Ba.isURLSearchParams(r)?(cv(s,"application/x-www-form-urlencoded;charset=utf-8"),r.toString()):Ba.isObject(r)||s&&s["Content-Type"]==="application/json"?(cv(s,"application/json"),oA(r)):r}],transformResponse:[function(r){var s=this.transitional,y=s&&s.silentJSONParsing,w=s&&s.forcedJSONParsing,z=!y&&this.responseType==="json";if(z||w&&Ba.isString(r)&&r.length)try{return JSON.parse(r)}catch(f){if(z)throw f.name==="SyntaxError"?iA(f,this,"E_JSON_PARSE"):f}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(r){return r>=200&&r<300}};_m.headers={common:{Accept:"application/json, text/plain, */*"}};Ba.forEach(["delete","get","head"],function(r){_m.headers[r]={}});Ba.forEach(["post","put","patch"],function(r){_m.headers[r]=Ba.merge(rA)});var Dg=_m,aA=fl,sA=Dg,lA=function(r,s,y){var w=this||sA;return aA.forEach(y,function(f){r=f.call(w,r,s)}),r},q0=function(r){return!!(r&&r.__CANCEL__)},hv=fl,Dy=lA,uA=q0,cA=Dg;function Ry(u){u.cancelToken&&u.cancelToken.throwIfRequested()}var hA=function(r){Ry(r),r.headers=r.headers||{},r.data=Dy.call(r,r.data,r.headers,r.transformRequest),r.headers=hv.merge(r.headers.common||{},r.headers[r.method]||{},r.headers),hv.forEach(["delete","get","head","post","put","patch","common"],function(w){delete r.headers[w]});var s=r.adapter||cA.adapter;return s(r).then(function(w){return Ry(r),w.data=Dy.call(r,w.data,w.headers,r.transformResponse),w},function(w){return uA(w)||(Ry(r),w&&w.response&&(w.response.data=Dy.call(r,w.response.data,w.response.headers,r.transformResponse))),Promise.reject(w)})},Qa=fl,G0=function(r,s){s=s||{};var y={},w=["url","method","data"],z=["headers","auth","proxy","params"],f=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],p=["validateStatus"];function L(X,Se){return Qa.isPlainObject(X)&&Qa.isPlainObject(Se)?Qa.merge(X,Se):Qa.isPlainObject(Se)?Qa.merge({},Se):Qa.isArray(Se)?Se.slice():Se}function N(X){Qa.isUndefined(s[X])?Qa.isUndefined(r[X])||(y[X]=L(void 0,r[X])):y[X]=L(r[X],s[X])}Qa.forEach(w,function(Se){Qa.isUndefined(s[Se])||(y[Se]=L(void 0,s[Se]))}),Qa.forEach(z,N),Qa.forEach(f,function(Se){Qa.isUndefined(s[Se])?Qa.isUndefined(r[Se])||(y[Se]=L(void 0,r[Se])):y[Se]=L(void 0,s[Se])}),Qa.forEach(p,function(Se){Se in s?y[Se]=L(r[Se],s[Se]):Se in r&&(y[Se]=L(void 0,r[Se]))});var U=w.concat(z).concat(f).concat(p),G=Object.keys(r).concat(Object.keys(s)).filter(function(Se){return U.indexOf(Se)===-1});return Qa.forEach(G,N),y};const pA="axios",dA="0.21.4",fA="Promise based HTTP client for the browser and node.js",mA="index.js",yA={test:"grunt test",start:"node ./sandbox/server.js",build:"NODE_ENV=production grunt build",preversion:"npm test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json",postversion:"git push && git push --tags",examples:"node ./examples/server.js",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",fix:"eslint --fix lib/**/*.js"},gA={type:"git",url:"https://github.com/axios/axios.git"},_A=["xhr","http","ajax","promise","node"],vA="Matt Zabriskie",xA="MIT",bA={url:"https://github.com/axios/axios/issues"},wA="https://axios-http.com",EA={coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",mocha:"^8.2.1",sinon:"^4.5.0","terser-webpack-plugin":"^4.2.3",typescript:"^4.0.5","url-search-params":"^0.10.0",webpack:"^4.44.2","webpack-dev-server":"^3.11.0"},SA={"./lib/adapters/http.js":"./lib/adapters/xhr.js"},IA="dist/axios.min.js",TA="dist/axios.min.js",AA="./index.d.ts",CA={"follow-redirects":"^1.14.0"},kA=[{path:"./dist/axios.min.js",threshold:"5kB"}];var zA={name:pA,version:dA,description:fA,main:mA,scripts:yA,repository:gA,keywords:_A,author:vA,license:xA,bugs:bA,homepage:wA,devDependencies:EA,browser:SA,jsdelivr:IA,unpkg:TA,typings:AA,dependencies:CA,bundlesize:kA},Z0=zA,Rg={};["object","boolean","number","function","string","symbol"].forEach(function(u,r){Rg[u]=function(y){return typeof y===u||"a"+(r<1?"n ":" ")+u}});var pv={},PA=Z0.version.split(".");function H0(u,r){for(var s=r?r.split("."):PA,y=u.split("."),w=0;w<3;w++){if(s[w]>y[w])return!0;if(s[w]<y[w])return!1}return!1}Rg.transitional=function(r,s,y){var w=s&&H0(s);function z(f,p){return"[Axios v"+Z0.version+"] Transitional option '"+f+"'"+p+(y?". "+y:"")}return function(f,p,L){if(r===!1)throw new Error(z(p," has been removed in "+s));return w&&!pv[p]&&(pv[p]=!0,console.warn(z(p," has been deprecated since v"+s+" and will be removed in the near future"))),r?r(f,p,L):!0}};function MA(u,r,s){if(typeof u!="object")throw new TypeError("options must be an object");for(var y=Object.keys(u),w=y.length;w-- >0;){var z=y[w],f=r[z];if(f){var p=u[z],L=p===void 0||f(p,z,u);if(L!==!0)throw new TypeError("option "+z+" must be "+L);continue}if(s!==!0)throw Error("Unknown option "+z)}}var LA={isOlderVersion:H0,assertOptions:MA,validators:Rg},W0=fl,DA=N0,dv=RT,fv=hA,vm=G0,X0=LA,Pp=X0.validators;function qd(u){this.defaults=u,this.interceptors={request:new dv,response:new dv}}qd.prototype.request=function(r){typeof r=="string"?(r=arguments[1]||{},r.url=arguments[0]):r=r||{},r=vm(this.defaults,r),r.method?r.method=r.method.toLowerCase():this.defaults.method?r.method=this.defaults.method.toLowerCase():r.method="get";var s=r.transitional;s!==void 0&&X0.assertOptions(s,{silentJSONParsing:Pp.transitional(Pp.boolean,"1.0.0"),forcedJSONParsing:Pp.transitional(Pp.boolean,"1.0.0"),clarifyTimeoutError:Pp.transitional(Pp.boolean,"1.0.0")},!1);var y=[],w=!0;this.interceptors.request.forEach(function(X){typeof X.runWhen=="function"&&X.runWhen(r)===!1||(w=w&&X.synchronous,y.unshift(X.fulfilled,X.rejected))});var z=[];this.interceptors.response.forEach(function(X){z.push(X.fulfilled,X.rejected)});var f;if(!w){var p=[fv,void 0];for(Array.prototype.unshift.apply(p,y),p=p.concat(z),f=Promise.resolve(r);p.length;)f=f.then(p.shift(),p.shift());return f}for(var L=r;y.length;){var N=y.shift(),U=y.shift();try{L=N(L)}catch(G){U(G);break}}try{f=fv(L)}catch(G){return Promise.reject(G)}for(;z.length;)f=f.then(z.shift(),z.shift());return f};qd.prototype.getUri=function(r){return r=vm(this.defaults,r),DA(r.url,r.params,r.paramsSerializer).replace(/^\?/,"")};W0.forEach(["delete","get","head","options"],function(r){qd.prototype[r]=function(s,y){return this.request(vm(y||{},{method:r,url:s,data:(y||{}).data}))}});W0.forEach(["post","put","patch"],function(r){qd.prototype[r]=function(s,y,w){return this.request(vm(w||{},{method:r,url:s,data:y}))}});var RA=qd;function Bg(u){this.message=u}Bg.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};Bg.prototype.__CANCEL__=!0;var K0=Bg,BA=K0;function Jf(u){if(typeof u!="function")throw new TypeError("executor must be a function.");var r;this.promise=new Promise(function(w){r=w});var s=this;u(function(w){s.reason||(s.reason=new BA(w),r(s.reason))})}Jf.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};Jf.source=function(){var r,s=new Jf(function(w){r=w});return{token:s,cancel:r}};var OA=Jf,FA=function(r){return function(y){return r.apply(null,y)}},UA=function(r){return typeof r=="object"&&r.isAxiosError===!0},mv=fl,NA=O0,Uf=RA,jA=G0,VA=Dg;function J0(u){var r=new Uf(u),s=NA(Uf.prototype.request,r);return mv.extend(s,Uf.prototype,r),mv.extend(s,r),s}var bu=J0(VA);bu.Axios=Uf;bu.create=function(r){return J0(jA(bu.defaults,r))};bu.Cancel=K0;bu.CancelToken=OA;bu.isCancel=q0;bu.all=function(r){return Promise.all(r)};bu.spread=FA;bu.isAxiosError=UA;Pg.exports=bu;Pg.exports.default=bu;var qA=Pg.exports;(function(u){Object.defineProperty(u,"__esModule",{value:!0}),u.ContourType=u.Costing=void 0;const r=qA,s=Ag.exports;u.Costing={Walking:"pedestrian",Bicycle:"bicycle",Car:"auto"},u.ContourType={Time:"time",Distance:"distance"};class y{constructor(z,f,p){this.contourSources=[],this.contourLayers=[],this.contourMaker=void 0,this.contours=[{time:5,distance:1,color:"ff0000"},{time:10,distance:3,color:"ffff00"},{time:15,distance:5,color:"0000ff"}],this.map=z,this.url=f,p&&(this.contours=p)}clearFeatures(){this.contourLayers&&this.contourLayers.length>0&&(this.contourLayers.forEach(z=>{var f;(f=this.map)===null||f===void 0||f.removeLayer(z)}),this.contourLayers=[]),this.contourSources&&this.contourSources.length>0&&(this.contourSources.forEach(z=>{var f;(f=this.map)===null||f===void 0||f.removeSource(z)}),this.contourSources=[]),this.contourMaker&&(this.contourMaker.remove(),this.contourMaker=void 0)}getIsochrone(z,f,p,L,N){this.clearFeatures();let U=JSON.parse(JSON.stringify(this.contours));N&&(U=N),U.forEach(X=>{p===u.ContourType.Time?delete X.distance:delete X.time});let G="km";return p===u.ContourType.Time&&(G="min"),new Promise((X,Se)=>{const ge={locations:[{lat:f,lon:z}],costing:L,contours:U,polygons:!0},De=`${this.url}/isochrone?json=${JSON.stringify(ge)}`;r.default.get(De).then(Le=>{Le.data.features.forEach(Ue=>{var Re,st,ut,ht;const at=`isochrone-${Ue.properties.contour}`;(Re=this.map)===null||Re===void 0||Re.addSource(at,{type:"geojson",data:Ue}),this.contourSources.push(at),(st=this.map)===null||st===void 0||st.addLayer({id:`pg-${at}`,type:"fill",source:at,layout:{},paint:{"fill-color":Ue.properties.fillColor,"fill-opacity":.1}}),this.contourLayers.push(`pg-${at}`),(ut=this.map)===null||ut===void 0||ut.addLayer({id:`ls-${at}`,type:"line",source:at,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":Ue.properties.fillColor,"line-width":3}}),this.contourLayers.push(`ls-${at}`),(ht=this.map)===null||ht===void 0||ht.addLayer({id:`symbol-${at}`,type:"symbol",source:at,layout:{"symbol-placement":"line","text-pitch-alignment":"viewport","text-font":["Roboto Bold"],"text-field":["concat",["get","contour"],` ${G}`],"text-size":16},paint:{"text-color":"#000000","text-halo-width":1,"text-halo-color":"#FFFFFF"}}),this.contourLayers.push(`symbol-${at}`)}),this.map&&(this.contourMaker=new s.Marker().setLngLat([z,f]).addTo(this.map)),X()}).catch(Le=>Se(Le))})}getContoursOption(){return this.contours}}u.default=y})(ym);var xm={};Object.defineProperty(xm,"__esModule",{value:!0});class GA{constructor(r){this.color="#535353",this.map=r}create(){this.updateValues(),this.map!==void 0?(this.map.on("resize",this.mapResize.bind(this)),this.createCanvas(this.map.getCanvasContainer())):console.error("map object is null")}updateValues(){var r,s;this.width=(r=this.map)===null||r===void 0?void 0:r.getCanvas().clientWidth,this.height=(s=this.map)===null||s===void 0?void 0:s.getCanvas().clientHeight}mapResize(){this.updateValues(),this.updateCanvas()}updateCanvas(){if(this.svgCanvas!==void 0&&this.yLine!==void 0&&this.xLine!==void 0&&this.width!==void 0&&this.height!==void 0){this.svgCanvas.setAttribute("width",`${this.width}px`),this.svgCanvas.setAttribute("height",`${this.height}px`);const r=this.width/2,s=this.height/2;this.yLine.setAttribute("x1",`${r}px`),this.yLine.setAttribute("y1","0px"),this.yLine.setAttribute("x2",`${r}px`),this.yLine.setAttribute("y2",`${this.height}px`),this.xLine.setAttribute("x1",`${0}px`),this.xLine.setAttribute("y1",`${s}px`),this.xLine.setAttribute("x2",`${this.width}px`),this.xLine.setAttribute("y2",`${s}px`)}}createCanvas(r){if(this.width!==void 0&&this.height!==void 0){const s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.style.position="relative",s.setAttribute("width",`${this.width}px`),s.setAttribute("height",`${this.height}px`);const y=this.width/2,w=this.height/2;this.yLine=s.appendChild(this.createLine(y,0,y,this.height,this.color,"2px")),this.xLine=s.appendChild(this.createLine(0,w,this.width,w,this.color,"2px")),r==null||r.appendChild(s),this.svgCanvas=s}}createLine(r,s,y,w,z,f){const p=document.createElementNS("http://www.w3.org/2000/svg","line");return p.setAttribute("x1",r),p.setAttribute("y1",s),p.setAttribute("x2",y),p.setAttribute("y2",w),p.setAttribute("stroke-dasharray","5,5"),p.setAttribute("stroke",z),p.setAttribute("stroke-width",f),p}destroy(){this.xLine!==void 0&&(this.xLine.remove(),this.xLine=void 0),this.yLine!==void 0&&(this.yLine.remove(),this.yLine=void 0),this.svgCanvas!==void 0&&(this.svgCanvas.remove(),this.svgCanvas=void 0),this.map!==void 0&&(this.map.off("resize",this.mapResize),this.map=void 0)}}xm.default=GA;var ep={};Object.defineProperty(ep,"__esModule",{value:!0});ep.createTextbox=ep.createSelection=void 0;const ZA=(u,r,s,y,w)=>{const z=document.createElement("label");z.textContent=r;const f=document.createElement("select");f.setAttribute("id",`mapbox-gl-valhalla-${s}`),f.style.width="100%",Object.keys(u).forEach(U=>{const G=document.createElement("option");G.setAttribute("value",w(u,U)),G.appendChild(document.createTextNode(U)),G.setAttribute("name",s),y===u[U]&&(G.selected=!0),f.appendChild(G)});const p=document.createElement("TR"),L=document.createElement("TD"),N=document.createElement("TD");return L.appendChild(z),N.appendChild(f),p.appendChild(L),p.appendChild(N),p};ep.createSelection=ZA;const HA=(u,r,s,y,w)=>{const z=document.createElement("label");z.textContent=u,w||(w="text");const f=document.createElement("input");f.setAttribute("id",`mapbox-gl-valhalla-${r}`),f.setAttribute("type",w),f.setAttribute("value",s),f.readOnly=y;const p=document.createElement("TR"),L=document.createElement("TD"),N=document.createElement("TD");return L.appendChild(z),N.appendChild(f),p.appendChild(L),p.appendChild(N),p};ep.createTextbox=HA;Object.defineProperty(zg,"__esModule",{value:!0});const By=ym,WA=xm,Df=ep;class XA{constructor(r,s){this.map=r,this.valhalla=s,this.onDocumentClick=this.onDocumentClick.bind(this)}addTo(r){var s,y;this.map||console.error("map object is null"),this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.mainContainer=document.createElement("div"),this.mainContainer.classList.add("mapboxgl-valhalla-list"),this.mainButton=document.createElement("button"),this.mainButton.classList.add("mapboxgl-ctrl-icon"),this.mainButton.classList.add("mapboxgl-valhalla-time-isochrone-control"),this.mainButton.addEventListener("click",()=>{this.mainButton.style.display="none",this.mainContainer.style.display="block",this.toggleCrosshair(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.mainButton),this.controlContainer.appendChild(this.mainContainer);const w=document.createElement("TABLE");w.className="valhalla-table",this.mainContainer.appendChild(w);const z=Df.createSelection(By.Costing,"Means of transport","costing",By.Costing.Walking,(U,G)=>U[G]);w.appendChild(z);const f=(s=this.map)===null||s===void 0?void 0:s.getCenter();if(f){const U=Df.createTextbox("Longitude","lon-time",f.lng,!0);w.appendChild(U);const G=Df.createTextbox("Latitude","lat-time",f.lat,!0);w.appendChild(G)}const p=this.valhalla.getContoursOption();for(let U=0;U<p.length;U+=1){const G=p[U],X=Df.createTextbox(`Contour ${U+1} (min)`,`contour-time-${U}`,G.time,!1,"number");w.appendChild(X)}const L=document.createElement("button");L.textContent="Clear",L.classList.add("mapbox-valhalla-control-button"),L.addEventListener("click",()=>{this.valhalla.clearFeatures()}),this.mainContainer.appendChild(L);const N=document.createElement("button");return N.textContent="Calculate",N.classList.add("mapbox-valhalla-control-button"),N.addEventListener("click",()=>{const U=document.getElementById("mapbox-gl-valhalla-lon-time"),G=document.getElementById("mapbox-gl-valhalla-lat-time"),X=document.getElementById("mapbox-gl-valhalla-costing"),Se=this.valhalla.getContoursOption();for(let ge=0;ge<Se.length;ge+=1){const De=Se[ge],Le=document.getElementById(`mapbox-gl-valhalla-contour-time-${ge}`);De.time=Number(Le.value)}this.valhalla.getIsochrone(Number(U.value),Number(G.value),By.ContourType.Time,X.value,Se)}),this.mainContainer.appendChild(N),(y=this.map)===null||y===void 0||y.on("moveend",()=>{var U;const G=(U=this.map)===null||U===void 0?void 0:U.getCenter(),X=document.getElementById("mapbox-gl-valhalla-lon-time"),Se=document.getElementById("mapbox-gl-valhalla-lat-time");G||(X.setAttribute("value",""),Se.setAttribute("value",""));const ge=G,De=ge!=null&&ge.lng?ge.lng.toString():"";X.setAttribute("value",De);const Le=ge!=null&&ge.lat?ge.lat.toString():"";Se.setAttribute("value",Le)}),r.appendChild(this.controlContainer),r}onDocumentClick(r){this.controlContainer&&!this.controlContainer.contains(r.target)&&this.hide()}hide(){this.mainContainer&&this.mainButton&&(this.mainContainer.style.display="none",this.mainButton.style.display="block",this.toggleCrosshair(!1))}destroy(){!this.mainContainer||!this.mainContainer.parentNode||!this.map||!this.mainButton||(this.mainButton.removeEventListener("click",this.onDocumentClick),this.mainContainer.parentNode.removeChild(this.mainContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.map=void 0)}toggleCrosshair(r){r===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new WA.default(this.map),this.crosshair.create())}}zg.default=XA;var Og={};Object.defineProperty(Og,"__esModule",{value:!0});const yv=ym,KA=xm,Oy=ep;class JA{constructor(r,s){this.map=r,this.valhalla=s,this.onDocumentClick=this.onDocumentClick.bind(this)}addTo(r){var s,y;this.map||console.error("map object is null"),this.controlContainer=document.createElement("div"),this.controlContainer.classList.add("mapboxgl-ctrl"),this.controlContainer.classList.add("mapboxgl-ctrl-group"),this.mainContainer=document.createElement("div"),this.mainContainer.classList.add("mapboxgl-valhalla-list"),this.mainButton=document.createElement("button"),this.mainButton.classList.add("mapboxgl-ctrl-icon"),this.mainButton.classList.add("mapboxgl-valhalla-distance-isochrone-control"),this.mainButton.addEventListener("click",()=>{this.mainButton.style.display="none",this.mainContainer.style.display="block",this.toggleCrosshair(!0)}),document.addEventListener("click",this.onDocumentClick),this.controlContainer.appendChild(this.mainButton),this.controlContainer.appendChild(this.mainContainer);const w=document.createElement("TABLE");w.className="valhalla-table",this.mainContainer.appendChild(w);const z=(s=this.map)===null||s===void 0?void 0:s.getCenter();if(z){const N=Oy.createTextbox("Longitude","lon-distance",z.lng,!0);w.appendChild(N);const U=Oy.createTextbox("Latitude","lat-distance",z.lat,!0);w.appendChild(U)}const f=this.valhalla.getContoursOption();for(let N=0;N<f.length;N+=1){const U=f[N],G=Oy.createTextbox(`Contour ${N+1} (km)`,`contour-distance-${N}`,U.distance,!1,"number");w.appendChild(G)}const p=document.createElement("button");p.textContent="Clear",p.classList.add("mapbox-valhalla-control-button"),p.addEventListener("click",()=>{this.valhalla.clearFeatures()}),this.mainContainer.appendChild(p);const L=document.createElement("button");return L.textContent="Calculate",L.classList.add("mapbox-valhalla-control-button"),L.addEventListener("click",()=>{const N=document.getElementById("mapbox-gl-valhalla-lon-distance"),U=document.getElementById("mapbox-gl-valhalla-lat-distance"),G=this.valhalla.getContoursOption();for(let X=0;X<G.length;X+=1){const Se=G[X],ge=document.getElementById(`mapbox-gl-valhalla-contour-distance-${X}`);Se.distance=Number(ge.value)}this.valhalla.getIsochrone(Number(N.value),Number(U.value),yv.ContourType.Distance,yv.Costing.Walking,G)}),this.mainContainer.appendChild(L),(y=this.map)===null||y===void 0||y.on("moveend",()=>{var N;const U=(N=this.map)===null||N===void 0?void 0:N.getCenter(),G=document.getElementById("mapbox-gl-valhalla-lon-distance"),X=document.getElementById("mapbox-gl-valhalla-lat-distance");U||(G.setAttribute("value",""),X.setAttribute("value",""));const Se=U,ge=Se!=null&&Se.lng?Se.lng.toString():"";G.setAttribute("value",ge);const De=Se!=null&&Se.lat?Se.lat.toString():"";X.setAttribute("value",De)}),r.appendChild(this.controlContainer),r}onDocumentClick(r){this.controlContainer&&!this.controlContainer.contains(r.target)&&this.hide()}hide(){this.mainContainer&&this.mainButton&&(this.mainContainer.style.display="none",this.mainButton.style.display="block",this.toggleCrosshair(!1))}destroy(){!this.mainContainer||!this.mainContainer.parentNode||!this.map||!this.mainButton||(this.mainButton.removeEventListener("click",this.onDocumentClick),this.mainContainer.parentNode.removeChild(this.mainContainer),document.removeEventListener("click",this.onDocumentClick),this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0),this.map=void 0)}toggleCrosshair(r){r===!1?this.crosshair!==void 0&&(this.crosshair.destroy(),this.crosshair=void 0):(this.crosshair=new KA.default(this.map),this.crosshair.create())}}Og.default=JA;Object.defineProperty(kg,"__esModule",{value:!0});const YA=zg,$A=Og,QA=ym;class eC{constructor(r,s){this.options={Contours:[{time:5,distance:1,color:"ff0000"},{time:10,distance:3,color:"ffff00"},{time:15,distance:5,color:"0000ff"}]},this.url=r,s&&(this.options=Object.assign(this.options,s)),this.onDocumentClick=this.onDocumentClick.bind(this)}getDefaultPosition(){return"top-right"}onAdd(r){return this.map=r,this.map&&(this.valhalla=new QA.default(this.map,this.url,this.options.Contours)),this.controlContainer=document.createElement("div"),this.timeIsochroneControl=new YA.default(this.map,this.valhalla),this.controlContainer=this.timeIsochroneControl.addTo(this.controlContainer),this.distanceIsochroneControl=new $A.default(this.map,this.valhalla),this.controlContainer=this.distanceIsochroneControl.addTo(this.controlContainer),document.addEventListener("click",this.onDocumentClick),this.controlContainer}onDocumentClick(r){this.controlContainer&&!this.controlContainer.contains(r.target)&&this.timeIsochroneControl&&this.distanceIsochroneControl&&(this.timeIsochroneControl.hide(),this.distanceIsochroneControl.hide())}onRemove(){!this.controlContainer||!this.controlContainer.parentNode||!this.map||!this.timeIsochroneControl||!this.distanceIsochroneControl||(this.timeIsochroneControl.destroy(),this.distanceIsochroneControl.destroy(),this.controlContainer.parentNode.removeChild(this.controlContainer),document.removeEventListener("click",this.onDocumentClick),this.map=void 0)}}kg.default=eC;(function(u){Object.defineProperty(u,"__esModule",{value:!0}),u.MapboxValhallaControl=void 0;var r=kg;Object.defineProperty(u,"MapboxValhallaControl",{enumerable:!0,get:function(){return r.default}})})(B0);function tC(u){let r,s;return{c(){r=mr("div"),s=mr("div"),this.h()},l(y){r=yr(y,"DIV",{class:!0});var w=Vr(r);s=yr(w,"DIV",{class:!0,id:!0}),Vr(s).forEach(Bt),w.forEach(Bt),this.h()},h(){jr(s,"class","map svelte-7ujfu6"),jr(s,"id","map"),jr(r,"class","map-wrap svelte-7ujfu6")},m(y,w){ki(y,r,w),Ta(r,s),u[1](s)},p:Bl,i:Bl,o:Bl,d(y){y&&Bt(r),u[1](null)}}}function iC(u,r,s){let y;Qu(async()=>{const z=new Yh.exports.Map({container:y,style:Ur.styles[0].uri,center:Ur.center,zoom:Ur.zoom,hash:!0,attributionControl:!1});if(z.addControl(new Yh.exports.NavigationControl({}),"top-right"),z.addControl(new Yh.exports.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),"top-right"),z.addControl(new Yh.exports.ScaleControl({maxWidth:80,unit:"metric"}),"bottom-left"),z.addControl(new Yh.exports.AttributionControl({compact:!0}),"bottom-right"),z.addControl(new R0(Ur.styles),"top-right"),z.addControl(new pT(Ur.areaSwitcher.areas),"top-right"),Ur.elevation){const Se=await(await p_(()=>import("./index-148b21b8.js").then(function(ge){return ge.i}),[])).default;z.addControl(new Se(Ur.elevation.url,Ur.elevation.options),"top-right")}const{MaplibreExportControl:f,Size:p,PageOrientation:L,Format:N,DPI:U}=await p_(()=>import("./index-88cad604.js").then(function(Se){return Se.i}),[]);if(z.addControl(new f({PageSize:p.A4,PageOrientation:L.Landscape,Format:N.PNG,DPI:U[96],Crosshair:!0,PrintableArea:!0}),"top-right"),Ur.valhalla&&z.addControl(new B0.MapboxValhallaControl(Ur.valhalla.url,Ur.valhalla.options),"top-right"),Ur.popup&&z.addControl(new yT(Ur.popup.target)),!Ur.search)return;const G=await fetch(Ur.search.url).then(Se=>Se.json());function X(Se){for(var ge=[],De=0;De<G.features.length;De++){var Le=G.features[De];Ur.search.target.forEach(ft=>{var Ue=Le.properties[ft];!Ue||Ue.toString().toLowerCase().search(Se.toString().toLowerCase())!==-1&&(Le.place_name=Ur.search.format(Le.properties),Le.center=Le.geometry.coordinates,Le.place_type=Ur.search.place_type,ge.push(Le))})}return ge}z.addControl(new hT({localGeocoder:X,localGeocoderOnly:!0,zoom:Ur.search.zoom,placeholder:Ur.search.placeholder,mapboxgl:tS}),"top-left"),Qf.update(()=>z)});function w(z){hn[z?"unshift":"push"](()=>{y=z,s(0,y)})}return[y,w]}class rC extends gn{constructor(r){super(),_n(this,r,iC,tC,vn,{})}}function nC(u){let r,s;return r=new rC({}),{c(){gr(r.$$.fragment)},l(y){qr(r.$$.fragment,y)},m(y,w){_r(r,y,w),s=!0},i(y){s||(li(r.$$.fragment,y),s=!0)},o(y){pi(r.$$.fragment,y),s=!1},d(y){vr(r,y)}}}function oC(u){let r,s,y,w,z,f;function p(G){u[1](G)}let L={};u[0]!==void 0&&(L.drawerOpen=u[0]),r=new hb({props:L}),hn.push(()=>Nf(r,"drawerOpen",p));function N(G){u[2](G)}let U={$$slots:{default:[nC]},$$scope:{ctx:u}};return u[0]!==void 0&&(U.open=u[0]),w=new QE({props:U}),hn.push(()=>Nf(w,"open",N)),{c(){gr(r.$$.fragment),y=na(),gr(w.$$.fragment)},l(G){qr(r.$$.fragment,G),y=oa(G),qr(w.$$.fragment,G)},m(G,X){_r(r,G,X),ki(G,y,X),_r(w,G,X),f=!0},p(G,[X]){const Se={};!s&&X&1&&(s=!0,Se.drawerOpen=G[0],jf(()=>s=!1)),r.$set(Se);const ge={};X&8&&(ge.$$scope={dirty:X,ctx:G}),!z&&X&1&&(z=!0,ge.open=G[0],jf(()=>z=!1)),w.$set(ge)},i(G){f||(li(r.$$.fragment,G),li(w.$$.fragment,G),f=!0)},o(G){pi(r.$$.fragment,G),pi(w.$$.fragment,G),f=!1},d(G){vr(r,G),G&&Bt(y),vr(w,G)}}}function aC(u,r,s){let y=!1;function w(f){y=f,s(0,y)}function z(f){y=f,s(0,y)}return[y,w,z]}class hC extends gn{constructor(r){super(),_n(this,r,aC,oC,vn,{})}}export{hC as _,qA as a,cC as b,Rl as c,eS as g,Yh as m};
